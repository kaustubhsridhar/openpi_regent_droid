Using cache found in /home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
2025-03-13 14:54:54: [embed_episodes] skipping episode 161 [episode count 0/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 12481 [episode count 1/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 80218 [episode count 2/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 45298 [episode count 3/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 84850 [episode count 4/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 8718 [episode count 5/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 23959 [episode count 6/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 91556 [episode count 7/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 48565 [episode count 8/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 20115 [episode count 9/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 15684 [episode count 10/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 3259 [episode count 11/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 36048 [episode count 12/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 13531 [episode count 13/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 79548 [episode count 14/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 62698 [episode count 15/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 46982 [episode count 16/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 57228 [episode count 17/20]
2025-03-13 14:54:54: [embed_episodes] skipping episode 26519 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] embedded episode 92141 with 93 steps [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5235850418_close_drawer_generic [chosen_id count 0/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 55330 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 14371 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 45164 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 63601 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 34989 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 33183 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 6426 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 35144 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 53909 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 8960 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 56529 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 83631 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 62757 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 86948 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 23461 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 60441 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 67519 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 59358 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 90729 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 83408 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5235850418_close_upper_drawer_generic [chosen_id count 1/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 32875 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 82039 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 94344 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 150 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 43182 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 4279 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 57531 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 65735 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 41173 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 12503 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 45273 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 33038 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 20764 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 55649 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 86384 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 383 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 14724 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 80293 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 94645 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 94649 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5235850418_put_orange_on_green [chosen_id count 2/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 19201 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 71298 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 27139 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 78348 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 43028 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 29845 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 17307 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 64028 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 58537 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 88106 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 54075 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 78780 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 77248 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 37185 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 89930 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 25805 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 8015 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 22361 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 71386 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 83930 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 52817038_green_block_in_black_bowl [chosen_id count 3/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 95232 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 90128 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 69139 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 43555 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 34378 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 1113 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 71811 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 68740 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 52359 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 21131 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 94382 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 73906 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 56534 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 85727 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 91528 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 33166 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 39855 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 19902 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 481 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 93162 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5374398722_close_laptop [chosen_id count 4/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 44547 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 76815 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 61997 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 58938 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 36412 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 42104 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 24744 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 28883 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 28372 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 8942 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 66319 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 9034 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 32026 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 42778 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 55593 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 48529 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 86881 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 67964 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 53190 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 23883 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5374398722_press_stapler [chosen_id count 5/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 35356 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 91181 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 35917 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 27727 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 72814 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 46179 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 84091 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 68749 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 58012 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 76460 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 15264 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 39301 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 31968 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 87356 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 17845 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 84439 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 29148 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 52725 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 17854 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 22483 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5594497977_Close the air fryer [chosen_id count 6/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 54656 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 54532 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 10759 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 4247 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 59258 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 55839 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 86561 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 79271 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 51240 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 45867 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 52524 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 85181 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 90052 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 42697 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 20811 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 20431 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 82895 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 44129 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 41459 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 17656 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5664924394_put_glue_stick_in_mug [chosen_id count 7/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 23056 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 23 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 81492 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 54374 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 39544 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 83598 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 25757 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 16545 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 23751 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 70352 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 4313 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 88813 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 87298 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 41219 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 68368 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 60181 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 21699 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 94016 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 6027 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 26516 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5879622450_put_yellow_block_in_blue_cup [chosen_id count 8/196]
2025-03-13 14:54:56: [embed_episodes] skipping episode 64528 [episode count 0/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 92700 [episode count 1/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 57391 [episode count 2/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 18992 [episode count 3/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 31289 [episode count 4/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 27714 [episode count 5/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 11846 [episode count 6/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 66173 [episode count 7/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 74415 [episode count 8/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 50353 [episode count 9/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 95416 [episode count 10/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 43710 [episode count 11/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 90814 [episode count 12/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 86212 [episode count 13/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 12489 [episode count 14/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 14546 [episode count 15/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 87305 [episode count 16/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 50974 [episode count 17/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 37671 [episode count 18/20]
2025-03-13 14:54:56: [embed_episodes] skipping episode 87860 [episode count 19/20]
2025-03-13 14:54:56: [embed_episodes] finished embedding all episodes for 5879622450_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 14:54:56: [embed_episodes] done!
2025-03-13 14:54:56: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:55:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_drawer_generic [chosen_id count 0/196]
2025-03-13 14:55:24: [retrieval_preprocessing] we have num_total=1982 embedding_dim=49152
[retrieval_preprocessing] for episode 161 [episode count 0/20], we have num_retrieval=np.int64(1919) num_query=np.int64(63)
2025-03-13 14:55:30,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:30,519 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:30
2025-03-13 14:55:30,519 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 620.83it/s]
2025-03-13 14:55:30,554 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 14:55:30,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 14:55:30,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:30,554 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 14:55:30,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:30,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:55:30,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,555 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:30,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0009 secs
2025-03-13 14:55:30,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:30
2025-03-13 14:55:30,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:30,555 [INFO]: 	Creating the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,555 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:30
2025-03-13 14:55:30,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 14:55:30,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,557 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:55:30,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  3.17it/s] 25%|██▌       | 2/8 [00:00<00:01,  4.51it/s] 38%|███▊      | 3/8 [00:00<00:01,  4.81it/s] 50%|█████     | 4/8 [00:00<00:00,  5.63it/s] 62%|██████▎   | 5/8 [00:01<00:00,  3.93it/s] 75%|███████▌  | 6/8 [00:01<00:00,  3.01it/s]100%|██████████| 8/8 [00:03<00:00,  1.50it/s]100%|██████████| 8/8 [00:03<00:00,  2.17it/s]
2025-03-13 14:55:34,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:34
2025-03-13 14:56:09,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5149 secs
2025-03-13 14:56:09,766 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 14:56:09,766 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.73it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.71it/s]
2025-03-13 14:56:44,880 [INFO]: 	>>> Finished "Compute fast metrics" in 35.1139 secs
2025-03-13 14:56:44,883 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.3261 secs
2025-03-13 14:56:44,883 [INFO]: {
2025-03-13 14:56:44,883 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:44,883 [INFO]: 	index_param: efSearch=335
2025-03-13 14:56:44,883 [INFO]: 	index_path: knn.index
2025-03-13 14:56:44,883 [INFO]: 	size in bytes: 377551810
2025-03-13 14:56:44,883 [INFO]: 	avg_search_speed_ms: 12.35775091214513
2025-03-13 14:56:44,883 [INFO]: 	99p_search_speed_ms: 19.475326491519795
2025-03-13 14:56:44,883 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:44,883 [INFO]: 	nb vectors: 1919
2025-03-13 14:56:44,883 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:44,883 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 14:56:44,883 [INFO]: }
2025-03-13 14:56:44,883 [INFO]: 	>>> Finished "Creating the index" in 74.3281 secs
2025-03-13 14:56:44,883 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3647 secs
2025-03-13 14:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 161 [episode count 0/20]
[retrieval_preprocessing] for episode 12481 [episode count 1/20], we have num_retrieval=np.int64(1908) num_query=np.int64(74)
2025-03-13 14:56:49,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:49,781 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:49
2025-03-13 14:56:49,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1654.56it/s]
2025-03-13 14:56:49,804 [INFO]: There are 1908 embeddings of dim 49152
2025-03-13 14:56:49,805 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 14:56:49,805 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:49
2025-03-13 14:56:49,805 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:49,805 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 14:56:49,805 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:49,805 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:56:49,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:49
2025-03-13 14:56:49,806 [INFO]: 393.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:49,806 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:56:49,806 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:49
2025-03-13 14:56:49,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:49,807 [INFO]: 	Creating the index 03/13/2025, 14:56:49
2025-03-13 14:56:49,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:49
2025-03-13 14:56:49,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:56:49,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:49
2025-03-13 14:56:49,810 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 14:56:49,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:04<00:31,  4.47s/it] 25%|██▌       | 2/8 [00:06<00:17,  2.98s/it] 38%|███▊      | 3/8 [00:06<00:08,  1.67s/it] 50%|█████     | 4/8 [00:06<00:04,  1.06s/it] 75%|███████▌  | 6/8 [00:06<00:01,  1.84it/s]100%|██████████| 8/8 [00:08<00:00,  1.46it/s]100%|██████████| 8/8 [00:08<00:00,  1.07s/it]
2025-03-13 14:56:58,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:58
2025-03-13 14:57:28,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6386 secs
2025-03-13 14:57:28,017 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 14:57:28,017 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.23s/it] 50%|█████     | 2/4 [00:03<00:02,  1.40s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.24it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.18s/it]
2025-03-13 14:57:57,187 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1698 secs
2025-03-13 14:57:57,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3842 secs
2025-03-13 14:57:57,194 [INFO]: {
2025-03-13 14:57:57,194 [INFO]: 	index_key: HNSW15
2025-03-13 14:57:57,195 [INFO]: 	index_param: efSearch=244
2025-03-13 14:57:57,195 [INFO]: 	index_path: knn.index
2025-03-13 14:57:57,195 [INFO]: 	size in bytes: 375387670
2025-03-13 14:57:57,195 [INFO]: 	avg_search_speed_ms: 9.398366940379338
2025-03-13 14:57:57,195 [INFO]: 	99p_search_speed_ms: 16.235572153236678
2025-03-13 14:57:57,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:57:57,195 [INFO]: 	nb vectors: 1908
2025-03-13 14:57:57,195 [INFO]: 	vectors dimension: 49152
2025-03-13 14:57:57,195 [INFO]: 	compression ratio: 0.999308432266835
2025-03-13 14:57:57,195 [INFO]: }
2025-03-13 14:57:57,195 [INFO]: 	>>> Finished "Creating the index" in 67.3878 secs
2025-03-13 14:57:57,195 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4140 secs
2025-03-13 14:57:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 12481 [episode count 1/20]
[retrieval_preprocessing] for episode 80218 [episode count 2/20], we have num_retrieval=np.int64(1913) num_query=np.int64(69)
2025-03-13 14:57:58,655 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:58,969 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:58
2025-03-13 14:57:58,969 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.53it/s]
2025-03-13 14:57:58,993 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 14:57:58,994 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 14:57:58,994 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:58
2025-03-13 14:57:58,994 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:58,994 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 14:57:58,994 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:58,994 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:57:58,994 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:58
2025-03-13 14:57:58,994 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:58,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:57:58,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:58
2025-03-13 14:57:58,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:58,994 [INFO]: 	Creating the index 03/13/2025, 14:57:58
2025-03-13 14:57:58,994 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:58
2025-03-13 14:57:58,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:57:58,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:58
2025-03-13 14:57:58,995 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 14:57:58,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.23it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.25it/s] 38%|███▊      | 3/8 [00:00<00:00,  5.69it/s] 50%|█████     | 4/8 [00:00<00:00,  5.87it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.09it/s] 75%|███████▌  | 6/8 [00:01<00:00,  6.13it/s] 88%|████████▊ | 7/8 [00:01<00:00,  6.25it/s]100%|██████████| 8/8 [00:02<00:00,  1.62it/s]100%|██████████| 8/8 [00:02<00:00,  2.88it/s]
2025-03-13 14:58:01,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:01
2025-03-13 14:58:28,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2102 secs
2025-03-13 14:58:28,991 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 14:58:28,992 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s]
2025-03-13 14:58:48,738 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7467 secs
2025-03-13 14:58:48,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7458 secs
2025-03-13 14:58:48,741 [INFO]: {
2025-03-13 14:58:48,741 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:48,741 [INFO]: 	index_param: efSearch=259
2025-03-13 14:58:48,741 [INFO]: 	index_path: knn.index
2025-03-13 14:58:48,742 [INFO]: 	size in bytes: 376371370
2025-03-13 14:58:48,742 [INFO]: 	avg_search_speed_ms: 10.941401147945934
2025-03-13 14:58:48,742 [INFO]: 	99p_search_speed_ms: 20.3234370192513
2025-03-13 14:58:48,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:48,742 [INFO]: 	nb vectors: 1913
2025-03-13 14:58:48,742 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:48,742 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 14:58:48,742 [INFO]: }
2025-03-13 14:58:48,742 [INFO]: 	>>> Finished "Creating the index" in 49.7475 secs
2025-03-13 14:58:48,742 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7723 secs
2025-03-13 14:58:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 80218 [episode count 2/20]
[retrieval_preprocessing] for episode 45298 [episode count 3/20], we have num_retrieval=np.int64(1887) num_query=np.int64(95)
2025-03-13 14:58:50,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:51,625 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:51
2025-03-13 14:58:51,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-13 14:58:51,653 [INFO]: There are 1887 embeddings of dim 49152
2025-03-13 14:58:51,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 14:58:51,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:51
2025-03-13 14:58:51,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:51,654 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 14:58:51,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:51,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:51,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:51
2025-03-13 14:58:51,654 [INFO]: 389.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:51,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:58:51,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:51
2025-03-13 14:58:51,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:51,654 [INFO]: 	Creating the index 03/13/2025, 14:58:51
2025-03-13 14:58:51,654 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:51
2025-03-13 14:58:51,656 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:58:51,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:51
2025-03-13 14:58:51,656 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 14:58:51,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.95it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.49it/s] 38%|███▊      | 3/8 [00:00<00:01,  3.53it/s] 50%|█████     | 4/8 [00:00<00:01,  3.97it/s] 62%|██████▎   | 5/8 [00:01<00:00,  3.60it/s] 75%|███████▌  | 6/8 [00:01<00:00,  4.42it/s]100%|██████████| 8/8 [00:02<00:00,  2.10it/s]100%|██████████| 8/8 [00:02<00:00,  2.80it/s]
2025-03-13 14:58:54,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:54
2025-03-13 14:59:17,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5120 secs
2025-03-13 14:59:17,072 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 14:59:17,072 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 14:59:41,273 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2003 secs
2025-03-13 14:59:41,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6190 secs
2025-03-13 14:59:41,275 [INFO]: {
2025-03-13 14:59:41,276 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:41,276 [INFO]: 	index_param: efSearch=319
2025-03-13 14:59:41,276 [INFO]: 	index_path: knn.index
2025-03-13 14:59:41,276 [INFO]: 	size in bytes: 371255950
2025-03-13 14:59:41,276 [INFO]: 	avg_search_speed_ms: 11.21817345338385
2025-03-13 14:59:41,276 [INFO]: 	99p_search_speed_ms: 18.933664173819135
2025-03-13 14:59:41,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:41,276 [INFO]: 	nb vectors: 1887
2025-03-13 14:59:41,276 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:41,276 [INFO]: 	compression ratio: 0.9993086871739025
2025-03-13 14:59:41,276 [INFO]: }
2025-03-13 14:59:41,276 [INFO]: 	>>> Finished "Creating the index" in 49.6213 secs
2025-03-13 14:59:41,276 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6502 secs
2025-03-13 14:59:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 45298 [episode count 3/20]
[retrieval_preprocessing] for episode 84850 [episode count 4/20], we have num_retrieval=np.int64(1904) num_query=np.int64(78)
2025-03-13 14:59:43,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:43,748 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:43
2025-03-13 14:59:43,748 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.05it/s]
2025-03-13 14:59:43,774 [INFO]: There are 1904 embeddings of dim 49152
2025-03-13 14:59:43,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 14:59:43,775 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:43,776 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 14:59:43,776 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:43,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:59:43,776 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,776 [INFO]: 392.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:43,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:59:43,777 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:43
2025-03-13 14:59:43,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:43,777 [INFO]: 	Creating the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,777 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:43
2025-03-13 14:59:43,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 14:59:43,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:43
2025-03-13 14:59:43,780 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 14:59:43,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.19it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.33it/s] 50%|█████     | 4/8 [00:00<00:00,  8.01it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.34it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.53it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.44it/s]100%|██████████| 8/8 [00:02<00:00,  2.09it/s]100%|██████████| 8/8 [00:02<00:00,  3.75it/s]
2025-03-13 14:59:45,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:45
2025-03-13 15:00:11,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1340 secs
2025-03-13 15:00:11,052 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 15:00:11,053 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 15:00:27,553 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5000 secs
2025-03-13 15:00:27,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7746 secs
2025-03-13 15:00:27,555 [INFO]: {
2025-03-13 15:00:27,555 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:27,555 [INFO]: 	index_param: efSearch=224
2025-03-13 15:00:27,555 [INFO]: 	index_path: knn.index
2025-03-13 15:00:27,555 [INFO]: 	size in bytes: 374600710
2025-03-13 15:00:27,555 [INFO]: 	avg_search_speed_ms: 9.481012186485726
2025-03-13 15:00:27,555 [INFO]: 	99p_search_speed_ms: 14.11498319823295
2025-03-13 15:00:27,555 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:27,555 [INFO]: 	nb vectors: 1904
2025-03-13 15:00:27,555 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:27,555 [INFO]: 	compression ratio: 0.9993083889243028
2025-03-13 15:00:27,555 [INFO]: }
2025-03-13 15:00:27,555 [INFO]: 	>>> Finished "Creating the index" in 43.7781 secs
2025-03-13 15:00:27,555 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8065 secs
2025-03-13 15:00:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 84850 [episode count 4/20]
[retrieval_preprocessing] for episode 8718 [episode count 5/20], we have num_retrieval=np.int64(1849) num_query=np.int64(133)
2025-03-13 15:00:28,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:29,252 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:29
2025-03-13 15:00:29,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.09it/s]
2025-03-13 15:00:29,274 [INFO]: There are 1849 embeddings of dim 49152
2025-03-13 15:00:29,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 15:00:29,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:29,274 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:00:29,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:29,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:29,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,275 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:29,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:00:29,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:29
2025-03-13 15:00:29,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:29,275 [INFO]: 	Creating the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,275 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:29
2025-03-13 15:00:29,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:00:29,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:29
2025-03-13 15:00:29,276 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:00:29,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.07it/s] 50%|█████     | 4/8 [00:00<00:00, 16.29it/s] 75%|███████▌  | 6/8 [00:00<00:00, 14.65it/s]100%|██████████| 8/8 [00:01<00:00,  4.02it/s]100%|██████████| 8/8 [00:01<00:00,  5.36it/s]
2025-03-13 15:00:30,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:30
2025-03-13 15:00:57,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4954 secs
2025-03-13 15:00:57,269 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 15:00:57,269 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.45s/it] 50%|█████     | 2/4 [00:01<00:01,  1.11it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.32it/s] 75%|███████▌  | 3/4 [00:04<00:01,  1.35s/it]
2025-03-13 15:01:20,007 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7379 secs
2025-03-13 15:01:20,008 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7325 secs
2025-03-13 15:01:20,009 [INFO]: {
2025-03-13 15:01:20,009 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:20,009 [INFO]: 	index_param: efSearch=294
2025-03-13 15:01:20,009 [INFO]: 	index_path: knn.index
2025-03-13 15:01:20,009 [INFO]: 	size in bytes: 363779470
2025-03-13 15:01:20,009 [INFO]: 	avg_search_speed_ms: 10.54609990344709
2025-03-13 15:01:20,009 [INFO]: 	99p_search_speed_ms: 15.12200133409351
2025-03-13 15:01:20,009 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:20,009 [INFO]: 	nb vectors: 1849
2025-03-13 15:01:20,009 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:20,009 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-13 15:01:20,009 [INFO]: }
2025-03-13 15:01:20,009 [INFO]: 	>>> Finished "Creating the index" in 50.7339 secs
2025-03-13 15:01:20,009 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7570 secs
2025-03-13 15:01:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 8718 [episode count 5/20]
[retrieval_preprocessing] for episode 23959 [episode count 6/20], we have num_retrieval=np.int64(1925) num_query=np.int64(57)
2025-03-13 15:01:24,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:25,226 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:25
2025-03-13 15:01:25,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1834.78it/s]
2025-03-13 15:01:25,248 [INFO]: There are 1925 embeddings of dim 49152
2025-03-13 15:01:25,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 15:01:25,248 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:25
2025-03-13 15:01:25,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:25,248 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:01:25,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:25,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:01:25,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:25
2025-03-13 15:01:25,249 [INFO]: 397.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:25,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:01:25,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:25
2025-03-13 15:01:25,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:25,249 [INFO]: 	Creating the index 03/13/2025, 15:01:25
2025-03-13 15:01:25,249 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:25
2025-03-13 15:01:25,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:01:25,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:25
2025-03-13 15:01:25,250 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:01:25,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:03,  2.18it/s] 25%|██▌       | 2/8 [00:00<00:02,  2.76it/s] 38%|███▊      | 3/8 [00:01<00:01,  3.16it/s] 50%|█████     | 4/8 [00:01<00:01,  2.73it/s] 75%|███████▌  | 6/8 [00:01<00:00,  4.90it/s]100%|██████████| 8/8 [00:02<00:00,  2.60it/s]100%|██████████| 8/8 [00:02<00:00,  2.83it/s]
2025-03-13 15:01:28,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:28
2025-03-13 15:01:51,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9040 secs
2025-03-13 15:01:51,989 [INFO]: The best hyperparameters are: efSearch=361
2025-03-13 15:01:51,989 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 15:02:15,718 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7289 secs
2025-03-13 15:02:15,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6031 secs
2025-03-13 15:02:15,853 [INFO]: {
2025-03-13 15:02:15,853 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:15,854 [INFO]: 	index_param: efSearch=361
2025-03-13 15:02:15,854 [INFO]: 	index_path: knn.index
2025-03-13 15:02:15,854 [INFO]: 	size in bytes: 378732250
2025-03-13 15:02:15,854 [INFO]: 	avg_search_speed_ms: 11.151649006471088
2025-03-13 15:02:15,854 [INFO]: 	99p_search_speed_ms: 19.30576878599821
2025-03-13 15:02:15,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:15,854 [INFO]: 	nb vectors: 1925
2025-03-13 15:02:15,854 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:15,854 [INFO]: 	compression ratio: 0.99930861446312
2025-03-13 15:02:15,854 [INFO]: }
2025-03-13 15:02:15,854 [INFO]: 	>>> Finished "Creating the index" in 50.6053 secs
2025-03-13 15:02:15,854 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6284 secs
2025-03-13 15:02:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 23959 [episode count 6/20]
[retrieval_preprocessing] for episode 91556 [episode count 7/20], we have num_retrieval=np.int64(1862) num_query=np.int64(120)
2025-03-13 15:02:17,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:17,616 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:17
2025-03-13 15:02:17,616 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.26it/s]
2025-03-13 15:02:17,640 [INFO]: There are 1862 embeddings of dim 49152
2025-03-13 15:02:17,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:02:17,640 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:17
2025-03-13 15:02:17,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:17,640 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:02:17,640 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:17,640 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:17,640 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:17
2025-03-13 15:02:17,640 [INFO]: 384.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:17,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:02:17,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:17
2025-03-13 15:02:17,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:17,640 [INFO]: 	Creating the index 03/13/2025, 15:02:17
2025-03-13 15:02:17,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:17
2025-03-13 15:02:17,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:02:17,641 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:17
2025-03-13 15:02:17,641 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:02:17,641 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.65it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.03it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.61it/s] 50%|█████     | 4/8 [00:00<00:00,  8.05it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.40it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.66it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.77it/s]100%|██████████| 8/8 [00:02<00:00,  1.94it/s]100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
2025-03-13 15:02:19,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:19
2025-03-13 15:02:42,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8766 secs
2025-03-13 15:02:42,757 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 15:02:42,757 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 15:02:58,268 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5113 secs
2025-03-13 15:02:58,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6285 secs
2025-03-13 15:02:58,270 [INFO]: {
2025-03-13 15:02:58,270 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:58,270 [INFO]: 	index_param: efSearch=291
2025-03-13 15:02:58,270 [INFO]: 	index_path: knn.index
2025-03-13 15:02:58,270 [INFO]: 	size in bytes: 366337270
2025-03-13 15:02:58,270 [INFO]: 	avg_search_speed_ms: 10.41439321367458
2025-03-13 15:02:58,270 [INFO]: 	99p_search_speed_ms: 13.678513760678468
2025-03-13 15:02:58,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:58,270 [INFO]: 	nb vectors: 1862
2025-03-13 15:02:58,270 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:58,270 [INFO]: 	compression ratio: 0.9993089046058568
2025-03-13 15:02:58,270 [INFO]: }
2025-03-13 15:02:58,270 [INFO]: 	>>> Finished "Creating the index" in 40.6299 secs
2025-03-13 15:02:58,270 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6542 secs
2025-03-13 15:02:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 91556 [episode count 7/20]
[retrieval_preprocessing] for episode 48565 [episode count 8/20], we have num_retrieval=np.int64(1873) num_query=np.int64(109)
2025-03-13 15:03:00,963 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:01,539 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:01
2025-03-13 15:03:01,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.68it/s]
2025-03-13 15:03:01,565 [INFO]: There are 1873 embeddings of dim 49152
2025-03-13 15:03:01,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:03:01,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:01
2025-03-13 15:03:01,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:01,566 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:03:01,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:01,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:01,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:01
2025-03-13 15:03:01,566 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:01,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:03:01,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:01
2025-03-13 15:03:01,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:01,566 [INFO]: 	Creating the index 03/13/2025, 15:03:01
2025-03-13 15:03:01,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:01
2025-03-13 15:03:01,567 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:03:01,567 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:01
2025-03-13 15:03:01,567 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:03:01,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.82it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.12it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.72it/s] 50%|█████     | 4/8 [00:00<00:00,  6.98it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.31it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.38it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.46it/s]100%|██████████| 8/8 [00:02<00:00,  1.97it/s]100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
2025-03-13 15:03:04,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:04
2025-03-13 15:03:26,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0857 secs
2025-03-13 15:03:26,230 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 15:03:26,230 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 15:03:43,418 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1883 secs
2025-03-13 15:03:43,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8528 secs
2025-03-13 15:03:43,420 [INFO]: {
2025-03-13 15:03:43,420 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:43,420 [INFO]: 	index_param: efSearch=309
2025-03-13 15:03:43,420 [INFO]: 	index_path: knn.index
2025-03-13 15:03:43,420 [INFO]: 	size in bytes: 368501470
2025-03-13 15:03:43,420 [INFO]: 	avg_search_speed_ms: 11.605192972249903
2025-03-13 15:03:43,420 [INFO]: 	99p_search_speed_ms: 17.840493787080042
2025-03-13 15:03:43,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:43,421 [INFO]: 	nb vectors: 1873
2025-03-13 15:03:43,421 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:43,421 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-13 15:03:43,421 [INFO]: }
2025-03-13 15:03:43,421 [INFO]: 	>>> Finished "Creating the index" in 41.8545 secs
2025-03-13 15:03:43,421 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8811 secs
2025-03-13 15:03:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 48565 [episode count 8/20]
[retrieval_preprocessing] for episode 20115 [episode count 9/20], we have num_retrieval=np.int64(1914) num_query=np.int64(68)
2025-03-13 15:03:45,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:45,721 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:45
2025-03-13 15:03:45,721 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 770.02it/s]
2025-03-13 15:03:45,749 [INFO]: There are 1914 embeddings of dim 49152
2025-03-13 15:03:45,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:03:45,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:45,750 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:03:45,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:45,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:03:45,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,751 [INFO]: 395.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:45,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:03:45,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:45
2025-03-13 15:03:45,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:45,751 [INFO]: 	Creating the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:45
2025-03-13 15:03:45,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:03:45,754 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,755 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:03:45,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.88it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.37it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.00it/s] 50%|█████     | 4/8 [00:00<00:00,  8.36it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.54it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.63it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.63it/s]100%|██████████| 8/8 [00:02<00:00,  1.81it/s]100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
2025-03-13 15:03:48,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:48
2025-03-13 15:04:12,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8781 secs
2025-03-13 15:04:12,978 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 15:04:12,978 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.36it/s] 50%|█████     | 2/4 [00:00<00:00,  2.68it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.76it/s]
2025-03-13 15:04:30,901 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9233 secs
2025-03-13 15:04:30,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1482 secs
2025-03-13 15:04:30,903 [INFO]: {
2025-03-13 15:04:30,903 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:30,903 [INFO]: 	index_param: efSearch=262
2025-03-13 15:04:30,903 [INFO]: 	index_path: knn.index
2025-03-13 15:04:30,903 [INFO]: 	size in bytes: 376568110
2025-03-13 15:04:30,903 [INFO]: 	avg_search_speed_ms: 10.10139713280204
2025-03-13 15:04:30,903 [INFO]: 	99p_search_speed_ms: 16.855332106351856
2025-03-13 15:04:30,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:30,903 [INFO]: 	nb vectors: 1914
2025-03-13 15:04:30,903 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:30,903 [INFO]: 	compression ratio: 0.9993084969409651
2025-03-13 15:04:30,903 [INFO]: }
2025-03-13 15:04:30,903 [INFO]: 	>>> Finished "Creating the index" in 45.1517 secs
2025-03-13 15:04:30,903 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1819 secs
2025-03-13 15:04:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 20115 [episode count 9/20]
[retrieval_preprocessing] for episode 15684 [episode count 10/20], we have num_retrieval=np.int64(1799) num_query=np.int64(183)
2025-03-13 15:04:35,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:36,079 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:36
2025-03-13 15:04:36,079 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 15:04:36,101 [INFO]: There are 1799 embeddings of dim 49152
2025-03-13 15:04:36,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 15:04:36,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:36
2025-03-13 15:04:36,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:36,101 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:04:36,101 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:36,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:36,101 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:36
2025-03-13 15:04:36,101 [INFO]: 371.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:36,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:04:36,101 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:36
2025-03-13 15:04:36,101 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:36,101 [INFO]: 	Creating the index 03/13/2025, 15:04:36
2025-03-13 15:04:36,101 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:36
2025-03-13 15:04:36,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:04:36,102 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:36
2025-03-13 15:04:36,102 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:04:36,103 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.63it/s] 38%|███▊      | 3/8 [00:00<00:00, 11.71it/s] 62%|██████▎   | 5/8 [00:00<00:00, 13.95it/s]100%|██████████| 8/8 [00:01<00:00,  3.76it/s]100%|██████████| 8/8 [00:01<00:00,  4.63it/s]
2025-03-13 15:04:37,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:37
2025-03-13 15:05:06,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5753 secs
2025-03-13 15:05:06,410 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 15:05:06,410 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.53it/s]
2025-03-13 15:05:31,794 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3843 secs
2025-03-13 15:05:31,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6938 secs
2025-03-13 15:05:31,796 [INFO]: {
2025-03-13 15:05:31,796 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:31,796 [INFO]: 	index_param: efSearch=304
2025-03-13 15:05:31,796 [INFO]: 	index_path: knn.index
2025-03-13 15:05:31,796 [INFO]: 	size in bytes: 353942470
2025-03-13 15:05:31,796 [INFO]: 	avg_search_speed_ms: 10.90987125866627
2025-03-13 15:05:31,796 [INFO]: 	99p_search_speed_ms: 21.47605042904618
2025-03-13 15:05:31,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:31,797 [INFO]: 	nb vectors: 1799
2025-03-13 15:05:31,797 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:31,797 [INFO]: 	compression ratio: 0.999308706864141
2025-03-13 15:05:31,797 [INFO]: }
2025-03-13 15:05:31,797 [INFO]: 	>>> Finished "Creating the index" in 55.6951 secs
2025-03-13 15:05:31,797 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7178 secs
2025-03-13 15:05:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 15684 [episode count 10/20]
[retrieval_preprocessing] for episode 3259 [episode count 11/20], we have num_retrieval=np.int64(1915) num_query=np.int64(67)
2025-03-13 15:05:35,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:35,694 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:35
2025-03-13 15:05:35,694 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 964.43it/s]
2025-03-13 15:05:35,722 [INFO]: There are 1915 embeddings of dim 49152
2025-03-13 15:05:35,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:05:35,723 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:35
2025-03-13 15:05:35,723 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:35,723 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:05:35,723 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:35,723 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:05:35,724 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:35
2025-03-13 15:05:35,724 [INFO]: 395.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:35,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:05:35,724 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:35
2025-03-13 15:05:35,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:35,725 [INFO]: 	Creating the index 03/13/2025, 15:05:35
2025-03-13 15:05:35,725 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:35
2025-03-13 15:05:35,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:05:35,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:35
2025-03-13 15:05:35,728 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:05:35,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.37it/s] 25%|██▌       | 2/8 [00:00<00:00,  8.06it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.08it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.99it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]100%|██████████| 8/8 [00:02<00:00,  3.78it/s]
2025-03-13 15:05:37,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:37
2025-03-13 15:06:05,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9742 secs
2025-03-13 15:06:05,823 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 15:06:05,823 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 15:06:26,244 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4217 secs
2025-03-13 15:06:26,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5187 secs
2025-03-13 15:06:26,247 [INFO]: {
2025-03-13 15:06:26,247 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:26,247 [INFO]: 	index_param: efSearch=267
2025-03-13 15:06:26,247 [INFO]: 	index_path: knn.index
2025-03-13 15:06:26,247 [INFO]: 	size in bytes: 376764850
2025-03-13 15:06:26,247 [INFO]: 	avg_search_speed_ms: 10.300062228249335
2025-03-13 15:06:26,247 [INFO]: 	99p_search_speed_ms: 20.02598037943243
2025-03-13 15:06:26,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:26,247 [INFO]: 	nb vectors: 1915
2025-03-13 15:06:26,247 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:26,247 [INFO]: 	compression ratio: 0.9993085076805864
2025-03-13 15:06:26,247 [INFO]: }
2025-03-13 15:06:26,247 [INFO]: 	>>> Finished "Creating the index" in 50.5223 secs
2025-03-13 15:06:26,247 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5528 secs
2025-03-13 15:06:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 3259 [episode count 11/20]
[retrieval_preprocessing] for episode 36048 [episode count 12/20], we have num_retrieval=np.int64(1797) num_query=np.int64(185)
2025-03-13 15:06:28,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:28,858 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:28
2025-03-13 15:06:28,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.70it/s]
2025-03-13 15:06:28,889 [INFO]: There are 1797 embeddings of dim 49152
2025-03-13 15:06:28,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 15:06:28,889 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:28
2025-03-13 15:06:28,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:28,889 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:06:28,889 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:28,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:28,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:28
2025-03-13 15:06:28,889 [INFO]: 370.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:28,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:06:28,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:28
2025-03-13 15:06:28,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:28,889 [INFO]: 	Creating the index 03/13/2025, 15:06:28
2025-03-13 15:06:28,890 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:28
2025-03-13 15:06:28,891 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:06:28,891 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:28
2025-03-13 15:06:28,891 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:06:28,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.99it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.80it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.19it/s] 50%|█████     | 4/8 [00:00<00:00,  7.48it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.55it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.63it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.73it/s]100%|██████████| 8/8 [00:02<00:00,  1.88it/s]100%|██████████| 8/8 [00:02<00:00,  3.43it/s]
2025-03-13 15:06:31,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:31
2025-03-13 15:06:55,765 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5358 secs
2025-03-13 15:06:55,765 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 15:06:55,765 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 15:07:19,630 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8647 secs
2025-03-13 15:07:19,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7405 secs
2025-03-13 15:07:19,632 [INFO]: {
2025-03-13 15:07:19,632 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:19,632 [INFO]: 	index_param: efSearch=344
2025-03-13 15:07:19,632 [INFO]: 	index_path: knn.index
2025-03-13 15:07:19,632 [INFO]: 	size in bytes: 353548990
2025-03-13 15:07:19,632 [INFO]: 	avg_search_speed_ms: 14.199513280552559
2025-03-13 15:07:19,632 [INFO]: 	99p_search_speed_ms: 24.72178967902437
2025-03-13 15:07:19,632 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:19,632 [INFO]: 	nb vectors: 1797
2025-03-13 15:07:19,632 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:19,632 [INFO]: 	compression ratio: 0.9993086842080924
2025-03-13 15:07:19,632 [INFO]: }
2025-03-13 15:07:19,632 [INFO]: 	>>> Finished "Creating the index" in 50.7430 secs
2025-03-13 15:07:19,633 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7749 secs
2025-03-13 15:07:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 36048 [episode count 12/20]
[retrieval_preprocessing] for episode 13531 [episode count 13/20], we have num_retrieval=np.int64(1863) num_query=np.int64(119)
2025-03-13 15:07:24,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:24,418 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:24
2025-03-13 15:07:24,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.23it/s]
2025-03-13 15:07:24,453 [INFO]: There are 1863 embeddings of dim 49152
2025-03-13 15:07:24,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 15:07:24,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:24
2025-03-13 15:07:24,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:24,454 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:07:24,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:24,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:07:24,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:24
2025-03-13 15:07:24,454 [INFO]: 384.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:24,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:07:24,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:24
2025-03-13 15:07:24,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:24,455 [INFO]: 	Creating the index 03/13/2025, 15:07:24
2025-03-13 15:07:24,455 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:24
2025-03-13 15:07:24,457 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 15:07:24,457 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:24
2025-03-13 15:07:24,457 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:07:24,457 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.56it/s] 25%|██▌       | 2/8 [00:00<00:01,  4.44it/s] 38%|███▊      | 3/8 [00:00<00:00,  5.29it/s] 50%|█████     | 4/8 [00:00<00:00,  6.03it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.49it/s]100%|██████████| 8/8 [00:02<00:00,  2.18it/s]100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
2025-03-13 15:07:27,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:27
2025-03-13 15:07:57,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0113 secs
2025-03-13 15:07:57,149 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 15:07:57,149 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 15:08:12,355 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2057 secs
2025-03-13 15:08:12,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8998 secs
2025-03-13 15:08:12,357 [INFO]: {
2025-03-13 15:08:12,357 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:12,357 [INFO]: 	index_param: efSearch=309
2025-03-13 15:08:12,357 [INFO]: 	index_path: knn.index
2025-03-13 15:08:12,357 [INFO]: 	size in bytes: 366534010
2025-03-13 15:08:12,357 [INFO]: 	avg_search_speed_ms: 11.669660455198434
2025-03-13 15:08:12,357 [INFO]: 	99p_search_speed_ms: 18.884328724816427
2025-03-13 15:08:12,357 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:12,357 [INFO]: 	nb vectors: 1863
2025-03-13 15:08:12,357 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:12,357 [INFO]: 	compression ratio: 0.9993089154264293
2025-03-13 15:08:12,357 [INFO]: }
2025-03-13 15:08:12,357 [INFO]: 	>>> Finished "Creating the index" in 47.9024 secs
2025-03-13 15:08:12,357 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9392 secs
2025-03-13 15:08:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 13531 [episode count 13/20]
[retrieval_preprocessing] for episode 79548 [episode count 14/20], we have num_retrieval=np.int64(1911) num_query=np.int64(71)
2025-03-13 15:08:14,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:14,613 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:14
2025-03-13 15:08:14,613 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2123.70it/s]
2025-03-13 15:08:14,635 [INFO]: There are 1911 embeddings of dim 49152
2025-03-13 15:08:14,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 15:08:14,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:14
2025-03-13 15:08:14,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:14,635 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:08:14,635 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:14,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:14,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:14
2025-03-13 15:08:14,636 [INFO]: 394.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:14,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:08:14,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:14
2025-03-13 15:08:14,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:14,636 [INFO]: 	Creating the index 03/13/2025, 15:08:14
2025-03-13 15:08:14,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:14
2025-03-13 15:08:14,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:08:14,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:14
2025-03-13 15:08:14,637 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:08:14,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.81it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.28it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.38it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.81it/s]100%|██████████| 8/8 [00:01<00:00,  4.40it/s]
2025-03-13 15:08:16,456 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:16
2025-03-13 15:08:40,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0901 secs
2025-03-13 15:08:40,547 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 15:08:40,547 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.14it/s] 50%|█████     | 2/4 [00:00<00:00,  4.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.44it/s]
2025-03-13 15:09:02,409 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8620 secs
2025-03-13 15:09:02,470 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8329 secs
2025-03-13 15:09:02,470 [INFO]: {
2025-03-13 15:09:02,470 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:02,470 [INFO]: 	index_param: efSearch=264
2025-03-13 15:09:02,470 [INFO]: 	index_path: knn.index
2025-03-13 15:09:02,470 [INFO]: 	size in bytes: 375977890
2025-03-13 15:09:02,470 [INFO]: 	avg_search_speed_ms: 9.74653960436176
2025-03-13 15:09:02,470 [INFO]: 	99p_search_speed_ms: 13.961780234239995
2025-03-13 15:09:02,470 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:02,471 [INFO]: 	nb vectors: 1911
2025-03-13 15:09:02,471 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:02,471 [INFO]: 	compression ratio: 0.9993084646546636
2025-03-13 15:09:02,471 [INFO]: }
2025-03-13 15:09:02,471 [INFO]: 	>>> Finished "Creating the index" in 47.8350 secs
2025-03-13 15:09:02,471 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8577 secs
2025-03-13 15:09:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 79548 [episode count 14/20]
[retrieval_preprocessing] for episode 62698 [episode count 15/20], we have num_retrieval=np.int64(1893) num_query=np.int64(89)
2025-03-13 15:09:04,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:04,830 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:04
2025-03-13 15:09:04,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1674.37it/s]
2025-03-13 15:09:04,856 [INFO]: There are 1893 embeddings of dim 49152
2025-03-13 15:09:04,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:09:04,857 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:04
2025-03-13 15:09:04,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:04,858 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:09:04,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:04,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 15:09:04,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:04
2025-03-13 15:09:04,859 [INFO]: 390.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:04,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:09:04,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:04
2025-03-13 15:09:04,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:04,860 [INFO]: 	Creating the index 03/13/2025, 15:09:04
2025-03-13 15:09:04,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:04
2025-03-13 15:09:04,864 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 15:09:04,864 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:04
2025-03-13 15:09:04,864 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:09:04,865 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.98it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.11it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.62it/s] 50%|█████     | 4/8 [00:00<00:00,  6.99it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.09it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.40it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.38it/s]100%|██████████| 8/8 [00:02<00:00,  1.85it/s]100%|██████████| 8/8 [00:02<00:00,  3.31it/s]
2025-03-13 15:09:07,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:07
2025-03-13 15:09:31,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7700 secs
2025-03-13 15:09:31,055 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:09:31,055 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-13 15:09:49,723 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6675 secs
2025-03-13 15:09:49,725 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8608 secs
2025-03-13 15:09:49,725 [INFO]: {
2025-03-13 15:09:49,725 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:49,725 [INFO]: 	index_param: efSearch=191
2025-03-13 15:09:49,725 [INFO]: 	index_path: knn.index
2025-03-13 15:09:49,725 [INFO]: 	size in bytes: 372436450
2025-03-13 15:09:49,725 [INFO]: 	avg_search_speed_ms: 10.598430611995125
2025-03-13 15:09:49,725 [INFO]: 	99p_search_speed_ms: 26.554964249953674
2025-03-13 15:09:49,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:49,725 [INFO]: 	nb vectors: 1893
2025-03-13 15:09:49,725 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:49,725 [INFO]: 	compression ratio: 0.999308590767633
2025-03-13 15:09:49,725 [INFO]: }
2025-03-13 15:09:49,725 [INFO]: 	>>> Finished "Creating the index" in 44.8654 secs
2025-03-13 15:09:49,725 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8958 secs
2025-03-13 15:09:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 62698 [episode count 15/20]
[retrieval_preprocessing] for episode 46982 [episode count 16/20], we have num_retrieval=np.int64(1880) num_query=np.int64(102)
2025-03-13 15:09:53,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:54,060 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:54
2025-03-13 15:09:54,060 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]
2025-03-13 15:09:54,087 [INFO]: There are 1880 embeddings of dim 49152
2025-03-13 15:09:54,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:09:54,088 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:54
2025-03-13 15:09:54,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:54,088 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:09:54,088 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:54,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:54,088 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:54
2025-03-13 15:09:54,088 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:54,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:54,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:54
2025-03-13 15:09:54,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:54,088 [INFO]: 	Creating the index 03/13/2025, 15:09:54
2025-03-13 15:09:54,088 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:54
2025-03-13 15:09:54,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:09:54,090 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:54
2025-03-13 15:09:54,090 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:09:54,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.84it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.95it/s] 50%|█████     | 4/8 [00:00<00:00,  6.91it/s] 62%|██████▎   | 5/8 [00:00<00:00,  5.92it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.94it/s]100%|██████████| 8/8 [00:02<00:00,  2.03it/s]100%|██████████| 8/8 [00:02<00:00,  3.20it/s]
2025-03-13 15:09:56,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:56
2025-03-13 15:10:20,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8987 secs
2025-03-13 15:10:20,493 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 15:10:20,493 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.09s/it] 50%|█████     | 2/4 [00:01<00:01,  1.36it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.76it/s]
2025-03-13 15:10:41,662 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1690 secs
2025-03-13 15:10:41,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5736 secs
2025-03-13 15:10:41,664 [INFO]: {
2025-03-13 15:10:41,664 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:41,664 [INFO]: 	index_param: efSearch=275
2025-03-13 15:10:41,664 [INFO]: 	index_path: knn.index
2025-03-13 15:10:41,664 [INFO]: 	size in bytes: 369878770
2025-03-13 15:10:41,664 [INFO]: 	avg_search_speed_ms: 10.103517289583882
2025-03-13 15:10:41,664 [INFO]: 	99p_search_speed_ms: 17.369921756908298
2025-03-13 15:10:41,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:41,664 [INFO]: 	nb vectors: 1880
2025-03-13 15:10:41,664 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:41,664 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-13 15:10:41,664 [INFO]: }
2025-03-13 15:10:41,664 [INFO]: 	>>> Finished "Creating the index" in 47.5758 secs
2025-03-13 15:10:41,664 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6038 secs
2025-03-13 15:10:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 46982 [episode count 16/20]
[retrieval_preprocessing] for episode 57228 [episode count 17/20], we have num_retrieval=np.int64(1910) num_query=np.int64(72)
2025-03-13 15:10:43,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:44,199 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:44
2025-03-13 15:10:44,199 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-13 15:10:44,222 [INFO]: There are 1910 embeddings of dim 49152
2025-03-13 15:10:44,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 15:10:44,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:44
2025-03-13 15:10:44,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:44,223 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:10:44,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:44,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:44,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:44
2025-03-13 15:10:44,223 [INFO]: 394.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:44,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:10:44,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:44
2025-03-13 15:10:44,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:44,223 [INFO]: 	Creating the index 03/13/2025, 15:10:44
2025-03-13 15:10:44,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:44
2025-03-13 15:10:44,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:10:44,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:44
2025-03-13 15:10:44,224 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:10:44,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.07it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.13it/s] 50%|█████     | 4/8 [00:00<00:00,  9.02it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.88it/s]100%|██████████| 8/8 [00:01<00:00,  3.08it/s]100%|██████████| 8/8 [00:01<00:00,  4.05it/s]
2025-03-13 15:10:46,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:46
2025-03-13 15:11:12,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8524 secs
2025-03-13 15:11:12,056 [INFO]: The best hyperparameters are: efSearch=339
2025-03-13 15:11:12,056 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.28it/s] 50%|█████     | 2/4 [00:00<00:00,  4.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s]
2025-03-13 15:11:29,997 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9410 secs
2025-03-13 15:11:29,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7750 secs
2025-03-13 15:11:29,999 [INFO]: {
2025-03-13 15:11:29,999 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:29,999 [INFO]: 	index_param: efSearch=339
2025-03-13 15:11:30,000 [INFO]: 	index_path: knn.index
2025-03-13 15:11:30,000 [INFO]: 	size in bytes: 375781150
2025-03-13 15:11:30,000 [INFO]: 	avg_search_speed_ms: 12.506979406462051
2025-03-13 15:11:30,000 [INFO]: 	99p_search_speed_ms: 17.075935837347057
2025-03-13 15:11:30,000 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:30,000 [INFO]: 	nb vectors: 1910
2025-03-13 15:11:30,000 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:30,000 [INFO]: 	compression ratio: 0.9993084538700251
2025-03-13 15:11:30,000 [INFO]: }
2025-03-13 15:11:30,000 [INFO]: 	>>> Finished "Creating the index" in 45.7765 secs
2025-03-13 15:11:30,000 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8007 secs
2025-03-13 15:11:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 57228 [episode count 17/20]
[retrieval_preprocessing] for episode 26519 [episode count 18/20], we have num_retrieval=np.int64(1847) num_query=np.int64(135)
2025-03-13 15:11:31,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:31,811 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:31
2025-03-13 15:11:31,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 922.03it/s]
2025-03-13 15:11:31,839 [INFO]: There are 1847 embeddings of dim 49152
2025-03-13 15:11:31,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:11:31,839 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:31
2025-03-13 15:11:31,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:31,840 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:11:31,840 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:31,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:11:31,840 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:31
2025-03-13 15:11:31,840 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:31,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:11:31,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:31
2025-03-13 15:11:31,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:31,841 [INFO]: 	Creating the index 03/13/2025, 15:11:31
2025-03-13 15:11:31,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:31
2025-03-13 15:11:31,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:11:31,845 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:31
2025-03-13 15:11:31,845 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:11:31,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  3.77it/s] 25%|██▌       | 2/8 [00:00<00:01,  5.70it/s] 50%|█████     | 4/8 [00:00<00:00,  7.13it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.77it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.28it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.78it/s]100%|██████████| 8/8 [00:02<00:00,  1.99it/s]100%|██████████| 8/8 [00:02<00:00,  3.38it/s]
2025-03-13 15:11:34,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:34
2025-03-13 15:12:01,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7982 secs
2025-03-13 15:12:01,015 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 15:12:01,016 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 15:12:16,799 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7828 secs
2025-03-13 15:12:16,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9550 secs
2025-03-13 15:12:16,800 [INFO]: {
2025-03-13 15:12:16,800 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:16,800 [INFO]: 	index_param: efSearch=279
2025-03-13 15:12:16,800 [INFO]: 	index_path: knn.index
2025-03-13 15:12:16,800 [INFO]: 	size in bytes: 363385990
2025-03-13 15:12:16,800 [INFO]: 	avg_search_speed_ms: 10.118449001579618
2025-03-13 15:12:16,800 [INFO]: 	99p_search_speed_ms: 13.82502207532525
2025-03-13 15:12:16,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:16,800 [INFO]: 	nb vectors: 1847
2025-03-13 15:12:16,800 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:16,801 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-13 15:12:16,801 [INFO]: }
2025-03-13 15:12:16,801 [INFO]: 	>>> Finished "Creating the index" in 44.9590 secs
2025-03-13 15:12:16,801 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9891 secs
2025-03-13 15:12:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 26519 [episode count 18/20]
[retrieval_preprocessing] for episode 92141 [episode count 19/20], we have num_retrieval=np.int64(1889) num_query=np.int64(93)
2025-03-13 15:12:21,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:21,492 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:21
2025-03-13 15:12:21,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.28it/s]
2025-03-13 15:12:21,516 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 15:12:21,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:12:21,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:21,516 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:12:21,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:21,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:21,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,516 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:21,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:12:21,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:21
2025-03-13 15:12:21,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:21,516 [INFO]: 	Creating the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:21
2025-03-13 15:12:21,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:12:21,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,517 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:12:21,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.95it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.36it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.96it/s] 88%|████████▊ | 7/8 [00:00<00:00, 12.68it/s]100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
2025-03-13 15:12:23,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:23
2025-03-13 15:12:46,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.2220 secs
2025-03-13 15:12:46,494 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 15:12:46,494 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 15:13:03,688 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1937 secs
2025-03-13 15:13:03,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1724 secs
2025-03-13 15:13:03,690 [INFO]: {
2025-03-13 15:13:03,690 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:03,690 [INFO]: 	index_param: efSearch=233
2025-03-13 15:13:03,690 [INFO]: 	index_path: knn.index
2025-03-13 15:13:03,690 [INFO]: 	size in bytes: 371649490
2025-03-13 15:13:03,690 [INFO]: 	avg_search_speed_ms: 9.84493921708873
2025-03-13 15:13:03,690 [INFO]: 	99p_search_speed_ms: 14.163434016518302
2025-03-13 15:13:03,690 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:03,690 [INFO]: 	nb vectors: 1889
2025-03-13 15:13:03,690 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:03,690 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 15:13:03,690 [INFO]: }
2025-03-13 15:13:03,690 [INFO]: 	>>> Finished "Creating the index" in 42.1737 secs
2025-03-13 15:13:03,690 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1977 secs
2025-03-13 15:13:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 92141 [episode count 19/20]
2025-03-13 15:13:04: [retrieval_preprocessing] finished for 5235850418_close_drawer_generic [chosen_id count 0/196]
2025-03-13 15:13:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_close_upper_drawer_generic [chosen_id count 1/196]
2025-03-13 15:13:06: [retrieval_preprocessing] we have num_total=2173 embedding_dim=49152
[retrieval_preprocessing] for episode 55330 [episode count 0/20], we have num_retrieval=np.int64(2072) num_query=np.int64(101)
2025-03-13 15:13:07,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:07,757 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:07
2025-03-13 15:13:07,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2298.25it/s]
2025-03-13 15:13:07,779 [INFO]: There are 2072 embeddings of dim 49152
2025-03-13 15:13:07,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 15:13:07,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:07
2025-03-13 15:13:07,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:07,779 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:13:07,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:07,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:07,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:07
2025-03-13 15:13:07,779 [INFO]: 427.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:07,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:13:07,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:07
2025-03-13 15:13:07,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:07,779 [INFO]: 	Creating the index 03/13/2025, 15:13:07
2025-03-13 15:13:07,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:07
2025-03-13 15:13:07,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:13:07,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:07
2025-03-13 15:13:07,781 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:13:07,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.79it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.91it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.09it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.40it/s]100%|██████████| 9/9 [00:01<00:00,  3.59it/s]100%|██████████| 9/9 [00:01<00:00,  4.90it/s]
2025-03-13 15:13:09,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:09
2025-03-13 15:13:35,557 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9378 secs
2025-03-13 15:13:35,558 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 15:13:35,558 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 15:13:55,573 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0152 secs
2025-03-13 15:13:55,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7947 secs
2025-03-13 15:13:55,575 [INFO]: {
2025-03-13 15:13:55,575 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:55,575 [INFO]: 	index_param: efSearch=261
2025-03-13 15:13:55,575 [INFO]: 	index_path: knn.index
2025-03-13 15:13:55,575 [INFO]: 	size in bytes: 407653450
2025-03-13 15:13:55,575 [INFO]: 	avg_search_speed_ms: 9.421846192965633
2025-03-13 15:13:55,575 [INFO]: 	99p_search_speed_ms: 14.583096140995623
2025-03-13 15:13:55,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:55,575 [INFO]: 	nb vectors: 2072
2025-03-13 15:13:55,575 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:55,575 [INFO]: 	compression ratio: 0.9993090356527095
2025-03-13 15:13:55,576 [INFO]: }
2025-03-13 15:13:55,576 [INFO]: 	>>> Finished "Creating the index" in 47.7960 secs
2025-03-13 15:13:55,576 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8182 secs
2025-03-13 15:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 55330 [episode count 0/20]
[retrieval_preprocessing] for episode 14371 [episode count 1/20], we have num_retrieval=np.int64(2092) num_query=np.int64(81)
2025-03-13 15:13:57,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:57,704 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:57
2025-03-13 15:13:57,704 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1878.33it/s]
2025-03-13 15:13:57,729 [INFO]: There are 2092 embeddings of dim 49152
2025-03-13 15:13:57,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:13:57,730 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:57
2025-03-13 15:13:57,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:57,730 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:13:57,730 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:57,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:13:57,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:57
2025-03-13 15:13:57,731 [INFO]: 431.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:57,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:13:57,731 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:57
2025-03-13 15:13:57,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:57,731 [INFO]: 	Creating the index 03/13/2025, 15:13:57
2025-03-13 15:13:57,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:57
2025-03-13 15:13:57,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:13:57,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:57
2025-03-13 15:13:57,735 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:13:57,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.41it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.70it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.83it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.37it/s]100%|██████████| 9/9 [00:02<00:00,  3.08it/s]100%|██████████| 9/9 [00:02<00:00,  4.25it/s]
2025-03-13 15:13:59,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:59
2025-03-13 15:14:25,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3510 secs
2025-03-13 15:14:25,210 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 15:14:25,210 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.26it/s] 50%|█████     | 2/4 [00:00<00:00,  4.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.31it/s]
2025-03-13 15:14:45,743 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5335 secs
2025-03-13 15:14:45,746 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0104 secs
2025-03-13 15:14:45,746 [INFO]: {
2025-03-13 15:14:45,746 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:45,746 [INFO]: 	index_param: efSearch=257
2025-03-13 15:14:45,746 [INFO]: 	index_path: knn.index
2025-03-13 15:14:45,746 [INFO]: 	size in bytes: 411588310
2025-03-13 15:14:45,746 [INFO]: 	avg_search_speed_ms: 10.249555201582671
2025-03-13 15:14:45,746 [INFO]: 	99p_search_speed_ms: 18.248979351483285
2025-03-13 15:14:45,746 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:45,746 [INFO]: 	nb vectors: 2092
2025-03-13 15:14:45,746 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:45,746 [INFO]: 	compression ratio: 0.9993090814459721
2025-03-13 15:14:45,746 [INFO]: }
2025-03-13 15:14:45,746 [INFO]: 	>>> Finished "Creating the index" in 48.0144 secs
2025-03-13 15:14:45,746 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0421 secs
2025-03-13 15:14:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 14371 [episode count 1/20]
[retrieval_preprocessing] for episode 45164 [episode count 2/20], we have num_retrieval=np.int64(1857) num_query=np.int64(316)
2025-03-13 15:14:47,364 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:47,796 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:47
2025-03-13 15:14:47,796 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 7423.55it/s]
2025-03-13 15:14:48,464 [INFO]: There are 1857 embeddings of dim 49152
2025-03-13 15:14:48,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6677 secs
2025-03-13 15:14:48,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:48
2025-03-13 15:14:48,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:48,464 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 15:14:48,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:48,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:14:48,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:48
2025-03-13 15:14:48,465 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:48,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:14:48,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:48
2025-03-13 15:14:48,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:48,465 [INFO]: 	Creating the index 03/13/2025, 15:14:48
2025-03-13 15:14:48,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:48
2025-03-13 15:14:48,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:14:48,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:48
2025-03-13 15:14:48,468 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:14:48,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:02,  3.21it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.52it/s] 50%|█████     | 4/8 [00:00<00:00,  6.74it/s] 62%|██████▎   | 5/8 [00:00<00:00,  6.88it/s] 75%|███████▌  | 6/8 [00:00<00:00,  6.88it/s] 88%|████████▊ | 7/8 [00:01<00:00,  6.86it/s]100%|██████████| 8/8 [00:02<00:00,  1.81it/s]100%|██████████| 8/8 [00:02<00:00,  3.15it/s]
2025-03-13 15:14:51,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:51
2025-03-13 15:15:16,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2795 secs
2025-03-13 15:15:16,293 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 15:15:16,293 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.40it/s]
2025-03-13 15:15:31,871 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5781 secs
2025-03-13 15:15:31,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4059 secs
2025-03-13 15:15:31,874 [INFO]: {
2025-03-13 15:15:31,874 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:31,874 [INFO]: 	index_param: efSearch=315
2025-03-13 15:15:31,874 [INFO]: 	index_path: knn.index
2025-03-13 15:15:31,874 [INFO]: 	size in bytes: 365353510
2025-03-13 15:15:31,874 [INFO]: 	avg_search_speed_ms: 14.366353399337045
2025-03-13 15:15:31,874 [INFO]: 	99p_search_speed_ms: 31.269904237706214
2025-03-13 15:15:31,874 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:31,874 [INFO]: 	nb vectors: 1857
2025-03-13 15:15:31,874 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:31,874 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-13 15:15:31,874 [INFO]: }
2025-03-13 15:15:31,874 [INFO]: 	>>> Finished "Creating the index" in 43.4092 secs
2025-03-13 15:15:31,874 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0778 secs
2025-03-13 15:15:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 45164 [episode count 2/20]
[retrieval_preprocessing] for episode 63601 [episode count 3/20], we have num_retrieval=np.int64(2074) num_query=np.int64(99)
2025-03-13 15:15:35,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:36,250 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:36
2025-03-13 15:15:36,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 963.32it/s]
2025-03-13 15:15:36,276 [INFO]: There are 2074 embeddings of dim 49152
2025-03-13 15:15:36,276 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:15:36,276 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:36
2025-03-13 15:15:36,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:36,276 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:15:36,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:36,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:36,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:36
2025-03-13 15:15:36,276 [INFO]: 428.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:36,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:15:36,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:36
2025-03-13 15:15:36,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:36,276 [INFO]: 	Creating the index 03/13/2025, 15:15:36
2025-03-13 15:15:36,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:36
2025-03-13 15:15:36,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:15:36,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:36
2025-03-13 15:15:36,277 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:15:36,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.42it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.65it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.46it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.33it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.10it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.95it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.03it/s]100%|██████████| 9/9 [00:02<00:00,  1.88it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 15:15:38,651 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:38
2025-03-13 15:16:11,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8459 secs
2025-03-13 15:16:11,497 [INFO]: The best hyperparameters are: efSearch=306
2025-03-13 15:16:11,497 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 15:16:26,489 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9914 secs
2025-03-13 15:16:26,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2135 secs
2025-03-13 15:16:26,491 [INFO]: {
2025-03-13 15:16:26,491 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:26,491 [INFO]: 	index_param: efSearch=306
2025-03-13 15:16:26,491 [INFO]: 	index_path: knn.index
2025-03-13 15:16:26,491 [INFO]: 	size in bytes: 408046930
2025-03-13 15:16:26,491 [INFO]: 	avg_search_speed_ms: 10.137086362873319
2025-03-13 15:16:26,491 [INFO]: 	99p_search_speed_ms: 14.007735089398917
2025-03-13 15:16:26,491 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:26,491 [INFO]: 	nb vectors: 2074
2025-03-13 15:16:26,491 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:26,491 [INFO]: 	compression ratio: 0.9993090549658099
2025-03-13 15:16:26,491 [INFO]: }
2025-03-13 15:16:26,491 [INFO]: 	>>> Finished "Creating the index" in 50.2148 secs
2025-03-13 15:16:26,491 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2414 secs
2025-03-13 15:16:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 63601 [episode count 3/20]
[retrieval_preprocessing] for episode 34989 [episode count 4/20], we have num_retrieval=np.int64(2055) num_query=np.int64(118)
2025-03-13 15:16:28,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:28,653 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:28
2025-03-13 15:16:28,654 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1669.04it/s]
2025-03-13 15:16:28,679 [INFO]: There are 2055 embeddings of dim 49152
2025-03-13 15:16:28,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:16:28,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:28
2025-03-13 15:16:28,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:28,680 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:16:28,680 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:28,680 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:16:28,680 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:28
2025-03-13 15:16:28,680 [INFO]: 424.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:28,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:16:28,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:28
2025-03-13 15:16:28,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:28,681 [INFO]: 	Creating the index 03/13/2025, 15:16:28
2025-03-13 15:16:28,681 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:28
2025-03-13 15:16:28,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:16:28,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:28
2025-03-13 15:16:28,684 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:16:28,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.69it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.64it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.40it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.72it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]100%|██████████| 9/9 [00:02<00:00,  4.41it/s]
2025-03-13 15:16:30,732 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:30
2025-03-13 15:16:54,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3723 secs
2025-03-13 15:16:54,105 [INFO]: The best hyperparameters are: efSearch=330
2025-03-13 15:16:54,105 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.09it/s] 50%|█████     | 2/4 [00:00<00:00,  4.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.26it/s]
2025-03-13 15:17:19,107 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0014 secs
2025-03-13 15:17:19,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4246 secs
2025-03-13 15:17:19,109 [INFO]: {
2025-03-13 15:17:19,109 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:19,109 [INFO]: 	index_param: efSearch=330
2025-03-13 15:17:19,109 [INFO]: 	index_path: knn.index
2025-03-13 15:17:19,109 [INFO]: 	size in bytes: 404308870
2025-03-13 15:17:19,109 [INFO]: 	avg_search_speed_ms: 10.202732630672731
2025-03-13 15:17:19,109 [INFO]: 	99p_search_speed_ms: 15.795951457694178
2025-03-13 15:17:19,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:19,109 [INFO]: 	nb vectors: 2055
2025-03-13 15:17:19,109 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:19,109 [INFO]: 	compression ratio: 0.9993088699735923
2025-03-13 15:17:19,109 [INFO]: }
2025-03-13 15:17:19,109 [INFO]: 	>>> Finished "Creating the index" in 50.4283 secs
2025-03-13 15:17:19,109 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4556 secs
2025-03-13 15:17:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 34989 [episode count 4/20]
[retrieval_preprocessing] for episode 33183 [episode count 5/20], we have num_retrieval=np.int64(2095) num_query=np.int64(78)
2025-03-13 15:17:21,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:21,874 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:21
2025-03-13 15:17:21,875 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.32it/s]
2025-03-13 15:17:21,898 [INFO]: There are 2095 embeddings of dim 49152
2025-03-13 15:17:21,898 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 15:17:21,898 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,898 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:21,898 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:17:21,898 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:21,898 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:17:21,898 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,898 [INFO]: 432.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:21,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:17:21,898 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:21
2025-03-13 15:17:21,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:21,898 [INFO]: 	Creating the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,898 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:21
2025-03-13 15:17:21,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:17:21,900 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:21
2025-03-13 15:17:21,900 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:17:21,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.32it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.59it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.98it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.31it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.42it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.54it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.71it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]
2025-03-13 15:17:24,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:24
2025-03-13 15:17:56,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9935 secs
2025-03-13 15:17:56,447 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:17:56,447 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.70it/s]
2025-03-13 15:18:18,555 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1084 secs
2025-03-13 15:18:18,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6576 secs
2025-03-13 15:18:18,557 [INFO]: {
2025-03-13 15:18:18,557 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:18,557 [INFO]: 	index_param: efSearch=265
2025-03-13 15:18:18,557 [INFO]: 	index_path: knn.index
2025-03-13 15:18:18,557 [INFO]: 	size in bytes: 412178530
2025-03-13 15:18:18,557 [INFO]: 	avg_search_speed_ms: 8.753982736507265
2025-03-13 15:18:18,557 [INFO]: 	99p_search_speed_ms: 15.341503687668581
2025-03-13 15:18:18,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:18,558 [INFO]: 	nb vectors: 2095
2025-03-13 15:18:18,558 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:18,558 [INFO]: 	compression ratio: 0.9993091100596627
2025-03-13 15:18:18,558 [INFO]: }
2025-03-13 15:18:18,558 [INFO]: 	>>> Finished "Creating the index" in 56.6592 secs
2025-03-13 15:18:18,558 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6831 secs
2025-03-13 15:18:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 33183 [episode count 5/20]
[retrieval_preprocessing] for episode 6426 [episode count 6/20], we have num_retrieval=np.int64(2075) num_query=np.int64(98)
2025-03-13 15:18:20,030 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:20,365 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:20
2025-03-13 15:18:20,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 962.00it/s]
2025-03-13 15:18:20,390 [INFO]: There are 2075 embeddings of dim 49152
2025-03-13 15:18:20,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:18:20,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:20
2025-03-13 15:18:20,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:20,391 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:18:20,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:20,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:18:20,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:20
2025-03-13 15:18:20,391 [INFO]: 428.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:20,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:18:20,391 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:20
2025-03-13 15:18:20,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:20,391 [INFO]: 	Creating the index 03/13/2025, 15:18:20
2025-03-13 15:18:20,391 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:20
2025-03-13 15:18:20,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:18:20,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:20
2025-03-13 15:18:20,393 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:18:20,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.70it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.79it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.13it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.30it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.32it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.45it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.62it/s]100%|██████████| 9/9 [00:02<00:00,  1.87it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]
2025-03-13 15:18:22,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:22
2025-03-13 15:18:47,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5354 secs
2025-03-13 15:18:47,474 [INFO]: The best hyperparameters are: efSearch=372
2025-03-13 15:18:47,474 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 15:19:09,007 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5327 secs
2025-03-13 15:19:09,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6164 secs
2025-03-13 15:19:09,010 [INFO]: {
2025-03-13 15:19:09,010 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:09,010 [INFO]: 	index_param: efSearch=372
2025-03-13 15:19:09,010 [INFO]: 	index_path: knn.index
2025-03-13 15:19:09,010 [INFO]: 	size in bytes: 408243670
2025-03-13 15:19:09,010 [INFO]: 	avg_search_speed_ms: 12.607544683176005
2025-03-13 15:19:09,010 [INFO]: 	99p_search_speed_ms: 19.132915548980236
2025-03-13 15:19:09,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:09,010 [INFO]: 	nb vectors: 2075
2025-03-13 15:19:09,010 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:09,010 [INFO]: 	compression ratio: 0.9993090646083992
2025-03-13 15:19:09,010 [INFO]: }
2025-03-13 15:19:09,010 [INFO]: 	>>> Finished "Creating the index" in 48.6186 secs
2025-03-13 15:19:09,010 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6447 secs
2025-03-13 15:19:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 6426 [episode count 6/20]
[retrieval_preprocessing] for episode 35144 [episode count 7/20], we have num_retrieval=np.int64(2003) num_query=np.int64(170)
2025-03-13 15:19:11,560 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:11,873 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:11
2025-03-13 15:19:11,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2062.10it/s]
2025-03-13 15:19:11,896 [INFO]: There are 2003 embeddings of dim 49152
2025-03-13 15:19:11,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 15:19:11,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:11,896 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:19:11,896 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:11,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:11,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,896 [INFO]: 413.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:11,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:19:11,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:11
2025-03-13 15:19:11,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:11,896 [INFO]: 	Creating the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,896 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:11
2025-03-13 15:19:11,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:19:11,897 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,897 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:19:11,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.47it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.47it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.54it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.84it/s]100%|██████████| 8/8 [00:01<00:00,  4.30it/s]
2025-03-13 15:19:14,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:14
2025-03-13 15:19:45,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3066 secs
2025-03-13 15:19:45,948 [INFO]: The best hyperparameters are: efSearch=327
2025-03-13 15:19:45,948 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.34s/it] 50%|█████     | 2/4 [00:04<00:04,  2.06s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.22s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.60s/it]
2025-03-13 15:20:09,808 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8596 secs
2025-03-13 15:20:09,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9129 secs
2025-03-13 15:20:09,811 [INFO]: {
2025-03-13 15:20:09,811 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:09,811 [INFO]: 	index_param: efSearch=327
2025-03-13 15:20:09,811 [INFO]: 	index_path: knn.index
2025-03-13 15:20:09,811 [INFO]: 	size in bytes: 394078150
2025-03-13 15:20:09,811 [INFO]: 	avg_search_speed_ms: 13.055476373397106
2025-03-13 15:20:09,811 [INFO]: 	99p_search_speed_ms: 24.108811526093632
2025-03-13 15:20:09,811 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:09,811 [INFO]: 	nb vectors: 2003
2025-03-13 15:20:09,811 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:09,811 [INFO]: 	compression ratio: 0.9993089543279677
2025-03-13 15:20:09,811 [INFO]: }
2025-03-13 15:20:09,811 [INFO]: 	>>> Finished "Creating the index" in 57.9145 secs
2025-03-13 15:20:09,811 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9379 secs
2025-03-13 15:20:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 35144 [episode count 7/20]
[retrieval_preprocessing] for episode 53909 [episode count 8/20], we have num_retrieval=np.int64(2040) num_query=np.int64(133)
2025-03-13 15:20:12,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:13,461 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:13
2025-03-13 15:20:13,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2128.01it/s]
2025-03-13 15:20:13,484 [INFO]: There are 2040 embeddings of dim 49152
2025-03-13 15:20:13,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:20:13,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:13
2025-03-13 15:20:13,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:13,485 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:20:13,485 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:13,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:13,485 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:13
2025-03-13 15:20:13,485 [INFO]: 421.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:13,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:20:13,485 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:13
2025-03-13 15:20:13,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:13,485 [INFO]: 	Creating the index 03/13/2025, 15:20:13
2025-03-13 15:20:13,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:13
2025-03-13 15:20:13,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:20:13,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:13
2025-03-13 15:20:13,486 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:20:13,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.80it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.53it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.82it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.89it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.01it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.02it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.07it/s]100%|██████████| 9/9 [00:02<00:00,  1.56it/s]100%|██████████| 9/9 [00:02<00:00,  3.08it/s]
2025-03-13 15:20:16,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:16
2025-03-13 15:20:42,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9490 secs
2025-03-13 15:20:42,359 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 15:20:42,359 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 15:21:06,578 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2196 secs
2025-03-13 15:21:06,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0944 secs
2025-03-13 15:21:06,581 [INFO]: {
2025-03-13 15:21:06,581 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:06,581 [INFO]: 	index_param: efSearch=294
2025-03-13 15:21:06,581 [INFO]: 	index_path: knn.index
2025-03-13 15:21:06,581 [INFO]: 	size in bytes: 401357770
2025-03-13 15:21:06,581 [INFO]: 	avg_search_speed_ms: 9.491408954637807
2025-03-13 15:21:06,581 [INFO]: 	99p_search_speed_ms: 12.911673875059932
2025-03-13 15:21:06,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:06,581 [INFO]: 	nb vectors: 2040
2025-03-13 15:21:06,581 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:06,581 [INFO]: 	compression ratio: 0.999308721493046
2025-03-13 15:21:06,581 [INFO]: }
2025-03-13 15:21:06,581 [INFO]: 	>>> Finished "Creating the index" in 53.0957 secs
2025-03-13 15:21:06,581 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1197 secs
2025-03-13 15:21:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 53909 [episode count 8/20]
[retrieval_preprocessing] for episode 8960 [episode count 9/20], we have num_retrieval=np.int64(2104) num_query=np.int64(69)
2025-03-13 15:21:09,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:09,963 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:09
2025-03-13 15:21:09,963 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2313.46it/s]
2025-03-13 15:21:09,984 [INFO]: There are 2104 embeddings of dim 49152
2025-03-13 15:21:09,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0212 secs
2025-03-13 15:21:09,984 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:09
2025-03-13 15:21:09,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:09,984 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:21:09,984 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:09,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:09,984 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:09
2025-03-13 15:21:09,984 [INFO]: 434.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:09,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:21:09,984 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:09
2025-03-13 15:21:09,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:09,984 [INFO]: 	Creating the index 03/13/2025, 15:21:09
2025-03-13 15:21:09,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:09
2025-03-13 15:21:09,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:21:09,985 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:09
2025-03-13 15:21:09,985 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:21:09,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.16it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.70it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.49it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.19it/s]100%|██████████| 9/9 [00:02<00:00,  2.73it/s]100%|██████████| 9/9 [00:02<00:00,  3.84it/s]
2025-03-13 15:21:12,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:12
2025-03-13 15:21:45,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3958 secs
2025-03-13 15:21:45,729 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 15:21:45,729 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.04it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.61it/s]
2025-03-13 15:22:07,422 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6930 secs
2025-03-13 15:22:07,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4388 secs
2025-03-13 15:22:07,424 [INFO]: {
2025-03-13 15:22:07,424 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:07,424 [INFO]: 	index_param: efSearch=240
2025-03-13 15:22:07,424 [INFO]: 	index_path: knn.index
2025-03-13 15:22:07,424 [INFO]: 	size in bytes: 413949250
2025-03-13 15:22:07,424 [INFO]: 	avg_search_speed_ms: 8.427393593445332
2025-03-13 15:22:07,424 [INFO]: 	99p_search_speed_ms: 14.174076099880043
2025-03-13 15:22:07,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:07,424 [INFO]: 	nb vectors: 2104
2025-03-13 15:22:07,424 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:07,424 [INFO]: 	compression ratio: 0.9993090505659812
2025-03-13 15:22:07,424 [INFO]: }
2025-03-13 15:22:07,424 [INFO]: 	>>> Finished "Creating the index" in 57.4400 secs
2025-03-13 15:22:07,424 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4618 secs
2025-03-13 15:22:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 8960 [episode count 9/20]
[retrieval_preprocessing] for episode 56529 [episode count 10/20], we have num_retrieval=np.int64(2083) num_query=np.int64(90)
2025-03-13 15:22:08,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:09,039 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:09
2025-03-13 15:22:09,039 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1229.28it/s]
2025-03-13 15:22:09,067 [INFO]: There are 2083 embeddings of dim 49152
2025-03-13 15:22:09,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 15:22:09,068 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:09
2025-03-13 15:22:09,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:09,068 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:22:09,068 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:09,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:22:09,069 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:09
2025-03-13 15:22:09,069 [INFO]: 429.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:09,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:22:09,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:09
2025-03-13 15:22:09,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:09,069 [INFO]: 	Creating the index 03/13/2025, 15:22:09
2025-03-13 15:22:09,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:09
2025-03-13 15:22:09,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:22:09,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:09
2025-03-13 15:22:09,073 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:22:09,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.77it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.83it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.84it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.25it/s]100%|██████████| 9/9 [00:02<00:00,  3.19it/s]100%|██████████| 9/9 [00:02<00:00,  4.45it/s]
2025-03-13 15:22:11,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:11
2025-03-13 15:22:41,412 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3107 secs
2025-03-13 15:22:41,413 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 15:22:41,413 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-13 15:23:04,033 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6202 secs
2025-03-13 15:23:04,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9625 secs
2025-03-13 15:23:04,035 [INFO]: {
2025-03-13 15:23:04,036 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:04,036 [INFO]: 	index_param: efSearch=291
2025-03-13 15:23:04,036 [INFO]: 	index_path: knn.index
2025-03-13 15:23:04,036 [INFO]: 	size in bytes: 409817650
2025-03-13 15:23:04,036 [INFO]: 	avg_search_speed_ms: 8.872491563319128
2025-03-13 15:23:04,036 [INFO]: 	99p_search_speed_ms: 14.031289923004813
2025-03-13 15:23:04,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:04,036 [INFO]: 	nb vectors: 2083
2025-03-13 15:23:04,036 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:04,036 [INFO]: 	compression ratio: 0.9993089951103863
2025-03-13 15:23:04,036 [INFO]: }
2025-03-13 15:23:04,036 [INFO]: 	>>> Finished "Creating the index" in 54.9663 secs
2025-03-13 15:23:04,036 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9967 secs
2025-03-13 15:23:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 56529 [episode count 10/20]
[retrieval_preprocessing] for episode 83631 [episode count 11/20], we have num_retrieval=np.int64(2072) num_query=np.int64(101)
2025-03-13 15:23:09,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:10,143 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:10
2025-03-13 15:23:10,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-13 15:23:10,172 [INFO]: There are 2072 embeddings of dim 49152
2025-03-13 15:23:10,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:23:10,172 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:10
2025-03-13 15:23:10,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:10,173 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:23:10,173 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:10,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:23:10,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:10
2025-03-13 15:23:10,173 [INFO]: 427.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:10,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:23:10,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:10
2025-03-13 15:23:10,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:10,174 [INFO]: 	Creating the index 03/13/2025, 15:23:10
2025-03-13 15:23:10,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:10
2025-03-13 15:23:10,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:23:10,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:10
2025-03-13 15:23:10,177 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:23:10,178 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.05it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.05it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.42it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.73it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.82it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.84it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.73it/s] 89%|████████▉ | 8/9 [00:01<00:00,  6.59it/s]100%|██████████| 9/9 [00:03<00:00,  1.48it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
2025-03-13 15:23:13,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:13
2025-03-13 15:23:44,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9196 secs
2025-03-13 15:23:44,156 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 15:23:44,156 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 15:24:01,956 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7993 secs
2025-03-13 15:24:01,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7807 secs
2025-03-13 15:24:01,958 [INFO]: {
2025-03-13 15:24:01,958 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:01,958 [INFO]: 	index_param: efSearch=293
2025-03-13 15:24:01,958 [INFO]: 	index_path: knn.index
2025-03-13 15:24:01,958 [INFO]: 	size in bytes: 407653450
2025-03-13 15:24:01,958 [INFO]: 	avg_search_speed_ms: 11.103440449261969
2025-03-13 15:24:01,958 [INFO]: 	99p_search_speed_ms: 17.121633049100637
2025-03-13 15:24:01,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:01,958 [INFO]: 	nb vectors: 2072
2025-03-13 15:24:01,958 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:01,958 [INFO]: 	compression ratio: 0.9993090356527095
2025-03-13 15:24:01,958 [INFO]: }
2025-03-13 15:24:01,958 [INFO]: 	>>> Finished "Creating the index" in 51.7842 secs
2025-03-13 15:24:01,958 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8155 secs
2025-03-13 15:24:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 83631 [episode count 11/20]
[retrieval_preprocessing] for episode 62757 [episode count 12/20], we have num_retrieval=np.int64(2098) num_query=np.int64(75)
2025-03-13 15:24:04,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:05,108 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:05
2025-03-13 15:24:05,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1263.34it/s]
2025-03-13 15:24:05,135 [INFO]: There are 2098 embeddings of dim 49152
2025-03-13 15:24:05,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:24:05,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:05,136 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:24:05,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:05,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:24:05,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,137 [INFO]: 433.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:05,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:24:05,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:05
2025-03-13 15:24:05,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:05,137 [INFO]: 	Creating the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:05
2025-03-13 15:24:05,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:24:05,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:05
2025-03-13 15:24:05,141 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:24:05,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.42it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.76it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.37it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.75it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.26it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.26it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.16it/s]100%|██████████| 9/9 [00:02<00:00,  1.80it/s]100%|██████████| 9/9 [00:02<00:00,  3.43it/s]
2025-03-13 15:24:07,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:07
2025-03-13 15:24:42,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3017 secs
2025-03-13 15:24:42,071 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 15:24:42,071 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 15:25:07,112 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0400 secs
2025-03-13 15:25:07,114 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9727 secs
2025-03-13 15:25:07,114 [INFO]: {
2025-03-13 15:25:07,114 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:07,114 [INFO]: 	index_param: efSearch=279
2025-03-13 15:25:07,114 [INFO]: 	index_path: knn.index
2025-03-13 15:25:07,114 [INFO]: 	size in bytes: 412768750
2025-03-13 15:25:07,114 [INFO]: 	avg_search_speed_ms: 9.570746707538383
2025-03-13 15:25:07,114 [INFO]: 	99p_search_speed_ms: 17.699359590187655
2025-03-13 15:25:07,114 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:07,114 [INFO]: 	nb vectors: 2098
2025-03-13 15:25:07,114 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:07,114 [INFO]: 	compression ratio: 0.9993091385915237
2025-03-13 15:25:07,114 [INFO]: }
2025-03-13 15:25:07,114 [INFO]: 	>>> Finished "Creating the index" in 61.9765 secs
2025-03-13 15:25:07,114 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0062 secs
2025-03-13 15:25:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 62757 [episode count 12/20]
[retrieval_preprocessing] for episode 86948 [episode count 13/20], we have num_retrieval=np.int64(2087) num_query=np.int64(86)
2025-03-13 15:25:10,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:10,567 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:10
2025-03-13 15:25:10,567 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.36it/s]
2025-03-13 15:25:10,595 [INFO]: There are 2087 embeddings of dim 49152
2025-03-13 15:25:10,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:25:10,595 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,595 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:10,595 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:25:10,595 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:10,595 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:10,595 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,596 [INFO]: 430.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:10,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:25:10,596 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:10
2025-03-13 15:25:10,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:10,596 [INFO]: 	Creating the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,596 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:10
2025-03-13 15:25:10,597 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:25:10,597 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,597 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:25:10,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.93it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.34it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.79it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.00it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.11it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.19it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.16it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.19it/s]100%|██████████| 9/9 [00:02<00:00,  1.90it/s]100%|██████████| 9/9 [00:02<00:00,  3.55it/s]
2025-03-13 15:25:13,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:13
2025-03-13 15:25:40,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0274 secs
2025-03-13 15:25:40,161 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 15:25:40,161 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 15:26:01,081 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9205 secs
2025-03-13 15:26:01,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8901 secs
2025-03-13 15:26:01,488 [INFO]: {
2025-03-13 15:26:01,488 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:01,488 [INFO]: 	index_param: efSearch=293
2025-03-13 15:26:01,488 [INFO]: 	index_path: knn.index
2025-03-13 15:26:01,488 [INFO]: 	size in bytes: 410604610
2025-03-13 15:26:01,488 [INFO]: 	avg_search_speed_ms: 10.09834506365684
2025-03-13 15:26:01,488 [INFO]: 	99p_search_speed_ms: 14.582680608145894
2025-03-13 15:26:01,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:01,488 [INFO]: 	nb vectors: 2087
2025-03-13 15:26:01,488 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:01,488 [INFO]: 	compression ratio: 0.9993090335736854
2025-03-13 15:26:01,488 [INFO]: }
2025-03-13 15:26:01,488 [INFO]: 	>>> Finished "Creating the index" in 50.8924 secs
2025-03-13 15:26:01,488 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9216 secs
2025-03-13 15:26:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 86948 [episode count 13/20]
[retrieval_preprocessing] for episode 23461 [episode count 14/20], we have num_retrieval=np.int64(2098) num_query=np.int64(75)
2025-03-13 15:26:03,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:03,511 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:03
2025-03-13 15:26:03,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1565.04it/s]
2025-03-13 15:26:03,540 [INFO]: There are 2098 embeddings of dim 49152
2025-03-13 15:26:03,541 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:26:03,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:03,542 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:26:03,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:03,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:26:03,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,543 [INFO]: 433.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:03,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:26:03,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:03
2025-03-13 15:26:03,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:03,544 [INFO]: 	Creating the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,544 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:03
2025-03-13 15:26:03,547 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:26:03,547 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,547 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:03,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.61it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.17it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.77it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.28it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.48it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.86it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.87it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.81it/s]100%|██████████| 9/9 [00:02<00:00,  1.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]
2025-03-13 15:26:06,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:06
2025-03-13 15:26:31,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7076 secs
2025-03-13 15:26:31,210 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:26:31,210 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 15:26:52,965 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7550 secs
2025-03-13 15:26:52,967 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4199 secs
2025-03-13 15:26:52,967 [INFO]: {
2025-03-13 15:26:52,967 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:52,967 [INFO]: 	index_param: efSearch=200
2025-03-13 15:26:52,967 [INFO]: 	index_path: knn.index
2025-03-13 15:26:52,967 [INFO]: 	size in bytes: 412768750
2025-03-13 15:26:52,967 [INFO]: 	avg_search_speed_ms: 7.938901014623068
2025-03-13 15:26:52,967 [INFO]: 	99p_search_speed_ms: 14.394488967955121
2025-03-13 15:26:52,967 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:52,967 [INFO]: 	nb vectors: 2098
2025-03-13 15:26:52,967 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:52,968 [INFO]: 	compression ratio: 0.9993091385915237
2025-03-13 15:26:52,968 [INFO]: }
2025-03-13 15:26:52,968 [INFO]: 	>>> Finished "Creating the index" in 49.4238 secs
2025-03-13 15:26:52,968 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4560 secs
2025-03-13 15:26:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 23461 [episode count 14/20]
[retrieval_preprocessing] for episode 60441 [episode count 15/20], we have num_retrieval=np.int64(2064) num_query=np.int64(109)
2025-03-13 15:26:54,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:55,247 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:55
2025-03-13 15:26:55,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.76it/s]
2025-03-13 15:26:55,278 [INFO]: There are 2064 embeddings of dim 49152
2025-03-13 15:26:55,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:26:55,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:55
2025-03-13 15:26:55,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:55,279 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:26:55,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:55,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:26:55,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:55
2025-03-13 15:26:55,279 [INFO]: 426.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:55,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:26:55,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:55
2025-03-13 15:26:55,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:55,280 [INFO]: 	Creating the index 03/13/2025, 15:26:55
2025-03-13 15:26:55,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:55
2025-03-13 15:26:55,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:26:55,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:55
2025-03-13 15:26:55,284 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:26:55,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.22it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.12it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.12it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.60it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.04it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.68it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.66it/s]100%|██████████| 9/9 [00:02<00:00,  2.10it/s]100%|██████████| 9/9 [00:02<00:00,  3.90it/s]
2025-03-13 15:26:58,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:58
2025-03-13 15:27:28,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1858 secs
2025-03-13 15:27:28,662 [INFO]: The best hyperparameters are: efSearch=352
2025-03-13 15:27:28,662 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  4.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.67it/s]
2025-03-13 15:27:53,917 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2546 secs
2025-03-13 15:27:53,919 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6352 secs
2025-03-13 15:27:53,919 [INFO]: {
2025-03-13 15:27:53,919 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:53,919 [INFO]: 	index_param: efSearch=352
2025-03-13 15:27:53,919 [INFO]: 	index_path: knn.index
2025-03-13 15:27:53,919 [INFO]: 	size in bytes: 406079530
2025-03-13 15:27:53,919 [INFO]: 	avg_search_speed_ms: 11.859765484591426
2025-03-13 15:27:53,919 [INFO]: 	99p_search_speed_ms: 22.556341900490224
2025-03-13 15:27:53,919 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:53,919 [INFO]: 	nb vectors: 2064
2025-03-13 15:27:53,919 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:53,919 [INFO]: 	compression ratio: 0.99930895802603
2025-03-13 15:27:53,919 [INFO]: }
2025-03-13 15:27:53,919 [INFO]: 	>>> Finished "Creating the index" in 58.6391 secs
2025-03-13 15:27:53,919 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6719 secs
2025-03-13 15:27:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 60441 [episode count 15/20]
[retrieval_preprocessing] for episode 67519 [episode count 16/20], we have num_retrieval=np.int64(2084) num_query=np.int64(89)
2025-03-13 15:27:56,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:56,792 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:56
2025-03-13 15:27:56,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.61it/s]
2025-03-13 15:27:56,820 [INFO]: There are 2084 embeddings of dim 49152
2025-03-13 15:27:56,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:27:56,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:56
2025-03-13 15:27:56,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:56,821 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:27:56,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:56,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:27:56,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:56
2025-03-13 15:27:56,821 [INFO]: 430.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:56,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:27:56,822 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:56
2025-03-13 15:27:56,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:56,822 [INFO]: 	Creating the index 03/13/2025, 15:27:56
2025-03-13 15:27:56,822 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:56
2025-03-13 15:27:56,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:27:56,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:56
2025-03-13 15:27:56,826 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:27:56,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.96it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.06it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.40it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.02it/s]100%|██████████| 9/9 [00:01<00:00,  3.58it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-13 15:27:58,688 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:58
2025-03-13 15:28:23,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1136 secs
2025-03-13 15:28:23,802 [INFO]: The best hyperparameters are: efSearch=94
2025-03-13 15:28:23,802 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 15:28:46,132 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3300 secs
2025-03-13 15:28:46,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3090 secs
2025-03-13 15:28:46,135 [INFO]: {
2025-03-13 15:28:46,135 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:46,135 [INFO]: 	index_param: efSearch=94
2025-03-13 15:28:46,135 [INFO]: 	index_path: knn.index
2025-03-13 15:28:46,135 [INFO]: 	size in bytes: 410014390
2025-03-13 15:28:46,135 [INFO]: 	avg_search_speed_ms: 5.177825651073665
2025-03-13 15:28:46,135 [INFO]: 	99p_search_speed_ms: 8.354103509336712
2025-03-13 15:28:46,135 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:46,135 [INFO]: 	nb vectors: 2084
2025-03-13 15:28:46,135 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:46,135 [INFO]: 	compression ratio: 0.9993090047400531
2025-03-13 15:28:46,135 [INFO]: }
2025-03-13 15:28:46,135 [INFO]: 	>>> Finished "Creating the index" in 49.3131 secs
2025-03-13 15:28:46,135 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3426 secs
2025-03-13 15:28:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 67519 [episode count 16/20]
[retrieval_preprocessing] for episode 59358 [episode count 17/20], we have num_retrieval=np.int64(2080) num_query=np.int64(93)
2025-03-13 15:28:47,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:47,990 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:47
2025-03-13 15:28:47,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.63it/s]
2025-03-13 15:28:48,019 [INFO]: There are 2080 embeddings of dim 49152
2025-03-13 15:28:48,019 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:28:48,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:48
2025-03-13 15:28:48,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:48,020 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:28:48,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:48,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:28:48,020 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:48
2025-03-13 15:28:48,020 [INFO]: 429.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:48,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:28:48,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:48
2025-03-13 15:28:48,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:48,021 [INFO]: 	Creating the index 03/13/2025, 15:28:48
2025-03-13 15:28:48,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:48
2025-03-13 15:28:48,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:28:48,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:48
2025-03-13 15:28:48,025 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:28:48,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.95it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.01it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.19it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]100%|██████████| 9/9 [00:02<00:00,  4.07it/s]
2025-03-13 15:28:50,244 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:50
2025-03-13 15:29:14,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6579 secs
2025-03-13 15:29:14,902 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 15:29:14,903 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.98it/s]
2025-03-13 15:29:35,667 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7641 secs
2025-03-13 15:29:35,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6439 secs
2025-03-13 15:29:35,669 [INFO]: {
2025-03-13 15:29:35,669 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:35,669 [INFO]: 	index_param: efSearch=291
2025-03-13 15:29:35,669 [INFO]: 	index_path: knn.index
2025-03-13 15:29:35,669 [INFO]: 	size in bytes: 409227370
2025-03-13 15:29:35,669 [INFO]: 	avg_search_speed_ms: 9.644454337024241
2025-03-13 15:29:35,669 [INFO]: 	99p_search_speed_ms: 13.821911746636038
2025-03-13 15:29:35,669 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:35,669 [INFO]: 	nb vectors: 2080
2025-03-13 15:29:35,669 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:35,669 [INFO]: 	compression ratio: 0.9993091126822724
2025-03-13 15:29:35,669 [INFO]: }
2025-03-13 15:29:35,669 [INFO]: 	>>> Finished "Creating the index" in 47.6476 secs
2025-03-13 15:29:35,669 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6789 secs
2025-03-13 15:29:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 59358 [episode count 17/20]
[retrieval_preprocessing] for episode 90729 [episode count 18/20], we have num_retrieval=np.int64(2078) num_query=np.int64(95)
2025-03-13 15:29:37,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:38,148 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:38
2025-03-13 15:29:38,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.48it/s]
2025-03-13 15:29:38,177 [INFO]: There are 2078 embeddings of dim 49152
2025-03-13 15:29:38,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 15:29:38,178 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:38
2025-03-13 15:29:38,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:38,178 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:29:38,178 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:38,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:29:38,178 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:38
2025-03-13 15:29:38,178 [INFO]: 428.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:38,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 15:29:38,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:38
2025-03-13 15:29:38,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:38,179 [INFO]: 	Creating the index 03/13/2025, 15:29:38
2025-03-13 15:29:38,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:38
2025-03-13 15:29:38,183 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:29:38,183 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:38
2025-03-13 15:29:38,183 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:29:38,183 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.33it/s] 22%|██▏       | 2/9 [00:00<00:01,  7.00it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.76it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.06it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.34it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.44it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.65it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.64it/s]100%|██████████| 9/9 [00:02<00:00,  1.94it/s]100%|██████████| 9/9 [00:02<00:00,  3.79it/s]
2025-03-13 15:29:41,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:41
2025-03-13 15:30:05,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6605 secs
2025-03-13 15:30:05,799 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:30:05,799 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-13 15:30:20,804 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0056 secs
2025-03-13 15:30:20,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6231 secs
2025-03-13 15:30:20,806 [INFO]: {
2025-03-13 15:30:20,806 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:20,806 [INFO]: 	index_param: efSearch=229
2025-03-13 15:30:20,806 [INFO]: 	index_path: knn.index
2025-03-13 15:30:20,806 [INFO]: 	size in bytes: 408833890
2025-03-13 15:30:20,806 [INFO]: 	avg_search_speed_ms: 9.684199281577797
2025-03-13 15:30:20,806 [INFO]: 	99p_search_speed_ms: 14.151925183832645
2025-03-13 15:30:20,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:20,806 [INFO]: 	nb vectors: 2078
2025-03-13 15:30:20,806 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:20,807 [INFO]: 	compression ratio: 0.9993090934804842
2025-03-13 15:30:20,807 [INFO]: }
2025-03-13 15:30:20,807 [INFO]: 	>>> Finished "Creating the index" in 42.6270 secs
2025-03-13 15:30:20,807 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6580 secs
2025-03-13 15:30:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 90729 [episode count 18/20]
[retrieval_preprocessing] for episode 83408 [episode count 19/20], we have num_retrieval=np.int64(2076) num_query=np.int64(97)
2025-03-13 15:30:22,479 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:22,807 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:22
2025-03-13 15:30:22,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.09it/s]100%|██████████| 1/1 [00:00<00:00,  1.09it/s]
2025-03-13 15:30:23,747 [INFO]: There are 2076 embeddings of dim 49152
2025-03-13 15:30:23,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.9399 secs
2025-03-13 15:30:23,748 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:23
2025-03-13 15:30:23,748 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:23,748 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 15:30:23,748 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:23,748 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:30:23,748 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:23
2025-03-13 15:30:23,749 [INFO]: 428.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:23,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:30:23,749 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:23
2025-03-13 15:30:23,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:23,749 [INFO]: 	Creating the index 03/13/2025, 15:30:23
2025-03-13 15:30:23,749 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:23
2025-03-13 15:30:23,752 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:30:23,752 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:23
2025-03-13 15:30:23,752 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:30:23,753 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.43it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.52it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.44it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.82it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.76it/s]
2025-03-13 15:30:26,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:26
2025-03-13 15:30:56,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2619 secs
2025-03-13 15:30:56,415 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 15:30:56,415 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 15:31:14,137 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7217 secs
2025-03-13 15:31:14,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5167 secs
2025-03-13 15:31:14,269 [INFO]: {
2025-03-13 15:31:14,270 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:14,270 [INFO]: 	index_param: efSearch=305
2025-03-13 15:31:14,270 [INFO]: 	index_path: knn.index
2025-03-13 15:31:14,270 [INFO]: 	size in bytes: 408440410
2025-03-13 15:31:14,270 [INFO]: 	avg_search_speed_ms: 10.438607075535508
2025-03-13 15:31:14,270 [INFO]: 	99p_search_speed_ms: 16.0273666260764
2025-03-13 15:31:14,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:14,270 [INFO]: 	nb vectors: 2076
2025-03-13 15:31:14,270 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:14,270 [INFO]: 	compression ratio: 0.999309074241699
2025-03-13 15:31:14,270 [INFO]: }
2025-03-13 15:31:14,270 [INFO]: 	>>> Finished "Creating the index" in 50.5212 secs
2025-03-13 15:31:14,271 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4633 secs
2025-03-13 15:31:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 83408 [episode count 19/20]
2025-03-13 15:31:15: [retrieval_preprocessing] finished for 5235850418_close_upper_drawer_generic [chosen_id count 1/196]
2025-03-13 15:31:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5235850418_put_orange_on_green [chosen_id count 2/196]
2025-03-13 15:31:18: [retrieval_preprocessing] we have num_total=2439 embedding_dim=49152
[retrieval_preprocessing] for episode 32875 [episode count 0/20], we have num_retrieval=np.int64(2337) num_query=np.int64(102)
2025-03-13 15:31:19,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:19,702 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:19
2025-03-13 15:31:19,702 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 993.44it/s]
2025-03-13 15:31:19,729 [INFO]: There are 2337 embeddings of dim 49152
2025-03-13 15:31:19,729 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:31:19,729 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,729 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:19,729 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:31:19,729 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:19,729 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:19,729 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,729 [INFO]: 482.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:19,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:31:19,730 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:19
2025-03-13 15:31:19,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:19,730 [INFO]: 	Creating the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,730 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:19
2025-03-13 15:31:19,731 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:31:19,731 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:19
2025-03-13 15:31:19,731 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:31:19,731 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.18it/s] 20%|██        | 2/10 [00:00<00:01,  7.68it/s] 30%|███       | 3/10 [00:00<00:00,  7.81it/s] 40%|████      | 4/10 [00:00<00:00,  8.18it/s] 50%|█████     | 5/10 [00:00<00:00,  8.57it/s] 70%|███████   | 7/10 [00:00<00:00,  9.61it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.48it/s]100%|██████████| 10/10 [00:02<00:00,  3.70it/s]
2025-03-13 15:31:22,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:22
2025-03-13 15:31:58,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8246 secs
2025-03-13 15:31:58,261 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:31:58,261 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 15:32:18,320 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0593 secs
2025-03-13 15:32:18,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5914 secs
2025-03-13 15:32:18,323 [INFO]: {
2025-03-13 15:32:18,323 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:18,323 [INFO]: 	index_param: efSearch=205
2025-03-13 15:32:18,323 [INFO]: 	index_path: knn.index
2025-03-13 15:32:18,323 [INFO]: 	size in bytes: 459790390
2025-03-13 15:32:18,323 [INFO]: 	avg_search_speed_ms: 12.758390379568315
2025-03-13 15:32:18,323 [INFO]: 	99p_search_speed_ms: 23.698876840062432
2025-03-13 15:32:18,323 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:18,323 [INFO]: 	nb vectors: 2337
2025-03-13 15:32:18,323 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:18,323 [INFO]: 	compression ratio: 0.9993094810006795
2025-03-13 15:32:18,323 [INFO]: }
2025-03-13 15:32:18,323 [INFO]: 	>>> Finished "Creating the index" in 58.5931 secs
2025-03-13 15:32:18,323 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6206 secs
2025-03-13 15:32:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 32875 [episode count 0/20]
[retrieval_preprocessing] for episode 82039 [episode count 1/20], we have num_retrieval=np.int64(2353) num_query=np.int64(86)
2025-03-13 15:32:19,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:20,337 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:20
2025-03-13 15:32:20,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.21it/s]
2025-03-13 15:32:20,376 [INFO]: There are 2353 embeddings of dim 49152
2025-03-13 15:32:20,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0390 secs
2025-03-13 15:32:20,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:20
2025-03-13 15:32:20,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:20,377 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:32:20,377 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:20,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:32:20,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:20
2025-03-13 15:32:20,377 [INFO]: 485.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:20,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:32:20,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:20
2025-03-13 15:32:20,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:20,378 [INFO]: 	Creating the index 03/13/2025, 15:32:20
2025-03-13 15:32:20,378 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:20
2025-03-13 15:32:20,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:32:20,380 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:20
2025-03-13 15:32:20,380 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:32:20,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.84it/s] 30%|███       | 3/10 [00:00<00:00, 10.27it/s] 50%|█████     | 5/10 [00:00<00:00, 11.37it/s] 70%|███████   | 7/10 [00:00<00:00, 11.60it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.10it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-13 15:32:22,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:22
2025-03-13 15:33:01,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7692 secs
2025-03-13 15:33:01,565 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:33:01,565 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 15:33:23,271 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7058 secs
2025-03-13 15:33:23,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8932 secs
2025-03-13 15:33:23,274 [INFO]: {
2025-03-13 15:33:23,274 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:23,274 [INFO]: 	index_param: efSearch=206
2025-03-13 15:33:23,274 [INFO]: 	index_path: knn.index
2025-03-13 15:33:23,274 [INFO]: 	size in bytes: 462938230
2025-03-13 15:33:23,274 [INFO]: 	avg_search_speed_ms: 9.660750207072798
2025-03-13 15:33:23,274 [INFO]: 	99p_search_speed_ms: 13.32517270930111
2025-03-13 15:33:23,274 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:23,274 [INFO]: 	nb vectors: 2353
2025-03-13 15:33:23,274 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:23,274 [INFO]: 	compression ratio: 0.9993096141573791
2025-03-13 15:33:23,274 [INFO]: }
2025-03-13 15:33:23,274 [INFO]: 	>>> Finished "Creating the index" in 62.8962 secs
2025-03-13 15:33:23,274 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9366 secs
2025-03-13 15:33:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 82039 [episode count 1/20]
[retrieval_preprocessing] for episode 94344 [episode count 2/20], we have num_retrieval=np.int64(2333) num_query=np.int64(106)
2025-03-13 15:33:25,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:25,662 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:25
2025-03-13 15:33:25,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.66it/s]
2025-03-13 15:33:25,688 [INFO]: There are 2333 embeddings of dim 49152
2025-03-13 15:33:25,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:33:25,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:25
2025-03-13 15:33:25,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:25,689 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:33:25,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:25,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:25,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:25
2025-03-13 15:33:25,689 [INFO]: 481.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:25,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:33:25,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:25
2025-03-13 15:33:25,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:25,689 [INFO]: 	Creating the index 03/13/2025, 15:33:25
2025-03-13 15:33:25,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:25
2025-03-13 15:33:25,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:33:25,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:25
2025-03-13 15:33:25,690 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:33:25,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.27it/s] 30%|███       | 3/10 [00:00<00:00,  8.61it/s] 40%|████      | 4/10 [00:00<00:00,  8.37it/s] 60%|██████    | 6/10 [00:00<00:00,  9.15it/s] 80%|████████  | 8/10 [00:00<00:00,  9.66it/s]100%|██████████| 10/10 [00:02<00:00,  2.72it/s]100%|██████████| 10/10 [00:02<00:00,  4.00it/s]
2025-03-13 15:33:28,193 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:28
2025-03-13 15:33:57,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5934 secs
2025-03-13 15:33:57,786 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 15:33:57,786 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.35it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s]
2025-03-13 15:34:18,710 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9232 secs
2025-03-13 15:34:18,712 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0219 secs
2025-03-13 15:34:18,712 [INFO]: {
2025-03-13 15:34:18,712 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:18,712 [INFO]: 	index_param: efSearch=263
2025-03-13 15:34:18,712 [INFO]: 	index_path: knn.index
2025-03-13 15:34:18,712 [INFO]: 	size in bytes: 459003430
2025-03-13 15:34:18,712 [INFO]: 	avg_search_speed_ms: 13.33382298486928
2025-03-13 15:34:18,712 [INFO]: 	99p_search_speed_ms: 20.22797979181632
2025-03-13 15:34:18,712 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:18,712 [INFO]: 	nb vectors: 2333
2025-03-13 15:34:18,712 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:18,712 [INFO]: 	compression ratio: 0.9993094474261336
2025-03-13 15:34:18,712 [INFO]: }
2025-03-13 15:34:18,712 [INFO]: 	>>> Finished "Creating the index" in 53.0234 secs
2025-03-13 15:34:18,712 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0500 secs
2025-03-13 15:34:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 94344 [episode count 2/20]
[retrieval_preprocessing] for episode 150 [episode count 3/20], we have num_retrieval=np.int64(2334) num_query=np.int64(105)
2025-03-13 15:34:21,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:22,239 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:22
2025-03-13 15:34:22,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 73.23it/s]
2025-03-13 15:34:22,278 [INFO]: There are 2334 embeddings of dim 49152
2025-03-13 15:34:22,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-13 15:34:22,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:22
2025-03-13 15:34:22,278 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:22,278 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:34:22,278 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:22,278 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:34:22,278 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:22
2025-03-13 15:34:22,278 [INFO]: 481.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:22,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:22,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:22
2025-03-13 15:34:22,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:22,279 [INFO]: 	Creating the index 03/13/2025, 15:34:22
2025-03-13 15:34:22,279 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:22
2025-03-13 15:34:22,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:34:22,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:22
2025-03-13 15:34:22,281 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:34:22,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.13it/s] 30%|███       | 3/10 [00:00<00:00,  9.82it/s] 50%|█████     | 5/10 [00:00<00:00, 11.33it/s] 70%|███████   | 7/10 [00:00<00:00, 12.17it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.95it/s]100%|██████████| 10/10 [00:02<00:00,  3.68it/s]
2025-03-13 15:34:25,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:25
2025-03-13 15:34:59,214 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8125 secs
2025-03-13 15:34:59,214 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:34:59,215 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 15:35:20,169 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9546 secs
2025-03-13 15:35:20,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8910 secs
2025-03-13 15:35:20,172 [INFO]: {
2025-03-13 15:35:20,172 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:20,172 [INFO]: 	index_param: efSearch=245
2025-03-13 15:35:20,172 [INFO]: 	index_path: knn.index
2025-03-13 15:35:20,172 [INFO]: 	size in bytes: 459200170
2025-03-13 15:35:20,172 [INFO]: 	avg_search_speed_ms: 10.356846704161253
2025-03-13 15:35:20,172 [INFO]: 	99p_search_speed_ms: 13.154834671877325
2025-03-13 15:35:20,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:20,172 [INFO]: 	nb vectors: 2334
2025-03-13 15:35:20,172 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:20,172 [INFO]: 	compression ratio: 0.9993094558305586
2025-03-13 15:35:20,172 [INFO]: }
2025-03-13 15:35:20,172 [INFO]: 	>>> Finished "Creating the index" in 57.8931 secs
2025-03-13 15:35:20,172 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9323 secs
2025-03-13 15:35:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 150 [episode count 3/20]
[retrieval_preprocessing] for episode 43182 [episode count 4/20], we have num_retrieval=np.int64(2341) num_query=np.int64(98)
2025-03-13 15:35:25,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:25,497 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:25
2025-03-13 15:35:25,497 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 803.51it/s]
2025-03-13 15:35:25,524 [INFO]: There are 2341 embeddings of dim 49152
2025-03-13 15:35:25,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:35:25,525 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:25,525 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:35:25,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:25,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:35:25,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,526 [INFO]: 483.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:25,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:35:25,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:25
2025-03-13 15:35:25,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:25,527 [INFO]: 	Creating the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:25
2025-03-13 15:35:25,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:35:25,530 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:25
2025-03-13 15:35:25,530 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:35:25,531 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.37it/s] 20%|██        | 2/10 [00:00<00:01,  5.79it/s] 30%|███       | 3/10 [00:00<00:00,  7.06it/s] 40%|████      | 4/10 [00:00<00:00,  7.51it/s] 60%|██████    | 6/10 [00:00<00:00,  9.08it/s] 70%|███████   | 7/10 [00:00<00:00,  8.90it/s] 80%|████████  | 8/10 [00:00<00:00,  8.94it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.03it/s]100%|██████████| 10/10 [00:02<00:00,  1.84it/s]100%|██████████| 10/10 [00:02<00:00,  3.71it/s]
2025-03-13 15:35:28,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:28
2025-03-13 15:36:01,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8200 secs
2025-03-13 15:36:01,052 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 15:36:01,052 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 15:36:25,833 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7807 secs
2025-03-13 15:36:25,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3050 secs
2025-03-13 15:36:25,835 [INFO]: {
2025-03-13 15:36:25,835 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:25,836 [INFO]: 	index_param: efSearch=230
2025-03-13 15:36:25,836 [INFO]: 	index_path: knn.index
2025-03-13 15:36:25,836 [INFO]: 	size in bytes: 460577350
2025-03-13 15:36:25,836 [INFO]: 	avg_search_speed_ms: 10.36961707194757
2025-03-13 15:36:25,836 [INFO]: 	99p_search_speed_ms: 14.766415422782304
2025-03-13 15:36:25,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:25,836 [INFO]: 	nb vectors: 2341
2025-03-13 15:36:25,836 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:25,836 [INFO]: 	compression ratio: 0.9993095144604918
2025-03-13 15:36:25,836 [INFO]: }
2025-03-13 15:36:25,836 [INFO]: 	>>> Finished "Creating the index" in 60.3086 secs
2025-03-13 15:36:25,836 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3388 secs
2025-03-13 15:36:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 43182 [episode count 4/20]
[retrieval_preprocessing] for episode 4279 [episode count 5/20], we have num_retrieval=np.int64(2317) num_query=np.int64(122)
2025-03-13 15:36:28,303 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:29,480 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:29
2025-03-13 15:36:29,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.33it/s]
2025-03-13 15:36:29,507 [INFO]: There are 2317 embeddings of dim 49152
2025-03-13 15:36:29,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 15:36:29,507 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:29
2025-03-13 15:36:29,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:29,507 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:36:29,507 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:29,507 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:29,507 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:29
2025-03-13 15:36:29,508 [INFO]: 478.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:29,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:36:29,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:29
2025-03-13 15:36:29,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:29,508 [INFO]: 	Creating the index 03/13/2025, 15:36:29
2025-03-13 15:36:29,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:29
2025-03-13 15:36:29,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:36:29,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:29
2025-03-13 15:36:29,509 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:36:29,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.87it/s] 20%|██        | 2/10 [00:00<00:01,  6.19it/s] 30%|███       | 3/10 [00:00<00:01,  6.91it/s] 40%|████      | 4/10 [00:00<00:00,  7.16it/s] 60%|██████    | 6/10 [00:00<00:00,  8.37it/s] 70%|███████   | 7/10 [00:00<00:00,  8.18it/s] 80%|████████  | 8/10 [00:01<00:00,  8.07it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.07it/s]100%|██████████| 10/10 [00:02<00:00,  1.78it/s]100%|██████████| 10/10 [00:02<00:00,  3.56it/s]
2025-03-13 15:36:32,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:32
2025-03-13 15:37:01,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0244 secs
2025-03-13 15:37:01,343 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:37:01,343 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.21it/s]
2025-03-13 15:37:24,420 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0774 secs
2025-03-13 15:37:24,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9322 secs
2025-03-13 15:37:24,441 [INFO]: {
2025-03-13 15:37:24,442 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:24,442 [INFO]: 	index_param: efSearch=167
2025-03-13 15:37:24,442 [INFO]: 	index_path: knn.index
2025-03-13 15:37:24,442 [INFO]: 	size in bytes: 455855530
2025-03-13 15:37:24,442 [INFO]: 	avg_search_speed_ms: 8.028604167948565
2025-03-13 15:37:24,442 [INFO]: 	99p_search_speed_ms: 16.533017600886517
2025-03-13 15:37:24,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:24,442 [INFO]: 	nb vectors: 2317
2025-03-13 15:37:24,442 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:24,442 [INFO]: 	compression ratio: 0.9993094434984698
2025-03-13 15:37:24,442 [INFO]: }
2025-03-13 15:37:24,442 [INFO]: 	>>> Finished "Creating the index" in 54.9340 secs
2025-03-13 15:37:24,442 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9615 secs
2025-03-13 15:37:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 4279 [episode count 5/20]
[retrieval_preprocessing] for episode 57531 [episode count 6/20], we have num_retrieval=np.int64(2279) num_query=np.int64(160)
2025-03-13 15:37:27,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:27,664 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:27
2025-03-13 15:37:27,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1007.04it/s]
2025-03-13 15:37:27,689 [INFO]: There are 2279 embeddings of dim 49152
2025-03-13 15:37:27,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:37:27,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:27
2025-03-13 15:37:27,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:27,690 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:37:27,690 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:27,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:37:27,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:27
2025-03-13 15:37:27,691 [INFO]: 470.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:27,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:37:27,691 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:27
2025-03-13 15:37:27,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:27,691 [INFO]: 	Creating the index 03/13/2025, 15:37:27
2025-03-13 15:37:27,692 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:27
2025-03-13 15:37:27,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:37:27,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:27
2025-03-13 15:37:27,695 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:37:27,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.30it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.60it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.33it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.31it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.35it/s]100%|██████████| 9/9 [00:02<00:00,  1.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.24it/s]
2025-03-13 15:37:30,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:30
2025-03-13 15:38:06,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3515 secs
2025-03-13 15:38:06,841 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 15:38:06,841 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 15:38:24,272 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4302 secs
2025-03-13 15:38:24,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5786 secs
2025-03-13 15:38:24,274 [INFO]: {
2025-03-13 15:38:24,274 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:24,274 [INFO]: 	index_param: efSearch=228
2025-03-13 15:38:24,274 [INFO]: 	index_path: knn.index
2025-03-13 15:38:24,274 [INFO]: 	size in bytes: 448379230
2025-03-13 15:38:24,274 [INFO]: 	avg_search_speed_ms: 10.252019296234215
2025-03-13 15:38:24,274 [INFO]: 	99p_search_speed_ms: 14.59477498428896
2025-03-13 15:38:24,274 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:24,274 [INFO]: 	nb vectors: 2279
2025-03-13 15:38:24,274 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:24,274 [INFO]: 	compression ratio: 0.999309517526046
2025-03-13 15:38:24,274 [INFO]: }
2025-03-13 15:38:24,274 [INFO]: 	>>> Finished "Creating the index" in 56.5827 secs
2025-03-13 15:38:24,274 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6103 secs
2025-03-13 15:38:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 57531 [episode count 6/20]
[retrieval_preprocessing] for episode 65735 [episode count 7/20], we have num_retrieval=np.int64(2334) num_query=np.int64(105)
2025-03-13 15:38:26,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:27,192 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:27
2025-03-13 15:38:27,192 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1072.71it/s]
2025-03-13 15:38:27,215 [INFO]: There are 2334 embeddings of dim 49152
2025-03-13 15:38:27,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 15:38:27,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:27
2025-03-13 15:38:27,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:27,215 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:38:27,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:27,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:27,215 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:27
2025-03-13 15:38:27,215 [INFO]: 481.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:27,215 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:27,215 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:27
2025-03-13 15:38:27,215 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:27,215 [INFO]: 	Creating the index 03/13/2025, 15:38:27
2025-03-13 15:38:27,215 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:27
2025-03-13 15:38:27,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:38:27,216 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:27
2025-03-13 15:38:27,217 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:38:27,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:11,  1.31s/it] 20%|██        | 2/10 [00:01<00:06,  1.19it/s] 30%|███       | 3/10 [00:01<00:03,  1.88it/s] 40%|████      | 4/10 [00:02<00:02,  2.70it/s] 50%|█████     | 5/10 [00:02<00:01,  3.58it/s] 70%|███████   | 7/10 [00:02<00:00,  5.37it/s] 90%|█████████ | 9/10 [00:02<00:00,  6.36it/s]100%|██████████| 10/10 [00:04<00:00,  2.02it/s]100%|██████████| 10/10 [00:04<00:00,  2.34it/s]
2025-03-13 15:38:31,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:31
2025-03-13 15:39:05,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5172 secs
2025-03-13 15:39:05,013 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 15:39:05,013 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:16,  5.54s/it] 50%|█████     | 2/4 [00:07<00:06,  3.21s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.42s/it]
2025-03-13 15:39:35,710 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6972 secs
2025-03-13 15:39:35,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4974 secs
2025-03-13 15:39:35,714 [INFO]: {
2025-03-13 15:39:35,714 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:35,714 [INFO]: 	index_param: efSearch=236
2025-03-13 15:39:35,714 [INFO]: 	index_path: knn.index
2025-03-13 15:39:35,714 [INFO]: 	size in bytes: 459200170
2025-03-13 15:39:35,714 [INFO]: 	avg_search_speed_ms: 11.90462023242378
2025-03-13 15:39:35,714 [INFO]: 	99p_search_speed_ms: 27.824264811351906
2025-03-13 15:39:35,714 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:35,714 [INFO]: 	nb vectors: 2334
2025-03-13 15:39:35,714 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:35,714 [INFO]: 	compression ratio: 0.9993094558305586
2025-03-13 15:39:35,714 [INFO]: }
2025-03-13 15:39:35,714 [INFO]: 	>>> Finished "Creating the index" in 68.4989 secs
2025-03-13 15:39:35,714 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5224 secs
2025-03-13 15:39:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 65735 [episode count 7/20]
[retrieval_preprocessing] for episode 41173 [episode count 8/20], we have num_retrieval=np.int64(2342) num_query=np.int64(97)
2025-03-13 15:39:37,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:38,163 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:38
2025-03-13 15:39:38,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 15:39:38,192 [INFO]: There are 2342 embeddings of dim 49152
2025-03-13 15:39:38,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:39:38,193 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:38
2025-03-13 15:39:38,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:38,194 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:39:38,194 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:38,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:39:38,194 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:38
2025-03-13 15:39:38,195 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:38,195 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:39:38,195 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:38
2025-03-13 15:39:38,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:38,195 [INFO]: 	Creating the index 03/13/2025, 15:39:38
2025-03-13 15:39:38,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:38
2025-03-13 15:39:38,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:39:38,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:38
2025-03-13 15:39:38,199 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:39:38,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.27it/s] 20%|██        | 2/10 [00:00<00:01,  6.89it/s] 30%|███       | 3/10 [00:00<00:00,  7.71it/s] 40%|████      | 4/10 [00:00<00:00,  8.34it/s] 60%|██████    | 6/10 [00:00<00:00,  9.04it/s] 70%|███████   | 7/10 [00:00<00:00,  9.13it/s] 80%|████████  | 8/10 [00:00<00:00,  9.22it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.22it/s]100%|██████████| 10/10 [00:02<00:00,  2.01it/s]100%|██████████| 10/10 [00:02<00:00,  4.01it/s]
2025-03-13 15:39:40,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:40
2025-03-13 15:40:10,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9972 secs
2025-03-13 15:40:10,696 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 15:40:10,696 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s]
2025-03-13 15:40:38,633 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9365 secs
2025-03-13 15:40:38,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4362 secs
2025-03-13 15:40:38,635 [INFO]: {
2025-03-13 15:40:38,635 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:38,635 [INFO]: 	index_param: efSearch=253
2025-03-13 15:40:38,635 [INFO]: 	index_path: knn.index
2025-03-13 15:40:38,636 [INFO]: 	size in bytes: 460774090
2025-03-13 15:40:38,636 [INFO]: 	avg_search_speed_ms: 11.675692436175558
2025-03-13 15:40:38,636 [INFO]: 	99p_search_speed_ms: 21.266355179250134
2025-03-13 15:40:38,636 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:38,636 [INFO]: 	nb vectors: 2342
2025-03-13 15:40:38,636 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:38,636 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-13 15:40:38,636 [INFO]: }
2025-03-13 15:40:38,636 [INFO]: 	>>> Finished "Creating the index" in 60.4401 secs
2025-03-13 15:40:38,636 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4722 secs
2025-03-13 15:40:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 41173 [episode count 8/20]
[retrieval_preprocessing] for episode 12503 [episode count 9/20], we have num_retrieval=np.int64(2331) num_query=np.int64(108)
2025-03-13 15:40:40,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:40,970 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:40
2025-03-13 15:40:40,970 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.13it/s]
2025-03-13 15:40:40,996 [INFO]: There are 2331 embeddings of dim 49152
2025-03-13 15:40:40,996 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:40:40,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:40
2025-03-13 15:40:40,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:40,996 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:40:40,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:40,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:40,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:40
2025-03-13 15:40:40,997 [INFO]: 481.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:40,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:40:40,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:40
2025-03-13 15:40:40,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:40,997 [INFO]: 	Creating the index 03/13/2025, 15:40:40
2025-03-13 15:40:40,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:40
2025-03-13 15:40:40,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:40:40,998 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:40
2025-03-13 15:40:40,998 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:40:40,998 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.60it/s] 20%|██        | 2/10 [00:00<00:01,  5.85it/s] 30%|███       | 3/10 [00:00<00:01,  6.50it/s] 40%|████      | 4/10 [00:00<00:00,  6.80it/s] 50%|█████     | 5/10 [00:00<00:00,  6.98it/s] 60%|██████    | 6/10 [00:00<00:00,  7.10it/s] 70%|███████   | 7/10 [00:01<00:00,  7.17it/s] 80%|████████  | 8/10 [00:01<00:00,  7.24it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.23it/s]100%|██████████| 10/10 [00:03<00:00,  1.47it/s]100%|██████████| 10/10 [00:03<00:00,  3.12it/s]
2025-03-13 15:40:44,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:44
2025-03-13 15:41:17,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3284 secs
2025-03-13 15:41:17,532 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:41:17,532 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 15:41:36,390 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8574 secs
2025-03-13 15:41:36,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3945 secs
2025-03-13 15:41:36,393 [INFO]: {
2025-03-13 15:41:36,393 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:36,393 [INFO]: 	index_param: efSearch=221
2025-03-13 15:41:36,393 [INFO]: 	index_path: knn.index
2025-03-13 15:41:36,393 [INFO]: 	size in bytes: 458609950
2025-03-13 15:41:36,393 [INFO]: 	avg_search_speed_ms: 11.576220798209155
2025-03-13 15:41:36,393 [INFO]: 	99p_search_speed_ms: 19.134991047903895
2025-03-13 15:41:36,393 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:36,393 [INFO]: 	nb vectors: 2331
2025-03-13 15:41:36,393 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:36,393 [INFO]: 	compression ratio: 0.999309430595651
2025-03-13 15:41:36,393 [INFO]: }
2025-03-13 15:41:36,393 [INFO]: 	>>> Finished "Creating the index" in 55.3961 secs
2025-03-13 15:41:36,393 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4229 secs
2025-03-13 15:41:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 12503 [episode count 9/20]
[retrieval_preprocessing] for episode 45273 [episode count 10/20], we have num_retrieval=np.int64(2350) num_query=np.int64(89)
2025-03-13 15:41:38,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:39,817 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:39
2025-03-13 15:41:39,817 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.73it/s]
2025-03-13 15:41:39,851 [INFO]: There are 2350 embeddings of dim 49152
2025-03-13 15:41:39,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 15:41:39,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:39
2025-03-13 15:41:39,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:39,851 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:41:39,851 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:39,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:41:39,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:39
2025-03-13 15:41:39,852 [INFO]: 485.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:39,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:41:39,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:39
2025-03-13 15:41:39,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:39,852 [INFO]: 	Creating the index 03/13/2025, 15:41:39
2025-03-13 15:41:39,852 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:39
2025-03-13 15:41:39,854 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:41:39,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:39
2025-03-13 15:41:39,854 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:41:39,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.31it/s] 20%|██        | 2/10 [00:00<00:01,  7.33it/s] 30%|███       | 3/10 [00:00<00:00,  8.33it/s] 50%|█████     | 5/10 [00:00<00:00,  9.25it/s] 60%|██████    | 6/10 [00:00<00:00,  9.44it/s] 70%|███████   | 7/10 [00:00<00:00,  9.59it/s] 80%|████████  | 8/10 [00:00<00:00,  9.69it/s]100%|██████████| 10/10 [00:02<00:00,  2.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.68it/s]
2025-03-13 15:41:42,577 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:42
2025-03-13 15:42:15,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8911 secs
2025-03-13 15:42:15,468 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 15:42:15,468 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 15:42:36,603 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1345 secs
2025-03-13 15:42:36,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7512 secs
2025-03-13 15:42:36,605 [INFO]: {
2025-03-13 15:42:36,605 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:36,605 [INFO]: 	index_param: efSearch=247
2025-03-13 15:42:36,605 [INFO]: 	index_path: knn.index
2025-03-13 15:42:36,605 [INFO]: 	size in bytes: 462348010
2025-03-13 15:42:36,605 [INFO]: 	avg_search_speed_ms: 11.196282612209908
2025-03-13 15:42:36,605 [INFO]: 	99p_search_speed_ms: 15.483979620039474
2025-03-13 15:42:36,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:36,605 [INFO]: 	nb vectors: 2350
2025-03-13 15:42:36,605 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:36,605 [INFO]: 	compression ratio: 0.9993095893286098
2025-03-13 15:42:36,605 [INFO]: }
2025-03-13 15:42:36,605 [INFO]: 	>>> Finished "Creating the index" in 56.7532 secs
2025-03-13 15:42:36,605 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7887 secs
2025-03-13 15:42:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 45273 [episode count 10/20]
[retrieval_preprocessing] for episode 33038 [episode count 11/20], we have num_retrieval=np.int64(2336) num_query=np.int64(103)
2025-03-13 15:42:41,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:41,627 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:41
2025-03-13 15:42:41,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.94it/s]
2025-03-13 15:42:41,653 [INFO]: There are 2336 embeddings of dim 49152
2025-03-13 15:42:41,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:42:41,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:41
2025-03-13 15:42:41,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:41,654 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:42:41,655 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:41,655 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:42:41,655 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:41
2025-03-13 15:42:41,655 [INFO]: 482.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:41,655 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:42:41,655 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:41
2025-03-13 15:42:41,656 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:41,656 [INFO]: 	Creating the index 03/13/2025, 15:42:41
2025-03-13 15:42:41,656 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:41
2025-03-13 15:42:41,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:42:41,659 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:41
2025-03-13 15:42:41,660 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:42:41,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.61it/s] 20%|██        | 2/10 [00:00<00:01,  7.56it/s] 30%|███       | 3/10 [00:00<00:00,  8.43it/s] 40%|████      | 4/10 [00:00<00:00,  8.74it/s] 50%|█████     | 5/10 [00:00<00:00,  9.09it/s] 70%|███████   | 7/10 [00:00<00:00,  9.51it/s] 80%|████████  | 8/10 [00:00<00:00,  9.49it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.36it/s]100%|██████████| 10/10 [00:02<00:00,  1.84it/s]100%|██████████| 10/10 [00:02<00:00,  3.75it/s]
2025-03-13 15:42:44,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:44
2025-03-13 15:43:13,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6554 secs
2025-03-13 15:43:13,988 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 15:43:13,988 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.00it/s]
2025-03-13 15:43:39,313 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3244 secs
2025-03-13 15:43:39,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6558 secs
2025-03-13 15:43:39,316 [INFO]: {
2025-03-13 15:43:39,316 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:39,316 [INFO]: 	index_param: efSearch=252
2025-03-13 15:43:39,316 [INFO]: 	index_path: knn.index
2025-03-13 15:43:39,316 [INFO]: 	size in bytes: 459593650
2025-03-13 15:43:39,316 [INFO]: 	avg_search_speed_ms: 13.59228905177746
2025-03-13 15:43:39,316 [INFO]: 	99p_search_speed_ms: 27.80111447209491
2025-03-13 15:43:39,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:39,316 [INFO]: 	nb vectors: 2336
2025-03-13 15:43:39,316 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:39,316 [INFO]: 	compression ratio: 0.9993094726178223
2025-03-13 15:43:39,316 [INFO]: }
2025-03-13 15:43:39,316 [INFO]: 	>>> Finished "Creating the index" in 57.6600 secs
2025-03-13 15:43:39,316 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6890 secs
2025-03-13 15:43:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 33038 [episode count 11/20]
[retrieval_preprocessing] for episode 20764 [episode count 12/20], we have num_retrieval=np.int64(2355) num_query=np.int64(84)
2025-03-13 15:43:41,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:41,714 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:41
2025-03-13 15:43:41,714 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1111.37it/s]
2025-03-13 15:43:41,741 [INFO]: There are 2355 embeddings of dim 49152
2025-03-13 15:43:41,741 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:43:41,741 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,741 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:41,741 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:43:41,741 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:41,741 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:41,741 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,741 [INFO]: 486.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:41,741 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:43:41,741 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:41
2025-03-13 15:43:41,741 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:41,741 [INFO]: 	Creating the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,741 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:41
2025-03-13 15:43:41,743 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:43:41,743 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,743 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:43:41,743 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.03it/s] 30%|███       | 3/10 [00:00<00:00,  8.97it/s] 40%|████      | 4/10 [00:00<00:00,  9.30it/s] 60%|██████    | 6/10 [00:00<00:00,  9.92it/s] 80%|████████  | 8/10 [00:00<00:00, 10.69it/s]100%|██████████| 10/10 [00:02<00:00,  2.56it/s]100%|██████████| 10/10 [00:02<00:00,  3.86it/s]
2025-03-13 15:43:44,339 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:44
2025-03-13 15:44:18,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1761 secs
2025-03-13 15:44:18,516 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 15:44:18,516 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.34it/s] 50%|█████     | 2/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.42it/s]
2025-03-13 15:44:41,885 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3689 secs
2025-03-13 15:44:41,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1445 secs
2025-03-13 15:44:41,887 [INFO]: {
2025-03-13 15:44:41,887 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:41,887 [INFO]: 	index_param: efSearch=254
2025-03-13 15:44:41,887 [INFO]: 	index_path: knn.index
2025-03-13 15:44:41,887 [INFO]: 	size in bytes: 463331710
2025-03-13 15:44:41,887 [INFO]: 	avg_search_speed_ms: 11.264667505144587
2025-03-13 15:44:41,887 [INFO]: 	99p_search_speed_ms: 21.520925518125296
2025-03-13 15:44:41,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:41,887 [INFO]: 	nb vectors: 2355
2025-03-13 15:44:41,887 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:41,887 [INFO]: 	compression ratio: 0.9993096306747492
2025-03-13 15:44:41,887 [INFO]: }
2025-03-13 15:44:41,887 [INFO]: 	>>> Finished "Creating the index" in 60.1460 secs
2025-03-13 15:44:41,887 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1734 secs
2025-03-13 15:44:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 20764 [episode count 12/20]
[retrieval_preprocessing] for episode 55649 [episode count 13/20], we have num_retrieval=np.int64(2346) num_query=np.int64(93)
2025-03-13 15:44:43,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:44,253 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:44
2025-03-13 15:44:44,254 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1002.46it/s]
2025-03-13 15:44:44,279 [INFO]: There are 2346 embeddings of dim 49152
2025-03-13 15:44:44,279 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:44:44,279 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:44
2025-03-13 15:44:44,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:44,280 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:44:44,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:44,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:44,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:44
2025-03-13 15:44:44,280 [INFO]: 484.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:44,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:44:44,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:44
2025-03-13 15:44:44,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:44,280 [INFO]: 	Creating the index 03/13/2025, 15:44:44
2025-03-13 15:44:44,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:44
2025-03-13 15:44:44,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:44:44,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:44
2025-03-13 15:44:44,281 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:44:44,281 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.61it/s] 30%|███       | 3/10 [00:00<00:00,  9.34it/s] 50%|█████     | 5/10 [00:00<00:00, 10.08it/s] 70%|███████   | 7/10 [00:00<00:00, 10.47it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.68it/s]100%|██████████| 10/10 [00:02<00:00,  4.31it/s]
2025-03-13 15:44:46,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:46
2025-03-13 15:45:18,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1339 secs
2025-03-13 15:45:18,739 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:45:18,739 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 15:45:41,031 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2918 secs
2025-03-13 15:45:41,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2574 secs
2025-03-13 15:45:41,539 [INFO]: {
2025-03-13 15:45:41,539 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:41,539 [INFO]: 	index_param: efSearch=211
2025-03-13 15:45:41,539 [INFO]: 	index_path: knn.index
2025-03-13 15:45:41,539 [INFO]: 	size in bytes: 461561050
2025-03-13 15:45:41,539 [INFO]: 	avg_search_speed_ms: 11.448336695374184
2025-03-13 15:45:41,539 [INFO]: 	99p_search_speed_ms: 16.84362784260884
2025-03-13 15:45:41,539 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:41,539 [INFO]: 	nb vectors: 2346
2025-03-13 15:45:41,539 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:41,539 [INFO]: 	compression ratio: 0.9993095561248073
2025-03-13 15:45:41,539 [INFO]: }
2025-03-13 15:45:41,539 [INFO]: 	>>> Finished "Creating the index" in 57.2595 secs
2025-03-13 15:45:41,539 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2859 secs
2025-03-13 15:45:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 55649 [episode count 13/20]
[retrieval_preprocessing] for episode 86384 [episode count 14/20], we have num_retrieval=np.int64(2241) num_query=np.int64(198)
2025-03-13 15:45:43,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:44,302 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:44
2025-03-13 15:45:44,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2218.03it/s]
2025-03-13 15:45:44,324 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 15:45:44,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 15:45:44,324 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:44
2025-03-13 15:45:44,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:44,324 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:45:44,324 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:44,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:44,324 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:44
2025-03-13 15:45:44,324 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:44,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:45:44,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:44
2025-03-13 15:45:44,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:44,324 [INFO]: 	Creating the index 03/13/2025, 15:45:44
2025-03-13 15:45:44,324 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:44
2025-03-13 15:45:44,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:45:44,325 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:44
2025-03-13 15:45:44,325 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:45:44,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.07it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.52it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.13it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.50it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.91it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.05it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.15it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.35it/s]100%|██████████| 9/9 [00:03<00:00,  1.27it/s]100%|██████████| 9/9 [00:03<00:00,  2.80it/s]
2025-03-13 15:45:47,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:47
2025-03-13 15:46:18,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8180 secs
2025-03-13 15:46:18,362 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 15:46:18,362 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.63it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 15:46:38,419 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0568 secs
2025-03-13 15:46:38,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0958 secs
2025-03-13 15:46:38,421 [INFO]: {
2025-03-13 15:46:38,421 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:38,421 [INFO]: 	index_param: efSearch=175
2025-03-13 15:46:38,421 [INFO]: 	index_path: knn.index
2025-03-13 15:46:38,421 [INFO]: 	size in bytes: 440903050
2025-03-13 15:46:38,422 [INFO]: 	avg_search_speed_ms: 9.483602976258755
2025-03-13 15:46:38,422 [INFO]: 	99p_search_speed_ms: 14.779864205047488
2025-03-13 15:46:38,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:38,422 [INFO]: 	nb vectors: 2241
2025-03-13 15:46:38,422 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:38,422 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 15:46:38,422 [INFO]: }
2025-03-13 15:46:38,422 [INFO]: 	>>> Finished "Creating the index" in 54.0973 secs
2025-03-13 15:46:38,422 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1196 secs
2025-03-13 15:46:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 86384 [episode count 14/20]
[retrieval_preprocessing] for episode 383 [episode count 15/20], we have num_retrieval=np.int64(2238) num_query=np.int64(201)
2025-03-13 15:46:40,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:41,511 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:41
2025-03-13 15:46:41,511 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.43it/s]
2025-03-13 15:46:41,541 [INFO]: There are 2238 embeddings of dim 49152
2025-03-13 15:46:41,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 15:46:41,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:41
2025-03-13 15:46:41,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:41,543 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:46:41,543 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:41,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 15:46:41,543 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:41
2025-03-13 15:46:41,544 [INFO]: 461.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:41,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:46:41,544 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:41
2025-03-13 15:46:41,545 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:41,545 [INFO]: 	Creating the index 03/13/2025, 15:46:41
2025-03-13 15:46:41,545 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:41
2025-03-13 15:46:41,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:46:41,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:41
2025-03-13 15:46:41,549 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:46:41,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.45it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.06it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.02it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.44it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.68it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.77it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.89it/s]100%|██████████| 9/9 [00:02<00:00,  2.00it/s]100%|██████████| 9/9 [00:02<00:00,  3.37it/s]
2025-03-13 15:46:44,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:44
2025-03-13 15:47:18,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6490 secs
2025-03-13 15:47:18,876 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:47:18,876 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.81it/s] 50%|█████     | 2/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.00it/s]
2025-03-13 15:47:36,527 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6513 secs
2025-03-13 15:47:37,032 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4840 secs
2025-03-13 15:47:37,033 [INFO]: {
2025-03-13 15:47:37,033 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:37,033 [INFO]: 	index_param: efSearch=222
2025-03-13 15:47:37,033 [INFO]: 	index_path: knn.index
2025-03-13 15:47:37,033 [INFO]: 	size in bytes: 440312830
2025-03-13 15:47:37,033 [INFO]: 	avg_search_speed_ms: 10.874677270033356
2025-03-13 15:47:37,033 [INFO]: 	99p_search_speed_ms: 16.31713268114254
2025-03-13 15:47:37,033 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:37,033 [INFO]: 	nb vectors: 2238
2025-03-13 15:47:37,033 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:37,033 [INFO]: 	compression ratio: 0.9993092956205705
2025-03-13 15:47:37,033 [INFO]: }
2025-03-13 15:47:37,033 [INFO]: 	>>> Finished "Creating the index" in 55.4884 secs
2025-03-13 15:47:37,034 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5225 secs
2025-03-13 15:47:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 383 [episode count 15/20]
[retrieval_preprocessing] for episode 14724 [episode count 16/20], we have num_retrieval=np.int64(2277) num_query=np.int64(162)
2025-03-13 15:47:40,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:41,187 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:41
2025-03-13 15:47:41,187 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2508.56it/s]
2025-03-13 15:47:41,213 [INFO]: There are 2277 embeddings of dim 49152
2025-03-13 15:47:41,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:47:41,213 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:41
2025-03-13 15:47:41,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:41,213 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:47:41,213 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:41,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:41,213 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:41
2025-03-13 15:47:41,214 [INFO]: 469.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:41,214 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:47:41,214 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:41
2025-03-13 15:47:41,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:41,214 [INFO]: 	Creating the index 03/13/2025, 15:47:41
2025-03-13 15:47:41,214 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:41
2025-03-13 15:47:41,215 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:47:41,215 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:41
2025-03-13 15:47:41,215 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:47:41,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.30it/s] 22%|██▏       | 2/9 [00:00<00:01,  5.91it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.79it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.86it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.72it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.10it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.38it/s]100%|██████████| 9/9 [00:03<00:00,  2.55it/s]
2025-03-13 15:47:44,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:44
2025-03-13 15:48:21,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5905 secs
2025-03-13 15:48:21,340 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 15:48:21,340 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 15:48:42,349 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0091 secs
2025-03-13 15:48:42,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1383 secs
2025-03-13 15:48:42,353 [INFO]: {
2025-03-13 15:48:42,354 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:42,354 [INFO]: 	index_param: efSearch=272
2025-03-13 15:48:42,354 [INFO]: 	index_path: knn.index
2025-03-13 15:48:42,354 [INFO]: 	size in bytes: 447985750
2025-03-13 15:48:42,354 [INFO]: 	avg_search_speed_ms: 11.795651997364882
2025-03-13 15:48:42,354 [INFO]: 	99p_search_speed_ms: 17.225173797924068
2025-03-13 15:48:42,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:42,354 [INFO]: 	nb vectors: 2277
2025-03-13 15:48:42,354 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:42,354 [INFO]: 	compression ratio: 0.9993095003579913
2025-03-13 15:48:42,354 [INFO]: }
2025-03-13 15:48:42,354 [INFO]: 	>>> Finished "Creating the index" in 61.1399 secs
2025-03-13 15:48:42,354 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1662 secs
2025-03-13 15:48:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 14724 [episode count 16/20]
[retrieval_preprocessing] for episode 80293 [episode count 17/20], we have num_retrieval=np.int64(2222) num_query=np.int64(217)
2025-03-13 15:48:44,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:44,903 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:44
2025-03-13 15:48:44,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-13 15:48:44,925 [INFO]: There are 2222 embeddings of dim 49152
2025-03-13 15:48:44,925 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 15:48:44,925 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:44
2025-03-13 15:48:44,925 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:44,925 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 15:48:44,925 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:44,925 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:44,925 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:44
2025-03-13 15:48:44,926 [INFO]: 458.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:44,926 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:48:44,926 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:44
2025-03-13 15:48:44,926 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:44,926 [INFO]: 	Creating the index 03/13/2025, 15:48:44
2025-03-13 15:48:44,926 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:44
2025-03-13 15:48:44,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:48:44,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:44
2025-03-13 15:48:44,927 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:48:44,927 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.35it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.14it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.40it/s]100%|██████████| 9/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 15:48:47,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:47
2025-03-13 15:49:13,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2872 secs
2025-03-13 15:49:13,589 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 15:49:13,589 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 15:49:39,367 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7779 secs
2025-03-13 15:49:39,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4422 secs
2025-03-13 15:49:39,369 [INFO]: {
2025-03-13 15:49:39,369 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:39,369 [INFO]: 	index_param: efSearch=273
2025-03-13 15:49:39,369 [INFO]: 	index_path: knn.index
2025-03-13 15:49:39,369 [INFO]: 	size in bytes: 437164990
2025-03-13 15:49:39,369 [INFO]: 	avg_search_speed_ms: 12.274265048762588
2025-03-13 15:49:39,369 [INFO]: 	99p_search_speed_ms: 22.892561573535207
2025-03-13 15:49:39,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:39,369 [INFO]: 	nb vectors: 2222
2025-03-13 15:49:39,369 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:39,369 [INFO]: 	compression ratio: 0.9993091532787198
2025-03-13 15:49:39,369 [INFO]: }
2025-03-13 15:49:39,369 [INFO]: 	>>> Finished "Creating the index" in 54.4435 secs
2025-03-13 15:49:39,369 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4663 secs
2025-03-13 15:49:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 80293 [episode count 17/20]
[retrieval_preprocessing] for episode 94645 [episode count 18/20], we have num_retrieval=np.int64(2323) num_query=np.int64(116)
2025-03-13 15:49:42,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:42,879 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:42
2025-03-13 15:49:42,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.33it/s]
2025-03-13 15:49:42,907 [INFO]: There are 2323 embeddings of dim 49152
2025-03-13 15:49:42,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:49:42,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:42
2025-03-13 15:49:42,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:42,908 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:49:42,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:42,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:49:42,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:42
2025-03-13 15:49:42,909 [INFO]: 479.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:42,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:49:42,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:42
2025-03-13 15:49:42,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:42,910 [INFO]: 	Creating the index 03/13/2025, 15:49:42
2025-03-13 15:49:42,910 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:42
2025-03-13 15:49:42,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:49:42,913 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:42
2025-03-13 15:49:42,913 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:49:42,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.90it/s] 30%|███       | 3/10 [00:00<00:00,  9.38it/s] 40%|████      | 4/10 [00:00<00:00,  9.52it/s] 60%|██████    | 6/10 [00:00<00:00, 10.22it/s] 80%|████████  | 8/10 [00:00<00:00, 11.03it/s]100%|██████████| 10/10 [00:02<00:00,  2.48it/s]100%|██████████| 10/10 [00:02<00:00,  3.80it/s]
2025-03-13 15:49:45,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:45
2025-03-13 15:50:17,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4806 secs
2025-03-13 15:50:17,033 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 15:50:17,033 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 15:50:35,372 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3394 secs
2025-03-13 15:50:35,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4618 secs
2025-03-13 15:50:35,375 [INFO]: {
2025-03-13 15:50:35,375 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:35,375 [INFO]: 	index_param: efSearch=263
2025-03-13 15:50:35,375 [INFO]: 	index_path: knn.index
2025-03-13 15:50:35,375 [INFO]: 	size in bytes: 457036030
2025-03-13 15:50:35,375 [INFO]: 	avg_search_speed_ms: 13.50105143945247
2025-03-13 15:50:35,375 [INFO]: 	99p_search_speed_ms: 20.304729277268056
2025-03-13 15:50:35,375 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:35,375 [INFO]: 	nb vectors: 2323
2025-03-13 15:50:35,375 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:35,375 [INFO]: 	compression ratio: 0.9993093629839206
2025-03-13 15:50:35,375 [INFO]: }
2025-03-13 15:50:35,375 [INFO]: 	>>> Finished "Creating the index" in 52.4657 secs
2025-03-13 15:50:35,375 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4967 secs
2025-03-13 15:50:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 94645 [episode count 18/20]
[retrieval_preprocessing] for episode 94649 [episode count 19/20], we have num_retrieval=np.int64(2352) num_query=np.int64(87)
2025-03-13 15:50:37,852 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:38,315 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:38
2025-03-13 15:50:38,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.96it/s]
2025-03-13 15:50:38,342 [INFO]: There are 2352 embeddings of dim 49152
2025-03-13 15:50:38,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:50:38,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:38
2025-03-13 15:50:38,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:38,343 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:50:38,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:38,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:50:38,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:38
2025-03-13 15:50:38,344 [INFO]: 485.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:38,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:50:38,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:38
2025-03-13 15:50:38,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:38,345 [INFO]: 	Creating the index 03/13/2025, 15:50:38
2025-03-13 15:50:38,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:38
2025-03-13 15:50:38,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:50:38,348 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:38
2025-03-13 15:50:38,348 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:50:38,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.53it/s] 20%|██        | 2/10 [00:00<00:01,  7.06it/s] 30%|███       | 3/10 [00:00<00:01,  6.60it/s] 40%|████      | 4/10 [00:00<00:00,  6.65it/s] 60%|██████    | 6/10 [00:00<00:00,  8.35it/s] 70%|███████   | 7/10 [00:00<00:00,  8.50it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.20it/s]100%|██████████| 10/10 [00:03<00:00,  1.38it/s]100%|██████████| 10/10 [00:03<00:00,  2.64it/s]
2025-03-13 15:50:42,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:42
2025-03-13 15:51:18,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8079 secs
2025-03-13 15:51:18,946 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 15:51:18,946 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.27it/s] 50%|█████     | 2/4 [00:00<00:00,  4.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.39it/s]
2025-03-13 15:51:47,062 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1159 secs
2025-03-13 15:51:47,064 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7159 secs
2025-03-13 15:51:47,064 [INFO]: {
2025-03-13 15:51:47,064 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:47,064 [INFO]: 	index_param: efSearch=208
2025-03-13 15:51:47,064 [INFO]: 	index_path: knn.index
2025-03-13 15:51:47,064 [INFO]: 	size in bytes: 462741490
2025-03-13 15:51:47,064 [INFO]: 	avg_search_speed_ms: 10.484103691340492
2025-03-13 15:51:47,064 [INFO]: 	99p_search_speed_ms: 15.57008002186194
2025-03-13 15:51:47,064 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:47,064 [INFO]: 	nb vectors: 2352
2025-03-13 15:51:47,064 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:47,064 [INFO]: 	compression ratio: 0.9993096058881602
2025-03-13 15:51:47,064 [INFO]: }
2025-03-13 15:51:47,065 [INFO]: 	>>> Finished "Creating the index" in 68.7199 secs
2025-03-13 15:51:47,065 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7497 secs
2025-03-13 15:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 94649 [episode count 19/20]
2025-03-13 15:51:49: [retrieval_preprocessing] finished for 5235850418_put_orange_on_green [chosen_id count 2/196]
2025-03-13 15:51:50: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 52817038_green_block_in_black_bowl [chosen_id count 3/196]
2025-03-13 15:51:50: [retrieval_preprocessing] we have num_total=1669 embedding_dim=49152
[retrieval_preprocessing] for episode 19201 [episode count 0/20], we have num_retrieval=np.int64(1586) num_query=np.int64(83)
2025-03-13 15:51:50,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:51,714 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:51
2025-03-13 15:51:51,714 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1019.02it/s]
2025-03-13 15:51:51,742 [INFO]: There are 1586 embeddings of dim 49152
2025-03-13 15:51:51,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:51:51,742 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:51
2025-03-13 15:51:51,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:51,743 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:51:51,743 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:51,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:51,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:51
2025-03-13 15:51:51,743 [INFO]: 327.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:51,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:51:51,743 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:51
2025-03-13 15:51:51,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:51,743 [INFO]: 	Creating the index 03/13/2025, 15:51:51
2025-03-13 15:51:51,743 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:51
2025-03-13 15:51:51,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:51:51,744 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:51
2025-03-13 15:51:51,745 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:51:51,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  7.89it/s] 43%|████▎     | 3/7 [00:00<00:00, 11.57it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.03it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.19it/s]100%|██████████| 7/7 [00:02<00:00,  1.82it/s]100%|██████████| 7/7 [00:02<00:00,  2.97it/s]
2025-03-13 15:51:54,105 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:54
2025-03-13 15:52:14,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6572 secs
2025-03-13 15:52:14,763 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:52:14,763 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.65it/s] 50%|█████     | 2/4 [00:00<00:00,  3.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.99it/s]
2025-03-13 15:52:29,634 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8714 secs
2025-03-13 15:52:29,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8916 secs
2025-03-13 15:52:29,636 [INFO]: {
2025-03-13 15:52:29,636 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:29,636 [INFO]: 	index_param: efSearch=168
2025-03-13 15:52:29,636 [INFO]: 	index_path: knn.index
2025-03-13 15:52:29,636 [INFO]: 	size in bytes: 312035950
2025-03-13 15:52:29,636 [INFO]: 	avg_search_speed_ms: 7.916273126490738
2025-03-13 15:52:29,636 [INFO]: 	99p_search_speed_ms: 11.146509470418094
2025-03-13 15:52:29,636 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:29,636 [INFO]: 	nb vectors: 1586
2025-03-13 15:52:29,636 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:29,636 [INFO]: 	compression ratio: 0.9993088552777333
2025-03-13 15:52:29,636 [INFO]: }
2025-03-13 15:52:29,637 [INFO]: 	>>> Finished "Creating the index" in 37.8934 secs
2025-03-13 15:52:29,637 [INFO]: >>> Finished "Launching the whole pipeline" in 37.9225 secs
2025-03-13 15:52:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 19201 [episode count 0/20]
[retrieval_preprocessing] for episode 71298 [episode count 1/20], we have num_retrieval=np.int64(1602) num_query=np.int64(67)
2025-03-13 15:52:31,072 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:31,425 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:31
2025-03-13 15:52:31,425 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1354.31it/s]
2025-03-13 15:52:31,450 [INFO]: There are 1602 embeddings of dim 49152
2025-03-13 15:52:31,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 15:52:31,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:31
2025-03-13 15:52:31,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:31,450 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:52:31,450 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:31,450 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:31,450 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:31
2025-03-13 15:52:31,451 [INFO]: 330.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:31,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:52:31,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:31
2025-03-13 15:52:31,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:31,451 [INFO]: 	Creating the index 03/13/2025, 15:52:31
2025-03-13 15:52:31,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:31
2025-03-13 15:52:31,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:52:31,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:31
2025-03-13 15:52:31,452 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:52:31,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.70it/s] 43%|████▎     | 3/7 [00:00<00:00, 10.07it/s] 71%|███████▏  | 5/7 [00:00<00:00, 11.95it/s]100%|██████████| 7/7 [00:01<00:00,  3.15it/s]100%|██████████| 7/7 [00:01<00:00,  4.04it/s]
2025-03-13 15:52:33,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:33
2025-03-13 15:52:57,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6331 secs
2025-03-13 15:52:57,386 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 15:52:57,386 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.24s/it] 50%|█████     | 2/4 [00:02<00:02,  1.26s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.23it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.13s/it]
2025-03-13 15:53:25,858 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4716 secs
2025-03-13 15:53:25,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4083 secs
2025-03-13 15:53:25,860 [INFO]: {
2025-03-13 15:53:25,860 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:25,860 [INFO]: 	index_param: efSearch=194
2025-03-13 15:53:25,860 [INFO]: 	index_path: knn.index
2025-03-13 15:53:25,860 [INFO]: 	size in bytes: 315183850
2025-03-13 15:53:25,860 [INFO]: 	avg_search_speed_ms: 8.69943225250134
2025-03-13 15:53:25,860 [INFO]: 	99p_search_speed_ms: 14.799333778209984
2025-03-13 15:53:25,860 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:25,860 [INFO]: 	nb vectors: 1602
2025-03-13 15:53:25,860 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:25,860 [INFO]: 	compression ratio: 0.9993088668724619
2025-03-13 15:53:25,861 [INFO]: }
2025-03-13 15:53:25,861 [INFO]: 	>>> Finished "Creating the index" in 54.4098 secs
2025-03-13 15:53:25,861 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4352 secs
2025-03-13 15:53:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 71298 [episode count 1/20]
[retrieval_preprocessing] for episode 27139 [episode count 2/20], we have num_retrieval=np.int64(1586) num_query=np.int64(83)
2025-03-13 15:53:27,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:27,515 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:27
2025-03-13 15:53:27,515 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.11it/s]
2025-03-13 15:53:28,210 [INFO]: There are 1586 embeddings of dim 49152
2025-03-13 15:53:28,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6957 secs
2025-03-13 15:53:28,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:28
2025-03-13 15:53:28,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:28,212 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:53:28,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:28,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:53:28,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:28
2025-03-13 15:53:28,212 [INFO]: 327.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:28,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:53:28,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:28
2025-03-13 15:53:28,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:28,212 [INFO]: 	Creating the index 03/13/2025, 15:53:28
2025-03-13 15:53:28,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:28
2025-03-13 15:53:28,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:53:28,214 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:28
2025-03-13 15:53:28,215 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:53:28,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.17it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.88it/s] 57%|█████▋    | 4/7 [00:00<00:00,  8.37it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.19it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.10it/s]100%|██████████| 7/7 [00:02<00:00,  1.95it/s]100%|██████████| 7/7 [00:02<00:00,  3.32it/s]
2025-03-13 15:53:30,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:30
2025-03-13 15:53:54,756 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4275 secs
2025-03-13 15:53:54,756 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:53:54,756 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 15:54:16,381 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6248 secs
2025-03-13 15:54:16,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1681 secs
2025-03-13 15:54:16,383 [INFO]: {
2025-03-13 15:54:16,383 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:16,383 [INFO]: 	index_param: efSearch=221
2025-03-13 15:54:16,383 [INFO]: 	index_path: knn.index
2025-03-13 15:54:16,383 [INFO]: 	size in bytes: 312035950
2025-03-13 15:54:16,383 [INFO]: 	avg_search_speed_ms: 10.118843136149787
2025-03-13 15:54:16,383 [INFO]: 	99p_search_speed_ms: 17.423589932732284
2025-03-13 15:54:16,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:16,383 [INFO]: 	nb vectors: 1586
2025-03-13 15:54:16,383 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:16,383 [INFO]: 	compression ratio: 0.9993088552777333
2025-03-13 15:54:16,383 [INFO]: }
2025-03-13 15:54:16,383 [INFO]: 	>>> Finished "Creating the index" in 48.1706 secs
2025-03-13 15:54:16,383 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8677 secs
2025-03-13 15:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 27139 [episode count 2/20]
[retrieval_preprocessing] for episode 78348 [episode count 3/20], we have num_retrieval=np.int64(1571) num_query=np.int64(98)
2025-03-13 15:54:17,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:17,842 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:17
2025-03-13 15:54:17,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2099.25it/s]
2025-03-13 15:54:17,867 [INFO]: There are 1571 embeddings of dim 49152
2025-03-13 15:54:17,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:54:17,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:17
2025-03-13 15:54:17,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:17,868 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:54:17,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:17,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:54:17,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:17
2025-03-13 15:54:17,868 [INFO]: 324.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:17,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:54:17,869 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:17
2025-03-13 15:54:17,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:17,869 [INFO]: 	Creating the index 03/13/2025, 15:54:17
2025-03-13 15:54:17,869 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:17
2025-03-13 15:54:17,871 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:54:17,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:17
2025-03-13 15:54:17,871 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:54:17,871 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  3.76it/s] 29%|██▊       | 2/7 [00:00<00:00,  5.51it/s] 43%|████▎     | 3/7 [00:00<00:00,  6.90it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.81it/s] 71%|███████▏  | 5/7 [00:00<00:00,  8.38it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.81it/s]100%|██████████| 7/7 [00:02<00:00,  2.10it/s]100%|██████████| 7/7 [00:02<00:00,  3.46it/s]
2025-03-13 15:54:19,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:19
2025-03-13 15:54:39,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8532 secs
2025-03-13 15:54:39,755 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 15:54:39,755 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 15:55:00,288 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5326 secs
2025-03-13 15:55:00,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5726 secs
2025-03-13 15:55:00,444 [INFO]: {
2025-03-13 15:55:00,444 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:00,444 [INFO]: 	index_param: efSearch=259
2025-03-13 15:55:00,444 [INFO]: 	index_path: knn.index
2025-03-13 15:55:00,444 [INFO]: 	size in bytes: 309084790
2025-03-13 15:55:00,444 [INFO]: 	avg_search_speed_ms: 10.653859213901102
2025-03-13 15:55:00,444 [INFO]: 	99p_search_speed_ms: 13.9218136575073
2025-03-13 15:55:00,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:00,444 [INFO]: 	nb vectors: 1571
2025-03-13 15:55:00,445 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:00,445 [INFO]: 	compression ratio: 0.9993088563173879
2025-03-13 15:55:00,445 [INFO]: }
2025-03-13 15:55:00,445 [INFO]: 	>>> Finished "Creating the index" in 42.5757 secs
2025-03-13 15:55:00,445 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6028 secs
2025-03-13 15:55:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 78348 [episode count 3/20]
[retrieval_preprocessing] for episode 43028 [episode count 4/20], we have num_retrieval=np.int64(1599) num_query=np.int64(70)
2025-03-13 15:55:01,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:02,450 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:02
2025-03-13 15:55:02,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-13 15:55:02,479 [INFO]: There are 1599 embeddings of dim 49152
2025-03-13 15:55:02,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:55:02,479 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:02
2025-03-13 15:55:02,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:02,480 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:55:02,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:02,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:55:02,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:02
2025-03-13 15:55:02,480 [INFO]: 330.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:02,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:55:02,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:02
2025-03-13 15:55:02,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:02,481 [INFO]: 	Creating the index 03/13/2025, 15:55:02
2025-03-13 15:55:02,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:02
2025-03-13 15:55:02,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:55:02,484 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:02
2025-03-13 15:55:02,484 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:55:02,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  6.79it/s] 43%|████▎     | 3/7 [00:00<00:00, 11.77it/s] 71%|███████▏  | 5/7 [00:00<00:00, 13.48it/s]100%|██████████| 7/7 [00:01<00:00,  2.98it/s]100%|██████████| 7/7 [00:01<00:00,  3.91it/s]
2025-03-13 15:55:04,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:04
2025-03-13 15:55:30,821 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5431 secs
2025-03-13 15:55:30,821 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 15:55:30,821 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-13 15:55:49,002 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1804 secs
2025-03-13 15:55:49,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5197 secs
2025-03-13 15:55:49,004 [INFO]: {
2025-03-13 15:55:49,004 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:49,004 [INFO]: 	index_param: efSearch=268
2025-03-13 15:55:49,004 [INFO]: 	index_path: knn.index
2025-03-13 15:55:49,004 [INFO]: 	size in bytes: 314593570
2025-03-13 15:55:49,004 [INFO]: 	avg_search_speed_ms: 16.04812565359794
2025-03-13 15:55:49,004 [INFO]: 	99p_search_speed_ms: 26.66811122093347
2025-03-13 15:55:49,004 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:49,004 [INFO]: 	nb vectors: 1599
2025-03-13 15:55:49,004 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:49,004 [INFO]: 	compression ratio: 0.9993090195708705
2025-03-13 15:55:49,004 [INFO]: }
2025-03-13 15:55:49,004 [INFO]: 	>>> Finished "Creating the index" in 46.5231 secs
2025-03-13 15:55:49,004 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5540 secs
2025-03-13 15:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 43028 [episode count 4/20]
[retrieval_preprocessing] for episode 29845 [episode count 5/20], we have num_retrieval=np.int64(1562) num_query=np.int64(107)
2025-03-13 15:55:50,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:50,847 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:50
2025-03-13 15:55:50,848 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1029.28it/s]
2025-03-13 15:55:50,873 [INFO]: There are 1562 embeddings of dim 49152
2025-03-13 15:55:50,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:55:50,873 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:50
2025-03-13 15:55:50,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:50,873 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:55:50,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:50,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:55:50,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:50
2025-03-13 15:55:50,874 [INFO]: 322.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:50,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:55:50,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:50
2025-03-13 15:55:50,875 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:50,875 [INFO]: 	Creating the index 03/13/2025, 15:55:50
2025-03-13 15:55:50,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:50
2025-03-13 15:55:50,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 15:55:50,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:50
2025-03-13 15:55:50,878 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:55:50,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.19it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.12it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.15it/s]100%|██████████| 7/7 [00:01<00:00,  2.80it/s]100%|██████████| 7/7 [00:01<00:00,  3.54it/s]
2025-03-13 15:55:52,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:52
2025-03-13 15:56:14,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0980 secs
2025-03-13 15:56:14,957 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 15:56:14,957 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s] 50%|█████     | 2/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s]
2025-03-13 15:56:32,833 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8767 secs
2025-03-13 15:56:32,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9579 secs
2025-03-13 15:56:32,836 [INFO]: {
2025-03-13 15:56:32,836 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:32,836 [INFO]: 	index_param: efSearch=120
2025-03-13 15:56:32,836 [INFO]: 	index_path: knn.index
2025-03-13 15:56:32,836 [INFO]: 	size in bytes: 307314070
2025-03-13 15:56:32,836 [INFO]: 	avg_search_speed_ms: 7.253956253111839
2025-03-13 15:56:32,836 [INFO]: 	99p_search_speed_ms: 10.027677637990566
2025-03-13 15:56:32,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:32,836 [INFO]: 	nb vectors: 1562
2025-03-13 15:56:32,836 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:32,836 [INFO]: 	compression ratio: 0.9993089349927909
2025-03-13 15:56:32,836 [INFO]: }
2025-03-13 15:56:32,836 [INFO]: 	>>> Finished "Creating the index" in 41.9608 secs
2025-03-13 15:56:32,836 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9882 secs
2025-03-13 15:56:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 29845 [episode count 5/20]
[retrieval_preprocessing] for episode 17307 [episode count 6/20], we have num_retrieval=np.int64(1598) num_query=np.int64(71)
2025-03-13 15:56:34,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:34,673 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:34
2025-03-13 15:56:34,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.63it/s]
2025-03-13 15:56:34,696 [INFO]: There are 1598 embeddings of dim 49152
2025-03-13 15:56:34,697 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 15:56:34,697 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:34
2025-03-13 15:56:34,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:34,697 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:56:34,697 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:34,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:34,697 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:34
2025-03-13 15:56:34,697 [INFO]: 329.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:34,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:56:34,697 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:34
2025-03-13 15:56:34,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:34,697 [INFO]: 	Creating the index 03/13/2025, 15:56:34
2025-03-13 15:56:34,697 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:34
2025-03-13 15:56:34,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:56:34,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:34
2025-03-13 15:56:34,698 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:56:34,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  4.69it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.74it/s] 57%|█████▋    | 4/7 [00:00<00:00,  9.87it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.36it/s]100%|██████████| 7/7 [00:02<00:00,  2.17it/s]100%|██████████| 7/7 [00:02<00:00,  3.18it/s]
2025-03-13 15:56:36,900 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:36
2025-03-13 15:56:56,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5838 secs
2025-03-13 15:56:56,485 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 15:56:56,485 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 15:57:14,380 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8949 secs
2025-03-13 15:57:14,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.9173 secs
2025-03-13 15:57:14,616 [INFO]: {
2025-03-13 15:57:14,616 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:14,616 [INFO]: 	index_param: efSearch=248
2025-03-13 15:57:14,616 [INFO]: 	index_path: knn.index
2025-03-13 15:57:14,616 [INFO]: 	size in bytes: 314396830
2025-03-13 15:57:14,616 [INFO]: 	avg_search_speed_ms: 10.197713399385686
2025-03-13 15:57:14,616 [INFO]: 	99p_search_speed_ms: 12.8727110568434
2025-03-13 15:57:14,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:14,616 [INFO]: 	nb vectors: 1598
2025-03-13 15:57:14,616 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:14,617 [INFO]: 	compression ratio: 0.999309007027838
2025-03-13 15:57:14,617 [INFO]: }
2025-03-13 15:57:14,617 [INFO]: 	>>> Finished "Creating the index" in 39.9196 secs
2025-03-13 15:57:14,617 [INFO]: >>> Finished "Launching the whole pipeline" in 39.9436 secs
2025-03-13 15:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17307 [episode count 6/20]
[retrieval_preprocessing] for episode 64028 [episode count 7/20], we have num_retrieval=np.int64(1592) num_query=np.int64(77)
2025-03-13 15:57:15,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:16,059 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:16
2025-03-13 15:57:16,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.36it/s]
2025-03-13 15:57:16,084 [INFO]: There are 1592 embeddings of dim 49152
2025-03-13 15:57:16,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 15:57:16,084 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:16,084 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:57:16,084 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:16,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:16,084 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,084 [INFO]: 328.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:16,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:16,084 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:16
2025-03-13 15:57:16,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:16,084 [INFO]: 	Creating the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:16
2025-03-13 15:57:16,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:57:16,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,085 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:57:16,086 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.55it/s] 43%|████▎     | 3/7 [00:00<00:00,  8.82it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.82it/s]100%|██████████| 7/7 [00:01<00:00,  2.88it/s]100%|██████████| 7/7 [00:01<00:00,  3.68it/s]
2025-03-13 15:57:17,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:17
2025-03-13 15:57:38,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6680 secs
2025-03-13 15:57:38,662 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:57:38,662 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 15:57:57,266 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6038 secs
2025-03-13 15:57:57,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1821 secs
2025-03-13 15:57:57,268 [INFO]: {
2025-03-13 15:57:57,268 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:57,268 [INFO]: 	index_param: efSearch=156
2025-03-13 15:57:57,268 [INFO]: 	index_path: knn.index
2025-03-13 15:57:57,268 [INFO]: 	size in bytes: 313216390
2025-03-13 15:57:57,268 [INFO]: 	avg_search_speed_ms: 7.362187888393719
2025-03-13 15:57:57,268 [INFO]: 	99p_search_speed_ms: 9.2914657574147
2025-03-13 15:57:57,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:57,268 [INFO]: 	nb vectors: 1592
2025-03-13 15:57:57,268 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:57,268 [INFO]: 	compression ratio: 0.9993089314387411
2025-03-13 15:57:57,268 [INFO]: }
2025-03-13 15:57:57,268 [INFO]: 	>>> Finished "Creating the index" in 41.1834 secs
2025-03-13 15:57:57,268 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2090 secs
2025-03-13 15:57:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 64028 [episode count 7/20]
[retrieval_preprocessing] for episode 58537 [episode count 8/20], we have num_retrieval=np.int64(1596) num_query=np.int64(73)
2025-03-13 15:57:58,168 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:58,424 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:58
2025-03-13 15:57:58,424 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2215.69it/s]
2025-03-13 15:57:58,448 [INFO]: There are 1596 embeddings of dim 49152
2025-03-13 15:57:58,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 15:57:58,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:58
2025-03-13 15:57:58,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:58,448 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:57:58,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:58,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:58,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:58
2025-03-13 15:57:58,448 [INFO]: 329.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:58,448 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:57:58,448 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:58
2025-03-13 15:57:58,448 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:58,448 [INFO]: 	Creating the index 03/13/2025, 15:57:58
2025-03-13 15:57:58,449 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:58
2025-03-13 15:57:58,449 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:57:58,449 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:58
2025-03-13 15:57:58,450 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:57:58,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  4.93it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.19it/s] 43%|████▎     | 3/7 [00:00<00:00,  6.52it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.75it/s] 71%|███████▏  | 5/7 [00:00<00:00,  6.79it/s] 86%|████████▌ | 6/7 [00:00<00:00,  7.04it/s]100%|██████████| 7/7 [00:02<00:00,  1.64it/s]100%|██████████| 7/7 [00:02<00:00,  2.83it/s]
2025-03-13 15:58:00,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:00
2025-03-13 15:58:26,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2193 secs
2025-03-13 15:58:26,143 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 15:58:26,143 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 15:58:49,210 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0665 secs
2025-03-13 15:58:49,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7622 secs
2025-03-13 15:58:49,212 [INFO]: {
2025-03-13 15:58:49,212 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:49,212 [INFO]: 	index_param: efSearch=247
2025-03-13 15:58:49,212 [INFO]: 	index_path: knn.index
2025-03-13 15:58:49,212 [INFO]: 	size in bytes: 314003350
2025-03-13 15:58:49,212 [INFO]: 	avg_search_speed_ms: 12.413779281139854
2025-03-13 15:58:49,212 [INFO]: 	99p_search_speed_ms: 20.42081040563062
2025-03-13 15:58:49,212 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:49,212 [INFO]: 	nb vectors: 1596
2025-03-13 15:58:49,212 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:49,212 [INFO]: 	compression ratio: 0.9993089818946199
2025-03-13 15:58:49,212 [INFO]: }
2025-03-13 15:58:49,212 [INFO]: 	>>> Finished "Creating the index" in 50.7636 secs
2025-03-13 15:58:49,212 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7877 secs
2025-03-13 15:58:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 58537 [episode count 8/20]
[retrieval_preprocessing] for episode 88106 [episode count 9/20], we have num_retrieval=np.int64(1587) num_query=np.int64(82)
2025-03-13 15:58:50,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:50,653 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:50
2025-03-13 15:58:50,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-13 15:58:50,682 [INFO]: There are 1587 embeddings of dim 49152
2025-03-13 15:58:50,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:58:50,683 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:50,683 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:58:50,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:50,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:58:50,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,684 [INFO]: 327.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:50,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:58:50,684 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:50
2025-03-13 15:58:50,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:50,684 [INFO]: 	Creating the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,684 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:50
2025-03-13 15:58:50,687 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:58:50,687 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:50
2025-03-13 15:58:50,687 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:58:50,687 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.36it/s] 29%|██▊       | 2/7 [00:00<00:00,  6.63it/s] 43%|████▎     | 3/7 [00:00<00:00,  7.69it/s] 71%|███████▏  | 5/7 [00:00<00:00,  9.02it/s] 86%|████████▌ | 6/7 [00:00<00:00,  8.58it/s]100%|██████████| 7/7 [00:02<00:00,  1.80it/s]100%|██████████| 7/7 [00:02<00:00,  2.95it/s]
2025-03-13 15:58:53,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:53
2025-03-13 15:59:17,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3925 secs
2025-03-13 15:59:17,455 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 15:59:17,455 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 15:59:38,017 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5617 secs
2025-03-13 15:59:38,019 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3318 secs
2025-03-13 15:59:38,019 [INFO]: {
2025-03-13 15:59:38,019 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:38,019 [INFO]: 	index_param: efSearch=215
2025-03-13 15:59:38,019 [INFO]: 	index_path: knn.index
2025-03-13 15:59:38,019 [INFO]: 	size in bytes: 312232690
2025-03-13 15:59:38,019 [INFO]: 	avg_search_speed_ms: 9.071845227443426
2025-03-13 15:59:38,019 [INFO]: 	99p_search_speed_ms: 12.191028394736351
2025-03-13 15:59:38,019 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:38,019 [INFO]: 	nb vectors: 1587
2025-03-13 15:59:38,019 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:38,019 [INFO]: 	compression ratio: 0.9993088680112259
2025-03-13 15:59:38,019 [INFO]: }
2025-03-13 15:59:38,019 [INFO]: 	>>> Finished "Creating the index" in 47.3352 secs
2025-03-13 15:59:38,019 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3663 secs
2025-03-13 15:59:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 88106 [episode count 9/20]
[retrieval_preprocessing] for episode 54075 [episode count 10/20], we have num_retrieval=np.int64(1587) num_query=np.int64(82)
2025-03-13 15:59:39,502 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:39,827 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:39
2025-03-13 15:59:39,827 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-13 15:59:39,851 [INFO]: There are 1587 embeddings of dim 49152
2025-03-13 15:59:39,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 15:59:39,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:39
2025-03-13 15:59:39,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:39,852 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 15:59:39,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:39,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:39,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:39
2025-03-13 15:59:39,852 [INFO]: 327.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:39,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:59:39,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:39
2025-03-13 15:59:39,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:39,852 [INFO]: 	Creating the index 03/13/2025, 15:59:39
2025-03-13 15:59:39,852 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:39
2025-03-13 15:59:39,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:59:39,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:39
2025-03-13 15:59:39,853 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 15:59:39,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.20it/s] 43%|████▎     | 3/7 [00:00<00:00, 10.23it/s] 86%|████████▌ | 6/7 [00:00<00:00, 16.94it/s]100%|██████████| 7/7 [00:02<00:00,  3.17it/s]
2025-03-13 15:59:42,070 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:42
2025-03-13 16:00:09,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2608 secs
2025-03-13 16:00:09,332 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 16:00:09,333 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 16:00:27,586 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2532 secs
2025-03-13 16:00:27,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8407 secs
2025-03-13 16:00:27,695 [INFO]: {
2025-03-13 16:00:27,695 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:27,695 [INFO]: 	index_param: efSearch=127
2025-03-13 16:00:27,695 [INFO]: 	index_path: knn.index
2025-03-13 16:00:27,695 [INFO]: 	size in bytes: 312232690
2025-03-13 16:00:27,695 [INFO]: 	avg_search_speed_ms: 9.242118659899218
2025-03-13 16:00:27,695 [INFO]: 	99p_search_speed_ms: 13.830635859631009
2025-03-13 16:00:27,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:27,695 [INFO]: 	nb vectors: 1587
2025-03-13 16:00:27,695 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:27,695 [INFO]: 	compression ratio: 0.9993088680112259
2025-03-13 16:00:27,695 [INFO]: }
2025-03-13 16:00:27,695 [INFO]: 	>>> Finished "Creating the index" in 47.8431 secs
2025-03-13 16:00:27,695 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8687 secs
2025-03-13 16:00:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 54075 [episode count 10/20]
[retrieval_preprocessing] for episode 78780 [episode count 11/20], we have num_retrieval=np.int64(1588) num_query=np.int64(81)
2025-03-13 16:00:28,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:28,557 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:28
2025-03-13 16:00:28,557 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.64it/s]
2025-03-13 16:00:28,605 [INFO]: There are 1588 embeddings of dim 49152
2025-03-13 16:00:28,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0482 secs
2025-03-13 16:00:28,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:28
2025-03-13 16:00:28,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:28,606 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:00:28,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:28,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:00:28,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:28
2025-03-13 16:00:28,607 [INFO]: 327.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:28,607 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 16:00:28,607 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:28
2025-03-13 16:00:28,607 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:28,608 [INFO]: 	Creating the index 03/13/2025, 16:00:28
2025-03-13 16:00:28,608 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:28
2025-03-13 16:00:28,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:00:28,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:28
2025-03-13 16:00:28,612 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:00:28,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.97it/s] 86%|████████▌ | 6/7 [00:00<00:00, 28.96it/s]100%|██████████| 7/7 [00:01<00:00,  4.31it/s]
2025-03-13 16:00:30,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:30
2025-03-13 16:01:05,867 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6208 secs
2025-03-13 16:01:05,867 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 16:01:05,867 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-13 16:01:27,830 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9627 secs
2025-03-13 16:01:27,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2200 secs
2025-03-13 16:01:27,832 [INFO]: {
2025-03-13 16:01:27,832 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:27,832 [INFO]: 	index_param: efSearch=148
2025-03-13 16:01:27,832 [INFO]: 	index_path: knn.index
2025-03-13 16:01:27,832 [INFO]: 	size in bytes: 312429430
2025-03-13 16:01:27,832 [INFO]: 	avg_search_speed_ms: 7.106509031535953
2025-03-13 16:01:27,832 [INFO]: 	99p_search_speed_ms: 12.419883734546602
2025-03-13 16:01:27,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:27,832 [INFO]: 	nb vectors: 1588
2025-03-13 16:01:27,832 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:27,832 [INFO]: 	compression ratio: 0.9993088807286816
2025-03-13 16:01:27,832 [INFO]: }
2025-03-13 16:01:27,832 [INFO]: 	>>> Finished "Creating the index" in 59.2246 secs
2025-03-13 16:01:27,832 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2750 secs
2025-03-13 16:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 78780 [episode count 11/20]
[retrieval_preprocessing] for episode 77248 [episode count 12/20], we have num_retrieval=np.int64(1577) num_query=np.int64(92)
2025-03-13 16:01:28,665 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:29,067 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:29
2025-03-13 16:01:29,067 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 834.52it/s]
2025-03-13 16:01:29,099 [INFO]: There are 1577 embeddings of dim 49152
2025-03-13 16:01:29,099 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 16:01:29,099 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:29
2025-03-13 16:01:29,099 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:29,099 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:01:29,099 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:29,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:29,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:29
2025-03-13 16:01:29,100 [INFO]: 325.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:29,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:01:29,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:29
2025-03-13 16:01:29,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:29,100 [INFO]: 	Creating the index 03/13/2025, 16:01:29
2025-03-13 16:01:29,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:29
2025-03-13 16:01:29,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:01:29,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:29
2025-03-13 16:01:29,101 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:01:29,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 19.44it/s]100%|██████████| 7/7 [00:01<00:00,  4.00it/s]100%|██████████| 7/7 [00:01<00:00,  4.28it/s]
2025-03-13 16:01:31,336 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:31
2025-03-13 16:01:58,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7340 secs
2025-03-13 16:01:58,071 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 16:01:58,071 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.41it/s] 50%|█████     | 2/4 [00:00<00:00,  4.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.75it/s]
2025-03-13 16:02:14,423 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3519 secs
2025-03-13 16:02:14,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3236 secs
2025-03-13 16:02:14,425 [INFO]: {
2025-03-13 16:02:14,425 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:14,425 [INFO]: 	index_param: efSearch=127
2025-03-13 16:02:14,425 [INFO]: 	index_path: knn.index
2025-03-13 16:02:14,425 [INFO]: 	size in bytes: 310265230
2025-03-13 16:02:14,425 [INFO]: 	avg_search_speed_ms: 10.204202994675736
2025-03-13 16:02:14,425 [INFO]: 	99p_search_speed_ms: 21.949779198039327
2025-03-13 16:02:14,425 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:14,425 [INFO]: 	nb vectors: 1577
2025-03-13 16:02:14,425 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:14,425 [INFO]: 	compression ratio: 0.9993089331988635
2025-03-13 16:02:14,425 [INFO]: }
2025-03-13 16:02:14,425 [INFO]: 	>>> Finished "Creating the index" in 45.3253 secs
2025-03-13 16:02:14,425 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3582 secs
2025-03-13 16:02:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 77248 [episode count 12/20]
[retrieval_preprocessing] for episode 37185 [episode count 13/20], we have num_retrieval=np.int64(1607) num_query=np.int64(62)
2025-03-13 16:02:16,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:16,956 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:16
2025-03-13 16:02:16,956 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1068.34it/s]
2025-03-13 16:02:17,001 [INFO]: There are 1607 embeddings of dim 49152
2025-03-13 16:02:17,001 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0454 secs
2025-03-13 16:02:17,001 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:17
2025-03-13 16:02:17,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:17,002 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:02:17,002 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:17,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:02:17,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:17
2025-03-13 16:02:17,003 [INFO]: 331.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:17,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:02:17,003 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:17
2025-03-13 16:02:17,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:17,004 [INFO]: 	Creating the index 03/13/2025, 16:02:17
2025-03-13 16:02:17,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:17
2025-03-13 16:02:17,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:02:17,007 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:17
2025-03-13 16:02:17,007 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:02:17,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 19.99it/s]100%|██████████| 7/7 [00:01<00:00,  4.07it/s]100%|██████████| 7/7 [00:01<00:00,  4.36it/s]
2025-03-13 16:02:18,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:18
2025-03-13 16:02:41,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7947 secs
2025-03-13 16:02:41,414 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:02:41,414 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.50it/s]
2025-03-13 16:03:00,081 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6668 secs
2025-03-13 16:03:00,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0758 secs
2025-03-13 16:03:00,083 [INFO]: {
2025-03-13 16:03:00,083 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:00,083 [INFO]: 	index_param: efSearch=172
2025-03-13 16:03:00,083 [INFO]: 	index_path: knn.index
2025-03-13 16:03:00,083 [INFO]: 	size in bytes: 316167550
2025-03-13 16:03:00,083 [INFO]: 	avg_search_speed_ms: 8.508453683412455
2025-03-13 16:03:00,083 [INFO]: 	99p_search_speed_ms: 13.593900697305797
2025-03-13 16:03:00,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:00,083 [INFO]: 	nb vectors: 1607
2025-03-13 16:03:00,083 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:00,083 [INFO]: 	compression ratio: 0.9993089297114773
2025-03-13 16:03:00,083 [INFO]: }
2025-03-13 16:03:00,083 [INFO]: 	>>> Finished "Creating the index" in 43.0793 secs
2025-03-13 16:03:00,083 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1273 secs
2025-03-13 16:03:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 37185 [episode count 13/20]
[retrieval_preprocessing] for episode 89930 [episode count 14/20], we have num_retrieval=np.int64(1593) num_query=np.int64(76)
2025-03-13 16:03:00,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:00,881 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:00
2025-03-13 16:03:00,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 826.30it/s]
2025-03-13 16:03:00,921 [INFO]: There are 1593 embeddings of dim 49152
2025-03-13 16:03:00,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 16:03:00,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:00
2025-03-13 16:03:00,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:00,922 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:03:00,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:00,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:03:00,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:00
2025-03-13 16:03:00,923 [INFO]: 328.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:00,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:03:00,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:00
2025-03-13 16:03:00,924 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:00,924 [INFO]: 	Creating the index 03/13/2025, 16:03:00
2025-03-13 16:03:00,924 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:00
2025-03-13 16:03:00,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:03:00,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:00
2025-03-13 16:03:00,927 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:03:00,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 26.08it/s]100%|██████████| 7/7 [00:01<00:00,  3.88it/s]100%|██████████| 7/7 [00:01<00:00,  4.35it/s]
2025-03-13 16:03:03,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:03
2025-03-13 16:03:26,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7798 secs
2025-03-13 16:03:26,115 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 16:03:26,115 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.97it/s]
2025-03-13 16:03:51,492 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3770 secs
2025-03-13 16:03:51,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5658 secs
2025-03-13 16:03:51,493 [INFO]: {
2025-03-13 16:03:51,493 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:51,493 [INFO]: 	index_param: efSearch=297
2025-03-13 16:03:51,493 [INFO]: 	index_path: knn.index
2025-03-13 16:03:51,493 [INFO]: 	size in bytes: 313413130
2025-03-13 16:03:51,493 [INFO]: 	avg_search_speed_ms: 10.460877682425268
2025-03-13 16:03:51,493 [INFO]: 	99p_search_speed_ms: 13.734065683092924
2025-03-13 16:03:51,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:51,493 [INFO]: 	nb vectors: 1593
2025-03-13 16:03:51,493 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:51,493 [INFO]: 	compression ratio: 0.9993089440764654
2025-03-13 16:03:51,493 [INFO]: }
2025-03-13 16:03:51,493 [INFO]: 	>>> Finished "Creating the index" in 50.5696 secs
2025-03-13 16:03:51,493 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6123 secs
2025-03-13 16:03:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 89930 [episode count 14/20]
[retrieval_preprocessing] for episode 25805 [episode count 15/20], we have num_retrieval=np.int64(1599) num_query=np.int64(70)
2025-03-13 16:03:52,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:52,278 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:52
2025-03-13 16:03:52,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 16:03:52,308 [INFO]: There are 1599 embeddings of dim 49152
2025-03-13 16:03:52,309 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:03:52,309 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:52
2025-03-13 16:03:52,309 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:52,309 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:03:52,310 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:52,310 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:03:52,310 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:52
2025-03-13 16:03:52,310 [INFO]: 330.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:52,310 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:03:52,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:52
2025-03-13 16:03:52,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:52,311 [INFO]: 	Creating the index 03/13/2025, 16:03:52
2025-03-13 16:03:52,311 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:52
2025-03-13 16:03:52,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:03:52,314 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:52
2025-03-13 16:03:52,315 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:03:52,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 27.99it/s]100%|██████████| 7/7 [00:01<00:00,  5.06it/s]100%|██████████| 7/7 [00:01<00:00,  5.65it/s]
2025-03-13 16:03:53,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:53
2025-03-13 16:04:15,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3963 secs
2025-03-13 16:04:15,957 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:04:15,957 [INFO]: 	Compute fast metrics 03/13/2025, 16:04:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.43it/s] 50%|█████     | 2/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.74it/s]
2025-03-13 16:04:35,147 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1902 secs
2025-03-13 16:04:35,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2358 secs
2025-03-13 16:04:35,551 [INFO]: {
2025-03-13 16:04:35,551 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:35,551 [INFO]: 	index_param: efSearch=192
2025-03-13 16:04:35,551 [INFO]: 	index_path: knn.index
2025-03-13 16:04:35,551 [INFO]: 	size in bytes: 314593570
2025-03-13 16:04:35,551 [INFO]: 	avg_search_speed_ms: 15.849799034370202
2025-03-13 16:04:35,551 [INFO]: 	99p_search_speed_ms: 24.037130107171873
2025-03-13 16:04:35,551 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:35,551 [INFO]: 	nb vectors: 1599
2025-03-13 16:04:35,551 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:35,551 [INFO]: 	compression ratio: 0.9993090195708705
2025-03-13 16:04:35,551 [INFO]: }
2025-03-13 16:04:35,552 [INFO]: 	>>> Finished "Creating the index" in 43.2404 secs
2025-03-13 16:04:35,552 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2733 secs
2025-03-13 16:04:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 25805 [episode count 15/20]
[retrieval_preprocessing] for episode 8015 [episode count 16/20], we have num_retrieval=np.int64(1587) num_query=np.int64(82)
2025-03-13 16:04:36,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:36,786 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:36
2025-03-13 16:04:36,786 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 717.10it/s]
2025-03-13 16:04:36,843 [INFO]: There are 1587 embeddings of dim 49152
2025-03-13 16:04:36,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0575 secs
2025-03-13 16:04:36,844 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,845 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:36,845 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:04:36,845 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:36,845 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:04:36,846 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,846 [INFO]: 327.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:36,846 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:04:36,846 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:36
2025-03-13 16:04:36,846 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:36,847 [INFO]: 	Creating the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,847 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:36
2025-03-13 16:04:36,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:04:36,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:36
2025-03-13 16:04:36,850 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:04:36,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.84it/s] 71%|███████▏  | 5/7 [00:00<00:00, 25.90it/s]100%|██████████| 7/7 [00:02<00:00,  3.10it/s]
2025-03-13 16:04:39,113 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:39
2025-03-13 16:05:06,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1473 secs
2025-03-13 16:05:06,261 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 16:05:06,261 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.59it/s]
2025-03-13 16:05:22,853 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5926 secs
2025-03-13 16:05:22,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0051 secs
2025-03-13 16:05:22,855 [INFO]: {
2025-03-13 16:05:22,855 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:22,855 [INFO]: 	index_param: efSearch=205
2025-03-13 16:05:22,855 [INFO]: 	index_path: knn.index
2025-03-13 16:05:22,855 [INFO]: 	size in bytes: 312232690
2025-03-13 16:05:22,855 [INFO]: 	avg_search_speed_ms: 10.914720518628387
2025-03-13 16:05:22,855 [INFO]: 	99p_search_speed_ms: 14.15928271599114
2025-03-13 16:05:22,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:22,855 [INFO]: 	nb vectors: 1587
2025-03-13 16:05:22,855 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:22,855 [INFO]: 	compression ratio: 0.9993088680112259
2025-03-13 16:05:22,855 [INFO]: }
2025-03-13 16:05:22,855 [INFO]: 	>>> Finished "Creating the index" in 46.0088 secs
2025-03-13 16:05:22,856 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0691 secs
2025-03-13 16:05:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 8015 [episode count 16/20]
[retrieval_preprocessing] for episode 22361 [episode count 17/20], we have num_retrieval=np.int64(1588) num_query=np.int64(81)
2025-03-13 16:05:24,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:24,353 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:24
2025-03-13 16:05:24,353 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1082.68it/s]
2025-03-13 16:05:24,390 [INFO]: There are 1588 embeddings of dim 49152
2025-03-13 16:05:24,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 16:05:24,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:24
2025-03-13 16:05:24,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:24,391 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:05:24,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:24,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:05:24,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:24
2025-03-13 16:05:24,392 [INFO]: 327.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:24,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:05:24,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:24
2025-03-13 16:05:24,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:24,392 [INFO]: 	Creating the index 03/13/2025, 16:05:24
2025-03-13 16:05:24,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:24
2025-03-13 16:05:24,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:05:24,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:24
2025-03-13 16:05:24,396 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:05:24,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 15.57it/s] 86%|████████▌ | 6/7 [00:00<00:00, 26.60it/s]100%|██████████| 7/7 [00:01<00:00,  3.93it/s]
2025-03-13 16:05:26,184 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:26
2025-03-13 16:05:45,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6073 secs
2025-03-13 16:05:45,792 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 16:05:45,792 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-13 16:06:03,599 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8064 secs
2025-03-13 16:06:03,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2046 secs
2025-03-13 16:06:03,600 [INFO]: {
2025-03-13 16:06:03,600 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:03,600 [INFO]: 	index_param: efSearch=215
2025-03-13 16:06:03,600 [INFO]: 	index_path: knn.index
2025-03-13 16:06:03,600 [INFO]: 	size in bytes: 312429430
2025-03-13 16:06:03,600 [INFO]: 	avg_search_speed_ms: 10.105591394581051
2025-03-13 16:06:03,600 [INFO]: 	99p_search_speed_ms: 16.134569137357182
2025-03-13 16:06:03,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:03,601 [INFO]: 	nb vectors: 1588
2025-03-13 16:06:03,601 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:03,601 [INFO]: 	compression ratio: 0.9993088807286816
2025-03-13 16:06:03,601 [INFO]: }
2025-03-13 16:06:03,601 [INFO]: 	>>> Finished "Creating the index" in 39.2082 secs
2025-03-13 16:06:03,601 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2473 secs
2025-03-13 16:06:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 22361 [episode count 17/20]
[retrieval_preprocessing] for episode 71386 [episode count 18/20], we have num_retrieval=np.int64(1547) num_query=np.int64(122)
2025-03-13 16:06:04,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:04,666 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:04
2025-03-13 16:06:04,666 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-13 16:06:04,707 [INFO]: There are 1547 embeddings of dim 49152
2025-03-13 16:06:04,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0405 secs
2025-03-13 16:06:04,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:04,708 [INFO]: 		-> Add: 0.8 seconds
2025-03-13 16:06:04,708 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:04,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:06:04,708 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,708 [INFO]: 319.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:04,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:06:04,708 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:04
2025-03-13 16:06:04,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:04,709 [INFO]: 	Creating the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,709 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:04
2025-03-13 16:06:04,712 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:06:04,712 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,712 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:06:04,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.79it/s]100%|██████████| 7/7 [00:01<00:00,  3.98it/s]100%|██████████| 7/7 [00:01<00:00,  4.27it/s]
2025-03-13 16:06:06,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:06
2025-03-13 16:06:30,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3364 secs
2025-03-13 16:06:30,695 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:06:30,695 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 16:06:54,518 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8227 secs
2025-03-13 16:06:54,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8065 secs
2025-03-13 16:06:54,519 [INFO]: {
2025-03-13 16:06:54,519 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:54,519 [INFO]: 	index_param: efSearch=207
2025-03-13 16:06:54,519 [INFO]: 	index_path: knn.index
2025-03-13 16:06:54,519 [INFO]: 	size in bytes: 304362910
2025-03-13 16:06:54,519 [INFO]: 	avg_search_speed_ms: 9.462093300465407
2025-03-13 16:06:54,519 [INFO]: 	99p_search_speed_ms: 13.561306800693275
2025-03-13 16:06:54,519 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:54,519 [INFO]: 	nb vectors: 1547
2025-03-13 16:06:54,519 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:54,519 [INFO]: 	compression ratio: 0.9993089368215069
2025-03-13 16:06:54,519 [INFO]: }
2025-03-13 16:06:54,519 [INFO]: 	>>> Finished "Creating the index" in 49.8102 secs
2025-03-13 16:06:54,519 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8528 secs
2025-03-13 16:06:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 71386 [episode count 18/20]
[retrieval_preprocessing] for episode 83930 [episode count 19/20], we have num_retrieval=np.int64(1559) num_query=np.int64(110)
2025-03-13 16:06:55,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:55,829 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:55
2025-03-13 16:06:55,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.30it/s]
2025-03-13 16:06:55,859 [INFO]: There are 1559 embeddings of dim 49152
2025-03-13 16:06:55,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 16:06:55,860 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:55
2025-03-13 16:06:55,860 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:55,860 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:06:55,860 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:55,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:55,860 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:55
2025-03-13 16:06:55,860 [INFO]: 321.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:55,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:06:55,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:55
2025-03-13 16:06:55,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:55,860 [INFO]: 	Creating the index 03/13/2025, 16:06:55
2025-03-13 16:06:55,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:55
2025-03-13 16:06:55,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 16:06:55,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:55
2025-03-13 16:06:55,861 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:06:55,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.45it/s] 71%|███████▏  | 5/7 [00:00<00:00, 25.58it/s]100%|██████████| 7/7 [00:01<00:00,  4.13it/s]
2025-03-13 16:06:57,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:57
2025-03-13 16:07:19,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.6532 secs
2025-03-13 16:07:19,211 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 16:07:19,211 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 16:07:35,913 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7016 secs
2025-03-13 16:07:35,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.0534 secs
2025-03-13 16:07:35,915 [INFO]: {
2025-03-13 16:07:35,915 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:35,915 [INFO]: 	index_param: efSearch=138
2025-03-13 16:07:35,915 [INFO]: 	index_path: knn.index
2025-03-13 16:07:35,915 [INFO]: 	size in bytes: 306723850
2025-03-13 16:07:35,915 [INFO]: 	avg_search_speed_ms: 8.185757832630628
2025-03-13 16:07:35,915 [INFO]: 	99p_search_speed_ms: 12.703360216692086
2025-03-13 16:07:35,915 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:35,915 [INFO]: 	nb vectors: 1559
2025-03-13 16:07:35,915 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:35,915 [INFO]: 	compression ratio: 0.9993088962596159
2025-03-13 16:07:35,915 [INFO]: }
2025-03-13 16:07:35,915 [INFO]: 	>>> Finished "Creating the index" in 40.0546 secs
2025-03-13 16:07:35,915 [INFO]: >>> Finished "Launching the whole pipeline" in 40.0860 secs
2025-03-13 16:07:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 83930 [episode count 19/20]
2025-03-13 16:07:36: [retrieval_preprocessing] finished for 52817038_green_block_in_black_bowl [chosen_id count 3/196]
2025-03-13 16:07:38: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5374398722_close_laptop [chosen_id count 4/196]
2025-03-13 16:07:38: [retrieval_preprocessing] we have num_total=3348 embedding_dim=49152
[retrieval_preprocessing] for episode 95232 [episode count 0/20], we have num_retrieval=np.int64(3198) num_query=np.int64(150)
2025-03-13 16:07:38,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:39,874 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:39
2025-03-13 16:07:39,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.00it/s]
2025-03-13 16:07:39,916 [INFO]: There are 3198 embeddings of dim 49152
2025-03-13 16:07:39,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0424 secs
2025-03-13 16:07:39,917 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:39
2025-03-13 16:07:39,917 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:39,917 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:07:39,917 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:39,917 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:39,917 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:39
2025-03-13 16:07:39,917 [INFO]: 660.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:39,917 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:39,917 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:39
2025-03-13 16:07:39,917 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:39,917 [INFO]: 	Creating the index 03/13/2025, 16:07:39
2025-03-13 16:07:39,917 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:39
2025-03-13 16:07:39,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:07:39,918 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:39
2025-03-13 16:07:39,918 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:07:39,918 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.19it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.73it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]
2025-03-13 16:07:43,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:43
2025-03-13 16:08:25,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6813 secs
2025-03-13 16:08:25,252 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 16:08:25,253 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 16:08:38,590 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3373 secs
2025-03-13 16:08:38,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6740 secs
2025-03-13 16:08:38,592 [INFO]: {
2025-03-13 16:08:38,592 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:38,592 [INFO]: 	index_param: efSearch=167
2025-03-13 16:08:38,592 [INFO]: 	index_path: knn.index
2025-03-13 16:08:38,592 [INFO]: 	size in bytes: 629186650
2025-03-13 16:08:38,592 [INFO]: 	avg_search_speed_ms: 9.74227595161157
2025-03-13 16:08:38,592 [INFO]: 	99p_search_speed_ms: 13.994857766665518
2025-03-13 16:08:38,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:38,592 [INFO]: 	nb vectors: 3198
2025-03-13 16:08:38,592 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:38,592 [INFO]: 	compression ratio: 0.9993097978159581
2025-03-13 16:08:38,592 [INFO]: }
2025-03-13 16:08:38,592 [INFO]: 	>>> Finished "Creating the index" in 58.6754 secs
2025-03-13 16:08:38,592 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7183 secs
2025-03-13 16:08:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 95232 [episode count 0/20]
[retrieval_preprocessing] for episode 90128 [episode count 1/20], we have num_retrieval=np.int64(3174) num_query=np.int64(174)
2025-03-13 16:08:39,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:41,049 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:41
2025-03-13 16:08:41,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1824.40it/s]
2025-03-13 16:08:41,085 [INFO]: There are 3174 embeddings of dim 49152
2025-03-13 16:08:41,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 16:08:41,085 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:41
2025-03-13 16:08:41,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:41,086 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:08:41,086 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:41,086 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:08:41,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:41
2025-03-13 16:08:41,087 [INFO]: 655.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:41,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:08:41,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:41
2025-03-13 16:08:41,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:41,088 [INFO]: 	Creating the index 03/13/2025, 16:08:41
2025-03-13 16:08:41,088 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:41
2025-03-13 16:08:41,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:08:41,091 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:41
2025-03-13 16:08:41,091 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:08:41,091 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.68it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.79it/s] 92%|█████████▏| 12/13 [00:00<00:00, 42.13it/s]100%|██████████| 13/13 [00:02<00:00,  4.54it/s]
2025-03-13 16:08:43,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:43
2025-03-13 16:09:21,724 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7594 secs
2025-03-13 16:09:21,724 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:09:21,724 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 16:10:09,811 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0861 secs
2025-03-13 16:10:09,815 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.7233 secs
2025-03-13 16:10:09,815 [INFO]: {
2025-03-13 16:10:09,815 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:09,815 [INFO]: 	index_param: efSearch=193
2025-03-13 16:10:09,815 [INFO]: 	index_path: knn.index
2025-03-13 16:10:09,815 [INFO]: 	size in bytes: 624464830
2025-03-13 16:10:09,815 [INFO]: 	avg_search_speed_ms: 12.270984303297624
2025-03-13 16:10:09,815 [INFO]: 	99p_search_speed_ms: 16.94148710463196
2025-03-13 16:10:09,815 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:09,815 [INFO]: 	nb vectors: 3174
2025-03-13 16:10:09,815 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:09,815 [INFO]: 	compression ratio: 0.9993097481566736
2025-03-13 16:10:09,815 [INFO]: }
2025-03-13 16:10:09,815 [INFO]: 	>>> Finished "Creating the index" in 88.7273 secs
2025-03-13 16:10:09,815 [INFO]: >>> Finished "Launching the whole pipeline" in 88.7655 secs
2025-03-13 16:10:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 90128 [episode count 1/20]
[retrieval_preprocessing] for episode 69139 [episode count 2/20], we have num_retrieval=np.int64(3216) num_query=np.int64(132)
2025-03-13 16:10:13,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:14,437 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:14
2025-03-13 16:10:14,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 847.85it/s]
2025-03-13 16:10:14,471 [INFO]: There are 3216 embeddings of dim 49152
2025-03-13 16:10:14,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 16:10:14,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:14,472 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:10:14,472 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:14,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:10:14,473 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,473 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:14,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 16:10:14,474 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:14
2025-03-13 16:10:14,474 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:14,474 [INFO]: 	Creating the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,474 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:14
2025-03-13 16:10:14,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:10:14,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:14
2025-03-13 16:10:14,478 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:10:14,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.12it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.57it/s] 31%|███       | 4/13 [00:00<00:01,  8.93it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.13it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.95it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.15it/s]100%|██████████| 13/13 [00:04<00:00,  1.40it/s]100%|██████████| 13/13 [00:04<00:00,  2.65it/s]
2025-03-13 16:10:19,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:19
2025-03-13 16:11:02,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7564 secs
2025-03-13 16:11:02,152 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 16:11:02,152 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-13 16:11:26,265 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1130 secs
2025-03-13 16:11:26,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7907 secs
2025-03-13 16:11:26,269 [INFO]: {
2025-03-13 16:11:26,269 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:26,269 [INFO]: 	index_param: efSearch=194
2025-03-13 16:11:26,269 [INFO]: 	index_path: knn.index
2025-03-13 16:11:26,269 [INFO]: 	size in bytes: 632728030
2025-03-13 16:11:26,269 [INFO]: 	avg_search_speed_ms: 9.63647602738809
2025-03-13 16:11:26,269 [INFO]: 	99p_search_speed_ms: 14.171275454573308
2025-03-13 16:11:26,269 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:26,269 [INFO]: 	nb vectors: 3216
2025-03-13 16:11:26,269 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:26,269 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-13 16:11:26,269 [INFO]: }
2025-03-13 16:11:26,269 [INFO]: 	>>> Finished "Creating the index" in 71.7949 secs
2025-03-13 16:11:26,269 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8321 secs
2025-03-13 16:11:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 69139 [episode count 2/20]
[retrieval_preprocessing] for episode 43555 [episode count 3/20], we have num_retrieval=np.int64(3228) num_query=np.int64(120)
2025-03-13 16:11:28,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:29,366 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:29
2025-03-13 16:11:29,366 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 16:11:29,394 [INFO]: There are 3228 embeddings of dim 49152
2025-03-13 16:11:29,395 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:11:29,395 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:29
2025-03-13 16:11:29,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:29,395 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:11:29,396 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:29,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:11:29,396 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:29
2025-03-13 16:11:29,396 [INFO]: 666.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:29,396 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:11:29,397 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:29
2025-03-13 16:11:29,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:29,397 [INFO]: 	Creating the index 03/13/2025, 16:11:29
2025-03-13 16:11:29,397 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:29
2025-03-13 16:11:29,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:11:29,401 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:29
2025-03-13 16:11:29,401 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:11:29,402 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.89it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.60it/s] 31%|███       | 4/13 [00:00<00:01,  8.92it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.11it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.59it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.96it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.90it/s] 92%|█████████▏| 12/13 [00:01<00:00, 10.30it/s]100%|██████████| 13/13 [00:03<00:00,  3.55it/s]
2025-03-13 16:11:33,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:33
2025-03-13 16:12:09,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2629 secs
2025-03-13 16:12:09,341 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 16:12:09,341 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 16:12:35,890 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5493 secs
2025-03-13 16:12:35,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5814 secs
2025-03-13 16:12:35,983 [INFO]: {
2025-03-13 16:12:35,983 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:35,983 [INFO]: 	index_param: efSearch=178
2025-03-13 16:12:35,983 [INFO]: 	index_path: knn.index
2025-03-13 16:12:35,983 [INFO]: 	size in bytes: 635089210
2025-03-13 16:12:35,983 [INFO]: 	avg_search_speed_ms: 8.520932542874114
2025-03-13 16:12:35,983 [INFO]: 	99p_search_speed_ms: 12.767674671486017
2025-03-13 16:12:35,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:35,983 [INFO]: 	nb vectors: 3228
2025-03-13 16:12:35,983 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:35,984 [INFO]: 	compression ratio: 0.9993094104055082
2025-03-13 16:12:35,984 [INFO]: }
2025-03-13 16:12:35,984 [INFO]: 	>>> Finished "Creating the index" in 66.5865 secs
2025-03-13 16:12:35,984 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6181 secs
2025-03-13 16:12:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 43555 [episode count 3/20]
[retrieval_preprocessing] for episode 34378 [episode count 4/20], we have num_retrieval=np.int64(3168) num_query=np.int64(180)
2025-03-13 16:12:38,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:38,827 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:38
2025-03-13 16:12:38,827 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.04it/s]
2025-03-13 16:12:38,851 [INFO]: There are 3168 embeddings of dim 49152
2025-03-13 16:12:38,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 16:12:38,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:38
2025-03-13 16:12:38,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:38,851 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:12:38,851 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:38,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:38,851 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:38
2025-03-13 16:12:38,851 [INFO]: 653.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:38,851 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:12:38,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:38
2025-03-13 16:12:38,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:38,852 [INFO]: 	Creating the index 03/13/2025, 16:12:38
2025-03-13 16:12:38,852 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:38
2025-03-13 16:12:38,852 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:12:38,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:38
2025-03-13 16:12:38,853 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:12:38,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.32it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.85it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.04it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.51it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.54it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.73it/s]100%|██████████| 13/13 [00:03<00:00,  2.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.88it/s]
2025-03-13 16:12:42,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:42
2025-03-13 16:13:18,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7693 secs
2025-03-13 16:13:18,978 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:13:18,978 [INFO]: 	Compute fast metrics 03/13/2025, 16:13:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.57s/it] 50%|█████     | 2/4 [00:08<00:08,  4.20s/it] 75%|███████▌  | 3/4 [00:11<00:04,  4.01s/it] 75%|███████▌  | 3/4 [00:14<00:04,  4.99s/it]
2025-03-13 16:14:03,944 [INFO]: 	>>> Finished "Compute fast metrics" in 44.9657 secs
2025-03-13 16:14:03,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.0951 secs
2025-03-13 16:14:03,948 [INFO]: {
2025-03-13 16:14:03,948 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:03,948 [INFO]: 	index_param: efSearch=172
2025-03-13 16:14:03,948 [INFO]: 	index_path: knn.index
2025-03-13 16:14:03,948 [INFO]: 	size in bytes: 623284390
2025-03-13 16:14:03,948 [INFO]: 	avg_search_speed_ms: 9.086658497832438
2025-03-13 16:14:03,948 [INFO]: 	99p_search_speed_ms: 17.38579012453556
2025-03-13 16:14:03,948 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:03,948 [INFO]: 	nb vectors: 3168
2025-03-13 16:14:03,948 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:03,948 [INFO]: 	compression ratio: 0.9993097115748398
2025-03-13 16:14:03,948 [INFO]: }
2025-03-13 16:14:03,948 [INFO]: 	>>> Finished "Creating the index" in 85.0964 secs
2025-03-13 16:14:03,948 [INFO]: >>> Finished "Launching the whole pipeline" in 85.1208 secs
2025-03-13 16:14:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 34378 [episode count 4/20]
[retrieval_preprocessing] for episode 1113 [episode count 5/20], we have num_retrieval=np.int64(3178) num_query=np.int64(170)
2025-03-13 16:14:07,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:08,321 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:08
2025-03-13 16:14:08,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 956.73it/s]
2025-03-13 16:14:08,347 [INFO]: There are 3178 embeddings of dim 49152
2025-03-13 16:14:08,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 16:14:08,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:08
2025-03-13 16:14:08,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:08,348 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:14:08,348 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:08,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:08,348 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:08
2025-03-13 16:14:08,348 [INFO]: 655.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:08,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:08,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:08
2025-03-13 16:14:08,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:08,348 [INFO]: 	Creating the index 03/13/2025, 16:14:08
2025-03-13 16:14:08,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:08
2025-03-13 16:14:08,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:14:08,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:08
2025-03-13 16:14:08,350 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:14:08,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:01<00:19,  1.66s/it] 15%|█▌        | 2/13 [00:01<00:08,  1.24it/s] 23%|██▎       | 3/13 [00:02<00:07,  1.38it/s] 31%|███       | 4/13 [00:02<00:04,  1.97it/s] 38%|███▊      | 5/13 [00:03<00:03,  2.07it/s] 46%|████▌     | 6/13 [00:03<00:02,  2.71it/s] 54%|█████▍    | 7/13 [00:04<00:04,  1.39it/s] 62%|██████▏   | 8/13 [00:07<00:07,  1.45s/it] 69%|██████▉   | 9/13 [00:11<00:09,  2.27s/it] 85%|████████▍ | 11/13 [00:11<00:02,  1.24s/it]100%|██████████| 13/13 [00:14<00:00,  1.17s/it]100%|██████████| 13/13 [00:14<00:00,  1.08s/it]
2025-03-13 16:14:22,454 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:22
2025-03-13 16:14:59,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6786 secs
2025-03-13 16:14:59,133 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:14:59,134 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 50%|█████     | 2/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 16:15:19,056 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9227 secs
2025-03-13 16:15:19,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7159 secs
2025-03-13 16:15:19,066 [INFO]: {
2025-03-13 16:15:19,066 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:19,066 [INFO]: 	index_param: efSearch=237
2025-03-13 16:15:19,066 [INFO]: 	index_path: knn.index
2025-03-13 16:15:19,066 [INFO]: 	size in bytes: 625251850
2025-03-13 16:15:19,066 [INFO]: 	avg_search_speed_ms: 11.655940052278183
2025-03-13 16:15:19,066 [INFO]: 	99p_search_speed_ms: 20.786292855627828
2025-03-13 16:15:19,066 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:19,066 [INFO]: 	nb vectors: 3178
2025-03-13 16:15:19,066 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:19,066 [INFO]: 	compression ratio: 0.9993096765727283
2025-03-13 16:15:19,066 [INFO]: }
2025-03-13 16:15:19,066 [INFO]: 	>>> Finished "Creating the index" in 70.7178 secs
2025-03-13 16:15:19,066 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7446 secs
2025-03-13 16:15:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 1113 [episode count 5/20]
[retrieval_preprocessing] for episode 71811 [episode count 6/20], we have num_retrieval=np.int64(3200) num_query=np.int64(148)
2025-03-13 16:15:29,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:29,896 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:29
2025-03-13 16:15:29,896 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.11it/s]
2025-03-13 16:15:29,918 [INFO]: There are 3200 embeddings of dim 49152
2025-03-13 16:15:29,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 16:15:29,918 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:29
2025-03-13 16:15:29,919 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:29,919 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:15:29,919 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:29,919 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:29,919 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:29
2025-03-13 16:15:29,919 [INFO]: 660.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:29,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:15:29,919 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:29
2025-03-13 16:15:29,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:29,919 [INFO]: 	Creating the index 03/13/2025, 16:15:29
2025-03-13 16:15:29,919 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:29
2025-03-13 16:15:29,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:15:29,920 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:29
2025-03-13 16:15:29,920 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:15:29,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.12it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.16it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.97it/s] 31%|███       | 4/13 [00:00<00:01,  8.41it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.37it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.69it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.86it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.59it/s]100%|██████████| 13/13 [00:04<00:00,  1.52it/s]100%|██████████| 13/13 [00:04<00:00,  3.19it/s]
2025-03-13 16:15:34,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:34
2025-03-13 16:16:14,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3372 secs
2025-03-13 16:16:14,341 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:16:14,341 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 16:16:43,169 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8272 secs
2025-03-13 16:16:43,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2510 secs
2025-03-13 16:16:43,171 [INFO]: {
2025-03-13 16:16:43,171 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:43,171 [INFO]: 	index_param: efSearch=238
2025-03-13 16:16:43,171 [INFO]: 	index_path: knn.index
2025-03-13 16:16:43,171 [INFO]: 	size in bytes: 629580130
2025-03-13 16:16:43,171 [INFO]: 	avg_search_speed_ms: 10.464105950658713
2025-03-13 16:16:43,171 [INFO]: 	99p_search_speed_ms: 15.471684932708742
2025-03-13 16:16:43,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:43,171 [INFO]: 	nb vectors: 3200
2025-03-13 16:16:43,171 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:43,171 [INFO]: 	compression ratio: 0.999309809856928
2025-03-13 16:16:43,171 [INFO]: }
2025-03-13 16:16:43,171 [INFO]: 	>>> Finished "Creating the index" in 73.2524 secs
2025-03-13 16:16:43,172 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2751 secs
2025-03-13 16:16:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 71811 [episode count 6/20]
[retrieval_preprocessing] for episode 68740 [episode count 7/20], we have num_retrieval=np.int64(3214) num_query=np.int64(134)
2025-03-13 16:16:47,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:48,421 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:48
2025-03-13 16:16:48,421 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]
2025-03-13 16:16:48,445 [INFO]: There are 3214 embeddings of dim 49152
2025-03-13 16:16:48,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 16:16:48,446 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:48
2025-03-13 16:16:48,446 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:48,446 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:16:48,446 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:48,446 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:16:48,446 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:48
2025-03-13 16:16:48,446 [INFO]: 663.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:48,446 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:16:48,446 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:48
2025-03-13 16:16:48,446 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:48,446 [INFO]: 	Creating the index 03/13/2025, 16:16:48
2025-03-13 16:16:48,446 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:48
2025-03-13 16:16:48,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:16:48,447 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:48
2025-03-13 16:16:48,447 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:16:48,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.59it/s] 31%|███       | 4/13 [00:00<00:01,  5.01it/s] 38%|███▊      | 5/13 [00:00<00:01,  5.77it/s] 46%|████▌     | 6/13 [00:01<00:01,  6.17it/s] 54%|█████▍    | 7/13 [00:01<00:00,  6.40it/s] 62%|██████▏   | 8/13 [00:01<00:00,  6.63it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.73it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.95it/s]100%|██████████| 13/13 [00:04<00:00,  1.38it/s]100%|██████████| 13/13 [00:04<00:00,  3.02it/s]
2025-03-13 16:16:53,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:53
2025-03-13 16:17:30,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3077 secs
2025-03-13 16:17:30,550 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 16:17:30,550 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.70it/s] 50%|█████     | 2/4 [00:01<00:01,  1.38it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.16it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.82it/s]
2025-03-13 16:17:51,690 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1396 secs
2025-03-13 16:17:51,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2469 secs
2025-03-13 16:17:51,694 [INFO]: {
2025-03-13 16:17:51,694 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:51,694 [INFO]: 	index_param: efSearch=183
2025-03-13 16:17:51,694 [INFO]: 	index_path: knn.index
2025-03-13 16:17:51,694 [INFO]: 	size in bytes: 632334550
2025-03-13 16:17:51,694 [INFO]: 	avg_search_speed_ms: 9.737181628237188
2025-03-13 16:17:51,695 [INFO]: 	99p_search_speed_ms: 14.723986140452327
2025-03-13 16:17:51,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:51,695 [INFO]: 	nb vectors: 3214
2025-03-13 16:17:51,695 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:51,695 [INFO]: 	compression ratio: 0.9993097989031281
2025-03-13 16:17:51,695 [INFO]: }
2025-03-13 16:17:51,695 [INFO]: 	>>> Finished "Creating the index" in 63.2484 secs
2025-03-13 16:17:51,695 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2732 secs
2025-03-13 16:17:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 68740 [episode count 7/20]
[retrieval_preprocessing] for episode 52359 [episode count 8/20], we have num_retrieval=np.int64(3209) num_query=np.int64(139)
2025-03-13 16:17:53,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:54,637 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:54
2025-03-13 16:17:54,637 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.10it/s]
2025-03-13 16:17:54,662 [INFO]: There are 3209 embeddings of dim 49152
2025-03-13 16:17:54,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:17:54,663 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:54,663 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:17:54,663 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:54,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:54,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,663 [INFO]: 662.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:54,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:17:54,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:54
2025-03-13 16:17:54,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:54,663 [INFO]: 	Creating the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,663 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:54
2025-03-13 16:17:54,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:17:54,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:54
2025-03-13 16:17:54,664 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:17:54,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.88it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.68it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.84it/s] 31%|███       | 4/13 [00:00<00:01,  6.91it/s] 38%|███▊      | 5/13 [00:00<00:01,  6.98it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.10it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.39it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.65it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.99it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.22it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.31it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.65it/s]100%|██████████| 13/13 [00:04<00:00,  1.12it/s]100%|██████████| 13/13 [00:04<00:00,  3.07it/s]
2025-03-13 16:17:58,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:58
2025-03-13 16:18:34,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2882 secs
2025-03-13 16:18:34,197 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:18:34,197 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 16:18:57,967 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7693 secs
2025-03-13 16:18:57,969 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3050 secs
2025-03-13 16:18:57,969 [INFO]: {
2025-03-13 16:18:57,969 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:57,969 [INFO]: 	index_param: efSearch=236
2025-03-13 16:18:57,969 [INFO]: 	index_path: knn.index
2025-03-13 16:18:57,970 [INFO]: 	size in bytes: 631350850
2025-03-13 16:18:57,970 [INFO]: 	avg_search_speed_ms: 9.917535972947787
2025-03-13 16:18:57,970 [INFO]: 	99p_search_speed_ms: 14.63184401625767
2025-03-13 16:18:57,970 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:57,970 [INFO]: 	nb vectors: 3209
2025-03-13 16:18:57,970 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:57,970 [INFO]: 	compression ratio: 0.9993097688868242
2025-03-13 16:18:57,970 [INFO]: }
2025-03-13 16:18:57,970 [INFO]: 	>>> Finished "Creating the index" in 63.3064 secs
2025-03-13 16:18:57,970 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3326 secs
2025-03-13 16:18:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 52359 [episode count 8/20]
[retrieval_preprocessing] for episode 21131 [episode count 9/20], we have num_retrieval=np.int64(3160) num_query=np.int64(188)
2025-03-13 16:18:59,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:01,247 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:01
2025-03-13 16:19:01,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.13it/s]
2025-03-13 16:19:01,269 [INFO]: There are 3160 embeddings of dim 49152
2025-03-13 16:19:01,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 16:19:01,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:01,269 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:19:01,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:01,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:01,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,270 [INFO]: 652.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:01,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:19:01,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:01
2025-03-13 16:19:01,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:01,270 [INFO]: 	Creating the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:01
2025-03-13 16:19:01,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:19:01,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,271 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:19:01,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.16it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.40it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.97it/s] 31%|███       | 4/13 [00:00<00:01,  7.25it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.38it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.14it/s] 54%|█████▍    | 7/13 [00:01<00:00,  6.30it/s] 62%|██████▏   | 8/13 [00:01<00:00,  6.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.58it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.84it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.95it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.10it/s]100%|██████████| 13/13 [00:05<00:00,  1.21s/it]100%|██████████| 13/13 [00:05<00:00,  2.39it/s]
2025-03-13 16:19:06,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:06
2025-03-13 16:19:42,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3387 secs
2025-03-13 16:19:42,060 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 16:19:42,060 [INFO]: 	Compute fast metrics 03/13/2025, 16:19:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 16:20:10,549 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4890 secs
2025-03-13 16:20:10,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2803 secs
2025-03-13 16:20:10,552 [INFO]: {
2025-03-13 16:20:10,552 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:10,552 [INFO]: 	index_param: efSearch=165
2025-03-13 16:20:10,552 [INFO]: 	index_path: knn.index
2025-03-13 16:20:10,552 [INFO]: 	size in bytes: 621710470
2025-03-13 16:20:10,552 [INFO]: 	avg_search_speed_ms: 8.277072101894655
2025-03-13 16:20:10,552 [INFO]: 	99p_search_speed_ms: 11.930461735464636
2025-03-13 16:20:10,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:10,552 [INFO]: 	nb vectors: 3160
2025-03-13 16:20:10,552 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:10,552 [INFO]: 	compression ratio: 0.9993096625829705
2025-03-13 16:20:10,552 [INFO]: }
2025-03-13 16:20:10,552 [INFO]: 	>>> Finished "Creating the index" in 69.2819 secs
2025-03-13 16:20:10,552 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3042 secs
2025-03-13 16:20:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 21131 [episode count 9/20]
[retrieval_preprocessing] for episode 94382 [episode count 10/20], we have num_retrieval=np.int64(3211) num_query=np.int64(137)
2025-03-13 16:20:12,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:13,374 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:13
2025-03-13 16:20:13,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 16:20:13,399 [INFO]: There are 3211 embeddings of dim 49152
2025-03-13 16:20:13,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:20:13,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:13
2025-03-13 16:20:13,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:13,400 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:20:13,400 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:13,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:20:13,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:13
2025-03-13 16:20:13,401 [INFO]: 662.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:13,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:20:13,402 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:13
2025-03-13 16:20:13,402 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:13,402 [INFO]: 	Creating the index 03/13/2025, 16:20:13
2025-03-13 16:20:13,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:13
2025-03-13 16:20:13,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:20:13,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:13
2025-03-13 16:20:13,405 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:20:13,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.81it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.00it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.32it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.15it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.81it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.08it/s]100%|██████████| 13/13 [00:04<00:00,  1.76it/s]100%|██████████| 13/13 [00:04<00:00,  3.14it/s]
2025-03-13 16:20:17,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:17
2025-03-13 16:20:53,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1917 secs
2025-03-13 16:20:53,741 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:20:53,741 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.34it/s] 50%|█████     | 2/4 [00:00<00:00,  4.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.91it/s]
2025-03-13 16:21:24,561 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8200 secs
2025-03-13 16:21:24,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1589 secs
2025-03-13 16:21:24,564 [INFO]: {
2025-03-13 16:21:24,564 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:24,564 [INFO]: 	index_param: efSearch=207
2025-03-13 16:21:24,564 [INFO]: 	index_path: knn.index
2025-03-13 16:21:24,564 [INFO]: 	size in bytes: 631744330
2025-03-13 16:21:24,564 [INFO]: 	avg_search_speed_ms: 9.893222649339458
2025-03-13 16:21:24,564 [INFO]: 	99p_search_speed_ms: 15.973860723897813
2025-03-13 16:21:24,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:24,564 [INFO]: 	nb vectors: 3211
2025-03-13 16:21:24,564 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:24,564 [INFO]: 	compression ratio: 0.9993097809045631
2025-03-13 16:21:24,564 [INFO]: }
2025-03-13 16:21:24,564 [INFO]: 	>>> Finished "Creating the index" in 71.1622 secs
2025-03-13 16:21:24,564 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1901 secs
2025-03-13 16:21:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 94382 [episode count 10/20]
[retrieval_preprocessing] for episode 73906 [episode count 11/20], we have num_retrieval=np.int64(3138) num_query=np.int64(210)
2025-03-13 16:21:28,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:29,357 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:29
2025-03-13 16:21:29,357 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1768.26it/s]
2025-03-13 16:21:29,381 [INFO]: There are 3138 embeddings of dim 49152
2025-03-13 16:21:29,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:21:29,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:29,382 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:21:29,382 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:29,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:21:29,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,383 [INFO]: 647.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:29,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:21:29,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:29
2025-03-13 16:21:29,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:29,384 [INFO]: 	Creating the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:29
2025-03-13 16:21:29,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 16:21:29,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,387 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:21:29,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.07it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.88it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.84it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.09it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.22it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.49it/s]100%|██████████| 13/13 [00:03<00:00,  2.14it/s]100%|██████████| 13/13 [00:03<00:00,  3.69it/s]
2025-03-13 16:21:32,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:32
2025-03-13 16:22:11,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9946 secs
2025-03-13 16:22:11,911 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 16:22:11,911 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-13 16:22:41,769 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8576 secs
2025-03-13 16:22:41,771 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3836 secs
2025-03-13 16:22:41,771 [INFO]: {
2025-03-13 16:22:41,771 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:41,771 [INFO]: 	index_param: efSearch=189
2025-03-13 16:22:41,771 [INFO]: 	index_path: knn.index
2025-03-13 16:22:41,771 [INFO]: 	size in bytes: 617382130
2025-03-13 16:22:41,771 [INFO]: 	avg_search_speed_ms: 7.906877412920884
2025-03-13 16:22:41,771 [INFO]: 	99p_search_speed_ms: 11.167380446568126
2025-03-13 16:22:41,771 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:41,771 [INFO]: 	nb vectors: 3138
2025-03-13 16:22:41,771 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:41,771 [INFO]: 	compression ratio: 0.9993096236847672
2025-03-13 16:22:41,771 [INFO]: }
2025-03-13 16:22:41,771 [INFO]: 	>>> Finished "Creating the index" in 72.3870 secs
2025-03-13 16:22:41,771 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4143 secs
2025-03-13 16:22:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 73906 [episode count 11/20]
[retrieval_preprocessing] for episode 56534 [episode count 12/20], we have num_retrieval=np.int64(3160) num_query=np.int64(188)
2025-03-13 16:22:44,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:44,679 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:44
2025-03-13 16:22:44,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2345.81it/s]
2025-03-13 16:22:44,703 [INFO]: There are 3160 embeddings of dim 49152
2025-03-13 16:22:44,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 16:22:44,704 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:44
2025-03-13 16:22:44,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:44,704 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:22:44,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:44,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:22:44,704 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:44
2025-03-13 16:22:44,704 [INFO]: 652.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:44,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:22:44,704 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:44
2025-03-13 16:22:44,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:22:44,704 [INFO]: 	Creating the index 03/13/2025, 16:22:44
2025-03-13 16:22:44,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:44
2025-03-13 16:22:44,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:22:44,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:44
2025-03-13 16:22:44,706 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:22:44,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.51it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.85it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.45it/s] 31%|███       | 4/13 [00:00<00:01,  8.90it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.02it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.08it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.10it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.11it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.13it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.30it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.27it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.27it/s]100%|██████████| 13/13 [00:03<00:00,  1.43it/s]100%|██████████| 13/13 [00:03<00:00,  3.82it/s]
2025-03-13 16:22:48,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:48
2025-03-13 16:23:21,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6278 secs
2025-03-13 16:23:21,739 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 16:23:21,739 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 16:23:52,656 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9170 secs
2025-03-13 16:23:52,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9537 secs
2025-03-13 16:23:52,660 [INFO]: {
2025-03-13 16:23:52,660 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:52,660 [INFO]: 	index_param: efSearch=211
2025-03-13 16:23:52,660 [INFO]: 	index_path: knn.index
2025-03-13 16:23:52,660 [INFO]: 	size in bytes: 621710470
2025-03-13 16:23:52,660 [INFO]: 	avg_search_speed_ms: 9.878287880760599
2025-03-13 16:23:52,660 [INFO]: 	99p_search_speed_ms: 16.99459079187363
2025-03-13 16:23:52,660 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:52,660 [INFO]: 	nb vectors: 3160
2025-03-13 16:23:52,660 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:52,660 [INFO]: 	compression ratio: 0.9993096625829705
2025-03-13 16:23:52,660 [INFO]: }
2025-03-13 16:23:52,660 [INFO]: 	>>> Finished "Creating the index" in 67.9553 secs
2025-03-13 16:23:52,660 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9802 secs
2025-03-13 16:23:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 56534 [episode count 12/20]
[retrieval_preprocessing] for episode 85727 [episode count 13/20], we have num_retrieval=np.int64(3211) num_query=np.int64(137)
2025-03-13 16:23:55,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:56,341 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:56
2025-03-13 16:23:56,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.69it/s]
2025-03-13 16:23:56,367 [INFO]: There are 3211 embeddings of dim 49152
2025-03-13 16:23:56,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:23:56,367 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:56
2025-03-13 16:23:56,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:56,367 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:23:56,367 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:56,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:56,367 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:56
2025-03-13 16:23:56,367 [INFO]: 662.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:56,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:23:56,367 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:56
2025-03-13 16:23:56,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:56,367 [INFO]: 	Creating the index 03/13/2025, 16:23:56
2025-03-13 16:23:56,367 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:56
2025-03-13 16:23:56,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:23:56,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:56
2025-03-13 16:23:56,368 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:23:56,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.37it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.17it/s] 31%|███       | 4/13 [00:00<00:01,  8.63it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.81it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.10it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.27it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.34it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.42it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.35it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.28it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.33it/s]100%|██████████| 13/13 [00:04<00:00,  1.11it/s]100%|██████████| 13/13 [00:04<00:00,  3.18it/s]
2025-03-13 16:24:00,454 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:00
2025-03-13 16:24:38,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8653 secs
2025-03-13 16:24:38,320 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 16:24:38,320 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 16:25:02,046 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7261 secs
2025-03-13 16:25:02,254 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8853 secs
2025-03-13 16:25:02,254 [INFO]: {
2025-03-13 16:25:02,254 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:02,254 [INFO]: 	index_param: efSearch=105
2025-03-13 16:25:02,254 [INFO]: 	index_path: knn.index
2025-03-13 16:25:02,255 [INFO]: 	size in bytes: 631744330
2025-03-13 16:25:02,255 [INFO]: 	avg_search_speed_ms: 7.4597447952464115
2025-03-13 16:25:02,255 [INFO]: 	99p_search_speed_ms: 13.939607392530888
2025-03-13 16:25:02,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:02,255 [INFO]: 	nb vectors: 3211
2025-03-13 16:25:02,255 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:02,255 [INFO]: 	compression ratio: 0.9993097809045631
2025-03-13 16:25:02,255 [INFO]: }
2025-03-13 16:25:02,255 [INFO]: 	>>> Finished "Creating the index" in 65.8879 secs
2025-03-13 16:25:02,255 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9139 secs
2025-03-13 16:25:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 85727 [episode count 13/20]
[retrieval_preprocessing] for episode 91528 [episode count 14/20], we have num_retrieval=np.int64(3172) num_query=np.int64(176)
2025-03-13 16:25:04,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:05,144 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:05
2025-03-13 16:25:05,144 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.88it/s]
2025-03-13 16:25:05,170 [INFO]: There are 3172 embeddings of dim 49152
2025-03-13 16:25:05,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:25:05,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:05
2025-03-13 16:25:05,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:05,171 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:25:05,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:05,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:05,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:05
2025-03-13 16:25:05,171 [INFO]: 654.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:05,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:25:05,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:05
2025-03-13 16:25:05,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:05,171 [INFO]: 	Creating the index 03/13/2025, 16:25:05
2025-03-13 16:25:05,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:05
2025-03-13 16:25:05,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:25:05,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:05
2025-03-13 16:25:05,172 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:25:05,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.92it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.68it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.58it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.41it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.46it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.58it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.47it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.45it/s]100%|██████████| 13/13 [00:03<00:00,  1.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.62it/s]
2025-03-13 16:25:08,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:08
2025-03-13 16:25:48,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5042 secs
2025-03-13 16:25:48,276 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 16:25:48,276 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 16:26:24,438 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1626 secs
2025-03-13 16:26:25,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3982 secs
2025-03-13 16:26:25,571 [INFO]: {
2025-03-13 16:26:25,571 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:25,571 [INFO]: 	index_param: efSearch=222
2025-03-13 16:26:25,571 [INFO]: 	index_path: knn.index
2025-03-13 16:26:25,571 [INFO]: 	size in bytes: 624071350
2025-03-13 16:26:25,571 [INFO]: 	avg_search_speed_ms: 9.545625767533718
2025-03-13 16:26:25,571 [INFO]: 	99p_search_speed_ms: 14.617633332964033
2025-03-13 16:26:25,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:25,571 [INFO]: 	nb vectors: 3172
2025-03-13 16:26:25,571 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:25,571 [INFO]: 	compression ratio: 0.9993097359781057
2025-03-13 16:26:25,571 [INFO]: }
2025-03-13 16:26:25,571 [INFO]: 	>>> Finished "Creating the index" in 80.4003 secs
2025-03-13 16:26:25,572 [INFO]: >>> Finished "Launching the whole pipeline" in 80.4271 secs
2025-03-13 16:26:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 91528 [episode count 14/20]
[retrieval_preprocessing] for episode 33166 [episode count 15/20], we have num_retrieval=np.int64(3158) num_query=np.int64(190)
2025-03-13 16:26:28,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:28,465 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:28
2025-03-13 16:26:28,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.69it/s]
2025-03-13 16:26:28,489 [INFO]: There are 3158 embeddings of dim 49152
2025-03-13 16:26:28,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:26:28,490 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:28
2025-03-13 16:26:28,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:28,490 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:26:28,490 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:28,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:28,490 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:28
2025-03-13 16:26:28,490 [INFO]: 651.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:28,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:28,490 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:28
2025-03-13 16:26:28,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:28,490 [INFO]: 	Creating the index 03/13/2025, 16:26:28
2025-03-13 16:26:28,490 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:28
2025-03-13 16:26:28,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:26:28,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:28
2025-03-13 16:26:28,491 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:26:28,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.04it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.53it/s] 31%|███       | 4/13 [00:00<00:01,  8.83it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.05it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.43it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.30it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.01it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.74it/s]100%|██████████| 13/13 [00:04<00:00,  1.12it/s]100%|██████████| 13/13 [00:04<00:00,  3.16it/s]
2025-03-13 16:26:32,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:32
2025-03-13 16:27:17,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5123 secs
2025-03-13 16:27:17,128 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:27:17,128 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 16:27:39,043 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9151 secs
2025-03-13 16:27:39,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5543 secs
2025-03-13 16:27:39,046 [INFO]: {
2025-03-13 16:27:39,046 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:39,046 [INFO]: 	index_param: efSearch=172
2025-03-13 16:27:39,046 [INFO]: 	index_path: knn.index
2025-03-13 16:27:39,046 [INFO]: 	size in bytes: 621316990
2025-03-13 16:27:39,046 [INFO]: 	avg_search_speed_ms: 9.274436885116065
2025-03-13 16:27:39,046 [INFO]: 	99p_search_speed_ms: 19.998318413272504
2025-03-13 16:27:39,046 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:39,046 [INFO]: 	nb vectors: 3158
2025-03-13 16:27:39,046 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:39,046 [INFO]: 	compression ratio: 0.99930965029622
2025-03-13 16:27:39,046 [INFO]: }
2025-03-13 16:27:39,046 [INFO]: 	>>> Finished "Creating the index" in 70.5560 secs
2025-03-13 16:27:39,046 [INFO]: >>> Finished "Launching the whole pipeline" in 70.5810 secs
2025-03-13 16:27:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 33166 [episode count 15/20]
[retrieval_preprocessing] for episode 39855 [episode count 16/20], we have num_retrieval=np.int64(3158) num_query=np.int64(190)
2025-03-13 16:27:41,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:42,611 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:42
2025-03-13 16:27:42,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.84it/s]
2025-03-13 16:27:42,637 [INFO]: There are 3158 embeddings of dim 49152
2025-03-13 16:27:42,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:27:42,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:42
2025-03-13 16:27:42,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:42,637 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:27:42,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:42,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:27:42,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:42
2025-03-13 16:27:42,637 [INFO]: 651.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:42,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:27:42,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:42
2025-03-13 16:27:42,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:42,638 [INFO]: 	Creating the index 03/13/2025, 16:27:42
2025-03-13 16:27:42,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:42
2025-03-13 16:27:42,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:27:42,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:42
2025-03-13 16:27:42,639 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:27:42,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.92it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.81it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.71it/s] 31%|███       | 4/13 [00:00<00:01,  8.31it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.07it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.11it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.11it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.14it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.10it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.83it/s]100%|██████████| 13/13 [00:03<00:00,  1.39it/s]100%|██████████| 13/13 [00:03<00:00,  3.27it/s]
2025-03-13 16:27:46,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:46
2025-03-13 16:28:22,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8443 secs
2025-03-13 16:28:22,465 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 16:28:22,465 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-13 16:28:58,122 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6560 secs
2025-03-13 16:28:58,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1558 secs
2025-03-13 16:28:58,795 [INFO]: {
2025-03-13 16:28:58,795 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:58,795 [INFO]: 	index_param: efSearch=229
2025-03-13 16:28:58,795 [INFO]: 	index_path: knn.index
2025-03-13 16:28:58,795 [INFO]: 	size in bytes: 621316990
2025-03-13 16:28:58,795 [INFO]: 	avg_search_speed_ms: 10.36000008141433
2025-03-13 16:28:58,795 [INFO]: 	99p_search_speed_ms: 18.667668115813303
2025-03-13 16:28:58,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:58,795 [INFO]: 	nb vectors: 3158
2025-03-13 16:28:58,795 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:58,795 [INFO]: 	compression ratio: 0.99930965029622
2025-03-13 16:28:58,795 [INFO]: }
2025-03-13 16:28:58,796 [INFO]: 	>>> Finished "Creating the index" in 76.1580 secs
2025-03-13 16:28:58,796 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1844 secs
2025-03-13 16:29:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 39855 [episode count 16/20]
[retrieval_preprocessing] for episode 19902 [episode count 17/20], we have num_retrieval=np.int64(3066) num_query=np.int64(282)
2025-03-13 16:29:02,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:04,004 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:04
2025-03-13 16:29:04,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 955.42it/s]
2025-03-13 16:29:04,029 [INFO]: There are 3066 embeddings of dim 49152
2025-03-13 16:29:04,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 16:29:04,029 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:04
2025-03-13 16:29:04,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:04,029 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:29:04,029 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:04,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:04,029 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:04
2025-03-13 16:29:04,029 [INFO]: 632.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:04,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:29:04,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:04
2025-03-13 16:29:04,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:04,029 [INFO]: 	Creating the index 03/13/2025, 16:29:04
2025-03-13 16:29:04,029 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:04
2025-03-13 16:29:04,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:29:04,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:04
2025-03-13 16:29:04,030 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:29:04,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.57it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.79it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.27it/s] 31%|███       | 4/13 [00:00<00:01,  6.61it/s] 38%|███▊      | 5/13 [00:00<00:01,  6.69it/s] 46%|████▌     | 6/13 [00:00<00:01,  6.67it/s] 54%|█████▍    | 7/13 [00:01<00:00,  6.64it/s] 62%|██████▏   | 8/13 [00:01<00:00,  6.57it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.01it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.40it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.33it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.31it/s]100%|██████████| 13/13 [00:04<00:00,  1.01it/s]100%|██████████| 13/13 [00:04<00:00,  2.76it/s]
2025-03-13 16:29:08,746 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:08
2025-03-13 16:29:45,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9928 secs
2025-03-13 16:29:45,739 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 16:29:45,739 [INFO]: 	Compute fast metrics 03/13/2025, 16:29:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 16:30:07,044 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3047 secs
2025-03-13 16:30:07,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5269 secs
2025-03-13 16:30:07,558 [INFO]: {
2025-03-13 16:30:07,558 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:07,558 [INFO]: 	index_param: efSearch=138
2025-03-13 16:30:07,558 [INFO]: 	index_path: knn.index
2025-03-13 16:30:07,558 [INFO]: 	size in bytes: 603216490
2025-03-13 16:30:07,558 [INFO]: 	avg_search_speed_ms: 7.895908664947296
2025-03-13 16:30:07,558 [INFO]: 	99p_search_speed_ms: 13.170187023933932
2025-03-13 16:30:07,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:07,558 [INFO]: 	nb vectors: 3066
2025-03-13 16:30:07,558 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:07,558 [INFO]: 	compression ratio: 0.9993097635643217
2025-03-13 16:30:07,558 [INFO]: }
2025-03-13 16:30:07,558 [INFO]: 	>>> Finished "Creating the index" in 63.5290 secs
2025-03-13 16:30:07,558 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5540 secs
2025-03-13 16:30:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 19902 [episode count 17/20]
[retrieval_preprocessing] for episode 481 [episode count 18/20], we have num_retrieval=np.int64(3213) num_query=np.int64(135)
2025-03-13 16:30:11,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:11,936 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:11
2025-03-13 16:30:11,936 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-13 16:30:11,959 [INFO]: There are 3213 embeddings of dim 49152
2025-03-13 16:30:11,959 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 16:30:11,959 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:11
2025-03-13 16:30:11,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:11,960 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:30:11,960 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:11,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:30:11,960 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:11
2025-03-13 16:30:11,961 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:11,961 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:30:11,961 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:11
2025-03-13 16:30:11,961 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:11,961 [INFO]: 	Creating the index 03/13/2025, 16:30:11
2025-03-13 16:30:11,962 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:11
2025-03-13 16:30:11,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:30:11,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:11
2025-03-13 16:30:11,965 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:30:11,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.78it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.80it/s] 23%|██▎       | 3/13 [00:00<00:01,  5.89it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.04it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.07it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.65it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.98it/s]100%|██████████| 13/13 [00:03<00:00,  2.06it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-13 16:30:15,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:15
2025-03-13 16:30:51,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1345 secs
2025-03-13 16:30:51,833 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 16:30:51,833 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 16:31:12,526 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6925 secs
2025-03-13 16:31:12,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5638 secs
2025-03-13 16:31:12,529 [INFO]: {
2025-03-13 16:31:12,529 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:12,529 [INFO]: 	index_param: efSearch=171
2025-03-13 16:31:12,529 [INFO]: 	index_path: knn.index
2025-03-13 16:31:12,529 [INFO]: 	size in bytes: 632137810
2025-03-13 16:31:12,529 [INFO]: 	avg_search_speed_ms: 8.77925935360792
2025-03-13 16:31:12,529 [INFO]: 	99p_search_speed_ms: 14.608734333887691
2025-03-13 16:31:12,529 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:12,529 [INFO]: 	nb vectors: 3213
2025-03-13 16:31:12,529 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:12,529 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-13 16:31:12,529 [INFO]: }
2025-03-13 16:31:12,529 [INFO]: 	>>> Finished "Creating the index" in 60.5679 secs
2025-03-13 16:31:12,529 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5937 secs
2025-03-13 16:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 481 [episode count 18/20]
[retrieval_preprocessing] for episode 93162 [episode count 19/20], we have num_retrieval=np.int64(3180) num_query=np.int64(168)
2025-03-13 16:31:15,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:15,887 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:15
2025-03-13 16:31:15,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 960.89it/s]
2025-03-13 16:31:15,916 [INFO]: There are 3180 embeddings of dim 49152
2025-03-13 16:31:15,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:31:15,916 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:15
2025-03-13 16:31:15,917 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:15,917 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:31:15,917 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:15,917 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:31:15,917 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:15
2025-03-13 16:31:15,918 [INFO]: 656.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:15,918 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:31:15,918 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:15
2025-03-13 16:31:15,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:15,918 [INFO]: 	Creating the index 03/13/2025, 16:31:15
2025-03-13 16:31:15,919 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:15
2025-03-13 16:31:15,921 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:31:15,922 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:15
2025-03-13 16:31:15,922 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:31:15,922 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.37it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.55it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.10it/s] 31%|███       | 4/13 [00:00<00:01,  7.34it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.52it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.67it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.71it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.81it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.91it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.99it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.11it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.23it/s]100%|██████████| 13/13 [00:03<00:00,  1.22it/s]100%|██████████| 13/13 [00:03<00:00,  3.25it/s]
2025-03-13 16:31:19,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:19
2025-03-13 16:31:54,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9368 secs
2025-03-13 16:31:54,863 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 16:31:54,863 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 16:32:24,355 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4925 secs
2025-03-13 16:32:24,358 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4366 secs
2025-03-13 16:32:24,358 [INFO]: {
2025-03-13 16:32:24,358 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:24,358 [INFO]: 	index_param: efSearch=173
2025-03-13 16:32:24,358 [INFO]: 	index_path: knn.index
2025-03-13 16:32:24,358 [INFO]: 	size in bytes: 625645330
2025-03-13 16:32:24,358 [INFO]: 	avg_search_speed_ms: 8.56827568157473
2025-03-13 16:32:24,358 [INFO]: 	99p_search_speed_ms: 11.806784030050034
2025-03-13 16:32:24,358 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:24,358 [INFO]: 	nb vectors: 3180
2025-03-13 16:32:24,358 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:24,359 [INFO]: 	compression ratio: 0.9993096887656782
2025-03-13 16:32:24,359 [INFO]: }
2025-03-13 16:32:24,359 [INFO]: 	>>> Finished "Creating the index" in 68.4400 secs
2025-03-13 16:32:24,359 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4715 secs
2025-03-13 16:32:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 93162 [episode count 19/20]
2025-03-13 16:32:25: [retrieval_preprocessing] finished for 5374398722_close_laptop [chosen_id count 4/196]
2025-03-13 16:32:27: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5374398722_press_stapler [chosen_id count 5/196]
2025-03-13 16:32:27: [retrieval_preprocessing] we have num_total=2441 embedding_dim=49152
[retrieval_preprocessing] for episode 44547 [episode count 0/20], we have num_retrieval=np.int64(2316) num_query=np.int64(125)
2025-03-13 16:32:28,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:28,895 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:28
2025-03-13 16:32:28,895 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.50it/s]
2025-03-13 16:32:28,925 [INFO]: There are 2316 embeddings of dim 49152
2025-03-13 16:32:28,925 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 16:32:28,925 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:28
2025-03-13 16:32:28,926 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:28,926 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:32:28,926 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:28,926 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:32:28,926 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:28
2025-03-13 16:32:28,926 [INFO]: 478.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:28,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:32:28,927 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:28
2025-03-13 16:32:28,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:28,927 [INFO]: 	Creating the index 03/13/2025, 16:32:28
2025-03-13 16:32:28,927 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:28
2025-03-13 16:32:28,930 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:32:28,931 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:28
2025-03-13 16:32:28,931 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:32:28,931 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.74it/s] 30%|███       | 3/10 [00:00<00:00, 10.06it/s] 50%|█████     | 5/10 [00:00<00:00, 11.14it/s] 70%|███████   | 7/10 [00:00<00:00, 11.52it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.95it/s]100%|██████████| 10/10 [00:02<00:00,  4.61it/s]
2025-03-13 16:32:31,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:31
2025-03-13 16:32:54,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6515 secs
2025-03-13 16:32:54,759 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 16:32:54,759 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 16:33:27,950 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1908 secs
2025-03-13 16:33:28,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4000 secs
2025-03-13 16:33:28,331 [INFO]: {
2025-03-13 16:33:28,331 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:28,331 [INFO]: 	index_param: efSearch=291
2025-03-13 16:33:28,331 [INFO]: 	index_path: knn.index
2025-03-13 16:33:28,331 [INFO]: 	size in bytes: 455658790
2025-03-13 16:33:28,331 [INFO]: 	avg_search_speed_ms: 10.568127635504496
2025-03-13 16:33:28,332 [INFO]: 	99p_search_speed_ms: 20.296471714973425
2025-03-13 16:33:28,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:28,332 [INFO]: 	nb vectors: 2316
2025-03-13 16:33:28,332 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:28,332 [INFO]: 	compression ratio: 0.9993094350270297
2025-03-13 16:33:28,332 [INFO]: }
2025-03-13 16:33:28,332 [INFO]: 	>>> Finished "Creating the index" in 59.4045 secs
2025-03-13 16:33:28,332 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4365 secs
2025-03-13 16:33:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 44547 [episode count 0/20]
[retrieval_preprocessing] for episode 76815 [episode count 1/20], we have num_retrieval=np.int64(2352) num_query=np.int64(89)
2025-03-13 16:33:30,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:30,684 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:30
2025-03-13 16:33:30,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1251.28it/s]
2025-03-13 16:33:30,721 [INFO]: There are 2352 embeddings of dim 49152
2025-03-13 16:33:30,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 16:33:30,721 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:30
2025-03-13 16:33:30,721 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:30,721 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:33:30,721 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:30,721 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:30,721 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:30
2025-03-13 16:33:30,722 [INFO]: 485.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:30,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:33:30,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:30
2025-03-13 16:33:30,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:30,722 [INFO]: 	Creating the index 03/13/2025, 16:33:30
2025-03-13 16:33:30,722 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:30
2025-03-13 16:33:30,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:33:30,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:30
2025-03-13 16:33:30,724 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:33:30,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.53it/s] 50%|█████     | 5/10 [00:00<00:00, 20.87it/s] 80%|████████  | 8/10 [00:00<00:00, 16.08it/s]100%|██████████| 10/10 [00:01<00:00,  3.70it/s]100%|██████████| 10/10 [00:01<00:00,  5.26it/s]
2025-03-13 16:33:32,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:32
2025-03-13 16:34:00,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3097 secs
2025-03-13 16:34:00,940 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 16:34:00,940 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s]
2025-03-13 16:34:17,458 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5185 secs
2025-03-13 16:34:17,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7372 secs
2025-03-13 16:34:17,461 [INFO]: {
2025-03-13 16:34:17,461 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:17,461 [INFO]: 	index_param: efSearch=126
2025-03-13 16:34:17,461 [INFO]: 	index_path: knn.index
2025-03-13 16:34:17,461 [INFO]: 	size in bytes: 462741490
2025-03-13 16:34:17,461 [INFO]: 	avg_search_speed_ms: 7.151415734618465
2025-03-13 16:34:17,461 [INFO]: 	99p_search_speed_ms: 12.722374487202613
2025-03-13 16:34:17,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:17,461 [INFO]: 	nb vectors: 2352
2025-03-13 16:34:17,461 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:17,461 [INFO]: 	compression ratio: 0.9993096058881602
2025-03-13 16:34:17,461 [INFO]: }
2025-03-13 16:34:17,461 [INFO]: 	>>> Finished "Creating the index" in 46.7393 secs
2025-03-13 16:34:17,461 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7766 secs
2025-03-13 16:34:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 76815 [episode count 1/20]
[retrieval_preprocessing] for episode 61997 [episode count 2/20], we have num_retrieval=np.int64(2352) num_query=np.int64(89)
2025-03-13 16:34:21,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:22,110 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:22
2025-03-13 16:34:22,110 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.03it/s]
2025-03-13 16:34:22,137 [INFO]: There are 2352 embeddings of dim 49152
2025-03-13 16:34:22,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 16:34:22,137 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:22
2025-03-13 16:34:22,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:22,138 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:34:22,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:22,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:34:22,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:22
2025-03-13 16:34:22,138 [INFO]: 485.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:22,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:34:22,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:22
2025-03-13 16:34:22,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:22,138 [INFO]: 	Creating the index 03/13/2025, 16:34:22
2025-03-13 16:34:22,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:22
2025-03-13 16:34:22,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:34:22,139 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:22
2025-03-13 16:34:22,139 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:34:22,139 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.58it/s] 20%|██        | 2/10 [00:00<00:01,  7.37it/s] 40%|████      | 4/10 [00:00<00:00,  8.98it/s] 60%|██████    | 6/10 [00:00<00:00,  9.47it/s] 80%|████████  | 8/10 [00:00<00:00,  9.79it/s]100%|██████████| 10/10 [00:02<00:00,  2.28it/s]100%|██████████| 10/10 [00:02<00:00,  3.43it/s]
2025-03-13 16:34:25,059 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:25
2025-03-13 16:34:55,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2014 secs
2025-03-13 16:34:55,261 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 16:34:55,261 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 16:35:15,493 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2323 secs
2025-03-13 16:35:15,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3561 secs
2025-03-13 16:35:15,496 [INFO]: {
2025-03-13 16:35:15,496 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:15,496 [INFO]: 	index_param: efSearch=254
2025-03-13 16:35:15,496 [INFO]: 	index_path: knn.index
2025-03-13 16:35:15,496 [INFO]: 	size in bytes: 462741490
2025-03-13 16:35:15,497 [INFO]: 	avg_search_speed_ms: 9.912981293131889
2025-03-13 16:35:15,497 [INFO]: 	99p_search_speed_ms: 18.035816960036744
2025-03-13 16:35:15,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:15,497 [INFO]: 	nb vectors: 2352
2025-03-13 16:35:15,497 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:15,497 [INFO]: 	compression ratio: 0.9993096058881602
2025-03-13 16:35:15,497 [INFO]: }
2025-03-13 16:35:15,497 [INFO]: 	>>> Finished "Creating the index" in 53.3585 secs
2025-03-13 16:35:15,497 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3863 secs
2025-03-13 16:35:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 61997 [episode count 2/20]
[retrieval_preprocessing] for episode 58938 [episode count 3/20], we have num_retrieval=np.int64(2332) num_query=np.int64(109)
2025-03-13 16:35:17,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:17,552 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:17
2025-03-13 16:35:17,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.82it/s]
2025-03-13 16:35:17,578 [INFO]: There are 2332 embeddings of dim 49152
2025-03-13 16:35:17,578 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:35:17,578 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:17
2025-03-13 16:35:17,578 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:17,578 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:35:17,578 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:17,578 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:17,578 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:17
2025-03-13 16:35:17,578 [INFO]: 481.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:17,579 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:35:17,579 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:17
2025-03-13 16:35:17,579 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:17,579 [INFO]: 	Creating the index 03/13/2025, 16:35:17
2025-03-13 16:35:17,579 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:17
2025-03-13 16:35:17,580 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:35:17,580 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:17
2025-03-13 16:35:17,580 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:35:17,580 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.77it/s] 20%|██        | 2/10 [00:00<00:01,  6.13it/s] 30%|███       | 3/10 [00:00<00:01,  5.61it/s] 40%|████      | 4/10 [00:00<00:00,  6.25it/s] 50%|█████     | 5/10 [00:00<00:00,  6.70it/s] 60%|██████    | 6/10 [00:00<00:00,  7.11it/s] 70%|███████   | 7/10 [00:01<00:00,  7.52it/s] 80%|████████  | 8/10 [00:01<00:00,  7.55it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.59it/s]100%|██████████| 10/10 [00:02<00:00,  1.67it/s]100%|██████████| 10/10 [00:02<00:00,  3.40it/s]
2025-03-13 16:35:20,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:20
2025-03-13 16:35:50,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9410 secs
2025-03-13 16:35:50,860 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 16:35:50,860 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 16:36:22,147 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2871 secs
2025-03-13 16:36:22,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5697 secs
2025-03-13 16:36:22,150 [INFO]: {
2025-03-13 16:36:22,150 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:22,150 [INFO]: 	index_param: efSearch=307
2025-03-13 16:36:22,150 [INFO]: 	index_path: knn.index
2025-03-13 16:36:22,150 [INFO]: 	size in bytes: 458806690
2025-03-13 16:36:22,150 [INFO]: 	avg_search_speed_ms: 11.222974361180757
2025-03-13 16:36:22,150 [INFO]: 	99p_search_speed_ms: 19.96223644819111
2025-03-13 16:36:22,150 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:22,150 [INFO]: 	nb vectors: 2332
2025-03-13 16:36:22,150 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:22,150 [INFO]: 	compression ratio: 0.9993094390145009
2025-03-13 16:36:22,150 [INFO]: }
2025-03-13 16:36:22,150 [INFO]: 	>>> Finished "Creating the index" in 64.5712 secs
2025-03-13 16:36:22,150 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5973 secs
2025-03-13 16:36:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 58938 [episode count 3/20]
[retrieval_preprocessing] for episode 36412 [episode count 4/20], we have num_retrieval=np.int64(2347) num_query=np.int64(94)
2025-03-13 16:36:24,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:24,833 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:24
2025-03-13 16:36:24,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.81it/s]
2025-03-13 16:36:24,858 [INFO]: There are 2347 embeddings of dim 49152
2025-03-13 16:36:24,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:36:24,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:24
2025-03-13 16:36:24,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:24,859 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:36:24,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:24,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:24,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:24
2025-03-13 16:36:24,859 [INFO]: 484.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:24,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:24,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:24
2025-03-13 16:36:24,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:24,859 [INFO]: 	Creating the index 03/13/2025, 16:36:24
2025-03-13 16:36:24,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:24
2025-03-13 16:36:24,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:36:24,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:24
2025-03-13 16:36:24,860 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:36:24,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.56it/s] 30%|███       | 3/10 [00:00<00:00,  8.51it/s] 50%|█████     | 5/10 [00:00<00:00, 10.36it/s] 70%|███████   | 7/10 [00:00<00:00, 10.90it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.44it/s]
2025-03-13 16:36:27,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:27
2025-03-13 16:36:52,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4713 secs
2025-03-13 16:36:52,985 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 16:36:52,985 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.10it/s] 50%|█████     | 2/4 [00:00<00:00,  4.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.11it/s]
2025-03-13 16:37:11,856 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8715 secs
2025-03-13 16:37:11,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9986 secs
2025-03-13 16:37:11,859 [INFO]: {
2025-03-13 16:37:11,859 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:11,859 [INFO]: 	index_param: efSearch=221
2025-03-13 16:37:11,859 [INFO]: 	index_path: knn.index
2025-03-13 16:37:11,859 [INFO]: 	size in bytes: 461757790
2025-03-13 16:37:11,859 [INFO]: 	avg_search_speed_ms: 8.381133706075484
2025-03-13 16:37:11,859 [INFO]: 	99p_search_speed_ms: 11.592899709939955
2025-03-13 16:37:11,859 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:11,859 [INFO]: 	nb vectors: 2347
2025-03-13 16:37:11,859 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:11,859 [INFO]: 	compression ratio: 0.9993095644363682
2025-03-13 16:37:11,859 [INFO]: }
2025-03-13 16:37:11,859 [INFO]: 	>>> Finished "Creating the index" in 47.0000 secs
2025-03-13 16:37:11,859 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0261 secs
2025-03-13 16:37:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 36412 [episode count 4/20]
[retrieval_preprocessing] for episode 42104 [episode count 5/20], we have num_retrieval=np.int64(2291) num_query=np.int64(150)
2025-03-13 16:37:13,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:14,185 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:14
2025-03-13 16:37:14,185 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-13 16:37:14,208 [INFO]: There are 2291 embeddings of dim 49152
2025-03-13 16:37:14,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 16:37:14,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:14
2025-03-13 16:37:14,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:14,208 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:37:14,208 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:14,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:37:14,208 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:14
2025-03-13 16:37:14,209 [INFO]: 472.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:14,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:37:14,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:14
2025-03-13 16:37:14,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:14,209 [INFO]: 	Creating the index 03/13/2025, 16:37:14
2025-03-13 16:37:14,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:14
2025-03-13 16:37:14,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:37:14,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:14
2025-03-13 16:37:14,210 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:37:14,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.89it/s] 30%|███       | 3/10 [00:00<00:00,  9.46it/s] 50%|█████     | 5/10 [00:00<00:00, 10.44it/s] 70%|███████   | 7/10 [00:00<00:00, 10.93it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.05it/s]100%|██████████| 10/10 [00:02<00:00,  3.70it/s]
2025-03-13 16:37:16,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:16
2025-03-13 16:37:43,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6473 secs
2025-03-13 16:37:43,560 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 16:37:43,560 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.09it/s]
2025-03-13 16:38:21,909 [INFO]: 	>>> Finished "Compute fast metrics" in 38.3483 secs
2025-03-13 16:38:21,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7026 secs
2025-03-13 16:38:21,913 [INFO]: {
2025-03-13 16:38:21,913 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:21,913 [INFO]: 	index_param: efSearch=244
2025-03-13 16:38:21,913 [INFO]: 	index_path: knn.index
2025-03-13 16:38:21,913 [INFO]: 	size in bytes: 450740230
2025-03-13 16:38:21,913 [INFO]: 	avg_search_speed_ms: 14.804471830063163
2025-03-13 16:38:21,913 [INFO]: 	99p_search_speed_ms: 27.312727877870202
2025-03-13 16:38:21,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:21,913 [INFO]: 	nb vectors: 2291
2025-03-13 16:38:21,913 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:21,913 [INFO]: 	compression ratio: 0.9993093538599828
2025-03-13 16:38:21,913 [INFO]: }
2025-03-13 16:38:21,913 [INFO]: 	>>> Finished "Creating the index" in 67.7042 secs
2025-03-13 16:38:21,913 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7276 secs
2025-03-13 16:38:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 42104 [episode count 5/20]
[retrieval_preprocessing] for episode 24744 [episode count 6/20], we have num_retrieval=np.int64(2283) num_query=np.int64(158)
2025-03-13 16:38:25,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:26,167 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:26
2025-03-13 16:38:26,167 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1029.02it/s]
2025-03-13 16:38:26,203 [INFO]: There are 2283 embeddings of dim 49152
2025-03-13 16:38:26,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 16:38:26,203 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,203 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:26,203 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:38:26,203 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:26,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:26,203 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,203 [INFO]: 471.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:26,203 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:38:26,203 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:26
2025-03-13 16:38:26,203 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:26,204 [INFO]: 	Creating the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:26
2025-03-13 16:38:26,205 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:38:26,205 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:26
2025-03-13 16:38:26,205 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:38:26,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.90it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.29it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.75it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.79it/s] 56%|█████▌    | 5/9 [00:00<00:00,  6.73it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.73it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.56it/s] 89%|████████▉ | 8/9 [00:01<00:00,  6.72it/s]100%|██████████| 9/9 [00:03<00:00,  1.48it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
2025-03-13 16:38:29,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:29
2025-03-13 16:38:57,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4987 secs
2025-03-13 16:38:57,763 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 16:38:57,763 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 16:39:16,336 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5726 secs
2025-03-13 16:39:16,338 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1334 secs
2025-03-13 16:39:16,339 [INFO]: {
2025-03-13 16:39:16,339 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:16,339 [INFO]: 	index_param: efSearch=221
2025-03-13 16:39:16,339 [INFO]: 	index_path: knn.index
2025-03-13 16:39:16,339 [INFO]: 	size in bytes: 449166190
2025-03-13 16:39:16,339 [INFO]: 	avg_search_speed_ms: 9.419004341654073
2025-03-13 16:39:16,339 [INFO]: 	99p_search_speed_ms: 14.309098082594577
2025-03-13 16:39:16,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:16,339 [INFO]: 	nb vectors: 2283
2025-03-13 16:39:16,339 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:16,339 [INFO]: 	compression ratio: 0.9993095517719176
2025-03-13 16:39:16,339 [INFO]: }
2025-03-13 16:39:16,339 [INFO]: 	>>> Finished "Creating the index" in 50.1351 secs
2025-03-13 16:39:16,339 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1715 secs
2025-03-13 16:39:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 24744 [episode count 6/20]
[retrieval_preprocessing] for episode 28883 [episode count 7/20], we have num_retrieval=np.int64(2332) num_query=np.int64(109)
2025-03-13 16:39:18,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:19,158 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:19
2025-03-13 16:39:19,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.93it/s]
2025-03-13 16:39:19,188 [INFO]: There are 2332 embeddings of dim 49152
2025-03-13 16:39:19,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:39:19,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:19
2025-03-13 16:39:19,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:19,189 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:39:19,190 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:19,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:39:19,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:19
2025-03-13 16:39:19,191 [INFO]: 481.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:19,191 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 16:39:19,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:19
2025-03-13 16:39:19,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:19,192 [INFO]: 	Creating the index 03/13/2025, 16:39:19
2025-03-13 16:39:19,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:19
2025-03-13 16:39:19,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 16:39:19,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:19
2025-03-13 16:39:19,197 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:39:19,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.42it/s] 20%|██        | 2/10 [00:00<00:01,  6.99it/s] 30%|███       | 3/10 [00:00<00:00,  7.43it/s] 40%|████      | 4/10 [00:00<00:00,  7.65it/s] 50%|█████     | 5/10 [00:00<00:00,  7.85it/s] 60%|██████    | 6/10 [00:00<00:00,  7.87it/s] 70%|███████   | 7/10 [00:00<00:00,  8.07it/s] 80%|████████  | 8/10 [00:01<00:00,  8.54it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.74it/s]100%|██████████| 10/10 [00:02<00:00,  1.83it/s]100%|██████████| 10/10 [00:02<00:00,  3.79it/s]
2025-03-13 16:39:21,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:21
2025-03-13 16:39:48,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4690 secs
2025-03-13 16:39:48,308 [INFO]: The best hyperparameters are: efSearch=337
2025-03-13 16:39:48,308 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 16:40:15,717 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4094 secs
2025-03-13 16:40:15,719 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5230 secs
2025-03-13 16:40:15,720 [INFO]: {
2025-03-13 16:40:15,720 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:15,720 [INFO]: 	index_param: efSearch=337
2025-03-13 16:40:15,720 [INFO]: 	index_path: knn.index
2025-03-13 16:40:15,720 [INFO]: 	size in bytes: 458806690
2025-03-13 16:40:15,720 [INFO]: 	avg_search_speed_ms: 10.749064201827208
2025-03-13 16:40:15,720 [INFO]: 	99p_search_speed_ms: 20.54330580867828
2025-03-13 16:40:15,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:15,720 [INFO]: 	nb vectors: 2332
2025-03-13 16:40:15,720 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:15,720 [INFO]: 	compression ratio: 0.9993094390145009
2025-03-13 16:40:15,720 [INFO]: }
2025-03-13 16:40:15,720 [INFO]: 	>>> Finished "Creating the index" in 56.5275 secs
2025-03-13 16:40:15,720 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5616 secs
2025-03-13 16:40:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 28883 [episode count 7/20]
[retrieval_preprocessing] for episode 28372 [episode count 8/20], we have num_retrieval=np.int64(2271) num_query=np.int64(170)
2025-03-13 16:40:17,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:17,879 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:17
2025-03-13 16:40:17,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 915.59it/s]
2025-03-13 16:40:17,909 [INFO]: There are 2271 embeddings of dim 49152
2025-03-13 16:40:17,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:40:17,910 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:17
2025-03-13 16:40:17,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:17,910 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:40:17,911 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:17,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:40:17,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:17
2025-03-13 16:40:17,911 [INFO]: 468.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:17,912 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:40:17,912 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:17
2025-03-13 16:40:17,912 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:17,912 [INFO]: 	Creating the index 03/13/2025, 16:40:17
2025-03-13 16:40:17,913 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:17
2025-03-13 16:40:17,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:40:17,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:17
2025-03-13 16:40:17,916 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:40:17,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.44it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.06it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.17it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.68it/s]100%|██████████| 9/9 [00:02<00:00,  2.46it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]
2025-03-13 16:40:20,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:20
2025-03-13 16:40:44,269 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7974 secs
2025-03-13 16:40:44,269 [INFO]: The best hyperparameters are: efSearch=349
2025-03-13 16:40:44,269 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 16:41:19,818 [INFO]: 	>>> Finished "Compute fast metrics" in 35.5483 secs
2025-03-13 16:41:19,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9041 secs
2025-03-13 16:41:19,821 [INFO]: {
2025-03-13 16:41:19,821 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:19,821 [INFO]: 	index_param: efSearch=349
2025-03-13 16:41:19,821 [INFO]: 	index_path: knn.index
2025-03-13 16:41:19,821 [INFO]: 	size in bytes: 446805310
2025-03-13 16:41:19,821 [INFO]: 	avg_search_speed_ms: 12.480352674732996
2025-03-13 16:41:19,821 [INFO]: 	99p_search_speed_ms: 22.69313088618219
2025-03-13 16:41:19,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:19,821 [INFO]: 	nb vectors: 2271
2025-03-13 16:41:19,821 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:19,821 [INFO]: 	compression ratio: 0.9993094486723982
2025-03-13 16:41:19,821 [INFO]: }
2025-03-13 16:41:19,821 [INFO]: 	>>> Finished "Creating the index" in 61.9088 secs
2025-03-13 16:41:19,821 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9423 secs
2025-03-13 16:41:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 28372 [episode count 8/20]
[retrieval_preprocessing] for episode 8942 [episode count 9/20], we have num_retrieval=np.int64(2289) num_query=np.int64(152)
2025-03-13 16:41:24,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:24,411 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:24
2025-03-13 16:41:24,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.28it/s]
2025-03-13 16:41:24,441 [INFO]: There are 2289 embeddings of dim 49152
2025-03-13 16:41:24,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:41:24,441 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:24
2025-03-13 16:41:24,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:24,442 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:41:24,442 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:24,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:41:24,442 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:24
2025-03-13 16:41:24,442 [INFO]: 472.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:24,442 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:24,443 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:24
2025-03-13 16:41:24,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:24,443 [INFO]: 	Creating the index 03/13/2025, 16:41:24
2025-03-13 16:41:24,443 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:24
2025-03-13 16:41:24,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:41:24,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:24
2025-03-13 16:41:24,447 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:41:24,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.81it/s] 30%|███       | 3/10 [00:00<00:00,  8.60it/s] 50%|█████     | 5/10 [00:00<00:00,  9.28it/s] 60%|██████    | 6/10 [00:00<00:00,  9.39it/s] 80%|████████  | 8/10 [00:00<00:00,  9.77it/s]100%|██████████| 10/10 [00:02<00:00,  2.58it/s]100%|██████████| 10/10 [00:02<00:00,  3.91it/s]
2025-03-13 16:41:27,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:27
2025-03-13 16:41:55,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6846 secs
2025-03-13 16:41:55,694 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 16:41:55,694 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 16:42:18,602 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9071 secs
2025-03-13 16:42:18,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4784 secs
2025-03-13 16:42:18,925 [INFO]: {
2025-03-13 16:42:18,925 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:18,926 [INFO]: 	index_param: efSearch=255
2025-03-13 16:42:18,926 [INFO]: 	index_path: knn.index
2025-03-13 16:42:18,926 [INFO]: 	size in bytes: 450346690
2025-03-13 16:42:18,926 [INFO]: 	avg_search_speed_ms: 10.31236615771255
2025-03-13 16:42:18,926 [INFO]: 	99p_search_speed_ms: 18.349147888366108
2025-03-13 16:42:18,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:18,926 [INFO]: 	nb vectors: 2289
2025-03-13 16:42:18,926 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:18,926 [INFO]: 	compression ratio: 0.9993094697776063
2025-03-13 16:42:18,926 [INFO]: }
2025-03-13 16:42:18,926 [INFO]: 	>>> Finished "Creating the index" in 54.4831 secs
2025-03-13 16:42:18,926 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5149 secs
2025-03-13 16:42:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 8942 [episode count 9/20]
[retrieval_preprocessing] for episode 66319 [episode count 10/20], we have num_retrieval=np.int64(2300) num_query=np.int64(141)
2025-03-13 16:42:20,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:21,319 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:21
2025-03-13 16:42:21,319 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.25it/s]
2025-03-13 16:42:21,348 [INFO]: There are 2300 embeddings of dim 49152
2025-03-13 16:42:21,349 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 16:42:21,349 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:21
2025-03-13 16:42:21,349 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:21,350 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:42:21,350 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:21,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:42:21,350 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:21
2025-03-13 16:42:21,350 [INFO]: 474.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:21,351 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:42:21,351 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:21
2025-03-13 16:42:21,351 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:21,351 [INFO]: 	Creating the index 03/13/2025, 16:42:21
2025-03-13 16:42:21,351 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:21
2025-03-13 16:42:21,354 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 16:42:21,354 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:21
2025-03-13 16:42:21,355 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:42:21,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.68it/s] 30%|███       | 3/10 [00:00<00:00,  9.71it/s] 50%|█████     | 5/10 [00:00<00:00, 10.73it/s] 70%|███████   | 7/10 [00:00<00:00, 11.33it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.52it/s]100%|██████████| 10/10 [00:02<00:00,  4.23it/s]
2025-03-13 16:42:23,723 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:23
2025-03-13 16:42:49,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9404 secs
2025-03-13 16:42:49,664 [INFO]: The best hyperparameters are: efSearch=353
2025-03-13 16:42:49,664 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 16:43:15,756 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0913 secs
2025-03-13 16:43:15,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4031 secs
2025-03-13 16:43:15,758 [INFO]: {
2025-03-13 16:43:15,758 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:15,758 [INFO]: 	index_param: efSearch=353
2025-03-13 16:43:15,758 [INFO]: 	index_path: knn.index
2025-03-13 16:43:15,758 [INFO]: 	size in bytes: 452510890
2025-03-13 16:43:15,758 [INFO]: 	avg_search_speed_ms: 9.617750123008872
2025-03-13 16:43:15,758 [INFO]: 	99p_search_speed_ms: 13.855992800090458
2025-03-13 16:43:15,758 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:15,758 [INFO]: 	nb vectors: 2300
2025-03-13 16:43:15,758 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:15,758 [INFO]: 	compression ratio: 0.9993094309840809
2025-03-13 16:43:15,758 [INFO]: }
2025-03-13 16:43:15,758 [INFO]: 	>>> Finished "Creating the index" in 54.4065 secs
2025-03-13 16:43:15,758 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4387 secs
2025-03-13 16:43:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 66319 [episode count 10/20]
[retrieval_preprocessing] for episode 9034 [episode count 11/20], we have num_retrieval=np.int64(2339) num_query=np.int64(102)
2025-03-13 16:43:20,209 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:20,545 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:20
2025-03-13 16:43:20,545 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2263.52it/s]
2025-03-13 16:43:20,568 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 16:43:20,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 16:43:20,569 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:20,569 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:43:20,569 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:20,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:20,569 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,569 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:20,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:43:20,569 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:20
2025-03-13 16:43:20,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:20,569 [INFO]: 	Creating the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,569 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:20
2025-03-13 16:43:20,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:20,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:20
2025-03-13 16:43:20,570 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:43:20,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.09it/s] 30%|███       | 3/10 [00:00<00:00,  8.91it/s] 50%|█████     | 5/10 [00:00<00:00,  9.64it/s] 70%|███████   | 7/10 [00:00<00:00, 11.49it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.77it/s]100%|██████████| 10/10 [00:02<00:00,  4.48it/s]
2025-03-13 16:43:22,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:22
2025-03-13 16:43:49,189 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3853 secs
2025-03-13 16:43:49,189 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 16:43:49,189 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.55it/s]
2025-03-13 16:44:11,367 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1781 secs
2025-03-13 16:44:11,370 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7999 secs
2025-03-13 16:44:11,370 [INFO]: {
2025-03-13 16:44:11,370 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:11,370 [INFO]: 	index_param: efSearch=213
2025-03-13 16:44:11,370 [INFO]: 	index_path: knn.index
2025-03-13 16:44:11,370 [INFO]: 	size in bytes: 460183870
2025-03-13 16:44:11,370 [INFO]: 	avg_search_speed_ms: 10.351941713775984
2025-03-13 16:44:11,370 [INFO]: 	99p_search_speed_ms: 20.099170401226743
2025-03-13 16:44:11,370 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:11,370 [INFO]: 	nb vectors: 2339
2025-03-13 16:44:11,370 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:11,370 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 16:44:11,370 [INFO]: }
2025-03-13 16:44:11,370 [INFO]: 	>>> Finished "Creating the index" in 50.8014 secs
2025-03-13 16:44:11,371 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8254 secs
2025-03-13 16:44:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 9034 [episode count 11/20]
[retrieval_preprocessing] for episode 32026 [episode count 12/20], we have num_retrieval=np.int64(2314) num_query=np.int64(127)
2025-03-13 16:44:13,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:13,956 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:13
2025-03-13 16:44:13,956 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.80it/s]
2025-03-13 16:44:13,983 [INFO]: There are 2314 embeddings of dim 49152
2025-03-13 16:44:13,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 16:44:13,983 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:13,983 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:44:13,983 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:13,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:44:13,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,984 [INFO]: 477.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:13,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:44:13,984 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:13
2025-03-13 16:44:13,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:13,984 [INFO]: 	Creating the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:13
2025-03-13 16:44:13,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:44:13,985 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:13
2025-03-13 16:44:13,985 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:44:13,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.87it/s] 30%|███       | 3/10 [00:00<00:00,  8.39it/s] 40%|████      | 4/10 [00:00<00:00,  7.21it/s] 50%|█████     | 5/10 [00:00<00:00,  7.78it/s] 60%|██████    | 6/10 [00:00<00:00,  8.38it/s] 70%|███████   | 7/10 [00:00<00:00,  8.77it/s] 80%|████████  | 8/10 [00:00<00:00,  9.00it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.25it/s]100%|██████████| 10/10 [00:03<00:00,  1.34it/s]100%|██████████| 10/10 [00:03<00:00,  3.06it/s]
2025-03-13 16:44:17,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:17
2025-03-13 16:44:46,836 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5796 secs
2025-03-13 16:44:46,836 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 16:44:46,836 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s]
2025-03-13 16:45:14,227 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3910 secs
2025-03-13 16:45:14,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2439 secs
2025-03-13 16:45:14,229 [INFO]: {
2025-03-13 16:45:14,229 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:14,229 [INFO]: 	index_param: efSearch=239
2025-03-13 16:45:14,229 [INFO]: 	index_path: knn.index
2025-03-13 16:45:14,229 [INFO]: 	size in bytes: 455265310
2025-03-13 16:45:14,229 [INFO]: 	avg_search_speed_ms: 8.399913302121856
2025-03-13 16:45:14,229 [INFO]: 	99p_search_speed_ms: 11.530288292560723
2025-03-13 16:45:14,229 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:14,229 [INFO]: 	nb vectors: 2314
2025-03-13 16:45:14,229 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:14,229 [INFO]: 	compression ratio: 0.9993094180621844
2025-03-13 16:45:14,229 [INFO]: }
2025-03-13 16:45:14,229 [INFO]: 	>>> Finished "Creating the index" in 60.2455 secs
2025-03-13 16:45:14,229 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2734 secs
2025-03-13 16:45:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 32026 [episode count 12/20]
[retrieval_preprocessing] for episode 42778 [episode count 13/20], we have num_retrieval=np.int64(2313) num_query=np.int64(128)
2025-03-13 16:45:15,949 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:16,276 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:16
2025-03-13 16:45:16,276 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.93it/s]
2025-03-13 16:45:16,301 [INFO]: There are 2313 embeddings of dim 49152
2025-03-13 16:45:16,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:45:16,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:16
2025-03-13 16:45:16,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:16,302 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:45:16,303 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:16,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:45:16,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:16
2025-03-13 16:45:16,303 [INFO]: 477.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:16,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:45:16,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:16
2025-03-13 16:45:16,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:16,304 [INFO]: 	Creating the index 03/13/2025, 16:45:16
2025-03-13 16:45:16,304 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:16
2025-03-13 16:45:16,307 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 16:45:16,307 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:16
2025-03-13 16:45:16,307 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:45:16,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.84it/s] 30%|███       | 3/10 [00:00<00:00,  9.55it/s] 50%|█████     | 5/10 [00:00<00:00, 10.82it/s] 70%|███████   | 7/10 [00:00<00:00, 11.56it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.08it/s]100%|██████████| 10/10 [00:02<00:00,  4.71it/s]
2025-03-13 16:45:18,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:18
2025-03-13 16:45:42,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4569 secs
2025-03-13 16:45:42,896 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 16:45:42,896 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 16:46:06,963 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0667 secs
2025-03-13 16:46:06,965 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6583 secs
2025-03-13 16:46:06,966 [INFO]: {
2025-03-13 16:46:06,966 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:06,966 [INFO]: 	index_param: efSearch=256
2025-03-13 16:46:06,966 [INFO]: 	index_path: knn.index
2025-03-13 16:46:06,966 [INFO]: 	size in bytes: 455068570
2025-03-13 16:46:06,966 [INFO]: 	avg_search_speed_ms: 10.232025901848944
2025-03-13 16:46:06,966 [INFO]: 	99p_search_speed_ms: 17.733632205054167
2025-03-13 16:46:06,966 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:06,966 [INFO]: 	nb vectors: 2313
2025-03-13 16:46:06,966 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:06,966 [INFO]: 	compression ratio: 0.9993094095687601
2025-03-13 16:46:06,966 [INFO]: }
2025-03-13 16:46:06,966 [INFO]: 	>>> Finished "Creating the index" in 50.6617 secs
2025-03-13 16:46:06,966 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6900 secs
2025-03-13 16:46:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 42778 [episode count 13/20]
[retrieval_preprocessing] for episode 55593 [episode count 14/20], we have num_retrieval=np.int64(2333) num_query=np.int64(108)
2025-03-13 16:46:09,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:10,163 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:10
2025-03-13 16:46:10,164 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-13 16:46:10,187 [INFO]: There are 2333 embeddings of dim 49152
2025-03-13 16:46:10,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 16:46:10,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:10,187 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:46:10,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:10,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:10,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,188 [INFO]: 481.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:10,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:46:10,188 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:10
2025-03-13 16:46:10,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:10,188 [INFO]: 	Creating the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:10
2025-03-13 16:46:10,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:46:10,189 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,189 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:46:10,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.84it/s] 30%|███       | 3/10 [00:00<00:00,  8.98it/s] 50%|█████     | 5/10 [00:00<00:00,  9.77it/s] 70%|███████   | 7/10 [00:00<00:00, 10.25it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.32it/s]100%|██████████| 10/10 [00:02<00:00,  3.61it/s]
2025-03-13 16:46:13,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:13
2025-03-13 16:46:40,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9299 secs
2025-03-13 16:46:40,436 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 16:46:40,436 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 16:47:04,752 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3166 secs
2025-03-13 16:47:04,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5657 secs
2025-03-13 16:47:04,755 [INFO]: {
2025-03-13 16:47:04,755 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:04,755 [INFO]: 	index_param: efSearch=282
2025-03-13 16:47:04,755 [INFO]: 	index_path: knn.index
2025-03-13 16:47:04,755 [INFO]: 	size in bytes: 459003430
2025-03-13 16:47:04,755 [INFO]: 	avg_search_speed_ms: 9.730890147063649
2025-03-13 16:47:04,755 [INFO]: 	99p_search_speed_ms: 13.042709080036731
2025-03-13 16:47:04,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:04,755 [INFO]: 	nb vectors: 2333
2025-03-13 16:47:04,755 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:04,755 [INFO]: 	compression ratio: 0.9993094474261336
2025-03-13 16:47:04,755 [INFO]: }
2025-03-13 16:47:04,755 [INFO]: 	>>> Finished "Creating the index" in 54.5670 secs
2025-03-13 16:47:04,755 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5912 secs
2025-03-13 16:47:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 55593 [episode count 14/20]
[retrieval_preprocessing] for episode 48529 [episode count 15/20], we have num_retrieval=np.int64(2300) num_query=np.int64(141)
2025-03-13 16:47:06,814 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:07,215 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:07
2025-03-13 16:47:07,215 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 16:47:07,240 [INFO]: There are 2300 embeddings of dim 49152
2025-03-13 16:47:07,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 16:47:07,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:07
2025-03-13 16:47:07,240 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:07,240 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:47:07,240 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:07,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:07,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:07
2025-03-13 16:47:07,241 [INFO]: 474.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:07,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:47:07,241 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:07
2025-03-13 16:47:07,241 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:07,241 [INFO]: 	Creating the index 03/13/2025, 16:47:07
2025-03-13 16:47:07,241 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:07
2025-03-13 16:47:07,242 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:47:07,242 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:07
2025-03-13 16:47:07,242 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:47:07,242 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.59it/s] 20%|██        | 2/10 [00:00<00:01,  7.54it/s] 30%|███       | 3/10 [00:00<00:00,  8.34it/s] 40%|████      | 4/10 [00:00<00:00,  8.85it/s] 60%|██████    | 6/10 [00:00<00:00,  9.68it/s] 70%|███████   | 7/10 [00:00<00:00,  9.74it/s] 80%|████████  | 8/10 [00:00<00:00,  9.77it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.25it/s]100%|██████████| 10/10 [00:02<00:00,  1.73it/s]100%|██████████| 10/10 [00:02<00:00,  3.66it/s]
2025-03-13 16:47:09,976 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:09
2025-03-13 16:47:36,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9310 secs
2025-03-13 16:47:36,907 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 16:47:36,907 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 16:48:06,569 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6616 secs
2025-03-13 16:48:06,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3297 secs
2025-03-13 16:48:06,572 [INFO]: {
2025-03-13 16:48:06,572 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:06,572 [INFO]: 	index_param: efSearch=304
2025-03-13 16:48:06,572 [INFO]: 	index_path: knn.index
2025-03-13 16:48:06,572 [INFO]: 	size in bytes: 452510890
2025-03-13 16:48:06,572 [INFO]: 	avg_search_speed_ms: 11.111261707782331
2025-03-13 16:48:06,572 [INFO]: 	99p_search_speed_ms: 18.86844004271552
2025-03-13 16:48:06,572 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:06,572 [INFO]: 	nb vectors: 2300
2025-03-13 16:48:06,572 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:06,572 [INFO]: 	compression ratio: 0.9993094309840809
2025-03-13 16:48:06,572 [INFO]: }
2025-03-13 16:48:06,572 [INFO]: 	>>> Finished "Creating the index" in 59.3313 secs
2025-03-13 16:48:06,572 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3570 secs
2025-03-13 16:48:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 48529 [episode count 15/20]
[retrieval_preprocessing] for episode 86881 [episode count 16/20], we have num_retrieval=np.int64(2286) num_query=np.int64(155)
2025-03-13 16:48:09,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:09,690 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:09
2025-03-13 16:48:09,690 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2275.80it/s]
2025-03-13 16:48:09,715 [INFO]: There are 2286 embeddings of dim 49152
2025-03-13 16:48:09,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:48:09,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:09
2025-03-13 16:48:09,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:09,716 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:48:09,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:09,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:48:09,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:09
2025-03-13 16:48:09,716 [INFO]: 471.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:09,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:48:09,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:09
2025-03-13 16:48:09,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:09,717 [INFO]: 	Creating the index 03/13/2025, 16:48:09
2025-03-13 16:48:09,717 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:09
2025-03-13 16:48:09,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 16:48:09,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:09
2025-03-13 16:48:09,720 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:48:09,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.42it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.02it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.75it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.45it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.46it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.28it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.33it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.24it/s]100%|██████████| 9/9 [00:02<00:00,  1.52it/s]100%|██████████| 9/9 [00:02<00:00,  3.17it/s]
2025-03-13 16:48:12,573 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:12
2025-03-13 16:48:45,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4865 secs
2025-03-13 16:48:45,061 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 16:48:45,061 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-13 16:49:00,486 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4256 secs
2025-03-13 16:49:00,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7689 secs
2025-03-13 16:49:00,489 [INFO]: {
2025-03-13 16:49:00,489 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:00,489 [INFO]: 	index_param: efSearch=268
2025-03-13 16:49:00,489 [INFO]: 	index_path: knn.index
2025-03-13 16:49:00,489 [INFO]: 	size in bytes: 449756410
2025-03-13 16:49:00,489 [INFO]: 	avg_search_speed_ms: 10.244068221838242
2025-03-13 16:49:00,489 [INFO]: 	99p_search_speed_ms: 21.23523519374431
2025-03-13 16:49:00,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:00,489 [INFO]: 	nb vectors: 2286
2025-03-13 16:49:00,489 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:00,489 [INFO]: 	compression ratio: 0.9993095773776742
2025-03-13 16:49:00,489 [INFO]: }
2025-03-13 16:49:00,489 [INFO]: 	>>> Finished "Creating the index" in 50.7723 secs
2025-03-13 16:49:00,489 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7994 secs
2025-03-13 16:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 86881 [episode count 16/20]
[retrieval_preprocessing] for episode 67964 [episode count 17/20], we have num_retrieval=np.int64(2344) num_query=np.int64(97)
2025-03-13 16:49:03,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:04,251 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:04
2025-03-13 16:49:04,251 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-13 16:49:04,279 [INFO]: There are 2344 embeddings of dim 49152
2025-03-13 16:49:04,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:49:04,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:04
2025-03-13 16:49:04,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:04,280 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:49:04,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:04,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:04,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:04
2025-03-13 16:49:04,280 [INFO]: 483.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:04,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:49:04,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:04
2025-03-13 16:49:04,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:04,280 [INFO]: 	Creating the index 03/13/2025, 16:49:04
2025-03-13 16:49:04,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:04
2025-03-13 16:49:04,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:49:04,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:04
2025-03-13 16:49:04,282 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:49:04,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.78it/s] 20%|██        | 2/10 [00:00<00:01,  5.65it/s] 30%|███       | 3/10 [00:00<00:01,  6.82it/s] 40%|████      | 4/10 [00:00<00:00,  7.42it/s] 50%|█████     | 5/10 [00:00<00:00,  7.85it/s] 60%|██████    | 6/10 [00:00<00:00,  8.05it/s] 70%|███████   | 7/10 [00:00<00:00,  8.33it/s] 80%|████████  | 8/10 [00:01<00:00,  8.59it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.87it/s]100%|██████████| 10/10 [00:03<00:00,  1.36it/s]100%|██████████| 10/10 [00:03<00:00,  3.03it/s]
2025-03-13 16:49:07,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:07
2025-03-13 16:49:36,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7712 secs
2025-03-13 16:49:36,356 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 16:49:36,356 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 16:50:05,232 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8759 secs
2025-03-13 16:50:05,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9524 secs
2025-03-13 16:50:05,234 [INFO]: {
2025-03-13 16:50:05,234 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:05,234 [INFO]: 	index_param: efSearch=265
2025-03-13 16:50:05,234 [INFO]: 	index_path: knn.index
2025-03-13 16:50:05,234 [INFO]: 	size in bytes: 461167570
2025-03-13 16:50:05,234 [INFO]: 	avg_search_speed_ms: 8.096745493350483
2025-03-13 16:50:05,234 [INFO]: 	99p_search_speed_ms: 11.485565071925524
2025-03-13 16:50:05,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:05,234 [INFO]: 	nb vectors: 2344
2025-03-13 16:50:05,235 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:05,235 [INFO]: 	compression ratio: 0.9993095394804106
2025-03-13 16:50:05,235 [INFO]: }
2025-03-13 16:50:05,235 [INFO]: 	>>> Finished "Creating the index" in 60.9542 secs
2025-03-13 16:50:05,235 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9833 secs
2025-03-13 16:50:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 67964 [episode count 17/20]
[retrieval_preprocessing] for episode 53190 [episode count 18/20], we have num_retrieval=np.int64(2359) num_query=np.int64(82)
2025-03-13 16:50:06,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:07,044 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:07
2025-03-13 16:50:07,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2278.27it/s]
2025-03-13 16:50:07,069 [INFO]: There are 2359 embeddings of dim 49152
2025-03-13 16:50:07,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 16:50:07,069 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:07
2025-03-13 16:50:07,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:07,070 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:50:07,070 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:07,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:50:07,070 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:07
2025-03-13 16:50:07,070 [INFO]: 486.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:07,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:50:07,071 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:07
2025-03-13 16:50:07,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:07,071 [INFO]: 	Creating the index 03/13/2025, 16:50:07
2025-03-13 16:50:07,071 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:07
2025-03-13 16:50:07,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:50:07,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:07
2025-03-13 16:50:07,074 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:50:07,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.65it/s] 20%|██        | 2/10 [00:00<00:01,  7.24it/s] 30%|███       | 3/10 [00:00<00:00,  7.96it/s] 40%|████      | 4/10 [00:00<00:00,  8.45it/s] 60%|██████    | 6/10 [00:00<00:00,  9.47it/s] 80%|████████  | 8/10 [00:00<00:00, 10.24it/s]100%|██████████| 10/10 [00:02<00:00,  2.92it/s]100%|██████████| 10/10 [00:02<00:00,  4.26it/s]
2025-03-13 16:50:09,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:09
2025-03-13 16:50:34,287 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8600 secs
2025-03-13 16:50:34,287 [INFO]: The best hyperparameters are: efSearch=381
2025-03-13 16:50:34,287 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 16:51:03,205 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9174 secs
2025-03-13 16:51:03,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1331 secs
2025-03-13 16:51:03,208 [INFO]: {
2025-03-13 16:51:03,208 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:03,208 [INFO]: 	index_param: efSearch=381
2025-03-13 16:51:03,208 [INFO]: 	index_path: knn.index
2025-03-13 16:51:03,208 [INFO]: 	size in bytes: 464118670
2025-03-13 16:51:03,208 [INFO]: 	avg_search_speed_ms: 12.199561321176589
2025-03-13 16:51:03,208 [INFO]: 	99p_search_speed_ms: 20.5290734115988
2025-03-13 16:51:03,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:03,208 [INFO]: 	nb vectors: 2359
2025-03-13 16:51:03,208 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:03,209 [INFO]: 	compression ratio: 0.9993096636254689
2025-03-13 16:51:03,209 [INFO]: }
2025-03-13 16:51:03,209 [INFO]: 	>>> Finished "Creating the index" in 56.1374 secs
2025-03-13 16:51:03,209 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1648 secs
2025-03-13 16:51:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 53190 [episode count 18/20]
[retrieval_preprocessing] for episode 23883 [episode count 19/20], we have num_retrieval=np.int64(2326) num_query=np.int64(115)
2025-03-13 16:51:05,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:06,435 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:06
2025-03-13 16:51:06,435 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.07it/s]
2025-03-13 16:51:06,464 [INFO]: There are 2326 embeddings of dim 49152
2025-03-13 16:51:06,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:51:06,464 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:06
2025-03-13 16:51:06,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:06,464 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:51:06,464 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:06,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:06,464 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:06
2025-03-13 16:51:06,465 [INFO]: 480.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:06,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:06,465 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:06
2025-03-13 16:51:06,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:06,465 [INFO]: 	Creating the index 03/13/2025, 16:51:06
2025-03-13 16:51:06,465 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:06
2025-03-13 16:51:06,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:51:06,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:06
2025-03-13 16:51:06,466 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:51:06,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.34it/s] 20%|██        | 2/10 [00:00<00:01,  5.53it/s] 30%|███       | 3/10 [00:00<00:01,  6.14it/s] 40%|████      | 4/10 [00:00<00:00,  6.58it/s] 50%|█████     | 5/10 [00:00<00:00,  7.04it/s] 60%|██████    | 6/10 [00:00<00:00,  7.44it/s] 70%|███████   | 7/10 [00:01<00:00,  7.80it/s] 80%|████████  | 8/10 [00:01<00:00,  8.21it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.60it/s]100%|██████████| 10/10 [00:02<00:00,  1.95it/s]100%|██████████| 10/10 [00:02<00:00,  3.80it/s]
2025-03-13 16:51:09,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:09
2025-03-13 16:51:40,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5345 secs
2025-03-13 16:51:40,634 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 16:51:40,634 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 16:51:58,796 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1621 secs
2025-03-13 16:51:58,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3327 secs
2025-03-13 16:51:58,799 [INFO]: {
2025-03-13 16:51:58,799 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:58,799 [INFO]: 	index_param: efSearch=270
2025-03-13 16:51:58,799 [INFO]: 	index_path: knn.index
2025-03-13 16:51:58,799 [INFO]: 	size in bytes: 457626250
2025-03-13 16:51:58,799 [INFO]: 	avg_search_speed_ms: 10.328897130382472
2025-03-13 16:51:58,799 [INFO]: 	99p_search_speed_ms: 15.250367065891606
2025-03-13 16:51:58,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:58,799 [INFO]: 	nb vectors: 2326
2025-03-13 16:51:58,799 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:58,799 [INFO]: 	compression ratio: 0.9993093883928206
2025-03-13 16:51:58,799 [INFO]: }
2025-03-13 16:51:58,799 [INFO]: 	>>> Finished "Creating the index" in 52.3342 secs
2025-03-13 16:51:58,799 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3644 secs
2025-03-13 16:51:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 23883 [episode count 19/20]
2025-03-13 16:51:59: [retrieval_preprocessing] finished for 5374398722_press_stapler [chosen_id count 5/196]
2025-03-13 16:52:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5594497977_Close the air fryer [chosen_id count 6/196]
2025-03-13 16:52:03: [retrieval_preprocessing] we have num_total=3920 embedding_dim=49152
[retrieval_preprocessing] for episode 35356 [episode count 0/20], we have num_retrieval=np.int64(3827) num_query=np.int64(93)
2025-03-13 16:52:04,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:05,655 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:05
2025-03-13 16:52:05,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.07it/s]
2025-03-13 16:52:05,678 [INFO]: There are 3827 embeddings of dim 49152
2025-03-13 16:52:05,678 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 16:52:05,678 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:05
2025-03-13 16:52:05,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:05,679 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:52:05,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:05,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:52:05,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:05
2025-03-13 16:52:05,679 [INFO]: 789.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:05,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:52:05,679 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:05
2025-03-13 16:52:05,679 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:05,679 [INFO]: 	Creating the index 03/13/2025, 16:52:05
2025-03-13 16:52:05,679 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:05
2025-03-13 16:52:05,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:52:05,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:05
2025-03-13 16:52:05,680 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:52:05,680 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.69it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.81it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.30it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.46it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.92it/s] 50%|█████     | 8/16 [00:01<00:01,  7.96it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.89it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.87it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.88it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.96it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.87it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.01it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.31it/s]100%|██████████| 16/16 [00:04<00:00,  1.07it/s]100%|██████████| 16/16 [00:04<00:00,  3.35it/s]
2025-03-13 16:52:10,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:10
2025-03-13 16:52:49,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4206 secs
2025-03-13 16:52:49,134 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 16:52:49,134 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 16:53:28,985 [INFO]: 	>>> Finished "Compute fast metrics" in 39.8506 secs
2025-03-13 16:53:28,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3074 secs
2025-03-13 16:53:28,988 [INFO]: {
2025-03-13 16:53:28,988 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:28,988 [INFO]: 	index_param: efSearch=272
2025-03-13 16:53:28,988 [INFO]: 	index_path: knn.index
2025-03-13 16:53:28,988 [INFO]: 	size in bytes: 752939050
2025-03-13 16:53:28,988 [INFO]: 	avg_search_speed_ms: 13.550268483936726
2025-03-13 16:53:28,988 [INFO]: 	99p_search_speed_ms: 19.059878014959395
2025-03-13 16:53:28,988 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:28,988 [INFO]: 	nb vectors: 3827
2025-03-13 16:53:28,988 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:28,988 [INFO]: 	compression ratio: 0.9993090622673907
2025-03-13 16:53:28,988 [INFO]: }
2025-03-13 16:53:28,988 [INFO]: 	>>> Finished "Creating the index" in 83.3088 secs
2025-03-13 16:53:28,988 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3333 secs
2025-03-13 16:53:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 35356 [episode count 0/20]
[retrieval_preprocessing] for episode 91181 [episode count 1/20], we have num_retrieval=np.int64(3725) num_query=np.int64(195)
2025-03-13 16:53:31,280 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:31,855 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:31
2025-03-13 16:53:31,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2334.06it/s]
2025-03-13 16:53:31,888 [INFO]: There are 3725 embeddings of dim 49152
2025-03-13 16:53:31,888 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 16:53:31,888 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:31
2025-03-13 16:53:31,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:31,888 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 16:53:31,888 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:31,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:31,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:31
2025-03-13 16:53:31,889 [INFO]: 768.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:31,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:53:31,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:31
2025-03-13 16:53:31,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:31,889 [INFO]: 	Creating the index 03/13/2025, 16:53:31
2025-03-13 16:53:31,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:31
2025-03-13 16:53:31,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:53:31,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:31
2025-03-13 16:53:31,890 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:53:31,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.22it/s] 20%|██        | 3/15 [00:00<00:01, 10.19it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.76it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.91it/s] 60%|██████    | 9/15 [00:00<00:00, 11.46it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.89it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.16it/s]100%|██████████| 15/15 [00:04<00:00,  1.90it/s]100%|██████████| 15/15 [00:04<00:00,  3.70it/s]
2025-03-13 16:53:35,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:35
2025-03-13 16:54:14,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1997 secs
2025-03-13 16:54:14,143 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:54:14,144 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 16:54:32,125 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9816 secs
2025-03-13 16:54:32,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2384 secs
2025-03-13 16:54:32,128 [INFO]: {
2025-03-13 16:54:32,128 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:32,128 [INFO]: 	index_param: efSearch=187
2025-03-13 16:54:32,128 [INFO]: 	index_path: knn.index
2025-03-13 16:54:32,128 [INFO]: 	size in bytes: 732870970
2025-03-13 16:54:32,128 [INFO]: 	avg_search_speed_ms: 10.056489460104748
2025-03-13 16:54:32,129 [INFO]: 	99p_search_speed_ms: 17.71381638012826
2025-03-13 16:54:32,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:32,129 [INFO]: 	nb vectors: 3725
2025-03-13 16:54:32,129 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:32,129 [INFO]: 	compression ratio: 0.999309332719237
2025-03-13 16:54:32,129 [INFO]: }
2025-03-13 16:54:32,129 [INFO]: 	>>> Finished "Creating the index" in 60.2398 secs
2025-03-13 16:54:32,129 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2732 secs
2025-03-13 16:54:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 91181 [episode count 1/20]
[retrieval_preprocessing] for episode 35917 [episode count 2/20], we have num_retrieval=np.int64(3797) num_query=np.int64(123)
2025-03-13 16:54:35,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:36,375 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:36
2025-03-13 16:54:36,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1347.35it/s]
2025-03-13 16:54:36,398 [INFO]: There are 3797 embeddings of dim 49152
2025-03-13 16:54:36,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 16:54:36,398 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:36
2025-03-13 16:54:36,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:36,398 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:54:36,399 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:36,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:36,399 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:36
2025-03-13 16:54:36,399 [INFO]: 783.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:36,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:54:36,399 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:36
2025-03-13 16:54:36,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:36,399 [INFO]: 	Creating the index 03/13/2025, 16:54:36
2025-03-13 16:54:36,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:36
2025-03-13 16:54:36,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:54:36,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:36
2025-03-13 16:54:36,400 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:54:36,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.08it/s] 20%|██        | 3/15 [00:00<00:01,  9.56it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.02it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.42it/s] 60%|██████    | 9/15 [00:00<00:00, 11.49it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.14it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.98it/s]100%|██████████| 15/15 [00:04<00:00,  1.69it/s]100%|██████████| 15/15 [00:04<00:00,  3.36it/s]
2025-03-13 16:54:40,863 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:40
2025-03-13 16:55:18,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4707 secs
2025-03-13 16:55:18,335 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:55:18,335 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.83it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 16:55:44,806 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4711 secs
2025-03-13 16:55:44,809 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4086 secs
2025-03-13 16:55:44,809 [INFO]: {
2025-03-13 16:55:44,809 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:44,809 [INFO]: 	index_param: efSearch=218
2025-03-13 16:55:44,809 [INFO]: 	index_path: knn.index
2025-03-13 16:55:44,809 [INFO]: 	size in bytes: 747036610
2025-03-13 16:55:44,809 [INFO]: 	avg_search_speed_ms: 9.632430301308704
2025-03-13 16:55:44,809 [INFO]: 	99p_search_speed_ms: 16.08969148714095
2025-03-13 16:55:44,809 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:44,809 [INFO]: 	nb vectors: 3797
2025-03-13 16:55:44,809 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:44,809 [INFO]: 	compression ratio: 0.9993092252868303
2025-03-13 16:55:44,809 [INFO]: }
2025-03-13 16:55:44,809 [INFO]: 	>>> Finished "Creating the index" in 68.4101 secs
2025-03-13 16:55:44,809 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4342 secs
2025-03-13 16:55:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 35917 [episode count 2/20]
[retrieval_preprocessing] for episode 27727 [episode count 3/20], we have num_retrieval=np.int64(3169) num_query=np.int64(751)
2025-03-13 16:55:46,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:47,009 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:47
2025-03-13 16:55:47,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-13 16:55:47,052 [INFO]: There are 3169 embeddings of dim 49152
2025-03-13 16:55:47,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 16:55:47,053 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:47
2025-03-13 16:55:47,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:47,053 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:55:47,053 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:47,053 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:47,053 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:47
2025-03-13 16:55:47,053 [INFO]: 654.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:47,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:55:47,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:47
2025-03-13 16:55:47,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:47,053 [INFO]: 	Creating the index 03/13/2025, 16:55:47
2025-03-13 16:55:47,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:47
2025-03-13 16:55:47,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:55:47,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:47
2025-03-13 16:55:47,055 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:55:47,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.85it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.96it/s]100%|██████████| 13/13 [00:02<00:00,  4.36it/s]100%|██████████| 13/13 [00:02<00:00,  5.11it/s]
2025-03-13 16:55:49,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:49
2025-03-13 16:56:23,947 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3422 secs
2025-03-13 16:56:23,948 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 16:56:23,948 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 16:56:56,072 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1243 secs
2025-03-13 16:56:56,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0201 secs
2025-03-13 16:56:56,075 [INFO]: {
2025-03-13 16:56:56,075 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:56,075 [INFO]: 	index_param: efSearch=251
2025-03-13 16:56:56,075 [INFO]: 	index_path: knn.index
2025-03-13 16:56:56,075 [INFO]: 	size in bytes: 623481130
2025-03-13 16:56:56,075 [INFO]: 	avg_search_speed_ms: 12.73305287066866
2025-03-13 16:56:56,075 [INFO]: 	99p_search_speed_ms: 18.324251519516107
2025-03-13 16:56:56,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:56,075 [INFO]: 	nb vectors: 3169
2025-03-13 16:56:56,075 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:56,075 [INFO]: 	compression ratio: 0.9993097176814316
2025-03-13 16:56:56,075 [INFO]: }
2025-03-13 16:56:56,075 [INFO]: 	>>> Finished "Creating the index" in 69.0222 secs
2025-03-13 16:56:56,076 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0665 secs
2025-03-13 16:57:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 27727 [episode count 3/20]
[retrieval_preprocessing] for episode 72814 [episode count 4/20], we have num_retrieval=np.int64(3844) num_query=np.int64(76)
2025-03-13 16:57:07,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:08,054 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:08
2025-03-13 16:57:08,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.18it/s]
2025-03-13 16:57:08,095 [INFO]: There are 3844 embeddings of dim 49152
2025-03-13 16:57:08,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0414 secs
2025-03-13 16:57:08,095 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:08
2025-03-13 16:57:08,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:08,095 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:57:08,095 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:08,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:08,095 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:08
2025-03-13 16:57:08,095 [INFO]: 793.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:08,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:57:08,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:08
2025-03-13 16:57:08,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:08,096 [INFO]: 	Creating the index 03/13/2025, 16:57:08
2025-03-13 16:57:08,096 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:08
2025-03-13 16:57:08,097 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:57:08,097 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:08
2025-03-13 16:57:08,097 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:57:08,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.00it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.57it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.11it/s]100%|██████████| 16/16 [00:03<00:00,  3.20it/s]100%|██████████| 16/16 [00:03<00:00,  4.31it/s]
2025-03-13 16:57:11,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:11
2025-03-13 16:58:04,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9048 secs
2025-03-13 16:58:04,715 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 16:58:04,715 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.14it/s]
2025-03-13 16:58:24,077 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3619 secs
2025-03-13 16:58:24,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9829 secs
2025-03-13 16:58:24,080 [INFO]: {
2025-03-13 16:58:24,080 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:24,080 [INFO]: 	index_param: efSearch=161
2025-03-13 16:58:24,080 [INFO]: 	index_path: knn.index
2025-03-13 16:58:24,080 [INFO]: 	size in bytes: 756283810
2025-03-13 16:58:24,080 [INFO]: 	avg_search_speed_ms: 8.723522633977273
2025-03-13 16:58:24,080 [INFO]: 	99p_search_speed_ms: 14.167978719342493
2025-03-13 16:58:24,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:24,080 [INFO]: 	nb vectors: 3844
2025-03-13 16:58:24,080 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:24,080 [INFO]: 	compression ratio: 0.9993089128802056
2025-03-13 16:58:24,080 [INFO]: }
2025-03-13 16:58:24,080 [INFO]: 	>>> Finished "Creating the index" in 75.9843 secs
2025-03-13 16:58:24,080 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0262 secs
2025-03-13 16:58:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 72814 [episode count 4/20]
[retrieval_preprocessing] for episode 46179 [episode count 5/20], we have num_retrieval=np.int64(3305) num_query=np.int64(615)
2025-03-13 16:58:25,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:25,606 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:25
2025-03-13 16:58:25,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.90it/s]
2025-03-13 16:58:25,643 [INFO]: There are 3305 embeddings of dim 49152
2025-03-13 16:58:25,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 16:58:25,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:25
2025-03-13 16:58:25,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:25,645 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 16:58:25,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:25,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:58:25,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:25
2025-03-13 16:58:25,645 [INFO]: 682.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:25,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:58:25,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:25
2025-03-13 16:58:25,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:25,646 [INFO]: 	Creating the index 03/13/2025, 16:58:25
2025-03-13 16:58:25,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:25
2025-03-13 16:58:25,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:58:25,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:25
2025-03-13 16:58:25,648 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:58:25,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.82it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.50it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.33it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.93it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.16it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.34it/s] 50%|█████     | 7/14 [00:00<00:00,  8.38it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.43it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.56it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.56it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.49it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.41it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.44it/s]100%|██████████| 14/14 [00:04<00:00,  1.04s/it]100%|██████████| 14/14 [00:04<00:00,  2.93it/s]
2025-03-13 16:58:30,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:30
2025-03-13 16:59:07,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3041 secs
2025-03-13 16:59:07,743 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 16:59:07,743 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.82it/s]
2025-03-13 16:59:38,794 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0508 secs
2025-03-13 16:59:38,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1489 secs
2025-03-13 16:59:38,797 [INFO]: {
2025-03-13 16:59:38,797 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:38,797 [INFO]: 	index_param: efSearch=154
2025-03-13 16:59:38,797 [INFO]: 	index_path: knn.index
2025-03-13 16:59:38,797 [INFO]: 	size in bytes: 650238730
2025-03-13 16:59:38,797 [INFO]: 	avg_search_speed_ms: 8.283706395420019
2025-03-13 16:59:38,797 [INFO]: 	99p_search_speed_ms: 13.020269377157094
2025-03-13 16:59:38,798 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:38,798 [INFO]: 	nb vectors: 3305
2025-03-13 16:59:38,798 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:38,798 [INFO]: 	compression ratio: 0.9993090383896388
2025-03-13 16:59:38,798 [INFO]: }
2025-03-13 16:59:38,798 [INFO]: 	>>> Finished "Creating the index" in 73.1520 secs
2025-03-13 16:59:38,798 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1916 secs
2025-03-13 16:59:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 46179 [episode count 5/20]
[retrieval_preprocessing] for episode 84091 [episode count 6/20], we have num_retrieval=np.int64(3820) num_query=np.int64(100)
2025-03-13 16:59:43,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:43,773 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:43
2025-03-13 16:59:43,773 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.78it/s]
2025-03-13 16:59:43,811 [INFO]: There are 3820 embeddings of dim 49152
2025-03-13 16:59:43,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0381 secs
2025-03-13 16:59:43,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:43
2025-03-13 16:59:43,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:43,812 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 16:59:43,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:43,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:43,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:43
2025-03-13 16:59:43,812 [INFO]: 788.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:43,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:59:43,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:43
2025-03-13 16:59:43,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:43,812 [INFO]: 	Creating the index 03/13/2025, 16:59:43
2025-03-13 16:59:43,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:43
2025-03-13 16:59:43,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:59:43,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:43
2025-03-13 16:59:43,813 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:59:43,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.32it/s] 38%|███▊      | 6/16 [00:00<00:00, 31.29it/s] 69%|██████▉   | 11/16 [00:00<00:00, 38.87it/s]100%|██████████| 16/16 [00:03<00:00,  3.93it/s]100%|██████████| 16/16 [00:03<00:00,  5.28it/s]
2025-03-13 16:59:46,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:46
2025-03-13 17:00:28,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8848 secs
2025-03-13 17:00:28,733 [INFO]: The best hyperparameters are: efSearch=81
2025-03-13 17:00:28,733 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.22it/s]
2025-03-13 17:00:52,226 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4923 secs
2025-03-13 17:00:52,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4148 secs
2025-03-13 17:00:52,228 [INFO]: {
2025-03-13 17:00:52,228 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:52,228 [INFO]: 	index_param: efSearch=81
2025-03-13 17:00:52,228 [INFO]: 	index_path: knn.index
2025-03-13 17:00:52,228 [INFO]: 	size in bytes: 751561810
2025-03-13 17:00:52,228 [INFO]: 	avg_search_speed_ms: 4.151445134426467
2025-03-13 17:00:52,228 [INFO]: 	99p_search_speed_ms: 9.997028179932386
2025-03-13 17:00:52,228 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:52,228 [INFO]: 	nb vectors: 3820
2025-03-13 17:00:52,228 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:52,228 [INFO]: 	compression ratio: 0.9993091053948044
2025-03-13 17:00:52,228 [INFO]: }
2025-03-13 17:00:52,228 [INFO]: 	>>> Finished "Creating the index" in 68.4161 secs
2025-03-13 17:00:52,228 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4548 secs
2025-03-13 17:00:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 84091 [episode count 6/20]
[retrieval_preprocessing] for episode 68749 [episode count 7/20], we have num_retrieval=np.int64(3850) num_query=np.int64(70)
2025-03-13 17:00:52,983 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:54,660 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:54
2025-03-13 17:00:54,660 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-13 17:00:54,698 [INFO]: There are 3850 embeddings of dim 49152
2025-03-13 17:00:54,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 17:00:54,699 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:54
2025-03-13 17:00:54,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:54,699 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:00:54,699 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:54,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:00:54,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:54
2025-03-13 17:00:54,700 [INFO]: 794.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:54,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:00:54,700 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:54
2025-03-13 17:00:54,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:54,701 [INFO]: 	Creating the index 03/13/2025, 17:00:54
2025-03-13 17:00:54,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:54
2025-03-13 17:00:54,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:00:54,704 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:54
2025-03-13 17:00:54,704 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:00:54,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.45it/s] 50%|█████     | 8/16 [00:00<00:00, 37.78it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.93it/s]100%|██████████| 16/16 [00:03<00:00,  5.31it/s]
2025-03-13 17:00:57,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:57
2025-03-13 17:01:36,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7963 secs
2025-03-13 17:01:36,521 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:01:36,521 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-13 17:02:08,938 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4175 secs
2025-03-13 17:02:08,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2370 secs
2025-03-13 17:02:08,941 [INFO]: {
2025-03-13 17:02:08,941 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:08,941 [INFO]: 	index_param: efSearch=206
2025-03-13 17:02:08,941 [INFO]: 	index_path: knn.index
2025-03-13 17:02:08,941 [INFO]: 	size in bytes: 757464250
2025-03-13 17:02:08,941 [INFO]: 	avg_search_speed_ms: 12.448857983502453
2025-03-13 17:02:08,941 [INFO]: 	99p_search_speed_ms: 17.728486866690226
2025-03-13 17:02:08,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:08,941 [INFO]: 	nb vectors: 3850
2025-03-13 17:02:08,941 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:08,941 [INFO]: 	compression ratio: 0.9993089442835091
2025-03-13 17:02:08,941 [INFO]: }
2025-03-13 17:02:08,941 [INFO]: 	>>> Finished "Creating the index" in 74.2405 secs
2025-03-13 17:02:08,941 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2814 secs
2025-03-13 17:02:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 68749 [episode count 7/20]
[retrieval_preprocessing] for episode 58012 [episode count 8/20], we have num_retrieval=np.int64(3823) num_query=np.int64(97)
2025-03-13 17:02:09,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:11,050 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:11
2025-03-13 17:02:11,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1123.88it/s]
2025-03-13 17:02:11,099 [INFO]: There are 3823 embeddings of dim 49152
2025-03-13 17:02:11,099 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0483 secs
2025-03-13 17:02:11,099 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:11
2025-03-13 17:02:11,099 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:11,099 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:02:11,099 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:11,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:11,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:11
2025-03-13 17:02:11,099 [INFO]: 789.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:11,099 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:11,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:11
2025-03-13 17:02:11,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:11,100 [INFO]: 	Creating the index 03/13/2025, 17:02:11
2025-03-13 17:02:11,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:11
2025-03-13 17:02:11,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:02:11,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:11
2025-03-13 17:02:11,101 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:02:11,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.71it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.44it/s] 56%|█████▋    | 9/16 [00:00<00:00, 27.39it/s] 81%|████████▏ | 13/16 [00:00<00:00, 30.43it/s]100%|██████████| 16/16 [00:04<00:00,  3.52it/s]
2025-03-13 17:02:15,654 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:15
2025-03-13 17:03:02,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4999 secs
2025-03-13 17:03:02,154 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:03:02,154 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-13 17:03:24,298 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1437 secs
2025-03-13 17:03:24,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2027 secs
2025-03-13 17:03:24,304 [INFO]: {
2025-03-13 17:03:24,304 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:24,304 [INFO]: 	index_param: efSearch=135
2025-03-13 17:03:24,304 [INFO]: 	index_path: knn.index
2025-03-13 17:03:24,304 [INFO]: 	size in bytes: 752152030
2025-03-13 17:03:24,304 [INFO]: 	avg_search_speed_ms: 6.619506334848949
2025-03-13 17:03:24,304 [INFO]: 	99p_search_speed_ms: 10.033853345084935
2025-03-13 17:03:24,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:24,304 [INFO]: 	nb vectors: 3823
2025-03-13 17:03:24,304 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:24,304 [INFO]: 	compression ratio: 0.9993091210562843
2025-03-13 17:03:24,305 [INFO]: }
2025-03-13 17:03:24,305 [INFO]: 	>>> Finished "Creating the index" in 73.2050 secs
2025-03-13 17:03:24,305 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2540 secs
2025-03-13 17:03:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 58012 [episode count 8/20]
[retrieval_preprocessing] for episode 76460 [episode count 9/20], we have num_retrieval=np.int64(3804) num_query=np.int64(116)
2025-03-13 17:03:25,634 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:26,409 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:26
2025-03-13 17:03:26,409 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.74it/s]
2025-03-13 17:03:26,455 [INFO]: There are 3804 embeddings of dim 49152
2025-03-13 17:03:26,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0460 secs
2025-03-13 17:03:26,455 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:26
2025-03-13 17:03:26,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:26,456 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:03:26,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:26,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:03:26,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:26
2025-03-13 17:03:26,456 [INFO]: 785.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:26,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:03:26,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:26
2025-03-13 17:03:26,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:26,457 [INFO]: 	Creating the index 03/13/2025, 17:03:26
2025-03-13 17:03:26,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:26
2025-03-13 17:03:26,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:03:26,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:26
2025-03-13 17:03:26,461 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:03:26,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.41it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.48it/s] 80%|████████  | 12/15 [00:00<00:00, 39.76it/s]100%|██████████| 15/15 [00:02<00:00,  5.14it/s]
2025-03-13 17:03:30,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:30
2025-03-13 17:04:10,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1996 secs
2025-03-13 17:04:10,210 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:04:10,210 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.59it/s]
2025-03-13 17:04:29,001 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7907 secs
2025-03-13 17:04:29,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5429 secs
2025-03-13 17:04:29,004 [INFO]: {
2025-03-13 17:04:29,004 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:29,004 [INFO]: 	index_param: efSearch=178
2025-03-13 17:04:29,004 [INFO]: 	index_path: knn.index
2025-03-13 17:04:29,004 [INFO]: 	size in bytes: 748413850
2025-03-13 17:04:29,004 [INFO]: 	avg_search_speed_ms: 10.79742472013358
2025-03-13 17:04:29,004 [INFO]: 	99p_search_speed_ms: 17.811554775107652
2025-03-13 17:04:29,004 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:29,004 [INFO]: 	nb vectors: 3804
2025-03-13 17:04:29,004 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:29,004 [INFO]: 	compression ratio: 0.9993091816780248
2025-03-13 17:04:29,004 [INFO]: }
2025-03-13 17:04:29,004 [INFO]: 	>>> Finished "Creating the index" in 62.5465 secs
2025-03-13 17:04:29,004 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5950 secs
2025-03-13 17:04:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 76460 [episode count 9/20]
[retrieval_preprocessing] for episode 15264 [episode count 10/20], we have num_retrieval=np.int64(3806) num_query=np.int64(114)
2025-03-13 17:04:30,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:30,868 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:30
2025-03-13 17:04:30,868 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.72it/s]
2025-03-13 17:04:30,904 [INFO]: There are 3806 embeddings of dim 49152
2025-03-13 17:04:30,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 17:04:30,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:30
2025-03-13 17:04:30,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:30,904 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:04:30,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:30,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:30,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:30
2025-03-13 17:04:30,905 [INFO]: 785.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:30,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:30,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:30
2025-03-13 17:04:30,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:30,905 [INFO]: 	Creating the index 03/13/2025, 17:04:30
2025-03-13 17:04:30,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:30
2025-03-13 17:04:30,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:04:30,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:30
2025-03-13 17:04:30,906 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:04:30,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.59it/s] 40%|████      | 6/15 [00:00<00:00, 28.46it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.25it/s]100%|██████████| 15/15 [00:02<00:00,  3.72it/s]100%|██████████| 15/15 [00:02<00:00,  5.09it/s]
2025-03-13 17:04:33,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:33
2025-03-13 17:05:08,265 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4101 secs
2025-03-13 17:05:08,266 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 17:05:08,266 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.19it/s]
2025-03-13 17:05:46,434 [INFO]: 	>>> Finished "Compute fast metrics" in 38.1684 secs
2025-03-13 17:05:46,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5319 secs
2025-03-13 17:05:46,438 [INFO]: {
2025-03-13 17:05:46,438 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:46,438 [INFO]: 	index_param: efSearch=263
2025-03-13 17:05:46,438 [INFO]: 	index_path: knn.index
2025-03-13 17:05:46,438 [INFO]: 	size in bytes: 748807390
2025-03-13 17:05:46,438 [INFO]: 	avg_search_speed_ms: 16.46872353625153
2025-03-13 17:05:46,438 [INFO]: 	99p_search_speed_ms: 24.55507784383371
2025-03-13 17:05:46,438 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:46,438 [INFO]: 	nb vectors: 3806
2025-03-13 17:05:46,438 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:46,438 [INFO]: 	compression ratio: 0.9993091120535015
2025-03-13 17:05:46,438 [INFO]: }
2025-03-13 17:05:46,438 [INFO]: 	>>> Finished "Creating the index" in 75.5334 secs
2025-03-13 17:05:46,438 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5700 secs
2025-03-13 17:05:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 15264 [episode count 10/20]
[retrieval_preprocessing] for episode 39301 [episode count 11/20], we have num_retrieval=np.int64(3807) num_query=np.int64(113)
2025-03-13 17:05:48,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:48,566 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:48
2025-03-13 17:05:48,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2106.63it/s]
2025-03-13 17:05:48,601 [INFO]: There are 3807 embeddings of dim 49152
2025-03-13 17:05:48,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 17:05:48,601 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:48,602 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:05:48,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:48,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:48,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,602 [INFO]: 785.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:48,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:05:48,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:48
2025-03-13 17:05:48,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:48,602 [INFO]: 	Creating the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,602 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:48
2025-03-13 17:05:48,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:05:48,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:48
2025-03-13 17:05:48,603 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:05:48,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.96it/s] 40%|████      | 6/15 [00:00<00:00, 26.86it/s] 67%|██████▋   | 10/15 [00:00<00:00, 31.18it/s] 93%|█████████▎| 14/15 [00:00<00:00, 32.14it/s]100%|██████████| 15/15 [00:03<00:00,  4.99it/s]
2025-03-13 17:05:51,610 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:51
2025-03-13 17:06:32,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5117 secs
2025-03-13 17:06:32,123 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 17:06:32,123 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.62it/s]
2025-03-13 17:06:59,894 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7716 secs
2025-03-13 17:06:59,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2948 secs
2025-03-13 17:06:59,898 [INFO]: {
2025-03-13 17:06:59,898 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:59,898 [INFO]: 	index_param: efSearch=167
2025-03-13 17:06:59,898 [INFO]: 	index_path: knn.index
2025-03-13 17:06:59,898 [INFO]: 	size in bytes: 749004130
2025-03-13 17:06:59,898 [INFO]: 	avg_search_speed_ms: 11.536391013416848
2025-03-13 17:06:59,898 [INFO]: 	99p_search_speed_ms: 18.939431929029524
2025-03-13 17:06:59,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:59,898 [INFO]: 	nb vectors: 3807
2025-03-13 17:06:59,898 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:59,898 [INFO]: 	compression ratio: 0.9993091172941864
2025-03-13 17:06:59,898 [INFO]: }
2025-03-13 17:06:59,898 [INFO]: 	>>> Finished "Creating the index" in 71.2963 secs
2025-03-13 17:06:59,898 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3319 secs
2025-03-13 17:07:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 39301 [episode count 11/20]
[retrieval_preprocessing] for episode 31968 [episode count 12/20], we have num_retrieval=np.int64(3771) num_query=np.int64(149)
2025-03-13 17:07:01,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:02,952 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:02
2025-03-13 17:07:02,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.54it/s]
2025-03-13 17:07:02,997 [INFO]: There are 3771 embeddings of dim 49152
2025-03-13 17:07:02,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0445 secs
2025-03-13 17:07:02,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:02
2025-03-13 17:07:02,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:02,997 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:07:02,997 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:02,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:07:02,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:02
2025-03-13 17:07:02,997 [INFO]: 778.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:02,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:07:02,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:02
2025-03-13 17:07:02,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:02,997 [INFO]: 	Creating the index 03/13/2025, 17:07:02
2025-03-13 17:07:02,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:02
2025-03-13 17:07:02,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:07:02,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:02
2025-03-13 17:07:02,999 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:07:02,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.98it/s] 33%|███▎      | 5/15 [00:00<00:00, 20.64it/s] 60%|██████    | 9/15 [00:00<00:00, 26.79it/s] 87%|████████▋ | 13/15 [00:00<00:00, 29.89it/s]100%|██████████| 15/15 [00:04<00:00,  3.05it/s]
2025-03-13 17:07:07,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:07
2025-03-13 17:07:45,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5708 secs
2025-03-13 17:07:45,498 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:07:45,498 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 17:08:26,358 [INFO]: 	>>> Finished "Compute fast metrics" in 40.8593 secs
2025-03-13 17:08:26,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3627 secs
2025-03-13 17:08:26,361 [INFO]: {
2025-03-13 17:08:26,361 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:26,362 [INFO]: 	index_param: efSearch=170
2025-03-13 17:08:26,362 [INFO]: 	index_path: knn.index
2025-03-13 17:08:26,362 [INFO]: 	size in bytes: 741921310
2025-03-13 17:08:26,362 [INFO]: 	avg_search_speed_ms: 10.75144977363888
2025-03-13 17:08:26,362 [INFO]: 	99p_search_speed_ms: 22.208950796630237
2025-03-13 17:08:26,362 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:26,362 [INFO]: 	nb vectors: 3771
2025-03-13 17:08:26,362 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:26,362 [INFO]: 	compression ratio: 0.99930916932417
2025-03-13 17:08:26,362 [INFO]: }
2025-03-13 17:08:26,362 [INFO]: 	>>> Finished "Creating the index" in 83.3642 secs
2025-03-13 17:08:26,362 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4093 secs
2025-03-13 17:08:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 31968 [episode count 12/20]
[retrieval_preprocessing] for episode 87356 [episode count 13/20], we have num_retrieval=np.int64(3840) num_query=np.int64(80)
2025-03-13 17:08:28,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:30,367 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:30
2025-03-13 17:08:30,367 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.05it/s]
2025-03-13 17:08:30,396 [INFO]: There are 3840 embeddings of dim 49152
2025-03-13 17:08:30,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:08:30,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:30,396 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:08:30,396 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:30,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:08:30,396 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,397 [INFO]: 792.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:30,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:08:30,397 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:30
2025-03-13 17:08:30,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:30,397 [INFO]: 	Creating the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,397 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:30
2025-03-13 17:08:30,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:08:30,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:30
2025-03-13 17:08:30,399 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:08:30,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.21it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.69it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.27it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.69it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.86it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.02it/s] 50%|█████     | 8/16 [00:00<00:00,  9.76it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.88it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.64it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.63it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.61it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.55it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.56it/s]100%|██████████| 16/16 [00:06<00:00,  1.37s/it]100%|██████████| 16/16 [00:06<00:00,  2.59it/s]
2025-03-13 17:08:36,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:36
2025-03-13 17:09:20,189 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6001 secs
2025-03-13 17:09:20,189 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 17:09:20,189 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 17:09:46,128 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9388 secs
2025-03-13 17:09:46,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9509 secs
2025-03-13 17:09:46,350 [INFO]: {
2025-03-13 17:09:46,350 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:46,350 [INFO]: 	index_param: efSearch=189
2025-03-13 17:09:46,350 [INFO]: 	index_path: knn.index
2025-03-13 17:09:46,350 [INFO]: 	size in bytes: 755496850
2025-03-13 17:09:46,350 [INFO]: 	avg_search_speed_ms: 9.743317018581342
2025-03-13 17:09:46,350 [INFO]: 	99p_search_speed_ms: 17.56233491469175
2025-03-13 17:09:46,351 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:46,351 [INFO]: 	nb vectors: 3840
2025-03-13 17:09:46,351 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:46,351 [INFO]: 	compression ratio: 0.9993088918901515
2025-03-13 17:09:46,351 [INFO]: }
2025-03-13 17:09:46,351 [INFO]: 	>>> Finished "Creating the index" in 75.9536 secs
2025-03-13 17:09:46,351 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9839 secs
2025-03-13 17:09:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 87356 [episode count 13/20]
[retrieval_preprocessing] for episode 17845 [episode count 14/20], we have num_retrieval=np.int64(3776) num_query=np.int64(144)
2025-03-13 17:09:48,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:49,713 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:49
2025-03-13 17:09:49,713 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2141.04it/s]
2025-03-13 17:09:49,740 [INFO]: There are 3776 embeddings of dim 49152
2025-03-13 17:09:49,740 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:09:49,740 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:49
2025-03-13 17:09:49,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:49,740 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:09:49,740 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:49,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:49,740 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:49
2025-03-13 17:09:49,740 [INFO]: 779.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:49,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:09:49,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:49
2025-03-13 17:09:49,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:49,740 [INFO]: 	Creating the index 03/13/2025, 17:09:49
2025-03-13 17:09:49,741 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:49
2025-03-13 17:09:49,742 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:09:49,742 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:49
2025-03-13 17:09:49,742 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:09:49,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.24it/s] 20%|██        | 3/15 [00:00<00:01, 10.31it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.89it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.82it/s] 60%|██████    | 9/15 [00:00<00:00,  9.97it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.20it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.91it/s]100%|██████████| 15/15 [00:04<00:00,  1.63it/s]100%|██████████| 15/15 [00:04<00:00,  3.22it/s]
2025-03-13 17:09:54,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:54
2025-03-13 17:10:30,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9892 secs
2025-03-13 17:10:30,395 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:10:30,395 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 17:11:04,660 [INFO]: 	>>> Finished "Compute fast metrics" in 34.2645 secs
2025-03-13 17:11:05,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8511 secs
2025-03-13 17:11:05,593 [INFO]: {
2025-03-13 17:11:05,593 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:05,593 [INFO]: 	index_param: efSearch=235
2025-03-13 17:11:05,593 [INFO]: 	index_path: knn.index
2025-03-13 17:11:05,594 [INFO]: 	size in bytes: 742905010
2025-03-13 17:11:05,594 [INFO]: 	avg_search_speed_ms: 12.43961422584849
2025-03-13 17:11:05,594 [INFO]: 	99p_search_speed_ms: 24.569469625130296
2025-03-13 17:11:05,594 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:05,594 [INFO]: 	nb vectors: 3776
2025-03-13 17:11:05,594 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:05,594 [INFO]: 	compression ratio: 0.9993091956668861
2025-03-13 17:11:05,594 [INFO]: }
2025-03-13 17:11:05,594 [INFO]: 	>>> Finished "Creating the index" in 75.8535 secs
2025-03-13 17:11:05,594 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8808 secs
2025-03-13 17:11:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 17845 [episode count 14/20]
[retrieval_preprocessing] for episode 84439 [episode count 15/20], we have num_retrieval=np.int64(3795) num_query=np.int64(125)
2025-03-13 17:11:08,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:08,829 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:08
2025-03-13 17:11:08,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.95it/s]
2025-03-13 17:11:08,853 [INFO]: There are 3795 embeddings of dim 49152
2025-03-13 17:11:08,854 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:11:08,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:08,854 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:11:08,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:08,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:11:08,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,855 [INFO]: 783.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:08,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:11:08,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:08
2025-03-13 17:11:08,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:08,855 [INFO]: 	Creating the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,855 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:08
2025-03-13 17:11:08,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:11:08,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:08
2025-03-13 17:11:08,856 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:11:08,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.50it/s] 20%|██        | 3/15 [00:00<00:01,  8.83it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.96it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.32it/s] 60%|██████    | 9/15 [00:00<00:00, 10.49it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.47it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.27it/s]100%|██████████| 15/15 [00:05<00:00,  1.47it/s]100%|██████████| 15/15 [00:05<00:00,  2.94it/s]
2025-03-13 17:11:13,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:13
2025-03-13 17:11:53,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4478 secs
2025-03-13 17:11:53,423 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 17:11:53,423 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 17:12:19,406 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9828 secs
2025-03-13 17:12:19,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5545 secs
2025-03-13 17:12:19,411 [INFO]: {
2025-03-13 17:12:19,411 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:19,411 [INFO]: 	index_param: efSearch=142
2025-03-13 17:12:19,411 [INFO]: 	index_path: knn.index
2025-03-13 17:12:19,411 [INFO]: 	size in bytes: 746643130
2025-03-13 17:12:19,411 [INFO]: 	avg_search_speed_ms: 7.420485796034889
2025-03-13 17:12:19,411 [INFO]: 	99p_search_speed_ms: 11.19755343534052
2025-03-13 17:12:19,411 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:19,411 [INFO]: 	nb vectors: 3795
2025-03-13 17:12:19,411 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:19,411 [INFO]: 	compression ratio: 0.9993092148319908
2025-03-13 17:12:19,411 [INFO]: }
2025-03-13 17:12:19,411 [INFO]: 	>>> Finished "Creating the index" in 70.5560 secs
2025-03-13 17:12:19,411 [INFO]: >>> Finished "Launching the whole pipeline" in 70.5822 secs
2025-03-13 17:12:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 84439 [episode count 15/20]
[retrieval_preprocessing] for episode 29148 [episode count 16/20], we have num_retrieval=np.int64(3662) num_query=np.int64(258)
2025-03-13 17:12:22,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:24,139 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:24
2025-03-13 17:12:24,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 17:12:24,164 [INFO]: There are 3662 embeddings of dim 49152
2025-03-13 17:12:24,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:12:24,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:24,165 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:12:24,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:24,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:24,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,165 [INFO]: 755.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:24,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:24,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:24
2025-03-13 17:12:24,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:24,165 [INFO]: 	Creating the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:24
2025-03-13 17:12:24,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:12:24,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:24
2025-03-13 17:12:24,166 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:12:24,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  3.63it/s] 13%|█▎        | 2/15 [00:00<00:02,  4.60it/s] 20%|██        | 3/15 [00:00<00:02,  5.90it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.86it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.50it/s] 40%|████      | 6/15 [00:00<00:01,  8.11it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.61it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.82it/s] 60%|██████    | 9/15 [00:01<00:00,  8.96it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.84it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.97it/s] 80%|████████  | 12/15 [00:01<00:00,  9.10it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.19it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.25it/s]100%|██████████| 15/15 [00:05<00:00,  1.10s/it]100%|██████████| 15/15 [00:05<00:00,  2.90it/s]
2025-03-13 17:12:29,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:29
2025-03-13 17:13:07,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2958 secs
2025-03-13 17:13:07,634 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:13:07,634 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.56it/s] 50%|█████     | 2/4 [00:00<00:00,  5.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.58it/s]
2025-03-13 17:13:46,013 [INFO]: 	>>> Finished "Compute fast metrics" in 38.3793 secs
2025-03-13 17:13:46,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.8496 secs
2025-03-13 17:13:46,016 [INFO]: {
2025-03-13 17:13:46,016 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:46,016 [INFO]: 	index_param: efSearch=155
2025-03-13 17:13:46,016 [INFO]: 	index_path: knn.index
2025-03-13 17:13:46,016 [INFO]: 	size in bytes: 720476170
2025-03-13 17:13:46,016 [INFO]: 	avg_search_speed_ms: 8.209566834607514
2025-03-13 17:13:46,016 [INFO]: 	99p_search_speed_ms: 15.70594489574432
2025-03-13 17:13:46,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:46,016 [INFO]: 	nb vectors: 3662
2025-03-13 17:13:46,016 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:46,016 [INFO]: 	compression ratio: 0.999309242941373
2025-03-13 17:13:46,016 [INFO]: }
2025-03-13 17:13:46,016 [INFO]: 	>>> Finished "Creating the index" in 81.8511 secs
2025-03-13 17:13:46,016 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8773 secs
2025-03-13 17:13:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 29148 [episode count 16/20]
[retrieval_preprocessing] for episode 52725 [episode count 17/20], we have num_retrieval=np.int64(3768) num_query=np.int64(152)
2025-03-13 17:13:49,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:49,770 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:49
2025-03-13 17:13:49,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.80it/s]
2025-03-13 17:13:49,795 [INFO]: There are 3768 embeddings of dim 49152
2025-03-13 17:13:49,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:13:49,796 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:49
2025-03-13 17:13:49,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:49,796 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:13:49,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:49,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:49,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:49
2025-03-13 17:13:49,796 [INFO]: 777.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:49,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:13:49,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:49
2025-03-13 17:13:49,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:49,796 [INFO]: 	Creating the index 03/13/2025, 17:13:49
2025-03-13 17:13:49,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:49
2025-03-13 17:13:49,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:13:49,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:49
2025-03-13 17:13:49,797 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:13:49,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.43it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.41it/s] 20%|██        | 3/15 [00:00<00:01,  6.81it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.34it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.26it/s] 60%|██████    | 9/15 [00:01<00:00, 10.05it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.08it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.00it/s]100%|██████████| 15/15 [00:04<00:00,  1.85it/s]100%|██████████| 15/15 [00:04<00:00,  3.44it/s]
2025-03-13 17:13:54,162 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:54
2025-03-13 17:14:35,516 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3528 secs
2025-03-13 17:14:35,516 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:14:35,516 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.62it/s] 50%|█████     | 2/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s]
2025-03-13 17:14:57,569 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0533 secs
2025-03-13 17:14:57,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7754 secs
2025-03-13 17:14:57,573 [INFO]: {
2025-03-13 17:14:57,573 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:57,573 [INFO]: 	index_param: efSearch=178
2025-03-13 17:14:57,573 [INFO]: 	index_path: knn.index
2025-03-13 17:14:57,573 [INFO]: 	size in bytes: 741331090
2025-03-13 17:14:57,573 [INFO]: 	avg_search_speed_ms: 9.659909082864578
2025-03-13 17:14:57,573 [INFO]: 	99p_search_speed_ms: 24.217494325712316
2025-03-13 17:14:57,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:57,573 [INFO]: 	nb vectors: 3768
2025-03-13 17:14:57,573 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:57,573 [INFO]: 	compression ratio: 0.9993091534849834
2025-03-13 17:14:57,573 [INFO]: }
2025-03-13 17:14:57,573 [INFO]: 	>>> Finished "Creating the index" in 67.7768 secs
2025-03-13 17:14:57,573 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8027 secs
2025-03-13 17:14:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 52725 [episode count 17/20]
[retrieval_preprocessing] for episode 17854 [episode count 18/20], we have num_retrieval=np.int64(3680) num_query=np.int64(240)
2025-03-13 17:15:00,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:01,550 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:01
2025-03-13 17:15:01,550 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.76it/s]
2025-03-13 17:15:01,581 [INFO]: There are 3680 embeddings of dim 49152
2025-03-13 17:15:01,581 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:15:01,581 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:01,582 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:15:01,582 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:01,582 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:15:01,582 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,582 [INFO]: 759.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:01,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:15:01,583 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:01
2025-03-13 17:15:01,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:01,583 [INFO]: 	Creating the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,583 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:01
2025-03-13 17:15:01,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:15:01,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,587 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:15:01,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  3.86it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.24it/s] 20%|██        | 3/15 [00:00<00:02,  5.92it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.29it/s] 40%|████      | 6/15 [00:00<00:01,  8.51it/s] 53%|█████▎    | 8/15 [00:00<00:00, 10.15it/s] 67%|██████▋   | 10/15 [00:01<00:00, 10.66it/s] 80%|████████  | 12/15 [00:01<00:00, 11.18it/s] 93%|█████████▎| 14/15 [00:01<00:00, 11.93it/s]100%|██████████| 15/15 [00:04<00:00,  3.51it/s]
2025-03-13 17:15:05,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:05
2025-03-13 17:15:38,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2051 secs
2025-03-13 17:15:38,071 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:15:38,071 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s]
2025-03-13 17:16:07,354 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2830 secs
2025-03-13 17:16:07,358 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7711 secs
2025-03-13 17:16:07,358 [INFO]: {
2025-03-13 17:16:07,358 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:07,358 [INFO]: 	index_param: efSearch=201
2025-03-13 17:16:07,358 [INFO]: 	index_path: knn.index
2025-03-13 17:16:07,358 [INFO]: 	size in bytes: 724017490
2025-03-13 17:16:07,358 [INFO]: 	avg_search_speed_ms: 12.559614817049807
2025-03-13 17:16:07,358 [INFO]: 	99p_search_speed_ms: 17.836458906531334
2025-03-13 17:16:07,358 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:07,358 [INFO]: 	nb vectors: 3680
2025-03-13 17:16:07,358 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:07,358 [INFO]: 	compression ratio: 0.9993093398890129
2025-03-13 17:16:07,358 [INFO]: }
2025-03-13 17:16:07,358 [INFO]: 	>>> Finished "Creating the index" in 65.7748 secs
2025-03-13 17:16:07,358 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8081 secs
2025-03-13 17:16:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 17854 [episode count 18/20]
[retrieval_preprocessing] for episode 22483 [episode count 19/20], we have num_retrieval=np.int64(3611) num_query=np.int64(309)
2025-03-13 17:16:11,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:11,929 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:11
2025-03-13 17:16:11,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.87it/s]
2025-03-13 17:16:11,953 [INFO]: There are 3611 embeddings of dim 49152
2025-03-13 17:16:11,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 17:16:11,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:11
2025-03-13 17:16:11,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:11,954 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:16:11,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:11,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:11,954 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:11
2025-03-13 17:16:11,954 [INFO]: 745.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:11,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:11,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:11
2025-03-13 17:16:11,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:11,954 [INFO]: 	Creating the index 03/13/2025, 17:16:11
2025-03-13 17:16:11,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:11
2025-03-13 17:16:11,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:16:11,955 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:11
2025-03-13 17:16:11,955 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:16:11,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:04,  3.48it/s] 13%|█▎        | 2/15 [00:00<00:02,  4.76it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.11it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.80it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.88it/s] 60%|██████    | 9/15 [00:01<00:00,  9.46it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.94it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.19it/s]100%|██████████| 15/15 [00:04<00:00,  1.88it/s]100%|██████████| 15/15 [00:04<00:00,  3.47it/s]
2025-03-13 17:16:16,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:16
2025-03-13 17:16:53,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9866 secs
2025-03-13 17:16:53,272 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:16:53,272 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s]
2025-03-13 17:17:22,980 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7078 secs
2025-03-13 17:17:22,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0291 secs
2025-03-13 17:17:22,984 [INFO]: {
2025-03-13 17:17:22,985 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:22,985 [INFO]: 	index_param: efSearch=168
2025-03-13 17:17:22,985 [INFO]: 	index_path: knn.index
2025-03-13 17:17:22,985 [INFO]: 	size in bytes: 710442070
2025-03-13 17:17:22,985 [INFO]: 	avg_search_speed_ms: 8.076107514245805
2025-03-13 17:17:22,985 [INFO]: 	99p_search_speed_ms: 13.825293891131842
2025-03-13 17:17:22,985 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:22,985 [INFO]: 	nb vectors: 3611
2025-03-13 17:17:22,985 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:22,985 [INFO]: 	compression ratio: 0.999309469384323
2025-03-13 17:17:22,985 [INFO]: }
2025-03-13 17:17:22,985 [INFO]: 	>>> Finished "Creating the index" in 71.0307 secs
2025-03-13 17:17:22,985 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0560 secs
2025-03-13 17:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 22483 [episode count 19/20]
2025-03-13 17:17:25: [retrieval_preprocessing] finished for 5594497977_Close the air fryer [chosen_id count 6/196]
2025-03-13 17:17:28: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5664924394_put_glue_stick_in_mug [chosen_id count 7/196]
2025-03-13 17:17:28: [retrieval_preprocessing] we have num_total=3612 embedding_dim=49152
[retrieval_preprocessing] for episode 54656 [episode count 0/20], we have num_retrieval=np.int64(3332) num_query=np.int64(280)
2025-03-13 17:17:29,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:30,388 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:30
2025-03-13 17:17:30,388 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.40it/s]
2025-03-13 17:17:30,414 [INFO]: There are 3332 embeddings of dim 49152
2025-03-13 17:17:30,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:17:30,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:30
2025-03-13 17:17:30,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:30,415 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:17:30,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:30,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:17:30,415 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:30
2025-03-13 17:17:30,415 [INFO]: 687.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:30,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:17:30,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:30
2025-03-13 17:17:30,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:30,416 [INFO]: 	Creating the index 03/13/2025, 17:17:30
2025-03-13 17:17:30,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:30
2025-03-13 17:17:30,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:17:30,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:30
2025-03-13 17:17:30,418 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:17:30,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.11it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.97it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.77it/s] 57%|█████▋    | 8/14 [00:00<00:00, 14.96it/s] 79%|███████▊  | 11/14 [00:00<00:00, 18.09it/s]100%|██████████| 14/14 [00:03<00:00,  2.33it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-13 17:17:34,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:34
2025-03-13 17:18:08,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9215 secs
2025-03-13 17:18:08,199 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:18:08,199 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.44it/s] 50%|█████     | 2/4 [00:00<00:00,  4.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.33it/s]
2025-03-13 17:18:32,186 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9867 secs
2025-03-13 17:18:32,192 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7739 secs
2025-03-13 17:18:32,192 [INFO]: {
2025-03-13 17:18:32,192 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:32,192 [INFO]: 	index_param: efSearch=218
2025-03-13 17:18:32,192 [INFO]: 	index_path: knn.index
2025-03-13 17:18:32,192 [INFO]: 	size in bytes: 655550770
2025-03-13 17:18:32,192 [INFO]: 	avg_search_speed_ms: 11.684230104182351
2025-03-13 17:18:32,193 [INFO]: 	99p_search_speed_ms: 16.107165056746453
2025-03-13 17:18:32,193 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:32,193 [INFO]: 	nb vectors: 3332
2025-03-13 17:18:32,193 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:32,193 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 17:18:32,193 [INFO]: }
2025-03-13 17:18:32,193 [INFO]: 	>>> Finished "Creating the index" in 61.7767 secs
2025-03-13 17:18:32,193 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8045 secs
2025-03-13 17:18:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 54656 [episode count 0/20]
[retrieval_preprocessing] for episode 54532 [episode count 1/20], we have num_retrieval=np.int64(3438) num_query=np.int64(174)
2025-03-13 17:18:36,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:36,907 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:36
2025-03-13 17:18:36,907 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-13 17:18:36,930 [INFO]: There are 3438 embeddings of dim 49152
2025-03-13 17:18:36,931 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:18:36,931 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:36,931 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:18:36,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:36,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:18:36,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,931 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:36,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:18:36,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:36
2025-03-13 17:18:36,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:36,931 [INFO]: 	Creating the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:36
2025-03-13 17:18:36,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:18:36,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,932 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:18:36,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.88it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.75it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.63it/s] 50%|█████     | 7/14 [00:00<00:00, 10.39it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.58it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.12it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.69it/s]100%|██████████| 14/14 [00:04<00:00,  1.43it/s]100%|██████████| 14/14 [00:04<00:00,  3.09it/s]
2025-03-13 17:18:41,470 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:41
2025-03-13 17:19:20,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0006 secs
2025-03-13 17:19:20,471 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:19:20,471 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 17:19:50,932 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4605 secs
2025-03-13 17:19:50,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0027 secs
2025-03-13 17:19:50,935 [INFO]: {
2025-03-13 17:19:50,935 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:50,935 [INFO]: 	index_param: efSearch=191
2025-03-13 17:19:50,935 [INFO]: 	index_path: knn.index
2025-03-13 17:19:50,935 [INFO]: 	size in bytes: 676405450
2025-03-13 17:19:50,935 [INFO]: 	avg_search_speed_ms: 9.334914125832551
2025-03-13 17:19:50,935 [INFO]: 	99p_search_speed_ms: 15.11947531253099
2025-03-13 17:19:50,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:50,935 [INFO]: 	nb vectors: 3438
2025-03-13 17:19:50,935 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:50,935 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-13 17:19:50,935 [INFO]: }
2025-03-13 17:19:50,935 [INFO]: 	>>> Finished "Creating the index" in 74.0040 secs
2025-03-13 17:19:50,935 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0282 secs
2025-03-13 17:19:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 54532 [episode count 1/20]
[retrieval_preprocessing] for episode 10759 [episode count 2/20], we have num_retrieval=np.int64(3466) num_query=np.int64(146)
2025-03-13 17:19:53,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:54,431 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:54
2025-03-13 17:19:54,431 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1183.49it/s]
2025-03-13 17:19:54,665 [INFO]: There are 3466 embeddings of dim 49152
2025-03-13 17:19:54,666 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2352 secs
2025-03-13 17:19:54,666 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:54
2025-03-13 17:19:54,666 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:54,667 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:19:54,667 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:54,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:19:54,667 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:54
2025-03-13 17:19:54,667 [INFO]: 715.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:54,667 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:19:54,668 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:54
2025-03-13 17:19:54,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:54,668 [INFO]: 	Creating the index 03/13/2025, 17:19:54
2025-03-13 17:19:54,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:54
2025-03-13 17:19:54,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:19:54,671 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:54
2025-03-13 17:19:54,671 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:19:54,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.21it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.52it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.71it/s] 50%|█████     | 7/14 [00:00<00:00, 11.30it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.85it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.93it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.58it/s]100%|██████████| 14/14 [00:03<00:00,  3.53it/s]
2025-03-13 17:19:58,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:58
2025-03-13 17:20:47,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4015 secs
2025-03-13 17:20:47,042 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 17:20:47,042 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.87it/s] 50%|█████     | 2/4 [00:00<00:00,  4.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.59it/s]
2025-03-13 17:21:04,868 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8258 secs
2025-03-13 17:21:04,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1998 secs
2025-03-13 17:21:04,871 [INFO]: {
2025-03-13 17:21:04,871 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:04,871 [INFO]: 	index_param: efSearch=188
2025-03-13 17:21:04,871 [INFO]: 	index_path: knn.index
2025-03-13 17:21:04,871 [INFO]: 	size in bytes: 681914230
2025-03-13 17:21:04,871 [INFO]: 	avg_search_speed_ms: 9.869391221814189
2025-03-13 17:21:04,871 [INFO]: 	99p_search_speed_ms: 17.75001770816743
2025-03-13 17:21:04,871 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:04,871 [INFO]: 	nb vectors: 3466
2025-03-13 17:21:04,871 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:04,871 [INFO]: 	compression ratio: 0.9993094410128383
2025-03-13 17:21:04,871 [INFO]: }
2025-03-13 17:21:04,871 [INFO]: 	>>> Finished "Creating the index" in 70.2034 secs
2025-03-13 17:21:04,871 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4408 secs
2025-03-13 17:21:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 10759 [episode count 2/20]
[retrieval_preprocessing] for episode 4247 [episode count 3/20], we have num_retrieval=np.int64(3329) num_query=np.int64(283)
2025-03-13 17:21:08,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:09,059 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:09
2025-03-13 17:21:09,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.99it/s]
2025-03-13 17:21:09,261 [INFO]: There are 3329 embeddings of dim 49152
2025-03-13 17:21:09,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2023 secs
2025-03-13 17:21:09,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:09
2025-03-13 17:21:09,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:09,262 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:21:09,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:09,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:21:09,263 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:09
2025-03-13 17:21:09,263 [INFO]: 687.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:09,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:21:09,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:09
2025-03-13 17:21:09,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:09,264 [INFO]: 	Creating the index 03/13/2025, 17:21:09
2025-03-13 17:21:09,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:09
2025-03-13 17:21:09,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:21:09,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:09
2025-03-13 17:21:09,268 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:21:09,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.39it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.67it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.78it/s] 50%|█████     | 7/14 [00:00<00:00, 10.37it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.62it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.81it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.81it/s]100%|██████████| 14/14 [00:03<00:00,  3.65it/s]
2025-03-13 17:21:13,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:13
2025-03-13 17:21:58,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6662 secs
2025-03-13 17:21:58,774 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:21:58,774 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 17:22:24,310 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5359 secs
2025-03-13 17:22:24,313 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0449 secs
2025-03-13 17:22:24,313 [INFO]: {
2025-03-13 17:22:24,313 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:24,313 [INFO]: 	index_param: efSearch=212
2025-03-13 17:22:24,313 [INFO]: 	index_path: knn.index
2025-03-13 17:22:24,313 [INFO]: 	size in bytes: 654960550
2025-03-13 17:22:24,313 [INFO]: 	avg_search_speed_ms: 10.200866710926805
2025-03-13 17:22:24,313 [INFO]: 	99p_search_speed_ms: 14.337229651864623
2025-03-13 17:22:24,313 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:24,313 [INFO]: 	nb vectors: 3329
2025-03-13 17:22:24,313 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:24,313 [INFO]: 	compression ratio: 0.9993090912116768
2025-03-13 17:22:24,313 [INFO]: }
2025-03-13 17:22:24,313 [INFO]: 	>>> Finished "Creating the index" in 75.0487 secs
2025-03-13 17:22:24,313 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2537 secs
2025-03-13 17:22:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 4247 [episode count 3/20]
[retrieval_preprocessing] for episode 59258 [episode count 4/20], we have num_retrieval=np.int64(3485) num_query=np.int64(127)
2025-03-13 17:22:29,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:30,338 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:30
2025-03-13 17:22:30,338 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1073.81it/s]
2025-03-13 17:22:30,707 [INFO]: There are 3485 embeddings of dim 49152
2025-03-13 17:22:30,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3691 secs
2025-03-13 17:22:30,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:30
2025-03-13 17:22:30,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:30,707 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:22:30,708 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:30,708 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:22:30,708 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:30
2025-03-13 17:22:30,708 [INFO]: 719.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:30,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:22:30,708 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:30
2025-03-13 17:22:30,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:30,708 [INFO]: 	Creating the index 03/13/2025, 17:22:30
2025-03-13 17:22:30,708 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:30
2025-03-13 17:22:30,710 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:22:30,710 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:30
2025-03-13 17:22:30,711 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:22:30,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.36it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.10it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.60it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.84it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.04it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.40it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.45it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.49it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.44it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.53it/s]100%|██████████| 14/14 [00:04<00:00,  1.52it/s]100%|██████████| 14/14 [00:04<00:00,  3.49it/s]
2025-03-13 17:22:34,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:34
2025-03-13 17:23:20,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3783 secs
2025-03-13 17:23:20,109 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:23:20,109 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 17:23:42,728 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6185 secs
2025-03-13 17:23:42,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0502 secs
2025-03-13 17:23:42,761 [INFO]: {
2025-03-13 17:23:42,761 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:42,761 [INFO]: 	index_param: efSearch=199
2025-03-13 17:23:42,761 [INFO]: 	index_path: knn.index
2025-03-13 17:23:42,761 [INFO]: 	size in bytes: 685652350
2025-03-13 17:23:42,761 [INFO]: 	avg_search_speed_ms: 9.107241828167618
2025-03-13 17:23:42,761 [INFO]: 	99p_search_speed_ms: 14.35113022336736
2025-03-13 17:23:42,761 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:42,761 [INFO]: 	nb vectors: 3485
2025-03-13 17:23:42,761 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:42,761 [INFO]: 	compression ratio: 0.999309460545129
2025-03-13 17:23:42,761 [INFO]: }
2025-03-13 17:23:42,761 [INFO]: 	>>> Finished "Creating the index" in 72.0528 secs
2025-03-13 17:23:42,761 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4233 secs
2025-03-13 17:23:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 59258 [episode count 4/20]
[retrieval_preprocessing] for episode 55839 [episode count 5/20], we have num_retrieval=np.int64(3477) num_query=np.int64(135)
2025-03-13 17:23:44,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:45,360 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:45
2025-03-13 17:23:45,360 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.99it/s]
2025-03-13 17:23:45,384 [INFO]: There are 3477 embeddings of dim 49152
2025-03-13 17:23:45,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 17:23:45,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:45
2025-03-13 17:23:45,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:45,384 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:23:45,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:45,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:23:45,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:45
2025-03-13 17:23:45,385 [INFO]: 717.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:45,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:23:45,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:45
2025-03-13 17:23:45,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:45,385 [INFO]: 	Creating the index 03/13/2025, 17:23:45
2025-03-13 17:23:45,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:45
2025-03-13 17:23:45,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:23:45,386 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:45
2025-03-13 17:23:45,386 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:23:45,386 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.09it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.66it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.71it/s] 50%|█████     | 7/14 [00:00<00:00, 11.21it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.58it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.67it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.04it/s]100%|██████████| 14/14 [00:03<00:00,  3.77it/s]
2025-03-13 17:23:49,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:49
2025-03-13 17:24:22,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7831 secs
2025-03-13 17:24:22,896 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 17:24:22,896 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-13 17:24:52,691 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7959 secs
2025-03-13 17:24:52,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3079 secs
2025-03-13 17:24:52,694 [INFO]: {
2025-03-13 17:24:52,694 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:52,694 [INFO]: 	index_param: efSearch=147
2025-03-13 17:24:52,694 [INFO]: 	index_path: knn.index
2025-03-13 17:24:52,694 [INFO]: 	size in bytes: 684078430
2025-03-13 17:24:52,694 [INFO]: 	avg_search_speed_ms: 7.659628936464245
2025-03-13 17:24:52,694 [INFO]: 	99p_search_speed_ms: 9.83834502287209
2025-03-13 17:24:52,694 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:52,694 [INFO]: 	nb vectors: 3477
2025-03-13 17:24:52,694 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:52,694 [INFO]: 	compression ratio: 0.99930941544232
2025-03-13 17:24:52,694 [INFO]: }
2025-03-13 17:24:52,694 [INFO]: 	>>> Finished "Creating the index" in 67.3094 secs
2025-03-13 17:24:52,694 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3344 secs
2025-03-13 17:24:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 55839 [episode count 5/20]
[retrieval_preprocessing] for episode 86561 [episode count 6/20], we have num_retrieval=np.int64(3388) num_query=np.int64(224)
2025-03-13 17:24:54,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:55,261 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:55
2025-03-13 17:24:55,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1909.97it/s]
2025-03-13 17:24:55,280 [INFO]: There are 3388 embeddings of dim 49152
2025-03-13 17:24:55,281 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0197 secs
2025-03-13 17:24:55,281 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:55
2025-03-13 17:24:55,281 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:55,281 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:24:55,281 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:55,281 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:55,281 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:55
2025-03-13 17:24:55,281 [INFO]: 699.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:55,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:24:55,281 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:55
2025-03-13 17:24:55,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:55,281 [INFO]: 	Creating the index 03/13/2025, 17:24:55
2025-03-13 17:24:55,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:55
2025-03-13 17:24:55,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:24:55,282 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:55
2025-03-13 17:24:55,282 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:24:55,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.39it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.29it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.09it/s] 50%|█████     | 7/14 [00:00<00:00, 11.46it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.15it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.26it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.48it/s]100%|██████████| 14/14 [00:04<00:00,  3.45it/s]
2025-03-13 17:24:59,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:59
2025-03-13 17:25:43,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8376 secs
2025-03-13 17:25:43,179 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:25:43,179 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 17:26:06,677 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4976 secs
2025-03-13 17:26:06,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3983 secs
2025-03-13 17:26:06,681 [INFO]: {
2025-03-13 17:26:06,681 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:06,681 [INFO]: 	index_param: efSearch=178
2025-03-13 17:26:06,681 [INFO]: 	index_path: knn.index
2025-03-13 17:26:06,681 [INFO]: 	size in bytes: 666568270
2025-03-13 17:26:06,681 [INFO]: 	avg_search_speed_ms: 10.322674499801577
2025-03-13 17:26:06,681 [INFO]: 	99p_search_speed_ms: 14.320182278752323
2025-03-13 17:26:06,681 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:06,681 [INFO]: 	nb vectors: 3388
2025-03-13 17:26:06,681 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:06,681 [INFO]: 	compression ratio: 0.999309349063375
2025-03-13 17:26:06,681 [INFO]: }
2025-03-13 17:26:06,681 [INFO]: 	>>> Finished "Creating the index" in 71.4004 secs
2025-03-13 17:26:06,681 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4207 secs
2025-03-13 17:26:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 86561 [episode count 6/20]
[retrieval_preprocessing] for episode 79271 [episode count 7/20], we have num_retrieval=np.int64(3486) num_query=np.int64(126)
2025-03-13 17:26:10,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:11,509 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:11
2025-03-13 17:26:11,509 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 17:26:11,540 [INFO]: There are 3486 embeddings of dim 49152
2025-03-13 17:26:11,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 17:26:11,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:11,541 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:26:11,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:11,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:26:11,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,542 [INFO]: 719.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:11,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:26:11,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:11
2025-03-13 17:26:11,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:11,543 [INFO]: 	Creating the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:11
2025-03-13 17:26:11,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:26:11,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,546 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:26:11,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.59it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.32it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.26it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.23it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.26it/s] 50%|█████     | 7/14 [00:00<00:00,  7.42it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.56it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.70it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.96it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.09it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.20it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.30it/s]100%|██████████| 14/14 [00:04<00:00,  1.01s/it]100%|██████████| 14/14 [00:04<00:00,  2.93it/s]
2025-03-13 17:26:16,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:16
2025-03-13 17:26:59,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1564 secs
2025-03-13 17:26:59,486 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:26:59,486 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.30it/s] 50%|█████     | 2/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 17:27:27,392 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9052 secs
2025-03-13 17:27:27,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8479 secs
2025-03-13 17:27:27,395 [INFO]: {
2025-03-13 17:27:27,395 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:27,395 [INFO]: 	index_param: efSearch=213
2025-03-13 17:27:27,395 [INFO]: 	index_path: knn.index
2025-03-13 17:27:27,395 [INFO]: 	size in bytes: 685849090
2025-03-13 17:27:27,395 [INFO]: 	avg_search_speed_ms: 10.685240888408918
2025-03-13 17:27:27,395 [INFO]: 	99p_search_speed_ms: 15.295570448506622
2025-03-13 17:27:27,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:27,395 [INFO]: 	nb vectors: 3486
2025-03-13 17:27:27,395 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:27,395 [INFO]: 	compression ratio: 0.9993094661684249
2025-03-13 17:27:27,395 [INFO]: }
2025-03-13 17:27:27,395 [INFO]: 	>>> Finished "Creating the index" in 75.8519 secs
2025-03-13 17:27:27,395 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8860 secs
2025-03-13 17:27:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 79271 [episode count 7/20]
[retrieval_preprocessing] for episode 51240 [episode count 8/20], we have num_retrieval=np.int64(3443) num_query=np.int64(169)
2025-03-13 17:27:29,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:30,728 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:30
2025-03-13 17:27:30,728 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2457.12it/s]
2025-03-13 17:27:30,749 [INFO]: There are 3443 embeddings of dim 49152
2025-03-13 17:27:30,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0207 secs
2025-03-13 17:27:30,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:30
2025-03-13 17:27:30,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:30,749 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:27:30,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:30,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:30,749 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:30
2025-03-13 17:27:30,750 [INFO]: 710.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:30,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:30,750 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:30
2025-03-13 17:27:30,750 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:30,750 [INFO]: 	Creating the index 03/13/2025, 17:27:30
2025-03-13 17:27:30,750 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:30
2025-03-13 17:27:30,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:27:30,751 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:30
2025-03-13 17:27:30,751 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:27:30,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.96it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.65it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.88it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.02it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.12it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.12it/s] 50%|█████     | 7/14 [00:01<00:00,  7.25it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.25it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.25it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.29it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.29it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.38it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.33it/s]100%|██████████| 14/14 [00:04<00:00,  1.02s/it]100%|██████████| 14/14 [00:04<00:00,  2.86it/s]
2025-03-13 17:27:35,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:35
2025-03-13 17:28:20,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6889 secs
2025-03-13 17:28:20,336 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 17:28:20,336 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 17:28:58,906 [INFO]: 	>>> Finished "Compute fast metrics" in 38.5704 secs
2025-03-13 17:28:58,909 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1577 secs
2025-03-13 17:28:58,909 [INFO]: {
2025-03-13 17:28:58,909 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:58,909 [INFO]: 	index_param: efSearch=208
2025-03-13 17:28:58,909 [INFO]: 	index_path: knn.index
2025-03-13 17:28:58,909 [INFO]: 	size in bytes: 677389210
2025-03-13 17:28:58,909 [INFO]: 	avg_search_speed_ms: 9.193316163659533
2025-03-13 17:28:58,909 [INFO]: 	99p_search_speed_ms: 12.825282195117323
2025-03-13 17:28:58,909 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:58,909 [INFO]: 	nb vectors: 3443
2025-03-13 17:28:58,909 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:58,909 [INFO]: 	compression ratio: 0.9993093099312875
2025-03-13 17:28:58,909 [INFO]: }
2025-03-13 17:28:58,909 [INFO]: 	>>> Finished "Creating the index" in 88.1595 secs
2025-03-13 17:28:58,909 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1810 secs
2025-03-13 17:29:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 51240 [episode count 8/20]
[retrieval_preprocessing] for episode 45867 [episode count 9/20], we have num_retrieval=np.int64(3438) num_query=np.int64(174)
2025-03-13 17:29:05,744 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:06,227 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:06
2025-03-13 17:29:06,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1686.49it/s]
2025-03-13 17:29:06,250 [INFO]: There are 3438 embeddings of dim 49152
2025-03-13 17:29:06,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:29:06,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:06
2025-03-13 17:29:06,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:06,250 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:29:06,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:06,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:06,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:06
2025-03-13 17:29:06,250 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:06,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:29:06,250 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:06
2025-03-13 17:29:06,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:06,251 [INFO]: 	Creating the index 03/13/2025, 17:29:06
2025-03-13 17:29:06,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:06
2025-03-13 17:29:06,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:29:06,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:06
2025-03-13 17:29:06,252 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:29:06,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.83it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.48it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.95it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.22it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.34it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.48it/s] 50%|█████     | 7/14 [00:00<00:00,  8.49it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.82it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.74it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.73it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.67it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.58it/s]100%|██████████| 14/14 [00:04<00:00,  1.15it/s]100%|██████████| 14/14 [00:04<00:00,  3.27it/s]
2025-03-13 17:29:10,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:10
2025-03-13 17:29:59,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9542 secs
2025-03-13 17:29:59,489 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:29:59,489 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 17:30:22,065 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5758 secs
2025-03-13 17:30:22,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8161 secs
2025-03-13 17:30:22,068 [INFO]: {
2025-03-13 17:30:22,068 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:22,068 [INFO]: 	index_param: efSearch=168
2025-03-13 17:30:22,068 [INFO]: 	index_path: knn.index
2025-03-13 17:30:22,068 [INFO]: 	size in bytes: 676405450
2025-03-13 17:30:22,068 [INFO]: 	avg_search_speed_ms: 9.383539186954835
2025-03-13 17:30:22,068 [INFO]: 	99p_search_speed_ms: 13.730436679907136
2025-03-13 17:30:22,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:22,068 [INFO]: 	nb vectors: 3438
2025-03-13 17:30:22,068 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:22,068 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-13 17:30:22,068 [INFO]: }
2025-03-13 17:30:22,068 [INFO]: 	>>> Finished "Creating the index" in 75.8178 secs
2025-03-13 17:30:22,068 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8417 secs
2025-03-13 17:30:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 45867 [episode count 9/20]
[retrieval_preprocessing] for episode 52524 [episode count 10/20], we have num_retrieval=np.int64(3435) num_query=np.int64(177)
2025-03-13 17:30:24,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:24,854 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:24
2025-03-13 17:30:24,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.18it/s]
2025-03-13 17:30:24,875 [INFO]: There are 3435 embeddings of dim 49152
2025-03-13 17:30:24,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0214 secs
2025-03-13 17:30:24,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:24,876 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:30:24,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:24,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:24,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,876 [INFO]: 708.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:24,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:24,876 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:24
2025-03-13 17:30:24,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:24,876 [INFO]: 	Creating the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,876 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:24
2025-03-13 17:30:24,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:30:24,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:24
2025-03-13 17:30:24,877 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:30:24,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.64it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.22it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.92it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.28it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.44it/s] 50%|█████     | 7/14 [00:00<00:00,  8.88it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.73it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.99it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.49it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.18it/s]100%|██████████| 14/14 [00:04<00:00,  1.20it/s]100%|██████████| 14/14 [00:04<00:00,  3.09it/s]
2025-03-13 17:30:29,406 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:29
2025-03-13 17:31:15,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5873 secs
2025-03-13 17:31:15,994 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 17:31:15,994 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 17:31:37,852 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8579 secs
2025-03-13 17:31:37,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9777 secs
2025-03-13 17:31:37,855 [INFO]: {
2025-03-13 17:31:37,855 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:37,855 [INFO]: 	index_param: efSearch=204
2025-03-13 17:31:37,855 [INFO]: 	index_path: knn.index
2025-03-13 17:31:37,855 [INFO]: 	size in bytes: 675815170
2025-03-13 17:31:37,855 [INFO]: 	avg_search_speed_ms: 10.822592665757822
2025-03-13 17:31:37,855 [INFO]: 	99p_search_speed_ms: 18.555571618489918
2025-03-13 17:31:37,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:37,855 [INFO]: 	nb vectors: 3435
2025-03-13 17:31:37,855 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:37,855 [INFO]: 	compression ratio: 0.9993094413669347
2025-03-13 17:31:37,855 [INFO]: }
2025-03-13 17:31:37,855 [INFO]: 	>>> Finished "Creating the index" in 72.9792 secs
2025-03-13 17:31:37,855 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0012 secs
2025-03-13 17:31:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 52524 [episode count 10/20]
[retrieval_preprocessing] for episode 85181 [episode count 11/20], we have num_retrieval=np.int64(3462) num_query=np.int64(150)
2025-03-13 17:31:40,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:41,240 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:41
2025-03-13 17:31:41,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1011.65it/s]
2025-03-13 17:31:41,265 [INFO]: There are 3462 embeddings of dim 49152
2025-03-13 17:31:41,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:31:41,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:41,266 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:31:41,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:41,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:41,266 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,266 [INFO]: 714.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:41,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:41,266 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:41
2025-03-13 17:31:41,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:41,266 [INFO]: 	Creating the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:41
2025-03-13 17:31:41,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:31:41,267 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,267 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:31:41,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.37it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.84it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.88it/s] 50%|█████     | 7/14 [00:00<00:00, 11.22it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.84it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.22it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.44it/s]100%|██████████| 14/14 [00:04<00:00,  3.50it/s]
2025-03-13 17:31:45,275 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:45
2025-03-13 17:32:31,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1606 secs
2025-03-13 17:32:31,437 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:32:31,437 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 17:32:52,162 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7250 secs
2025-03-13 17:32:52,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8975 secs
2025-03-13 17:32:52,165 [INFO]: {
2025-03-13 17:32:52,165 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:52,165 [INFO]: 	index_param: efSearch=199
2025-03-13 17:32:52,165 [INFO]: 	index_path: knn.index
2025-03-13 17:32:52,165 [INFO]: 	size in bytes: 681127270
2025-03-13 17:32:52,165 [INFO]: 	avg_search_speed_ms: 10.916826283959795
2025-03-13 17:32:52,165 [INFO]: 	99p_search_speed_ms: 17.249599506612878
2025-03-13 17:32:52,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:52,165 [INFO]: 	nb vectors: 3462
2025-03-13 17:32:52,165 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:52,165 [INFO]: 	compression ratio: 0.9993094183411567
2025-03-13 17:32:52,165 [INFO]: }
2025-03-13 17:32:52,165 [INFO]: 	>>> Finished "Creating the index" in 70.8991 secs
2025-03-13 17:32:52,165 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9253 secs
2025-03-13 17:32:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 85181 [episode count 11/20]
[retrieval_preprocessing] for episode 90052 [episode count 12/20], we have num_retrieval=np.int64(3457) num_query=np.int64(155)
2025-03-13 17:32:54,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:55,139 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:55
2025-03-13 17:32:55,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1414.13it/s]
2025-03-13 17:32:55,162 [INFO]: There are 3457 embeddings of dim 49152
2025-03-13 17:32:55,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 17:32:55,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:55
2025-03-13 17:32:55,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:55,162 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:32:55,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:55,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:55,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:55
2025-03-13 17:32:55,162 [INFO]: 713.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:55,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:55,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:55
2025-03-13 17:32:55,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:55,163 [INFO]: 	Creating the index 03/13/2025, 17:32:55
2025-03-13 17:32:55,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:55
2025-03-13 17:32:55,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:32:55,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:55
2025-03-13 17:32:55,164 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:32:55,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.39it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.14it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.75it/s] 50%|█████     | 7/14 [00:00<00:00, 10.74it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.77it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.73it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.65it/s]100%|██████████| 14/14 [00:04<00:00,  3.41it/s]
2025-03-13 17:32:59,271 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:59
2025-03-13 17:33:38,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5970 secs
2025-03-13 17:33:38,868 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 17:33:38,868 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 17:34:15,057 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1887 secs
2025-03-13 17:34:15,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8962 secs
2025-03-13 17:34:15,061 [INFO]: {
2025-03-13 17:34:15,061 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:15,061 [INFO]: 	index_param: efSearch=239
2025-03-13 17:34:15,061 [INFO]: 	index_path: knn.index
2025-03-13 17:34:15,061 [INFO]: 	size in bytes: 680143570
2025-03-13 17:34:15,061 [INFO]: 	avg_search_speed_ms: 12.061681041875518
2025-03-13 17:34:15,061 [INFO]: 	99p_search_speed_ms: 20.278593387920413
2025-03-13 17:34:15,061 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:15,061 [INFO]: 	nb vectors: 3457
2025-03-13 17:34:15,061 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:15,061 [INFO]: 	compression ratio: 0.9993093899277766
2025-03-13 17:34:15,061 [INFO]: }
2025-03-13 17:34:15,061 [INFO]: 	>>> Finished "Creating the index" in 79.8984 secs
2025-03-13 17:34:15,061 [INFO]: >>> Finished "Launching the whole pipeline" in 79.9223 secs
2025-03-13 17:34:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 90052 [episode count 12/20]
[retrieval_preprocessing] for episode 42697 [episode count 13/20], we have num_retrieval=np.int64(3410) num_query=np.int64(202)
2025-03-13 17:34:18,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:20,113 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:20
2025-03-13 17:34:20,113 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1250.17it/s]
2025-03-13 17:34:20,143 [INFO]: There are 3410 embeddings of dim 49152
2025-03-13 17:34:20,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 17:34:20,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:20
2025-03-13 17:34:20,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:20,145 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:34:20,145 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:20,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:34:20,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:20
2025-03-13 17:34:20,145 [INFO]: 703.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:20,146 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:34:20,146 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:20
2025-03-13 17:34:20,146 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:20,146 [INFO]: 	Creating the index 03/13/2025, 17:34:20
2025-03-13 17:34:20,146 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:20
2025-03-13 17:34:20,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:34:20,149 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:20
2025-03-13 17:34:20,149 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:34:20,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.36it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.30it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.44it/s] 50%|█████     | 7/14 [00:00<00:00, 10.09it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.52it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.62it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.73it/s]100%|██████████| 14/14 [00:04<00:00,  2.93it/s]
2025-03-13 17:34:24,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:24
2025-03-13 17:35:21,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7575 secs
2025-03-13 17:35:21,689 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 17:35:21,689 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.91it/s]
2025-03-13 17:35:51,150 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4610 secs
2025-03-13 17:35:51,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.0043 secs
2025-03-13 17:35:51,153 [INFO]: {
2025-03-13 17:35:51,153 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:51,153 [INFO]: 	index_param: efSearch=140
2025-03-13 17:35:51,153 [INFO]: 	index_path: knn.index
2025-03-13 17:35:51,153 [INFO]: 	size in bytes: 670896670
2025-03-13 17:35:51,153 [INFO]: 	avg_search_speed_ms: 8.788527822431327
2025-03-13 17:35:51,153 [INFO]: 	99p_search_speed_ms: 12.32583730947226
2025-03-13 17:35:51,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:51,153 [INFO]: 	nb vectors: 3410
2025-03-13 17:35:51,153 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:51,153 [INFO]: 	compression ratio: 0.9993092975107478
2025-03-13 17:35:51,153 [INFO]: }
2025-03-13 17:35:51,153 [INFO]: 	>>> Finished "Creating the index" in 91.0071 secs
2025-03-13 17:35:51,153 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0404 secs
2025-03-13 17:35:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 42697 [episode count 13/20]
[retrieval_preprocessing] for episode 20811 [episode count 14/20], we have num_retrieval=np.int64(3425) num_query=np.int64(187)
2025-03-13 17:35:54,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:54,578 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:54
2025-03-13 17:35:54,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-13 17:35:54,601 [INFO]: There are 3425 embeddings of dim 49152
2025-03-13 17:35:54,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 17:35:54,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:54
2025-03-13 17:35:54,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:54,602 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:35:54,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:54,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:35:54,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:54
2025-03-13 17:35:54,602 [INFO]: 706.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:54,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:35:54,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:54
2025-03-13 17:35:54,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:54,602 [INFO]: 	Creating the index 03/13/2025, 17:35:54
2025-03-13 17:35:54,602 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:54
2025-03-13 17:35:54,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:35:54,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:54
2025-03-13 17:35:54,603 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:35:54,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.83it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.74it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.35it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.68it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.96it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.03it/s] 50%|█████     | 7/14 [00:00<00:00,  8.06it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.01it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.65it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.60it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.46it/s]100%|██████████| 14/14 [00:04<00:00,  1.37it/s]100%|██████████| 14/14 [00:04<00:00,  2.90it/s]
2025-03-13 17:35:59,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:59
2025-03-13 17:36:49,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2106 secs
2025-03-13 17:36:49,645 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:36:49,645 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.98it/s]
2025-03-13 17:37:10,986 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3411 secs
2025-03-13 17:37:10,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3851 secs
2025-03-13 17:37:10,989 [INFO]: {
2025-03-13 17:37:10,989 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:10,989 [INFO]: 	index_param: efSearch=185
2025-03-13 17:37:10,989 [INFO]: 	index_path: knn.index
2025-03-13 17:37:10,989 [INFO]: 	size in bytes: 673847770
2025-03-13 17:37:10,989 [INFO]: 	avg_search_speed_ms: 10.068608093622244
2025-03-13 17:37:10,989 [INFO]: 	99p_search_speed_ms: 14.792127953842284
2025-03-13 17:37:10,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:10,989 [INFO]: 	nb vectors: 3425
2025-03-13 17:37:10,989 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:10,989 [INFO]: 	compression ratio: 0.9993093840764659
2025-03-13 17:37:10,989 [INFO]: }
2025-03-13 17:37:10,989 [INFO]: 	>>> Finished "Creating the index" in 76.3867 secs
2025-03-13 17:37:10,989 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4109 secs
2025-03-13 17:37:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 20811 [episode count 14/20]
[retrieval_preprocessing] for episode 20431 [episode count 15/20], we have num_retrieval=np.int64(3338) num_query=np.int64(274)
2025-03-13 17:37:14,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:15,404 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:15
2025-03-13 17:37:15,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.09it/s]
2025-03-13 17:37:15,432 [INFO]: There are 3338 embeddings of dim 49152
2025-03-13 17:37:15,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:37:15,433 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:15,433 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:37:15,433 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:15,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:37:15,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,434 [INFO]: 688.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:15,434 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:37:15,434 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:15
2025-03-13 17:37:15,434 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:15,434 [INFO]: 	Creating the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,435 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:15
2025-03-13 17:37:15,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:37:15,438 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,438 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:37:15,438 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.06it/s] 36%|███▌      | 5/14 [00:00<00:00, 22.02it/s] 64%|██████▍   | 9/14 [00:00<00:00, 27.56it/s] 93%|█████████▎| 13/14 [00:00<00:00, 30.05it/s]100%|██████████| 14/14 [00:03<00:00,  4.36it/s]
2025-03-13 17:37:18,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:18
2025-03-13 17:38:06,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2217 secs
2025-03-13 17:38:06,036 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:38:06,036 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 17:38:43,579 [INFO]: 	>>> Finished "Compute fast metrics" in 37.5427 secs
2025-03-13 17:38:43,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1431 secs
2025-03-13 17:38:43,581 [INFO]: {
2025-03-13 17:38:43,581 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:43,581 [INFO]: 	index_param: efSearch=197
2025-03-13 17:38:43,581 [INFO]: 	index_path: knn.index
2025-03-13 17:38:43,581 [INFO]: 	size in bytes: 656731210
2025-03-13 17:38:43,581 [INFO]: 	avg_search_speed_ms: 9.98844114014996
2025-03-13 17:38:43,581 [INFO]: 	99p_search_speed_ms: 14.954733196645975
2025-03-13 17:38:43,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:43,581 [INFO]: 	nb vectors: 3338
2025-03-13 17:38:43,581 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:43,581 [INFO]: 	compression ratio: 0.9993091450610364
2025-03-13 17:38:43,581 [INFO]: }
2025-03-13 17:38:43,581 [INFO]: 	>>> Finished "Creating the index" in 88.1469 secs
2025-03-13 17:38:43,581 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1770 secs
2025-03-13 17:38:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20431 [episode count 15/20]
[retrieval_preprocessing] for episode 82895 [episode count 16/20], we have num_retrieval=np.int64(3475) num_query=np.int64(137)
2025-03-13 17:38:47,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:48,513 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:48
2025-03-13 17:38:48,513 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.84it/s]
2025-03-13 17:38:48,541 [INFO]: There are 3475 embeddings of dim 49152
2025-03-13 17:38:48,541 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 17:38:48,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:48
2025-03-13 17:38:48,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:48,542 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:38:48,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:48,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:38:48,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:48
2025-03-13 17:38:48,543 [INFO]: 717.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:48,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:38:48,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:48
2025-03-13 17:38:48,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:48,544 [INFO]: 	Creating the index 03/13/2025, 17:38:48
2025-03-13 17:38:48,544 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:48
2025-03-13 17:38:48,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:38:48,545 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:48
2025-03-13 17:38:48,546 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:38:48,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.64it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.58it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.57it/s] 50%|█████     | 7/14 [00:00<00:00, 12.94it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.27it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.37it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.44it/s]100%|██████████| 14/14 [00:04<00:00,  3.15it/s]
2025-03-13 17:38:52,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:52
2025-03-13 17:39:37,110 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1103 secs
2025-03-13 17:39:37,110 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:39:37,110 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 17:40:08,292 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1819 secs
2025-03-13 17:40:08,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.7496 secs
2025-03-13 17:40:08,295 [INFO]: {
2025-03-13 17:40:08,295 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:08,295 [INFO]: 	index_param: efSearch=198
2025-03-13 17:40:08,295 [INFO]: 	index_path: knn.index
2025-03-13 17:40:08,295 [INFO]: 	size in bytes: 683684950
2025-03-13 17:40:08,295 [INFO]: 	avg_search_speed_ms: 12.47144558587741
2025-03-13 17:40:08,295 [INFO]: 	99p_search_speed_ms: 21.981086712330583
2025-03-13 17:40:08,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:08,295 [INFO]: 	nb vectors: 3475
2025-03-13 17:40:08,295 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:08,295 [INFO]: 	compression ratio: 0.9993094041341702
2025-03-13 17:40:08,295 [INFO]: }
2025-03-13 17:40:08,295 [INFO]: 	>>> Finished "Creating the index" in 79.7516 secs
2025-03-13 17:40:08,295 [INFO]: >>> Finished "Launching the whole pipeline" in 79.7823 secs
2025-03-13 17:40:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 82895 [episode count 16/20]
[retrieval_preprocessing] for episode 44129 [episode count 17/20], we have num_retrieval=np.int64(3470) num_query=np.int64(142)
2025-03-13 17:40:11,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:11,600 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:11
2025-03-13 17:40:11,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1049.63it/s]
2025-03-13 17:40:11,627 [INFO]: There are 3470 embeddings of dim 49152
2025-03-13 17:40:11,627 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:40:11,627 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:11
2025-03-13 17:40:11,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:11,627 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:40:11,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:11,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:11,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:11
2025-03-13 17:40:11,628 [INFO]: 716.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:11,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:11,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:11
2025-03-13 17:40:11,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:11,628 [INFO]: 	Creating the index 03/13/2025, 17:40:11
2025-03-13 17:40:11,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:11
2025-03-13 17:40:11,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:40:11,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:11
2025-03-13 17:40:11,629 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:40:11,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.90it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.53it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.61it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.68it/s] 50%|█████     | 7/14 [00:00<00:00,  9.72it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.39it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.98it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.81it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.65it/s]100%|██████████| 14/14 [00:04<00:00,  1.20it/s]100%|██████████| 14/14 [00:04<00:00,  3.22it/s]
2025-03-13 17:40:15,978 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:15
2025-03-13 17:41:07,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7622 secs
2025-03-13 17:41:07,742 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:41:07,742 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.48it/s] 50%|█████     | 2/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 17:41:29,667 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9249 secs
2025-03-13 17:41:30,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.6304 secs
2025-03-13 17:41:30,260 [INFO]: {
2025-03-13 17:41:30,260 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:30,260 [INFO]: 	index_param: efSearch=171
2025-03-13 17:41:30,260 [INFO]: 	index_path: knn.index
2025-03-13 17:41:30,260 [INFO]: 	size in bytes: 682701190
2025-03-13 17:41:30,261 [INFO]: 	avg_search_speed_ms: 10.375799567494695
2025-03-13 17:41:30,261 [INFO]: 	99p_search_speed_ms: 15.032923989929259
2025-03-13 17:41:30,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:30,261 [INFO]: 	nb vectors: 3470
2025-03-13 17:41:30,261 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:30,261 [INFO]: 	compression ratio: 0.9993094636322518
2025-03-13 17:41:30,261 [INFO]: }
2025-03-13 17:41:30,261 [INFO]: 	>>> Finished "Creating the index" in 78.6333 secs
2025-03-13 17:41:30,261 [INFO]: >>> Finished "Launching the whole pipeline" in 78.6616 secs
2025-03-13 17:41:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 44129 [episode count 17/20]
[retrieval_preprocessing] for episode 41459 [episode count 18/20], we have num_retrieval=np.int64(3412) num_query=np.int64(200)
2025-03-13 17:41:33,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:34,615 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:34
2025-03-13 17:41:34,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 193.39it/s]
2025-03-13 17:41:34,649 [INFO]: There are 3412 embeddings of dim 49152
2025-03-13 17:41:34,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 17:41:34,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:34
2025-03-13 17:41:34,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:34,651 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:41:34,651 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:34,651 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:41:34,651 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:34
2025-03-13 17:41:34,651 [INFO]: 704.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:34,651 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:41:34,651 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:34
2025-03-13 17:41:34,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:34,652 [INFO]: 	Creating the index 03/13/2025, 17:41:34
2025-03-13 17:41:34,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:34
2025-03-13 17:41:34,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:41:34,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:34
2025-03-13 17:41:34,656 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:41:34,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.49it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.45it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.12it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.03it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.89it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.88it/s] 50%|█████     | 7/14 [00:00<00:00,  7.76it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.68it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.63it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.65it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.51it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.59it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.36it/s]100%|██████████| 14/14 [00:04<00:00,  1.02it/s]100%|██████████| 14/14 [00:04<00:00,  3.01it/s]
2025-03-13 17:41:39,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:39
2025-03-13 17:42:25,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7098 secs
2025-03-13 17:42:25,021 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:42:25,021 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 17:43:00,605 [INFO]: 	>>> Finished "Compute fast metrics" in 35.5845 secs
2025-03-13 17:43:00,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.9523 secs
2025-03-13 17:43:00,608 [INFO]: {
2025-03-13 17:43:00,608 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:00,608 [INFO]: 	index_param: efSearch=207
2025-03-13 17:43:00,608 [INFO]: 	index_path: knn.index
2025-03-13 17:43:00,608 [INFO]: 	size in bytes: 671290150
2025-03-13 17:43:00,608 [INFO]: 	avg_search_speed_ms: 10.762971897827075
2025-03-13 17:43:00,608 [INFO]: 	99p_search_speed_ms: 16.045301929116256
2025-03-13 17:43:00,608 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:00,608 [INFO]: 	nb vectors: 3412
2025-03-13 17:43:00,608 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:00,608 [INFO]: 	compression ratio: 0.999309309096819
2025-03-13 17:43:00,608 [INFO]: }
2025-03-13 17:43:00,608 [INFO]: 	>>> Finished "Creating the index" in 85.9564 secs
2025-03-13 17:43:00,608 [INFO]: >>> Finished "Launching the whole pipeline" in 85.9932 secs
2025-03-13 17:43:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 41459 [episode count 18/20]
[retrieval_preprocessing] for episode 17656 [episode count 19/20], we have num_retrieval=np.int64(3462) num_query=np.int64(150)
2025-03-13 17:43:03,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:03,828 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:03
2025-03-13 17:43:03,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2133.42it/s]
2025-03-13 17:43:03,848 [INFO]: There are 3462 embeddings of dim 49152
2025-03-13 17:43:03,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0205 secs
2025-03-13 17:43:03,848 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:03,848 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:43:03,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:03,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:03,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,849 [INFO]: 714.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:03,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:03,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:03
2025-03-13 17:43:03,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:03,849 [INFO]: 	Creating the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:03
2025-03-13 17:43:03,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:43:03,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:03
2025-03-13 17:43:03,850 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:43:03,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.17it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.97it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.57it/s] 50%|█████     | 7/14 [00:00<00:00, 11.38it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.84it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.21it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.37it/s]100%|██████████| 14/14 [00:04<00:00,  3.01it/s]
2025-03-13 17:43:08,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:08
2025-03-13 17:43:48,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1684 secs
2025-03-13 17:43:48,667 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 17:43:48,667 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 17:44:25,379 [INFO]: 	>>> Finished "Compute fast metrics" in 36.7117 secs
2025-03-13 17:44:25,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6171 secs
2025-03-13 17:44:25,467 [INFO]: {
2025-03-13 17:44:25,467 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:25,467 [INFO]: 	index_param: efSearch=211
2025-03-13 17:44:25,468 [INFO]: 	index_path: knn.index
2025-03-13 17:44:25,468 [INFO]: 	size in bytes: 681127270
2025-03-13 17:44:25,468 [INFO]: 	avg_search_speed_ms: 10.88932770266845
2025-03-13 17:44:25,468 [INFO]: 	99p_search_speed_ms: 19.725882415659726
2025-03-13 17:44:25,468 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:25,468 [INFO]: 	nb vectors: 3462
2025-03-13 17:44:25,468 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:25,468 [INFO]: 	compression ratio: 0.9993094183411567
2025-03-13 17:44:25,468 [INFO]: }
2025-03-13 17:44:25,468 [INFO]: 	>>> Finished "Creating the index" in 81.6194 secs
2025-03-13 17:44:25,468 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6405 secs
2025-03-13 17:44:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 17656 [episode count 19/20]
2025-03-13 17:44:27: [retrieval_preprocessing] finished for 5664924394_put_glue_stick_in_mug [chosen_id count 7/196]
2025-03-13 17:44:28: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5879622450_put_yellow_block_in_blue_cup [chosen_id count 8/196]
2025-03-13 17:44:28: [retrieval_preprocessing] we have num_total=2005 embedding_dim=49152
[retrieval_preprocessing] for episode 23056 [episode count 0/20], we have num_retrieval=np.int64(1925) num_query=np.int64(80)
2025-03-13 17:44:28,999 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:29,499 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:29
2025-03-13 17:44:29,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.55it/s]
2025-03-13 17:44:29,526 [INFO]: There are 1925 embeddings of dim 49152
2025-03-13 17:44:29,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:44:29,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:29
2025-03-13 17:44:29,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:29,526 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:44:29,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:29,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:29,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:29
2025-03-13 17:44:29,527 [INFO]: 397.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:29,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:44:29,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:29
2025-03-13 17:44:29,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:29,527 [INFO]: 	Creating the index 03/13/2025, 17:44:29
2025-03-13 17:44:29,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:29
2025-03-13 17:44:29,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:44:29,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:29
2025-03-13 17:44:29,528 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:29,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  8.84it/s] 50%|█████     | 4/8 [00:00<00:00, 17.98it/s] 75%|███████▌  | 6/8 [00:00<00:00, 12.15it/s]100%|██████████| 8/8 [00:02<00:00,  2.49it/s]100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
2025-03-13 17:44:31,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:31
2025-03-13 17:45:09,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1552 secs
2025-03-13 17:45:09,996 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:45:09,996 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 17:45:30,159 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1634 secs
2025-03-13 17:45:30,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6329 secs
2025-03-13 17:45:30,161 [INFO]: {
2025-03-13 17:45:30,161 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:30,161 [INFO]: 	index_param: efSearch=138
2025-03-13 17:45:30,161 [INFO]: 	index_path: knn.index
2025-03-13 17:45:30,161 [INFO]: 	size in bytes: 378732250
2025-03-13 17:45:30,161 [INFO]: 	avg_search_speed_ms: 10.5241617246678
2025-03-13 17:45:30,161 [INFO]: 	99p_search_speed_ms: 15.900765573605891
2025-03-13 17:45:30,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:30,161 [INFO]: 	nb vectors: 1925
2025-03-13 17:45:30,161 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:30,161 [INFO]: 	compression ratio: 0.99930861446312
2025-03-13 17:45:30,161 [INFO]: }
2025-03-13 17:45:30,161 [INFO]: 	>>> Finished "Creating the index" in 60.6345 secs
2025-03-13 17:45:30,161 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6619 secs
2025-03-13 17:45:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 23056 [episode count 0/20]
[retrieval_preprocessing] for episode 23 [episode count 1/20], we have num_retrieval=np.int64(1915) num_query=np.int64(90)
2025-03-13 17:45:31,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:31,838 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:31
2025-03-13 17:45:31,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1973.79it/s]
2025-03-13 17:45:31,864 [INFO]: There are 1915 embeddings of dim 49152
2025-03-13 17:45:31,864 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:45:31,864 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:31
2025-03-13 17:45:31,864 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:31,864 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:45:31,864 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:31,864 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:31,864 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:31
2025-03-13 17:45:31,864 [INFO]: 395.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:31,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:45:31,864 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:31
2025-03-13 17:45:31,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:31,864 [INFO]: 	Creating the index 03/13/2025, 17:45:31
2025-03-13 17:45:31,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:31
2025-03-13 17:45:31,865 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:45:31,865 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:31
2025-03-13 17:45:31,865 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:45:31,865 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.38it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.99it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.93it/s] 50%|█████     | 4/8 [00:00<00:00,  8.20it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.05it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.98it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.90it/s]100%|██████████| 8/8 [00:02<00:00,  1.34it/s]100%|██████████| 8/8 [00:02<00:00,  2.69it/s]
2025-03-13 17:45:34,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:34
2025-03-13 17:45:59,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8415 secs
2025-03-13 17:45:59,686 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 17:45:59,686 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s]
2025-03-13 17:46:18,024 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3379 secs
2025-03-13 17:46:18,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5709 secs
2025-03-13 17:46:18,437 [INFO]: {
2025-03-13 17:46:18,437 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:18,437 [INFO]: 	index_param: efSearch=211
2025-03-13 17:46:18,437 [INFO]: 	index_path: knn.index
2025-03-13 17:46:18,437 [INFO]: 	size in bytes: 376764850
2025-03-13 17:46:18,437 [INFO]: 	avg_search_speed_ms: 10.722122944957334
2025-03-13 17:46:18,437 [INFO]: 	99p_search_speed_ms: 14.72024258226156
2025-03-13 17:46:18,437 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:18,437 [INFO]: 	nb vectors: 1915
2025-03-13 17:46:18,437 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:18,437 [INFO]: 	compression ratio: 0.9993085076805864
2025-03-13 17:46:18,437 [INFO]: }
2025-03-13 17:46:18,437 [INFO]: 	>>> Finished "Creating the index" in 46.5730 secs
2025-03-13 17:46:18,437 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5992 secs
2025-03-13 17:46:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 23 [episode count 1/20]
[retrieval_preprocessing] for episode 81492 [episode count 2/20], we have num_retrieval=np.int64(1896) num_query=np.int64(109)
2025-03-13 17:46:19,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:20,305 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:20
2025-03-13 17:46:20,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.10it/s]
2025-03-13 17:46:20,328 [INFO]: There are 1896 embeddings of dim 49152
2025-03-13 17:46:20,328 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 17:46:20,328 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:20
2025-03-13 17:46:20,328 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:20,328 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:46:20,328 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:20,328 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:20,328 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:20
2025-03-13 17:46:20,329 [INFO]: 391.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:20,329 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:20,329 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:20
2025-03-13 17:46:20,329 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:20,329 [INFO]: 	Creating the index 03/13/2025, 17:46:20
2025-03-13 17:46:20,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:20
2025-03-13 17:46:20,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:46:20,330 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:20
2025-03-13 17:46:20,330 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:46:20,330 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.57it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.51it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.35it/s] 50%|█████     | 4/8 [00:00<00:00,  8.64it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.94it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.07it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.15it/s]100%|██████████| 8/8 [00:02<00:00,  1.66it/s]100%|██████████| 8/8 [00:02<00:00,  3.24it/s]
2025-03-13 17:46:22,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:22
2025-03-13 17:46:49,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2440 secs
2025-03-13 17:46:49,049 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 17:46:49,049 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-13 17:47:09,174 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1254 secs
2025-03-13 17:47:09,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2873 secs
2025-03-13 17:47:09,618 [INFO]: {
2025-03-13 17:47:09,618 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:09,618 [INFO]: 	index_param: efSearch=253
2025-03-13 17:47:09,618 [INFO]: 	index_path: knn.index
2025-03-13 17:47:09,618 [INFO]: 	size in bytes: 373026670
2025-03-13 17:47:09,618 [INFO]: 	avg_search_speed_ms: 11.028013252956093
2025-03-13 17:47:09,618 [INFO]: 	99p_search_speed_ms: 14.90428538993001
2025-03-13 17:47:09,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:09,618 [INFO]: 	nb vectors: 1896
2025-03-13 17:47:09,618 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:09,618 [INFO]: 	compression ratio: 0.9993086231609123
2025-03-13 17:47:09,618 [INFO]: }
2025-03-13 17:47:09,618 [INFO]: 	>>> Finished "Creating the index" in 49.2894 secs
2025-03-13 17:47:09,618 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3136 secs
2025-03-13 17:47:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81492 [episode count 2/20]
[retrieval_preprocessing] for episode 54374 [episode count 3/20], we have num_retrieval=np.int64(1905) num_query=np.int64(100)
2025-03-13 17:47:11,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:12,185 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:12
2025-03-13 17:47:12,185 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 741.83it/s]
2025-03-13 17:47:12,214 [INFO]: There are 1905 embeddings of dim 49152
2025-03-13 17:47:12,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:47:12,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:12
2025-03-13 17:47:12,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:12,215 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:47:12,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:12,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:47:12,216 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:12
2025-03-13 17:47:12,216 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:12,216 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:47:12,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:12
2025-03-13 17:47:12,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:12,217 [INFO]: 	Creating the index 03/13/2025, 17:47:12
2025-03-13 17:47:12,217 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:12
2025-03-13 17:47:12,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:47:12,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:12
2025-03-13 17:47:12,220 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:47:12,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.98it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.52it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.31it/s] 50%|█████     | 4/8 [00:00<00:00,  8.85it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.60it/s]100%|██████████| 8/8 [00:02<00:00,  2.24it/s]100%|██████████| 8/8 [00:02<00:00,  3.24it/s]
2025-03-13 17:47:14,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:14
2025-03-13 17:47:41,388 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6899 secs
2025-03-13 17:47:41,388 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:47:41,388 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s]
2025-03-13 17:48:08,440 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0517 secs
2025-03-13 17:48:08,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4177 secs
2025-03-13 17:48:08,638 [INFO]: {
2025-03-13 17:48:08,638 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:08,638 [INFO]: 	index_param: efSearch=206
2025-03-13 17:48:08,638 [INFO]: 	index_path: knn.index
2025-03-13 17:48:08,638 [INFO]: 	size in bytes: 374797450
2025-03-13 17:48:08,638 [INFO]: 	avg_search_speed_ms: 8.61857937556563
2025-03-13 17:48:08,639 [INFO]: 	99p_search_speed_ms: 13.241529872175326
2025-03-13 17:48:08,639 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:08,639 [INFO]: 	nb vectors: 1905
2025-03-13 17:48:08,639 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:08,639 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 17:48:08,639 [INFO]: }
2025-03-13 17:48:08,639 [INFO]: 	>>> Finished "Creating the index" in 56.4217 secs
2025-03-13 17:48:08,639 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4538 secs
2025-03-13 17:48:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 54374 [episode count 3/20]
[retrieval_preprocessing] for episode 39544 [episode count 4/20], we have num_retrieval=np.int64(1912) num_query=np.int64(93)
2025-03-13 17:48:10,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:10,467 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:10
2025-03-13 17:48:10,467 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 926.92it/s]
2025-03-13 17:48:10,493 [INFO]: There are 1912 embeddings of dim 49152
2025-03-13 17:48:10,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:48:10,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:10,494 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:48:10,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:10,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:10,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,494 [INFO]: 394.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:10,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:10,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:10
2025-03-13 17:48:10,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:10,494 [INFO]: 	Creating the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:10
2025-03-13 17:48:10,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:48:10,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:10
2025-03-13 17:48:10,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:48:10,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.10it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.66it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.48it/s] 50%|█████     | 4/8 [00:00<00:00,  7.81it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.99it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.11it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.17it/s]100%|██████████| 8/8 [00:02<00:00,  1.98it/s]100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
2025-03-13 17:48:12,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:12
2025-03-13 17:48:38,467 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7375 secs
2025-03-13 17:48:38,468 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:48:38,468 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-13 17:48:58,841 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3730 secs
2025-03-13 17:48:58,843 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3471 secs
2025-03-13 17:48:58,843 [INFO]: {
2025-03-13 17:48:58,843 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:58,843 [INFO]: 	index_param: efSearch=194
2025-03-13 17:48:58,843 [INFO]: 	index_path: knn.index
2025-03-13 17:48:58,843 [INFO]: 	size in bytes: 376174630
2025-03-13 17:48:58,843 [INFO]: 	avg_search_speed_ms: 9.217791514007658
2025-03-13 17:48:58,843 [INFO]: 	99p_search_speed_ms: 12.434296635910872
2025-03-13 17:48:58,843 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:58,843 [INFO]: 	nb vectors: 1912
2025-03-13 17:48:58,843 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:58,843 [INFO]: 	compression ratio: 0.9993084754280213
2025-03-13 17:48:58,843 [INFO]: }
2025-03-13 17:48:58,843 [INFO]: 	>>> Finished "Creating the index" in 48.3490 secs
2025-03-13 17:48:58,843 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3765 secs
2025-03-13 17:49:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 39544 [episode count 4/20]
[retrieval_preprocessing] for episode 83598 [episode count 5/20], we have num_retrieval=np.int64(1876) num_query=np.int64(129)
2025-03-13 17:49:01,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:01,904 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:01
2025-03-13 17:49:01,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-13 17:49:01,932 [INFO]: There are 1876 embeddings of dim 49152
2025-03-13 17:49:01,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:49:01,932 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:01
2025-03-13 17:49:01,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:01,932 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:49:01,932 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:01,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:01,932 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:01
2025-03-13 17:49:01,932 [INFO]: 387.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:01,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:01,932 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:01
2025-03-13 17:49:01,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:01,933 [INFO]: 	Creating the index 03/13/2025, 17:49:01
2025-03-13 17:49:01,933 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:01
2025-03-13 17:49:01,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:49:01,934 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:01
2025-03-13 17:49:01,934 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:49:01,934 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.64it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.39it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.96it/s] 50%|█████     | 4/8 [00:00<00:00,  8.44it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.49it/s]100%|██████████| 8/8 [00:02<00:00,  2.70it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 17:49:04,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:04
2025-03-13 17:49:31,184 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1078 secs
2025-03-13 17:49:31,184 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:49:31,184 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 17:49:49,369 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1848 secs
2025-03-13 17:49:49,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4380 secs
2025-03-13 17:49:49,372 [INFO]: {
2025-03-13 17:49:49,372 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:49,372 [INFO]: 	index_param: efSearch=197
2025-03-13 17:49:49,372 [INFO]: 	index_path: knn.index
2025-03-13 17:49:49,372 [INFO]: 	size in bytes: 369091750
2025-03-13 17:49:49,372 [INFO]: 	avg_search_speed_ms: 10.00301860831678
2025-03-13 17:49:49,372 [INFO]: 	99p_search_speed_ms: 13.678262869361786
2025-03-13 17:49:49,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:49,372 [INFO]: 	nb vectors: 1876
2025-03-13 17:49:49,372 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:49,372 [INFO]: 	compression ratio: 0.999308730146366
2025-03-13 17:49:49,372 [INFO]: }
2025-03-13 17:49:49,372 [INFO]: 	>>> Finished "Creating the index" in 47.4395 secs
2025-03-13 17:49:49,372 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4679 secs
2025-03-13 17:49:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 83598 [episode count 5/20]
[retrieval_preprocessing] for episode 25757 [episode count 6/20], we have num_retrieval=np.int64(1893) num_query=np.int64(112)
2025-03-13 17:49:50,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:51,237 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:51
2025-03-13 17:49:51,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.93it/s]
2025-03-13 17:49:51,264 [INFO]: There are 1893 embeddings of dim 49152
2025-03-13 17:49:51,265 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 17:49:51,265 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:51
2025-03-13 17:49:51,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:51,265 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:49:51,265 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:51,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:49:51,265 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:51
2025-03-13 17:49:51,266 [INFO]: 390.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:51,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:49:51,266 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:51
2025-03-13 17:49:51,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:51,266 [INFO]: 	Creating the index 03/13/2025, 17:49:51
2025-03-13 17:49:51,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:51
2025-03-13 17:49:51,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:49:51,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:51
2025-03-13 17:49:51,270 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:49:51,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.65it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.33it/s] 50%|█████     | 4/8 [00:00<00:00,  8.97it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.25it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.35it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.25it/s]100%|██████████| 8/8 [00:02<00:00,  1.76it/s]100%|██████████| 8/8 [00:02<00:00,  3.22it/s]
2025-03-13 17:49:53,758 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:53
2025-03-13 17:50:25,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7739 secs
2025-03-13 17:50:25,533 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:50:25,533 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 17:50:46,809 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2762 secs
2025-03-13 17:50:46,811 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5415 secs
2025-03-13 17:50:46,812 [INFO]: {
2025-03-13 17:50:46,812 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:46,812 [INFO]: 	index_param: efSearch=178
2025-03-13 17:50:46,812 [INFO]: 	index_path: knn.index
2025-03-13 17:50:46,812 [INFO]: 	size in bytes: 372436450
2025-03-13 17:50:46,812 [INFO]: 	avg_search_speed_ms: 9.309130676352597
2025-03-13 17:50:46,812 [INFO]: 	99p_search_speed_ms: 12.724692756310105
2025-03-13 17:50:46,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:46,812 [INFO]: 	nb vectors: 1893
2025-03-13 17:50:46,812 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:46,812 [INFO]: 	compression ratio: 0.999308590767633
2025-03-13 17:50:46,812 [INFO]: }
2025-03-13 17:50:46,812 [INFO]: 	>>> Finished "Creating the index" in 55.5454 secs
2025-03-13 17:50:46,812 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5749 secs
2025-03-13 17:50:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 25757 [episode count 6/20]
[retrieval_preprocessing] for episode 16545 [episode count 7/20], we have num_retrieval=np.int64(1922) num_query=np.int64(83)
2025-03-13 17:50:48,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:49,393 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:49
2025-03-13 17:50:49,393 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.31it/s]
2025-03-13 17:50:49,424 [INFO]: There are 1922 embeddings of dim 49152
2025-03-13 17:50:49,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:50:49,425 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:49,425 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:50:49,425 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:49,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:50:49,426 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,426 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:49,426 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:50:49,426 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:49
2025-03-13 17:50:49,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:49,427 [INFO]: 	Creating the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,427 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:49
2025-03-13 17:50:49,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:50:49,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,430 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:50:49,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.81it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.28it/s] 50%|█████     | 4/8 [00:00<00:00,  7.94it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.87it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.50it/s] 88%|████████▊ | 7/8 [00:01<00:00,  6.14it/s]100%|██████████| 8/8 [00:02<00:00,  1.72it/s]100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
2025-03-13 17:50:52,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:52
2025-03-13 17:51:15,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4987 secs
2025-03-13 17:51:15,506 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 17:51:15,506 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-13 17:51:37,314 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8077 secs
2025-03-13 17:51:37,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8857 secs
2025-03-13 17:51:37,316 [INFO]: {
2025-03-13 17:51:37,316 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:37,316 [INFO]: 	index_param: efSearch=240
2025-03-13 17:51:37,316 [INFO]: 	index_path: knn.index
2025-03-13 17:51:37,316 [INFO]: 	size in bytes: 378142030
2025-03-13 17:51:37,316 [INFO]: 	avg_search_speed_ms: 10.467441572571976
2025-03-13 17:51:37,316 [INFO]: 	99p_search_speed_ms: 16.989133867900822
2025-03-13 17:51:37,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:37,316 [INFO]: 	nb vectors: 1922
2025-03-13 17:51:37,316 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:37,316 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-13 17:51:37,316 [INFO]: }
2025-03-13 17:51:37,316 [INFO]: 	>>> Finished "Creating the index" in 47.8893 secs
2025-03-13 17:51:37,316 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9236 secs
2025-03-13 17:51:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 16545 [episode count 7/20]
[retrieval_preprocessing] for episode 23751 [episode count 8/20], we have num_retrieval=np.int64(1906) num_query=np.int64(99)
2025-03-13 17:51:38,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:39,841 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:39
2025-03-13 17:51:39,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.93it/s]
2025-03-13 17:51:39,870 [INFO]: There are 1906 embeddings of dim 49152
2025-03-13 17:51:39,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:51:39,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:39
2025-03-13 17:51:39,871 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:39,871 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:51:39,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:39,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:51:39,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:39
2025-03-13 17:51:39,872 [INFO]: 393.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:39,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:51:39,872 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:39
2025-03-13 17:51:39,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:39,872 [INFO]: 	Creating the index 03/13/2025, 17:51:39
2025-03-13 17:51:39,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:39
2025-03-13 17:51:39,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:51:39,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:39
2025-03-13 17:51:39,875 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:51:39,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.80it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.91it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.39it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.50it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.53it/s]100%|██████████| 8/8 [00:02<00:00,  1.98it/s]100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
2025-03-13 17:51:42,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:42
2025-03-13 17:52:09,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6556 secs
2025-03-13 17:52:09,813 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:52:09,813 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 17:52:27,325 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5115 secs
2025-03-13 17:52:27,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4522 secs
2025-03-13 17:52:27,328 [INFO]: {
2025-03-13 17:52:27,328 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:27,328 [INFO]: 	index_param: efSearch=184
2025-03-13 17:52:27,328 [INFO]: 	index_path: knn.index
2025-03-13 17:52:27,328 [INFO]: 	size in bytes: 374994190
2025-03-13 17:52:27,328 [INFO]: 	avg_search_speed_ms: 10.215220039432623
2025-03-13 17:52:27,328 [INFO]: 	99p_search_speed_ms: 15.963603830896322
2025-03-13 17:52:27,328 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:27,328 [INFO]: 	nb vectors: 1906
2025-03-13 17:52:27,328 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:27,328 [INFO]: 	compression ratio: 0.9993084106183086
2025-03-13 17:52:27,328 [INFO]: }
2025-03-13 17:52:27,328 [INFO]: 	>>> Finished "Creating the index" in 47.4558 secs
2025-03-13 17:52:27,328 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4873 secs
2025-03-13 17:52:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 23751 [episode count 8/20]
[retrieval_preprocessing] for episode 70352 [episode count 9/20], we have num_retrieval=np.int64(1927) num_query=np.int64(78)
2025-03-13 17:52:29,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:30,244 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:30
2025-03-13 17:52:30,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1278.75it/s]
2025-03-13 17:52:30,270 [INFO]: There are 1927 embeddings of dim 49152
2025-03-13 17:52:30,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:52:30,271 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:30
2025-03-13 17:52:30,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:30,271 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:52:30,271 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:30,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:30,271 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:30
2025-03-13 17:52:30,271 [INFO]: 397.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:30,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:30,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:30
2025-03-13 17:52:30,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:30,271 [INFO]: 	Creating the index 03/13/2025, 17:52:30
2025-03-13 17:52:30,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:30
2025-03-13 17:52:30,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:52:30,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:30
2025-03-13 17:52:30,272 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:30,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  3.98it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.59it/s] 50%|█████     | 4/8 [00:00<00:00,  8.28it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.36it/s]100%|██████████| 8/8 [00:02<00:00,  2.32it/s]100%|██████████| 8/8 [00:02<00:00,  3.21it/s]
2025-03-13 17:52:32,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:32
2025-03-13 17:52:57,691 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7365 secs
2025-03-13 17:52:57,691 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 17:52:57,691 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s]
2025-03-13 17:53:17,733 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0423 secs
2025-03-13 17:53:17,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4628 secs
2025-03-13 17:53:17,735 [INFO]: {
2025-03-13 17:53:17,735 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:17,735 [INFO]: 	index_param: efSearch=211
2025-03-13 17:53:17,735 [INFO]: 	index_path: knn.index
2025-03-13 17:53:17,735 [INFO]: 	size in bytes: 379125790
2025-03-13 17:53:17,735 [INFO]: 	avg_search_speed_ms: 11.1618936747878
2025-03-13 17:53:17,735 [INFO]: 	99p_search_speed_ms: 21.141798316966717
2025-03-13 17:53:17,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:17,735 [INFO]: 	nb vectors: 1927
2025-03-13 17:53:17,735 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:17,735 [INFO]: 	compression ratio: 0.9993084775372311
2025-03-13 17:53:17,736 [INFO]: }
2025-03-13 17:53:17,736 [INFO]: 	>>> Finished "Creating the index" in 47.4642 secs
2025-03-13 17:53:17,736 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4915 secs
2025-03-13 17:53:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 70352 [episode count 9/20]
[retrieval_preprocessing] for episode 4313 [episode count 10/20], we have num_retrieval=np.int64(1903) num_query=np.int64(102)
2025-03-13 17:53:18,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:19,306 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:19
2025-03-13 17:53:19,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.58it/s]
2025-03-13 17:53:19,331 [INFO]: There are 1903 embeddings of dim 49152
2025-03-13 17:53:19,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:53:19,332 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:19
2025-03-13 17:53:19,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:19,332 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:53:19,332 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:19,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:53:19,332 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:19
2025-03-13 17:53:19,332 [INFO]: 392.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:19,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:19,332 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:19
2025-03-13 17:53:19,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:19,332 [INFO]: 	Creating the index 03/13/2025, 17:53:19
2025-03-13 17:53:19,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:19
2025-03-13 17:53:19,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:53:19,335 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:19
2025-03-13 17:53:19,335 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:53:19,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.81it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.69it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.55it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.58it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.00it/s]100%|██████████| 8/8 [00:02<00:00,  2.46it/s]100%|██████████| 8/8 [00:02<00:00,  3.77it/s]
2025-03-13 17:53:21,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:21
2025-03-13 17:53:46,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3323 secs
2025-03-13 17:53:46,796 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:53:46,796 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 17:54:08,743 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9468 secs
2025-03-13 17:54:08,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4098 secs
2025-03-13 17:54:08,745 [INFO]: {
2025-03-13 17:54:08,745 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:08,745 [INFO]: 	index_param: efSearch=230
2025-03-13 17:54:08,745 [INFO]: 	index_path: knn.index
2025-03-13 17:54:08,745 [INFO]: 	size in bytes: 374403970
2025-03-13 17:54:08,745 [INFO]: 	avg_search_speed_ms: 11.144211606632341
2025-03-13 17:54:08,745 [INFO]: 	99p_search_speed_ms: 15.750285433605312
2025-03-13 17:54:08,745 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:08,745 [INFO]: 	nb vectors: 1903
2025-03-13 17:54:08,745 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:08,745 [INFO]: 	compression ratio: 0.9993083780602006
2025-03-13 17:54:08,745 [INFO]: }
2025-03-13 17:54:08,745 [INFO]: 	>>> Finished "Creating the index" in 49.4122 secs
2025-03-13 17:54:08,745 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4383 secs
2025-03-13 17:54:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 4313 [episode count 10/20]
[retrieval_preprocessing] for episode 88813 [episode count 11/20], we have num_retrieval=np.int64(1906) num_query=np.int64(99)
2025-03-13 17:54:10,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:11,000 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:11
2025-03-13 17:54:11,000 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.54it/s]
2025-03-13 17:54:11,036 [INFO]: There are 1906 embeddings of dim 49152
2025-03-13 17:54:11,037 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 17:54:11,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:11
2025-03-13 17:54:11,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:11,038 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:54:11,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:11,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:54:11,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:11
2025-03-13 17:54:11,038 [INFO]: 393.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:11,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:54:11,039 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:11
2025-03-13 17:54:11,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:11,039 [INFO]: 	Creating the index 03/13/2025, 17:54:11
2025-03-13 17:54:11,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:11
2025-03-13 17:54:11,042 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:54:11,042 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:11
2025-03-13 17:54:11,042 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:54:11,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  7.51it/s] 25%|██▌       | 2/8 [00:00<00:00,  8.76it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.23it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.13it/s] 75%|███████▌  | 6/8 [00:00<00:00, 10.01it/s]100%|██████████| 8/8 [00:02<00:00,  1.96it/s]100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
2025-03-13 17:54:13,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:13
2025-03-13 17:54:38,811 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1188 secs
2025-03-13 17:54:38,811 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 17:54:38,811 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.04it/s]
2025-03-13 17:55:04,482 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6708 secs
2025-03-13 17:55:04,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4416 secs
2025-03-13 17:55:04,484 [INFO]: {
2025-03-13 17:55:04,484 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:04,484 [INFO]: 	index_param: efSearch=257
2025-03-13 17:55:04,484 [INFO]: 	index_path: knn.index
2025-03-13 17:55:04,484 [INFO]: 	size in bytes: 374994190
2025-03-13 17:55:04,484 [INFO]: 	avg_search_speed_ms: 10.171732230496612
2025-03-13 17:55:04,484 [INFO]: 	99p_search_speed_ms: 13.431177404709159
2025-03-13 17:55:04,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:04,484 [INFO]: 	nb vectors: 1906
2025-03-13 17:55:04,484 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:04,484 [INFO]: 	compression ratio: 0.9993084106183086
2025-03-13 17:55:04,484 [INFO]: }
2025-03-13 17:55:04,484 [INFO]: 	>>> Finished "Creating the index" in 53.4452 secs
2025-03-13 17:55:04,484 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4838 secs
2025-03-13 17:55:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 88813 [episode count 11/20]
[retrieval_preprocessing] for episode 87298 [episode count 12/20], we have num_retrieval=np.int64(1913) num_query=np.int64(92)
2025-03-13 17:55:06,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:06,594 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:06
2025-03-13 17:55:06,594 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1645.47it/s]
2025-03-13 17:55:06,616 [INFO]: There are 1913 embeddings of dim 49152
2025-03-13 17:55:06,617 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 17:55:06,617 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:06
2025-03-13 17:55:06,617 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:06,617 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:55:06,617 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:06,617 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:06,617 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:06
2025-03-13 17:55:06,617 [INFO]: 394.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:06,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:55:06,617 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:06
2025-03-13 17:55:06,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:06,617 [INFO]: 	Creating the index 03/13/2025, 17:55:06
2025-03-13 17:55:06,617 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:06
2025-03-13 17:55:06,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:55:06,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:06
2025-03-13 17:55:06,618 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:55:06,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.19it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.22it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.68it/s] 50%|█████     | 4/8 [00:00<00:00,  7.03it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.11it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.16it/s] 88%|████████▊ | 7/8 [00:01<00:00,  7.23it/s]100%|██████████| 8/8 [00:02<00:00,  1.44it/s]100%|██████████| 8/8 [00:02<00:00,  2.76it/s]
2025-03-13 17:55:09,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:09
2025-03-13 17:55:36,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0616 secs
2025-03-13 17:55:36,578 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:55:36,578 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 17:55:56,849 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2707 secs
2025-03-13 17:55:56,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2324 secs
2025-03-13 17:55:56,851 [INFO]: {
2025-03-13 17:55:56,851 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:56,851 [INFO]: 	index_param: efSearch=218
2025-03-13 17:55:56,851 [INFO]: 	index_path: knn.index
2025-03-13 17:55:56,851 [INFO]: 	size in bytes: 376371370
2025-03-13 17:55:56,851 [INFO]: 	avg_search_speed_ms: 10.560401861379837
2025-03-13 17:55:56,851 [INFO]: 	99p_search_speed_ms: 17.74604868609457
2025-03-13 17:55:56,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:56,851 [INFO]: 	nb vectors: 1913
2025-03-13 17:55:56,851 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:56,851 [INFO]: 	compression ratio: 0.9993084861901159
2025-03-13 17:55:56,851 [INFO]: }
2025-03-13 17:55:56,851 [INFO]: 	>>> Finished "Creating the index" in 50.2339 secs
2025-03-13 17:55:56,851 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2568 secs
2025-03-13 17:55:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 87298 [episode count 12/20]
[retrieval_preprocessing] for episode 41219 [episode count 13/20], we have num_retrieval=np.int64(1908) num_query=np.int64(97)
2025-03-13 17:55:58,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:59,395 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:59
2025-03-13 17:55:59,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 874.18it/s]
2025-03-13 17:55:59,422 [INFO]: There are 1908 embeddings of dim 49152
2025-03-13 17:55:59,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:55:59,423 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:59,424 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:55:59,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:59,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:55:59,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,424 [INFO]: 393.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:59,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:55:59,425 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:59
2025-03-13 17:55:59,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:59,425 [INFO]: 	Creating the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:59
2025-03-13 17:55:59,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:55:59,429 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:59
2025-03-13 17:55:59,429 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:55:59,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.25it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.73it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.62it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.21it/s]100%|██████████| 8/8 [00:02<00:00,  2.92it/s]
2025-03-13 17:56:02,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:02
2025-03-13 17:56:33,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0372 secs
2025-03-13 17:56:33,213 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:56:33,213 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 17:56:48,406 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1934 secs
2025-03-13 17:56:48,408 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9790 secs
2025-03-13 17:56:48,408 [INFO]: {
2025-03-13 17:56:48,408 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:48,408 [INFO]: 	index_param: efSearch=199
2025-03-13 17:56:48,408 [INFO]: 	index_path: knn.index
2025-03-13 17:56:48,408 [INFO]: 	size in bytes: 375387670
2025-03-13 17:56:48,409 [INFO]: 	avg_search_speed_ms: 9.735652609449877
2025-03-13 17:56:48,409 [INFO]: 	99p_search_speed_ms: 14.545255973935127
2025-03-13 17:56:48,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:48,409 [INFO]: 	nb vectors: 1908
2025-03-13 17:56:48,409 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:48,409 [INFO]: 	compression ratio: 0.999308432266835
2025-03-13 17:56:48,409 [INFO]: }
2025-03-13 17:56:48,409 [INFO]: 	>>> Finished "Creating the index" in 48.9834 secs
2025-03-13 17:56:48,409 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0140 secs
2025-03-13 17:56:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 41219 [episode count 13/20]
[retrieval_preprocessing] for episode 68368 [episode count 14/20], we have num_retrieval=np.int64(1896) num_query=np.int64(109)
2025-03-13 17:56:49,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:50,030 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:50
2025-03-13 17:56:50,030 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1707.78it/s]
2025-03-13 17:56:50,055 [INFO]: There are 1896 embeddings of dim 49152
2025-03-13 17:56:50,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:56:50,056 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:50
2025-03-13 17:56:50,056 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:50,056 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:56:50,056 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:50,056 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:56:50,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:50
2025-03-13 17:56:50,057 [INFO]: 391.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:50,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:56:50,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:50
2025-03-13 17:56:50,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:50,057 [INFO]: 	Creating the index 03/13/2025, 17:56:50
2025-03-13 17:56:50,058 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:50
2025-03-13 17:56:50,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:56:50,061 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:50
2025-03-13 17:56:50,061 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:56:50,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.38it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.05it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.62it/s] 50%|█████     | 4/8 [00:00<00:00,  7.97it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.13it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.29it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.46it/s]100%|██████████| 8/8 [00:02<00:00,  1.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.40it/s]
2025-03-13 17:56:52,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:52
2025-03-13 17:57:15,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1604 secs
2025-03-13 17:57:15,577 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 17:57:15,577 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 17:57:40,428 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8517 secs
2025-03-13 17:57:40,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3699 secs
2025-03-13 17:57:40,431 [INFO]: {
2025-03-13 17:57:40,431 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:40,431 [INFO]: 	index_param: efSearch=245
2025-03-13 17:57:40,431 [INFO]: 	index_path: knn.index
2025-03-13 17:57:40,431 [INFO]: 	size in bytes: 373026670
2025-03-13 17:57:40,431 [INFO]: 	avg_search_speed_ms: 10.518573829757303
2025-03-13 17:57:40,431 [INFO]: 	99p_search_speed_ms: 13.99983000010252
2025-03-13 17:57:40,431 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:40,431 [INFO]: 	nb vectors: 1896
2025-03-13 17:57:40,431 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:40,431 [INFO]: 	compression ratio: 0.9993086231609123
2025-03-13 17:57:40,431 [INFO]: }
2025-03-13 17:57:40,431 [INFO]: 	>>> Finished "Creating the index" in 50.3735 secs
2025-03-13 17:57:40,431 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4011 secs
2025-03-13 17:57:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 68368 [episode count 14/20]
[retrieval_preprocessing] for episode 60181 [episode count 15/20], we have num_retrieval=np.int64(1919) num_query=np.int64(86)
2025-03-13 17:57:42,803 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:43,755 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:43
2025-03-13 17:57:43,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1932.86it/s]
2025-03-13 17:57:43,781 [INFO]: There are 1919 embeddings of dim 49152
2025-03-13 17:57:43,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:57:43,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:43
2025-03-13 17:57:43,781 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:43,781 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:57:43,781 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:43,781 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:43,781 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:43
2025-03-13 17:57:43,781 [INFO]: 396.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:43,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:43,781 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:43
2025-03-13 17:57:43,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:43,782 [INFO]: 	Creating the index 03/13/2025, 17:57:43
2025-03-13 17:57:43,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:43
2025-03-13 17:57:43,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:57:43,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:43
2025-03-13 17:57:43,783 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:57:43,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.16it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.36it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.95it/s] 50%|█████     | 4/8 [00:00<00:00,  7.26it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.37it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.54it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.57it/s]100%|██████████| 8/8 [00:02<00:00,  1.48it/s]100%|██████████| 8/8 [00:02<00:00,  2.85it/s]
2025-03-13 17:57:46,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:46
2025-03-13 17:58:11,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1367 secs
2025-03-13 17:58:11,732 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:58:11,732 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 17:58:37,520 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7878 secs
2025-03-13 17:58:37,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7391 secs
2025-03-13 17:58:37,522 [INFO]: {
2025-03-13 17:58:37,522 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:37,522 [INFO]: 	index_param: efSearch=162
2025-03-13 17:58:37,522 [INFO]: 	index_path: knn.index
2025-03-13 17:58:37,522 [INFO]: 	size in bytes: 377551810
2025-03-13 17:58:37,522 [INFO]: 	avg_search_speed_ms: 8.720658302393197
2025-03-13 17:58:37,522 [INFO]: 	99p_search_speed_ms: 15.408603511750693
2025-03-13 17:58:37,522 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:37,522 [INFO]: 	nb vectors: 1919
2025-03-13 17:58:37,522 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:37,522 [INFO]: 	compression ratio: 0.9993085505271448
2025-03-13 17:58:37,522 [INFO]: }
2025-03-13 17:58:37,522 [INFO]: 	>>> Finished "Creating the index" in 53.7407 secs
2025-03-13 17:58:37,522 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7674 secs
2025-03-13 17:58:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 60181 [episode count 15/20]
[retrieval_preprocessing] for episode 21699 [episode count 16/20], we have num_retrieval=np.int64(1830) num_query=np.int64(175)
2025-03-13 17:58:38,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:39,753 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:39
2025-03-13 17:58:39,753 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1000.31it/s]
2025-03-13 17:58:39,778 [INFO]: There are 1830 embeddings of dim 49152
2025-03-13 17:58:39,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:58:39,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:39
2025-03-13 17:58:39,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:39,779 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 17:58:39,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:39,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:39,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:39
2025-03-13 17:58:39,779 [INFO]: 377.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:39,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:58:39,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:39
2025-03-13 17:58:39,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:39,779 [INFO]: 	Creating the index 03/13/2025, 17:58:39
2025-03-13 17:58:39,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:39
2025-03-13 17:58:39,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:39,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:39
2025-03-13 17:58:39,780 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 17:58:39,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.83it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.86it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.62it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.98it/s]100%|██████████| 8/8 [00:02<00:00,  2.69it/s]100%|██████████| 8/8 [00:02<00:00,  3.98it/s]
2025-03-13 17:58:41,794 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:41
2025-03-13 17:59:05,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3717 secs
2025-03-13 17:59:05,166 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:59:05,166 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-13 17:59:22,915 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7486 secs
2025-03-13 17:59:22,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1360 secs
2025-03-13 17:59:22,916 [INFO]: {
2025-03-13 17:59:22,916 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:22,917 [INFO]: 	index_param: efSearch=223
2025-03-13 17:59:22,917 [INFO]: 	index_path: knn.index
2025-03-13 17:59:22,917 [INFO]: 	size in bytes: 360041410
2025-03-13 17:59:22,917 [INFO]: 	avg_search_speed_ms: 11.434566522549305
2025-03-13 17:59:22,917 [INFO]: 	99p_search_speed_ms: 17.9553298978135
2025-03-13 17:59:22,917 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:22,917 [INFO]: 	nb vectors: 1830
2025-03-13 17:59:22,917 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:22,917 [INFO]: 	compression ratio: 0.9993090517004697
2025-03-13 17:59:22,917 [INFO]: }
2025-03-13 17:59:22,917 [INFO]: 	>>> Finished "Creating the index" in 43.1376 secs
2025-03-13 17:59:22,917 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1636 secs
2025-03-13 17:59:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 21699 [episode count 16/20]
[retrieval_preprocessing] for episode 94016 [episode count 17/20], we have num_retrieval=np.int64(1914) num_query=np.int64(91)
2025-03-13 17:59:25,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:25,964 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:25
2025-03-13 17:59:25,964 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1660.45it/s]
2025-03-13 17:59:25,989 [INFO]: There are 1914 embeddings of dim 49152
2025-03-13 17:59:25,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:59:25,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:25
2025-03-13 17:59:25,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:25,990 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 17:59:25,990 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:25,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:25,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:25
2025-03-13 17:59:25,990 [INFO]: 395.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:25,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:25,990 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:25
2025-03-13 17:59:25,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:25,990 [INFO]: 	Creating the index 03/13/2025, 17:59:25
2025-03-13 17:59:25,990 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:25
2025-03-13 17:59:25,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:59:25,992 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:25
2025-03-13 17:59:25,992 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:59:25,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  4.97it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.33it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.00it/s] 50%|█████     | 4/8 [00:00<00:00,  7.24it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.36it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.44it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.48it/s]100%|██████████| 8/8 [00:02<00:00,  1.61it/s]100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
2025-03-13 17:59:28,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:28
2025-03-13 17:59:56,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6670 secs
2025-03-13 17:59:56,313 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:59:56,313 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 18:00:17,604 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2905 secs
2025-03-13 18:00:17,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6142 secs
2025-03-13 18:00:17,606 [INFO]: {
2025-03-13 18:00:17,606 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:17,606 [INFO]: 	index_param: efSearch=200
2025-03-13 18:00:17,606 [INFO]: 	index_path: knn.index
2025-03-13 18:00:17,606 [INFO]: 	size in bytes: 376568110
2025-03-13 18:00:17,606 [INFO]: 	avg_search_speed_ms: 8.707449747531802
2025-03-13 18:00:17,606 [INFO]: 	99p_search_speed_ms: 16.597991304006428
2025-03-13 18:00:17,606 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:17,606 [INFO]: 	nb vectors: 1914
2025-03-13 18:00:17,606 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:17,606 [INFO]: 	compression ratio: 0.9993084969409651
2025-03-13 18:00:17,606 [INFO]: }
2025-03-13 18:00:17,606 [INFO]: 	>>> Finished "Creating the index" in 51.6159 secs
2025-03-13 18:00:17,606 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6422 secs
2025-03-13 18:00:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 94016 [episode count 17/20]
[retrieval_preprocessing] for episode 6027 [episode count 18/20], we have num_retrieval=np.int64(1920) num_query=np.int64(85)
2025-03-13 18:00:19,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:20,020 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:20
2025-03-13 18:00:20,020 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.92it/s]
2025-03-13 18:00:20,044 [INFO]: There are 1920 embeddings of dim 49152
2025-03-13 18:00:20,045 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:00:20,045 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,045 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:20,045 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 18:00:20,045 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:20,045 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:20,045 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,045 [INFO]: 396.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:20,045 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:20,045 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:20
2025-03-13 18:00:20,045 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:20,045 [INFO]: 	Creating the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,045 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:20
2025-03-13 18:00:20,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:00:20,046 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,046 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:00:20,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.21it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.55it/s] 50%|█████     | 4/8 [00:00<00:00,  8.91it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.17it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.59it/s]100%|██████████| 8/8 [00:02<00:00,  2.28it/s]100%|██████████| 8/8 [00:02<00:00,  3.68it/s]
2025-03-13 18:00:22,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:22
2025-03-13 18:00:50,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7832 secs
2025-03-13 18:00:50,008 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 18:00:50,008 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 18:01:06,463 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4549 secs
2025-03-13 18:01:07,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0344 secs
2025-03-13 18:01:07,081 [INFO]: {
2025-03-13 18:01:07,081 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:07,081 [INFO]: 	index_param: efSearch=215
2025-03-13 18:01:07,081 [INFO]: 	index_path: knn.index
2025-03-13 18:01:07,081 [INFO]: 	size in bytes: 377748550
2025-03-13 18:01:07,081 [INFO]: 	avg_search_speed_ms: 10.285671695936548
2025-03-13 18:01:07,081 [INFO]: 	99p_search_speed_ms: 14.419545326381918
2025-03-13 18:01:07,081 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:07,081 [INFO]: 	nb vectors: 1920
2025-03-13 18:01:07,081 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:07,082 [INFO]: 	compression ratio: 0.9993085612108902
2025-03-13 18:01:07,082 [INFO]: }
2025-03-13 18:01:07,082 [INFO]: 	>>> Finished "Creating the index" in 47.0365 secs
2025-03-13 18:01:07,082 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0617 secs
2025-03-13 18:01:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 6027 [episode count 18/20]
[retrieval_preprocessing] for episode 26516 [episode count 19/20], we have num_retrieval=np.int64(1909) num_query=np.int64(96)
2025-03-13 18:01:08,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:08,846 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:08
2025-03-13 18:01:08,846 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1835.58it/s]
2025-03-13 18:01:08,870 [INFO]: There are 1909 embeddings of dim 49152
2025-03-13 18:01:08,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 18:01:08,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:08
2025-03-13 18:01:08,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:08,870 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:01:08,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:08,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:08,870 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:08
2025-03-13 18:01:08,870 [INFO]: 394.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:08,870 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:01:08,870 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:08
2025-03-13 18:01:08,870 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:08,870 [INFO]: 	Creating the index 03/13/2025, 18:01:08
2025-03-13 18:01:08,870 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:08
2025-03-13 18:01:08,871 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:01:08,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:08
2025-03-13 18:01:08,872 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:01:08,872 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.87it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.07it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.64it/s] 50%|█████     | 4/8 [00:00<00:00,  7.94it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.08it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.23it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.27it/s]100%|██████████| 8/8 [00:02<00:00,  1.83it/s]100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
2025-03-13 18:01:11,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:11
2025-03-13 18:01:35,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1828 secs
2025-03-13 18:01:35,400 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 18:01:35,400 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 18:01:59,814 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4139 secs
2025-03-13 18:01:59,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9444 secs
2025-03-13 18:01:59,816 [INFO]: {
2025-03-13 18:01:59,816 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:59,816 [INFO]: 	index_param: efSearch=247
2025-03-13 18:01:59,816 [INFO]: 	index_path: knn.index
2025-03-13 18:01:59,816 [INFO]: 	size in bytes: 375584410
2025-03-13 18:01:59,816 [INFO]: 	avg_search_speed_ms: 10.156344498748782
2025-03-13 18:01:59,816 [INFO]: 	99p_search_speed_ms: 14.387522526085375
2025-03-13 18:01:59,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:59,816 [INFO]: 	nb vectors: 1909
2025-03-13 18:01:59,816 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:59,816 [INFO]: 	compression ratio: 0.9993084430740882
2025-03-13 18:01:59,816 [INFO]: }
2025-03-13 18:01:59,816 [INFO]: 	>>> Finished "Creating the index" in 50.9458 secs
2025-03-13 18:01:59,816 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9703 secs
2025-03-13 18:02:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 26516 [episode count 19/20]
2025-03-13 18:02:00: [retrieval_preprocessing] finished for 5879622450_put_yellow_block_in_blue_cup [chosen_id count 8/196]
2025-03-13 18:02:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 5879622450_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 18:02:02: [retrieval_preprocessing] we have num_total=1985 embedding_dim=49152
[retrieval_preprocessing] for episode 64528 [episode count 0/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 18:02:03,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:04,131 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:04
2025-03-13 18:02:04,131 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2442.81it/s]
2025-03-13 18:02:04,154 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 18:02:04,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 18:02:04,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,155 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:04,155 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:02:04,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:04,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:04,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,155 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:04,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:02:04,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:04
2025-03-13 18:02:04,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:04,155 [INFO]: 	Creating the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:04
2025-03-13 18:02:04,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:02:04,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,156 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:02:04,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.97it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.79it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.83it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.50it/s]100%|██████████| 8/8 [00:02<00:00,  3.74it/s]
2025-03-13 18:02:06,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:06
2025-03-13 18:02:33,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7437 secs
2025-03-13 18:02:33,042 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 18:02:33,042 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 18:02:53,302 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2599 secs
2025-03-13 18:02:53,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1485 secs
2025-03-13 18:02:53,305 [INFO]: {
2025-03-13 18:02:53,305 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:53,305 [INFO]: 	index_param: efSearch=223
2025-03-13 18:02:53,305 [INFO]: 	index_path: knn.index
2025-03-13 18:02:53,305 [INFO]: 	size in bytes: 373420150
2025-03-13 18:02:53,305 [INFO]: 	avg_search_speed_ms: 10.03142857037619
2025-03-13 18:02:53,305 [INFO]: 	99p_search_speed_ms: 15.979488501325244
2025-03-13 18:02:53,305 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:53,305 [INFO]: 	nb vectors: 1898
2025-03-13 18:02:53,305 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:53,305 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 18:02:53,305 [INFO]: }
2025-03-13 18:02:53,305 [INFO]: 	>>> Finished "Creating the index" in 49.1501 secs
2025-03-13 18:02:53,305 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1737 secs
2025-03-13 18:02:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 64528 [episode count 0/20]
[retrieval_preprocessing] for episode 92700 [episode count 1/20], we have num_retrieval=np.int64(1889) num_query=np.int64(96)
2025-03-13 18:02:55,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:55,686 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:55
2025-03-13 18:02:55,686 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1081.28it/s]
2025-03-13 18:02:55,715 [INFO]: There are 1889 embeddings of dim 49152
2025-03-13 18:02:55,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:02:55,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:55
2025-03-13 18:02:55,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:55,716 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:02:55,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:55,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:02:55,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:55
2025-03-13 18:02:55,717 [INFO]: 389.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:55,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:02:55,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:55
2025-03-13 18:02:55,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:55,717 [INFO]: 	Creating the index 03/13/2025, 18:02:55
2025-03-13 18:02:55,718 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:55
2025-03-13 18:02:55,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:02:55,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:55
2025-03-13 18:02:55,721 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:02:55,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.24it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.01it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.78it/s] 50%|█████     | 4/8 [00:00<00:00,  8.16it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.05it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.81it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.72it/s]100%|██████████| 8/8 [00:02<00:00,  1.79it/s]100%|██████████| 8/8 [00:02<00:00,  3.34it/s]
2025-03-13 18:02:58,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:58
2025-03-13 18:03:25,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7612 secs
2025-03-13 18:03:25,886 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 18:03:25,886 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 18:03:41,812 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9264 secs
2025-03-13 18:03:41,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0932 secs
2025-03-13 18:03:41,814 [INFO]: {
2025-03-13 18:03:41,814 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:41,814 [INFO]: 	index_param: efSearch=152
2025-03-13 18:03:41,814 [INFO]: 	index_path: knn.index
2025-03-13 18:03:41,815 [INFO]: 	size in bytes: 371649490
2025-03-13 18:03:41,815 [INFO]: 	avg_search_speed_ms: 8.453182442726241
2025-03-13 18:03:41,815 [INFO]: 	99p_search_speed_ms: 13.841151543892922
2025-03-13 18:03:41,815 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:41,815 [INFO]: 	nb vectors: 1889
2025-03-13 18:03:41,815 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:41,815 [INFO]: 	compression ratio: 0.9993085474165456
2025-03-13 18:03:41,815 [INFO]: }
2025-03-13 18:03:41,815 [INFO]: 	>>> Finished "Creating the index" in 46.0972 secs
2025-03-13 18:03:41,815 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1285 secs
2025-03-13 18:03:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 92700 [episode count 1/20]
[retrieval_preprocessing] for episode 57391 [episode count 2/20], we have num_retrieval=np.int64(1885) num_query=np.int64(100)
2025-03-13 18:03:44,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:45,786 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:45
2025-03-13 18:03:45,786 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.40it/s]
2025-03-13 18:03:45,811 [INFO]: There are 1885 embeddings of dim 49152
2025-03-13 18:03:45,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:03:45,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:45
2025-03-13 18:03:45,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:45,811 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:03:45,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:45,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:45,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:45
2025-03-13 18:03:45,811 [INFO]: 389.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:45,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:03:45,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:45
2025-03-13 18:03:45,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:45,812 [INFO]: 	Creating the index 03/13/2025, 18:03:45
2025-03-13 18:03:45,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:45
2025-03-13 18:03:45,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:03:45,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:45
2025-03-13 18:03:45,813 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:03:45,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.84it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.56it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.57it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.99it/s]100%|██████████| 8/8 [00:02<00:00,  3.77it/s]
2025-03-13 18:03:47,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:47
2025-03-13 18:04:11,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6963 secs
2025-03-13 18:04:11,632 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 18:04:11,633 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 18:04:33,341 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7080 secs
2025-03-13 18:04:33,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5298 secs
2025-03-13 18:04:33,342 [INFO]: {
2025-03-13 18:04:33,343 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:33,343 [INFO]: 	index_param: efSearch=193
2025-03-13 18:04:33,343 [INFO]: 	index_path: knn.index
2025-03-13 18:04:33,343 [INFO]: 	size in bytes: 370862470
2025-03-13 18:04:33,343 [INFO]: 	avg_search_speed_ms: 8.687140306394763
2025-03-13 18:04:33,343 [INFO]: 	99p_search_speed_ms: 11.619183933362365
2025-03-13 18:04:33,343 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:33,343 [INFO]: 	nb vectors: 1885
2025-03-13 18:04:33,343 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:33,343 [INFO]: 	compression ratio: 0.9993086655546461
2025-03-13 18:04:33,343 [INFO]: }
2025-03-13 18:04:33,343 [INFO]: 	>>> Finished "Creating the index" in 47.5311 secs
2025-03-13 18:04:33,343 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5562 secs
2025-03-13 18:04:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 57391 [episode count 2/20]
[retrieval_preprocessing] for episode 18992 [episode count 3/20], we have num_retrieval=np.int64(1897) num_query=np.int64(88)
2025-03-13 18:04:35,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:35,397 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:35
2025-03-13 18:04:35,397 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.85it/s]
2025-03-13 18:04:35,421 [INFO]: There are 1897 embeddings of dim 49152
2025-03-13 18:04:35,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 18:04:35,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:35
2025-03-13 18:04:35,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:35,422 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:04:35,422 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:35,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:04:35,422 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:35
2025-03-13 18:04:35,422 [INFO]: 391.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:35,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:04:35,423 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:35
2025-03-13 18:04:35,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:35,423 [INFO]: 	Creating the index 03/13/2025, 18:04:35
2025-03-13 18:04:35,423 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:35
2025-03-13 18:04:35,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:04:35,426 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:35
2025-03-13 18:04:35,426 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:04:35,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.52it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.38it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.34it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.21it/s]100%|██████████| 8/8 [00:02<00:00,  3.40it/s]
2025-03-13 18:04:37,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:37
2025-03-13 18:05:04,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2007 secs
2025-03-13 18:05:04,991 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:05:04,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 18:05:27,628 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6365 secs
2025-03-13 18:05:28,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7796 secs
2025-03-13 18:05:28,206 [INFO]: {
2025-03-13 18:05:28,206 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:28,206 [INFO]: 	index_param: efSearch=231
2025-03-13 18:05:28,206 [INFO]: 	index_path: knn.index
2025-03-13 18:05:28,206 [INFO]: 	size in bytes: 373223410
2025-03-13 18:05:28,207 [INFO]: 	avg_search_speed_ms: 10.538701960685476
2025-03-13 18:05:28,207 [INFO]: 	99p_search_speed_ms: 13.65277266129851
2025-03-13 18:05:28,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:28,207 [INFO]: 	nb vectors: 1897
2025-03-13 18:05:28,207 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:28,207 [INFO]: 	compression ratio: 0.9993086339359045
2025-03-13 18:05:28,207 [INFO]: }
2025-03-13 18:05:28,207 [INFO]: 	>>> Finished "Creating the index" in 52.7839 secs
2025-03-13 18:05:28,207 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8103 secs
2025-03-13 18:05:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 18992 [episode count 3/20]
[retrieval_preprocessing] for episode 31289 [episode count 4/20], we have num_retrieval=np.int64(1863) num_query=np.int64(122)
2025-03-13 18:05:30,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:31,099 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:31
2025-03-13 18:05:31,099 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.87it/s]
2025-03-13 18:05:31,128 [INFO]: There are 1863 embeddings of dim 49152
2025-03-13 18:05:31,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 18:05:31,129 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:31,129 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:05:31,129 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:31,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:05:31,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,130 [INFO]: 384.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:31,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:05:31,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:31
2025-03-13 18:05:31,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:31,130 [INFO]: 	Creating the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,131 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:31
2025-03-13 18:05:31,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:05:31,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,133 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:05:31,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.02it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.39it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.85it/s] 50%|█████     | 4/8 [00:00<00:00,  6.92it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.04it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.15it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.70it/s]100%|██████████| 8/8 [00:02<00:00,  1.88it/s]100%|██████████| 8/8 [00:02<00:00,  3.36it/s]
2025-03-13 18:05:33,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:33
2025-03-13 18:05:56,377 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8551 secs
2025-03-13 18:05:56,378 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:05:56,378 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.43it/s] 50%|█████     | 2/4 [00:00<00:00,  4.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.48it/s]
2025-03-13 18:06:19,582 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2043 secs
2025-03-13 18:06:19,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4508 secs
2025-03-13 18:06:19,584 [INFO]: {
2025-03-13 18:06:19,584 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:19,584 [INFO]: 	index_param: efSearch=206
2025-03-13 18:06:19,584 [INFO]: 	index_path: knn.index
2025-03-13 18:06:19,584 [INFO]: 	size in bytes: 366534010
2025-03-13 18:06:19,584 [INFO]: 	avg_search_speed_ms: 8.152887859125943
2025-03-13 18:06:19,584 [INFO]: 	99p_search_speed_ms: 11.441332418471575
2025-03-13 18:06:19,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:19,584 [INFO]: 	nb vectors: 1863
2025-03-13 18:06:19,584 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:19,584 [INFO]: 	compression ratio: 0.9993089154264293
2025-03-13 18:06:19,584 [INFO]: }
2025-03-13 18:06:19,584 [INFO]: 	>>> Finished "Creating the index" in 48.4537 secs
2025-03-13 18:06:19,584 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4853 secs
2025-03-13 18:06:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 31289 [episode count 4/20]
[retrieval_preprocessing] for episode 27714 [episode count 5/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 18:06:21,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:21,681 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:21
2025-03-13 18:06:21,681 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2235.77it/s]
2025-03-13 18:06:21,704 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 18:06:21,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 18:06:21,704 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:21,704 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:06:21,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:21,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:21,704 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,704 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:21,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:06:21,704 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:21
2025-03-13 18:06:21,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:21,705 [INFO]: 	Creating the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:21
2025-03-13 18:06:21,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:06:21,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:21
2025-03-13 18:06:21,706 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:06:21,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.01it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.36it/s] 38%|███▊      | 3/8 [00:00<00:00,  6.99it/s] 50%|█████     | 4/8 [00:00<00:00,  7.25it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.47it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.86it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.01it/s]100%|██████████| 8/8 [00:02<00:00,  1.92it/s]100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
2025-03-13 18:06:24,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:24
2025-03-13 18:06:47,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3163 secs
2025-03-13 18:06:47,337 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:06:47,337 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 18:07:07,128 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7909 secs
2025-03-13 18:07:07,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4242 secs
2025-03-13 18:07:07,130 [INFO]: {
2025-03-13 18:07:07,130 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:07,130 [INFO]: 	index_param: efSearch=201
2025-03-13 18:07:07,130 [INFO]: 	index_path: knn.index
2025-03-13 18:07:07,130 [INFO]: 	size in bytes: 372829930
2025-03-13 18:07:07,130 [INFO]: 	avg_search_speed_ms: 10.435007737622847
2025-03-13 18:07:07,130 [INFO]: 	99p_search_speed_ms: 16.096857069060196
2025-03-13 18:07:07,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:07,130 [INFO]: 	nb vectors: 1895
2025-03-13 18:07:07,130 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:07,130 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 18:07:07,130 [INFO]: }
2025-03-13 18:07:07,130 [INFO]: 	>>> Finished "Creating the index" in 45.4257 secs
2025-03-13 18:07:07,130 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4488 secs
2025-03-13 18:07:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 27714 [episode count 5/20]
[retrieval_preprocessing] for episode 11846 [episode count 6/20], we have num_retrieval=np.int64(1899) num_query=np.int64(86)
2025-03-13 18:07:09,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:10,534 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:10
2025-03-13 18:07:10,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1957.21it/s]
2025-03-13 18:07:10,565 [INFO]: There are 1899 embeddings of dim 49152
2025-03-13 18:07:10,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 18:07:10,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:10
2025-03-13 18:07:10,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:10,566 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:07:10,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:10,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:07:10,567 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:10
2025-03-13 18:07:10,567 [INFO]: 391.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:10,567 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:07:10,567 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:10
2025-03-13 18:07:10,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:10,568 [INFO]: 	Creating the index 03/13/2025, 18:07:10
2025-03-13 18:07:10,568 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:10
2025-03-13 18:07:10,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:07:10,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:10
2025-03-13 18:07:10,571 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:07:10,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.08it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.77it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.75it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.45it/s]100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
2025-03-13 18:07:12,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:12
2025-03-13 18:07:36,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6732 secs
2025-03-13 18:07:36,543 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:07:36,543 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 50%|█████     | 2/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 18:07:51,233 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6903 secs
2025-03-13 18:07:51,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9351 secs
2025-03-13 18:07:51,507 [INFO]: {
2025-03-13 18:07:51,507 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:51,507 [INFO]: 	index_param: efSearch=201
2025-03-13 18:07:51,507 [INFO]: 	index_path: knn.index
2025-03-13 18:07:51,507 [INFO]: 	size in bytes: 373616890
2025-03-13 18:07:51,507 [INFO]: 	avg_search_speed_ms: 9.737954567256361
2025-03-13 18:07:51,507 [INFO]: 	99p_search_speed_ms: 13.008376816287637
2025-03-13 18:07:51,507 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:51,507 [INFO]: 	nb vectors: 1899
2025-03-13 18:07:51,507 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:51,507 [INFO]: 	compression ratio: 0.9993086554518453
2025-03-13 18:07:51,507 [INFO]: }
2025-03-13 18:07:51,507 [INFO]: 	>>> Finished "Creating the index" in 40.9396 secs
2025-03-13 18:07:51,507 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9737 secs
2025-03-13 18:07:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 11846 [episode count 6/20]
[retrieval_preprocessing] for episode 66173 [episode count 7/20], we have num_retrieval=np.int64(1836) num_query=np.int64(149)
2025-03-13 18:07:52,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:52,987 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:52
2025-03-13 18:07:52,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2025.26it/s]
2025-03-13 18:07:53,173 [INFO]: There are 1836 embeddings of dim 49152
2025-03-13 18:07:53,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1866 secs
2025-03-13 18:07:53,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:53
2025-03-13 18:07:53,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:53,174 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:07:53,174 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:53,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:53,174 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:53
2025-03-13 18:07:53,174 [INFO]: 378.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:53,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:53,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:53
2025-03-13 18:07:53,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:53,174 [INFO]: 	Creating the index 03/13/2025, 18:07:53
2025-03-13 18:07:53,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:53
2025-03-13 18:07:53,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:53,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:53
2025-03-13 18:07:53,175 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:07:53,175 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.78it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.32it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.60it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.00it/s]100%|██████████| 8/8 [00:02<00:00,  3.91it/s]
2025-03-13 18:07:55,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:55
2025-03-13 18:08:20,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2342 secs
2025-03-13 18:08:20,461 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:08:20,461 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:08:42,874 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4132 secs
2025-03-13 18:08:42,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7433 secs
2025-03-13 18:08:42,919 [INFO]: {
2025-03-13 18:08:42,919 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:42,919 [INFO]: 	index_param: efSearch=203
2025-03-13 18:08:42,919 [INFO]: 	index_path: knn.index
2025-03-13 18:08:42,919 [INFO]: 	size in bytes: 361221850
2025-03-13 18:08:42,919 [INFO]: 	avg_search_speed_ms: 10.617305968805056
2025-03-13 18:08:42,919 [INFO]: 	99p_search_speed_ms: 15.846323845908053
2025-03-13 18:08:42,920 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:42,920 [INFO]: 	nb vectors: 1836
2025-03-13 18:08:42,920 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:42,920 [INFO]: 	compression ratio: 0.9993091170979829
2025-03-13 18:08:42,920 [INFO]: }
2025-03-13 18:08:42,920 [INFO]: 	>>> Finished "Creating the index" in 49.7457 secs
2025-03-13 18:08:42,920 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9329 secs
2025-03-13 18:08:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 66173 [episode count 7/20]
[retrieval_preprocessing] for episode 74415 [episode count 8/20], we have num_retrieval=np.int64(1846) num_query=np.int64(139)
2025-03-13 18:08:44,622 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:44,896 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:44
2025-03-13 18:08:44,896 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.14it/s]
2025-03-13 18:08:44,921 [INFO]: There are 1846 embeddings of dim 49152
2025-03-13 18:08:44,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:08:44,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:44
2025-03-13 18:08:44,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:44,921 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:08:44,921 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:44,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:44,921 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:44
2025-03-13 18:08:44,921 [INFO]: 381.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:44,921 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:08:44,921 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:44
2025-03-13 18:08:44,921 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:44,922 [INFO]: 	Creating the index 03/13/2025, 18:08:44
2025-03-13 18:08:44,922 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:44
2025-03-13 18:08:44,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:08:44,923 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:44
2025-03-13 18:08:44,923 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:08:44,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.99it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.48it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.76it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.29it/s]100%|██████████| 8/8 [00:01<00:00,  4.14it/s]
2025-03-13 18:08:46,856 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:46
2025-03-13 18:09:11,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8272 secs
2025-03-13 18:09:11,684 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:09:11,684 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 18:09:31,084 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4003 secs
2025-03-13 18:09:31,086 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1633 secs
2025-03-13 18:09:31,086 [INFO]: {
2025-03-13 18:09:31,086 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:31,086 [INFO]: 	index_param: efSearch=201
2025-03-13 18:09:31,086 [INFO]: 	index_path: knn.index
2025-03-13 18:09:31,086 [INFO]: 	size in bytes: 363189250
2025-03-13 18:09:31,086 [INFO]: 	avg_search_speed_ms: 8.54662284394328
2025-03-13 18:09:31,086 [INFO]: 	99p_search_speed_ms: 11.144341074395925
2025-03-13 18:09:31,086 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:31,086 [INFO]: 	nb vectors: 1846
2025-03-13 18:09:31,086 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:31,086 [INFO]: 	compression ratio: 0.9993092251491474
2025-03-13 18:09:31,086 [INFO]: }
2025-03-13 18:09:31,086 [INFO]: 	>>> Finished "Creating the index" in 46.1649 secs
2025-03-13 18:09:31,086 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1908 secs
2025-03-13 18:09:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 74415 [episode count 8/20]
[retrieval_preprocessing] for episode 50353 [episode count 9/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 18:09:33,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:34,181 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:34
2025-03-13 18:09:34,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.01it/s]
2025-03-13 18:09:34,208 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 18:09:34,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:09:34,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:34
2025-03-13 18:09:34,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:34,208 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:09:34,208 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:34,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:34,208 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:34
2025-03-13 18:09:34,208 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:34,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:34,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:34
2025-03-13 18:09:34,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:34,209 [INFO]: 	Creating the index 03/13/2025, 18:09:34
2025-03-13 18:09:34,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:34
2025-03-13 18:09:34,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:09:34,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:34
2025-03-13 18:09:34,210 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:09:34,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.12it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.56it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.10it/s] 50%|█████     | 4/8 [00:00<00:00,  7.46it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.77it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.00it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.53it/s]100%|██████████| 8/8 [00:02<00:00,  1.95it/s]100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
2025-03-13 18:09:36,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:36
2025-03-13 18:09:59,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1651 secs
2025-03-13 18:09:59,648 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 18:09:59,648 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:10:15,833 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1853 secs
2025-03-13 18:10:15,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6254 secs
2025-03-13 18:10:15,835 [INFO]: {
2025-03-13 18:10:15,835 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:15,836 [INFO]: 	index_param: efSearch=190
2025-03-13 18:10:15,836 [INFO]: 	index_path: knn.index
2025-03-13 18:10:15,836 [INFO]: 	size in bytes: 372829930
2025-03-13 18:10:15,836 [INFO]: 	avg_search_speed_ms: 10.011746538094467
2025-03-13 18:10:15,836 [INFO]: 	99p_search_speed_ms: 13.072746144607663
2025-03-13 18:10:15,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:15,836 [INFO]: 	nb vectors: 1895
2025-03-13 18:10:15,836 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:15,836 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 18:10:15,836 [INFO]: }
2025-03-13 18:10:15,836 [INFO]: 	>>> Finished "Creating the index" in 41.6270 secs
2025-03-13 18:10:15,836 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6545 secs
2025-03-13 18:10:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 50353 [episode count 9/20]
[retrieval_preprocessing] for episode 95416 [episode count 10/20], we have num_retrieval=np.int64(1882) num_query=np.int64(103)
2025-03-13 18:10:17,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:18,033 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:18
2025-03-13 18:10:18,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.37it/s]
2025-03-13 18:10:18,060 [INFO]: There are 1882 embeddings of dim 49152
2025-03-13 18:10:18,061 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:10:18,061 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,061 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:18,062 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:10:18,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:18,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:10:18,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,062 [INFO]: 388.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:18,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:10:18,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:18
2025-03-13 18:10:18,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:18,063 [INFO]: 	Creating the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,063 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:18
2025-03-13 18:10:18,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:10:18,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,067 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:10:18,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.43it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.77it/s] 50%|█████     | 4/8 [00:00<00:00,  8.73it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.04it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.77it/s]100%|██████████| 8/8 [00:02<00:00,  2.10it/s]100%|██████████| 8/8 [00:02<00:00,  3.37it/s]
2025-03-13 18:10:20,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:20
2025-03-13 18:10:49,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7473 secs
2025-03-13 18:10:49,196 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 18:10:49,197 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s]
2025-03-13 18:11:08,249 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0526 secs
2025-03-13 18:11:08,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1845 secs
2025-03-13 18:11:08,251 [INFO]: {
2025-03-13 18:11:08,251 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:08,251 [INFO]: 	index_param: efSearch=191
2025-03-13 18:11:08,251 [INFO]: 	index_path: knn.index
2025-03-13 18:11:08,251 [INFO]: 	size in bytes: 370272250
2025-03-13 18:11:08,251 [INFO]: 	avg_search_speed_ms: 8.5595874406863
2025-03-13 18:11:08,251 [INFO]: 	99p_search_speed_ms: 11.714966972358523
2025-03-13 18:11:08,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:08,251 [INFO]: 	nb vectors: 1882
2025-03-13 18:11:08,251 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:08,251 [INFO]: 	compression ratio: 0.999308633039608
2025-03-13 18:11:08,251 [INFO]: }
2025-03-13 18:11:08,251 [INFO]: 	>>> Finished "Creating the index" in 50.1881 secs
2025-03-13 18:11:08,251 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2185 secs
2025-03-13 18:11:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 95416 [episode count 10/20]
[retrieval_preprocessing] for episode 43710 [episode count 11/20], we have num_retrieval=np.int64(1895) num_query=np.int64(90)
2025-03-13 18:11:09,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:10,240 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:10
2025-03-13 18:11:10,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 18:11:10,264 [INFO]: There are 1895 embeddings of dim 49152
2025-03-13 18:11:10,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:11:10,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:10
2025-03-13 18:11:10,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:10,265 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:11:10,265 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:10,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:11:10,265 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:10
2025-03-13 18:11:10,265 [INFO]: 391.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:10,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:11:10,266 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:10
2025-03-13 18:11:10,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:10,266 [INFO]: 	Creating the index 03/13/2025, 18:11:10
2025-03-13 18:11:10,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:10
2025-03-13 18:11:10,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:11:10,269 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:10
2025-03-13 18:11:10,269 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:11:10,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.08it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.50it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.48it/s] 88%|████████▊ | 7/8 [00:00<00:00, 11.04it/s]100%|██████████| 8/8 [00:01<00:00,  4.26it/s]
2025-03-13 18:11:12,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:12
2025-03-13 18:11:33,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.6241 secs
2025-03-13 18:11:33,775 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 18:11:33,776 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.63it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-13 18:11:57,736 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9602 secs
2025-03-13 18:11:57,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4691 secs
2025-03-13 18:11:57,739 [INFO]: {
2025-03-13 18:11:57,739 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:57,739 [INFO]: 	index_param: efSearch=245
2025-03-13 18:11:57,739 [INFO]: 	index_path: knn.index
2025-03-13 18:11:57,739 [INFO]: 	size in bytes: 372829930
2025-03-13 18:11:57,739 [INFO]: 	avg_search_speed_ms: 10.845911589354163
2025-03-13 18:11:57,739 [INFO]: 	99p_search_speed_ms: 21.25884004170075
2025-03-13 18:11:57,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:57,739 [INFO]: 	nb vectors: 1895
2025-03-13 18:11:57,739 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:57,739 [INFO]: 	compression ratio: 0.9993086123745484
2025-03-13 18:11:57,739 [INFO]: }
2025-03-13 18:11:57,739 [INFO]: 	>>> Finished "Creating the index" in 47.4731 secs
2025-03-13 18:11:57,739 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4988 secs
2025-03-13 18:11:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 43710 [episode count 11/20]
[retrieval_preprocessing] for episode 90814 [episode count 12/20], we have num_retrieval=np.int64(1894) num_query=np.int64(91)
2025-03-13 18:12:00,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:00,887 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:00
2025-03-13 18:12:00,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.21it/s]
2025-03-13 18:12:00,913 [INFO]: There are 1894 embeddings of dim 49152
2025-03-13 18:12:00,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:12:00,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:00
2025-03-13 18:12:00,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:00,914 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:12:00,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:00,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:00,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:00
2025-03-13 18:12:00,914 [INFO]: 390.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:00,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:12:00,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:00
2025-03-13 18:12:00,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:00,914 [INFO]: 	Creating the index 03/13/2025, 18:12:00
2025-03-13 18:12:00,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:00
2025-03-13 18:12:00,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:12:00,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:00
2025-03-13 18:12:00,915 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:12:00,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.51it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.21it/s] 50%|█████     | 4/8 [00:00<00:00,  8.45it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.74it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.99it/s] 88%|████████▊ | 7/8 [00:00<00:00,  9.16it/s]100%|██████████| 8/8 [00:02<00:00,  1.43it/s]100%|██████████| 8/8 [00:02<00:00,  2.78it/s]
2025-03-13 18:12:03,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:03
2025-03-13 18:12:27,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7508 secs
2025-03-13 18:12:27,547 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 18:12:27,547 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-13 18:12:48,108 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5609 secs
2025-03-13 18:12:48,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1948 secs
2025-03-13 18:12:48,110 [INFO]: {
2025-03-13 18:12:48,110 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:48,110 [INFO]: 	index_param: efSearch=195
2025-03-13 18:12:48,110 [INFO]: 	index_path: knn.index
2025-03-13 18:12:48,110 [INFO]: 	size in bytes: 372633190
2025-03-13 18:12:48,110 [INFO]: 	avg_search_speed_ms: 10.04105480925468
2025-03-13 18:12:48,110 [INFO]: 	99p_search_speed_ms: 15.870784840080887
2025-03-13 18:12:48,110 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:48,110 [INFO]: 	nb vectors: 1894
2025-03-13 18:12:48,110 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:48,110 [INFO]: 	compression ratio: 0.9993086015767946
2025-03-13 18:12:48,110 [INFO]: }
2025-03-13 18:12:48,110 [INFO]: 	>>> Finished "Creating the index" in 47.1962 secs
2025-03-13 18:12:48,110 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2229 secs
2025-03-13 18:12:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 90814 [episode count 12/20]
[retrieval_preprocessing] for episode 86212 [episode count 13/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 18:12:49,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:50,003 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:50
2025-03-13 18:12:50,004 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.33it/s]
2025-03-13 18:12:50,028 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 18:12:50,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:12:50,029 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:50
2025-03-13 18:12:50,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:50,030 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:12:50,030 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:50,030 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:12:50,030 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:50
2025-03-13 18:12:50,030 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:50,030 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:12:50,030 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:50
2025-03-13 18:12:50,030 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:50,031 [INFO]: 	Creating the index 03/13/2025, 18:12:50
2025-03-13 18:12:50,031 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:50
2025-03-13 18:12:50,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:12:50,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:50
2025-03-13 18:12:50,034 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:12:50,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.57it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.88it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.51it/s] 50%|█████     | 4/8 [00:00<00:00,  7.72it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.77it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.84it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.79it/s]100%|██████████| 8/8 [00:02<00:00,  1.89it/s]100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
2025-03-13 18:12:52,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:52
2025-03-13 18:13:19,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1708 secs
2025-03-13 18:13:19,521 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 18:13:19,522 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 18:13:40,832 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3103 secs
2025-03-13 18:13:40,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8003 secs
2025-03-13 18:13:40,834 [INFO]: {
2025-03-13 18:13:40,834 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:40,834 [INFO]: 	index_param: efSearch=155
2025-03-13 18:13:40,834 [INFO]: 	index_path: knn.index
2025-03-13 18:13:40,834 [INFO]: 	size in bytes: 373420150
2025-03-13 18:13:40,834 [INFO]: 	avg_search_speed_ms: 7.609249385051083
2025-03-13 18:13:40,834 [INFO]: 	99p_search_speed_ms: 11.400038991123427
2025-03-13 18:13:40,834 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:40,834 [INFO]: 	nb vectors: 1898
2025-03-13 18:13:40,834 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:40,834 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 18:13:40,834 [INFO]: }
2025-03-13 18:13:40,834 [INFO]: 	>>> Finished "Creating the index" in 50.8036 secs
2025-03-13 18:13:40,834 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8306 secs
2025-03-13 18:13:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 86212 [episode count 13/20]
[retrieval_preprocessing] for episode 12489 [episode count 14/20], we have num_retrieval=np.int64(1875) num_query=np.int64(110)
2025-03-13 18:13:41,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:42,634 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:42
2025-03-13 18:13:42,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1090.85it/s]
2025-03-13 18:13:42,659 [INFO]: There are 1875 embeddings of dim 49152
2025-03-13 18:13:42,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:13:42,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:42
2025-03-13 18:13:42,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:42,659 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:13:42,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:42,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:42,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:42
2025-03-13 18:13:42,659 [INFO]: 387.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:42,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:13:42,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:42
2025-03-13 18:13:42,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:42,659 [INFO]: 	Creating the index 03/13/2025, 18:13:42
2025-03-13 18:13:42,659 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:42
2025-03-13 18:13:42,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:13:42,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:42
2025-03-13 18:13:42,660 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:13:42,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.60it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.85it/s] 62%|██████▎   | 5/8 [00:00<00:00,  9.95it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.46it/s]100%|██████████| 8/8 [00:02<00:00,  3.91it/s]
2025-03-13 18:13:44,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:44
2025-03-13 18:14:06,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5233 secs
2025-03-13 18:14:06,235 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 18:14:06,235 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 18:14:23,507 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2717 secs
2025-03-13 18:14:23,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8484 secs
2025-03-13 18:14:23,509 [INFO]: {
2025-03-13 18:14:23,509 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:23,509 [INFO]: 	index_param: efSearch=214
2025-03-13 18:14:23,509 [INFO]: 	index_path: knn.index
2025-03-13 18:14:23,509 [INFO]: 	size in bytes: 368895010
2025-03-13 18:14:23,509 [INFO]: 	avg_search_speed_ms: 11.256764346159601
2025-03-13 18:14:23,509 [INFO]: 	99p_search_speed_ms: 24.262310694903135
2025-03-13 18:14:23,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:23,509 [INFO]: 	nb vectors: 1875
2025-03-13 18:14:23,509 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:23,509 [INFO]: 	compression ratio: 0.9993087193020042
2025-03-13 18:14:23,509 [INFO]: }
2025-03-13 18:14:23,509 [INFO]: 	>>> Finished "Creating the index" in 40.8496 secs
2025-03-13 18:14:23,509 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8754 secs
2025-03-13 18:14:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 12489 [episode count 14/20]
[retrieval_preprocessing] for episode 14546 [episode count 15/20], we have num_retrieval=np.int64(1878) num_query=np.int64(107)
2025-03-13 18:14:25,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:25,384 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:25
2025-03-13 18:14:25,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.78it/s]
2025-03-13 18:14:25,409 [INFO]: There are 1878 embeddings of dim 49152
2025-03-13 18:14:25,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:14:25,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:25
2025-03-13 18:14:25,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:25,410 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:14:25,410 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:25,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:25,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:25
2025-03-13 18:14:25,410 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:25,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:14:25,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:25
2025-03-13 18:14:25,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:25,410 [INFO]: 	Creating the index 03/13/2025, 18:14:25
2025-03-13 18:14:25,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:25
2025-03-13 18:14:25,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:14:25,411 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:25
2025-03-13 18:14:25,411 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:14:25,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.70it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.87it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.39it/s] 50%|█████     | 4/8 [00:00<00:00,  7.57it/s] 62%|██████▎   | 5/8 [00:00<00:00,  7.64it/s] 75%|███████▌  | 6/8 [00:00<00:00,  7.69it/s] 88%|████████▊ | 7/8 [00:00<00:00,  7.80it/s]100%|██████████| 8/8 [00:02<00:00,  1.57it/s]100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
2025-03-13 18:14:28,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:28
2025-03-13 18:14:54,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9462 secs
2025-03-13 18:14:54,020 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:14:54,020 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 18:15:19,396 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3757 secs
2025-03-13 18:15:19,468 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0563 secs
2025-03-13 18:15:19,468 [INFO]: {
2025-03-13 18:15:19,468 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:19,468 [INFO]: 	index_param: efSearch=240
2025-03-13 18:15:19,468 [INFO]: 	index_path: knn.index
2025-03-13 18:15:19,468 [INFO]: 	size in bytes: 369485230
2025-03-13 18:15:19,468 [INFO]: 	avg_search_speed_ms: 10.007086860200575
2025-03-13 18:15:19,468 [INFO]: 	99p_search_speed_ms: 15.151884378865331
2025-03-13 18:15:19,468 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:19,468 [INFO]: 	nb vectors: 1878
2025-03-13 18:15:19,469 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:19,469 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-13 18:15:19,469 [INFO]: }
2025-03-13 18:15:19,469 [INFO]: 	>>> Finished "Creating the index" in 54.0587 secs
2025-03-13 18:15:19,469 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0846 secs
2025-03-13 18:15:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 14546 [episode count 15/20]
[retrieval_preprocessing] for episode 87305 [episode count 16/20], we have num_retrieval=np.int64(1892) num_query=np.int64(93)
2025-03-13 18:15:21,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:21,571 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:21
2025-03-13 18:15:21,571 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-13 18:15:21,594 [INFO]: There are 1892 embeddings of dim 49152
2025-03-13 18:15:21,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:15:21,595 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:21
2025-03-13 18:15:21,595 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:21,595 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:15:21,595 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:21,595 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:21,595 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:21
2025-03-13 18:15:21,595 [INFO]: 390.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:21,595 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:21,595 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:21
2025-03-13 18:15:21,595 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:21,595 [INFO]: 	Creating the index 03/13/2025, 18:15:21
2025-03-13 18:15:21,595 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:21
2025-03-13 18:15:21,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:15:21,597 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:21
2025-03-13 18:15:21,597 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:15:21,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.23it/s] 25%|██▌       | 2/8 [00:00<00:00,  6.87it/s] 38%|███▊      | 3/8 [00:00<00:00,  7.57it/s] 50%|█████     | 4/8 [00:00<00:00,  8.06it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.28it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.44it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.53it/s]100%|██████████| 8/8 [00:02<00:00,  2.01it/s]100%|██████████| 8/8 [00:02<00:00,  3.65it/s]
2025-03-13 18:15:23,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:23
2025-03-13 18:15:51,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4602 secs
2025-03-13 18:15:51,252 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 18:15:51,252 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.48it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 18:16:09,149 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8976 secs
2025-03-13 18:16:09,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2082 secs
2025-03-13 18:16:09,805 [INFO]: {
2025-03-13 18:16:09,805 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:09,805 [INFO]: 	index_param: efSearch=187
2025-03-13 18:16:09,805 [INFO]: 	index_path: knn.index
2025-03-13 18:16:09,805 [INFO]: 	size in bytes: 372239710
2025-03-13 18:16:09,805 [INFO]: 	avg_search_speed_ms: 9.479952648379156
2025-03-13 18:16:09,805 [INFO]: 	99p_search_speed_ms: 12.213462311774494
2025-03-13 18:16:09,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:09,806 [INFO]: 	nb vectors: 1892
2025-03-13 18:16:09,806 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:09,806 [INFO]: 	compression ratio: 0.9993085799470454
2025-03-13 18:16:09,806 [INFO]: }
2025-03-13 18:16:09,806 [INFO]: 	>>> Finished "Creating the index" in 48.2104 secs
2025-03-13 18:16:09,806 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2347 secs
2025-03-13 18:16:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 87305 [episode count 16/20]
[retrieval_preprocessing] for episode 50974 [episode count 17/20], we have num_retrieval=np.int64(1910) num_query=np.int64(75)
2025-03-13 18:16:11,551 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:11,893 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:11
2025-03-13 18:16:11,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2267.19it/s]
2025-03-13 18:16:11,916 [INFO]: There are 1910 embeddings of dim 49152
2025-03-13 18:16:11,917 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:16:11,917 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:11
2025-03-13 18:16:11,917 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:11,917 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:16:11,918 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:11,918 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:16:11,918 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:11
2025-03-13 18:16:11,919 [INFO]: 394.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:11,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:16:11,919 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:11
2025-03-13 18:16:11,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:11,920 [INFO]: 	Creating the index 03/13/2025, 18:16:11
2025-03-13 18:16:11,920 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:11
2025-03-13 18:16:11,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:16:11,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:11
2025-03-13 18:16:11,924 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:16:11,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  6.70it/s] 38%|███▊      | 3/8 [00:00<00:00,  9.38it/s] 62%|██████▎   | 5/8 [00:00<00:00, 10.14it/s] 88%|████████▊ | 7/8 [00:00<00:00, 10.65it/s]100%|██████████| 8/8 [00:01<00:00,  4.27it/s]
2025-03-13 18:16:13,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:13
2025-03-13 18:16:37,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3067 secs
2025-03-13 18:16:37,109 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 18:16:37,109 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 18:16:58,330 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2208 secs
2025-03-13 18:16:58,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4080 secs
2025-03-13 18:16:58,332 [INFO]: {
2025-03-13 18:16:58,332 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:58,332 [INFO]: 	index_param: efSearch=249
2025-03-13 18:16:58,332 [INFO]: 	index_path: knn.index
2025-03-13 18:16:58,332 [INFO]: 	size in bytes: 375781150
2025-03-13 18:16:58,332 [INFO]: 	avg_search_speed_ms: 10.09196711057566
2025-03-13 18:16:58,332 [INFO]: 	99p_search_speed_ms: 12.97636455856264
2025-03-13 18:16:58,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:58,332 [INFO]: 	nb vectors: 1910
2025-03-13 18:16:58,332 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:58,332 [INFO]: 	compression ratio: 0.9993084538700251
2025-03-13 18:16:58,332 [INFO]: }
2025-03-13 18:16:58,332 [INFO]: 	>>> Finished "Creating the index" in 46.4123 secs
2025-03-13 18:16:58,332 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4391 secs
2025-03-13 18:16:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 50974 [episode count 17/20]
[retrieval_preprocessing] for episode 37671 [episode count 18/20], we have num_retrieval=np.int64(1890) num_query=np.int64(95)
2025-03-13 18:16:59,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:59,964 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:59
2025-03-13 18:16:59,964 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.97it/s]
2025-03-13 18:16:59,994 [INFO]: There are 1890 embeddings of dim 49152
2025-03-13 18:16:59,994 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:16:59,994 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:59
2025-03-13 18:16:59,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:59,995 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:16:59,995 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:59,995 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:16:59,995 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:59
2025-03-13 18:16:59,995 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:59,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:16:59,996 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:59
2025-03-13 18:16:59,996 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:59,996 [INFO]: 	Creating the index 03/13/2025, 18:16:59
2025-03-13 18:16:59,996 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:59
2025-03-13 18:16:59,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:16:59,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:59
2025-03-13 18:16:59,999 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:16:59,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.86it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.36it/s] 38%|███▊      | 3/8 [00:00<00:00,  8.01it/s] 50%|█████     | 4/8 [00:00<00:00,  8.50it/s] 62%|██████▎   | 5/8 [00:00<00:00,  8.67it/s] 75%|███████▌  | 6/8 [00:00<00:00,  8.79it/s] 88%|████████▊ | 7/8 [00:00<00:00,  8.85it/s]100%|██████████| 8/8 [00:02<00:00,  1.87it/s]100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
2025-03-13 18:17:02,275 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:02
2025-03-13 18:17:31,298 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0232 secs
2025-03-13 18:17:31,299 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:17:31,299 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:17:47,583 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2843 secs
2025-03-13 18:17:47,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5863 secs
2025-03-13 18:17:47,585 [INFO]: {
2025-03-13 18:17:47,585 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:47,585 [INFO]: 	index_param: efSearch=174
2025-03-13 18:17:47,585 [INFO]: 	index_path: knn.index
2025-03-13 18:17:47,585 [INFO]: 	size in bytes: 371846230
2025-03-13 18:17:47,585 [INFO]: 	avg_search_speed_ms: 8.905661843247705
2025-03-13 18:17:47,585 [INFO]: 	99p_search_speed_ms: 11.74206887371838
2025-03-13 18:17:47,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:47,585 [INFO]: 	nb vectors: 1890
2025-03-13 18:17:47,585 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:47,585 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-13 18:17:47,585 [INFO]: }
2025-03-13 18:17:47,585 [INFO]: 	>>> Finished "Creating the index" in 47.5895 secs
2025-03-13 18:17:47,585 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6216 secs
2025-03-13 18:17:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 37671 [episode count 18/20]
[retrieval_preprocessing] for episode 87860 [episode count 19/20], we have num_retrieval=np.int64(1898) num_query=np.int64(87)
2025-03-13 18:17:49,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:49,622 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:49
2025-03-13 18:17:49,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 18:17:49,646 [INFO]: There are 1898 embeddings of dim 49152
2025-03-13 18:17:49,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:17:49,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:49
2025-03-13 18:17:49,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:49,646 [INFO]: 		-> Add: 1.0 seconds
2025-03-13 18:17:49,646 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:49,646 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:49,646 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:49
2025-03-13 18:17:49,646 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:49,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:17:49,647 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:49
2025-03-13 18:17:49,647 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:49,647 [INFO]: 	Creating the index 03/13/2025, 18:17:49
2025-03-13 18:17:49,647 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:49
2025-03-13 18:17:49,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:17:49,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:49
2025-03-13 18:17:49,648 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 18:17:49,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:01,  5.18it/s] 25%|██▌       | 2/8 [00:00<00:00,  7.20it/s] 50%|█████     | 4/8 [00:00<00:00,  8.91it/s] 75%|███████▌  | 6/8 [00:00<00:00,  9.74it/s]100%|██████████| 8/8 [00:02<00:00,  2.82it/s]100%|██████████| 8/8 [00:02<00:00,  3.76it/s]
2025-03-13 18:17:51,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:51
2025-03-13 18:18:14,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7120 secs
2025-03-13 18:18:14,492 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 18:18:14,492 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 18:18:40,422 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9300 secs
2025-03-13 18:18:40,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7765 secs
2025-03-13 18:18:40,425 [INFO]: {
2025-03-13 18:18:40,425 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:40,425 [INFO]: 	index_param: efSearch=190
2025-03-13 18:18:40,425 [INFO]: 	index_path: knn.index
2025-03-13 18:18:40,425 [INFO]: 	size in bytes: 373420150
2025-03-13 18:18:40,425 [INFO]: 	avg_search_speed_ms: 8.216892460348879
2025-03-13 18:18:40,425 [INFO]: 	99p_search_speed_ms: 11.171235721558332
2025-03-13 18:18:40,425 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:40,425 [INFO]: 	nb vectors: 1898
2025-03-13 18:18:40,425 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:40,425 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-13 18:18:40,425 [INFO]: }
2025-03-13 18:18:40,425 [INFO]: 	>>> Finished "Creating the index" in 50.7782 secs
2025-03-13 18:18:40,425 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8027 secs
2025-03-13 18:18:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 87860 [episode count 19/20]
2025-03-13 18:18:41: [retrieval_preprocessing] finished for 5879622450_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 18:18:41: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
