Using cache found in /home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
2025-03-13 17:07:44: [embed_episodes] skipping episode 2560 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 87306 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 28438 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 48552 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 86442 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 80429 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 67887 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 12467 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 23993 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 16059 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 15814 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 10698 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 62154 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35404 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 73162 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 90453 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 91095 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 733 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 85473 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 124 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 6078642573_put_marker_in_mug [chosen_id count 0/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 54279 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 58383 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 49173 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 52759 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 23578 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 19502 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 20559 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 91716 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 90720 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 88686 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 20620 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 72947 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 40181 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 7939 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 52472 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 36259 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 45475 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 65965 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 79264 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 11175 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 6093644330_Pour_Jug_into_Red_Bowl [chosen_id count 1/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 7179 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 56846 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 4134 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 57380 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 14396 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35411 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 15458 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 42087 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 34437 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 91408 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 11025 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 77649 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 79710 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 11625 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 34666 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 2955 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 5065 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 5406 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 57637 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 92965 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 6284002987_turn_on_light_switch [chosen_id count 2/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 66593 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 64052 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 36406 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 85079 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 60559 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 73362 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 86662 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 30328 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35939 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 10916 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 67265 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 43203 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 37340 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 20914 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 41977 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 29063 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 51531 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 6995 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 81237 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 42843 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 6284002987_turn_off_light_switch [chosen_id count 3/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 21890 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 5763 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 74378 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35212 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 24461 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 92044 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35216 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 52882 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 83218 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 85528 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 39710 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 39075 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 50085 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 58153 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 40875 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 20397 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 45995 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 26799 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 57133 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 77741 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 6357288647_put_lid_on_pot [chosen_id count 4/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 67094 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 92220 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 36426 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 66127 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 26171 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 31361 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 18133 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 70893 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 78068 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 22847 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 40288 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 69400 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 38188 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 77653 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 59280 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 77817 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 46530 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 52164 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 19399 [episode count 18/20]
2025-03-13 17:07:48: [embed_episodes] embedded episode 13306 with 187 steps [episode count 19/20]
2025-03-13 17:07:48: [embed_episodes] finished embedding all episodes for 6370153372_put_lid_on_can [chosen_id count 5/196]
2025-03-13 17:07:48: [embed_episodes] skipping episode 54786 [episode count 0/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 89618 [episode count 1/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 2080 [episode count 2/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 27686 [episode count 3/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 78887 [episode count 4/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 25146 [episode count 5/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 52802 [episode count 6/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 12908 [episode count 7/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 27253 [episode count 8/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 22149 [episode count 9/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 76975 [episode count 10/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 27333 [episode count 11/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 9445 [episode count 12/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 92926 [episode count 13/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 61731 [episode count 14/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 78118 [episode count 15/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 54581 [episode count 16/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 7512 [episode count 17/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 69464 [episode count 18/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 47469 [episode count 19/20]
2025-03-13 17:07:48: [embed_episodes] finished embedding all episodes for 6486961974_put_ropes_in_blue_box [chosen_id count 6/196]
2025-03-13 17:07:48: [embed_episodes] skipping episode 6223 [episode count 0/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 2128 [episode count 1/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 20058 [episode count 2/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 91747 [episode count 3/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 61044 [episode count 4/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 35449 [episode count 5/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 67197 [episode count 6/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 65150 [episode count 7/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 74419 [episode count 8/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 25875 [episode count 9/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 13691 [episode count 10/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 64408 [episode count 11/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 33177 [episode count 12/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 70554 [episode count 13/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 53675 [episode count 14/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 44463 [episode count 15/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 27065 [episode count 16/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 35776 [episode count 17/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 26939 [episode count 18/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 42812 [episode count 19/20]
2025-03-13 17:07:48: [embed_episodes] finished embedding all episodes for 6486961974_pick_up_ropes_and_put_in_box [chosen_id count 7/196]
2025-03-13 17:07:48: [embed_episodes] skipping episode 75918 [episode count 0/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 8366 [episode count 1/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 18608 [episode count 2/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 57572 [episode count 3/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 26846 [episode count 4/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 33104 [episode count 5/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 27028 [episode count 6/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 16944 [episode count 7/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 47677 [episode count 8/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 62114 [episode count 9/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 68331 [episode count 10/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 54037 [episode count 11/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 4898 [episode count 12/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 60267 [episode count 13/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 39789 [episode count 14/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 17520 [episode count 15/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 9679 [episode count 16/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 62937 [episode count 17/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 60470 [episode count 18/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 63362 [episode count 19/20]
2025-03-13 17:07:48: [embed_episodes] finished embedding all episodes for 6498288010_turn_off_extension_cord [chosen_id count 8/196]
2025-03-13 17:07:48: [embed_episodes] skipping episode 29698 [episode count 0/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 16905 [episode count 1/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 95241 [episode count 2/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 15891 [episode count 3/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 26660 [episode count 4/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 567 [episode count 5/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 49771 [episode count 6/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 20123 [episode count 7/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 8861 [episode count 8/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 42665 [episode count 9/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 28360 [episode count 10/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 58065 [episode count 11/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 32990 [episode count 12/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 55523 [episode count 13/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 17641 [episode count 14/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 52457 [episode count 15/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 91369 [episode count 16/20]
2025-03-13 17:07:48: [embed_episodes] skipping episode 94465 [episode count 17/20]
2025-03-13 17:07:51: [embed_episodes] embedded episode 41284 with 96 steps [episode count 18/20]
2025-03-13 17:07:53: [embed_episodes] embedded episode 59717 with 88 steps [episode count 19/20]
2025-03-13 17:07:53: [embed_episodes] finished embedding all episodes for 65137982_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 17:07:53: [embed_episodes] done!
2025-03-13 17:07:53: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 17:07:56: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6078642573_put_marker_in_mug [chosen_id count 0/196]
2025-03-13 17:07:56: [retrieval_preprocessing] we have num_total=5013 embedding_dim=49152
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 2560 [episode count 0/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 87306 [episode count 1/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 28438 [episode count 2/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 48552 [episode count 3/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 86442 [episode count 4/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 80429 [episode count 5/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 67887 [episode count 6/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 12467 [episode count 7/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 23993 [episode count 8/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 16059 [episode count 9/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 15814 [episode count 10/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 10698 [episode count 11/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 62154 [episode count 12/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 35404 [episode count 13/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 73162 [episode count 14/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 90453 [episode count 15/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 91095 [episode count 16/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 733 [episode count 17/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 85473 [episode count 18/20]
2025-03-13 17:07:56: [retrieval_preprocessing] skipping episode 124 [episode count 19/20]
2025-03-13 17:07:56: [retrieval_preprocessing] finished for 6078642573_put_marker_in_mug [chosen_id count 0/196]
2025-03-13 17:08:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6093644330_Pour_Jug_into_Red_Bowl [chosen_id count 1/196]
2025-03-13 17:08:01: [retrieval_preprocessing] we have num_total=6872 embedding_dim=49152
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 54279 [episode count 0/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 58383 [episode count 1/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 49173 [episode count 2/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 52759 [episode count 3/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 23578 [episode count 4/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 19502 [episode count 5/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 20559 [episode count 6/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 91716 [episode count 7/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 90720 [episode count 8/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 88686 [episode count 9/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 20620 [episode count 10/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 72947 [episode count 11/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 40181 [episode count 12/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 7939 [episode count 13/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 52472 [episode count 14/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 36259 [episode count 15/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 45475 [episode count 16/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 65965 [episode count 17/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 79264 [episode count 18/20]
2025-03-13 17:08:01: [retrieval_preprocessing] skipping episode 11175 [episode count 19/20]
2025-03-13 17:08:01: [retrieval_preprocessing] finished for 6093644330_Pour_Jug_into_Red_Bowl [chosen_id count 1/196]
2025-03-13 17:08:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6284002987_turn_on_light_switch [chosen_id count 2/196]
2025-03-13 17:08:02: [retrieval_preprocessing] we have num_total=2796 embedding_dim=49152
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 7179 [episode count 0/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 56846 [episode count 1/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 4134 [episode count 2/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 57380 [episode count 3/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 14396 [episode count 4/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 35411 [episode count 5/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 15458 [episode count 6/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 42087 [episode count 7/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 34437 [episode count 8/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 91408 [episode count 9/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 11025 [episode count 10/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 77649 [episode count 11/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 79710 [episode count 12/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 11625 [episode count 13/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 34666 [episode count 14/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 2955 [episode count 15/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 5065 [episode count 16/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 5406 [episode count 17/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 57637 [episode count 18/20]
2025-03-13 17:08:02: [retrieval_preprocessing] skipping episode 92965 [episode count 19/20]
2025-03-13 17:08:02: [retrieval_preprocessing] finished for 6284002987_turn_on_light_switch [chosen_id count 2/196]
2025-03-13 17:08:04: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6284002987_turn_off_light_switch [chosen_id count 3/196]
2025-03-13 17:08:04: [retrieval_preprocessing] we have num_total=2815 embedding_dim=49152
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 66593 [episode count 0/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 64052 [episode count 1/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 36406 [episode count 2/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 85079 [episode count 3/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 60559 [episode count 4/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 73362 [episode count 5/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 86662 [episode count 6/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 30328 [episode count 7/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 35939 [episode count 8/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 10916 [episode count 9/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 67265 [episode count 10/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 43203 [episode count 11/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 37340 [episode count 12/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 20914 [episode count 13/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 41977 [episode count 14/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 29063 [episode count 15/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 51531 [episode count 16/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 6995 [episode count 17/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 81237 [episode count 18/20]
2025-03-13 17:08:04: [retrieval_preprocessing] skipping episode 42843 [episode count 19/20]
2025-03-13 17:08:04: [retrieval_preprocessing] finished for 6284002987_turn_off_light_switch [chosen_id count 3/196]
2025-03-13 17:08:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6357288647_put_lid_on_pot [chosen_id count 4/196]
2025-03-13 17:08:06: [retrieval_preprocessing] we have num_total=4788 embedding_dim=49152
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 21890 [episode count 0/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 5763 [episode count 1/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 74378 [episode count 2/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 35212 [episode count 3/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 24461 [episode count 4/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 92044 [episode count 5/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 35216 [episode count 6/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 52882 [episode count 7/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 83218 [episode count 8/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 85528 [episode count 9/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 39710 [episode count 10/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 39075 [episode count 11/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 50085 [episode count 12/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 58153 [episode count 13/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 40875 [episode count 14/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 20397 [episode count 15/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 45995 [episode count 16/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 26799 [episode count 17/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 57133 [episode count 18/20]
2025-03-13 17:08:06: [retrieval_preprocessing] skipping episode 77741 [episode count 19/20]
2025-03-13 17:08:06: [retrieval_preprocessing] finished for 6357288647_put_lid_on_pot [chosen_id count 4/196]
2025-03-13 17:08:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6370153372_put_lid_on_can [chosen_id count 5/196]
2025-03-13 17:08:08: [retrieval_preprocessing] we have num_total=3738 embedding_dim=49152
[retrieval_preprocessing] for episode 67094 [episode count 0/20], we have num_retrieval=np.int64(3549) num_query=np.int64(189)
2025-03-13 17:08:09,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:10,378 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:10
2025-03-13 17:08:10,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 595.11it/s]
2025-03-13 17:08:10,416 [INFO]: There are 3549 embeddings of dim 49152
2025-03-13 17:08:10,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 17:08:10,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:10
2025-03-13 17:08:10,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:10,416 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:08:10,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:10,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:08:10,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:10
2025-03-13 17:08:10,417 [INFO]: 732.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:10,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-13 17:08:10,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:10
2025-03-13 17:08:10,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:10,418 [INFO]: 	Creating the index 03/13/2025, 17:08:10
2025-03-13 17:08:10,418 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:10
2025-03-13 17:08:10,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:08:10,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:10
2025-03-13 17:08:10,420 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:08:10,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.76it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.35it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.61it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.89it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.01it/s] 50%|█████     | 7/14 [00:00<00:00,  8.18it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.29it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.46it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.21it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.14it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.90it/s]100%|██████████| 14/14 [00:04<00:00,  1.00it/s]100%|██████████| 14/14 [00:04<00:00,  2.91it/s]
2025-03-13 17:08:15,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:15
2025-03-13 17:09:04,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7676 secs
2025-03-13 17:09:04,005 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:09:04,005 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.06it/s] 50%|█████     | 2/4 [00:00<00:00,  4.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.19it/s]
2025-03-13 17:09:27,766 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7608 secs
2025-03-13 17:09:27,769 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3495 secs
2025-03-13 17:09:27,770 [INFO]: {
2025-03-13 17:09:27,770 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:27,770 [INFO]: 	index_param: efSearch=207
2025-03-13 17:09:27,770 [INFO]: 	index_path: knn.index
2025-03-13 17:09:27,770 [INFO]: 	size in bytes: 698243950
2025-03-13 17:09:27,770 [INFO]: 	avg_search_speed_ms: 10.881807379702247
2025-03-13 17:09:27,770 [INFO]: 	99p_search_speed_ms: 18.123865779489268
2025-03-13 17:09:27,770 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:27,770 [INFO]: 	nb vectors: 3549
2025-03-13 17:09:27,770 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:27,770 [INFO]: 	compression ratio: 0.9993094705654091
2025-03-13 17:09:27,770 [INFO]: }
2025-03-13 17:09:27,770 [INFO]: 	>>> Finished "Creating the index" in 77.3519 secs
2025-03-13 17:09:27,770 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3918 secs
2025-03-13 17:09:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 67094 [episode count 0/20]
[retrieval_preprocessing] for episode 92220 [episode count 1/20], we have num_retrieval=np.int64(3561) num_query=np.int64(177)
2025-03-13 17:09:30,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:31,606 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:31
2025-03-13 17:09:31,606 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 697.08it/s]
2025-03-13 17:09:31,637 [INFO]: There are 3561 embeddings of dim 49152
2025-03-13 17:09:31,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:09:31,638 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:31
2025-03-13 17:09:31,638 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:31,638 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:09:31,639 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:31,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:09:31,639 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:31
2025-03-13 17:09:31,639 [INFO]: 734.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:31,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:09:31,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:31
2025-03-13 17:09:31,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:31,640 [INFO]: 	Creating the index 03/13/2025, 17:09:31
2025-03-13 17:09:31,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:31
2025-03-13 17:09:31,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:09:31,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:31
2025-03-13 17:09:31,644 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:09:31,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.28it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.91it/s] 20%|██        | 3/15 [00:00<00:01,  6.72it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.30it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.54it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.85it/s] 67%|██████▋   | 10/15 [00:01<00:00, 13.47it/s] 80%|████████  | 12/15 [00:01<00:00, 15.08it/s] 93%|█████████▎| 14/15 [00:01<00:00, 16.14it/s]100%|██████████| 15/15 [00:04<00:00,  3.43it/s]
2025-03-13 17:09:36,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:36
2025-03-13 17:10:17,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2099 secs
2025-03-13 17:10:17,240 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:10:17,240 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.94it/s] 50%|█████     | 2/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 17:11:08,877 [INFO]: 	>>> Finished "Compute fast metrics" in 51.6369 secs
2025-03-13 17:11:08,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.2357 secs
2025-03-13 17:11:08,880 [INFO]: {
2025-03-13 17:11:08,880 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:08,880 [INFO]: 	index_param: efSearch=164
2025-03-13 17:11:08,880 [INFO]: 	index_path: knn.index
2025-03-13 17:11:08,880 [INFO]: 	size in bytes: 700604830
2025-03-13 17:11:08,880 [INFO]: 	avg_search_speed_ms: 8.15786205275443
2025-03-13 17:11:08,880 [INFO]: 	99p_search_speed_ms: 13.280842395033687
2025-03-13 17:11:08,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:08,880 [INFO]: 	nb vectors: 3561
2025-03-13 17:11:08,880 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:08,880 [INFO]: 	compression ratio: 0.9993095365899776
2025-03-13 17:11:08,880 [INFO]: }
2025-03-13 17:11:08,880 [INFO]: 	>>> Finished "Creating the index" in 97.2397 secs
2025-03-13 17:11:08,880 [INFO]: >>> Finished "Launching the whole pipeline" in 97.2740 secs
2025-03-13 17:11:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 92220 [episode count 1/20]
[retrieval_preprocessing] for episode 36426 [episode count 2/20], we have num_retrieval=np.int64(3521) num_query=np.int64(217)
2025-03-13 17:11:13,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:14,298 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:14
2025-03-13 17:11:14,298 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2162.01it/s]
2025-03-13 17:11:14,324 [INFO]: There are 3521 embeddings of dim 49152
2025-03-13 17:11:14,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:11:14,325 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:14
2025-03-13 17:11:14,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:14,325 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:11:14,325 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:14,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:11:14,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:14
2025-03-13 17:11:14,326 [INFO]: 726.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:14,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:11:14,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:14
2025-03-13 17:11:14,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:14,326 [INFO]: 	Creating the index 03/13/2025, 17:11:14
2025-03-13 17:11:14,326 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:14
2025-03-13 17:11:14,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:11:14,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:14
2025-03-13 17:11:14,329 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:11:14,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.51it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.03it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.18it/s] 50%|█████     | 7/14 [00:00<00:00, 11.76it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.35it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.62it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.68it/s]100%|██████████| 14/14 [00:04<00:00,  3.28it/s]
2025-03-13 17:11:18,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:18
2025-03-13 17:11:58,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1503 secs
2025-03-13 17:11:58,763 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 17:11:58,764 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 17:12:23,607 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8419 secs
2025-03-13 17:12:23,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2833 secs
2025-03-13 17:12:23,613 [INFO]: {
2025-03-13 17:12:23,613 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:23,613 [INFO]: 	index_param: efSearch=154
2025-03-13 17:12:23,613 [INFO]: 	index_path: knn.index
2025-03-13 17:12:23,613 [INFO]: 	size in bytes: 692735050
2025-03-13 17:12:23,613 [INFO]: 	avg_search_speed_ms: 10.19975896255435
2025-03-13 17:12:23,613 [INFO]: 	99p_search_speed_ms: 21.205276949331168
2025-03-13 17:12:23,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:23,613 [INFO]: 	nb vectors: 3521
2025-03-13 17:12:23,613 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:23,613 [INFO]: 	compression ratio: 0.9993095744180982
2025-03-13 17:12:23,613 [INFO]: }
2025-03-13 17:12:23,613 [INFO]: 	>>> Finished "Creating the index" in 69.2866 secs
2025-03-13 17:12:23,613 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3150 secs
2025-03-13 17:12:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 36426 [episode count 2/20]
[retrieval_preprocessing] for episode 66127 [episode count 3/20], we have num_retrieval=np.int64(3583) num_query=np.int64(155)
2025-03-13 17:12:27,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:28,190 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:28
2025-03-13 17:12:28,190 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 823.70it/s]
2025-03-13 17:12:28,217 [INFO]: There are 3583 embeddings of dim 49152
2025-03-13 17:12:28,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:12:28,218 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:28
2025-03-13 17:12:28,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:28,218 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:12:28,218 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:28,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:12:28,218 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:28
2025-03-13 17:12:28,218 [INFO]: 739.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:28,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:28,218 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:28
2025-03-13 17:12:28,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:28,218 [INFO]: 	Creating the index 03/13/2025, 17:12:28
2025-03-13 17:12:28,219 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:28
2025-03-13 17:12:28,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:12:28,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:28
2025-03-13 17:12:28,220 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:12:28,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.94it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.92it/s] 20%|██        | 3/15 [00:00<00:01,  7.72it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.52it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.09it/s] 40%|████      | 6/15 [00:00<00:01,  8.50it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.50it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.57it/s] 60%|██████    | 9/15 [00:01<00:00,  8.84it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.99it/s] 80%|████████  | 12/15 [00:01<00:00,  9.48it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.77it/s]100%|██████████| 15/15 [00:04<00:00,  1.47it/s]100%|██████████| 15/15 [00:04<00:00,  3.48it/s]
2025-03-13 17:12:32,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:32
2025-03-13 17:13:13,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4624 secs
2025-03-13 17:13:13,991 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:13:13,991 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s]
2025-03-13 17:13:51,797 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8063 secs
2025-03-13 17:13:51,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5810 secs
2025-03-13 17:13:51,801 [INFO]: {
2025-03-13 17:13:51,801 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:51,801 [INFO]: 	index_param: efSearch=185
2025-03-13 17:13:51,801 [INFO]: 	index_path: knn.index
2025-03-13 17:13:51,801 [INFO]: 	size in bytes: 704933110
2025-03-13 17:13:51,801 [INFO]: 	avg_search_speed_ms: 13.102374905086469
2025-03-13 17:13:51,801 [INFO]: 	99p_search_speed_ms: 35.691602658480406
2025-03-13 17:13:51,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:51,801 [INFO]: 	nb vectors: 3583
2025-03-13 17:13:51,801 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:51,801 [INFO]: 	compression ratio: 0.9993096564864147
2025-03-13 17:13:51,801 [INFO]: }
2025-03-13 17:13:51,801 [INFO]: 	>>> Finished "Creating the index" in 83.5826 secs
2025-03-13 17:13:51,801 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6113 secs
2025-03-13 17:13:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 66127 [episode count 3/20]
[retrieval_preprocessing] for episode 26171 [episode count 4/20], we have num_retrieval=np.int64(3551) num_query=np.int64(187)
2025-03-13 17:13:54,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:55,444 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:55
2025-03-13 17:13:55,444 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 852.67it/s]
2025-03-13 17:13:55,472 [INFO]: There are 3551 embeddings of dim 49152
2025-03-13 17:13:55,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:13:55,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:55
2025-03-13 17:13:55,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:55,473 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:13:55,473 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:55,474 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 17:13:55,474 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:55
2025-03-13 17:13:55,474 [INFO]: 732.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:55,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:13:55,475 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:55
2025-03-13 17:13:55,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:55,475 [INFO]: 	Creating the index 03/13/2025, 17:13:55
2025-03-13 17:13:55,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:55
2025-03-13 17:13:55,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:13:55,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:55
2025-03-13 17:13:55,480 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:13:55,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.34it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.06it/s] 29%|██▊       | 4/14 [00:00<00:01,  6.68it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.11it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.82it/s] 50%|█████     | 7/14 [00:01<00:01,  5.87it/s] 57%|█████▋    | 8/14 [00:01<00:01,  5.88it/s] 86%|████████▌ | 12/14 [00:01<00:00, 12.79it/s]100%|██████████| 14/14 [00:04<00:00,  1.84it/s]100%|██████████| 14/14 [00:04<00:00,  3.13it/s]
2025-03-13 17:13:59,972 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:59
2025-03-13 17:14:53,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5760 secs
2025-03-13 17:14:53,549 [INFO]: The best hyperparameters are: efSearch=108
2025-03-13 17:14:53,549 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-13 17:15:15,551 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0014 secs
2025-03-13 17:15:15,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.0733 secs
2025-03-13 17:15:15,553 [INFO]: {
2025-03-13 17:15:15,553 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:15,553 [INFO]: 	index_param: efSearch=108
2025-03-13 17:15:15,553 [INFO]: 	index_path: knn.index
2025-03-13 17:15:15,553 [INFO]: 	size in bytes: 698637430
2025-03-13 17:15:15,553 [INFO]: 	avg_search_speed_ms: 5.927432156772428
2025-03-13 17:15:15,553 [INFO]: 	99p_search_speed_ms: 11.096609281376
2025-03-13 17:15:15,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:15,553 [INFO]: 	nb vectors: 3551
2025-03-13 17:15:15,553 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:15,553 [INFO]: 	compression ratio: 0.9993094816004919
2025-03-13 17:15:15,553 [INFO]: }
2025-03-13 17:15:15,553 [INFO]: 	>>> Finished "Creating the index" in 80.0778 secs
2025-03-13 17:15:15,553 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1095 secs
2025-03-13 17:15:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 26171 [episode count 4/20]
[retrieval_preprocessing] for episode 31361 [episode count 5/20], we have num_retrieval=np.int64(3573) num_query=np.int64(165)
2025-03-13 17:15:16,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:17,066 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:17
2025-03-13 17:15:17,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-13 17:15:17,098 [INFO]: There are 3573 embeddings of dim 49152
2025-03-13 17:15:17,098 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 17:15:17,098 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:17
2025-03-13 17:15:17,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:17,098 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:15:17,098 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:17,098 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:17,098 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:17
2025-03-13 17:15:17,099 [INFO]: 737.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:17,099 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:15:17,099 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:17
2025-03-13 17:15:17,099 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:17,099 [INFO]: 	Creating the index 03/13/2025, 17:15:17
2025-03-13 17:15:17,099 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:17
2025-03-13 17:15:17,100 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:15:17,100 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:17
2025-03-13 17:15:17,100 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:15:17,100 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.40it/s] 53%|█████▎    | 8/15 [00:00<00:00, 41.81it/s]100%|██████████| 15/15 [00:02<00:00,  4.69it/s]100%|██████████| 15/15 [00:02<00:00,  5.59it/s]
2025-03-13 17:15:19,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:19
2025-03-13 17:16:06,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4137 secs
2025-03-13 17:16:06,200 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 17:16:06,200 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.22it/s]
2025-03-13 17:16:27,097 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8969 secs
2025-03-13 17:16:27,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0002 secs
2025-03-13 17:16:27,100 [INFO]: {
2025-03-13 17:16:27,100 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:27,100 [INFO]: 	index_param: efSearch=125
2025-03-13 17:16:27,100 [INFO]: 	index_path: knn.index
2025-03-13 17:16:27,100 [INFO]: 	size in bytes: 702965710
2025-03-13 17:16:27,100 [INFO]: 	avg_search_speed_ms: 7.587935603103616
2025-03-13 17:16:27,100 [INFO]: 	99p_search_speed_ms: 11.708981855772436
2025-03-13 17:16:27,100 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:27,100 [INFO]: 	nb vectors: 3573
2025-03-13 17:16:27,100 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:27,100 [INFO]: 	compression ratio: 0.9993096021710647
2025-03-13 17:16:27,100 [INFO]: }
2025-03-13 17:16:27,100 [INFO]: 	>>> Finished "Creating the index" in 70.0017 secs
2025-03-13 17:16:27,100 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0344 secs
2025-03-13 17:16:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 31361 [episode count 5/20]
[retrieval_preprocessing] for episode 18133 [episode count 6/20], we have num_retrieval=np.int64(3504) num_query=np.int64(234)
2025-03-13 17:16:30,350 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:31,289 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:31
2025-03-13 17:16:31,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 821.12it/s]
2025-03-13 17:16:31,346 [INFO]: There are 3504 embeddings of dim 49152
2025-03-13 17:16:31,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0565 secs
2025-03-13 17:16:31,347 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:31
2025-03-13 17:16:31,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:31,347 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:16:31,347 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:31,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:16:31,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:31
2025-03-13 17:16:31,347 [INFO]: 723.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:31,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:16:31,348 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:31
2025-03-13 17:16:31,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:31,348 [INFO]: 	Creating the index 03/13/2025, 17:16:31
2025-03-13 17:16:31,348 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:31
2025-03-13 17:16:31,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:16:31,350 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:31
2025-03-13 17:16:31,350 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:16:31,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.27it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.89it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.92it/s]100%|██████████| 14/14 [00:03<00:00,  4.00it/s]
2025-03-13 17:16:34,859 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:34
2025-03-13 17:17:24,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5951 secs
2025-03-13 17:17:24,456 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 17:17:24,456 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 17:17:56,034 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5774 secs
2025-03-13 17:17:56,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.6866 secs
2025-03-13 17:17:56,037 [INFO]: {
2025-03-13 17:17:56,037 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:56,037 [INFO]: 	index_param: efSearch=91
2025-03-13 17:17:56,037 [INFO]: 	index_path: knn.index
2025-03-13 17:17:56,037 [INFO]: 	size in bytes: 689390470
2025-03-13 17:17:56,037 [INFO]: 	avg_search_speed_ms: 6.001966806002283
2025-03-13 17:17:56,037 [INFO]: 	99p_search_speed_ms: 10.46552681364118
2025-03-13 17:17:56,037 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:56,037 [INFO]: 	nb vectors: 3504
2025-03-13 17:17:56,037 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:56,037 [INFO]: 	compression ratio: 0.9993094798655978
2025-03-13 17:17:56,037 [INFO]: }
2025-03-13 17:17:56,037 [INFO]: 	>>> Finished "Creating the index" in 84.6893 secs
2025-03-13 17:17:56,037 [INFO]: >>> Finished "Launching the whole pipeline" in 84.7473 secs
2025-03-13 17:17:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 18133 [episode count 6/20]
[retrieval_preprocessing] for episode 70893 [episode count 7/20], we have num_retrieval=np.int64(3561) num_query=np.int64(177)
2025-03-13 17:17:57,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:58,313 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:58
2025-03-13 17:17:58,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 991.80it/s]
2025-03-13 17:17:58,347 [INFO]: There are 3561 embeddings of dim 49152
2025-03-13 17:17:58,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 17:17:58,348 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:58,348 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:17:58,349 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:58,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:17:58,349 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,349 [INFO]: 734.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:58,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:17:58,350 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:58
2025-03-13 17:17:58,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:58,350 [INFO]: 	Creating the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,350 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:58
2025-03-13 17:17:58,353 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:17:58,353 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:58
2025-03-13 17:17:58,353 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:17:58,354 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.88it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.94it/s] 80%|████████  | 12/15 [00:00<00:00, 39.83it/s]100%|██████████| 15/15 [00:03<00:00,  4.06it/s]
2025-03-13 17:18:02,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:02
2025-03-13 17:18:54,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5695 secs
2025-03-13 17:18:54,623 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 17:18:54,623 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 17:19:18,365 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7423 secs
2025-03-13 17:19:18,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5742 secs
2025-03-13 17:19:18,928 [INFO]: {
2025-03-13 17:19:18,928 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:18,928 [INFO]: 	index_param: efSearch=133
2025-03-13 17:19:18,928 [INFO]: 	index_path: knn.index
2025-03-13 17:19:18,928 [INFO]: 	size in bytes: 700604830
2025-03-13 17:19:18,928 [INFO]: 	avg_search_speed_ms: 7.706031640769142
2025-03-13 17:19:18,928 [INFO]: 	99p_search_speed_ms: 10.434977333061397
2025-03-13 17:19:18,928 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:18,928 [INFO]: 	nb vectors: 3561
2025-03-13 17:19:18,929 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:18,929 [INFO]: 	compression ratio: 0.9993095365899776
2025-03-13 17:19:18,929 [INFO]: }
2025-03-13 17:19:18,929 [INFO]: 	>>> Finished "Creating the index" in 80.5788 secs
2025-03-13 17:19:18,929 [INFO]: >>> Finished "Launching the whole pipeline" in 80.6159 secs
2025-03-13 17:19:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 70893 [episode count 7/20]
[retrieval_preprocessing] for episode 78068 [episode count 8/20], we have num_retrieval=np.int64(3539) num_query=np.int64(199)
2025-03-13 17:19:20,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:21,032 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:21
2025-03-13 17:19:21,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.39it/s]
2025-03-13 17:19:21,066 [INFO]: There are 3539 embeddings of dim 49152
2025-03-13 17:19:21,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 17:19:21,066 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:21
2025-03-13 17:19:21,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:21,066 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:19:21,066 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:21,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:21,066 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:21
2025-03-13 17:19:21,066 [INFO]: 730.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:21,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:21,067 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:21
2025-03-13 17:19:21,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:21,067 [INFO]: 	Creating the index 03/13/2025, 17:19:21
2025-03-13 17:19:21,067 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:21
2025-03-13 17:19:21,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:19:21,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:21
2025-03-13 17:19:21,068 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:19:21,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.20it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.03it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.57it/s]100%|██████████| 14/14 [00:03<00:00,  4.40it/s]
2025-03-13 17:19:24,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:24
2025-03-13 17:20:05,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4908 secs
2025-03-13 17:20:05,748 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 17:20:05,748 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 17:20:29,223 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4748 secs
2025-03-13 17:20:29,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1583 secs
2025-03-13 17:20:29,226 [INFO]: {
2025-03-13 17:20:29,226 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:29,226 [INFO]: 	index_param: efSearch=140
2025-03-13 17:20:29,226 [INFO]: 	index_path: knn.index
2025-03-13 17:20:29,226 [INFO]: 	size in bytes: 696276430
2025-03-13 17:20:29,226 [INFO]: 	avg_search_speed_ms: 7.323406148725087
2025-03-13 17:20:29,226 [INFO]: 	99p_search_speed_ms: 10.208706744015213
2025-03-13 17:20:29,226 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:29,226 [INFO]: 	nb vectors: 3539
2025-03-13 17:20:29,226 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:29,226 [INFO]: 	compression ratio: 0.9993095874292341
2025-03-13 17:20:29,226 [INFO]: }
2025-03-13 17:20:29,226 [INFO]: 	>>> Finished "Creating the index" in 68.1599 secs
2025-03-13 17:20:29,227 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1943 secs
2025-03-13 17:20:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 78068 [episode count 8/20]
[retrieval_preprocessing] for episode 22847 [episode count 9/20], we have num_retrieval=np.int64(3577) num_query=np.int64(161)
2025-03-13 17:20:32,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:34,040 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:34
2025-03-13 17:20:34,041 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 17:20:34,072 [INFO]: There are 3577 embeddings of dim 49152
2025-03-13 17:20:34,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:20:34,072 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:34
2025-03-13 17:20:34,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:34,072 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:20:34,072 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:34,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:34,072 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:34
2025-03-13 17:20:34,072 [INFO]: 738.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:34,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:20:34,073 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:34
2025-03-13 17:20:34,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:34,073 [INFO]: 	Creating the index 03/13/2025, 17:20:34
2025-03-13 17:20:34,073 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:34
2025-03-13 17:20:34,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:20:34,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:34
2025-03-13 17:20:34,074 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:20:34,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.58it/s] 40%|████      | 6/15 [00:00<00:00, 29.88it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.30it/s]100%|██████████| 15/15 [00:02<00:00,  3.89it/s]100%|██████████| 15/15 [00:02<00:00,  5.34it/s]
2025-03-13 17:20:36,889 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:36
2025-03-13 17:21:24,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1212 secs
2025-03-13 17:21:24,011 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 17:21:24,011 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-13 17:21:46,913 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9016 secs
2025-03-13 17:21:46,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8422 secs
2025-03-13 17:21:46,916 [INFO]: {
2025-03-13 17:21:46,916 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:46,916 [INFO]: 	index_param: efSearch=114
2025-03-13 17:21:46,916 [INFO]: 	index_path: knn.index
2025-03-13 17:21:46,916 [INFO]: 	size in bytes: 703752670
2025-03-13 17:21:46,916 [INFO]: 	avg_search_speed_ms: 7.608448540617512
2025-03-13 17:21:46,916 [INFO]: 	99p_search_speed_ms: 10.844034692272542
2025-03-13 17:21:46,916 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:46,916 [INFO]: 	nb vectors: 3577
2025-03-13 17:21:46,916 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:46,916 [INFO]: 	compression ratio: 0.9993096239336471
2025-03-13 17:21:46,916 [INFO]: }
2025-03-13 17:21:46,916 [INFO]: 	>>> Finished "Creating the index" in 72.8436 secs
2025-03-13 17:21:46,916 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8757 secs
2025-03-13 17:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 22847 [episode count 9/20]
[retrieval_preprocessing] for episode 40288 [episode count 10/20], we have num_retrieval=np.int64(3535) num_query=np.int64(203)
2025-03-13 17:21:48,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:49,143 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:49
2025-03-13 17:21:49,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 820.64it/s]
2025-03-13 17:21:49,184 [INFO]: There are 3535 embeddings of dim 49152
2025-03-13 17:21:49,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0420 secs
2025-03-13 17:21:49,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:49
2025-03-13 17:21:49,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:49,186 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:21:49,186 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:49,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:21:49,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:49
2025-03-13 17:21:49,187 [INFO]: 729.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:49,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:21:49,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:49
2025-03-13 17:21:49,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:49,187 [INFO]: 	Creating the index 03/13/2025, 17:21:49
2025-03-13 17:21:49,188 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:49
2025-03-13 17:21:49,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 17:21:49,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:49
2025-03-13 17:21:49,191 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:21:49,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.60it/s] 29%|██▊       | 4/14 [00:00<00:00, 15.36it/s] 57%|█████▋    | 8/14 [00:00<00:00, 22.09it/s] 79%|███████▊  | 11/14 [00:00<00:00, 22.14it/s]100%|██████████| 14/14 [00:03<00:00,  2.41it/s]100%|██████████| 14/14 [00:03<00:00,  3.71it/s]
2025-03-13 17:21:52,969 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:52
2025-03-13 17:22:35,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8347 secs
2025-03-13 17:22:35,804 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 17:22:35,804 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-13 17:22:56,203 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3991 secs
2025-03-13 17:22:56,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0160 secs
2025-03-13 17:22:56,207 [INFO]: {
2025-03-13 17:22:56,207 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:56,207 [INFO]: 	index_param: efSearch=163
2025-03-13 17:22:56,207 [INFO]: 	index_path: knn.index
2025-03-13 17:22:56,207 [INFO]: 	size in bytes: 695489470
2025-03-13 17:22:56,207 [INFO]: 	avg_search_speed_ms: 9.82617257160184
2025-03-13 17:22:56,207 [INFO]: 	99p_search_speed_ms: 15.491066679824147
2025-03-13 17:22:56,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:56,207 [INFO]: 	nb vectors: 3535
2025-03-13 17:22:56,207 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:56,207 [INFO]: 	compression ratio: 0.999309565391407
2025-03-13 17:22:56,207 [INFO]: }
2025-03-13 17:22:56,207 [INFO]: 	>>> Finished "Creating the index" in 67.0197 secs
2025-03-13 17:22:56,207 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0643 secs
2025-03-13 17:22:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 40288 [episode count 10/20]
[retrieval_preprocessing] for episode 69400 [episode count 11/20], we have num_retrieval=np.int64(3487) num_query=np.int64(251)
2025-03-13 17:22:58,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:59,321 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:59
2025-03-13 17:22:59,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.04it/s]
2025-03-13 17:22:59,358 [INFO]: There are 3487 embeddings of dim 49152
2025-03-13 17:22:59,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 17:22:59,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:59,359 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:22:59,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:59,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:22:59,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,360 [INFO]: 719.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:59,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:22:59,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:59
2025-03-13 17:22:59,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:59,360 [INFO]: 	Creating the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:59
2025-03-13 17:22:59,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:22:59,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:59
2025-03-13 17:22:59,364 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:22:59,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 16.99it/s] 50%|█████     | 7/14 [00:00<00:00, 32.42it/s] 86%|████████▌ | 12/14 [00:00<00:00, 37.31it/s]100%|██████████| 14/14 [00:03<00:00,  4.21it/s]
2025-03-13 17:23:02,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:02
2025-03-13 17:23:48,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8771 secs
2025-03-13 17:23:48,571 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:23:48,571 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.74it/s]
2025-03-13 17:24:09,919 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3477 secs
2025-03-13 17:24:09,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5580 secs
2025-03-13 17:24:09,922 [INFO]: {
2025-03-13 17:24:09,922 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:09,922 [INFO]: 	index_param: efSearch=173
2025-03-13 17:24:09,922 [INFO]: 	index_path: knn.index
2025-03-13 17:24:09,922 [INFO]: 	size in bytes: 686045830
2025-03-13 17:24:09,922 [INFO]: 	avg_search_speed_ms: 10.691765829638188
2025-03-13 17:24:09,922 [INFO]: 	99p_search_speed_ms: 15.116849623154849
2025-03-13 17:24:09,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:09,922 [INFO]: 	nb vectors: 3487
2025-03-13 17:24:09,922 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:09,922 [INFO]: 	compression ratio: 0.9993094717884955
2025-03-13 17:24:09,922 [INFO]: }
2025-03-13 17:24:09,922 [INFO]: 	>>> Finished "Creating the index" in 70.5619 secs
2025-03-13 17:24:09,923 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6015 secs
2025-03-13 17:24:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 69400 [episode count 11/20]
[retrieval_preprocessing] for episode 38188 [episode count 12/20], we have num_retrieval=np.int64(3587) num_query=np.int64(151)
2025-03-13 17:24:13,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:14,029 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:14
2025-03-13 17:24:14,030 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1369.35it/s]
2025-03-13 17:24:14,062 [INFO]: There are 3587 embeddings of dim 49152
2025-03-13 17:24:14,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 17:24:14,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:14
2025-03-13 17:24:14,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:14,064 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:24:14,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:14,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:24:14,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:14
2025-03-13 17:24:14,064 [INFO]: 740.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:14,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:24:14,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:14
2025-03-13 17:24:14,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:14,065 [INFO]: 	Creating the index 03/13/2025, 17:24:14
2025-03-13 17:24:14,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:14
2025-03-13 17:24:14,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:24:14,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:14
2025-03-13 17:24:14,069 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:24:14,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.74it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.34it/s] 80%|████████  | 12/15 [00:00<00:00, 36.11it/s]100%|██████████| 15/15 [00:03<00:00,  4.58it/s]
2025-03-13 17:24:17,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:17
2025-03-13 17:25:09,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7159 secs
2025-03-13 17:25:09,063 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:25:09,063 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 17:25:34,652 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5889 secs
2025-03-13 17:25:34,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5860 secs
2025-03-13 17:25:34,655 [INFO]: {
2025-03-13 17:25:34,655 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:34,655 [INFO]: 	index_param: efSearch=135
2025-03-13 17:25:34,655 [INFO]: 	index_path: knn.index
2025-03-13 17:25:34,655 [INFO]: 	size in bytes: 705720130
2025-03-13 17:25:34,655 [INFO]: 	avg_search_speed_ms: 7.782902811918452
2025-03-13 17:25:34,655 [INFO]: 	99p_search_speed_ms: 10.92589030973614
2025-03-13 17:25:34,655 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:34,655 [INFO]: 	nb vectors: 3587
2025-03-13 17:25:34,655 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:34,655 [INFO]: 	compression ratio: 0.9993095931669117
2025-03-13 17:25:34,655 [INFO]: }
2025-03-13 17:25:34,655 [INFO]: 	>>> Finished "Creating the index" in 80.5898 secs
2025-03-13 17:25:34,655 [INFO]: >>> Finished "Launching the whole pipeline" in 80.6255 secs
2025-03-13 17:25:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 38188 [episode count 12/20]
[retrieval_preprocessing] for episode 77653 [episode count 13/20], we have num_retrieval=np.int64(3514) num_query=np.int64(224)
2025-03-13 17:25:36,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:36,782 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:36
2025-03-13 17:25:36,782 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-13 17:25:36,816 [INFO]: There are 3514 embeddings of dim 49152
2025-03-13 17:25:36,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 17:25:36,817 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:36
2025-03-13 17:25:36,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:36,817 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:25:36,817 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:36,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:36,817 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:36
2025-03-13 17:25:36,817 [INFO]: 725.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:36,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:36,817 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:36
2025-03-13 17:25:36,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:36,817 [INFO]: 	Creating the index 03/13/2025, 17:25:36
2025-03-13 17:25:36,817 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:36
2025-03-13 17:25:36,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:25:36,818 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:36
2025-03-13 17:25:36,818 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:25:36,818 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.31it/s] 36%|███▌      | 5/14 [00:00<00:00, 22.64it/s] 64%|██████▍   | 9/14 [00:00<00:00, 29.22it/s] 93%|█████████▎| 13/14 [00:00<00:00, 33.14it/s]100%|██████████| 14/14 [00:03<00:00,  4.17it/s]
2025-03-13 17:25:40,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:40
2025-03-13 17:26:36,746 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5689 secs
2025-03-13 17:26:36,747 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 17:26:36,747 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 17:26:57,272 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5242 secs
2025-03-13 17:26:57,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.4564 secs
2025-03-13 17:26:57,275 [INFO]: {
2025-03-13 17:26:57,275 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:57,275 [INFO]: 	index_param: efSearch=105
2025-03-13 17:26:57,275 [INFO]: 	index_path: knn.index
2025-03-13 17:26:57,275 [INFO]: 	size in bytes: 691357870
2025-03-13 17:26:57,275 [INFO]: 	avg_search_speed_ms: 7.074361229717457
2025-03-13 17:26:57,275 [INFO]: 	99p_search_speed_ms: 10.556038720533246
2025-03-13 17:26:57,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:57,275 [INFO]: 	nb vectors: 3514
2025-03-13 17:26:57,275 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:57,275 [INFO]: 	compression ratio: 0.9993095355955086
2025-03-13 17:26:57,275 [INFO]: }
2025-03-13 17:26:57,275 [INFO]: 	>>> Finished "Creating the index" in 80.4581 secs
2025-03-13 17:26:57,275 [INFO]: >>> Finished "Launching the whole pipeline" in 80.4935 secs
2025-03-13 17:26:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 77653 [episode count 13/20]
[retrieval_preprocessing] for episode 59280 [episode count 14/20], we have num_retrieval=np.int64(3592) num_query=np.int64(146)
2025-03-13 17:26:59,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:00,121 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:00
2025-03-13 17:27:00,121 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 776.29it/s]
2025-03-13 17:27:00,157 [INFO]: There are 3592 embeddings of dim 49152
2025-03-13 17:27:00,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 17:27:00,157 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:00
2025-03-13 17:27:00,158 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:00,158 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:27:00,158 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:00,158 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:27:00,158 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:00
2025-03-13 17:27:00,158 [INFO]: 741.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:00,158 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:27:00,159 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:00
2025-03-13 17:27:00,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:00,159 [INFO]: 	Creating the index 03/13/2025, 17:27:00
2025-03-13 17:27:00,159 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:00
2025-03-13 17:27:00,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:27:00,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:00
2025-03-13 17:27:00,162 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:27:00,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 15.78it/s] 40%|████      | 6/15 [00:00<00:00, 27.65it/s] 67%|██████▋   | 10/15 [00:00<00:00, 32.51it/s]100%|██████████| 15/15 [00:02<00:00,  3.70it/s]100%|██████████| 15/15 [00:02<00:00,  5.00it/s]
2025-03-13 17:27:03,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:03
2025-03-13 17:27:48,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3638 secs
2025-03-13 17:27:48,529 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 17:27:48,529 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 17:28:07,792 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2634 secs
2025-03-13 17:28:07,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6330 secs
2025-03-13 17:28:07,795 [INFO]: {
2025-03-13 17:28:07,795 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:07,795 [INFO]: 	index_param: efSearch=150
2025-03-13 17:28:07,795 [INFO]: 	index_path: knn.index
2025-03-13 17:28:07,795 [INFO]: 	size in bytes: 706703830
2025-03-13 17:28:07,795 [INFO]: 	avg_search_speed_ms: 8.961677566082233
2025-03-13 17:28:07,795 [INFO]: 	99p_search_speed_ms: 12.382453971076755
2025-03-13 17:28:07,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:07,795 [INFO]: 	nb vectors: 3592
2025-03-13 17:28:07,795 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:07,795 [INFO]: 	compression ratio: 0.9993096202690737
2025-03-13 17:28:07,795 [INFO]: }
2025-03-13 17:28:07,795 [INFO]: 	>>> Finished "Creating the index" in 67.6359 secs
2025-03-13 17:28:07,795 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6741 secs
2025-03-13 17:28:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 59280 [episode count 14/20]
[retrieval_preprocessing] for episode 77817 [episode count 15/20], we have num_retrieval=np.int64(3564) num_query=np.int64(174)
2025-03-13 17:28:09,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:09,846 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:09
2025-03-13 17:28:09,846 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.61it/s]
2025-03-13 17:28:09,878 [INFO]: There are 3564 embeddings of dim 49152
2025-03-13 17:28:09,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 17:28:09,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:09
2025-03-13 17:28:09,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:09,880 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:28:09,880 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:09,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:28:09,880 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:09
2025-03-13 17:28:09,880 [INFO]: 735.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:09,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:28:09,881 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:09
2025-03-13 17:28:09,881 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:09,881 [INFO]: 	Creating the index 03/13/2025, 17:28:09
2025-03-13 17:28:09,881 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:09
2025-03-13 17:28:09,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:28:09,884 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:09
2025-03-13 17:28:09,884 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:28:09,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 19.72it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.95it/s] 80%|████████  | 12/15 [00:00<00:00, 40.59it/s]100%|██████████| 15/15 [00:03<00:00,  4.54it/s]
2025-03-13 17:28:13,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:13
2025-03-13 17:28:48,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5003 secs
2025-03-13 17:28:48,699 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:28:48,699 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.44it/s]
2025-03-13 17:29:26,692 [INFO]: 	>>> Finished "Compute fast metrics" in 37.9932 secs
2025-03-13 17:29:27,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.4104 secs
2025-03-13 17:29:27,295 [INFO]: {
2025-03-13 17:29:27,295 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:27,295 [INFO]: 	index_param: efSearch=183
2025-03-13 17:29:27,295 [INFO]: 	index_path: knn.index
2025-03-13 17:29:27,295 [INFO]: 	size in bytes: 701195050
2025-03-13 17:29:27,295 [INFO]: 	avg_search_speed_ms: 9.813442315597369
2025-03-13 17:29:27,295 [INFO]: 	99p_search_speed_ms: 13.494240911677476
2025-03-13 17:29:27,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:27,295 [INFO]: 	nb vectors: 3564
2025-03-13 17:29:27,295 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:27,296 [INFO]: 	compression ratio: 0.9993095530266507
2025-03-13 17:29:27,296 [INFO]: }
2025-03-13 17:29:27,296 [INFO]: 	>>> Finished "Creating the index" in 77.4146 secs
2025-03-13 17:29:27,296 [INFO]: >>> Finished "Launching the whole pipeline" in 77.4497 secs
2025-03-13 17:29:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 77817 [episode count 15/20]
[retrieval_preprocessing] for episode 46530 [episode count 16/20], we have num_retrieval=np.int64(3545) num_query=np.int64(193)
2025-03-13 17:29:28,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:29,491 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:29
2025-03-13 17:29:29,491 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.99it/s]
2025-03-13 17:29:29,521 [INFO]: There are 3545 embeddings of dim 49152
2025-03-13 17:29:29,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 17:29:29,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:29
2025-03-13 17:29:29,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:29,522 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:29:29,522 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:29,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:29,522 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:29
2025-03-13 17:29:29,522 [INFO]: 731.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:29,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:29,522 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:29
2025-03-13 17:29:29,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:29,522 [INFO]: 	Creating the index 03/13/2025, 17:29:29
2025-03-13 17:29:29,522 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:29
2025-03-13 17:29:29,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:29:29,523 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:29
2025-03-13 17:29:29,523 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:29:29,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.18it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.75it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.47it/s]100%|██████████| 14/14 [00:04<00:00,  3.22it/s]
2025-03-13 17:29:33,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:33
2025-03-13 17:30:13,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8166 secs
2025-03-13 17:30:13,698 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 17:30:13,698 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.81it/s]
2025-03-13 17:30:44,653 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9541 secs
2025-03-13 17:30:44,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.1317 secs
2025-03-13 17:30:44,655 [INFO]: {
2025-03-13 17:30:44,655 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:44,655 [INFO]: 	index_param: efSearch=93
2025-03-13 17:30:44,655 [INFO]: 	index_path: knn.index
2025-03-13 17:30:44,655 [INFO]: 	size in bytes: 697456930
2025-03-13 17:30:44,655 [INFO]: 	avg_search_speed_ms: 6.960813319122465
2025-03-13 17:30:44,655 [INFO]: 	99p_search_speed_ms: 11.036556644830856
2025-03-13 17:30:44,655 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:44,655 [INFO]: 	nb vectors: 3545
2025-03-13 17:30:44,655 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:44,655 [INFO]: 	compression ratio: 0.9993095344253013
2025-03-13 17:30:44,655 [INFO]: }
2025-03-13 17:30:44,655 [INFO]: 	>>> Finished "Creating the index" in 75.1334 secs
2025-03-13 17:30:44,655 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1647 secs
2025-03-13 17:30:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 46530 [episode count 16/20]
[retrieval_preprocessing] for episode 52164 [episode count 17/20], we have num_retrieval=np.int64(3571) num_query=np.int64(167)
2025-03-13 17:30:46,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:46,686 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:46
2025-03-13 17:30:46,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 853.37it/s]
2025-03-13 17:30:46,726 [INFO]: There are 3571 embeddings of dim 49152
2025-03-13 17:30:46,726 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0394 secs
2025-03-13 17:30:46,726 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:46
2025-03-13 17:30:46,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:46,727 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:30:46,727 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:46,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:30:46,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:46
2025-03-13 17:30:46,728 [INFO]: 737.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:46,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:30:46,728 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:46
2025-03-13 17:30:46,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:46,729 [INFO]: 	Creating the index 03/13/2025, 17:30:46
2025-03-13 17:30:46,729 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:46
2025-03-13 17:30:46,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:30:46,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:46
2025-03-13 17:30:46,733 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:30:46,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 15.91it/s] 40%|████      | 6/15 [00:00<00:00, 27.25it/s] 67%|██████▋   | 10/15 [00:00<00:00, 31.69it/s] 93%|█████████▎| 14/15 [00:00<00:00, 34.19it/s]100%|██████████| 15/15 [00:03<00:00,  3.96it/s]
2025-03-13 17:30:50,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:50
2025-03-13 17:31:31,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6963 secs
2025-03-13 17:31:31,224 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 17:31:31,224 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.96it/s]
2025-03-13 17:31:56,255 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0314 secs
2025-03-13 17:31:56,258 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5250 secs
2025-03-13 17:31:56,258 [INFO]: {
2025-03-13 17:31:56,258 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:56,258 [INFO]: 	index_param: efSearch=124
2025-03-13 17:31:56,258 [INFO]: 	index_path: knn.index
2025-03-13 17:31:56,258 [INFO]: 	size in bytes: 702572230
2025-03-13 17:31:56,258 [INFO]: 	avg_search_speed_ms: 8.181328273267042
2025-03-13 17:31:56,258 [INFO]: 	99p_search_speed_ms: 13.558602286502715
2025-03-13 17:31:56,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:56,258 [INFO]: 	nb vectors: 3571
2025-03-13 17:31:56,258 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:56,258 [INFO]: 	compression ratio: 0.999309591271491
2025-03-13 17:31:56,258 [INFO]: }
2025-03-13 17:31:56,258 [INFO]: 	>>> Finished "Creating the index" in 69.5291 secs
2025-03-13 17:31:56,258 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5717 secs
2025-03-13 17:31:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 52164 [episode count 17/20]
[retrieval_preprocessing] for episode 19399 [episode count 18/20], we have num_retrieval=np.int64(3557) num_query=np.int64(181)
2025-03-13 17:31:57,707 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:58,199 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:58
2025-03-13 17:31:58,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.92it/s]
2025-03-13 17:31:58,232 [INFO]: There are 3557 embeddings of dim 49152
2025-03-13 17:31:58,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 17:31:58,233 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:58,233 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:31:58,233 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:58,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:58,233 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,233 [INFO]: 734.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:58,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:58,233 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:58
2025-03-13 17:31:58,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:58,233 [INFO]: 	Creating the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,233 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:58
2025-03-13 17:31:58,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:31:58,234 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:58
2025-03-13 17:31:58,234 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:31:58,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.37it/s] 40%|████      | 6/15 [00:00<00:00, 29.11it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.35it/s]100%|██████████| 15/15 [00:03<00:00,  2.76it/s]100%|██████████| 15/15 [00:03<00:00,  3.85it/s]
2025-03-13 17:32:02,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:02
2025-03-13 17:32:40,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8003 secs
2025-03-13 17:32:40,939 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 17:32:40,939 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.51it/s]
2025-03-13 17:33:07,425 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4860 secs
2025-03-13 17:33:07,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1936 secs
2025-03-13 17:33:07,428 [INFO]: {
2025-03-13 17:33:07,428 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:07,428 [INFO]: 	index_param: efSearch=119
2025-03-13 17:33:07,428 [INFO]: 	index_path: knn.index
2025-03-13 17:33:07,428 [INFO]: 	size in bytes: 699817870
2025-03-13 17:33:07,428 [INFO]: 	avg_search_speed_ms: 7.561941918742289
2025-03-13 17:33:07,428 [INFO]: 	99p_search_speed_ms: 10.901486556977032
2025-03-13 17:33:07,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:07,428 [INFO]: 	nb vectors: 3557
2025-03-13 17:33:07,428 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:07,428 [INFO]: 	compression ratio: 0.9993095146312855
2025-03-13 17:33:07,428 [INFO]: }
2025-03-13 17:33:07,428 [INFO]: 	>>> Finished "Creating the index" in 69.1950 secs
2025-03-13 17:33:07,428 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2287 secs
2025-03-13 17:33:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 19399 [episode count 18/20]
[retrieval_preprocessing] for episode 13306 [episode count 19/20], we have num_retrieval=np.int64(3551) num_query=np.int64(187)
2025-03-13 17:33:08,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:09,253 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:09
2025-03-13 17:33:09,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-13 17:33:09,285 [INFO]: There are 3551 embeddings of dim 49152
2025-03-13 17:33:09,285 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:33:09,285 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:09
2025-03-13 17:33:09,285 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:09,285 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:33:09,285 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:09,285 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:09,285 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:09
2025-03-13 17:33:09,285 [INFO]: 732.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:09,285 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:09,285 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:09
2025-03-13 17:33:09,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:09,286 [INFO]: 	Creating the index 03/13/2025, 17:33:09
2025-03-13 17:33:09,286 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:09
2025-03-13 17:33:09,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:33:09,287 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:09
2025-03-13 17:33:09,287 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:33:09,287 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.79it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.14it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.54it/s]100%|██████████| 14/14 [00:03<00:00,  4.35it/s]
2025-03-13 17:33:12,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:12
2025-03-13 17:33:56,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6061 secs
2025-03-13 17:33:56,114 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 17:33:56,114 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 17:34:26,184 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0705 secs
2025-03-13 17:34:26,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9003 secs
2025-03-13 17:34:26,187 [INFO]: {
2025-03-13 17:34:26,187 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:26,187 [INFO]: 	index_param: efSearch=154
2025-03-13 17:34:26,187 [INFO]: 	index_path: knn.index
2025-03-13 17:34:26,187 [INFO]: 	size in bytes: 698637430
2025-03-13 17:34:26,187 [INFO]: 	avg_search_speed_ms: 8.811399387195706
2025-03-13 17:34:26,187 [INFO]: 	99p_search_speed_ms: 13.523128363303842
2025-03-13 17:34:26,187 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:26,187 [INFO]: 	nb vectors: 3551
2025-03-13 17:34:26,187 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:26,187 [INFO]: 	compression ratio: 0.9993094816004919
2025-03-13 17:34:26,187 [INFO]: }
2025-03-13 17:34:26,187 [INFO]: 	>>> Finished "Creating the index" in 76.9017 secs
2025-03-13 17:34:26,187 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9344 secs
2025-03-13 17:34:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 13306 [episode count 19/20]
2025-03-13 17:34:27: [retrieval_preprocessing] finished for 6370153372_put_lid_on_can [chosen_id count 5/196]
2025-03-13 17:34:30: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6486961974_put_ropes_in_blue_box [chosen_id count 6/196]
2025-03-13 17:34:30: [retrieval_preprocessing] we have num_total=9968 embedding_dim=49152
[retrieval_preprocessing] for episode 54786 [episode count 0/20], we have num_retrieval=np.int64(9352) num_query=np.int64(616)
2025-03-13 17:34:31,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:33,191 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:33
2025-03-13 17:34:33,191 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.83it/s]
2025-03-13 17:34:33,224 [INFO]: There are 9352 embeddings of dim 49152
2025-03-13 17:34:33,224 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 17:34:33,224 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:33
2025-03-13 17:34:33,224 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:33,224 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 17:34:33,224 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:34:33,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:33,224 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:33
2025-03-13 17:34:33,224 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:33,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:34:33,224 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:33
2025-03-13 17:34:33,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:33,224 [INFO]: 	Creating the index 03/13/2025, 17:34:33
2025-03-13 17:34:33,224 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:33
2025-03-13 17:34:33,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:34:33,225 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:33
2025-03-13 17:34:33,226 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:34:33,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  8.95it/s] 16%|█▌        | 6/38 [00:00<00:01, 28.73it/s] 26%|██▋       | 10/38 [00:00<00:00, 32.66it/s] 39%|███▉      | 15/38 [00:00<00:00, 37.14it/s] 53%|█████▎    | 20/38 [00:00<00:00, 39.23it/s] 63%|██████▎   | 24/38 [00:05<00:06,  2.32it/s] 76%|███████▋  | 29/38 [00:05<00:02,  3.53it/s] 89%|████████▉ | 34/38 [00:06<00:00,  5.14it/s]100%|██████████| 38/38 [00:10<00:00,  2.27it/s]100%|██████████| 38/38 [00:10<00:00,  3.68it/s]
2025-03-13 17:34:43,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:43
2025-03-13 17:35:56,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.9549 secs
2025-03-13 17:35:56,802 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 17:35:56,802 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 17:36:48,509 [INFO]: 	>>> Finished "Compute fast metrics" in 51.7067 secs
2025-03-13 17:36:48,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.2864 secs
2025-03-13 17:36:48,512 [INFO]: {
2025-03-13 17:36:48,512 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:48,512 [INFO]: 	index_param: efSearch=148
2025-03-13 17:36:48,512 [INFO]: 	index_path: knn.index
2025-03-13 17:36:48,512 [INFO]: 	size in bytes: 1839950950
2025-03-13 17:36:48,512 [INFO]: 	avg_search_speed_ms: 10.23968629169153
2025-03-13 17:36:48,512 [INFO]: 	99p_search_speed_ms: 16.26702021807432
2025-03-13 17:36:48,512 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:48,512 [INFO]: 	nb vectors: 9352
2025-03-13 17:36:48,512 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:48,512 [INFO]: 	compression ratio: 0.9993081696009342
2025-03-13 17:36:48,512 [INFO]: }
2025-03-13 17:36:48,512 [INFO]: 	>>> Finished "Creating the index" in 135.2879 secs
2025-03-13 17:36:48,512 [INFO]: >>> Finished "Launching the whole pipeline" in 135.3213 secs
2025-03-13 17:36:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 54786 [episode count 0/20]
[retrieval_preprocessing] for episode 89618 [episode count 1/20], we have num_retrieval=np.int64(9423) num_query=np.int64(545)
2025-03-13 17:36:54,816 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:56,978 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:56
2025-03-13 17:36:56,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.96it/s]
2025-03-13 17:36:57,018 [INFO]: There are 9423 embeddings of dim 49152
2025-03-13 17:36:57,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0399 secs
2025-03-13 17:36:57,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,019 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:57,019 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:36:57,019 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:36:57,019 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:36:57,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,020 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:57,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:36:57,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:57
2025-03-13 17:36:57,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:57,021 [INFO]: 	Creating the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:57
2025-03-13 17:36:57,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:36:57,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:57
2025-03-13 17:36:57,025 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:36:57,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  7.34it/s] 13%|█▎        | 5/39 [00:00<00:01, 24.05it/s] 26%|██▌       | 10/39 [00:00<00:00, 32.38it/s] 38%|███▊      | 15/39 [00:00<00:00, 36.05it/s] 51%|█████▏    | 20/39 [00:00<00:00, 38.37it/s] 62%|██████▏   | 24/39 [00:05<00:05,  2.50it/s] 74%|███████▍  | 29/39 [00:05<00:02,  3.79it/s] 87%|████████▋ | 34/39 [00:05<00:00,  5.51it/s]100%|██████████| 39/39 [00:10<00:00,  2.28it/s]100%|██████████| 39/39 [00:10<00:00,  3.70it/s]
2025-03-13 17:37:07,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:07
2025-03-13 17:38:25,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.6413 secs
2025-03-13 17:38:25,203 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 17:38:25,203 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 17:39:10,114 [INFO]: 	>>> Finished "Compute fast metrics" in 44.9114 secs
2025-03-13 17:39:10,117 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.0929 secs
2025-03-13 17:39:10,118 [INFO]: {
2025-03-13 17:39:10,118 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:10,118 [INFO]: 	index_param: efSearch=142
2025-03-13 17:39:10,118 [INFO]: 	index_path: knn.index
2025-03-13 17:39:10,118 [INFO]: 	size in bytes: 1853919490
2025-03-13 17:39:10,118 [INFO]: 	avg_search_speed_ms: 9.431757371573937
2025-03-13 17:39:10,118 [INFO]: 	99p_search_speed_ms: 14.986174975056203
2025-03-13 17:39:10,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:10,118 [INFO]: 	nb vectors: 9423
2025-03-13 17:39:10,118 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:10,118 [INFO]: 	compression ratio: 0.9993083270298863
2025-03-13 17:39:10,118 [INFO]: }
2025-03-13 17:39:10,118 [INFO]: 	>>> Finished "Creating the index" in 133.0971 secs
2025-03-13 17:39:10,118 [INFO]: >>> Finished "Launching the whole pipeline" in 133.1397 secs
2025-03-13 17:39:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 89618 [episode count 1/20]
[retrieval_preprocessing] for episode 2080 [episode count 2/20], we have num_retrieval=np.int64(9669) num_query=np.int64(299)
2025-03-13 17:39:15,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:17,196 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:17
2025-03-13 17:39:17,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.71it/s]
2025-03-13 17:39:17,227 [INFO]: There are 9669 embeddings of dim 49152
2025-03-13 17:39:17,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:39:17,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:17
2025-03-13 17:39:17,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:17,228 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 17:39:17,228 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:39:17,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:17,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:17
2025-03-13 17:39:17,228 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:17,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:39:17,228 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:17
2025-03-13 17:39:17,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:17,228 [INFO]: 	Creating the index 03/13/2025, 17:39:17
2025-03-13 17:39:17,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:17
2025-03-13 17:39:17,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:39:17,229 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:17
2025-03-13 17:39:17,229 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 17:39:17,229 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.77it/s] 12%|█▎        | 5/40 [00:00<00:01, 23.52it/s] 28%|██▊       | 11/40 [00:00<00:00, 36.42it/s] 42%|████▎     | 17/40 [00:00<00:00, 42.51it/s] 55%|█████▌    | 22/40 [00:04<00:05,  3.06it/s] 65%|██████▌   | 26/40 [00:04<00:03,  4.20it/s] 78%|███████▊  | 31/40 [00:04<00:01,  6.07it/s] 90%|█████████ | 36/40 [00:05<00:00,  8.49it/s]100%|██████████| 40/40 [00:09<00:00,  2.60it/s]100%|██████████| 40/40 [00:09<00:00,  4.23it/s]
2025-03-13 17:39:26,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:26
2025-03-13 17:40:37,216 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.5191 secs
2025-03-13 17:40:37,216 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:40:37,216 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.08it/s]
2025-03-13 17:41:16,324 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1076 secs
2025-03-13 17:41:16,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.0986 secs
2025-03-13 17:41:16,328 [INFO]: {
2025-03-13 17:41:16,328 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:16,328 [INFO]: 	index_param: efSearch=177
2025-03-13 17:41:16,328 [INFO]: 	index_path: knn.index
2025-03-13 17:41:16,328 [INFO]: 	size in bytes: 1902318310
2025-03-13 17:41:16,328 [INFO]: 	avg_search_speed_ms: 15.573992226258337
2025-03-13 17:41:16,328 [INFO]: 	99p_search_speed_ms: 29.310080395080185
2025-03-13 17:41:16,328 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:16,328 [INFO]: 	nb vectors: 9669
2025-03-13 17:41:16,328 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:16,328 [INFO]: 	compression ratio: 0.9993084448627317
2025-03-13 17:41:16,328 [INFO]: }
2025-03-13 17:41:16,328 [INFO]: 	>>> Finished "Creating the index" in 119.1002 secs
2025-03-13 17:41:16,328 [INFO]: >>> Finished "Launching the whole pipeline" in 119.1318 secs
2025-03-13 17:41:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 2080 [episode count 2/20]
[retrieval_preprocessing] for episode 27686 [episode count 3/20], we have num_retrieval=np.int64(9555) num_query=np.int64(413)
2025-03-13 17:41:21,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:22,880 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:22
2025-03-13 17:41:22,880 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.43it/s]
2025-03-13 17:41:22,915 [INFO]: There are 9555 embeddings of dim 49152
2025-03-13 17:41:22,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 17:41:22,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:22
2025-03-13 17:41:22,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:22,915 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:41:22,916 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:41:22,916 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:22,916 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:22
2025-03-13 17:41:22,916 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:22,916 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:22,916 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:22
2025-03-13 17:41:22,916 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:22,916 [INFO]: 	Creating the index 03/13/2025, 17:41:22
2025-03-13 17:41:22,916 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:22
2025-03-13 17:41:22,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:41:22,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:22
2025-03-13 17:41:22,917 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 17:41:22,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  7.93it/s] 13%|█▎        | 5/39 [00:00<00:01, 24.89it/s] 28%|██▊       | 11/39 [00:00<00:00, 36.91it/s] 41%|████      | 16/39 [00:00<00:00, 41.38it/s] 54%|█████▍    | 21/39 [00:04<00:05,  3.15it/s] 67%|██████▋   | 26/39 [00:04<00:02,  4.68it/s] 79%|███████▉  | 31/39 [00:04<00:01,  6.67it/s] 90%|████████▉ | 35/39 [00:04<00:00,  8.61it/s]100%|██████████| 39/39 [00:10<00:00,  2.06it/s]100%|██████████| 39/39 [00:10<00:00,  3.74it/s]
2025-03-13 17:41:33,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:33
2025-03-13 17:42:54,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.5798 secs
2025-03-13 17:42:54,932 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:42:54,933 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.15it/s]
2025-03-13 17:43:29,277 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3440 secs
2025-03-13 17:43:29,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.3620 secs
2025-03-13 17:43:29,279 [INFO]: {
2025-03-13 17:43:29,279 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:29,279 [INFO]: 	index_param: efSearch=187
2025-03-13 17:43:29,279 [INFO]: 	index_path: knn.index
2025-03-13 17:43:29,279 [INFO]: 	size in bytes: 1879889650
2025-03-13 17:43:29,279 [INFO]: 	avg_search_speed_ms: 11.603176217253932
2025-03-13 17:43:29,279 [INFO]: 	99p_search_speed_ms: 21.13096026936546
2025-03-13 17:43:29,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:29,279 [INFO]: 	nb vectors: 9555
2025-03-13 17:43:29,280 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:29,280 [INFO]: 	compression ratio: 0.9993083583390121
2025-03-13 17:43:29,280 [INFO]: }
2025-03-13 17:43:29,280 [INFO]: 	>>> Finished "Creating the index" in 126.3637 secs
2025-03-13 17:43:29,280 [INFO]: >>> Finished "Launching the whole pipeline" in 126.3991 secs
2025-03-13 17:43:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 27686 [episode count 3/20]
[retrieval_preprocessing] for episode 78887 [episode count 4/20], we have num_retrieval=np.int64(9495) num_query=np.int64(473)
2025-03-13 17:43:33,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:34,710 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:34
2025-03-13 17:43:34,710 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.58it/s]
2025-03-13 17:43:34,745 [INFO]: There are 9495 embeddings of dim 49152
2025-03-13 17:43:34,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 17:43:34,745 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:34
2025-03-13 17:43:34,745 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:34,745 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:43:34,745 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:43:34,745 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:34,745 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:34
2025-03-13 17:43:34,745 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:34,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:34,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:34
2025-03-13 17:43:34,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:34,746 [INFO]: 	Creating the index 03/13/2025, 17:43:34
2025-03-13 17:43:34,746 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:34
2025-03-13 17:43:34,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:43:34,747 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:34
2025-03-13 17:43:34,747 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:43:34,747 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  7.67it/s] 13%|█▎        | 5/39 [00:00<00:01, 24.02it/s] 26%|██▌       | 10/39 [00:00<00:00, 34.24it/s] 38%|███▊      | 15/39 [00:00<00:00, 32.09it/s] 49%|████▊     | 19/39 [00:00<00:01, 16.59it/s] 56%|█████▋    | 22/39 [00:05<00:08,  2.10it/s] 62%|██████▏   | 24/39 [00:05<00:05,  2.53it/s] 67%|██████▋   | 26/39 [00:06<00:04,  3.08it/s] 72%|███████▏  | 28/39 [00:06<00:02,  3.76it/s] 77%|███████▋  | 30/39 [00:06<00:01,  4.56it/s] 82%|████████▏ | 32/39 [00:06<00:01,  5.50it/s] 87%|████████▋ | 34/39 [00:06<00:00,  6.48it/s] 92%|█████████▏| 36/39 [00:06<00:00,  7.34it/s] 97%|█████████▋| 38/39 [00:07<00:00,  8.26it/s]100%|██████████| 39/39 [00:11<00:00,  3.26it/s]
2025-03-13 17:43:46,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:46
2025-03-13 17:45:06,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.7759 secs
2025-03-13 17:45:06,489 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 17:45:06,489 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 17:45:43,309 [INFO]: 	>>> Finished "Compute fast metrics" in 36.8201 secs
2025-03-13 17:45:43,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.5654 secs
2025-03-13 17:45:43,312 [INFO]: {
2025-03-13 17:45:43,312 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:43,312 [INFO]: 	index_param: efSearch=134
2025-03-13 17:45:43,312 [INFO]: 	index_path: knn.index
2025-03-13 17:45:43,312 [INFO]: 	size in bytes: 1868085010
2025-03-13 17:45:43,312 [INFO]: 	avg_search_speed_ms: 9.199323261151537
2025-03-13 17:45:43,312 [INFO]: 	99p_search_speed_ms: 15.12575669679793
2025-03-13 17:45:43,312 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:43,312 [INFO]: 	nb vectors: 9495
2025-03-13 17:45:43,312 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:43,312 [INFO]: 	compression ratio: 0.9993083558868662
2025-03-13 17:45:43,312 [INFO]: }
2025-03-13 17:45:43,312 [INFO]: 	>>> Finished "Creating the index" in 128.5668 secs
2025-03-13 17:45:43,312 [INFO]: >>> Finished "Launching the whole pipeline" in 128.6020 secs
2025-03-13 17:45:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 78887 [episode count 4/20]
[retrieval_preprocessing] for episode 25146 [episode count 5/20], we have num_retrieval=np.int64(9700) num_query=np.int64(268)
2025-03-13 17:45:47,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:48,659 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:48
2025-03-13 17:45:48,660 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 17:45:48,692 [INFO]: There are 9700 embeddings of dim 49152
2025-03-13 17:45:48,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 17:45:48,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:48
2025-03-13 17:45:48,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:48,692 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 17:45:48,692 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:45:48,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:48,692 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:48
2025-03-13 17:45:48,692 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:48,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:45:48,692 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:48
2025-03-13 17:45:48,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:48,693 [INFO]: 	Creating the index 03/13/2025, 17:45:48
2025-03-13 17:45:48,693 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:48
2025-03-13 17:45:48,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:45:48,694 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:48
2025-03-13 17:45:48,694 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 17:45:48,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.65it/s] 12%|█▎        | 5/40 [00:00<00:01, 24.03it/s] 25%|██▌       | 10/40 [00:00<00:00, 33.70it/s] 38%|███▊      | 15/40 [00:00<00:00, 38.48it/s] 50%|█████     | 20/40 [00:00<00:00, 41.22it/s] 62%|██████▎   | 25/40 [00:04<00:04,  3.27it/s] 75%|███████▌  | 30/40 [00:04<00:02,  4.79it/s] 90%|█████████ | 36/40 [00:04<00:00,  7.20it/s]100%|██████████| 40/40 [00:09<00:00,  2.27it/s]100%|██████████| 40/40 [00:09<00:00,  4.01it/s]
2025-03-13 17:45:58,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:58
2025-03-13 17:47:15,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.4153 secs
2025-03-13 17:47:15,098 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:47:15,098 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.50it/s]
2025-03-13 17:48:05,731 [INFO]: 	>>> Finished "Compute fast metrics" in 50.6322 secs
2025-03-13 17:48:05,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.0393 secs
2025-03-13 17:48:05,733 [INFO]: {
2025-03-13 17:48:05,733 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:05,733 [INFO]: 	index_param: efSearch=171
2025-03-13 17:48:05,733 [INFO]: 	index_path: knn.index
2025-03-13 17:48:05,733 [INFO]: 	size in bytes: 1908417250
2025-03-13 17:48:05,733 [INFO]: 	avg_search_speed_ms: 10.034839165889272
2025-03-13 17:48:05,733 [INFO]: 	99p_search_speed_ms: 15.018199449405072
2025-03-13 17:48:05,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:05,733 [INFO]: 	nb vectors: 9700
2025-03-13 17:48:05,733 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:05,733 [INFO]: 	compression ratio: 0.9993085107567541
2025-03-13 17:48:05,733 [INFO]: }
2025-03-13 17:48:05,733 [INFO]: 	>>> Finished "Creating the index" in 137.0408 secs
2025-03-13 17:48:05,733 [INFO]: >>> Finished "Launching the whole pipeline" in 137.0739 secs
2025-03-13 17:48:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 25146 [episode count 5/20]
[retrieval_preprocessing] for episode 52802 [episode count 6/20], we have num_retrieval=np.int64(9480) num_query=np.int64(488)
2025-03-13 17:48:09,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:11,358 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:11
2025-03-13 17:48:11,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1909.11it/s]
2025-03-13 17:48:11,392 [INFO]: There are 9480 embeddings of dim 49152
2025-03-13 17:48:11,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 17:48:11,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:11
2025-03-13 17:48:11,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:11,392 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:48:11,392 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:48:11,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:11,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:11
2025-03-13 17:48:11,392 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:11,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:11,393 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:11
2025-03-13 17:48:11,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:11,393 [INFO]: 	Creating the index 03/13/2025, 17:48:11
2025-03-13 17:48:11,393 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:11
2025-03-13 17:48:11,394 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:48:11,394 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:11
2025-03-13 17:48:11,394 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:48:11,394 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  9.14it/s] 15%|█▌        | 6/39 [00:00<00:01, 31.12it/s] 28%|██▊       | 11/39 [00:00<00:00, 38.63it/s] 41%|████      | 16/39 [00:00<00:00, 42.29it/s] 54%|█████▍    | 21/39 [00:04<00:05,  3.02it/s] 67%|██████▋   | 26/39 [00:04<00:02,  4.53it/s] 82%|████████▏ | 32/39 [00:04<00:01,  6.94it/s] 97%|█████████▋| 38/39 [00:04<00:00,  9.99it/s]100%|██████████| 39/39 [00:09<00:00,  4.20it/s]
2025-03-13 17:48:21,339 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:21
2025-03-13 17:49:42,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.0382 secs
2025-03-13 17:49:42,379 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 17:49:42,379 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 17:50:34,146 [INFO]: 	>>> Finished "Compute fast metrics" in 51.7668 secs
2025-03-13 17:50:34,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.7545 secs
2025-03-13 17:50:34,148 [INFO]: {
2025-03-13 17:50:34,148 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:34,148 [INFO]: 	index_param: efSearch=203
2025-03-13 17:50:34,148 [INFO]: 	index_path: knn.index
2025-03-13 17:50:34,148 [INFO]: 	size in bytes: 1865133790
2025-03-13 17:50:34,148 [INFO]: 	avg_search_speed_ms: 12.701251333683427
2025-03-13 17:50:34,149 [INFO]: 	99p_search_speed_ms: 20.204311618581414
2025-03-13 17:50:34,149 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:34,149 [INFO]: 	nb vectors: 9480
2025-03-13 17:50:34,149 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:34,149 [INFO]: 	compression ratio: 0.999308387416004
2025-03-13 17:50:34,149 [INFO]: }
2025-03-13 17:50:34,149 [INFO]: 	>>> Finished "Creating the index" in 142.7559 secs
2025-03-13 17:50:34,149 [INFO]: >>> Finished "Launching the whole pipeline" in 142.7903 secs
2025-03-13 17:50:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 52802 [episode count 6/20]
[retrieval_preprocessing] for episode 12908 [episode count 7/20], we have num_retrieval=np.int64(9365) num_query=np.int64(603)
2025-03-13 17:50:40,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:41,953 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:41
2025-03-13 17:50:41,953 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 917.59it/s]
2025-03-13 17:50:41,989 [INFO]: There are 9365 embeddings of dim 49152
2025-03-13 17:50:41,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 17:50:41,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:41
2025-03-13 17:50:41,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:41,991 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 17:50:41,991 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:50:41,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0013 secs
2025-03-13 17:50:41,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:41
2025-03-13 17:50:41,992 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:41,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:50:41,992 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:41
2025-03-13 17:50:41,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:41,992 [INFO]: 	Creating the index 03/13/2025, 17:50:41
2025-03-13 17:50:41,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:41
2025-03-13 17:50:41,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:50:41,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:41
2025-03-13 17:50:41,996 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:50:41,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  8.96it/s] 16%|█▌        | 6/38 [00:00<00:01, 31.21it/s] 29%|██▉       | 11/38 [00:00<00:00, 39.40it/s] 42%|████▏     | 16/38 [00:00<00:00, 43.02it/s] 55%|█████▌    | 21/38 [00:05<00:07,  2.39it/s] 66%|██████▌   | 25/38 [00:05<00:03,  3.35it/s] 76%|███████▋  | 29/38 [00:05<00:01,  4.63it/s] 87%|████████▋ | 33/38 [00:05<00:00,  6.31it/s] 97%|█████████▋| 37/38 [00:06<00:00,  8.43it/s]100%|██████████| 38/38 [00:11<00:00,  3.44it/s]
2025-03-13 17:50:53,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:53
2025-03-13 17:52:03,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.7162 secs
2025-03-13 17:52:03,766 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:52:03,766 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 17:52:41,241 [INFO]: 	>>> Finished "Compute fast metrics" in 37.4743 secs
2025-03-13 17:52:41,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.2477 secs
2025-03-13 17:52:41,244 [INFO]: {
2025-03-13 17:52:41,244 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:41,244 [INFO]: 	index_param: efSearch=201
2025-03-13 17:52:41,244 [INFO]: 	index_path: knn.index
2025-03-13 17:52:41,244 [INFO]: 	size in bytes: 1842508570
2025-03-13 17:52:41,244 [INFO]: 	avg_search_speed_ms: 12.30221846528113
2025-03-13 17:52:41,244 [INFO]: 	99p_search_speed_ms: 18.52819954045117
2025-03-13 17:52:41,244 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:41,244 [INFO]: 	nb vectors: 9365
2025-03-13 17:52:41,244 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:41,244 [INFO]: 	compression ratio: 0.9993081986044711
2025-03-13 17:52:41,244 [INFO]: }
2025-03-13 17:52:41,244 [INFO]: 	>>> Finished "Creating the index" in 119.2516 secs
2025-03-13 17:52:41,244 [INFO]: >>> Finished "Launching the whole pipeline" in 119.2902 secs
2025-03-13 17:52:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 12908 [episode count 7/20]
[retrieval_preprocessing] for episode 27253 [episode count 8/20], we have num_retrieval=np.int64(9379) num_query=np.int64(589)
2025-03-13 17:52:48,749 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:50,988 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:50
2025-03-13 17:52:50,988 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.11it/s]
2025-03-13 17:52:51,039 [INFO]: There are 9379 embeddings of dim 49152
2025-03-13 17:52:51,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0512 secs
2025-03-13 17:52:51,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:51
2025-03-13 17:52:51,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:51,040 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:52:51,040 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:52:51,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:51,040 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:51
2025-03-13 17:52:51,040 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:51,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:52:51,041 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:51
2025-03-13 17:52:51,041 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:51,041 [INFO]: 	Creating the index 03/13/2025, 17:52:51
2025-03-13 17:52:51,041 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:51
2025-03-13 17:52:51,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:52:51,043 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:51
2025-03-13 17:52:51,043 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:52:51,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.24it/s] 16%|█▌        | 6/38 [00:00<00:01, 24.98it/s] 29%|██▉       | 11/38 [00:00<00:00, 32.29it/s] 42%|████▏     | 16/38 [00:00<00:00, 35.93it/s] 55%|█████▌    | 21/38 [00:05<00:06,  2.44it/s] 66%|██████▌   | 25/38 [00:05<00:03,  3.41it/s] 79%|███████▉  | 30/38 [00:05<00:01,  5.06it/s] 92%|█████████▏| 35/38 [00:05<00:00,  7.20it/s]100%|██████████| 38/38 [00:10<00:00,  3.78it/s]
2025-03-13 17:53:01,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:01
2025-03-13 17:54:19,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.1641 secs
2025-03-13 17:54:19,260 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:54:19,260 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-13 17:55:21,826 [INFO]: 	>>> Finished "Compute fast metrics" in 62.5658 secs
2025-03-13 17:55:21,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.7856 secs
2025-03-13 17:55:21,829 [INFO]: {
2025-03-13 17:55:21,829 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:21,829 [INFO]: 	index_param: efSearch=135
2025-03-13 17:55:21,829 [INFO]: 	index_path: knn.index
2025-03-13 17:55:21,829 [INFO]: 	size in bytes: 1845262930
2025-03-13 17:55:21,829 [INFO]: 	avg_search_speed_ms: 8.80961880305298
2025-03-13 17:55:21,829 [INFO]: 	99p_search_speed_ms: 14.66149476822467
2025-03-13 17:55:21,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:21,829 [INFO]: 	nb vectors: 9379
2025-03-13 17:55:21,829 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:21,829 [INFO]: 	compression ratio: 0.9993082297491339
2025-03-13 17:55:21,829 [INFO]: }
2025-03-13 17:55:21,829 [INFO]: 	>>> Finished "Creating the index" in 150.7884 secs
2025-03-13 17:55:21,829 [INFO]: >>> Finished "Launching the whole pipeline" in 150.8408 secs
2025-03-13 17:55:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 27253 [episode count 8/20]
[retrieval_preprocessing] for episode 22149 [episode count 9/20], we have num_retrieval=np.int64(9391) num_query=np.int64(577)
2025-03-13 17:55:27,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:29,912 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:29
2025-03-13 17:55:29,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.52it/s]
2025-03-13 17:55:29,954 [INFO]: There are 9391 embeddings of dim 49152
2025-03-13 17:55:29,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0422 secs
2025-03-13 17:55:29,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:29
2025-03-13 17:55:29,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:29,954 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 17:55:29,954 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:55:29,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:29,955 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:29
2025-03-13 17:55:29,955 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:29,955 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:29,955 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:29
2025-03-13 17:55:29,955 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:29,955 [INFO]: 	Creating the index 03/13/2025, 17:55:29
2025-03-13 17:55:29,955 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:29
2025-03-13 17:55:29,956 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:55:29,956 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:29
2025-03-13 17:55:29,956 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:55:29,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.62it/s]  8%|▊         | 3/38 [00:00<00:02, 12.02it/s] 18%|█▊        | 7/38 [00:00<00:01, 22.26it/s] 29%|██▉       | 11/38 [00:00<00:00, 27.84it/s] 39%|███▉      | 15/38 [00:00<00:00, 31.36it/s] 50%|█████     | 19/38 [00:00<00:00, 33.95it/s] 61%|██████    | 23/38 [00:05<00:06,  2.48it/s] 76%|███████▋  | 29/38 [00:05<00:02,  4.17it/s] 92%|█████████▏| 35/38 [00:05<00:00,  6.40it/s]100%|██████████| 38/38 [00:09<00:00,  4.05it/s]
2025-03-13 17:55:39,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:39
2025-03-13 17:56:52,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.3181 secs
2025-03-13 17:56:52,664 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:56:52,664 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.05it/s]
2025-03-13 17:57:49,484 [INFO]: 	>>> Finished "Compute fast metrics" in 56.8205 secs
2025-03-13 17:57:49,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.5310 secs
2025-03-13 17:57:49,487 [INFO]: {
2025-03-13 17:57:49,487 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:49,487 [INFO]: 	index_param: efSearch=235
2025-03-13 17:57:49,488 [INFO]: 	index_path: knn.index
2025-03-13 17:57:49,488 [INFO]: 	size in bytes: 1847623810
2025-03-13 17:57:49,488 [INFO]: 	avg_search_speed_ms: 15.0517175387227
2025-03-13 17:57:49,488 [INFO]: 	99p_search_speed_ms: 24.310889868065715
2025-03-13 17:57:49,488 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:49,488 [INFO]: 	nb vectors: 9391
2025-03-13 17:57:49,488 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:49,488 [INFO]: 	compression ratio: 0.9993082563706516
2025-03-13 17:57:49,488 [INFO]: }
2025-03-13 17:57:49,488 [INFO]: 	>>> Finished "Creating the index" in 139.5325 secs
2025-03-13 17:57:49,488 [INFO]: >>> Finished "Launching the whole pipeline" in 139.5757 secs
2025-03-13 17:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 22149 [episode count 9/20]
[retrieval_preprocessing] for episode 76975 [episode count 10/20], we have num_retrieval=np.int64(9600) num_query=np.int64(368)
2025-03-13 17:57:59,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:00,926 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:00
2025-03-13 17:58:00,926 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 817.76it/s]
2025-03-13 17:58:00,971 [INFO]: There are 9600 embeddings of dim 49152
2025-03-13 17:58:00,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0447 secs
2025-03-13 17:58:00,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:00,971 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 17:58:00,971 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:58:00,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:00,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,971 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:00,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:58:00,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:00
2025-03-13 17:58:00,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:00,972 [INFO]: 	Creating the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:00
2025-03-13 17:58:00,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:58:00,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:00
2025-03-13 17:58:00,973 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 17:58:00,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.67it/s] 13%|█▎        | 5/39 [00:00<00:01, 20.27it/s] 23%|██▎       | 9/39 [00:00<00:01, 26.10it/s] 33%|███▎      | 13/39 [00:00<00:00, 28.81it/s] 44%|████▎     | 17/39 [00:00<00:00, 29.91it/s] 54%|█████▍    | 21/39 [00:04<00:06,  2.60it/s] 67%|██████▋   | 26/39 [00:04<00:03,  4.10it/s] 79%|███████▉  | 31/39 [00:04<00:01,  6.09it/s] 92%|█████████▏| 36/39 [00:05<00:00,  8.65it/s]100%|██████████| 39/39 [00:10<00:00,  3.81it/s]
2025-03-13 17:58:11,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:11
2025-03-13 17:59:28,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.4093 secs
2025-03-13 17:59:28,623 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 17:59:28,623 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 18:00:17,311 [INFO]: 	>>> Finished "Compute fast metrics" in 48.6878 secs
2025-03-13 18:00:17,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.3414 secs
2025-03-13 18:00:17,314 [INFO]: {
2025-03-13 18:00:17,314 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:17,314 [INFO]: 	index_param: efSearch=180
2025-03-13 18:00:17,314 [INFO]: 	index_path: knn.index
2025-03-13 18:00:17,314 [INFO]: 	size in bytes: 1888743190
2025-03-13 18:00:17,314 [INFO]: 	avg_search_speed_ms: 12.242217154630815
2025-03-13 18:00:17,314 [INFO]: 	99p_search_speed_ms: 18.536096140742302
2025-03-13 18:00:17,314 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:17,314 [INFO]: 	nb vectors: 9600
2025-03-13 18:00:17,315 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:17,315 [INFO]: 	compression ratio: 0.9993083284128215
2025-03-13 18:00:17,315 [INFO]: }
2025-03-13 18:00:17,315 [INFO]: 	>>> Finished "Creating the index" in 136.3429 secs
2025-03-13 18:00:17,315 [INFO]: >>> Finished "Launching the whole pipeline" in 136.3884 secs
2025-03-13 18:00:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 76975 [episode count 10/20]
[retrieval_preprocessing] for episode 27333 [episode count 11/20], we have num_retrieval=np.int64(9332) num_query=np.int64(636)
2025-03-13 18:00:21,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:22,984 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:22
2025-03-13 18:00:22,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.72it/s]
2025-03-13 18:00:23,021 [INFO]: There are 9332 embeddings of dim 49152
2025-03-13 18:00:23,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 18:00:23,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:23
2025-03-13 18:00:23,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:23,022 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 18:00:23,022 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:00:23,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:23,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:23
2025-03-13 18:00:23,022 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:23,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:23,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:23
2025-03-13 18:00:23,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:23,022 [INFO]: 	Creating the index 03/13/2025, 18:00:23
2025-03-13 18:00:23,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:23
2025-03-13 18:00:23,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:23,023 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:23
2025-03-13 18:00:23,023 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:00:23,023 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.92it/s] 11%|█         | 4/38 [00:00<00:02, 16.87it/s] 21%|██        | 8/38 [00:00<00:01, 25.45it/s] 32%|███▏      | 12/38 [00:00<00:00, 30.38it/s] 45%|████▍     | 17/38 [00:00<00:00, 34.90it/s] 55%|█████▌    | 21/38 [00:05<00:07,  2.40it/s] 66%|██████▌   | 25/38 [00:05<00:03,  3.45it/s] 76%|███████▋  | 29/38 [00:05<00:01,  4.86it/s] 87%|████████▋ | 33/38 [00:05<00:00,  6.67it/s] 97%|█████████▋| 37/38 [00:05<00:00,  8.90it/s]100%|██████████| 38/38 [00:10<00:00,  3.64it/s]
2025-03-13 18:00:33,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:33
2025-03-13 18:01:48,557 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.0798 secs
2025-03-13 18:01:48,558 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 18:01:48,558 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 18:02:30,868 [INFO]: 	>>> Finished "Compute fast metrics" in 42.3101 secs
2025-03-13 18:02:30,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.8476 secs
2025-03-13 18:02:30,871 [INFO]: {
2025-03-13 18:02:30,871 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:30,871 [INFO]: 	index_param: efSearch=194
2025-03-13 18:02:30,871 [INFO]: 	index_path: knn.index
2025-03-13 18:02:30,871 [INFO]: 	size in bytes: 1836016090
2025-03-13 18:02:30,871 [INFO]: 	avg_search_speed_ms: 12.088515225500949
2025-03-13 18:02:30,871 [INFO]: 	99p_search_speed_ms: 18.83720155339688
2025-03-13 18:02:30,871 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:30,871 [INFO]: 	nb vectors: 9332
2025-03-13 18:02:30,871 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:30,871 [INFO]: 	compression ratio: 0.9993081574791646
2025-03-13 18:02:30,871 [INFO]: }
2025-03-13 18:02:30,871 [INFO]: 	>>> Finished "Creating the index" in 127.8491 secs
2025-03-13 18:02:30,871 [INFO]: >>> Finished "Launching the whole pipeline" in 127.8869 secs
2025-03-13 18:02:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 27333 [episode count 11/20]
[retrieval_preprocessing] for episode 9445 [episode count 12/20], we have num_retrieval=np.int64(9411) num_query=np.int64(557)
2025-03-13 18:02:38,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:39,693 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:39
2025-03-13 18:02:39,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.63it/s]
2025-03-13 18:02:39,732 [INFO]: There are 9411 embeddings of dim 49152
2025-03-13 18:02:39,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0389 secs
2025-03-13 18:02:39,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:39,732 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:02:39,732 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:02:39,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:02:39,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,733 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:39,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:02:39,733 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:39
2025-03-13 18:02:39,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:39,733 [INFO]: 	Creating the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,733 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:39
2025-03-13 18:02:39,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:02:39,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,734 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:02:39,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  7.39it/s] 13%|█▎        | 5/39 [00:00<00:01, 23.74it/s] 26%|██▌       | 10/39 [00:00<00:00, 33.21it/s] 38%|███▊      | 15/39 [00:00<00:00, 37.77it/s] 51%|█████▏    | 20/39 [00:00<00:00, 40.32it/s] 64%|██████▍   | 25/39 [00:05<00:04,  2.89it/s] 77%|███████▋  | 30/39 [00:05<00:02,  4.24it/s] 90%|████████▉ | 35/39 [00:05<00:00,  6.01it/s]100%|██████████| 39/39 [00:09<00:00,  2.38it/s]100%|██████████| 39/39 [00:09<00:00,  4.00it/s]
2025-03-13 18:02:49,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:49
2025-03-13 18:04:06,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.7021 secs
2025-03-13 18:04:06,194 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:04:06,195 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 18:04:46,580 [INFO]: 	>>> Finished "Compute fast metrics" in 40.3855 secs
2025-03-13 18:04:46,583 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.8492 secs
2025-03-13 18:04:46,584 [INFO]: {
2025-03-13 18:04:46,584 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:46,584 [INFO]: 	index_param: efSearch=203
2025-03-13 18:04:46,584 [INFO]: 	index_path: knn.index
2025-03-13 18:04:46,584 [INFO]: 	size in bytes: 1851558610
2025-03-13 18:04:46,584 [INFO]: 	avg_search_speed_ms: 13.777842210251684
2025-03-13 18:04:46,584 [INFO]: 	99p_search_speed_ms: 29.34074541553855
2025-03-13 18:04:46,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:46,584 [INFO]: 	nb vectors: 9411
2025-03-13 18:04:46,584 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:46,584 [INFO]: 	compression ratio: 0.9993083005889832
2025-03-13 18:04:46,584 [INFO]: }
2025-03-13 18:04:46,584 [INFO]: 	>>> Finished "Creating the index" in 126.8510 secs
2025-03-13 18:04:46,584 [INFO]: >>> Finished "Launching the whole pipeline" in 126.8908 secs
2025-03-13 18:04:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 9445 [episode count 12/20]
[retrieval_preprocessing] for episode 92926 [episode count 13/20], we have num_retrieval=np.int64(9537) num_query=np.int64(431)
2025-03-13 18:04:53,949 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:55,350 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:55
2025-03-13 18:04:55,350 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1072.99it/s]
2025-03-13 18:04:55,385 [INFO]: There are 9537 embeddings of dim 49152
2025-03-13 18:04:55,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 18:04:55,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:55,386 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:04:55,386 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:04:55,386 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:55,386 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,386 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:55,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:55,386 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:55
2025-03-13 18:04:55,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:55,386 [INFO]: 	Creating the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:55
2025-03-13 18:04:55,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:04:55,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:55
2025-03-13 18:04:55,388 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:04:55,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.77it/s] 15%|█▌        | 6/39 [00:00<00:01, 26.93it/s] 28%|██▊       | 11/39 [00:00<00:00, 36.01it/s] 41%|████      | 16/39 [00:00<00:00, 40.89it/s] 54%|█████▍    | 21/39 [00:04<00:06,  2.78it/s] 69%|██████▉   | 27/39 [00:05<00:02,  4.47it/s] 79%|███████▉  | 31/39 [00:05<00:01,  5.90it/s] 95%|█████████▍| 37/39 [00:05<00:00,  8.85it/s]100%|██████████| 39/39 [00:09<00:00,  4.14it/s]
2025-03-13 18:05:04,820 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:04
2025-03-13 18:06:23,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.9981 secs
2025-03-13 18:06:23,819 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 18:06:23,819 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 18:07:07,486 [INFO]: 	>>> Finished "Compute fast metrics" in 43.6670 secs
2025-03-13 18:07:07,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.1024 secs
2025-03-13 18:07:07,490 [INFO]: {
2025-03-13 18:07:07,490 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:07,490 [INFO]: 	index_param: efSearch=166
2025-03-13 18:07:07,490 [INFO]: 	index_path: knn.index
2025-03-13 18:07:07,490 [INFO]: 	size in bytes: 1876348270
2025-03-13 18:07:07,490 [INFO]: 	avg_search_speed_ms: 17.043801697662808
2025-03-13 18:07:07,490 [INFO]: 	99p_search_speed_ms: 29.887435394339263
2025-03-13 18:07:07,490 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:07,490 [INFO]: 	nb vectors: 9537
2025-03-13 18:07:07,490 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:07,490 [INFO]: 	compression ratio: 0.9993083512156301
2025-03-13 18:07:07,490 [INFO]: }
2025-03-13 18:07:07,490 [INFO]: 	>>> Finished "Creating the index" in 132.1043 secs
2025-03-13 18:07:07,491 [INFO]: >>> Finished "Launching the whole pipeline" in 132.1408 secs
2025-03-13 18:07:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 92926 [episode count 13/20]
[retrieval_preprocessing] for episode 61731 [episode count 14/20], we have num_retrieval=np.int64(9324) num_query=np.int64(644)
2025-03-13 18:07:11,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:13,381 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:13
2025-03-13 18:07:13,381 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.92it/s]
2025-03-13 18:07:13,418 [INFO]: There are 9324 embeddings of dim 49152
2025-03-13 18:07:13,418 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 18:07:13,418 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:13
2025-03-13 18:07:13,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:13,419 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 18:07:13,419 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:07:13,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:13,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:13
2025-03-13 18:07:13,419 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:13,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:07:13,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:13
2025-03-13 18:07:13,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:13,419 [INFO]: 	Creating the index 03/13/2025, 18:07:13
2025-03-13 18:07:13,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:13
2025-03-13 18:07:13,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:07:13,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:13
2025-03-13 18:07:13,420 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:07:13,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.35it/s] 11%|█         | 4/38 [00:00<00:01, 17.29it/s] 21%|██        | 8/38 [00:00<00:01, 26.23it/s] 32%|███▏      | 12/38 [00:00<00:00, 30.87it/s] 42%|████▏     | 16/38 [00:00<00:00, 33.49it/s] 53%|█████▎    | 20/38 [00:00<00:00, 35.18it/s] 63%|██████▎   | 24/38 [00:04<00:05,  2.67it/s] 76%|███████▋  | 29/38 [00:04<00:02,  4.16it/s] 89%|████████▉ | 34/38 [00:05<00:00,  6.12it/s]100%|██████████| 38/38 [00:09<00:00,  2.42it/s]100%|██████████| 38/38 [00:09<00:00,  4.13it/s]
2025-03-13 18:07:22,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:22
2025-03-13 18:08:37,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.8878 secs
2025-03-13 18:08:37,514 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 18:08:37,514 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.63it/s]
2025-03-13 18:09:25,179 [INFO]: 	>>> Finished "Compute fast metrics" in 47.6649 secs
2025-03-13 18:09:25,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.7613 secs
2025-03-13 18:09:25,182 [INFO]: {
2025-03-13 18:09:25,182 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:25,182 [INFO]: 	index_param: efSearch=201
2025-03-13 18:09:25,182 [INFO]: 	index_path: knn.index
2025-03-13 18:09:25,182 [INFO]: 	size in bytes: 1834442110
2025-03-13 18:09:25,182 [INFO]: 	avg_search_speed_ms: 11.484480335994117
2025-03-13 18:09:25,182 [INFO]: 	99p_search_speed_ms: 17.04347571358083
2025-03-13 18:09:25,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:25,182 [INFO]: 	nb vectors: 9324
2025-03-13 18:09:25,182 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:25,182 [INFO]: 	compression ratio: 0.999308172226814
2025-03-13 18:09:25,182 [INFO]: }
2025-03-13 18:09:25,182 [INFO]: 	>>> Finished "Creating the index" in 131.7629 secs
2025-03-13 18:09:25,182 [INFO]: >>> Finished "Launching the whole pipeline" in 131.8011 secs
2025-03-13 18:09:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 61731 [episode count 14/20]
[retrieval_preprocessing] for episode 78118 [episode count 15/20], we have num_retrieval=np.int64(9471) num_query=np.int64(497)
2025-03-13 18:09:31,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:32,849 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:32
2025-03-13 18:09:32,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.21it/s]
2025-03-13 18:09:32,884 [INFO]: There are 9471 embeddings of dim 49152
2025-03-13 18:09:32,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 18:09:32,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:32
2025-03-13 18:09:32,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:32,886 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:09:32,886 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:09:32,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 18:09:32,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:32
2025-03-13 18:09:32,887 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:32,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:09:32,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:32
2025-03-13 18:09:32,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:32,887 [INFO]: 	Creating the index 03/13/2025, 18:09:32
2025-03-13 18:09:32,887 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:32
2025-03-13 18:09:32,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:09:32,891 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:32
2025-03-13 18:09:32,891 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:09:32,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  7.89it/s] 18%|█▊        | 7/39 [00:00<00:00, 32.44it/s] 33%|███▎      | 13/39 [00:00<00:00, 41.21it/s] 49%|████▊     | 19/39 [00:00<00:00, 45.29it/s] 62%|██████▏   | 24/39 [00:04<00:04,  3.46it/s] 77%|███████▋  | 30/39 [00:04<00:01,  5.33it/s] 92%|█████████▏| 36/39 [00:04<00:00,  7.74it/s]100%|██████████| 39/39 [00:09<00:00,  4.05it/s]
2025-03-13 18:09:42,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:42
2025-03-13 18:11:03,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.1371 secs
2025-03-13 18:11:03,672 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 18:11:03,672 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 18:12:09,376 [INFO]: 	>>> Finished "Compute fast metrics" in 65.7042 secs
2025-03-13 18:12:09,380 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.4886 secs
2025-03-13 18:12:09,380 [INFO]: {
2025-03-13 18:12:09,380 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:09,380 [INFO]: 	index_param: efSearch=173
2025-03-13 18:12:09,380 [INFO]: 	index_path: knn.index
2025-03-13 18:12:09,380 [INFO]: 	size in bytes: 1863363070
2025-03-13 18:12:09,380 [INFO]: 	avg_search_speed_ms: 12.889815159874114
2025-03-13 18:12:09,380 [INFO]: 	99p_search_speed_ms: 24.221692932769656
2025-03-13 18:12:09,380 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:09,380 [INFO]: 	nb vectors: 9471
2025-03-13 18:12:09,380 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:09,380 [INFO]: 	compression ratio: 0.9993083999459107
2025-03-13 18:12:09,380 [INFO]: }
2025-03-13 18:12:09,380 [INFO]: 	>>> Finished "Creating the index" in 156.4925 secs
2025-03-13 18:12:09,380 [INFO]: >>> Finished "Launching the whole pipeline" in 156.5310 secs
2025-03-13 18:12:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 78118 [episode count 15/20]
[retrieval_preprocessing] for episode 54581 [episode count 16/20], we have num_retrieval=np.int64(9453) num_query=np.int64(515)
2025-03-13 18:12:15,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:17,754 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:17
2025-03-13 18:12:17,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.90it/s]
2025-03-13 18:12:17,791 [INFO]: There are 9453 embeddings of dim 49152
2025-03-13 18:12:17,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 18:12:17,791 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:17
2025-03-13 18:12:17,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:17,791 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:12:17,791 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:12:17,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:17,791 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:17
2025-03-13 18:12:17,792 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:17,792 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:17,792 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:17
2025-03-13 18:12:17,792 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:17,792 [INFO]: 	Creating the index 03/13/2025, 18:12:17
2025-03-13 18:12:17,792 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:17
2025-03-13 18:12:17,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:12:17,793 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:17
2025-03-13 18:12:17,793 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:12:17,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  6.29it/s] 13%|█▎        | 5/39 [00:00<00:01, 21.04it/s] 26%|██▌       | 10/39 [00:00<00:00, 30.35it/s] 38%|███▊      | 15/39 [00:00<00:00, 35.34it/s] 51%|█████▏    | 20/39 [00:00<00:00, 37.93it/s] 62%|██████▏   | 24/39 [00:05<00:06,  2.50it/s] 74%|███████▍  | 29/39 [00:05<00:02,  3.78it/s] 87%|████████▋ | 34/39 [00:05<00:00,  5.46it/s]100%|██████████| 39/39 [00:10<00:00,  2.38it/s]100%|██████████| 39/39 [00:10<00:00,  3.79it/s]
2025-03-13 18:12:28,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:28
2025-03-13 18:13:44,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2668 secs
2025-03-13 18:13:44,361 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:13:44,361 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.59it/s]
2025-03-13 18:14:24,560 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1994 secs
2025-03-13 18:14:24,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.7699 secs
2025-03-13 18:14:24,563 [INFO]: {
2025-03-13 18:14:24,563 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:24,563 [INFO]: 	index_param: efSearch=228
2025-03-13 18:14:24,563 [INFO]: 	index_path: knn.index
2025-03-13 18:14:24,563 [INFO]: 	size in bytes: 1859821750
2025-03-13 18:14:24,563 [INFO]: 	avg_search_speed_ms: 15.903087403175135
2025-03-13 18:14:24,563 [INFO]: 	99p_search_speed_ms: 27.362998099997643
2025-03-13 18:14:24,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:24,563 [INFO]: 	nb vectors: 9453
2025-03-13 18:14:24,563 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:24,563 [INFO]: 	compression ratio: 0.9993083605996113
2025-03-13 18:14:24,563 [INFO]: }
2025-03-13 18:14:24,563 [INFO]: 	>>> Finished "Creating the index" in 126.7716 secs
2025-03-13 18:14:24,563 [INFO]: >>> Finished "Launching the whole pipeline" in 126.8089 secs
2025-03-13 18:14:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 54581 [episode count 16/20]
[retrieval_preprocessing] for episode 7512 [episode count 17/20], we have num_retrieval=np.int64(9441) num_query=np.int64(527)
2025-03-13 18:14:31,664 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:33,579 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:33
2025-03-13 18:14:33,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.78it/s]
2025-03-13 18:14:33,621 [INFO]: There are 9441 embeddings of dim 49152
2025-03-13 18:14:33,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0422 secs
2025-03-13 18:14:33,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:33
2025-03-13 18:14:33,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:33,622 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:14:33,622 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:14:33,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:33,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:33
2025-03-13 18:14:33,622 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:33,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:33,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:33
2025-03-13 18:14:33,622 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:33,622 [INFO]: 	Creating the index 03/13/2025, 18:14:33
2025-03-13 18:14:33,622 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:33
2025-03-13 18:14:33,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:14:33,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:33
2025-03-13 18:14:33,624 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:14:33,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  5.48it/s] 10%|█         | 4/39 [00:00<00:02, 15.86it/s] 21%|██        | 8/39 [00:00<00:01, 23.68it/s] 31%|███       | 12/39 [00:00<00:00, 27.14it/s] 41%|████      | 16/39 [00:00<00:00, 29.29it/s] 51%|█████▏    | 20/39 [00:00<00:00, 30.85it/s] 62%|██████▏   | 24/39 [00:06<00:07,  2.04it/s] 69%|██████▉   | 27/39 [00:06<00:04,  2.57it/s] 74%|███████▍  | 29/39 [00:06<00:03,  3.00it/s] 79%|███████▉  | 31/39 [00:07<00:02,  3.54it/s] 85%|████████▍ | 33/39 [00:07<00:01,  4.19it/s] 90%|████████▉ | 35/39 [00:07<00:00,  4.86it/s] 95%|█████████▍| 37/39 [00:07<00:00,  5.60it/s]100%|██████████| 39/39 [00:13<00:00,  1.03it/s]100%|██████████| 39/39 [00:13<00:00,  2.83it/s]
2025-03-13 18:14:47,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:47
2025-03-13 18:16:06,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.3542 secs
2025-03-13 18:16:06,759 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 18:16:06,759 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 18:16:53,018 [INFO]: 	>>> Finished "Compute fast metrics" in 46.2588 secs
2025-03-13 18:16:53,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.3980 secs
2025-03-13 18:16:53,022 [INFO]: {
2025-03-13 18:16:53,022 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:53,022 [INFO]: 	index_param: efSearch=184
2025-03-13 18:16:53,022 [INFO]: 	index_path: knn.index
2025-03-13 18:16:53,022 [INFO]: 	size in bytes: 1857460870
2025-03-13 18:16:53,022 [INFO]: 	avg_search_speed_ms: 10.688571505145067
2025-03-13 18:16:53,022 [INFO]: 	99p_search_speed_ms: 19.179705402348183
2025-03-13 18:16:53,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:53,022 [INFO]: 	nb vectors: 9441
2025-03-13 18:16:53,022 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:53,022 [INFO]: 	compression ratio: 0.9993083342853947
2025-03-13 18:16:53,022 [INFO]: }
2025-03-13 18:16:53,022 [INFO]: 	>>> Finished "Creating the index" in 139.3998 secs
2025-03-13 18:16:53,022 [INFO]: >>> Finished "Launching the whole pipeline" in 139.4426 secs
2025-03-13 18:16:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 7512 [episode count 17/20]
[retrieval_preprocessing] for episode 69464 [episode count 18/20], we have num_retrieval=np.int64(9455) num_query=np.int64(513)
2025-03-13 18:17:02,280 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:03,553 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:03
2025-03-13 18:17:03,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.07it/s]
2025-03-13 18:17:03,579 [INFO]: There are 9455 embeddings of dim 49152
2025-03-13 18:17:03,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:17:03,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:03
2025-03-13 18:17:03,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:03,579 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:17:03,579 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:17:03,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:03,579 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:03
2025-03-13 18:17:03,580 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:03,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:03,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:03
2025-03-13 18:17:03,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:03,580 [INFO]: 	Creating the index 03/13/2025, 18:17:03
2025-03-13 18:17:03,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:03
2025-03-13 18:17:03,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:17:03,581 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:03
2025-03-13 18:17:03,581 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:17:03,581 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:08,  4.72it/s]  8%|▊         | 3/39 [00:00<00:03,  9.06it/s] 13%|█▎        | 5/39 [00:00<00:03, 10.91it/s] 18%|█▊        | 7/39 [00:00<00:02, 12.00it/s] 23%|██▎       | 9/39 [00:00<00:02, 12.53it/s] 28%|██▊       | 11/39 [00:00<00:02, 12.84it/s] 33%|███▎      | 13/39 [00:01<00:01, 13.23it/s] 38%|███▊      | 15/39 [00:01<00:01, 13.76it/s] 44%|████▎     | 17/39 [00:01<00:01, 13.90it/s] 49%|████▊     | 19/39 [00:01<00:01, 14.46it/s] 54%|█████▍    | 21/39 [00:05<00:10,  1.68it/s] 59%|█████▉    | 23/39 [00:05<00:07,  2.26it/s] 64%|██████▍   | 25/39 [00:05<00:04,  3.01it/s] 69%|██████▉   | 27/39 [00:05<00:03,  3.91it/s] 74%|███████▍  | 29/39 [00:05<00:02,  4.94it/s] 79%|███████▉  | 31/39 [00:05<00:01,  6.00it/s] 85%|████████▍ | 33/39 [00:06<00:00,  7.17it/s] 90%|████████▉ | 35/39 [00:06<00:00,  8.31it/s] 95%|█████████▍| 37/39 [00:06<00:00,  9.06it/s]100%|██████████| 39/39 [00:10<00:00,  1.43it/s]100%|██████████| 39/39 [00:10<00:00,  3.72it/s]
2025-03-13 18:17:14,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:14
2025-03-13 18:18:28,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.1918 secs
2025-03-13 18:18:28,272 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:18:28,272 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 18:19:24,140 [INFO]: 	>>> Finished "Compute fast metrics" in 55.8682 secs
2025-03-13 18:19:24,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.5629 secs
2025-03-13 18:19:24,144 [INFO]: {
2025-03-13 18:19:24,144 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:24,144 [INFO]: 	index_param: efSearch=222
2025-03-13 18:19:24,144 [INFO]: 	index_path: knn.index
2025-03-13 18:19:24,144 [INFO]: 	size in bytes: 1860215230
2025-03-13 18:19:24,144 [INFO]: 	avg_search_speed_ms: 13.401845775524695
2025-03-13 18:19:24,144 [INFO]: 	99p_search_speed_ms: 23.882807791233056
2025-03-13 18:19:24,144 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:24,144 [INFO]: 	nb vectors: 9455
2025-03-13 18:19:24,144 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:24,144 [INFO]: 	compression ratio: 0.9993083649788203
2025-03-13 18:19:24,144 [INFO]: }
2025-03-13 18:19:24,144 [INFO]: 	>>> Finished "Creating the index" in 140.5643 secs
2025-03-13 18:19:24,144 [INFO]: >>> Finished "Launching the whole pipeline" in 140.5905 secs
2025-03-13 18:19:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 69464 [episode count 18/20]
[retrieval_preprocessing] for episode 47469 [episode count 19/20], we have num_retrieval=np.int64(9559) num_query=np.int64(409)
2025-03-13 18:19:32,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:34,770 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:34
2025-03-13 18:19:34,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 933.10it/s]
2025-03-13 18:19:34,800 [INFO]: There are 9559 embeddings of dim 49152
2025-03-13 18:19:34,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 18:19:34,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:34
2025-03-13 18:19:34,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:34,801 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:19:34,801 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:19:34,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:19:34,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:34
2025-03-13 18:19:34,802 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:34,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:19:34,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:34
2025-03-13 18:19:34,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:34,802 [INFO]: 	Creating the index 03/13/2025, 18:19:34
2025-03-13 18:19:34,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:34
2025-03-13 18:19:34,805 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:19:34,806 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:34
2025-03-13 18:19:34,806 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:19:34,806 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:07,  5.23it/s]  8%|▊         | 3/39 [00:00<00:03,  9.79it/s] 13%|█▎        | 5/39 [00:00<00:02, 11.38it/s] 18%|█▊        | 7/39 [00:00<00:02, 12.28it/s] 23%|██▎       | 9/39 [00:00<00:02, 12.85it/s] 28%|██▊       | 11/39 [00:00<00:02, 13.23it/s] 33%|███▎      | 13/39 [00:01<00:01, 13.55it/s] 38%|███▊      | 15/39 [00:01<00:01, 14.01it/s] 44%|████▎     | 17/39 [00:01<00:01, 14.76it/s] 49%|████▊     | 19/39 [00:01<00:01, 15.91it/s] 54%|█████▍    | 21/39 [00:05<00:11,  1.57it/s] 59%|█████▉    | 23/39 [00:05<00:07,  2.12it/s] 64%|██████▍   | 25/39 [00:05<00:04,  2.82it/s] 69%|██████▉   | 27/39 [00:05<00:03,  3.64it/s] 74%|███████▍  | 29/39 [00:05<00:02,  4.58it/s] 79%|███████▉  | 31/39 [00:06<00:01,  5.59it/s] 85%|████████▍ | 33/39 [00:06<00:00,  6.53it/s] 90%|████████▉ | 35/39 [00:06<00:00,  7.48it/s] 95%|█████████▍| 37/39 [00:06<00:00,  8.20it/s]100%|██████████| 39/39 [00:10<00:00,  1.39it/s]100%|██████████| 39/39 [00:10<00:00,  3.56it/s]
2025-03-13 18:19:45,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:45
2025-03-13 18:21:01,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.6931 secs
2025-03-13 18:21:01,466 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:21:01,466 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.54it/s] 50%|█████     | 2/4 [00:00<00:00,  5.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-13 18:21:52,191 [INFO]: 	>>> Finished "Compute fast metrics" in 50.7253 secs
2025-03-13 18:21:52,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.3883 secs
2025-03-13 18:21:52,194 [INFO]: {
2025-03-13 18:21:52,194 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:52,194 [INFO]: 	index_param: efSearch=196
2025-03-13 18:21:52,194 [INFO]: 	index_path: knn.index
2025-03-13 18:21:52,194 [INFO]: 	size in bytes: 1880676610
2025-03-13 18:21:52,194 [INFO]: 	avg_search_speed_ms: 10.355474336475798
2025-03-13 18:21:52,194 [INFO]: 	99p_search_speed_ms: 15.780893841292716
2025-03-13 18:21:52,194 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:52,194 [INFO]: 	nb vectors: 9559
2025-03-13 18:21:52,194 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:52,194 [INFO]: 	compression ratio: 0.9993083670030862
2025-03-13 18:21:52,194 [INFO]: }
2025-03-13 18:21:52,194 [INFO]: 	>>> Finished "Creating the index" in 137.3922 secs
2025-03-13 18:21:52,194 [INFO]: >>> Finished "Launching the whole pipeline" in 137.4242 secs
2025-03-13 18:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 47469 [episode count 19/20]
2025-03-13 18:21:56: [retrieval_preprocessing] finished for 6486961974_put_ropes_in_blue_box [chosen_id count 6/196]
2025-03-13 18:22:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6486961974_pick_up_ropes_and_put_in_box [chosen_id count 7/196]
2025-03-13 18:22:02: [retrieval_preprocessing] we have num_total=10216 embedding_dim=49152
[retrieval_preprocessing] for episode 6223 [episode count 0/20], we have num_retrieval=np.int64(9811) num_query=np.int64(405)
2025-03-13 18:22:05,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:06,875 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:06
2025-03-13 18:22:06,875 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.93it/s]
2025-03-13 18:22:06,903 [INFO]: There are 9811 embeddings of dim 49152
2025-03-13 18:22:06,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 18:22:06,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:06
2025-03-13 18:22:06,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:06,904 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:22:06,904 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:22:06,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:22:06,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:06
2025-03-13 18:22:06,905 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:06,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:22:06,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:06
2025-03-13 18:22:06,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:06,905 [INFO]: 	Creating the index 03/13/2025, 18:22:06
2025-03-13 18:22:06,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:06
2025-03-13 18:22:06,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:22:06,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:06
2025-03-13 18:22:06,909 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:22:06,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:08,  4.48it/s]  8%|▊         | 3/40 [00:00<00:04,  9.09it/s] 12%|█▎        | 5/40 [00:00<00:03,  8.75it/s] 18%|█▊        | 7/40 [00:00<00:03,  9.66it/s] 22%|██▎       | 9/40 [00:00<00:03,  9.48it/s] 28%|██▊       | 11/40 [00:01<00:02, 10.13it/s] 32%|███▎      | 13/40 [00:01<00:02,  9.85it/s] 38%|███▊      | 15/40 [00:01<00:02,  9.17it/s] 40%|████      | 16/40 [00:01<00:02,  9.19it/s] 45%|████▌     | 18/40 [00:01<00:02, 10.55it/s] 50%|█████     | 20/40 [00:02<00:01, 11.32it/s] 55%|█████▌    | 22/40 [00:06<00:12,  1.41it/s] 60%|██████    | 24/40 [00:06<00:08,  1.96it/s] 65%|██████▌   | 26/40 [00:06<00:05,  2.66it/s] 70%|███████   | 28/40 [00:06<00:03,  3.60it/s] 75%|███████▌  | 30/40 [00:06<00:02,  4.71it/s] 80%|████████  | 32/40 [00:06<00:01,  6.05it/s] 88%|████████▊ | 35/40 [00:06<00:00,  8.40it/s] 95%|█████████▌| 38/40 [00:07<00:00, 10.48it/s]100%|██████████| 40/40 [00:11<00:00,  1.65it/s]100%|██████████| 40/40 [00:11<00:00,  3.56it/s]
2025-03-13 18:22:18,142 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:18
2025-03-13 18:23:32,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.0537 secs
2025-03-13 18:23:32,196 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 18:23:32,196 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 18:24:11,818 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6212 secs
2025-03-13 18:24:11,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.9126 secs
2025-03-13 18:24:11,822 [INFO]: {
2025-03-13 18:24:11,822 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:11,822 [INFO]: 	index_param: efSearch=175
2025-03-13 18:24:11,822 [INFO]: 	index_path: knn.index
2025-03-13 18:24:11,822 [INFO]: 	size in bytes: 1930256170
2025-03-13 18:24:11,822 [INFO]: 	avg_search_speed_ms: 10.427890770084868
2025-03-13 18:24:11,822 [INFO]: 	99p_search_speed_ms: 18.414479470811777
2025-03-13 18:24:11,822 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:11,822 [INFO]: 	nb vectors: 9811
2025-03-13 18:24:11,822 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:11,822 [INFO]: 	compression ratio: 0.9993083394728898
2025-03-13 18:24:11,822 [INFO]: }
2025-03-13 18:24:11,822 [INFO]: 	>>> Finished "Creating the index" in 124.9164 secs
2025-03-13 18:24:11,822 [INFO]: >>> Finished "Launching the whole pipeline" in 124.9470 secs
2025-03-13 18:24:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 6223 [episode count 0/20]
[retrieval_preprocessing] for episode 2128 [episode count 1/20], we have num_retrieval=np.int64(9936) num_query=np.int64(280)
2025-03-13 18:24:19,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:21,038 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:21
2025-03-13 18:24:21,038 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.67it/s]
2025-03-13 18:24:21,067 [INFO]: There are 9936 embeddings of dim 49152
2025-03-13 18:24:21,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:24:21,068 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:21
2025-03-13 18:24:21,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:21,068 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 18:24:21,068 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:24:21,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:24:21,069 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:21
2025-03-13 18:24:21,069 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:21,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:24:21,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:21
2025-03-13 18:24:21,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:21,069 [INFO]: 	Creating the index 03/13/2025, 18:24:21
2025-03-13 18:24:21,070 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:21
2025-03-13 18:24:21,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:24:21,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:21
2025-03-13 18:24:21,073 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:24:21,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:08,  4.67it/s]  7%|▋         | 3/41 [00:00<00:04,  8.69it/s] 12%|█▏        | 5/41 [00:00<00:03,  9.64it/s] 17%|█▋        | 7/41 [00:00<00:03, 10.01it/s] 22%|██▏       | 9/41 [00:00<00:03, 10.43it/s] 27%|██▋       | 11/41 [00:01<00:02, 10.68it/s] 32%|███▏      | 13/41 [00:01<00:02, 10.99it/s] 37%|███▋      | 15/41 [00:01<00:02, 11.29it/s] 41%|████▏     | 17/41 [00:01<00:02, 11.40it/s] 46%|████▋     | 19/41 [00:01<00:01, 11.72it/s] 51%|█████     | 21/41 [00:05<00:13,  1.46it/s] 54%|█████▎    | 22/41 [00:05<00:11,  1.72it/s] 59%|█████▊    | 24/41 [00:06<00:07,  2.40it/s] 63%|██████▎   | 26/41 [00:06<00:04,  3.19it/s] 66%|██████▌   | 27/41 [00:06<00:03,  3.66it/s] 68%|██████▊   | 28/41 [00:06<00:03,  4.22it/s] 71%|███████   | 29/41 [00:06<00:02,  4.87it/s] 76%|███████▌  | 31/41 [00:06<00:01,  6.16it/s] 80%|████████  | 33/41 [00:07<00:01,  7.24it/s] 85%|████████▌ | 35/41 [00:07<00:00,  7.88it/s] 88%|████████▊ | 36/41 [00:07<00:00,  8.09it/s] 90%|█████████ | 37/41 [00:07<00:00,  8.22it/s] 93%|█████████▎| 38/41 [00:07<00:00,  8.40it/s] 95%|█████████▌| 39/41 [00:07<00:00,  8.57it/s] 98%|█████████▊| 40/41 [00:07<00:00,  8.83it/s]100%|██████████| 41/41 [00:13<00:00,  1.51s/it]100%|██████████| 41/41 [00:13<00:00,  3.15it/s]
2025-03-13 18:24:34,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:34
2025-03-13 18:25:37,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.5446 secs
2025-03-13 18:25:37,633 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 18:25:37,634 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:26:43,429 [INFO]: 	>>> Finished "Compute fast metrics" in 65.7957 secs
2025-03-13 18:26:43,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.3608 secs
2025-03-13 18:26:43,434 [INFO]: {
2025-03-13 18:26:43,434 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:43,434 [INFO]: 	index_param: efSearch=177
2025-03-13 18:26:43,434 [INFO]: 	index_path: knn.index
2025-03-13 18:26:43,434 [INFO]: 	size in bytes: 1954849450
2025-03-13 18:26:43,434 [INFO]: 	avg_search_speed_ms: 12.610394138753676
2025-03-13 18:26:43,434 [INFO]: 	99p_search_speed_ms: 20.374938433524214
2025-03-13 18:26:43,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:43,434 [INFO]: 	nb vectors: 9936
2025-03-13 18:26:43,434 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:43,434 [INFO]: 	compression ratio: 0.9993082014576621
2025-03-13 18:26:43,434 [INFO]: }
2025-03-13 18:26:43,434 [INFO]: 	>>> Finished "Creating the index" in 142.3646 secs
2025-03-13 18:26:43,434 [INFO]: >>> Finished "Launching the whole pipeline" in 142.3956 secs
2025-03-13 18:26:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 2128 [episode count 1/20]
[retrieval_preprocessing] for episode 20058 [episode count 2/20], we have num_retrieval=np.int64(9744) num_query=np.int64(472)
2025-03-13 18:26:50,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:52,199 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:52
2025-03-13 18:26:52,199 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 757.37it/s]
2025-03-13 18:26:52,231 [INFO]: There are 9744 embeddings of dim 49152
2025-03-13 18:26:52,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 18:26:52,232 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:52
2025-03-13 18:26:52,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:52,232 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:26:52,232 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:26:52,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:26:52,232 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:52
2025-03-13 18:26:52,233 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:52,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:26:52,233 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:52
2025-03-13 18:26:52,234 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:52,234 [INFO]: 	Creating the index 03/13/2025, 18:26:52
2025-03-13 18:26:52,234 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:52
2025-03-13 18:26:52,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:26:52,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:52
2025-03-13 18:26:52,237 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:26:52,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:09,  3.93it/s]  5%|▌         | 2/40 [00:00<00:07,  5.05it/s]  8%|▊         | 3/40 [00:00<00:06,  5.65it/s] 10%|█         | 4/40 [00:00<00:05,  6.41it/s] 12%|█▎        | 5/40 [00:00<00:05,  6.72it/s] 15%|█▌        | 6/40 [00:01<00:05,  5.75it/s] 18%|█▊        | 7/40 [00:01<00:05,  6.41it/s] 20%|██        | 8/40 [00:01<00:04,  6.95it/s] 22%|██▎       | 9/40 [00:01<00:04,  7.36it/s] 25%|██▌       | 10/40 [00:01<00:03,  7.71it/s] 28%|██▊       | 11/40 [00:01<00:03,  7.94it/s] 30%|███       | 12/40 [00:01<00:03,  8.28it/s] 32%|███▎      | 13/40 [00:01<00:03,  8.46it/s] 35%|███▌      | 14/40 [00:01<00:03,  8.57it/s] 38%|███▊      | 15/40 [00:02<00:02,  8.67it/s] 40%|████      | 16/40 [00:02<00:02,  8.77it/s] 42%|████▎     | 17/40 [00:02<00:02,  8.96it/s] 45%|████▌     | 18/40 [00:02<00:02,  8.98it/s] 48%|████▊     | 19/40 [00:02<00:02,  9.04it/s] 50%|█████     | 20/40 [00:02<00:02,  9.09it/s] 52%|█████▎    | 21/40 [00:07<00:28,  1.49s/it] 55%|█████▌    | 22/40 [00:07<00:19,  1.07s/it] 60%|██████    | 24/40 [00:07<00:09,  1.63it/s] 65%|██████▌   | 26/40 [00:07<00:05,  2.49it/s] 70%|███████   | 28/40 [00:07<00:03,  3.46it/s] 75%|███████▌  | 30/40 [00:08<00:02,  4.49it/s] 80%|████████  | 32/40 [00:08<00:01,  5.56it/s] 85%|████████▌ | 34/40 [00:08<00:00,  6.56it/s] 90%|█████████ | 36/40 [00:08<00:00,  7.42it/s] 95%|█████████▌| 38/40 [00:08<00:00,  8.19it/s]100%|██████████| 40/40 [00:14<00:00,  1.03it/s]100%|██████████| 40/40 [00:14<00:00,  2.73it/s]
2025-03-13 18:27:06,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:06
2025-03-13 18:28:18,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.9802 secs
2025-03-13 18:28:18,889 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 18:28:18,889 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 18:29:08,275 [INFO]: 	>>> Finished "Compute fast metrics" in 49.3862 secs
2025-03-13 18:29:08,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.0411 secs
2025-03-13 18:29:08,278 [INFO]: {
2025-03-13 18:29:08,278 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:08,279 [INFO]: 	index_param: efSearch=123
2025-03-13 18:29:08,279 [INFO]: 	index_path: knn.index
2025-03-13 18:29:08,279 [INFO]: 	size in bytes: 1917074170
2025-03-13 18:29:08,279 [INFO]: 	avg_search_speed_ms: 8.464262249053887
2025-03-13 18:29:08,279 [INFO]: 	99p_search_speed_ms: 15.903037041425705
2025-03-13 18:29:08,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:08,279 [INFO]: 	nb vectors: 9744
2025-03-13 18:29:08,279 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:08,279 [INFO]: 	compression ratio: 0.9993084159075598
2025-03-13 18:29:08,279 [INFO]: }
2025-03-13 18:29:08,279 [INFO]: 	>>> Finished "Creating the index" in 136.0448 secs
2025-03-13 18:29:08,279 [INFO]: >>> Finished "Launching the whole pipeline" in 136.0793 secs
2025-03-13 18:29:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20058 [episode count 2/20]
[retrieval_preprocessing] for episode 91747 [episode count 3/20], we have num_retrieval=np.int64(9673) num_query=np.int64(543)
2025-03-13 18:29:13,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:14,951 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:14
2025-03-13 18:29:14,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.55it/s]
2025-03-13 18:29:14,976 [INFO]: There are 9673 embeddings of dim 49152
2025-03-13 18:29:14,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:29:14,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:14
2025-03-13 18:29:14,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:14,977 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:29:14,977 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:29:14,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:14,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:14
2025-03-13 18:29:14,977 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:14,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:29:14,977 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:14
2025-03-13 18:29:14,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:14,977 [INFO]: 	Creating the index 03/13/2025, 18:29:14
2025-03-13 18:29:14,977 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:14
2025-03-13 18:29:14,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:29:14,979 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:14
2025-03-13 18:29:14,979 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:29:14,979 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:08,  4.74it/s]  8%|▊         | 3/40 [00:00<00:04,  8.87it/s] 12%|█▎        | 5/40 [00:00<00:03, 11.46it/s] 18%|█▊        | 7/40 [00:00<00:02, 11.77it/s] 22%|██▎       | 9/40 [00:00<00:02, 12.28it/s] 28%|██▊       | 11/40 [00:00<00:02, 13.47it/s] 32%|███▎      | 13/40 [00:01<00:01, 14.46it/s] 38%|███▊      | 15/40 [00:01<00:01, 14.29it/s] 42%|████▎     | 17/40 [00:01<00:01, 14.32it/s] 48%|████▊     | 19/40 [00:01<00:01, 15.03it/s] 52%|█████▎    | 21/40 [00:05<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:05<00:07,  2.18it/s] 62%|██████▎   | 25/40 [00:05<00:05,  2.95it/s] 68%|██████▊   | 27/40 [00:05<00:03,  3.94it/s] 72%|███████▎  | 29/40 [00:05<00:02,  5.01it/s] 78%|███████▊  | 31/40 [00:05<00:01,  6.10it/s] 82%|████████▎ | 33/40 [00:06<00:00,  7.17it/s] 88%|████████▊ | 35/40 [00:06<00:00,  8.19it/s] 92%|█████████▎| 37/40 [00:06<00:00,  9.02it/s] 98%|█████████▊| 39/40 [00:06<00:00,  9.76it/s]100%|██████████| 40/40 [00:11<00:00,  3.45it/s]
2025-03-13 18:29:26,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:26
2025-03-13 18:30:43,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.9515 secs
2025-03-13 18:30:43,522 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 18:30:43,522 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 18:31:33,456 [INFO]: 	>>> Finished "Compute fast metrics" in 49.9343 secs
2025-03-13 18:31:33,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.4805 secs
2025-03-13 18:31:33,460 [INFO]: {
2025-03-13 18:31:33,460 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:33,460 [INFO]: 	index_param: efSearch=115
2025-03-13 18:31:33,460 [INFO]: 	index_path: knn.index
2025-03-13 18:31:33,460 [INFO]: 	size in bytes: 1903105270
2025-03-13 18:31:33,460 [INFO]: 	avg_search_speed_ms: 8.770068313950967
2025-03-13 18:31:33,460 [INFO]: 	99p_search_speed_ms: 19.130885123740857
2025-03-13 18:31:33,460 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:33,460 [INFO]: 	nb vectors: 9673
2025-03-13 18:31:33,460 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:33,460 [INFO]: 	compression ratio: 0.9993084533889184
2025-03-13 18:31:33,460 [INFO]: }
2025-03-13 18:31:33,460 [INFO]: 	>>> Finished "Creating the index" in 138.4823 secs
2025-03-13 18:31:33,460 [INFO]: >>> Finished "Launching the whole pipeline" in 138.5088 secs
2025-03-13 18:31:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 91747 [episode count 3/20]
[retrieval_preprocessing] for episode 61044 [episode count 4/20], we have num_retrieval=np.int64(9743) num_query=np.int64(473)
2025-03-13 18:31:38,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:40,412 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:40
2025-03-13 18:31:40,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 704.45it/s]
2025-03-13 18:31:40,454 [INFO]: There are 9743 embeddings of dim 49152
2025-03-13 18:31:40,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0429 secs
2025-03-13 18:31:40,455 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:40
2025-03-13 18:31:40,455 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:40,455 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:31:40,455 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:31:40,455 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:31:40,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:40
2025-03-13 18:31:40,456 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:40,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:31:40,456 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:40
2025-03-13 18:31:40,456 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:40,457 [INFO]: 	Creating the index 03/13/2025, 18:31:40
2025-03-13 18:31:40,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:40
2025-03-13 18:31:40,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:31:40,460 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:40
2025-03-13 18:31:40,461 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:31:40,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.65it/s] 15%|█▌        | 6/40 [00:00<00:01, 27.42it/s] 28%|██▊       | 11/40 [00:00<00:00, 34.29it/s] 40%|████      | 16/40 [00:00<00:00, 37.78it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.63it/s] 60%|██████    | 24/40 [00:05<00:04,  3.25it/s] 68%|██████▊   | 27/40 [00:05<00:03,  4.02it/s] 72%|███████▎  | 29/40 [00:05<00:02,  4.64it/s] 78%|███████▊  | 31/40 [00:06<00:01,  5.39it/s] 82%|████████▎ | 33/40 [00:06<00:01,  6.41it/s] 88%|████████▊ | 35/40 [00:06<00:00,  7.49it/s] 92%|█████████▎| 37/40 [00:06<00:00,  8.12it/s] 98%|█████████▊| 39/40 [00:06<00:00,  9.29it/s]100%|██████████| 40/40 [00:12<00:00,  3.21it/s]
2025-03-13 18:31:52,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:52
2025-03-13 18:33:08,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.6403 secs
2025-03-13 18:33:08,562 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:33:08,562 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 18:34:01,997 [INFO]: 	>>> Finished "Compute fast metrics" in 53.4353 secs
2025-03-13 18:34:02,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.7064 secs
2025-03-13 18:34:02,167 [INFO]: {
2025-03-13 18:34:02,167 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:02,168 [INFO]: 	index_param: efSearch=147
2025-03-13 18:34:02,168 [INFO]: 	index_path: knn.index
2025-03-13 18:34:02,168 [INFO]: 	size in bytes: 1916877430
2025-03-13 18:34:02,168 [INFO]: 	avg_search_speed_ms: 10.275545127054281
2025-03-13 18:34:02,168 [INFO]: 	99p_search_speed_ms: 19.45719126611948
2025-03-13 18:34:02,168 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:02,168 [INFO]: 	nb vectors: 9743
2025-03-13 18:34:02,168 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:02,168 [INFO]: 	compression ratio: 0.9993084137883558
2025-03-13 18:34:02,168 [INFO]: }
2025-03-13 18:34:02,168 [INFO]: 	>>> Finished "Creating the index" in 141.7114 secs
2025-03-13 18:34:02,168 [INFO]: >>> Finished "Launching the whole pipeline" in 141.7566 secs
2025-03-13 18:34:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 61044 [episode count 4/20]
[retrieval_preprocessing] for episode 35449 [episode count 5/20], we have num_retrieval=np.int64(9700) num_query=np.int64(516)
2025-03-13 18:34:10,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:12,515 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:12
2025-03-13 18:34:12,515 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 992.50it/s]
2025-03-13 18:34:12,543 [INFO]: There are 9700 embeddings of dim 49152
2025-03-13 18:34:12,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:34:12,544 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:12
2025-03-13 18:34:12,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:12,544 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:34:12,544 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:34:12,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:12,544 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:12
2025-03-13 18:34:12,544 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:12,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:12,544 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:12
2025-03-13 18:34:12,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:12,544 [INFO]: 	Creating the index 03/13/2025, 18:34:12
2025-03-13 18:34:12,544 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:12
2025-03-13 18:34:12,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:34:12,545 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:12
2025-03-13 18:34:12,545 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:34:12,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:10,  3.88it/s]  5%|▌         | 2/40 [00:00<00:06,  5.57it/s]  8%|▊         | 3/40 [00:00<00:05,  6.41it/s] 10%|█         | 4/40 [00:00<00:05,  6.92it/s] 12%|█▎        | 5/40 [00:00<00:04,  7.22it/s] 15%|█▌        | 6/40 [00:00<00:04,  7.58it/s] 18%|█▊        | 7/40 [00:01<00:04,  7.58it/s] 20%|██        | 8/40 [00:01<00:04,  7.56it/s] 22%|██▎       | 9/40 [00:01<00:04,  7.56it/s] 25%|██▌       | 10/40 [00:01<00:03,  7.57it/s] 28%|██▊       | 11/40 [00:01<00:03,  7.65it/s] 30%|███       | 12/40 [00:01<00:03,  7.60it/s] 32%|███▎      | 13/40 [00:01<00:03,  7.60it/s] 35%|███▌      | 14/40 [00:01<00:03,  7.52it/s] 38%|███▊      | 15/40 [00:02<00:03,  7.52it/s] 40%|████      | 16/40 [00:02<00:03,  7.63it/s] 42%|████▎     | 17/40 [00:02<00:02,  8.10it/s] 45%|████▌     | 18/40 [00:02<00:02,  8.34it/s] 48%|████▊     | 19/40 [00:02<00:02,  8.55it/s] 50%|█████     | 20/40 [00:02<00:02,  8.73it/s] 52%|█████▎    | 21/40 [00:07<00:26,  1.40s/it] 62%|██████▎   | 25/40 [00:07<00:08,  1.86it/s] 72%|███████▎  | 29/40 [00:07<00:03,  3.37it/s] 82%|████████▎ | 33/40 [00:07<00:01,  5.32it/s] 92%|█████████▎| 37/40 [00:07<00:00,  7.72it/s]100%|██████████| 40/40 [00:12<00:00,  1.85it/s]100%|██████████| 40/40 [00:12<00:00,  3.25it/s]
2025-03-13 18:34:24,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:24
2025-03-13 18:35:35,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.1498 secs
2025-03-13 18:35:35,998 [INFO]: The best hyperparameters are: efSearch=94
2025-03-13 18:35:35,998 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 18:36:27,101 [INFO]: 	>>> Finished "Compute fast metrics" in 51.1030 secs
2025-03-13 18:36:27,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.5592 secs
2025-03-13 18:36:27,104 [INFO]: {
2025-03-13 18:36:27,104 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:27,105 [INFO]: 	index_param: efSearch=94
2025-03-13 18:36:27,105 [INFO]: 	index_path: knn.index
2025-03-13 18:36:27,105 [INFO]: 	size in bytes: 1908417250
2025-03-13 18:36:27,105 [INFO]: 	avg_search_speed_ms: 8.672855693058588
2025-03-13 18:36:27,105 [INFO]: 	99p_search_speed_ms: 15.134066771715881
2025-03-13 18:36:27,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:27,105 [INFO]: 	nb vectors: 9700
2025-03-13 18:36:27,105 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:27,105 [INFO]: 	compression ratio: 0.9993085107567541
2025-03-13 18:36:27,105 [INFO]: }
2025-03-13 18:36:27,105 [INFO]: 	>>> Finished "Creating the index" in 134.5605 secs
2025-03-13 18:36:27,105 [INFO]: >>> Finished "Launching the whole pipeline" in 134.5894 secs
2025-03-13 18:36:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 35449 [episode count 5/20]
[retrieval_preprocessing] for episode 67197 [episode count 6/20], we have num_retrieval=np.int64(9851) num_query=np.int64(365)
2025-03-13 18:36:33,858 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:35,664 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:35
2025-03-13 18:36:35,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1003.90it/s]
2025-03-13 18:36:35,706 [INFO]: There are 9851 embeddings of dim 49152
2025-03-13 18:36:35,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0418 secs
2025-03-13 18:36:35,706 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:35
2025-03-13 18:36:35,706 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:35,707 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:36:35,707 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:36:35,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:36:35,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:35
2025-03-13 18:36:35,707 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:35,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:36:35,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:35
2025-03-13 18:36:35,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:35,707 [INFO]: 	Creating the index 03/13/2025, 18:36:35
2025-03-13 18:36:35,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:35
2025-03-13 18:36:35,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:36:35,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:35
2025-03-13 18:36:35,709 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:36:35,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:06,  6.02it/s] 12%|█▎        | 5/40 [00:00<00:01, 21.35it/s] 25%|██▌       | 10/40 [00:00<00:00, 30.81it/s] 38%|███▊      | 15/40 [00:00<00:00, 34.88it/s] 48%|████▊     | 19/40 [00:00<00:00, 36.28it/s] 57%|█████▊    | 23/40 [00:05<00:07,  2.36it/s] 70%|███████   | 28/40 [00:05<00:03,  3.64it/s] 82%|████████▎ | 33/40 [00:05<00:01,  5.36it/s] 95%|█████████▌| 38/40 [00:05<00:00,  7.59it/s]100%|██████████| 40/40 [00:10<00:00,  3.77it/s]
2025-03-13 18:36:46,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:46
2025-03-13 18:37:59,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.6974 secs
2025-03-13 18:37:59,020 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 18:37:59,020 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 18:39:05,104 [INFO]: 	>>> Finished "Compute fast metrics" in 66.0836 secs
2025-03-13 18:39:05,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.3979 secs
2025-03-13 18:39:05,108 [INFO]: {
2025-03-13 18:39:05,108 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:05,108 [INFO]: 	index_param: efSearch=155
2025-03-13 18:39:05,108 [INFO]: 	index_path: knn.index
2025-03-13 18:39:05,108 [INFO]: 	size in bytes: 1938126070
2025-03-13 18:39:05,108 [INFO]: 	avg_search_speed_ms: 13.315522253634867
2025-03-13 18:39:05,108 [INFO]: 	99p_search_speed_ms: 19.654440926387906
2025-03-13 18:39:05,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:05,108 [INFO]: 	nb vectors: 9851
2025-03-13 18:39:05,108 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:05,108 [INFO]: 	compression ratio: 0.9993082689404204
2025-03-13 18:39:05,108 [INFO]: }
2025-03-13 18:39:05,108 [INFO]: 	>>> Finished "Creating the index" in 149.4004 secs
2025-03-13 18:39:05,108 [INFO]: >>> Finished "Launching the whole pipeline" in 149.4433 secs
2025-03-13 18:39:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 67197 [episode count 6/20]
[retrieval_preprocessing] for episode 65150 [episode count 7/20], we have num_retrieval=np.int64(9634) num_query=np.int64(582)
2025-03-13 18:39:11,753 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:13,724 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:13
2025-03-13 18:39:13,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 867.85it/s]
2025-03-13 18:39:13,784 [INFO]: There are 9634 embeddings of dim 49152
2025-03-13 18:39:13,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0602 secs
2025-03-13 18:39:13,785 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:13
2025-03-13 18:39:13,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:13,785 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:39:13,785 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:39:13,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:39:13,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:13
2025-03-13 18:39:13,786 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:13,787 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:39:13,787 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:13
2025-03-13 18:39:13,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:13,787 [INFO]: 	Creating the index 03/13/2025, 18:39:13
2025-03-13 18:39:13,787 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:13
2025-03-13 18:39:13,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:39:13,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:13
2025-03-13 18:39:13,791 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:39:13,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.37it/s] 13%|█▎        | 5/39 [00:00<00:01, 21.19it/s] 23%|██▎       | 9/39 [00:00<00:01, 27.37it/s] 33%|███▎      | 13/39 [00:00<00:00, 30.61it/s] 44%|████▎     | 17/39 [00:00<00:00, 32.48it/s] 54%|█████▍    | 21/39 [00:06<00:09,  1.85it/s] 64%|██████▍   | 25/39 [00:06<00:05,  2.71it/s] 74%|███████▍  | 29/39 [00:06<00:02,  3.88it/s] 87%|████████▋ | 34/39 [00:06<00:00,  5.84it/s]100%|██████████| 39/39 [00:13<00:00,  1.65it/s]100%|██████████| 39/39 [00:13<00:00,  2.79it/s]
2025-03-13 18:39:27,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:27
2025-03-13 18:40:38,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.0706 secs
2025-03-13 18:40:38,864 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 18:40:38,864 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.08it/s]
2025-03-13 18:41:30,557 [INFO]: 	>>> Finished "Compute fast metrics" in 51.6930 secs
2025-03-13 18:41:30,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.7692 secs
2025-03-13 18:41:30,560 [INFO]: {
2025-03-13 18:41:30,560 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:30,560 [INFO]: 	index_param: efSearch=127
2025-03-13 18:41:30,560 [INFO]: 	index_path: knn.index
2025-03-13 18:41:30,560 [INFO]: 	size in bytes: 1895432350
2025-03-13 18:41:30,560 [INFO]: 	avg_search_speed_ms: 8.785309106899758
2025-03-13 18:41:30,560 [INFO]: 	99p_search_speed_ms: 13.63589580636471
2025-03-13 18:41:30,560 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:30,560 [INFO]: 	nb vectors: 9634
2025-03-13 18:41:30,560 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:30,560 [INFO]: 	compression ratio: 0.9993084015897481
2025-03-13 18:41:30,560 [INFO]: }
2025-03-13 18:41:30,560 [INFO]: 	>>> Finished "Creating the index" in 136.7733 secs
2025-03-13 18:41:30,560 [INFO]: >>> Finished "Launching the whole pipeline" in 136.8365 secs
2025-03-13 18:41:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 65150 [episode count 7/20]
[retrieval_preprocessing] for episode 74419 [episode count 8/20], we have num_retrieval=np.int64(9826) num_query=np.int64(390)
2025-03-13 18:41:35,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:36,667 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:36
2025-03-13 18:41:36,668 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.05it/s]
2025-03-13 18:41:36,700 [INFO]: There are 9826 embeddings of dim 49152
2025-03-13 18:41:36,700 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 18:41:36,701 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:36,701 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:41:36,701 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:41:36,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:36,701 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,701 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:36,701 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:36,701 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:36
2025-03-13 18:41:36,701 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:36,701 [INFO]: 	Creating the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,701 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:36
2025-03-13 18:41:36,702 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:41:36,702 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:36
2025-03-13 18:41:36,702 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:41:36,702 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  6.55it/s] 15%|█▌        | 6/40 [00:00<00:01, 26.52it/s] 28%|██▊       | 11/40 [00:00<00:00, 35.06it/s] 40%|████      | 16/40 [00:00<00:00, 39.71it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.56it/s] 65%|██████▌   | 26/40 [00:05<00:03,  3.85it/s] 78%|███████▊  | 31/40 [00:05<00:01,  5.59it/s] 90%|█████████ | 36/40 [00:05<00:00,  7.81it/s]100%|██████████| 40/40 [00:10<00:00,  3.71it/s]
2025-03-13 18:41:47,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:47
2025-03-13 18:42:59,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.0566 secs
2025-03-13 18:42:59,553 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:42:59,553 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.35it/s]
2025-03-13 18:43:46,721 [INFO]: 	>>> Finished "Compute fast metrics" in 47.1676 secs
2025-03-13 18:43:46,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.0237 secs
2025-03-13 18:43:46,726 [INFO]: {
2025-03-13 18:43:46,726 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:46,726 [INFO]: 	index_param: efSearch=147
2025-03-13 18:43:46,726 [INFO]: 	index_path: knn.index
2025-03-13 18:43:46,726 [INFO]: 	size in bytes: 1933207450
2025-03-13 18:43:46,726 [INFO]: 	avg_search_speed_ms: 10.539508352813765
2025-03-13 18:43:46,726 [INFO]: 	99p_search_speed_ms: 17.29328945279121
2025-03-13 18:43:46,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:46,726 [INFO]: 	nb vectors: 9826
2025-03-13 18:43:46,726 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:46,726 [INFO]: 	compression ratio: 0.9993082780640019
2025-03-13 18:43:46,727 [INFO]: }
2025-03-13 18:43:46,727 [INFO]: 	>>> Finished "Creating the index" in 130.0255 secs
2025-03-13 18:43:46,727 [INFO]: >>> Finished "Launching the whole pipeline" in 130.0590 secs
2025-03-13 18:43:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 74419 [episode count 8/20]
[retrieval_preprocessing] for episode 25875 [episode count 9/20], we have num_retrieval=np.int64(9504) num_query=np.int64(712)
2025-03-13 18:43:50,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:53,083 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:53
2025-03-13 18:43:53,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-13 18:43:53,125 [INFO]: There are 9504 embeddings of dim 49152
2025-03-13 18:43:53,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0421 secs
2025-03-13 18:43:53,125 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:53,126 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:43:53,126 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:43:53,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:43:53,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,126 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:53,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:43:53,126 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:53
2025-03-13 18:43:53,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:53,127 [INFO]: 	Creating the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,127 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:53
2025-03-13 18:43:53,128 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 18:43:53,129 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:53
2025-03-13 18:43:53,129 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:43:53,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  7.68it/s] 13%|█▎        | 5/39 [00:00<00:01, 22.51it/s] 23%|██▎       | 9/39 [00:00<00:01, 28.81it/s] 36%|███▌      | 14/39 [00:00<00:00, 33.57it/s] 49%|████▊     | 19/39 [00:00<00:00, 36.02it/s] 59%|█████▉    | 23/39 [00:04<00:05,  3.05it/s] 72%|███████▏  | 28/39 [00:04<00:02,  4.63it/s] 87%|████████▋ | 34/39 [00:04<00:00,  7.12it/s]100%|██████████| 39/39 [00:08<00:00,  2.73it/s]100%|██████████| 39/39 [00:08<00:00,  4.35it/s]
2025-03-13 18:44:02,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:02
2025-03-13 18:45:02,136 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0345 secs
2025-03-13 18:45:02,136 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 18:45:02,136 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.83it/s]
2025-03-13 18:45:42,784 [INFO]: 	>>> Finished "Compute fast metrics" in 40.6483 secs
2025-03-13 18:45:42,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.6585 secs
2025-03-13 18:45:42,787 [INFO]: {
2025-03-13 18:45:42,787 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:42,787 [INFO]: 	index_param: efSearch=167
2025-03-13 18:45:42,787 [INFO]: 	index_path: knn.index
2025-03-13 18:45:42,787 [INFO]: 	size in bytes: 1869855730
2025-03-13 18:45:42,787 [INFO]: 	avg_search_speed_ms: 10.94343033552993
2025-03-13 18:45:42,787 [INFO]: 	99p_search_speed_ms: 18.69522793451324
2025-03-13 18:45:42,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:42,787 [INFO]: 	nb vectors: 9504
2025-03-13 18:45:42,788 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:42,788 [INFO]: 	compression ratio: 0.9993083434303245
2025-03-13 18:45:42,788 [INFO]: }
2025-03-13 18:45:42,788 [INFO]: 	>>> Finished "Creating the index" in 109.6610 secs
2025-03-13 18:45:42,788 [INFO]: >>> Finished "Launching the whole pipeline" in 109.7047 secs
2025-03-13 18:45:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 25875 [episode count 9/20]
[retrieval_preprocessing] for episode 13691 [episode count 10/20], we have num_retrieval=np.int64(9795) num_query=np.int64(421)
2025-03-13 18:45:49,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:51,093 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:51
2025-03-13 18:45:51,093 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.93it/s]
2025-03-13 18:45:51,128 [INFO]: There are 9795 embeddings of dim 49152
2025-03-13 18:45:51,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 18:45:51,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:51,129 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:45:51,129 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:45:51,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:45:51,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,129 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:51,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:45:51,130 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:51
2025-03-13 18:45:51,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:51,130 [INFO]: 	Creating the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:51
2025-03-13 18:45:51,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:45:51,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,134 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:45:51,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.53it/s] 15%|█▌        | 6/40 [00:00<00:01, 30.05it/s] 28%|██▊       | 11/40 [00:00<00:00, 37.45it/s] 40%|████      | 16/40 [00:00<00:00, 41.12it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.64it/s] 65%|██████▌   | 26/40 [00:05<00:03,  3.96it/s] 78%|███████▊  | 31/40 [00:05<00:01,  5.73it/s] 90%|█████████ | 36/40 [00:05<00:00,  8.01it/s]100%|██████████| 40/40 [00:10<00:00,  2.29it/s]100%|██████████| 40/40 [00:10<00:00,  3.78it/s]
2025-03-13 18:46:01,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:01
2025-03-13 18:47:05,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3196 secs
2025-03-13 18:47:05,046 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 18:47:05,047 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 18:47:45,002 [INFO]: 	>>> Finished "Compute fast metrics" in 39.9553 secs
2025-03-13 18:47:45,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.8710 secs
2025-03-13 18:47:45,005 [INFO]: {
2025-03-13 18:47:45,005 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:45,005 [INFO]: 	index_param: efSearch=167
2025-03-13 18:47:45,005 [INFO]: 	index_path: knn.index
2025-03-13 18:47:45,005 [INFO]: 	size in bytes: 1927108270
2025-03-13 18:47:45,005 [INFO]: 	avg_search_speed_ms: 10.606282580276499
2025-03-13 18:47:45,005 [INFO]: 	99p_search_speed_ms: 15.468466314487165
2025-03-13 18:47:45,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:45,005 [INFO]: 	nb vectors: 9795
2025-03-13 18:47:45,005 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:45,005 [INFO]: 	compression ratio: 0.9993083367339812
2025-03-13 18:47:45,005 [INFO]: }
2025-03-13 18:47:45,005 [INFO]: 	>>> Finished "Creating the index" in 113.8751 secs
2025-03-13 18:47:45,005 [INFO]: >>> Finished "Launching the whole pipeline" in 113.9120 secs
2025-03-13 18:47:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 13691 [episode count 10/20]
[retrieval_preprocessing] for episode 64408 [episode count 11/20], we have num_retrieval=np.int64(9909) num_query=np.int64(307)
2025-03-13 18:47:49,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:50,838 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:50
2025-03-13 18:47:50,838 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.61it/s]
2025-03-13 18:47:50,879 [INFO]: There are 9909 embeddings of dim 49152
2025-03-13 18:47:50,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 18:47:50,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:50,879 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:47:50,879 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:47:50,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:47:50,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,880 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:50,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:47:50,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:50
2025-03-13 18:47:50,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:50,880 [INFO]: 	Creating the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:50
2025-03-13 18:47:50,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 18:47:50,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:50
2025-03-13 18:47:50,882 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:47:50,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.54it/s] 15%|█▌        | 6/40 [00:00<00:01, 27.88it/s] 28%|██▊       | 11/40 [00:00<00:00, 35.52it/s] 40%|████      | 16/40 [00:00<00:00, 38.90it/s] 52%|█████▎    | 21/40 [00:05<00:08,  2.35it/s] 65%|██████▌   | 26/40 [00:05<00:03,  3.54it/s] 78%|███████▊  | 31/40 [00:05<00:01,  5.14it/s] 90%|█████████ | 36/40 [00:06<00:00,  7.23it/s]100%|██████████| 40/40 [00:11<00:00,  2.05it/s]100%|██████████| 40/40 [00:11<00:00,  3.39it/s]
2025-03-13 18:48:03,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:03
2025-03-13 18:49:11,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.9568 secs
2025-03-13 18:49:11,063 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 18:49:11,063 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 18:50:06,010 [INFO]: 	>>> Finished "Compute fast metrics" in 54.9463 secs
2025-03-13 18:50:06,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.1321 secs
2025-03-13 18:50:06,014 [INFO]: {
2025-03-13 18:50:06,014 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:06,014 [INFO]: 	index_param: efSearch=146
2025-03-13 18:50:06,014 [INFO]: 	index_path: knn.index
2025-03-13 18:50:06,014 [INFO]: 	size in bytes: 1949537290
2025-03-13 18:50:06,014 [INFO]: 	avg_search_speed_ms: 11.011282284564786
2025-03-13 18:50:06,014 [INFO]: 	99p_search_speed_ms: 20.374823044985526
2025-03-13 18:50:06,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:06,014 [INFO]: 	nb vectors: 9909
2025-03-13 18:50:06,014 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:06,014 [INFO]: 	compression ratio: 0.9993082368791212
2025-03-13 18:50:06,014 [INFO]: }
2025-03-13 18:50:06,014 [INFO]: 	>>> Finished "Creating the index" in 135.1341 secs
2025-03-13 18:50:06,014 [INFO]: >>> Finished "Launching the whole pipeline" in 135.1763 secs
2025-03-13 18:50:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 64408 [episode count 11/20]
[retrieval_preprocessing] for episode 33177 [episode count 12/20], we have num_retrieval=np.int64(9718) num_query=np.int64(498)
2025-03-13 18:50:10,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:12,565 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:12
2025-03-13 18:50:12,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-13 18:50:12,603 [INFO]: There are 9718 embeddings of dim 49152
2025-03-13 18:50:12,603 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 18:50:12,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:12
2025-03-13 18:50:12,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:12,604 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:50:12,604 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:50:12,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:12,604 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:12
2025-03-13 18:50:12,604 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:12,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:12,604 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:12
2025-03-13 18:50:12,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:12,604 [INFO]: 	Creating the index 03/13/2025, 18:50:12
2025-03-13 18:50:12,604 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:12
2025-03-13 18:50:12,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:50:12,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:12
2025-03-13 18:50:12,606 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:50:12,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  6.75it/s] 12%|█▎        | 5/40 [00:00<00:01, 22.75it/s] 25%|██▌       | 10/40 [00:00<00:00, 30.94it/s] 38%|███▊      | 15/40 [00:00<00:00, 35.86it/s] 50%|█████     | 20/40 [00:00<00:00, 39.60it/s] 62%|██████▎   | 25/40 [00:04<00:04,  3.44it/s] 75%|███████▌  | 30/40 [00:04<00:01,  5.03it/s] 88%|████████▊ | 35/40 [00:04<00:00,  7.12it/s]100%|██████████| 40/40 [00:09<00:00,  2.57it/s]100%|██████████| 40/40 [00:09<00:00,  4.35it/s]
2025-03-13 18:50:21,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:21
2025-03-13 18:51:25,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6608 secs
2025-03-13 18:51:25,537 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 18:51:25,537 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-13 18:52:10,059 [INFO]: 	>>> Finished "Compute fast metrics" in 44.5220 secs
2025-03-13 18:52:10,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.0363 secs
2025-03-13 18:52:10,643 [INFO]: {
2025-03-13 18:52:10,643 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:10,643 [INFO]: 	index_param: efSearch=153
2025-03-13 18:52:10,643 [INFO]: 	index_path: knn.index
2025-03-13 18:52:10,643 [INFO]: 	size in bytes: 1911958570
2025-03-13 18:52:10,643 [INFO]: 	avg_search_speed_ms: 9.957364447733974
2025-03-13 18:52:10,643 [INFO]: 	99p_search_speed_ms: 15.498071757610887
2025-03-13 18:52:10,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:10,643 [INFO]: 	nb vectors: 9718
2025-03-13 18:52:10,643 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:10,643 [INFO]: 	compression ratio: 0.9993085488248838
2025-03-13 18:52:10,643 [INFO]: }
2025-03-13 18:52:10,643 [INFO]: 	>>> Finished "Creating the index" in 118.0392 secs
2025-03-13 18:52:10,643 [INFO]: >>> Finished "Launching the whole pipeline" in 118.0780 secs
2025-03-13 18:52:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 33177 [episode count 12/20]
[retrieval_preprocessing] for episode 70554 [episode count 13/20], we have num_retrieval=np.int64(9468) num_query=np.int64(748)
2025-03-13 18:52:15,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:17,447 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:17
2025-03-13 18:52:17,447 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-13 18:52:17,479 [INFO]: There are 9468 embeddings of dim 49152
2025-03-13 18:52:17,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 18:52:17,479 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:17
2025-03-13 18:52:17,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:17,479 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 18:52:17,479 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:52:17,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:17,479 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:17
2025-03-13 18:52:17,479 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:17,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:52:17,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:17
2025-03-13 18:52:17,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:17,480 [INFO]: 	Creating the index 03/13/2025, 18:52:17
2025-03-13 18:52:17,480 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:17
2025-03-13 18:52:17,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:52:17,481 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:17
2025-03-13 18:52:17,481 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:52:17,481 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  8.31it/s] 10%|█         | 4/39 [00:00<00:01, 19.68it/s] 23%|██▎       | 9/39 [00:00<00:00, 31.85it/s] 36%|███▌      | 14/39 [00:00<00:00, 37.78it/s] 49%|████▊     | 19/39 [00:00<00:00, 41.42it/s] 62%|██████▏   | 24/39 [00:04<00:04,  3.05it/s] 77%|███████▋  | 30/39 [00:04<00:01,  4.79it/s] 92%|█████████▏| 36/39 [00:05<00:00,  7.08it/s]100%|██████████| 39/39 [00:09<00:00,  4.30it/s]
2025-03-13 18:52:26,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:26
2025-03-13 18:53:29,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.0276 secs
2025-03-13 18:53:29,575 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 18:53:29,575 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]
2025-03-13 18:54:08,973 [INFO]: 	>>> Finished "Compute fast metrics" in 39.3972 secs
2025-03-13 18:54:08,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.4945 secs
2025-03-13 18:54:08,975 [INFO]: {
2025-03-13 18:54:08,975 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:08,975 [INFO]: 	index_param: efSearch=163
2025-03-13 18:54:08,975 [INFO]: 	index_path: knn.index
2025-03-13 18:54:08,975 [INFO]: 	size in bytes: 1862772850
2025-03-13 18:54:08,975 [INFO]: 	avg_search_speed_ms: 9.74418408533315
2025-03-13 18:54:08,975 [INFO]: 	99p_search_speed_ms: 14.858671987894922
2025-03-13 18:54:08,975 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:08,975 [INFO]: 	nb vectors: 9468
2025-03-13 18:54:08,975 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:08,975 [INFO]: 	compression ratio: 0.9993083933985832
2025-03-13 18:54:08,975 [INFO]: }
2025-03-13 18:54:08,976 [INFO]: 	>>> Finished "Creating the index" in 111.4959 secs
2025-03-13 18:54:08,976 [INFO]: >>> Finished "Launching the whole pipeline" in 111.5287 secs
2025-03-13 18:54:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 70554 [episode count 13/20]
[retrieval_preprocessing] for episode 53675 [episode count 14/20], we have num_retrieval=np.int64(9815) num_query=np.int64(401)
2025-03-13 18:54:14,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:15,795 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:15
2025-03-13 18:54:15,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.36it/s]
2025-03-13 18:54:15,824 [INFO]: There are 9815 embeddings of dim 49152
2025-03-13 18:54:15,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:54:15,825 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:15,825 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:54:15,825 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:54:15,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:15,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,825 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:15,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:54:15,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:15
2025-03-13 18:54:15,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:15,825 [INFO]: 	Creating the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:15
2025-03-13 18:54:15,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:54:15,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,826 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:54:15,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.61it/s] 15%|█▌        | 6/40 [00:00<00:01, 28.65it/s] 30%|███       | 12/40 [00:00<00:00, 38.53it/s] 42%|████▎     | 17/40 [00:00<00:00, 42.45it/s] 55%|█████▌    | 22/40 [00:04<00:05,  3.14it/s] 68%|██████▊   | 27/40 [00:04<00:02,  4.65it/s] 80%|████████  | 32/40 [00:04<00:01,  6.63it/s] 92%|█████████▎| 37/40 [00:04<00:00,  9.15it/s]100%|██████████| 40/40 [00:09<00:00,  4.30it/s]
2025-03-13 18:54:25,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:25
2025-03-13 18:55:30,811 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.6720 secs
2025-03-13 18:55:30,812 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 18:55:30,812 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 18:56:04,610 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7982 secs
2025-03-13 18:56:04,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.7868 secs
2025-03-13 18:56:04,613 [INFO]: {
2025-03-13 18:56:04,613 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:04,613 [INFO]: 	index_param: efSearch=150
2025-03-13 18:56:04,613 [INFO]: 	index_path: knn.index
2025-03-13 18:56:04,613 [INFO]: 	size in bytes: 1931043190
2025-03-13 18:56:04,613 [INFO]: 	avg_search_speed_ms: 9.678150152488534
2025-03-13 18:56:04,613 [INFO]: 	99p_search_speed_ms: 15.170803554356098
2025-03-13 18:56:04,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:04,614 [INFO]: 	nb vectors: 9815
2025-03-13 18:56:04,614 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:04,614 [INFO]: 	compression ratio: 0.9993083168688733
2025-03-13 18:56:04,614 [INFO]: }
2025-03-13 18:56:04,614 [INFO]: 	>>> Finished "Creating the index" in 108.7883 secs
2025-03-13 18:56:04,614 [INFO]: >>> Finished "Launching the whole pipeline" in 108.8182 secs
2025-03-13 18:56:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 53675 [episode count 14/20]
[retrieval_preprocessing] for episode 44463 [episode count 15/20], we have num_retrieval=np.int64(9856) num_query=np.int64(360)
2025-03-13 18:56:10,890 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:12,343 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:12
2025-03-13 18:56:12,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1289.36it/s]
2025-03-13 18:56:12,376 [INFO]: There are 9856 embeddings of dim 49152
2025-03-13 18:56:12,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:56:12,377 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:12
2025-03-13 18:56:12,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:12,377 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 18:56:12,377 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:56:12,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:56:12,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:12
2025-03-13 18:56:12,378 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:12,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:56:12,378 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:12
2025-03-13 18:56:12,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:12,379 [INFO]: 	Creating the index 03/13/2025, 18:56:12
2025-03-13 18:56:12,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:12
2025-03-13 18:56:12,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:56:12,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:12
2025-03-13 18:56:12,382 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:56:12,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:08,  4.75it/s]  8%|▊         | 3/40 [00:00<00:04,  8.61it/s] 12%|█▎        | 5/40 [00:00<00:03, 10.12it/s] 18%|█▊        | 7/40 [00:00<00:03, 10.79it/s] 22%|██▎       | 9/40 [00:00<00:02, 11.29it/s] 28%|██▊       | 11/40 [00:01<00:02, 11.47it/s] 32%|███▎      | 13/40 [00:01<00:02, 11.48it/s] 38%|███▊      | 15/40 [00:01<00:02, 11.73it/s] 48%|████▊     | 19/40 [00:01<00:01, 17.15it/s] 52%|█████▎    | 21/40 [00:05<00:10,  1.82it/s] 65%|██████▌   | 26/40 [00:05<00:04,  3.34it/s] 78%|███████▊  | 31/40 [00:05<00:01,  5.33it/s] 88%|████████▊ | 35/40 [00:05<00:00,  7.31it/s] 98%|█████████▊| 39/40 [00:05<00:00,  9.76it/s]100%|██████████| 40/40 [00:10<00:00,  3.82it/s]
2025-03-13 18:56:22,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:22
2025-03-13 18:57:30,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.4080 secs
2025-03-13 18:57:30,290 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 18:57:30,290 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 18:58:02,220 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9299 secs
2025-03-13 18:58:02,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.8412 secs
2025-03-13 18:58:02,224 [INFO]: {
2025-03-13 18:58:02,224 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:02,224 [INFO]: 	index_param: efSearch=146
2025-03-13 18:58:02,224 [INFO]: 	index_path: knn.index
2025-03-13 18:58:02,224 [INFO]: 	size in bytes: 1939109770
2025-03-13 18:58:02,224 [INFO]: 	avg_search_speed_ms: 10.4238496904145
2025-03-13 18:58:02,224 [INFO]: 	99p_search_speed_ms: 17.012912896461778
2025-03-13 18:58:02,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:02,224 [INFO]: 	nb vectors: 9856
2025-03-13 18:58:02,224 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:02,224 [INFO]: 	compression ratio: 0.9993082794895103
2025-03-13 18:58:02,224 [INFO]: }
2025-03-13 18:58:02,224 [INFO]: 	>>> Finished "Creating the index" in 109.8447 secs
2025-03-13 18:58:02,224 [INFO]: >>> Finished "Launching the whole pipeline" in 109.8802 secs
2025-03-13 18:58:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 44463 [episode count 15/20]
[retrieval_preprocessing] for episode 27065 [episode count 16/20], we have num_retrieval=np.int64(9663) num_query=np.int64(553)
2025-03-13 18:58:05,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:06,883 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:06
2025-03-13 18:58:06,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2193.67it/s]
2025-03-13 18:58:06,913 [INFO]: There are 9663 embeddings of dim 49152
2025-03-13 18:58:06,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 18:58:06,913 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:06
2025-03-13 18:58:06,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:06,913 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 18:58:06,913 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:58:06,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:58:06,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:06
2025-03-13 18:58:06,913 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:06,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:58:06,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:06
2025-03-13 18:58:06,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:06,913 [INFO]: 	Creating the index 03/13/2025, 18:58:06
2025-03-13 18:58:06,913 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:06
2025-03-13 18:58:06,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:58:06,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:06
2025-03-13 18:58:06,914 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 18:58:06,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.00it/s] 15%|█▌        | 6/40 [00:00<00:01, 29.21it/s] 30%|███       | 12/40 [00:00<00:00, 39.09it/s] 45%|████▌     | 18/40 [00:00<00:00, 43.70it/s] 57%|█████▊    | 23/40 [00:04<00:04,  3.42it/s] 72%|███████▎  | 29/40 [00:04<00:02,  5.29it/s] 88%|████████▊ | 35/40 [00:04<00:00,  7.76it/s]100%|██████████| 40/40 [00:09<00:00,  2.72it/s]100%|██████████| 40/40 [00:09<00:00,  4.30it/s]
2025-03-13 18:58:16,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:16
2025-03-13 18:59:21,064 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.8357 secs
2025-03-13 18:59:21,064 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 18:59:21,064 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.88it/s]
2025-03-13 19:00:04,816 [INFO]: 	>>> Finished "Compute fast metrics" in 43.7517 secs
2025-03-13 19:00:04,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.9037 secs
2025-03-13 19:00:04,818 [INFO]: {
2025-03-13 19:00:04,818 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:04,818 [INFO]: 	index_param: efSearch=136
2025-03-13 19:00:04,818 [INFO]: 	index_path: knn.index
2025-03-13 19:00:04,818 [INFO]: 	size in bytes: 1901137870
2025-03-13 19:00:04,818 [INFO]: 	avg_search_speed_ms: 7.465029876234372
2025-03-13 19:00:04,818 [INFO]: 	99p_search_speed_ms: 10.875472270417958
2025-03-13 19:00:04,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:04,818 [INFO]: 	nb vectors: 9663
2025-03-13 19:00:04,818 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:04,818 [INFO]: 	compression ratio: 0.9993084320602167
2025-03-13 19:00:04,818 [INFO]: }
2025-03-13 19:00:04,818 [INFO]: 	>>> Finished "Creating the index" in 117.9052 secs
2025-03-13 19:00:04,818 [INFO]: >>> Finished "Launching the whole pipeline" in 117.9356 secs
2025-03-13 19:00:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 27065 [episode count 16/20]
[retrieval_preprocessing] for episode 35776 [episode count 17/20], we have num_retrieval=np.int64(9529) num_query=np.int64(687)
2025-03-13 19:00:08,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:10,183 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:10
2025-03-13 19:00:10,184 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.67it/s]
2025-03-13 19:00:10,213 [INFO]: There are 9529 embeddings of dim 49152
2025-03-13 19:00:10,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 19:00:10,213 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:10
2025-03-13 19:00:10,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:10,213 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 19:00:10,213 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:00:10,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:10,213 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:10
2025-03-13 19:00:10,213 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:10,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:10,213 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:10
2025-03-13 19:00:10,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:10,214 [INFO]: 	Creating the index 03/13/2025, 19:00:10
2025-03-13 19:00:10,214 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:10
2025-03-13 19:00:10,215 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:00:10,215 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:10
2025-03-13 19:00:10,215 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:00:10,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  8.23it/s] 18%|█▊        | 7/39 [00:00<00:00, 36.18it/s] 36%|███▌      | 14/39 [00:00<00:00, 49.04it/s] 54%|█████▍    | 21/39 [00:03<00:04,  4.22it/s] 67%|██████▋   | 26/39 [00:03<00:02,  5.93it/s] 79%|███████▉  | 31/39 [00:03<00:00,  8.18it/s] 92%|█████████▏| 36/39 [00:04<00:00, 11.00it/s]100%|██████████| 39/39 [00:08<00:00,  4.47it/s]
2025-03-13 19:00:18,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:18
2025-03-13 19:01:25,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.5679 secs
2025-03-13 19:01:25,522 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 19:01:25,522 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.93it/s]
2025-03-13 19:01:59,294 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7717 secs
2025-03-13 19:01:59,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.0817 secs
2025-03-13 19:01:59,296 [INFO]: {
2025-03-13 19:01:59,296 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:59,297 [INFO]: 	index_param: efSearch=154
2025-03-13 19:01:59,297 [INFO]: 	index_path: knn.index
2025-03-13 19:01:59,297 [INFO]: 	size in bytes: 1874774350
2025-03-13 19:01:59,297 [INFO]: 	avg_search_speed_ms: 8.12239797179119
2025-03-13 19:01:59,297 [INFO]: 	99p_search_speed_ms: 13.03302263841033
2025-03-13 19:01:59,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:59,297 [INFO]: 	nb vectors: 9529
2025-03-13 19:01:59,297 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:59,297 [INFO]: 	compression ratio: 0.9993083338269483
2025-03-13 19:01:59,297 [INFO]: }
2025-03-13 19:01:59,297 [INFO]: 	>>> Finished "Creating the index" in 109.0831 secs
2025-03-13 19:01:59,297 [INFO]: >>> Finished "Launching the whole pipeline" in 109.1131 secs
2025-03-13 19:02:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 35776 [episode count 17/20]
[retrieval_preprocessing] for episode 26939 [episode count 18/20], we have num_retrieval=np.int64(9791) num_query=np.int64(425)
2025-03-13 19:02:03,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:06,289 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:06
2025-03-13 19:02:06,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 990.62it/s]
2025-03-13 19:02:06,324 [INFO]: There are 9791 embeddings of dim 49152
2025-03-13 19:02:06,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 19:02:06,325 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:06
2025-03-13 19:02:06,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:06,325 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 19:02:06,325 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:02:06,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:02:06,325 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:06
2025-03-13 19:02:06,325 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:06,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:02:06,325 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:06
2025-03-13 19:02:06,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:06,325 [INFO]: 	Creating the index 03/13/2025, 19:02:06
2025-03-13 19:02:06,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:06
2025-03-13 19:02:06,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:02:06,326 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:06
2025-03-13 19:02:06,326 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 19:02:06,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.35it/s] 18%|█▊        | 7/40 [00:00<00:01, 31.81it/s] 32%|███▎      | 13/40 [00:00<00:00, 41.49it/s] 48%|████▊     | 19/40 [00:00<00:00, 46.43it/s] 60%|██████    | 24/40 [00:03<00:04,  3.93it/s] 75%|███████▌  | 30/40 [00:04<00:01,  6.03it/s] 90%|█████████ | 36/40 [00:04<00:00,  8.75it/s]100%|██████████| 40/40 [00:07<00:00,  5.02it/s]
2025-03-13 19:02:14,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:14
2025-03-13 19:03:25,671 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.3730 secs
2025-03-13 19:03:25,671 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 19:03:25,671 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-13 19:04:10,937 [INFO]: 	>>> Finished "Compute fast metrics" in 45.2656 secs
2025-03-13 19:04:10,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.6131 secs
2025-03-13 19:04:10,940 [INFO]: {
2025-03-13 19:04:10,940 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:10,940 [INFO]: 	index_param: efSearch=152
2025-03-13 19:04:10,940 [INFO]: 	index_path: knn.index
2025-03-13 19:04:10,940 [INFO]: 	size in bytes: 1926321250
2025-03-13 19:04:10,940 [INFO]: 	avg_search_speed_ms: 9.405182153231841
2025-03-13 19:04:10,940 [INFO]: 	99p_search_speed_ms: 13.930285866372285
2025-03-13 19:04:10,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:10,940 [INFO]: 	nb vectors: 9791
2025-03-13 19:04:10,940 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:10,940 [INFO]: 	compression ratio: 0.9993083593922872
2025-03-13 19:04:10,940 [INFO]: }
2025-03-13 19:04:10,940 [INFO]: 	>>> Finished "Creating the index" in 124.6148 secs
2025-03-13 19:04:10,940 [INFO]: >>> Finished "Launching the whole pipeline" in 124.6512 secs
2025-03-13 19:04:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 26939 [episode count 18/20]
[retrieval_preprocessing] for episode 42812 [episode count 19/20], we have num_retrieval=np.int64(9138) num_query=np.int64(1078)
2025-03-13 19:04:14,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:16,248 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:16
2025-03-13 19:04:16,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.89it/s]
2025-03-13 19:04:16,289 [INFO]: There are 9138 embeddings of dim 49152
2025-03-13 19:04:16,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-13 19:04:16,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:16,290 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:04:16,290 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:04:16,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:04:16,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,290 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:16,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:04:16,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:16
2025-03-13 19:04:16,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:16,291 [INFO]: 	Creating the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:16
2025-03-13 19:04:16,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 19:04:16,293 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:16
2025-03-13 19:04:16,293 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:04:16,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:03,  9.68it/s] 16%|█▌        | 6/37 [00:00<00:00, 32.64it/s] 30%|██▉       | 11/37 [00:00<00:00, 39.98it/s] 43%|████▎     | 16/37 [00:00<00:00, 43.46it/s] 57%|█████▋    | 21/37 [00:05<00:06,  2.61it/s] 68%|██████▊   | 25/37 [00:05<00:03,  3.66it/s] 81%|████████  | 30/37 [00:05<00:01,  5.41it/s] 92%|█████████▏| 34/37 [00:05<00:00,  7.21it/s]100%|██████████| 37/37 [00:10<00:00,  3.59it/s]
2025-03-13 19:04:26,620 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:26
2025-03-13 19:05:29,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6024 secs
2025-03-13 19:05:29,223 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 19:05:29,223 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 19:06:27,421 [INFO]: 	>>> Finished "Compute fast metrics" in 58.1972 secs
2025-03-13 19:06:27,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 131.1311 secs
2025-03-13 19:06:27,424 [INFO]: {
2025-03-13 19:06:27,424 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:27,424 [INFO]: 	index_param: efSearch=119
2025-03-13 19:06:27,424 [INFO]: 	index_path: knn.index
2025-03-13 19:06:27,424 [INFO]: 	size in bytes: 1797847570
2025-03-13 19:06:27,424 [INFO]: 	avg_search_speed_ms: 8.019612096257525
2025-03-13 19:06:27,424 [INFO]: 	99p_search_speed_ms: 11.918984102085227
2025-03-13 19:06:27,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:27,424 [INFO]: 	nb vectors: 9138
2025-03-13 19:06:27,424 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:27,424 [INFO]: 	compression ratio: 0.9993082472503495
2025-03-13 19:06:27,424 [INFO]: }
2025-03-13 19:06:27,424 [INFO]: 	>>> Finished "Creating the index" in 131.1335 secs
2025-03-13 19:06:27,424 [INFO]: >>> Finished "Launching the whole pipeline" in 131.1763 secs
2025-03-13 19:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 42812 [episode count 19/20]
2025-03-13 19:06:35: [retrieval_preprocessing] finished for 6486961974_pick_up_ropes_and_put_in_box [chosen_id count 7/196]
2025-03-13 19:06:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 6498288010_turn_off_extension_cord [chosen_id count 8/196]
2025-03-13 19:06:36: [retrieval_preprocessing] we have num_total=2916 embedding_dim=49152
[retrieval_preprocessing] for episode 75918 [episode count 0/20], we have num_retrieval=np.int64(2725) num_query=np.int64(191)
2025-03-13 19:06:37,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:37,680 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:37
2025-03-13 19:06:37,680 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1327.31it/s]
2025-03-13 19:06:37,721 [INFO]: There are 2725 embeddings of dim 49152
2025-03-13 19:06:37,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0414 secs
2025-03-13 19:06:37,722 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:37
2025-03-13 19:06:37,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:37,722 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:06:37,722 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:37,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:37,722 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:37
2025-03-13 19:06:37,722 [INFO]: 562.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:37,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:06:37,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:37
2025-03-13 19:06:37,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:37,723 [INFO]: 	Creating the index 03/13/2025, 19:06:37
2025-03-13 19:06:37,723 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:37
2025-03-13 19:06:37,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:06:37,724 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:37
2025-03-13 19:06:37,724 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:06:37,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.32it/s] 82%|████████▏ | 9/11 [00:00<00:00, 27.75it/s]100%|██████████| 11/11 [00:02<00:00,  3.90it/s]
2025-03-13 19:06:40,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:40
2025-03-13 19:07:13,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4594 secs
2025-03-13 19:07:13,012 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 19:07:13,012 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.34it/s]
2025-03-13 19:07:31,576 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5637 secs
2025-03-13 19:07:31,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8538 secs
2025-03-13 19:07:31,578 [INFO]: {
2025-03-13 19:07:31,578 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:31,578 [INFO]: 	index_param: efSearch=186
2025-03-13 19:07:31,578 [INFO]: 	index_path: knn.index
2025-03-13 19:07:31,578 [INFO]: 	size in bytes: 536126830
2025-03-13 19:07:31,578 [INFO]: 	avg_search_speed_ms: 7.635353826242321
2025-03-13 19:07:31,578 [INFO]: 	99p_search_speed_ms: 11.061093856114896
2025-03-13 19:07:31,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:31,578 [INFO]: 	nb vectors: 2725
2025-03-13 19:07:31,578 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:31,578 [INFO]: 	compression ratio: 0.9993098088375842
2025-03-13 19:07:31,578 [INFO]: }
2025-03-13 19:07:31,578 [INFO]: 	>>> Finished "Creating the index" in 53.8557 secs
2025-03-13 19:07:31,578 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8979 secs
2025-03-13 19:07:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 75918 [episode count 0/20]
[retrieval_preprocessing] for episode 8366 [episode count 1/20], we have num_retrieval=np.int64(2801) num_query=np.int64(115)
2025-03-13 19:07:32,990 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:33,321 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:33
2025-03-13 19:07:33,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-13 19:07:33,351 [INFO]: There are 2801 embeddings of dim 49152
2025-03-13 19:07:33,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 19:07:33,352 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:33
2025-03-13 19:07:33,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:33,352 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:07:33,352 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:33,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:07:33,352 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:33
2025-03-13 19:07:33,353 [INFO]: 578.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:33,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:07:33,353 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:33
2025-03-13 19:07:33,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:33,354 [INFO]: 	Creating the index 03/13/2025, 19:07:33
2025-03-13 19:07:33,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:33
2025-03-13 19:07:33,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:07:33,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:33
2025-03-13 19:07:33,357 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:07:33,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.41it/s] 75%|███████▌  | 9/12 [00:00<00:00, 41.20it/s]100%|██████████| 12/12 [00:02<00:00,  5.63it/s]
2025-03-13 19:07:35,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:35
2025-03-13 19:08:00,771 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2767 secs
2025-03-13 19:08:00,771 [INFO]: The best hyperparameters are: efSearch=398
2025-03-13 19:08:00,771 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.22it/s]
2025-03-13 19:08:24,318 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5470 secs
2025-03-13 19:08:24,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9633 secs
2025-03-13 19:08:24,320 [INFO]: {
2025-03-13 19:08:24,320 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:24,320 [INFO]: 	index_param: efSearch=398
2025-03-13 19:08:24,320 [INFO]: 	index_path: knn.index
2025-03-13 19:08:24,320 [INFO]: 	size in bytes: 551079430
2025-03-13 19:08:24,320 [INFO]: 	avg_search_speed_ms: 14.374025701277558
2025-03-13 19:08:24,321 [INFO]: 	99p_search_speed_ms: 20.903109665960063
2025-03-13 19:08:24,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:24,321 [INFO]: 	nb vectors: 2801
2025-03-13 19:08:24,321 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:24,321 [INFO]: 	compression ratio: 0.9993096784614153
2025-03-13 19:08:24,321 [INFO]: }
2025-03-13 19:08:24,321 [INFO]: 	>>> Finished "Creating the index" in 50.9668 secs
2025-03-13 19:08:24,321 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9999 secs
2025-03-13 19:08:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 8366 [episode count 1/20]
[retrieval_preprocessing] for episode 18608 [episode count 2/20], we have num_retrieval=np.int64(2770) num_query=np.int64(146)
2025-03-13 19:08:26,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:27,364 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:27
2025-03-13 19:08:27,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.80it/s]
2025-03-13 19:08:27,396 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 19:08:27,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 19:08:27,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:27
2025-03-13 19:08:27,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:27,397 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:08:27,397 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:27,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 19:08:27,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:27
2025-03-13 19:08:27,398 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:27,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:08:27,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:27
2025-03-13 19:08:27,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:27,399 [INFO]: 	Creating the index 03/13/2025, 19:08:27
2025-03-13 19:08:27,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:27
2025-03-13 19:08:27,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:08:27,402 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:27
2025-03-13 19:08:27,402 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:08:27,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.45it/s] 82%|████████▏ | 9/11 [00:00<00:00, 42.36it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]
2025-03-13 19:08:30,037 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:30
2025-03-13 19:09:01,101 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0632 secs
2025-03-13 19:09:01,101 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 19:09:01,102 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.38it/s]
2025-03-13 19:09:18,466 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3643 secs
2025-03-13 19:09:18,468 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0659 secs
2025-03-13 19:09:18,468 [INFO]: {
2025-03-13 19:09:18,468 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:18,468 [INFO]: 	index_param: efSearch=295
2025-03-13 19:09:18,468 [INFO]: 	index_path: knn.index
2025-03-13 19:09:18,468 [INFO]: 	size in bytes: 544980310
2025-03-13 19:09:18,468 [INFO]: 	avg_search_speed_ms: 11.306231206619723
2025-03-13 19:09:18,468 [INFO]: 	99p_search_speed_ms: 17.71813140250742
2025-03-13 19:09:18,468 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:18,468 [INFO]: 	nb vectors: 2770
2025-03-13 19:09:18,468 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:18,468 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 19:09:18,468 [INFO]: }
2025-03-13 19:09:18,468 [INFO]: 	>>> Finished "Creating the index" in 51.0694 secs
2025-03-13 19:09:18,468 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1047 secs
2025-03-13 19:09:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 18608 [episode count 2/20]
[retrieval_preprocessing] for episode 57572 [episode count 3/20], we have num_retrieval=np.int64(2766) num_query=np.int64(150)
2025-03-13 19:09:20,275 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:20,757 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:20
2025-03-13 19:09:20,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.18it/s]
2025-03-13 19:09:20,788 [INFO]: There are 2766 embeddings of dim 49152
2025-03-13 19:09:20,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 19:09:20,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:20
2025-03-13 19:09:20,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:20,788 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:09:20,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:20,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:20,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:20
2025-03-13 19:09:20,789 [INFO]: 570.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:20,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:09:20,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:20
2025-03-13 19:09:20,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:20,789 [INFO]: 	Creating the index 03/13/2025, 19:09:20
2025-03-13 19:09:20,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:20
2025-03-13 19:09:20,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:09:20,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:20
2025-03-13 19:09:20,790 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:09:20,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.22it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.96it/s]100%|██████████| 11/11 [00:01<00:00,  4.65it/s]100%|██████████| 11/11 [00:01<00:00,  5.75it/s]
2025-03-13 19:09:22,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:22
2025-03-13 19:09:50,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8934 secs
2025-03-13 19:09:50,600 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 19:09:50,601 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 19:10:09,481 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8807 secs
2025-03-13 19:10:09,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6928 secs
2025-03-13 19:10:09,483 [INFO]: {
2025-03-13 19:10:09,483 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:09,483 [INFO]: 	index_param: efSearch=220
2025-03-13 19:10:09,483 [INFO]: 	index_path: knn.index
2025-03-13 19:10:09,483 [INFO]: 	size in bytes: 544193350
2025-03-13 19:10:09,483 [INFO]: 	avg_search_speed_ms: 8.703126121811678
2025-03-13 19:10:09,483 [INFO]: 	99p_search_speed_ms: 13.011434692889448
2025-03-13 19:10:09,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:09,483 [INFO]: 	nb vectors: 2766
2025-03-13 19:10:09,483 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:09,483 [INFO]: 	compression ratio: 0.9993097637080645
2025-03-13 19:10:09,483 [INFO]: }
2025-03-13 19:10:09,483 [INFO]: 	>>> Finished "Creating the index" in 48.6945 secs
2025-03-13 19:10:09,483 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7260 secs
2025-03-13 19:10:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 57572 [episode count 3/20]
[retrieval_preprocessing] for episode 26846 [episode count 4/20], we have num_retrieval=np.int64(2766) num_query=np.int64(150)
2025-03-13 19:10:11,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:11,965 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:11
2025-03-13 19:10:11,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1792.44it/s]
2025-03-13 19:10:11,995 [INFO]: There are 2766 embeddings of dim 49152
2025-03-13 19:10:11,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 19:10:11,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:11
2025-03-13 19:10:11,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:11,996 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:10:11,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:11,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:10:11,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:11
2025-03-13 19:10:11,997 [INFO]: 570.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:11,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:10:11,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:11
2025-03-13 19:10:11,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:11,997 [INFO]: 	Creating the index 03/13/2025, 19:10:11
2025-03-13 19:10:11,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:11
2025-03-13 19:10:11,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 19:10:12,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:12
2025-03-13 19:10:12,000 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:10:12,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.70it/s]100%|██████████| 11/11 [00:01<00:00,  4.75it/s]100%|██████████| 11/11 [00:01<00:00,  5.85it/s]
2025-03-13 19:10:13,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:13
2025-03-13 19:10:41,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7410 secs
2025-03-13 19:10:41,627 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 19:10:41,627 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.63it/s]
2025-03-13 19:10:58,411 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7832 secs
2025-03-13 19:10:58,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8904 secs
2025-03-13 19:10:58,890 [INFO]: {
2025-03-13 19:10:58,891 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:58,891 [INFO]: 	index_param: efSearch=225
2025-03-13 19:10:58,891 [INFO]: 	index_path: knn.index
2025-03-13 19:10:58,891 [INFO]: 	size in bytes: 544193350
2025-03-13 19:10:58,891 [INFO]: 	avg_search_speed_ms: 11.689150045521417
2025-03-13 19:10:58,891 [INFO]: 	99p_search_speed_ms: 18.50396562367678
2025-03-13 19:10:58,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:58,891 [INFO]: 	nb vectors: 2766
2025-03-13 19:10:58,891 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:58,891 [INFO]: 	compression ratio: 0.9993097637080645
2025-03-13 19:10:58,891 [INFO]: }
2025-03-13 19:10:58,891 [INFO]: 	>>> Finished "Creating the index" in 46.8939 secs
2025-03-13 19:10:58,891 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9261 secs
2025-03-13 19:10:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 26846 [episode count 4/20]
[retrieval_preprocessing] for episode 33104 [episode count 5/20], we have num_retrieval=np.int64(2787) num_query=np.int64(129)
2025-03-13 19:11:00,363 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:00,775 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:00
2025-03-13 19:11:00,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.95it/s]
2025-03-13 19:11:00,808 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 19:11:00,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 19:11:00,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:00,808 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:11:00,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:00,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:11:00,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,809 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:00,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:11:00,809 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:00
2025-03-13 19:11:00,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:00,809 [INFO]: 	Creating the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,809 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:00
2025-03-13 19:11:00,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:11:00,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,810 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:11:00,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.15it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.20it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]100%|██████████| 11/11 [00:02<00:00,  4.73it/s]
2025-03-13 19:11:03,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:03
2025-03-13 19:11:31,960 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8207 secs
2025-03-13 19:11:31,960 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 19:11:31,960 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 19:11:48,507 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5464 secs
2025-03-13 19:11:48,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6991 secs
2025-03-13 19:11:48,509 [INFO]: {
2025-03-13 19:11:48,509 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:48,509 [INFO]: 	index_param: efSearch=328
2025-03-13 19:11:48,509 [INFO]: 	index_path: knn.index
2025-03-13 19:11:48,509 [INFO]: 	size in bytes: 548324890
2025-03-13 19:11:48,509 [INFO]: 	avg_search_speed_ms: 12.443195241364414
2025-03-13 19:11:48,509 [INFO]: 	99p_search_speed_ms: 20.636931697372347
2025-03-13 19:11:48,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:48,509 [INFO]: 	nb vectors: 2787
2025-03-13 19:11:48,509 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:48,509 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 19:11:48,509 [INFO]: }
2025-03-13 19:11:48,509 [INFO]: 	>>> Finished "Creating the index" in 47.7005 secs
2025-03-13 19:11:48,509 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7342 secs
2025-03-13 19:11:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 33104 [episode count 5/20]
[retrieval_preprocessing] for episode 27028 [episode count 6/20], we have num_retrieval=np.int64(2770) num_query=np.int64(146)
2025-03-13 19:11:50,131 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:51,256 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:51
2025-03-13 19:11:51,256 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 993.91it/s]
2025-03-13 19:11:51,285 [INFO]: There are 2770 embeddings of dim 49152
2025-03-13 19:11:51,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 19:11:51,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:51,286 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:11:51,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:51,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:11:51,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,287 [INFO]: 571.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:51,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:11:51,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:51
2025-03-13 19:11:51,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:51,288 [INFO]: 	Creating the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:51
2025-03-13 19:11:51,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:11:51,291 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:51
2025-03-13 19:11:51,291 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:11:51,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.37it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.57it/s]100%|██████████| 11/11 [00:02<00:00,  4.13it/s]
2025-03-13 19:11:53,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:53
2025-03-13 19:12:24,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8586 secs
2025-03-13 19:12:24,823 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 19:12:24,823 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.07it/s]
2025-03-13 19:12:42,930 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1060 secs
2025-03-13 19:12:42,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6409 secs
2025-03-13 19:12:42,932 [INFO]: {
2025-03-13 19:12:42,932 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:42,932 [INFO]: 	index_param: efSearch=229
2025-03-13 19:12:42,932 [INFO]: 	index_path: knn.index
2025-03-13 19:12:42,932 [INFO]: 	size in bytes: 544980310
2025-03-13 19:12:42,932 [INFO]: 	avg_search_speed_ms: 10.841407422642279
2025-03-13 19:12:42,932 [INFO]: 	99p_search_speed_ms: 15.763078872114416
2025-03-13 19:12:42,932 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:42,932 [INFO]: 	nb vectors: 2770
2025-03-13 19:12:42,932 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:42,932 [INFO]: 	compression ratio: 0.9993097915776077
2025-03-13 19:12:42,932 [INFO]: }
2025-03-13 19:12:42,932 [INFO]: 	>>> Finished "Creating the index" in 51.6445 secs
2025-03-13 19:12:42,933 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6763 secs
2025-03-13 19:12:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 27028 [episode count 6/20]
[retrieval_preprocessing] for episode 16944 [episode count 7/20], we have num_retrieval=np.int64(2803) num_query=np.int64(113)
2025-03-13 19:12:45,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:45,858 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:45
2025-03-13 19:12:45,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1250.54it/s]
2025-03-13 19:12:45,893 [INFO]: There are 2803 embeddings of dim 49152
2025-03-13 19:12:45,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 19:12:45,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:45
2025-03-13 19:12:45,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:45,893 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:12:45,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:45,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:12:45,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:45
2025-03-13 19:12:45,893 [INFO]: 578.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:45,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:12:45,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:45
2025-03-13 19:12:45,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:45,893 [INFO]: 	Creating the index 03/13/2025, 19:12:45
2025-03-13 19:12:45,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:45
2025-03-13 19:12:45,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:12:45,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:45
2025-03-13 19:12:45,895 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:12:45,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.72it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.20it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.42it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.97it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.29it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.55it/s]100%|██████████| 12/12 [00:03<00:00,  3.91it/s]
2025-03-13 19:12:49,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:49
2025-03-13 19:13:18,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0879 secs
2025-03-13 19:13:18,426 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 19:13:18,426 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s]
2025-03-13 19:13:35,100 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6738 secs
2025-03-13 19:13:35,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2073 secs
2025-03-13 19:13:35,103 [INFO]: {
2025-03-13 19:13:35,103 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:35,103 [INFO]: 	index_param: efSearch=276
2025-03-13 19:13:35,103 [INFO]: 	index_path: knn.index
2025-03-13 19:13:35,103 [INFO]: 	size in bytes: 551472910
2025-03-13 19:13:35,103 [INFO]: 	avg_search_speed_ms: 9.31851618718408
2025-03-13 19:13:35,103 [INFO]: 	99p_search_speed_ms: 14.707965897396198
2025-03-13 19:13:35,103 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:35,103 [INFO]: 	nb vectors: 2803
2025-03-13 19:13:35,103 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:35,103 [INFO]: 	compression ratio: 0.9993096922929542
2025-03-13 19:13:35,103 [INFO]: }
2025-03-13 19:13:35,103 [INFO]: 	>>> Finished "Creating the index" in 49.2092 secs
2025-03-13 19:13:35,103 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2447 secs
2025-03-13 19:13:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 16944 [episode count 7/20]
[retrieval_preprocessing] for episode 47677 [episode count 8/20], we have num_retrieval=np.int64(2765) num_query=np.int64(151)
2025-03-13 19:13:37,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:37,886 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:37
2025-03-13 19:13:37,886 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.70it/s]
2025-03-13 19:13:37,913 [INFO]: There are 2765 embeddings of dim 49152
2025-03-13 19:13:37,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 19:13:37,913 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:37
2025-03-13 19:13:37,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:37,913 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:13:37,913 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:37,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:37,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:37
2025-03-13 19:13:37,913 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:37,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:37,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:37
2025-03-13 19:13:37,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:37,913 [INFO]: 	Creating the index 03/13/2025, 19:13:37
2025-03-13 19:13:37,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:37
2025-03-13 19:13:37,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:13:37,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:37
2025-03-13 19:13:37,915 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:13:37,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.80it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.01it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.86it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.05it/s]100%|██████████| 11/11 [00:02<00:00,  2.56it/s]100%|██████████| 11/11 [00:02<00:00,  3.98it/s]
2025-03-13 19:13:40,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:40
2025-03-13 19:14:09,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0063 secs
2025-03-13 19:14:09,693 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 19:14:09,693 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s]
2025-03-13 19:14:26,207 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5131 secs
2025-03-13 19:14:26,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2943 secs
2025-03-13 19:14:26,209 [INFO]: {
2025-03-13 19:14:26,209 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:26,209 [INFO]: 	index_param: efSearch=315
2025-03-13 19:14:26,209 [INFO]: 	index_path: knn.index
2025-03-13 19:14:26,209 [INFO]: 	size in bytes: 543996610
2025-03-13 19:14:26,209 [INFO]: 	avg_search_speed_ms: 10.779922295177098
2025-03-13 19:14:26,209 [INFO]: 	99p_search_speed_ms: 16.858250808436434
2025-03-13 19:14:26,209 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:26,209 [INFO]: 	nb vectors: 2765
2025-03-13 19:14:26,209 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:26,209 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-13 19:14:26,209 [INFO]: }
2025-03-13 19:14:26,209 [INFO]: 	>>> Finished "Creating the index" in 48.2960 secs
2025-03-13 19:14:26,209 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3231 secs
2025-03-13 19:14:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 47677 [episode count 8/20]
[retrieval_preprocessing] for episode 62114 [episode count 9/20], we have num_retrieval=np.int64(2757) num_query=np.int64(159)
2025-03-13 19:14:28,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:29,290 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:29
2025-03-13 19:14:29,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.31it/s]
2025-03-13 19:14:29,314 [INFO]: There are 2757 embeddings of dim 49152
2025-03-13 19:14:29,314 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:14:29,314 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:29
2025-03-13 19:14:29,314 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:29,314 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:14:29,314 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:29,314 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:29,314 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:29
2025-03-13 19:14:29,314 [INFO]: 569.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:29,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:14:29,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:29
2025-03-13 19:14:29,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:29,314 [INFO]: 	Creating the index 03/13/2025, 19:14:29
2025-03-13 19:14:29,315 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:29
2025-03-13 19:14:29,316 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:14:29,316 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:29
2025-03-13 19:14:29,316 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:14:29,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.15it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.14it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.72it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.16it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.62it/s]100%|██████████| 11/11 [00:02<00:00,  2.33it/s]100%|██████████| 11/11 [00:02<00:00,  3.69it/s]
2025-03-13 19:14:32,301 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:32
2025-03-13 19:14:58,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2680 secs
2025-03-13 19:14:58,570 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 19:14:58,570 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 19:15:25,172 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6014 secs
2025-03-13 19:15:25,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8588 secs
2025-03-13 19:15:25,175 [INFO]: {
2025-03-13 19:15:25,175 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:25,175 [INFO]: 	index_param: efSearch=294
2025-03-13 19:15:25,175 [INFO]: 	index_path: knn.index
2025-03-13 19:15:25,175 [INFO]: 	size in bytes: 542422510
2025-03-13 19:15:25,175 [INFO]: 	avg_search_speed_ms: 10.272984843766212
2025-03-13 19:15:25,175 [INFO]: 	99p_search_speed_ms: 14.128774143755434
2025-03-13 19:15:25,175 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:25,175 [INFO]: 	nb vectors: 2757
2025-03-13 19:15:25,175 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:25,175 [INFO]: 	compression ratio: 0.9993100323214831
2025-03-13 19:15:25,175 [INFO]: }
2025-03-13 19:15:25,175 [INFO]: 	>>> Finished "Creating the index" in 55.8604 secs
2025-03-13 19:15:25,175 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8853 secs
2025-03-13 19:15:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 62114 [episode count 9/20]
[retrieval_preprocessing] for episode 68331 [episode count 10/20], we have num_retrieval=np.int64(2741) num_query=np.int64(175)
2025-03-13 19:15:27,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:27,913 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:27
2025-03-13 19:15:27,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 19:15:27,936 [INFO]: There are 2741 embeddings of dim 49152
2025-03-13 19:15:27,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 19:15:27,936 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:27,936 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:15:27,936 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:27,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:27,936 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,936 [INFO]: 565.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:27,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:15:27,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:27
2025-03-13 19:15:27,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:27,936 [INFO]: 	Creating the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:27
2025-03-13 19:15:27,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:15:27,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,937 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:15:27,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.86it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.18it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.11it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.57it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.74it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.81it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.75it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.48it/s]100%|██████████| 11/11 [00:03<00:00,  1.37it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 19:15:31,275 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:31
2025-03-13 19:15:58,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6296 secs
2025-03-13 19:15:58,905 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 19:15:58,906 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 50%|█████     | 2/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 19:16:15,629 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7238 secs
2025-03-13 19:16:15,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6939 secs
2025-03-13 19:16:15,631 [INFO]: {
2025-03-13 19:16:15,631 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:15,631 [INFO]: 	index_param: efSearch=289
2025-03-13 19:16:15,631 [INFO]: 	index_path: knn.index
2025-03-13 19:16:15,631 [INFO]: 	size in bytes: 539274670
2025-03-13 19:16:15,631 [INFO]: 	avg_search_speed_ms: 9.73680904706416
2025-03-13 19:16:15,631 [INFO]: 	99p_search_speed_ms: 13.034215732477605
2025-03-13 19:16:15,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:15,631 [INFO]: 	nb vectors: 2741
2025-03-13 19:16:15,631 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:15,631 [INFO]: 	compression ratio: 0.9993099212317909
2025-03-13 19:16:15,631 [INFO]: }
2025-03-13 19:16:15,632 [INFO]: 	>>> Finished "Creating the index" in 47.6952 secs
2025-03-13 19:16:15,632 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7188 secs
2025-03-13 19:16:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 68331 [episode count 10/20]
[retrieval_preprocessing] for episode 54037 [episode count 11/20], we have num_retrieval=np.int64(2762) num_query=np.int64(154)
2025-03-13 19:16:17,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:18,092 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:18
2025-03-13 19:16:18,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2197.12it/s]
2025-03-13 19:16:18,118 [INFO]: There are 2762 embeddings of dim 49152
2025-03-13 19:16:18,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 19:16:18,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:18
2025-03-13 19:16:18,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:18,118 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:16:18,118 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:18,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:16:18,118 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:18
2025-03-13 19:16:18,118 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:18,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:16:18,118 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:18
2025-03-13 19:16:18,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:18,118 [INFO]: 	Creating the index 03/13/2025, 19:16:18
2025-03-13 19:16:18,118 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:18
2025-03-13 19:16:18,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:16:18,120 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:18
2025-03-13 19:16:18,120 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:16:18,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.31it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.59it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.35it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.69it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.37it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.31it/s]100%|██████████| 11/11 [00:02<00:00,  4.11it/s]
2025-03-13 19:16:20,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:20
2025-03-13 19:16:47,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8718 secs
2025-03-13 19:16:47,683 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 19:16:47,683 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s]
2025-03-13 19:17:06,313 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6295 secs
2025-03-13 19:17:06,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1956 secs
2025-03-13 19:17:06,315 [INFO]: {
2025-03-13 19:17:06,315 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:06,316 [INFO]: 	index_param: efSearch=293
2025-03-13 19:17:06,316 [INFO]: 	index_path: knn.index
2025-03-13 19:17:06,316 [INFO]: 	size in bytes: 543406270
2025-03-13 19:17:06,316 [INFO]: 	avg_search_speed_ms: 10.428932982198777
2025-03-13 19:17:06,316 [INFO]: 	99p_search_speed_ms: 18.113601692020875
2025-03-13 19:17:06,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:06,316 [INFO]: 	nb vectors: 2762
2025-03-13 19:17:06,316 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:06,316 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-13 19:17:06,316 [INFO]: }
2025-03-13 19:17:06,316 [INFO]: 	>>> Finished "Creating the index" in 48.1975 secs
2025-03-13 19:17:06,316 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2239 secs
2025-03-13 19:17:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 54037 [episode count 11/20]
[retrieval_preprocessing] for episode 4898 [episode count 12/20], we have num_retrieval=np.int64(2763) num_query=np.int64(153)
2025-03-13 19:17:08,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:09,430 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:09
2025-03-13 19:17:09,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1078.50it/s]
2025-03-13 19:17:09,456 [INFO]: There are 2763 embeddings of dim 49152
2025-03-13 19:17:09,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 19:17:09,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:09
2025-03-13 19:17:09,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:09,456 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:17:09,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:09,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:09,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:09
2025-03-13 19:17:09,457 [INFO]: 570.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:09,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:17:09,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:09
2025-03-13 19:17:09,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:09,457 [INFO]: 	Creating the index 03/13/2025, 19:17:09
2025-03-13 19:17:09,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:09
2025-03-13 19:17:09,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:17:09,458 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:09
2025-03-13 19:17:09,458 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:17:09,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.48it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.74it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.04it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.20it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.36it/s]100%|██████████| 11/11 [00:02<00:00,  2.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.04it/s]
2025-03-13 19:17:12,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:12
2025-03-13 19:17:42,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8896 secs
2025-03-13 19:17:42,079 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 19:17:42,079 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 19:18:00,454 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3748 secs
2025-03-13 19:18:00,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9985 secs
2025-03-13 19:18:00,457 [INFO]: {
2025-03-13 19:18:00,457 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:00,457 [INFO]: 	index_param: efSearch=308
2025-03-13 19:18:00,457 [INFO]: 	index_path: knn.index
2025-03-13 19:18:00,457 [INFO]: 	size in bytes: 543603010
2025-03-13 19:18:00,457 [INFO]: 	avg_search_speed_ms: 11.167372798289373
2025-03-13 19:18:00,457 [INFO]: 	99p_search_speed_ms: 15.808557847049075
2025-03-13 19:18:00,457 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:00,457 [INFO]: 	nb vectors: 2763
2025-03-13 19:18:00,457 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:00,457 [INFO]: 	compression ratio: 0.9993099633499086
2025-03-13 19:18:00,457 [INFO]: }
2025-03-13 19:18:00,457 [INFO]: 	>>> Finished "Creating the index" in 51.0000 secs
2025-03-13 19:18:00,457 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0269 secs
2025-03-13 19:18:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 4898 [episode count 12/20]
[retrieval_preprocessing] for episode 60267 [episode count 13/20], we have num_retrieval=np.int64(2775) num_query=np.int64(141)
2025-03-13 19:18:03,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:04,289 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:04
2025-03-13 19:18:04,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2280.75it/s]
2025-03-13 19:18:04,313 [INFO]: There are 2775 embeddings of dim 49152
2025-03-13 19:18:04,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 19:18:04,314 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:04
2025-03-13 19:18:04,314 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:04,314 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:18:04,314 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:04,314 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:18:04,314 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:04
2025-03-13 19:18:04,314 [INFO]: 572.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:04,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:18:04,315 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:04
2025-03-13 19:18:04,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:04,315 [INFO]: 	Creating the index 03/13/2025, 19:18:04
2025-03-13 19:18:04,315 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:04
2025-03-13 19:18:04,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:18:04,318 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:04
2025-03-13 19:18:04,318 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:18:04,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.99it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.62it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.83it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.23it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.45it/s]100%|██████████| 11/11 [00:02<00:00,  2.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.58it/s]
2025-03-13 19:18:06,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:06
2025-03-13 19:18:35,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8339 secs
2025-03-13 19:18:35,565 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:18:35,565 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 19:18:58,241 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6756 secs
2025-03-13 19:18:58,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9248 secs
2025-03-13 19:18:58,243 [INFO]: {
2025-03-13 19:18:58,243 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:58,243 [INFO]: 	index_param: efSearch=257
2025-03-13 19:18:58,243 [INFO]: 	index_path: knn.index
2025-03-13 19:18:58,243 [INFO]: 	size in bytes: 545964010
2025-03-13 19:18:58,243 [INFO]: 	avg_search_speed_ms: 8.354334305207818
2025-03-13 19:18:58,243 [INFO]: 	99p_search_speed_ms: 15.680147754028438
2025-03-13 19:18:58,243 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:58,243 [INFO]: 	nb vectors: 2775
2025-03-13 19:18:58,243 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:58,244 [INFO]: 	compression ratio: 0.9993098263015542
2025-03-13 19:18:58,244 [INFO]: }
2025-03-13 19:18:58,244 [INFO]: 	>>> Finished "Creating the index" in 53.9284 secs
2025-03-13 19:18:58,244 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9544 secs
2025-03-13 19:18:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 60267 [episode count 13/20]
[retrieval_preprocessing] for episode 39789 [episode count 14/20], we have num_retrieval=np.int64(2783) num_query=np.int64(133)
2025-03-13 19:19:00,412 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:00,821 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:00
2025-03-13 19:19:00,821 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.41it/s]
2025-03-13 19:19:00,853 [INFO]: There are 2783 embeddings of dim 49152
2025-03-13 19:19:00,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 19:19:00,853 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:00
2025-03-13 19:19:00,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:00,854 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:19:00,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:00,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:19:00,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:00
2025-03-13 19:19:00,854 [INFO]: 574.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:00,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 19:19:00,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:00
2025-03-13 19:19:00,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:00,855 [INFO]: 	Creating the index 03/13/2025, 19:19:00
2025-03-13 19:19:00,856 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:00
2025-03-13 19:19:00,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:19:00,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:00
2025-03-13 19:19:00,859 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:19:00,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.37it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.97it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.86it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.30it/s]100%|██████████| 11/11 [00:03<00:00,  2.31it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-13 19:19:03,893 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:03
2025-03-13 19:19:31,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7625 secs
2025-03-13 19:19:31,656 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 19:19:31,656 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s]
2025-03-13 19:19:50,489 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8330 secs
2025-03-13 19:19:50,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6326 secs
2025-03-13 19:19:50,491 [INFO]: {
2025-03-13 19:19:50,491 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:50,491 [INFO]: 	index_param: efSearch=305
2025-03-13 19:19:50,491 [INFO]: 	index_path: knn.index
2025-03-13 19:19:50,491 [INFO]: 	size in bytes: 547537930
2025-03-13 19:19:50,492 [INFO]: 	avg_search_speed_ms: 9.591916279576198
2025-03-13 19:19:50,492 [INFO]: 	99p_search_speed_ms: 12.673607384786006
2025-03-13 19:19:50,492 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:50,492 [INFO]: 	nb vectors: 2783
2025-03-13 19:19:50,492 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:50,492 [INFO]: 	compression ratio: 0.9993098816003487
2025-03-13 19:19:50,492 [INFO]: }
2025-03-13 19:19:50,492 [INFO]: 	>>> Finished "Creating the index" in 49.6361 secs
2025-03-13 19:19:50,492 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6701 secs
2025-03-13 19:19:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 39789 [episode count 14/20]
[retrieval_preprocessing] for episode 17520 [episode count 15/20], we have num_retrieval=np.int64(2773) num_query=np.int64(143)
2025-03-13 19:19:54,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:54,577 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:54
2025-03-13 19:19:54,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.53it/s]
2025-03-13 19:19:54,602 [INFO]: There are 2773 embeddings of dim 49152
2025-03-13 19:19:54,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 19:19:54,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:54
2025-03-13 19:19:54,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:54,602 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:19:54,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:54,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:19:54,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:54
2025-03-13 19:19:54,602 [INFO]: 572.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:54,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:19:54,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:54
2025-03-13 19:19:54,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:54,603 [INFO]: 	Creating the index 03/13/2025, 19:19:54
2025-03-13 19:19:54,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:54
2025-03-13 19:19:54,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:19:54,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:54
2025-03-13 19:19:54,604 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:19:54,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.59it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.82it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.73it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.58it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.84it/s]100%|██████████| 11/11 [00:02<00:00,  2.51it/s]100%|██████████| 11/11 [00:02<00:00,  3.89it/s]
2025-03-13 19:19:57,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:57
2025-03-13 19:20:25,272 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8301 secs
2025-03-13 19:20:25,272 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 19:20:25,272 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-13 19:20:40,971 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6988 secs
2025-03-13 19:20:40,973 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3696 secs
2025-03-13 19:20:40,974 [INFO]: {
2025-03-13 19:20:40,974 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:40,974 [INFO]: 	index_param: efSearch=317
2025-03-13 19:20:40,974 [INFO]: 	index_path: knn.index
2025-03-13 19:20:40,974 [INFO]: 	size in bytes: 545570530
2025-03-13 19:20:40,974 [INFO]: 	avg_search_speed_ms: 10.63377303294243
2025-03-13 19:20:40,974 [INFO]: 	99p_search_speed_ms: 18.2645629090257
2025-03-13 19:20:40,974 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:40,974 [INFO]: 	nb vectors: 2773
2025-03-13 19:20:40,974 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:40,974 [INFO]: 	compression ratio: 0.9993098124270019
2025-03-13 19:20:40,974 [INFO]: }
2025-03-13 19:20:40,974 [INFO]: 	>>> Finished "Creating the index" in 46.3711 secs
2025-03-13 19:20:40,974 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3962 secs
2025-03-13 19:20:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 17520 [episode count 15/20]
[retrieval_preprocessing] for episode 9679 [episode count 16/20], we have num_retrieval=np.int64(2754) num_query=np.int64(162)
2025-03-13 19:20:43,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:43,757 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:43
2025-03-13 19:20:43,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-13 19:20:43,778 [INFO]: There are 2754 embeddings of dim 49152
2025-03-13 19:20:43,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 19:20:43,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:43
2025-03-13 19:20:43,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:43,779 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:20:43,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:43,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:20:43,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:43
2025-03-13 19:20:43,779 [INFO]: 568.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:43,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:20:43,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:43
2025-03-13 19:20:43,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:43,779 [INFO]: 	Creating the index 03/13/2025, 19:20:43
2025-03-13 19:20:43,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:43
2025-03-13 19:20:43,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:20:43,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:43
2025-03-13 19:20:43,780 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:20:43,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.43it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.69it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.40it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.82it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.56it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.09it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]
2025-03-13 19:20:46,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:46
2025-03-13 19:21:16,308 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8992 secs
2025-03-13 19:21:16,308 [INFO]: The best hyperparameters are: efSearch=366
2025-03-13 19:21:16,308 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 19:21:39,802 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4936 secs
2025-03-13 19:21:39,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0234 secs
2025-03-13 19:21:39,804 [INFO]: {
2025-03-13 19:21:39,804 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:39,804 [INFO]: 	index_param: efSearch=366
2025-03-13 19:21:39,804 [INFO]: 	index_path: knn.index
2025-03-13 19:21:39,804 [INFO]: 	size in bytes: 541832290
2025-03-13 19:21:39,804 [INFO]: 	avg_search_speed_ms: 11.920440078438821
2025-03-13 19:21:39,804 [INFO]: 	99p_search_speed_ms: 21.690396391786635
2025-03-13 19:21:39,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:39,804 [INFO]: 	nb vectors: 2754
2025-03-13 19:21:39,804 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:39,804 [INFO]: 	compression ratio: 0.9993100115904868
2025-03-13 19:21:39,804 [INFO]: }
2025-03-13 19:21:39,804 [INFO]: 	>>> Finished "Creating the index" in 56.0247 secs
2025-03-13 19:21:39,804 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0470 secs
2025-03-13 19:21:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 9679 [episode count 16/20]
[retrieval_preprocessing] for episode 62937 [episode count 17/20], we have num_retrieval=np.int64(2788) num_query=np.int64(128)
2025-03-13 19:21:43,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:43,788 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:43
2025-03-13 19:21:43,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.83it/s]
2025-03-13 19:21:43,811 [INFO]: There are 2788 embeddings of dim 49152
2025-03-13 19:21:43,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 19:21:43,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:43
2025-03-13 19:21:43,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:43,812 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:21:43,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:43,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:43,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:43
2025-03-13 19:21:43,812 [INFO]: 575.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:43,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:43,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:43
2025-03-13 19:21:43,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:43,812 [INFO]: 	Creating the index 03/13/2025, 19:21:43
2025-03-13 19:21:43,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:43
2025-03-13 19:21:43,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:21:43,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:43
2025-03-13 19:21:43,813 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:21:43,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.10it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.24it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.47it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.26it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.67it/s]100%|██████████| 11/11 [00:02<00:00,  2.57it/s]100%|██████████| 11/11 [00:02<00:00,  4.08it/s]
2025-03-13 19:21:46,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:46
2025-03-13 19:22:13,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7736 secs
2025-03-13 19:22:13,294 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 19:22:13,294 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 19:22:29,813 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5184 secs
2025-03-13 19:22:29,815 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0015 secs
2025-03-13 19:22:29,815 [INFO]: {
2025-03-13 19:22:29,815 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:29,815 [INFO]: 	index_param: efSearch=300
2025-03-13 19:22:29,815 [INFO]: 	index_path: knn.index
2025-03-13 19:22:29,815 [INFO]: 	size in bytes: 548521630
2025-03-13 19:22:29,815 [INFO]: 	avg_search_speed_ms: 9.679216247805668
2025-03-13 19:22:29,815 [INFO]: 	99p_search_speed_ms: 15.051205111667496
2025-03-13 19:22:29,815 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:29,815 [INFO]: 	nb vectors: 2788
2025-03-13 19:22:29,815 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:29,815 [INFO]: 	compression ratio: 0.9993099160009424
2025-03-13 19:22:29,815 [INFO]: }
2025-03-13 19:22:29,815 [INFO]: 	>>> Finished "Creating the index" in 46.0027 secs
2025-03-13 19:22:29,815 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0270 secs
2025-03-13 19:22:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 62937 [episode count 17/20]
[retrieval_preprocessing] for episode 60470 [episode count 18/20], we have num_retrieval=np.int64(2802) num_query=np.int64(114)
2025-03-13 19:22:31,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:32,172 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:32
2025-03-13 19:22:32,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-13 19:22:32,195 [INFO]: There are 2802 embeddings of dim 49152
2025-03-13 19:22:32,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 19:22:32,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:32
2025-03-13 19:22:32,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:32,196 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:22:32,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:32,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:22:32,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:32
2025-03-13 19:22:32,196 [INFO]: 578.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:32,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:22:32,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:32
2025-03-13 19:22:32,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:32,196 [INFO]: 	Creating the index 03/13/2025, 19:22:32
2025-03-13 19:22:32,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:32
2025-03-13 19:22:32,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:22:32,197 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:32
2025-03-13 19:22:32,197 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:22:32,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.30it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.92it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.64it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.89it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.50it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.86it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-13 19:22:34,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:34
2025-03-13 19:23:02,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5000 secs
2025-03-13 19:23:02,235 [INFO]: The best hyperparameters are: efSearch=310
2025-03-13 19:23:02,235 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 19:23:25,093 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8579 secs
2025-03-13 19:23:25,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8979 secs
2025-03-13 19:23:25,095 [INFO]: {
2025-03-13 19:23:25,096 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:25,096 [INFO]: 	index_param: efSearch=310
2025-03-13 19:23:25,096 [INFO]: 	index_path: knn.index
2025-03-13 19:23:25,096 [INFO]: 	size in bytes: 551276170
2025-03-13 19:23:25,096 [INFO]: 	avg_search_speed_ms: 10.520844847858971
2025-03-13 19:23:25,096 [INFO]: 	99p_search_speed_ms: 14.902836992405355
2025-03-13 19:23:25,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:25,096 [INFO]: 	nb vectors: 2802
2025-03-13 19:23:25,096 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:25,096 [INFO]: 	compression ratio: 0.9993096853796528
2025-03-13 19:23:25,096 [INFO]: }
2025-03-13 19:23:25,096 [INFO]: 	>>> Finished "Creating the index" in 52.8995 secs
2025-03-13 19:23:25,096 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9238 secs
2025-03-13 19:23:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 60470 [episode count 18/20]
[retrieval_preprocessing] for episode 63362 [episode count 19/20], we have num_retrieval=np.int64(2753) num_query=np.int64(163)
2025-03-13 19:23:27,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:28,363 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:28
2025-03-13 19:23:28,363 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-13 19:23:28,391 [INFO]: There are 2753 embeddings of dim 49152
2025-03-13 19:23:28,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 19:23:28,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:28
2025-03-13 19:23:28,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:28,391 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:23:28,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:28,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:23:28,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:28
2025-03-13 19:23:28,391 [INFO]: 568.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:28,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:23:28,391 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:28
2025-03-13 19:23:28,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:28,391 [INFO]: 	Creating the index 03/13/2025, 19:23:28
2025-03-13 19:23:28,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:28
2025-03-13 19:23:28,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:23:28,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:28
2025-03-13 19:23:28,393 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:23:28,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.81it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.08it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.77it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.33it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.73it/s]100%|██████████| 11/11 [00:03<00:00,  2.09it/s]100%|██████████| 11/11 [00:03<00:00,  3.36it/s]
2025-03-13 19:23:31,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:31
2025-03-13 19:23:57,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2253 secs
2025-03-13 19:23:57,905 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 19:23:57,905 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 19:24:16,673 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7672 secs
2025-03-13 19:24:16,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2821 secs
2025-03-13 19:24:16,675 [INFO]: {
2025-03-13 19:24:16,675 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:16,675 [INFO]: 	index_param: efSearch=314
2025-03-13 19:24:16,675 [INFO]: 	index_path: knn.index
2025-03-13 19:24:16,675 [INFO]: 	size in bytes: 541635550
2025-03-13 19:24:16,675 [INFO]: 	avg_search_speed_ms: 11.004009345552513
2025-03-13 19:24:16,675 [INFO]: 	99p_search_speed_ms: 21.327195642516003
2025-03-13 19:24:16,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:16,675 [INFO]: 	nb vectors: 2753
2025-03-13 19:24:16,675 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:16,675 [INFO]: 	compression ratio: 0.9993100046701144
2025-03-13 19:24:16,675 [INFO]: }
2025-03-13 19:24:16,675 [INFO]: 	>>> Finished "Creating the index" in 48.2839 secs
2025-03-13 19:24:16,675 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3124 secs
2025-03-13 19:24:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 63362 [episode count 19/20]
2025-03-13 19:24:18: [retrieval_preprocessing] finished for 6498288010_turn_off_extension_cord [chosen_id count 8/196]
2025-03-13 19:24:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 65137982_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 19:24:19: [retrieval_preprocessing] we have num_total=2284 embedding_dim=49152
[retrieval_preprocessing] for episode 29698 [episode count 0/20], we have num_retrieval=np.int64(2157) num_query=np.int64(127)
2025-03-13 19:24:20,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:20,902 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:20
2025-03-13 19:24:20,902 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.35it/s]
2025-03-13 19:24:20,934 [INFO]: There are 2157 embeddings of dim 49152
2025-03-13 19:24:20,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 19:24:20,934 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:20
2025-03-13 19:24:20,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:20,934 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:24:20,934 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:20,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:24:20,934 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:20
2025-03-13 19:24:20,934 [INFO]: 445.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:20,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:24:20,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:20
2025-03-13 19:24:20,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:20,935 [INFO]: 	Creating the index 03/13/2025, 19:24:20
2025-03-13 19:24:20,935 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:20
2025-03-13 19:24:20,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:24:20,936 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:20
2025-03-13 19:24:20,936 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:24:20,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.30it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.75it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.20it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.48it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.53it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.39it/s]100%|██████████| 9/9 [00:02<00:00,  1.91it/s]100%|██████████| 9/9 [00:02<00:00,  3.43it/s]
2025-03-13 19:24:23,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:23
2025-03-13 19:24:52,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7538 secs
2025-03-13 19:24:52,313 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 19:24:52,313 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 19:25:11,234 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9204 secs
2025-03-13 19:25:11,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2994 secs
2025-03-13 19:25:11,235 [INFO]: {
2025-03-13 19:25:11,235 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:11,235 [INFO]: 	index_param: efSearch=220
2025-03-13 19:25:11,235 [INFO]: 	index_path: knn.index
2025-03-13 19:25:11,235 [INFO]: 	size in bytes: 424376650
2025-03-13 19:25:11,236 [INFO]: 	avg_search_speed_ms: 9.543877035443394
2025-03-13 19:25:11,236 [INFO]: 	99p_search_speed_ms: 13.213491239584975
2025-03-13 19:25:11,236 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:11,236 [INFO]: 	nb vectors: 2157
2025-03-13 19:25:11,236 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:11,236 [INFO]: 	compression ratio: 0.9993091184446646
2025-03-13 19:25:11,236 [INFO]: }
2025-03-13 19:25:11,236 [INFO]: 	>>> Finished "Creating the index" in 50.3010 secs
2025-03-13 19:25:11,236 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3332 secs
2025-03-13 19:25:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 29698 [episode count 0/20]
[retrieval_preprocessing] for episode 16905 [episode count 1/20], we have num_retrieval=np.int64(2164) num_query=np.int64(120)
2025-03-13 19:25:12,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:13,387 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:13
2025-03-13 19:25:13,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2373.69it/s]
2025-03-13 19:25:13,410 [INFO]: There are 2164 embeddings of dim 49152
2025-03-13 19:25:13,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 19:25:13,410 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:13
2025-03-13 19:25:13,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:13,410 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:25:13,410 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:13,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:13,410 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:13
2025-03-13 19:25:13,410 [INFO]: 446.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:13,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:13,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:13
2025-03-13 19:25:13,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:13,411 [INFO]: 	Creating the index 03/13/2025, 19:25:13
2025-03-13 19:25:13,411 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:13
2025-03-13 19:25:13,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:25:13,412 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:13
2025-03-13 19:25:13,412 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:25:13,412 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.04it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.44it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.44it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.99it/s]100%|██████████| 9/9 [00:02<00:00,  2.74it/s]100%|██████████| 9/9 [00:02<00:00,  3.95it/s]
2025-03-13 19:25:15,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:15
2025-03-13 19:25:46,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8075 secs
2025-03-13 19:25:46,504 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 19:25:46,504 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-13 19:26:00,768 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2632 secs
2025-03-13 19:26:00,769 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3573 secs
2025-03-13 19:26:00,769 [INFO]: {
2025-03-13 19:26:00,770 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:00,770 [INFO]: 	index_param: efSearch=239
2025-03-13 19:26:00,770 [INFO]: 	index_path: knn.index
2025-03-13 19:26:00,770 [INFO]: 	size in bytes: 425753830
2025-03-13 19:26:00,770 [INFO]: 	avg_search_speed_ms: 10.469691526798131
2025-03-13 19:26:00,770 [INFO]: 	99p_search_speed_ms: 14.057316076941788
2025-03-13 19:26:00,770 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:00,770 [INFO]: 	nb vectors: 2164
2025-03-13 19:26:00,770 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:00,770 [INFO]: 	compression ratio: 0.999309182961431
2025-03-13 19:26:00,770 [INFO]: }
2025-03-13 19:26:00,770 [INFO]: 	>>> Finished "Creating the index" in 47.3588 secs
2025-03-13 19:26:00,770 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3825 secs
2025-03-13 19:26:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 16905 [episode count 1/20]
[retrieval_preprocessing] for episode 95241 [episode count 2/20], we have num_retrieval=np.int64(2193) num_query=np.int64(91)
2025-03-13 19:26:02,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:03,022 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:03
2025-03-13 19:26:03,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2204.05it/s]
2025-03-13 19:26:03,047 [INFO]: There are 2193 embeddings of dim 49152
2025-03-13 19:26:03,048 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 19:26:03,048 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:03
2025-03-13 19:26:03,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:03,048 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:26:03,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:03,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:26:03,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:03
2025-03-13 19:26:03,049 [INFO]: 452.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:03,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:26:03,049 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:03
2025-03-13 19:26:03,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:03,049 [INFO]: 	Creating the index 03/13/2025, 19:26:03
2025-03-13 19:26:03,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:03
2025-03-13 19:26:03,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 19:26:03,052 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:03
2025-03-13 19:26:03,052 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:26:03,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.81it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.35it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.01it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.47it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.68it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.82it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.91it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.94it/s]100%|██████████| 9/9 [00:02<00:00,  1.81it/s]100%|██████████| 9/9 [00:02<00:00,  3.65it/s]
2025-03-13 19:26:05,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:05
2025-03-13 19:26:32,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9395 secs
2025-03-13 19:26:32,465 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 19:26:32,465 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 19:26:49,006 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5410 secs
2025-03-13 19:26:49,008 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9553 secs
2025-03-13 19:26:49,008 [INFO]: {
2025-03-13 19:26:49,008 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:49,008 [INFO]: 	index_param: efSearch=260
2025-03-13 19:26:49,008 [INFO]: 	index_path: knn.index
2025-03-13 19:26:49,008 [INFO]: 	size in bytes: 431459530
2025-03-13 19:26:49,008 [INFO]: 	avg_search_speed_ms: 11.359570726794614
2025-03-13 19:26:49,008 [INFO]: 	99p_search_speed_ms: 14.558306068647653
2025-03-13 19:26:49,008 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:49,008 [INFO]: 	nb vectors: 2193
2025-03-13 19:26:49,008 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:49,008 [INFO]: 	compression ratio: 0.9993088899902153
2025-03-13 19:26:49,008 [INFO]: }
2025-03-13 19:26:49,008 [INFO]: 	>>> Finished "Creating the index" in 45.9587 secs
2025-03-13 19:26:49,008 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9860 secs
2025-03-13 19:26:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 95241 [episode count 2/20]
[retrieval_preprocessing] for episode 15891 [episode count 3/20], we have num_retrieval=np.int64(2149) num_query=np.int64(135)
2025-03-13 19:26:50,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:50,755 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:50
2025-03-13 19:26:50,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1697.41it/s]
2025-03-13 19:26:50,779 [INFO]: There are 2149 embeddings of dim 49152
2025-03-13 19:26:50,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 19:26:50,780 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:50
2025-03-13 19:26:50,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:50,780 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:26:50,780 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:50,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:26:50,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:50
2025-03-13 19:26:50,781 [INFO]: 443.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:50,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:26:50,781 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:50
2025-03-13 19:26:50,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:50,781 [INFO]: 	Creating the index 03/13/2025, 19:26:50
2025-03-13 19:26:50,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:50
2025-03-13 19:26:50,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:26:50,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:50
2025-03-13 19:26:50,785 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:26:50,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.05it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.27it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.11it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.49it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]100%|██████████| 9/9 [00:02<00:00,  4.31it/s]
2025-03-13 19:26:52,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:52
2025-03-13 19:27:20,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6882 secs
2025-03-13 19:27:20,565 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 19:27:20,566 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-13 19:27:35,399 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8334 secs
2025-03-13 19:27:35,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7949 secs
2025-03-13 19:27:35,580 [INFO]: {
2025-03-13 19:27:35,580 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:35,580 [INFO]: 	index_param: efSearch=263
2025-03-13 19:27:35,580 [INFO]: 	index_path: knn.index
2025-03-13 19:27:35,580 [INFO]: 	size in bytes: 422802670
2025-03-13 19:27:35,580 [INFO]: 	avg_search_speed_ms: 10.450843908476605
2025-03-13 19:27:35,580 [INFO]: 	99p_search_speed_ms: 14.40008804202079
2025-03-13 19:27:35,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:35,580 [INFO]: 	nb vectors: 2149
2025-03-13 19:27:35,580 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:35,580 [INFO]: 	compression ratio: 0.9993091860086881
2025-03-13 19:27:35,580 [INFO]: }
2025-03-13 19:27:35,580 [INFO]: 	>>> Finished "Creating the index" in 44.7989 secs
2025-03-13 19:27:35,580 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8255 secs
2025-03-13 19:27:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 15891 [episode count 3/20]
[retrieval_preprocessing] for episode 26660 [episode count 4/20], we have num_retrieval=np.int64(2165) num_query=np.int64(119)
2025-03-13 19:27:37,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:38,109 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:38
2025-03-13 19:27:38,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1870.79it/s]
2025-03-13 19:27:38,136 [INFO]: There are 2165 embeddings of dim 49152
2025-03-13 19:27:38,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:27:38,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:38
2025-03-13 19:27:38,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:38,136 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:27:38,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:38,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:38,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:38
2025-03-13 19:27:38,137 [INFO]: 446.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:38,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:38,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:38
2025-03-13 19:27:38,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:38,137 [INFO]: 	Creating the index 03/13/2025, 19:27:38
2025-03-13 19:27:38,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:38
2025-03-13 19:27:38,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:27:38,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:38
2025-03-13 19:27:38,138 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:27:38,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.51it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.64it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.50it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.11it/s]100%|██████████| 9/9 [00:02<00:00,  4.46it/s]
2025-03-13 19:27:40,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:40
2025-03-13 19:28:05,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7956 secs
2025-03-13 19:28:05,953 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 19:28:05,953 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 19:28:20,498 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5451 secs
2025-03-13 19:28:20,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3627 secs
2025-03-13 19:28:20,501 [INFO]: {
2025-03-13 19:28:20,501 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:20,501 [INFO]: 	index_param: efSearch=253
2025-03-13 19:28:20,501 [INFO]: 	index_path: knn.index
2025-03-13 19:28:20,501 [INFO]: 	size in bytes: 425950570
2025-03-13 19:28:20,501 [INFO]: 	avg_search_speed_ms: 10.423424629673237
2025-03-13 19:28:20,501 [INFO]: 	99p_search_speed_ms: 13.821549452841278
2025-03-13 19:28:20,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:20,501 [INFO]: 	nb vectors: 2165
2025-03-13 19:28:20,501 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:20,501 [INFO]: 	compression ratio: 0.9993091921440556
2025-03-13 19:28:20,501 [INFO]: }
2025-03-13 19:28:20,501 [INFO]: 	>>> Finished "Creating the index" in 42.3640 secs
2025-03-13 19:28:20,501 [INFO]: >>> Finished "Launching the whole pipeline" in 42.3920 secs
2025-03-13 19:28:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 26660 [episode count 4/20]
[retrieval_preprocessing] for episode 567 [episode count 5/20], we have num_retrieval=np.int64(2184) num_query=np.int64(100)
2025-03-13 19:28:22,356 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:22,633 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:22
2025-03-13 19:28:22,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2031.14it/s]
2025-03-13 19:28:22,657 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 19:28:22,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 19:28:22,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:22
2025-03-13 19:28:22,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:22,658 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:28:22,658 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:22,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:28:22,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:22
2025-03-13 19:28:22,658 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:22,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:28:22,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:22
2025-03-13 19:28:22,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:22,658 [INFO]: 	Creating the index 03/13/2025, 19:28:22
2025-03-13 19:28:22,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:22
2025-03-13 19:28:22,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:28:22,659 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:22
2025-03-13 19:28:22,659 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:28:22,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.23it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.21it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.41it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.07it/s]100%|██████████| 9/9 [00:02<00:00,  3.02it/s]100%|██████████| 9/9 [00:02<00:00,  4.27it/s]
2025-03-13 19:28:24,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:24
2025-03-13 19:28:50,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1975 secs
2025-03-13 19:28:50,966 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 19:28:50,966 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 19:29:07,096 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1302 secs
2025-03-13 19:29:07,098 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4389 secs
2025-03-13 19:29:07,098 [INFO]: {
2025-03-13 19:29:07,098 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:07,098 [INFO]: 	index_param: efSearch=267
2025-03-13 19:29:07,098 [INFO]: 	index_path: knn.index
2025-03-13 19:29:07,098 [INFO]: 	size in bytes: 429688750
2025-03-13 19:29:07,098 [INFO]: 	avg_search_speed_ms: 11.710995892488095
2025-03-13 19:29:07,098 [INFO]: 	99p_search_speed_ms: 15.694483995903283
2025-03-13 19:29:07,098 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:07,098 [INFO]: 	nb vectors: 2184
2025-03-13 19:29:07,098 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:07,098 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 19:29:07,098 [INFO]: }
2025-03-13 19:29:07,098 [INFO]: 	>>> Finished "Creating the index" in 44.4405 secs
2025-03-13 19:29:07,098 [INFO]: >>> Finished "Launching the whole pipeline" in 44.4650 secs
2025-03-13 19:29:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 567 [episode count 5/20]
[retrieval_preprocessing] for episode 49771 [episode count 6/20], we have num_retrieval=np.int64(2184) num_query=np.int64(100)
2025-03-13 19:29:08,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:09,189 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:09
2025-03-13 19:29:09,189 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1826.79it/s]
2025-03-13 19:29:09,211 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 19:29:09,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 19:29:09,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:09
2025-03-13 19:29:09,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:09,211 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:29:09,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:09,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:09,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:09
2025-03-13 19:29:09,211 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:09,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:29:09,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:09
2025-03-13 19:29:09,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:09,212 [INFO]: 	Creating the index 03/13/2025, 19:29:09
2025-03-13 19:29:09,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:09
2025-03-13 19:29:09,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:29:09,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:09
2025-03-13 19:29:09,213 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:29:09,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.22it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.59it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.15it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.94it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 19:29:11,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:11
2025-03-13 19:29:39,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7160 secs
2025-03-13 19:29:39,100 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 19:29:39,100 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 19:29:55,867 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7676 secs
2025-03-13 19:29:55,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6569 secs
2025-03-13 19:29:55,870 [INFO]: {
2025-03-13 19:29:55,870 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:55,870 [INFO]: 	index_param: efSearch=255
2025-03-13 19:29:55,870 [INFO]: 	index_path: knn.index
2025-03-13 19:29:55,870 [INFO]: 	size in bytes: 429688750
2025-03-13 19:29:55,870 [INFO]: 	avg_search_speed_ms: 10.725941612932814
2025-03-13 19:29:55,870 [INFO]: 	99p_search_speed_ms: 14.405500069260595
2025-03-13 19:29:55,870 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:55,870 [INFO]: 	nb vectors: 2184
2025-03-13 19:29:55,870 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:55,870 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 19:29:55,870 [INFO]: }
2025-03-13 19:29:55,870 [INFO]: 	>>> Finished "Creating the index" in 46.6582 secs
2025-03-13 19:29:55,870 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6807 secs
2025-03-13 19:29:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 49771 [episode count 6/20]
[retrieval_preprocessing] for episode 20123 [episode count 7/20], we have num_retrieval=np.int64(2179) num_query=np.int64(105)
2025-03-13 19:29:57,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:57,877 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:57
2025-03-13 19:29:57,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.01it/s]
2025-03-13 19:29:57,904 [INFO]: There are 2179 embeddings of dim 49152
2025-03-13 19:29:57,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 19:29:57,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:57
2025-03-13 19:29:57,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:57,905 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:29:57,905 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:57,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:29:57,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:57
2025-03-13 19:29:57,905 [INFO]: 449.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:57,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:29:57,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:57
2025-03-13 19:29:57,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:57,906 [INFO]: 	Creating the index 03/13/2025, 19:29:57
2025-03-13 19:29:57,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:57
2025-03-13 19:29:57,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:29:57,910 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:57
2025-03-13 19:29:57,910 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:29:57,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.64it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.03it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.37it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.70it/s]100%|██████████| 9/9 [00:02<00:00,  2.96it/s]100%|██████████| 9/9 [00:02<00:00,  4.20it/s]
2025-03-13 19:30:00,059 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:00
2025-03-13 19:30:25,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9210 secs
2025-03-13 19:30:25,980 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 19:30:25,980 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 19:30:42,578 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5974 secs
2025-03-13 19:30:43,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3221 secs
2025-03-13 19:30:43,232 [INFO]: {
2025-03-13 19:30:43,232 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:43,232 [INFO]: 	index_param: efSearch=258
2025-03-13 19:30:43,232 [INFO]: 	index_path: knn.index
2025-03-13 19:30:43,232 [INFO]: 	size in bytes: 428705050
2025-03-13 19:30:43,232 [INFO]: 	avg_search_speed_ms: 10.537331663778698
2025-03-13 19:30:43,232 [INFO]: 	99p_search_speed_ms: 14.714458426460624
2025-03-13 19:30:43,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:43,233 [INFO]: 	nb vectors: 2179
2025-03-13 19:30:43,233 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:43,233 [INFO]: 	compression ratio: 0.9993090400964486
2025-03-13 19:30:43,233 [INFO]: }
2025-03-13 19:30:43,233 [INFO]: 	>>> Finished "Creating the index" in 45.3263 secs
2025-03-13 19:30:43,233 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3562 secs
2025-03-13 19:30:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 20123 [episode count 7/20]
[retrieval_preprocessing] for episode 8861 [episode count 8/20], we have num_retrieval=np.int64(2156) num_query=np.int64(128)
2025-03-13 19:30:44,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:45,272 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:45
2025-03-13 19:30:45,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2191.38it/s]
2025-03-13 19:30:45,294 [INFO]: There are 2156 embeddings of dim 49152
2025-03-13 19:30:45,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 19:30:45,294 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:45
2025-03-13 19:30:45,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:45,294 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:30:45,294 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:45,294 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:45,294 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:45
2025-03-13 19:30:45,294 [INFO]: 444.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:45,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:30:45,294 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:45
2025-03-13 19:30:45,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:45,294 [INFO]: 	Creating the index 03/13/2025, 19:30:45
2025-03-13 19:30:45,294 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:45
2025-03-13 19:30:45,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:30:45,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:45
2025-03-13 19:30:45,296 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:30:45,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.53it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.95it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.90it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.40it/s]100%|██████████| 9/9 [00:02<00:00,  2.94it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 19:30:47,465 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:47
2025-03-13 19:31:11,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9976 secs
2025-03-13 19:31:11,463 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 19:31:11,463 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 19:31:27,942 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4783 secs
2025-03-13 19:31:27,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6478 secs
2025-03-13 19:31:27,943 [INFO]: {
2025-03-13 19:31:27,943 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:27,943 [INFO]: 	index_param: efSearch=256
2025-03-13 19:31:27,943 [INFO]: 	index_path: knn.index
2025-03-13 19:31:27,944 [INFO]: 	size in bytes: 424179910
2025-03-13 19:31:27,944 [INFO]: 	avg_search_speed_ms: 10.938072420880605
2025-03-13 19:31:27,944 [INFO]: 	99p_search_speed_ms: 15.045545757748187
2025-03-13 19:31:27,944 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:27,944 [INFO]: 	nb vectors: 2156
2025-03-13 19:31:27,944 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:27,944 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 19:31:27,944 [INFO]: }
2025-03-13 19:31:27,944 [INFO]: 	>>> Finished "Creating the index" in 42.6492 secs
2025-03-13 19:31:27,944 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6717 secs
2025-03-13 19:31:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 8861 [episode count 8/20]
[retrieval_preprocessing] for episode 42665 [episode count 9/20], we have num_retrieval=np.int64(2190) num_query=np.int64(94)
2025-03-13 19:31:29,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:30,096 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:30
2025-03-13 19:31:30,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2308.37it/s]
2025-03-13 19:31:30,118 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 19:31:30,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 19:31:30,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:30
2025-03-13 19:31:30,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:30,118 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:31:30,118 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:30,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:31:30,118 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:30
2025-03-13 19:31:30,118 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:30,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:31:30,118 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:30
2025-03-13 19:31:30,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:30,118 [INFO]: 	Creating the index 03/13/2025, 19:31:30
2025-03-13 19:31:30,118 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:30
2025-03-13 19:31:30,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:31:30,119 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:30
2025-03-13 19:31:30,119 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:31:30,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.03it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.66it/s] 78%|███████▊  | 7/9 [00:00<00:00, 18.95it/s]100%|██████████| 9/9 [00:01<00:00,  3.67it/s]100%|██████████| 9/9 [00:01<00:00,  4.79it/s]
2025-03-13 19:31:32,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:32
2025-03-13 19:31:57,876 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8738 secs
2025-03-13 19:31:57,877 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 19:31:57,877 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 19:32:17,127 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2506 secs
2025-03-13 19:32:17,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0100 secs
2025-03-13 19:32:17,129 [INFO]: {
2025-03-13 19:32:17,130 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:17,130 [INFO]: 	index_param: efSearch=297
2025-03-13 19:32:17,130 [INFO]: 	index_path: knn.index
2025-03-13 19:32:17,130 [INFO]: 	size in bytes: 430869310
2025-03-13 19:32:17,130 [INFO]: 	avg_search_speed_ms: 12.75331759795651
2025-03-13 19:32:17,130 [INFO]: 	99p_search_speed_ms: 20.311263238545504
2025-03-13 19:32:17,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:17,130 [INFO]: 	nb vectors: 2190
2025-03-13 19:32:17,130 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:17,130 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 19:32:17,130 [INFO]: }
2025-03-13 19:32:17,130 [INFO]: 	>>> Finished "Creating the index" in 47.0115 secs
2025-03-13 19:32:17,130 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0338 secs
2025-03-13 19:32:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 42665 [episode count 9/20]
[retrieval_preprocessing] for episode 28360 [episode count 10/20], we have num_retrieval=np.int64(2115) num_query=np.int64(169)
2025-03-13 19:32:18,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:19,171 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:19
2025-03-13 19:32:19,171 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.16it/s]
2025-03-13 19:32:19,197 [INFO]: There are 2115 embeddings of dim 49152
2025-03-13 19:32:19,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 19:32:19,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:19
2025-03-13 19:32:19,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:19,197 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:32:19,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:19,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:32:19,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:19
2025-03-13 19:32:19,197 [INFO]: 436.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:19,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:32:19,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:19
2025-03-13 19:32:19,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:19,198 [INFO]: 	Creating the index 03/13/2025, 19:32:19
2025-03-13 19:32:19,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:19
2025-03-13 19:32:19,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:32:19,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:19
2025-03-13 19:32:19,199 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:32:19,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.15it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.23it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.81it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.46it/s]100%|██████████| 9/9 [00:02<00:00,  3.19it/s]100%|██████████| 9/9 [00:02<00:00,  4.49it/s]
2025-03-13 19:32:21,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:21
2025-03-13 19:32:46,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0234 secs
2025-03-13 19:32:46,231 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 19:32:46,231 [INFO]: 	Compute fast metrics 03/13/2025, 19:32:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 19:33:02,979 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7480 secs
2025-03-13 19:33:02,980 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7817 secs
2025-03-13 19:33:02,980 [INFO]: {
2025-03-13 19:33:02,980 [INFO]: 	index_key: HNSW15
2025-03-13 19:33:02,980 [INFO]: 	index_param: efSearch=302
2025-03-13 19:33:02,981 [INFO]: 	index_path: knn.index
2025-03-13 19:33:02,981 [INFO]: 	size in bytes: 416113390
2025-03-13 19:33:02,981 [INFO]: 	avg_search_speed_ms: 11.467830629628407
2025-03-13 19:33:02,981 [INFO]: 	99p_search_speed_ms: 16.21586040128022
2025-03-13 19:33:02,981 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:33:02,981 [INFO]: 	nb vectors: 2115
2025-03-13 19:33:02,981 [INFO]: 	vectors dimension: 49152
2025-03-13 19:33:02,981 [INFO]: 	compression ratio: 0.999309154651332
2025-03-13 19:33:02,981 [INFO]: }
2025-03-13 19:33:02,981 [INFO]: 	>>> Finished "Creating the index" in 43.7831 secs
2025-03-13 19:33:02,981 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8093 secs
2025-03-13 19:33:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:33:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 28360 [episode count 10/20]
[retrieval_preprocessing] for episode 58065 [episode count 11/20], we have num_retrieval=np.int64(2177) num_query=np.int64(107)
2025-03-13 19:33:05,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:33:05,525 [INFO]: Launching the whole pipeline 03/13/2025, 19:33:05
2025-03-13 19:33:05,525 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:33:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1578.59it/s]
2025-03-13 19:33:05,554 [INFO]: There are 2177 embeddings of dim 49152
2025-03-13 19:33:05,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 19:33:05,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:33:05,554 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:33:05,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:33:05,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:33:05,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,554 [INFO]: 449.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:33:05,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:33:05,554 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:33:05
2025-03-13 19:33:05,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:33:05,554 [INFO]: 	Creating the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,554 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:33:05
2025-03-13 19:33:05,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:33:05,555 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:33:05
2025-03-13 19:33:05,556 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:33:05,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.28it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.89it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.89it/s]100%|██████████| 9/9 [00:02<00:00,  2.90it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 19:33:07,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:33:07
2025-03-13 19:33:30,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0872 secs
2025-03-13 19:33:30,802 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 19:33:30,802 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 19:33:48,930 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1281 secs
2025-03-13 19:33:48,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3760 secs
2025-03-13 19:33:48,932 [INFO]: {
2025-03-13 19:33:48,932 [INFO]: 	index_key: HNSW15
2025-03-13 19:33:48,932 [INFO]: 	index_param: efSearch=299
2025-03-13 19:33:48,932 [INFO]: 	index_path: knn.index
2025-03-13 19:33:48,932 [INFO]: 	size in bytes: 428311570
2025-03-13 19:33:48,932 [INFO]: 	avg_search_speed_ms: 9.996235938277096
2025-03-13 19:33:48,932 [INFO]: 	99p_search_speed_ms: 12.741277168970555
2025-03-13 19:33:48,932 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:33:48,932 [INFO]: 	nb vectors: 2177
2025-03-13 19:33:48,932 [INFO]: 	vectors dimension: 49152
2025-03-13 19:33:48,932 [INFO]: 	compression ratio: 0.9993090217011882
2025-03-13 19:33:48,932 [INFO]: }
2025-03-13 19:33:48,932 [INFO]: 	>>> Finished "Creating the index" in 43.3773 secs
2025-03-13 19:33:48,932 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4070 secs
2025-03-13 19:33:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:33:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 58065 [episode count 11/20]
[retrieval_preprocessing] for episode 32990 [episode count 12/20], we have num_retrieval=np.int64(2161) num_query=np.int64(123)
2025-03-13 19:33:50,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:33:50,731 [INFO]: Launching the whole pipeline 03/13/2025, 19:33:50
2025-03-13 19:33:50,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:33:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.12it/s]
2025-03-13 19:33:50,753 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 19:33:50,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 19:33:50,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:33:50
2025-03-13 19:33:50,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:33:50,753 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:33:50,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:33:50,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:33:50,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:33:50
2025-03-13 19:33:50,754 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:33:50,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:33:50,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:33:50
2025-03-13 19:33:50,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:33:50,754 [INFO]: 	Creating the index 03/13/2025, 19:33:50
2025-03-13 19:33:50,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:33:50
2025-03-13 19:33:50,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:33:50,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:33:50
2025-03-13 19:33:50,755 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:33:50,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.41it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.29it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.71it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.27it/s]100%|██████████| 9/9 [00:02<00:00,  2.94it/s]100%|██████████| 9/9 [00:02<00:00,  4.19it/s]
2025-03-13 19:33:52,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:33:52
2025-03-13 19:34:14,821 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.9135 secs
2025-03-13 19:34:14,822 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 19:34:14,822 [INFO]: 	Compute fast metrics 03/13/2025, 19:34:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s]
2025-03-13 19:34:29,082 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2602 secs
2025-03-13 19:34:29,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3290 secs
2025-03-13 19:34:29,084 [INFO]: {
2025-03-13 19:34:29,084 [INFO]: 	index_key: HNSW15
2025-03-13 19:34:29,084 [INFO]: 	index_param: efSearch=274
2025-03-13 19:34:29,084 [INFO]: 	index_path: knn.index
2025-03-13 19:34:29,084 [INFO]: 	size in bytes: 425163610
2025-03-13 19:34:29,084 [INFO]: 	avg_search_speed_ms: 10.496524940728595
2025-03-13 19:34:29,084 [INFO]: 	99p_search_speed_ms: 14.317062804475427
2025-03-13 19:34:29,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:34:29,084 [INFO]: 	nb vectors: 2161
2025-03-13 19:34:29,084 [INFO]: 	vectors dimension: 49152
2025-03-13 19:34:29,084 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 19:34:29,084 [INFO]: }
2025-03-13 19:34:29,084 [INFO]: 	>>> Finished "Creating the index" in 38.3303 secs
2025-03-13 19:34:29,084 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3530 secs
2025-03-13 19:34:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 32990 [episode count 12/20]
[retrieval_preprocessing] for episode 55523 [episode count 13/20], we have num_retrieval=np.int64(2179) num_query=np.int64(105)
2025-03-13 19:34:30,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:31,372 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:31
2025-03-13 19:34:31,373 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2404.99it/s]
2025-03-13 19:34:31,403 [INFO]: There are 2179 embeddings of dim 49152
2025-03-13 19:34:31,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 19:34:31,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:31
2025-03-13 19:34:31,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:31,403 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:34:31,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:31,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:34:31,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:31
2025-03-13 19:34:31,403 [INFO]: 449.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:31,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:34:31,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:31
2025-03-13 19:34:31,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:31,404 [INFO]: 	Creating the index 03/13/2025, 19:34:31
2025-03-13 19:34:31,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:31
2025-03-13 19:34:31,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:34:31,404 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:31
2025-03-13 19:34:31,405 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:34:31,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.44it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.54it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.47it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.54it/s]100%|██████████| 9/9 [00:02<00:00,  2.99it/s]100%|██████████| 9/9 [00:02<00:00,  4.30it/s]
2025-03-13 19:34:33,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:33
2025-03-13 19:35:00,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5430 secs
2025-03-13 19:35:00,044 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 19:35:00,044 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 19:35:17,499 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4553 secs
2025-03-13 19:35:18,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7893 secs
2025-03-13 19:35:18,194 [INFO]: {
2025-03-13 19:35:18,194 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:18,194 [INFO]: 	index_param: efSearch=270
2025-03-13 19:35:18,194 [INFO]: 	index_path: knn.index
2025-03-13 19:35:18,194 [INFO]: 	size in bytes: 428705050
2025-03-13 19:35:18,194 [INFO]: 	avg_search_speed_ms: 10.09233570779842
2025-03-13 19:35:18,194 [INFO]: 	99p_search_speed_ms: 14.296537218615416
2025-03-13 19:35:18,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:18,195 [INFO]: 	nb vectors: 2179
2025-03-13 19:35:18,195 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:18,195 [INFO]: 	compression ratio: 0.9993090400964486
2025-03-13 19:35:18,195 [INFO]: }
2025-03-13 19:35:18,195 [INFO]: 	>>> Finished "Creating the index" in 46.7911 secs
2025-03-13 19:35:18,195 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8223 secs
2025-03-13 19:35:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 55523 [episode count 13/20]
[retrieval_preprocessing] for episode 17641 [episode count 14/20], we have num_retrieval=np.int64(2150) num_query=np.int64(134)
2025-03-13 19:35:19,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:35:20,061 [INFO]: Launching the whole pipeline 03/13/2025, 19:35:20
2025-03-13 19:35:20,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:35:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.87it/s]
2025-03-13 19:35:20,086 [INFO]: There are 2150 embeddings of dim 49152
2025-03-13 19:35:20,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 19:35:20,087 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:35:20
2025-03-13 19:35:20,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:35:20,087 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:35:20,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:35:20,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:35:20,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:35:20
2025-03-13 19:35:20,087 [INFO]: 443.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:35:20,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:35:20,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:35:20
2025-03-13 19:35:20,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:35:20,088 [INFO]: 	Creating the index 03/13/2025, 19:35:20
2025-03-13 19:35:20,088 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:35:20
2025-03-13 19:35:20,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 19:35:20,091 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:35:20
2025-03-13 19:35:20,091 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:35:20,091 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.52it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.40it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.68it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.76it/s]100%|██████████| 9/9 [00:02<00:00,  2.34it/s]100%|██████████| 9/9 [00:02<00:00,  3.44it/s]
2025-03-13 19:35:22,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:35:22
2025-03-13 19:35:50,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7519 secs
2025-03-13 19:35:50,463 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 19:35:50,463 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s]
2025-03-13 19:36:03,222 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7586 secs
2025-03-13 19:36:03,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1320 secs
2025-03-13 19:36:03,223 [INFO]: {
2025-03-13 19:36:03,223 [INFO]: 	index_key: HNSW15
2025-03-13 19:36:03,223 [INFO]: 	index_param: efSearch=262
2025-03-13 19:36:03,223 [INFO]: 	index_path: knn.index
2025-03-13 19:36:03,223 [INFO]: 	size in bytes: 422999410
2025-03-13 19:36:03,224 [INFO]: 	avg_search_speed_ms: 10.427010747943
2025-03-13 19:36:03,224 [INFO]: 	99p_search_speed_ms: 13.08473595418036
2025-03-13 19:36:03,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:03,224 [INFO]: 	nb vectors: 2150
2025-03-13 19:36:03,224 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:03,224 [INFO]: 	compression ratio: 0.9993091952539603
2025-03-13 19:36:03,224 [INFO]: }
2025-03-13 19:36:03,224 [INFO]: 	>>> Finished "Creating the index" in 43.1356 secs
2025-03-13 19:36:03,224 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1630 secs
2025-03-13 19:36:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 17641 [episode count 14/20]
[retrieval_preprocessing] for episode 52457 [episode count 15/20], we have num_retrieval=np.int64(2168) num_query=np.int64(116)
2025-03-13 19:36:05,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:05,948 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:05
2025-03-13 19:36:05,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]
2025-03-13 19:36:05,981 [INFO]: There are 2168 embeddings of dim 49152
2025-03-13 19:36:05,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 19:36:05,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:05
2025-03-13 19:36:05,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:05,982 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:36:05,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:05,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:36:05,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:05
2025-03-13 19:36:05,982 [INFO]: 447.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:05,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:36:05,982 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:05
2025-03-13 19:36:05,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:05,982 [INFO]: 	Creating the index 03/13/2025, 19:36:05
2025-03-13 19:36:05,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:05
2025-03-13 19:36:05,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:36:05,983 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:05
2025-03-13 19:36:05,984 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:36:05,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.89it/s] 89%|████████▉ | 8/9 [00:00<00:00, 38.31it/s]100%|██████████| 9/9 [00:01<00:00,  4.61it/s]
2025-03-13 19:36:07,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:07
2025-03-13 19:36:35,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9644 secs
2025-03-13 19:36:35,906 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 19:36:35,906 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.83it/s]
2025-03-13 19:36:53,660 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7544 secs
2025-03-13 19:36:53,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6788 secs
2025-03-13 19:36:53,662 [INFO]: {
2025-03-13 19:36:53,662 [INFO]: 	index_key: HNSW15
2025-03-13 19:36:53,663 [INFO]: 	index_param: efSearch=245
2025-03-13 19:36:53,663 [INFO]: 	index_path: knn.index
2025-03-13 19:36:53,663 [INFO]: 	size in bytes: 426540850
2025-03-13 19:36:53,663 [INFO]: 	avg_search_speed_ms: 11.499375756294734
2025-03-13 19:36:53,663 [INFO]: 	99p_search_speed_ms: 23.189112346153703
2025-03-13 19:36:53,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:36:53,663 [INFO]: 	nb vectors: 2168
2025-03-13 19:36:53,663 [INFO]: 	vectors dimension: 49152
2025-03-13 19:36:53,663 [INFO]: 	compression ratio: 0.9993090790717934
2025-03-13 19:36:53,663 [INFO]: }
2025-03-13 19:36:53,663 [INFO]: 	>>> Finished "Creating the index" in 47.6806 secs
2025-03-13 19:36:53,663 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7144 secs
2025-03-13 19:36:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:36:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 52457 [episode count 15/20]
[retrieval_preprocessing] for episode 91369 [episode count 16/20], we have num_retrieval=np.int64(2146) num_query=np.int64(138)
2025-03-13 19:36:55,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:36:55,446 [INFO]: Launching the whole pipeline 03/13/2025, 19:36:55
2025-03-13 19:36:55,446 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:36:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.08it/s]
2025-03-13 19:36:55,482 [INFO]: There are 2146 embeddings of dim 49152
2025-03-13 19:36:55,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 19:36:55,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:36:55
2025-03-13 19:36:55,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:36:55,483 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:36:55,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:36:55,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:36:55,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:36:55
2025-03-13 19:36:55,483 [INFO]: 442.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:36:55,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:36:55,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:36:55
2025-03-13 19:36:55,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:36:55,483 [INFO]: 	Creating the index 03/13/2025, 19:36:55
2025-03-13 19:36:55,483 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:36:55
2025-03-13 19:36:55,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:36:55,484 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:36:55
2025-03-13 19:36:55,485 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:36:55,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.33it/s] 89%|████████▉ | 8/9 [00:00<00:00, 41.05it/s]100%|██████████| 9/9 [00:01<00:00,  5.64it/s]
2025-03-13 19:36:57,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:36:57
2025-03-13 19:37:23,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3938 secs
2025-03-13 19:37:23,478 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 19:37:23,478 [INFO]: 	Compute fast metrics 03/13/2025, 19:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.33it/s]
2025-03-13 19:37:38,464 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9855 secs
2025-03-13 19:37:38,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9986 secs
2025-03-13 19:37:38,483 [INFO]: {
2025-03-13 19:37:38,483 [INFO]: 	index_key: HNSW15
2025-03-13 19:37:38,483 [INFO]: 	index_param: efSearch=278
2025-03-13 19:37:38,483 [INFO]: 	index_path: knn.index
2025-03-13 19:37:38,483 [INFO]: 	size in bytes: 422212450
2025-03-13 19:37:38,483 [INFO]: 	avg_search_speed_ms: 10.94846163761213
2025-03-13 19:37:38,483 [INFO]: 	99p_search_speed_ms: 13.694334402680397
2025-03-13 19:37:38,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:37:38,484 [INFO]: 	nb vectors: 2146
2025-03-13 19:37:38,484 [INFO]: 	vectors dimension: 49152
2025-03-13 19:37:38,484 [INFO]: 	compression ratio: 0.9993091582211752
2025-03-13 19:37:38,484 [INFO]: }
2025-03-13 19:37:38,484 [INFO]: 	>>> Finished "Creating the index" in 43.0004 secs
2025-03-13 19:37:38,484 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0380 secs
2025-03-13 19:37:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:37:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 91369 [episode count 16/20]
[retrieval_preprocessing] for episode 94465 [episode count 17/20], we have num_retrieval=np.int64(2195) num_query=np.int64(89)
2025-03-13 19:37:39,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:37:40,229 [INFO]: Launching the whole pipeline 03/13/2025, 19:37:40
2025-03-13 19:37:40,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:37:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.16it/s]
2025-03-13 19:37:40,264 [INFO]: There are 2195 embeddings of dim 49152
2025-03-13 19:37:40,265 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 19:37:40,265 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:37:40
2025-03-13 19:37:40,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:37:40,265 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:37:40,265 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:37:40,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:37:40,265 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:37:40
2025-03-13 19:37:40,265 [INFO]: 453.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:37:40,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:37:40,265 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:37:40
2025-03-13 19:37:40,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:37:40,265 [INFO]: 	Creating the index 03/13/2025, 19:37:40
2025-03-13 19:37:40,265 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:37:40
2025-03-13 19:37:40,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:37:40,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:37:40
2025-03-13 19:37:40,266 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:37:40,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.29it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.36it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-13 19:37:42,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:37:42
2025-03-13 19:38:09,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6998 secs
2025-03-13 19:38:09,106 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 19:38:09,106 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.99it/s]
2025-03-13 19:38:24,822 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7166 secs
2025-03-13 19:38:24,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5577 secs
2025-03-13 19:38:24,824 [INFO]: {
2025-03-13 19:38:24,824 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:24,824 [INFO]: 	index_param: efSearch=290
2025-03-13 19:38:24,824 [INFO]: 	index_path: knn.index
2025-03-13 19:38:24,824 [INFO]: 	size in bytes: 431853010
2025-03-13 19:38:24,824 [INFO]: 	avg_search_speed_ms: 10.682225700977266
2025-03-13 19:38:24,824 [INFO]: 	99p_search_speed_ms: 15.341428609099237
2025-03-13 19:38:24,824 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:24,824 [INFO]: 	nb vectors: 2195
2025-03-13 19:38:24,824 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:24,824 [INFO]: 	compression ratio: 0.9993089083713924
2025-03-13 19:38:24,824 [INFO]: }
2025-03-13 19:38:24,824 [INFO]: 	>>> Finished "Creating the index" in 44.5591 secs
2025-03-13 19:38:24,824 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5954 secs
2025-03-13 19:38:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 94465 [episode count 17/20]
[retrieval_preprocessing] for episode 41284 [episode count 18/20], we have num_retrieval=np.int64(2188) num_query=np.int64(96)
2025-03-13 19:38:25,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:26,001 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:26
2025-03-13 19:38:26,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.09it/s]
2025-03-13 19:38:26,029 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 19:38:26,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:38:26,029 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:26
2025-03-13 19:38:26,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:26,029 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:38:26,029 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:38:26,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:38:26,029 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:26
2025-03-13 19:38:26,029 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:26,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:38:26,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:26
2025-03-13 19:38:26,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:26,030 [INFO]: 	Creating the index 03/13/2025, 19:38:26
2025-03-13 19:38:26,030 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:26
2025-03-13 19:38:26,031 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:38:26,031 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:26
2025-03-13 19:38:26,031 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:38:26,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.54it/s] 89%|████████▉ | 8/9 [00:00<00:00, 42.78it/s]100%|██████████| 9/9 [00:01<00:00,  6.14it/s]
2025-03-13 19:38:27,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:27
2025-03-13 19:38:53,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2559 secs
2025-03-13 19:38:53,755 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 19:38:53,755 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.26it/s]
2025-03-13 19:39:06,976 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2203 secs
2025-03-13 19:39:06,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9464 secs
2025-03-13 19:39:06,977 [INFO]: {
2025-03-13 19:39:06,977 [INFO]: 	index_key: HNSW15
2025-03-13 19:39:06,977 [INFO]: 	index_param: efSearch=239
2025-03-13 19:39:06,977 [INFO]: 	index_path: knn.index
2025-03-13 19:39:06,977 [INFO]: 	size in bytes: 430475830
2025-03-13 19:39:06,977 [INFO]: 	avg_search_speed_ms: 9.967490085906693
2025-03-13 19:39:06,977 [INFO]: 	99p_search_speed_ms: 12.475908696651459
2025-03-13 19:39:06,977 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:39:06,977 [INFO]: 	nb vectors: 2188
2025-03-13 19:39:06,977 [INFO]: 	vectors dimension: 49152
2025-03-13 19:39:06,977 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 19:39:06,977 [INFO]: }
2025-03-13 19:39:06,977 [INFO]: 	>>> Finished "Creating the index" in 40.9478 secs
2025-03-13 19:39:06,977 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9767 secs
2025-03-13 19:39:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:39:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 41284 [episode count 18/20]
[retrieval_preprocessing] for episode 59717 [episode count 19/20], we have num_retrieval=np.int64(2196) num_query=np.int64(88)
2025-03-13 19:39:08,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:39:08,476 [INFO]: Launching the whole pipeline 03/13/2025, 19:39:08
2025-03-13 19:39:08,476 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:39:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1905.64it/s]
2025-03-13 19:39:08,509 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 19:39:08,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 19:39:08,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:39:08
2025-03-13 19:39:08,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:39:08,511 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 19:39:08,511 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:39:08,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:39:08,511 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:39:08
2025-03-13 19:39:08,512 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:39:08,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:39:08,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:39:08
2025-03-13 19:39:08,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:39:08,512 [INFO]: 	Creating the index 03/13/2025, 19:39:08
2025-03-13 19:39:08,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:39:08
2025-03-13 19:39:08,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:39:08,515 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:39:08
2025-03-13 19:39:08,516 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:39:08,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.28it/s]100%|██████████| 9/9 [00:01<00:00,  5.20it/s]100%|██████████| 9/9 [00:01<00:00,  5.66it/s]
2025-03-13 19:39:10,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:39:10
2025-03-13 19:39:37,366 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2540 secs
2025-03-13 19:39:37,366 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 19:39:37,367 [INFO]: 	Compute fast metrics 03/13/2025, 19:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.59it/s]
2025-03-13 19:39:53,650 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2830 secs
2025-03-13 19:39:53,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1353 secs
2025-03-13 19:39:53,651 [INFO]: {
2025-03-13 19:39:53,651 [INFO]: 	index_key: HNSW15
2025-03-13 19:39:53,651 [INFO]: 	index_param: efSearch=275
2025-03-13 19:39:53,651 [INFO]: 	index_path: knn.index
2025-03-13 19:39:53,651 [INFO]: 	size in bytes: 432049750
2025-03-13 19:39:53,651 [INFO]: 	avg_search_speed_ms: 10.946114371526637
2025-03-13 19:39:53,651 [INFO]: 	99p_search_speed_ms: 14.33576836483553
2025-03-13 19:39:53,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:39:53,651 [INFO]: 	nb vectors: 2196
2025-03-13 19:39:53,651 [INFO]: 	vectors dimension: 49152
2025-03-13 19:39:53,651 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 19:39:53,651 [INFO]: }
2025-03-13 19:39:53,651 [INFO]: 	>>> Finished "Creating the index" in 45.1389 secs
2025-03-13 19:39:53,651 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1754 secs
2025-03-13 19:39:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:39:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 59717 [episode count 19/20]
2025-03-13 19:39:54: [retrieval_preprocessing] finished for 65137982_put_yellow_block_in_cup [chosen_id count 9/196]
2025-03-13 19:39:54: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
