2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 7802759726_top_right_button [chosen_id count 0/196]
2025-03-13 14:35:06: [retrieval_preprocessing] we have num_total=3810 embedding_dim=49152
[retrieval_preprocessing] for episode 26756 [episode count 0/20], we have num_retrieval=np.int64(3623) num_query=np.int64(187)
2025-03-13 14:35:08,523 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:09,427 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:09
2025-03-13 14:35:09,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.26it/s]
2025-03-13 14:35:09,465 [INFO]: There are 3623 embeddings of dim 49152
2025-03-13 14:35:09,465 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 14:35:09,465 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:09,466 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:35:09,466 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:09,466 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:09,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,466 [INFO]: 747.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:09,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:35:09,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:09
2025-03-13 14:35:09,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:09,467 [INFO]: 	Creating the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:09
2025-03-13 14:35:09,468 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:35:09,468 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:09
2025-03-13 14:35:09,468 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:35:09,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.87it/s] 20%|██        | 3/15 [00:00<00:01,  7.77it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.54it/s] 40%|████      | 6/15 [00:00<00:00, 10.03it/s] 53%|█████▎    | 8/15 [00:00<00:00, 11.17it/s] 67%|██████▋   | 10/15 [00:01<00:00, 10.09it/s] 80%|████████  | 12/15 [00:01<00:00, 10.20it/s] 93%|█████████▎| 14/15 [00:01<00:00, 10.37it/s]100%|██████████| 15/15 [00:06<00:00,  2.38it/s]
2025-03-13 14:35:15,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:15
2025-03-13 14:36:10,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7275 secs
2025-03-13 14:36:10,509 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 14:36:10,509 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.58it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.63it/s]
2025-03-13 14:36:32,193 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6837 secs
2025-03-13 14:36:32,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.7285 secs
2025-03-13 14:36:32,197 [INFO]: {
2025-03-13 14:36:32,197 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:32,197 [INFO]: 	index_param: efSearch=193
2025-03-13 14:36:32,197 [INFO]: 	index_path: knn.index
2025-03-13 14:36:32,197 [INFO]: 	size in bytes: 712803010
2025-03-13 14:36:32,197 [INFO]: 	avg_search_speed_ms: 10.177689543825746
2025-03-13 14:36:32,197 [INFO]: 	99p_search_speed_ms: 18.787211040034883
2025-03-13 14:36:32,197 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:32,197 [INFO]: 	nb vectors: 3623
2025-03-13 14:36:32,197 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:32,197 [INFO]: 	compression ratio: 0.999309450166323
2025-03-13 14:36:32,197 [INFO]: }
2025-03-13 14:36:32,197 [INFO]: 	>>> Finished "Creating the index" in 82.7305 secs
2025-03-13 14:36:32,197 [INFO]: >>> Finished "Launching the whole pipeline" in 82.7697 secs
2025-03-13 14:36:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 26756 [episode count 0/20]
[retrieval_preprocessing] for episode 65416 [episode count 1/20], we have num_retrieval=np.int64(3667) num_query=np.int64(143)
2025-03-13 14:36:34,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:35,066 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:35
2025-03-13 14:36:35,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.42it/s]
2025-03-13 14:36:35,102 [INFO]: There are 3667 embeddings of dim 49152
2025-03-13 14:36:35,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 14:36:35,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:35
2025-03-13 14:36:35,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:35,103 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:36:35,103 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:35,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:35,103 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:35
2025-03-13 14:36:35,103 [INFO]: 756.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:35,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:36:35,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:35
2025-03-13 14:36:35,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:35,103 [INFO]: 	Creating the index 03/13/2025, 14:36:35
2025-03-13 14:36:35,103 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:35
2025-03-13 14:36:35,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:36:35,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:35
2025-03-13 14:36:35,105 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:36:35,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.77it/s] 40%|████      | 6/15 [00:00<00:00, 25.25it/s] 73%|███████▎  | 11/15 [00:00<00:00, 32.15it/s]100%|██████████| 15/15 [00:03<00:00,  2.82it/s]100%|██████████| 15/15 [00:03<00:00,  3.89it/s]
2025-03-13 14:36:38,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:38
2025-03-13 14:37:36,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0433 secs
2025-03-13 14:37:36,008 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 14:37:36,008 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.37it/s]
2025-03-13 14:37:51,477 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4690 secs
2025-03-13 14:37:51,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8162 secs
2025-03-13 14:37:51,921 [INFO]: {
2025-03-13 14:37:51,921 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:51,921 [INFO]: 	index_param: efSearch=145
2025-03-13 14:37:51,921 [INFO]: 	index_path: knn.index
2025-03-13 14:37:51,921 [INFO]: 	size in bytes: 721459870
2025-03-13 14:37:51,922 [INFO]: 	avg_search_speed_ms: 10.102748856033115
2025-03-13 14:37:51,922 [INFO]: 	99p_search_speed_ms: 19.553841839078814
2025-03-13 14:37:51,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:51,922 [INFO]: 	nb vectors: 3667
2025-03-13 14:37:51,922 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:51,922 [INFO]: 	compression ratio: 0.9993092699667412
2025-03-13 14:37:51,922 [INFO]: }
2025-03-13 14:37:51,922 [INFO]: 	>>> Finished "Creating the index" in 76.8188 secs
2025-03-13 14:37:51,922 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8556 secs
2025-03-13 14:37:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 65416 [episode count 1/20]
[retrieval_preprocessing] for episode 20618 [episode count 2/20], we have num_retrieval=np.int64(3672) num_query=np.int64(138)
2025-03-13 14:37:53,172 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:53,672 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:53
2025-03-13 14:37:53,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1020.26it/s]
2025-03-13 14:37:53,703 [INFO]: There are 3672 embeddings of dim 49152
2025-03-13 14:37:53,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 14:37:53,704 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:53
2025-03-13 14:37:53,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:53,704 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:37:53,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:53,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:53,704 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:53
2025-03-13 14:37:53,704 [INFO]: 757.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:53,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:53,704 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:53
2025-03-13 14:37:53,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:53,704 [INFO]: 	Creating the index 03/13/2025, 14:37:53
2025-03-13 14:37:53,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:53
2025-03-13 14:37:53,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:37:53,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:53
2025-03-13 14:37:53,705 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:37:53,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.12it/s] 40%|████      | 6/15 [00:00<00:00, 28.70it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.01it/s]100%|██████████| 15/15 [00:03<00:00,  3.39it/s]100%|██████████| 15/15 [00:03<00:00,  4.67it/s]
2025-03-13 14:37:56,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:56
2025-03-13 14:38:48,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3991 secs
2025-03-13 14:38:48,320 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 14:38:48,320 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.54it/s]
2025-03-13 14:39:09,436 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1155 secs
2025-03-13 14:39:09,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.7351 secs
2025-03-13 14:39:09,441 [INFO]: {
2025-03-13 14:39:09,441 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:09,441 [INFO]: 	index_param: efSearch=173
2025-03-13 14:39:09,441 [INFO]: 	index_path: knn.index
2025-03-13 14:39:09,441 [INFO]: 	size in bytes: 722443570
2025-03-13 14:39:09,441 [INFO]: 	avg_search_speed_ms: 12.663029290771089
2025-03-13 14:39:09,441 [INFO]: 	99p_search_speed_ms: 18.94827229669318
2025-03-13 14:39:09,441 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:09,441 [INFO]: 	nb vectors: 3672
2025-03-13 14:39:09,441 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:09,441 [INFO]: 	compression ratio: 0.9993092969185122
2025-03-13 14:39:09,441 [INFO]: }
2025-03-13 14:39:09,441 [INFO]: 	>>> Finished "Creating the index" in 75.7367 secs
2025-03-13 14:39:09,441 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7686 secs
2025-03-13 14:39:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20618 [episode count 2/20]
[retrieval_preprocessing] for episode 65291 [episode count 3/20], we have num_retrieval=np.int64(3583) num_query=np.int64(227)
2025-03-13 14:39:11,978 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:12,700 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:12
2025-03-13 14:39:12,700 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 800.13it/s]
2025-03-13 14:39:12,734 [INFO]: There are 3583 embeddings of dim 49152
2025-03-13 14:39:12,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 14:39:12,734 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:12,735 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:39:12,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:12,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:39:12,735 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,735 [INFO]: 739.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:12,736 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:39:12,736 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:12
2025-03-13 14:39:12,736 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:12,736 [INFO]: 	Creating the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:12
2025-03-13 14:39:12,740 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 14:39:12,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:12
2025-03-13 14:39:12,740 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:39:12,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.50it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.57it/s] 80%|████████  | 12/15 [00:00<00:00, 38.67it/s]100%|██████████| 15/15 [00:04<00:00,  3.43it/s]
2025-03-13 14:39:17,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:17
2025-03-13 14:40:10,699 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5793 secs
2025-03-13 14:40:10,700 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 14:40:10,700 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.04it/s]
2025-03-13 14:40:30,020 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3194 secs
2025-03-13 14:40:30,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.2822 secs
2025-03-13 14:40:30,023 [INFO]: {
2025-03-13 14:40:30,023 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:30,023 [INFO]: 	index_param: efSearch=147
2025-03-13 14:40:30,023 [INFO]: 	index_path: knn.index
2025-03-13 14:40:30,023 [INFO]: 	size in bytes: 704933110
2025-03-13 14:40:30,023 [INFO]: 	avg_search_speed_ms: 7.433362411106608
2025-03-13 14:40:30,023 [INFO]: 	99p_search_speed_ms: 9.73615019582212
2025-03-13 14:40:30,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:30,023 [INFO]: 	nb vectors: 3583
2025-03-13 14:40:30,023 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:30,023 [INFO]: 	compression ratio: 0.9993096564864147
2025-03-13 14:40:30,023 [INFO]: }
2025-03-13 14:40:30,023 [INFO]: 	>>> Finished "Creating the index" in 77.2863 secs
2025-03-13 14:40:30,023 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3225 secs
2025-03-13 14:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 65291 [episode count 3/20]
[retrieval_preprocessing] for episode 65674 [episode count 4/20], we have num_retrieval=np.int64(3649) num_query=np.int64(161)
2025-03-13 14:40:31,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:32,483 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:32
2025-03-13 14:40:32,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 927.12it/s]
2025-03-13 14:40:32,515 [INFO]: There are 3649 embeddings of dim 49152
2025-03-13 14:40:32,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 14:40:32,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:32,516 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:40:32,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:32,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:32,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,516 [INFO]: 753.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:32,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:40:32,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:32
2025-03-13 14:40:32,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:32,516 [INFO]: 	Creating the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:32
2025-03-13 14:40:32,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:40:32,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:32
2025-03-13 14:40:32,517 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:40:32,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.54it/s] 40%|████      | 6/15 [00:00<00:00, 29.24it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.03it/s]100%|██████████| 15/15 [00:03<00:00,  3.45it/s]100%|██████████| 15/15 [00:03<00:00,  4.76it/s]
2025-03-13 14:40:35,672 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:35
2025-03-13 14:41:17,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2494 secs
2025-03-13 14:41:17,922 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 14:41:17,923 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.87s/it] 50%|█████     | 2/4 [00:06<00:06,  3.42s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.59s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.66s/it]
2025-03-13 14:41:48,691 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7685 secs
2025-03-13 14:41:48,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1766 secs
2025-03-13 14:41:48,694 [INFO]: {
2025-03-13 14:41:48,694 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:48,694 [INFO]: 	index_param: efSearch=250
2025-03-13 14:41:48,694 [INFO]: 	index_path: knn.index
2025-03-13 14:41:48,694 [INFO]: 	size in bytes: 717918490
2025-03-13 14:41:48,694 [INFO]: 	avg_search_speed_ms: 10.389330673591463
2025-03-13 14:41:48,694 [INFO]: 	99p_search_speed_ms: 15.027809306047857
2025-03-13 14:41:48,694 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:48,694 [INFO]: 	nb vectors: 3649
2025-03-13 14:41:48,694 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:48,694 [INFO]: 	compression ratio: 0.9993092558460223
2025-03-13 14:41:48,694 [INFO]: }
2025-03-13 14:41:48,694 [INFO]: 	>>> Finished "Creating the index" in 76.1780 secs
2025-03-13 14:41:48,694 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2109 secs
2025-03-13 14:41:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 65674 [episode count 4/20]
[retrieval_preprocessing] for episode 83090 [episode count 5/20], we have num_retrieval=np.int64(3612) num_query=np.int64(198)
2025-03-13 14:41:51,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:51,866 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:51
2025-03-13 14:41:51,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 801.51it/s]
2025-03-13 14:41:51,903 [INFO]: There are 3612 embeddings of dim 49152
2025-03-13 14:41:51,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 14:41:51,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:51,904 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:41:51,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:51,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:41:51,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,905 [INFO]: 745.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:51,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:41:51,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:51
2025-03-13 14:41:51,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:51,906 [INFO]: 	Creating the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:51
2025-03-13 14:41:51,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 14:41:51,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,909 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:41:51,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.80it/s] 27%|██▋       | 4/15 [00:00<00:00, 16.04it/s] 47%|████▋     | 7/15 [00:00<00:00, 20.86it/s] 73%|███████▎  | 11/15 [00:00<00:00, 25.97it/s]100%|██████████| 15/15 [00:04<00:00,  2.46it/s]100%|██████████| 15/15 [00:04<00:00,  3.59it/s]
2025-03-13 14:41:56,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:56
2025-03-13 14:42:38,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2717 secs
2025-03-13 14:42:38,363 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 14:42:38,363 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.20it/s]
2025-03-13 14:42:56,782 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4187 secs
2025-03-13 14:42:56,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8780 secs
2025-03-13 14:42:56,787 [INFO]: {
2025-03-13 14:42:56,788 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:56,788 [INFO]: 	index_param: efSearch=208
2025-03-13 14:42:56,788 [INFO]: 	index_path: knn.index
2025-03-13 14:42:56,788 [INFO]: 	size in bytes: 710638810
2025-03-13 14:42:56,788 [INFO]: 	avg_search_speed_ms: 14.857757122543273
2025-03-13 14:42:56,788 [INFO]: 	99p_search_speed_ms: 24.604498723056164
2025-03-13 14:42:56,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:56,788 [INFO]: 	nb vectors: 3612
2025-03-13 14:42:56,788 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:56,788 [INFO]: 	compression ratio: 0.9993094748090102
2025-03-13 14:42:56,788 [INFO]: }
2025-03-13 14:42:56,788 [INFO]: 	>>> Finished "Creating the index" in 64.8819 secs
2025-03-13 14:42:56,788 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9217 secs
2025-03-13 14:42:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 83090 [episode count 5/20]
[retrieval_preprocessing] for episode 63251 [episode count 6/20], we have num_retrieval=np.int64(3587) num_query=np.int64(223)
2025-03-13 14:42:59,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:59,774 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:59
2025-03-13 14:42:59,774 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.65it/s]
2025-03-13 14:42:59,809 [INFO]: There are 3587 embeddings of dim 49152
2025-03-13 14:42:59,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 14:42:59,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:59
2025-03-13 14:42:59,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:59,809 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:42:59,809 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:59,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:59,809 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:59
2025-03-13 14:42:59,809 [INFO]: 740.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:59,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:42:59,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:59
2025-03-13 14:42:59,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:59,810 [INFO]: 	Creating the index 03/13/2025, 14:42:59
2025-03-13 14:42:59,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:59
2025-03-13 14:42:59,811 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:42:59,811 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:59
2025-03-13 14:42:59,811 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:42:59,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.46it/s] 33%|███▎      | 5/15 [00:00<00:00, 25.45it/s] 67%|██████▋   | 10/15 [00:00<00:00, 33.32it/s]100%|██████████| 15/15 [00:03<00:00,  3.25it/s]100%|██████████| 15/15 [00:03<00:00,  4.29it/s]
2025-03-13 14:43:03,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:03
2025-03-13 14:43:51,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1384 secs
2025-03-13 14:43:51,455 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 14:43:51,455 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 14:44:13,768 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3125 secs
2025-03-13 14:44:14,334 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5228 secs
2025-03-13 14:44:14,334 [INFO]: {
2025-03-13 14:44:14,334 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:14,334 [INFO]: 	index_param: efSearch=207
2025-03-13 14:44:14,334 [INFO]: 	index_path: knn.index
2025-03-13 14:44:14,334 [INFO]: 	size in bytes: 705720130
2025-03-13 14:44:14,334 [INFO]: 	avg_search_speed_ms: 10.592611003676982
2025-03-13 14:44:14,334 [INFO]: 	99p_search_speed_ms: 16.49652728112414
2025-03-13 14:44:14,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:14,335 [INFO]: 	nb vectors: 3587
2025-03-13 14:44:14,335 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:14,335 [INFO]: 	compression ratio: 0.9993095931669117
2025-03-13 14:44:14,335 [INFO]: }
2025-03-13 14:44:14,335 [INFO]: 	>>> Finished "Creating the index" in 74.5251 secs
2025-03-13 14:44:14,335 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5605 secs
2025-03-13 14:44:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 63251 [episode count 6/20]
[retrieval_preprocessing] for episode 48916 [episode count 7/20], we have num_retrieval=np.int64(3508) num_query=np.int64(302)
2025-03-13 14:44:17,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:18,097 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:18
2025-03-13 14:44:18,097 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1915.21it/s]
2025-03-13 14:44:18,130 [INFO]: There are 3508 embeddings of dim 49152
2025-03-13 14:44:18,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 14:44:18,131 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:18
2025-03-13 14:44:18,131 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:18,131 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 14:44:18,131 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:18,131 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:44:18,131 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:18
2025-03-13 14:44:18,132 [INFO]: 724.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:18,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:18,132 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:18
2025-03-13 14:44:18,132 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:18,133 [INFO]: 	Creating the index 03/13/2025, 14:44:18
2025-03-13 14:44:18,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:18
2025-03-13 14:44:18,136 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 14:44:18,136 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:18
2025-03-13 14:44:18,136 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:44:18,136 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.97it/s] 50%|█████     | 7/14 [00:00<00:00, 34.58it/s] 86%|████████▌ | 12/14 [00:00<00:00, 39.61it/s]100%|██████████| 14/14 [00:03<00:00,  3.98it/s]
2025-03-13 14:44:21,660 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:21
2025-03-13 14:45:04,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3814 secs
2025-03-13 14:45:04,042 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 14:45:04,042 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.76it/s]
2025-03-13 14:45:24,745 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7021 secs
2025-03-13 14:45:24,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6118 secs
2025-03-13 14:45:24,748 [INFO]: {
2025-03-13 14:45:24,748 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:24,748 [INFO]: 	index_param: efSearch=231
2025-03-13 14:45:24,748 [INFO]: 	index_path: knn.index
2025-03-13 14:45:24,748 [INFO]: 	size in bytes: 690177430
2025-03-13 14:45:24,748 [INFO]: 	avg_search_speed_ms: 14.580114060706043
2025-03-13 14:45:24,748 [INFO]: 	99p_search_speed_ms: 22.929641103837636
2025-03-13 14:45:24,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:24,748 [INFO]: 	nb vectors: 3508
2025-03-13 14:45:24,748 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:24,748 [INFO]: 	compression ratio: 0.999309502195689
2025-03-13 14:45:24,748 [INFO]: }
2025-03-13 14:45:24,748 [INFO]: 	>>> Finished "Creating the index" in 66.6159 secs
2025-03-13 14:45:24,749 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6517 secs
2025-03-13 14:45:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 48916 [episode count 7/20]
[retrieval_preprocessing] for episode 77207 [episode count 8/20], we have num_retrieval=np.int64(3614) num_query=np.int64(196)
2025-03-13 14:45:28,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:29,368 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:29
2025-03-13 14:45:29,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.37it/s]
2025-03-13 14:45:29,404 [INFO]: There are 3614 embeddings of dim 49152
2025-03-13 14:45:29,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 14:45:29,404 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:29,404 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:45:29,404 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:29,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:29,405 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,405 [INFO]: 745.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:29,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:45:29,405 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:29
2025-03-13 14:45:29,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:29,405 [INFO]: 	Creating the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,405 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:29
2025-03-13 14:45:29,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:45:29,406 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:29
2025-03-13 14:45:29,406 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:45:29,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.85it/s] 40%|████      | 6/15 [00:00<00:00, 27.60it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.47it/s]100%|██████████| 15/15 [00:02<00:00,  3.83it/s]100%|██████████| 15/15 [00:02<00:00,  5.23it/s]
2025-03-13 14:45:32,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:32
2025-03-13 14:46:21,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4664 secs
2025-03-13 14:46:21,744 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 14:46:21,744 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 14:46:39,996 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2516 secs
2025-03-13 14:46:39,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5923 secs
2025-03-13 14:46:39,999 [INFO]: {
2025-03-13 14:46:39,999 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:39,999 [INFO]: 	index_param: efSearch=207
2025-03-13 14:46:39,999 [INFO]: 	index_path: knn.index
2025-03-13 14:46:39,999 [INFO]: 	size in bytes: 711032290
2025-03-13 14:46:39,999 [INFO]: 	avg_search_speed_ms: 14.777558283781305
2025-03-13 14:46:39,999 [INFO]: 	99p_search_speed_ms: 23.75378386117518
2025-03-13 14:46:39,999 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:39,999 [INFO]: 	nb vectors: 3614
2025-03-13 14:46:39,999 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:39,999 [INFO]: 	compression ratio: 0.9993094856493788
2025-03-13 14:46:39,999 [INFO]: }
2025-03-13 14:46:39,999 [INFO]: 	>>> Finished "Creating the index" in 70.5942 secs
2025-03-13 14:46:39,999 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6312 secs
2025-03-13 14:46:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 77207 [episode count 8/20]
[retrieval_preprocessing] for episode 82968 [episode count 9/20], we have num_retrieval=np.int64(3626) num_query=np.int64(184)
2025-03-13 14:46:42,465 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:43,013 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:43
2025-03-13 14:46:43,014 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 14:46:43,062 [INFO]: There are 3626 embeddings of dim 49152
2025-03-13 14:46:43,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0488 secs
2025-03-13 14:46:43,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:43
2025-03-13 14:46:43,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:43,063 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:46:43,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:43,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:46:43,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:43
2025-03-13 14:46:43,064 [INFO]: 748.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:43,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:46:43,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:43
2025-03-13 14:46:43,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:43,064 [INFO]: 	Creating the index 03/13/2025, 14:46:43
2025-03-13 14:46:43,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:43
2025-03-13 14:46:43,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 14:46:43,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:43
2025-03-13 14:46:43,068 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:46:43,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.32it/s] 40%|████      | 6/15 [00:00<00:00, 28.46it/s] 67%|██████▋   | 10/15 [00:00<00:00, 32.34it/s] 93%|█████████▎| 14/15 [00:00<00:00, 33.90it/s]100%|██████████| 15/15 [00:05<00:00,  2.78it/s]
2025-03-13 14:46:48,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:48
2025-03-13 14:47:42,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1711 secs
2025-03-13 14:47:42,651 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 14:47:42,651 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-13 14:48:06,739 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0872 secs
2025-03-13 14:48:06,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6738 secs
2025-03-13 14:48:06,742 [INFO]: {
2025-03-13 14:48:06,742 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:06,742 [INFO]: 	index_param: efSearch=155
2025-03-13 14:48:06,742 [INFO]: 	index_path: knn.index
2025-03-13 14:48:06,742 [INFO]: 	size in bytes: 713393230
2025-03-13 14:48:06,742 [INFO]: 	avg_search_speed_ms: 7.0134437952235045
2025-03-13 14:48:06,742 [INFO]: 	99p_search_speed_ms: 13.243948807939887
2025-03-13 14:48:06,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:06,742 [INFO]: 	nb vectors: 3626
2025-03-13 14:48:06,742 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:06,742 [INFO]: 	compression ratio: 0.9993094663934503
2025-03-13 14:48:06,742 [INFO]: }
2025-03-13 14:48:06,742 [INFO]: 	>>> Finished "Creating the index" in 83.6773 secs
2025-03-13 14:48:06,742 [INFO]: >>> Finished "Launching the whole pipeline" in 83.7283 secs
2025-03-13 14:48:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 82968 [episode count 9/20]
[retrieval_preprocessing] for episode 25373 [episode count 10/20], we have num_retrieval=np.int64(3615) num_query=np.int64(195)
2025-03-13 14:48:08,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:08,929 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:08
2025-03-13 14:48:08,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.98it/s]
2025-03-13 14:48:08,966 [INFO]: There are 3615 embeddings of dim 49152
2025-03-13 14:48:08,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 14:48:08,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:08
2025-03-13 14:48:08,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:08,966 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:48:08,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:08,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:08,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:08
2025-03-13 14:48:08,967 [INFO]: 746.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:08,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:48:08,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:08
2025-03-13 14:48:08,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:08,967 [INFO]: 	Creating the index 03/13/2025, 14:48:08
2025-03-13 14:48:08,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:08
2025-03-13 14:48:08,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:48:08,968 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:08
2025-03-13 14:48:08,968 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:48:08,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 33%|███▎      | 5/15 [00:00<00:00, 21.90it/s] 60%|██████    | 9/15 [00:00<00:00, 28.08it/s] 87%|████████▋ | 13/15 [00:00<00:00, 31.49it/s]100%|██████████| 15/15 [00:03<00:00,  4.61it/s]
2025-03-13 14:48:12,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:12
2025-03-13 14:48:56,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5724 secs
2025-03-13 14:48:56,798 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 14:48:56,798 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.07it/s]
2025-03-13 14:49:23,930 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1315 secs
2025-03-13 14:49:23,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9644 secs
2025-03-13 14:49:23,932 [INFO]: {
2025-03-13 14:49:23,932 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:23,933 [INFO]: 	index_param: efSearch=247
2025-03-13 14:49:23,933 [INFO]: 	index_path: knn.index
2025-03-13 14:49:23,933 [INFO]: 	size in bytes: 711229030
2025-03-13 14:49:23,933 [INFO]: 	avg_search_speed_ms: 10.28644545157076
2025-03-13 14:49:23,933 [INFO]: 	99p_search_speed_ms: 15.781349421013081
2025-03-13 14:49:23,933 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:23,933 [INFO]: 	nb vectors: 3615
2025-03-13 14:49:23,933 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:23,933 [INFO]: 	compression ratio: 0.9993094910650652
2025-03-13 14:49:23,933 [INFO]: }
2025-03-13 14:49:23,933 [INFO]: 	>>> Finished "Creating the index" in 74.9659 secs
2025-03-13 14:49:23,933 [INFO]: >>> Finished "Launching the whole pipeline" in 75.0031 secs
2025-03-13 14:49:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 25373 [episode count 10/20]
[retrieval_preprocessing] for episode 61726 [episode count 11/20], we have num_retrieval=np.int64(3566) num_query=np.int64(244)
2025-03-13 14:49:25,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:26,226 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:26
2025-03-13 14:49:26,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-13 14:49:26,255 [INFO]: There are 3566 embeddings of dim 49152
2025-03-13 14:49:26,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 14:49:26,255 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:26
2025-03-13 14:49:26,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:26,255 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:49:26,255 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:26,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:26,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:26
2025-03-13 14:49:26,255 [INFO]: 735.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:26,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:26,256 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:26
2025-03-13 14:49:26,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:26,256 [INFO]: 	Creating the index 03/13/2025, 14:49:26
2025-03-13 14:49:26,256 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:26
2025-03-13 14:49:26,257 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:49:26,257 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:26
2025-03-13 14:49:26,257 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:49:26,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 16.95it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.63it/s] 93%|█████████▎| 14/15 [00:00<00:00, 46.14it/s]100%|██████████| 15/15 [00:02<00:00,  6.37it/s]
2025-03-13 14:49:28,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:28
2025-03-13 14:50:19,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3464 secs
2025-03-13 14:50:19,960 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 14:50:19,960 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.56it/s]
2025-03-13 14:50:38,554 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5944 secs
2025-03-13 14:50:38,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3007 secs
2025-03-13 14:50:38,558 [INFO]: {
2025-03-13 14:50:38,558 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:38,558 [INFO]: 	index_param: efSearch=153
2025-03-13 14:50:38,558 [INFO]: 	index_path: knn.index
2025-03-13 14:50:38,558 [INFO]: 	size in bytes: 701588530
2025-03-13 14:50:38,558 [INFO]: 	avg_search_speed_ms: 9.550035454612136
2025-03-13 14:50:38,558 [INFO]: 	99p_search_speed_ms: 15.845747259445483
2025-03-13 14:50:38,558 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:38,558 [INFO]: 	nb vectors: 3566
2025-03-13 14:50:38,558 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:38,558 [INFO]: 	compression ratio: 0.9993095639690689
2025-03-13 14:50:38,558 [INFO]: }
2025-03-13 14:50:38,558 [INFO]: 	>>> Finished "Creating the index" in 72.3021 secs
2025-03-13 14:50:38,558 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3317 secs
2025-03-13 14:50:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 61726 [episode count 11/20]
[retrieval_preprocessing] for episode 5663 [episode count 12/20], we have num_retrieval=np.int64(3650) num_query=np.int64(160)
2025-03-13 14:50:40,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:41,141 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:41
2025-03-13 14:50:41,142 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1700.85it/s]
2025-03-13 14:50:41,173 [INFO]: There are 3650 embeddings of dim 49152
2025-03-13 14:50:41,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 14:50:41,174 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:41
2025-03-13 14:50:41,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:41,174 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:50:41,174 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:41,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:50:41,175 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:41
2025-03-13 14:50:41,175 [INFO]: 753.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:41,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:50:41,175 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:41
2025-03-13 14:50:41,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:41,175 [INFO]: 	Creating the index 03/13/2025, 14:50:41
2025-03-13 14:50:41,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:41
2025-03-13 14:50:41,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 14:50:41,178 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:41
2025-03-13 14:50:41,178 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:50:41,178 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.93it/s] 33%|███▎      | 5/15 [00:00<00:00, 26.22it/s] 60%|██████    | 9/15 [00:00<00:00, 32.13it/s] 87%|████████▋ | 13/15 [00:00<00:00, 34.84it/s]100%|██████████| 15/15 [00:03<00:00,  3.85it/s]
2025-03-13 14:50:45,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:45
2025-03-13 14:51:32,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8529 secs
2025-03-13 14:51:32,932 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 14:51:32,933 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.85it/s]
2025-03-13 14:51:51,165 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2317 secs
2025-03-13 14:51:51,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9890 secs
2025-03-13 14:51:51,167 [INFO]: {
2025-03-13 14:51:51,167 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:51,167 [INFO]: 	index_param: efSearch=216
2025-03-13 14:51:51,167 [INFO]: 	index_path: knn.index
2025-03-13 14:51:51,167 [INFO]: 	size in bytes: 718115230
2025-03-13 14:51:51,167 [INFO]: 	avg_search_speed_ms: 10.351757055937117
2025-03-13 14:51:51,167 [INFO]: 	99p_search_speed_ms: 16.68583081336692
2025-03-13 14:51:51,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:51,167 [INFO]: 	nb vectors: 3650
2025-03-13 14:51:51,167 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:51,167 [INFO]: 	compression ratio: 0.9993092612727348
2025-03-13 14:51:51,167 [INFO]: }
2025-03-13 14:51:51,167 [INFO]: 	>>> Finished "Creating the index" in 69.9919 secs
2025-03-13 14:51:51,167 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0259 secs
2025-03-13 14:51:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 5663 [episode count 12/20]
[retrieval_preprocessing] for episode 40607 [episode count 13/20], we have num_retrieval=np.int64(3645) num_query=np.int64(165)
2025-03-13 14:51:52,759 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:53,348 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:53
2025-03-13 14:51:53,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.87it/s]
2025-03-13 14:51:53,382 [INFO]: There are 3645 embeddings of dim 49152
2025-03-13 14:51:53,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 14:51:53,383 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:53
2025-03-13 14:51:53,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:53,383 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:51:53,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:53,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:51:53,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:53
2025-03-13 14:51:53,384 [INFO]: 752.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:53,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:51:53,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:53
2025-03-13 14:51:53,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:53,385 [INFO]: 	Creating the index 03/13/2025, 14:51:53
2025-03-13 14:51:53,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:53
2025-03-13 14:51:53,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:51:53,389 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:53
2025-03-13 14:51:53,389 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:51:53,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.28it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.38it/s] 80%|████████  | 12/15 [00:00<00:00, 35.99it/s]100%|██████████| 15/15 [00:03<00:00,  4.57it/s]
2025-03-13 14:51:56,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:56
2025-03-13 14:52:51,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.2046 secs
2025-03-13 14:52:51,881 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 14:52:51,881 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 14:53:12,826 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9448 secs
2025-03-13 14:53:12,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4401 secs
2025-03-13 14:53:12,829 [INFO]: {
2025-03-13 14:53:12,829 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:12,829 [INFO]: 	index_param: efSearch=150
2025-03-13 14:53:12,829 [INFO]: 	index_path: knn.index
2025-03-13 14:53:12,829 [INFO]: 	size in bytes: 717131530
2025-03-13 14:53:12,829 [INFO]: 	avg_search_speed_ms: 6.925585358358476
2025-03-13 14:53:12,829 [INFO]: 	99p_search_speed_ms: 9.713310769293457
2025-03-13 14:53:12,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:12,829 [INFO]: 	nb vectors: 3645
2025-03-13 14:53:12,829 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:12,829 [INFO]: 	compression ratio: 0.9993092341093969
2025-03-13 14:53:12,829 [INFO]: }
2025-03-13 14:53:12,829 [INFO]: 	>>> Finished "Creating the index" in 79.4444 secs
2025-03-13 14:53:12,829 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4810 secs
2025-03-13 14:53:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 40607 [episode count 13/20]
[retrieval_preprocessing] for episode 75432 [episode count 14/20], we have num_retrieval=np.int64(3590) num_query=np.int64(220)
2025-03-13 14:53:14,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:15,060 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:15
2025-03-13 14:53:15,060 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.73it/s]
2025-03-13 14:53:15,090 [INFO]: There are 3590 embeddings of dim 49152
2025-03-13 14:53:15,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 14:53:15,091 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:15,091 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:53:15,091 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:15,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:53:15,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,091 [INFO]: 740.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:15,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:53:15,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:15
2025-03-13 14:53:15,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:15,091 [INFO]: 	Creating the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,091 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:15
2025-03-13 14:53:15,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:53:15,093 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,093 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:53:15,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.67it/s] 40%|████      | 6/15 [00:00<00:00, 30.19it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.45it/s]100%|██████████| 15/15 [00:03<00:00,  3.57it/s]100%|██████████| 15/15 [00:03<00:00,  4.92it/s]
2025-03-13 14:53:18,142 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:18
2025-03-13 14:54:05,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3116 secs
2025-03-13 14:54:05,454 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 14:54:05,454 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 14:54:30,324 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8699 secs
2025-03-13 14:54:30,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2359 secs
2025-03-13 14:54:30,329 [INFO]: {
2025-03-13 14:54:30,329 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:30,329 [INFO]: 	index_param: efSearch=197
2025-03-13 14:54:30,329 [INFO]: 	index_path: knn.index
2025-03-13 14:54:30,329 [INFO]: 	size in bytes: 706310350
2025-03-13 14:54:30,329 [INFO]: 	avg_search_speed_ms: 10.814232808361584
2025-03-13 14:54:30,329 [INFO]: 	99p_search_speed_ms: 16.37306598946452
2025-03-13 14:54:30,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:30,329 [INFO]: 	nb vectors: 3590
2025-03-13 14:54:30,329 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:30,329 [INFO]: 	compression ratio: 0.9993096094372679
2025-03-13 14:54:30,329 [INFO]: }
2025-03-13 14:54:30,329 [INFO]: 	>>> Finished "Creating the index" in 75.2378 secs
2025-03-13 14:54:30,329 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2694 secs
2025-03-13 14:54:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 75432 [episode count 14/20]
[retrieval_preprocessing] for episode 63999 [episode count 15/20], we have num_retrieval=np.int64(3654) num_query=np.int64(156)
2025-03-13 14:54:33,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:34,333 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:34
2025-03-13 14:54:34,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.14it/s]
2025-03-13 14:54:34,376 [INFO]: There are 3654 embeddings of dim 49152
2025-03-13 14:54:34,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0437 secs
2025-03-13 14:54:34,377 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:34
2025-03-13 14:54:34,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:34,378 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:54:34,378 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:34,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:54:34,378 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:34
2025-03-13 14:54:34,378 [INFO]: 754.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:34,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:54:34,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:34
2025-03-13 14:54:34,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:34,379 [INFO]: 	Creating the index 03/13/2025, 14:54:34
2025-03-13 14:54:34,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:34
2025-03-13 14:54:34,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:54:34,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:34
2025-03-13 14:54:34,382 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:54:34,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.54it/s] 33%|███▎      | 5/15 [00:00<00:00, 24.65it/s] 60%|██████    | 9/15 [00:00<00:00, 28.12it/s] 87%|████████▋ | 13/15 [00:00<00:00, 29.79it/s]100%|██████████| 15/15 [00:03<00:00,  3.78it/s]
2025-03-13 14:54:38,361 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:38
2025-03-13 14:55:48,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.6369 secs
2025-03-13 14:55:48,998 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 14:55:48,998 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.06s/it] 50%|█████     | 2/4 [00:05<00:05,  2.85s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.51s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.04s/it]
2025-03-13 14:56:17,255 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2565 secs
2025-03-13 14:56:17,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.8772 secs
2025-03-13 14:56:17,260 [INFO]: {
2025-03-13 14:56:17,260 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:17,260 [INFO]: 	index_param: efSearch=183
2025-03-13 14:56:17,260 [INFO]: 	index_path: knn.index
2025-03-13 14:56:17,260 [INFO]: 	size in bytes: 718902250
2025-03-13 14:56:17,260 [INFO]: 	avg_search_speed_ms: 8.387777758035622
2025-03-13 14:56:17,260 [INFO]: 	99p_search_speed_ms: 13.254922882188099
2025-03-13 14:56:17,260 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:17,260 [INFO]: 	nb vectors: 3654
2025-03-13 14:56:17,260 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:17,260 [INFO]: 	compression ratio: 0.9993091995469482
2025-03-13 14:56:17,260 [INFO]: }
2025-03-13 14:56:17,260 [INFO]: 	>>> Finished "Creating the index" in 102.8812 secs
2025-03-13 14:56:17,260 [INFO]: >>> Finished "Launching the whole pipeline" in 102.9266 secs
2025-03-13 14:56:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 63999 [episode count 15/20]
[retrieval_preprocessing] for episode 82613 [episode count 16/20], we have num_retrieval=np.int64(3653) num_query=np.int64(157)
2025-03-13 14:56:19,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:20,359 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:20
2025-03-13 14:56:20,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1655.86it/s]
2025-03-13 14:56:20,397 [INFO]: There are 3653 embeddings of dim 49152
2025-03-13 14:56:20,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 14:56:20,398 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:20,398 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:56:20,398 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:20,398 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:56:20,398 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,398 [INFO]: 753.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:20,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:56:20,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:20
2025-03-13 14:56:20,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:20,399 [INFO]: 	Creating the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:20
2025-03-13 14:56:20,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:56:20,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:20
2025-03-13 14:56:20,400 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:56:20,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:14,  1.06s/it] 13%|█▎        | 2/15 [00:04<00:32,  2.50s/it] 47%|████▋     | 7/15 [00:04<00:03,  2.00it/s] 67%|██████▋   | 10/15 [00:05<00:01,  2.68it/s]100%|██████████| 15/15 [00:08<00:00,  2.01it/s]100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
2025-03-13 14:56:28,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:28
2025-03-13 14:57:21,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1648 secs
2025-03-13 14:57:21,953 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 14:57:21,954 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.40it/s]
2025-03-13 14:57:54,178 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2244 secs
2025-03-13 14:57:54,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.7824 secs
2025-03-13 14:57:54,183 [INFO]: {
2025-03-13 14:57:54,183 [INFO]: 	index_key: HNSW15
2025-03-13 14:57:54,183 [INFO]: 	index_param: efSearch=240
2025-03-13 14:57:54,183 [INFO]: 	index_path: knn.index
2025-03-13 14:57:54,183 [INFO]: 	size in bytes: 718705510
2025-03-13 14:57:54,183 [INFO]: 	avg_search_speed_ms: 9.326543891368045
2025-03-13 14:57:54,183 [INFO]: 	99p_search_speed_ms: 12.914675334468482
2025-03-13 14:57:54,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:57:54,183 [INFO]: 	nb vectors: 3653
2025-03-13 14:57:54,183 [INFO]: 	vectors dimension: 49152
2025-03-13 14:57:54,183 [INFO]: 	compression ratio: 0.9993091941092813
2025-03-13 14:57:54,183 [INFO]: }
2025-03-13 14:57:54,183 [INFO]: 	>>> Finished "Creating the index" in 93.7843 secs
2025-03-13 14:57:54,183 [INFO]: >>> Finished "Launching the whole pipeline" in 93.8237 secs
2025-03-13 14:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 82613 [episode count 16/20]
[retrieval_preprocessing] for episode 36980 [episode count 17/20], we have num_retrieval=np.int64(3616) num_query=np.int64(194)
2025-03-13 14:57:56,149 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:56,687 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:56
2025-03-13 14:57:56,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.17it/s]
2025-03-13 14:57:56,715 [INFO]: There are 3616 embeddings of dim 49152
2025-03-13 14:57:56,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 14:57:56,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:56
2025-03-13 14:57:56,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:56,715 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:57:56,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:56,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:57:56,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:56
2025-03-13 14:57:56,715 [INFO]: 746.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:56,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:57:56,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:56
2025-03-13 14:57:56,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:56,716 [INFO]: 	Creating the index 03/13/2025, 14:57:56
2025-03-13 14:57:56,716 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:56
2025-03-13 14:57:56,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:57:56,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:56
2025-03-13 14:57:56,717 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:57:56,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.06it/s] 33%|███▎      | 5/15 [00:00<00:00, 22.78it/s] 67%|██████▋   | 10/15 [00:00<00:00, 33.21it/s]100%|██████████| 15/15 [00:03<00:00,  3.35it/s]100%|██████████| 15/15 [00:03<00:00,  4.41it/s]
2025-03-13 14:58:00,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:00
2025-03-13 14:58:53,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.3155 secs
2025-03-13 14:58:53,437 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 14:58:53,437 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.27it/s]
2025-03-13 14:59:17,905 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4682 secs
2025-03-13 14:59:17,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.1904 secs
2025-03-13 14:59:17,907 [INFO]: {
2025-03-13 14:59:17,907 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:17,907 [INFO]: 	index_param: efSearch=97
2025-03-13 14:59:17,907 [INFO]: 	index_path: knn.index
2025-03-13 14:59:17,907 [INFO]: 	size in bytes: 711425770
2025-03-13 14:59:17,907 [INFO]: 	avg_search_speed_ms: 5.1758771974223
2025-03-13 14:59:17,907 [INFO]: 	99p_search_speed_ms: 7.606303878128531
2025-03-13 14:59:17,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:17,907 [INFO]: 	nb vectors: 3616
2025-03-13 14:59:17,907 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:17,907 [INFO]: 	compression ratio: 0.9993094964777562
2025-03-13 14:59:17,907 [INFO]: }
2025-03-13 14:59:17,907 [INFO]: 	>>> Finished "Creating the index" in 81.1918 secs
2025-03-13 14:59:17,907 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2207 secs
2025-03-13 14:59:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 36980 [episode count 17/20]
[retrieval_preprocessing] for episode 968 [episode count 18/20], we have num_retrieval=np.int64(3640) num_query=np.int64(170)
2025-03-13 14:59:19,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:19,644 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:19
2025-03-13 14:59:19,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.92it/s]
2025-03-13 14:59:19,675 [INFO]: There are 3640 embeddings of dim 49152
2025-03-13 14:59:19,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 14:59:19,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:19
2025-03-13 14:59:19,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:19,676 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 14:59:19,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:19,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:59:19,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:19
2025-03-13 14:59:19,676 [INFO]: 751.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:19,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:59:19,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:19
2025-03-13 14:59:19,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:19,677 [INFO]: 	Creating the index 03/13/2025, 14:59:19
2025-03-13 14:59:19,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:19
2025-03-13 14:59:19,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 14:59:19,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:19
2025-03-13 14:59:19,680 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:59:19,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.18it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.44it/s] 80%|████████  | 12/15 [00:00<00:00, 40.93it/s]100%|██████████| 15/15 [00:02<00:00,  5.07it/s]
2025-03-13 14:59:22,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:22
2025-03-13 15:00:07,264 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6172 secs
2025-03-13 15:00:07,264 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:00:07,264 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.06it/s] 50%|█████     | 2/4 [00:00<00:00,  2.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.03it/s]
2025-03-13 15:00:27,870 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6058 secs
2025-03-13 15:00:27,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1924 secs
2025-03-13 15:00:27,873 [INFO]: {
2025-03-13 15:00:27,873 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:27,873 [INFO]: 	index_param: efSearch=196
2025-03-13 15:00:27,873 [INFO]: 	index_path: knn.index
2025-03-13 15:00:27,873 [INFO]: 	size in bytes: 716147830
2025-03-13 15:00:27,873 [INFO]: 	avg_search_speed_ms: 10.794390661053223
2025-03-13 15:00:27,873 [INFO]: 	99p_search_speed_ms: 21.267257467843592
2025-03-13 15:00:27,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:27,873 [INFO]: 	nb vectors: 3640
2025-03-13 15:00:27,873 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:27,873 [INFO]: 	compression ratio: 0.999309206871436
2025-03-13 15:00:27,873 [INFO]: }
2025-03-13 15:00:27,873 [INFO]: 	>>> Finished "Creating the index" in 68.1959 secs
2025-03-13 15:00:27,873 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2286 secs
2025-03-13 15:00:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 968 [episode count 18/20]
[retrieval_preprocessing] for episode 4940 [episode count 19/20], we have num_retrieval=np.int64(3620) num_query=np.int64(190)
2025-03-13 15:00:29,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:30,213 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:30
2025-03-13 15:00:30,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 939.58it/s]
2025-03-13 15:00:30,247 [INFO]: There are 3620 embeddings of dim 49152
2025-03-13 15:00:30,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-13 15:00:30,248 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:30,248 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 15:00:30,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:30,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:30,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,248 [INFO]: 747.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:30,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:00:30,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:30
2025-03-13 15:00:30,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:30,248 [INFO]: 	Creating the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:30
2025-03-13 15:00:30,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:00:30,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,250 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 15:00:30,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.13it/s] 40%|████      | 6/15 [00:00<00:00, 29.36it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.01it/s]100%|██████████| 15/15 [00:02<00:00,  3.74it/s]100%|██████████| 15/15 [00:02<00:00,  5.12it/s]
2025-03-13 15:00:33,182 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:33
2025-03-13 15:01:13,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7990 secs
2025-03-13 15:01:13,982 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 15:01:13,982 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 15:01:46,954 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9724 secs
2025-03-13 15:01:46,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7068 secs
2025-03-13 15:01:46,957 [INFO]: {
2025-03-13 15:01:46,957 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:46,957 [INFO]: 	index_param: efSearch=140
2025-03-13 15:01:46,957 [INFO]: 	index_path: knn.index
2025-03-13 15:01:46,957 [INFO]: 	size in bytes: 712212790
2025-03-13 15:01:46,957 [INFO]: 	avg_search_speed_ms: 6.544841910104136
2025-03-13 15:01:46,957 [INFO]: 	99p_search_speed_ms: 8.9815877052024
2025-03-13 15:01:46,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:46,957 [INFO]: 	nb vectors: 3620
2025-03-13 15:01:46,957 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:46,957 [INFO]: 	compression ratio: 0.9993094339123003
2025-03-13 15:01:46,957 [INFO]: }
2025-03-13 15:01:46,957 [INFO]: 	>>> Finished "Creating the index" in 76.7085 secs
2025-03-13 15:01:46,957 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7437 secs
2025-03-13 15:01:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 4940 [episode count 19/20]
2025-03-13 15:01:49: [retrieval_preprocessing] finished for 7802759726_top_right_button [chosen_id count 0/196]
2025-03-13 15:01:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8098563998_close_coffee_maker [chosen_id count 1/196]
2025-03-13 15:01:51: [retrieval_preprocessing] we have num_total=5061 embedding_dim=49152
[retrieval_preprocessing] for episode 88068 [episode count 0/20], we have num_retrieval=np.int64(4803) num_query=np.int64(258)
2025-03-13 15:01:51,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:52,468 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:52
2025-03-13 15:01:52,468 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 15:01:52,493 [INFO]: There are 4803 embeddings of dim 49152
2025-03-13 15:01:52,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:01:52,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:52
2025-03-13 15:01:52,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:52,494 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:01:52,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:52,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:01:52,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:52
2025-03-13 15:01:52,494 [INFO]: 991.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:52,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:01:52,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:52
2025-03-13 15:01:52,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:52,494 [INFO]: 	Creating the index 03/13/2025, 15:01:52
2025-03-13 15:01:52,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:52
2025-03-13 15:01:52,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:01:52,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:52
2025-03-13 15:01:52,496 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:01:52,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01, 10.00it/s] 37%|███▋      | 7/19 [00:00<00:00, 37.00it/s] 68%|██████▊   | 13/19 [00:00<00:00, 45.38it/s]100%|██████████| 19/19 [00:03<00:00,  3.65it/s]100%|██████████| 19/19 [00:03<00:00,  4.93it/s]
2025-03-13 15:01:56,357 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:56
2025-03-13 15:02:49,719 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.3619 secs
2025-03-13 15:02:49,720 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 15:02:49,720 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.57it/s]
2025-03-13 15:03:12,550 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8303 secs
2025-03-13 15:03:12,554 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.0584 secs
2025-03-13 15:03:12,554 [INFO]: {
2025-03-13 15:03:12,554 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:12,554 [INFO]: 	index_param: efSearch=103
2025-03-13 15:03:12,554 [INFO]: 	index_path: knn.index
2025-03-13 15:03:12,554 [INFO]: 	size in bytes: 944961550
2025-03-13 15:03:12,554 [INFO]: 	avg_search_speed_ms: 6.8307059428646975
2025-03-13 15:03:12,554 [INFO]: 	99p_search_speed_ms: 11.609630140010252
2025-03-13 15:03:12,554 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:12,554 [INFO]: 	nb vectors: 4803
2025-03-13 15:03:12,554 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:12,554 [INFO]: 	compression ratio: 0.9993086216047626
2025-03-13 15:03:12,554 [INFO]: }
2025-03-13 15:03:12,555 [INFO]: 	>>> Finished "Creating the index" in 80.0602 secs
2025-03-13 15:03:12,555 [INFO]: >>> Finished "Launching the whole pipeline" in 80.0868 secs
2025-03-13 15:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 88068 [episode count 0/20]
[retrieval_preprocessing] for episode 16903 [episode count 1/20], we have num_retrieval=np.int64(4923) num_query=np.int64(138)
2025-03-13 15:03:14,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:15,227 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:15
2025-03-13 15:03:15,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 15:03:15,250 [INFO]: There are 4923 embeddings of dim 49152
2025-03-13 15:03:15,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:03:15,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:15
2025-03-13 15:03:15,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:15,251 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:03:15,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:15,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:03:15,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:15
2025-03-13 15:03:15,251 [INFO]: 1016.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:15,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:03:15,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:15
2025-03-13 15:03:15,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:15,251 [INFO]: 	Creating the index 03/13/2025, 15:03:15
2025-03-13 15:03:15,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:15
2025-03-13 15:03:15,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:03:15,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:15
2025-03-13 15:03:15,252 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:03:15,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.65it/s] 30%|███       | 6/20 [00:00<00:00, 28.46it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.84it/s] 80%|████████  | 16/20 [00:00<00:00, 39.42it/s]100%|██████████| 20/20 [00:04<00:00,  4.41it/s]
2025-03-13 15:03:19,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:19
2025-03-13 15:04:19,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6678 secs
2025-03-13 15:04:19,463 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:04:19,463 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 15:04:46,656 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1924 secs
2025-03-13 15:04:46,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.4081 secs
2025-03-13 15:04:46,661 [INFO]: {
2025-03-13 15:04:46,661 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:46,661 [INFO]: 	index_param: efSearch=201
2025-03-13 15:04:46,661 [INFO]: 	index_path: knn.index
2025-03-13 15:04:46,661 [INFO]: 	size in bytes: 968570770
2025-03-13 15:04:46,661 [INFO]: 	avg_search_speed_ms: 10.00651488872245
2025-03-13 15:04:46,661 [INFO]: 	99p_search_speed_ms: 15.2658411138691
2025-03-13 15:04:46,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:46,661 [INFO]: 	nb vectors: 4923
2025-03-13 15:04:46,661 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:46,661 [INFO]: 	compression ratio: 0.9993086865505966
2025-03-13 15:04:46,661 [INFO]: }
2025-03-13 15:04:46,661 [INFO]: 	>>> Finished "Creating the index" in 91.4096 secs
2025-03-13 15:04:46,661 [INFO]: >>> Finished "Launching the whole pipeline" in 91.4341 secs
2025-03-13 15:04:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 16903 [episode count 1/20]
[retrieval_preprocessing] for episode 26136 [episode count 2/20], we have num_retrieval=np.int64(4690) num_query=np.int64(371)
2025-03-13 15:04:48,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:49,921 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:49
2025-03-13 15:04:49,921 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.26it/s]
2025-03-13 15:04:49,952 [INFO]: There are 4690 embeddings of dim 49152
2025-03-13 15:04:49,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 15:04:49,953 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:49
2025-03-13 15:04:49,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:49,953 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:04:49,953 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:49,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:49,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:49
2025-03-13 15:04:49,953 [INFO]: 967.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:49,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:04:49,953 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:49
2025-03-13 15:04:49,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:49,953 [INFO]: 	Creating the index 03/13/2025, 15:04:49
2025-03-13 15:04:49,953 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:49
2025-03-13 15:04:49,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:04:49,955 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:49
2025-03-13 15:04:49,955 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:04:49,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.01it/s] 26%|██▋       | 5/19 [00:00<00:00, 23.16it/s] 47%|████▋     | 9/19 [00:00<00:00, 29.61it/s] 68%|██████▊   | 13/19 [00:00<00:00, 33.07it/s] 89%|████████▉ | 17/19 [00:00<00:00, 34.87it/s]100%|██████████| 19/19 [00:04<00:00,  4.23it/s]
2025-03-13 15:04:54,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:54
2025-03-13 15:05:47,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.4762 secs
2025-03-13 15:05:47,927 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 15:05:47,927 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.73it/s]
2025-03-13 15:06:13,571 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6439 secs
2025-03-13 15:06:13,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6189 secs
2025-03-13 15:06:13,574 [INFO]: {
2025-03-13 15:06:13,574 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:13,574 [INFO]: 	index_param: efSearch=216
2025-03-13 15:06:13,574 [INFO]: 	index_path: knn.index
2025-03-13 15:06:13,574 [INFO]: 	size in bytes: 922729450
2025-03-13 15:06:13,574 [INFO]: 	avg_search_speed_ms: 10.39252114814286
2025-03-13 15:06:13,574 [INFO]: 	99p_search_speed_ms: 13.982794503681362
2025-03-13 15:06:13,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:13,574 [INFO]: 	nb vectors: 4690
2025-03-13 15:06:13,574 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:13,574 [INFO]: 	compression ratio: 0.9993086489219565
2025-03-13 15:06:13,574 [INFO]: }
2025-03-13 15:06:13,574 [INFO]: 	>>> Finished "Creating the index" in 83.6208 secs
2025-03-13 15:06:13,574 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6528 secs
2025-03-13 15:06:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 26136 [episode count 2/20]
[retrieval_preprocessing] for episode 20520 [episode count 3/20], we have num_retrieval=np.int64(4775) num_query=np.int64(286)
2025-03-13 15:06:17,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:18,642 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:18
2025-03-13 15:06:18,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.96it/s]
2025-03-13 15:06:18,670 [INFO]: There are 4775 embeddings of dim 49152
2025-03-13 15:06:18,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 15:06:18,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:18
2025-03-13 15:06:18,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:18,670 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:06:18,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:18,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:06:18,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:18
2025-03-13 15:06:18,671 [INFO]: 985.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:18,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:06:18,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:18
2025-03-13 15:06:18,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:18,671 [INFO]: 	Creating the index 03/13/2025, 15:06:18
2025-03-13 15:06:18,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:18
2025-03-13 15:06:18,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:06:18,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:18
2025-03-13 15:06:18,672 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:06:18,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.34it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.45it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.07it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.96it/s]100%|██████████| 19/19 [00:04<00:00,  4.55it/s]
2025-03-13 15:06:22,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:22
2025-03-13 15:07:18,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.8345 secs
2025-03-13 15:07:18,689 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:07:18,689 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.46it/s]
2025-03-13 15:07:40,248 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5597 secs
2025-03-13 15:07:40,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.5797 secs
2025-03-13 15:07:40,252 [INFO]: {
2025-03-13 15:07:40,252 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:40,252 [INFO]: 	index_param: efSearch=183
2025-03-13 15:07:40,252 [INFO]: 	index_path: knn.index
2025-03-13 15:07:40,252 [INFO]: 	size in bytes: 939452710
2025-03-13 15:07:40,252 [INFO]: 	avg_search_speed_ms: 10.687154312279777
2025-03-13 15:07:40,252 [INFO]: 	99p_search_speed_ms: 18.43564987648278
2025-03-13 15:07:40,252 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:40,252 [INFO]: 	nb vectors: 4775
2025-03-13 15:07:40,252 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:40,252 [INFO]: 	compression ratio: 0.9993086293827392
2025-03-13 15:07:40,252 [INFO]: }
2025-03-13 15:07:40,252 [INFO]: 	>>> Finished "Creating the index" in 81.5813 secs
2025-03-13 15:07:40,252 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6107 secs
2025-03-13 15:07:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 20520 [episode count 3/20]
[retrieval_preprocessing] for episode 17452 [episode count 4/20], we have num_retrieval=np.int64(4896) num_query=np.int64(165)
2025-03-13 15:07:44,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:46,496 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:46
2025-03-13 15:07:46,496 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.65it/s]
2025-03-13 15:07:46,529 [INFO]: There are 4896 embeddings of dim 49152
2025-03-13 15:07:46,529 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 15:07:46,529 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:46
2025-03-13 15:07:46,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:46,529 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:07:46,529 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:46,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:46,529 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:46
2025-03-13 15:07:46,529 [INFO]: 1010.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:46,530 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:46,530 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:46
2025-03-13 15:07:46,530 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:46,530 [INFO]: 	Creating the index 03/13/2025, 15:07:46
2025-03-13 15:07:46,530 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:46
2025-03-13 15:07:46,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:07:46,531 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:46
2025-03-13 15:07:46,531 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:07:46,531 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.56it/s] 25%|██▌       | 5/20 [00:00<00:00, 23.11it/s] 45%|████▌     | 9/20 [00:00<00:00, 29.65it/s] 70%|███████   | 14/20 [00:00<00:00, 34.37it/s] 95%|█████████▌| 19/20 [00:00<00:00, 37.18it/s]100%|██████████| 20/20 [00:06<00:00,  3.20it/s]
2025-03-13 15:07:52,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:52
2025-03-13 15:08:39,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0036 secs
2025-03-13 15:08:39,793 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:08:39,793 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 15:09:08,477 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6831 secs
2025-03-13 15:09:08,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.9492 secs
2025-03-13 15:09:08,480 [INFO]: {
2025-03-13 15:09:08,480 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:08,480 [INFO]: 	index_param: efSearch=202
2025-03-13 15:09:08,481 [INFO]: 	index_path: knn.index
2025-03-13 15:09:08,481 [INFO]: 	size in bytes: 963258610
2025-03-13 15:09:08,481 [INFO]: 	avg_search_speed_ms: 10.350768249260174
2025-03-13 15:09:08,481 [INFO]: 	99p_search_speed_ms: 16.779274074360732
2025-03-13 15:09:08,481 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:08,481 [INFO]: 	nb vectors: 4896
2025-03-13 15:09:08,481 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:08,481 [INFO]: 	compression ratio: 0.9993087609152022
2025-03-13 15:09:08,481 [INFO]: }
2025-03-13 15:09:08,481 [INFO]: 	>>> Finished "Creating the index" in 81.9510 secs
2025-03-13 15:09:08,481 [INFO]: >>> Finished "Launching the whole pipeline" in 81.9846 secs
2025-03-13 15:09:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 17452 [episode count 4/20]
[retrieval_preprocessing] for episode 13874 [episode count 5/20], we have num_retrieval=np.int64(4784) num_query=np.int64(277)
2025-03-13 15:09:10,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:11,856 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:11
2025-03-13 15:09:11,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1043.88it/s]
2025-03-13 15:09:11,889 [INFO]: There are 4784 embeddings of dim 49152
2025-03-13 15:09:11,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:09:11,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:11,890 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:09:11,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:11,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:09:11,891 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,891 [INFO]: 987.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:11,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:09:11,891 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:11
2025-03-13 15:09:11,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:11,892 [INFO]: 	Creating the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:11
2025-03-13 15:09:11,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:09:11,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:11
2025-03-13 15:09:11,896 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:09:11,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.26it/s] 26%|██▋       | 5/19 [00:00<00:00, 24.55it/s] 47%|████▋     | 9/19 [00:00<00:00, 29.86it/s] 68%|██████▊   | 13/19 [00:00<00:00, 32.05it/s] 89%|████████▉ | 17/19 [00:00<00:00, 33.37it/s]100%|██████████| 19/19 [00:05<00:00,  3.22it/s]
2025-03-13 15:09:17,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:17
2025-03-13 15:10:22,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.6756 secs
2025-03-13 15:10:22,492 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:10:22,492 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.39it/s]
2025-03-13 15:10:53,210 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7178 secs
2025-03-13 15:10:53,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.3192 secs
2025-03-13 15:10:53,215 [INFO]: {
2025-03-13 15:10:53,215 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:53,215 [INFO]: 	index_param: efSearch=167
2025-03-13 15:10:53,215 [INFO]: 	index_path: knn.index
2025-03-13 15:10:53,215 [INFO]: 	size in bytes: 941223370
2025-03-13 15:10:53,215 [INFO]: 	avg_search_speed_ms: 8.534956254810412
2025-03-13 15:10:53,215 [INFO]: 	99p_search_speed_ms: 13.411793543491513
2025-03-13 15:10:53,215 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:53,215 [INFO]: 	nb vectors: 4784
2025-03-13 15:10:53,215 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:53,215 [INFO]: 	compression ratio: 0.9993086678245144
2025-03-13 15:10:53,215 [INFO]: }
2025-03-13 15:10:53,215 [INFO]: 	>>> Finished "Creating the index" in 101.3234 secs
2025-03-13 15:10:53,215 [INFO]: >>> Finished "Launching the whole pipeline" in 101.3589 secs
2025-03-13 15:10:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 13874 [episode count 5/20]
[retrieval_preprocessing] for episode 73807 [episode count 6/20], we have num_retrieval=np.int64(4746) num_query=np.int64(315)
2025-03-13 15:10:56,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:57,863 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:57
2025-03-13 15:10:57,863 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 950.87it/s]
2025-03-13 15:10:57,893 [INFO]: There are 4746 embeddings of dim 49152
2025-03-13 15:10:57,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:10:57,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:57
2025-03-13 15:10:57,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:57,894 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:10:57,894 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:57,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:57,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:57
2025-03-13 15:10:57,894 [INFO]: 979.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:57,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:57,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:57
2025-03-13 15:10:57,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:57,894 [INFO]: 	Creating the index 03/13/2025, 15:10:57
2025-03-13 15:10:57,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:57
2025-03-13 15:10:57,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:10:57,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:57
2025-03-13 15:10:57,896 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:10:57,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.33it/s] 26%|██▋       | 5/19 [00:00<00:00, 21.37it/s] 47%|████▋     | 9/19 [00:00<00:00, 27.43it/s] 68%|██████▊   | 13/19 [00:00<00:00, 29.61it/s] 89%|████████▉ | 17/19 [00:00<00:00, 31.26it/s]100%|██████████| 19/19 [00:04<00:00,  3.94it/s]
2025-03-13 15:11:02,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:02
2025-03-13 15:12:04,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.8641 secs
2025-03-13 15:12:04,583 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 15:12:04,583 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.74it/s]
2025-03-13 15:12:25,091 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5078 secs
2025-03-13 15:12:25,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4454 secs
2025-03-13 15:12:25,342 [INFO]: {
2025-03-13 15:12:25,342 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:25,342 [INFO]: 	index_param: efSearch=138
2025-03-13 15:12:25,342 [INFO]: 	index_path: knn.index
2025-03-13 15:12:25,342 [INFO]: 	size in bytes: 933747070
2025-03-13 15:12:25,342 [INFO]: 	avg_search_speed_ms: 8.61921874705211
2025-03-13 15:12:25,342 [INFO]: 	99p_search_speed_ms: 14.696670416742569
2025-03-13 15:12:25,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:25,342 [INFO]: 	nb vectors: 4746
2025-03-13 15:12:25,343 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:25,343 [INFO]: 	compression ratio: 0.9993086971614272
2025-03-13 15:12:25,343 [INFO]: }
2025-03-13 15:12:25,343 [INFO]: 	>>> Finished "Creating the index" in 87.4483 secs
2025-03-13 15:12:25,343 [INFO]: >>> Finished "Launching the whole pipeline" in 87.4800 secs
2025-03-13 15:12:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 73807 [episode count 6/20]
[retrieval_preprocessing] for episode 37474 [episode count 7/20], we have num_retrieval=np.int64(4900) num_query=np.int64(161)
2025-03-13 15:12:28,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:29,294 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:29
2025-03-13 15:12:29,294 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.90it/s]
2025-03-13 15:12:29,318 [INFO]: There are 4900 embeddings of dim 49152
2025-03-13 15:12:29,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 15:12:29,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:29
2025-03-13 15:12:29,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:29,319 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:12:29,319 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:29,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:29,319 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:29
2025-03-13 15:12:29,319 [INFO]: 1011.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:29,319 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:29,319 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:29
2025-03-13 15:12:29,319 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:29,319 [INFO]: 	Creating the index 03/13/2025, 15:12:29
2025-03-13 15:12:29,319 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:29
2025-03-13 15:12:29,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:12:29,320 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:29
2025-03-13 15:12:29,320 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:12:29,320 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.99it/s] 30%|███       | 6/20 [00:00<00:00, 25.68it/s] 55%|█████▌    | 11/20 [00:00<00:00, 32.71it/s] 80%|████████  | 16/20 [00:00<00:00, 35.38it/s]100%|██████████| 20/20 [00:05<00:00,  2.20it/s]100%|██████████| 20/20 [00:05<00:00,  3.51it/s]
2025-03-13 15:12:35,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:35
2025-03-13 15:13:29,248 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.2276 secs
2025-03-13 15:13:29,248 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:13:29,249 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.92it/s]
2025-03-13 15:13:52,520 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2714 secs
2025-03-13 15:13:52,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.2028 secs
2025-03-13 15:13:52,523 [INFO]: {
2025-03-13 15:13:52,523 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:52,523 [INFO]: 	index_param: efSearch=198
2025-03-13 15:13:52,523 [INFO]: 	index_path: knn.index
2025-03-13 15:13:52,523 [INFO]: 	size in bytes: 964045570
2025-03-13 15:13:52,523 [INFO]: 	avg_search_speed_ms: 8.958915711670954
2025-03-13 15:13:52,523 [INFO]: 	99p_search_speed_ms: 12.908598710782822
2025-03-13 15:13:52,523 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:52,523 [INFO]: 	nb vectors: 4900
2025-03-13 15:13:52,523 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:52,523 [INFO]: 	compression ratio: 0.9993087774885995
2025-03-13 15:13:52,523 [INFO]: }
2025-03-13 15:13:52,523 [INFO]: 	>>> Finished "Creating the index" in 83.2042 secs
2025-03-13 15:13:52,523 [INFO]: >>> Finished "Launching the whole pipeline" in 83.2295 secs
2025-03-13 15:13:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 37474 [episode count 7/20]
[retrieval_preprocessing] for episode 70288 [episode count 8/20], we have num_retrieval=np.int64(4881) num_query=np.int64(180)
2025-03-13 15:13:54,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:55,224 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:55
2025-03-13 15:13:55,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 15:13:55,253 [INFO]: There are 4881 embeddings of dim 49152
2025-03-13 15:13:55,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 15:13:55,254 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:55
2025-03-13 15:13:55,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:55,254 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:13:55,254 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:55,254 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:13:55,254 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:55
2025-03-13 15:13:55,254 [INFO]: 1007.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:55,254 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:13:55,254 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:55
2025-03-13 15:13:55,254 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:55,254 [INFO]: 	Creating the index 03/13/2025, 15:13:55
2025-03-13 15:13:55,255 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:55
2025-03-13 15:13:55,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:13:55,256 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:55
2025-03-13 15:13:55,256 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:13:55,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.29it/s] 30%|███       | 6/20 [00:00<00:00, 30.08it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.61it/s] 80%|████████  | 16/20 [00:00<00:00, 38.70it/s]100%|██████████| 20/20 [00:04<00:00,  3.02it/s]100%|██████████| 20/20 [00:04<00:00,  4.76it/s]
2025-03-13 15:13:59,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:59
2025-03-13 15:14:50,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4554 secs
2025-03-13 15:14:50,921 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 15:14:50,921 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-13 15:15:13,327 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4057 secs
2025-03-13 15:15:13,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0739 secs
2025-03-13 15:15:13,330 [INFO]: {
2025-03-13 15:15:13,330 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:13,330 [INFO]: 	index_param: efSearch=140
2025-03-13 15:15:13,330 [INFO]: 	index_path: knn.index
2025-03-13 15:15:13,330 [INFO]: 	size in bytes: 960307510
2025-03-13 15:15:13,330 [INFO]: 	avg_search_speed_ms: 7.792184041887057
2025-03-13 15:15:13,330 [INFO]: 	99p_search_speed_ms: 11.422901358455421
2025-03-13 15:15:13,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:13,330 [INFO]: 	nb vectors: 4881
2025-03-13 15:15:13,330 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:13,330 [INFO]: 	compression ratio: 0.9993086985230387
2025-03-13 15:15:13,330 [INFO]: }
2025-03-13 15:15:13,330 [INFO]: 	>>> Finished "Creating the index" in 78.0758 secs
2025-03-13 15:15:13,330 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1066 secs
2025-03-13 15:15:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 70288 [episode count 8/20]
[retrieval_preprocessing] for episode 46737 [episode count 9/20], we have num_retrieval=np.int64(4791) num_query=np.int64(270)
2025-03-13 15:15:15,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:15,946 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:15
2025-03-13 15:15:15,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1580.97it/s]
2025-03-13 15:15:15,975 [INFO]: There are 4791 embeddings of dim 49152
2025-03-13 15:15:15,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:15:15,976 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:15
2025-03-13 15:15:15,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:15,976 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:15:15,976 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:15,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:15:15,976 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:15
2025-03-13 15:15:15,977 [INFO]: 988.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:15,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:15:15,977 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:15
2025-03-13 15:15:15,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:15,977 [INFO]: 	Creating the index 03/13/2025, 15:15:15
2025-03-13 15:15:15,977 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:15
2025-03-13 15:15:15,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:15:15,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:15
2025-03-13 15:15:15,981 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:15:15,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.66it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.56it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.99it/s] 89%|████████▉ | 17/19 [00:00<00:00, 39.59it/s]100%|██████████| 19/19 [00:04<00:00,  4.70it/s]
2025-03-13 15:15:20,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:20
2025-03-13 15:16:20,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.9217 secs
2025-03-13 15:16:20,951 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:16:20,951 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 15:16:50,606 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6551 secs
2025-03-13 15:16:50,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.6298 secs
2025-03-13 15:16:50,611 [INFO]: {
2025-03-13 15:16:50,611 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:50,611 [INFO]: 	index_param: efSearch=196
2025-03-13 15:16:50,611 [INFO]: 	index_path: knn.index
2025-03-13 15:16:50,611 [INFO]: 	size in bytes: 942600550
2025-03-13 15:16:50,611 [INFO]: 	avg_search_speed_ms: 9.63360327699323
2025-03-13 15:16:50,611 [INFO]: 	99p_search_speed_ms: 15.914247808977944
2025-03-13 15:16:50,611 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:50,611 [INFO]: 	nb vectors: 4791
2025-03-13 15:16:50,611 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:50,611 [INFO]: 	compression ratio: 0.9993086976238238
2025-03-13 15:16:50,611 [INFO]: }
2025-03-13 15:16:50,611 [INFO]: 	>>> Finished "Creating the index" in 94.6340 secs
2025-03-13 15:16:50,611 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6651 secs
2025-03-13 15:16:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 46737 [episode count 9/20]
[retrieval_preprocessing] for episode 64187 [episode count 10/20], we have num_retrieval=np.int64(4917) num_query=np.int64(144)
2025-03-13 15:16:53,575 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:54,514 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:54
2025-03-13 15:16:54,515 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-13 15:16:55,706 [INFO]: There are 4917 embeddings of dim 49152
2025-03-13 15:16:55,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 1.1914 secs
2025-03-13 15:16:55,706 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:55
2025-03-13 15:16:55,706 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:55,706 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:16:55,706 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:55,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:16:55,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:55
2025-03-13 15:16:55,707 [INFO]: 1014.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:55,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:16:55,707 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:55
2025-03-13 15:16:55,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:55,707 [INFO]: 	Creating the index 03/13/2025, 15:16:55
2025-03-13 15:16:55,707 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:55
2025-03-13 15:16:55,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:16:55,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:55
2025-03-13 15:16:55,710 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:16:55,710 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.67it/s] 30%|███       | 6/20 [00:00<00:00, 29.97it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.56it/s] 80%|████████  | 16/20 [00:00<00:00, 41.42it/s]100%|██████████| 20/20 [00:04<00:00,  4.90it/s]
2025-03-13 15:16:59,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:59
2025-03-13 15:17:56,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4070 secs
2025-03-13 15:17:56,203 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 15:17:56,203 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 15:18:28,806 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6025 secs
2025-03-13 15:18:28,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.1003 secs
2025-03-13 15:18:28,810 [INFO]: {
2025-03-13 15:18:28,810 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:28,810 [INFO]: 	index_param: efSearch=131
2025-03-13 15:18:28,810 [INFO]: 	index_path: knn.index
2025-03-13 15:18:28,810 [INFO]: 	size in bytes: 967390210
2025-03-13 15:18:28,810 [INFO]: 	avg_search_speed_ms: 7.068167441086528
2025-03-13 15:18:28,810 [INFO]: 	99p_search_speed_ms: 10.705734335351734
2025-03-13 15:18:28,810 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:28,810 [INFO]: 	nb vectors: 4917
2025-03-13 15:18:28,810 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:28,810 [INFO]: 	compression ratio: 0.9993087856450398
2025-03-13 15:18:28,810 [INFO]: }
2025-03-13 15:18:28,810 [INFO]: 	>>> Finished "Creating the index" in 93.1029 secs
2025-03-13 15:18:28,810 [INFO]: >>> Finished "Launching the whole pipeline" in 94.2957 secs
2025-03-13 15:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 64187 [episode count 10/20]
[retrieval_preprocessing] for episode 15042 [episode count 11/20], we have num_retrieval=np.int64(4753) num_query=np.int64(308)
2025-03-13 15:18:30,404 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:31,177 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:31
2025-03-13 15:18:31,178 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1711.96it/s]
2025-03-13 15:18:31,207 [INFO]: There are 4753 embeddings of dim 49152
2025-03-13 15:18:31,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:18:31,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:31
2025-03-13 15:18:31,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:31,208 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:18:31,209 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:31,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:18:31,209 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:31
2025-03-13 15:18:31,209 [INFO]: 980.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:31,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:18:31,210 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:31
2025-03-13 15:18:31,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:31,210 [INFO]: 	Creating the index 03/13/2025, 15:18:31
2025-03-13 15:18:31,210 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:31
2025-03-13 15:18:31,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:18:31,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:31
2025-03-13 15:18:31,214 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:18:31,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.89it/s] 37%|███▋      | 7/19 [00:00<00:00, 34.61it/s] 63%|██████▎   | 12/19 [00:00<00:00, 40.47it/s] 89%|████████▉ | 17/19 [00:00<00:00, 43.49it/s]100%|██████████| 19/19 [00:03<00:00,  4.87it/s]
2025-03-13 15:18:35,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:35
2025-03-13 15:19:29,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1383 secs
2025-03-13 15:19:29,260 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:19:29,260 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.39it/s]
2025-03-13 15:20:00,576 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3162 secs
2025-03-13 15:20:00,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.3670 secs
2025-03-13 15:20:00,581 [INFO]: {
2025-03-13 15:20:00,581 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:00,581 [INFO]: 	index_param: efSearch=207
2025-03-13 15:20:00,581 [INFO]: 	index_path: knn.index
2025-03-13 15:20:00,581 [INFO]: 	size in bytes: 935124250
2025-03-13 15:20:00,581 [INFO]: 	avg_search_speed_ms: 11.660218776946145
2025-03-13 15:20:00,581 [INFO]: 	99p_search_speed_ms: 19.598888289183375
2025-03-13 15:20:00,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:00,581 [INFO]: 	nb vectors: 4753
2025-03-13 15:20:00,581 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:00,581 [INFO]: 	compression ratio: 0.9993087271557763
2025-03-13 15:20:00,581 [INFO]: }
2025-03-13 15:20:00,581 [INFO]: 	>>> Finished "Creating the index" in 89.3711 secs
2025-03-13 15:20:00,581 [INFO]: >>> Finished "Launching the whole pipeline" in 89.4035 secs
2025-03-13 15:20:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 15042 [episode count 11/20]
[retrieval_preprocessing] for episode 61142 [episode count 12/20], we have num_retrieval=np.int64(4658) num_query=np.int64(403)
2025-03-13 15:20:04,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:05,467 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:05
2025-03-13 15:20:05,467 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.96it/s]
2025-03-13 15:20:05,493 [INFO]: There are 4658 embeddings of dim 49152
2025-03-13 15:20:05,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:20:05,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:05
2025-03-13 15:20:05,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:05,494 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:20:05,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:05,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:05,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:05
2025-03-13 15:20:05,494 [INFO]: 961.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:05,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:05,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:05
2025-03-13 15:20:05,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:05,494 [INFO]: 	Creating the index 03/13/2025, 15:20:05
2025-03-13 15:20:05,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:05
2025-03-13 15:20:05,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:20:05,495 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:05
2025-03-13 15:20:05,495 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:20:05,495 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.81it/s] 32%|███▏      | 6/19 [00:00<00:00, 25.54it/s] 58%|█████▊    | 11/19 [00:00<00:00, 32.32it/s] 84%|████████▍ | 16/19 [00:00<00:00, 35.83it/s]100%|██████████| 19/19 [00:05<00:00,  3.57it/s]
2025-03-13 15:20:10,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:10
2025-03-13 15:21:07,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4540 secs
2025-03-13 15:21:07,278 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:21:07,278 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.14it/s]
2025-03-13 15:21:30,784 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5057 secs
2025-03-13 15:21:30,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.2921 secs
2025-03-13 15:21:30,788 [INFO]: {
2025-03-13 15:21:30,788 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:30,788 [INFO]: 	index_param: efSearch=193
2025-03-13 15:21:30,788 [INFO]: 	index_path: knn.index
2025-03-13 15:21:30,788 [INFO]: 	size in bytes: 916433470
2025-03-13 15:21:30,788 [INFO]: 	avg_search_speed_ms: 9.29107787009661
2025-03-13 15:21:30,788 [INFO]: 	99p_search_speed_ms: 13.556172547396272
2025-03-13 15:21:30,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:30,788 [INFO]: 	nb vectors: 4658
2025-03-13 15:21:30,788 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:30,788 [INFO]: 	compression ratio: 0.9993088358067062
2025-03-13 15:21:30,788 [INFO]: }
2025-03-13 15:21:30,788 [INFO]: 	>>> Finished "Creating the index" in 85.2938 secs
2025-03-13 15:21:30,788 [INFO]: >>> Finished "Launching the whole pipeline" in 85.3212 secs
2025-03-13 15:21:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 61142 [episode count 12/20]
[retrieval_preprocessing] for episode 75516 [episode count 13/20], we have num_retrieval=np.int64(4806) num_query=np.int64(255)
2025-03-13 15:21:34,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:36,218 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:36
2025-03-13 15:21:36,218 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-13 15:21:36,243 [INFO]: There are 4806 embeddings of dim 49152
2025-03-13 15:21:36,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 15:21:36,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:36
2025-03-13 15:21:36,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:36,243 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:21:36,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:36,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:21:36,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:36
2025-03-13 15:21:36,243 [INFO]: 991.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:36,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:21:36,243 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:36
2025-03-13 15:21:36,243 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:36,243 [INFO]: 	Creating the index 03/13/2025, 15:21:36
2025-03-13 15:21:36,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:36
2025-03-13 15:21:36,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:21:36,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:36
2025-03-13 15:21:36,245 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:21:36,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.95it/s] 32%|███▏      | 6/19 [00:00<00:00, 23.72it/s] 53%|█████▎    | 10/19 [00:00<00:00, 29.75it/s] 74%|███████▎  | 14/19 [00:00<00:00, 33.22it/s] 95%|█████████▍| 18/19 [00:00<00:00, 35.15it/s]100%|██████████| 19/19 [00:05<00:00,  3.67it/s]
2025-03-13 15:21:41,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:41
2025-03-13 15:22:27,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6615 secs
2025-03-13 15:22:27,088 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:22:27,088 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 15:23:08,365 [INFO]: 	>>> Finished "Compute fast metrics" in 41.2767 secs
2025-03-13 15:23:08,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.1247 secs
2025-03-13 15:23:08,370 [INFO]: {
2025-03-13 15:23:08,370 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:08,370 [INFO]: 	index_param: efSearch=207
2025-03-13 15:23:08,370 [INFO]: 	index_path: knn.index
2025-03-13 15:23:08,370 [INFO]: 	size in bytes: 945551770
2025-03-13 15:23:08,370 [INFO]: 	avg_search_speed_ms: 13.130240574395993
2025-03-13 15:23:08,370 [INFO]: 	99p_search_speed_ms: 21.03722819592803
2025-03-13 15:23:08,370 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:08,370 [INFO]: 	nb vectors: 4806
2025-03-13 15:23:08,370 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:08,370 [INFO]: 	compression ratio: 0.9993086343648852
2025-03-13 15:23:08,370 [INFO]: }
2025-03-13 15:23:08,370 [INFO]: 	>>> Finished "Creating the index" in 92.1263 secs
2025-03-13 15:23:08,370 [INFO]: >>> Finished "Launching the whole pipeline" in 92.1518 secs
2025-03-13 15:23:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 75516 [episode count 13/20]
[retrieval_preprocessing] for episode 74558 [episode count 14/20], we have num_retrieval=np.int64(4874) num_query=np.int64(187)
2025-03-13 15:23:13,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:13,980 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:13
2025-03-13 15:23:13,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.60it/s]
2025-03-13 15:23:14,010 [INFO]: There are 4874 embeddings of dim 49152
2025-03-13 15:23:14,011 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:23:14,011 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:14
2025-03-13 15:23:14,011 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:14,011 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:23:14,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:14,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:14,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:14
2025-03-13 15:23:14,011 [INFO]: 1005.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:14,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:23:14,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:14
2025-03-13 15:23:14,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:14,012 [INFO]: 	Creating the index 03/13/2025, 15:23:14
2025-03-13 15:23:14,012 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:14
2025-03-13 15:23:14,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:23:14,013 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:14
2025-03-13 15:23:14,013 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:23:14,013 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.32it/s] 30%|███       | 6/20 [00:00<00:00, 27.72it/s] 55%|█████▌    | 11/20 [00:00<00:00, 33.87it/s] 80%|████████  | 16/20 [00:00<00:00, 36.73it/s]100%|██████████| 20/20 [00:04<00:00,  2.90it/s]100%|██████████| 20/20 [00:04<00:00,  4.56it/s]
2025-03-13 15:23:18,400 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:18
2025-03-13 15:24:06,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0536 secs
2025-03-13 15:24:06,454 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 15:24:06,454 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.69it/s]
2025-03-13 15:24:36,003 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5483 secs
2025-03-13 15:24:36,006 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.9934 secs
2025-03-13 15:24:36,007 [INFO]: {
2025-03-13 15:24:36,007 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:36,007 [INFO]: 	index_param: efSearch=142
2025-03-13 15:24:36,007 [INFO]: 	index_path: knn.index
2025-03-13 15:24:36,007 [INFO]: 	size in bytes: 958930270
2025-03-13 15:24:36,007 [INFO]: 	avg_search_speed_ms: 7.31220841714132
2025-03-13 15:24:36,007 [INFO]: 	99p_search_speed_ms: 12.978900081943719
2025-03-13 15:24:36,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:36,007 [INFO]: 	nb vectors: 4874
2025-03-13 15:24:36,007 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:36,007 [INFO]: 	compression ratio: 0.9993087318017398
2025-03-13 15:24:36,007 [INFO]: }
2025-03-13 15:24:36,007 [INFO]: 	>>> Finished "Creating the index" in 81.9953 secs
2025-03-13 15:24:36,007 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0266 secs
2025-03-13 15:24:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 74558 [episode count 14/20]
[retrieval_preprocessing] for episode 68460 [episode count 15/20], we have num_retrieval=np.int64(4706) num_query=np.int64(355)
2025-03-13 15:24:40,090 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:40,991 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:40
2025-03-13 15:24:40,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 946.80it/s]
2025-03-13 15:24:41,021 [INFO]: There are 4706 embeddings of dim 49152
2025-03-13 15:24:41,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:24:41,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:41
2025-03-13 15:24:41,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:41,021 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:24:41,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:41,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:41,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:41
2025-03-13 15:24:41,022 [INFO]: 971.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:41,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:24:41,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:41
2025-03-13 15:24:41,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:41,022 [INFO]: 	Creating the index 03/13/2025, 15:24:41
2025-03-13 15:24:41,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:41
2025-03-13 15:24:41,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:24:41,023 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:41
2025-03-13 15:24:41,023 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:24:41,023 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.74it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.80it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.02it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.86it/s]100%|██████████| 19/19 [00:03<00:00,  4.90it/s]
2025-03-13 15:24:44,910 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:44
2025-03-13 15:25:38,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.4736 secs
2025-03-13 15:25:38,384 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:25:38,385 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 15:26:03,495 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1103 secs
2025-03-13 15:26:03,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4754 secs
2025-03-13 15:26:03,499 [INFO]: {
2025-03-13 15:26:03,499 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:03,499 [INFO]: 	index_param: efSearch=162
2025-03-13 15:26:03,499 [INFO]: 	index_path: knn.index
2025-03-13 15:26:03,499 [INFO]: 	size in bytes: 925877350
2025-03-13 15:26:03,499 [INFO]: 	avg_search_speed_ms: 7.9401626839355
2025-03-13 15:26:03,499 [INFO]: 	99p_search_speed_ms: 12.750014308840052
2025-03-13 15:26:03,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:03,499 [INFO]: 	nb vectors: 4706
2025-03-13 15:26:03,499 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:03,499 [INFO]: 	compression ratio: 0.9993086535705836
2025-03-13 15:26:03,499 [INFO]: }
2025-03-13 15:26:03,499 [INFO]: 	>>> Finished "Creating the index" in 82.4774 secs
2025-03-13 15:26:03,499 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5078 secs
2025-03-13 15:26:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 68460 [episode count 15/20]
[retrieval_preprocessing] for episode 49001 [episode count 16/20], we have num_retrieval=np.int64(4736) num_query=np.int64(325)
2025-03-13 15:26:06,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:07,490 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:07
2025-03-13 15:26:07,490 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 938.95it/s]
2025-03-13 15:26:07,516 [INFO]: There are 4736 embeddings of dim 49152
2025-03-13 15:26:07,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:26:07,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:07
2025-03-13 15:26:07,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:07,517 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:26:07,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:07,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:26:07,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:07
2025-03-13 15:26:07,517 [INFO]: 977.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:07,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:07,517 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:07
2025-03-13 15:26:07,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:07,517 [INFO]: 	Creating the index 03/13/2025, 15:26:07
2025-03-13 15:26:07,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:07
2025-03-13 15:26:07,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:26:07,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:07
2025-03-13 15:26:07,519 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:26:07,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.30it/s] 37%|███▋      | 7/19 [00:00<00:00, 32.18it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.77it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.69it/s]100%|██████████| 19/19 [00:03<00:00,  4.93it/s]
2025-03-13 15:26:11,376 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:11
2025-03-13 15:27:07,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7705 secs
2025-03-13 15:27:07,148 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:27:07,148 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-13 15:27:47,327 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1792 secs
2025-03-13 15:27:47,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.8115 secs
2025-03-13 15:27:47,330 [INFO]: {
2025-03-13 15:27:47,330 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:47,330 [INFO]: 	index_param: efSearch=199
2025-03-13 15:27:47,330 [INFO]: 	index_path: knn.index
2025-03-13 15:27:47,330 [INFO]: 	size in bytes: 931779610
2025-03-13 15:27:47,330 [INFO]: 	avg_search_speed_ms: 9.386884606500187
2025-03-13 15:27:47,330 [INFO]: 	99p_search_speed_ms: 13.010704563930627
2025-03-13 15:27:47,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:47,330 [INFO]: 	nb vectors: 4736
2025-03-13 15:27:47,330 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:47,330 [INFO]: 	compression ratio: 0.9993087185069439
2025-03-13 15:27:47,330 [INFO]: }
2025-03-13 15:27:47,330 [INFO]: 	>>> Finished "Creating the index" in 99.8132 secs
2025-03-13 15:27:47,331 [INFO]: >>> Finished "Launching the whole pipeline" in 99.8408 secs
2025-03-13 15:27:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 49001 [episode count 16/20]
[retrieval_preprocessing] for episode 7524 [episode count 17/20], we have num_retrieval=np.int64(4881) num_query=np.int64(180)
2025-03-13 15:27:49,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:50,780 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:50
2025-03-13 15:27:50,781 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1345.62it/s]
2025-03-13 15:27:50,810 [INFO]: There are 4881 embeddings of dim 49152
2025-03-13 15:27:50,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 15:27:50,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:50,811 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:27:50,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:50,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:27:50,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,812 [INFO]: 1007.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:50,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:27:50,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:50
2025-03-13 15:27:50,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:50,812 [INFO]: 	Creating the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:50
2025-03-13 15:27:50,814 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 15:27:50,814 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:50
2025-03-13 15:27:50,814 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:27:50,815 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.19it/s] 30%|███       | 6/20 [00:00<00:00, 27.55it/s] 55%|█████▌    | 11/20 [00:00<00:00, 33.86it/s] 80%|████████  | 16/20 [00:00<00:00, 36.82it/s]100%|██████████| 20/20 [00:04<00:00,  2.98it/s]100%|██████████| 20/20 [00:04<00:00,  4.68it/s]
2025-03-13 15:27:55,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:55
2025-03-13 15:28:52,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7194 secs
2025-03-13 15:28:52,813 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:28:52,813 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.12it/s]
2025-03-13 15:29:19,214 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4009 secs
2025-03-13 15:29:19,218 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.4031 secs
2025-03-13 15:29:19,218 [INFO]: {
2025-03-13 15:29:19,218 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:19,218 [INFO]: 	index_param: efSearch=162
2025-03-13 15:29:19,218 [INFO]: 	index_path: knn.index
2025-03-13 15:29:19,218 [INFO]: 	size in bytes: 960307510
2025-03-13 15:29:19,218 [INFO]: 	avg_search_speed_ms: 8.782322933289032
2025-03-13 15:29:19,218 [INFO]: 	99p_search_speed_ms: 13.369630221277465
2025-03-13 15:29:19,218 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:19,218 [INFO]: 	nb vectors: 4881
2025-03-13 15:29:19,218 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:19,218 [INFO]: 	compression ratio: 0.9993086985230387
2025-03-13 15:29:19,218 [INFO]: }
2025-03-13 15:29:19,218 [INFO]: 	>>> Finished "Creating the index" in 88.4058 secs
2025-03-13 15:29:19,218 [INFO]: >>> Finished "Launching the whole pipeline" in 88.4374 secs
2025-03-13 15:29:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 7524 [episode count 17/20]
[retrieval_preprocessing] for episode 1264 [episode count 18/20], we have num_retrieval=np.int64(4845) num_query=np.int64(216)
2025-03-13 15:29:21,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:22,377 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:22
2025-03-13 15:29:22,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1638.40it/s]
2025-03-13 15:29:22,403 [INFO]: There are 4845 embeddings of dim 49152
2025-03-13 15:29:22,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:29:22,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:22
2025-03-13 15:29:22,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:22,403 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:29:22,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:22,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:29:22,403 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:22
2025-03-13 15:29:22,404 [INFO]: 999.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:22,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:29:22,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:22
2025-03-13 15:29:22,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:22,404 [INFO]: 	Creating the index 03/13/2025, 15:29:22
2025-03-13 15:29:22,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:22
2025-03-13 15:29:22,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:29:22,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:22
2025-03-13 15:29:22,405 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:29:22,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.94it/s] 25%|██▌       | 5/20 [00:00<00:00, 22.28it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.35it/s] 65%|██████▌   | 13/20 [00:00<00:00, 31.46it/s] 85%|████████▌ | 17/20 [00:00<00:00, 33.17it/s]100%|██████████| 20/20 [00:06<00:00,  2.95it/s]
2025-03-13 15:29:29,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:29
2025-03-13 15:30:18,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3796 secs
2025-03-13 15:30:18,571 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 15:30:18,571 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 15:30:45,144 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5729 secs
2025-03-13 15:30:45,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.7433 secs
2025-03-13 15:30:45,148 [INFO]: {
2025-03-13 15:30:45,148 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:45,148 [INFO]: 	index_param: efSearch=169
2025-03-13 15:30:45,148 [INFO]: 	index_path: knn.index
2025-03-13 15:30:45,148 [INFO]: 	size in bytes: 953224810
2025-03-13 15:30:45,148 [INFO]: 	avg_search_speed_ms: 10.038301516529996
2025-03-13 15:30:45,148 [INFO]: 	99p_search_speed_ms: 13.510156283155082
2025-03-13 15:30:45,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:45,148 [INFO]: 	nb vectors: 4845
2025-03-13 15:30:45,148 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:45,148 [INFO]: 	compression ratio: 0.999308610106361
2025-03-13 15:30:45,148 [INFO]: }
2025-03-13 15:30:45,149 [INFO]: 	>>> Finished "Creating the index" in 82.7448 secs
2025-03-13 15:30:45,149 [INFO]: >>> Finished "Launching the whole pipeline" in 82.7711 secs
2025-03-13 15:30:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 1264 [episode count 18/20]
[retrieval_preprocessing] for episode 62299 [episode count 19/20], we have num_retrieval=np.int64(4794) num_query=np.int64(267)
2025-03-13 15:30:48,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:49,772 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:49
2025-03-13 15:30:49,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.07it/s]
2025-03-13 15:30:49,802 [INFO]: There are 4794 embeddings of dim 49152
2025-03-13 15:30:49,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 15:30:49,802 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,802 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:49,802 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:30:49,802 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:49,802 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:49,802 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,802 [INFO]: 989.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:49,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:30:49,803 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:49
2025-03-13 15:30:49,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:49,803 [INFO]: 	Creating the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,803 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:49
2025-03-13 15:30:49,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:30:49,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:49
2025-03-13 15:30:49,804 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:30:49,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.65it/s] 16%|█▌        | 3/19 [00:00<00:01,  9.16it/s] 26%|██▋       | 5/19 [00:00<00:01,  8.59it/s] 32%|███▏      | 6/19 [00:00<00:01,  8.50it/s] 37%|███▋      | 7/19 [00:00<00:01,  8.06it/s] 42%|████▏     | 8/19 [00:01<00:01,  7.67it/s] 53%|█████▎    | 10/19 [00:01<00:01,  8.17it/s] 63%|██████▎   | 12/19 [00:01<00:00,  8.61it/s] 68%|██████▊   | 13/19 [00:01<00:00,  8.84it/s] 79%|███████▉  | 15/19 [00:01<00:00, 11.21it/s] 89%|████████▉ | 17/19 [00:01<00:00, 12.56it/s]100%|██████████| 19/19 [00:06<00:00,  1.29it/s]100%|██████████| 19/19 [00:06<00:00,  3.13it/s]
2025-03-13 15:30:55,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:55
2025-03-13 15:31:38,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9257 secs
2025-03-13 15:31:38,808 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 15:31:38,809 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.32it/s]
2025-03-13 15:32:12,099 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2901 secs
2025-03-13 15:32:12,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.2996 secs
2025-03-13 15:32:12,104 [INFO]: {
2025-03-13 15:32:12,104 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:12,104 [INFO]: 	index_param: efSearch=308
2025-03-13 15:32:12,104 [INFO]: 	index_path: knn.index
2025-03-13 15:32:12,104 [INFO]: 	size in bytes: 943190770
2025-03-13 15:32:12,104 [INFO]: 	avg_search_speed_ms: 14.044317619592537
2025-03-13 15:32:12,104 [INFO]: 	99p_search_speed_ms: 23.31632888643071
2025-03-13 15:32:12,104 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:12,104 [INFO]: 	nb vectors: 4794
2025-03-13 15:32:12,104 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:12,104 [INFO]: 	compression ratio: 0.9993087103683171
2025-03-13 15:32:12,104 [INFO]: }
2025-03-13 15:32:12,104 [INFO]: 	>>> Finished "Creating the index" in 82.3014 secs
2025-03-13 15:32:12,104 [INFO]: >>> Finished "Launching the whole pipeline" in 82.3321 secs
2025-03-13 15:32:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 62299 [episode count 19/20]
2025-03-13 15:32:16: [retrieval_preprocessing] finished for 8098563998_close_coffee_maker [chosen_id count 1/196]
2025-03-13 15:32:20: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8098563998_open_coffee_maker [chosen_id count 2/196]
2025-03-13 15:32:20: [retrieval_preprocessing] we have num_total=5166 embedding_dim=49152
[retrieval_preprocessing] for episode 26128 [episode count 0/20], we have num_retrieval=np.int64(4886) num_query=np.int64(280)
2025-03-13 15:32:21,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:22,109 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:22
2025-03-13 15:32:22,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.88it/s]
2025-03-13 15:32:22,134 [INFO]: There are 4886 embeddings of dim 49152
2025-03-13 15:32:22,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:32:22,135 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:22
2025-03-13 15:32:22,135 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:22,135 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:32:22,135 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:22,135 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:22,135 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:22
2025-03-13 15:32:22,135 [INFO]: 1008.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:22,135 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:22,135 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:22
2025-03-13 15:32:22,135 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:22,135 [INFO]: 	Creating the index 03/13/2025, 15:32:22
2025-03-13 15:32:22,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:22
2025-03-13 15:32:22,137 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:32:22,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:22
2025-03-13 15:32:22,137 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:32:22,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.37it/s] 10%|█         | 2/20 [00:00<00:02,  7.01it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.94it/s] 20%|██        | 4/20 [00:00<00:01,  8.34it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.79it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.31it/s] 40%|████      | 8/20 [00:00<00:01,  8.96it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.58it/s] 50%|█████     | 10/20 [00:01<00:01,  8.31it/s] 60%|██████    | 12/20 [00:01<00:00,  9.05it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.15it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.47it/s] 80%|████████  | 16/20 [00:01<00:00,  9.51it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.48it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.93it/s]100%|██████████| 20/20 [00:06<00:00,  1.01it/s]100%|██████████| 20/20 [00:06<00:00,  3.27it/s]
2025-03-13 15:32:28,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:28
2025-03-13 15:33:29,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6301 secs
2025-03-13 15:33:29,894 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 15:33:29,895 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-13 15:34:13,260 [INFO]: 	>>> Finished "Compute fast metrics" in 43.3652 secs
2025-03-13 15:34:13,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.1278 secs
2025-03-13 15:34:13,265 [INFO]: {
2025-03-13 15:34:13,265 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:13,265 [INFO]: 	index_param: efSearch=233
2025-03-13 15:34:13,265 [INFO]: 	index_path: knn.index
2025-03-13 15:34:13,265 [INFO]: 	size in bytes: 961291210
2025-03-13 15:34:13,265 [INFO]: 	avg_search_speed_ms: 12.58716058782624
2025-03-13 15:34:13,265 [INFO]: 	99p_search_speed_ms: 22.95277232304213
2025-03-13 15:34:13,265 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:13,265 [INFO]: 	nb vectors: 4886
2025-03-13 15:34:13,265 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:13,265 [INFO]: 	compression ratio: 0.9993087193629909
2025-03-13 15:34:13,265 [INFO]: }
2025-03-13 15:34:13,265 [INFO]: 	>>> Finished "Creating the index" in 111.1293 secs
2025-03-13 15:34:13,265 [INFO]: >>> Finished "Launching the whole pipeline" in 111.1559 secs
2025-03-13 15:34:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 26128 [episode count 0/20]
[retrieval_preprocessing] for episode 35861 [episode count 1/20], we have num_retrieval=np.int64(5002) num_query=np.int64(164)
2025-03-13 15:34:18,464 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:19,352 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:19
2025-03-13 15:34:19,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1012.38it/s]
2025-03-13 15:34:19,380 [INFO]: There are 5002 embeddings of dim 49152
2025-03-13 15:34:19,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:34:19,381 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:19
2025-03-13 15:34:19,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:19,381 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:34:19,381 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:19,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:19,381 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:19
2025-03-13 15:34:19,381 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:19,381 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:19,381 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:19
2025-03-13 15:34:19,381 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:19,381 [INFO]: 	Creating the index 03/13/2025, 15:34:19
2025-03-13 15:34:19,381 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:19
2025-03-13 15:34:19,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:34:19,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:19
2025-03-13 15:34:19,383 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:34:19,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.55it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.93it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.53it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.62it/s] 40%|████      | 8/20 [00:00<00:01,  9.38it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.18it/s] 50%|█████     | 10/20 [00:01<00:01,  9.11it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.08it/s] 60%|██████    | 12/20 [00:01<00:00,  9.07it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.10it/s] 70%|███████   | 14/20 [00:01<00:00,  9.10it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.09it/s] 80%|████████  | 16/20 [00:01<00:00,  9.12it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.13it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.23it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.20it/s]100%|██████████| 20/20 [00:06<00:00,  1.30s/it]100%|██████████| 20/20 [00:06<00:00,  3.24it/s]
2025-03-13 15:34:25,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:25
2025-03-13 15:35:18,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9746 secs
2025-03-13 15:35:18,538 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 15:35:18,538 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.16it/s] 50%|█████     | 2/4 [00:00<00:00,  4.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.49it/s]
2025-03-13 15:35:49,901 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3635 secs
2025-03-13 15:35:49,905 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.5226 secs
2025-03-13 15:35:49,905 [INFO]: {
2025-03-13 15:35:49,905 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:49,905 [INFO]: 	index_param: efSearch=222
2025-03-13 15:35:49,905 [INFO]: 	index_path: knn.index
2025-03-13 15:35:49,905 [INFO]: 	size in bytes: 984113710
2025-03-13 15:35:49,905 [INFO]: 	avg_search_speed_ms: 9.057199833636252
2025-03-13 15:35:49,905 [INFO]: 	99p_search_speed_ms: 17.7542463131249
2025-03-13 15:35:49,905 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:49,905 [INFO]: 	nb vectors: 5002
2025-03-13 15:35:49,905 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:49,905 [INFO]: 	compression ratio: 0.9993085209634972
2025-03-13 15:35:49,905 [INFO]: }
2025-03-13 15:35:49,905 [INFO]: 	>>> Finished "Creating the index" in 90.5241 secs
2025-03-13 15:35:49,905 [INFO]: >>> Finished "Launching the whole pipeline" in 90.5530 secs
2025-03-13 15:35:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 35861 [episode count 1/20]
[retrieval_preprocessing] for episode 93725 [episode count 2/20], we have num_retrieval=np.int64(4995) num_query=np.int64(171)
2025-03-13 15:35:53,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:53,993 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:53
2025-03-13 15:35:53,993 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.07it/s]
2025-03-13 15:35:54,018 [INFO]: There are 4995 embeddings of dim 49152
2025-03-13 15:35:54,019 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:35:54,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:54
2025-03-13 15:35:54,019 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:54,019 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:35:54,019 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:54,019 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:35:54,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:54
2025-03-13 15:35:54,020 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:54,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:35:54,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:54
2025-03-13 15:35:54,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:54,020 [INFO]: 	Creating the index 03/13/2025, 15:35:54
2025-03-13 15:35:54,020 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:54
2025-03-13 15:35:54,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:35:54,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:54
2025-03-13 15:35:54,022 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:35:54,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.65it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.60it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.48it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.96it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.15it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.26it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.05it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.99it/s] 80%|████████  | 16/20 [00:01<00:00,  9.98it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.82it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.74it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.56it/s]100%|██████████| 20/20 [00:05<00:00,  1.07it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-13 15:35:59,264 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:59
2025-03-13 15:36:49,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.0042 secs
2025-03-13 15:36:49,269 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:36:49,269 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:16,  5.60s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.52s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.95s/it]
2025-03-13 15:37:28,581 [INFO]: 	>>> Finished "Compute fast metrics" in 39.3120 secs
2025-03-13 15:37:28,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5650 secs
2025-03-13 15:37:28,587 [INFO]: {
2025-03-13 15:37:28,587 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:28,587 [INFO]: 	index_param: efSearch=202
2025-03-13 15:37:28,587 [INFO]: 	index_path: knn.index
2025-03-13 15:37:28,587 [INFO]: 	size in bytes: 982736530
2025-03-13 15:37:28,587 [INFO]: 	avg_search_speed_ms: 9.85243860792754
2025-03-13 15:37:28,587 [INFO]: 	99p_search_speed_ms: 17.82386344391853
2025-03-13 15:37:28,587 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:28,587 [INFO]: 	nb vectors: 4995
2025-03-13 15:37:28,587 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:28,587 [INFO]: 	compression ratio: 0.9993084921754155
2025-03-13 15:37:28,587 [INFO]: }
2025-03-13 15:37:28,587 [INFO]: 	>>> Finished "Creating the index" in 94.5673 secs
2025-03-13 15:37:28,587 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5944 secs
2025-03-13 15:37:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 93725 [episode count 2/20]
[retrieval_preprocessing] for episode 8734 [episode count 3/20], we have num_retrieval=np.int64(4899) num_query=np.int64(267)
2025-03-13 15:37:32,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:33,947 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:33
2025-03-13 15:37:33,947 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 959.36it/s]
2025-03-13 15:37:33,973 [INFO]: There are 4899 embeddings of dim 49152
2025-03-13 15:37:33,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:37:33,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:33
2025-03-13 15:37:33,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:33,973 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:37:33,974 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:33,974 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:37:33,974 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:33
2025-03-13 15:37:33,974 [INFO]: 1011.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:33,974 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:33,974 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:33
2025-03-13 15:37:33,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:33,974 [INFO]: 	Creating the index 03/13/2025, 15:37:33
2025-03-13 15:37:33,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:33
2025-03-13 15:37:33,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:37:33,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:33
2025-03-13 15:37:33,975 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:37:33,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.85it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.74it/s] 20%|██        | 4/20 [00:00<00:01,  8.33it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.63it/s] 30%|███       | 6/20 [00:00<00:01,  8.66it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.69it/s] 40%|████      | 8/20 [00:00<00:01,  8.73it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.02it/s] 50%|█████     | 10/20 [00:01<00:01,  9.10it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.17it/s] 60%|██████    | 12/20 [00:01<00:00,  8.97it/s] 70%|███████   | 14/20 [00:01<00:00,  9.69it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.48it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.34it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.72it/s] 95%|█████████▌| 19/20 [00:02<00:00,  8.58it/s]100%|██████████| 20/20 [00:06<00:00,  1.25s/it]100%|██████████| 20/20 [00:06<00:00,  3.01it/s]
2025-03-13 15:37:40,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:40
2025-03-13 15:38:29,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7093 secs
2025-03-13 15:38:29,336 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:38:29,336 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.49it/s] 50%|█████     | 2/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 15:39:23,043 [INFO]: 	>>> Finished "Compute fast metrics" in 53.7064 secs
2025-03-13 15:39:23,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.0709 secs
2025-03-13 15:39:23,046 [INFO]: {
2025-03-13 15:39:23,046 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:23,046 [INFO]: 	index_param: efSearch=217
2025-03-13 15:39:23,046 [INFO]: 	index_path: knn.index
2025-03-13 15:39:23,047 [INFO]: 	size in bytes: 963848830
2025-03-13 15:39:23,047 [INFO]: 	avg_search_speed_ms: 9.872033287424443
2025-03-13 15:39:23,047 [INFO]: 	99p_search_speed_ms: 14.195195408537984
2025-03-13 15:39:23,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:23,047 [INFO]: 	nb vectors: 4899
2025-03-13 15:39:23,047 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:23,047 [INFO]: 	compression ratio: 0.9993087733477873
2025-03-13 15:39:23,047 [INFO]: }
2025-03-13 15:39:23,047 [INFO]: 	>>> Finished "Creating the index" in 109.0727 secs
2025-03-13 15:39:23,047 [INFO]: >>> Finished "Launching the whole pipeline" in 109.0997 secs
2025-03-13 15:39:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 8734 [episode count 3/20]
[retrieval_preprocessing] for episode 90169 [episode count 4/20], we have num_retrieval=np.int64(5022) num_query=np.int64(144)
2025-03-13 15:39:27,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:28,214 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:28
2025-03-13 15:39:28,214 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.83it/s]
2025-03-13 15:39:28,235 [INFO]: There are 5022 embeddings of dim 49152
2025-03-13 15:39:28,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0214 secs
2025-03-13 15:39:28,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:28,236 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 15:39:28,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:28,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:28,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,236 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:28,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:39:28,236 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:28
2025-03-13 15:39:28,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:28,236 [INFO]: 	Creating the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,236 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:28
2025-03-13 15:39:28,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:39:28,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:28
2025-03-13 15:39:28,237 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:39:28,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.33it/s] 10%|█         | 2/20 [00:00<00:02,  6.18it/s] 20%|██        | 4/20 [00:00<00:01,  9.46it/s] 30%|███       | 6/20 [00:00<00:01, 10.59it/s] 40%|████      | 8/20 [00:00<00:01, 10.53it/s] 50%|█████     | 10/20 [00:00<00:00, 11.56it/s] 60%|██████    | 12/20 [00:01<00:00, 12.32it/s] 70%|███████   | 14/20 [00:01<00:00, 12.75it/s] 80%|████████  | 16/20 [00:01<00:00, 13.36it/s] 90%|█████████ | 18/20 [00:01<00:00, 13.41it/s]100%|██████████| 20/20 [00:06<00:00,  1.17it/s]100%|██████████| 20/20 [00:06<00:00,  2.96it/s]
2025-03-13 15:39:35,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:35
2025-03-13 15:40:21,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7075 secs
2025-03-13 15:40:21,722 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:40:21,722 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.28it/s] 50%|█████     | 2/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.32it/s]
2025-03-13 15:40:54,936 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2138 secs
2025-03-13 15:40:54,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7023 secs
2025-03-13 15:40:54,940 [INFO]: {
2025-03-13 15:40:54,940 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:54,940 [INFO]: 	index_param: efSearch=214
2025-03-13 15:40:54,940 [INFO]: 	index_path: knn.index
2025-03-13 15:40:54,940 [INFO]: 	size in bytes: 988048570
2025-03-13 15:40:54,940 [INFO]: 	avg_search_speed_ms: 11.161877882841509
2025-03-13 15:40:54,940 [INFO]: 	99p_search_speed_ms: 20.404567825607952
2025-03-13 15:40:54,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:54,940 [INFO]: 	nb vectors: 5022
2025-03-13 15:40:54,940 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:54,940 [INFO]: 	compression ratio: 0.9993085420891809
2025-03-13 15:40:54,940 [INFO]: }
2025-03-13 15:40:54,940 [INFO]: 	>>> Finished "Creating the index" in 86.7038 secs
2025-03-13 15:40:54,940 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7257 secs
2025-03-13 15:40:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 90169 [episode count 4/20]
[retrieval_preprocessing] for episode 86617 [episode count 5/20], we have num_retrieval=np.int64(4998) num_query=np.int64(168)
2025-03-13 15:40:58,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:59,811 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:59
2025-03-13 15:40:59,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 905.51it/s]
2025-03-13 15:40:59,837 [INFO]: There are 4998 embeddings of dim 49152
2025-03-13 15:40:59,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:40:59,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:59
2025-03-13 15:40:59,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:59,838 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:40:59,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:59,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:59,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:59
2025-03-13 15:40:59,838 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:59,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:40:59,838 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:59
2025-03-13 15:40:59,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:59,838 [INFO]: 	Creating the index 03/13/2025, 15:40:59
2025-03-13 15:40:59,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:59
2025-03-13 15:40:59,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:40:59,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:59
2025-03-13 15:40:59,839 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:40:59,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.07it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.93it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.99it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.72it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.84it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.91it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.32it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.51it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.63it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.82it/s]100%|██████████| 20/20 [00:05<00:00,  3.62it/s]
2025-03-13 15:41:05,382 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:05
2025-03-13 15:42:06,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3234 secs
2025-03-13 15:42:06,706 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:42:06,706 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 15:42:33,884 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1774 secs
2025-03-13 15:42:33,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.0481 secs
2025-03-13 15:42:33,888 [INFO]: {
2025-03-13 15:42:33,888 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:33,888 [INFO]: 	index_param: efSearch=179
2025-03-13 15:42:33,888 [INFO]: 	index_path: knn.index
2025-03-13 15:42:33,888 [INFO]: 	size in bytes: 983326750
2025-03-13 15:42:33,888 [INFO]: 	avg_search_speed_ms: 9.28255559672483
2025-03-13 15:42:33,888 [INFO]: 	99p_search_speed_ms: 15.883709751069546
2025-03-13 15:42:33,888 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:33,888 [INFO]: 	nb vectors: 4998
2025-03-13 15:42:33,888 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:33,888 [INFO]: 	compression ratio: 0.9993085045230388
2025-03-13 15:42:33,888 [INFO]: }
2025-03-13 15:42:33,888 [INFO]: 	>>> Finished "Creating the index" in 94.0497 secs
2025-03-13 15:42:33,888 [INFO]: >>> Finished "Launching the whole pipeline" in 94.0768 secs
2025-03-13 15:42:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 86617 [episode count 5/20]
[retrieval_preprocessing] for episode 46697 [episode count 6/20], we have num_retrieval=np.int64(4885) num_query=np.int64(281)
2025-03-13 15:42:37,022 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:37,775 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:37
2025-03-13 15:42:37,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1992.54it/s]
2025-03-13 15:42:37,798 [INFO]: There are 4885 embeddings of dim 49152
2025-03-13 15:42:37,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 15:42:37,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:37
2025-03-13 15:42:37,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:37,799 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:42:37,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:37,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:42:37,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:37
2025-03-13 15:42:37,799 [INFO]: 1008.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:37,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:42:37,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:37
2025-03-13 15:42:37,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:37,799 [INFO]: 	Creating the index 03/13/2025, 15:42:37
2025-03-13 15:42:37,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:37
2025-03-13 15:42:37,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:42:37,800 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:37
2025-03-13 15:42:37,800 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:42:37,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.33it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.90it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.08it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.15it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.13it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.09it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.41it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.76it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.06it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.21it/s]100%|██████████| 20/20 [00:05<00:00,  3.83it/s]
2025-03-13 15:42:43,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:43
2025-03-13 15:43:40,129 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1009 secs
2025-03-13 15:43:40,129 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 15:43:40,129 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 15:44:05,294 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1648 secs
2025-03-13 15:44:05,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4977 secs
2025-03-13 15:44:05,298 [INFO]: {
2025-03-13 15:44:05,298 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:05,298 [INFO]: 	index_param: efSearch=194
2025-03-13 15:44:05,298 [INFO]: 	index_path: knn.index
2025-03-13 15:44:05,298 [INFO]: 	size in bytes: 961094470
2025-03-13 15:44:05,298 [INFO]: 	avg_search_speed_ms: 9.878174605891624
2025-03-13 15:44:05,298 [INFO]: 	99p_search_speed_ms: 19.689494995400302
2025-03-13 15:44:05,298 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:05,298 [INFO]: 	nb vectors: 4885
2025-03-13 15:44:05,298 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:05,298 [INFO]: 	compression ratio: 0.9993087151984134
2025-03-13 15:44:05,298 [INFO]: }
2025-03-13 15:44:05,298 [INFO]: 	>>> Finished "Creating the index" in 87.4992 secs
2025-03-13 15:44:05,298 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5232 secs
2025-03-13 15:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 46697 [episode count 6/20]
[retrieval_preprocessing] for episode 20590 [episode count 7/20], we have num_retrieval=np.int64(4882) num_query=np.int64(284)
2025-03-13 15:44:09,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:10,026 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:10
2025-03-13 15:44:10,026 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.04it/s]
2025-03-13 15:44:10,051 [INFO]: There are 4882 embeddings of dim 49152
2025-03-13 15:44:10,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:44:10,052 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:10
2025-03-13 15:44:10,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:10,052 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:44:10,052 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:10,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:10,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:10
2025-03-13 15:44:10,052 [INFO]: 1007.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:10,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:44:10,052 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:10
2025-03-13 15:44:10,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:10,052 [INFO]: 	Creating the index 03/13/2025, 15:44:10
2025-03-13 15:44:10,052 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:10
2025-03-13 15:44:10,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:44:10,053 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:10
2025-03-13 15:44:10,053 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:44:10,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.69it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.46it/s] 20%|██        | 4/20 [00:00<00:01,  8.04it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.03it/s] 30%|███       | 6/20 [00:00<00:01,  7.85it/s] 35%|███▌      | 7/20 [00:00<00:01,  7.73it/s] 40%|████      | 8/20 [00:01<00:01,  7.72it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.27it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.73it/s] 60%|██████    | 12/20 [00:01<00:00,  8.41it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.20it/s] 70%|███████   | 14/20 [00:01<00:00,  8.03it/s] 75%|███████▌  | 15/20 [00:01<00:00,  6.88it/s] 85%|████████▌ | 17/20 [00:02<00:00,  8.34it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.24it/s]100%|██████████| 20/20 [00:05<00:00,  3.46it/s]
2025-03-13 15:44:15,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:15
2025-03-13 15:45:06,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2832 secs
2025-03-13 15:45:06,114 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:45:06,115 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-13 15:45:43,915 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8008 secs
2025-03-13 15:45:43,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.8675 secs
2025-03-13 15:45:43,921 [INFO]: {
2025-03-13 15:45:43,921 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:43,921 [INFO]: 	index_param: efSearch=202
2025-03-13 15:45:43,921 [INFO]: 	index_path: knn.index
2025-03-13 15:45:43,921 [INFO]: 	size in bytes: 960504250
2025-03-13 15:45:43,921 [INFO]: 	avg_search_speed_ms: 12.23277541823585
2025-03-13 15:45:43,921 [INFO]: 	99p_search_speed_ms: 19.85430132597685
2025-03-13 15:45:43,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:43,921 [INFO]: 	nb vectors: 4882
2025-03-13 15:45:43,921 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:43,921 [INFO]: 	compression ratio: 0.999308702694444
2025-03-13 15:45:43,921 [INFO]: }
2025-03-13 15:45:43,921 [INFO]: 	>>> Finished "Creating the index" in 93.8689 secs
2025-03-13 15:45:43,921 [INFO]: >>> Finished "Launching the whole pipeline" in 93.8950 secs
2025-03-13 15:45:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 20590 [episode count 7/20]
[retrieval_preprocessing] for episode 45141 [episode count 8/20], we have num_retrieval=np.int64(4945) num_query=np.int64(221)
2025-03-13 15:45:49,492 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:50,525 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:50
2025-03-13 15:45:50,525 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 15:45:50,551 [INFO]: There are 4945 embeddings of dim 49152
2025-03-13 15:45:50,551 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:45:50,552 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:50
2025-03-13 15:45:50,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:50,552 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:45:50,552 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:50,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:45:50,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:50
2025-03-13 15:45:50,552 [INFO]: 1020.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:50,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:45:50,552 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:50
2025-03-13 15:45:50,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:50,552 [INFO]: 	Creating the index 03/13/2025, 15:45:50
2025-03-13 15:45:50,552 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:50
2025-03-13 15:45:50,553 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:45:50,553 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:50
2025-03-13 15:45:50,553 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:45:50,553 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.01it/s] 10%|█         | 2/20 [00:00<00:02,  6.85it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.92it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.89it/s] 30%|███       | 6/20 [00:00<00:01,  9.13it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.37it/s] 40%|████      | 8/20 [00:00<00:01,  9.51it/s] 50%|█████     | 10/20 [00:01<00:01,  9.80it/s] 60%|██████    | 12/20 [00:01<00:00,  9.93it/s] 70%|███████   | 14/20 [00:01<00:00, 10.15it/s] 80%|████████  | 16/20 [00:01<00:00, 10.56it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.46it/s]100%|██████████| 20/20 [00:05<00:00,  1.41it/s]100%|██████████| 20/20 [00:05<00:00,  3.39it/s]
2025-03-13 15:45:56,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:56
2025-03-13 15:46:45,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2320 secs
2025-03-13 15:46:45,696 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:46:45,696 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 15:47:17,583 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8862 secs
2025-03-13 15:47:17,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0333 secs
2025-03-13 15:47:17,587 [INFO]: {
2025-03-13 15:47:17,587 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:17,587 [INFO]: 	index_param: efSearch=179
2025-03-13 15:47:17,587 [INFO]: 	index_path: knn.index
2025-03-13 15:47:17,587 [INFO]: 	size in bytes: 972899170
2025-03-13 15:47:17,587 [INFO]: 	avg_search_speed_ms: 9.12229535016945
2025-03-13 15:47:17,587 [INFO]: 	99p_search_speed_ms: 15.082502563018348
2025-03-13 15:47:17,587 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:17,587 [INFO]: 	nb vectors: 4945
2025-03-13 15:47:17,587 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:17,587 [INFO]: 	compression ratio: 0.9993086539481784
2025-03-13 15:47:17,587 [INFO]: }
2025-03-13 15:47:17,587 [INFO]: 	>>> Finished "Creating the index" in 87.0350 secs
2025-03-13 15:47:17,587 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0623 secs
2025-03-13 15:47:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 45141 [episode count 8/20]
[retrieval_preprocessing] for episode 29325 [episode count 9/20], we have num_retrieval=np.int64(4797) num_query=np.int64(369)
2025-03-13 15:47:21,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:22,410 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:22
2025-03-13 15:47:22,410 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.06it/s]
2025-03-13 15:47:22,435 [INFO]: There are 4797 embeddings of dim 49152
2025-03-13 15:47:22,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:47:22,435 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:22
2025-03-13 15:47:22,435 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:22,435 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:47:22,435 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:22,435 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:22,435 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:22
2025-03-13 15:47:22,435 [INFO]: 990.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:22,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:47:22,435 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:22
2025-03-13 15:47:22,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:22,436 [INFO]: 	Creating the index 03/13/2025, 15:47:22
2025-03-13 15:47:22,436 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:22
2025-03-13 15:47:22,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:47:22,437 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:22
2025-03-13 15:47:22,437 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:47:22,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.05it/s] 16%|█▌        | 3/19 [00:00<00:01, 10.16it/s] 26%|██▋       | 5/19 [00:00<00:01, 11.67it/s] 37%|███▋      | 7/19 [00:00<00:00, 12.54it/s] 47%|████▋     | 9/19 [00:00<00:00, 13.24it/s] 58%|█████▊    | 11/19 [00:00<00:00, 13.79it/s] 68%|██████▊   | 13/19 [00:01<00:00, 14.26it/s] 79%|███████▉  | 15/19 [00:01<00:00, 14.66it/s] 89%|████████▉ | 17/19 [00:01<00:00, 14.82it/s]100%|██████████| 19/19 [00:05<00:00,  1.41it/s]100%|██████████| 19/19 [00:05<00:00,  3.43it/s]
2025-03-13 15:47:27,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:27
2025-03-13 15:48:20,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.0324 secs
2025-03-13 15:48:20,026 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:48:20,026 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.71it/s]
2025-03-13 15:48:58,981 [INFO]: 	>>> Finished "Compute fast metrics" in 38.9548 secs
2025-03-13 15:48:58,985 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.5480 secs
2025-03-13 15:48:58,985 [INFO]: {
2025-03-13 15:48:58,985 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:58,985 [INFO]: 	index_param: efSearch=221
2025-03-13 15:48:58,985 [INFO]: 	index_path: knn.index
2025-03-13 15:48:58,985 [INFO]: 	size in bytes: 943780990
2025-03-13 15:48:58,985 [INFO]: 	avg_search_speed_ms: 10.868378925521899
2025-03-13 15:48:58,985 [INFO]: 	99p_search_speed_ms: 17.46497757965699
2025-03-13 15:48:58,985 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:58,985 [INFO]: 	nb vectors: 4797
2025-03-13 15:48:58,985 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:58,985 [INFO]: 	compression ratio: 0.9993087230968701
2025-03-13 15:48:58,985 [INFO]: }
2025-03-13 15:48:58,985 [INFO]: 	>>> Finished "Creating the index" in 96.5495 secs
2025-03-13 15:48:58,985 [INFO]: >>> Finished "Launching the whole pipeline" in 96.5754 secs
2025-03-13 15:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 29325 [episode count 9/20]
[retrieval_preprocessing] for episode 78663 [episode count 10/20], we have num_retrieval=np.int64(4812) num_query=np.int64(354)
2025-03-13 15:49:05,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:06,718 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:06
2025-03-13 15:49:06,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.54it/s]
2025-03-13 15:49:06,745 [INFO]: There are 4812 embeddings of dim 49152
2025-03-13 15:49:06,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:49:06,746 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:06
2025-03-13 15:49:06,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:06,746 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 15:49:06,746 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:06,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:49:06,746 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:06
2025-03-13 15:49:06,747 [INFO]: 993.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:06,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:49:06,747 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:06
2025-03-13 15:49:06,747 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:06,747 [INFO]: 	Creating the index 03/13/2025, 15:49:06
2025-03-13 15:49:06,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:06
2025-03-13 15:49:06,750 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:49:06,750 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:06
2025-03-13 15:49:06,750 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:49:06,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:04,  4.06it/s] 11%|█         | 2/19 [00:00<00:03,  5.19it/s] 16%|█▌        | 3/19 [00:00<00:02,  6.28it/s] 26%|██▋       | 5/19 [00:00<00:01,  9.45it/s] 37%|███▋      | 7/19 [00:00<00:01, 11.36it/s] 47%|████▋     | 9/19 [00:00<00:00, 11.00it/s] 58%|█████▊    | 11/19 [00:01<00:00, 10.11it/s] 68%|██████▊   | 13/19 [00:01<00:00, 10.15it/s] 79%|███████▉  | 15/19 [00:01<00:00, 10.42it/s] 89%|████████▉ | 17/19 [00:01<00:00, 10.71it/s]100%|██████████| 19/19 [00:05<00:00,  1.49it/s]100%|██████████| 19/19 [00:05<00:00,  3.36it/s]
2025-03-13 15:49:12,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:12
2025-03-13 15:50:04,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5553 secs
2025-03-13 15:50:04,972 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 15:50:04,972 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-13 15:50:31,866 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8945 secs
2025-03-13 15:50:31,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.1200 secs
2025-03-13 15:50:31,870 [INFO]: {
2025-03-13 15:50:31,870 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:31,870 [INFO]: 	index_param: efSearch=206
2025-03-13 15:50:31,870 [INFO]: 	index_path: knn.index
2025-03-13 15:50:31,871 [INFO]: 	size in bytes: 946732210
2025-03-13 15:50:31,871 [INFO]: 	avg_search_speed_ms: 12.15335722013466
2025-03-13 15:50:31,871 [INFO]: 	99p_search_speed_ms: 20.55086985230446
2025-03-13 15:50:31,871 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:31,871 [INFO]: 	nb vectors: 4812
2025-03-13 15:50:31,871 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:31,871 [INFO]: 	compression ratio: 0.9993086598374
2025-03-13 15:50:31,871 [INFO]: }
2025-03-13 15:50:31,871 [INFO]: 	>>> Finished "Creating the index" in 85.1231 secs
2025-03-13 15:50:31,871 [INFO]: >>> Finished "Launching the whole pipeline" in 85.1530 secs
2025-03-13 15:50:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 78663 [episode count 10/20]
[retrieval_preprocessing] for episode 93444 [episode count 11/20], we have num_retrieval=np.int64(4878) num_query=np.int64(288)
2025-03-13 15:50:38,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:39,137 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:39
2025-03-13 15:50:39,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.07it/s]
2025-03-13 15:50:39,165 [INFO]: There are 4878 embeddings of dim 49152
2025-03-13 15:50:39,166 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:50:39,166 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:39
2025-03-13 15:50:39,166 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:39,166 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:50:39,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:39,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:50:39,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:39
2025-03-13 15:50:39,166 [INFO]: 1006.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:39,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:50:39,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:39
2025-03-13 15:50:39,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:39,167 [INFO]: 	Creating the index 03/13/2025, 15:50:39
2025-03-13 15:50:39,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:39
2025-03-13 15:50:39,169 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:50:39,169 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:39
2025-03-13 15:50:39,170 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:50:39,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.50it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.13it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.89it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.09it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.14it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.63it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.20it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.01it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.65it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.57it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.36it/s]100%|██████████| 20/20 [00:07<00:00,  1.37s/it]100%|██████████| 20/20 [00:07<00:00,  2.66it/s]
2025-03-13 15:50:46,684 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:46
2025-03-13 15:51:43,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5057 secs
2025-03-13 15:51:43,190 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:51:43,191 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.60it/s] 50%|█████     | 2/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 15:52:08,094 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9038 secs
2025-03-13 15:52:08,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.9290 secs
2025-03-13 15:52:08,099 [INFO]: {
2025-03-13 15:52:08,099 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:08,099 [INFO]: 	index_param: efSearch=189
2025-03-13 15:52:08,099 [INFO]: 	index_path: knn.index
2025-03-13 15:52:08,099 [INFO]: 	size in bytes: 959717290
2025-03-13 15:52:08,099 [INFO]: 	avg_search_speed_ms: 9.235029108177386
2025-03-13 15:52:08,099 [INFO]: 	99p_search_speed_ms: 14.086710126139224
2025-03-13 15:52:08,099 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:08,099 [INFO]: 	nb vectors: 4878
2025-03-13 15:52:08,099 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:08,099 [INFO]: 	compression ratio: 0.9993086859985612
2025-03-13 15:52:08,099 [INFO]: }
2025-03-13 15:52:08,099 [INFO]: 	>>> Finished "Creating the index" in 88.9318 secs
2025-03-13 15:52:08,099 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9615 secs
2025-03-13 15:52:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 93444 [episode count 11/20]
[retrieval_preprocessing] for episode 88853 [episode count 12/20], we have num_retrieval=np.int64(4900) num_query=np.int64(266)
2025-03-13 15:52:13,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:14,472 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:14
2025-03-13 15:52:14,473 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.12it/s]
2025-03-13 15:52:14,498 [INFO]: There are 4900 embeddings of dim 49152
2025-03-13 15:52:14,498 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:52:14,498 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:14
2025-03-13 15:52:14,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:14,498 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:52:14,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:14,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:14,498 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:14
2025-03-13 15:52:14,499 [INFO]: 1011.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:14,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:52:14,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:14
2025-03-13 15:52:14,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:14,499 [INFO]: 	Creating the index 03/13/2025, 15:52:14
2025-03-13 15:52:14,499 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:14
2025-03-13 15:52:14,500 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:52:14,500 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:14
2025-03-13 15:52:14,500 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:52:14,500 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.74it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.18it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.34it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.77it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.99it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.90it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.92it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.93it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.42it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.14it/s]100%|██████████| 20/20 [00:05<00:00,  3.47it/s]
2025-03-13 15:52:20,270 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:20
2025-03-13 15:53:15,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9414 secs
2025-03-13 15:53:15,212 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 15:53:15,212 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:12,  4.02s/it] 50%|█████     | 2/4 [00:04<00:03,  1.95s/it] 75%|███████▌  | 3/4 [00:06<00:01,  1.94s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.37s/it]
2025-03-13 15:53:52,475 [INFO]: 	>>> Finished "Compute fast metrics" in 37.2636 secs
2025-03-13 15:53:52,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.9801 secs
2025-03-13 15:53:52,480 [INFO]: {
2025-03-13 15:53:52,480 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:52,480 [INFO]: 	index_param: efSearch=221
2025-03-13 15:53:52,480 [INFO]: 	index_path: knn.index
2025-03-13 15:53:52,480 [INFO]: 	size in bytes: 964045570
2025-03-13 15:53:52,480 [INFO]: 	avg_search_speed_ms: 10.855910573033343
2025-03-13 15:53:52,480 [INFO]: 	99p_search_speed_ms: 17.081374302506433
2025-03-13 15:53:52,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:52,480 [INFO]: 	nb vectors: 4900
2025-03-13 15:53:52,480 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:52,480 [INFO]: 	compression ratio: 0.9993087774885995
2025-03-13 15:53:52,480 [INFO]: }
2025-03-13 15:53:52,480 [INFO]: 	>>> Finished "Creating the index" in 97.9817 secs
2025-03-13 15:53:52,480 [INFO]: >>> Finished "Launching the whole pipeline" in 98.0079 secs
2025-03-13 15:53:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 88853 [episode count 12/20]
[retrieval_preprocessing] for episode 48933 [episode count 13/20], we have num_retrieval=np.int64(5006) num_query=np.int64(160)
2025-03-13 15:53:56,678 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:57,569 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:57
2025-03-13 15:53:57,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1585.15it/s]
2025-03-13 15:53:57,592 [INFO]: There are 5006 embeddings of dim 49152
2025-03-13 15:53:57,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 15:53:57,592 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:57
2025-03-13 15:53:57,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:57,593 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:53:57,593 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:57,593 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:57,593 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:57
2025-03-13 15:53:57,593 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:57,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:53:57,593 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:57
2025-03-13 15:53:57,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:57,593 [INFO]: 	Creating the index 03/13/2025, 15:53:57
2025-03-13 15:53:57,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:57
2025-03-13 15:53:57,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:53:57,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:57
2025-03-13 15:53:57,594 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:53:57,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.32it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.71it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.33it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.29it/s] 45%|████▌     | 9/20 [00:00<00:01,  8.98it/s] 50%|█████     | 10/20 [00:01<00:01,  8.47it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.41it/s] 60%|██████    | 12/20 [00:01<00:00,  8.52it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.56it/s] 70%|███████   | 14/20 [00:01<00:00,  8.81it/s] 80%|████████  | 16/20 [00:01<00:00,  9.11it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.82it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.48it/s]100%|██████████| 20/20 [00:05<00:00,  1.17it/s]100%|██████████| 20/20 [00:05<00:00,  3.61it/s]
2025-03-13 15:54:03,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:03
2025-03-13 15:54:56,323 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1744 secs
2025-03-13 15:54:56,324 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:54:56,324 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.29it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.03it/s]
2025-03-13 15:55:36,015 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6914 secs
2025-03-13 15:55:36,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.4257 secs
2025-03-13 15:55:36,020 [INFO]: {
2025-03-13 15:55:36,020 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:36,020 [INFO]: 	index_param: efSearch=187
2025-03-13 15:55:36,020 [INFO]: 	index_path: knn.index
2025-03-13 15:55:36,020 [INFO]: 	size in bytes: 984900670
2025-03-13 15:55:36,020 [INFO]: 	avg_search_speed_ms: 8.370705650511459
2025-03-13 15:55:36,020 [INFO]: 	99p_search_speed_ms: 11.72307051718235
2025-03-13 15:55:36,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:36,020 [INFO]: 	nb vectors: 5006
2025-03-13 15:55:36,020 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:36,020 [INFO]: 	compression ratio: 0.999308537377683
2025-03-13 15:55:36,020 [INFO]: }
2025-03-13 15:55:36,020 [INFO]: 	>>> Finished "Creating the index" in 98.4271 secs
2025-03-13 15:55:36,020 [INFO]: >>> Finished "Launching the whole pipeline" in 98.4512 secs
2025-03-13 15:55:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 48933 [episode count 13/20]
[retrieval_preprocessing] for episode 80172 [episode count 14/20], we have num_retrieval=np.int64(4848) num_query=np.int64(318)
2025-03-13 15:55:39,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:40,232 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:40
2025-03-13 15:55:40,232 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1884.23it/s]
2025-03-13 15:55:40,257 [INFO]: There are 4848 embeddings of dim 49152
2025-03-13 15:55:40,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 15:55:40,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:40,257 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:55:40,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:40,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:40,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,257 [INFO]: 1000.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:40,257 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:55:40,257 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:40
2025-03-13 15:55:40,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:40,257 [INFO]: 	Creating the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,258 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:40
2025-03-13 15:55:40,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:55:40,259 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:40
2025-03-13 15:55:40,259 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:55:40,259 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.36it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.13it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.74it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.31it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.48it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.35it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.14it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.43it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.42it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.43it/s]100%|██████████| 20/20 [00:08<00:00,  2.49it/s]
2025-03-13 15:55:48,295 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:48
2025-03-13 15:56:39,559 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2639 secs
2025-03-13 15:56:39,559 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:56:39,559 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-13 15:57:11,080 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5206 secs
2025-03-13 15:57:11,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8249 secs
2025-03-13 15:57:11,084 [INFO]: {
2025-03-13 15:57:11,084 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:11,084 [INFO]: 	index_param: efSearch=212
2025-03-13 15:57:11,084 [INFO]: 	index_path: knn.index
2025-03-13 15:57:11,084 [INFO]: 	size in bytes: 953815030
2025-03-13 15:57:11,084 [INFO]: 	avg_search_speed_ms: 9.715136096915058
2025-03-13 15:57:11,084 [INFO]: 	99p_search_speed_ms: 16.538246311247352
2025-03-13 15:57:11,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:11,084 [INFO]: 	nb vectors: 4848
2025-03-13 15:57:11,084 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:11,084 [INFO]: 	compression ratio: 0.9993086227630529
2025-03-13 15:57:11,084 [INFO]: }
2025-03-13 15:57:11,084 [INFO]: 	>>> Finished "Creating the index" in 90.8263 secs
2025-03-13 15:57:11,084 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8519 secs
2025-03-13 15:57:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 80172 [episode count 14/20]
[retrieval_preprocessing] for episode 9007 [episode count 15/20], we have num_retrieval=np.int64(4844) num_query=np.int64(322)
2025-03-13 15:57:16,082 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:16,833 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:16
2025-03-13 15:57:16,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2019.40it/s]
2025-03-13 15:57:16,860 [INFO]: There are 4844 embeddings of dim 49152
2025-03-13 15:57:16,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 15:57:16,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:16,861 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 15:57:16,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:16,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:57:16,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,862 [INFO]: 999.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:16,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:57:16,863 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:16
2025-03-13 15:57:16,863 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:16,863 [INFO]: 	Creating the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,863 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:16
2025-03-13 15:57:16,865 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:57:16,865 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:16
2025-03-13 15:57:16,866 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:57:16,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:05,  3.64it/s] 10%|█         | 2/20 [00:00<00:03,  5.62it/s] 15%|█▌        | 3/20 [00:00<00:02,  6.99it/s] 20%|██        | 4/20 [00:00<00:02,  7.80it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.33it/s] 30%|███       | 6/20 [00:00<00:01,  8.79it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.97it/s] 40%|████      | 8/20 [00:01<00:01,  9.13it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.34it/s] 50%|█████     | 10/20 [00:01<00:01,  9.38it/s] 60%|██████    | 12/20 [00:01<00:00,  9.83it/s] 70%|███████   | 14/20 [00:01<00:00,  9.95it/s] 80%|████████  | 16/20 [00:01<00:00, 10.07it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.54it/s]100%|██████████| 20/20 [00:05<00:00,  1.49it/s]100%|██████████| 20/20 [00:05<00:00,  3.52it/s]
2025-03-13 15:57:22,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:22
2025-03-13 15:58:12,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9587 secs
2025-03-13 15:58:12,509 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 15:58:12,509 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 15:58:56,350 [INFO]: 	>>> Finished "Compute fast metrics" in 43.8404 secs
2025-03-13 15:58:56,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.4879 secs
2025-03-13 15:58:56,354 [INFO]: {
2025-03-13 15:58:56,354 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:56,354 [INFO]: 	index_param: efSearch=219
2025-03-13 15:58:56,354 [INFO]: 	index_path: knn.index
2025-03-13 15:58:56,354 [INFO]: 	size in bytes: 953028070
2025-03-13 15:58:56,354 [INFO]: 	avg_search_speed_ms: 11.853940026300531
2025-03-13 15:58:56,354 [INFO]: 	99p_search_speed_ms: 21.22962292982265
2025-03-13 15:58:56,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:56,354 [INFO]: 	nb vectors: 4844
2025-03-13 15:58:56,354 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:56,354 [INFO]: 	compression ratio: 0.9993086058839799
2025-03-13 15:58:56,354 [INFO]: }
2025-03-13 15:58:56,354 [INFO]: 	>>> Finished "Creating the index" in 99.4907 secs
2025-03-13 15:58:56,354 [INFO]: >>> Finished "Launching the whole pipeline" in 99.5204 secs
2025-03-13 15:58:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 9007 [episode count 15/20]
[retrieval_preprocessing] for episode 75601 [episode count 16/20], we have num_retrieval=np.int64(5052) num_query=np.int64(114)
2025-03-13 15:59:01,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:01,877 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:01
2025-03-13 15:59:01,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1200.09it/s]
2025-03-13 15:59:02,189 [INFO]: There are 5052 embeddings of dim 49152
2025-03-13 15:59:02,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3118 secs
2025-03-13 15:59:02,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:02
2025-03-13 15:59:02,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:02,189 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 15:59:02,190 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:02,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:59:02,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:02
2025-03-13 15:59:02,190 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:02,190 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:59:02,190 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:02
2025-03-13 15:59:02,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:02,191 [INFO]: 	Creating the index 03/13/2025, 15:59:02
2025-03-13 15:59:02,191 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:02
2025-03-13 15:59:02,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:59:02,193 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:02
2025-03-13 15:59:02,193 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 15:59:02,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:05,  3.47it/s] 10%|█         | 2/20 [00:00<00:03,  4.58it/s] 20%|██        | 4/20 [00:00<00:02,  7.04it/s] 30%|███       | 6/20 [00:00<00:01,  8.22it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.61it/s] 40%|████      | 8/20 [00:01<00:01,  8.89it/s] 50%|█████     | 10/20 [00:01<00:01,  9.34it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.42it/s] 60%|██████    | 12/20 [00:01<00:00,  9.51it/s] 70%|███████   | 14/20 [00:01<00:00,  9.94it/s] 80%|████████  | 16/20 [00:01<00:00, 10.33it/s] 90%|█████████ | 18/20 [00:02<00:00, 10.60it/s]100%|██████████| 20/20 [00:06<00:00,  1.26it/s]100%|██████████| 20/20 [00:06<00:00,  3.11it/s]
2025-03-13 15:59:08,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:08
2025-03-13 16:00:01,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9452 secs
2025-03-13 16:00:01,575 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:00:01,575 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 16:00:29,786 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2103 secs
2025-03-13 16:00:29,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5965 secs
2025-03-13 16:00:29,790 [INFO]: {
2025-03-13 16:00:29,790 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:29,790 [INFO]: 	index_param: efSearch=187
2025-03-13 16:00:29,790 [INFO]: 	index_path: knn.index
2025-03-13 16:00:29,790 [INFO]: 	size in bytes: 993951010
2025-03-13 16:00:29,790 [INFO]: 	avg_search_speed_ms: 9.98188530238059
2025-03-13 16:00:29,790 [INFO]: 	99p_search_speed_ms: 18.919339543208483
2025-03-13 16:00:29,790 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:29,790 [INFO]: 	nb vectors: 5052
2025-03-13 16:00:29,790 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:29,790 [INFO]: 	compression ratio: 0.9993084226555593
2025-03-13 16:00:29,790 [INFO]: }
2025-03-13 16:00:29,790 [INFO]: 	>>> Finished "Creating the index" in 87.5995 secs
2025-03-13 16:00:29,790 [INFO]: >>> Finished "Launching the whole pipeline" in 87.9128 secs
2025-03-13 16:00:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 75601 [episode count 16/20]
[retrieval_preprocessing] for episode 14661 [episode count 17/20], we have num_retrieval=np.int64(4757) num_query=np.int64(409)
2025-03-13 16:00:32,536 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:33,752 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:33
2025-03-13 16:00:33,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.71it/s]
2025-03-13 16:00:33,777 [INFO]: There are 4757 embeddings of dim 49152
2025-03-13 16:00:33,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:00:33,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:33
2025-03-13 16:00:33,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:33,778 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 16:00:33,778 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:33,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:00:33,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:33
2025-03-13 16:00:33,778 [INFO]: 981.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:33,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:00:33,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:33
2025-03-13 16:00:33,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:33,778 [INFO]: 	Creating the index 03/13/2025, 16:00:33
2025-03-13 16:00:33,778 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:33
2025-03-13 16:00:33,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:00:33,779 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:33
2025-03-13 16:00:33,779 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:00:33,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.39it/s] 16%|█▌        | 3/19 [00:00<00:01,  8.99it/s] 26%|██▋       | 5/19 [00:00<00:01, 10.09it/s] 37%|███▋      | 7/19 [00:00<00:01, 10.78it/s] 47%|████▋     | 9/19 [00:00<00:00, 11.02it/s] 58%|█████▊    | 11/19 [00:01<00:00, 11.10it/s] 68%|██████▊   | 13/19 [00:01<00:00, 11.29it/s] 79%|███████▉  | 15/19 [00:01<00:00, 11.39it/s] 89%|████████▉ | 17/19 [00:01<00:00, 11.52it/s]100%|██████████| 19/19 [00:04<00:00,  1.78it/s]100%|██████████| 19/19 [00:04<00:00,  3.96it/s]
2025-03-13 16:00:38,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:38
2025-03-13 16:01:24,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7516 secs
2025-03-13 16:01:24,339 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:01:24,339 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 16:02:00,179 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8401 secs
2025-03-13 16:02:00,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4040 secs
2025-03-13 16:02:00,183 [INFO]: {
2025-03-13 16:02:00,183 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:00,183 [INFO]: 	index_param: efSearch=238
2025-03-13 16:02:00,184 [INFO]: 	index_path: knn.index
2025-03-13 16:02:00,184 [INFO]: 	size in bytes: 935911270
2025-03-13 16:02:00,184 [INFO]: 	avg_search_speed_ms: 10.571498856741943
2025-03-13 16:02:00,184 [INFO]: 	99p_search_speed_ms: 15.076842904090867
2025-03-13 16:02:00,184 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:00,184 [INFO]: 	nb vectors: 4757
2025-03-13 16:02:00,184 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:00,184 [INFO]: 	compression ratio: 0.9993086801914459
2025-03-13 16:02:00,184 [INFO]: }
2025-03-13 16:02:00,184 [INFO]: 	>>> Finished "Creating the index" in 86.4056 secs
2025-03-13 16:02:00,184 [INFO]: >>> Finished "Launching the whole pipeline" in 86.4316 secs
2025-03-13 16:02:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 14661 [episode count 17/20]
[retrieval_preprocessing] for episode 46977 [episode count 18/20], we have num_retrieval=np.int64(4904) num_query=np.int64(262)
2025-03-13 16:02:09,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:10,550 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:10
2025-03-13 16:02:10,550 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 966.88it/s]
2025-03-13 16:02:10,576 [INFO]: There are 4904 embeddings of dim 49152
2025-03-13 16:02:10,577 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:02:10,577 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:10
2025-03-13 16:02:10,577 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:10,577 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:02:10,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:10,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:02:10,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:10
2025-03-13 16:02:10,577 [INFO]: 1012.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:10,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:02:10,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:10
2025-03-13 16:02:10,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:10,577 [INFO]: 	Creating the index 03/13/2025, 16:02:10
2025-03-13 16:02:10,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:10
2025-03-13 16:02:10,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:02:10,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:10
2025-03-13 16:02:10,578 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:02:10,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.85it/s] 10%|█         | 2/20 [00:00<00:02,  6.85it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.72it/s] 20%|██        | 4/20 [00:00<00:01,  8.13it/s] 30%|███       | 6/20 [00:00<00:01,  8.88it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.82it/s] 40%|████      | 8/20 [00:00<00:01,  8.82it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.83it/s] 50%|█████     | 10/20 [00:01<00:01,  8.92it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.80it/s] 60%|██████    | 12/20 [00:01<00:00,  8.73it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.78it/s] 70%|███████   | 14/20 [00:01<00:00,  8.73it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.82it/s] 80%|████████  | 16/20 [00:01<00:00,  8.97it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.10it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.45it/s]100%|██████████| 20/20 [00:06<00:00,  1.13s/it]100%|██████████| 20/20 [00:06<00:00,  3.11it/s]
2025-03-13 16:02:17,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:17
2025-03-13 16:03:05,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0097 secs
2025-03-13 16:03:05,026 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 16:03:05,026 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 16:04:12,160 [INFO]: 	>>> Finished "Compute fast metrics" in 67.1336 secs
2025-03-13 16:04:12,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.5862 secs
2025-03-13 16:04:12,165 [INFO]: {
2025-03-13 16:04:12,165 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:12,165 [INFO]: 	index_param: efSearch=251
2025-03-13 16:04:12,165 [INFO]: 	index_path: knn.index
2025-03-13 16:04:12,165 [INFO]: 	size in bytes: 964832530
2025-03-13 16:04:12,165 [INFO]: 	avg_search_speed_ms: 10.57584017065273
2025-03-13 16:04:12,165 [INFO]: 	99p_search_speed_ms: 18.430146307218802
2025-03-13 16:04:12,165 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:12,165 [INFO]: 	nb vectors: 4904
2025-03-13 16:04:12,165 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:12,165 [INFO]: 	compression ratio: 0.9993087940349606
2025-03-13 16:04:12,165 [INFO]: }
2025-03-13 16:04:12,165 [INFO]: 	>>> Finished "Creating the index" in 121.5877 secs
2025-03-13 16:04:12,165 [INFO]: >>> Finished "Launching the whole pipeline" in 121.6143 secs
2025-03-13 16:04:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 46977 [episode count 18/20]
[retrieval_preprocessing] for episode 39834 [episode count 19/20], we have num_retrieval=np.int64(4842) num_query=np.int64(324)
2025-03-13 16:04:17,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:18,115 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:18
2025-03-13 16:04:18,115 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.68it/s]
2025-03-13 16:04:18,141 [INFO]: There are 4842 embeddings of dim 49152
2025-03-13 16:04:18,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:04:18,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:18,141 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 16:04:18,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:18,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:18,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,142 [INFO]: 999.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:18,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:04:18,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:18
2025-03-13 16:04:18,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:18,142 [INFO]: 	Creating the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,142 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:18
2025-03-13 16:04:18,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:04:18,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:18
2025-03-13 16:04:18,143 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 16:04:18,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.50it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.26it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.07it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.93it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.30it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.61it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.41it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.28it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.45it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.50it/s]100%|██████████| 20/20 [00:05<00:00,  3.77it/s]
2025-03-13 16:04:23,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:23
2025-03-13 16:05:20,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5854 secs
2025-03-13 16:05:20,041 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:05:20,041 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-13 16:05:50,684 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6428 secs
2025-03-13 16:05:50,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.5447 secs
2025-03-13 16:05:50,688 [INFO]: {
2025-03-13 16:05:50,688 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:50,688 [INFO]: 	index_param: efSearch=201
2025-03-13 16:05:50,688 [INFO]: 	index_path: knn.index
2025-03-13 16:05:50,688 [INFO]: 	size in bytes: 952634590
2025-03-13 16:05:50,688 [INFO]: 	avg_search_speed_ms: 9.419529611532438
2025-03-13 16:05:50,688 [INFO]: 	99p_search_speed_ms: 13.996467557735754
2025-03-13 16:05:50,688 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:50,688 [INFO]: 	nb vectors: 4842
2025-03-13 16:05:50,688 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:50,688 [INFO]: 	compression ratio: 0.9993085974339857
2025-03-13 16:05:50,688 [INFO]: }
2025-03-13 16:05:50,688 [INFO]: 	>>> Finished "Creating the index" in 92.5465 secs
2025-03-13 16:05:50,688 [INFO]: >>> Finished "Launching the whole pipeline" in 92.5736 secs
2025-03-13 16:05:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 39834 [episode count 19/20]
2025-03-13 16:05:53: [retrieval_preprocessing] finished for 8098563998_open_coffee_maker [chosen_id count 2/196]
2025-03-13 16:06:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8175789552_folding_clothes [chosen_id count 3/196]
2025-03-13 16:06:00: [retrieval_preprocessing] we have num_total=7237 embedding_dim=49152
[retrieval_preprocessing] for episode 79360 [episode count 0/20], we have num_retrieval=np.int64(6724) num_query=np.int64(513)
2025-03-13 16:06:03,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:03,988 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:03
2025-03-13 16:06:03,989 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.53it/s]
2025-03-13 16:06:04,017 [INFO]: There are 6724 embeddings of dim 49152
2025-03-13 16:06:04,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:06:04,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:04,018 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:06:04,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:04,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:06:04,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,019 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:04,019 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:06:04,020 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:04
2025-03-13 16:06:04,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:04,020 [INFO]: 	Creating the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,020 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:04
2025-03-13 16:06:04,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:06:04,023 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:04
2025-03-13 16:06:04,023 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:06:04,023 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.32it/s] 11%|█         | 3/28 [00:00<00:02,  9.07it/s] 18%|█▊        | 5/28 [00:00<00:02, 10.46it/s] 25%|██▌       | 7/28 [00:00<00:01, 11.03it/s] 32%|███▏      | 9/28 [00:00<00:01, 11.31it/s] 39%|███▉      | 11/28 [00:01<00:01, 11.53it/s] 46%|████▋     | 13/28 [00:01<00:01, 11.64it/s] 54%|█████▎    | 15/28 [00:01<00:01, 11.75it/s] 61%|██████    | 17/28 [00:01<00:00, 11.74it/s] 68%|██████▊   | 19/28 [00:01<00:00, 11.89it/s] 75%|███████▌  | 21/28 [00:05<00:04,  1.56it/s] 79%|███████▊  | 22/28 [00:05<00:03,  1.84it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.58it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.47it/s]100%|██████████| 28/28 [00:07<00:00,  2.04it/s]100%|██████████| 28/28 [00:07<00:00,  3.61it/s]
2025-03-13 16:06:11,794 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:11
2025-03-13 16:07:07,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7435 secs
2025-03-13 16:07:07,538 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:07:07,538 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 16:07:45,894 [INFO]: 	>>> Finished "Compute fast metrics" in 38.3558 secs
2025-03-13 16:07:45,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.8726 secs
2025-03-13 16:07:45,896 [INFO]: {
2025-03-13 16:07:45,896 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:45,896 [INFO]: 	index_param: efSearch=177
2025-03-13 16:07:45,896 [INFO]: 	index_path: knn.index
2025-03-13 16:07:45,896 [INFO]: 	size in bytes: 1322907130
2025-03-13 16:07:45,896 [INFO]: 	avg_search_speed_ms: 11.494577076853435
2025-03-13 16:07:45,896 [INFO]: 	99p_search_speed_ms: 21.90854446496814
2025-03-13 16:07:45,896 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:45,896 [INFO]: 	nb vectors: 6724
2025-03-13 16:07:45,896 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:45,896 [INFO]: 	compression ratio: 0.9993083883371314
2025-03-13 16:07:45,896 [INFO]: }
2025-03-13 16:07:45,896 [INFO]: 	>>> Finished "Creating the index" in 101.8762 secs
2025-03-13 16:07:45,896 [INFO]: >>> Finished "Launching the whole pipeline" in 101.9075 secs
2025-03-13 16:07:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 79360 [episode count 0/20]
[retrieval_preprocessing] for episode 4097 [episode count 1/20], we have num_retrieval=np.int64(6981) num_query=np.int64(256)
2025-03-13 16:07:53,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:55,131 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:55
2025-03-13 16:07:55,131 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.33it/s]
2025-03-13 16:07:55,156 [INFO]: There are 6981 embeddings of dim 49152
2025-03-13 16:07:55,156 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:07:55,156 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:55
2025-03-13 16:07:55,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:55,156 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:07:55,156 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:55,156 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:55,156 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:55
2025-03-13 16:07:55,156 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:55,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:07:55,156 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:55
2025-03-13 16:07:55,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:55,157 [INFO]: 	Creating the index 03/13/2025, 16:07:55
2025-03-13 16:07:55,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:55
2025-03-13 16:07:55,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:07:55,158 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:55
2025-03-13 16:07:55,158 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:07:55,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.20it/s]  7%|▋         | 2/29 [00:00<00:03,  7.19it/s] 10%|█         | 3/29 [00:00<00:03,  7.95it/s] 14%|█▍        | 4/29 [00:00<00:02,  8.35it/s] 17%|█▋        | 5/29 [00:00<00:02,  8.66it/s] 21%|██        | 6/29 [00:00<00:02,  8.88it/s] 28%|██▊       | 8/29 [00:00<00:02,  9.59it/s] 34%|███▍      | 10/29 [00:01<00:01,  9.94it/s] 41%|████▏     | 12/29 [00:01<00:01, 10.23it/s] 48%|████▊     | 14/29 [00:01<00:01, 10.07it/s] 55%|█████▌    | 16/29 [00:01<00:01,  9.96it/s] 59%|█████▊    | 17/29 [00:01<00:01,  9.94it/s] 72%|███████▏  | 21/29 [00:06<00:04,  1.62it/s] 76%|███████▌  | 22/29 [00:06<00:03,  1.85it/s] 79%|███████▉  | 23/29 [00:06<00:02,  2.15it/s] 83%|████████▎ | 24/29 [00:06<00:01,  2.52it/s] 86%|████████▌ | 25/29 [00:06<00:01,  2.98it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.52it/s] 93%|█████████▎| 27/29 [00:06<00:00,  4.10it/s] 97%|█████████▋| 28/29 [00:07<00:00,  4.70it/s]100%|██████████| 29/29 [00:09<00:00,  1.12it/s]100%|██████████| 29/29 [00:09<00:00,  2.98it/s]
2025-03-13 16:08:04,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:04
2025-03-13 16:09:06,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2646 secs
2025-03-13 16:09:06,179 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 16:09:06,179 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 16:10:15,118 [INFO]: 	>>> Finished "Compute fast metrics" in 68.9390 secs
2025-03-13 16:10:15,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.7268 secs
2025-03-13 16:10:15,885 [INFO]: {
2025-03-13 16:10:15,885 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:15,885 [INFO]: 	index_param: efSearch=290
2025-03-13 16:10:15,885 [INFO]: 	index_path: knn.index
2025-03-13 16:10:15,885 [INFO]: 	size in bytes: 1373470390
2025-03-13 16:10:15,885 [INFO]: 	avg_search_speed_ms: 15.04218731516678
2025-03-13 16:10:15,885 [INFO]: 	99p_search_speed_ms: 27.032504985108975
2025-03-13 16:10:15,885 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:15,885 [INFO]: 	nb vectors: 6981
2025-03-13 16:10:15,885 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:15,885 [INFO]: 	compression ratio: 0.9993083636844913
2025-03-13 16:10:15,885 [INFO]: }
2025-03-13 16:10:15,886 [INFO]: 	>>> Finished "Creating the index" in 140.7290 secs
2025-03-13 16:10:15,886 [INFO]: >>> Finished "Launching the whole pipeline" in 140.7549 secs
2025-03-13 16:10:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 4097 [episode count 1/20]
[retrieval_preprocessing] for episode 94741 [episode count 2/20], we have num_retrieval=np.int64(6816) num_query=np.int64(421)
2025-03-13 16:10:23,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:25,066 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:25
2025-03-13 16:10:25,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.31it/s]
2025-03-13 16:10:25,092 [INFO]: There are 6816 embeddings of dim 49152
2025-03-13 16:10:25,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 16:10:25,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:25
2025-03-13 16:10:25,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:25,093 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:10:25,093 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:25,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:25,093 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:25
2025-03-13 16:10:25,093 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:25,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:25,093 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:25
2025-03-13 16:10:25,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:25,093 [INFO]: 	Creating the index 03/13/2025, 16:10:25
2025-03-13 16:10:25,093 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:25
2025-03-13 16:10:25,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:10:25,095 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:25
2025-03-13 16:10:25,095 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:10:25,095 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:06,  4.25it/s]  7%|▋         | 2/28 [00:00<00:04,  5.71it/s] 11%|█         | 3/28 [00:00<00:03,  6.38it/s] 14%|█▍        | 4/28 [00:00<00:03,  6.88it/s] 18%|█▊        | 5/28 [00:00<00:03,  7.27it/s] 21%|██▏       | 6/28 [00:00<00:02,  7.42it/s] 25%|██▌       | 7/28 [00:01<00:02,  7.57it/s] 29%|██▊       | 8/28 [00:01<00:02,  7.54it/s] 32%|███▏      | 9/28 [00:01<00:02,  7.97it/s] 39%|███▉      | 11/28 [00:01<00:02,  8.29it/s] 43%|████▎     | 12/28 [00:01<00:02,  7.99it/s] 46%|████▋     | 13/28 [00:01<00:01,  7.85it/s] 50%|█████     | 14/28 [00:01<00:01,  7.39it/s] 54%|█████▎    | 15/28 [00:02<00:01,  7.34it/s] 57%|█████▋    | 16/28 [00:02<00:01,  7.12it/s] 61%|██████    | 17/28 [00:02<00:01,  7.12it/s] 64%|██████▍   | 18/28 [00:02<00:01,  7.07it/s] 68%|██████▊   | 19/28 [00:02<00:01,  7.36it/s] 71%|███████▏  | 20/28 [00:02<00:01,  7.67it/s] 75%|███████▌  | 21/28 [00:07<00:11,  1.66s/it] 86%|████████▌ | 24/28 [00:08<00:03,  1.33it/s] 96%|█████████▋| 27/28 [00:08<00:00,  2.29it/s]100%|██████████| 28/28 [00:10<00:00,  2.58it/s]
2025-03-13 16:10:35,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:35
2025-03-13 16:11:49,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.5510 secs
2025-03-13 16:11:49,523 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 16:11:49,523 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 16:12:37,681 [INFO]: 	>>> Finished "Compute fast metrics" in 48.1575 secs
2025-03-13 16:12:37,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.5881 secs
2025-03-13 16:12:37,683 [INFO]: {
2025-03-13 16:12:37,683 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:37,683 [INFO]: 	index_param: efSearch=188
2025-03-13 16:12:37,683 [INFO]: 	index_path: knn.index
2025-03-13 16:12:37,683 [INFO]: 	size in bytes: 1341007510
2025-03-13 16:12:37,683 [INFO]: 	avg_search_speed_ms: 14.352295203655531
2025-03-13 16:12:37,683 [INFO]: 	99p_search_speed_ms: 28.784507494419792
2025-03-13 16:12:37,683 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:37,683 [INFO]: 	nb vectors: 6816
2025-03-13 16:12:37,683 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:37,683 [INFO]: 	compression ratio: 0.9993084438430923
2025-03-13 16:12:37,683 [INFO]: }
2025-03-13 16:12:37,683 [INFO]: 	>>> Finished "Creating the index" in 132.5898 secs
2025-03-13 16:12:37,683 [INFO]: >>> Finished "Launching the whole pipeline" in 132.6173 secs
2025-03-13 16:12:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 94741 [episode count 2/20]
[retrieval_preprocessing] for episode 34335 [episode count 3/20], we have num_retrieval=np.int64(6781) num_query=np.int64(456)
2025-03-13 16:12:42,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:43,872 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:43
2025-03-13 16:12:43,873 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 986.90it/s]
2025-03-13 16:12:43,906 [INFO]: There are 6781 embeddings of dim 49152
2025-03-13 16:12:43,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 16:12:43,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:43
2025-03-13 16:12:43,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:43,906 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:12:43,906 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:43,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:43,906 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:43
2025-03-13 16:12:43,906 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:43,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:43,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:43
2025-03-13 16:12:43,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:43,907 [INFO]: 	Creating the index 03/13/2025, 16:12:43
2025-03-13 16:12:43,907 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:43
2025-03-13 16:12:43,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:12:43,908 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:43
2025-03-13 16:12:43,908 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:12:43,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.50it/s] 14%|█▍        | 4/28 [00:00<00:01, 19.47it/s] 32%|███▏      | 9/28 [00:00<00:00, 29.75it/s] 50%|█████     | 14/28 [00:00<00:00, 35.18it/s] 68%|██████▊   | 19/28 [00:00<00:00, 38.28it/s] 82%|████████▏ | 23/28 [00:05<00:02,  2.42it/s]100%|██████████| 28/28 [00:07<00:00,  2.44it/s]100%|██████████| 28/28 [00:07<00:00,  3.70it/s]
2025-03-13 16:12:51,484 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:51
2025-03-13 16:14:10,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.3063 secs
2025-03-13 16:14:10,792 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 16:14:10,792 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.16it/s]
2025-03-13 16:15:00,954 [INFO]: 	>>> Finished "Compute fast metrics" in 50.1625 secs
2025-03-13 16:15:01,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.4037 secs
2025-03-13 16:15:01,312 [INFO]: {
2025-03-13 16:15:01,312 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:01,312 [INFO]: 	index_param: efSearch=203
2025-03-13 16:15:01,312 [INFO]: 	index_path: knn.index
2025-03-13 16:15:01,312 [INFO]: 	size in bytes: 1334121490
2025-03-13 16:15:01,312 [INFO]: 	avg_search_speed_ms: 12.106728172459006
2025-03-13 16:15:01,312 [INFO]: 	99p_search_speed_ms: 20.80591628793627
2025-03-13 16:15:01,313 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:01,313 [INFO]: 	nb vectors: 6781
2025-03-13 16:15:01,313 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:01,313 [INFO]: 	compression ratio: 0.9993084273007251
2025-03-13 16:15:01,313 [INFO]: }
2025-03-13 16:15:01,313 [INFO]: 	>>> Finished "Creating the index" in 137.4064 secs
2025-03-13 16:15:01,313 [INFO]: >>> Finished "Launching the whole pipeline" in 137.4406 secs
2025-03-13 16:15:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 34335 [episode count 3/20]
[retrieval_preprocessing] for episode 90161 [episode count 4/20], we have num_retrieval=np.int64(6619) num_query=np.int64(618)
2025-03-13 16:15:08,421 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:09,534 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:09
2025-03-13 16:15:09,534 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.75it/s]
2025-03-13 16:15:09,570 [INFO]: There are 6619 embeddings of dim 49152
2025-03-13 16:15:09,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 16:15:09,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:09
2025-03-13 16:15:09,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:09,570 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:15:09,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:09,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:09,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:09
2025-03-13 16:15:09,571 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:09,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:15:09,571 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:09
2025-03-13 16:15:09,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:09,571 [INFO]: 	Creating the index 03/13/2025, 16:15:09
2025-03-13 16:15:09,571 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:09
2025-03-13 16:15:09,572 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:15:09,572 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:09
2025-03-13 16:15:09,572 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:15:09,572 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.05it/s] 18%|█▊        | 5/28 [00:00<00:00, 23.51it/s] 32%|███▏      | 9/28 [00:00<00:00, 30.37it/s] 46%|████▋     | 13/28 [00:00<00:00, 33.86it/s] 61%|██████    | 17/28 [00:00<00:00, 35.86it/s] 75%|███████▌  | 21/28 [00:05<00:03,  2.10it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.33it/s]100%|██████████| 28/28 [00:07<00:00,  3.67it/s]
2025-03-13 16:15:17,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:17
2025-03-13 16:16:15,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0764 secs
2025-03-13 16:16:15,279 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 16:16:15,279 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.15it/s]
2025-03-13 16:17:17,029 [INFO]: 	>>> Finished "Compute fast metrics" in 61.7503 secs
2025-03-13 16:17:17,031 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.4585 secs
2025-03-13 16:17:17,031 [INFO]: {
2025-03-13 16:17:17,031 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:17,031 [INFO]: 	index_param: efSearch=253
2025-03-13 16:17:17,031 [INFO]: 	index_path: knn.index
2025-03-13 16:17:17,031 [INFO]: 	size in bytes: 1302249010
2025-03-13 16:17:17,031 [INFO]: 	avg_search_speed_ms: 15.157680300233716
2025-03-13 16:17:17,031 [INFO]: 	99p_search_speed_ms: 26.77652663784099
2025-03-13 16:17:17,031 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:17,031 [INFO]: 	nb vectors: 6619
2025-03-13 16:17:17,031 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:17,031 [INFO]: 	compression ratio: 0.9993083826571694
2025-03-13 16:17:17,031 [INFO]: }
2025-03-13 16:17:17,031 [INFO]: 	>>> Finished "Creating the index" in 127.4604 secs
2025-03-13 16:17:17,031 [INFO]: >>> Finished "Launching the whole pipeline" in 127.4974 secs
2025-03-13 16:17:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 90161 [episode count 4/20]
[retrieval_preprocessing] for episode 2136 [episode count 5/20], we have num_retrieval=np.int64(6866) num_query=np.int64(371)
2025-03-13 16:17:26,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:28,042 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:28
2025-03-13 16:17:28,042 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-13 16:17:28,074 [INFO]: There are 6866 embeddings of dim 49152
2025-03-13 16:17:28,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 16:17:28,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:28
2025-03-13 16:17:28,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:28,075 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:17:28,075 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:28,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:28,075 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:28
2025-03-13 16:17:28,075 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:28,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:28,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:28
2025-03-13 16:17:28,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:28,075 [INFO]: 	Creating the index 03/13/2025, 16:17:28
2025-03-13 16:17:28,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:28
2025-03-13 16:17:28,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:17:28,077 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:28
2025-03-13 16:17:28,077 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:17:28,077 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  5.28it/s] 17%|█▋        | 5/29 [00:00<00:01, 18.81it/s] 31%|███       | 9/29 [00:00<00:00, 25.73it/s] 45%|████▍     | 13/29 [00:00<00:00, 29.73it/s] 59%|█████▊    | 17/29 [00:00<00:00, 32.22it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.17it/s] 83%|████████▎ | 24/29 [00:09<00:03,  1.43it/s] 90%|████████▉ | 26/29 [00:09<00:01,  1.71it/s]100%|██████████| 29/29 [00:12<00:00,  1.52it/s]100%|██████████| 29/29 [00:12<00:00,  2.35it/s]
2025-03-13 16:17:40,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:40
2025-03-13 16:18:46,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.8855 secs
2025-03-13 16:18:46,330 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 16:18:46,331 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.52it/s]
2025-03-13 16:19:26,267 [INFO]: 	>>> Finished "Compute fast metrics" in 39.9363 secs
2025-03-13 16:19:26,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.1944 secs
2025-03-13 16:19:26,271 [INFO]: {
2025-03-13 16:19:26,271 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:26,271 [INFO]: 	index_param: efSearch=243
2025-03-13 16:19:26,271 [INFO]: 	index_path: knn.index
2025-03-13 16:19:26,271 [INFO]: 	size in bytes: 1350844690
2025-03-13 16:19:26,271 [INFO]: 	avg_search_speed_ms: 17.76489402129452
2025-03-13 16:19:26,271 [INFO]: 	99p_search_speed_ms: 32.38360935822129
2025-03-13 16:19:26,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:26,271 [INFO]: 	nb vectors: 6866
2025-03-13 16:19:26,272 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:26,272 [INFO]: 	compression ratio: 0.9993084608416383
2025-03-13 16:19:26,272 [INFO]: }
2025-03-13 16:19:26,272 [INFO]: 	>>> Finished "Creating the index" in 118.1962 secs
2025-03-13 16:19:26,272 [INFO]: >>> Finished "Launching the whole pipeline" in 118.2297 secs
2025-03-13 16:19:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 2136 [episode count 5/20]
[retrieval_preprocessing] for episode 21085 [episode count 6/20], we have num_retrieval=np.int64(6968) num_query=np.int64(269)
2025-03-13 16:19:34,026 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:35,756 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:35
2025-03-13 16:19:35,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 16:19:35,789 [INFO]: There are 6968 embeddings of dim 49152
2025-03-13 16:19:35,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 16:19:35,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:35
2025-03-13 16:19:35,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:35,789 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:19:35,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:35,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:35,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:35
2025-03-13 16:19:35,789 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:35,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:35,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:35
2025-03-13 16:19:35,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:35,789 [INFO]: 	Creating the index 03/13/2025, 16:19:35
2025-03-13 16:19:35,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:35
2025-03-13 16:19:35,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:19:35,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:35
2025-03-13 16:19:35,791 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:19:35,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.78it/s] 21%|██        | 6/29 [00:00<00:00, 27.91it/s] 38%|███▊      | 11/29 [00:00<00:00, 33.81it/s] 55%|█████▌    | 16/29 [00:00<00:00, 36.32it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.39it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.35it/s]100%|██████████| 29/29 [00:08<00:00,  2.60it/s]100%|██████████| 29/29 [00:08<00:00,  3.57it/s]
2025-03-13 16:19:44,118 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:44
2025-03-13 16:20:47,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7097 secs
2025-03-13 16:20:47,828 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:20:47,828 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.58it/s]
2025-03-13 16:21:36,214 [INFO]: 	>>> Finished "Compute fast metrics" in 48.3850 secs
2025-03-13 16:21:36,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.4249 secs
2025-03-13 16:21:36,216 [INFO]: {
2025-03-13 16:21:36,216 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:36,216 [INFO]: 	index_param: efSearch=168
2025-03-13 16:21:36,216 [INFO]: 	index_path: knn.index
2025-03-13 16:21:36,216 [INFO]: 	size in bytes: 1370912770
2025-03-13 16:21:36,216 [INFO]: 	avg_search_speed_ms: 12.591933873159894
2025-03-13 16:21:36,216 [INFO]: 	99p_search_speed_ms: 28.205631696619086
2025-03-13 16:21:36,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:36,216 [INFO]: 	nb vectors: 6968
2025-03-13 16:21:36,216 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:36,216 [INFO]: 	compression ratio: 0.9993083250657881
2025-03-13 16:21:36,216 [INFO]: }
2025-03-13 16:21:36,216 [INFO]: 	>>> Finished "Creating the index" in 120.4264 secs
2025-03-13 16:21:36,216 [INFO]: >>> Finished "Launching the whole pipeline" in 120.4597 secs
2025-03-13 16:21:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 21085 [episode count 6/20]
[retrieval_preprocessing] for episode 84586 [episode count 7/20], we have num_retrieval=np.int64(6879) num_query=np.int64(358)
2025-03-13 16:21:39,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:40,114 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:40
2025-03-13 16:21:40,114 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-13 16:21:40,147 [INFO]: There are 6879 embeddings of dim 49152
2025-03-13 16:21:40,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 16:21:40,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:40
2025-03-13 16:21:40,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:40,148 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:21:40,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:40,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:21:40,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:40
2025-03-13 16:21:40,149 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:40,149 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:21:40,149 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:40
2025-03-13 16:21:40,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:40,150 [INFO]: 	Creating the index 03/13/2025, 16:21:40
2025-03-13 16:21:40,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:40
2025-03-13 16:21:40,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 16:21:40,154 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:40
2025-03-13 16:21:40,154 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:21:40,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.26it/s] 24%|██▍       | 7/29 [00:00<00:00, 33.35it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.53it/s] 59%|█████▊    | 17/29 [00:00<00:00, 42.56it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.19it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.75it/s]100%|██████████| 29/29 [00:06<00:00,  4.39it/s]
2025-03-13 16:21:46,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:46
2025-03-13 16:22:45,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1659 secs
2025-03-13 16:22:45,009 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 16:22:45,009 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-13 16:23:43,792 [INFO]: 	>>> Finished "Compute fast metrics" in 58.7825 secs
2025-03-13 16:23:43,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.6397 secs
2025-03-13 16:23:43,794 [INFO]: {
2025-03-13 16:23:43,794 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:43,794 [INFO]: 	index_param: efSearch=271
2025-03-13 16:23:43,794 [INFO]: 	index_path: knn.index
2025-03-13 16:23:43,794 [INFO]: 	size in bytes: 1353402310
2025-03-13 16:23:43,794 [INFO]: 	avg_search_speed_ms: 18.84041471177056
2025-03-13 16:23:43,794 [INFO]: 	99p_search_speed_ms: 30.576206045225273
2025-03-13 16:23:43,794 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:43,794 [INFO]: 	nb vectors: 6879
2025-03-13 16:23:43,794 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:43,794 [INFO]: 	compression ratio: 0.9993084997763895
2025-03-13 16:23:43,794 [INFO]: }
2025-03-13 16:23:43,794 [INFO]: 	>>> Finished "Creating the index" in 123.6441 secs
2025-03-13 16:23:43,794 [INFO]: >>> Finished "Launching the whole pipeline" in 123.6797 secs
2025-03-13 16:23:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 84586 [episode count 7/20]
[retrieval_preprocessing] for episode 53359 [episode count 8/20], we have num_retrieval=np.int64(7063) num_query=np.int64(174)
2025-03-13 16:23:48,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:49,941 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:49
2025-03-13 16:23:49,941 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 16:23:49,971 [INFO]: There are 7063 embeddings of dim 49152
2025-03-13 16:23:49,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 16:23:49,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:49,971 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:23:49,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:49,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:49,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,971 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:49,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:49,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:49
2025-03-13 16:23:49,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:49,972 [INFO]: 	Creating the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:49
2025-03-13 16:23:49,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:23:49,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,973 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:23:49,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.75it/s] 24%|██▍       | 7/29 [00:00<00:00, 32.31it/s] 45%|████▍     | 13/29 [00:00<00:00, 41.31it/s] 66%|██████▌   | 19/29 [00:00<00:00, 46.05it/s] 83%|████████▎ | 24/29 [00:05<00:01,  2.96it/s]100%|██████████| 29/29 [00:07<00:00,  2.73it/s]100%|██████████| 29/29 [00:07<00:00,  3.99it/s]
2025-03-13 16:23:57,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:57
2025-03-13 16:25:04,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.4422 secs
2025-03-13 16:25:04,688 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 16:25:04,688 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.00it/s]
2025-03-13 16:25:44,197 [INFO]: 	>>> Finished "Compute fast metrics" in 39.5084 secs
2025-03-13 16:25:44,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.2268 secs
2025-03-13 16:25:44,200 [INFO]: {
2025-03-13 16:25:44,200 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:44,200 [INFO]: 	index_param: efSearch=188
2025-03-13 16:25:44,200 [INFO]: 	index_path: knn.index
2025-03-13 16:25:44,200 [INFO]: 	size in bytes: 1389603490
2025-03-13 16:25:44,200 [INFO]: 	avg_search_speed_ms: 11.784487286005586
2025-03-13 16:25:44,200 [INFO]: 	99p_search_speed_ms: 21.828209022060037
2025-03-13 16:25:44,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:44,200 [INFO]: 	nb vectors: 7063
2025-03-13 16:25:44,200 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:44,200 [INFO]: 	compression ratio: 0.9993083019674914
2025-03-13 16:25:44,200 [INFO]: }
2025-03-13 16:25:44,200 [INFO]: 	>>> Finished "Creating the index" in 114.2288 secs
2025-03-13 16:25:44,201 [INFO]: >>> Finished "Launching the whole pipeline" in 114.2592 secs
2025-03-13 16:25:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 53359 [episode count 8/20]
[retrieval_preprocessing] for episode 94832 [episode count 9/20], we have num_retrieval=np.int64(6905) num_query=np.int64(332)
2025-03-13 16:25:46,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:47,641 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:47
2025-03-13 16:25:47,641 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2060.07it/s]
2025-03-13 16:25:47,668 [INFO]: There are 6905 embeddings of dim 49152
2025-03-13 16:25:47,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:25:47,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:47
2025-03-13 16:25:47,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:47,668 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:25:47,668 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:47,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:47,668 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:47
2025-03-13 16:25:47,668 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:47,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:25:47,668 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:47
2025-03-13 16:25:47,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:47,668 [INFO]: 	Creating the index 03/13/2025, 16:25:47
2025-03-13 16:25:47,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:47
2025-03-13 16:25:47,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:25:47,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:47
2025-03-13 16:25:47,669 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:25:47,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.40it/s] 21%|██        | 6/29 [00:00<00:00, 30.51it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.29it/s] 59%|█████▊    | 17/29 [00:00<00:00, 43.25it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.12it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.61it/s]100%|██████████| 29/29 [00:06<00:00,  4.42it/s]
2025-03-13 16:25:54,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:54
2025-03-13 16:26:45,227 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9965 secs
2025-03-13 16:26:45,227 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 16:26:45,227 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 16:27:15,564 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3364 secs
2025-03-13 16:27:15,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.8968 secs
2025-03-13 16:27:15,566 [INFO]: {
2025-03-13 16:27:15,566 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:15,566 [INFO]: 	index_param: efSearch=188
2025-03-13 16:27:15,566 [INFO]: 	index_path: knn.index
2025-03-13 16:27:15,566 [INFO]: 	size in bytes: 1358517790
2025-03-13 16:27:15,567 [INFO]: 	avg_search_speed_ms: 15.687297142131202
2025-03-13 16:27:15,567 [INFO]: 	99p_search_speed_ms: 28.318068929947913
2025-03-13 16:27:15,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:15,567 [INFO]: 	nb vectors: 6905
2025-03-13 16:27:15,567 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:15,567 [INFO]: 	compression ratio: 0.9993084006651102
2025-03-13 16:27:15,567 [INFO]: }
2025-03-13 16:27:15,567 [INFO]: 	>>> Finished "Creating the index" in 87.8983 secs
2025-03-13 16:27:15,567 [INFO]: >>> Finished "Launching the whole pipeline" in 87.9253 secs
2025-03-13 16:27:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 94832 [episode count 9/20]
[retrieval_preprocessing] for episode 79012 [episode count 10/20], we have num_retrieval=np.int64(6900) num_query=np.int64(337)
2025-03-13 16:27:20,278 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:21,604 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:21
2025-03-13 16:27:21,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1789.38it/s]
2025-03-13 16:27:21,632 [INFO]: There are 6900 embeddings of dim 49152
2025-03-13 16:27:21,632 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 16:27:21,632 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:21
2025-03-13 16:27:21,632 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:21,632 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:27:21,632 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:21,632 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:27:21,633 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:21
2025-03-13 16:27:21,633 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:21,633 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:27:21,633 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:21
2025-03-13 16:27:21,633 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:21,633 [INFO]: 	Creating the index 03/13/2025, 16:27:21
2025-03-13 16:27:21,633 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:21
2025-03-13 16:27:21,634 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:27:21,634 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:21
2025-03-13 16:27:21,634 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:27:21,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.52it/s] 24%|██▍       | 7/29 [00:00<00:00, 30.59it/s] 41%|████▏     | 12/29 [00:00<00:00, 34.97it/s] 55%|█████▌    | 16/29 [00:00<00:00, 36.70it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.22it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.14it/s]100%|██████████| 29/29 [00:08<00:00,  2.34it/s]100%|██████████| 29/29 [00:08<00:00,  3.34it/s]
2025-03-13 16:27:30,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:30
2025-03-13 16:28:28,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3571 secs
2025-03-13 16:28:28,683 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 16:28:28,683 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.48it/s]
2025-03-13 16:29:15,269 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5853 secs
2025-03-13 16:29:15,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.6364 secs
2025-03-13 16:29:15,270 [INFO]: {
2025-03-13 16:29:15,270 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:15,270 [INFO]: 	index_param: efSearch=284
2025-03-13 16:29:15,270 [INFO]: 	index_path: knn.index
2025-03-13 16:29:15,270 [INFO]: 	size in bytes: 1357534030
2025-03-13 16:29:15,270 [INFO]: 	avg_search_speed_ms: 15.860457179577882
2025-03-13 16:29:15,270 [INFO]: 	99p_search_speed_ms: 23.791893641464412
2025-03-13 16:29:15,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:15,270 [INFO]: 	nb vectors: 6900
2025-03-13 16:29:15,270 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:15,270 [INFO]: 	compression ratio: 0.9993084298593974
2025-03-13 16:29:15,271 [INFO]: }
2025-03-13 16:29:15,271 [INFO]: 	>>> Finished "Creating the index" in 113.6377 secs
2025-03-13 16:29:15,271 [INFO]: >>> Finished "Launching the whole pipeline" in 113.6668 secs
2025-03-13 16:29:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 79012 [episode count 10/20]
[retrieval_preprocessing] for episode 89257 [episode count 11/20], we have num_retrieval=np.int64(7024) num_query=np.int64(213)
2025-03-13 16:29:20,767 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:22,069 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:22
2025-03-13 16:29:22,070 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1284.23it/s]
2025-03-13 16:29:22,102 [INFO]: There are 7024 embeddings of dim 49152
2025-03-13 16:29:22,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 16:29:22,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:22
2025-03-13 16:29:22,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:22,102 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:29:22,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:22,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:22,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:22
2025-03-13 16:29:22,102 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:22,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:22,103 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:22
2025-03-13 16:29:22,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:22,103 [INFO]: 	Creating the index 03/13/2025, 16:29:22
2025-03-13 16:29:22,103 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:22
2025-03-13 16:29:22,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:29:22,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:22
2025-03-13 16:29:22,104 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:29:22,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.25it/s] 21%|██        | 6/29 [00:00<00:00, 29.37it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.30it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.09it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.36it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.30it/s]100%|██████████| 29/29 [00:08<00:00,  2.50it/s]100%|██████████| 29/29 [00:08<00:00,  3.48it/s]
2025-03-13 16:29:30,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:30
2025-03-13 16:30:36,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.9187 secs
2025-03-13 16:30:36,561 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 16:30:36,561 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.08it/s]
2025-03-13 16:31:08,602 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0407 secs
2025-03-13 16:31:09,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.0436 secs
2025-03-13 16:31:09,148 [INFO]: {
2025-03-13 16:31:09,148 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:09,148 [INFO]: 	index_param: efSearch=224
2025-03-13 16:31:09,148 [INFO]: 	index_path: knn.index
2025-03-13 16:31:09,148 [INFO]: 	size in bytes: 1381930450
2025-03-13 16:31:09,148 [INFO]: 	avg_search_speed_ms: 14.683457626858603
2025-03-13 16:31:09,148 [INFO]: 	99p_search_speed_ms: 23.8415255676955
2025-03-13 16:31:09,149 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:09,149 [INFO]: 	nb vectors: 7024
2025-03-13 16:31:09,149 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:09,149 [INFO]: 	compression ratio: 0.999308316854875
2025-03-13 16:31:09,149 [INFO]: }
2025-03-13 16:31:09,149 [INFO]: 	>>> Finished "Creating the index" in 107.0461 secs
2025-03-13 16:31:09,149 [INFO]: >>> Finished "Launching the whole pipeline" in 107.0793 secs
2025-03-13 16:31:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 89257 [episode count 11/20]
[retrieval_preprocessing] for episode 31923 [episode count 12/20], we have num_retrieval=np.int64(6677) num_query=np.int64(560)
2025-03-13 16:31:13,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:14,557 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:14
2025-03-13 16:31:14,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-13 16:31:14,694 [INFO]: There are 6677 embeddings of dim 49152
2025-03-13 16:31:14,694 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1364 secs
2025-03-13 16:31:14,694 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:14
2025-03-13 16:31:14,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:14,694 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:31:14,694 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:14,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:31:14,694 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:14
2025-03-13 16:31:14,695 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:14,695 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:31:14,695 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:14
2025-03-13 16:31:14,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:14,695 [INFO]: 	Creating the index 03/13/2025, 16:31:14
2025-03-13 16:31:14,695 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:14
2025-03-13 16:31:14,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:31:14,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:14
2025-03-13 16:31:14,697 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:31:14,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.34it/s] 21%|██▏       | 6/28 [00:00<00:00, 26.86it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.08it/s] 57%|█████▋    | 16/28 [00:00<00:00, 40.03it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.01it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.51it/s]100%|██████████| 28/28 [00:06<00:00,  4.48it/s]
2025-03-13 16:31:20,951 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:20
2025-03-13 16:32:18,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5674 secs
2025-03-13 16:32:18,519 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 16:32:18,520 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.31it/s]
2025-03-13 16:33:06,368 [INFO]: 	>>> Finished "Compute fast metrics" in 47.8480 secs
2025-03-13 16:33:06,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.6719 secs
2025-03-13 16:33:06,370 [INFO]: {
2025-03-13 16:33:06,370 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:06,370 [INFO]: 	index_param: efSearch=268
2025-03-13 16:33:06,370 [INFO]: 	index_path: knn.index
2025-03-13 16:33:06,370 [INFO]: 	size in bytes: 1313660170
2025-03-13 16:33:06,370 [INFO]: 	avg_search_speed_ms: 15.482118806673625
2025-03-13 16:33:06,370 [INFO]: 	99p_search_speed_ms: 24.606152935884882
2025-03-13 16:33:06,370 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:06,370 [INFO]: 	nb vectors: 6677
2025-03-13 16:33:06,370 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:06,370 [INFO]: 	compression ratio: 0.9993083797311142
2025-03-13 16:33:06,370 [INFO]: }
2025-03-13 16:33:06,370 [INFO]: 	>>> Finished "Creating the index" in 111.6751 secs
2025-03-13 16:33:06,370 [INFO]: >>> Finished "Launching the whole pipeline" in 111.8129 secs
2025-03-13 16:33:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 31923 [episode count 12/20]
[retrieval_preprocessing] for episode 61625 [episode count 13/20], we have num_retrieval=np.int64(7079) num_query=np.int64(158)
2025-03-13 16:33:14,518 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:15,728 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:15
2025-03-13 16:33:15,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.37it/s]
2025-03-13 16:33:15,761 [INFO]: There are 7079 embeddings of dim 49152
2025-03-13 16:33:15,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 16:33:15,761 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:15
2025-03-13 16:33:15,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:15,761 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:33:15,761 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:15,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:15,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:15
2025-03-13 16:33:15,761 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:15,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:33:15,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:15
2025-03-13 16:33:15,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:15,762 [INFO]: 	Creating the index 03/13/2025, 16:33:15
2025-03-13 16:33:15,762 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:15
2025-03-13 16:33:15,763 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:33:15,763 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:15
2025-03-13 16:33:15,763 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:33:15,763 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.28it/s] 21%|██        | 6/29 [00:00<00:00, 29.44it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.67it/s] 55%|█████▌    | 16/29 [00:00<00:00, 41.81it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.10it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.64it/s]100%|██████████| 29/29 [00:06<00:00,  4.36it/s]
2025-03-13 16:33:22,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:22
2025-03-13 16:34:25,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6285 secs
2025-03-13 16:34:25,044 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 16:34:25,044 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.10it/s]
2025-03-13 16:34:57,603 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5590 secs
2025-03-13 16:34:57,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.8421 secs
2025-03-13 16:34:57,605 [INFO]: {
2025-03-13 16:34:57,605 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:57,605 [INFO]: 	index_param: efSearch=157
2025-03-13 16:34:57,605 [INFO]: 	index_path: knn.index
2025-03-13 16:34:57,606 [INFO]: 	size in bytes: 1392751330
2025-03-13 16:34:57,606 [INFO]: 	avg_search_speed_ms: 10.497000689715037
2025-03-13 16:34:57,606 [INFO]: 	99p_search_speed_ms: 17.35305454581976
2025-03-13 16:34:57,606 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:57,606 [INFO]: 	nb vectors: 7079
2025-03-13 16:34:57,606 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:57,606 [INFO]: 	compression ratio: 0.9993083488924042
2025-03-13 16:34:57,606 [INFO]: }
2025-03-13 16:34:57,606 [INFO]: 	>>> Finished "Creating the index" in 101.8439 secs
2025-03-13 16:34:57,606 [INFO]: >>> Finished "Launching the whole pipeline" in 101.8771 secs
2025-03-13 16:34:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 61625 [episode count 13/20]
[retrieval_preprocessing] for episode 78530 [episode count 14/20], we have num_retrieval=np.int64(6948) num_query=np.int64(289)
2025-03-13 16:34:59,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:00,922 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:00
2025-03-13 16:35:00,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1364.00it/s]
2025-03-13 16:35:00,965 [INFO]: There are 6948 embeddings of dim 49152
2025-03-13 16:35:00,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0436 secs
2025-03-13 16:35:00,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:00
2025-03-13 16:35:00,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:00,967 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:35:00,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:00,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:35:00,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:00
2025-03-13 16:35:00,968 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:00,969 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:35:00,969 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:00
2025-03-13 16:35:00,969 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:00,969 [INFO]: 	Creating the index 03/13/2025, 16:35:00
2025-03-13 16:35:00,970 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:00
2025-03-13 16:35:00,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:35:00,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:00
2025-03-13 16:35:00,973 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:35:00,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.38it/s] 17%|█▋        | 5/29 [00:00<00:00, 26.66it/s] 31%|███       | 9/29 [00:00<00:00, 32.43it/s] 45%|████▍     | 13/29 [00:00<00:00, 35.12it/s] 59%|█████▊    | 17/29 [00:00<00:00, 36.25it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.29it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.62it/s]100%|██████████| 29/29 [00:07<00:00,  3.88it/s]
2025-03-13 16:35:08,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:08
2025-03-13 16:36:04,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6498 secs
2025-03-13 16:36:04,104 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 16:36:04,104 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s]
2025-03-13 16:36:51,715 [INFO]: 	>>> Finished "Compute fast metrics" in 47.6106 secs
2025-03-13 16:36:51,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.7444 secs
2025-03-13 16:36:51,718 [INFO]: {
2025-03-13 16:36:51,718 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:51,718 [INFO]: 	index_param: efSearch=221
2025-03-13 16:36:51,718 [INFO]: 	index_path: knn.index
2025-03-13 16:36:51,718 [INFO]: 	size in bytes: 1366977850
2025-03-13 16:36:51,718 [INFO]: 	avg_search_speed_ms: 15.19388919674981
2025-03-13 16:36:51,718 [INFO]: 	99p_search_speed_ms: 42.89489937247699
2025-03-13 16:36:51,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:51,718 [INFO]: 	nb vectors: 6948
2025-03-13 16:36:51,718 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:51,718 [INFO]: 	compression ratio: 0.9993083530943826
2025-03-13 16:36:51,718 [INFO]: }
2025-03-13 16:36:51,718 [INFO]: 	>>> Finished "Creating the index" in 110.7489 secs
2025-03-13 16:36:51,718 [INFO]: >>> Finished "Launching the whole pipeline" in 110.7960 secs
2025-03-13 16:36:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 78530 [episode count 14/20]
[retrieval_preprocessing] for episode 11460 [episode count 15/20], we have num_retrieval=np.int64(6654) num_query=np.int64(583)
2025-03-13 16:36:56,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:57,825 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:57
2025-03-13 16:36:57,825 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 860.72it/s]
2025-03-13 16:36:57,859 [INFO]: There are 6654 embeddings of dim 49152
2025-03-13 16:36:57,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 16:36:57,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:57
2025-03-13 16:36:57,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:57,859 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:36:57,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:57,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:57,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:57
2025-03-13 16:36:57,859 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:57,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:57,860 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:57
2025-03-13 16:36:57,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:57,860 [INFO]: 	Creating the index 03/13/2025, 16:36:57
2025-03-13 16:36:57,860 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:57
2025-03-13 16:36:57,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:36:57,861 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:57
2025-03-13 16:36:57,861 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:36:57,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.07it/s] 18%|█▊        | 5/28 [00:00<00:01, 21.57it/s] 32%|███▏      | 9/28 [00:00<00:00, 28.10it/s] 46%|████▋     | 13/28 [00:00<00:00, 31.84it/s] 64%|██████▍   | 18/28 [00:00<00:00, 36.36it/s] 79%|███████▊  | 22/28 [00:05<00:02,  2.26it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.50it/s]100%|██████████| 28/28 [00:07<00:00,  3.56it/s]
2025-03-13 16:37:05,736 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:05
2025-03-13 16:38:03,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.3217 secs
2025-03-13 16:38:03,059 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 16:38:03,059 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.83it/s]
2025-03-13 16:38:47,262 [INFO]: 	>>> Finished "Compute fast metrics" in 44.2026 secs
2025-03-13 16:38:47,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.4027 secs
2025-03-13 16:38:47,264 [INFO]: {
2025-03-13 16:38:47,264 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:47,264 [INFO]: 	index_param: efSearch=251
2025-03-13 16:38:47,264 [INFO]: 	index_path: knn.index
2025-03-13 16:38:47,264 [INFO]: 	size in bytes: 1309135090
2025-03-13 16:38:47,264 [INFO]: 	avg_search_speed_ms: 21.185706886541794
2025-03-13 16:38:47,264 [INFO]: 	99p_search_speed_ms: 40.579656141344614
2025-03-13 16:38:47,264 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:47,264 [INFO]: 	nb vectors: 6654
2025-03-13 16:38:47,264 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:47,264 [INFO]: 	compression ratio: 0.9993083540370153
2025-03-13 16:38:47,264 [INFO]: }
2025-03-13 16:38:47,264 [INFO]: 	>>> Finished "Creating the index" in 109.4042 secs
2025-03-13 16:38:47,264 [INFO]: >>> Finished "Launching the whole pipeline" in 109.4385 secs
2025-03-13 16:38:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 11460 [episode count 15/20]
[retrieval_preprocessing] for episode 6363 [episode count 16/20], we have num_retrieval=np.int64(6514) num_query=np.int64(723)
2025-03-13 16:38:57,685 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:59,509 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:59
2025-03-13 16:38:59,509 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.14it/s]
2025-03-13 16:38:59,542 [INFO]: There are 6514 embeddings of dim 49152
2025-03-13 16:38:59,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 16:38:59,543 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:59
2025-03-13 16:38:59,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:59,543 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:38:59,543 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:59,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:59,543 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:59
2025-03-13 16:38:59,543 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:59,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:38:59,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:59
2025-03-13 16:38:59,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:59,543 [INFO]: 	Creating the index 03/13/2025, 16:38:59
2025-03-13 16:38:59,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:59
2025-03-13 16:38:59,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:59,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:59
2025-03-13 16:38:59,544 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:38:59,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  7.69it/s] 19%|█▊        | 5/27 [00:00<00:00, 22.54it/s] 33%|███▎      | 9/27 [00:00<00:00, 29.59it/s] 52%|█████▏    | 14/27 [00:00<00:00, 34.12it/s] 70%|███████   | 19/27 [00:00<00:00, 36.47it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.41it/s]100%|██████████| 27/27 [00:08<00:00,  1.92it/s]100%|██████████| 27/27 [00:08<00:00,  3.16it/s]
2025-03-13 16:39:08,080 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:08
2025-03-13 16:40:07,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3126 secs
2025-03-13 16:40:07,393 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 16:40:07,393 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.98it/s]
2025-03-13 16:41:02,253 [INFO]: 	>>> Finished "Compute fast metrics" in 54.8600 secs
2025-03-13 16:41:02,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.7102 secs
2025-03-13 16:41:02,255 [INFO]: {
2025-03-13 16:41:02,255 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:02,255 [INFO]: 	index_param: efSearch=289
2025-03-13 16:41:02,255 [INFO]: 	index_path: knn.index
2025-03-13 16:41:02,255 [INFO]: 	size in bytes: 1281590770
2025-03-13 16:41:02,255 [INFO]: 	avg_search_speed_ms: 14.310148454341872
2025-03-13 16:41:02,255 [INFO]: 	99p_search_speed_ms: 22.451649820432056
2025-03-13 16:41:02,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:02,255 [INFO]: 	nb vectors: 6514
2025-03-13 16:41:02,255 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:02,255 [INFO]: 	compression ratio: 0.9993084703629693
2025-03-13 16:41:02,256 [INFO]: }
2025-03-13 16:41:02,256 [INFO]: 	>>> Finished "Creating the index" in 122.7125 secs
2025-03-13 16:41:02,256 [INFO]: >>> Finished "Launching the whole pipeline" in 122.7462 secs
2025-03-13 16:41:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 6363 [episode count 16/20]
[retrieval_preprocessing] for episode 41183 [episode count 17/20], we have num_retrieval=np.int64(7014) num_query=np.int64(223)
2025-03-13 16:41:12,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:13,422 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:13
2025-03-13 16:41:13,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 960.89it/s]
2025-03-13 16:41:13,453 [INFO]: There are 7014 embeddings of dim 49152
2025-03-13 16:41:13,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 16:41:13,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:13,454 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:41:13,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:13,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:41:13,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,454 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:13,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:41:13,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:13
2025-03-13 16:41:13,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:13,454 [INFO]: 	Creating the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:13
2025-03-13 16:41:13,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:41:13,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:13
2025-03-13 16:41:13,456 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:41:13,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.59it/s] 21%|██        | 6/29 [00:00<00:00, 25.31it/s] 38%|███▊      | 11/29 [00:00<00:00, 32.62it/s] 55%|█████▌    | 16/29 [00:00<00:00, 36.18it/s] 72%|███████▏  | 21/29 [00:06<00:03,  2.06it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.11it/s]100%|██████████| 29/29 [00:09<00:00,  3.07it/s]
2025-03-13 16:41:22,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:22
2025-03-13 16:42:29,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.1074 secs
2025-03-13 16:42:30,000 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:42:30,000 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.85it/s]
2025-03-13 16:43:27,748 [INFO]: 	>>> Finished "Compute fast metrics" in 57.7481 secs
2025-03-13 16:43:27,750 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.2939 secs
2025-03-13 16:43:27,750 [INFO]: {
2025-03-13 16:43:27,750 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:27,750 [INFO]: 	index_param: efSearch=219
2025-03-13 16:43:27,750 [INFO]: 	index_path: knn.index
2025-03-13 16:43:27,750 [INFO]: 	size in bytes: 1379963050
2025-03-13 16:43:27,750 [INFO]: 	avg_search_speed_ms: 13.835643709252071
2025-03-13 16:43:27,750 [INFO]: 	99p_search_speed_ms: 25.285443728789687
2025-03-13 16:43:27,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:27,750 [INFO]: 	nb vectors: 7014
2025-03-13 16:43:27,750 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:27,750 [INFO]: 	compression ratio: 0.9993082872762427
2025-03-13 16:43:27,750 [INFO]: }
2025-03-13 16:43:27,750 [INFO]: 	>>> Finished "Creating the index" in 134.2959 secs
2025-03-13 16:43:27,750 [INFO]: >>> Finished "Launching the whole pipeline" in 134.3282 secs
2025-03-13 16:43:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 41183 [episode count 17/20]
[retrieval_preprocessing] for episode 38117 [episode count 18/20], we have num_retrieval=np.int64(7075) num_query=np.int64(162)
2025-03-13 16:43:30,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:32,334 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:32
2025-03-13 16:43:32,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 964.43it/s]
2025-03-13 16:43:32,371 [INFO]: There are 7075 embeddings of dim 49152
2025-03-13 16:43:32,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 16:43:32,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:32,372 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:43:32,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:32,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:32,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,372 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:32,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:43:32,372 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:32
2025-03-13 16:43:32,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:32,372 [INFO]: 	Creating the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,372 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:32
2025-03-13 16:43:32,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:43:32,373 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:32
2025-03-13 16:43:32,374 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:43:32,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.55it/s] 17%|█▋        | 5/29 [00:00<00:01, 22.19it/s] 31%|███       | 9/29 [00:00<00:00, 28.90it/s] 45%|████▍     | 13/29 [00:00<00:00, 32.59it/s] 59%|█████▊    | 17/29 [00:00<00:00, 34.49it/s] 72%|███████▏  | 21/29 [00:06<00:04,  1.96it/s] 90%|████████▉ | 26/29 [00:06<00:00,  3.12it/s]100%|██████████| 29/29 [00:08<00:00,  3.43it/s]
2025-03-13 16:43:40,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:40
2025-03-13 16:44:45,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.4786 secs
2025-03-13 16:44:45,317 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 16:44:45,317 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 16:45:46,863 [INFO]: 	>>> Finished "Compute fast metrics" in 61.5461 secs
2025-03-13 16:45:46,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.4910 secs
2025-03-13 16:45:46,865 [INFO]: {
2025-03-13 16:45:46,865 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:46,865 [INFO]: 	index_param: efSearch=132
2025-03-13 16:45:46,865 [INFO]: 	index_path: knn.index
2025-03-13 16:45:46,865 [INFO]: 	size in bytes: 1391964370
2025-03-13 16:45:46,865 [INFO]: 	avg_search_speed_ms: 7.547669002505125
2025-03-13 16:45:46,865 [INFO]: 	99p_search_speed_ms: 11.4546771440655
2025-03-13 16:45:46,865 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:46,865 [INFO]: 	nb vectors: 7075
2025-03-13 16:45:46,865 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:46,865 [INFO]: 	compression ratio: 0.9993083371810731
2025-03-13 16:45:46,865 [INFO]: }
2025-03-13 16:45:46,865 [INFO]: 	>>> Finished "Creating the index" in 134.4926 secs
2025-03-13 16:45:46,865 [INFO]: >>> Finished "Launching the whole pipeline" in 134.5306 secs
2025-03-13 16:45:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 38117 [episode count 18/20]
[retrieval_preprocessing] for episode 8944 [episode count 19/20], we have num_retrieval=np.int64(7016) num_query=np.int64(221)
2025-03-13 16:45:48,460 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:49,725 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:49
2025-03-13 16:45:49,726 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.72it/s]
2025-03-13 16:45:49,758 [INFO]: There are 7016 embeddings of dim 49152
2025-03-13 16:45:49,758 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 16:45:49,758 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:49
2025-03-13 16:45:49,758 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:49,758 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:45:49,758 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:49,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:49,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:49
2025-03-13 16:45:49,758 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:49,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:49,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:49
2025-03-13 16:45:49,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:49,758 [INFO]: 	Creating the index 03/13/2025, 16:45:49
2025-03-13 16:45:49,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:49
2025-03-13 16:45:49,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:45:49,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:49
2025-03-13 16:45:49,760 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:45:49,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.29it/s] 21%|██        | 6/29 [00:00<00:00, 26.50it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.01it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.96it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.47it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.46it/s]100%|██████████| 29/29 [00:08<00:00,  2.47it/s]100%|██████████| 29/29 [00:08<00:00,  3.50it/s]
2025-03-13 16:45:58,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:58
2025-03-13 16:47:00,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.5056 secs
2025-03-13 16:47:00,558 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 16:47:00,558 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 16:47:50,939 [INFO]: 	>>> Finished "Compute fast metrics" in 50.3803 secs
2025-03-13 16:47:50,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.1807 secs
2025-03-13 16:47:50,941 [INFO]: {
2025-03-13 16:47:50,941 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:50,941 [INFO]: 	index_param: efSearch=254
2025-03-13 16:47:50,941 [INFO]: 	index_path: knn.index
2025-03-13 16:47:50,941 [INFO]: 	size in bytes: 1380356530
2025-03-13 16:47:50,941 [INFO]: 	avg_search_speed_ms: 13.870732634342515
2025-03-13 16:47:50,941 [INFO]: 	99p_search_speed_ms: 21.346743591129776
2025-03-13 16:47:50,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:50,941 [INFO]: 	nb vectors: 7016
2025-03-13 16:47:50,941 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:50,941 [INFO]: 	compression ratio: 0.9993082931987144
2025-03-13 16:47:50,941 [INFO]: }
2025-03-13 16:47:50,941 [INFO]: 	>>> Finished "Creating the index" in 121.1825 secs
2025-03-13 16:47:50,941 [INFO]: >>> Finished "Launching the whole pipeline" in 121.2154 secs
2025-03-13 16:47:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 8944 [episode count 19/20]
2025-03-13 16:47:54: [retrieval_preprocessing] finished for 8175789552_folding_clothes [chosen_id count 3/196]
2025-03-13 16:47:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8175789552_unfolding_clothes [chosen_id count 4/196]
2025-03-13 16:47:59: [retrieval_preprocessing] we have num_total=9448 embedding_dim=49152
[retrieval_preprocessing] for episode 16917 [episode count 0/20], we have num_retrieval=np.int64(9021) num_query=np.int64(427)
2025-03-13 16:48:00,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:02,130 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:02
2025-03-13 16:48:02,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.89it/s]
2025-03-13 16:48:02,171 [INFO]: There are 9021 embeddings of dim 49152
2025-03-13 16:48:02,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0416 secs
2025-03-13 16:48:02,172 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:02
2025-03-13 16:48:02,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:02,173 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 16:48:02,173 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:02,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:48:02,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:02
2025-03-13 16:48:02,174 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:02,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 16:48:02,175 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:02
2025-03-13 16:48:02,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:48:02,175 [INFO]: 	Creating the index 03/13/2025, 16:48:02
2025-03-13 16:48:02,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:02
2025-03-13 16:48:02,179 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:48:02,179 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:02
2025-03-13 16:48:02,179 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 16:48:02,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  8.13it/s] 14%|█▎        | 5/37 [00:00<00:01, 24.31it/s] 24%|██▍       | 9/37 [00:00<00:00, 30.86it/s] 35%|███▌      | 13/37 [00:00<00:00, 34.25it/s] 46%|████▌     | 17/37 [00:00<00:00, 36.03it/s] 57%|█████▋    | 21/37 [00:06<00:08,  1.80it/s] 65%|██████▍   | 24/37 [00:06<00:05,  2.32it/s] 70%|███████   | 26/37 [00:07<00:03,  2.76it/s] 76%|███████▌  | 28/37 [00:07<00:02,  3.32it/s] 81%|████████  | 30/37 [00:07<00:01,  3.97it/s] 86%|████████▋ | 32/37 [00:07<00:01,  4.67it/s] 92%|█████████▏| 34/37 [00:07<00:00,  5.42it/s] 97%|█████████▋| 36/37 [00:08<00:00,  6.15it/s]100%|██████████| 37/37 [00:13<00:00,  2.67it/s]
2025-03-13 16:48:16,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:16
2025-03-13 16:49:35,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1788 secs
2025-03-13 16:49:35,208 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:49:35,208 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 16:50:51,209 [INFO]: 	>>> Finished "Compute fast metrics" in 76.0007 secs
2025-03-13 16:50:51,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 169.0338 secs
2025-03-13 16:50:51,213 [INFO]: {
2025-03-13 16:50:51,213 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:51,213 [INFO]: 	index_param: efSearch=145
2025-03-13 16:50:51,213 [INFO]: 	index_path: knn.index
2025-03-13 16:50:51,213 [INFO]: 	size in bytes: 1774828390
2025-03-13 16:50:51,213 [INFO]: 	avg_search_speed_ms: 10.29074883879902
2025-03-13 16:50:51,213 [INFO]: 	99p_search_speed_ms: 18.055992419831448
2025-03-13 16:50:51,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:51,213 [INFO]: 	nb vectors: 9021
2025-03-13 16:50:51,213 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:51,213 [INFO]: 	compression ratio: 0.9993083150985657
2025-03-13 16:50:51,213 [INFO]: }
2025-03-13 16:50:51,214 [INFO]: 	>>> Finished "Creating the index" in 169.0381 secs
2025-03-13 16:50:51,214 [INFO]: >>> Finished "Launching the whole pipeline" in 169.0835 secs
2025-03-13 16:50:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 16917 [episode count 0/20]
[retrieval_preprocessing] for episode 88599 [episode count 1/20], we have num_retrieval=np.int64(8976) num_query=np.int64(472)
2025-03-13 16:50:58,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:00,098 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:00
2025-03-13 16:51:00,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 858.43it/s]
2025-03-13 16:51:00,134 [INFO]: There are 8976 embeddings of dim 49152
2025-03-13 16:51:00,134 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 16:51:00,134 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,135 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:00,135 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 16:51:00,135 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:00,135 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:51:00,135 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,136 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:00,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:51:00,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:00
2025-03-13 16:51:00,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:00,136 [INFO]: 	Creating the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:00
2025-03-13 16:51:00,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:51:00,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:00
2025-03-13 16:51:00,141 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:51:00,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.09it/s]  5%|▌         | 2/37 [00:00<00:06,  5.79it/s]  8%|▊         | 3/37 [00:00<00:04,  6.82it/s] 11%|█         | 4/37 [00:00<00:04,  7.23it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.57it/s] 16%|█▌        | 6/37 [00:00<00:04,  7.57it/s] 19%|█▉        | 7/37 [00:00<00:03,  7.75it/s] 22%|██▏       | 8/37 [00:01<00:03,  7.84it/s] 24%|██▍       | 9/37 [00:01<00:03,  7.85it/s] 27%|██▋       | 10/37 [00:01<00:03,  7.88it/s] 30%|██▉       | 11/37 [00:01<00:03,  8.04it/s] 32%|███▏      | 12/37 [00:01<00:03,  7.98it/s] 35%|███▌      | 13/37 [00:01<00:03,  7.93it/s] 38%|███▊      | 14/37 [00:01<00:02,  7.92it/s] 41%|████      | 15/37 [00:01<00:02,  8.04it/s] 46%|████▌     | 17/37 [00:02<00:02,  8.92it/s] 49%|████▊     | 18/37 [00:02<00:02,  8.97it/s] 51%|█████▏    | 19/37 [00:02<00:02,  8.99it/s] 54%|█████▍    | 20/37 [00:02<00:01,  9.02it/s] 57%|█████▋    | 21/37 [00:07<00:22,  1.43s/it] 62%|██████▏   | 23/37 [00:07<00:11,  1.20it/s] 68%|██████▊   | 25/37 [00:07<00:06,  1.84it/s] 73%|███████▎  | 27/37 [00:07<00:03,  2.64it/s] 76%|███████▌  | 28/37 [00:07<00:02,  3.07it/s] 81%|████████  | 30/37 [00:08<00:01,  4.16it/s] 84%|████████▍ | 31/37 [00:08<00:01,  4.73it/s] 86%|████████▋ | 32/37 [00:08<00:00,  5.36it/s] 92%|█████████▏| 34/37 [00:08<00:00,  6.65it/s] 97%|█████████▋| 36/37 [00:08<00:00,  7.63it/s]100%|██████████| 37/37 [00:13<00:00,  2.72it/s]
2025-03-13 16:51:13,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:13
2025-03-13 16:52:39,364 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.6207 secs
2025-03-13 16:52:39,365 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 16:52:39,365 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-13 16:53:46,438 [INFO]: 	>>> Finished "Compute fast metrics" in 67.0735 secs
2025-03-13 16:53:46,441 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 166.3008 secs
2025-03-13 16:53:46,442 [INFO]: {
2025-03-13 16:53:46,442 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:46,442 [INFO]: 	index_param: efSearch=159
2025-03-13 16:53:46,442 [INFO]: 	index_path: knn.index
2025-03-13 16:53:46,442 [INFO]: 	size in bytes: 1765974910
2025-03-13 16:53:46,442 [INFO]: 	avg_search_speed_ms: 11.869553758506774
2025-03-13 16:53:46,442 [INFO]: 	99p_search_speed_ms: 20.909665599465363
2025-03-13 16:53:46,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:46,442 [INFO]: 	nb vectors: 8976
2025-03-13 16:53:46,442 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:46,442 [INFO]: 	compression ratio: 0.9993083129363373
2025-03-13 16:53:46,442 [INFO]: }
2025-03-13 16:53:46,442 [INFO]: 	>>> Finished "Creating the index" in 166.3060 secs
2025-03-13 16:53:46,442 [INFO]: >>> Finished "Launching the whole pipeline" in 166.3441 secs
2025-03-13 16:53:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 88599 [episode count 1/20]
[retrieval_preprocessing] for episode 11816 [episode count 2/20], we have num_retrieval=np.int64(8941) num_query=np.int64(507)
2025-03-13 16:53:55,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:56,578 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:56
2025-03-13 16:53:56,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.50it/s]
2025-03-13 16:53:56,605 [INFO]: There are 8941 embeddings of dim 49152
2025-03-13 16:53:56,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:53:56,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:56,605 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 16:53:56,605 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:56,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:56,605 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,605 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:56,605 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:53:56,605 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:56
2025-03-13 16:53:56,605 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:56,605 [INFO]: 	Creating the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,605 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:56
2025-03-13 16:53:56,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:53:56,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,607 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:53:56,607 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.04it/s]  5%|▌         | 2/37 [00:00<00:05,  5.85it/s]  8%|▊         | 3/37 [00:00<00:04,  6.94it/s] 11%|█         | 4/37 [00:00<00:04,  7.47it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.74it/s] 16%|█▌        | 6/37 [00:00<00:03,  7.93it/s] 19%|█▉        | 7/37 [00:00<00:03,  8.06it/s] 22%|██▏       | 8/37 [00:01<00:03,  8.20it/s] 24%|██▍       | 9/37 [00:01<00:03,  8.22it/s] 27%|██▋       | 10/37 [00:01<00:03,  8.22it/s] 30%|██▉       | 11/37 [00:01<00:03,  8.17it/s] 32%|███▏      | 12/37 [00:01<00:03,  8.10it/s] 35%|███▌      | 13/37 [00:01<00:02,  8.16it/s] 38%|███▊      | 14/37 [00:01<00:02,  8.18it/s] 41%|████      | 15/37 [00:01<00:02,  8.20it/s] 46%|████▌     | 17/37 [00:02<00:02,  9.37it/s] 51%|█████▏    | 19/37 [00:02<00:01, 10.09it/s] 57%|█████▋    | 21/37 [00:06<00:13,  1.23it/s] 59%|█████▉    | 22/37 [00:06<00:10,  1.50it/s] 65%|██████▍   | 24/37 [00:06<00:05,  2.19it/s] 70%|███████   | 26/37 [00:06<00:03,  3.01it/s] 76%|███████▌  | 28/37 [00:07<00:02,  3.94it/s] 81%|████████  | 30/37 [00:07<00:01,  4.92it/s] 84%|████████▍ | 31/37 [00:07<00:01,  5.39it/s] 86%|████████▋ | 32/37 [00:07<00:00,  5.89it/s] 89%|████████▉ | 33/37 [00:07<00:00,  6.01it/s] 92%|█████████▏| 34/37 [00:07<00:00,  6.11it/s] 95%|█████████▍| 35/37 [00:07<00:00,  6.45it/s] 97%|█████████▋| 36/37 [00:08<00:00,  6.92it/s]100%|██████████| 37/37 [00:12<00:00,  1.32s/it]100%|██████████| 37/37 [00:12<00:00,  2.98it/s]
2025-03-13 16:54:09,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:09
2025-03-13 16:55:28,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.5452 secs
2025-03-13 16:55:28,561 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:55:28,561 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.31it/s] 50%|█████     | 2/4 [00:00<00:00,  5.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.47it/s]
2025-03-13 16:57:03,759 [INFO]: 	>>> Finished "Compute fast metrics" in 95.1984 secs
2025-03-13 16:57:03,762 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 187.1557 secs
2025-03-13 16:57:03,762 [INFO]: {
2025-03-13 16:57:03,762 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:03,762 [INFO]: 	index_param: efSearch=185
2025-03-13 16:57:03,762 [INFO]: 	index_path: knn.index
2025-03-13 16:57:03,762 [INFO]: 	size in bytes: 1759088650
2025-03-13 16:57:03,762 [INFO]: 	avg_search_speed_ms: 12.387782626968832
2025-03-13 16:57:03,762 [INFO]: 	99p_search_speed_ms: 18.947812519036216
2025-03-13 16:57:03,762 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:03,763 [INFO]: 	nb vectors: 8941
2025-03-13 16:57:03,763 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:03,763 [INFO]: 	compression ratio: 0.9993084362178108
2025-03-13 16:57:03,763 [INFO]: }
2025-03-13 16:57:03,763 [INFO]: 	>>> Finished "Creating the index" in 187.1573 secs
2025-03-13 16:57:03,763 [INFO]: >>> Finished "Launching the whole pipeline" in 187.1847 secs
2025-03-13 16:57:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 11816 [episode count 2/20]
[retrieval_preprocessing] for episode 86569 [episode count 3/20], we have num_retrieval=np.int64(8852) num_query=np.int64(596)
2025-03-13 16:57:11,928 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:13,962 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:13
2025-03-13 16:57:13,962 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1768.26it/s]
2025-03-13 16:57:13,989 [INFO]: There are 8852 embeddings of dim 49152
2025-03-13 16:57:13,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:57:13,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:13
2025-03-13 16:57:13,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:13,990 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 16:57:13,990 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:13,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:57:13,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:13
2025-03-13 16:57:13,991 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:13,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:57:13,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:13
2025-03-13 16:57:13,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:13,992 [INFO]: 	Creating the index 03/13/2025, 16:57:13
2025-03-13 16:57:13,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:13
2025-03-13 16:57:13,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:57:13,995 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:13
2025-03-13 16:57:13,996 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:57:13,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.42it/s]  6%|▌         | 2/36 [00:00<00:05,  5.89it/s]  8%|▊         | 3/36 [00:00<00:04,  6.76it/s] 11%|█         | 4/36 [00:00<00:04,  7.24it/s] 14%|█▍        | 5/36 [00:00<00:04,  7.56it/s] 17%|█▋        | 6/36 [00:00<00:03,  7.64it/s] 19%|█▉        | 7/36 [00:00<00:03,  7.86it/s] 22%|██▏       | 8/36 [00:01<00:03,  7.97it/s] 25%|██▌       | 9/36 [00:01<00:03,  8.16it/s] 28%|██▊       | 10/36 [00:01<00:03,  8.17it/s] 31%|███       | 11/36 [00:01<00:03,  8.31it/s] 33%|███▎      | 12/36 [00:01<00:02,  8.13it/s] 36%|███▌      | 13/36 [00:01<00:02,  8.04it/s] 39%|███▉      | 14/36 [00:01<00:02,  8.07it/s] 42%|████▏     | 15/36 [00:01<00:02,  7.97it/s] 44%|████▍     | 16/36 [00:02<00:02,  8.10it/s] 50%|█████     | 18/36 [00:02<00:01,  9.08it/s] 56%|█████▌    | 20/36 [00:02<00:01,  9.67it/s] 58%|█████▊    | 21/36 [00:06<00:15,  1.06s/it] 61%|██████    | 22/36 [00:06<00:11,  1.20it/s] 67%|██████▋   | 24/36 [00:07<00:06,  1.87it/s] 72%|███████▏  | 26/36 [00:07<00:03,  2.68it/s] 75%|███████▌  | 27/36 [00:07<00:02,  3.16it/s] 78%|███████▊  | 28/36 [00:07<00:02,  3.74it/s] 83%|████████▎ | 30/36 [00:07<00:01,  5.00it/s] 89%|████████▉ | 32/36 [00:07<00:00,  6.16it/s] 94%|█████████▍| 34/36 [00:08<00:00,  7.16it/s]100%|██████████| 36/36 [00:12<00:00,  1.28it/s]100%|██████████| 36/36 [00:12<00:00,  2.91it/s]
2025-03-13 16:57:26,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:26
2025-03-13 16:58:49,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.6891 secs
2025-03-13 16:58:49,063 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:58:49,063 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-13 16:59:43,292 [INFO]: 	>>> Finished "Compute fast metrics" in 54.2286 secs
2025-03-13 16:59:43,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.2999 secs
2025-03-13 16:59:43,296 [INFO]: {
2025-03-13 16:59:43,296 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:43,296 [INFO]: 	index_param: efSearch=177
2025-03-13 16:59:43,296 [INFO]: 	index_path: knn.index
2025-03-13 16:59:43,296 [INFO]: 	size in bytes: 1741578430
2025-03-13 16:59:43,296 [INFO]: 	avg_search_speed_ms: 13.944895655849384
2025-03-13 16:59:43,296 [INFO]: 	99p_search_speed_ms: 28.15541432239116
2025-03-13 16:59:43,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:43,296 [INFO]: 	nb vectors: 8852
2025-03-13 16:59:43,296 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:43,296 [INFO]: 	compression ratio: 0.999308435394437
2025-03-13 16:59:43,296 [INFO]: }
2025-03-13 16:59:43,296 [INFO]: 	>>> Finished "Creating the index" in 149.3040 secs
2025-03-13 16:59:43,296 [INFO]: >>> Finished "Launching the whole pipeline" in 149.3337 secs
2025-03-13 16:59:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 86569 [episode count 3/20]
[retrieval_preprocessing] for episode 28213 [episode count 4/20], we have num_retrieval=np.int64(8886) num_query=np.int64(562)
2025-03-13 16:59:53,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:54,917 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:54
2025-03-13 16:59:54,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 969.33it/s]
2025-03-13 16:59:54,942 [INFO]: There are 8886 embeddings of dim 49152
2025-03-13 16:59:54,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:59:54,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:54
2025-03-13 16:59:54,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:54,942 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 16:59:54,942 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:54,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:54,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:54
2025-03-13 16:59:54,942 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:54,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:54,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:54
2025-03-13 16:59:54,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:54,943 [INFO]: 	Creating the index 03/13/2025, 16:59:54
2025-03-13 16:59:54,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:54
2025-03-13 16:59:54,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:59:54,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:54
2025-03-13 16:59:54,944 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 16:59:54,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:09,  3.65it/s]  6%|▌         | 2/36 [00:00<00:05,  5.81it/s] 11%|█         | 4/36 [00:00<00:04,  7.85it/s] 14%|█▍        | 5/36 [00:00<00:03,  8.39it/s] 17%|█▋        | 6/36 [00:00<00:03,  8.75it/s] 19%|█▉        | 7/36 [00:00<00:03,  8.92it/s] 22%|██▏       | 8/36 [00:00<00:03,  9.13it/s] 25%|██▌       | 9/36 [00:01<00:02,  9.25it/s] 28%|██▊       | 10/36 [00:01<00:02,  9.34it/s] 31%|███       | 11/36 [00:01<00:02,  9.40it/s] 33%|███▎      | 12/36 [00:01<00:02,  9.44it/s] 36%|███▌      | 13/36 [00:01<00:02,  9.57it/s] 39%|███▉      | 14/36 [00:01<00:02,  9.55it/s] 42%|████▏     | 15/36 [00:01<00:02,  9.54it/s] 44%|████▍     | 16/36 [00:01<00:02,  9.65it/s] 50%|█████     | 18/36 [00:02<00:01,  9.84it/s] 56%|█████▌    | 20/36 [00:02<00:01,  9.97it/s] 58%|█████▊    | 21/36 [00:07<00:17,  1.14s/it] 61%|██████    | 22/36 [00:07<00:12,  1.12it/s] 67%|██████▋   | 24/36 [00:07<00:06,  1.77it/s] 72%|███████▏  | 26/36 [00:07<00:03,  2.58it/s] 78%|███████▊  | 28/36 [00:07<00:02,  3.53it/s] 83%|████████▎ | 30/36 [00:07<00:01,  4.58it/s] 89%|████████▉ | 32/36 [00:07<00:00,  5.69it/s] 94%|█████████▍| 34/36 [00:08<00:00,  6.72it/s]100%|██████████| 36/36 [00:12<00:00,  1.27it/s]100%|██████████| 36/36 [00:12<00:00,  2.85it/s]
2025-03-13 17:00:07,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:07
2025-03-13 17:01:16,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.6306 secs
2025-03-13 17:01:16,554 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 17:01:16,554 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 17:02:10,966 [INFO]: 	>>> Finished "Compute fast metrics" in 54.4116 secs
2025-03-13 17:02:10,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.0261 secs
2025-03-13 17:02:10,970 [INFO]: {
2025-03-13 17:02:10,970 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:10,970 [INFO]: 	index_param: efSearch=145
2025-03-13 17:02:10,970 [INFO]: 	index_path: knn.index
2025-03-13 17:02:10,970 [INFO]: 	size in bytes: 1748267710
2025-03-13 17:02:10,970 [INFO]: 	avg_search_speed_ms: 9.853691066124389
2025-03-13 17:02:10,970 [INFO]: 	99p_search_speed_ms: 15.822336282581094
2025-03-13 17:02:10,970 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:10,970 [INFO]: 	nb vectors: 8886
2025-03-13 17:02:10,970 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:10,970 [INFO]: 	compression ratio: 0.9993084457299735
2025-03-13 17:02:10,970 [INFO]: }
2025-03-13 17:02:10,970 [INFO]: 	>>> Finished "Creating the index" in 136.0277 secs
2025-03-13 17:02:10,970 [INFO]: >>> Finished "Launching the whole pipeline" in 136.0536 secs
2025-03-13 17:02:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 28213 [episode count 4/20]
[retrieval_preprocessing] for episode 33337 [episode count 5/20], we have num_retrieval=np.int64(9202) num_query=np.int64(246)
2025-03-13 17:02:20,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:22,209 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:22
2025-03-13 17:02:22,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.92it/s]
2025-03-13 17:02:22,234 [INFO]: There are 9202 embeddings of dim 49152
2025-03-13 17:02:22,234 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:02:22,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:22
2025-03-13 17:02:22,235 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:22,235 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 17:02:22,235 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:02:22,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:22,235 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:22
2025-03-13 17:02:22,235 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:22,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:02:22,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:22
2025-03-13 17:02:22,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:22,235 [INFO]: 	Creating the index 03/13/2025, 17:02:22
2025-03-13 17:02:22,235 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:22
2025-03-13 17:02:22,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:02:22,236 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:22
2025-03-13 17:02:22,236 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:02:22,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:08,  4.56it/s]  8%|▊         | 3/38 [00:00<00:04,  7.81it/s] 13%|█▎        | 5/38 [00:00<00:03,  8.78it/s] 16%|█▌        | 6/38 [00:00<00:03,  8.86it/s] 18%|█▊        | 7/38 [00:00<00:03,  8.90it/s] 21%|██        | 8/38 [00:00<00:03,  8.76it/s] 24%|██▎       | 9/38 [00:01<00:03,  8.42it/s] 26%|██▋       | 10/38 [00:01<00:03,  8.25it/s] 29%|██▉       | 11/38 [00:01<00:03,  7.68it/s] 32%|███▏      | 12/38 [00:01<00:03,  8.04it/s] 34%|███▍      | 13/38 [00:01<00:02,  8.49it/s] 37%|███▋      | 14/38 [00:01<00:02,  8.75it/s] 39%|███▉      | 15/38 [00:01<00:02,  8.85it/s] 42%|████▏     | 16/38 [00:01<00:02,  9.11it/s] 47%|████▋     | 18/38 [00:02<00:02,  9.40it/s] 53%|█████▎    | 20/38 [00:02<00:01,  9.62it/s] 55%|█████▌    | 21/38 [00:08<00:23,  1.40s/it] 58%|█████▊    | 22/38 [00:08<00:17,  1.09s/it] 61%|██████    | 23/38 [00:08<00:12,  1.19it/s] 63%|██████▎   | 24/38 [00:08<00:09,  1.55it/s] 66%|██████▌   | 25/38 [00:08<00:06,  2.00it/s] 68%|██████▊   | 26/38 [00:08<00:04,  2.55it/s] 71%|███████   | 27/38 [00:08<00:03,  3.17it/s] 74%|███████▎  | 28/38 [00:09<00:02,  3.87it/s] 76%|███████▋  | 29/38 [00:09<00:01,  4.71it/s] 79%|███████▉  | 30/38 [00:09<00:01,  5.55it/s] 84%|████████▍ | 32/38 [00:09<00:00,  7.02it/s] 87%|████████▋ | 33/38 [00:09<00:00,  7.58it/s] 89%|████████▉ | 34/38 [00:09<00:00,  8.08it/s] 95%|█████████▍| 36/38 [00:09<00:00,  8.86it/s]100%|██████████| 38/38 [00:15<00:00,  1.08s/it]100%|██████████| 38/38 [00:15<00:00,  2.49it/s]
2025-03-13 17:02:37,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:37
2025-03-13 17:03:59,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.0687 secs
2025-03-13 17:03:59,545 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:03:59,546 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.88it/s]
2025-03-13 17:04:30,525 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9791 secs
2025-03-13 17:04:30,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.2920 secs
2025-03-13 17:04:30,528 [INFO]: {
2025-03-13 17:04:30,528 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:30,528 [INFO]: 	index_param: efSearch=196
2025-03-13 17:04:30,528 [INFO]: 	index_path: knn.index
2025-03-13 17:04:30,528 [INFO]: 	size in bytes: 1810439170
2025-03-13 17:04:30,528 [INFO]: 	avg_search_speed_ms: 13.76301734746681
2025-03-13 17:04:30,528 [INFO]: 	99p_search_speed_ms: 19.80613245628774
2025-03-13 17:04:30,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:30,528 [INFO]: 	nb vectors: 9202
2025-03-13 17:04:30,528 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:30,528 [INFO]: 	compression ratio: 0.9993082595533989
2025-03-13 17:04:30,528 [INFO]: }
2025-03-13 17:04:30,528 [INFO]: 	>>> Finished "Creating the index" in 128.2934 secs
2025-03-13 17:04:30,528 [INFO]: >>> Finished "Launching the whole pipeline" in 128.3191 secs
2025-03-13 17:04:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 33337 [episode count 5/20]
[retrieval_preprocessing] for episode 32317 [episode count 6/20], we have num_retrieval=np.int64(9040) num_query=np.int64(408)
2025-03-13 17:04:36,560 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:38,080 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:38
2025-03-13 17:04:38,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.18it/s]
2025-03-13 17:04:38,104 [INFO]: There are 9040 embeddings of dim 49152
2025-03-13 17:04:38,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 17:04:38,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:38
2025-03-13 17:04:38,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:38,105 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 17:04:38,105 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:38,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:38,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:38
2025-03-13 17:04:38,105 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:38,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:38,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:38
2025-03-13 17:04:38,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:38,105 [INFO]: 	Creating the index 03/13/2025, 17:04:38
2025-03-13 17:04:38,105 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:38
2025-03-13 17:04:38,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:04:38,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:38
2025-03-13 17:04:38,106 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:04:38,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.31it/s]  5%|▌         | 2/37 [00:00<00:05,  6.07it/s]  8%|▊         | 3/37 [00:00<00:04,  6.98it/s] 11%|█         | 4/37 [00:00<00:04,  7.52it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.97it/s] 16%|█▌        | 6/37 [00:00<00:03,  8.16it/s] 19%|█▉        | 7/37 [00:00<00:03,  8.31it/s] 22%|██▏       | 8/37 [00:01<00:03,  8.38it/s] 24%|██▍       | 9/37 [00:01<00:03,  8.43it/s] 27%|██▋       | 10/37 [00:01<00:03,  8.50it/s] 30%|██▉       | 11/37 [00:01<00:03,  8.66it/s] 32%|███▏      | 12/37 [00:01<00:02,  8.56it/s] 35%|███▌      | 13/37 [00:01<00:02,  8.53it/s] 38%|███▊      | 14/37 [00:01<00:02,  8.60it/s] 41%|████      | 15/37 [00:01<00:02,  8.66it/s] 43%|████▎     | 16/37 [00:01<00:02,  8.74it/s] 46%|████▌     | 17/37 [00:02<00:02,  8.71it/s] 49%|████▊     | 18/37 [00:02<00:02,  8.69it/s] 51%|█████▏    | 19/37 [00:02<00:02,  8.63it/s] 54%|█████▍    | 20/37 [00:02<00:01,  8.70it/s] 57%|█████▋    | 21/37 [00:06<00:19,  1.21s/it] 59%|█████▉    | 22/37 [00:06<00:13,  1.14it/s] 65%|██████▍   | 24/37 [00:06<00:06,  1.96it/s] 70%|███████   | 26/37 [00:06<00:03,  2.94it/s] 76%|███████▌  | 28/37 [00:06<00:02,  4.05it/s] 81%|████████  | 30/37 [00:06<00:01,  5.24it/s] 86%|████████▋ | 32/37 [00:07<00:00,  6.40it/s] 92%|█████████▏| 34/37 [00:07<00:00,  7.57it/s] 97%|█████████▋| 36/37 [00:07<00:00,  8.58it/s]100%|██████████| 37/37 [00:11<00:00,  3.29it/s]
2025-03-13 17:04:49,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:49
2025-03-13 17:06:04,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.3872 secs
2025-03-13 17:06:04,753 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 17:06:04,753 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 17:06:35,161 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4077 secs
2025-03-13 17:06:35,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.0571 secs
2025-03-13 17:06:35,164 [INFO]: {
2025-03-13 17:06:35,164 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:35,164 [INFO]: 	index_param: efSearch=139
2025-03-13 17:06:35,164 [INFO]: 	index_path: knn.index
2025-03-13 17:06:35,164 [INFO]: 	size in bytes: 1778566510
2025-03-13 17:06:35,164 [INFO]: 	avg_search_speed_ms: 9.501519584665667
2025-03-13 17:06:35,164 [INFO]: 	99p_search_speed_ms: 15.427752304822208
2025-03-13 17:06:35,164 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:35,164 [INFO]: 	nb vectors: 9040
2025-03-13 17:06:35,164 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:35,164 [INFO]: 	compression ratio: 0.9993083249948297
2025-03-13 17:06:35,164 [INFO]: }
2025-03-13 17:06:35,164 [INFO]: 	>>> Finished "Creating the index" in 117.0585 secs
2025-03-13 17:06:35,164 [INFO]: >>> Finished "Launching the whole pipeline" in 117.0833 secs
2025-03-13 17:06:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 32317 [episode count 6/20]
[retrieval_preprocessing] for episode 79428 [episode count 7/20], we have num_retrieval=np.int64(8963) num_query=np.int64(485)
2025-03-13 17:06:42,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:43,364 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:43
2025-03-13 17:06:43,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1270.23it/s]
2025-03-13 17:06:43,389 [INFO]: There are 8963 embeddings of dim 49152
2025-03-13 17:06:43,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:06:43,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:43
2025-03-13 17:06:43,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:43,389 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:06:43,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:43,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:06:43,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:43
2025-03-13 17:06:43,390 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:43,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:06:43,390 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:43
2025-03-13 17:06:43,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:43,390 [INFO]: 	Creating the index 03/13/2025, 17:06:43
2025-03-13 17:06:43,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:43
2025-03-13 17:06:43,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:06:43,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:43
2025-03-13 17:06:43,391 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:06:43,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:06,  5.53it/s]  8%|▊         | 3/37 [00:00<00:03, 10.72it/s] 14%|█▎        | 5/37 [00:00<00:02, 12.99it/s] 19%|█▉        | 7/37 [00:00<00:02, 14.35it/s] 24%|██▍       | 9/37 [00:00<00:01, 15.65it/s] 30%|██▉       | 11/37 [00:00<00:01, 16.10it/s] 35%|███▌      | 13/37 [00:00<00:01, 16.53it/s] 41%|████      | 15/37 [00:00<00:01, 17.25it/s] 46%|████▌     | 17/37 [00:01<00:01, 17.25it/s] 51%|█████▏    | 19/37 [00:01<00:01, 17.42it/s] 57%|█████▋    | 21/37 [00:05<00:11,  1.43it/s] 62%|██████▏   | 23/37 [00:05<00:07,  1.93it/s] 68%|██████▊   | 25/37 [00:05<00:04,  2.57it/s] 73%|███████▎  | 27/37 [00:06<00:02,  3.34it/s] 78%|███████▊  | 29/37 [00:06<00:01,  4.16it/s] 84%|████████▍ | 31/37 [00:06<00:01,  5.05it/s] 89%|████████▉ | 33/37 [00:06<00:00,  5.89it/s] 95%|█████████▍| 35/37 [00:06<00:00,  6.76it/s]100%|██████████| 37/37 [00:11<00:00,  1.19it/s]100%|██████████| 37/37 [00:11<00:00,  3.13it/s]
2025-03-13 17:06:55,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:55
2025-03-13 17:08:15,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.6650 secs
2025-03-13 17:08:15,882 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 17:08:15,882 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.82it/s] 50%|█████     | 2/4 [00:00<00:00,  4.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.48it/s]
2025-03-13 17:08:44,779 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8971 secs
2025-03-13 17:08:45,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.6426 secs
2025-03-13 17:08:45,034 [INFO]: {
2025-03-13 17:08:45,034 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:45,034 [INFO]: 	index_param: efSearch=152
2025-03-13 17:08:45,034 [INFO]: 	index_path: knn.index
2025-03-13 17:08:45,034 [INFO]: 	size in bytes: 1763417230
2025-03-13 17:08:45,034 [INFO]: 	avg_search_speed_ms: 16.16234154183183
2025-03-13 17:08:45,035 [INFO]: 	99p_search_speed_ms: 28.13552929554136
2025-03-13 17:08:45,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:45,035 [INFO]: 	nb vectors: 8963
2025-03-13 17:08:45,035 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:45,035 [INFO]: 	compression ratio: 0.9993083168411596
2025-03-13 17:08:45,035 [INFO]: }
2025-03-13 17:08:45,035 [INFO]: 	>>> Finished "Creating the index" in 121.6451 secs
2025-03-13 17:08:45,035 [INFO]: >>> Finished "Launching the whole pipeline" in 121.6708 secs
2025-03-13 17:08:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 79428 [episode count 7/20]
[retrieval_preprocessing] for episode 75884 [episode count 8/20], we have num_retrieval=np.int64(9190) num_query=np.int64(258)
2025-03-13 17:08:52,473 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:54,163 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:54
2025-03-13 17:08:54,163 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2103.46it/s]
2025-03-13 17:08:54,189 [INFO]: There are 9190 embeddings of dim 49152
2025-03-13 17:08:54,190 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:08:54,190 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:54
2025-03-13 17:08:54,190 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:54,190 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 17:08:54,190 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:08:54,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:54,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:54
2025-03-13 17:08:54,190 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:54,190 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:08:54,190 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:54
2025-03-13 17:08:54,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:54,190 [INFO]: 	Creating the index 03/13/2025, 17:08:54
2025-03-13 17:08:54,190 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:54
2025-03-13 17:08:54,191 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:08:54,192 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:54
2025-03-13 17:08:54,192 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:08:54,192 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:10,  3.47it/s]  5%|▌         | 2/38 [00:00<00:06,  5.63it/s] 11%|█         | 4/38 [00:00<00:04,  8.07it/s] 16%|█▌        | 6/38 [00:00<00:03,  9.07it/s] 21%|██        | 8/38 [00:00<00:03,  9.53it/s] 26%|██▋       | 10/38 [00:01<00:02,  9.72it/s] 29%|██▉       | 11/38 [00:01<00:02,  9.71it/s] 32%|███▏      | 12/38 [00:01<00:02,  9.64it/s] 34%|███▍      | 13/38 [00:01<00:02,  9.69it/s] 37%|███▋      | 14/38 [00:01<00:02,  9.51it/s] 39%|███▉      | 15/38 [00:01<00:02,  9.37it/s] 42%|████▏     | 16/38 [00:01<00:02,  9.38it/s] 45%|████▍     | 17/38 [00:01<00:02,  9.38it/s] 47%|████▋     | 18/38 [00:02<00:02,  9.32it/s] 50%|█████     | 19/38 [00:02<00:02,  9.33it/s] 53%|█████▎    | 20/38 [00:02<00:01,  9.11it/s] 55%|█████▌    | 21/38 [00:07<00:25,  1.52s/it] 58%|█████▊    | 22/38 [00:07<00:17,  1.10s/it] 63%|██████▎   | 24/38 [00:07<00:08,  1.58it/s] 66%|██████▌   | 25/38 [00:07<00:06,  1.97it/s] 71%|███████   | 27/38 [00:07<00:03,  3.01it/s] 76%|███████▋  | 29/38 [00:07<00:02,  4.12it/s] 82%|████████▏ | 31/38 [00:08<00:01,  5.27it/s] 87%|████████▋ | 33/38 [00:08<00:00,  6.36it/s] 92%|█████████▏| 35/38 [00:08<00:00,  7.38it/s] 97%|█████████▋| 37/38 [00:08<00:00,  8.32it/s]100%|██████████| 38/38 [00:13<00:00,  2.84it/s]
2025-03-13 17:09:07,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:07
2025-03-13 17:10:28,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.5057 secs
2025-03-13 17:10:28,061 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:10:28,061 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 17:11:35,653 [INFO]: 	>>> Finished "Compute fast metrics" in 67.5921 secs
2025-03-13 17:11:35,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.6255 secs
2025-03-13 17:11:35,817 [INFO]: {
2025-03-13 17:11:35,818 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:35,818 [INFO]: 	index_param: efSearch=191
2025-03-13 17:11:35,818 [INFO]: 	index_path: knn.index
2025-03-13 17:11:35,818 [INFO]: 	size in bytes: 1808078170
2025-03-13 17:11:35,818 [INFO]: 	avg_search_speed_ms: 14.966156199842157
2025-03-13 17:11:35,818 [INFO]: 	99p_search_speed_ms: 24.71271379385144
2025-03-13 17:11:35,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:35,818 [INFO]: 	nb vectors: 9190
2025-03-13 17:11:35,818 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:35,818 [INFO]: 	compression ratio: 0.9993082987114434
2025-03-13 17:11:35,818 [INFO]: }
2025-03-13 17:11:35,818 [INFO]: 	>>> Finished "Creating the index" in 161.6279 secs
2025-03-13 17:11:35,818 [INFO]: >>> Finished "Launching the whole pipeline" in 161.6549 secs
2025-03-13 17:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 75884 [episode count 8/20]
[retrieval_preprocessing] for episode 9837 [episode count 9/20], we have num_retrieval=np.int64(8968) num_query=np.int64(480)
2025-03-13 17:11:43,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:44,910 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:44
2025-03-13 17:11:44,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 906.09it/s]
2025-03-13 17:11:44,940 [INFO]: There are 8968 embeddings of dim 49152
2025-03-13 17:11:44,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 17:11:44,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:44
2025-03-13 17:11:44,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:44,941 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:11:44,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:44,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:11:44,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:44
2025-03-13 17:11:44,942 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:44,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:11:44,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:44
2025-03-13 17:11:44,942 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:44,943 [INFO]: 	Creating the index 03/13/2025, 17:11:44
2025-03-13 17:11:44,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:44
2025-03-13 17:11:44,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:11:44,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:44
2025-03-13 17:11:44,947 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:11:44,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.10it/s]  5%|▌         | 2/37 [00:00<00:06,  5.61it/s]  8%|▊         | 3/37 [00:00<00:05,  6.43it/s] 11%|█         | 4/37 [00:00<00:04,  7.07it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.40it/s] 16%|█▌        | 6/37 [00:00<00:04,  7.64it/s] 19%|█▉        | 7/37 [00:00<00:03,  7.76it/s] 22%|██▏       | 8/37 [00:01<00:03,  7.87it/s] 24%|██▍       | 9/37 [00:01<00:03,  7.97it/s] 27%|██▋       | 10/37 [00:01<00:03,  7.97it/s] 30%|██▉       | 11/37 [00:01<00:03,  7.94it/s] 32%|███▏      | 12/37 [00:01<00:03,  7.92it/s] 35%|███▌      | 13/37 [00:01<00:03,  7.94it/s] 38%|███▊      | 14/37 [00:01<00:02,  7.92it/s] 41%|████      | 15/37 [00:01<00:02,  7.93it/s] 43%|████▎     | 16/37 [00:02<00:02,  8.13it/s] 46%|████▌     | 17/37 [00:02<00:02,  8.11it/s] 49%|████▊     | 18/37 [00:02<00:02,  8.08it/s] 51%|█████▏    | 19/37 [00:02<00:02,  8.21it/s] 57%|█████▋    | 21/37 [00:07<00:18,  1.13s/it] 59%|█████▉    | 22/37 [00:07<00:13,  1.13it/s] 62%|██████▏   | 23/37 [00:07<00:09,  1.48it/s] 68%|██████▊   | 25/37 [00:07<00:05,  2.33it/s] 73%|███████▎  | 27/37 [00:07<00:03,  3.31it/s] 76%|███████▌  | 28/37 [00:07<00:02,  3.86it/s] 78%|███████▊  | 29/37 [00:07<00:01,  4.46it/s] 81%|████████  | 30/37 [00:08<00:01,  5.08it/s] 84%|████████▍ | 31/37 [00:08<00:01,  5.73it/s] 86%|████████▋ | 32/37 [00:08<00:00,  6.41it/s] 89%|████████▉ | 33/37 [00:08<00:00,  7.06it/s] 92%|█████████▏| 34/37 [00:08<00:00,  7.66it/s] 95%|█████████▍| 35/37 [00:08<00:00,  8.14it/s] 97%|█████████▋| 36/37 [00:08<00:00,  8.55it/s]100%|██████████| 37/37 [00:12<00:00,  1.36s/it]100%|██████████| 37/37 [00:12<00:00,  2.85it/s]
2025-03-13 17:11:57,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:57
2025-03-13 17:13:22,267 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.3141 secs
2025-03-13 17:13:22,267 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:13:22,267 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 17:14:15,716 [INFO]: 	>>> Finished "Compute fast metrics" in 53.4489 secs
2025-03-13 17:14:15,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.7733 secs
2025-03-13 17:14:15,720 [INFO]: {
2025-03-13 17:14:15,720 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:15,720 [INFO]: 	index_param: efSearch=177
2025-03-13 17:14:15,720 [INFO]: 	index_path: knn.index
2025-03-13 17:14:15,720 [INFO]: 	size in bytes: 1764400930
2025-03-13 17:14:15,720 [INFO]: 	avg_search_speed_ms: 13.330884478098344
2025-03-13 17:14:15,720 [INFO]: 	99p_search_speed_ms: 19.75379150826484
2025-03-13 17:14:15,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:15,720 [INFO]: 	nb vectors: 8968
2025-03-13 17:14:15,720 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:15,720 [INFO]: 	compression ratio: 0.9993083284081017
2025-03-13 17:14:15,720 [INFO]: }
2025-03-13 17:14:15,720 [INFO]: 	>>> Finished "Creating the index" in 150.7775 secs
2025-03-13 17:14:15,720 [INFO]: >>> Finished "Launching the whole pipeline" in 150.8106 secs
2025-03-13 17:14:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 9837 [episode count 9/20]
[retrieval_preprocessing] for episode 627 [episode count 10/20], we have num_retrieval=np.int64(8958) num_query=np.int64(490)
2025-03-13 17:14:25,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:26,611 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:26
2025-03-13 17:14:26,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.35it/s]
2025-03-13 17:14:26,637 [INFO]: There are 8958 embeddings of dim 49152
2025-03-13 17:14:26,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:14:26,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:26,637 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:14:26,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:26,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:26,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,637 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:26,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:26,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:26
2025-03-13 17:14:26,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:26,637 [INFO]: 	Creating the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:26
2025-03-13 17:14:26,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:14:26,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,639 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:14:26,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:09,  3.91it/s]  5%|▌         | 2/37 [00:00<00:06,  5.38it/s]  8%|▊         | 3/37 [00:00<00:05,  6.12it/s] 11%|█         | 4/37 [00:00<00:05,  6.09it/s] 14%|█▎        | 5/37 [00:00<00:05,  6.27it/s] 16%|█▌        | 6/37 [00:00<00:04,  6.64it/s] 19%|█▉        | 7/37 [00:01<00:04,  7.29it/s] 22%|██▏       | 8/37 [00:01<00:03,  7.41it/s] 24%|██▍       | 9/37 [00:01<00:03,  7.16it/s] 27%|██▋       | 10/37 [00:01<00:03,  7.33it/s] 30%|██▉       | 11/37 [00:01<00:03,  7.69it/s] 32%|███▏      | 12/37 [00:01<00:03,  7.99it/s] 38%|███▊      | 14/37 [00:01<00:02,  9.22it/s] 43%|████▎     | 16/37 [00:02<00:02, 10.37it/s] 49%|████▊     | 18/37 [00:02<00:01, 11.13it/s] 54%|█████▍    | 20/37 [00:02<00:01, 11.78it/s] 59%|█████▉    | 22/37 [00:08<00:14,  1.01it/s] 62%|██████▏   | 23/37 [00:08<00:11,  1.21it/s] 65%|██████▍   | 24/37 [00:08<00:08,  1.48it/s] 68%|██████▊   | 25/37 [00:08<00:06,  1.81it/s] 70%|███████   | 26/37 [00:08<00:04,  2.23it/s] 73%|███████▎  | 27/37 [00:08<00:03,  2.73it/s] 76%|███████▌  | 28/37 [00:08<00:02,  3.27it/s] 78%|███████▊  | 29/37 [00:08<00:02,  3.87it/s] 81%|████████  | 30/37 [00:09<00:01,  4.44it/s] 84%|████████▍ | 31/37 [00:09<00:01,  4.97it/s] 86%|████████▋ | 32/37 [00:09<00:00,  5.43it/s] 89%|████████▉ | 33/37 [00:09<00:00,  5.82it/s] 92%|█████████▏| 34/37 [00:09<00:00,  6.42it/s] 95%|█████████▍| 35/37 [00:09<00:00,  6.97it/s] 97%|█████████▋| 36/37 [00:09<00:00,  7.62it/s]100%|██████████| 37/37 [00:14<00:00,  1.42s/it]100%|██████████| 37/37 [00:14<00:00,  2.58it/s]
2025-03-13 17:14:41,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:41
2025-03-13 17:16:07,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.9969 secs
2025-03-13 17:16:07,010 [INFO]: The best hyperparameters are: efSearch=115
2025-03-13 17:16:07,010 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.86it/s] 50%|█████     | 2/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-13 17:16:49,461 [INFO]: 	>>> Finished "Compute fast metrics" in 42.4512 secs
2025-03-13 17:16:49,466 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.8272 secs
2025-03-13 17:16:49,466 [INFO]: {
2025-03-13 17:16:49,466 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:49,466 [INFO]: 	index_param: efSearch=115
2025-03-13 17:16:49,466 [INFO]: 	index_path: knn.index
2025-03-13 17:16:49,466 [INFO]: 	size in bytes: 1762433470
2025-03-13 17:16:49,466 [INFO]: 	avg_search_speed_ms: 9.513579152363196
2025-03-13 17:16:49,466 [INFO]: 	99p_search_speed_ms: 17.2213320620358
2025-03-13 17:16:49,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:49,466 [INFO]: 	nb vectors: 8958
2025-03-13 17:16:49,466 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:49,466 [INFO]: 	compression ratio: 0.9993083392815957
2025-03-13 17:16:49,466 [INFO]: }
2025-03-13 17:16:49,466 [INFO]: 	>>> Finished "Creating the index" in 142.8287 secs
2025-03-13 17:16:49,466 [INFO]: >>> Finished "Launching the whole pipeline" in 142.8547 secs
2025-03-13 17:16:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 627 [episode count 10/20]
[retrieval_preprocessing] for episode 79990 [episode count 11/20], we have num_retrieval=np.int64(9032) num_query=np.int64(416)
2025-03-13 17:16:56,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:58,097 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:58
2025-03-13 17:16:58,097 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-13 17:16:58,121 [INFO]: There are 9032 embeddings of dim 49152
2025-03-13 17:16:58,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:16:58,122 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:58
2025-03-13 17:16:58,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:58,122 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 17:16:58,122 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:58,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:58,122 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:58
2025-03-13 17:16:58,122 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:58,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:58,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:58
2025-03-13 17:16:58,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:58,122 [INFO]: 	Creating the index 03/13/2025, 17:16:58
2025-03-13 17:16:58,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:58
2025-03-13 17:16:58,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:16:58,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:58
2025-03-13 17:16:58,123 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:16:58,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:09,  3.97it/s]  5%|▌         | 2/37 [00:00<00:06,  5.28it/s] 11%|█         | 4/37 [00:00<00:04,  7.89it/s] 16%|█▌        | 6/37 [00:00<00:03,  9.07it/s] 22%|██▏       | 8/37 [00:00<00:02,  9.81it/s] 27%|██▋       | 10/37 [00:01<00:02, 10.17it/s] 32%|███▏      | 12/37 [00:01<00:02, 10.35it/s] 38%|███▊      | 14/37 [00:01<00:02, 10.58it/s] 43%|████▎     | 16/37 [00:01<00:01, 10.67it/s] 49%|████▊     | 18/37 [00:01<00:01, 10.76it/s] 54%|█████▍    | 20/37 [00:02<00:01, 10.84it/s] 59%|█████▉    | 22/37 [00:06<00:10,  1.37it/s] 65%|██████▍   | 24/37 [00:06<00:06,  1.88it/s] 70%|███████   | 26/37 [00:06<00:04,  2.52it/s] 76%|███████▌  | 28/37 [00:06<00:02,  3.31it/s] 81%|████████  | 30/37 [00:07<00:01,  4.29it/s] 86%|████████▋ | 32/37 [00:07<00:00,  5.33it/s] 92%|█████████▏| 34/37 [00:07<00:00,  6.40it/s] 97%|█████████▋| 36/37 [00:07<00:00,  6.30it/s]100%|██████████| 37/37 [00:12<00:00,  2.93it/s]
2025-03-13 17:17:10,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:10
2025-03-13 17:18:31,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.7904 secs
2025-03-13 17:18:31,553 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 17:18:31,553 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 17:19:14,427 [INFO]: 	>>> Finished "Compute fast metrics" in 42.8735 secs
2025-03-13 17:19:14,430 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.3067 secs
2025-03-13 17:19:14,430 [INFO]: {
2025-03-13 17:19:14,430 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:14,430 [INFO]: 	index_param: efSearch=161
2025-03-13 17:19:14,430 [INFO]: 	index_path: knn.index
2025-03-13 17:19:14,430 [INFO]: 	size in bytes: 1776992530
2025-03-13 17:19:14,430 [INFO]: 	avg_search_speed_ms: 11.32363849767776
2025-03-13 17:19:14,430 [INFO]: 	99p_search_speed_ms: 19.229132230393567
2025-03-13 17:19:14,430 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:14,430 [INFO]: 	nb vectors: 9032
2025-03-13 17:19:14,430 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:14,430 [INFO]: 	compression ratio: 0.9993083403676435
2025-03-13 17:19:14,430 [INFO]: }
2025-03-13 17:19:14,430 [INFO]: 	>>> Finished "Creating the index" in 136.3083 secs
2025-03-13 17:19:14,430 [INFO]: >>> Finished "Launching the whole pipeline" in 136.3335 secs
2025-03-13 17:19:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 79990 [episode count 11/20]
[retrieval_preprocessing] for episode 35967 [episode count 12/20], we have num_retrieval=np.int64(8997) num_query=np.int64(451)
2025-03-13 17:19:22,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:23,862 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:23
2025-03-13 17:19:23,863 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1997.29it/s]
2025-03-13 17:19:23,886 [INFO]: There are 8997 embeddings of dim 49152
2025-03-13 17:19:23,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 17:19:23,887 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:23
2025-03-13 17:19:23,887 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:23,887 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:19:23,887 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:23,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:23,887 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:23
2025-03-13 17:19:23,887 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:23,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:23,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:23
2025-03-13 17:19:23,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:23,887 [INFO]: 	Creating the index 03/13/2025, 17:19:23
2025-03-13 17:19:23,887 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:23
2025-03-13 17:19:23,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:19:23,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:23
2025-03-13 17:19:23,888 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:19:23,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:07,  4.58it/s]  5%|▌         | 2/37 [00:00<00:05,  6.60it/s] 11%|█         | 4/37 [00:00<00:03,  8.39it/s] 14%|█▎        | 5/37 [00:00<00:03,  8.74it/s] 19%|█▉        | 7/37 [00:00<00:03,  9.30it/s] 24%|██▍       | 9/37 [00:00<00:02, 11.28it/s] 30%|██▉       | 11/37 [00:01<00:01, 13.07it/s] 35%|███▌      | 13/37 [00:01<00:01, 12.48it/s] 41%|████      | 15/37 [00:01<00:01, 11.87it/s] 46%|████▌     | 17/37 [00:01<00:01, 11.37it/s] 51%|█████▏    | 19/37 [00:01<00:01, 11.14it/s] 57%|█████▋    | 21/37 [00:06<00:13,  1.16it/s] 59%|█████▉    | 22/37 [00:07<00:10,  1.38it/s] 65%|██████▍   | 24/37 [00:07<00:06,  1.97it/s] 70%|███████   | 26/37 [00:07<00:04,  2.72it/s] 76%|███████▌  | 28/37 [00:07<00:02,  3.60it/s] 81%|████████  | 30/37 [00:07<00:01,  4.60it/s] 86%|████████▋ | 32/37 [00:07<00:00,  5.68it/s] 92%|█████████▏| 34/37 [00:08<00:00,  6.73it/s] 97%|█████████▋| 36/37 [00:08<00:00,  7.82it/s]100%|██████████| 37/37 [00:12<00:00,  2.93it/s]
2025-03-13 17:19:36,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:36
2025-03-13 17:20:57,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.4636 secs
2025-03-13 17:20:57,972 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:20:57,972 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.10it/s]
2025-03-13 17:21:35,903 [INFO]: 	>>> Finished "Compute fast metrics" in 37.9314 secs
2025-03-13 17:21:35,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.0184 secs
2025-03-13 17:21:35,907 [INFO]: {
2025-03-13 17:21:35,907 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:35,907 [INFO]: 	index_param: efSearch=153
2025-03-13 17:21:35,907 [INFO]: 	index_path: knn.index
2025-03-13 17:21:35,907 [INFO]: 	size in bytes: 1770106510
2025-03-13 17:21:35,907 [INFO]: 	avg_search_speed_ms: 12.451233094381829
2025-03-13 17:21:35,907 [INFO]: 	99p_search_speed_ms: 19.26703715696931
2025-03-13 17:21:35,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:35,907 [INFO]: 	nb vectors: 8997
2025-03-13 17:21:35,907 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:35,907 [INFO]: 	compression ratio: 0.9993083274971968
2025-03-13 17:21:35,907 [INFO]: }
2025-03-13 17:21:35,907 [INFO]: 	>>> Finished "Creating the index" in 132.0200 secs
2025-03-13 17:21:35,907 [INFO]: >>> Finished "Launching the whole pipeline" in 132.0446 secs
2025-03-13 17:21:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 35967 [episode count 12/20]
[retrieval_preprocessing] for episode 19596 [episode count 13/20], we have num_retrieval=np.int64(8951) num_query=np.int64(497)
2025-03-13 17:21:42,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:44,344 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:44
2025-03-13 17:21:44,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.20it/s]
2025-03-13 17:21:44,898 [INFO]: There are 8951 embeddings of dim 49152
2025-03-13 17:21:44,898 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5540 secs
2025-03-13 17:21:44,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:44
2025-03-13 17:21:44,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:44,899 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:21:44,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:44,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:21:44,899 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:44
2025-03-13 17:21:44,899 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:44,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:21:44,899 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:44
2025-03-13 17:21:44,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:44,900 [INFO]: 	Creating the index 03/13/2025, 17:21:44
2025-03-13 17:21:44,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:44
2025-03-13 17:21:44,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:21:44,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:44
2025-03-13 17:21:44,902 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:21:44,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:07,  4.66it/s]  8%|▊         | 3/37 [00:00<00:04,  8.20it/s] 14%|█▎        | 5/37 [00:00<00:03,  9.55it/s] 19%|█▉        | 7/37 [00:00<00:02, 10.19it/s] 24%|██▍       | 9/37 [00:00<00:02, 10.56it/s] 30%|██▉       | 11/37 [00:01<00:02, 10.56it/s] 35%|███▌      | 13/37 [00:01<00:02, 10.61it/s] 41%|████      | 15/37 [00:01<00:02, 10.69it/s] 46%|████▌     | 17/37 [00:01<00:01, 11.27it/s] 51%|█████▏    | 19/37 [00:01<00:01, 10.93it/s] 57%|█████▋    | 21/37 [00:06<00:12,  1.24it/s] 59%|█████▉    | 22/37 [00:06<00:10,  1.47it/s] 62%|██████▏   | 23/37 [00:06<00:07,  1.77it/s] 65%|██████▍   | 24/37 [00:06<00:05,  2.17it/s] 68%|██████▊   | 25/37 [00:07<00:04,  2.67it/s] 70%|███████   | 26/37 [00:07<00:03,  3.28it/s] 76%|███████▌  | 28/37 [00:07<00:01,  4.60it/s] 81%|████████  | 30/37 [00:07<00:01,  5.78it/s] 86%|████████▋ | 32/37 [00:07<00:00,  6.86it/s] 92%|█████████▏| 34/37 [00:07<00:00,  7.82it/s] 97%|█████████▋| 36/37 [00:08<00:00,  8.65it/s]100%|██████████| 37/37 [00:12<00:00,  2.93it/s]
2025-03-13 17:21:57,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:57
2025-03-13 17:23:17,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.2555 secs
2025-03-13 17:23:17,773 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 17:23:17,773 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 17:24:00,298 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5250 secs
2025-03-13 17:24:00,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 135.3991 secs
2025-03-13 17:24:00,301 [INFO]: {
2025-03-13 17:24:00,301 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:00,301 [INFO]: 	index_param: efSearch=152
2025-03-13 17:24:00,301 [INFO]: 	index_path: knn.index
2025-03-13 17:24:00,301 [INFO]: 	size in bytes: 1761056290
2025-03-13 17:24:00,301 [INFO]: 	avg_search_speed_ms: 10.628958579348787
2025-03-13 17:24:00,301 [INFO]: 	99p_search_speed_ms: 15.132244629785426
2025-03-13 17:24:00,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:00,301 [INFO]: 	nb vectors: 8951
2025-03-13 17:24:00,301 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:00,301 [INFO]: 	compression ratio: 0.9993083230746701
2025-03-13 17:24:00,301 [INFO]: }
2025-03-13 17:24:00,302 [INFO]: 	>>> Finished "Creating the index" in 135.4018 secs
2025-03-13 17:24:00,302 [INFO]: >>> Finished "Launching the whole pipeline" in 135.9572 secs
2025-03-13 17:24:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 19596 [episode count 13/20]
[retrieval_preprocessing] for episode 27808 [episode count 14/20], we have num_retrieval=np.int64(8995) num_query=np.int64(453)
2025-03-13 17:24:08,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:09,765 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:09
2025-03-13 17:24:09,765 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 17:24:09,789 [INFO]: There are 8995 embeddings of dim 49152
2025-03-13 17:24:09,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 17:24:09,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:09
2025-03-13 17:24:09,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:09,789 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:24:09,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:09,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:09,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:09
2025-03-13 17:24:09,790 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:09,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:24:09,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:09
2025-03-13 17:24:09,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:09,790 [INFO]: 	Creating the index 03/13/2025, 17:24:09
2025-03-13 17:24:09,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:09
2025-03-13 17:24:09,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:24:09,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:09
2025-03-13 17:24:09,791 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:24:09,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.19it/s]  5%|▌         | 2/37 [00:00<00:06,  5.49it/s]  8%|▊         | 3/37 [00:00<00:05,  6.62it/s] 11%|█         | 4/37 [00:00<00:04,  6.60it/s] 16%|█▌        | 6/37 [00:00<00:03,  8.28it/s] 22%|██▏       | 8/37 [00:00<00:02, 10.31it/s] 27%|██▋       | 10/37 [00:01<00:02, 11.57it/s] 32%|███▏      | 12/37 [00:01<00:02,  9.07it/s] 38%|███▊      | 14/37 [00:01<00:02,  8.65it/s] 43%|████▎     | 16/37 [00:01<00:02, 10.01it/s] 49%|████▊     | 18/37 [00:01<00:01, 11.05it/s] 54%|█████▍    | 20/37 [00:02<00:01, 11.97it/s] 59%|█████▉    | 22/37 [00:06<00:10,  1.43it/s] 62%|██████▏   | 23/37 [00:06<00:08,  1.68it/s] 65%|██████▍   | 24/37 [00:06<00:06,  2.00it/s] 68%|██████▊   | 25/37 [00:06<00:05,  2.39it/s] 70%|███████   | 26/37 [00:06<00:03,  2.91it/s] 73%|███████▎  | 27/37 [00:06<00:02,  3.52it/s] 76%|███████▌  | 28/37 [00:06<00:02,  4.21it/s] 78%|███████▊  | 29/37 [00:07<00:01,  4.91it/s] 81%|████████  | 30/37 [00:07<00:01,  5.60it/s] 84%|████████▍ | 31/37 [00:07<00:00,  6.28it/s] 86%|████████▋ | 32/37 [00:07<00:00,  6.87it/s] 92%|█████████▏| 34/37 [00:07<00:00,  7.96it/s] 95%|█████████▍| 35/37 [00:07<00:00,  8.34it/s] 97%|█████████▋| 36/37 [00:07<00:00,  8.66it/s]100%|██████████| 37/37 [00:12<00:00,  1.35s/it]100%|██████████| 37/37 [00:12<00:00,  2.95it/s]
2025-03-13 17:24:22,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:22
2025-03-13 17:25:41,960 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.6351 secs
2025-03-13 17:25:41,961 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 17:25:41,961 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.49it/s] 50%|█████     | 2/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.11it/s]
2025-03-13 17:26:18,931 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9699 secs
2025-03-13 17:26:18,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.1445 secs
2025-03-13 17:26:18,935 [INFO]: {
2025-03-13 17:26:18,935 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:18,935 [INFO]: 	index_param: efSearch=159
2025-03-13 17:26:18,935 [INFO]: 	index_path: knn.index
2025-03-13 17:26:18,935 [INFO]: 	size in bytes: 1769713030
2025-03-13 17:26:18,935 [INFO]: 	avg_search_speed_ms: 13.348050754037356
2025-03-13 17:26:18,935 [INFO]: 	99p_search_speed_ms: 22.945493031293154
2025-03-13 17:26:18,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:18,936 [INFO]: 	nb vectors: 8995
2025-03-13 17:26:18,936 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:18,936 [INFO]: 	compression ratio: 0.9993083228866773
2025-03-13 17:26:18,936 [INFO]: }
2025-03-13 17:26:18,936 [INFO]: 	>>> Finished "Creating the index" in 129.1459 secs
2025-03-13 17:26:18,936 [INFO]: >>> Finished "Launching the whole pipeline" in 129.1708 secs
2025-03-13 17:26:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 27808 [episode count 14/20]
[retrieval_preprocessing] for episode 6308 [episode count 15/20], we have num_retrieval=np.int64(8972) num_query=np.int64(476)
2025-03-13 17:26:26,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:29,159 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:29
2025-03-13 17:26:29,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.12it/s]
2025-03-13 17:26:29,188 [INFO]: There are 8972 embeddings of dim 49152
2025-03-13 17:26:29,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 17:26:29,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:29
2025-03-13 17:26:29,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:29,189 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:26:29,189 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:29,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:26:29,189 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:29
2025-03-13 17:26:29,189 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:29,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:26:29,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:29
2025-03-13 17:26:29,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:29,190 [INFO]: 	Creating the index 03/13/2025, 17:26:29
2025-03-13 17:26:29,190 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:29
2025-03-13 17:26:29,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:26:29,193 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:29
2025-03-13 17:26:29,193 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:26:29,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.46it/s]  5%|▌         | 2/37 [00:00<00:06,  5.69it/s]  8%|▊         | 3/37 [00:00<00:05,  6.78it/s] 11%|█         | 4/37 [00:00<00:04,  7.44it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.87it/s] 16%|█▌        | 6/37 [00:00<00:03,  8.09it/s] 22%|██▏       | 8/37 [00:00<00:02,  9.84it/s] 27%|██▋       | 10/37 [00:01<00:02, 10.82it/s] 32%|███▏      | 12/37 [00:01<00:02, 11.04it/s] 38%|███▊      | 14/37 [00:01<00:02, 11.23it/s] 43%|████▎     | 16/37 [00:01<00:01, 11.32it/s] 49%|████▊     | 18/37 [00:01<00:01, 11.48it/s] 54%|█████▍    | 20/37 [00:01<00:01, 11.95it/s] 59%|█████▉    | 22/37 [00:06<00:11,  1.32it/s] 62%|██████▏   | 23/37 [00:06<00:08,  1.57it/s] 68%|██████▊   | 25/37 [00:06<00:05,  2.23it/s] 73%|███████▎  | 27/37 [00:06<00:03,  3.08it/s] 78%|███████▊  | 29/37 [00:07<00:02,  3.97it/s] 84%|████████▍ | 31/37 [00:07<00:01,  4.97it/s] 89%|████████▉ | 33/37 [00:07<00:00,  6.12it/s] 95%|█████████▍| 35/37 [00:07<00:00,  7.10it/s]100%|██████████| 37/37 [00:12<00:00,  1.30it/s]100%|██████████| 37/37 [00:12<00:00,  3.08it/s]
2025-03-13 17:26:41,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:41
2025-03-13 17:27:57,507 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2839 secs
2025-03-13 17:27:57,507 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 17:27:57,507 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s]
2025-03-13 17:28:41,542 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0346 secs
2025-03-13 17:28:41,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.3982 secs
2025-03-13 17:28:41,592 [INFO]: {
2025-03-13 17:28:41,592 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:41,592 [INFO]: 	index_param: efSearch=160
2025-03-13 17:28:41,592 [INFO]: 	index_path: knn.index
2025-03-13 17:28:41,592 [INFO]: 	size in bytes: 1765187950
2025-03-13 17:28:41,592 [INFO]: 	avg_search_speed_ms: 10.566315470104044
2025-03-13 17:28:41,592 [INFO]: 	99p_search_speed_ms: 18.181507512927013
2025-03-13 17:28:41,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:41,592 [INFO]: 	nb vectors: 8972
2025-03-13 17:28:41,592 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:41,592 [INFO]: 	compression ratio: 0.9993083036851684
2025-03-13 17:28:41,592 [INFO]: }
2025-03-13 17:28:41,593 [INFO]: 	>>> Finished "Creating the index" in 132.4028 secs
2025-03-13 17:28:41,593 [INFO]: >>> Finished "Launching the whole pipeline" in 132.4339 secs
2025-03-13 17:28:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 6308 [episode count 15/20]
[retrieval_preprocessing] for episode 81586 [episode count 16/20], we have num_retrieval=np.int64(8686) num_query=np.int64(762)
2025-03-13 17:28:47,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:48,813 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:48
2025-03-13 17:28:48,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 949.80it/s]
2025-03-13 17:28:48,840 [INFO]: There are 8686 embeddings of dim 49152
2025-03-13 17:28:48,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 17:28:48,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:48
2025-03-13 17:28:48,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:48,841 [INFO]: 		-> Add: 4.8 seconds
2025-03-13 17:28:48,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:48,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:48,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:48
2025-03-13 17:28:48,841 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:48,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:28:48,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:48
2025-03-13 17:28:48,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:48,841 [INFO]: 	Creating the index 03/13/2025, 17:28:48
2025-03-13 17:28:48,841 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:48
2025-03-13 17:28:48,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:28:48,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:48
2025-03-13 17:28:48,843 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:28:48,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:06,  5.05it/s]  8%|▊         | 3/36 [00:00<00:03,  8.72it/s] 14%|█▍        | 5/36 [00:00<00:03, 10.01it/s] 19%|█▉        | 7/36 [00:00<00:02, 10.75it/s] 25%|██▌       | 9/36 [00:00<00:02, 10.96it/s] 31%|███       | 11/36 [00:01<00:02, 11.17it/s] 36%|███▌      | 13/36 [00:01<00:02, 11.31it/s] 42%|████▏     | 15/36 [00:01<00:01, 11.22it/s] 47%|████▋     | 17/36 [00:01<00:01, 11.30it/s] 53%|█████▎    | 19/36 [00:01<00:01, 11.13it/s] 58%|█████▊    | 21/36 [00:05<00:10,  1.48it/s] 64%|██████▍   | 23/36 [00:05<00:06,  2.01it/s] 69%|██████▉   | 25/36 [00:06<00:04,  2.69it/s] 75%|███████▌  | 27/36 [00:06<00:02,  3.49it/s] 81%|████████  | 29/36 [00:06<00:01,  4.44it/s] 86%|████████▌ | 31/36 [00:06<00:00,  5.65it/s] 94%|█████████▍| 34/36 [00:06<00:00,  8.09it/s]100%|██████████| 36/36 [00:10<00:00,  1.85it/s]100%|██████████| 36/36 [00:10<00:00,  3.58it/s]
2025-03-13 17:28:58,889 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:58
2025-03-13 17:30:20,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.5841 secs
2025-03-13 17:30:20,473 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 17:30:20,473 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s]
2025-03-13 17:31:06,325 [INFO]: 	>>> Finished "Compute fast metrics" in 45.8514 secs
2025-03-13 17:31:06,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.4869 secs
2025-03-13 17:31:06,330 [INFO]: {
2025-03-13 17:31:06,330 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:06,330 [INFO]: 	index_param: efSearch=165
2025-03-13 17:31:06,330 [INFO]: 	index_path: knn.index
2025-03-13 17:31:06,330 [INFO]: 	size in bytes: 1708918990
2025-03-13 17:31:06,330 [INFO]: 	avg_search_speed_ms: 12.3977847221334
2025-03-13 17:31:06,330 [INFO]: 	99p_search_speed_ms: 21.182207777164873
2025-03-13 17:31:06,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:06,330 [INFO]: 	nb vectors: 8686
2025-03-13 17:31:06,330 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:06,330 [INFO]: 	compression ratio: 0.9993083920262364
2025-03-13 17:31:06,330 [INFO]: }
2025-03-13 17:31:06,330 [INFO]: 	>>> Finished "Creating the index" in 137.4886 secs
2025-03-13 17:31:06,330 [INFO]: >>> Finished "Launching the whole pipeline" in 137.5165 secs
2025-03-13 17:31:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 81586 [episode count 16/20]
[retrieval_preprocessing] for episode 63674 [episode count 17/20], we have num_retrieval=np.int64(9053) num_query=np.int64(395)
2025-03-13 17:31:15,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:17,388 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:17
2025-03-13 17:31:17,388 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.05it/s]
2025-03-13 17:31:17,412 [INFO]: There are 9053 embeddings of dim 49152
2025-03-13 17:31:17,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:31:17,412 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:17
2025-03-13 17:31:17,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:17,413 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 17:31:17,413 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:17,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:17,413 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:17
2025-03-13 17:31:17,413 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:17,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:31:17,413 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:17
2025-03-13 17:31:17,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:17,413 [INFO]: 	Creating the index 03/13/2025, 17:31:17
2025-03-13 17:31:17,413 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:17
2025-03-13 17:31:17,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:31:17,414 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:17
2025-03-13 17:31:17,414 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 17:31:17,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:08,  4.10it/s]  5%|▌         | 2/37 [00:00<00:06,  5.72it/s]  8%|▊         | 3/37 [00:00<00:05,  6.73it/s] 11%|█         | 4/37 [00:00<00:04,  7.31it/s] 14%|█▎        | 5/37 [00:00<00:04,  7.63it/s] 16%|█▌        | 6/37 [00:00<00:03,  7.84it/s] 19%|█▉        | 7/37 [00:00<00:03,  8.02it/s] 22%|██▏       | 8/37 [00:01<00:03,  8.18it/s] 24%|██▍       | 9/37 [00:01<00:03,  8.16it/s] 30%|██▉       | 11/37 [00:01<00:03,  8.65it/s] 32%|███▏      | 12/37 [00:01<00:02,  8.54it/s] 35%|███▌      | 13/37 [00:01<00:02,  8.52it/s] 38%|███▊      | 14/37 [00:01<00:02,  8.42it/s] 41%|████      | 15/37 [00:01<00:02,  8.29it/s] 46%|████▌     | 17/37 [00:02<00:02,  9.64it/s] 49%|████▊     | 18/37 [00:02<00:01,  9.65it/s] 51%|█████▏    | 19/37 [00:02<00:01,  9.65it/s] 57%|█████▋    | 21/37 [00:06<00:15,  1.02it/s] 59%|█████▉    | 22/37 [00:06<00:11,  1.28it/s] 62%|██████▏   | 23/37 [00:06<00:08,  1.64it/s] 68%|██████▊   | 25/37 [00:07<00:04,  2.56it/s] 73%|███████▎  | 27/37 [00:07<00:02,  3.60it/s] 78%|███████▊  | 29/37 [00:07<00:01,  4.67it/s] 84%|████████▍ | 31/37 [00:07<00:01,  5.66it/s] 89%|████████▉ | 33/37 [00:07<00:00,  6.60it/s] 95%|█████████▍| 35/37 [00:07<00:00,  7.35it/s] 97%|█████████▋| 36/37 [00:08<00:00,  7.58it/s]100%|██████████| 37/37 [00:12<00:00,  1.04s/it]100%|██████████| 37/37 [00:12<00:00,  2.94it/s]
2025-03-13 17:31:29,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:29
2025-03-13 17:32:51,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.3655 secs
2025-03-13 17:32:51,360 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:32:51,360 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-13 17:33:30,951 [INFO]: 	>>> Finished "Compute fast metrics" in 39.5912 secs
2025-03-13 17:33:30,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.5403 secs
2025-03-13 17:33:30,954 [INFO]: {
2025-03-13 17:33:30,954 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:30,954 [INFO]: 	index_param: efSearch=175
2025-03-13 17:33:30,954 [INFO]: 	index_path: knn.index
2025-03-13 17:33:30,954 [INFO]: 	size in bytes: 1781124190
2025-03-13 17:33:30,954 [INFO]: 	avg_search_speed_ms: 11.977355433404892
2025-03-13 17:33:30,954 [INFO]: 	99p_search_speed_ms: 17.67870050389317
2025-03-13 17:33:30,954 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:30,954 [INFO]: 	nb vectors: 9053
2025-03-13 17:33:30,954 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:30,954 [INFO]: 	compression ratio: 0.999308321111511
2025-03-13 17:33:30,954 [INFO]: }
2025-03-13 17:33:30,955 [INFO]: 	>>> Finished "Creating the index" in 133.5416 secs
2025-03-13 17:33:30,955 [INFO]: >>> Finished "Launching the whole pipeline" in 133.5666 secs
2025-03-13 17:33:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 63674 [episode count 17/20]
[retrieval_preprocessing] for episode 75455 [episode count 18/20], we have num_retrieval=np.int64(8976) num_query=np.int64(472)
2025-03-13 17:33:38,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:39,700 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:39
2025-03-13 17:33:39,700 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 17:33:39,724 [INFO]: There are 8976 embeddings of dim 49152
2025-03-13 17:33:39,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 17:33:39,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:39
2025-03-13 17:33:39,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:39,724 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:33:39,724 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:39,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:39,724 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:39
2025-03-13 17:33:39,724 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:39,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:39,724 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:39
2025-03-13 17:33:39,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:39,724 [INFO]: 	Creating the index 03/13/2025, 17:33:39
2025-03-13 17:33:39,724 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:39
2025-03-13 17:33:39,725 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:33:39,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:39
2025-03-13 17:33:39,726 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:33:39,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:07,  4.58it/s]  8%|▊         | 3/37 [00:00<00:03,  8.62it/s] 14%|█▎        | 5/37 [00:00<00:03, 10.18it/s] 19%|█▉        | 7/37 [00:00<00:02, 10.91it/s] 24%|██▍       | 9/37 [00:00<00:02, 11.75it/s] 30%|██▉       | 11/37 [00:01<00:02, 11.89it/s] 35%|███▌      | 13/37 [00:01<00:01, 12.04it/s] 41%|████      | 15/37 [00:01<00:01, 12.07it/s] 46%|████▌     | 17/37 [00:01<00:01, 12.11it/s] 51%|█████▏    | 19/37 [00:01<00:01, 12.21it/s] 57%|█████▋    | 21/37 [00:05<00:10,  1.51it/s] 62%|██████▏   | 23/37 [00:05<00:06,  2.06it/s] 68%|██████▊   | 25/37 [00:05<00:04,  2.75it/s] 73%|███████▎  | 27/37 [00:06<00:02,  3.61it/s] 78%|███████▊  | 29/37 [00:06<00:01,  4.58it/s] 84%|████████▍ | 31/37 [00:06<00:01,  5.64it/s] 89%|████████▉ | 33/37 [00:06<00:00,  6.75it/s] 95%|█████████▍| 35/37 [00:06<00:00,  7.74it/s]100%|██████████| 37/37 [00:11<00:00,  1.33it/s]100%|██████████| 37/37 [00:11<00:00,  3.32it/s]
2025-03-13 17:33:50,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:50
2025-03-13 17:35:21,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.6982 secs
2025-03-13 17:35:21,581 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 17:35:21,581 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 17:36:10,734 [INFO]: 	>>> Finished "Compute fast metrics" in 49.1529 secs
2025-03-13 17:36:10,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.0109 secs
2025-03-13 17:36:10,737 [INFO]: {
2025-03-13 17:36:10,737 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:10,737 [INFO]: 	index_param: efSearch=119
2025-03-13 17:36:10,737 [INFO]: 	index_path: knn.index
2025-03-13 17:36:10,737 [INFO]: 	size in bytes: 1765974910
2025-03-13 17:36:10,737 [INFO]: 	avg_search_speed_ms: 9.216199599824469
2025-03-13 17:36:10,737 [INFO]: 	99p_search_speed_ms: 16.51640464551748
2025-03-13 17:36:10,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:10,737 [INFO]: 	nb vectors: 8976
2025-03-13 17:36:10,737 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:10,737 [INFO]: 	compression ratio: 0.9993083129363373
2025-03-13 17:36:10,737 [INFO]: }
2025-03-13 17:36:10,737 [INFO]: 	>>> Finished "Creating the index" in 151.0125 secs
2025-03-13 17:36:10,737 [INFO]: >>> Finished "Launching the whole pipeline" in 151.0368 secs
2025-03-13 17:36:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 75455 [episode count 18/20]
[retrieval_preprocessing] for episode 36034 [episode count 19/20], we have num_retrieval=np.int64(8853) num_query=np.int64(595)
2025-03-13 17:36:17,608 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:19,186 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:19
2025-03-13 17:36:19,186 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.84it/s]
2025-03-13 17:36:19,211 [INFO]: There are 8853 embeddings of dim 49152
2025-03-13 17:36:19,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:36:19,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:19
2025-03-13 17:36:19,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:19,212 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 17:36:19,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:19,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:19,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:19
2025-03-13 17:36:19,212 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:19,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:19,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:19
2025-03-13 17:36:19,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:19,212 [INFO]: 	Creating the index 03/13/2025, 17:36:19
2025-03-13 17:36:19,212 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:19
2025-03-13 17:36:19,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:36:19,213 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:19
2025-03-13 17:36:19,213 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 17:36:19,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.78it/s]  8%|▊         | 3/36 [00:00<00:03,  8.37it/s] 14%|█▍        | 5/36 [00:00<00:03,  9.89it/s] 19%|█▉        | 7/36 [00:00<00:02, 10.57it/s] 25%|██▌       | 9/36 [00:00<00:02, 11.25it/s] 31%|███       | 11/36 [00:01<00:02, 11.67it/s] 36%|███▌      | 13/36 [00:01<00:01, 12.11it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.48it/s] 47%|████▋     | 17/36 [00:01<00:01, 13.11it/s] 53%|█████▎    | 19/36 [00:01<00:01, 13.77it/s] 58%|█████▊    | 21/36 [00:05<00:09,  1.54it/s] 61%|██████    | 22/36 [00:05<00:07,  1.81it/s] 67%|██████▋   | 24/36 [00:05<00:04,  2.56it/s] 72%|███████▏  | 26/36 [00:05<00:02,  3.45it/s] 78%|███████▊  | 28/36 [00:06<00:01,  4.45it/s] 83%|████████▎ | 30/36 [00:06<00:01,  5.51it/s] 89%|████████▉ | 32/36 [00:06<00:00,  6.39it/s] 94%|█████████▍| 34/36 [00:06<00:00,  6.58it/s] 97%|█████████▋| 35/36 [00:06<00:00,  6.87it/s]100%|██████████| 36/36 [00:11<00:00,  1.03it/s]100%|██████████| 36/36 [00:11<00:00,  3.26it/s]
2025-03-13 17:36:30,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:30
2025-03-13 17:37:48,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.0766 secs
2025-03-13 17:37:48,983 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:37:48,983 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 17:38:49,112 [INFO]: 	>>> Finished "Compute fast metrics" in 60.1294 secs
2025-03-13 17:38:49,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.9020 secs
2025-03-13 17:38:49,115 [INFO]: {
2025-03-13 17:38:49,116 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:49,116 [INFO]: 	index_param: efSearch=175
2025-03-13 17:38:49,116 [INFO]: 	index_path: knn.index
2025-03-13 17:38:49,116 [INFO]: 	size in bytes: 1741775170
2025-03-13 17:38:49,116 [INFO]: 	avg_search_speed_ms: 12.252240904547529
2025-03-13 17:38:49,116 [INFO]: 	99p_search_speed_ms: 23.572614113800242
2025-03-13 17:38:49,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:49,116 [INFO]: 	nb vectors: 8853
2025-03-13 17:38:49,116 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:49,116 [INFO]: 	compression ratio: 0.9993084377244854
2025-03-13 17:38:49,116 [INFO]: }
2025-03-13 17:38:49,116 [INFO]: 	>>> Finished "Creating the index" in 149.9035 secs
2025-03-13 17:38:49,116 [INFO]: >>> Finished "Launching the whole pipeline" in 149.9295 secs
2025-03-13 17:38:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 36034 [episode count 19/20]
2025-03-13 17:38:56: [retrieval_preprocessing] finished for 8175789552_unfolding_clothes [chosen_id count 4/196]
2025-03-13 17:38:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8351259745_close_door [chosen_id count 5/196]
2025-03-13 17:38:58: [retrieval_preprocessing] we have num_total=2570 embedding_dim=49152
[retrieval_preprocessing] for episode 82434 [episode count 0/20], we have num_retrieval=np.int64(2477) num_query=np.int64(93)
2025-03-13 17:38:59,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:00,118 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:00
2025-03-13 17:39:00,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.31it/s]
2025-03-13 17:39:00,146 [INFO]: There are 2477 embeddings of dim 49152
2025-03-13 17:39:00,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:39:00,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:00
2025-03-13 17:39:00,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:00,147 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:39:00,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:00,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:39:00,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:00
2025-03-13 17:39:00,147 [INFO]: 511.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:00,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:00,147 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:00
2025-03-13 17:39:00,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:00,147 [INFO]: 	Creating the index 03/13/2025, 17:39:00
2025-03-13 17:39:00,147 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:00
2025-03-13 17:39:00,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:39:00,149 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:00
2025-03-13 17:39:00,149 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:39:00,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.47it/s] 20%|██        | 2/10 [00:00<00:01,  6.81it/s] 30%|███       | 3/10 [00:00<00:00,  7.43it/s] 40%|████      | 4/10 [00:00<00:00,  7.74it/s] 50%|█████     | 5/10 [00:00<00:00,  7.95it/s] 60%|██████    | 6/10 [00:00<00:00,  7.95it/s] 70%|███████   | 7/10 [00:00<00:00,  7.96it/s] 80%|████████  | 8/10 [00:01<00:00,  7.94it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.92it/s]100%|██████████| 10/10 [00:03<00:00,  1.24it/s]100%|██████████| 10/10 [00:03<00:00,  2.86it/s]
2025-03-13 17:39:03,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:03
2025-03-13 17:39:34,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8520 secs
2025-03-13 17:39:34,503 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:39:34,503 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 17:39:56,429 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9259 secs
2025-03-13 17:39:56,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2821 secs
2025-03-13 17:39:56,431 [INFO]: {
2025-03-13 17:39:56,431 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:56,431 [INFO]: 	index_param: efSearch=223
2025-03-13 17:39:56,431 [INFO]: 	index_path: knn.index
2025-03-13 17:39:56,431 [INFO]: 	size in bytes: 487334230
2025-03-13 17:39:56,431 [INFO]: 	avg_search_speed_ms: 8.259285250786325
2025-03-13 17:39:56,431 [INFO]: 	99p_search_speed_ms: 11.95705616846681
2025-03-13 17:39:56,431 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:56,431 [INFO]: 	nb vectors: 2477
2025-03-13 17:39:56,431 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:56,431 [INFO]: 	compression ratio: 0.9993100956606311
2025-03-13 17:39:56,431 [INFO]: }
2025-03-13 17:39:56,431 [INFO]: 	>>> Finished "Creating the index" in 56.2836 secs
2025-03-13 17:39:56,431 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3125 secs
2025-03-13 17:39:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 82434 [episode count 0/20]
[retrieval_preprocessing] for episode 1040 [episode count 1/20], we have num_retrieval=np.int64(2409) num_query=np.int64(161)
2025-03-13 17:39:58,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:58,591 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:58
2025-03-13 17:39:58,591 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.87it/s]
2025-03-13 17:39:58,616 [INFO]: There are 2409 embeddings of dim 49152
2025-03-13 17:39:58,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:39:58,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:58
2025-03-13 17:39:58,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:58,616 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:39:58,616 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:58,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:58,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:58
2025-03-13 17:39:58,616 [INFO]: 497.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:58,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:39:58,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:58
2025-03-13 17:39:58,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:58,616 [INFO]: 	Creating the index 03/13/2025, 17:39:58
2025-03-13 17:39:58,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:58
2025-03-13 17:39:58,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:39:58,617 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:58
2025-03-13 17:39:58,617 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:39:58,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.27it/s] 20%|██        | 2/10 [00:00<00:01,  6.54it/s] 30%|███       | 3/10 [00:00<00:00,  7.07it/s] 40%|████      | 4/10 [00:00<00:00,  7.34it/s] 50%|█████     | 5/10 [00:00<00:00,  7.50it/s] 60%|██████    | 6/10 [00:00<00:00,  7.61it/s] 70%|███████   | 7/10 [00:00<00:00,  7.74it/s] 80%|████████  | 8/10 [00:01<00:00,  7.73it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.66it/s]100%|██████████| 10/10 [00:03<00:00,  1.32it/s]100%|██████████| 10/10 [00:03<00:00,  2.97it/s]
2025-03-13 17:40:01,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:01
2025-03-13 17:40:32,382 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3894 secs
2025-03-13 17:40:32,383 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:40:32,383 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-13 17:40:56,263 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8799 secs
2025-03-13 17:40:56,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6476 secs
2025-03-13 17:40:56,265 [INFO]: {
2025-03-13 17:40:56,265 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:56,265 [INFO]: 	index_param: efSearch=155
2025-03-13 17:40:56,265 [INFO]: 	index_path: knn.index
2025-03-13 17:40:56,265 [INFO]: 	size in bytes: 473955850
2025-03-13 17:40:56,265 [INFO]: 	avg_search_speed_ms: 9.450926175842762
2025-03-13 17:40:56,265 [INFO]: 	99p_search_speed_ms: 19.047037723939873
2025-03-13 17:40:56,265 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:56,265 [INFO]: 	nb vectors: 2409
2025-03-13 17:40:56,265 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:56,265 [INFO]: 	compression ratio: 0.9993096867566884
2025-03-13 17:40:56,265 [INFO]: }
2025-03-13 17:40:56,265 [INFO]: 	>>> Finished "Creating the index" in 57.6492 secs
2025-03-13 17:40:56,266 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6744 secs
2025-03-13 17:40:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 1040 [episode count 1/20]
[retrieval_preprocessing] for episode 25655 [episode count 2/20], we have num_retrieval=np.int64(2470) num_query=np.int64(100)
2025-03-13 17:40:58,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:58,971 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:58
2025-03-13 17:40:58,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 17:40:58,997 [INFO]: There are 2470 embeddings of dim 49152
2025-03-13 17:40:58,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:40:58,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:58,998 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:40:58,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:58,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:58,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,998 [INFO]: 509.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:58,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:40:58,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:58
2025-03-13 17:40:58,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:58,998 [INFO]: 	Creating the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:58
2025-03-13 17:40:58,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:40:59,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:59
2025-03-13 17:40:59,000 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:40:59,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.92it/s] 30%|███       | 3/10 [00:00<00:00,  8.67it/s] 40%|████      | 4/10 [00:00<00:00,  8.74it/s] 50%|█████     | 5/10 [00:00<00:00,  8.38it/s] 60%|██████    | 6/10 [00:00<00:00,  8.10it/s] 70%|███████   | 7/10 [00:00<00:00,  7.95it/s] 80%|████████  | 8/10 [00:01<00:00,  7.97it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.89it/s]100%|██████████| 10/10 [00:03<00:00,  1.43it/s]100%|██████████| 10/10 [00:03<00:00,  3.19it/s]
2025-03-13 17:41:02,144 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:02
2025-03-13 17:41:32,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5803 secs
2025-03-13 17:41:32,725 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 17:41:32,725 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.25it/s] 50%|█████     | 2/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.52it/s]
2025-03-13 17:41:50,864 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1383 secs
2025-03-13 17:41:50,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9083 secs
2025-03-13 17:41:50,908 [INFO]: {
2025-03-13 17:41:50,908 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:50,908 [INFO]: 	index_param: efSearch=106
2025-03-13 17:41:50,908 [INFO]: 	index_path: knn.index
2025-03-13 17:41:50,908 [INFO]: 	size in bytes: 485957050
2025-03-13 17:41:50,908 [INFO]: 	avg_search_speed_ms: 6.209975703162436
2025-03-13 17:41:50,909 [INFO]: 	99p_search_speed_ms: 8.901108824647963
2025-03-13 17:41:50,909 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:50,909 [INFO]: 	nb vectors: 2470
2025-03-13 17:41:50,909 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:50,909 [INFO]: 	compression ratio: 0.9993100419059668
2025-03-13 17:41:50,909 [INFO]: }
2025-03-13 17:41:50,909 [INFO]: 	>>> Finished "Creating the index" in 51.9108 secs
2025-03-13 17:41:50,909 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9378 secs
2025-03-13 17:41:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 25655 [episode count 2/20]
[retrieval_preprocessing] for episode 45630 [episode count 3/20], we have num_retrieval=np.int64(2357) num_query=np.int64(213)
2025-03-13 17:41:52,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:52,790 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:52
2025-03-13 17:41:52,790 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2025.26it/s]
2025-03-13 17:41:53,010 [INFO]: There are 2357 embeddings of dim 49152
2025-03-13 17:41:53,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2207 secs
2025-03-13 17:41:53,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:53
2025-03-13 17:41:53,011 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:53,011 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:41:53,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:53,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:53,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:53
2025-03-13 17:41:53,011 [INFO]: 486.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:53,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:53,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:53
2025-03-13 17:41:53,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:53,011 [INFO]: 	Creating the index 03/13/2025, 17:41:53
2025-03-13 17:41:53,011 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:53
2025-03-13 17:41:53,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:41:53,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:53
2025-03-13 17:41:53,013 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:41:53,013 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.36it/s] 30%|███       | 3/10 [00:00<00:00,  9.33it/s] 50%|█████     | 5/10 [00:00<00:00, 10.14it/s] 70%|███████   | 7/10 [00:00<00:00, 10.62it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.63it/s]100%|██████████| 10/10 [00:02<00:00,  3.82it/s]
2025-03-13 17:41:55,634 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:55
2025-03-13 17:42:25,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3551 secs
2025-03-13 17:42:25,990 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:42:25,990 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 17:42:53,158 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1682 secs
2025-03-13 17:42:53,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5722 secs
2025-03-13 17:42:53,585 [INFO]: {
2025-03-13 17:42:53,585 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:53,585 [INFO]: 	index_param: efSearch=220
2025-03-13 17:42:53,585 [INFO]: 	index_path: knn.index
2025-03-13 17:42:53,585 [INFO]: 	size in bytes: 463725190
2025-03-13 17:42:53,585 [INFO]: 	avg_search_speed_ms: 9.066024559599803
2025-03-13 17:42:53,585 [INFO]: 	99p_search_speed_ms: 13.851561853662133
2025-03-13 17:42:53,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:53,586 [INFO]: 	nb vectors: 2357
2025-03-13 17:42:53,586 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:53,586 [INFO]: 	compression ratio: 0.9993096471640888
2025-03-13 17:42:53,586 [INFO]: }
2025-03-13 17:42:53,586 [INFO]: 	>>> Finished "Creating the index" in 60.5745 secs
2025-03-13 17:42:53,586 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7962 secs
2025-03-13 17:42:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 45630 [episode count 3/20]
[retrieval_preprocessing] for episode 67656 [episode count 4/20], we have num_retrieval=np.int64(2468) num_query=np.int64(102)
2025-03-13 17:42:56,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:56,706 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:56
2025-03-13 17:42:56,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.83it/s]
2025-03-13 17:42:56,731 [INFO]: There are 2468 embeddings of dim 49152
2025-03-13 17:42:56,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:42:56,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:56
2025-03-13 17:42:56,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:56,733 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:42:56,733 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:56,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:42:56,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:56
2025-03-13 17:42:56,734 [INFO]: 509.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:56,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:42:56,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:56
2025-03-13 17:42:56,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:56,735 [INFO]: 	Creating the index 03/13/2025, 17:42:56
2025-03-13 17:42:56,735 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:56
2025-03-13 17:42:56,739 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:42:56,739 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:56
2025-03-13 17:42:56,739 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:42:56,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.51it/s] 20%|██        | 2/10 [00:00<00:01,  7.22it/s] 30%|███       | 3/10 [00:00<00:00,  8.02it/s] 40%|████      | 4/10 [00:00<00:00,  8.58it/s] 50%|█████     | 5/10 [00:00<00:00,  8.98it/s] 70%|███████   | 7/10 [00:00<00:00,  9.70it/s] 80%|████████  | 8/10 [00:00<00:00,  9.72it/s]100%|██████████| 10/10 [00:02<00:00,  2.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.55it/s]
2025-03-13 17:42:59,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:59
2025-03-13 17:43:33,699 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1312 secs
2025-03-13 17:43:33,699 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:43:33,699 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 17:43:56,172 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4729 secs
2025-03-13 17:43:56,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4347 secs
2025-03-13 17:43:56,174 [INFO]: {
2025-03-13 17:43:56,174 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:56,174 [INFO]: 	index_param: efSearch=200
2025-03-13 17:43:56,174 [INFO]: 	index_path: knn.index
2025-03-13 17:43:56,174 [INFO]: 	size in bytes: 485563570
2025-03-13 17:43:56,174 [INFO]: 	avg_search_speed_ms: 8.279429873164792
2025-03-13 17:43:56,174 [INFO]: 	99p_search_speed_ms: 14.493040291126817
2025-03-13 17:43:56,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:56,174 [INFO]: 	nb vectors: 2468
2025-03-13 17:43:56,174 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:56,174 [INFO]: 	compression ratio: 0.9993100264914849
2025-03-13 17:43:56,174 [INFO]: }
2025-03-13 17:43:56,174 [INFO]: 	>>> Finished "Creating the index" in 59.4393 secs
2025-03-13 17:43:56,174 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4683 secs
2025-03-13 17:43:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 67656 [episode count 4/20]
[retrieval_preprocessing] for episode 81993 [episode count 5/20], we have num_retrieval=np.int64(2447) num_query=np.int64(123)
2025-03-13 17:43:57,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:57,709 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:57
2025-03-13 17:43:57,709 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.56it/s]
2025-03-13 17:43:57,734 [INFO]: There are 2447 embeddings of dim 49152
2025-03-13 17:43:57,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:43:57,734 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:57
2025-03-13 17:43:57,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:57,735 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:43:57,735 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:57,735 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:57,735 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:57
2025-03-13 17:43:57,735 [INFO]: 505.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:57,735 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:57,735 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:57
2025-03-13 17:43:57,735 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:57,735 [INFO]: 	Creating the index 03/13/2025, 17:43:57
2025-03-13 17:43:57,735 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:57
2025-03-13 17:43:57,736 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:43:57,736 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:57
2025-03-13 17:43:57,736 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:43:57,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.87it/s] 20%|██        | 2/10 [00:00<00:01,  7.20it/s] 30%|███       | 3/10 [00:00<00:00,  7.64it/s] 40%|████      | 4/10 [00:00<00:00,  8.10it/s] 50%|█████     | 5/10 [00:00<00:00,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00,  8.36it/s] 70%|███████   | 7/10 [00:00<00:00,  8.44it/s] 80%|████████  | 8/10 [00:00<00:00,  8.51it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.66it/s]100%|██████████| 10/10 [00:02<00:00,  1.76it/s]100%|██████████| 10/10 [00:02<00:00,  3.73it/s]
2025-03-13 17:44:00,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:00
2025-03-13 17:44:28,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5798 secs
2025-03-13 17:44:28,000 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 17:44:28,000 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 17:44:49,409 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4084 secs
2025-03-13 17:44:49,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6750 secs
2025-03-13 17:44:49,411 [INFO]: {
2025-03-13 17:44:49,411 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:49,411 [INFO]: 	index_param: efSearch=214
2025-03-13 17:44:49,411 [INFO]: 	index_path: knn.index
2025-03-13 17:44:49,411 [INFO]: 	size in bytes: 481431970
2025-03-13 17:44:49,411 [INFO]: 	avg_search_speed_ms: 11.121454377512595
2025-03-13 17:44:49,411 [INFO]: 	99p_search_speed_ms: 16.876568133011457
2025-03-13 17:44:49,411 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:49,411 [INFO]: 	nb vectors: 2447
2025-03-13 17:44:49,412 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:49,412 [INFO]: 	compression ratio: 0.9993099876603542
2025-03-13 17:44:49,412 [INFO]: }
2025-03-13 17:44:49,412 [INFO]: 	>>> Finished "Creating the index" in 51.6766 secs
2025-03-13 17:44:49,412 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7021 secs
2025-03-13 17:44:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 81993 [episode count 5/20]
[retrieval_preprocessing] for episode 57421 [episode count 6/20], we have num_retrieval=np.int64(2437) num_query=np.int64(133)
2025-03-13 17:44:52,024 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:52,545 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:52
2025-03-13 17:44:52,545 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.58it/s]
2025-03-13 17:44:52,572 [INFO]: There are 2437 embeddings of dim 49152
2025-03-13 17:44:52,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:44:52,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:52
2025-03-13 17:44:52,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:52,572 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:44:52,573 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:52,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:52,573 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:52
2025-03-13 17:44:52,573 [INFO]: 502.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:52,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:52,573 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:52
2025-03-13 17:44:52,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:52,573 [INFO]: 	Creating the index 03/13/2025, 17:44:52
2025-03-13 17:44:52,573 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:52
2025-03-13 17:44:52,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:44:52,574 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:52
2025-03-13 17:44:52,574 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:52,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.77it/s] 20%|██        | 2/10 [00:00<00:01,  7.48it/s] 30%|███       | 3/10 [00:00<00:00,  8.38it/s] 40%|████      | 4/10 [00:00<00:00,  8.86it/s] 50%|█████     | 5/10 [00:00<00:00,  9.10it/s] 60%|██████    | 6/10 [00:00<00:00,  9.29it/s] 70%|███████   | 7/10 [00:00<00:00,  9.31it/s] 80%|████████  | 8/10 [00:00<00:00,  9.19it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.10it/s]100%|██████████| 10/10 [00:03<00:00,  1.30it/s]100%|██████████| 10/10 [00:03<00:00,  3.05it/s]
2025-03-13 17:44:55,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:55
2025-03-13 17:45:37,631 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7731 secs
2025-03-13 17:45:37,631 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:45:37,631 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 17:45:58,711 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0796 secs
2025-03-13 17:45:58,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1390 secs
2025-03-13 17:45:58,713 [INFO]: {
2025-03-13 17:45:58,713 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:58,713 [INFO]: 	index_param: efSearch=195
2025-03-13 17:45:58,713 [INFO]: 	index_path: knn.index
2025-03-13 17:45:58,713 [INFO]: 	size in bytes: 479464570
2025-03-13 17:45:58,713 [INFO]: 	avg_search_speed_ms: 9.41632325097168
2025-03-13 17:45:58,713 [INFO]: 	99p_search_speed_ms: 13.027833548840135
2025-03-13 17:45:58,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:58,713 [INFO]: 	nb vectors: 2437
2025-03-13 17:45:58,713 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:58,714 [INFO]: 	compression ratio: 0.9993099093849624
2025-03-13 17:45:58,714 [INFO]: }
2025-03-13 17:45:58,714 [INFO]: 	>>> Finished "Creating the index" in 66.1406 secs
2025-03-13 17:45:58,714 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1688 secs
2025-03-13 17:45:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 57421 [episode count 6/20]
[retrieval_preprocessing] for episode 7790 [episode count 7/20], we have num_retrieval=np.int64(2362) num_query=np.int64(208)
2025-03-13 17:46:00,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:01,314 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:01
2025-03-13 17:46:01,314 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.04it/s]
2025-03-13 17:46:01,339 [INFO]: There are 2362 embeddings of dim 49152
2025-03-13 17:46:01,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:46:01,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:01
2025-03-13 17:46:01,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:01,340 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:46:01,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:01,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:01,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:01
2025-03-13 17:46:01,340 [INFO]: 487.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:01,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:01,340 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:01
2025-03-13 17:46:01,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:01,340 [INFO]: 	Creating the index 03/13/2025, 17:46:01
2025-03-13 17:46:01,340 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:01
2025-03-13 17:46:01,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:46:01,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:01
2025-03-13 17:46:01,341 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:01,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.32it/s] 20%|██        | 2/10 [00:00<00:01,  7.02it/s] 30%|███       | 3/10 [00:00<00:00,  7.86it/s] 40%|████      | 4/10 [00:00<00:00,  8.29it/s] 50%|█████     | 5/10 [00:00<00:00,  8.62it/s] 60%|██████    | 6/10 [00:00<00:00,  8.78it/s] 70%|███████   | 7/10 [00:00<00:00,  9.07it/s] 80%|████████  | 8/10 [00:00<00:00,  8.87it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.61it/s]100%|██████████| 10/10 [00:02<00:00,  1.55it/s]100%|██████████| 10/10 [00:02<00:00,  3.43it/s]
2025-03-13 17:46:04,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:04
2025-03-13 17:46:38,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4111 secs
2025-03-13 17:46:38,667 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:46:38,667 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 17:46:58,383 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7160 secs
2025-03-13 17:46:58,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0443 secs
2025-03-13 17:46:58,385 [INFO]: {
2025-03-13 17:46:58,385 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:58,385 [INFO]: 	index_param: efSearch=170
2025-03-13 17:46:58,385 [INFO]: 	index_path: knn.index
2025-03-13 17:46:58,386 [INFO]: 	size in bytes: 464708950
2025-03-13 17:46:58,386 [INFO]: 	avg_search_speed_ms: 7.003840093933964
2025-03-13 17:46:58,386 [INFO]: 	99p_search_speed_ms: 10.313597966451198
2025-03-13 17:46:58,386 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:58,386 [INFO]: 	nb vectors: 2362
2025-03-13 17:46:58,386 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:58,386 [INFO]: 	compression ratio: 0.9993095592413272
2025-03-13 17:46:58,386 [INFO]: }
2025-03-13 17:46:58,386 [INFO]: 	>>> Finished "Creating the index" in 57.0457 secs
2025-03-13 17:46:58,386 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0718 secs
2025-03-13 17:47:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 7790 [episode count 7/20]
[retrieval_preprocessing] for episode 67707 [episode count 8/20], we have num_retrieval=np.int64(2465) num_query=np.int64(105)
2025-03-13 17:47:02,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:02,981 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:02
2025-03-13 17:47:02,981 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.09it/s]
2025-03-13 17:47:03,007 [INFO]: There are 2465 embeddings of dim 49152
2025-03-13 17:47:03,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:47:03,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:03
2025-03-13 17:47:03,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:03,008 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:47:03,008 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:03,008 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:47:03,008 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:03
2025-03-13 17:47:03,008 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:03,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:47:03,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:03
2025-03-13 17:47:03,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:03,009 [INFO]: 	Creating the index 03/13/2025, 17:47:03
2025-03-13 17:47:03,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:03
2025-03-13 17:47:03,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:47:03,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:03
2025-03-13 17:47:03,013 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:47:03,013 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.14it/s] 20%|██        | 2/10 [00:00<00:01,  6.66it/s] 30%|███       | 3/10 [00:00<00:00,  7.33it/s] 40%|████      | 4/10 [00:00<00:00,  7.69it/s] 50%|█████     | 5/10 [00:00<00:00,  8.03it/s] 60%|██████    | 6/10 [00:00<00:00,  8.23it/s] 70%|███████   | 7/10 [00:00<00:00,  8.32it/s] 80%|████████  | 8/10 [00:01<00:00,  8.37it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.62it/s]100%|██████████| 10/10 [00:03<00:00,  1.31it/s]100%|██████████| 10/10 [00:03<00:00,  2.99it/s]
2025-03-13 17:47:06,363 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:06
2025-03-13 17:47:34,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9425 secs
2025-03-13 17:47:34,306 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:47:34,306 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.25it/s]
2025-03-13 17:48:03,550 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2438 secs
2025-03-13 17:48:03,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5390 secs
2025-03-13 17:48:03,552 [INFO]: {
2025-03-13 17:48:03,552 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:03,552 [INFO]: 	index_param: efSearch=164
2025-03-13 17:48:03,552 [INFO]: 	index_path: knn.index
2025-03-13 17:48:03,552 [INFO]: 	size in bytes: 484973350
2025-03-13 17:48:03,552 [INFO]: 	avg_search_speed_ms: 7.928788469008316
2025-03-13 17:48:03,552 [INFO]: 	99p_search_speed_ms: 17.1069440431893
2025-03-13 17:48:03,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:03,552 [INFO]: 	nb vectors: 2465
2025-03-13 17:48:03,552 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:03,552 [INFO]: 	compression ratio: 0.999310003322863
2025-03-13 17:48:03,552 [INFO]: }
2025-03-13 17:48:03,552 [INFO]: 	>>> Finished "Creating the index" in 60.5426 secs
2025-03-13 17:48:03,552 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5706 secs
2025-03-13 17:48:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 67707 [episode count 8/20]
[retrieval_preprocessing] for episode 5264 [episode count 9/20], we have num_retrieval=np.int64(2441) num_query=np.int64(129)
2025-03-13 17:48:04,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:05,174 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:05
2025-03-13 17:48:05,175 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.43it/s]
2025-03-13 17:48:05,200 [INFO]: There are 2441 embeddings of dim 49152
2025-03-13 17:48:05,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 17:48:05,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:05
2025-03-13 17:48:05,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:05,201 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:48:05,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:05,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:05,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:05
2025-03-13 17:48:05,201 [INFO]: 503.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:05,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:48:05,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:05
2025-03-13 17:48:05,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:05,201 [INFO]: 	Creating the index 03/13/2025, 17:48:05
2025-03-13 17:48:05,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:05
2025-03-13 17:48:05,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:48:05,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:05
2025-03-13 17:48:05,203 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:48:05,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.78it/s] 30%|███       | 3/10 [00:00<00:00, 12.42it/s] 50%|█████     | 5/10 [00:00<00:00, 12.87it/s] 70%|███████   | 7/10 [00:00<00:00, 12.60it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.21it/s]100%|██████████| 10/10 [00:02<00:00,  4.37it/s]
2025-03-13 17:48:07,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:07
2025-03-13 17:48:37,987 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4913 secs
2025-03-13 17:48:37,988 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 17:48:37,988 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 17:49:01,157 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1688 secs
2025-03-13 17:49:01,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9571 secs
2025-03-13 17:49:01,160 [INFO]: {
2025-03-13 17:49:01,160 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:01,160 [INFO]: 	index_param: efSearch=186
2025-03-13 17:49:01,160 [INFO]: 	index_path: knn.index
2025-03-13 17:49:01,160 [INFO]: 	size in bytes: 480251530
2025-03-13 17:49:01,160 [INFO]: 	avg_search_speed_ms: 9.828463405341436
2025-03-13 17:49:01,160 [INFO]: 	99p_search_speed_ms: 17.524019561242323
2025-03-13 17:49:01,160 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:01,160 [INFO]: 	nb vectors: 2441
2025-03-13 17:49:01,160 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:01,160 [INFO]: 	compression ratio: 0.9993099407720784
2025-03-13 17:49:01,160 [INFO]: }
2025-03-13 17:49:01,160 [INFO]: 	>>> Finished "Creating the index" in 55.9587 secs
2025-03-13 17:49:01,160 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9855 secs
2025-03-13 17:49:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 5264 [episode count 9/20]
[retrieval_preprocessing] for episode 10428 [episode count 10/20], we have num_retrieval=np.int64(2464) num_query=np.int64(106)
2025-03-13 17:49:04,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:04,971 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:04
2025-03-13 17:49:04,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.33it/s]
2025-03-13 17:49:04,999 [INFO]: There are 2464 embeddings of dim 49152
2025-03-13 17:49:05,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:49:05,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:05
2025-03-13 17:49:05,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:05,000 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:49:05,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:05,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:05,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:05
2025-03-13 17:49:05,000 [INFO]: 508.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:05,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:05,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:05
2025-03-13 17:49:05,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:05,000 [INFO]: 	Creating the index 03/13/2025, 17:49:05
2025-03-13 17:49:05,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:05
2025-03-13 17:49:05,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:49:05,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:05
2025-03-13 17:49:05,002 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:49:05,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.18it/s] 20%|██        | 2/10 [00:00<00:01,  6.77it/s] 30%|███       | 3/10 [00:00<00:00,  7.33it/s] 40%|████      | 4/10 [00:00<00:00,  7.64it/s] 50%|█████     | 5/10 [00:00<00:00,  7.78it/s] 60%|██████    | 6/10 [00:00<00:00,  8.01it/s] 70%|███████   | 7/10 [00:00<00:00,  7.96it/s] 80%|████████  | 8/10 [00:01<00:00,  7.94it/s]100%|██████████| 10/10 [00:03<00:00,  1.65it/s]100%|██████████| 10/10 [00:03<00:00,  3.02it/s]
2025-03-13 17:49:08,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:08
2025-03-13 17:49:45,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4427 secs
2025-03-13 17:49:45,766 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:49:45,766 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 17:50:16,296 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5298 secs
2025-03-13 17:50:16,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2965 secs
2025-03-13 17:50:16,299 [INFO]: {
2025-03-13 17:50:16,299 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:16,299 [INFO]: 	index_param: efSearch=155
2025-03-13 17:50:16,299 [INFO]: 	index_path: knn.index
2025-03-13 17:50:16,299 [INFO]: 	size in bytes: 484776610
2025-03-13 17:50:16,299 [INFO]: 	avg_search_speed_ms: 8.991073030792512
2025-03-13 17:50:16,299 [INFO]: 	99p_search_speed_ms: 21.918955771252516
2025-03-13 17:50:16,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:16,299 [INFO]: 	nb vectors: 2464
2025-03-13 17:50:16,299 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:16,299 [INFO]: 	compression ratio: 0.9993099955874521
2025-03-13 17:50:16,299 [INFO]: }
2025-03-13 17:50:16,299 [INFO]: 	>>> Finished "Creating the index" in 71.2985 secs
2025-03-13 17:50:16,299 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3276 secs
2025-03-13 17:50:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 10428 [episode count 10/20]
[retrieval_preprocessing] for episode 76513 [episode count 11/20], we have num_retrieval=np.int64(2439) num_query=np.int64(131)
2025-03-13 17:50:18,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:19,064 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:19
2025-03-13 17:50:19,064 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.28it/s]
2025-03-13 17:50:19,090 [INFO]: There are 2439 embeddings of dim 49152
2025-03-13 17:50:19,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:50:19,091 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:19
2025-03-13 17:50:19,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:19,091 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:50:19,091 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:19,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:50:19,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:19
2025-03-13 17:50:19,092 [INFO]: 503.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:19,092 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:50:19,092 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:19
2025-03-13 17:50:19,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:19,092 [INFO]: 	Creating the index 03/13/2025, 17:50:19
2025-03-13 17:50:19,092 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:19
2025-03-13 17:50:19,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:50:19,094 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:19
2025-03-13 17:50:19,094 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:50:19,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.45it/s] 30%|███       | 3/10 [00:00<00:00,  8.74it/s] 40%|████      | 4/10 [00:00<00:00,  9.09it/s] 50%|█████     | 5/10 [00:00<00:00,  9.24it/s] 60%|██████    | 6/10 [00:00<00:00,  9.43it/s] 70%|███████   | 7/10 [00:00<00:00,  9.25it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.10it/s]100%|██████████| 10/10 [00:03<00:00,  1.62it/s]100%|██████████| 10/10 [00:03<00:00,  3.21it/s]
2025-03-13 17:50:22,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:22
2025-03-13 17:50:53,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9639 secs
2025-03-13 17:50:53,179 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:50:53,179 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 17:51:14,070 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8906 secs
2025-03-13 17:51:14,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1314 secs
2025-03-13 17:51:14,226 [INFO]: {
2025-03-13 17:51:14,226 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:14,226 [INFO]: 	index_param: efSearch=168
2025-03-13 17:51:14,226 [INFO]: 	index_path: knn.index
2025-03-13 17:51:14,226 [INFO]: 	size in bytes: 479858050
2025-03-13 17:51:14,226 [INFO]: 	avg_search_speed_ms: 7.941053404285616
2025-03-13 17:51:14,226 [INFO]: 	99p_search_speed_ms: 11.536629553884268
2025-03-13 17:51:14,226 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:14,226 [INFO]: 	nb vectors: 2439
2025-03-13 17:51:14,226 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:14,227 [INFO]: 	compression ratio: 0.999309925091389
2025-03-13 17:51:14,227 [INFO]: }
2025-03-13 17:51:14,227 [INFO]: 	>>> Finished "Creating the index" in 55.1347 secs
2025-03-13 17:51:14,227 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1624 secs
2025-03-13 17:51:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 76513 [episode count 11/20]
[retrieval_preprocessing] for episode 9997 [episode count 12/20], we have num_retrieval=np.int64(2427) num_query=np.int64(143)
2025-03-13 17:51:16,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:16,434 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:16
2025-03-13 17:51:16,434 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1595.40it/s]
2025-03-13 17:51:16,458 [INFO]: There are 2427 embeddings of dim 49152
2025-03-13 17:51:16,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 17:51:16,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:16
2025-03-13 17:51:16,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:16,458 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:51:16,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:16,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:16,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:16
2025-03-13 17:51:16,458 [INFO]: 500.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:16,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:51:16,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:16
2025-03-13 17:51:16,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:16,458 [INFO]: 	Creating the index 03/13/2025, 17:51:16
2025-03-13 17:51:16,458 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:16
2025-03-13 17:51:16,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:51:16,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:16
2025-03-13 17:51:16,459 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:51:16,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.02it/s] 20%|██        | 2/10 [00:00<00:01,  7.24it/s] 30%|███       | 3/10 [00:00<00:00,  7.96it/s] 40%|████      | 4/10 [00:00<00:00,  8.32it/s] 50%|█████     | 5/10 [00:00<00:00,  8.12it/s] 60%|██████    | 6/10 [00:00<00:00,  7.91it/s] 70%|███████   | 7/10 [00:00<00:00,  7.67it/s] 80%|████████  | 8/10 [00:01<00:00,  7.56it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.52it/s]100%|██████████| 10/10 [00:03<00:00,  1.37it/s]100%|██████████| 10/10 [00:03<00:00,  3.08it/s]
2025-03-13 17:51:19,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:19
2025-03-13 17:51:44,640 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9268 secs
2025-03-13 17:51:44,640 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:51:44,640 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 50%|█████     | 2/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-13 17:52:07,197 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5567 secs
2025-03-13 17:52:07,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7415 secs
2025-03-13 17:52:07,201 [INFO]: {
2025-03-13 17:52:07,201 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:07,202 [INFO]: 	index_param: efSearch=218
2025-03-13 17:52:07,202 [INFO]: 	index_path: knn.index
2025-03-13 17:52:07,202 [INFO]: 	size in bytes: 477497170
2025-03-13 17:52:07,202 [INFO]: 	avg_search_speed_ms: 9.444354519087952
2025-03-13 17:52:07,202 [INFO]: 	99p_search_speed_ms: 13.391053341329101
2025-03-13 17:52:07,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:07,202 [INFO]: 	nb vectors: 2427
2025-03-13 17:52:07,202 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:07,202 [INFO]: 	compression ratio: 0.9993098304645449
2025-03-13 17:52:07,202 [INFO]: }
2025-03-13 17:52:07,202 [INFO]: 	>>> Finished "Creating the index" in 50.7438 secs
2025-03-13 17:52:07,202 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7683 secs
2025-03-13 17:52:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 9997 [episode count 12/20]
[retrieval_preprocessing] for episode 35105 [episode count 13/20], we have num_retrieval=np.int64(2447) num_query=np.int64(123)
2025-03-13 17:52:09,693 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:10,792 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:10
2025-03-13 17:52:10,792 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.90it/s]
2025-03-13 17:52:10,819 [INFO]: There are 2447 embeddings of dim 49152
2025-03-13 17:52:10,819 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:52:10,819 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:10
2025-03-13 17:52:10,819 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:10,819 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:52:10,819 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:10,819 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:10,819 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:10
2025-03-13 17:52:10,819 [INFO]: 505.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:10,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:10,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:10
2025-03-13 17:52:10,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:10,820 [INFO]: 	Creating the index 03/13/2025, 17:52:10
2025-03-13 17:52:10,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:10
2025-03-13 17:52:10,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:52:10,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:10
2025-03-13 17:52:10,821 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:10,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.04it/s] 20%|██        | 2/10 [00:00<00:01,  7.82it/s] 30%|███       | 3/10 [00:00<00:00,  8.64it/s] 50%|█████     | 5/10 [00:00<00:00,  9.37it/s] 70%|███████   | 7/10 [00:00<00:00, 10.02it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.11it/s]100%|██████████| 10/10 [00:03<00:00,  3.10it/s]
2025-03-13 17:52:14,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:14
2025-03-13 17:52:46,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4098 secs
2025-03-13 17:52:46,465 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:52:46,466 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.58it/s] 50%|█████     | 2/4 [00:00<00:00,  4.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.04it/s]
2025-03-13 17:53:04,980 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5147 secs
2025-03-13 17:53:04,982 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1614 secs
2025-03-13 17:53:04,983 [INFO]: {
2025-03-13 17:53:04,983 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:04,983 [INFO]: 	index_param: efSearch=171
2025-03-13 17:53:04,983 [INFO]: 	index_path: knn.index
2025-03-13 17:53:04,983 [INFO]: 	size in bytes: 481431970
2025-03-13 17:53:04,983 [INFO]: 	avg_search_speed_ms: 8.456352152070464
2025-03-13 17:53:04,983 [INFO]: 	99p_search_speed_ms: 12.582475263625383
2025-03-13 17:53:04,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:04,983 [INFO]: 	nb vectors: 2447
2025-03-13 17:53:04,983 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:04,983 [INFO]: 	compression ratio: 0.9993099876603542
2025-03-13 17:53:04,983 [INFO]: }
2025-03-13 17:53:04,983 [INFO]: 	>>> Finished "Creating the index" in 54.1631 secs
2025-03-13 17:53:04,983 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1911 secs
2025-03-13 17:53:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 35105 [episode count 13/20]
[retrieval_preprocessing] for episode 18223 [episode count 14/20], we have num_retrieval=np.int64(2463) num_query=np.int64(107)
2025-03-13 17:53:06,834 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:07,332 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:07
2025-03-13 17:53:07,332 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1019.77it/s]
2025-03-13 17:53:07,360 [INFO]: There are 2463 embeddings of dim 49152
2025-03-13 17:53:07,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:53:07,360 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:07,360 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:53:07,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:07,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:07,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,360 [INFO]: 508.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:07,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:07,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:07
2025-03-13 17:53:07,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:07,361 [INFO]: 	Creating the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:07
2025-03-13 17:53:07,362 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:53:07,362 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:07
2025-03-13 17:53:07,362 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:07,362 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.14it/s] 20%|██        | 2/10 [00:00<00:01,  6.28it/s] 30%|███       | 3/10 [00:00<00:00,  7.48it/s] 50%|█████     | 5/10 [00:00<00:00,  8.78it/s] 70%|███████   | 7/10 [00:00<00:00,  9.23it/s] 80%|████████  | 8/10 [00:00<00:00,  9.35it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.44it/s]100%|██████████| 10/10 [00:02<00:00,  1.78it/s]100%|██████████| 10/10 [00:02<00:00,  3.51it/s]
2025-03-13 17:53:10,215 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:10
2025-03-13 17:53:39,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0797 secs
2025-03-13 17:53:39,295 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 17:53:39,295 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-13 17:54:04,753 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4571 secs
2025-03-13 17:54:04,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3929 secs
2025-03-13 17:54:04,755 [INFO]: {
2025-03-13 17:54:04,755 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:04,755 [INFO]: 	index_param: efSearch=222
2025-03-13 17:54:04,755 [INFO]: 	index_path: knn.index
2025-03-13 17:54:04,755 [INFO]: 	size in bytes: 484579870
2025-03-13 17:54:04,755 [INFO]: 	avg_search_speed_ms: 10.152819796895542
2025-03-13 17:54:04,755 [INFO]: 	99p_search_speed_ms: 16.623211875557896
2025-03-13 17:54:04,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:04,755 [INFO]: 	nb vectors: 2463
2025-03-13 17:54:04,755 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:04,755 [INFO]: 	compression ratio: 0.9993099878457601
2025-03-13 17:54:04,755 [INFO]: }
2025-03-13 17:54:04,755 [INFO]: 	>>> Finished "Creating the index" in 57.3946 secs
2025-03-13 17:54:04,755 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4236 secs
2025-03-13 17:54:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 18223 [episode count 14/20]
[retrieval_preprocessing] for episode 47934 [episode count 15/20], we have num_retrieval=np.int64(2453) num_query=np.int64(117)
2025-03-13 17:54:07,662 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:08,168 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:08
2025-03-13 17:54:08,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.72it/s]
2025-03-13 17:54:08,201 [INFO]: There are 2453 embeddings of dim 49152
2025-03-13 17:54:08,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 17:54:08,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:08
2025-03-13 17:54:08,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:08,201 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:54:08,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:08,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:08,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:08
2025-03-13 17:54:08,202 [INFO]: 506.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:08,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:54:08,202 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:08
2025-03-13 17:54:08,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:08,202 [INFO]: 	Creating the index 03/13/2025, 17:54:08
2025-03-13 17:54:08,202 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:08
2025-03-13 17:54:08,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:54:08,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:08
2025-03-13 17:54:08,203 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:54:08,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.05it/s] 30%|███       | 3/10 [00:00<00:00, 10.03it/s] 50%|█████     | 5/10 [00:00<00:00, 10.72it/s] 70%|███████   | 7/10 [00:00<00:00, 11.03it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.00it/s]100%|██████████| 10/10 [00:02<00:00,  3.83it/s]
2025-03-13 17:54:10,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:10
2025-03-13 17:54:39,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1677 secs
2025-03-13 17:54:39,986 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:54:39,986 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 17:55:08,828 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8415 secs
2025-03-13 17:55:08,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6265 secs
2025-03-13 17:55:08,830 [INFO]: {
2025-03-13 17:55:08,830 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:08,830 [INFO]: 	index_param: efSearch=234
2025-03-13 17:55:08,830 [INFO]: 	index_path: knn.index
2025-03-13 17:55:08,830 [INFO]: 	size in bytes: 482612410
2025-03-13 17:55:08,830 [INFO]: 	avg_search_speed_ms: 9.596588641750106
2025-03-13 17:55:08,830 [INFO]: 	99p_search_speed_ms: 15.812290937174104
2025-03-13 17:55:08,830 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:08,830 [INFO]: 	nb vectors: 2453
2025-03-13 17:55:08,830 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:08,830 [INFO]: 	compression ratio: 0.9993100343192584
2025-03-13 17:55:08,830 [INFO]: }
2025-03-13 17:55:08,830 [INFO]: 	>>> Finished "Creating the index" in 60.6285 secs
2025-03-13 17:55:08,830 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6627 secs
2025-03-13 17:55:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 47934 [episode count 15/20]
[retrieval_preprocessing] for episode 95551 [episode count 16/20], we have num_retrieval=np.int64(2412) num_query=np.int64(158)
2025-03-13 17:55:11,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:11,737 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:11
2025-03-13 17:55:11,738 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1588.75it/s]
2025-03-13 17:55:11,763 [INFO]: There are 2412 embeddings of dim 49152
2025-03-13 17:55:11,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:55:11,764 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:11
2025-03-13 17:55:11,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:11,764 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:55:11,764 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:11,764 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:11,764 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:11
2025-03-13 17:55:11,764 [INFO]: 497.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:11,764 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:11,764 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:11
2025-03-13 17:55:11,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:11,764 [INFO]: 	Creating the index 03/13/2025, 17:55:11
2025-03-13 17:55:11,764 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:11
2025-03-13 17:55:11,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:55:11,766 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:11
2025-03-13 17:55:11,766 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:55:11,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.99it/s] 20%|██        | 2/10 [00:00<00:01,  6.32it/s] 30%|███       | 3/10 [00:00<00:01,  6.95it/s] 40%|████      | 4/10 [00:00<00:00,  7.44it/s] 60%|██████    | 6/10 [00:00<00:00,  8.95it/s] 80%|████████  | 8/10 [00:00<00:00,  9.36it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.17it/s]100%|██████████| 10/10 [00:02<00:00,  1.88it/s]100%|██████████| 10/10 [00:02<00:00,  3.49it/s]
2025-03-13 17:55:14,638 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:14
2025-03-13 17:55:45,994 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3555 secs
2025-03-13 17:55:45,994 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:55:45,994 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 17:56:08,237 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2420 secs
2025-03-13 17:56:08,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4731 secs
2025-03-13 17:56:08,239 [INFO]: {
2025-03-13 17:56:08,239 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:08,239 [INFO]: 	index_param: efSearch=173
2025-03-13 17:56:08,239 [INFO]: 	index_path: knn.index
2025-03-13 17:56:08,239 [INFO]: 	size in bytes: 474546070
2025-03-13 17:56:08,239 [INFO]: 	avg_search_speed_ms: 9.960242184166578
2025-03-13 17:56:08,239 [INFO]: 	99p_search_speed_ms: 22.59465665789321
2025-03-13 17:56:08,239 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:08,239 [INFO]: 	nb vectors: 2412
2025-03-13 17:56:08,239 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:08,239 [INFO]: 	compression ratio: 0.9993097108569459
2025-03-13 17:56:08,239 [INFO]: }
2025-03-13 17:56:08,239 [INFO]: 	>>> Finished "Creating the index" in 56.4749 secs
2025-03-13 17:56:08,239 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5016 secs
2025-03-13 17:56:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 95551 [episode count 16/20]
[retrieval_preprocessing] for episode 82764 [episode count 17/20], we have num_retrieval=np.int64(2452) num_query=np.int64(118)
2025-03-13 17:56:10,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:11,202 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:11
2025-03-13 17:56:11,203 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1382.43it/s]
2025-03-13 17:56:11,228 [INFO]: There are 2452 embeddings of dim 49152
2025-03-13 17:56:11,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:56:11,229 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:11
2025-03-13 17:56:11,229 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:11,229 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:56:11,229 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:11,229 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:56:11,229 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:11
2025-03-13 17:56:11,229 [INFO]: 506.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:11,229 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:56:11,229 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:11
2025-03-13 17:56:11,229 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:11,229 [INFO]: 	Creating the index 03/13/2025, 17:56:11
2025-03-13 17:56:11,229 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:11
2025-03-13 17:56:11,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:56:11,230 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:11
2025-03-13 17:56:11,230 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:56:11,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.80it/s] 30%|███       | 3/10 [00:00<00:00,  8.43it/s] 40%|████      | 4/10 [00:00<00:00,  8.77it/s] 50%|█████     | 5/10 [00:00<00:00,  8.95it/s] 60%|██████    | 6/10 [00:00<00:00,  9.19it/s] 70%|███████   | 7/10 [00:00<00:00,  9.30it/s] 80%|████████  | 8/10 [00:00<00:00,  9.40it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.42it/s]100%|██████████| 10/10 [00:03<00:00,  1.18it/s]100%|██████████| 10/10 [00:03<00:00,  2.82it/s]
2025-03-13 17:56:14,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:14
2025-03-13 17:56:42,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0005 secs
2025-03-13 17:56:42,782 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:56:42,782 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 17:57:14,226 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4433 secs
2025-03-13 17:57:14,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9976 secs
2025-03-13 17:57:14,228 [INFO]: {
2025-03-13 17:57:14,228 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:14,228 [INFO]: 	index_param: efSearch=184
2025-03-13 17:57:14,228 [INFO]: 	index_path: knn.index
2025-03-13 17:57:14,228 [INFO]: 	size in bytes: 482415670
2025-03-13 17:57:14,228 [INFO]: 	avg_search_speed_ms: 8.193755301562916
2025-03-13 17:57:14,228 [INFO]: 	99p_search_speed_ms: 13.578759036026891
2025-03-13 17:57:14,228 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:14,228 [INFO]: 	nb vectors: 2452
2025-03-13 17:57:14,228 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:14,228 [INFO]: 	compression ratio: 0.9993100265586314
2025-03-13 17:57:14,228 [INFO]: }
2025-03-13 17:57:14,228 [INFO]: 	>>> Finished "Creating the index" in 62.9990 secs
2025-03-13 17:57:14,228 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0256 secs
2025-03-13 17:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 82764 [episode count 17/20]
[retrieval_preprocessing] for episode 53081 [episode count 18/20], we have num_retrieval=np.int64(2472) num_query=np.int64(98)
2025-03-13 17:57:16,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:17,145 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:17
2025-03-13 17:57:17,145 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1083.52it/s]
2025-03-13 17:57:17,173 [INFO]: There are 2472 embeddings of dim 49152
2025-03-13 17:57:17,173 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:57:17,173 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:17
2025-03-13 17:57:17,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:17,174 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:57:17,174 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:17,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:17,174 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:17
2025-03-13 17:57:17,174 [INFO]: 510.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:17,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:17,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:17
2025-03-13 17:57:17,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:17,174 [INFO]: 	Creating the index 03/13/2025, 17:57:17
2025-03-13 17:57:17,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:17
2025-03-13 17:57:17,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:57:17,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:17
2025-03-13 17:57:17,175 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:17,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.27it/s] 30%|███       | 3/10 [00:00<00:00,  9.84it/s] 50%|█████     | 5/10 [00:00<00:00, 11.38it/s] 70%|███████   | 7/10 [00:00<00:00, 12.14it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.62it/s]100%|██████████| 10/10 [00:02<00:00,  3.88it/s]
2025-03-13 17:57:20,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:20
2025-03-13 17:57:47,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0909 secs
2025-03-13 17:57:47,212 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:57:47,212 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.13it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.00it/s]
2025-03-13 17:58:05,315 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1029 secs
2025-03-13 17:58:05,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1416 secs
2025-03-13 17:58:05,318 [INFO]: {
2025-03-13 17:58:05,318 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:05,318 [INFO]: 	index_param: efSearch=155
2025-03-13 17:58:05,318 [INFO]: 	index_path: knn.index
2025-03-13 17:58:05,318 [INFO]: 	size in bytes: 486350530
2025-03-13 17:58:05,318 [INFO]: 	avg_search_speed_ms: 8.392184750675442
2025-03-13 17:58:05,318 [INFO]: 	99p_search_speed_ms: 14.150243070907889
2025-03-13 17:58:05,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:05,318 [INFO]: 	nb vectors: 2472
2025-03-13 17:58:05,318 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:05,318 [INFO]: 	compression ratio: 0.9993100572955066
2025-03-13 17:58:05,318 [INFO]: }
2025-03-13 17:58:05,318 [INFO]: 	>>> Finished "Creating the index" in 48.1440 secs
2025-03-13 17:58:05,318 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1729 secs
2025-03-13 17:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 53081 [episode count 18/20]
[retrieval_preprocessing] for episode 32609 [episode count 19/20], we have num_retrieval=np.int64(2468) num_query=np.int64(102)
2025-03-13 17:58:06,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:07,430 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:07
2025-03-13 17:58:07,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1322.29it/s]
2025-03-13 17:58:07,451 [INFO]: There are 2468 embeddings of dim 49152
2025-03-13 17:58:07,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0210 secs
2025-03-13 17:58:07,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:07,451 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:58:07,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:07,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:07,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,451 [INFO]: 509.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:07,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:07,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:07
2025-03-13 17:58:07,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:07,451 [INFO]: 	Creating the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:07
2025-03-13 17:58:07,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:58:07,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,452 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:58:07,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.97it/s] 20%|██        | 2/10 [00:00<00:01,  7.53it/s] 30%|███       | 3/10 [00:00<00:00,  8.30it/s] 40%|████      | 4/10 [00:00<00:00,  8.67it/s] 50%|█████     | 5/10 [00:00<00:00,  8.85it/s] 60%|██████    | 6/10 [00:00<00:00,  9.01it/s] 70%|███████   | 7/10 [00:00<00:00,  9.22it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.03it/s]100%|██████████| 10/10 [00:03<00:00,  1.63it/s]100%|██████████| 10/10 [00:03<00:00,  3.23it/s]
2025-03-13 17:58:10,557 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:10
2025-03-13 17:58:39,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5502 secs
2025-03-13 17:58:39,108 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:58:39,108 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 17:59:05,036 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9282 secs
2025-03-13 17:59:05,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5860 secs
2025-03-13 17:59:05,039 [INFO]: {
2025-03-13 17:59:05,039 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:05,039 [INFO]: 	index_param: efSearch=218
2025-03-13 17:59:05,039 [INFO]: 	index_path: knn.index
2025-03-13 17:59:05,039 [INFO]: 	size in bytes: 485563570
2025-03-13 17:59:05,039 [INFO]: 	avg_search_speed_ms: 9.743638922592904
2025-03-13 17:59:05,039 [INFO]: 	99p_search_speed_ms: 16.833075147587806
2025-03-13 17:59:05,039 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:05,039 [INFO]: 	nb vectors: 2468
2025-03-13 17:59:05,039 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:05,039 [INFO]: 	compression ratio: 0.9993100264914849
2025-03-13 17:59:05,039 [INFO]: }
2025-03-13 17:59:05,039 [INFO]: 	>>> Finished "Creating the index" in 57.5873 secs
2025-03-13 17:59:05,039 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6090 secs
2025-03-13 17:59:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 32609 [episode count 19/20]
2025-03-13 17:59:06: [retrieval_preprocessing] finished for 8351259745_close_door [chosen_id count 5/196]
2025-03-13 17:59:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8351259745_open_door [chosen_id count 6/196]
2025-03-13 17:59:08: [retrieval_preprocessing] we have num_total=4169 embedding_dim=49152
[retrieval_preprocessing] for episode 63496 [episode count 0/20], we have num_retrieval=np.int64(4040) num_query=np.int64(129)
2025-03-13 17:59:09,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:10,628 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:10
2025-03-13 17:59:10,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2308.37it/s]
2025-03-13 17:59:10,652 [INFO]: There are 4040 embeddings of dim 49152
2025-03-13 17:59:10,652 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:59:10,652 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:10,653 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:59:10,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:10,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:10,653 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,653 [INFO]: 833.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:10,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:59:10,653 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:10
2025-03-13 17:59:10,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:10,653 [INFO]: 	Creating the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,653 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:10
2025-03-13 17:59:10,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:59:10,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,654 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:59:10,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.37it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.17it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 13.82it/s] 56%|█████▋    | 9/16 [00:00<00:00, 14.60it/s] 69%|██████▉   | 11/16 [00:00<00:00, 15.05it/s] 81%|████████▏ | 13/16 [00:00<00:00, 14.78it/s] 94%|█████████▍| 15/16 [00:01<00:00, 14.80it/s]100%|██████████| 16/16 [00:04<00:00,  3.35it/s]
2025-03-13 17:59:15,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:15
2025-03-13 18:00:02,582 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1411 secs
2025-03-13 18:00:02,582 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 18:00:02,582 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 18:00:29,387 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8046 secs
2025-03-13 18:00:29,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7354 secs
2025-03-13 18:00:29,390 [INFO]: {
2025-03-13 18:00:29,390 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:29,390 [INFO]: 	index_param: efSearch=230
2025-03-13 18:00:29,390 [INFO]: 	index_path: knn.index
2025-03-13 18:00:29,390 [INFO]: 	size in bytes: 794845930
2025-03-13 18:00:29,390 [INFO]: 	avg_search_speed_ms: 12.282682090759717
2025-03-13 18:00:29,390 [INFO]: 	99p_search_speed_ms: 18.17414846736938
2025-03-13 18:00:29,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:29,390 [INFO]: 	nb vectors: 4040
2025-03-13 18:00:29,390 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:29,390 [INFO]: 	compression ratio: 0.9993085326611661
2025-03-13 18:00:29,390 [INFO]: }
2025-03-13 18:00:29,390 [INFO]: 	>>> Finished "Creating the index" in 78.7371 secs
2025-03-13 18:00:29,390 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7622 secs
2025-03-13 18:00:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 63496 [episode count 0/20]
[retrieval_preprocessing] for episode 90691 [episode count 1/20], we have num_retrieval=np.int64(3824) num_query=np.int64(345)
2025-03-13 18:00:32,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:33,865 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:33
2025-03-13 18:00:33,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.77it/s]
2025-03-13 18:00:33,888 [INFO]: There are 3824 embeddings of dim 49152
2025-03-13 18:00:33,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 18:00:33,889 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:33
2025-03-13 18:00:33,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:33,889 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:00:33,889 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:33,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:33,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:33
2025-03-13 18:00:33,889 [INFO]: 789.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:33,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:33,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:33
2025-03-13 18:00:33,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:33,889 [INFO]: 	Creating the index 03/13/2025, 18:00:33
2025-03-13 18:00:33,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:33
2025-03-13 18:00:33,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:33,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:33
2025-03-13 18:00:33,890 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:00:33,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.53it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.26it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.22it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.72it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.05it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.75it/s] 56%|█████▋    | 9/16 [00:01<00:00, 10.84it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.54it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.13it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.83it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.93it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.02it/s]100%|██████████| 16/16 [00:04<00:00,  1.10it/s]100%|██████████| 16/16 [00:04<00:00,  3.26it/s]
2025-03-13 18:00:38,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:38
2025-03-13 18:01:24,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9102 secs
2025-03-13 18:01:24,712 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:01:24,712 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 18:01:58,537 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8246 secs
2025-03-13 18:01:58,905 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.0150 secs
2025-03-13 18:01:58,906 [INFO]: {
2025-03-13 18:01:58,906 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:58,906 [INFO]: 	index_param: efSearch=206
2025-03-13 18:01:58,906 [INFO]: 	index_path: knn.index
2025-03-13 18:01:58,906 [INFO]: 	size in bytes: 752348830
2025-03-13 18:01:58,906 [INFO]: 	avg_search_speed_ms: 8.710762818679799
2025-03-13 18:01:58,906 [INFO]: 	99p_search_speed_ms: 12.248834769707171
2025-03-13 18:01:58,906 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:58,906 [INFO]: 	nb vectors: 3824
2025-03-13 18:01:58,906 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:58,906 [INFO]: 	compression ratio: 0.999309046576174
2025-03-13 18:01:58,906 [INFO]: }
2025-03-13 18:01:58,906 [INFO]: 	>>> Finished "Creating the index" in 85.0170 secs
2025-03-13 18:01:58,906 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0407 secs
2025-03-13 18:02:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 90691 [episode count 1/20]
[retrieval_preprocessing] for episode 68720 [episode count 2/20], we have num_retrieval=np.int64(3839) num_query=np.int64(330)
2025-03-13 18:02:03,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:04,442 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:04
2025-03-13 18:02:04,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.45it/s]
2025-03-13 18:02:04,468 [INFO]: There are 3839 embeddings of dim 49152
2025-03-13 18:02:04,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:02:04,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:04,468 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:02:04,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:04,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:04,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,468 [INFO]: 792.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:04,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:04,468 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:04
2025-03-13 18:02:04,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:04,469 [INFO]: 	Creating the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:04
2025-03-13 18:02:04,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:02:04,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:04
2025-03-13 18:02:04,470 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:02:04,470 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.65it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.88it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.37it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.61it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.24it/s] 50%|█████     | 8/16 [00:01<00:01,  6.68it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.00it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.24it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.43it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.63it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.73it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.81it/s] 94%|█████████▍| 15/16 [00:01<00:00,  7.89it/s]100%|██████████| 16/16 [00:04<00:00,  1.06it/s]100%|██████████| 16/16 [00:04<00:00,  3.29it/s]
2025-03-13 18:02:09,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:09
2025-03-13 18:02:45,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0992 secs
2025-03-13 18:02:45,441 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:02:45,441 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 18:03:11,299 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8580 secs
2025-03-13 18:03:11,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8331 secs
2025-03-13 18:03:11,303 [INFO]: {
2025-03-13 18:03:11,303 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:11,303 [INFO]: 	index_param: efSearch=261
2025-03-13 18:03:11,303 [INFO]: 	index_path: knn.index
2025-03-13 18:03:11,303 [INFO]: 	size in bytes: 755300110
2025-03-13 18:03:11,303 [INFO]: 	avg_search_speed_ms: 15.010059064089155
2025-03-13 18:03:11,303 [INFO]: 	99p_search_speed_ms: 24.497260048519824
2025-03-13 18:03:11,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:11,303 [INFO]: 	nb vectors: 3839
2025-03-13 18:03:11,303 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:11,303 [INFO]: 	compression ratio: 0.9993088866358036
2025-03-13 18:03:11,303 [INFO]: }
2025-03-13 18:03:11,303 [INFO]: 	>>> Finished "Creating the index" in 66.8346 secs
2025-03-13 18:03:11,303 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8607 secs
2025-03-13 18:03:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 68720 [episode count 2/20]
[retrieval_preprocessing] for episode 35954 [episode count 3/20], we have num_retrieval=np.int64(3889) num_query=np.int64(280)
2025-03-13 18:03:18,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:19,302 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:19
2025-03-13 18:03:19,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 16.60it/s]
2025-03-13 18:03:19,388 [INFO]: There are 3889 embeddings of dim 49152
2025-03-13 18:03:19,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0865 secs
2025-03-13 18:03:19,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:19
2025-03-13 18:03:19,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:19,389 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:03:19,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:19,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:03:19,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:19
2025-03-13 18:03:19,389 [INFO]: 802.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:19,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:03:19,390 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:19
2025-03-13 18:03:19,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:19,390 [INFO]: 	Creating the index 03/13/2025, 18:03:19
2025-03-13 18:03:19,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:19
2025-03-13 18:03:19,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 18:03:19,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:19
2025-03-13 18:03:19,393 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:03:19,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.93it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.19it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.86it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.10it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.25it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.32it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.44it/s] 50%|█████     | 8/16 [00:01<00:01,  7.68it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.73it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.72it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.75it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.81it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.97it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.35it/s] 94%|█████████▍| 15/16 [00:02<00:00,  6.16it/s]100%|██████████| 16/16 [00:05<00:00,  1.09s/it]100%|██████████| 16/16 [00:05<00:00,  2.98it/s]
2025-03-13 18:03:25,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:25
2025-03-13 18:04:12,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4197 secs
2025-03-13 18:04:12,669 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:04:12,669 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.00it/s] 50%|█████     | 2/4 [00:00<00:00,  4.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.31it/s]
2025-03-13 18:04:41,832 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1627 secs
2025-03-13 18:04:41,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4416 secs
2025-03-13 18:04:41,835 [INFO]: {
2025-03-13 18:04:41,835 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:41,835 [INFO]: 	index_param: efSearch=207
2025-03-13 18:04:41,835 [INFO]: 	index_path: knn.index
2025-03-13 18:04:41,835 [INFO]: 	size in bytes: 765137350
2025-03-13 18:04:41,835 [INFO]: 	avg_search_speed_ms: 11.25909295536133
2025-03-13 18:04:41,835 [INFO]: 	99p_search_speed_ms: 21.208485632669177
2025-03-13 18:04:41,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:41,835 [INFO]: 	nb vectors: 3889
2025-03-13 18:04:41,835 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:41,835 [INFO]: 	compression ratio: 0.9993088325906453
2025-03-13 18:04:41,835 [INFO]: }
2025-03-13 18:04:41,835 [INFO]: 	>>> Finished "Creating the index" in 82.4450 secs
2025-03-13 18:04:41,835 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5333 secs
2025-03-13 18:04:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 35954 [episode count 3/20]
[retrieval_preprocessing] for episode 26229 [episode count 4/20], we have num_retrieval=np.int64(4034) num_query=np.int64(135)
2025-03-13 18:04:45,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:46,366 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:46
2025-03-13 18:04:46,366 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 952.39it/s]
2025-03-13 18:04:46,569 [INFO]: There are 4034 embeddings of dim 49152
2025-03-13 18:04:46,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2034 secs
2025-03-13 18:04:46,570 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:46
2025-03-13 18:04:46,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:46,570 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:04:46,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:46,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:04:46,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:46
2025-03-13 18:04:46,570 [INFO]: 832.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:46,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:04:46,571 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:46
2025-03-13 18:04:46,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:46,571 [INFO]: 	Creating the index 03/13/2025, 18:04:46
2025-03-13 18:04:46,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:46
2025-03-13 18:04:46,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:04:46,575 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:46
2025-03-13 18:04:46,575 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:04:46,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.60it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.31it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.73it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.52it/s] 50%|█████     | 8/16 [00:00<00:00,  9.89it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.06it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.03it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.16it/s]100%|██████████| 16/16 [00:04<00:00,  1.60it/s]100%|██████████| 16/16 [00:04<00:00,  3.24it/s]
2025-03-13 18:04:51,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:51
2025-03-13 18:05:34,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6860 secs
2025-03-13 18:05:34,209 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:05:34,209 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 18:06:00,632 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4230 secs
2025-03-13 18:06:00,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0594 secs
2025-03-13 18:06:00,635 [INFO]: {
2025-03-13 18:06:00,635 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:00,635 [INFO]: 	index_param: efSearch=209
2025-03-13 18:06:00,635 [INFO]: 	index_path: knn.index
2025-03-13 18:06:00,635 [INFO]: 	size in bytes: 793665430
2025-03-13 18:06:00,635 [INFO]: 	avg_search_speed_ms: 10.430792293426842
2025-03-13 18:06:00,635 [INFO]: 	99p_search_speed_ms: 16.66269159410149
2025-03-13 18:06:00,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:00,635 [INFO]: 	nb vectors: 4034
2025-03-13 18:06:00,635 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:00,635 [INFO]: 	compression ratio: 0.9993085776710723
2025-03-13 18:06:00,635 [INFO]: }
2025-03-13 18:06:00,635 [INFO]: 	>>> Finished "Creating the index" in 74.0632 secs
2025-03-13 18:06:00,635 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2687 secs
2025-03-13 18:06:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 26229 [episode count 4/20]
[retrieval_preprocessing] for episode 33453 [episode count 5/20], we have num_retrieval=np.int64(3871) num_query=np.int64(298)
2025-03-13 18:06:03,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:04,368 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:04
2025-03-13 18:06:04,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1764.54it/s]
2025-03-13 18:06:04,391 [INFO]: There are 3871 embeddings of dim 49152
2025-03-13 18:06:04,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 18:06:04,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:04
2025-03-13 18:06:04,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:04,391 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:06:04,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:04,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:04,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:04
2025-03-13 18:06:04,391 [INFO]: 798.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:04,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:06:04,391 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:04
2025-03-13 18:06:04,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:04,391 [INFO]: 	Creating the index 03/13/2025, 18:06:04
2025-03-13 18:06:04,391 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:04
2025-03-13 18:06:04,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:06:04,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:04
2025-03-13 18:06:04,392 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:06:04,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.70it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.49it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.51it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.16it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.66it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.05it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.22it/s] 50%|█████     | 8/16 [00:01<00:00,  8.28it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.33it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.40it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.51it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.66it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.59it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.55it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.56it/s]100%|██████████| 16/16 [00:04<00:00,  1.04it/s]100%|██████████| 16/16 [00:04<00:00,  3.31it/s]
2025-03-13 18:06:09,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:09
2025-03-13 18:06:44,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4864 secs
2025-03-13 18:06:44,717 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 18:06:44,717 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 18:07:07,884 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1669 secs
2025-03-13 18:07:07,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4949 secs
2025-03-13 18:07:07,887 [INFO]: {
2025-03-13 18:07:07,887 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:07,887 [INFO]: 	index_param: efSearch=231
2025-03-13 18:07:07,887 [INFO]: 	index_path: knn.index
2025-03-13 18:07:07,888 [INFO]: 	size in bytes: 761595910
2025-03-13 18:07:07,888 [INFO]: 	avg_search_speed_ms: 11.758028394974916
2025-03-13 18:07:07,888 [INFO]: 	99p_search_speed_ms: 20.984010072425008
2025-03-13 18:07:07,888 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:07,888 [INFO]: 	nb vectors: 3871
2025-03-13 18:07:07,888 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:07,888 [INFO]: 	compression ratio: 0.9993088959734566
2025-03-13 18:07:07,888 [INFO]: }
2025-03-13 18:07:07,888 [INFO]: 	>>> Finished "Creating the index" in 63.4964 secs
2025-03-13 18:07:07,888 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5197 secs
2025-03-13 18:07:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 33453 [episode count 5/20]
[retrieval_preprocessing] for episode 37562 [episode count 6/20], we have num_retrieval=np.int64(3727) num_query=np.int64(442)
2025-03-13 18:07:13,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:14,099 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:14
2025-03-13 18:07:14,100 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-13 18:07:14,125 [INFO]: There are 3727 embeddings of dim 49152
2025-03-13 18:07:14,125 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:07:14,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:14
2025-03-13 18:07:14,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:14,126 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:07:14,126 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:14,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:07:14,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:14
2025-03-13 18:07:14,126 [INFO]: 769.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:14,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:07:14,126 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:14
2025-03-13 18:07:14,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:14,126 [INFO]: 	Creating the index 03/13/2025, 18:07:14
2025-03-13 18:07:14,126 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:14
2025-03-13 18:07:14,128 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:07:14,128 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:14
2025-03-13 18:07:14,128 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:07:14,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.53it/s] 20%|██        | 3/15 [00:00<00:01,  7.70it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.68it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.82it/s] 60%|██████    | 9/15 [00:00<00:00, 10.68it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.90it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.99it/s]100%|██████████| 15/15 [00:04<00:00,  1.88it/s]100%|██████████| 15/15 [00:04<00:00,  3.56it/s]
2025-03-13 18:07:18,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:18
2025-03-13 18:07:59,995 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6465 secs
2025-03-13 18:07:59,996 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:07:59,996 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-13 18:08:23,598 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6018 secs
2025-03-13 18:08:23,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4723 secs
2025-03-13 18:08:23,601 [INFO]: {
2025-03-13 18:08:23,601 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:23,601 [INFO]: 	index_param: efSearch=224
2025-03-13 18:08:23,601 [INFO]: 	index_path: knn.index
2025-03-13 18:08:23,601 [INFO]: 	size in bytes: 733264450
2025-03-13 18:08:23,601 [INFO]: 	avg_search_speed_ms: 11.52229595908998
2025-03-13 18:08:23,601 [INFO]: 	99p_search_speed_ms: 22.808034222107384
2025-03-13 18:08:23,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:23,601 [INFO]: 	nb vectors: 3727
2025-03-13 18:08:23,601 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:23,601 [INFO]: 	compression ratio: 0.9993093433071792
2025-03-13 18:08:23,601 [INFO]: }
2025-03-13 18:08:23,601 [INFO]: 	>>> Finished "Creating the index" in 69.4746 secs
2025-03-13 18:08:23,601 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5013 secs
2025-03-13 18:08:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 37562 [episode count 6/20]
[retrieval_preprocessing] for episode 15548 [episode count 7/20], we have num_retrieval=np.int64(4003) num_query=np.int64(166)
2025-03-13 18:08:33,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:33,975 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:33
2025-03-13 18:08:33,975 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.33it/s]
2025-03-13 18:08:34,005 [INFO]: There are 4003 embeddings of dim 49152
2025-03-13 18:08:34,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 18:08:34,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:34
2025-03-13 18:08:34,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:34,006 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:08:34,006 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:34,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:34,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:34
2025-03-13 18:08:34,006 [INFO]: 826.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:34,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:34,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:34
2025-03-13 18:08:34,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:34,006 [INFO]: 	Creating the index 03/13/2025, 18:08:34
2025-03-13 18:08:34,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:34
2025-03-13 18:08:34,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:08:34,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:34
2025-03-13 18:08:34,008 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:08:34,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.11it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.62it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.23it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.71it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.92it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.12it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.23it/s] 50%|█████     | 8/16 [00:01<00:00,  8.29it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.32it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.48it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.49it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.49it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.59it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.53it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.91it/s]100%|██████████| 16/16 [00:05<00:00,  1.05s/it]100%|██████████| 16/16 [00:05<00:00,  3.16it/s]
2025-03-13 18:08:39,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:39
2025-03-13 18:09:23,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6436 secs
2025-03-13 18:09:23,716 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 18:09:23,716 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 18:09:56,690 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9741 secs
2025-03-13 18:09:56,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6859 secs
2025-03-13 18:09:56,694 [INFO]: {
2025-03-13 18:09:56,694 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:56,694 [INFO]: 	index_param: efSearch=205
2025-03-13 18:09:56,694 [INFO]: 	index_path: knn.index
2025-03-13 18:09:56,694 [INFO]: 	size in bytes: 787566370
2025-03-13 18:09:56,694 [INFO]: 	avg_search_speed_ms: 11.03702006747465
2025-03-13 18:09:56,694 [INFO]: 	99p_search_speed_ms: 19.196641235612336
2025-03-13 18:09:56,694 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:56,694 [INFO]: 	nb vectors: 4003
2025-03-13 18:09:56,694 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:56,694 [INFO]: 	compression ratio: 0.9993085712890458
2025-03-13 18:09:56,694 [INFO]: }
2025-03-13 18:09:56,694 [INFO]: 	>>> Finished "Creating the index" in 82.6876 secs
2025-03-13 18:09:56,694 [INFO]: >>> Finished "Launching the whole pipeline" in 82.7192 secs
2025-03-13 18:09:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 15548 [episode count 7/20]
[retrieval_preprocessing] for episode 16591 [episode count 8/20], we have num_retrieval=np.int64(3979) num_query=np.int64(190)
2025-03-13 18:09:59,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:00,562 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:00
2025-03-13 18:10:00,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.12it/s]
2025-03-13 18:10:00,587 [INFO]: There are 3979 embeddings of dim 49152
2025-03-13 18:10:00,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:10:00,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:00
2025-03-13 18:10:00,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:00,587 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:10:00,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:00,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:00,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:00
2025-03-13 18:10:00,587 [INFO]: 821.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:00,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:10:00,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:00
2025-03-13 18:10:00,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:00,587 [INFO]: 	Creating the index 03/13/2025, 18:10:00
2025-03-13 18:10:00,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:00
2025-03-13 18:10:00,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:10:00,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:00
2025-03-13 18:10:00,589 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:10:00,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.62it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.71it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.87it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.37it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.29it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.36it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.69it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.58it/s]100%|██████████| 16/16 [00:04<00:00,  3.67it/s]
2025-03-13 18:10:04,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:04
2025-03-13 18:10:56,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9320 secs
2025-03-13 18:10:56,890 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 18:10:56,890 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 18:11:26,154 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2644 secs
2025-03-13 18:11:26,157 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5681 secs
2025-03-13 18:11:26,157 [INFO]: {
2025-03-13 18:11:26,157 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:26,157 [INFO]: 	index_param: efSearch=172
2025-03-13 18:11:26,157 [INFO]: 	index_path: knn.index
2025-03-13 18:11:26,157 [INFO]: 	size in bytes: 782844550
2025-03-13 18:11:26,157 [INFO]: 	avg_search_speed_ms: 7.929939167901968
2025-03-13 18:11:26,157 [INFO]: 	99p_search_speed_ms: 11.903002997860314
2025-03-13 18:11:26,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:26,157 [INFO]: 	nb vectors: 3979
2025-03-13 18:11:26,157 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:26,157 [INFO]: 	compression ratio: 0.9993085242785429
2025-03-13 18:11:26,157 [INFO]: }
2025-03-13 18:11:26,157 [INFO]: 	>>> Finished "Creating the index" in 85.5696 secs
2025-03-13 18:11:26,157 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5954 secs
2025-03-13 18:11:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 16591 [episode count 8/20]
[retrieval_preprocessing] for episode 17107 [episode count 9/20], we have num_retrieval=np.int64(4032) num_query=np.int64(137)
2025-03-13 18:11:28,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:29,088 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:29
2025-03-13 18:11:29,088 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.33it/s]
2025-03-13 18:11:29,118 [INFO]: There are 4032 embeddings of dim 49152
2025-03-13 18:11:29,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:11:29,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:29
2025-03-13 18:11:29,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:29,119 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:11:29,119 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:29,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:11:29,119 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:29
2025-03-13 18:11:29,119 [INFO]: 832.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:29,120 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:11:29,120 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:29
2025-03-13 18:11:29,120 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:29,120 [INFO]: 	Creating the index 03/13/2025, 18:11:29
2025-03-13 18:11:29,120 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:29
2025-03-13 18:11:29,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:11:29,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:29
2025-03-13 18:11:29,124 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:11:29,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.65it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.79it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.92it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.50it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.50it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.89it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.30it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.65it/s]100%|██████████| 16/16 [00:04<00:00,  3.86it/s]
2025-03-13 18:11:33,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:33
2025-03-13 18:12:17,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7547 secs
2025-03-13 18:12:17,040 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 18:12:17,040 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 18:12:37,494 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4534 secs
2025-03-13 18:12:37,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3735 secs
2025-03-13 18:12:37,497 [INFO]: {
2025-03-13 18:12:37,497 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:37,497 [INFO]: 	index_param: efSearch=187
2025-03-13 18:12:37,497 [INFO]: 	index_path: knn.index
2025-03-13 18:12:37,497 [INFO]: 	size in bytes: 793271950
2025-03-13 18:12:37,497 [INFO]: 	avg_search_speed_ms: 8.83621491603685
2025-03-13 18:12:37,497 [INFO]: 	99p_search_speed_ms: 12.655834599863738
2025-03-13 18:12:37,497 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:37,497 [INFO]: 	nb vectors: 4032
2025-03-13 18:12:37,497 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:37,497 [INFO]: 	compression ratio: 0.9993085675095407
2025-03-13 18:12:37,497 [INFO]: }
2025-03-13 18:12:37,497 [INFO]: 	>>> Finished "Creating the index" in 68.3772 secs
2025-03-13 18:12:37,497 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4094 secs
2025-03-13 18:12:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 17107 [episode count 9/20]
[retrieval_preprocessing] for episode 80612 [episode count 10/20], we have num_retrieval=np.int64(4009) num_query=np.int64(160)
2025-03-13 18:12:40,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:41,014 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:41
2025-03-13 18:12:41,014 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-13 18:12:41,047 [INFO]: There are 4009 embeddings of dim 49152
2025-03-13 18:12:41,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 18:12:41,047 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:41,048 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:12:41,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:41,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:41,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,048 [INFO]: 827.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:41,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:41,048 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:41
2025-03-13 18:12:41,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:41,048 [INFO]: 	Creating the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:41
2025-03-13 18:12:41,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:12:41,050 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,050 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:12:41,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.09it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.39it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.55it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.90it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.19it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.49it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.80it/s] 50%|█████     | 8/16 [00:01<00:01,  7.93it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.04it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.52it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.82it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.39it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.37it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.32it/s]100%|██████████| 16/16 [00:05<00:00,  1.06s/it]100%|██████████| 16/16 [00:05<00:00,  2.94it/s]
2025-03-13 18:12:46,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:46
2025-03-13 18:13:34,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0928 secs
2025-03-13 18:13:34,875 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 18:13:34,875 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 18:14:12,224 [INFO]: 	>>> Finished "Compute fast metrics" in 37.3489 secs
2025-03-13 18:14:12,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1772 secs
2025-03-13 18:14:12,227 [INFO]: {
2025-03-13 18:14:12,227 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:12,227 [INFO]: 	index_param: efSearch=217
2025-03-13 18:14:12,227 [INFO]: 	index_path: knn.index
2025-03-13 18:14:12,227 [INFO]: 	size in bytes: 788746870
2025-03-13 18:14:12,227 [INFO]: 	avg_search_speed_ms: 10.566972935942433
2025-03-13 18:14:12,227 [INFO]: 	99p_search_speed_ms: 22.773785947356362
2025-03-13 18:14:12,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:12,227 [INFO]: 	nb vectors: 4009
2025-03-13 18:14:12,227 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:12,227 [INFO]: 	compression ratio: 0.9993085259406481
2025-03-13 18:14:12,227 [INFO]: }
2025-03-13 18:14:12,227 [INFO]: 	>>> Finished "Creating the index" in 91.1791 secs
2025-03-13 18:14:12,227 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2127 secs
2025-03-13 18:14:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 80612 [episode count 10/20]
[retrieval_preprocessing] for episode 50410 [episode count 11/20], we have num_retrieval=np.int64(4021) num_query=np.int64(148)
2025-03-13 18:14:15,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:16,245 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:16
2025-03-13 18:14:16,246 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2153.13it/s]
2025-03-13 18:14:16,269 [INFO]: There are 4021 embeddings of dim 49152
2025-03-13 18:14:16,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 18:14:16,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:16,269 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:14:16,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:16,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:16,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,269 [INFO]: 829.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:16,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:14:16,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:16
2025-03-13 18:14:16,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:16,269 [INFO]: 	Creating the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:16
2025-03-13 18:14:16,270 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:14:16,270 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:16
2025-03-13 18:14:16,270 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:14:16,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.14it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.08it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.18it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.90it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.43it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.70it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.96it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.04it/s]100%|██████████| 16/16 [00:04<00:00,  3.49it/s]
2025-03-13 18:14:20,863 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:20
2025-03-13 18:15:09,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9204 secs
2025-03-13 18:15:09,784 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 18:15:09,784 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 18:15:41,081 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2972 secs
2025-03-13 18:15:41,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.8142 secs
2025-03-13 18:15:41,085 [INFO]: {
2025-03-13 18:15:41,085 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:41,085 [INFO]: 	index_param: efSearch=219
2025-03-13 18:15:41,085 [INFO]: 	index_path: knn.index
2025-03-13 18:15:41,085 [INFO]: 	size in bytes: 791107810
2025-03-13 18:15:41,085 [INFO]: 	avg_search_speed_ms: 10.518577369958257
2025-03-13 18:15:41,085 [INFO]: 	99p_search_speed_ms: 14.908788492903113
2025-03-13 18:15:41,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:41,085 [INFO]: 	nb vectors: 4021
2025-03-13 18:15:41,085 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:41,085 [INFO]: 	compression ratio: 0.9993085114404319
2025-03-13 18:15:41,085 [INFO]: }
2025-03-13 18:15:41,085 [INFO]: 	>>> Finished "Creating the index" in 84.8157 secs
2025-03-13 18:15:41,085 [INFO]: >>> Finished "Launching the whole pipeline" in 84.8394 secs
2025-03-13 18:15:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 50410 [episode count 11/20]
[retrieval_preprocessing] for episode 13548 [episode count 12/20], we have num_retrieval=np.int64(4041) num_query=np.int64(128)
2025-03-13 18:15:44,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:45,278 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:45
2025-03-13 18:15:45,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.98it/s]
2025-03-13 18:15:45,303 [INFO]: There are 4041 embeddings of dim 49152
2025-03-13 18:15:45,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:15:45,303 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:45
2025-03-13 18:15:45,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:45,304 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:15:45,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:45,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:45,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:45
2025-03-13 18:15:45,304 [INFO]: 834.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:45,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:45,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:45
2025-03-13 18:15:45,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:45,304 [INFO]: 	Creating the index 03/13/2025, 18:15:45
2025-03-13 18:15:45,304 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:45
2025-03-13 18:15:45,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:15:45,305 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:45
2025-03-13 18:15:45,305 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:15:45,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.47it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.58it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.44it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.47it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.60it/s] 50%|█████     | 8/16 [00:00<00:00,  9.47it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.15it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.91it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.07it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.10it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.85it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.46it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.22it/s]100%|██████████| 16/16 [00:05<00:00,  1.08s/it]100%|██████████| 16/16 [00:05<00:00,  3.19it/s]
2025-03-13 18:15:50,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:50
2025-03-13 18:16:30,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8459 secs
2025-03-13 18:16:30,506 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 18:16:30,506 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
2025-03-13 18:17:18,186 [INFO]: 	>>> Finished "Compute fast metrics" in 47.6802 secs
2025-03-13 18:17:18,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8843 secs
2025-03-13 18:17:18,190 [INFO]: {
2025-03-13 18:17:18,190 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:18,190 [INFO]: 	index_param: efSearch=195
2025-03-13 18:17:18,190 [INFO]: 	index_path: knn.index
2025-03-13 18:17:18,190 [INFO]: 	size in bytes: 795042670
2025-03-13 18:17:18,190 [INFO]: 	avg_search_speed_ms: 9.981034653067976
2025-03-13 18:17:18,190 [INFO]: 	99p_search_speed_ms: 17.528251421172172
2025-03-13 18:17:18,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:18,190 [INFO]: 	nb vectors: 4041
2025-03-13 18:17:18,190 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:18,190 [INFO]: 	compression ratio: 0.9993085377417542
2025-03-13 18:17:18,190 [INFO]: }
2025-03-13 18:17:18,190 [INFO]: 	>>> Finished "Creating the index" in 92.8859 secs
2025-03-13 18:17:18,190 [INFO]: >>> Finished "Launching the whole pipeline" in 92.9120 secs
2025-03-13 18:17:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 13548 [episode count 12/20]
[retrieval_preprocessing] for episode 16143 [episode count 13/20], we have num_retrieval=np.int64(4023) num_query=np.int64(146)
2025-03-13 18:17:21,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:22,219 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:22
2025-03-13 18:17:22,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-13 18:17:22,245 [INFO]: There are 4023 embeddings of dim 49152
2025-03-13 18:17:22,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:17:22,245 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:22
2025-03-13 18:17:22,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:22,245 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:17:22,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:22,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:17:22,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:22
2025-03-13 18:17:22,246 [INFO]: 830.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:22,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:17:22,246 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:22
2025-03-13 18:17:22,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:22,246 [INFO]: 	Creating the index 03/13/2025, 18:17:22
2025-03-13 18:17:22,246 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:22
2025-03-13 18:17:22,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:17:22,247 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:22
2025-03-13 18:17:22,247 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:17:22,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.21it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.86it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.79it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.51it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.24it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.58it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.90it/s] 50%|█████     | 8/16 [00:01<00:00,  9.02it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.11it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.12it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.22it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.07it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.30it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.49it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.91it/s]100%|██████████| 16/16 [00:04<00:00,  1.03s/it]100%|██████████| 16/16 [00:04<00:00,  3.23it/s]
2025-03-13 18:17:27,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:27
2025-03-13 18:18:13,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7221 secs
2025-03-13 18:18:13,931 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:18:13,931 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 18:18:54,978 [INFO]: 	>>> Finished "Compute fast metrics" in 41.0477 secs
2025-03-13 18:18:55,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.9467 secs
2025-03-13 18:18:55,194 [INFO]: {
2025-03-13 18:18:55,194 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:55,194 [INFO]: 	index_param: efSearch=204
2025-03-13 18:18:55,194 [INFO]: 	index_path: knn.index
2025-03-13 18:18:55,194 [INFO]: 	size in bytes: 791501290
2025-03-13 18:18:55,194 [INFO]: 	avg_search_speed_ms: 8.926409072384038
2025-03-13 18:18:55,194 [INFO]: 	99p_search_speed_ms: 14.222268078010524
2025-03-13 18:18:55,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:55,195 [INFO]: 	nb vectors: 4023
2025-03-13 18:18:55,195 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:55,195 [INFO]: 	compression ratio: 0.9993085216576211
2025-03-13 18:18:55,195 [INFO]: }
2025-03-13 18:18:55,195 [INFO]: 	>>> Finished "Creating the index" in 92.9490 secs
2025-03-13 18:18:55,195 [INFO]: >>> Finished "Launching the whole pipeline" in 92.9754 secs
2025-03-13 18:18:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 16143 [episode count 13/20]
[retrieval_preprocessing] for episode 40719 [episode count 14/20], we have num_retrieval=np.int64(3966) num_query=np.int64(203)
2025-03-13 18:18:57,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:59,155 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:59
2025-03-13 18:18:59,155 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1545.43it/s]
2025-03-13 18:18:59,179 [INFO]: There are 3966 embeddings of dim 49152
2025-03-13 18:18:59,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 18:18:59,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:59,179 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:18:59,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:59,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:59,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,180 [INFO]: 818.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:59,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:18:59,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:59
2025-03-13 18:18:59,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:59,180 [INFO]: 	Creating the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:59
2025-03-13 18:18:59,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:18:59,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:59
2025-03-13 18:18:59,181 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:18:59,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.22it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.54it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.58it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.24it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.56it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.76it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.94it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.07it/s]100%|██████████| 16/16 [00:04<00:00,  3.96it/s]
2025-03-13 18:19:03,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:03
2025-03-13 18:19:46,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0274 secs
2025-03-13 18:19:46,256 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:19:46,256 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 18:20:15,914 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6579 secs
2025-03-13 18:20:15,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7373 secs
2025-03-13 18:20:15,918 [INFO]: {
2025-03-13 18:20:15,918 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:15,918 [INFO]: 	index_param: efSearch=206
2025-03-13 18:20:15,918 [INFO]: 	index_path: knn.index
2025-03-13 18:20:15,918 [INFO]: 	size in bytes: 780286870
2025-03-13 18:20:15,918 [INFO]: 	avg_search_speed_ms: 10.216566877753227
2025-03-13 18:20:15,918 [INFO]: 	99p_search_speed_ms: 16.3639738271013
2025-03-13 18:20:15,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:15,918 [INFO]: 	nb vectors: 3966
2025-03-13 18:20:15,918 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:15,918 [INFO]: 	compression ratio: 0.9993085337960383
2025-03-13 18:20:15,918 [INFO]: }
2025-03-13 18:20:15,919 [INFO]: 	>>> Finished "Creating the index" in 76.7387 secs
2025-03-13 18:20:15,919 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7633 secs
2025-03-13 18:20:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 40719 [episode count 14/20]
[retrieval_preprocessing] for episode 70939 [episode count 15/20], we have num_retrieval=np.int64(3936) num_query=np.int64(233)
2025-03-13 18:20:19,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:19,908 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:19
2025-03-13 18:20:19,908 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1016.55it/s]
2025-03-13 18:20:19,933 [INFO]: There are 3936 embeddings of dim 49152
2025-03-13 18:20:19,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:20:19,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:19
2025-03-13 18:20:19,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:19,933 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:20:19,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:19,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:19,934 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:19
2025-03-13 18:20:19,934 [INFO]: 812.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:19,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:20:19,934 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:19
2025-03-13 18:20:19,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:19,934 [INFO]: 	Creating the index 03/13/2025, 18:20:19
2025-03-13 18:20:19,934 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:19
2025-03-13 18:20:19,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:20:19,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:19
2025-03-13 18:20:19,935 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:20:19,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.87it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.02it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.07it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.69it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.96it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.08it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.05it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.10it/s]100%|██████████| 16/16 [00:04<00:00,  3.60it/s]
2025-03-13 18:20:24,385 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:24
2025-03-13 18:21:10,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3439 secs
2025-03-13 18:21:10,730 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:21:10,730 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 18:21:33,269 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5389 secs
2025-03-13 18:21:33,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3364 secs
2025-03-13 18:21:33,271 [INFO]: {
2025-03-13 18:21:33,272 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:33,272 [INFO]: 	index_param: efSearch=226
2025-03-13 18:21:33,272 [INFO]: 	index_path: knn.index
2025-03-13 18:21:33,272 [INFO]: 	size in bytes: 774384610
2025-03-13 18:21:33,272 [INFO]: 	avg_search_speed_ms: 10.28789272493541
2025-03-13 18:21:33,272 [INFO]: 	99p_search_speed_ms: 14.770717199426144
2025-03-13 18:21:33,272 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:33,272 [INFO]: 	nb vectors: 3936
2025-03-13 18:21:33,272 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:33,272 [INFO]: 	compression ratio: 0.9993084547483453
2025-03-13 18:21:33,272 [INFO]: }
2025-03-13 18:21:33,272 [INFO]: 	>>> Finished "Creating the index" in 73.3379 secs
2025-03-13 18:21:33,272 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3640 secs
2025-03-13 18:21:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 70939 [episode count 15/20]
[retrieval_preprocessing] for episode 80686 [episode count 16/20], we have num_retrieval=np.int64(4005) num_query=np.int64(164)
2025-03-13 18:21:36,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:37,138 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:37
2025-03-13 18:21:37,138 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2229.83it/s]
2025-03-13 18:21:37,161 [INFO]: There are 4005 embeddings of dim 49152
2025-03-13 18:21:37,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:21:37,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:37
2025-03-13 18:21:37,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:37,161 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:21:37,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:37,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:37,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:37
2025-03-13 18:21:37,162 [INFO]: 826.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:37,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:21:37,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:37
2025-03-13 18:21:37,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:37,162 [INFO]: 	Creating the index 03/13/2025, 18:21:37
2025-03-13 18:21:37,162 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:37
2025-03-13 18:21:37,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:21:37,163 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:37
2025-03-13 18:21:37,163 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:21:37,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.44it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.01it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.06it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.66it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.96it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.07it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.22it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.46it/s]100%|██████████| 16/16 [00:04<00:00,  3.91it/s]
2025-03-13 18:21:41,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:41
2025-03-13 18:22:24,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3763 secs
2025-03-13 18:22:24,636 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 18:22:24,636 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 18:22:53,916 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2799 secs
2025-03-13 18:22:53,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7572 secs
2025-03-13 18:22:53,920 [INFO]: {
2025-03-13 18:22:53,920 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:53,920 [INFO]: 	index_param: efSearch=207
2025-03-13 18:22:53,920 [INFO]: 	index_path: knn.index
2025-03-13 18:22:53,920 [INFO]: 	size in bytes: 787959850
2025-03-13 18:22:53,920 [INFO]: 	avg_search_speed_ms: 10.028570833968704
2025-03-13 18:22:53,920 [INFO]: 	99p_search_speed_ms: 16.8480132217519
2025-03-13 18:22:53,920 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:53,920 [INFO]: 	nb vectors: 4005
2025-03-13 18:22:53,920 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:53,920 [INFO]: 	compression ratio: 0.9993085815222692
2025-03-13 18:22:53,920 [INFO]: }
2025-03-13 18:22:53,920 [INFO]: 	>>> Finished "Creating the index" in 76.7586 secs
2025-03-13 18:22:53,920 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7827 secs
2025-03-13 18:22:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 80686 [episode count 16/20]
[retrieval_preprocessing] for episode 48482 [episode count 17/20], we have num_retrieval=np.int64(3999) num_query=np.int64(170)
2025-03-13 18:22:57,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:57,933 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:57
2025-03-13 18:22:57,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 814.11it/s]
2025-03-13 18:22:57,962 [INFO]: There are 3999 embeddings of dim 49152
2025-03-13 18:22:57,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:22:57,962 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:57,962 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:22:57,962 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:57,962 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:57,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,963 [INFO]: 825.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:57,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:57,963 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:57
2025-03-13 18:22:57,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:57,963 [INFO]: 	Creating the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:57
2025-03-13 18:22:57,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:22:57,964 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,964 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:22:57,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.75it/s] 19%|█▉        | 3/16 [00:00<00:00, 13.53it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.25it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.91it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.81it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.59it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.77it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.86it/s]100%|██████████| 16/16 [00:05<00:00,  3.20it/s]
2025-03-13 18:23:02,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:02
2025-03-13 18:23:49,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8383 secs
2025-03-13 18:23:49,820 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:23:49,820 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-13 18:24:19,508 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6873 secs
2025-03-13 18:24:19,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.5461 secs
2025-03-13 18:24:19,511 [INFO]: {
2025-03-13 18:24:19,511 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:19,511 [INFO]: 	index_param: efSearch=222
2025-03-13 18:24:19,511 [INFO]: 	index_path: knn.index
2025-03-13 18:24:19,511 [INFO]: 	size in bytes: 786779410
2025-03-13 18:24:19,511 [INFO]: 	avg_search_speed_ms: 9.416774186926583
2025-03-13 18:24:19,511 [INFO]: 	99p_search_speed_ms: 13.655351269990225
2025-03-13 18:24:19,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:19,511 [INFO]: 	nb vectors: 3999
2025-03-13 18:24:19,511 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:19,511 [INFO]: 	compression ratio: 0.9993085507918922
2025-03-13 18:24:19,511 [INFO]: }
2025-03-13 18:24:19,511 [INFO]: 	>>> Finished "Creating the index" in 81.5477 secs
2025-03-13 18:24:19,511 [INFO]: >>> Finished "Launching the whole pipeline" in 81.5775 secs
2025-03-13 18:24:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 48482 [episode count 17/20]
[retrieval_preprocessing] for episode 56674 [episode count 18/20], we have num_retrieval=np.int64(3970) num_query=np.int64(199)
2025-03-13 18:24:24,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:25,247 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:25
2025-03-13 18:24:25,247 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.90it/s]
2025-03-13 18:24:25,272 [INFO]: There are 3970 embeddings of dim 49152
2025-03-13 18:24:25,273 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:24:25,273 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:25
2025-03-13 18:24:25,273 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:25,273 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:24:25,273 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:25,273 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:25,273 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:25
2025-03-13 18:24:25,273 [INFO]: 819.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:25,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:24:25,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:25
2025-03-13 18:24:25,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:25,273 [INFO]: 	Creating the index 03/13/2025, 18:24:25
2025-03-13 18:24:25,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:25
2025-03-13 18:24:25,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:24:25,274 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:25
2025-03-13 18:24:25,274 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:24:25,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.02it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.54it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.36it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.93it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.31it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.29it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.97it/s] 50%|█████     | 8/16 [00:01<00:01,  7.81it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.67it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.62it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.54it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.55it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.60it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.99it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.21it/s]100%|██████████| 16/16 [00:05<00:00,  1.02s/it]100%|██████████| 16/16 [00:05<00:00,  3.17it/s]
2025-03-13 18:24:30,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:30
2025-03-13 18:25:14,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0298 secs
2025-03-13 18:25:14,351 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:25:14,351 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s]
2025-03-13 18:25:47,392 [INFO]: 	>>> Finished "Compute fast metrics" in 33.0415 secs
2025-03-13 18:25:47,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.1207 secs
2025-03-13 18:25:47,395 [INFO]: {
2025-03-13 18:25:47,395 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:47,395 [INFO]: 	index_param: efSearch=213
2025-03-13 18:25:47,395 [INFO]: 	index_path: knn.index
2025-03-13 18:25:47,395 [INFO]: 	size in bytes: 781073830
2025-03-13 18:25:47,395 [INFO]: 	avg_search_speed_ms: 9.44887146061749
2025-03-13 18:25:47,395 [INFO]: 	99p_search_speed_ms: 13.17154331598431
2025-03-13 18:25:47,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:47,395 [INFO]: 	nb vectors: 3970
2025-03-13 18:25:47,395 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:47,395 [INFO]: 	compression ratio: 0.9993085544806949
2025-03-13 18:25:47,395 [INFO]: }
2025-03-13 18:25:47,395 [INFO]: 	>>> Finished "Creating the index" in 82.1221 secs
2025-03-13 18:25:47,395 [INFO]: >>> Finished "Launching the whole pipeline" in 82.1487 secs
2025-03-13 18:25:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 56674 [episode count 18/20]
[retrieval_preprocessing] for episode 12652 [episode count 19/20], we have num_retrieval=np.int64(4003) num_query=np.int64(166)
2025-03-13 18:25:51,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:52,065 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:52
2025-03-13 18:25:52,065 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.45it/s]
2025-03-13 18:25:52,091 [INFO]: There are 4003 embeddings of dim 49152
2025-03-13 18:25:52,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:25:52,092 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,092 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:52,092 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:25:52,092 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:52,092 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:25:52,092 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,092 [INFO]: 826.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:52,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:25:52,093 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:52
2025-03-13 18:25:52,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:52,093 [INFO]: 	Creating the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,093 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:52
2025-03-13 18:25:52,095 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:25:52,095 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:52
2025-03-13 18:25:52,096 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:25:52,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.26it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.12it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.63it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.24it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.66it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.79it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.83it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.75it/s]100%|██████████| 16/16 [00:04<00:00,  3.43it/s]
2025-03-13 18:25:56,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:56
2025-03-13 18:26:46,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4790 secs
2025-03-13 18:26:46,257 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 18:26:46,257 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 18:27:08,980 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7230 secs
2025-03-13 18:27:08,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8876 secs
2025-03-13 18:27:08,983 [INFO]: {
2025-03-13 18:27:08,984 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:08,984 [INFO]: 	index_param: efSearch=165
2025-03-13 18:27:08,984 [INFO]: 	index_path: knn.index
2025-03-13 18:27:08,984 [INFO]: 	size in bytes: 787566370
2025-03-13 18:27:08,984 [INFO]: 	avg_search_speed_ms: 10.357584298865996
2025-03-13 18:27:08,984 [INFO]: 	99p_search_speed_ms: 18.821336899418394
2025-03-13 18:27:08,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:08,984 [INFO]: 	nb vectors: 4003
2025-03-13 18:27:08,984 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:08,984 [INFO]: 	compression ratio: 0.9993085712890458
2025-03-13 18:27:08,984 [INFO]: }
2025-03-13 18:27:08,984 [INFO]: 	>>> Finished "Creating the index" in 76.8905 secs
2025-03-13 18:27:08,984 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9187 secs
2025-03-13 18:27:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 12652 [episode count 19/20]
2025-03-13 18:27:10: [retrieval_preprocessing] finished for 8351259745_open_door [chosen_id count 6/196]
2025-03-13 18:27:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_put_marker_in_bowl [chosen_id count 7/196]
2025-03-13 18:27:12: [retrieval_preprocessing] we have num_total=3179 embedding_dim=49152
[retrieval_preprocessing] for episode 22540 [episode count 0/20], we have num_retrieval=np.int64(3012) num_query=np.int64(167)
2025-03-13 18:27:14,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:14,659 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:14
2025-03-13 18:27:14,659 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 886.56it/s]
2025-03-13 18:27:14,692 [INFO]: There are 3012 embeddings of dim 49152
2025-03-13 18:27:14,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 18:27:14,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:14,693 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:27:14,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:14,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:14,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,693 [INFO]: 621.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:14,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:27:14,693 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:14
2025-03-13 18:27:14,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:14,693 [INFO]: 	Creating the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,693 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:14
2025-03-13 18:27:14,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:27:14,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,695 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:27:14,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.55it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.46it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.43it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.56it/s] 50%|█████     | 6/12 [00:00<00:00,  9.61it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.29it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.06it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.93it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.95it/s]100%|██████████| 12/12 [00:03<00:00,  1.73it/s]100%|██████████| 12/12 [00:03<00:00,  3.54it/s]
2025-03-13 18:27:18,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:18
2025-03-13 18:28:00,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8959 secs
2025-03-13 18:28:00,993 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:28:00,993 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 18:28:23,470 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4760 secs
2025-03-13 18:28:23,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7770 secs
2025-03-13 18:28:23,472 [INFO]: {
2025-03-13 18:28:23,472 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:23,472 [INFO]: 	index_param: efSearch=209
2025-03-13 18:28:23,472 [INFO]: 	index_path: knn.index
2025-03-13 18:28:23,472 [INFO]: 	size in bytes: 592592290
2025-03-13 18:28:23,472 [INFO]: 	avg_search_speed_ms: 10.299894485879694
2025-03-13 18:28:23,472 [INFO]: 	99p_search_speed_ms: 17.061800323426713
2025-03-13 18:28:23,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:23,472 [INFO]: 	nb vectors: 3012
2025-03-13 18:28:23,472 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:23,472 [INFO]: 	compression ratio: 0.999309822272578
2025-03-13 18:28:23,472 [INFO]: }
2025-03-13 18:28:23,472 [INFO]: 	>>> Finished "Creating the index" in 68.7789 secs
2025-03-13 18:28:23,472 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8133 secs
2025-03-13 18:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 22540 [episode count 0/20]
[retrieval_preprocessing] for episode 2063 [episode count 1/20], we have num_retrieval=np.int64(3045) num_query=np.int64(134)
2025-03-13 18:28:25,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:26,321 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:26
2025-03-13 18:28:26,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2273.34it/s]
2025-03-13 18:28:26,345 [INFO]: There are 3045 embeddings of dim 49152
2025-03-13 18:28:26,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:28:26,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:26
2025-03-13 18:28:26,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:26,345 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:28:26,345 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:26,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:26,345 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:26
2025-03-13 18:28:26,345 [INFO]: 628.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:26,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:28:26,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:26
2025-03-13 18:28:26,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:26,345 [INFO]: 	Creating the index 03/13/2025, 18:28:26
2025-03-13 18:28:26,346 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:26
2025-03-13 18:28:26,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:28:26,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:26
2025-03-13 18:28:26,347 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:28:26,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.39it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.02it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.83it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.09it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.23it/s] 50%|█████     | 6/12 [00:00<00:00,  8.26it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.35it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.42it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.57it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.85it/s]100%|██████████| 12/12 [00:03<00:00,  1.75it/s]100%|██████████| 12/12 [00:03<00:00,  3.53it/s]
2025-03-13 18:28:30,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:30
2025-03-13 18:28:59,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3322 secs
2025-03-13 18:28:59,572 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 18:28:59,572 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.85it/s]
2025-03-13 18:29:31,087 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5151 secs
2025-03-13 18:29:31,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7428 secs
2025-03-13 18:29:31,090 [INFO]: {
2025-03-13 18:29:31,090 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:31,090 [INFO]: 	index_param: efSearch=233
2025-03-13 18:29:31,090 [INFO]: 	index_path: knn.index
2025-03-13 18:29:31,090 [INFO]: 	size in bytes: 599084770
2025-03-13 18:29:31,090 [INFO]: 	avg_search_speed_ms: 10.523874315580255
2025-03-13 18:29:31,090 [INFO]: 	99p_search_speed_ms: 20.636249191593375
2025-03-13 18:29:31,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:31,090 [INFO]: 	nb vectors: 3045
2025-03-13 18:29:31,090 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:31,090 [INFO]: 	compression ratio: 0.9993099307131443
2025-03-13 18:29:31,090 [INFO]: }
2025-03-13 18:29:31,090 [INFO]: 	>>> Finished "Creating the index" in 64.7443 secs
2025-03-13 18:29:31,090 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7690 secs
2025-03-13 18:29:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 2063 [episode count 1/20]
[retrieval_preprocessing] for episode 8214 [episode count 2/20], we have num_retrieval=np.int64(3001) num_query=np.int64(178)
2025-03-13 18:29:34,095 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:34,566 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:34
2025-03-13 18:29:34,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 18:29:34,592 [INFO]: There are 3001 embeddings of dim 49152
2025-03-13 18:29:34,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:29:34,593 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:34,593 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:29:34,593 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:34,593 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:29:34,593 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,593 [INFO]: 619.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:34,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:29:34,593 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:34
2025-03-13 18:29:34,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:34,593 [INFO]: 	Creating the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:34
2025-03-13 18:29:34,594 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:29:34,594 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:34
2025-03-13 18:29:34,594 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:29:34,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.45it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.41it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.14it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.29it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.02it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.46it/s] 92%|█████████▏| 11/12 [00:00<00:00, 13.41it/s]100%|██████████| 12/12 [00:03<00:00,  3.74it/s]
2025-03-13 18:29:37,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:37
2025-03-13 18:30:15,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9939 secs
2025-03-13 18:30:15,805 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 18:30:15,805 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.97it/s]
2025-03-13 18:30:34,661 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8561 secs
2025-03-13 18:30:34,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0689 secs
2025-03-13 18:30:34,664 [INFO]: {
2025-03-13 18:30:34,664 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:34,664 [INFO]: 	index_param: efSearch=263
2025-03-13 18:30:34,664 [INFO]: 	index_path: knn.index
2025-03-13 18:30:34,664 [INFO]: 	size in bytes: 590428150
2025-03-13 18:30:34,664 [INFO]: 	avg_search_speed_ms: 10.454567905433686
2025-03-13 18:30:34,664 [INFO]: 	99p_search_speed_ms: 14.082713350653641
2025-03-13 18:30:34,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:34,664 [INFO]: 	nb vectors: 3001
2025-03-13 18:30:34,664 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:34,664 [INFO]: 	compression ratio: 0.9993097517454071
2025-03-13 18:30:34,664 [INFO]: }
2025-03-13 18:30:34,664 [INFO]: 	>>> Finished "Creating the index" in 60.0706 secs
2025-03-13 18:30:34,664 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0973 secs
2025-03-13 18:30:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 8214 [episode count 2/20]
[retrieval_preprocessing] for episode 51229 [episode count 3/20], we have num_retrieval=np.int64(3036) num_query=np.int64(143)
2025-03-13 18:30:37,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:38,588 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:38
2025-03-13 18:30:38,588 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2290.72it/s]
2025-03-13 18:30:38,611 [INFO]: There are 3036 embeddings of dim 49152
2025-03-13 18:30:38,611 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 18:30:38,611 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,611 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:38,612 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:30:38,612 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:38,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:30:38,612 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,612 [INFO]: 626.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:38,612 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:30:38,612 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:38
2025-03-13 18:30:38,612 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:38,612 [INFO]: 	Creating the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,612 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:38
2025-03-13 18:30:38,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:30:38,613 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,613 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:30:38,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  3.40it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.30it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.46it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.21it/s] 50%|█████     | 6/12 [00:00<00:00,  9.95it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.64it/s] 83%|████████▎ | 10/12 [00:01<00:00, 12.45it/s]100%|██████████| 12/12 [00:03<00:00,  1.94it/s]100%|██████████| 12/12 [00:03<00:00,  3.25it/s]
2025-03-13 18:30:42,317 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:42
2025-03-13 18:31:15,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1789 secs
2025-03-13 18:31:15,497 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:31:15,497 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-13 18:31:40,849 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3520 secs
2025-03-13 18:31:40,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2382 secs
2025-03-13 18:31:40,851 [INFO]: {
2025-03-13 18:31:40,851 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:40,851 [INFO]: 	index_param: efSearch=268
2025-03-13 18:31:40,851 [INFO]: 	index_path: knn.index
2025-03-13 18:31:40,851 [INFO]: 	size in bytes: 597314110
2025-03-13 18:31:40,851 [INFO]: 	avg_search_speed_ms: 12.062257244246052
2025-03-13 18:31:40,851 [INFO]: 	99p_search_speed_ms: 21.88198159448805
2025-03-13 18:31:40,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:40,852 [INFO]: 	nb vectors: 3036
2025-03-13 18:31:40,852 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:40,852 [INFO]: 	compression ratio: 0.9993098739957775
2025-03-13 18:31:40,852 [INFO]: }
2025-03-13 18:31:40,852 [INFO]: 	>>> Finished "Creating the index" in 62.2396 secs
2025-03-13 18:31:40,852 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2631 secs
2025-03-13 18:31:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 51229 [episode count 3/20]
[retrieval_preprocessing] for episode 12333 [episode count 4/20], we have num_retrieval=np.int64(2961) num_query=np.int64(218)
2025-03-13 18:31:44,365 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:44,958 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:44
2025-03-13 18:31:44,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.79it/s]
2025-03-13 18:31:44,986 [INFO]: There are 2961 embeddings of dim 49152
2025-03-13 18:31:44,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:31:44,986 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:44
2025-03-13 18:31:44,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:44,986 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:31:44,986 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:44,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:31:44,986 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:44
2025-03-13 18:31:44,987 [INFO]: 611.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:44,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:31:44,987 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:44
2025-03-13 18:31:44,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:44,987 [INFO]: 	Creating the index 03/13/2025, 18:31:44
2025-03-13 18:31:44,987 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:44
2025-03-13 18:31:44,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:31:44,988 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:44
2025-03-13 18:31:44,988 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:31:44,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.68it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.30it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.72it/s] 50%|█████     | 6/12 [00:00<00:00,  9.85it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.54it/s] 83%|████████▎ | 10/12 [00:00<00:00, 11.06it/s]100%|██████████| 12/12 [00:03<00:00,  2.34it/s]100%|██████████| 12/12 [00:03<00:00,  3.82it/s]
2025-03-13 18:31:48,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:48
2025-03-13 18:32:20,840 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7035 secs
2025-03-13 18:32:20,841 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:32:20,841 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 18:32:52,678 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8368 secs
2025-03-13 18:32:52,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6918 secs
2025-03-13 18:32:52,680 [INFO]: {
2025-03-13 18:32:52,680 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:52,680 [INFO]: 	index_param: efSearch=161
2025-03-13 18:32:52,680 [INFO]: 	index_path: knn.index
2025-03-13 18:32:52,680 [INFO]: 	size in bytes: 582558490
2025-03-13 18:32:52,680 [INFO]: 	avg_search_speed_ms: 7.426259383963307
2025-03-13 18:32:52,680 [INFO]: 	99p_search_speed_ms: 9.62483229814097
2025-03-13 18:32:52,680 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:52,680 [INFO]: 	nb vectors: 2961
2025-03-13 18:32:52,680 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:52,680 [INFO]: 	compression ratio: 0.9993095937885996
2025-03-13 18:32:52,680 [INFO]: }
2025-03-13 18:32:52,680 [INFO]: 	>>> Finished "Creating the index" in 67.6935 secs
2025-03-13 18:32:52,680 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7219 secs
2025-03-13 18:32:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 12333 [episode count 4/20]
[retrieval_preprocessing] for episode 71745 [episode count 5/20], we have num_retrieval=np.int64(3007) num_query=np.int64(172)
2025-03-13 18:32:55,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:56,332 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:56
2025-03-13 18:32:56,332 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1762.31it/s]
2025-03-13 18:32:56,355 [INFO]: There are 3007 embeddings of dim 49152
2025-03-13 18:32:56,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 18:32:56,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:56,356 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:32:56,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:56,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:32:56,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,356 [INFO]: 620.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:56,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:32:56,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:56
2025-03-13 18:32:56,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:56,356 [INFO]: 	Creating the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:56
2025-03-13 18:32:56,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:32:56,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:56
2025-03-13 18:32:56,357 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:32:56,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  3.81it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.52it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.68it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.46it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.85it/s] 50%|█████     | 6/12 [00:00<00:00,  8.37it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.51it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.57it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.50it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.47it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.38it/s]100%|██████████| 12/12 [00:03<00:00,  1.22it/s]100%|██████████| 12/12 [00:03<00:00,  3.13it/s]
2025-03-13 18:33:00,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:00
2025-03-13 18:33:31,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8964 secs
2025-03-13 18:33:31,099 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 18:33:31,099 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 18:34:01,460 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3614 secs
2025-03-13 18:34:02,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8077 secs
2025-03-13 18:34:02,165 [INFO]: {
2025-03-13 18:34:02,165 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:02,166 [INFO]: 	index_param: efSearch=275
2025-03-13 18:34:02,166 [INFO]: 	index_path: knn.index
2025-03-13 18:34:02,166 [INFO]: 	size in bytes: 591608590
2025-03-13 18:34:02,166 [INFO]: 	avg_search_speed_ms: 10.542809928387593
2025-03-13 18:34:02,166 [INFO]: 	99p_search_speed_ms: 14.279083134606477
2025-03-13 18:34:02,166 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:02,166 [INFO]: 	nb vectors: 3007
2025-03-13 18:34:02,166 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:02,166 [INFO]: 	compression ratio: 0.9993097902787382
2025-03-13 18:34:02,166 [INFO]: }
2025-03-13 18:34:02,166 [INFO]: 	>>> Finished "Creating the index" in 65.8100 secs
2025-03-13 18:34:02,166 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8339 secs
2025-03-13 18:34:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 71745 [episode count 5/20]
[retrieval_preprocessing] for episode 67668 [episode count 6/20], we have num_retrieval=np.int64(2993) num_query=np.int64(186)
2025-03-13 18:34:05,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:05,662 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:05
2025-03-13 18:34:05,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2114.06it/s]
2025-03-13 18:34:05,688 [INFO]: There are 2993 embeddings of dim 49152
2025-03-13 18:34:05,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:34:05,689 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:05
2025-03-13 18:34:05,689 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:05,689 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:34:05,689 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:05,689 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:05,689 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:05
2025-03-13 18:34:05,689 [INFO]: 617.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:05,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:05,689 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:05
2025-03-13 18:34:05,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:05,689 [INFO]: 	Creating the index 03/13/2025, 18:34:05
2025-03-13 18:34:05,689 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:05
2025-03-13 18:34:05,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:34:05,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:05
2025-03-13 18:34:05,691 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:34:05,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.79it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.52it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.76it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.47it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.00it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.32it/s]100%|██████████| 12/12 [00:03<00:00,  3.62it/s]
2025-03-13 18:34:09,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:09
2025-03-13 18:34:42,647 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6318 secs
2025-03-13 18:34:42,648 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 18:34:42,648 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-13 18:35:01,686 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0379 secs
2025-03-13 18:35:01,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9975 secs
2025-03-13 18:35:01,688 [INFO]: {
2025-03-13 18:35:01,688 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:01,688 [INFO]: 	index_param: efSearch=181
2025-03-13 18:35:01,688 [INFO]: 	index_path: knn.index
2025-03-13 18:35:01,688 [INFO]: 	size in bytes: 588854230
2025-03-13 18:35:01,688 [INFO]: 	avg_search_speed_ms: 7.898929843195019
2025-03-13 18:35:01,688 [INFO]: 	99p_search_speed_ms: 11.464240867644543
2025-03-13 18:35:01,688 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:01,688 [INFO]: 	nb vectors: 2993
2025-03-13 18:35:01,688 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:01,688 [INFO]: 	compression ratio: 0.9993097001273133
2025-03-13 18:35:01,688 [INFO]: }
2025-03-13 18:35:01,688 [INFO]: 	>>> Finished "Creating the index" in 55.9992 secs
2025-03-13 18:35:01,688 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0263 secs
2025-03-13 18:35:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 67668 [episode count 6/20]
[retrieval_preprocessing] for episode 2197 [episode count 7/20], we have num_retrieval=np.int64(2934) num_query=np.int64(245)
2025-03-13 18:35:03,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:04,451 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:04
2025-03-13 18:35:04,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1859.18it/s]
2025-03-13 18:35:04,474 [INFO]: There are 2934 embeddings of dim 49152
2025-03-13 18:35:04,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:35:04,475 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:04
2025-03-13 18:35:04,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:04,475 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:35:04,475 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:04,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:35:04,475 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:04
2025-03-13 18:35:04,475 [INFO]: 605.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:04,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:35:04,475 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:04
2025-03-13 18:35:04,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:04,475 [INFO]: 	Creating the index 03/13/2025, 18:35:04
2025-03-13 18:35:04,475 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:04
2025-03-13 18:35:04,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:35:04,476 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:04
2025-03-13 18:35:04,476 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:35:04,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.56it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.76it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.01it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.53it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.77it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.06it/s]100%|██████████| 12/12 [00:03<00:00,  3.92it/s]
2025-03-13 18:35:07,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:07
2025-03-13 18:35:40,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9548 secs
2025-03-13 18:35:40,497 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:35:40,497 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 18:36:07,473 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9757 secs
2025-03-13 18:36:07,475 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9990 secs
2025-03-13 18:36:07,475 [INFO]: {
2025-03-13 18:36:07,475 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:07,475 [INFO]: 	index_param: efSearch=271
2025-03-13 18:36:07,475 [INFO]: 	index_path: knn.index
2025-03-13 18:36:07,475 [INFO]: 	size in bytes: 577246330
2025-03-13 18:36:07,475 [INFO]: 	avg_search_speed_ms: 10.489640643102863
2025-03-13 18:36:07,475 [INFO]: 	99p_search_speed_ms: 13.261496722698213
2025-03-13 18:36:07,475 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:07,476 [INFO]: 	nb vectors: 2934
2025-03-13 18:36:07,476 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:07,476 [INFO]: 	compression ratio: 0.999309726230741
2025-03-13 18:36:07,476 [INFO]: }
2025-03-13 18:36:07,476 [INFO]: 	>>> Finished "Creating the index" in 63.0003 secs
2025-03-13 18:36:07,476 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0246 secs
2025-03-13 18:36:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 2197 [episode count 7/20]
[retrieval_preprocessing] for episode 65687 [episode count 8/20], we have num_retrieval=np.int64(3032) num_query=np.int64(147)
2025-03-13 18:36:11,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:11,453 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:11
2025-03-13 18:36:11,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10485.76it/s]
2025-03-13 18:36:11,478 [INFO]: There are 3032 embeddings of dim 49152
2025-03-13 18:36:11,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:36:11,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:11
2025-03-13 18:36:11,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:11,478 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:36:11,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:11,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:11,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:11
2025-03-13 18:36:11,478 [INFO]: 625.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:11,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:36:11,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:11
2025-03-13 18:36:11,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:11,478 [INFO]: 	Creating the index 03/13/2025, 18:36:11
2025-03-13 18:36:11,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:11
2025-03-13 18:36:11,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:36:11,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:11
2025-03-13 18:36:11,480 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:36:11,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.91it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.60it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.31it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.45it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.38it/s] 50%|█████     | 6/12 [00:00<00:00,  8.37it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.36it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.39it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.39it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.42it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.42it/s]100%|██████████| 12/12 [00:03<00:00,  1.15it/s]100%|██████████| 12/12 [00:03<00:00,  3.05it/s]
2025-03-13 18:36:15,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:15
2025-03-13 18:36:49,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7389 secs
2025-03-13 18:36:49,161 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 18:36:49,162 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.36it/s]
2025-03-13 18:37:09,073 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9114 secs
2025-03-13 18:37:09,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5954 secs
2025-03-13 18:37:09,076 [INFO]: {
2025-03-13 18:37:09,076 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:09,076 [INFO]: 	index_param: efSearch=191
2025-03-13 18:37:09,076 [INFO]: 	index_path: knn.index
2025-03-13 18:37:09,076 [INFO]: 	size in bytes: 596527150
2025-03-13 18:37:09,076 [INFO]: 	avg_search_speed_ms: 9.137735219835772
2025-03-13 18:37:09,076 [INFO]: 	99p_search_speed_ms: 18.374706974718706
2025-03-13 18:37:09,076 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:09,076 [INFO]: 	nb vectors: 3032
2025-03-13 18:37:09,076 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:09,076 [INFO]: 	compression ratio: 0.9993098486799804
2025-03-13 18:37:09,076 [INFO]: }
2025-03-13 18:37:09,076 [INFO]: 	>>> Finished "Creating the index" in 57.5973 secs
2025-03-13 18:37:09,076 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6223 secs
2025-03-13 18:37:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 65687 [episode count 8/20]
[retrieval_preprocessing] for episode 75950 [episode count 9/20], we have num_retrieval=np.int64(2987) num_query=np.int64(192)
2025-03-13 18:37:11,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:11,844 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:11
2025-03-13 18:37:11,844 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.92it/s]
2025-03-13 18:37:11,874 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 18:37:11,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:37:11,875 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:11
2025-03-13 18:37:11,875 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:11,875 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:37:11,875 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:11,875 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:37:11,875 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:11
2025-03-13 18:37:11,876 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:11,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:37:11,876 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:11
2025-03-13 18:37:11,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:11,876 [INFO]: 	Creating the index 03/13/2025, 18:37:11
2025-03-13 18:37:11,876 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:11
2025-03-13 18:37:11,879 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:37:11,879 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:11
2025-03-13 18:37:11,879 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:37:11,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.65it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.23it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.11it/s] 50%|█████     | 6/12 [00:00<00:00,  6.66it/s] 58%|█████▊    | 7/12 [00:01<00:00,  5.37it/s] 67%|██████▋   | 8/12 [00:01<00:00,  4.68it/s] 75%|███████▌  | 9/12 [00:01<00:00,  4.38it/s] 83%|████████▎ | 10/12 [00:01<00:00,  4.23it/s] 92%|█████████▏| 11/12 [00:02<00:00,  4.09it/s]100%|██████████| 12/12 [00:04<00:00,  1.07it/s]100%|██████████| 12/12 [00:04<00:00,  2.52it/s]
2025-03-13 18:37:16,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:16
2025-03-13 18:37:55,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8783 secs
2025-03-13 18:37:55,537 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:37:55,537 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.80it/s]
2025-03-13 18:38:21,437 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8999 secs
2025-03-13 18:38:22,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7545 secs
2025-03-13 18:38:22,634 [INFO]: {
2025-03-13 18:38:22,634 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:22,634 [INFO]: 	index_param: efSearch=221
2025-03-13 18:38:22,634 [INFO]: 	index_path: knn.index
2025-03-13 18:38:22,634 [INFO]: 	size in bytes: 587673790
2025-03-13 18:38:22,635 [INFO]: 	avg_search_speed_ms: 7.965078443081018
2025-03-13 18:38:22,635 [INFO]: 	99p_search_speed_ms: 10.244606235064573
2025-03-13 18:38:22,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:22,635 [INFO]: 	nb vectors: 2987
2025-03-13 18:38:22,635 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:22,635 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 18:38:22,635 [INFO]: }
2025-03-13 18:38:22,635 [INFO]: 	>>> Finished "Creating the index" in 70.7588 secs
2025-03-13 18:38:22,635 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7909 secs
2025-03-13 18:38:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 75950 [episode count 9/20]
[retrieval_preprocessing] for episode 41145 [episode count 10/20], we have num_retrieval=np.int64(2997) num_query=np.int64(182)
2025-03-13 18:38:24,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:25,059 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:25
2025-03-13 18:38:25,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.00it/s]
2025-03-13 18:38:25,083 [INFO]: There are 2997 embeddings of dim 49152
2025-03-13 18:38:25,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:38:25,083 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:25
2025-03-13 18:38:25,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:25,083 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:38:25,083 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:25,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:38:25,083 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:25
2025-03-13 18:38:25,083 [INFO]: 618.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:25,083 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:38:25,083 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:25
2025-03-13 18:38:25,083 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:25,083 [INFO]: 	Creating the index 03/13/2025, 18:38:25
2025-03-13 18:38:25,083 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:25
2025-03-13 18:38:25,084 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:38:25,084 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:25
2025-03-13 18:38:25,084 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:38:25,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.97it/s] 25%|██▌       | 3/12 [00:00<00:00, 11.18it/s] 42%|████▏     | 5/12 [00:00<00:00, 13.24it/s] 58%|█████▊    | 7/12 [00:00<00:00, 13.35it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.51it/s] 92%|█████████▏| 11/12 [00:00<00:00, 14.91it/s]100%|██████████| 12/12 [00:02<00:00,  4.43it/s]
2025-03-13 18:38:27,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:27
2025-03-13 18:39:00,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5342 secs
2025-03-13 18:39:00,334 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:39:00,334 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 18:39:20,521 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1872 secs
2025-03-13 18:39:20,524 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4397 secs
2025-03-13 18:39:20,524 [INFO]: {
2025-03-13 18:39:20,524 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:20,524 [INFO]: 	index_param: efSearch=256
2025-03-13 18:39:20,524 [INFO]: 	index_path: knn.index
2025-03-13 18:39:20,524 [INFO]: 	size in bytes: 589641190
2025-03-13 18:39:20,524 [INFO]: 	avg_search_speed_ms: 11.479442849077378
2025-03-13 18:39:20,524 [INFO]: 	99p_search_speed_ms: 16.01516823284328
2025-03-13 18:39:20,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:20,524 [INFO]: 	nb vectors: 2997
2025-03-13 18:39:20,524 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:20,524 [INFO]: 	compression ratio: 0.999309725970806
2025-03-13 18:39:20,525 [INFO]: }
2025-03-13 18:39:20,525 [INFO]: 	>>> Finished "Creating the index" in 55.4412 secs
2025-03-13 18:39:20,525 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4658 secs
2025-03-13 18:39:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 41145 [episode count 10/20]
[retrieval_preprocessing] for episode 63763 [episode count 11/20], we have num_retrieval=np.int64(3049) num_query=np.int64(130)
2025-03-13 18:39:25,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:25,965 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:25
2025-03-13 18:39:25,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1729.61it/s]
2025-03-13 18:39:25,989 [INFO]: There are 3049 embeddings of dim 49152
2025-03-13 18:39:25,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:39:25,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:25
2025-03-13 18:39:25,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:25,990 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:39:25,990 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:25,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:39:25,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:25
2025-03-13 18:39:25,990 [INFO]: 629.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:25,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:39:25,990 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:25
2025-03-13 18:39:25,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:25,990 [INFO]: 	Creating the index 03/13/2025, 18:39:25
2025-03-13 18:39:25,990 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:25
2025-03-13 18:39:25,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:39:25,991 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:25
2025-03-13 18:39:25,991 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:39:25,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.08it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.41it/s] 31%|███       | 4/13 [00:00<00:01,  8.67it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.92it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.67it/s] 77%|███████▋  | 10/13 [00:01<00:00, 11.14it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.54it/s]100%|██████████| 13/13 [00:03<00:00,  3.79it/s]
2025-03-13 18:39:29,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:29
2025-03-13 18:40:03,950 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5260 secs
2025-03-13 18:40:03,950 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:40:03,950 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 18:40:27,045 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0947 secs
2025-03-13 18:40:27,047 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0561 secs
2025-03-13 18:40:27,048 [INFO]: {
2025-03-13 18:40:27,048 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:27,048 [INFO]: 	index_param: efSearch=271
2025-03-13 18:40:27,048 [INFO]: 	index_path: knn.index
2025-03-13 18:40:27,048 [INFO]: 	size in bytes: 599871730
2025-03-13 18:40:27,048 [INFO]: 	avg_search_speed_ms: 10.666379935668111
2025-03-13 18:40:27,048 [INFO]: 	99p_search_speed_ms: 13.960949196480215
2025-03-13 18:40:27,048 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:27,048 [INFO]: 	nb vectors: 3049
2025-03-13 18:40:27,048 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:27,048 [INFO]: 	compression ratio: 0.999309955813387
2025-03-13 18:40:27,048 [INFO]: }
2025-03-13 18:40:27,048 [INFO]: 	>>> Finished "Creating the index" in 61.0575 secs
2025-03-13 18:40:27,048 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0827 secs
2025-03-13 18:40:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 63763 [episode count 11/20]
[retrieval_preprocessing] for episode 35095 [episode count 12/20], we have num_retrieval=np.int64(3043) num_query=np.int64(136)
2025-03-13 18:40:29,435 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:29,943 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:29
2025-03-13 18:40:29,943 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2035.08it/s]
2025-03-13 18:40:29,971 [INFO]: There are 3043 embeddings of dim 49152
2025-03-13 18:40:29,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 18:40:29,972 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:29
2025-03-13 18:40:29,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:29,973 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:40:29,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:29,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:40:29,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:29
2025-03-13 18:40:29,973 [INFO]: 628.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:29,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:40:29,974 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:29
2025-03-13 18:40:29,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:29,974 [INFO]: 	Creating the index 03/13/2025, 18:40:29
2025-03-13 18:40:29,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:29
2025-03-13 18:40:29,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:40:29,977 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:29
2025-03-13 18:40:29,978 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:40:29,978 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.06it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.70it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.14it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.69it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.88it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.84it/s]100%|██████████| 12/12 [00:03<00:00,  3.67it/s]
2025-03-13 18:40:33,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:33
2025-03-13 18:41:08,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6339 secs
2025-03-13 18:41:08,897 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:41:08,897 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 18:41:36,841 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9437 secs
2025-03-13 18:41:36,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8665 secs
2025-03-13 18:41:36,844 [INFO]: {
2025-03-13 18:41:36,844 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:36,844 [INFO]: 	index_param: efSearch=256
2025-03-13 18:41:36,844 [INFO]: 	index_path: knn.index
2025-03-13 18:41:36,844 [INFO]: 	size in bytes: 598691290
2025-03-13 18:41:36,844 [INFO]: 	avg_search_speed_ms: 10.55390313036842
2025-03-13 18:41:36,844 [INFO]: 	99p_search_speed_ms: 19.80333723360671
2025-03-13 18:41:36,844 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:36,844 [INFO]: 	nb vectors: 3043
2025-03-13 18:41:36,844 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:36,844 [INFO]: 	compression ratio: 0.999309918138278
2025-03-13 18:41:36,844 [INFO]: }
2025-03-13 18:41:36,844 [INFO]: 	>>> Finished "Creating the index" in 66.8705 secs
2025-03-13 18:41:36,844 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9015 secs
2025-03-13 18:41:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 35095 [episode count 12/20]
[retrieval_preprocessing] for episode 6438 [episode count 13/20], we have num_retrieval=np.int64(3063) num_query=np.int64(116)
2025-03-13 18:41:39,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:40,687 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:40
2025-03-13 18:41:40,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.29it/s]
2025-03-13 18:41:40,717 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 18:41:40,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:41:40,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:40
2025-03-13 18:41:40,717 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:40,717 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:41:40,717 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:40,717 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:40,717 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:40
2025-03-13 18:41:40,717 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:40,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:40,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:40
2025-03-13 18:41:40,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:40,717 [INFO]: 	Creating the index 03/13/2025, 18:41:40
2025-03-13 18:41:40,718 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:40
2025-03-13 18:41:40,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:41:40,719 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:40
2025-03-13 18:41:40,719 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:41:40,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.60it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.94it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.62it/s] 31%|███       | 4/13 [00:00<00:01,  6.95it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.15it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.32it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.74it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.31it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.76it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.59it/s]100%|██████████| 13/13 [00:03<00:00,  1.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.56it/s]
2025-03-13 18:41:44,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:44
2025-03-13 18:42:15,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2986 secs
2025-03-13 18:42:15,677 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:42:15,677 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.79it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 18:42:37,386 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7091 secs
2025-03-13 18:42:37,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6700 secs
2025-03-13 18:42:37,389 [INFO]: {
2025-03-13 18:42:37,389 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:37,389 [INFO]: 	index_param: efSearch=256
2025-03-13 18:42:37,389 [INFO]: 	index_path: knn.index
2025-03-13 18:42:37,389 [INFO]: 	size in bytes: 602626270
2025-03-13 18:42:37,389 [INFO]: 	avg_search_speed_ms: 12.142823427831935
2025-03-13 18:42:37,389 [INFO]: 	99p_search_speed_ms: 17.04869978595525
2025-03-13 18:42:37,389 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:37,389 [INFO]: 	nb vectors: 3063
2025-03-13 18:42:37,389 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:37,389 [INFO]: 	compression ratio: 0.9993097446614798
2025-03-13 18:42:37,389 [INFO]: }
2025-03-13 18:42:37,389 [INFO]: 	>>> Finished "Creating the index" in 56.6718 secs
2025-03-13 18:42:37,389 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7023 secs
2025-03-13 18:42:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 6438 [episode count 13/20]
[retrieval_preprocessing] for episode 12605 [episode count 14/20], we have num_retrieval=np.int64(3024) num_query=np.int64(155)
2025-03-13 18:42:39,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:40,230 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:40
2025-03-13 18:42:40,230 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.07it/s]
2025-03-13 18:42:40,256 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 18:42:40,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:42:40,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:40,257 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:42:40,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:40,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:42:40,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,258 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:40,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:42:40,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:40
2025-03-13 18:42:40,258 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:40,259 [INFO]: 	Creating the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:40
2025-03-13 18:42:40,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:42:40,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:40
2025-03-13 18:42:40,262 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:42:40,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.56it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.75it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.66it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.05it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.06it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.84it/s]100%|██████████| 12/12 [00:03<00:00,  3.34it/s]
2025-03-13 18:42:43,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:43
2025-03-13 18:43:22,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1877 secs
2025-03-13 18:43:22,053 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:43:22,053 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 18:43:49,207 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1538 secs
2025-03-13 18:43:49,210 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9475 secs
2025-03-13 18:43:49,210 [INFO]: {
2025-03-13 18:43:49,210 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:49,210 [INFO]: 	index_param: efSearch=261
2025-03-13 18:43:49,210 [INFO]: 	index_path: knn.index
2025-03-13 18:43:49,210 [INFO]: 	size in bytes: 594953170
2025-03-13 18:43:49,210 [INFO]: 	avg_search_speed_ms: 11.982193702698021
2025-03-13 18:43:49,210 [INFO]: 	99p_search_speed_ms: 18.912008996121585
2025-03-13 18:43:49,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:49,210 [INFO]: 	nb vectors: 3024
2025-03-13 18:43:49,210 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:49,210 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 18:43:49,210 [INFO]: }
2025-03-13 18:43:49,210 [INFO]: 	>>> Finished "Creating the index" in 68.9514 secs
2025-03-13 18:43:49,210 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9804 secs
2025-03-13 18:43:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 12605 [episode count 14/20]
[retrieval_preprocessing] for episode 41308 [episode count 15/20], we have num_retrieval=np.int64(3072) num_query=np.int64(107)
2025-03-13 18:43:51,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:52,290 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:52
2025-03-13 18:43:52,290 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 18:43:52,315 [INFO]: There are 3072 embeddings of dim 49152
2025-03-13 18:43:52,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:43:52,316 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:52
2025-03-13 18:43:52,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:52,316 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:43:52,316 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:52,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:52,316 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:52
2025-03-13 18:43:52,316 [INFO]: 634.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:52,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:52,316 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:52
2025-03-13 18:43:52,316 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:52,316 [INFO]: 	Creating the index 03/13/2025, 18:43:52
2025-03-13 18:43:52,316 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:52
2025-03-13 18:43:52,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:43:52,317 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:52
2025-03-13 18:43:52,317 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:43:52,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.20it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.55it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.39it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.68it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.67it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.33it/s]100%|██████████| 13/13 [00:03<00:00,  2.20it/s]100%|██████████| 13/13 [00:03<00:00,  3.80it/s]
2025-03-13 18:43:55,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:55
2025-03-13 18:44:26,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0988 secs
2025-03-13 18:44:26,843 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 18:44:26,843 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-13 18:44:52,337 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4945 secs
2025-03-13 18:44:52,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0219 secs
2025-03-13 18:44:52,339 [INFO]: {
2025-03-13 18:44:52,339 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:52,339 [INFO]: 	index_param: efSearch=261
2025-03-13 18:44:52,339 [INFO]: 	index_path: knn.index
2025-03-13 18:44:52,339 [INFO]: 	size in bytes: 604396930
2025-03-13 18:44:52,339 [INFO]: 	avg_search_speed_ms: 9.863452238253
2025-03-13 18:44:52,339 [INFO]: 	99p_search_speed_ms: 13.226098604500294
2025-03-13 18:44:52,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:52,339 [INFO]: 	nb vectors: 3072
2025-03-13 18:44:52,340 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:52,340 [INFO]: 	compression ratio: 0.9993098012592486
2025-03-13 18:44:52,340 [INFO]: }
2025-03-13 18:44:52,340 [INFO]: 	>>> Finished "Creating the index" in 60.0234 secs
2025-03-13 18:44:52,340 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0492 secs
2025-03-13 18:44:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 41308 [episode count 15/20]
[retrieval_preprocessing] for episode 41316 [episode count 16/20], we have num_retrieval=np.int64(3053) num_query=np.int64(126)
2025-03-13 18:44:54,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:55,293 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:55
2025-03-13 18:44:55,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.04it/s]
2025-03-13 18:44:55,318 [INFO]: There are 3053 embeddings of dim 49152
2025-03-13 18:44:55,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:44:55,318 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:55
2025-03-13 18:44:55,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:55,318 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:44:55,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:55,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:44:55,318 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:55
2025-03-13 18:44:55,318 [INFO]: 630.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:55,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:44:55,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:55
2025-03-13 18:44:55,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:55,318 [INFO]: 	Creating the index 03/13/2025, 18:44:55
2025-03-13 18:44:55,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:55
2025-03-13 18:44:55,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:44:55,320 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:55
2025-03-13 18:44:55,320 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:44:55,320 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.02it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.56it/s] 38%|███▊      | 5/13 [00:00<00:00, 12.82it/s] 54%|█████▍    | 7/13 [00:00<00:00, 13.15it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.84it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.68it/s]100%|██████████| 13/13 [00:02<00:00,  2.55it/s]100%|██████████| 13/13 [00:02<00:00,  4.43it/s]
2025-03-13 18:44:58,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:58
2025-03-13 18:45:32,024 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7630 secs
2025-03-13 18:45:32,025 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:45:32,025 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.67it/s]
2025-03-13 18:45:49,721 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6963 secs
2025-03-13 18:45:49,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4041 secs
2025-03-13 18:45:49,724 [INFO]: {
2025-03-13 18:45:49,724 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:49,724 [INFO]: 	index_param: efSearch=182
2025-03-13 18:45:49,724 [INFO]: 	index_path: knn.index
2025-03-13 18:45:49,724 [INFO]: 	size in bytes: 600658690
2025-03-13 18:45:49,724 [INFO]: 	avg_search_speed_ms: 10.178633848781246
2025-03-13 18:45:49,724 [INFO]: 	99p_search_speed_ms: 14.165823017247018
2025-03-13 18:45:49,724 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:49,724 [INFO]: 	nb vectors: 3053
2025-03-13 18:45:49,724 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:49,724 [INFO]: 	compression ratio: 0.9993099808478588
2025-03-13 18:45:49,724 [INFO]: }
2025-03-13 18:45:49,724 [INFO]: 	>>> Finished "Creating the index" in 54.4059 secs
2025-03-13 18:45:49,724 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4316 secs
2025-03-13 18:45:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 41316 [episode count 16/20]
[retrieval_preprocessing] for episode 88423 [episode count 17/20], we have num_retrieval=np.int64(3040) num_query=np.int64(139)
2025-03-13 18:45:51,132 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:51,571 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:51
2025-03-13 18:45:51,571 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.81it/s]
2025-03-13 18:45:51,602 [INFO]: There are 3040 embeddings of dim 49152
2025-03-13 18:45:51,603 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 18:45:51,603 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:51,603 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:45:51,603 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:51,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:51,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,603 [INFO]: 627.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:51,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:45:51,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:51
2025-03-13 18:45:51,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:51,603 [INFO]: 	Creating the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:51
2025-03-13 18:45:51,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:45:51,605 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:51
2025-03-13 18:45:51,605 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:45:51,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.09it/s] 50%|█████     | 6/12 [00:00<00:00, 31.37it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.13it/s]
2025-03-13 18:45:54,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:54
2025-03-13 18:46:28,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4615 secs
2025-03-13 18:46:28,974 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 18:46:28,975 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 18:46:56,477 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5025 secs
2025-03-13 18:46:56,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8745 secs
2025-03-13 18:46:56,479 [INFO]: {
2025-03-13 18:46:56,479 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:56,479 [INFO]: 	index_param: efSearch=215
2025-03-13 18:46:56,480 [INFO]: 	index_path: knn.index
2025-03-13 18:46:56,480 [INFO]: 	size in bytes: 598101070
2025-03-13 18:46:56,480 [INFO]: 	avg_search_speed_ms: 10.045315839357704
2025-03-13 18:46:56,480 [INFO]: 	99p_search_speed_ms: 14.568332058843213
2025-03-13 18:46:56,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:56,480 [INFO]: 	nb vectors: 3040
2025-03-13 18:46:56,480 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:56,480 [INFO]: 	compression ratio: 0.9993098992449554
2025-03-13 18:46:56,480 [INFO]: }
2025-03-13 18:46:56,480 [INFO]: 	>>> Finished "Creating the index" in 64.8763 secs
2025-03-13 18:46:56,480 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9085 secs
2025-03-13 18:46:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 88423 [episode count 17/20]
[retrieval_preprocessing] for episode 74089 [episode count 18/20], we have num_retrieval=np.int64(3044) num_query=np.int64(135)
2025-03-13 18:46:57,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:58,126 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:58
2025-03-13 18:46:58,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1090.56it/s]
2025-03-13 18:46:58,160 [INFO]: There are 3044 embeddings of dim 49152
2025-03-13 18:46:58,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 18:46:58,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:58,161 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:46:58,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:58,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:46:58,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,162 [INFO]: 628.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:58,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:46:58,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:58
2025-03-13 18:46:58,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:46:58,163 [INFO]: 	Creating the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:58
2025-03-13 18:46:58,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:46:58,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:58
2025-03-13 18:46:58,167 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:46:58,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.45it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.09it/s]100%|██████████| 12/12 [00:02<00:00,  5.41it/s]
2025-03-13 18:47:00,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:00
2025-03-13 18:47:36,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7186 secs
2025-03-13 18:47:36,113 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 18:47:36,113 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.03it/s]
2025-03-13 18:47:57,523 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4104 secs
2025-03-13 18:47:57,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3582 secs
2025-03-13 18:47:57,525 [INFO]: {
2025-03-13 18:47:57,525 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:57,525 [INFO]: 	index_param: efSearch=255
2025-03-13 18:47:57,525 [INFO]: 	index_path: knn.index
2025-03-13 18:47:57,525 [INFO]: 	size in bytes: 598888030
2025-03-13 18:47:57,525 [INFO]: 	avg_search_speed_ms: 12.108555182275648
2025-03-13 18:47:57,526 [INFO]: 	99p_search_speed_ms: 22.33161829644814
2025-03-13 18:47:57,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:57,526 [INFO]: 	nb vectors: 3044
2025-03-13 18:47:57,526 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:57,526 [INFO]: 	compression ratio: 0.9993099244277766
2025-03-13 18:47:57,526 [INFO]: }
2025-03-13 18:47:57,526 [INFO]: 	>>> Finished "Creating the index" in 59.3625 secs
2025-03-13 18:47:57,526 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3993 secs
2025-03-13 18:47:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 74089 [episode count 18/20]
[retrieval_preprocessing] for episode 45433 [episode count 19/20], we have num_retrieval=np.int64(3008) num_query=np.int64(171)
2025-03-13 18:47:59,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:59,997 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:59
2025-03-13 18:47:59,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.68it/s]
2025-03-13 18:48:00,031 [INFO]: There are 3008 embeddings of dim 49152
2025-03-13 18:48:00,031 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 18:48:00,031 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:00
2025-03-13 18:48:00,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:00,032 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:48:00,032 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:00,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:48:00,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:00
2025-03-13 18:48:00,033 [INFO]: 620.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:00,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:48:00,033 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:00
2025-03-13 18:48:00,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:00,034 [INFO]: 	Creating the index 03/13/2025, 18:48:00
2025-03-13 18:48:00,034 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:00
2025-03-13 18:48:00,036 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:48:00,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:00
2025-03-13 18:48:00,037 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:48:00,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.34it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.50it/s] 75%|███████▌  | 9/12 [00:00<00:00, 30.77it/s]100%|██████████| 12/12 [00:03<00:00,  3.77it/s]
2025-03-13 18:48:03,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:03
2025-03-13 18:48:35,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8794 secs
2025-03-13 18:48:35,110 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 18:48:35,110 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 18:48:58,892 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7821 secs
2025-03-13 18:48:58,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8568 secs
2025-03-13 18:48:58,894 [INFO]: {
2025-03-13 18:48:58,894 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:58,894 [INFO]: 	index_param: efSearch=199
2025-03-13 18:48:58,894 [INFO]: 	index_path: knn.index
2025-03-13 18:48:58,894 [INFO]: 	size in bytes: 591805330
2025-03-13 18:48:58,894 [INFO]: 	avg_search_speed_ms: 9.333515971544575
2025-03-13 18:48:58,894 [INFO]: 	99p_search_speed_ms: 13.930156708229331
2025-03-13 18:48:58,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:58,894 [INFO]: 	nb vectors: 3008
2025-03-13 18:48:58,894 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:58,894 [INFO]: 	compression ratio: 0.9993097966860149
2025-03-13 18:48:58,894 [INFO]: }
2025-03-13 18:48:58,894 [INFO]: 	>>> Finished "Creating the index" in 58.8604 secs
2025-03-13 18:48:58,894 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8971 secs
2025-03-13 18:48:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 45433 [episode count 19/20]
2025-03-13 18:49:00: [retrieval_preprocessing] finished for 8376714657_put_marker_in_bowl [chosen_id count 7/196]
2025-03-13 18:49:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_remove_marker_from_bowl_and_put_on_table [chosen_id count 8/196]
2025-03-13 18:49:01: [retrieval_preprocessing] we have num_total=3609 embedding_dim=49152
[retrieval_preprocessing] for episode 57344 [episode count 0/20], we have num_retrieval=np.int64(3481) num_query=np.int64(128)
2025-03-13 18:49:01,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:02,265 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:02
2025-03-13 18:49:02,265 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 18:49:02,295 [INFO]: There are 3481 embeddings of dim 49152
2025-03-13 18:49:02,296 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 18:49:02,296 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:02
2025-03-13 18:49:02,296 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:02,296 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:49:02,296 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:02,296 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:49:02,296 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:02
2025-03-13 18:49:02,296 [INFO]: 718.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:02,296 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:49:02,296 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:02
2025-03-13 18:49:02,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:02,296 [INFO]: 	Creating the index 03/13/2025, 18:49:02
2025-03-13 18:49:02,296 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:02
2025-03-13 18:49:02,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:49:02,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:02
2025-03-13 18:49:02,297 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:49:02,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.72it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.91it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.24it/s]100%|██████████| 14/14 [00:02<00:00,  4.80it/s]
2025-03-13 18:49:05,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:05
2025-03-13 18:49:42,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0208 secs
2025-03-13 18:49:42,237 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 18:49:42,238 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 18:50:06,174 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9365 secs
2025-03-13 18:50:06,177 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8797 secs
2025-03-13 18:50:06,177 [INFO]: {
2025-03-13 18:50:06,178 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:06,178 [INFO]: 	index_param: efSearch=304
2025-03-13 18:50:06,178 [INFO]: 	index_path: knn.index
2025-03-13 18:50:06,178 [INFO]: 	size in bytes: 684865390
2025-03-13 18:50:06,178 [INFO]: 	avg_search_speed_ms: 14.25912035058685
2025-03-13 18:50:06,178 [INFO]: 	99p_search_speed_ms: 18.58163604978472
2025-03-13 18:50:06,178 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:06,178 [INFO]: 	nb vectors: 3481
2025-03-13 18:50:06,178 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:06,178 [INFO]: 	compression ratio: 0.9993094380196377
2025-03-13 18:50:06,178 [INFO]: }
2025-03-13 18:50:06,178 [INFO]: 	>>> Finished "Creating the index" in 63.8814 secs
2025-03-13 18:50:06,178 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9125 secs
2025-03-13 18:50:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 57344 [episode count 0/20]
[retrieval_preprocessing] for episode 83973 [episode count 1/20], we have num_retrieval=np.int64(3388) num_query=np.int64(221)
2025-03-13 18:50:09,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:10,605 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:10
2025-03-13 18:50:10,605 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 957.39it/s]
2025-03-13 18:50:10,636 [INFO]: There are 3388 embeddings of dim 49152
2025-03-13 18:50:10,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 18:50:10,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:10
2025-03-13 18:50:10,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:10,637 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:50:10,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:10,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:10,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:10
2025-03-13 18:50:10,637 [INFO]: 699.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:10,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:10,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:10
2025-03-13 18:50:10,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:10,637 [INFO]: 	Creating the index 03/13/2025, 18:50:10
2025-03-13 18:50:10,637 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:10
2025-03-13 18:50:10,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:50:10,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:10
2025-03-13 18:50:10,639 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:50:10,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.61it/s] 50%|█████     | 7/14 [00:00<00:00, 35.32it/s] 93%|█████████▎| 13/14 [00:00<00:00, 42.59it/s]100%|██████████| 14/14 [00:02<00:00,  5.46it/s]
2025-03-13 18:50:13,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:13
2025-03-13 18:50:49,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8100 secs
2025-03-13 18:50:49,018 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:50:49,019 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s]
2025-03-13 18:51:09,420 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4012 secs
2025-03-13 18:51:09,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0280 secs
2025-03-13 18:51:09,667 [INFO]: {
2025-03-13 18:51:09,667 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:09,667 [INFO]: 	index_param: efSearch=240
2025-03-13 18:51:09,667 [INFO]: 	index_path: knn.index
2025-03-13 18:51:09,667 [INFO]: 	size in bytes: 666568270
2025-03-13 18:51:09,667 [INFO]: 	avg_search_speed_ms: 10.06420218302368
2025-03-13 18:51:09,667 [INFO]: 	99p_search_speed_ms: 17.011922956444312
2025-03-13 18:51:09,668 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:09,668 [INFO]: 	nb vectors: 3388
2025-03-13 18:51:09,668 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:09,668 [INFO]: 	compression ratio: 0.999309349063375
2025-03-13 18:51:09,668 [INFO]: }
2025-03-13 18:51:09,668 [INFO]: 	>>> Finished "Creating the index" in 59.0306 secs
2025-03-13 18:51:09,668 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0624 secs
2025-03-13 18:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 83973 [episode count 1/20]
[retrieval_preprocessing] for episode 34863 [episode count 2/20], we have num_retrieval=np.int64(3410) num_query=np.int64(199)
2025-03-13 18:51:12,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:13,489 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:13
2025-03-13 18:51:13,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1287.39it/s]
2025-03-13 18:51:13,528 [INFO]: There are 3410 embeddings of dim 49152
2025-03-13 18:51:13,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 18:51:13,528 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:13,528 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:51:13,528 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:13,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:51:13,528 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,528 [INFO]: 703.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:13,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:51:13,529 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:13
2025-03-13 18:51:13,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:13,529 [INFO]: 	Creating the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,529 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:13
2025-03-13 18:51:13,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:51:13,530 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:13
2025-03-13 18:51:13,530 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:51:13,530 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.82it/s] 36%|███▌      | 5/14 [00:00<00:00, 27.41it/s] 71%|███████▏  | 10/14 [00:00<00:00, 34.48it/s]100%|██████████| 14/14 [00:02<00:00,  3.73it/s]100%|██████████| 14/14 [00:02<00:00,  5.03it/s]
2025-03-13 18:51:16,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:16
2025-03-13 18:51:51,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9195 secs
2025-03-13 18:51:51,239 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 18:51:51,239 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 18:52:14,945 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7059 secs
2025-03-13 18:52:14,947 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4167 secs
2025-03-13 18:52:14,947 [INFO]: {
2025-03-13 18:52:14,947 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:14,947 [INFO]: 	index_param: efSearch=278
2025-03-13 18:52:14,947 [INFO]: 	index_path: knn.index
2025-03-13 18:52:14,947 [INFO]: 	size in bytes: 670896670
2025-03-13 18:52:14,947 [INFO]: 	avg_search_speed_ms: 12.01317989209271
2025-03-13 18:52:14,947 [INFO]: 	99p_search_speed_ms: 16.569412481039762
2025-03-13 18:52:14,947 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:14,947 [INFO]: 	nb vectors: 3410
2025-03-13 18:52:14,947 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:14,947 [INFO]: 	compression ratio: 0.9993092975107478
2025-03-13 18:52:14,947 [INFO]: }
2025-03-13 18:52:14,947 [INFO]: 	>>> Finished "Creating the index" in 61.4184 secs
2025-03-13 18:52:14,947 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4578 secs
2025-03-13 18:52:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 34863 [episode count 2/20]
[retrieval_preprocessing] for episode 69682 [episode count 3/20], we have num_retrieval=np.int64(3423) num_query=np.int64(186)
2025-03-13 18:52:17,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:18,405 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:18
2025-03-13 18:52:18,405 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1763.05it/s]
2025-03-13 18:52:18,431 [INFO]: There are 3423 embeddings of dim 49152
2025-03-13 18:52:18,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:52:18,431 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:18
2025-03-13 18:52:18,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:18,431 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:52:18,431 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:18,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:18,431 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:18
2025-03-13 18:52:18,431 [INFO]: 706.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:18,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:52:18,431 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:18
2025-03-13 18:52:18,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:18,432 [INFO]: 	Creating the index 03/13/2025, 18:52:18
2025-03-13 18:52:18,432 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:18
2025-03-13 18:52:18,433 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:52:18,433 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:18
2025-03-13 18:52:18,433 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:52:18,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.01it/s] 36%|███▌      | 5/14 [00:00<00:00, 22.78it/s] 71%|███████▏  | 10/14 [00:00<00:00, 32.83it/s]100%|██████████| 14/14 [00:03<00:00,  3.24it/s]100%|██████████| 14/14 [00:03<00:00,  4.37it/s]
2025-03-13 18:52:21,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:21
2025-03-13 18:52:54,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2519 secs
2025-03-13 18:52:54,893 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:52:54,893 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.79it/s]
2025-03-13 18:53:12,113 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2200 secs
2025-03-13 18:53:12,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6828 secs
2025-03-13 18:53:12,116 [INFO]: {
2025-03-13 18:53:12,116 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:12,116 [INFO]: 	index_param: efSearch=196
2025-03-13 18:53:12,116 [INFO]: 	index_path: knn.index
2025-03-13 18:53:12,116 [INFO]: 	size in bytes: 673454290
2025-03-13 18:53:12,116 [INFO]: 	avg_search_speed_ms: 9.378055241404496
2025-03-13 18:53:12,116 [INFO]: 	99p_search_speed_ms: 13.130717899184674
2025-03-13 18:53:12,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:12,116 [INFO]: 	nb vectors: 3423
2025-03-13 18:53:12,116 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:12,116 [INFO]: 	compression ratio: 0.9993093725782042
2025-03-13 18:53:12,116 [INFO]: }
2025-03-13 18:53:12,116 [INFO]: 	>>> Finished "Creating the index" in 53.6843 secs
2025-03-13 18:53:12,116 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7107 secs
2025-03-13 18:53:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 69682 [episode count 3/20]
[retrieval_preprocessing] for episode 79905 [episode count 4/20], we have num_retrieval=np.int64(3447) num_query=np.int64(162)
2025-03-13 18:53:13,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:13,945 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:13
2025-03-13 18:53:13,945 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1419.39it/s]
2025-03-13 18:53:13,974 [INFO]: There are 3447 embeddings of dim 49152
2025-03-13 18:53:13,974 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:53:13,974 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:13
2025-03-13 18:53:13,974 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:13,974 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:53:13,974 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:13,974 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:53:13,974 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:13
2025-03-13 18:53:13,974 [INFO]: 711.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:13,974 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:53:13,974 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:13
2025-03-13 18:53:13,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:13,974 [INFO]: 	Creating the index 03/13/2025, 18:53:13
2025-03-13 18:53:13,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:13
2025-03-13 18:53:13,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:53:13,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:13
2025-03-13 18:53:13,975 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:53:13,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.89it/s] 50%|█████     | 7/14 [00:00<00:00, 36.26it/s] 93%|█████████▎| 13/14 [00:00<00:00, 44.33it/s]100%|██████████| 14/14 [00:02<00:00,  5.69it/s]
2025-03-13 18:53:16,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:16
2025-03-13 18:53:50,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7623 secs
2025-03-13 18:53:50,201 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 18:53:50,201 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 18:54:12,656 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4555 secs
2025-03-13 18:54:13,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0484 secs
2025-03-13 18:54:13,024 [INFO]: {
2025-03-13 18:54:13,024 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:13,024 [INFO]: 	index_param: efSearch=277
2025-03-13 18:54:13,024 [INFO]: 	index_path: knn.index
2025-03-13 18:54:13,025 [INFO]: 	size in bytes: 678176170
2025-03-13 18:54:13,025 [INFO]: 	avg_search_speed_ms: 10.704723460753339
2025-03-13 18:54:13,025 [INFO]: 	99p_search_speed_ms: 14.114016399253158
2025-03-13 18:54:13,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:13,025 [INFO]: 	nb vectors: 3447
2025-03-13 18:54:13,025 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:13,025 [INFO]: 	compression ratio: 0.9993093328537332
2025-03-13 18:54:13,025 [INFO]: }
2025-03-13 18:54:13,025 [INFO]: 	>>> Finished "Creating the index" in 59.0507 secs
2025-03-13 18:54:13,025 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0798 secs
2025-03-13 18:54:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 79905 [episode count 4/20]
[retrieval_preprocessing] for episode 36955 [episode count 5/20], we have num_retrieval=np.int64(3438) num_query=np.int64(171)
2025-03-13 18:54:14,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:15,247 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:15
2025-03-13 18:54:15,247 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.15it/s]
2025-03-13 18:54:15,271 [INFO]: There are 3438 embeddings of dim 49152
2025-03-13 18:54:15,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:54:15,271 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:15,272 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:54:15,272 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:15,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:15,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,272 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:15,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:54:15,272 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:15
2025-03-13 18:54:15,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:15,272 [INFO]: 	Creating the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:15
2025-03-13 18:54:15,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:54:15,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:15
2025-03-13 18:54:15,273 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:54:15,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.92it/s] 50%|█████     | 7/14 [00:00<00:00, 38.07it/s] 93%|█████████▎| 13/14 [00:00<00:00, 46.11it/s]100%|██████████| 14/14 [00:02<00:00,  5.47it/s]
2025-03-13 18:54:17,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:17
2025-03-13 18:54:50,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7141 secs
2025-03-13 18:54:50,553 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 18:54:50,553 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 18:55:13,055 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5022 secs
2025-03-13 18:55:13,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7841 secs
2025-03-13 18:55:13,057 [INFO]: {
2025-03-13 18:55:13,058 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:13,058 [INFO]: 	index_param: efSearch=273
2025-03-13 18:55:13,058 [INFO]: 	index_path: knn.index
2025-03-13 18:55:13,058 [INFO]: 	size in bytes: 676405450
2025-03-13 18:55:13,058 [INFO]: 	avg_search_speed_ms: 10.920390391399001
2025-03-13 18:55:13,058 [INFO]: 	99p_search_speed_ms: 13.867066975217313
2025-03-13 18:55:13,058 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:13,058 [INFO]: 	nb vectors: 3438
2025-03-13 18:55:13,058 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:13,058 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-13 18:55:13,058 [INFO]: }
2025-03-13 18:55:13,058 [INFO]: 	>>> Finished "Creating the index" in 57.7858 secs
2025-03-13 18:55:13,058 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8107 secs
2025-03-13 18:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 36955 [episode count 5/20]
[retrieval_preprocessing] for episode 73818 [episode count 6/20], we have num_retrieval=np.int64(3413) num_query=np.int64(196)
2025-03-13 18:55:15,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:15,657 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:15
2025-03-13 18:55:15,657 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1286.60it/s]
2025-03-13 18:55:15,687 [INFO]: There are 3413 embeddings of dim 49152
2025-03-13 18:55:15,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 18:55:15,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:15
2025-03-13 18:55:15,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:15,688 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:55:15,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:15,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:15,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:15
2025-03-13 18:55:15,688 [INFO]: 704.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:15,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:55:15,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:15
2025-03-13 18:55:15,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:15,688 [INFO]: 	Creating the index 03/13/2025, 18:55:15
2025-03-13 18:55:15,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:15
2025-03-13 18:55:15,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:55:15,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:15
2025-03-13 18:55:15,690 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:55:15,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.36it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.64it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.35it/s]100%|██████████| 14/14 [00:02<00:00,  5.47it/s]
2025-03-13 18:55:18,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:18
2025-03-13 18:55:50,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9333 secs
2025-03-13 18:55:50,189 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 18:55:50,189 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 18:56:09,232 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0434 secs
2025-03-13 18:56:09,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5446 secs
2025-03-13 18:56:09,234 [INFO]: {
2025-03-13 18:56:09,234 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:09,234 [INFO]: 	index_param: efSearch=249
2025-03-13 18:56:09,234 [INFO]: 	index_path: knn.index
2025-03-13 18:56:09,234 [INFO]: 	size in bytes: 671486890
2025-03-13 18:56:09,234 [INFO]: 	avg_search_speed_ms: 11.299183383047328
2025-03-13 18:56:09,234 [INFO]: 	99p_search_speed_ms: 16.410872694104903
2025-03-13 18:56:09,234 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:09,234 [INFO]: 	nb vectors: 3413
2025-03-13 18:56:09,234 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:09,234 [INFO]: 	compression ratio: 0.9993093148847627
2025-03-13 18:56:09,234 [INFO]: }
2025-03-13 18:56:09,234 [INFO]: 	>>> Finished "Creating the index" in 53.5461 secs
2025-03-13 18:56:09,235 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5774 secs
2025-03-13 18:56:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 73818 [episode count 6/20]
[retrieval_preprocessing] for episode 51300 [episode count 7/20], we have num_retrieval=np.int64(3422) num_query=np.int64(187)
2025-03-13 18:56:10,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:11,483 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:11
2025-03-13 18:56:11,483 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.19it/s]
2025-03-13 18:56:11,515 [INFO]: There are 3422 embeddings of dim 49152
2025-03-13 18:56:11,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 18:56:11,515 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:11
2025-03-13 18:56:11,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:11,516 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:56:11,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:11,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:56:11,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:11
2025-03-13 18:56:11,516 [INFO]: 706.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:11,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:56:11,517 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:11
2025-03-13 18:56:11,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:11,517 [INFO]: 	Creating the index 03/13/2025, 18:56:11
2025-03-13 18:56:11,517 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:11
2025-03-13 18:56:11,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 18:56:11,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:11
2025-03-13 18:56:11,520 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:56:11,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 26.00it/s] 64%|██████▍   | 9/14 [00:00<00:00, 44.62it/s]100%|██████████| 14/14 [00:02<00:00,  4.92it/s]100%|██████████| 14/14 [00:02<00:00,  6.19it/s]
2025-03-13 18:56:13,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:13
2025-03-13 18:56:44,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1162 secs
2025-03-13 18:56:44,902 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 18:56:44,902 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-13 18:57:01,150 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2476 secs
2025-03-13 18:57:01,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6330 secs
2025-03-13 18:57:01,153 [INFO]: {
2025-03-13 18:57:01,153 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:01,153 [INFO]: 	index_param: efSearch=170
2025-03-13 18:57:01,154 [INFO]: 	index_path: knn.index
2025-03-13 18:57:01,154 [INFO]: 	size in bytes: 673257550
2025-03-13 18:57:01,154 [INFO]: 	avg_search_speed_ms: 8.597070690378969
2025-03-13 18:57:01,154 [INFO]: 	99p_search_speed_ms: 13.793619209900491
2025-03-13 18:57:01,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:01,154 [INFO]: 	nb vectors: 3422
2025-03-13 18:57:01,154 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:01,154 [INFO]: 	compression ratio: 0.9993093668240334
2025-03-13 18:57:01,154 [INFO]: }
2025-03-13 18:57:01,154 [INFO]: 	>>> Finished "Creating the index" in 49.6370 secs
2025-03-13 18:57:01,154 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6705 secs
2025-03-13 18:57:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 51300 [episode count 7/20]
[retrieval_preprocessing] for episode 14449 [episode count 8/20], we have num_retrieval=np.int64(3419) num_query=np.int64(190)
2025-03-13 18:57:02,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:03,268 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:03
2025-03-13 18:57:03,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.25it/s]
2025-03-13 18:57:03,298 [INFO]: There are 3419 embeddings of dim 49152
2025-03-13 18:57:03,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:57:03,298 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:03
2025-03-13 18:57:03,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:03,298 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:57:03,298 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:03,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:57:03,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:03
2025-03-13 18:57:03,298 [INFO]: 705.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:03,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:57:03,298 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:03
2025-03-13 18:57:03,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:03,298 [INFO]: 	Creating the index 03/13/2025, 18:57:03
2025-03-13 18:57:03,298 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:03
2025-03-13 18:57:03,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:57:03,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:03
2025-03-13 18:57:03,300 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:57:03,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.89it/s] 50%|█████     | 7/14 [00:00<00:00, 34.56it/s] 93%|█████████▎| 13/14 [00:00<00:00, 42.94it/s]100%|██████████| 14/14 [00:02<00:00,  5.55it/s]
2025-03-13 18:57:05,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:05
2025-03-13 18:57:40,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1879 secs
2025-03-13 18:57:40,015 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 18:57:40,015 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.62it/s]
2025-03-13 18:57:57,588 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5721 secs
2025-03-13 18:57:57,591 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2911 secs
2025-03-13 18:57:57,591 [INFO]: {
2025-03-13 18:57:57,591 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:57,591 [INFO]: 	index_param: efSearch=260
2025-03-13 18:57:57,591 [INFO]: 	index_path: knn.index
2025-03-13 18:57:57,591 [INFO]: 	size in bytes: 672667330
2025-03-13 18:57:57,591 [INFO]: 	avg_search_speed_ms: 12.920068066750078
2025-03-13 18:57:57,591 [INFO]: 	99p_search_speed_ms: 18.840711629018184
2025-03-13 18:57:57,591 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:57,591 [INFO]: 	nb vectors: 3419
2025-03-13 18:57:57,591 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:57,591 [INFO]: 	compression ratio: 0.9993093495413253
2025-03-13 18:57:57,591 [INFO]: }
2025-03-13 18:57:57,591 [INFO]: 	>>> Finished "Creating the index" in 54.2928 secs
2025-03-13 18:57:57,591 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3231 secs
2025-03-13 18:57:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 14449 [episode count 8/20]
[retrieval_preprocessing] for episode 34938 [episode count 9/20], we have num_retrieval=np.int64(3443) num_query=np.int64(166)
2025-03-13 18:57:59,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:00,581 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:00
2025-03-13 18:58:00,581 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.26it/s]
2025-03-13 18:58:00,611 [INFO]: There are 3443 embeddings of dim 49152
2025-03-13 18:58:00,611 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:58:00,612 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:00
2025-03-13 18:58:00,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:00,612 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:58:00,612 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:00,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:58:00,612 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:00
2025-03-13 18:58:00,612 [INFO]: 710.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:00,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:58:00,613 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:00
2025-03-13 18:58:00,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:00,613 [INFO]: 	Creating the index 03/13/2025, 18:58:00
2025-03-13 18:58:00,613 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:00
2025-03-13 18:58:00,616 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:58:00,617 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:00
2025-03-13 18:58:00,617 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:58:00,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 27.26it/s] 64%|██████▍   | 9/14 [00:00<00:00, 43.85it/s]100%|██████████| 14/14 [00:02<00:00,  3.95it/s]100%|██████████| 14/14 [00:02<00:00,  5.02it/s]
2025-03-13 18:58:03,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:03
2025-03-13 18:58:38,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0352 secs
2025-03-13 18:58:38,449 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 18:58:38,449 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 18:59:04,370 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9201 secs
2025-03-13 18:59:04,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7549 secs
2025-03-13 18:59:04,372 [INFO]: {
2025-03-13 18:59:04,372 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:04,372 [INFO]: 	index_param: efSearch=233
2025-03-13 18:59:04,372 [INFO]: 	index_path: knn.index
2025-03-13 18:59:04,372 [INFO]: 	size in bytes: 677389210
2025-03-13 18:59:04,372 [INFO]: 	avg_search_speed_ms: 10.367551645495654
2025-03-13 18:59:04,372 [INFO]: 	99p_search_speed_ms: 16.106763938441873
2025-03-13 18:59:04,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:04,372 [INFO]: 	nb vectors: 3443
2025-03-13 18:59:04,372 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:04,372 [INFO]: 	compression ratio: 0.9993093099312875
2025-03-13 18:59:04,372 [INFO]: }
2025-03-13 18:59:04,372 [INFO]: 	>>> Finished "Creating the index" in 63.7585 secs
2025-03-13 18:59:04,372 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7909 secs
2025-03-13 18:59:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 34938 [episode count 9/20]
[retrieval_preprocessing] for episode 57494 [episode count 10/20], we have num_retrieval=np.int64(3416) num_query=np.int64(193)
2025-03-13 18:59:06,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:06,799 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:06
2025-03-13 18:59:06,799 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-13 18:59:06,831 [INFO]: There are 3416 embeddings of dim 49152
2025-03-13 18:59:06,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 18:59:06,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:06,832 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 18:59:06,832 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:06,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:06,832 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,832 [INFO]: 705.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:06,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:59:06,832 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:06
2025-03-13 18:59:06,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:06,832 [INFO]: 	Creating the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:06
2025-03-13 18:59:06,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:59:06,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:06
2025-03-13 18:59:06,833 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:59:06,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.06it/s] 43%|████▎     | 6/14 [00:00<00:00, 27.69it/s] 79%|███████▊  | 11/14 [00:00<00:00, 33.84it/s]100%|██████████| 14/14 [00:03<00:00,  4.07it/s]
2025-03-13 18:59:10,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:10
2025-03-13 18:59:41,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2793 secs
2025-03-13 18:59:41,553 [INFO]: The best hyperparameters are: efSearch=333
2025-03-13 18:59:41,553 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.86it/s]
2025-03-13 19:00:17,094 [INFO]: 	>>> Finished "Compute fast metrics" in 35.5403 secs
2025-03-13 19:00:17,096 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2631 secs
2025-03-13 19:00:17,096 [INFO]: {
2025-03-13 19:00:17,096 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:17,096 [INFO]: 	index_param: efSearch=333
2025-03-13 19:00:17,096 [INFO]: 	index_path: knn.index
2025-03-13 19:00:17,096 [INFO]: 	size in bytes: 672077110
2025-03-13 19:00:17,096 [INFO]: 	avg_search_speed_ms: 12.447509065268108
2025-03-13 19:00:17,096 [INFO]: 	99p_search_speed_ms: 18.911183837335564
2025-03-13 19:00:17,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:17,096 [INFO]: 	nb vectors: 3416
2025-03-13 19:00:17,096 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:17,096 [INFO]: 	compression ratio: 0.9993093322282617
2025-03-13 19:00:17,096 [INFO]: }
2025-03-13 19:00:17,096 [INFO]: 	>>> Finished "Creating the index" in 70.2645 secs
2025-03-13 19:00:17,096 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2974 secs
2025-03-13 19:00:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 57494 [episode count 10/20]
[retrieval_preprocessing] for episode 92320 [episode count 11/20], we have num_retrieval=np.int64(3409) num_query=np.int64(200)
2025-03-13 19:00:21,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:21,799 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:21
2025-03-13 19:00:21,799 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.82it/s]
2025-03-13 19:00:21,825 [INFO]: There are 3409 embeddings of dim 49152
2025-03-13 19:00:21,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 19:00:21,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:21
2025-03-13 19:00:21,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:21,826 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:00:21,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:21,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:21,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:21
2025-03-13 19:00:21,826 [INFO]: 703.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:21,826 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:21,826 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:21
2025-03-13 19:00:21,826 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:21,826 [INFO]: 	Creating the index 03/13/2025, 19:00:21
2025-03-13 19:00:21,826 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:21
2025-03-13 19:00:21,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:00:21,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:21
2025-03-13 19:00:21,827 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:00:21,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 16.25it/s] 50%|█████     | 7/14 [00:00<00:00, 31.78it/s] 86%|████████▌ | 12/14 [00:00<00:00, 37.33it/s]100%|██████████| 14/14 [00:02<00:00,  5.40it/s]
2025-03-13 19:00:24,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:24
2025-03-13 19:01:00,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9117 secs
2025-03-13 19:01:00,787 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 19:01:00,788 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-13 19:01:16,955 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1671 secs
2025-03-13 19:01:16,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1295 secs
2025-03-13 19:01:16,957 [INFO]: {
2025-03-13 19:01:16,957 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:16,957 [INFO]: 	index_param: efSearch=217
2025-03-13 19:01:16,957 [INFO]: 	index_path: knn.index
2025-03-13 19:01:16,957 [INFO]: 	size in bytes: 670699930
2025-03-13 19:01:16,957 [INFO]: 	avg_search_speed_ms: 9.565828123439752
2025-03-13 19:01:16,957 [INFO]: 	99p_search_speed_ms: 13.236549508292226
2025-03-13 19:01:16,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:16,957 [INFO]: 	nb vectors: 3409
2025-03-13 19:01:16,957 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:16,957 [INFO]: 	compression ratio: 0.9993092917126143
2025-03-13 19:01:16,957 [INFO]: }
2025-03-13 19:01:16,957 [INFO]: 	>>> Finished "Creating the index" in 55.1312 secs
2025-03-13 19:01:16,957 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1578 secs
2025-03-13 19:01:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:01:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 92320 [episode count 11/20]
[retrieval_preprocessing] for episode 18610 [episode count 12/20], we have num_retrieval=np.int64(3418) num_query=np.int64(191)
2025-03-13 19:01:18,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:19,123 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:19
2025-03-13 19:01:19,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1986.88it/s]
2025-03-13 19:01:19,151 [INFO]: There are 3418 embeddings of dim 49152
2025-03-13 19:01:19,152 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 19:01:19,152 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:19
2025-03-13 19:01:19,152 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:19,152 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:01:19,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:19,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:19,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:19
2025-03-13 19:01:19,152 [INFO]: 705.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:19,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:01:19,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:19
2025-03-13 19:01:19,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:19,152 [INFO]: 	Creating the index 03/13/2025, 19:01:19
2025-03-13 19:01:19,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:19
2025-03-13 19:01:19,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:01:19,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:19
2025-03-13 19:01:19,153 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:01:19,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.14it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.22it/s] 86%|████████▌ | 12/14 [00:00<00:00, 39.59it/s]100%|██████████| 14/14 [00:02<00:00,  5.25it/s]
2025-03-13 19:01:21,822 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:21
2025-03-13 19:01:53,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4344 secs
2025-03-13 19:01:53,258 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 19:01:53,258 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-13 19:02:23,502 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2439 secs
2025-03-13 19:02:23,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3509 secs
2025-03-13 19:02:23,504 [INFO]: {
2025-03-13 19:02:23,504 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:23,504 [INFO]: 	index_param: efSearch=270
2025-03-13 19:02:23,504 [INFO]: 	index_path: knn.index
2025-03-13 19:02:23,504 [INFO]: 	size in bytes: 672470590
2025-03-13 19:02:23,504 [INFO]: 	avg_search_speed_ms: 10.827335960673192
2025-03-13 19:02:23,504 [INFO]: 	99p_search_speed_ms: 14.951838362030685
2025-03-13 19:02:23,504 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:23,504 [INFO]: 	nb vectors: 3418
2025-03-13 19:02:23,504 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:23,504 [INFO]: 	compression ratio: 0.9993093437736809
2025-03-13 19:02:23,504 [INFO]: }
2025-03-13 19:02:23,504 [INFO]: 	>>> Finished "Creating the index" in 64.3524 secs
2025-03-13 19:02:23,504 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3813 secs
2025-03-13 19:02:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 18610 [episode count 12/20]
[retrieval_preprocessing] for episode 84147 [episode count 13/20], we have num_retrieval=np.int64(3453) num_query=np.int64(156)
2025-03-13 19:02:26,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:27,732 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:27
2025-03-13 19:02:27,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 844.60it/s]
2025-03-13 19:02:27,763 [INFO]: There are 3453 embeddings of dim 49152
2025-03-13 19:02:27,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 19:02:27,764 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:27
2025-03-13 19:02:27,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:27,764 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:02:27,765 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:27,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:02:27,765 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:27
2025-03-13 19:02:27,765 [INFO]: 712.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:27,766 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:02:27,766 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:27
2025-03-13 19:02:27,766 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:27,766 [INFO]: 	Creating the index 03/13/2025, 19:02:27
2025-03-13 19:02:27,766 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:27
2025-03-13 19:02:27,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0041 secs
2025-03-13 19:02:27,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:27
2025-03-13 19:02:27,771 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:02:27,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.22it/s] 36%|███▌      | 5/14 [00:00<00:00, 23.01it/s] 57%|█████▋    | 8/14 [00:00<00:00, 21.17it/s] 79%|███████▊  | 11/14 [00:00<00:00, 15.53it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.81it/s]100%|██████████| 14/14 [00:04<00:00,  3.43it/s]
2025-03-13 19:02:31,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:31
2025-03-13 19:03:06,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5303 secs
2025-03-13 19:03:06,387 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 19:03:06,388 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 19:03:23,723 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3349 secs
2025-03-13 19:03:24,397 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6258 secs
2025-03-13 19:03:24,397 [INFO]: {
2025-03-13 19:03:24,397 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:24,397 [INFO]: 	index_param: efSearch=229
2025-03-13 19:03:24,397 [INFO]: 	index_path: knn.index
2025-03-13 19:03:24,398 [INFO]: 	size in bytes: 679356610
2025-03-13 19:03:24,398 [INFO]: 	avg_search_speed_ms: 10.095305622185982
2025-03-13 19:03:24,398 [INFO]: 	99p_search_speed_ms: 17.050356743857265
2025-03-13 19:03:24,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:24,398 [INFO]: 	nb vectors: 3453
2025-03-13 19:03:24,398 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:24,398 [INFO]: 	compression ratio: 0.9993093671378277
2025-03-13 19:03:24,398 [INFO]: }
2025-03-13 19:03:24,398 [INFO]: 	>>> Finished "Creating the index" in 56.6317 secs
2025-03-13 19:03:24,398 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6657 secs
2025-03-13 19:03:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 84147 [episode count 13/20]
[retrieval_preprocessing] for episode 65744 [episode count 14/20], we have num_retrieval=np.int64(3410) num_query=np.int64(199)
2025-03-13 19:03:26,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:27,292 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:27
2025-03-13 19:03:27,292 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.12it/s]
2025-03-13 19:03:27,319 [INFO]: There are 3410 embeddings of dim 49152
2025-03-13 19:03:27,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 19:03:27,319 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:27
2025-03-13 19:03:27,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:27,319 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:03:27,319 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:03:27,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:03:27,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:27
2025-03-13 19:03:27,320 [INFO]: 703.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:27,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:03:27,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:27
2025-03-13 19:03:27,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:27,320 [INFO]: 	Creating the index 03/13/2025, 19:03:27
2025-03-13 19:03:27,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:03:27
2025-03-13 19:03:27,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:03:27,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:27
2025-03-13 19:03:27,321 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:03:27,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.75it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.58it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.73it/s] 50%|█████     | 7/14 [00:00<00:00, 12.34it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.58it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.73it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.87it/s]100%|██████████| 14/14 [00:03<00:00,  4.57it/s]
2025-03-13 19:03:30,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:30
2025-03-13 19:04:01,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6670 secs
2025-03-13 19:04:01,055 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 19:04:01,055 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-13 19:04:25,050 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9945 secs
2025-03-13 19:04:25,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0445 secs
2025-03-13 19:04:25,366 [INFO]: {
2025-03-13 19:04:25,366 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:25,366 [INFO]: 	index_param: efSearch=259
2025-03-13 19:04:25,366 [INFO]: 	index_path: knn.index
2025-03-13 19:04:25,366 [INFO]: 	size in bytes: 670896670
2025-03-13 19:04:25,366 [INFO]: 	avg_search_speed_ms: 10.483641502256086
2025-03-13 19:04:25,366 [INFO]: 	99p_search_speed_ms: 17.691879272460984
2025-03-13 19:04:25,366 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:25,366 [INFO]: 	nb vectors: 3410
2025-03-13 19:04:25,367 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:25,367 [INFO]: 	compression ratio: 0.9993092975107478
2025-03-13 19:04:25,367 [INFO]: }
2025-03-13 19:04:25,367 [INFO]: 	>>> Finished "Creating the index" in 58.0468 secs
2025-03-13 19:04:25,367 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0746 secs
2025-03-13 19:04:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 65744 [episode count 14/20]
[retrieval_preprocessing] for episode 78061 [episode count 15/20], we have num_retrieval=np.int64(3393) num_query=np.int64(216)
2025-03-13 19:04:28,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:29,033 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:29
2025-03-13 19:04:29,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.79it/s]
2025-03-13 19:04:29,060 [INFO]: There are 3393 embeddings of dim 49152
2025-03-13 19:04:29,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 19:04:29,060 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:29
2025-03-13 19:04:29,060 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:29,060 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:04:29,060 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:29,060 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:04:29,061 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:29
2025-03-13 19:04:29,061 [INFO]: 700.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:29,061 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:04:29,061 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:29
2025-03-13 19:04:29,061 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:29,062 [INFO]: 	Creating the index 03/13/2025, 19:04:29
2025-03-13 19:04:29,062 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:29
2025-03-13 19:04:29,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 19:04:29,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:29
2025-03-13 19:04:29,064 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:04:29,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.16it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.38it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.62it/s] 50%|█████     | 7/14 [00:00<00:00, 11.63it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.31it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.60it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.51it/s]100%|██████████| 14/14 [00:03<00:00,  4.27it/s]
2025-03-13 19:04:32,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:32
2025-03-13 19:05:02,849 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4975 secs
2025-03-13 19:05:02,849 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 19:05:02,849 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.14it/s] 50%|█████     | 2/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 19:05:23,408 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5595 secs
2025-03-13 19:05:23,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3470 secs
2025-03-13 19:05:23,411 [INFO]: {
2025-03-13 19:05:23,411 [INFO]: 	index_key: HNSW15
2025-03-13 19:05:23,411 [INFO]: 	index_param: efSearch=278
2025-03-13 19:05:23,412 [INFO]: 	index_path: knn.index
2025-03-13 19:05:23,412 [INFO]: 	size in bytes: 667552030
2025-03-13 19:05:23,412 [INFO]: 	avg_search_speed_ms: 11.79972994701392
2025-03-13 19:05:23,412 [INFO]: 	99p_search_speed_ms: 15.955377749633044
2025-03-13 19:05:23,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:05:23,412 [INFO]: 	nb vectors: 3393
2025-03-13 19:05:23,412 [INFO]: 	vectors dimension: 49152
2025-03-13 19:05:23,412 [INFO]: 	compression ratio: 0.9993092882962247
2025-03-13 19:05:23,412 [INFO]: }
2025-03-13 19:05:23,412 [INFO]: 	>>> Finished "Creating the index" in 54.3500 secs
2025-03-13 19:05:23,412 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3790 secs
2025-03-13 19:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 78061 [episode count 15/20]
[retrieval_preprocessing] for episode 45538 [episode count 16/20], we have num_retrieval=np.int64(3442) num_query=np.int64(167)
2025-03-13 19:05:28,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:29,302 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:29
2025-03-13 19:05:29,302 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.10it/s]
2025-03-13 19:05:29,330 [INFO]: There are 3442 embeddings of dim 49152
2025-03-13 19:05:29,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 19:05:29,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:29
2025-03-13 19:05:29,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:29,330 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:05:29,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:05:29,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:05:29,331 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:29
2025-03-13 19:05:29,331 [INFO]: 710.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:29,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:05:29,331 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:29
2025-03-13 19:05:29,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:05:29,331 [INFO]: 	Creating the index 03/13/2025, 19:05:29
2025-03-13 19:05:29,331 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:05:29
2025-03-13 19:05:29,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:05:29,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:29
2025-03-13 19:05:29,332 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:05:29,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.85it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.52it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.59it/s] 50%|█████     | 7/14 [00:00<00:00, 11.18it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.23it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.26it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.15it/s]100%|██████████| 14/14 [00:03<00:00,  4.00it/s]
2025-03-13 19:05:32,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:32
2025-03-13 19:06:04,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5619 secs
2025-03-13 19:06:04,393 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 19:06:04,394 [INFO]: 	Compute fast metrics 03/13/2025, 19:06:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 19:06:30,398 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0039 secs
2025-03-13 19:06:30,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0680 secs
2025-03-13 19:06:30,401 [INFO]: {
2025-03-13 19:06:30,401 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:30,401 [INFO]: 	index_param: efSearch=248
2025-03-13 19:06:30,401 [INFO]: 	index_path: knn.index
2025-03-13 19:06:30,401 [INFO]: 	size in bytes: 677192470
2025-03-13 19:06:30,401 [INFO]: 	avg_search_speed_ms: 9.969889946098059
2025-03-13 19:06:30,401 [INFO]: 	99p_search_speed_ms: 16.571655492298316
2025-03-13 19:06:30,401 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:30,401 [INFO]: 	nb vectors: 3442
2025-03-13 19:06:30,401 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:30,401 [INFO]: 	compression ratio: 0.9993093041923516
2025-03-13 19:06:30,401 [INFO]: }
2025-03-13 19:06:30,401 [INFO]: 	>>> Finished "Creating the index" in 61.0697 secs
2025-03-13 19:06:30,401 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0991 secs
2025-03-13 19:06:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 45538 [episode count 16/20]
[retrieval_preprocessing] for episode 78361 [episode count 17/20], we have num_retrieval=np.int64(3440) num_query=np.int64(169)
2025-03-13 19:06:33,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:34,708 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:34
2025-03-13 19:06:34,708 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.94it/s]
2025-03-13 19:06:34,743 [INFO]: There are 3440 embeddings of dim 49152
2025-03-13 19:06:34,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 19:06:34,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:34
2025-03-13 19:06:34,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:34,744 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:06:34,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:34,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:06:34,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:34
2025-03-13 19:06:34,744 [INFO]: 709.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:34,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:06:34,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:34
2025-03-13 19:06:34,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:34,745 [INFO]: 	Creating the index 03/13/2025, 19:06:34
2025-03-13 19:06:34,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:34
2025-03-13 19:06:34,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:06:34,748 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:34
2025-03-13 19:06:34,748 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:06:34,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.78it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.22it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.97it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.31it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.52it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.72it/s] 50%|█████     | 7/14 [00:00<00:00,  7.79it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.71it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.81it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.87it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.92it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.97it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.99it/s]100%|██████████| 14/14 [00:04<00:00,  1.23it/s]100%|██████████| 14/14 [00:04<00:00,  3.41it/s]
2025-03-13 19:06:38,864 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:38
2025-03-13 19:07:13,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2058 secs
2025-03-13 19:07:13,071 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 19:07:13,071 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 19:07:36,437 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3665 secs
2025-03-13 19:07:36,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6912 secs
2025-03-13 19:07:36,440 [INFO]: {
2025-03-13 19:07:36,440 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:36,440 [INFO]: 	index_param: efSearch=230
2025-03-13 19:07:36,440 [INFO]: 	index_path: knn.index
2025-03-13 19:07:36,440 [INFO]: 	size in bytes: 676798930
2025-03-13 19:07:36,440 [INFO]: 	avg_search_speed_ms: 7.6932366140401705
2025-03-13 19:07:36,440 [INFO]: 	99p_search_speed_ms: 10.01892969245091
2025-03-13 19:07:36,440 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:36,440 [INFO]: 	nb vectors: 3440
2025-03-13 19:07:36,440 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:36,440 [INFO]: 	compression ratio: 0.9993093812958599
2025-03-13 19:07:36,440 [INFO]: }
2025-03-13 19:07:36,440 [INFO]: 	>>> Finished "Creating the index" in 61.6950 secs
2025-03-13 19:07:36,440 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7318 secs
2025-03-13 19:07:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 78361 [episode count 17/20]
[retrieval_preprocessing] for episode 43547 [episode count 18/20], we have num_retrieval=np.int64(3448) num_query=np.int64(161)
2025-03-13 19:07:38,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:39,224 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:39
2025-03-13 19:07:39,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-13 19:07:39,248 [INFO]: There are 3448 embeddings of dim 49152
2025-03-13 19:07:39,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 19:07:39,248 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:39
2025-03-13 19:07:39,248 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:39,248 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:07:39,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:39,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:07:39,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:39
2025-03-13 19:07:39,248 [INFO]: 711.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:39,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:07:39,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:39
2025-03-13 19:07:39,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:39,249 [INFO]: 	Creating the index 03/13/2025, 19:07:39
2025-03-13 19:07:39,249 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:39
2025-03-13 19:07:39,249 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:07:39,250 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:39
2025-03-13 19:07:39,250 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:07:39,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.67it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.05it/s] 36%|███▌      | 5/14 [00:00<00:00, 14.18it/s] 50%|█████     | 7/14 [00:00<00:00, 15.26it/s] 64%|██████▍   | 9/14 [00:00<00:00, 14.05it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.67it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.44it/s]100%|██████████| 14/14 [00:03<00:00,  4.27it/s]
2025-03-13 19:07:42,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:42
2025-03-13 19:08:11,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1259 secs
2025-03-13 19:08:11,654 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 19:08:11,654 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 19:08:34,762 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1069 secs
2025-03-13 19:08:34,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5186 secs
2025-03-13 19:08:34,768 [INFO]: {
2025-03-13 19:08:34,768 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:34,768 [INFO]: 	index_param: efSearch=170
2025-03-13 19:08:34,768 [INFO]: 	index_path: knn.index
2025-03-13 19:08:34,768 [INFO]: 	size in bytes: 678372910
2025-03-13 19:08:34,768 [INFO]: 	avg_search_speed_ms: 10.852277651277495
2025-03-13 19:08:34,768 [INFO]: 	99p_search_speed_ms: 17.62547958642244
2025-03-13 19:08:34,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:34,768 [INFO]: 	nb vectors: 3448
2025-03-13 19:08:34,768 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:34,769 [INFO]: 	compression ratio: 0.9993093385760349
2025-03-13 19:08:34,769 [INFO]: }
2025-03-13 19:08:34,769 [INFO]: 	>>> Finished "Creating the index" in 55.5200 secs
2025-03-13 19:08:34,769 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5442 secs
2025-03-13 19:08:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 43547 [episode count 18/20]
[retrieval_preprocessing] for episode 21023 [episode count 19/20], we have num_retrieval=np.int64(3458) num_query=np.int64(151)
2025-03-13 19:08:38,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:38,712 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:38
2025-03-13 19:08:38,712 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1992.54it/s]
2025-03-13 19:08:38,739 [INFO]: There are 3458 embeddings of dim 49152
2025-03-13 19:08:38,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 19:08:38,739 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:38
2025-03-13 19:08:38,740 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:38,740 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:08:38,740 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:38,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 19:08:38,740 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:38
2025-03-13 19:08:38,741 [INFO]: 713.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:38,741 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:08:38,741 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:38
2025-03-13 19:08:38,741 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:38,741 [INFO]: 	Creating the index 03/13/2025, 19:08:38
2025-03-13 19:08:38,742 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:38
2025-03-13 19:08:38,745 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:08:38,745 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:38
2025-03-13 19:08:38,745 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:08:38,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.96it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.80it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.20it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.71it/s] 57%|█████▋    | 8/14 [00:00<00:00, 10.20it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.05it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.68it/s]100%|██████████| 14/14 [00:04<00:00,  3.47it/s]
2025-03-13 19:08:42,786 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:42
2025-03-13 19:09:19,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1726 secs
2025-03-13 19:09:19,960 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 19:09:19,960 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-13 19:09:40,079 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1192 secs
2025-03-13 19:09:40,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7174 secs
2025-03-13 19:09:40,463 [INFO]: {
2025-03-13 19:09:40,463 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:40,463 [INFO]: 	index_param: efSearch=173
2025-03-13 19:09:40,463 [INFO]: 	index_path: knn.index
2025-03-13 19:09:40,463 [INFO]: 	size in bytes: 680340310
2025-03-13 19:09:40,463 [INFO]: 	avg_search_speed_ms: 8.478410783326412
2025-03-13 19:09:40,464 [INFO]: 	99p_search_speed_ms: 11.08804883435369
2025-03-13 19:09:40,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:40,464 [INFO]: 	nb vectors: 3458
2025-03-13 19:09:40,464 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:40,464 [INFO]: 	compression ratio: 0.9993093956170258
2025-03-13 19:09:40,464 [INFO]: }
2025-03-13 19:09:40,464 [INFO]: 	>>> Finished "Creating the index" in 61.7223 secs
2025-03-13 19:09:40,464 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7521 secs
2025-03-13 19:09:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 21023 [episode count 19/20]
2025-03-13 19:09:41: [retrieval_preprocessing] finished for 8376714657_remove_marker_from_bowl_and_put_on_table [chosen_id count 8/196]
2025-03-13 19:09:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_put_marker_on_table [chosen_id count 9/196]
2025-03-13 19:09:44: [retrieval_preprocessing] we have num_total=3718 embedding_dim=49152
[retrieval_preprocessing] for episode 4130 [episode count 0/20], we have num_retrieval=np.int64(3527) num_query=np.int64(191)
2025-03-13 19:09:46,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:46,767 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:46
2025-03-13 19:09:46,767 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1150.39it/s]
2025-03-13 19:09:46,795 [INFO]: There are 3527 embeddings of dim 49152
2025-03-13 19:09:46,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 19:09:46,796 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:46
2025-03-13 19:09:46,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:46,796 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:09:46,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:46,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:46,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:46
2025-03-13 19:09:46,796 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:46,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:09:46,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:46
2025-03-13 19:09:46,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:46,796 [INFO]: 	Creating the index 03/13/2025, 19:09:46
2025-03-13 19:09:46,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:46
2025-03-13 19:09:46,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:09:46,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:46
2025-03-13 19:09:46,797 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:09:46,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.14it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.19it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.99it/s] 64%|██████▍   | 9/14 [00:00<00:00, 17.17it/s] 79%|███████▊  | 11/14 [00:00<00:00, 16.88it/s] 93%|█████████▎| 13/14 [00:00<00:00, 15.88it/s]100%|██████████| 14/14 [00:03<00:00,  3.76it/s]
2025-03-13 19:09:50,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:50
2025-03-13 19:10:30,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4369 secs
2025-03-13 19:10:30,974 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 19:10:30,974 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s]
2025-03-13 19:10:53,035 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0610 secs
2025-03-13 19:10:53,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2405 secs
2025-03-13 19:10:53,038 [INFO]: {
2025-03-13 19:10:53,038 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:53,038 [INFO]: 	index_param: efSearch=184
2025-03-13 19:10:53,038 [INFO]: 	index_path: knn.index
2025-03-13 19:10:53,038 [INFO]: 	size in bytes: 693915550
2025-03-13 19:10:53,038 [INFO]: 	avg_search_speed_ms: 11.647491313070406
2025-03-13 19:10:53,038 [INFO]: 	99p_search_speed_ms: 26.213623643852717
2025-03-13 19:10:53,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:53,038 [INFO]: 	nb vectors: 3527
2025-03-13 19:10:53,038 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:53,038 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-13 19:10:53,038 [INFO]: }
2025-03-13 19:10:53,038 [INFO]: 	>>> Finished "Creating the index" in 66.2424 secs
2025-03-13 19:10:53,038 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2711 secs
2025-03-13 19:10:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 4130 [episode count 0/20]
[retrieval_preprocessing] for episode 69720 [episode count 1/20], we have num_retrieval=np.int64(3541) num_query=np.int64(177)
2025-03-13 19:10:55,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:56,161 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:56
2025-03-13 19:10:56,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1124.78it/s]
2025-03-13 19:10:56,198 [INFO]: There are 3541 embeddings of dim 49152
2025-03-13 19:10:56,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 19:10:56,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:56
2025-03-13 19:10:56,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:56,198 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:10:56,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:56,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:56,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:56
2025-03-13 19:10:56,199 [INFO]: 730.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:56,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:10:56,199 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:56
2025-03-13 19:10:56,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:56,199 [INFO]: 	Creating the index 03/13/2025, 19:10:56
2025-03-13 19:10:56,199 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:56
2025-03-13 19:10:56,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:10:56,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:56
2025-03-13 19:10:56,200 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:10:56,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.28it/s] 36%|███▌      | 5/14 [00:00<00:00, 24.65it/s] 64%|██████▍   | 9/14 [00:00<00:00, 30.65it/s] 93%|█████████▎| 13/14 [00:00<00:00, 33.57it/s]100%|██████████| 14/14 [00:03<00:00,  4.21it/s]
2025-03-13 19:10:59,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:59
2025-03-13 19:11:45,401 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8649 secs
2025-03-13 19:11:45,402 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 19:11:45,402 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 19:12:06,031 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6292 secs
2025-03-13 19:12:06,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8339 secs
2025-03-13 19:12:06,034 [INFO]: {
2025-03-13 19:12:06,034 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:06,034 [INFO]: 	index_param: efSearch=178
2025-03-13 19:12:06,034 [INFO]: 	index_path: knn.index
2025-03-13 19:12:06,034 [INFO]: 	size in bytes: 696669910
2025-03-13 19:12:06,034 [INFO]: 	avg_search_speed_ms: 9.692849925278809
2025-03-13 19:12:06,034 [INFO]: 	99p_search_speed_ms: 14.012910227756947
2025-03-13 19:12:06,034 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:06,034 [INFO]: 	nb vectors: 3541
2025-03-13 19:12:06,035 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:06,035 [INFO]: 	compression ratio: 0.9993095984294772
2025-03-13 19:12:06,035 [INFO]: }
2025-03-13 19:12:06,035 [INFO]: 	>>> Finished "Creating the index" in 69.8354 secs
2025-03-13 19:12:06,035 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8732 secs
2025-03-13 19:12:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 69720 [episode count 1/20]
[retrieval_preprocessing] for episode 61508 [episode count 2/20], we have num_retrieval=np.int64(3531) num_query=np.int64(187)
2025-03-13 19:12:08,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:09,066 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:09
2025-03-13 19:12:09,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.86it/s]
2025-03-13 19:12:09,094 [INFO]: There are 3531 embeddings of dim 49152
2025-03-13 19:12:09,094 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:12:09,094 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:09
2025-03-13 19:12:09,094 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:09,094 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:12:09,094 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:09,094 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:12:09,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:09
2025-03-13 19:12:09,094 [INFO]: 728.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:09,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:12:09,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:09
2025-03-13 19:12:09,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:09,094 [INFO]: 	Creating the index 03/13/2025, 19:12:09
2025-03-13 19:12:09,094 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:09
2025-03-13 19:12:09,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:12:09,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:09
2025-03-13 19:12:09,096 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:12:09,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.91it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.50it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.81it/s] 50%|█████     | 7/14 [00:00<00:00, 11.58it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.77it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.02it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.17it/s]100%|██████████| 14/14 [00:03<00:00,  3.62it/s]
2025-03-13 19:12:12,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:12
2025-03-13 19:12:53,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3750 secs
2025-03-13 19:12:53,346 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 19:12:53,346 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s]
2025-03-13 19:13:15,010 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6643 secs
2025-03-13 19:13:15,013 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9173 secs
2025-03-13 19:13:15,014 [INFO]: {
2025-03-13 19:13:15,014 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:15,014 [INFO]: 	index_param: efSearch=259
2025-03-13 19:13:15,014 [INFO]: 	index_path: knn.index
2025-03-13 19:13:15,014 [INFO]: 	size in bytes: 694702510
2025-03-13 19:13:15,014 [INFO]: 	avg_search_speed_ms: 10.119714981099584
2025-03-13 19:13:15,014 [INFO]: 	99p_search_speed_ms: 13.738746589515358
2025-03-13 19:13:15,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:15,014 [INFO]: 	nb vectors: 3531
2025-03-13 19:13:15,014 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:15,014 [INFO]: 	compression ratio: 0.999309543303651
2025-03-13 19:13:15,014 [INFO]: }
2025-03-13 19:13:15,014 [INFO]: 	>>> Finished "Creating the index" in 65.9200 secs
2025-03-13 19:13:15,014 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9482 secs
2025-03-13 19:13:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 61508 [episode count 2/20]
[retrieval_preprocessing] for episode 47411 [episode count 3/20], we have num_retrieval=np.int64(3435) num_query=np.int64(283)
2025-03-13 19:13:18,379 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:18,969 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:18
2025-03-13 19:13:18,970 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1724.63it/s]
2025-03-13 19:13:18,997 [INFO]: There are 3435 embeddings of dim 49152
2025-03-13 19:13:18,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:13:18,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:18
2025-03-13 19:13:18,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:18,997 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:13:18,997 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:18,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:18,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:18
2025-03-13 19:13:18,997 [INFO]: 708.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:18,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:18,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:18
2025-03-13 19:13:18,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:18,998 [INFO]: 	Creating the index 03/13/2025, 19:13:18
2025-03-13 19:13:18,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:18
2025-03-13 19:13:18,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:13:18,999 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:18
2025-03-13 19:13:18,999 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:13:18,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.91it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.56it/s] 29%|██▊       | 4/14 [00:00<00:00, 11.21it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.43it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.89it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.66it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.49it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.37it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.33it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.30it/s]100%|██████████| 14/14 [00:04<00:00,  1.06it/s]100%|██████████| 14/14 [00:04<00:00,  3.08it/s]
2025-03-13 19:13:23,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:23
2025-03-13 19:13:57,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2721 secs
2025-03-13 19:13:57,815 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 19:13:57,815 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 19:14:18,646 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8306 secs
2025-03-13 19:14:18,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6499 secs
2025-03-13 19:14:18,649 [INFO]: {
2025-03-13 19:14:18,649 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:18,649 [INFO]: 	index_param: efSearch=173
2025-03-13 19:14:18,649 [INFO]: 	index_path: knn.index
2025-03-13 19:14:18,649 [INFO]: 	size in bytes: 675815170
2025-03-13 19:14:18,649 [INFO]: 	avg_search_speed_ms: 7.986996209988305
2025-03-13 19:14:18,649 [INFO]: 	99p_search_speed_ms: 14.186334884725518
2025-03-13 19:14:18,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:18,649 [INFO]: 	nb vectors: 3435
2025-03-13 19:14:18,649 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:18,649 [INFO]: 	compression ratio: 0.9993094413669347
2025-03-13 19:14:18,649 [INFO]: }
2025-03-13 19:14:18,649 [INFO]: 	>>> Finished "Creating the index" in 59.6517 secs
2025-03-13 19:14:18,649 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6798 secs
2025-03-13 19:14:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 47411 [episode count 3/20]
[retrieval_preprocessing] for episode 41282 [episode count 4/20], we have num_retrieval=np.int64(3590) num_query=np.int64(128)
2025-03-13 19:14:22,773 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:23,457 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:23
2025-03-13 19:14:23,457 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.18it/s]
2025-03-13 19:14:23,482 [INFO]: There are 3590 embeddings of dim 49152
2025-03-13 19:14:23,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 19:14:23,482 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:23
2025-03-13 19:14:23,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:23,483 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:14:23,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:23,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:23,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:23
2025-03-13 19:14:23,483 [INFO]: 740.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:23,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:14:23,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:23
2025-03-13 19:14:23,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:23,483 [INFO]: 	Creating the index 03/13/2025, 19:14:23
2025-03-13 19:14:23,483 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:23
2025-03-13 19:14:23,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:14:23,484 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:23
2025-03-13 19:14:23,484 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:14:23,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.89it/s] 20%|██        | 3/15 [00:00<00:01, 11.61it/s] 33%|███▎      | 5/15 [00:00<00:00, 13.54it/s] 47%|████▋     | 7/15 [00:00<00:00, 14.98it/s] 60%|██████    | 9/15 [00:00<00:00, 15.78it/s] 73%|███████▎  | 11/15 [00:00<00:00, 16.61it/s] 87%|████████▋ | 13/15 [00:00<00:00, 17.15it/s]100%|██████████| 15/15 [00:03<00:00,  1.91it/s]100%|██████████| 15/15 [00:03<00:00,  3.90it/s]
2025-03-13 19:14:27,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:27
2025-03-13 19:15:00,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6508 secs
2025-03-13 19:15:00,985 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 19:15:00,985 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-13 19:15:28,132 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1468 secs
2025-03-13 19:15:28,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9595 secs
2025-03-13 19:15:28,444 [INFO]: {
2025-03-13 19:15:28,444 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:28,444 [INFO]: 	index_param: efSearch=282
2025-03-13 19:15:28,444 [INFO]: 	index_path: knn.index
2025-03-13 19:15:28,444 [INFO]: 	size in bytes: 706310350
2025-03-13 19:15:28,444 [INFO]: 	avg_search_speed_ms: 11.420429945491748
2025-03-13 19:15:28,444 [INFO]: 	99p_search_speed_ms: 22.702087997458875
2025-03-13 19:15:28,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:28,444 [INFO]: 	nb vectors: 3590
2025-03-13 19:15:28,444 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:28,444 [INFO]: 	compression ratio: 0.9993096094372679
2025-03-13 19:15:28,444 [INFO]: }
2025-03-13 19:15:28,445 [INFO]: 	>>> Finished "Creating the index" in 64.9615 secs
2025-03-13 19:15:28,445 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9878 secs
2025-03-13 19:15:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 41282 [episode count 4/20]
[retrieval_preprocessing] for episode 29176 [episode count 5/20], we have num_retrieval=np.int64(3570) num_query=np.int64(148)
2025-03-13 19:15:32,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:32,802 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:32
2025-03-13 19:15:32,802 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.59it/s]
2025-03-13 19:15:32,830 [INFO]: There are 3570 embeddings of dim 49152
2025-03-13 19:15:32,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 19:15:32,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:32
2025-03-13 19:15:32,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:32,830 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:15:32,830 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:32,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:32,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:32
2025-03-13 19:15:32,830 [INFO]: 736.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:32,830 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:15:32,830 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:32
2025-03-13 19:15:32,830 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:32,831 [INFO]: 	Creating the index 03/13/2025, 19:15:32
2025-03-13 19:15:32,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:32
2025-03-13 19:15:32,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:15:32,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:32
2025-03-13 19:15:32,832 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:15:32,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.94it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.30it/s] 20%|██        | 3/15 [00:00<00:01,  7.40it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.10it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.64it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.48it/s] 60%|██████    | 9/15 [00:01<00:00, 10.15it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.63it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.76it/s]100%|██████████| 15/15 [00:04<00:00,  1.99it/s]100%|██████████| 15/15 [00:04<00:00,  3.73it/s]
2025-03-13 19:15:36,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:36
2025-03-13 19:16:11,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0017 secs
2025-03-13 19:16:11,855 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 19:16:11,855 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 19:16:36,732 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8765 secs
2025-03-13 19:16:36,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9020 secs
2025-03-13 19:16:36,734 [INFO]: {
2025-03-13 19:16:36,734 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:36,734 [INFO]: 	index_param: efSearch=283
2025-03-13 19:16:36,734 [INFO]: 	index_path: knn.index
2025-03-13 19:16:36,734 [INFO]: 	size in bytes: 702375490
2025-03-13 19:16:36,734 [INFO]: 	avg_search_speed_ms: 9.954824134596247
2025-03-13 19:16:36,734 [INFO]: 	99p_search_speed_ms: 13.366912752389908
2025-03-13 19:16:36,734 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:36,734 [INFO]: 	nb vectors: 3570
2025-03-13 19:16:36,734 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:36,734 [INFO]: 	compression ratio: 0.9993095858171247
2025-03-13 19:16:36,734 [INFO]: }
2025-03-13 19:16:36,734 [INFO]: 	>>> Finished "Creating the index" in 63.9037 secs
2025-03-13 19:16:36,734 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9323 secs
2025-03-13 19:16:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 29176 [episode count 5/20]
[retrieval_preprocessing] for episode 66078 [episode count 6/20], we have num_retrieval=np.int64(3554) num_query=np.int64(164)
2025-03-13 19:16:39,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:40,109 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:40
2025-03-13 19:16:40,109 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-13 19:16:40,132 [INFO]: There are 3554 embeddings of dim 49152
2025-03-13 19:16:40,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 19:16:40,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:40
2025-03-13 19:16:40,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:40,132 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:16:40,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:40,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:16:40,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:40
2025-03-13 19:16:40,133 [INFO]: 733.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:40,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:16:40,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:40
2025-03-13 19:16:40,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:40,133 [INFO]: 	Creating the index 03/13/2025, 19:16:40
2025-03-13 19:16:40,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:40
2025-03-13 19:16:40,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:16:40,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:40
2025-03-13 19:16:40,134 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:16:40,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.80it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.54it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.05it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.35it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.59it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.67it/s] 50%|█████     | 7/14 [00:00<00:00,  8.61it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.53it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.37it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.42it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.64it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.69it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.85it/s]100%|██████████| 14/14 [00:04<00:00,  1.04s/it]100%|██████████| 14/14 [00:04<00:00,  2.96it/s]
2025-03-13 19:16:44,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:44
2025-03-13 19:17:23,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4644 secs
2025-03-13 19:17:23,331 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 19:17:23,331 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 19:17:43,260 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9288 secs
2025-03-13 19:17:43,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1284 secs
2025-03-13 19:17:43,262 [INFO]: {
2025-03-13 19:17:43,262 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:43,262 [INFO]: 	index_param: efSearch=248
2025-03-13 19:17:43,262 [INFO]: 	index_path: knn.index
2025-03-13 19:17:43,262 [INFO]: 	size in bytes: 699227650
2025-03-13 19:17:43,262 [INFO]: 	avg_search_speed_ms: 10.021381135675346
2025-03-13 19:17:43,263 [INFO]: 	99p_search_speed_ms: 14.777599971275777
2025-03-13 19:17:43,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:43,263 [INFO]: 	nb vectors: 3554
2025-03-13 19:17:43,263 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:43,263 [INFO]: 	compression ratio: 0.9993094981298294
2025-03-13 19:17:43,263 [INFO]: }
2025-03-13 19:17:43,263 [INFO]: 	>>> Finished "Creating the index" in 63.1298 secs
2025-03-13 19:17:43,263 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1537 secs
2025-03-13 19:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 66078 [episode count 6/20]
[retrieval_preprocessing] for episode 6683 [episode count 7/20], we have num_retrieval=np.int64(3489) num_query=np.int64(229)
2025-03-13 19:17:46,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:46,985 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:46
2025-03-13 19:17:46,985 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.78it/s]
2025-03-13 19:17:47,011 [INFO]: There are 3489 embeddings of dim 49152
2025-03-13 19:17:47,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 19:17:47,012 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:47
2025-03-13 19:17:47,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:47,012 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:17:47,012 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:47,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:17:47,012 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:47
2025-03-13 19:17:47,013 [INFO]: 720.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:47,013 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:17:47,013 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:47
2025-03-13 19:17:47,013 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:47,013 [INFO]: 	Creating the index 03/13/2025, 19:17:47
2025-03-13 19:17:47,013 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:47
2025-03-13 19:17:47,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:17:47,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:47
2025-03-13 19:17:47,017 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:17:47,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.52it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.99it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.66it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.00it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.37it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.46it/s] 50%|█████     | 7/14 [00:00<00:00,  8.49it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.12it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.95it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.89it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.91it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.94it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.08it/s]100%|██████████| 14/14 [00:03<00:00,  1.32it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-13 19:17:50,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:50
2025-03-13 19:18:30,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1574 secs
2025-03-13 19:18:30,042 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 19:18:30,042 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 19:18:54,123 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0807 secs
2025-03-13 19:18:54,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1084 secs
2025-03-13 19:18:54,125 [INFO]: {
2025-03-13 19:18:54,125 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:54,125 [INFO]: 	index_param: efSearch=299
2025-03-13 19:18:54,125 [INFO]: 	index_path: knn.index
2025-03-13 19:18:54,125 [INFO]: 	size in bytes: 686439310
2025-03-13 19:18:54,125 [INFO]: 	avg_search_speed_ms: 13.277353193229967
2025-03-13 19:18:54,125 [INFO]: 	99p_search_speed_ms: 22.80001198872924
2025-03-13 19:18:54,125 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:54,125 [INFO]: 	nb vectors: 3489
2025-03-13 19:18:54,125 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:54,125 [INFO]: 	compression ratio: 0.9993094830189722
2025-03-13 19:18:54,126 [INFO]: }
2025-03-13 19:18:54,126 [INFO]: 	>>> Finished "Creating the index" in 67.1121 secs
2025-03-13 19:18:54,126 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1402 secs
2025-03-13 19:18:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 6683 [episode count 7/20]
[retrieval_preprocessing] for episode 51889 [episode count 8/20], we have num_retrieval=np.int64(3543) num_query=np.int64(175)
2025-03-13 19:18:57,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:58,108 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:58
2025-03-13 19:18:58,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.02it/s]
2025-03-13 19:18:58,137 [INFO]: There are 3543 embeddings of dim 49152
2025-03-13 19:18:58,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 19:18:58,138 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:58
2025-03-13 19:18:58,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:58,138 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:18:58,138 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:58,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:18:58,138 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:58
2025-03-13 19:18:58,138 [INFO]: 731.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:58,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:18:58,138 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:58
2025-03-13 19:18:58,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:58,138 [INFO]: 	Creating the index 03/13/2025, 19:18:58
2025-03-13 19:18:58,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:58
2025-03-13 19:18:58,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:18:58,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:58
2025-03-13 19:18:58,140 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:18:58,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.09it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.57it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.83it/s] 50%|█████     | 7/14 [00:00<00:00, 11.32it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.59it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.86it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.04it/s]100%|██████████| 14/14 [00:03<00:00,  3.55it/s]
2025-03-13 19:19:02,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:02
2025-03-13 19:19:38,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3348 secs
2025-03-13 19:19:38,430 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 19:19:38,430 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 19:20:00,546 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1160 secs
2025-03-13 19:20:00,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4088 secs
2025-03-13 19:20:00,549 [INFO]: {
2025-03-13 19:20:00,549 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:00,549 [INFO]: 	index_param: efSearch=279
2025-03-13 19:20:00,549 [INFO]: 	index_path: knn.index
2025-03-13 19:20:00,549 [INFO]: 	size in bytes: 697063390
2025-03-13 19:20:00,549 [INFO]: 	avg_search_speed_ms: 10.15189486617213
2025-03-13 19:20:00,549 [INFO]: 	99p_search_speed_ms: 14.45546619594097
2025-03-13 19:20:00,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:00,549 [INFO]: 	nb vectors: 3543
2025-03-13 19:20:00,549 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:00,549 [INFO]: 	compression ratio: 0.9993096094173013
2025-03-13 19:20:00,549 [INFO]: }
2025-03-13 19:20:00,549 [INFO]: 	>>> Finished "Creating the index" in 62.4106 secs
2025-03-13 19:20:00,549 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4403 secs
2025-03-13 19:20:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 51889 [episode count 8/20]
[retrieval_preprocessing] for episode 43644 [episode count 9/20], we have num_retrieval=np.int64(3513) num_query=np.int64(205)
2025-03-13 19:20:03,274 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:03,776 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:03
2025-03-13 19:20:03,776 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 954.99it/s]
2025-03-13 19:20:03,802 [INFO]: There are 3513 embeddings of dim 49152
2025-03-13 19:20:03,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 19:20:03,802 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:03
2025-03-13 19:20:03,803 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:03,803 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:20:03,803 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:03,803 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 19:20:03,804 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:03
2025-03-13 19:20:03,804 [INFO]: 725.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:03,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:20:03,804 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:03
2025-03-13 19:20:03,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:03,805 [INFO]: 	Creating the index 03/13/2025, 19:20:03
2025-03-13 19:20:03,805 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:03
2025-03-13 19:20:03,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:20:03,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:03
2025-03-13 19:20:03,809 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:20:03,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.88it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.93it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.93it/s] 50%|█████     | 7/14 [00:00<00:00, 10.31it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.70it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.09it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.44it/s]100%|██████████| 14/14 [00:03<00:00,  3.86it/s]
2025-03-13 19:20:07,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:07
2025-03-13 19:20:41,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5702 secs
2025-03-13 19:20:41,020 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 19:20:41,020 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 19:21:01,228 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2079 secs
2025-03-13 19:21:01,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4214 secs
2025-03-13 19:21:01,230 [INFO]: {
2025-03-13 19:21:01,230 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:01,230 [INFO]: 	index_param: efSearch=301
2025-03-13 19:21:01,230 [INFO]: 	index_path: knn.index
2025-03-13 19:21:01,230 [INFO]: 	size in bytes: 691161130
2025-03-13 19:21:01,230 [INFO]: 	avg_search_speed_ms: 11.162867099431294
2025-03-13 19:21:01,230 [INFO]: 	99p_search_speed_ms: 15.337884530890731
2025-03-13 19:21:01,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:01,230 [INFO]: 	nb vectors: 3513
2025-03-13 19:21:01,230 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:01,230 [INFO]: 	compression ratio: 0.9993095300367948
2025-03-13 19:21:01,230 [INFO]: }
2025-03-13 19:21:01,230 [INFO]: 	>>> Finished "Creating the index" in 57.4253 secs
2025-03-13 19:21:01,230 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4541 secs
2025-03-13 19:21:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 43644 [episode count 9/20]
[retrieval_preprocessing] for episode 31604 [episode count 10/20], we have num_retrieval=np.int64(3559) num_query=np.int64(159)
2025-03-13 19:21:04,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:04,908 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:04
2025-03-13 19:21:04,908 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-13 19:21:04,930 [INFO]: There are 3559 embeddings of dim 49152
2025-03-13 19:21:04,931 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 19:21:04,931 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:04
2025-03-13 19:21:04,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:04,931 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:21:04,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:04,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:21:04,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:04
2025-03-13 19:21:04,931 [INFO]: 734.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:04,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:04,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:04
2025-03-13 19:21:04,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:04,931 [INFO]: 	Creating the index 03/13/2025, 19:21:04
2025-03-13 19:21:04,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:04
2025-03-13 19:21:04,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:21:04,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:04
2025-03-13 19:21:04,932 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:21:04,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.07it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.84it/s] 20%|██        | 3/15 [00:00<00:01,  7.60it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.97it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.28it/s] 40%|████      | 6/15 [00:00<00:01,  8.48it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.60it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.83it/s] 60%|██████    | 9/15 [00:01<00:00,  8.83it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.86it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.87it/s] 80%|████████  | 12/15 [00:01<00:00,  8.89it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.96it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.93it/s]100%|██████████| 15/15 [00:04<00:00,  1.05it/s]100%|██████████| 15/15 [00:04<00:00,  3.30it/s]
2025-03-13 19:21:09,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:09
2025-03-13 19:21:47,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8793 secs
2025-03-13 19:21:47,361 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 19:21:47,361 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 19:22:07,989 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6282 secs
2025-03-13 19:22:07,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0598 secs
2025-03-13 19:22:07,993 [INFO]: {
2025-03-13 19:22:07,993 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:07,993 [INFO]: 	index_param: efSearch=251
2025-03-13 19:22:07,993 [INFO]: 	index_path: knn.index
2025-03-13 19:22:07,993 [INFO]: 	size in bytes: 700211350
2025-03-13 19:22:07,993 [INFO]: 	avg_search_speed_ms: 9.94200223805031
2025-03-13 19:22:07,993 [INFO]: 	99p_search_speed_ms: 14.695443981327118
2025-03-13 19:22:07,993 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:07,993 [INFO]: 	nb vectors: 3559
2025-03-13 19:22:07,993 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:07,993 [INFO]: 	compression ratio: 0.9993095256168013
2025-03-13 19:22:07,993 [INFO]: }
2025-03-13 19:22:07,993 [INFO]: 	>>> Finished "Creating the index" in 63.0616 secs
2025-03-13 19:22:07,993 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0851 secs
2025-03-13 19:22:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 31604 [episode count 10/20]
[retrieval_preprocessing] for episode 38267 [episode count 11/20], we have num_retrieval=np.int64(3582) num_query=np.int64(136)
2025-03-13 19:22:10,760 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:11,911 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:11
2025-03-13 19:22:11,911 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1382.43it/s]
2025-03-13 19:22:11,941 [INFO]: There are 3582 embeddings of dim 49152
2025-03-13 19:22:11,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 19:22:11,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:11
2025-03-13 19:22:11,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:11,942 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:22:11,942 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:11,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:22:11,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:11
2025-03-13 19:22:11,943 [INFO]: 739.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:11,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:22:11,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:11
2025-03-13 19:22:11,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:11,943 [INFO]: 	Creating the index 03/13/2025, 19:22:11
2025-03-13 19:22:11,944 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:11
2025-03-13 19:22:11,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:22:11,947 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:11
2025-03-13 19:22:11,947 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:22:11,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.41it/s] 20%|██        | 3/15 [00:00<00:01,  9.46it/s] 27%|██▋       | 4/15 [00:00<00:01,  9.29it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.16it/s] 40%|████      | 6/15 [00:00<00:00,  9.40it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.43it/s] 60%|██████    | 9/15 [00:00<00:00,  9.16it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.97it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.83it/s] 80%|████████  | 12/15 [00:01<00:00,  8.84it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.76it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.70it/s]100%|██████████| 15/15 [00:04<00:00,  1.26it/s]100%|██████████| 15/15 [00:04<00:00,  3.75it/s]
2025-03-13 19:22:15,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:15
2025-03-13 19:22:50,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7826 secs
2025-03-13 19:22:50,738 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 19:22:50,738 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 19:23:08,383 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6450 secs
2025-03-13 19:23:08,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4392 secs
2025-03-13 19:23:08,386 [INFO]: {
2025-03-13 19:23:08,386 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:08,386 [INFO]: 	index_param: efSearch=274
2025-03-13 19:23:08,386 [INFO]: 	index_path: knn.index
2025-03-13 19:23:08,386 [INFO]: 	size in bytes: 704736370
2025-03-13 19:23:08,386 [INFO]: 	avg_search_speed_ms: 9.990791146821165
2025-03-13 19:23:08,386 [INFO]: 	99p_search_speed_ms: 16.645280178636312
2025-03-13 19:23:08,386 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:08,386 [INFO]: 	nb vectors: 3582
2025-03-13 19:23:08,386 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:08,386 [INFO]: 	compression ratio: 0.9993096510685265
2025-03-13 19:23:08,386 [INFO]: }
2025-03-13 19:23:08,386 [INFO]: 	>>> Finished "Creating the index" in 56.4426 secs
2025-03-13 19:23:08,386 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4748 secs
2025-03-13 19:23:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 38267 [episode count 11/20]
[retrieval_preprocessing] for episode 21889 [episode count 12/20], we have num_retrieval=np.int64(3522) num_query=np.int64(196)
2025-03-13 19:23:10,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:11,107 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:11
2025-03-13 19:23:11,107 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.06it/s]
2025-03-13 19:23:11,132 [INFO]: There are 3522 embeddings of dim 49152
2025-03-13 19:23:11,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:23:11,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:11
2025-03-13 19:23:11,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:11,132 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:23:11,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:11,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:23:11,132 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:11
2025-03-13 19:23:11,132 [INFO]: 726.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:11,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:23:11,132 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:11
2025-03-13 19:23:11,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:11,133 [INFO]: 	Creating the index 03/13/2025, 19:23:11
2025-03-13 19:23:11,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:11
2025-03-13 19:23:11,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:23:11,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:11
2025-03-13 19:23:11,134 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:23:11,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.08it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.07it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.51it/s] 50%|█████     | 7/14 [00:00<00:00, 12.11it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.48it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.77it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.28it/s]100%|██████████| 14/14 [00:03<00:00,  4.30it/s]
2025-03-13 19:23:14,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:14
2025-03-13 19:23:45,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2783 secs
2025-03-13 19:23:45,680 [INFO]: The best hyperparameters are: efSearch=312
2025-03-13 19:23:45,680 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 19:24:07,666 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9864 secs
2025-03-13 19:24:08,065 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9314 secs
2025-03-13 19:24:08,066 [INFO]: {
2025-03-13 19:24:08,066 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:08,066 [INFO]: 	index_param: efSearch=312
2025-03-13 19:24:08,066 [INFO]: 	index_path: knn.index
2025-03-13 19:24:08,066 [INFO]: 	size in bytes: 692931790
2025-03-13 19:24:08,066 [INFO]: 	avg_search_speed_ms: 10.468966262756373
2025-03-13 19:24:08,066 [INFO]: 	99p_search_speed_ms: 17.2782136220485
2025-03-13 19:24:08,066 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:08,066 [INFO]: 	nb vectors: 3522
2025-03-13 19:24:08,066 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:08,066 [INFO]: 	compression ratio: 0.9993095799515851
2025-03-13 19:24:08,067 [INFO]: }
2025-03-13 19:24:08,067 [INFO]: 	>>> Finished "Creating the index" in 56.9340 secs
2025-03-13 19:24:08,067 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9600 secs
2025-03-13 19:24:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 21889 [episode count 12/20]
[retrieval_preprocessing] for episode 44333 [episode count 13/20], we have num_retrieval=np.int64(3493) num_query=np.int64(225)
2025-03-13 19:24:12,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:13,518 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:13
2025-03-13 19:24:13,518 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-13 19:24:13,547 [INFO]: There are 3493 embeddings of dim 49152
2025-03-13 19:24:13,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 19:24:13,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:13,548 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:24:13,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:13,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:24:13,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,549 [INFO]: 720.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:13,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:24:13,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:13
2025-03-13 19:24:13,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:13,549 [INFO]: 	Creating the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:13
2025-03-13 19:24:13,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:24:13,553 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:13
2025-03-13 19:24:13,553 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:24:13,553 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.99it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.11it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.76it/s] 50%|█████     | 7/14 [00:00<00:00,  9.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.12it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.64it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.47it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.33it/s]100%|██████████| 14/14 [00:03<00:00,  1.52it/s]100%|██████████| 14/14 [00:03<00:00,  3.71it/s]
2025-03-13 19:24:17,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:17
2025-03-13 19:24:51,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9438 secs
2025-03-13 19:24:51,279 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 19:24:51,279 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 19:25:15,039 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7599 secs
2025-03-13 19:25:15,042 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4892 secs
2025-03-13 19:25:15,042 [INFO]: {
2025-03-13 19:25:15,042 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:15,042 [INFO]: 	index_param: efSearch=284
2025-03-13 19:25:15,042 [INFO]: 	index_path: knn.index
2025-03-13 19:25:15,042 [INFO]: 	size in bytes: 687226270
2025-03-13 19:25:15,042 [INFO]: 	avg_search_speed_ms: 10.587462320155094
2025-03-13 19:25:15,042 [INFO]: 	99p_search_speed_ms: 16.519689047709104
2025-03-13 19:25:15,042 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:15,042 [INFO]: 	nb vectors: 3493
2025-03-13 19:25:15,042 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:15,042 [INFO]: 	compression ratio: 0.9993095054413447
2025-03-13 19:25:15,042 [INFO]: }
2025-03-13 19:25:15,042 [INFO]: 	>>> Finished "Creating the index" in 61.4929 secs
2025-03-13 19:25:15,042 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5239 secs
2025-03-13 19:25:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 44333 [episode count 13/20]
[retrieval_preprocessing] for episode 75056 [episode count 14/20], we have num_retrieval=np.int64(3583) num_query=np.int64(135)
2025-03-13 19:25:19,172 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:19,637 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:19
2025-03-13 19:25:19,637 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 19:25:19,663 [INFO]: There are 3583 embeddings of dim 49152
2025-03-13 19:25:19,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 19:25:19,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:19
2025-03-13 19:25:19,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:19,664 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:25:19,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:19,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:19,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:19
2025-03-13 19:25:19,664 [INFO]: 739.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:19,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:19,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:19
2025-03-13 19:25:19,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:19,664 [INFO]: 	Creating the index 03/13/2025, 19:25:19
2025-03-13 19:25:19,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:19
2025-03-13 19:25:19,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:25:19,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:19
2025-03-13 19:25:19,665 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:25:19,665 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.71it/s] 20%|██        | 3/15 [00:00<00:01,  8.43it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.66it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.75it/s] 40%|████      | 6/15 [00:00<00:01,  8.93it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.94it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.80it/s] 60%|██████    | 9/15 [00:01<00:00,  8.88it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.70it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.99it/s]100%|██████████| 15/15 [00:04<00:00,  1.69it/s]100%|██████████| 15/15 [00:04<00:00,  3.47it/s]
2025-03-13 19:25:23,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:23
2025-03-13 19:26:00,882 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8833 secs
2025-03-13 19:26:00,882 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 19:26:00,882 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 19:26:27,956 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0732 secs
2025-03-13 19:26:27,959 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2933 secs
2025-03-13 19:26:27,959 [INFO]: {
2025-03-13 19:26:27,959 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:27,959 [INFO]: 	index_param: efSearch=286
2025-03-13 19:26:27,959 [INFO]: 	index_path: knn.index
2025-03-13 19:26:27,959 [INFO]: 	size in bytes: 704933110
2025-03-13 19:26:27,959 [INFO]: 	avg_search_speed_ms: 10.722864626099266
2025-03-13 19:26:27,959 [INFO]: 	99p_search_speed_ms: 16.977844666689624
2025-03-13 19:26:27,959 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:27,959 [INFO]: 	nb vectors: 3583
2025-03-13 19:26:27,959 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:27,959 [INFO]: 	compression ratio: 0.9993096564864147
2025-03-13 19:26:27,959 [INFO]: }
2025-03-13 19:26:27,959 [INFO]: 	>>> Finished "Creating the index" in 68.2949 secs
2025-03-13 19:26:27,959 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3218 secs
2025-03-13 19:26:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 75056 [episode count 14/20]
[retrieval_preprocessing] for episode 66909 [episode count 15/20], we have num_retrieval=np.int64(3569) num_query=np.int64(149)
2025-03-13 19:26:30,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:30,894 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:30
2025-03-13 19:26:30,894 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1245.34it/s]
2025-03-13 19:26:30,921 [INFO]: There are 3569 embeddings of dim 49152
2025-03-13 19:26:30,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 19:26:30,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:30
2025-03-13 19:26:30,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:30,922 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:26:30,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:30,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:26:30,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:30
2025-03-13 19:26:30,922 [INFO]: 736.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:30,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:26:30,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:30
2025-03-13 19:26:30,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:30,922 [INFO]: 	Creating the index 03/13/2025, 19:26:30
2025-03-13 19:26:30,922 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:30
2025-03-13 19:26:30,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:26:30,923 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:30
2025-03-13 19:26:30,923 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:26:30,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.01it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.66it/s] 20%|██        | 3/15 [00:00<00:01,  8.30it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.51it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.61it/s] 40%|████      | 6/15 [00:00<00:01,  8.55it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.65it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.83it/s] 60%|██████    | 9/15 [00:01<00:00,  8.83it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.83it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.84it/s] 80%|████████  | 12/15 [00:01<00:00,  8.84it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.96it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.03it/s]100%|██████████| 15/15 [00:04<00:00,  1.20it/s]100%|██████████| 15/15 [00:04<00:00,  3.64it/s]
2025-03-13 19:26:35,045 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:35
2025-03-13 19:27:10,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0137 secs
2025-03-13 19:27:10,059 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 19:27:10,060 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 19:27:27,514 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4541 secs
2025-03-13 19:27:27,516 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5930 secs
2025-03-13 19:27:27,516 [INFO]: {
2025-03-13 19:27:27,516 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:27,516 [INFO]: 	index_param: efSearch=284
2025-03-13 19:27:27,516 [INFO]: 	index_path: knn.index
2025-03-13 19:27:27,516 [INFO]: 	size in bytes: 702178750
2025-03-13 19:27:27,516 [INFO]: 	avg_search_speed_ms: 9.911851570004647
2025-03-13 19:27:27,516 [INFO]: 	99p_search_speed_ms: 13.807771531864992
2025-03-13 19:27:27,516 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:27,516 [INFO]: 	nb vectors: 3569
2025-03-13 19:27:27,516 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:27,516 [INFO]: 	compression ratio: 0.9993095803597019
2025-03-13 19:27:27,516 [INFO]: }
2025-03-13 19:27:27,516 [INFO]: 	>>> Finished "Creating the index" in 56.5945 secs
2025-03-13 19:27:27,516 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6224 secs
2025-03-13 19:27:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 66909 [episode count 15/20]
[retrieval_preprocessing] for episode 94122 [episode count 16/20], we have num_retrieval=np.int64(3512) num_query=np.int64(206)
2025-03-13 19:27:30,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:31,237 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:31
2025-03-13 19:27:31,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2215.69it/s]
2025-03-13 19:27:31,260 [INFO]: There are 3512 embeddings of dim 49152
2025-03-13 19:27:31,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 19:27:31,260 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:31
2025-03-13 19:27:31,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:31,260 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:27:31,260 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:31,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:31,260 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:31
2025-03-13 19:27:31,260 [INFO]: 724.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:31,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:27:31,260 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:31
2025-03-13 19:27:31,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:31,261 [INFO]: 	Creating the index 03/13/2025, 19:27:31
2025-03-13 19:27:31,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:31
2025-03-13 19:27:31,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:27:31,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:31
2025-03-13 19:27:31,262 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:27:31,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.57it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.07it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.03it/s] 50%|█████     | 7/14 [00:00<00:00, 11.67it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.80it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.87it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.91it/s]100%|██████████| 14/14 [00:03<00:00,  4.10it/s]
2025-03-13 19:27:34,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:34
2025-03-13 19:28:06,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0255 secs
2025-03-13 19:28:06,712 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 19:28:06,712 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-13 19:28:24,823 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1109 secs
2025-03-13 19:28:24,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5647 secs
2025-03-13 19:28:24,826 [INFO]: {
2025-03-13 19:28:24,827 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:24,827 [INFO]: 	index_param: efSearch=326
2025-03-13 19:28:24,827 [INFO]: 	index_path: knn.index
2025-03-13 19:28:24,827 [INFO]: 	size in bytes: 690964390
2025-03-13 19:28:24,827 [INFO]: 	avg_search_speed_ms: 12.307625899130311
2025-03-13 19:28:24,827 [INFO]: 	99p_search_speed_ms: 19.27903201431036
2025-03-13 19:28:24,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:24,827 [INFO]: 	nb vectors: 3512
2025-03-13 19:28:24,827 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:24,827 [INFO]: 	compression ratio: 0.9993095244749154
2025-03-13 19:28:24,827 [INFO]: }
2025-03-13 19:28:24,827 [INFO]: 	>>> Finished "Creating the index" in 53.5662 secs
2025-03-13 19:28:24,827 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5898 secs
2025-03-13 19:28:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 94122 [episode count 16/20]
[retrieval_preprocessing] for episode 46971 [episode count 17/20], we have num_retrieval=np.int64(3532) num_query=np.int64(186)
2025-03-13 19:28:28,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:28,952 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:28
2025-03-13 19:28:28,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1063.46it/s]
2025-03-13 19:28:28,977 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 19:28:28,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:28:28,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:28
2025-03-13 19:28:28,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:28,977 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:28:28,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:28,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:28:28,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:28
2025-03-13 19:28:28,977 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:28,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:28:28,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:28
2025-03-13 19:28:28,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:28,978 [INFO]: 	Creating the index 03/13/2025, 19:28:28
2025-03-13 19:28:28,978 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:28
2025-03-13 19:28:28,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:28:28,979 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:28
2025-03-13 19:28:28,979 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:28:28,979 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.91it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.54it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.82it/s] 50%|█████     | 7/14 [00:00<00:00, 12.32it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.59it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.81it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.88it/s]100%|██████████| 14/14 [00:03<00:00,  3.70it/s]
2025-03-13 19:28:32,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:32
2025-03-13 19:29:07,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5442 secs
2025-03-13 19:29:07,320 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 19:29:07,320 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 19:29:21,495 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1749 secs
2025-03-13 19:29:21,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5188 secs
2025-03-13 19:29:21,498 [INFO]: {
2025-03-13 19:29:21,498 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:21,498 [INFO]: 	index_param: efSearch=292
2025-03-13 19:29:21,498 [INFO]: 	index_path: knn.index
2025-03-13 19:29:21,498 [INFO]: 	size in bytes: 694899250
2025-03-13 19:29:21,498 [INFO]: 	avg_search_speed_ms: 10.945805853092127
2025-03-13 19:29:21,498 [INFO]: 	99p_search_speed_ms: 16.55144074233249
2025-03-13 19:29:21,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:21,498 [INFO]: 	nb vectors: 3532
2025-03-13 19:29:21,498 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:21,498 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 19:29:21,498 [INFO]: }
2025-03-13 19:29:21,498 [INFO]: 	>>> Finished "Creating the index" in 52.5201 secs
2025-03-13 19:29:21,498 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5460 secs
2025-03-13 19:29:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 46971 [episode count 17/20]
[retrieval_preprocessing] for episode 30591 [episode count 18/20], we have num_retrieval=np.int64(3526) num_query=np.int64(192)
2025-03-13 19:29:24,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:24,812 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:24
2025-03-13 19:29:24,812 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-13 19:29:24,837 [INFO]: There are 3526 embeddings of dim 49152
2025-03-13 19:29:24,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:29:24,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:24
2025-03-13 19:29:24,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:24,837 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:29:24,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:24,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:24,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:24
2025-03-13 19:29:24,837 [INFO]: 727.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:24,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:29:24,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:24
2025-03-13 19:29:24,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:24,837 [INFO]: 	Creating the index 03/13/2025, 19:29:24
2025-03-13 19:29:24,838 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:24
2025-03-13 19:29:24,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:29:24,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:24
2025-03-13 19:29:24,839 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:29:24,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.79it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.45it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.53it/s] 50%|█████     | 7/14 [00:00<00:00, 11.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.24it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.35it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.55it/s]100%|██████████| 14/14 [00:03<00:00,  4.17it/s]
2025-03-13 19:29:28,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:28
2025-03-13 19:30:02,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3225 secs
2025-03-13 19:30:02,525 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 19:30:02,525 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 19:30:26,630 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1042 secs
2025-03-13 19:30:26,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7933 secs
2025-03-13 19:30:26,632 [INFO]: {
2025-03-13 19:30:26,632 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:26,632 [INFO]: 	index_param: efSearch=271
2025-03-13 19:30:26,632 [INFO]: 	index_path: knn.index
2025-03-13 19:30:26,632 [INFO]: 	size in bytes: 693718750
2025-03-13 19:30:26,632 [INFO]: 	avg_search_speed_ms: 9.88186449626932
2025-03-13 19:30:26,632 [INFO]: 	99p_search_speed_ms: 18.70499591343105
2025-03-13 19:30:26,632 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:26,632 [INFO]: 	nb vectors: 3526
2025-03-13 19:30:26,632 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:26,632 [INFO]: 	compression ratio: 0.9993096020541465
2025-03-13 19:30:26,632 [INFO]: }
2025-03-13 19:30:26,632 [INFO]: 	>>> Finished "Creating the index" in 61.7947 secs
2025-03-13 19:30:26,632 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8206 secs
2025-03-13 19:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 30591 [episode count 18/20]
[retrieval_preprocessing] for episode 66685 [episode count 19/20], we have num_retrieval=np.int64(3471) num_query=np.int64(247)
2025-03-13 19:30:29,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:30,009 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:30
2025-03-13 19:30:30,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.74it/s]
2025-03-13 19:30:30,038 [INFO]: There are 3471 embeddings of dim 49152
2025-03-13 19:30:30,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 19:30:30,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:30
2025-03-13 19:30:30,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:30,038 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 19:30:30,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:30,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:30,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:30
2025-03-13 19:30:30,038 [INFO]: 716.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:30,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:30:30,039 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:30
2025-03-13 19:30:30,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:30,039 [INFO]: 	Creating the index 03/13/2025, 19:30:30
2025-03-13 19:30:30,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:30
2025-03-13 19:30:30,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:30:30,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:30
2025-03-13 19:30:30,040 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 19:30:30,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.98it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.52it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.16it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.62it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.80it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.05it/s] 50%|█████     | 7/14 [00:00<00:00,  9.14it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.14it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.30it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.27it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.04it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.89it/s]100%|██████████| 14/14 [00:03<00:00,  1.39it/s]100%|██████████| 14/14 [00:03<00:00,  3.62it/s]
2025-03-13 19:30:33,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:33
2025-03-13 19:31:11,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1661 secs
2025-03-13 19:31:11,073 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 19:31:11,073 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.48it/s] 50%|█████     | 2/4 [00:00<00:00,  4.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.99it/s]
2025-03-13 19:31:28,459 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3862 secs
2025-03-13 19:31:28,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4217 secs
2025-03-13 19:31:28,462 [INFO]: {
2025-03-13 19:31:28,462 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:28,462 [INFO]: 	index_param: efSearch=243
2025-03-13 19:31:28,462 [INFO]: 	index_path: knn.index
2025-03-13 19:31:28,462 [INFO]: 	size in bytes: 682897930
2025-03-13 19:31:28,462 [INFO]: 	avg_search_speed_ms: 9.24282924718845
2025-03-13 19:31:28,462 [INFO]: 	99p_search_speed_ms: 13.722754216287289
2025-03-13 19:31:28,462 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:28,462 [INFO]: 	nb vectors: 3471
2025-03-13 19:31:28,462 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:28,462 [INFO]: 	compression ratio: 0.9993094692789595
2025-03-13 19:31:28,462 [INFO]: }
2025-03-13 19:31:28,462 [INFO]: 	>>> Finished "Creating the index" in 58.4232 secs
2025-03-13 19:31:28,462 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4526 secs
2025-03-13 19:31:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 66685 [episode count 19/20]
2025-03-13 19:31:30: [retrieval_preprocessing] finished for 8376714657_put_marker_on_table [chosen_id count 9/196]
2025-03-13 19:31:30: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
