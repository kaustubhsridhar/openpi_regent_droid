2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_put_pen_in_bowl [chosen_id count 0/196]
2025-03-13 14:35:02: [retrieval_preprocessing] we have num_total=3263 embedding_dim=49152
[retrieval_preprocessing] for episode 28672 [episode count 0/20], we have num_retrieval=np.int64(3120) num_query=np.int64(143)
2025-03-13 14:35:02,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:03,174 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:03
2025-03-13 14:35:03,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 607.25it/s]
2025-03-13 14:35:03,223 [INFO]: There are 3120 embeddings of dim 49152
2025-03-13 14:35:03,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0492 secs
2025-03-13 14:35:03,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:03,223 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:35:03,224 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:03,224 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:03,224 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,224 [INFO]: 643.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:03,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0009 secs
2025-03-13 14:35:03,225 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:03
2025-03-13 14:35:03,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:03,225 [INFO]: 	Creating the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,225 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:03
2025-03-13 14:35:03,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 14:35:03,227 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,227 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:35:03,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.36it/s] 38%|███▊      | 5/13 [00:00<00:00, 25.89it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.91it/s]100%|██████████| 13/13 [00:02<00:00,  3.47it/s]100%|██████████| 13/13 [00:02<00:00,  4.66it/s]
2025-03-13 14:35:06,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:06
2025-03-13 14:35:50,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3301 secs
2025-03-13 14:35:50,350 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 14:35:50,350 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  4.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.85it/s]
2025-03-13 14:36:10,845 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4940 secs
2025-03-13 14:36:10,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6208 secs
2025-03-13 14:36:10,848 [INFO]: {
2025-03-13 14:36:10,848 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:10,848 [INFO]: 	index_param: efSearch=235
2025-03-13 14:36:10,848 [INFO]: 	index_path: knn.index
2025-03-13 14:36:10,848 [INFO]: 	size in bytes: 613840630
2025-03-13 14:36:10,848 [INFO]: 	avg_search_speed_ms: 9.043783406056733
2025-03-13 14:36:10,848 [INFO]: 	99p_search_speed_ms: 12.28185696527362
2025-03-13 14:36:10,848 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:10,848 [INFO]: 	nb vectors: 3120
2025-03-13 14:36:10,848 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:10,848 [INFO]: 	compression ratio: 0.9993098045660483
2025-03-13 14:36:10,848 [INFO]: }
2025-03-13 14:36:10,848 [INFO]: 	>>> Finished "Creating the index" in 67.6234 secs
2025-03-13 14:36:10,848 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6741 secs
2025-03-13 14:36:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 28672 [episode count 0/20]
[retrieval_preprocessing] for episode 38926 [episode count 1/20], we have num_retrieval=np.int64(3096) num_query=np.int64(167)
2025-03-13 14:36:15,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:15,732 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:15
2025-03-13 14:36:15,733 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1971.01it/s]
2025-03-13 14:36:15,757 [INFO]: There are 3096 embeddings of dim 49152
2025-03-13 14:36:15,757 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 14:36:15,757 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:15
2025-03-13 14:36:15,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:15,757 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:36:15,757 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:15,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:15,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:15
2025-03-13 14:36:15,758 [INFO]: 638.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:15,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:36:15,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:15
2025-03-13 14:36:15,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:15,758 [INFO]: 	Creating the index 03/13/2025, 14:36:15
2025-03-13 14:36:15,758 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:15
2025-03-13 14:36:15,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:36:15,759 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:15
2025-03-13 14:36:15,759 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:36:15,759 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.95it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.11it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.02it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.19it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.66it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.35it/s]100%|██████████| 13/13 [00:03<00:00,  2.34it/s]100%|██████████| 13/13 [00:03<00:00,  4.05it/s]
2025-03-13 14:36:18,972 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:18
2025-03-13 14:36:55,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1261 secs
2025-03-13 14:36:55,100 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 14:36:55,100 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 14:37:15,570 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4704 secs
2025-03-13 14:37:15,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1967 secs
2025-03-13 14:37:15,956 [INFO]: {
2025-03-13 14:37:15,956 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:15,956 [INFO]: 	index_param: efSearch=249
2025-03-13 14:37:15,956 [INFO]: 	index_path: knn.index
2025-03-13 14:37:15,956 [INFO]: 	size in bytes: 609118810
2025-03-13 14:37:15,957 [INFO]: 	avg_search_speed_ms: 10.856537334671513
2025-03-13 14:37:15,957 [INFO]: 	99p_search_speed_ms: 17.877629958093166
2025-03-13 14:37:15,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:15,957 [INFO]: 	nb vectors: 3096
2025-03-13 14:37:15,957 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:15,957 [INFO]: 	compression ratio: 0.9993097537079835
2025-03-13 14:37:15,957 [INFO]: }
2025-03-13 14:37:15,957 [INFO]: 	>>> Finished "Creating the index" in 60.1990 secs
2025-03-13 14:37:15,957 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2244 secs
2025-03-13 14:37:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 38926 [episode count 1/20]
[retrieval_preprocessing] for episode 8213 [episode count 2/20], we have num_retrieval=np.int64(3126) num_query=np.int64(137)
2025-03-13 14:37:18,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:19,257 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:19
2025-03-13 14:37:19,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-13 14:37:19,282 [INFO]: There are 3126 embeddings of dim 49152
2025-03-13 14:37:19,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 14:37:19,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:19
2025-03-13 14:37:19,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:19,283 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:37:19,283 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:19,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:19,283 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:19
2025-03-13 14:37:19,283 [INFO]: 645.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:19,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:37:19,283 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:19
2025-03-13 14:37:19,283 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:19,283 [INFO]: 	Creating the index 03/13/2025, 14:37:19
2025-03-13 14:37:19,283 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:19
2025-03-13 14:37:19,285 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:37:19,285 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:19
2025-03-13 14:37:19,285 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:37:19,285 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.77it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.42it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.72it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.72it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.48it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.22it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.95it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.87it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.05it/s]100%|██████████| 13/13 [00:03<00:00,  1.23it/s]100%|██████████| 13/13 [00:03<00:00,  3.35it/s]
2025-03-13 14:37:23,175 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:23
2025-03-13 14:37:56,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1508 secs
2025-03-13 14:37:56,327 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 14:37:56,327 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.21it/s] 50%|█████     | 2/4 [00:00<00:00,  4.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.25it/s]
2025-03-13 14:38:14,786 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4597 secs
2025-03-13 14:38:14,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5044 secs
2025-03-13 14:38:14,789 [INFO]: {
2025-03-13 14:38:14,789 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:14,789 [INFO]: 	index_param: efSearch=211
2025-03-13 14:38:14,789 [INFO]: 	index_path: knn.index
2025-03-13 14:38:14,789 [INFO]: 	size in bytes: 615021250
2025-03-13 14:38:14,789 [INFO]: 	avg_search_speed_ms: 9.205695472805182
2025-03-13 14:38:14,789 [INFO]: 	99p_search_speed_ms: 15.503156604245312
2025-03-13 14:38:14,789 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:14,789 [INFO]: 	nb vectors: 3126
2025-03-13 14:38:14,789 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:14,789 [INFO]: 	compression ratio: 0.9993095490602967
2025-03-13 14:38:14,790 [INFO]: }
2025-03-13 14:38:14,790 [INFO]: 	>>> Finished "Creating the index" in 55.5063 secs
2025-03-13 14:38:14,790 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5320 secs
2025-03-13 14:38:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 8213 [episode count 2/20]
[retrieval_preprocessing] for episode 59419 [episode count 3/20], we have num_retrieval=np.int64(3055) num_query=np.int64(208)
2025-03-13 14:38:17,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:17,896 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:17
2025-03-13 14:38:17,896 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.37it/s]
2025-03-13 14:38:17,921 [INFO]: There are 3055 embeddings of dim 49152
2025-03-13 14:38:17,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 14:38:17,921 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:17
2025-03-13 14:38:17,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:17,921 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:38:17,921 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:17,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:17,921 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:17
2025-03-13 14:38:17,921 [INFO]: 630.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:17,921 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:38:17,921 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:17
2025-03-13 14:38:17,921 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:17,921 [INFO]: 	Creating the index 03/13/2025, 14:38:17
2025-03-13 14:38:17,921 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:17
2025-03-13 14:38:17,922 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:38:17,922 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:17
2025-03-13 14:38:17,923 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:38:17,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.06it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.13it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.16it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.10it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.34it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.45it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.48it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.57it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.47it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.45it/s]100%|██████████| 13/13 [00:04<00:00,  1.12it/s]100%|██████████| 13/13 [00:04<00:00,  3.19it/s]
2025-03-13 14:38:22,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:22
2025-03-13 14:38:51,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4443 secs
2025-03-13 14:38:51,452 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 14:38:51,452 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 14:39:10,332 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8791 secs
2025-03-13 14:39:10,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4127 secs
2025-03-13 14:39:10,335 [INFO]: {
2025-03-13 14:39:10,336 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:10,336 [INFO]: 	index_param: efSearch=288
2025-03-13 14:39:10,336 [INFO]: 	index_path: knn.index
2025-03-13 14:39:10,336 [INFO]: 	size in bytes: 601052230
2025-03-13 14:39:10,336 [INFO]: 	avg_search_speed_ms: 11.892729844703084
2025-03-13 14:39:10,336 [INFO]: 	99p_search_speed_ms: 15.260748099535704
2025-03-13 14:39:10,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:10,336 [INFO]: 	nb vectors: 3055
2025-03-13 14:39:10,336 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:10,336 [INFO]: 	compression ratio: 0.9993098935844561
2025-03-13 14:39:10,336 [INFO]: }
2025-03-13 14:39:10,336 [INFO]: 	>>> Finished "Creating the index" in 52.4143 secs
2025-03-13 14:39:10,336 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4399 secs
2025-03-13 14:39:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 59419 [episode count 3/20]
[retrieval_preprocessing] for episode 8243 [episode count 4/20], we have num_retrieval=np.int64(3042) num_query=np.int64(221)
2025-03-13 14:39:14,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:15,266 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:15
2025-03-13 14:39:15,266 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1043.88it/s]
2025-03-13 14:39:15,294 [INFO]: There are 3042 embeddings of dim 49152
2025-03-13 14:39:15,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 14:39:15,295 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:15
2025-03-13 14:39:15,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:15,295 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:39:15,295 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:15,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:39:15,295 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:15
2025-03-13 14:39:15,295 [INFO]: 627.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:15,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:39:15,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:15
2025-03-13 14:39:15,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:15,295 [INFO]: 	Creating the index 03/13/2025, 14:39:15
2025-03-13 14:39:15,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:15
2025-03-13 14:39:15,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:39:15,297 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:15
2025-03-13 14:39:15,297 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:39:15,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.85it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.17it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.93it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.53it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.02it/s] 50%|█████     | 6/12 [00:00<00:00,  8.25it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.10it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.00it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.96it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.05it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.80it/s]100%|██████████| 12/12 [00:03<00:00,  1.19it/s]100%|██████████| 12/12 [00:03<00:00,  3.06it/s]
2025-03-13 14:39:19,229 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:19
2025-03-13 14:39:49,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1655 secs
2025-03-13 14:39:49,396 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 14:39:49,396 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 14:40:10,985 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5894 secs
2025-03-13 14:40:10,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6912 secs
2025-03-13 14:40:10,988 [INFO]: {
2025-03-13 14:40:10,988 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:10,988 [INFO]: 	index_param: efSearch=247
2025-03-13 14:40:10,988 [INFO]: 	index_path: knn.index
2025-03-13 14:40:10,988 [INFO]: 	size in bytes: 598494550
2025-03-13 14:40:10,988 [INFO]: 	avg_search_speed_ms: 12.314537144954238
2025-03-13 14:40:10,988 [INFO]: 	99p_search_speed_ms: 30.56420560227707
2025-03-13 14:40:10,988 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:10,988 [INFO]: 	nb vectors: 3042
2025-03-13 14:40:10,988 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:10,988 [INFO]: 	compression ratio: 0.9993099118446442
2025-03-13 14:40:10,988 [INFO]: }
2025-03-13 14:40:10,988 [INFO]: 	>>> Finished "Creating the index" in 55.6929 secs
2025-03-13 14:40:10,988 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7223 secs
2025-03-13 14:40:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 8243 [episode count 4/20]
[retrieval_preprocessing] for episode 86107 [episode count 5/20], we have num_retrieval=np.int64(3153) num_query=np.int64(110)
2025-03-13 14:40:14,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:15,069 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:15
2025-03-13 14:40:15,069 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1926.64it/s]
2025-03-13 14:40:15,095 [INFO]: There are 3153 embeddings of dim 49152
2025-03-13 14:40:15,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 14:40:15,095 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:15
2025-03-13 14:40:15,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:15,095 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:40:15,095 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:15,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:15,095 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:15
2025-03-13 14:40:15,095 [INFO]: 650.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:15,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:40:15,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:15
2025-03-13 14:40:15,095 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:15,095 [INFO]: 	Creating the index 03/13/2025, 14:40:15
2025-03-13 14:40:15,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:15
2025-03-13 14:40:15,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:40:15,096 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:15
2025-03-13 14:40:15,096 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:40:15,096 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.54it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.92it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.76it/s] 31%|███       | 4/13 [00:00<00:01,  7.14it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.54it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.08it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.01it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.83it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.73it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.59it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.52it/s]100%|██████████| 13/13 [00:04<00:00,  1.15it/s]100%|██████████| 13/13 [00:04<00:00,  3.05it/s]
2025-03-13 14:40:19,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:19
2025-03-13 14:40:54,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6928 secs
2025-03-13 14:40:54,047 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 14:40:54,047 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 14:41:16,144 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0967 secs
2025-03-13 14:41:16,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4019 secs
2025-03-13 14:41:16,499 [INFO]: {
2025-03-13 14:41:16,499 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:16,499 [INFO]: 	index_param: efSearch=272
2025-03-13 14:41:16,499 [INFO]: 	index_path: knn.index
2025-03-13 14:41:16,499 [INFO]: 	size in bytes: 620333290
2025-03-13 14:41:16,499 [INFO]: 	avg_search_speed_ms: 10.754664835610217
2025-03-13 14:41:16,499 [INFO]: 	99p_search_speed_ms: 19.895689776167277
2025-03-13 14:41:16,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:16,499 [INFO]: 	nb vectors: 3153
2025-03-13 14:41:16,499 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:16,499 [INFO]: 	compression ratio: 0.9993096195111502
2025-03-13 14:41:16,499 [INFO]: }
2025-03-13 14:41:16,499 [INFO]: 	>>> Finished "Creating the index" in 61.4041 secs
2025-03-13 14:41:16,499 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4301 secs
2025-03-13 14:41:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 86107 [episode count 5/20]
[retrieval_preprocessing] for episode 70058 [episode count 6/20], we have num_retrieval=np.int64(3083) num_query=np.int64(180)
2025-03-13 14:41:18,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:18,603 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:18
2025-03-13 14:41:18,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.00it/s]
2025-03-13 14:41:18,627 [INFO]: There are 3083 embeddings of dim 49152
2025-03-13 14:41:18,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 14:41:18,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:18
2025-03-13 14:41:18,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:18,628 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:41:18,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:18,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:18,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:18
2025-03-13 14:41:18,628 [INFO]: 636.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:18,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:18,628 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:18
2025-03-13 14:41:18,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:18,628 [INFO]: 	Creating the index 03/13/2025, 14:41:18
2025-03-13 14:41:18,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:18
2025-03-13 14:41:18,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:41:18,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:18
2025-03-13 14:41:18,629 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:41:18,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.80it/s] 31%|███       | 4/13 [00:00<00:00, 17.74it/s] 46%|████▌     | 6/13 [00:00<00:00, 16.57it/s] 62%|██████▏   | 8/13 [00:00<00:00, 17.10it/s] 77%|███████▋  | 10/13 [00:00<00:00, 14.70it/s] 92%|█████████▏| 12/13 [00:00<00:00, 13.99it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-13 14:41:21,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:21
2025-03-13 14:41:56,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2722 secs
2025-03-13 14:41:56,739 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 14:41:56,739 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s]
2025-03-13 14:42:18,737 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9979 secs
2025-03-13 14:42:18,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1105 secs
2025-03-13 14:42:18,740 [INFO]: {
2025-03-13 14:42:18,740 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:18,740 [INFO]: 	index_param: efSearch=223
2025-03-13 14:42:18,740 [INFO]: 	index_path: knn.index
2025-03-13 14:42:18,740 [INFO]: 	size in bytes: 606561070
2025-03-13 14:42:18,740 [INFO]: 	avg_search_speed_ms: 9.649664395521162
2025-03-13 14:42:18,740 [INFO]: 	99p_search_speed_ms: 13.606745062861599
2025-03-13 14:42:18,740 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:18,740 [INFO]: 	nb vectors: 3083
2025-03-13 14:42:18,740 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:18,740 [INFO]: 	compression ratio: 0.9993098699855565
2025-03-13 14:42:18,740 [INFO]: }
2025-03-13 14:42:18,740 [INFO]: 	>>> Finished "Creating the index" in 60.1121 secs
2025-03-13 14:42:18,740 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1367 secs
2025-03-13 14:42:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 70058 [episode count 6/20]
[retrieval_preprocessing] for episode 4528 [episode count 7/20], we have num_retrieval=np.int64(3124) num_query=np.int64(139)
2025-03-13 14:42:21,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:23,415 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:23
2025-03-13 14:42:23,415 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-13 14:42:23,442 [INFO]: There are 3124 embeddings of dim 49152
2025-03-13 14:42:23,442 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 14:42:23,442 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:23
2025-03-13 14:42:23,442 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:23,442 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:42:23,442 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:23,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:23,442 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:23
2025-03-13 14:42:23,443 [INFO]: 644.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:23,443 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:42:23,443 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:23
2025-03-13 14:42:23,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:23,443 [INFO]: 	Creating the index 03/13/2025, 14:42:23
2025-03-13 14:42:23,443 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:23
2025-03-13 14:42:23,444 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:42:23,444 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:23
2025-03-13 14:42:23,445 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:42:23,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.78it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.34it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.43it/s] 31%|███       | 4/13 [00:00<00:01,  8.20it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.72it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.03it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.84it/s] 85%|████████▍ | 11/13 [00:01<00:00, 13.04it/s]100%|██████████| 13/13 [00:03<00:00,  2.35it/s]100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
2025-03-13 14:42:26,672 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:26
2025-03-13 14:43:02,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9387 secs
2025-03-13 14:43:02,611 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 14:43:02,611 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.77it/s]
2025-03-13 14:43:21,223 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6113 secs
2025-03-13 14:43:21,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7806 secs
2025-03-13 14:43:21,225 [INFO]: {
2025-03-13 14:43:21,225 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:21,225 [INFO]: 	index_param: efSearch=281
2025-03-13 14:43:21,225 [INFO]: 	index_path: knn.index
2025-03-13 14:43:21,225 [INFO]: 	size in bytes: 614627770
2025-03-13 14:43:21,225 [INFO]: 	avg_search_speed_ms: 11.28537333954092
2025-03-13 14:43:21,225 [INFO]: 	99p_search_speed_ms: 15.039876860100776
2025-03-13 14:43:21,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:21,225 [INFO]: 	nb vectors: 3124
2025-03-13 14:43:21,225 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:21,225 [INFO]: 	compression ratio: 0.9993095365671486
2025-03-13 14:43:21,225 [INFO]: }
2025-03-13 14:43:21,225 [INFO]: 	>>> Finished "Creating the index" in 57.7824 secs
2025-03-13 14:43:21,225 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8106 secs
2025-03-13 14:43:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 4528 [episode count 7/20]
[retrieval_preprocessing] for episode 41439 [episode count 8/20], we have num_retrieval=np.int64(3071) num_query=np.int64(192)
2025-03-13 14:43:23,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:24,320 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:24
2025-03-13 14:43:24,320 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1000.31it/s]
2025-03-13 14:43:24,342 [INFO]: There are 3071 embeddings of dim 49152
2025-03-13 14:43:24,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 14:43:24,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:24
2025-03-13 14:43:24,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:24,343 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:43:24,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:24,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:24,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:24
2025-03-13 14:43:24,343 [INFO]: 633.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:24,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:24,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:24
2025-03-13 14:43:24,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:24,343 [INFO]: 	Creating the index 03/13/2025, 14:43:24
2025-03-13 14:43:24,343 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:24
2025-03-13 14:43:24,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:43:24,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:24
2025-03-13 14:43:24,344 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:43:24,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.44it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.41it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.63it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.23it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.99it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.18it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.99it/s]100%|██████████| 13/13 [00:04<00:00,  1.38it/s]100%|██████████| 13/13 [00:04<00:00,  2.93it/s]
2025-03-13 14:43:28,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:28
2025-03-13 14:43:59,874 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0940 secs
2025-03-13 14:43:59,875 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 14:43:59,875 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 14:44:21,533 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6583 secs
2025-03-13 14:44:21,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1913 secs
2025-03-13 14:44:21,536 [INFO]: {
2025-03-13 14:44:21,536 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:21,536 [INFO]: 	index_param: efSearch=284
2025-03-13 14:44:21,536 [INFO]: 	index_path: knn.index
2025-03-13 14:44:21,536 [INFO]: 	size in bytes: 604200190
2025-03-13 14:44:21,536 [INFO]: 	avg_search_speed_ms: 11.251670217007415
2025-03-13 14:44:21,536 [INFO]: 	99p_search_speed_ms: 15.700752083212137
2025-03-13 14:44:21,536 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:21,536 [INFO]: 	nb vectors: 3071
2025-03-13 14:44:21,536 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:21,536 [INFO]: 	compression ratio: 0.9993097949869894
2025-03-13 14:44:21,536 [INFO]: }
2025-03-13 14:44:21,536 [INFO]: 	>>> Finished "Creating the index" in 57.1929 secs
2025-03-13 14:44:21,536 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2164 secs
2025-03-13 14:44:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 41439 [episode count 8/20]
[retrieval_preprocessing] for episode 86341 [episode count 9/20], we have num_retrieval=np.int64(3125) num_query=np.int64(138)
2025-03-13 14:44:24,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:25,416 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:25
2025-03-13 14:44:25,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.97it/s]
2025-03-13 14:44:25,443 [INFO]: There are 3125 embeddings of dim 49152
2025-03-13 14:44:25,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 14:44:25,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:25
2025-03-13 14:44:25,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:25,444 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:44:25,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:25,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:44:25,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:25
2025-03-13 14:44:25,445 [INFO]: 644.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:25,445 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:44:25,445 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:25
2025-03-13 14:44:25,445 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:25,445 [INFO]: 	Creating the index 03/13/2025, 14:44:25
2025-03-13 14:44:25,445 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:25
2025-03-13 14:44:25,449 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:44:25,449 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:25
2025-03-13 14:44:25,449 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:44:25,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.14it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.32it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.55it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.96it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.48it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.21it/s]100%|██████████| 13/13 [00:03<00:00,  2.42it/s]100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
2025-03-13 14:44:28,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:28
2025-03-13 14:45:02,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5952 secs
2025-03-13 14:45:02,163 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 14:45:02,163 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.56it/s] 50%|█████     | 2/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s]
2025-03-13 14:45:20,290 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1274 secs
2025-03-13 14:45:20,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8439 secs
2025-03-13 14:45:20,293 [INFO]: {
2025-03-13 14:45:20,293 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:20,293 [INFO]: 	index_param: efSearch=222
2025-03-13 14:45:20,293 [INFO]: 	index_path: knn.index
2025-03-13 14:45:20,293 [INFO]: 	size in bytes: 614824510
2025-03-13 14:45:20,293 [INFO]: 	avg_search_speed_ms: 10.189714050490055
2025-03-13 14:45:20,293 [INFO]: 	99p_search_speed_ms: 13.67903635837141
2025-03-13 14:45:20,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:20,293 [INFO]: 	nb vectors: 3125
2025-03-13 14:45:20,293 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:20,293 [INFO]: 	compression ratio: 0.9993095428157215
2025-03-13 14:45:20,293 [INFO]: }
2025-03-13 14:45:20,293 [INFO]: 	>>> Finished "Creating the index" in 54.8481 secs
2025-03-13 14:45:20,293 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8779 secs
2025-03-13 14:45:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 86341 [episode count 9/20]
[retrieval_preprocessing] for episode 82247 [episode count 10/20], we have num_retrieval=np.int64(3074) num_query=np.int64(189)
2025-03-13 14:45:23,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:23,856 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:23
2025-03-13 14:45:23,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-13 14:45:23,877 [INFO]: There are 3074 embeddings of dim 49152
2025-03-13 14:45:23,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0209 secs
2025-03-13 14:45:23,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:23
2025-03-13 14:45:23,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:23,878 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:45:23,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:23,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:23,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:23
2025-03-13 14:45:23,878 [INFO]: 634.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:23,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:45:23,878 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:23
2025-03-13 14:45:23,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:23,878 [INFO]: 	Creating the index 03/13/2025, 14:45:23
2025-03-13 14:45:23,878 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:23
2025-03-13 14:45:23,879 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:45:23,879 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:23
2025-03-13 14:45:23,879 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:45:23,879 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:07,  1.61it/s] 15%|█▌        | 2/13 [00:00<00:03,  3.15it/s] 31%|███       | 4/13 [00:00<00:01,  6.53it/s] 46%|████▌     | 6/13 [00:01<00:01,  3.59it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.03it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.66it/s]100%|██████████| 13/13 [00:04<00:00,  3.17it/s]
2025-03-13 14:45:27,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:27
2025-03-13 14:46:00,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9563 secs
2025-03-13 14:46:00,938 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 14:46:00,939 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.32it/s] 50%|█████     | 2/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.55it/s]
2025-03-13 14:46:26,086 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1473 secs
2025-03-13 14:46:26,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2098 secs
2025-03-13 14:46:26,089 [INFO]: {
2025-03-13 14:46:26,089 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:26,089 [INFO]: 	index_param: efSearch=256
2025-03-13 14:46:26,089 [INFO]: 	index_path: knn.index
2025-03-13 14:46:26,089 [INFO]: 	size in bytes: 604790410
2025-03-13 14:46:26,089 [INFO]: 	avg_search_speed_ms: 10.504957141027935
2025-03-13 14:46:26,089 [INFO]: 	99p_search_speed_ms: 19.024680024012927
2025-03-13 14:46:26,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:26,089 [INFO]: 	nb vectors: 3074
2025-03-13 14:46:26,089 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:26,089 [INFO]: 	compression ratio: 0.999309813791525
2025-03-13 14:46:26,089 [INFO]: }
2025-03-13 14:46:26,089 [INFO]: 	>>> Finished "Creating the index" in 62.2113 secs
2025-03-13 14:46:26,089 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2328 secs
2025-03-13 14:46:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 82247 [episode count 10/20]
[retrieval_preprocessing] for episode 29076 [episode count 11/20], we have num_retrieval=np.int64(3115) num_query=np.int64(148)
2025-03-13 14:46:31,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:32,254 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:32
2025-03-13 14:46:32,254 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.76it/s]
2025-03-13 14:46:32,281 [INFO]: There are 3115 embeddings of dim 49152
2025-03-13 14:46:32,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 14:46:32,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:32
2025-03-13 14:46:32,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:32,282 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:46:32,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:32,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:46:32,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:32
2025-03-13 14:46:32,282 [INFO]: 642.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:32,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:46:32,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:32
2025-03-13 14:46:32,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:32,282 [INFO]: 	Creating the index 03/13/2025, 14:46:32
2025-03-13 14:46:32,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:32
2025-03-13 14:46:32,284 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:46:32,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:32
2025-03-13 14:46:32,284 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:46:32,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.76it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.09it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.64it/s] 31%|███       | 4/13 [00:00<00:01,  7.07it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.37it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.78it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.93it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.77it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.60it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.47it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.41it/s]100%|██████████| 13/13 [00:04<00:00,  1.20it/s]100%|██████████| 13/13 [00:04<00:00,  3.17it/s]
2025-03-13 14:46:36,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:36
2025-03-13 14:47:13,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7955 secs
2025-03-13 14:47:13,184 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 14:47:13,184 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 14:47:32,706 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5218 secs
2025-03-13 14:47:32,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4244 secs
2025-03-13 14:47:32,709 [INFO]: {
2025-03-13 14:47:32,709 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:32,709 [INFO]: 	index_param: efSearch=271
2025-03-13 14:47:32,709 [INFO]: 	index_path: knn.index
2025-03-13 14:47:32,709 [INFO]: 	size in bytes: 612856930
2025-03-13 14:47:32,709 [INFO]: 	avg_search_speed_ms: 10.960909966103683
2025-03-13 14:47:32,709 [INFO]: 	99p_search_speed_ms: 21.310387533158035
2025-03-13 14:47:32,709 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:32,709 [INFO]: 	nb vectors: 3115
2025-03-13 14:47:32,709 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:32,709 [INFO]: 	compression ratio: 0.999309773653045
2025-03-13 14:47:32,709 [INFO]: }
2025-03-13 14:47:32,709 [INFO]: 	>>> Finished "Creating the index" in 60.4263 secs
2025-03-13 14:47:32,709 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4548 secs
2025-03-13 14:47:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 29076 [episode count 11/20]
[retrieval_preprocessing] for episode 29085 [episode count 12/20], we have num_retrieval=np.int64(3058) num_query=np.int64(205)
2025-03-13 14:47:35,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:36,073 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:36
2025-03-13 14:47:36,073 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1705.69it/s]
2025-03-13 14:47:36,099 [INFO]: There are 3058 embeddings of dim 49152
2025-03-13 14:47:36,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 14:47:36,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:36
2025-03-13 14:47:36,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:36,100 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:47:36,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:36,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:36,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:36
2025-03-13 14:47:36,100 [INFO]: 631.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:36,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:36,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:36
2025-03-13 14:47:36,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:36,100 [INFO]: 	Creating the index 03/13/2025, 14:47:36
2025-03-13 14:47:36,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:36
2025-03-13 14:47:36,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:47:36,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:36
2025-03-13 14:47:36,101 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:47:36,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.64it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.37it/s] 38%|███▊      | 5/13 [00:00<00:00, 13.10it/s] 54%|█████▍    | 7/13 [00:00<00:00, 14.03it/s] 69%|██████▉   | 9/13 [00:00<00:00, 14.51it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.76it/s]100%|██████████| 13/13 [00:03<00:00,  2.00it/s]100%|██████████| 13/13 [00:03<00:00,  3.66it/s]
2025-03-13 14:47:39,654 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:39
2025-03-13 14:48:17,836 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1816 secs
2025-03-13 14:48:17,836 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 14:48:17,837 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 14:48:35,145 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3082 secs
2025-03-13 14:48:35,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0457 secs
2025-03-13 14:48:35,147 [INFO]: {
2025-03-13 14:48:35,147 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:35,147 [INFO]: 	index_param: efSearch=276
2025-03-13 14:48:35,147 [INFO]: 	index_path: knn.index
2025-03-13 14:48:35,147 [INFO]: 	size in bytes: 601642510
2025-03-13 14:48:35,147 [INFO]: 	avg_search_speed_ms: 10.646543395210136
2025-03-13 14:48:35,147 [INFO]: 	99p_search_speed_ms: 14.773885414469987
2025-03-13 14:48:35,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:35,147 [INFO]: 	nb vectors: 3058
2025-03-13 14:48:35,147 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:35,147 [INFO]: 	compression ratio: 0.9993098127324813
2025-03-13 14:48:35,148 [INFO]: }
2025-03-13 14:48:35,148 [INFO]: 	>>> Finished "Creating the index" in 59.0474 secs
2025-03-13 14:48:35,148 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0742 secs
2025-03-13 14:48:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 29085 [episode count 12/20]
[retrieval_preprocessing] for episode 16884 [episode count 13/20], we have num_retrieval=np.int64(3116) num_query=np.int64(147)
2025-03-13 14:48:39,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:40,131 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:40
2025-03-13 14:48:40,131 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-13 14:48:40,154 [INFO]: There are 3116 embeddings of dim 49152
2025-03-13 14:48:40,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 14:48:40,155 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:40
2025-03-13 14:48:40,155 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:40,155 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:48:40,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:40,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:48:40,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:40
2025-03-13 14:48:40,155 [INFO]: 643.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:40,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:48:40,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:40
2025-03-13 14:48:40,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:40,155 [INFO]: 	Creating the index 03/13/2025, 14:48:40
2025-03-13 14:48:40,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:40
2025-03-13 14:48:40,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 14:48:40,157 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:40
2025-03-13 14:48:40,157 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:48:40,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.04it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.15it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.57it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.39it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.39it/s]100%|██████████| 13/13 [00:03<00:00,  2.12it/s]100%|██████████| 13/13 [00:03<00:00,  3.69it/s]
2025-03-13 14:48:43,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:43
2025-03-13 14:49:16,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9288 secs
2025-03-13 14:49:16,609 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 14:49:16,609 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 14:49:46,051 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4416 secs
2025-03-13 14:49:46,053 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8960 secs
2025-03-13 14:49:46,054 [INFO]: {
2025-03-13 14:49:46,054 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:46,054 [INFO]: 	index_param: efSearch=263
2025-03-13 14:49:46,054 [INFO]: 	index_path: knn.index
2025-03-13 14:49:46,054 [INFO]: 	size in bytes: 613053670
2025-03-13 14:49:46,054 [INFO]: 	avg_search_speed_ms: 9.858080402707325
2025-03-13 14:49:46,054 [INFO]: 	99p_search_speed_ms: 14.421147615648806
2025-03-13 14:49:46,054 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:46,054 [INFO]: 	nb vectors: 3116
2025-03-13 14:49:46,054 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:46,054 [INFO]: 	compression ratio: 0.999309779843582
2025-03-13 14:49:46,054 [INFO]: }
2025-03-13 14:49:46,054 [INFO]: 	>>> Finished "Creating the index" in 65.8984 secs
2025-03-13 14:49:46,054 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9231 secs
2025-03-13 14:49:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 16884 [episode count 13/20]
[retrieval_preprocessing] for episode 76761 [episode count 14/20], we have num_retrieval=np.int64(3103) num_query=np.int64(160)
2025-03-13 14:49:49,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:49,660 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:49
2025-03-13 14:49:49,660 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 14:49:49,688 [INFO]: There are 3103 embeddings of dim 49152
2025-03-13 14:49:49,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 14:49:49,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:49,688 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:49:49,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:49,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:49,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,688 [INFO]: 640.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:49,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:49:49,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:49
2025-03-13 14:49:49,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:49,688 [INFO]: 	Creating the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:49
2025-03-13 14:49:49,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:49:49,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:49
2025-03-13 14:49:49,690 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:49:49,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.57it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.17it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.65it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.30it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.76it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.43it/s]100%|██████████| 13/13 [00:03<00:00,  2.00it/s]100%|██████████| 13/13 [00:03<00:00,  3.53it/s]
2025-03-13 14:49:53,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:53
2025-03-13 14:50:28,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6395 secs
2025-03-13 14:50:28,012 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 14:50:28,012 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 50%|█████     | 2/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-13 14:50:45,777 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7650 secs
2025-03-13 14:50:45,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0903 secs
2025-03-13 14:50:45,780 [INFO]: {
2025-03-13 14:50:45,780 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:45,780 [INFO]: 	index_param: efSearch=204
2025-03-13 14:50:45,780 [INFO]: 	index_path: knn.index
2025-03-13 14:50:45,780 [INFO]: 	size in bytes: 610496050
2025-03-13 14:50:45,780 [INFO]: 	avg_search_speed_ms: 8.79402373685594
2025-03-13 14:50:45,780 [INFO]: 	99p_search_speed_ms: 14.026993643492482
2025-03-13 14:50:45,780 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:45,780 [INFO]: 	nb vectors: 3103
2025-03-13 14:50:45,780 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:45,780 [INFO]: 	compression ratio: 0.9993096990553829
2025-03-13 14:50:45,780 [INFO]: }
2025-03-13 14:50:45,780 [INFO]: 	>>> Finished "Creating the index" in 56.0920 secs
2025-03-13 14:50:45,780 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1207 secs
2025-03-13 14:50:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 76761 [episode count 14/20]
[retrieval_preprocessing] for episode 42205 [episode count 15/20], we have num_retrieval=np.int64(3067) num_query=np.int64(196)
2025-03-13 14:50:48,297 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:48,830 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:48
2025-03-13 14:50:48,831 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 849.05it/s]
2025-03-13 14:50:48,856 [INFO]: There are 3067 embeddings of dim 49152
2025-03-13 14:50:48,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 14:50:48,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:48
2025-03-13 14:50:48,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:48,857 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:50:48,857 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:48,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:48,857 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:48
2025-03-13 14:50:48,857 [INFO]: 633.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:48,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:50:48,857 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:48
2025-03-13 14:50:48,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:48,857 [INFO]: 	Creating the index 03/13/2025, 14:50:48
2025-03-13 14:50:48,857 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:48
2025-03-13 14:50:48,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:50:48,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:48
2025-03-13 14:50:48,858 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:50:48,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.12it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.91it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.51it/s] 31%|███       | 4/13 [00:00<00:01,  7.57it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.63it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.65it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.64it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.67it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.87it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.99it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.06it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.33it/s]100%|██████████| 13/13 [00:04<00:00,  1.08it/s]100%|██████████| 13/13 [00:04<00:00,  3.00it/s]
2025-03-13 14:50:53,193 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:53
2025-03-13 14:51:26,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2809 secs
2025-03-13 14:51:26,474 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 14:51:26,474 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 14:51:46,715 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2405 secs
2025-03-13 14:51:46,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8595 secs
2025-03-13 14:51:46,718 [INFO]: {
2025-03-13 14:51:46,718 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:46,718 [INFO]: 	index_param: efSearch=240
2025-03-13 14:51:46,718 [INFO]: 	index_path: knn.index
2025-03-13 14:51:46,718 [INFO]: 	size in bytes: 603413230
2025-03-13 14:51:46,718 [INFO]: 	avg_search_speed_ms: 10.442426872472735
2025-03-13 14:51:46,718 [INFO]: 	99p_search_speed_ms: 18.92538609681651
2025-03-13 14:51:46,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:46,718 [INFO]: 	nb vectors: 3067
2025-03-13 14:51:46,718 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:46,718 [INFO]: 	compression ratio: 0.9993097698570513
2025-03-13 14:51:46,718 [INFO]: }
2025-03-13 14:51:46,718 [INFO]: 	>>> Finished "Creating the index" in 57.8609 secs
2025-03-13 14:51:46,718 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8872 secs
2025-03-13 14:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 42205 [episode count 15/20]
[retrieval_preprocessing] for episode 31973 [episode count 16/20], we have num_retrieval=np.int64(3104) num_query=np.int64(159)
2025-03-13 14:51:50,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:51,055 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:51
2025-03-13 14:51:51,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2616.53it/s]
2025-03-13 14:51:51,077 [INFO]: There are 3104 embeddings of dim 49152
2025-03-13 14:51:51,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 14:51:51,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:51
2025-03-13 14:51:51,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:51,077 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:51:51,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:51,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:51:51,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:51
2025-03-13 14:51:51,077 [INFO]: 640.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:51,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:51:51,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:51
2025-03-13 14:51:51,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:51,077 [INFO]: 	Creating the index 03/13/2025, 14:51:51
2025-03-13 14:51:51,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:51
2025-03-13 14:51:51,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:51:51,079 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:51
2025-03-13 14:51:51,079 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:51:51,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.88it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.65it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.45it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.54it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.13it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.21it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.02it/s]100%|██████████| 13/13 [00:03<00:00,  1.88it/s]100%|██████████| 13/13 [00:03<00:00,  3.34it/s]
2025-03-13 14:51:54,969 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:54
2025-03-13 14:52:25,507 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5380 secs
2025-03-13 14:52:25,508 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 14:52:25,508 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 14:52:44,066 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5578 secs
2025-03-13 14:52:44,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9902 secs
2025-03-13 14:52:44,069 [INFO]: {
2025-03-13 14:52:44,069 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:44,069 [INFO]: 	index_param: efSearch=190
2025-03-13 14:52:44,069 [INFO]: 	index_path: knn.index
2025-03-13 14:52:44,069 [INFO]: 	size in bytes: 610692790
2025-03-13 14:52:44,069 [INFO]: 	avg_search_speed_ms: 10.753320621436723
2025-03-13 14:52:44,069 [INFO]: 	99p_search_speed_ms: 23.358294507488612
2025-03-13 14:52:44,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:44,069 [INFO]: 	nb vectors: 3104
2025-03-13 14:52:44,069 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:44,069 [INFO]: 	compression ratio: 0.9993097052938843
2025-03-13 14:52:44,069 [INFO]: }
2025-03-13 14:52:44,070 [INFO]: 	>>> Finished "Creating the index" in 52.9920 secs
2025-03-13 14:52:44,070 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0147 secs
2025-03-13 14:52:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 31973 [episode count 16/20]
[retrieval_preprocessing] for episode 58600 [episode count 17/20], we have num_retrieval=np.int64(3124) num_query=np.int64(139)
2025-03-13 14:52:46,872 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:47,403 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:47
2025-03-13 14:52:47,403 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1051.47it/s]
2025-03-13 14:52:47,428 [INFO]: There are 3124 embeddings of dim 49152
2025-03-13 14:52:47,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 14:52:47,428 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:47
2025-03-13 14:52:47,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:47,428 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:52:47,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:47,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:47,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:47
2025-03-13 14:52:47,429 [INFO]: 644.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:47,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:52:47,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:47
2025-03-13 14:52:47,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:47,429 [INFO]: 	Creating the index 03/13/2025, 14:52:47
2025-03-13 14:52:47,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:47
2025-03-13 14:52:47,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:52:47,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:47
2025-03-13 14:52:47,430 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:52:47,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.36it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.77it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.78it/s] 31%|███       | 4/13 [00:00<00:01,  8.19it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.52it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.78it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.85it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.86it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.85it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.05it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.52it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.87it/s]100%|██████████| 13/13 [00:04<00:00,  1.10s/it]100%|██████████| 13/13 [00:04<00:00,  2.63it/s]
2025-03-13 14:52:52,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:52
2025-03-13 14:53:25,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1497 secs
2025-03-13 14:53:25,522 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 14:53:25,522 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 14:53:48,954 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4321 secs
2025-03-13 14:53:48,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5276 secs
2025-03-13 14:53:48,958 [INFO]: {
2025-03-13 14:53:48,958 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:48,958 [INFO]: 	index_param: efSearch=167
2025-03-13 14:53:48,958 [INFO]: 	index_path: knn.index
2025-03-13 14:53:48,958 [INFO]: 	size in bytes: 614627770
2025-03-13 14:53:48,958 [INFO]: 	avg_search_speed_ms: 8.113284706434404
2025-03-13 14:53:48,958 [INFO]: 	99p_search_speed_ms: 12.392743162345152
2025-03-13 14:53:48,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:48,958 [INFO]: 	nb vectors: 3124
2025-03-13 14:53:48,958 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:48,958 [INFO]: 	compression ratio: 0.9993095365671486
2025-03-13 14:53:48,958 [INFO]: }
2025-03-13 14:53:48,958 [INFO]: 	>>> Finished "Creating the index" in 61.5292 secs
2025-03-13 14:53:48,958 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5553 secs
2025-03-13 14:53:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 58600 [episode count 17/20]
[retrieval_preprocessing] for episode 48383 [episode count 18/20], we have num_retrieval=np.int64(3130) num_query=np.int64(133)
2025-03-13 14:53:51,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:51,845 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:51
2025-03-13 14:53:51,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1282.66it/s]
2025-03-13 14:53:51,869 [INFO]: There are 3130 embeddings of dim 49152
2025-03-13 14:53:51,869 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 14:53:51,869 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:51
2025-03-13 14:53:51,869 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:51,869 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:53:51,869 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:51,869 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:51,869 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:51
2025-03-13 14:53:51,869 [INFO]: 646.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:51,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:51,869 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:51
2025-03-13 14:53:51,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:51,869 [INFO]: 	Creating the index 03/13/2025, 14:53:51
2025-03-13 14:53:51,870 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:51
2025-03-13 14:53:51,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:53:51,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:51
2025-03-13 14:53:51,871 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:53:51,871 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.47it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.15it/s] 31%|███       | 4/13 [00:00<00:01,  8.39it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.80it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.47it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.65it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.45it/s]100%|██████████| 13/13 [00:03<00:00,  1.84it/s]100%|██████████| 13/13 [00:03<00:00,  3.68it/s]
2025-03-13 14:53:55,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:55
2025-03-13 14:54:34,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8072 secs
2025-03-13 14:54:34,211 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 14:54:34,211 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 14:54:50,697 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4867 secs
2025-03-13 14:54:50,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8296 secs
2025-03-13 14:54:50,700 [INFO]: {
2025-03-13 14:54:50,700 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:50,700 [INFO]: 	index_param: efSearch=249
2025-03-13 14:54:50,700 [INFO]: 	index_path: knn.index
2025-03-13 14:54:50,700 [INFO]: 	size in bytes: 615808210
2025-03-13 14:54:50,700 [INFO]: 	avg_search_speed_ms: 10.301801056651941
2025-03-13 14:54:50,700 [INFO]: 	99p_search_speed_ms: 16.77550664171576
2025-03-13 14:54:50,700 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:50,700 [INFO]: 	nb vectors: 3130
2025-03-13 14:54:50,700 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:50,700 [INFO]: 	compression ratio: 0.9993095739986968
2025-03-13 14:54:50,700 [INFO]: }
2025-03-13 14:54:50,700 [INFO]: 	>>> Finished "Creating the index" in 58.8310 secs
2025-03-13 14:54:50,701 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8556 secs
2025-03-13 14:54:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 48383 [episode count 18/20]
[retrieval_preprocessing] for episode 73405 [episode count 19/20], we have num_retrieval=np.int64(3111) num_query=np.int64(152)
2025-03-13 14:54:55,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:55,972 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:55
2025-03-13 14:54:55,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1956.30it/s]
2025-03-13 14:54:56,005 [INFO]: There are 3111 embeddings of dim 49152
2025-03-13 14:54:56,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 14:54:56,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:56
2025-03-13 14:54:56,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:56,006 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 14:54:56,006 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:56,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:54:56,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:56
2025-03-13 14:54:56,006 [INFO]: 642.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:56,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:54:56,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:56
2025-03-13 14:54:56,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:56,007 [INFO]: 	Creating the index 03/13/2025, 14:54:56
2025-03-13 14:54:56,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:56
2025-03-13 14:54:56,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 14:54:56,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:56
2025-03-13 14:54:56,009 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 14:54:56,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.73it/s] 15%|█▌        | 2/13 [00:00<00:02,  5.49it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.54it/s] 31%|███       | 4/13 [00:00<00:01,  7.38it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.86it/s] 62%|██████▏   | 8/13 [00:00<00:00, 11.01it/s] 77%|███████▋  | 10/13 [00:05<00:02,  1.00it/s] 85%|████████▍ | 11/13 [00:10<00:03,  1.89s/it] 92%|█████████▏| 12/13 [00:15<00:02,  2.57s/it]100%|██████████| 13/13 [00:17<00:00,  2.45s/it]100%|██████████| 13/13 [00:17<00:00,  1.37s/it]
2025-03-13 14:55:13,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:13
2025-03-13 14:55:56,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6645 secs
2025-03-13 14:55:56,547 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 14:55:56,547 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:13,  4.64s/it] 50%|█████     | 2/4 [00:07<00:06,  3.50s/it] 75%|███████▌  | 3/4 [00:08<00:02,  2.30s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.98s/it]
2025-03-13 14:56:41,045 [INFO]: 	>>> Finished "Compute fast metrics" in 44.4982 secs
2025-03-13 14:56:41,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.0485 secs
2025-03-13 14:56:41,057 [INFO]: {
2025-03-13 14:56:41,057 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:41,057 [INFO]: 	index_param: efSearch=216
2025-03-13 14:56:41,057 [INFO]: 	index_path: knn.index
2025-03-13 14:56:41,058 [INFO]: 	size in bytes: 612069970
2025-03-13 14:56:41,058 [INFO]: 	avg_search_speed_ms: 9.43311476302421
2025-03-13 14:56:41,058 [INFO]: 	99p_search_speed_ms: 13.35773842176423
2025-03-13 14:56:41,058 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:41,058 [INFO]: 	nb vectors: 3111
2025-03-13 14:56:41,058 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:41,058 [INFO]: 	compression ratio: 0.9993097488510995
2025-03-13 14:56:41,058 [INFO]: }
2025-03-13 14:56:41,058 [INFO]: 	>>> Finished "Creating the index" in 105.0510 secs
2025-03-13 14:56:41,058 [INFO]: >>> Finished "Launching the whole pipeline" in 105.0859 secs
2025-03-13 14:56:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 73405 [episode count 19/20]
2025-03-13 14:56:42: [retrieval_preprocessing] finished for 8376714657_put_pen_in_bowl [chosen_id count 0/196]
2025-03-13 14:56:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_put_marker_in_grey_bowl [chosen_id count 1/196]
2025-03-13 14:56:49: [retrieval_preprocessing] we have num_total=3124 embedding_dim=49152
[retrieval_preprocessing] for episode 43026 [episode count 0/20], we have num_retrieval=np.int64(2996) num_query=np.int64(128)
2025-03-13 14:56:57,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:57,736 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:57
2025-03-13 14:56:57,737 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.76it/s]
2025-03-13 14:56:57,767 [INFO]: There are 2996 embeddings of dim 49152
2025-03-13 14:56:57,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 14:56:57,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:57
2025-03-13 14:56:57,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:57,767 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:56:57,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:57,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:56:57,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:57
2025-03-13 14:56:57,767 [INFO]: 618.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:57,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:56:57,768 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:57
2025-03-13 14:56:57,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:57,768 [INFO]: 	Creating the index 03/13/2025, 14:56:57
2025-03-13 14:56:57,768 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:57
2025-03-13 14:56:57,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:56:57,769 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:57
2025-03-13 14:56:57,769 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:56:57,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  3.70it/s] 17%|█▋        | 2/12 [00:00<00:02,  4.59it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.13it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.65it/s] 42%|████▏     | 5/12 [00:00<00:01,  5.79it/s] 50%|█████     | 6/12 [00:01<00:01,  5.88it/s] 58%|█████▊    | 7/12 [00:01<00:00,  5.68it/s] 67%|██████▋   | 8/12 [00:01<00:00,  5.59it/s] 75%|███████▌  | 9/12 [00:01<00:00,  5.55it/s] 83%|████████▎ | 10/12 [00:01<00:00,  5.68it/s] 92%|█████████▏| 11/12 [00:01<00:00,  6.16it/s]100%|██████████| 12/12 [00:04<00:00,  1.12it/s]100%|██████████| 12/12 [00:04<00:00,  2.66it/s]
2025-03-13 14:57:02,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:02
2025-03-13 14:57:50,158 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8643 secs
2025-03-13 14:57:50,158 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 14:57:50,158 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 14:58:13,720 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5620 secs
2025-03-13 14:58:13,723 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9537 secs
2025-03-13 14:58:13,723 [INFO]: {
2025-03-13 14:58:13,723 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:13,723 [INFO]: 	index_param: efSearch=221
2025-03-13 14:58:13,723 [INFO]: 	index_path: knn.index
2025-03-13 14:58:13,723 [INFO]: 	size in bytes: 589444450
2025-03-13 14:58:13,723 [INFO]: 	avg_search_speed_ms: 11.125982803260458
2025-03-13 14:58:13,723 [INFO]: 	99p_search_speed_ms: 21.340718981809907
2025-03-13 14:58:13,723 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:13,723 [INFO]: 	nb vectors: 2996
2025-03-13 14:58:13,723 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:13,723 [INFO]: 	compression ratio: 0.9993097195164022
2025-03-13 14:58:13,723 [INFO]: }
2025-03-13 14:58:13,723 [INFO]: 	>>> Finished "Creating the index" in 75.9556 secs
2025-03-13 14:58:13,723 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9867 secs
2025-03-13 14:58:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 43026 [episode count 0/20]
[retrieval_preprocessing] for episode 67609 [episode count 1/20], we have num_retrieval=np.int64(2994) num_query=np.int64(130)
2025-03-13 14:58:15,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:16,555 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:16
2025-03-13 14:58:16,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 874.36it/s]
2025-03-13 14:58:16,586 [INFO]: There are 2994 embeddings of dim 49152
2025-03-13 14:58:16,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 14:58:16,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:16,587 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:58:16,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:16,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:58:16,588 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,588 [INFO]: 617.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:16,588 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:58:16,588 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:16
2025-03-13 14:58:16,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:16,589 [INFO]: 	Creating the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,589 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:16
2025-03-13 14:58:16,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 14:58:16,593 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:16
2025-03-13 14:58:16,593 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:58:16,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.54it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.36it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.17it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.57it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.66it/s] 50%|█████     | 6/12 [00:00<00:00,  8.48it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.51it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.21it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.24it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.23it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.30it/s]100%|██████████| 12/12 [00:05<00:00,  1.24s/it]100%|██████████| 12/12 [00:05<00:00,  2.34it/s]
2025-03-13 14:58:21,741 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:21
2025-03-13 14:58:57,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7808 secs
2025-03-13 14:58:57,522 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 14:58:57,523 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-13 14:59:24,134 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6110 secs
2025-03-13 14:59:24,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5433 secs
2025-03-13 14:59:24,136 [INFO]: {
2025-03-13 14:59:24,137 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:24,137 [INFO]: 	index_param: efSearch=139
2025-03-13 14:59:24,137 [INFO]: 	index_path: knn.index
2025-03-13 14:59:24,137 [INFO]: 	size in bytes: 589050970
2025-03-13 14:59:24,137 [INFO]: 	avg_search_speed_ms: 7.754483563309612
2025-03-13 14:59:24,137 [INFO]: 	99p_search_speed_ms: 14.1698797792196
2025-03-13 14:59:24,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:24,137 [INFO]: 	nb vectors: 2994
2025-03-13 14:59:24,137 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:24,137 [INFO]: 	compression ratio: 0.9993097065946602
2025-03-13 14:59:24,137 [INFO]: }
2025-03-13 14:59:24,137 [INFO]: 	>>> Finished "Creating the index" in 67.5477 secs
2025-03-13 14:59:24,137 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5812 secs
2025-03-13 14:59:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67609 [episode count 1/20]
[retrieval_preprocessing] for episode 69665 [episode count 2/20], we have num_retrieval=np.int64(2968) num_query=np.int64(156)
2025-03-13 14:59:25,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:26,248 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:26
2025-03-13 14:59:26,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1052.26it/s]
2025-03-13 14:59:26,278 [INFO]: There are 2968 embeddings of dim 49152
2025-03-13 14:59:26,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 14:59:26,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:26
2025-03-13 14:59:26,279 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:26,279 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 14:59:26,279 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:26,279 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:59:26,279 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:26
2025-03-13 14:59:26,280 [INFO]: 612.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:26,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:59:26,280 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:26
2025-03-13 14:59:26,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:26,280 [INFO]: 	Creating the index 03/13/2025, 14:59:26
2025-03-13 14:59:26,280 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:26
2025-03-13 14:59:26,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:59:26,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:26
2025-03-13 14:59:26,284 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:59:26,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.58it/s] 25%|██▌       | 3/12 [00:00<00:00, 11.12it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.03it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.44it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.38it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.96it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.38it/s]100%|██████████| 12/12 [00:03<00:00,  1.28it/s]100%|██████████| 12/12 [00:03<00:00,  3.04it/s]
2025-03-13 14:59:30,244 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:30
2025-03-13 15:00:05,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1238 secs
2025-03-13 15:00:05,369 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 15:00:05,369 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.14s/it] 50%|█████     | 2/4 [00:02<00:02,  1.23s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.18it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.04it/s]
2025-03-13 15:00:27,509 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1398 secs
2025-03-13 15:00:27,513 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2288 secs
2025-03-13 15:00:27,514 [INFO]: {
2025-03-13 15:00:27,514 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:27,514 [INFO]: 	index_param: efSearch=260
2025-03-13 15:00:27,514 [INFO]: 	index_path: knn.index
2025-03-13 15:00:27,514 [INFO]: 	size in bytes: 583935670
2025-03-13 15:00:27,515 [INFO]: 	avg_search_speed_ms: 10.975732581544786
2025-03-13 15:00:27,515 [INFO]: 	99p_search_speed_ms: 19.67996340245008
2025-03-13 15:00:27,515 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:27,515 [INFO]: 	nb vectors: 2968
2025-03-13 15:00:27,515 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:27,515 [INFO]: 	compression ratio: 0.9993096397074013
2025-03-13 15:00:27,515 [INFO]: }
2025-03-13 15:00:27,515 [INFO]: 	>>> Finished "Creating the index" in 61.2345 secs
2025-03-13 15:00:27,515 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2671 secs
2025-03-13 15:00:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 69665 [episode count 2/20]
[retrieval_preprocessing] for episode 63634 [episode count 3/20], we have num_retrieval=np.int64(2947) num_query=np.int64(177)
2025-03-13 15:00:29,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:30,182 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:30
2025-03-13 15:00:30,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2045.00it/s]
2025-03-13 15:00:30,208 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 15:00:30,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:00:30,209 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:30,209 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:00:30,209 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:30,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:00:30,210 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,210 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:30,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:00:30,210 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:30
2025-03-13 15:00:30,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:30,211 [INFO]: 	Creating the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:30
2025-03-13 15:00:30,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:00:30,214 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:30
2025-03-13 15:00:30,215 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:00:30,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.95it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.20it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.78it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.77it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.47it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.38it/s]100%|██████████| 12/12 [00:03<00:00,  3.36it/s]
2025-03-13 15:00:33,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:33
2025-03-13 15:01:07,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3225 secs
2025-03-13 15:01:07,119 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 15:01:07,119 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.27s/it] 50%|█████     | 2/4 [00:01<00:01,  1.11it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.80it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.35it/s]
2025-03-13 15:01:27,712 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5929 secs
2025-03-13 15:01:27,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5005 secs
2025-03-13 15:01:27,715 [INFO]: {
2025-03-13 15:01:27,715 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:27,715 [INFO]: 	index_param: efSearch=201
2025-03-13 15:01:27,715 [INFO]: 	index_path: knn.index
2025-03-13 15:01:27,715 [INFO]: 	size in bytes: 579803950
2025-03-13 15:01:27,715 [INFO]: 	avg_search_speed_ms: 9.022214350968074
2025-03-13 15:01:27,715 [INFO]: 	99p_search_speed_ms: 11.828180935699493
2025-03-13 15:01:27,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:27,715 [INFO]: 	nb vectors: 2947
2025-03-13 15:01:27,715 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:27,715 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 15:01:27,715 [INFO]: }
2025-03-13 15:01:27,715 [INFO]: 	>>> Finished "Creating the index" in 57.5047 secs
2025-03-13 15:01:27,715 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5338 secs
2025-03-13 15:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 63634 [episode count 3/20]
[retrieval_preprocessing] for episode 53758 [episode count 4/20], we have num_retrieval=np.int64(2947) num_query=np.int64(177)
2025-03-13 15:01:30,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:30,903 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:30
2025-03-13 15:01:30,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2166.48it/s]
2025-03-13 15:01:30,929 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 15:01:30,929 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:01:30,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:30,930 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:01:30,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:30,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:01:30,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,931 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:30,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:01:30,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:30
2025-03-13 15:01:30,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:30,932 [INFO]: 	Creating the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:30
2025-03-13 15:01:30,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:01:30,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:30
2025-03-13 15:01:30,935 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:01:30,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.93it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.47it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.11it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.74it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.89it/s] 50%|█████     | 6/12 [00:00<00:00,  8.05it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.95it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.70it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.52it/s] 83%|████████▎ | 10/12 [00:01<00:00,  6.86it/s] 92%|█████████▏| 11/12 [00:01<00:00,  5.52it/s]100%|██████████| 12/12 [00:04<00:00,  1.09it/s]100%|██████████| 12/12 [00:04<00:00,  2.82it/s]
2025-03-13 15:01:35,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:35
2025-03-13 15:02:05,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6222 secs
2025-03-13 15:02:05,812 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 15:02:05,813 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
2025-03-13 15:02:33,949 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1362 secs
2025-03-13 15:02:33,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0171 secs
2025-03-13 15:02:33,952 [INFO]: {
2025-03-13 15:02:33,952 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:33,952 [INFO]: 	index_param: efSearch=279
2025-03-13 15:02:33,952 [INFO]: 	index_path: knn.index
2025-03-13 15:02:33,952 [INFO]: 	size in bytes: 579803950
2025-03-13 15:02:33,953 [INFO]: 	avg_search_speed_ms: 12.266529158474512
2025-03-13 15:02:33,953 [INFO]: 	99p_search_speed_ms: 19.992259133141502
2025-03-13 15:02:33,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:33,953 [INFO]: 	nb vectors: 2947
2025-03-13 15:02:33,953 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:33,953 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 15:02:33,953 [INFO]: }
2025-03-13 15:02:33,953 [INFO]: 	>>> Finished "Creating the index" in 63.0209 secs
2025-03-13 15:02:33,953 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0496 secs
2025-03-13 15:02:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 53758 [episode count 4/20]
[retrieval_preprocessing] for episode 14847 [episode count 5/20], we have num_retrieval=np.int64(2948) num_query=np.int64(176)
2025-03-13 15:02:37,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:38,449 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:38
2025-03-13 15:02:38,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.86it/s]
2025-03-13 15:02:38,477 [INFO]: There are 2948 embeddings of dim 49152
2025-03-13 15:02:38,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:02:38,477 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:38
2025-03-13 15:02:38,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:38,478 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:02:38,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:38,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:02:38,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:38
2025-03-13 15:02:38,478 [INFO]: 608.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:38,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:02:38,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:38
2025-03-13 15:02:38,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:38,480 [INFO]: 	Creating the index 03/13/2025, 15:02:38
2025-03-13 15:02:38,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:38
2025-03-13 15:02:38,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:02:38,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:38
2025-03-13 15:02:38,485 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:02:38,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.64it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.28it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.92it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.30it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.41it/s] 50%|█████     | 6/12 [00:00<00:00,  8.52it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.55it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.10it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.25it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.23it/s]100%|██████████| 12/12 [00:03<00:00,  1.42it/s]100%|██████████| 12/12 [00:03<00:00,  3.35it/s]
2025-03-13 15:02:42,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:42
2025-03-13 15:03:16,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5401 secs
2025-03-13 15:03:16,612 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 15:03:16,612 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.77it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 15:03:39,752 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1395 secs
2025-03-13 15:03:39,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2698 secs
2025-03-13 15:03:39,755 [INFO]: {
2025-03-13 15:03:39,755 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:39,755 [INFO]: 	index_param: efSearch=290
2025-03-13 15:03:39,755 [INFO]: 	index_path: knn.index
2025-03-13 15:03:39,755 [INFO]: 	size in bytes: 580000690
2025-03-13 15:03:39,755 [INFO]: 	avg_search_speed_ms: 12.179098535276923
2025-03-13 15:03:39,755 [INFO]: 	99p_search_speed_ms: 21.342277433723197
2025-03-13 15:03:39,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:39,755 [INFO]: 	nb vectors: 2948
2025-03-13 15:03:39,755 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:39,755 [INFO]: 	compression ratio: 0.9993098180624578
2025-03-13 15:03:39,755 [INFO]: }
2025-03-13 15:03:39,755 [INFO]: 	>>> Finished "Creating the index" in 61.2743 secs
2025-03-13 15:03:39,755 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3061 secs
2025-03-13 15:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 14847 [episode count 5/20]
[retrieval_preprocessing] for episode 82480 [episode count 6/20], we have num_retrieval=np.int64(2998) num_query=np.int64(126)
2025-03-13 15:03:43,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:43,767 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:43
2025-03-13 15:03:43,767 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1753.47it/s]
2025-03-13 15:03:43,789 [INFO]: There are 2998 embeddings of dim 49152
2025-03-13 15:03:43,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 15:03:43,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:43,789 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:03:43,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:43,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:03:43,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,790 [INFO]: 618.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:43,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:03:43,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:43
2025-03-13 15:03:43,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:43,790 [INFO]: 	Creating the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:43
2025-03-13 15:03:43,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:03:43,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:43
2025-03-13 15:03:43,792 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:03:43,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.58it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.40it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.58it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.13it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.03it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.11it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.06it/s]100%|██████████| 12/12 [00:03<00:00,  1.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.07it/s]
2025-03-13 15:03:47,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:47
2025-03-13 15:04:29,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3453 secs
2025-03-13 15:04:29,053 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 15:04:29,053 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-13 15:04:47,732 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6786 secs
2025-03-13 15:04:47,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9433 secs
2025-03-13 15:04:47,735 [INFO]: {
2025-03-13 15:04:47,735 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:47,735 [INFO]: 	index_param: efSearch=240
2025-03-13 15:04:47,735 [INFO]: 	index_path: knn.index
2025-03-13 15:04:47,735 [INFO]: 	size in bytes: 589837930
2025-03-13 15:04:47,735 [INFO]: 	avg_search_speed_ms: 10.423091764399652
2025-03-13 15:04:47,735 [INFO]: 	99p_search_speed_ms: 15.01110168173909
2025-03-13 15:04:47,735 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:47,735 [INFO]: 	nb vectors: 2998
2025-03-13 15:04:47,735 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:47,735 [INFO]: 	compression ratio: 0.9993097324209042
2025-03-13 15:04:47,735 [INFO]: }
2025-03-13 15:04:47,735 [INFO]: 	>>> Finished "Creating the index" in 63.9453 secs
2025-03-13 15:04:47,735 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9679 secs
2025-03-13 15:04:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 82480 [episode count 6/20]
[retrieval_preprocessing] for episode 60006 [episode count 7/20], we have num_retrieval=np.int64(2957) num_query=np.int64(167)
2025-03-13 15:04:53,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:53,500 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:53
2025-03-13 15:04:53,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.05it/s]
2025-03-13 15:04:53,526 [INFO]: There are 2957 embeddings of dim 49152
2025-03-13 15:04:53,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:04:53,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:53
2025-03-13 15:04:53,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:53,526 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:04:53,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:53,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:53,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:53
2025-03-13 15:04:53,526 [INFO]: 610.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:53,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:04:53,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:53
2025-03-13 15:04:53,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:53,526 [INFO]: 	Creating the index 03/13/2025, 15:04:53
2025-03-13 15:04:53,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:53
2025-03-13 15:04:53,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:04:53,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:53
2025-03-13 15:04:53,528 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:04:53,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.52it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.35it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.75it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.82it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.04it/s] 50%|█████     | 6/12 [00:01<00:00,  6.11it/s] 58%|█████▊    | 7/12 [00:01<00:00,  6.11it/s] 67%|██████▋   | 8/12 [00:01<00:00,  6.33it/s] 75%|███████▌  | 9/12 [00:01<00:00,  6.77it/s] 83%|████████▎ | 10/12 [00:01<00:00,  6.85it/s] 92%|█████████▏| 11/12 [00:01<00:00,  6.76it/s]100%|██████████| 12/12 [00:03<00:00,  1.36it/s]100%|██████████| 12/12 [00:03<00:00,  3.12it/s]
2025-03-13 15:04:57,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:57
2025-03-13 15:05:37,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6469 secs
2025-03-13 15:05:37,021 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:05:37,021 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s]
2025-03-13 15:05:58,183 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1618 secs
2025-03-13 15:05:58,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6573 secs
2025-03-13 15:05:58,185 [INFO]: {
2025-03-13 15:05:58,185 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:58,185 [INFO]: 	index_param: efSearch=229
2025-03-13 15:05:58,185 [INFO]: 	index_path: knn.index
2025-03-13 15:05:58,185 [INFO]: 	size in bytes: 581771470
2025-03-13 15:05:58,185 [INFO]: 	avg_search_speed_ms: 9.698895472630308
2025-03-13 15:05:58,185 [INFO]: 	99p_search_speed_ms: 14.495635800994934
2025-03-13 15:05:58,185 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:58,185 [INFO]: 	nb vectors: 2957
2025-03-13 15:05:58,185 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:58,185 [INFO]: 	compression ratio: 0.99930967051375
2025-03-13 15:05:58,186 [INFO]: }
2025-03-13 15:05:58,186 [INFO]: 	>>> Finished "Creating the index" in 64.6590 secs
2025-03-13 15:05:58,186 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6851 secs
2025-03-13 15:05:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 60006 [episode count 7/20]
[retrieval_preprocessing] for episode 39552 [episode count 8/20], we have num_retrieval=np.int64(2935) num_query=np.int64(189)
2025-03-13 15:06:01,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:01,620 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:01
2025-03-13 15:06:01,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 963.54it/s]
2025-03-13 15:06:01,647 [INFO]: There are 2935 embeddings of dim 49152
2025-03-13 15:06:01,647 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:06:01,647 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,647 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:01,647 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:06:01,647 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:01,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:01,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,647 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:01,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:06:01,648 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:01
2025-03-13 15:06:01,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:01,648 [INFO]: 	Creating the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,648 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:01
2025-03-13 15:06:01,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:06:01,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:01
2025-03-13 15:06:01,649 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:06:01,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.89it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.63it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.65it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.33it/s] 50%|█████     | 6/12 [00:00<00:00,  9.36it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.38it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.37it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.41it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.50it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.40it/s]100%|██████████| 12/12 [00:03<00:00,  1.46it/s]100%|██████████| 12/12 [00:03<00:00,  3.64it/s]
2025-03-13 15:06:04,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:04
2025-03-13 15:06:39,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0700 secs
2025-03-13 15:06:39,016 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 15:06:39,016 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-13 15:07:08,309 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2933 secs
2025-03-13 15:07:08,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6627 secs
2025-03-13 15:07:08,312 [INFO]: {
2025-03-13 15:07:08,312 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:08,312 [INFO]: 	index_param: efSearch=261
2025-03-13 15:07:08,312 [INFO]: 	index_path: knn.index
2025-03-13 15:07:08,312 [INFO]: 	size in bytes: 577443070
2025-03-13 15:07:08,312 [INFO]: 	avg_search_speed_ms: 10.161749142878953
2025-03-13 15:07:08,312 [INFO]: 	99p_search_speed_ms: 13.078537457622588
2025-03-13 15:07:08,312 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:08,312 [INFO]: 	nb vectors: 2935
2025-03-13 15:07:08,312 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:08,312 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-13 15:07:08,312 [INFO]: }
2025-03-13 15:07:08,312 [INFO]: 	>>> Finished "Creating the index" in 66.6644 secs
2025-03-13 15:07:08,312 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6914 secs
2025-03-13 15:07:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 39552 [episode count 8/20]
[retrieval_preprocessing] for episode 90759 [episode count 9/20], we have num_retrieval=np.int64(2987) num_query=np.int64(137)
2025-03-13 15:07:12,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:12,670 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:12
2025-03-13 15:07:12,670 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.44it/s]
2025-03-13 15:07:12,696 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 15:07:12,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:07:12,696 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:12
2025-03-13 15:07:12,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:12,696 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:07:12,696 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:12,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:07:12,696 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:12
2025-03-13 15:07:12,697 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:12,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:12,697 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:12
2025-03-13 15:07:12,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:12,697 [INFO]: 	Creating the index 03/13/2025, 15:07:12
2025-03-13 15:07:12,697 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:12
2025-03-13 15:07:12,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:07:12,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:12
2025-03-13 15:07:12,698 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:07:12,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.03it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.64it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.36it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.74it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.89it/s] 50%|█████     | 6/12 [00:00<00:00,  7.85it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.65it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.55it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.08it/s] 83%|████████▎ | 10/12 [00:01<00:00,  6.77it/s] 92%|█████████▏| 11/12 [00:01<00:00,  6.80it/s]100%|██████████| 12/12 [00:05<00:00,  1.19s/it]100%|██████████| 12/12 [00:05<00:00,  2.34it/s]
2025-03-13 15:07:17,842 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:17
2025-03-13 15:08:02,769 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9269 secs
2025-03-13 15:08:02,769 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 15:08:02,769 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.29it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-13 15:08:20,800 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0307 secs
2025-03-13 15:08:20,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1048 secs
2025-03-13 15:08:20,803 [INFO]: {
2025-03-13 15:08:20,803 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:20,803 [INFO]: 	index_param: efSearch=219
2025-03-13 15:08:20,803 [INFO]: 	index_path: knn.index
2025-03-13 15:08:20,803 [INFO]: 	size in bytes: 587673790
2025-03-13 15:08:20,803 [INFO]: 	avg_search_speed_ms: 9.621923218173789
2025-03-13 15:08:20,803 [INFO]: 	99p_search_speed_ms: 16.448551472276442
2025-03-13 15:08:20,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:20,803 [INFO]: 	nb vectors: 2987
2025-03-13 15:08:20,803 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:20,803 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 15:08:20,803 [INFO]: }
2025-03-13 15:08:20,803 [INFO]: 	>>> Finished "Creating the index" in 68.1063 secs
2025-03-13 15:08:20,803 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1329 secs
2025-03-13 15:08:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 90759 [episode count 9/20]
[retrieval_preprocessing] for episode 39579 [episode count 10/20], we have num_retrieval=np.int64(2987) num_query=np.int64(137)
2025-03-13 15:08:22,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:23,364 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:23
2025-03-13 15:08:23,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1509.29it/s]
2025-03-13 15:08:23,389 [INFO]: There are 2987 embeddings of dim 49152
2025-03-13 15:08:23,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:08:23,390 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:23
2025-03-13 15:08:23,390 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:23,390 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:08:23,390 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:23,390 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:23,390 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:23
2025-03-13 15:08:23,390 [INFO]: 616.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:23,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:08:23,390 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:23
2025-03-13 15:08:23,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:23,390 [INFO]: 	Creating the index 03/13/2025, 15:08:23
2025-03-13 15:08:23,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:23
2025-03-13 15:08:23,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:08:23,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:23
2025-03-13 15:08:23,391 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:08:23,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.76it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.98it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.20it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.97it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.66it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.59it/s]100%|██████████| 12/12 [00:03<00:00,  3.65it/s]
2025-03-13 15:08:26,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:26
2025-03-13 15:09:02,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1147 secs
2025-03-13 15:09:02,809 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 15:09:02,809 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-13 15:09:23,616 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8065 secs
2025-03-13 15:09:23,619 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2280 secs
2025-03-13 15:09:23,619 [INFO]: {
2025-03-13 15:09:23,620 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:23,620 [INFO]: 	index_param: efSearch=225
2025-03-13 15:09:23,620 [INFO]: 	index_path: knn.index
2025-03-13 15:09:23,620 [INFO]: 	size in bytes: 587673790
2025-03-13 15:09:23,620 [INFO]: 	avg_search_speed_ms: 11.239373988178924
2025-03-13 15:09:23,620 [INFO]: 	99p_search_speed_ms: 17.607505468186
2025-03-13 15:09:23,620 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:23,620 [INFO]: 	nb vectors: 2987
2025-03-13 15:09:23,620 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:23,620 [INFO]: 	compression ratio: 0.9993096612322969
2025-03-13 15:09:23,620 [INFO]: }
2025-03-13 15:09:23,620 [INFO]: 	>>> Finished "Creating the index" in 60.2297 secs
2025-03-13 15:09:23,620 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2556 secs
2025-03-13 15:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 39579 [episode count 10/20]
[retrieval_preprocessing] for episode 62409 [episode count 11/20], we have num_retrieval=np.int64(3017) num_query=np.int64(107)
2025-03-13 15:09:26,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:26,635 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:26
2025-03-13 15:09:26,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.35it/s]
2025-03-13 15:09:26,660 [INFO]: There are 3017 embeddings of dim 49152
2025-03-13 15:09:26,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:09:26,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:26
2025-03-13 15:09:26,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:26,661 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:09:26,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:26,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:26,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:26
2025-03-13 15:09:26,661 [INFO]: 622.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:26,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:09:26,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:26
2025-03-13 15:09:26,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:26,661 [INFO]: 	Creating the index 03/13/2025, 15:09:26
2025-03-13 15:09:26,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:26
2025-03-13 15:09:26,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:26,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:26
2025-03-13 15:09:26,662 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:09:26,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.35it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.33it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.32it/s] 50%|█████     | 6/12 [00:00<00:00, 10.02it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.29it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.30it/s]100%|██████████| 12/12 [00:03<00:00,  2.06it/s]100%|██████████| 12/12 [00:03<00:00,  3.43it/s]
2025-03-13 15:09:30,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:30
2025-03-13 15:10:04,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1818 secs
2025-03-13 15:10:04,348 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 15:10:04,348 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 15:10:30,271 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9232 secs
2025-03-13 15:10:30,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6111 secs
2025-03-13 15:10:30,273 [INFO]: {
2025-03-13 15:10:30,273 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:30,273 [INFO]: 	index_param: efSearch=236
2025-03-13 15:10:30,273 [INFO]: 	index_path: knn.index
2025-03-13 15:10:30,273 [INFO]: 	size in bytes: 593575990
2025-03-13 15:10:30,273 [INFO]: 	avg_search_speed_ms: 10.12494339256996
2025-03-13 15:10:30,273 [INFO]: 	99p_search_speed_ms: 15.687152412720025
2025-03-13 15:10:30,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:30,274 [INFO]: 	nb vectors: 3017
2025-03-13 15:10:30,274 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:30,274 [INFO]: 	compression ratio: 0.9993098541603747
2025-03-13 15:10:30,274 [INFO]: }
2025-03-13 15:10:30,274 [INFO]: 	>>> Finished "Creating the index" in 63.6126 secs
2025-03-13 15:10:30,274 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6389 secs
2025-03-13 15:10:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 62409 [episode count 11/20]
[retrieval_preprocessing] for episode 15866 [episode count 12/20], we have num_retrieval=np.int64(2914) num_query=np.int64(210)
2025-03-13 15:10:32,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:33,461 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:33
2025-03-13 15:10:33,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1823.61it/s]
2025-03-13 15:10:33,832 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 15:10:33,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3708 secs
2025-03-13 15:10:33,833 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:33
2025-03-13 15:10:33,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:33,833 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:10:33,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:33,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:10:33,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:33
2025-03-13 15:10:33,834 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:33,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:10:33,834 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:33
2025-03-13 15:10:33,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:33,834 [INFO]: 	Creating the index 03/13/2025, 15:10:33
2025-03-13 15:10:33,834 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:33
2025-03-13 15:10:33,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:10:33,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:33
2025-03-13 15:10:33,837 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:10:33,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.84it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.17it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.34it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.72it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.97it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.20it/s]100%|██████████| 12/12 [00:03<00:00,  3.79it/s]
2025-03-13 15:10:37,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:37
2025-03-13 15:11:13,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8548 secs
2025-03-13 15:11:13,868 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 15:11:13,868 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.99it/s]
2025-03-13 15:11:35,315 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4466 secs
2025-03-13 15:11:35,318 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4805 secs
2025-03-13 15:11:35,318 [INFO]: {
2025-03-13 15:11:35,318 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:35,318 [INFO]: 	index_param: efSearch=250
2025-03-13 15:11:35,318 [INFO]: 	index_path: knn.index
2025-03-13 15:11:35,318 [INFO]: 	size in bytes: 573311410
2025-03-13 15:11:35,318 [INFO]: 	avg_search_speed_ms: 12.83510850619319
2025-03-13 15:11:35,318 [INFO]: 	99p_search_speed_ms: 25.72593261953449
2025-03-13 15:11:35,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:35,318 [INFO]: 	nb vectors: 2914
2025-03-13 15:11:35,318 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:35,318 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 15:11:35,318 [INFO]: }
2025-03-13 15:11:35,318 [INFO]: 	>>> Finished "Creating the index" in 61.4841 secs
2025-03-13 15:11:35,318 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8570 secs
2025-03-13 15:11:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 15866 [episode count 12/20]
[retrieval_preprocessing] for episode 26111 [episode count 13/20], we have num_retrieval=np.int64(2951) num_query=np.int64(173)
2025-03-13 15:11:40,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:41,531 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:41
2025-03-13 15:11:41,532 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.25it/s]
2025-03-13 15:11:41,566 [INFO]: There are 2951 embeddings of dim 49152
2025-03-13 15:11:41,567 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 15:11:41,567 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:41
2025-03-13 15:11:41,567 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:41,567 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:11:41,567 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:41,567 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:41,567 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:41
2025-03-13 15:11:41,567 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:41,567 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:11:41,567 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:41
2025-03-13 15:11:41,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:41,567 [INFO]: 	Creating the index 03/13/2025, 15:11:41
2025-03-13 15:11:41,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:41
2025-03-13 15:11:41,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:11:41,569 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:41
2025-03-13 15:11:41,569 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:11:41,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:03,  3.29it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.15it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.34it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.46it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.01it/s] 50%|█████     | 6/12 [00:01<00:00,  6.38it/s] 58%|█████▊    | 7/12 [00:01<00:00,  6.69it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.03it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.16it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.24it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.28it/s]100%|██████████| 12/12 [00:04<00:00,  1.12it/s]100%|██████████| 12/12 [00:04<00:00,  2.76it/s]
2025-03-13 15:11:45,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:45
2025-03-13 15:12:16,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8793 secs
2025-03-13 15:12:16,792 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 15:12:16,793 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 15:12:37,229 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4364 secs
2025-03-13 15:12:37,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6628 secs
2025-03-13 15:12:37,232 [INFO]: {
2025-03-13 15:12:37,232 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:37,232 [INFO]: 	index_param: efSearch=281
2025-03-13 15:12:37,232 [INFO]: 	index_path: knn.index
2025-03-13 15:12:37,232 [INFO]: 	size in bytes: 580590910
2025-03-13 15:12:37,232 [INFO]: 	avg_search_speed_ms: 12.336091877107133
2025-03-13 15:12:37,232 [INFO]: 	99p_search_speed_ms: 19.022296275943514
2025-03-13 15:12:37,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:37,232 [INFO]: 	nb vectors: 2951
2025-03-13 15:12:37,232 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:37,232 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-13 15:12:37,232 [INFO]: }
2025-03-13 15:12:37,232 [INFO]: 	>>> Finished "Creating the index" in 55.6646 secs
2025-03-13 15:12:37,232 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7004 secs
2025-03-13 15:12:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 26111 [episode count 13/20]
[retrieval_preprocessing] for episode 65029 [episode count 14/20], we have num_retrieval=np.int64(3031) num_query=np.int64(93)
2025-03-13 15:12:40,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:41,823 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:41
2025-03-13 15:12:41,823 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.76it/s]
2025-03-13 15:12:41,847 [INFO]: There are 3031 embeddings of dim 49152
2025-03-13 15:12:41,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 15:12:41,848 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:41
2025-03-13 15:12:41,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:41,848 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:12:41,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:41,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:41,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:41
2025-03-13 15:12:41,848 [INFO]: 625.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:41,848 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:41,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:41
2025-03-13 15:12:41,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:41,848 [INFO]: 	Creating the index 03/13/2025, 15:12:41
2025-03-13 15:12:41,848 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:41
2025-03-13 15:12:41,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:12:41,849 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:41
2025-03-13 15:12:41,849 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:12:41,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.09it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.93it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.14it/s] 50%|█████     | 6/12 [00:00<00:00,  9.83it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.09it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.57it/s]100%|██████████| 12/12 [00:03<00:00,  2.11it/s]100%|██████████| 12/12 [00:03<00:00,  3.54it/s]
2025-03-13 15:12:45,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:45
2025-03-13 15:13:26,354 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1078 secs
2025-03-13 15:13:26,354 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:13:26,354 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 15:13:46,297 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9423 secs
2025-03-13 15:13:47,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3262 secs
2025-03-13 15:13:47,176 [INFO]: {
2025-03-13 15:13:47,176 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:47,176 [INFO]: 	index_param: efSearch=209
2025-03-13 15:13:47,176 [INFO]: 	index_path: knn.index
2025-03-13 15:13:47,176 [INFO]: 	size in bytes: 596330350
2025-03-13 15:13:47,176 [INFO]: 	avg_search_speed_ms: 9.999983076704666
2025-03-13 15:13:47,176 [INFO]: 	99p_search_speed_ms: 16.140318638645113
2025-03-13 15:13:47,176 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:47,176 [INFO]: 	nb vectors: 3031
2025-03-13 15:13:47,176 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:47,176 [INFO]: 	compression ratio: 0.9993099428865225
2025-03-13 15:13:47,176 [INFO]: }
2025-03-13 15:13:47,176 [INFO]: 	>>> Finished "Creating the index" in 65.3283 secs
2025-03-13 15:13:47,176 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3531 secs
2025-03-13 15:13:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 65029 [episode count 14/20]
[retrieval_preprocessing] for episode 73687 [episode count 15/20], we have num_retrieval=np.int64(2975) num_query=np.int64(149)
2025-03-13 15:13:49,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:49,655 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:49
2025-03-13 15:13:49,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.73it/s]
2025-03-13 15:13:49,681 [INFO]: There are 2975 embeddings of dim 49152
2025-03-13 15:13:49,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:13:49,681 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:49
2025-03-13 15:13:49,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:49,681 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:13:49,681 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:49,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:13:49,681 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:49
2025-03-13 15:13:49,681 [INFO]: 614.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:49,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:13:49,681 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:49
2025-03-13 15:13:49,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:49,681 [INFO]: 	Creating the index 03/13/2025, 15:13:49
2025-03-13 15:13:49,681 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:49
2025-03-13 15:13:49,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:13:49,683 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:49
2025-03-13 15:13:49,683 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:13:49,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.98it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.49it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.22it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.64it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.81it/s] 50%|█████     | 6/12 [00:00<00:00,  7.98it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.04it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.14it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.23it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.28it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.42it/s]100%|██████████| 12/12 [00:04<00:00,  1.10it/s]100%|██████████| 12/12 [00:04<00:00,  2.92it/s]
2025-03-13 15:13:53,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:53
2025-03-13 15:14:24,165 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3678 secs
2025-03-13 15:14:24,165 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 15:14:24,165 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 15:14:48,412 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2472 secs
2025-03-13 15:14:48,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7444 secs
2025-03-13 15:14:48,427 [INFO]: {
2025-03-13 15:14:48,427 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:48,427 [INFO]: 	index_param: efSearch=252
2025-03-13 15:14:48,427 [INFO]: 	index_path: knn.index
2025-03-13 15:14:48,427 [INFO]: 	size in bytes: 585312910
2025-03-13 15:14:48,427 [INFO]: 	avg_search_speed_ms: 11.617167272229661
2025-03-13 15:14:48,427 [INFO]: 	99p_search_speed_ms: 17.55856783129274
2025-03-13 15:14:48,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:48,427 [INFO]: 	nb vectors: 2975
2025-03-13 15:14:48,427 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:48,427 [INFO]: 	compression ratio: 0.9993095829716109
2025-03-13 15:14:48,427 [INFO]: }
2025-03-13 15:14:48,427 [INFO]: 	>>> Finished "Creating the index" in 58.7461 secs
2025-03-13 15:14:48,428 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7724 secs
2025-03-13 15:14:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 73687 [episode count 15/20]
[retrieval_preprocessing] for episode 5658 [episode count 16/20], we have num_retrieval=np.int64(2928) num_query=np.int64(196)
2025-03-13 15:14:51,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:52,119 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:52
2025-03-13 15:14:52,119 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-13 15:14:52,144 [INFO]: There are 2928 embeddings of dim 49152
2025-03-13 15:14:52,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:14:52,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:52,144 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:14:52,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:52,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:52,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,144 [INFO]: 604.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:52,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:14:52,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:52
2025-03-13 15:14:52,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:52,145 [INFO]: 	Creating the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:52
2025-03-13 15:14:52,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:14:52,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:52
2025-03-13 15:14:52,146 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:14:52,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.02it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.34it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.00it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.20it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.26it/s] 50%|█████     | 6/12 [00:00<00:00,  7.38it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.43it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.54it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.65it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.09it/s]100%|██████████| 12/12 [00:04<00:00,  1.34it/s]100%|██████████| 12/12 [00:04<00:00,  2.96it/s]
2025-03-13 15:14:56,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:56
2025-03-13 15:15:32,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4693 secs
2025-03-13 15:15:32,678 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 15:15:32,678 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 15:15:54,888 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2097 secs
2025-03-13 15:15:54,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7458 secs
2025-03-13 15:15:54,892 [INFO]: {
2025-03-13 15:15:54,892 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:54,892 [INFO]: 	index_param: efSearch=251
2025-03-13 15:15:54,892 [INFO]: 	index_path: knn.index
2025-03-13 15:15:54,892 [INFO]: 	size in bytes: 576065770
2025-03-13 15:15:54,892 [INFO]: 	avg_search_speed_ms: 12.730753372136608
2025-03-13 15:15:54,892 [INFO]: 	99p_search_speed_ms: 16.785229858942326
2025-03-13 15:15:54,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:54,892 [INFO]: 	nb vectors: 2928
2025-03-13 15:15:54,892 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:54,892 [INFO]: 	compression ratio: 0.9993098947712168
2025-03-13 15:15:54,892 [INFO]: }
2025-03-13 15:15:54,892 [INFO]: 	>>> Finished "Creating the index" in 62.7474 secs
2025-03-13 15:15:54,892 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7733 secs
2025-03-13 15:15:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 5658 [episode count 16/20]
[retrieval_preprocessing] for episode 72829 [episode count 17/20], we have num_retrieval=np.int64(2989) num_query=np.int64(135)
2025-03-13 15:15:59,178 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:59,956 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:59
2025-03-13 15:15:59,956 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.63it/s]
2025-03-13 15:15:59,983 [INFO]: There are 2989 embeddings of dim 49152
2025-03-13 15:15:59,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:15:59,983 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:59,984 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:15:59,984 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:59,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:15:59,984 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,985 [INFO]: 616.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:59,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:15:59,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:59
2025-03-13 15:15:59,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:59,985 [INFO]: 	Creating the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,985 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:59
2025-03-13 15:15:59,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:15:59,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:59
2025-03-13 15:15:59,989 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:15:59,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.28it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.13it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.38it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.97it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.15it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.44it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.60it/s]100%|██████████| 12/12 [00:04<00:00,  1.12it/s]100%|██████████| 12/12 [00:04<00:00,  2.65it/s]
2025-03-13 15:16:04,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:04
2025-03-13 15:16:34,765 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2418 secs
2025-03-13 15:16:34,765 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 15:16:34,765 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.09it/s] 50%|█████     | 2/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.38it/s]
2025-03-13 15:17:02,200 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4345 secs
2025-03-13 15:17:02,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2136 secs
2025-03-13 15:17:02,202 [INFO]: {
2025-03-13 15:17:02,202 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:02,202 [INFO]: 	index_param: efSearch=297
2025-03-13 15:17:02,202 [INFO]: 	index_path: knn.index
2025-03-13 15:17:02,202 [INFO]: 	size in bytes: 588067270
2025-03-13 15:17:02,203 [INFO]: 	avg_search_speed_ms: 10.903864566007204
2025-03-13 15:17:02,203 [INFO]: 	99p_search_speed_ms: 15.136386724188927
2025-03-13 15:17:02,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:02,203 [INFO]: 	nb vectors: 2989
2025-03-13 15:17:02,203 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:02,203 [INFO]: 	compression ratio: 0.9993096742146523
2025-03-13 15:17:02,203 [INFO]: }
2025-03-13 15:17:02,203 [INFO]: 	>>> Finished "Creating the index" in 62.2173 secs
2025-03-13 15:17:02,203 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2469 secs
2025-03-13 15:17:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 72829 [episode count 17/20]
[retrieval_preprocessing] for episode 64630 [episode count 18/20], we have num_retrieval=np.int64(2898) num_query=np.int64(226)
2025-03-13 15:17:04,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:05,734 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:05
2025-03-13 15:17:05,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.86it/s]
2025-03-13 15:17:05,762 [INFO]: There are 2898 embeddings of dim 49152
2025-03-13 15:17:05,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:17:05,762 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:05
2025-03-13 15:17:05,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:05,762 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:17:05,762 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:05,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:17:05,762 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:05
2025-03-13 15:17:05,762 [INFO]: 598.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:05,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:17:05,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:05
2025-03-13 15:17:05,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:05,762 [INFO]: 	Creating the index 03/13/2025, 15:17:05
2025-03-13 15:17:05,762 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:05
2025-03-13 15:17:05,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:17:05,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:05
2025-03-13 15:17:05,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:17:05,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.10it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.83it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.72it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.17it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.29it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.19it/s]100%|██████████| 12/12 [00:03<00:00,  3.38it/s]
2025-03-13 15:17:09,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:09
2025-03-13 15:17:41,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7711 secs
2025-03-13 15:17:41,087 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 15:17:41,087 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.80it/s]
2025-03-13 15:18:00,042 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9551 secs
2025-03-13 15:18:00,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2806 secs
2025-03-13 15:18:00,045 [INFO]: {
2025-03-13 15:18:00,045 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:00,045 [INFO]: 	index_param: efSearch=210
2025-03-13 15:18:00,045 [INFO]: 	index_path: knn.index
2025-03-13 15:18:00,045 [INFO]: 	size in bytes: 570163510
2025-03-13 15:18:00,045 [INFO]: 	avg_search_speed_ms: 10.459916188555017
2025-03-13 15:18:00,045 [INFO]: 	99p_search_speed_ms: 16.028276120778212
2025-03-13 15:18:00,045 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:00,045 [INFO]: 	nb vectors: 2898
2025-03-13 15:18:00,045 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:00,045 [INFO]: 	compression ratio: 0.9993098014988718
2025-03-13 15:18:00,045 [INFO]: }
2025-03-13 15:18:00,045 [INFO]: 	>>> Finished "Creating the index" in 54.2824 secs
2025-03-13 15:18:00,045 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3108 secs
2025-03-13 15:18:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 64630 [episode count 18/20]
[retrieval_preprocessing] for episode 52627 [episode count 19/20], we have num_retrieval=np.int64(2989) num_query=np.int64(135)
2025-03-13 15:18:02,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:02,558 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:02
2025-03-13 15:18:02,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.57it/s]
2025-03-13 15:18:02,597 [INFO]: There are 2989 embeddings of dim 49152
2025-03-13 15:18:02,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 15:18:02,597 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:02
2025-03-13 15:18:02,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:02,597 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:18:02,597 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:02,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:18:02,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:02
2025-03-13 15:18:02,598 [INFO]: 616.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:02,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:18:02,598 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:02
2025-03-13 15:18:02,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:02,598 [INFO]: 	Creating the index 03/13/2025, 15:18:02
2025-03-13 15:18:02,598 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:02
2025-03-13 15:18:02,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:18:02,599 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:02
2025-03-13 15:18:02,599 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:18:02,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.51it/s] 50%|█████     | 6/12 [00:00<00:00, 30.89it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.93it/s]100%|██████████| 12/12 [00:02<00:00,  4.78it/s]
2025-03-13 15:18:05,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:05
2025-03-13 15:18:42,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0794 secs
2025-03-13 15:18:42,193 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 15:18:42,193 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s]
2025-03-13 15:19:07,115 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9220 secs
2025-03-13 15:19:07,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0414 secs
2025-03-13 15:19:07,641 [INFO]: {
2025-03-13 15:19:07,641 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:07,641 [INFO]: 	index_param: efSearch=152
2025-03-13 15:19:07,641 [INFO]: 	index_path: knn.index
2025-03-13 15:19:07,641 [INFO]: 	size in bytes: 588067270
2025-03-13 15:19:07,641 [INFO]: 	avg_search_speed_ms: 10.021303701989039
2025-03-13 15:19:07,641 [INFO]: 	99p_search_speed_ms: 14.969927009660747
2025-03-13 15:19:07,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:07,641 [INFO]: 	nb vectors: 2989
2025-03-13 15:19:07,642 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:07,642 [INFO]: 	compression ratio: 0.9993096742146523
2025-03-13 15:19:07,642 [INFO]: }
2025-03-13 15:19:07,642 [INFO]: 	>>> Finished "Creating the index" in 65.0438 secs
2025-03-13 15:19:07,642 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0839 secs
2025-03-13 15:19:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 52627 [episode count 19/20]
2025-03-13 15:19:08: [retrieval_preprocessing] finished for 8376714657_put_marker_in_grey_bowl [chosen_id count 1/196]
2025-03-13 15:19:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8376714657_take_pen_out_of_bowl_and_put_on_table [chosen_id count 2/196]
2025-03-13 15:19:10: [retrieval_preprocessing] we have num_total=3350 embedding_dim=49152
[retrieval_preprocessing] for episode 55350 [episode count 0/20], we have num_retrieval=np.int64(3192) num_query=np.int64(158)
2025-03-13 15:19:10,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:11,549 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:11
2025-03-13 15:19:11,549 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 879.68it/s]
2025-03-13 15:19:11,583 [INFO]: There are 3192 embeddings of dim 49152
2025-03-13 15:19:11,584 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 15:19:11,584 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:11,584 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:19:11,584 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:11,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:11,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,584 [INFO]: 658.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:11,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:19:11,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:11
2025-03-13 15:19:11,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:11,584 [INFO]: 	Creating the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:11
2025-03-13 15:19:11,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:19:11,586 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:11
2025-03-13 15:19:11,586 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:19:11,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.52it/s] 54%|█████▍    | 7/13 [00:00<00:00, 31.99it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.18it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-13 15:19:14,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:14
2025-03-13 15:19:58,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7965 secs
2025-03-13 15:19:58,221 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:19:58,221 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.50it/s]
2025-03-13 15:20:20,014 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7934 secs
2025-03-13 15:20:20,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4312 secs
2025-03-13 15:20:20,017 [INFO]: {
2025-03-13 15:20:20,017 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:20,017 [INFO]: 	index_param: efSearch=151
2025-03-13 15:20:20,017 [INFO]: 	index_path: knn.index
2025-03-13 15:20:20,017 [INFO]: 	size in bytes: 628006210
2025-03-13 15:20:20,017 [INFO]: 	avg_search_speed_ms: 10.540285527763066
2025-03-13 15:20:20,017 [INFO]: 	99p_search_speed_ms: 17.519174041226506
2025-03-13 15:20:20,017 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:20,017 [INFO]: 	nb vectors: 3192
2025-03-13 15:20:20,017 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:20,017 [INFO]: 	compression ratio: 0.9993097616025166
2025-03-13 15:20:20,017 [INFO]: }
2025-03-13 15:20:20,018 [INFO]: 	>>> Finished "Creating the index" in 68.4331 secs
2025-03-13 15:20:20,018 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4683 secs
2025-03-13 15:20:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 55350 [episode count 0/20]
[retrieval_preprocessing] for episode 57434 [episode count 1/20], we have num_retrieval=np.int64(3196) num_query=np.int64(154)
2025-03-13 15:20:22,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:23,416 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:23
2025-03-13 15:20:23,417 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-13 15:20:23,460 [INFO]: There are 3196 embeddings of dim 49152
2025-03-13 15:20:23,461 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0442 secs
2025-03-13 15:20:23,461 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:23
2025-03-13 15:20:23,461 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:23,462 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:20:23,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:23,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:20:23,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:23
2025-03-13 15:20:23,463 [INFO]: 659.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:23,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 15:20:23,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:23
2025-03-13 15:20:23,464 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:23,464 [INFO]: 	Creating the index 03/13/2025, 15:20:23
2025-03-13 15:20:23,464 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:23
2025-03-13 15:20:23,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:20:23,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:23
2025-03-13 15:20:23,468 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:20:23,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.12it/s] 38%|███▊      | 5/13 [00:00<00:00, 25.74it/s] 69%|██████▉   | 9/13 [00:00<00:00, 31.13it/s]100%|██████████| 13/13 [00:03<00:00,  2.68it/s]100%|██████████| 13/13 [00:03<00:00,  3.66it/s]
2025-03-13 15:20:27,028 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:27
2025-03-13 15:21:07,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7233 secs
2025-03-13 15:21:07,752 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:21:07,752 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 15:21:27,414 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6617 secs
2025-03-13 15:21:27,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9492 secs
2025-03-13 15:21:27,417 [INFO]: {
2025-03-13 15:21:27,417 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:27,417 [INFO]: 	index_param: efSearch=173
2025-03-13 15:21:27,417 [INFO]: 	index_path: knn.index
2025-03-13 15:21:27,417 [INFO]: 	size in bytes: 628793170
2025-03-13 15:21:27,417 [INFO]: 	avg_search_speed_ms: 10.36646436620021
2025-03-13 15:21:27,417 [INFO]: 	99p_search_speed_ms: 14.559401525184512
2025-03-13 15:21:27,417 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:27,417 [INFO]: 	nb vectors: 3196
2025-03-13 15:21:27,417 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:27,417 [INFO]: 	compression ratio: 0.9993097857599185
2025-03-13 15:21:27,417 [INFO]: }
2025-03-13 15:21:27,417 [INFO]: 	>>> Finished "Creating the index" in 63.9532 secs
2025-03-13 15:21:27,417 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0005 secs
2025-03-13 15:21:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 57434 [episode count 1/20]
[retrieval_preprocessing] for episode 94305 [episode count 2/20], we have num_retrieval=np.int64(3186) num_query=np.int64(164)
2025-03-13 15:21:29,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:29,719 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:29
2025-03-13 15:21:29,719 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-13 15:21:29,745 [INFO]: There are 3186 embeddings of dim 49152
2025-03-13 15:21:29,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:21:29,745 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:29
2025-03-13 15:21:29,745 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:29,745 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:21:29,745 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:29,745 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:21:29,745 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:29
2025-03-13 15:21:29,745 [INFO]: 657.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:29,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:21:29,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:29
2025-03-13 15:21:29,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:29,746 [INFO]: 	Creating the index 03/13/2025, 15:21:29
2025-03-13 15:21:29,746 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:29
2025-03-13 15:21:29,747 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:21:29,747 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:29
2025-03-13 15:21:29,747 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:21:29,747 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.90it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.45it/s] 92%|█████████▏| 12/13 [00:00<00:00, 38.21it/s]100%|██████████| 13/13 [00:03<00:00,  4.30it/s]
2025-03-13 15:21:33,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:33
2025-03-13 15:22:09,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9230 secs
2025-03-13 15:22:09,111 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 15:22:09,111 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 15:22:32,008 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8964 secs
2025-03-13 15:22:32,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2629 secs
2025-03-13 15:22:32,010 [INFO]: {
2025-03-13 15:22:32,010 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:32,010 [INFO]: 	index_param: efSearch=225
2025-03-13 15:22:32,010 [INFO]: 	index_path: knn.index
2025-03-13 15:22:32,010 [INFO]: 	size in bytes: 626825770
2025-03-13 15:22:32,010 [INFO]: 	avg_search_speed_ms: 11.19780798196534
2025-03-13 15:22:32,010 [INFO]: 	99p_search_speed_ms: 14.946401240304112
2025-03-13 15:22:32,010 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:32,010 [INFO]: 	nb vectors: 3186
2025-03-13 15:22:32,010 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:32,010 [INFO]: 	compression ratio: 0.9993097252526807
2025-03-13 15:22:32,010 [INFO]: }
2025-03-13 15:22:32,010 [INFO]: 	>>> Finished "Creating the index" in 62.2644 secs
2025-03-13 15:22:32,010 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2912 secs
2025-03-13 15:22:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 94305 [episode count 2/20]
[retrieval_preprocessing] for episode 59792 [episode count 3/20], we have num_retrieval=np.int64(3184) num_query=np.int64(166)
2025-03-13 15:22:34,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:35,171 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:35
2025-03-13 15:22:35,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 836.35it/s]
2025-03-13 15:22:35,215 [INFO]: There are 3184 embeddings of dim 49152
2025-03-13 15:22:35,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0438 secs
2025-03-13 15:22:35,216 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:35
2025-03-13 15:22:35,216 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:35,216 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:22:35,216 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:35,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:22:35,216 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:35
2025-03-13 15:22:35,216 [INFO]: 657.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:35,217 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:22:35,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:35
2025-03-13 15:22:35,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:35,217 [INFO]: 	Creating the index 03/13/2025, 15:22:35
2025-03-13 15:22:35,217 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:35
2025-03-13 15:22:35,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:22:35,220 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:35
2025-03-13 15:22:35,220 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:22:35,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.88it/s] 38%|███▊      | 5/13 [00:00<00:00, 24.75it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.79it/s]100%|██████████| 13/13 [00:03<00:00,  2.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
2025-03-13 15:22:38,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:38
2025-03-13 15:23:18,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4402 secs
2025-03-13 15:23:18,937 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:23:18,938 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 15:23:40,408 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4699 secs
2025-03-13 15:23:40,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1915 secs
2025-03-13 15:23:40,412 [INFO]: {
2025-03-13 15:23:40,412 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:40,412 [INFO]: 	index_param: efSearch=176
2025-03-13 15:23:40,412 [INFO]: 	index_path: knn.index
2025-03-13 15:23:40,412 [INFO]: 	size in bytes: 626432290
2025-03-13 15:23:40,412 [INFO]: 	avg_search_speed_ms: 9.104435820661289
2025-03-13 15:23:40,412 [INFO]: 	99p_search_speed_ms: 11.4614789141342
2025-03-13 15:23:40,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:40,412 [INFO]: 	nb vectors: 3184
2025-03-13 15:23:40,412 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:40,412 [INFO]: 	compression ratio: 0.9993097131056256
2025-03-13 15:23:40,412 [INFO]: }
2025-03-13 15:23:40,412 [INFO]: 	>>> Finished "Creating the index" in 65.1949 secs
2025-03-13 15:23:40,412 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2403 secs
2025-03-13 15:23:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 59792 [episode count 3/20]
[retrieval_preprocessing] for episode 63968 [episode count 4/20], we have num_retrieval=np.int64(3218) num_query=np.int64(132)
2025-03-13 15:23:41,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:43,481 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:43
2025-03-13 15:23:43,481 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1750.54it/s]
2025-03-13 15:23:43,508 [INFO]: There are 3218 embeddings of dim 49152
2025-03-13 15:23:43,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:23:43,508 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:43
2025-03-13 15:23:43,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:43,508 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:23:43,508 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:43,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:43,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:43
2025-03-13 15:23:43,508 [INFO]: 664.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:43,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:23:43,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:43
2025-03-13 15:23:43,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:43,508 [INFO]: 	Creating the index 03/13/2025, 15:23:43
2025-03-13 15:23:43,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:43
2025-03-13 15:23:43,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:23:43,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:43
2025-03-13 15:23:43,509 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:23:43,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.37it/s] 46%|████▌     | 6/13 [00:00<00:00, 26.85it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.22it/s]100%|██████████| 13/13 [00:02<00:00,  4.83it/s]
2025-03-13 15:23:46,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:46
2025-03-13 15:24:27,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5301 secs
2025-03-13 15:24:27,735 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:24:27,735 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.85it/s]
2025-03-13 15:24:49,089 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3538 secs
2025-03-13 15:24:49,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5816 secs
2025-03-13 15:24:49,091 [INFO]: {
2025-03-13 15:24:49,091 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:49,091 [INFO]: 	index_param: efSearch=185
2025-03-13 15:24:49,091 [INFO]: 	index_path: knn.index
2025-03-13 15:24:49,091 [INFO]: 	size in bytes: 633121510
2025-03-13 15:24:49,091 [INFO]: 	avg_search_speed_ms: 9.279575422000146
2025-03-13 15:24:49,091 [INFO]: 	99p_search_speed_ms: 15.68572174757719
2025-03-13 15:24:49,091 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:49,091 [INFO]: 	nb vectors: 3218
2025-03-13 15:24:49,091 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:49,091 [INFO]: 	compression ratio: 0.9993098228490136
2025-03-13 15:24:49,091 [INFO]: }
2025-03-13 15:24:49,091 [INFO]: 	>>> Finished "Creating the index" in 65.5831 secs
2025-03-13 15:24:49,091 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6103 secs
2025-03-13 15:24:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 63968 [episode count 4/20]
[retrieval_preprocessing] for episode 86590 [episode count 5/20], we have num_retrieval=np.int64(3224) num_query=np.int64(126)
2025-03-13 15:24:50,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:50,752 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:50
2025-03-13 15:24:50,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.36it/s]
2025-03-13 15:24:50,788 [INFO]: There are 3224 embeddings of dim 49152
2025-03-13 15:24:50,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 15:24:50,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:50
2025-03-13 15:24:50,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:50,788 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:24:50,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:50,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:24:50,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:50
2025-03-13 15:24:50,788 [INFO]: 665.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:50,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:50,788 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:50
2025-03-13 15:24:50,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:50,788 [INFO]: 	Creating the index 03/13/2025, 15:24:50
2025-03-13 15:24:50,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:50
2025-03-13 15:24:50,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:24:50,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:50
2025-03-13 15:24:50,790 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:24:50,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.47it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.77it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.45it/s]100%|██████████| 13/13 [00:02<00:00,  4.93it/s]
2025-03-13 15:24:53,431 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:53
2025-03-13 15:25:38,024 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5923 secs
2025-03-13 15:25:38,024 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:25:38,024 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 15:26:00,715 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6905 secs
2025-03-13 15:26:00,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9277 secs
2025-03-13 15:26:00,718 [INFO]: {
2025-03-13 15:26:00,718 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:00,718 [INFO]: 	index_param: efSearch=151
2025-03-13 15:26:00,718 [INFO]: 	index_path: knn.index
2025-03-13 15:26:00,718 [INFO]: 	size in bytes: 634302130
2025-03-13 15:26:00,718 [INFO]: 	avg_search_speed_ms: 9.270033711935216
2025-03-13 15:26:00,718 [INFO]: 	99p_search_speed_ms: 15.262039871886374
2025-03-13 15:26:00,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:00,718 [INFO]: 	nb vectors: 3224
2025-03-13 15:26:00,718 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:00,718 [INFO]: 	compression ratio: 0.9993095750758396
2025-03-13 15:26:00,718 [INFO]: }
2025-03-13 15:26:00,718 [INFO]: 	>>> Finished "Creating the index" in 69.9292 secs
2025-03-13 15:26:00,718 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9653 secs
2025-03-13 15:26:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 86590 [episode count 5/20]
[retrieval_preprocessing] for episode 19145 [episode count 6/20], we have num_retrieval=np.int64(3202) num_query=np.int64(148)
2025-03-13 15:26:02,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:03,427 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:03
2025-03-13 15:26:03,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-13 15:26:03,456 [INFO]: There are 3202 embeddings of dim 49152
2025-03-13 15:26:03,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:26:03,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:03,456 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:26:03,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:03,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:03,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,457 [INFO]: 660.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:03,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:03,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:03
2025-03-13 15:26:03,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:03,457 [INFO]: 	Creating the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:03
2025-03-13 15:26:03,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:26:03,458 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:03
2025-03-13 15:26:03,458 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:26:03,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.82it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.94it/s] 77%|███████▋  | 10/13 [00:00<00:00, 29.85it/s]100%|██████████| 13/13 [00:03<00:00,  2.93it/s]100%|██████████| 13/13 [00:03<00:00,  4.19it/s]
2025-03-13 15:26:06,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:06
2025-03-13 15:26:44,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1980 secs
2025-03-13 15:26:44,767 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 15:26:44,767 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 15:27:07,565 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7983 secs
2025-03-13 15:27:07,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1099 secs
2025-03-13 15:27:07,568 [INFO]: {
2025-03-13 15:27:07,568 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:07,568 [INFO]: 	index_param: efSearch=124
2025-03-13 15:27:07,568 [INFO]: 	index_path: knn.index
2025-03-13 15:27:07,568 [INFO]: 	size in bytes: 629973610
2025-03-13 15:27:07,568 [INFO]: 	avg_search_speed_ms: 7.725544273673371
2025-03-13 15:27:07,568 [INFO]: 	99p_search_speed_ms: 14.668497839011234
2025-03-13 15:27:07,568 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:07,568 [INFO]: 	nb vectors: 3202
2025-03-13 15:27:07,568 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:07,568 [INFO]: 	compression ratio: 0.9993098218828563
2025-03-13 15:27:07,568 [INFO]: }
2025-03-13 15:27:07,568 [INFO]: 	>>> Finished "Creating the index" in 64.1115 secs
2025-03-13 15:27:07,568 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1412 secs
2025-03-13 15:27:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 19145 [episode count 6/20]
[retrieval_preprocessing] for episode 58267 [episode count 7/20], we have num_retrieval=np.int64(3160) num_query=np.int64(190)
2025-03-13 15:27:08,871 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:09,503 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:09
2025-03-13 15:27:09,503 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.40it/s]
2025-03-13 15:27:09,534 [INFO]: There are 3160 embeddings of dim 49152
2025-03-13 15:27:09,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 15:27:09,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:09,535 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:27:09,535 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:09,535 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:09,535 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,535 [INFO]: 652.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:09,535 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:27:09,535 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:09
2025-03-13 15:27:09,535 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:09,535 [INFO]: 	Creating the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,535 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:09
2025-03-13 15:27:09,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:27:09,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:09
2025-03-13 15:27:09,537 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:27:09,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.27it/s] 38%|███▊      | 5/13 [00:00<00:00, 22.66it/s] 77%|███████▋  | 10/13 [00:00<00:00, 30.96it/s]100%|██████████| 13/13 [00:02<00:00,  4.44it/s]
2025-03-13 15:27:12,470 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:12
2025-03-13 15:27:46,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0972 secs
2025-03-13 15:27:46,568 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 15:27:46,568 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.31it/s]
2025-03-13 15:28:12,430 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8623 secs
2025-03-13 15:28:12,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8968 secs
2025-03-13 15:28:12,434 [INFO]: {
2025-03-13 15:28:12,434 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:12,434 [INFO]: 	index_param: efSearch=166
2025-03-13 15:28:12,434 [INFO]: 	index_path: knn.index
2025-03-13 15:28:12,434 [INFO]: 	size in bytes: 621710470
2025-03-13 15:28:12,434 [INFO]: 	avg_search_speed_ms: 10.353551776722984
2025-03-13 15:28:12,434 [INFO]: 	99p_search_speed_ms: 16.560470848344274
2025-03-13 15:28:12,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:12,434 [INFO]: 	nb vectors: 3160
2025-03-13 15:28:12,434 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:12,434 [INFO]: 	compression ratio: 0.9993096625829705
2025-03-13 15:28:12,434 [INFO]: }
2025-03-13 15:28:12,434 [INFO]: 	>>> Finished "Creating the index" in 62.8987 secs
2025-03-13 15:28:12,434 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9310 secs
2025-03-13 15:28:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 58267 [episode count 7/20]
[retrieval_preprocessing] for episode 93185 [episode count 8/20], we have num_retrieval=np.int64(3185) num_query=np.int64(165)
2025-03-13 15:28:14,769 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:15,407 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:15
2025-03-13 15:28:15,407 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.45it/s]
2025-03-13 15:28:15,438 [INFO]: There are 3185 embeddings of dim 49152
2025-03-13 15:28:15,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 15:28:15,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:15,438 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:28:15,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:15,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:15,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,438 [INFO]: 657.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:15,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:28:15,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:15
2025-03-13 15:28:15,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:15,439 [INFO]: 	Creating the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,439 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:15
2025-03-13 15:28:15,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:28:15,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:15
2025-03-13 15:28:15,440 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:28:15,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.55it/s] 38%|███▊      | 5/13 [00:00<00:00, 22.85it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.52it/s]100%|██████████| 13/13 [00:03<00:00,  3.05it/s]100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
2025-03-13 15:28:18,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:18
2025-03-13 15:28:57,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2585 secs
2025-03-13 15:28:57,863 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:28:57,863 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 15:29:20,613 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7498 secs
2025-03-13 15:29:20,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1757 secs
2025-03-13 15:29:20,616 [INFO]: {
2025-03-13 15:29:20,616 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:20,616 [INFO]: 	index_param: efSearch=158
2025-03-13 15:29:20,616 [INFO]: 	index_path: knn.index
2025-03-13 15:29:20,616 [INFO]: 	size in bytes: 626629030
2025-03-13 15:29:20,616 [INFO]: 	avg_search_speed_ms: 10.301943584254163
2025-03-13 15:29:20,616 [INFO]: 	99p_search_speed_ms: 18.165461043827232
2025-03-13 15:29:20,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:20,616 [INFO]: 	nb vectors: 3185
2025-03-13 15:29:20,616 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:20,616 [INFO]: 	compression ratio: 0.9993097191810599
2025-03-13 15:29:20,616 [INFO]: }
2025-03-13 15:29:20,616 [INFO]: 	>>> Finished "Creating the index" in 65.1774 secs
2025-03-13 15:29:20,616 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2097 secs
2025-03-13 15:29:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 93185 [episode count 8/20]
[retrieval_preprocessing] for episode 60709 [episode count 9/20], we have num_retrieval=np.int64(3209) num_query=np.int64(141)
2025-03-13 15:29:22,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:23,172 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:23
2025-03-13 15:29:23,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.40it/s]
2025-03-13 15:29:23,205 [INFO]: There are 3209 embeddings of dim 49152
2025-03-13 15:29:23,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:29:23,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:23
2025-03-13 15:29:23,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:23,206 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:29:23,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:23,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:29:23,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:23
2025-03-13 15:29:23,206 [INFO]: 662.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:23,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:29:23,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:23
2025-03-13 15:29:23,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:23,207 [INFO]: 	Creating the index 03/13/2025, 15:29:23
2025-03-13 15:29:23,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:23
2025-03-13 15:29:23,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:29:23,211 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:23
2025-03-13 15:29:23,211 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:29:23,211 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.10it/s] 38%|███▊      | 5/13 [00:00<00:00, 24.76it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.72it/s]100%|██████████| 13/13 [00:05<00:00,  1.66it/s]100%|██████████| 13/13 [00:05<00:00,  2.31it/s]
2025-03-13 15:29:28,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:28
2025-03-13 15:30:05,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2963 secs
2025-03-13 15:30:05,271 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 15:30:05,271 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 15:30:20,965 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6943 secs
2025-03-13 15:30:20,968 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7572 secs
2025-03-13 15:30:20,968 [INFO]: {
2025-03-13 15:30:20,968 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:20,968 [INFO]: 	index_param: efSearch=109
2025-03-13 15:30:20,968 [INFO]: 	index_path: knn.index
2025-03-13 15:30:20,968 [INFO]: 	size in bytes: 631350850
2025-03-13 15:30:20,968 [INFO]: 	avg_search_speed_ms: 7.5438145398742185
2025-03-13 15:30:20,968 [INFO]: 	99p_search_speed_ms: 11.395257562398909
2025-03-13 15:30:20,968 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:20,968 [INFO]: 	nb vectors: 3209
2025-03-13 15:30:20,968 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:20,968 [INFO]: 	compression ratio: 0.9993097688868242
2025-03-13 15:30:20,968 [INFO]: }
2025-03-13 15:30:20,968 [INFO]: 	>>> Finished "Creating the index" in 57.7610 secs
2025-03-13 15:30:20,968 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7964 secs
2025-03-13 15:30:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 60709 [episode count 9/20]
[retrieval_preprocessing] for episode 33619 [episode count 10/20], we have num_retrieval=np.int64(3169) num_query=np.int64(181)
2025-03-13 15:30:22,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:22,621 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:22
2025-03-13 15:30:22,621 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1092.55it/s]
2025-03-13 15:30:22,652 [INFO]: There are 3169 embeddings of dim 49152
2025-03-13 15:30:22,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 15:30:22,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:22
2025-03-13 15:30:22,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:22,653 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:30:22,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:22,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:30:22,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:22
2025-03-13 15:30:22,654 [INFO]: 654.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:22,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:30:22,655 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:22
2025-03-13 15:30:22,655 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:30:22,655 [INFO]: 	Creating the index 03/13/2025, 15:30:22
2025-03-13 15:30:22,655 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:22
2025-03-13 15:30:22,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:30:22,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:22
2025-03-13 15:30:22,659 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:30:22,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.42it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.43it/s] 92%|█████████▏| 12/13 [00:00<00:00, 40.80it/s]100%|██████████| 13/13 [00:02<00:00,  4.74it/s]
2025-03-13 15:30:25,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:25
2025-03-13 15:31:03,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9915 secs
2025-03-13 15:31:03,396 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:31:03,396 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 15:31:21,632 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2354 secs
2025-03-13 15:31:21,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9755 secs
2025-03-13 15:31:21,634 [INFO]: {
2025-03-13 15:31:21,634 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:21,634 [INFO]: 	index_param: efSearch=193
2025-03-13 15:31:21,634 [INFO]: 	index_path: knn.index
2025-03-13 15:31:21,634 [INFO]: 	size in bytes: 623481130
2025-03-13 15:31:21,634 [INFO]: 	avg_search_speed_ms: 10.102486224948532
2025-03-13 15:31:21,634 [INFO]: 	99p_search_speed_ms: 13.667875148821624
2025-03-13 15:31:21,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:21,634 [INFO]: 	nb vectors: 3169
2025-03-13 15:31:21,634 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:21,634 [INFO]: 	compression ratio: 0.9993097176814316
2025-03-13 15:31:21,634 [INFO]: }
2025-03-13 15:31:21,634 [INFO]: 	>>> Finished "Creating the index" in 58.9791 secs
2025-03-13 15:31:21,634 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0129 secs
2025-03-13 15:31:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 33619 [episode count 10/20]
[retrieval_preprocessing] for episode 28136 [episode count 11/20], we have num_retrieval=np.int64(3155) num_query=np.int64(195)
2025-03-13 15:31:24,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:25,299 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:25
2025-03-13 15:31:25,299 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2130.17it/s]
2025-03-13 15:31:25,325 [INFO]: There are 3155 embeddings of dim 49152
2025-03-13 15:31:25,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 15:31:25,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:25,326 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:31:25,326 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:25,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:25,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,326 [INFO]: 651.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:25,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:31:25,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:25
2025-03-13 15:31:25,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:25,326 [INFO]: 	Creating the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,326 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:25
2025-03-13 15:31:25,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:31:25,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,327 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:31:25,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.96it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.91it/s] 85%|████████▍ | 11/13 [00:00<00:00, 37.14it/s]100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
2025-03-13 15:31:28,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:28
2025-03-13 15:32:03,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7395 secs
2025-03-13 15:32:03,388 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:32:03,388 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.21it/s]
2025-03-13 15:32:25,574 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1856 secs
2025-03-13 15:32:25,576 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2491 secs
2025-03-13 15:32:25,577 [INFO]: {
2025-03-13 15:32:25,577 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:25,577 [INFO]: 	index_param: efSearch=182
2025-03-13 15:32:25,577 [INFO]: 	index_path: knn.index
2025-03-13 15:32:25,577 [INFO]: 	size in bytes: 620726770
2025-03-13 15:32:25,577 [INFO]: 	avg_search_speed_ms: 10.879493224251128
2025-03-13 15:32:25,577 [INFO]: 	99p_search_speed_ms: 16.257341769523915
2025-03-13 15:32:25,577 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:25,577 [INFO]: 	nb vectors: 3155
2025-03-13 15:32:25,577 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:25,577 [INFO]: 	compression ratio: 0.9993096318368869
2025-03-13 15:32:25,577 [INFO]: }
2025-03-13 15:32:25,577 [INFO]: 	>>> Finished "Creating the index" in 60.2507 secs
2025-03-13 15:32:25,577 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2782 secs
2025-03-13 15:32:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 28136 [episode count 11/20]
[retrieval_preprocessing] for episode 24218 [episode count 12/20], we have num_retrieval=np.int64(3193) num_query=np.int64(157)
2025-03-13 15:32:27,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:28,272 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:28
2025-03-13 15:32:28,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2026.23it/s]
2025-03-13 15:32:28,307 [INFO]: There are 3193 embeddings of dim 49152
2025-03-13 15:32:28,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 15:32:28,307 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:28
2025-03-13 15:32:28,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:28,308 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:32:28,308 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:28,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:32:28,308 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:28
2025-03-13 15:32:28,308 [INFO]: 659.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:28,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:32:28,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:28
2025-03-13 15:32:28,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:28,309 [INFO]: 	Creating the index 03/13/2025, 15:32:28
2025-03-13 15:32:28,309 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:28
2025-03-13 15:32:28,311 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:32:28,311 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:28
2025-03-13 15:32:28,311 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:32:28,311 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.64it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.17it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.06it/s]100%|██████████| 13/13 [00:03<00:00,  3.72it/s]
2025-03-13 15:32:31,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:31
2025-03-13 15:33:09,874 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0660 secs
2025-03-13 15:33:09,874 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:33:09,874 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.76it/s]
2025-03-13 15:33:29,448 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5741 secs
2025-03-13 15:33:29,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1393 secs
2025-03-13 15:33:29,450 [INFO]: {
2025-03-13 15:33:29,450 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:29,451 [INFO]: 	index_param: efSearch=193
2025-03-13 15:33:29,451 [INFO]: 	index_path: knn.index
2025-03-13 15:33:29,451 [INFO]: 	size in bytes: 628202950
2025-03-13 15:33:29,451 [INFO]: 	avg_search_speed_ms: 10.217629562857903
2025-03-13 15:33:29,451 [INFO]: 	99p_search_speed_ms: 14.40931723918766
2025-03-13 15:33:29,451 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:29,451 [INFO]: 	nb vectors: 3193
2025-03-13 15:33:29,451 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:29,451 [INFO]: 	compression ratio: 0.9993097676475413
2025-03-13 15:33:29,451 [INFO]: }
2025-03-13 15:33:29,451 [INFO]: 	>>> Finished "Creating the index" in 61.1420 secs
2025-03-13 15:33:29,451 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1786 secs
2025-03-13 15:33:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 24218 [episode count 12/20]
[retrieval_preprocessing] for episode 81073 [episode count 13/20], we have num_retrieval=np.int64(3169) num_query=np.int64(181)
2025-03-13 15:33:31,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:32,150 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:32
2025-03-13 15:33:32,150 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-13 15:33:32,176 [INFO]: There are 3169 embeddings of dim 49152
2025-03-13 15:33:32,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:33:32,176 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:32
2025-03-13 15:33:32,176 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:32,176 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:33:32,176 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:32,176 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:32,176 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:32
2025-03-13 15:33:32,176 [INFO]: 654.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:32,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:33:32,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:32
2025-03-13 15:33:32,176 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:32,176 [INFO]: 	Creating the index 03/13/2025, 15:33:32
2025-03-13 15:33:32,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:32
2025-03-13 15:33:32,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:33:32,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:32
2025-03-13 15:33:32,177 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:33:32,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.03it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.10it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.98it/s]100%|██████████| 13/13 [00:02<00:00,  5.32it/s]
2025-03-13 15:33:34,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:34
2025-03-13 15:34:10,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7529 secs
2025-03-13 15:34:10,376 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:34:10,376 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.72it/s]
2025-03-13 15:34:29,826 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4494 secs
2025-03-13 15:34:29,828 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6508 secs
2025-03-13 15:34:29,828 [INFO]: {
2025-03-13 15:34:29,828 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:29,828 [INFO]: 	index_param: efSearch=160
2025-03-13 15:34:29,828 [INFO]: 	index_path: knn.index
2025-03-13 15:34:29,828 [INFO]: 	size in bytes: 623481130
2025-03-13 15:34:29,828 [INFO]: 	avg_search_speed_ms: 9.604653553351918
2025-03-13 15:34:29,828 [INFO]: 	99p_search_speed_ms: 13.488537073135376
2025-03-13 15:34:29,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:29,828 [INFO]: 	nb vectors: 3169
2025-03-13 15:34:29,828 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:29,828 [INFO]: 	compression ratio: 0.9993097176814316
2025-03-13 15:34:29,828 [INFO]: }
2025-03-13 15:34:29,829 [INFO]: 	>>> Finished "Creating the index" in 57.6523 secs
2025-03-13 15:34:29,829 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6783 secs
2025-03-13 15:34:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 81073 [episode count 13/20]
[retrieval_preprocessing] for episode 70589 [episode count 14/20], we have num_retrieval=np.int64(3129) num_query=np.int64(221)
2025-03-13 15:34:32,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:32,818 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:32
2025-03-13 15:34:32,819 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.04it/s]
2025-03-13 15:34:33,413 [INFO]: There are 3129 embeddings of dim 49152
2025-03-13 15:34:33,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5953 secs
2025-03-13 15:34:33,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:33
2025-03-13 15:34:33,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:33,414 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:34:33,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:33,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:34:33,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:33
2025-03-13 15:34:33,415 [INFO]: 645.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:33,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:34:33,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:33
2025-03-13 15:34:33,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:33,415 [INFO]: 	Creating the index 03/13/2025, 15:34:33
2025-03-13 15:34:33,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:33
2025-03-13 15:34:33,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:34:33,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:33
2025-03-13 15:34:33,418 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:34:33,419 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.77it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.67it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.62it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-13 15:34:37,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:37
2025-03-13 15:35:16,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6179 secs
2025-03-13 15:35:16,770 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:35:16,770 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.81it/s]
2025-03-13 15:35:40,460 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6897 secs
2025-03-13 15:35:40,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0437 secs
2025-03-13 15:35:40,462 [INFO]: {
2025-03-13 15:35:40,462 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:40,462 [INFO]: 	index_param: efSearch=189
2025-03-13 15:35:40,462 [INFO]: 	index_path: knn.index
2025-03-13 15:35:40,462 [INFO]: 	size in bytes: 615611470
2025-03-13 15:35:40,462 [INFO]: 	avg_search_speed_ms: 9.493330901575256
2025-03-13 15:35:40,462 [INFO]: 	99p_search_speed_ms: 11.951738223433498
2025-03-13 15:35:40,462 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:40,462 [INFO]: 	nb vectors: 3129
2025-03-13 15:35:40,462 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:40,462 [INFO]: 	compression ratio: 0.9993095677700742
2025-03-13 15:35:40,462 [INFO]: }
2025-03-13 15:35:40,462 [INFO]: 	>>> Finished "Creating the index" in 67.0470 secs
2025-03-13 15:35:40,462 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6438 secs
2025-03-13 15:35:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 70589 [episode count 14/20]
[retrieval_preprocessing] for episode 84312 [episode count 15/20], we have num_retrieval=np.int64(3223) num_query=np.int64(127)
2025-03-13 15:35:42,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:43,508 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:43
2025-03-13 15:35:43,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1378.35it/s]
2025-03-13 15:35:43,540 [INFO]: There are 3223 embeddings of dim 49152
2025-03-13 15:35:43,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 15:35:43,540 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:43
2025-03-13 15:35:43,540 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:43,541 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:35:43,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:43,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:35:43,541 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:43
2025-03-13 15:35:43,541 [INFO]: 665.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:43,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:35:43,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:43
2025-03-13 15:35:43,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:43,542 [INFO]: 	Creating the index 03/13/2025, 15:35:43
2025-03-13 15:35:43,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:43
2025-03-13 15:35:43,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:35:43,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:43
2025-03-13 15:35:43,546 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:35:43,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.10it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.19it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.57it/s]100%|██████████| 13/13 [00:02<00:00,  4.82it/s]
2025-03-13 15:35:46,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:46
2025-03-13 15:36:22,242 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9924 secs
2025-03-13 15:36:22,242 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:36:22,242 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-13 15:36:50,769 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5263 secs
2025-03-13 15:36:50,772 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2258 secs
2025-03-13 15:36:50,772 [INFO]: {
2025-03-13 15:36:50,772 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:50,772 [INFO]: 	index_param: efSearch=176
2025-03-13 15:36:50,772 [INFO]: 	index_path: knn.index
2025-03-13 15:36:50,772 [INFO]: 	size in bytes: 634105330
2025-03-13 15:36:50,772 [INFO]: 	avg_search_speed_ms: 9.699471023432354
2025-03-13 15:36:50,772 [INFO]: 	99p_search_speed_ms: 12.976812338456511
2025-03-13 15:36:50,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:50,772 [INFO]: 	nb vectors: 3223
2025-03-13 15:36:50,772 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:50,772 [INFO]: 	compression ratio: 0.9993096635853858
2025-03-13 15:36:50,772 [INFO]: }
2025-03-13 15:36:50,772 [INFO]: 	>>> Finished "Creating the index" in 67.2301 secs
2025-03-13 15:36:50,772 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2639 secs
2025-03-13 15:36:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 84312 [episode count 15/20]
[retrieval_preprocessing] for episode 16315 [episode count 16/20], we have num_retrieval=np.int64(3179) num_query=np.int64(171)
2025-03-13 15:36:52,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:53,096 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:53
2025-03-13 15:36:53,096 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.98it/s]
2025-03-13 15:36:53,127 [INFO]: There are 3179 embeddings of dim 49152
2025-03-13 15:36:53,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 15:36:53,127 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:53
2025-03-13 15:36:53,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:53,127 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:36:53,127 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:53,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:53,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:53
2025-03-13 15:36:53,127 [INFO]: 656.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:53,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:36:53,127 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:53
2025-03-13 15:36:53,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:53,128 [INFO]: 	Creating the index 03/13/2025, 15:36:53
2025-03-13 15:36:53,128 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:53
2025-03-13 15:36:53,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:36:53,129 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:53
2025-03-13 15:36:53,129 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:36:53,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.70it/s] 38%|███▊      | 5/13 [00:00<00:00, 21.51it/s] 69%|██████▉   | 9/13 [00:00<00:00, 28.04it/s]100%|██████████| 13/13 [00:02<00:00,  3.25it/s]100%|██████████| 13/13 [00:02<00:00,  4.34it/s]
2025-03-13 15:36:56,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:56
2025-03-13 15:37:40,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0222 secs
2025-03-13 15:37:40,149 [INFO]: The best hyperparameters are: efSearch=62
2025-03-13 15:37:40,149 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.97it/s]
2025-03-13 15:37:58,700 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5512 secs
2025-03-13 15:37:58,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5741 secs
2025-03-13 15:37:58,703 [INFO]: {
2025-03-13 15:37:58,703 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:58,703 [INFO]: 	index_param: efSearch=62
2025-03-13 15:37:58,703 [INFO]: 	index_path: knn.index
2025-03-13 15:37:58,703 [INFO]: 	size in bytes: 625448590
2025-03-13 15:37:58,703 [INFO]: 	avg_search_speed_ms: 5.1925136396879115
2025-03-13 15:37:58,703 [INFO]: 	99p_search_speed_ms: 7.488267607986927
2025-03-13 15:37:58,703 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:58,703 [INFO]: 	nb vectors: 3179
2025-03-13 15:37:58,703 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:58,703 [INFO]: 	compression ratio: 0.9993096826711209
2025-03-13 15:37:58,703 [INFO]: }
2025-03-13 15:37:58,703 [INFO]: 	>>> Finished "Creating the index" in 65.5758 secs
2025-03-13 15:37:58,703 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6075 secs
2025-03-13 15:37:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 16315 [episode count 16/20]
[retrieval_preprocessing] for episode 40921 [episode count 17/20], we have num_retrieval=np.int64(3156) num_query=np.int64(194)
2025-03-13 15:38:00,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:01,355 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:01
2025-03-13 15:38:01,355 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 15:38:01,391 [INFO]: There are 3156 embeddings of dim 49152
2025-03-13 15:38:01,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 15:38:01,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:01
2025-03-13 15:38:01,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:01,391 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:38:01,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:01,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:01,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:01
2025-03-13 15:38:01,392 [INFO]: 651.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:01,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:01,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:01
2025-03-13 15:38:01,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:01,392 [INFO]: 	Creating the index 03/13/2025, 15:38:01
2025-03-13 15:38:01,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:01
2025-03-13 15:38:01,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:38:01,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:01
2025-03-13 15:38:01,393 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:38:01,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.87it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.04it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.91it/s]100%|██████████| 13/13 [00:03<00:00,  4.26it/s]
2025-03-13 15:38:04,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:04
2025-03-13 15:38:39,250 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8046 secs
2025-03-13 15:38:39,251 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 15:38:39,251 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 15:39:23,315 [INFO]: 	>>> Finished "Compute fast metrics" in 44.0637 secs
2025-03-13 15:39:23,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.9243 secs
2025-03-13 15:39:23,317 [INFO]: {
2025-03-13 15:39:23,317 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:23,317 [INFO]: 	index_param: efSearch=223
2025-03-13 15:39:23,317 [INFO]: 	index_path: knn.index
2025-03-13 15:39:23,317 [INFO]: 	size in bytes: 620923510
2025-03-13 15:39:23,317 [INFO]: 	avg_search_speed_ms: 9.861711726553327
2025-03-13 15:39:23,318 [INFO]: 	99p_search_speed_ms: 15.265773718710989
2025-03-13 15:39:23,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:23,318 [INFO]: 	nb vectors: 3156
2025-03-13 15:39:23,318 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:23,318 [INFO]: 	compression ratio: 0.9993096379938972
2025-03-13 15:39:23,318 [INFO]: }
2025-03-13 15:39:23,318 [INFO]: 	>>> Finished "Creating the index" in 81.9258 secs
2025-03-13 15:39:23,318 [INFO]: >>> Finished "Launching the whole pipeline" in 81.9627 secs
2025-03-13 15:39:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 40921 [episode count 17/20]
[retrieval_preprocessing] for episode 58088 [episode count 18/20], we have num_retrieval=np.int64(3140) num_query=np.int64(210)
2025-03-13 15:39:27,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:27,886 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:27
2025-03-13 15:39:27,886 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.47it/s]
2025-03-13 15:39:27,913 [INFO]: There are 3140 embeddings of dim 49152
2025-03-13 15:39:27,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:39:27,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:27
2025-03-13 15:39:27,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:27,914 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:39:27,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:27,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:27,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:27
2025-03-13 15:39:27,914 [INFO]: 648.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:27,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:39:27,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:27
2025-03-13 15:39:27,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:27,914 [INFO]: 	Creating the index 03/13/2025, 15:39:27
2025-03-13 15:39:27,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:27
2025-03-13 15:39:27,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:39:27,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:27
2025-03-13 15:39:27,915 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:39:27,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.66it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.41it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.71it/s]100%|██████████| 13/13 [00:02<00:00,  4.40it/s]
2025-03-13 15:39:30,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:30
2025-03-13 15:40:11,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0873 secs
2025-03-13 15:40:11,959 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:40:11,959 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.05it/s]
2025-03-13 15:40:42,336 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3766 secs
2025-03-13 15:40:42,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4231 secs
2025-03-13 15:40:42,339 [INFO]: {
2025-03-13 15:40:42,339 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:42,339 [INFO]: 	index_param: efSearch=158
2025-03-13 15:40:42,340 [INFO]: 	index_path: knn.index
2025-03-13 15:40:42,340 [INFO]: 	size in bytes: 617775610
2025-03-13 15:40:42,340 [INFO]: 	avg_search_speed_ms: 9.087617693426596
2025-03-13 15:40:42,340 [INFO]: 	99p_search_speed_ms: 13.541809131857008
2025-03-13 15:40:42,340 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:42,340 [INFO]: 	nb vectors: 3140
2025-03-13 15:40:42,340 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:42,340 [INFO]: 	compression ratio: 0.9993096360667265
2025-03-13 15:40:42,340 [INFO]: }
2025-03-13 15:40:42,340 [INFO]: 	>>> Finished "Creating the index" in 74.4254 secs
2025-03-13 15:40:42,340 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4537 secs
2025-03-13 15:40:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 58088 [episode count 18/20]
[retrieval_preprocessing] for episode 60836 [episode count 19/20], we have num_retrieval=np.int64(3181) num_query=np.int64(169)
2025-03-13 15:40:44,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:45,137 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:45
2025-03-13 15:40:45,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.95it/s]
2025-03-13 15:40:45,171 [INFO]: There are 3181 embeddings of dim 49152
2025-03-13 15:40:45,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 15:40:45,172 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:45
2025-03-13 15:40:45,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:45,172 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:40:45,172 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:45,172 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:40:45,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:45
2025-03-13 15:40:45,173 [INFO]: 656.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:45,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:40:45,173 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:45
2025-03-13 15:40:45,173 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:45,173 [INFO]: 	Creating the index 03/13/2025, 15:40:45
2025-03-13 15:40:45,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:45
2025-03-13 15:40:45,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:40:45,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:45
2025-03-13 15:40:45,177 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:40:45,178 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.43it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.37it/s] 92%|█████████▏| 12/13 [00:00<00:00, 38.15it/s]100%|██████████| 13/13 [00:02<00:00,  4.67it/s]
2025-03-13 15:40:47,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:47
2025-03-13 15:41:28,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6732 secs
2025-03-13 15:41:28,642 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:41:28,642 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.12it/s]
2025-03-13 15:41:56,297 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6555 secs
2025-03-13 15:41:56,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1223 secs
2025-03-13 15:41:56,300 [INFO]: {
2025-03-13 15:41:56,300 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:56,300 [INFO]: 	index_param: efSearch=154
2025-03-13 15:41:56,300 [INFO]: 	index_path: knn.index
2025-03-13 15:41:56,300 [INFO]: 	size in bytes: 625842070
2025-03-13 15:41:56,300 [INFO]: 	avg_search_speed_ms: 7.71185600036524
2025-03-13 15:41:56,300 [INFO]: 	99p_search_speed_ms: 9.77569579146802
2025-03-13 15:41:56,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:56,300 [INFO]: 	nb vectors: 3181
2025-03-13 15:41:56,300 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:56,300 [INFO]: 	compression ratio: 0.9993096948564036
2025-03-13 15:41:56,300 [INFO]: }
2025-03-13 15:41:56,300 [INFO]: 	>>> Finished "Creating the index" in 71.1265 secs
2025-03-13 15:41:56,300 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1629 secs
2025-03-13 15:41:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 60836 [episode count 19/20]
2025-03-13 15:41:57: [retrieval_preprocessing] finished for 8376714657_take_pen_out_of_bowl_and_put_on_table [chosen_id count 2/196]
2025-03-13 15:41:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8481266618_put_cable_in_compartment [chosen_id count 3/196]
2025-03-13 15:41:58: [retrieval_preprocessing] we have num_total=3211 embedding_dim=49152
[retrieval_preprocessing] for episode 55826 [episode count 0/20], we have num_retrieval=np.int64(3056) num_query=np.int64(155)
2025-03-13 15:41:59,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:00,183 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:00
2025-03-13 15:42:00,183 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 804.28it/s]
2025-03-13 15:42:00,224 [INFO]: There are 3056 embeddings of dim 49152
2025-03-13 15:42:00,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0418 secs
2025-03-13 15:42:00,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:00,226 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:42:00,226 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:00,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:42:00,226 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,226 [INFO]: 630.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:00,227 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:42:00,227 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:00
2025-03-13 15:42:00,227 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:00,228 [INFO]: 	Creating the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,228 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:00
2025-03-13 15:42:00,231 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:42:00,231 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:00
2025-03-13 15:42:00,231 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:42:00,232 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.97it/s] 38%|███▊      | 5/13 [00:00<00:00, 26.05it/s] 69%|██████▉   | 9/13 [00:00<00:00, 30.87it/s]100%|██████████| 13/13 [00:03<00:00,  2.75it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
2025-03-13 15:42:03,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:03
2025-03-13 15:42:43,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8110 secs
2025-03-13 15:42:43,521 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:42:43,521 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 15:43:11,742 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2203 secs
2025-03-13 15:43:11,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5131 secs
2025-03-13 15:43:11,745 [INFO]: {
2025-03-13 15:43:11,745 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:11,745 [INFO]: 	index_param: efSearch=180
2025-03-13 15:43:11,745 [INFO]: 	index_path: knn.index
2025-03-13 15:43:11,745 [INFO]: 	size in bytes: 601248970
2025-03-13 15:43:11,745 [INFO]: 	avg_search_speed_ms: 8.909679445647262
2025-03-13 15:43:11,745 [INFO]: 	99p_search_speed_ms: 16.561931325122686
2025-03-13 15:43:11,745 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:11,745 [INFO]: 	nb vectors: 3056
2025-03-13 15:43:11,745 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:11,745 [INFO]: 	compression ratio: 0.999309899857292
2025-03-13 15:43:11,745 [INFO]: }
2025-03-13 15:43:11,745 [INFO]: 	>>> Finished "Creating the index" in 71.5171 secs
2025-03-13 15:43:11,745 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5618 secs
2025-03-13 15:43:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 55826 [episode count 0/20]
[retrieval_preprocessing] for episode 50206 [episode count 1/20], we have num_retrieval=np.int64(3017) num_query=np.int64(194)
2025-03-13 15:43:14,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:15,110 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:15
2025-03-13 15:43:15,110 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-13 15:43:15,136 [INFO]: There are 3017 embeddings of dim 49152
2025-03-13 15:43:15,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:43:15,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:15
2025-03-13 15:43:15,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:15,136 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:43:15,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:15,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:15,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:15
2025-03-13 15:43:15,136 [INFO]: 622.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:15,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:43:15,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:15
2025-03-13 15:43:15,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:15,136 [INFO]: 	Creating the index 03/13/2025, 15:43:15
2025-03-13 15:43:15,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:15
2025-03-13 15:43:15,137 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:43:15,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:15
2025-03-13 15:43:15,137 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:43:15,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.38it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.85it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.52it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.86it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.10it/s] 50%|█████     | 6/12 [00:00<00:00,  8.23it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.38it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.51it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.78it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.49it/s]100%|██████████| 12/12 [00:04<00:00,  1.19it/s]100%|██████████| 12/12 [00:04<00:00,  2.78it/s]
2025-03-13 15:43:19,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:19
2025-03-13 15:44:11,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4920 secs
2025-03-13 15:44:11,964 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:44:11,964 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 15:44:37,472 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5075 secs
2025-03-13 15:44:37,475 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3375 secs
2025-03-13 15:44:37,475 [INFO]: {
2025-03-13 15:44:37,475 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:37,475 [INFO]: 	index_param: efSearch=189
2025-03-13 15:44:37,475 [INFO]: 	index_path: knn.index
2025-03-13 15:44:37,475 [INFO]: 	size in bytes: 593575990
2025-03-13 15:44:37,475 [INFO]: 	avg_search_speed_ms: 9.54940512379651
2025-03-13 15:44:37,475 [INFO]: 	99p_search_speed_ms: 17.131801499053832
2025-03-13 15:44:37,475 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:37,475 [INFO]: 	nb vectors: 3017
2025-03-13 15:44:37,475 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:37,475 [INFO]: 	compression ratio: 0.9993098541603747
2025-03-13 15:44:37,475 [INFO]: }
2025-03-13 15:44:37,475 [INFO]: 	>>> Finished "Creating the index" in 82.3389 secs
2025-03-13 15:44:37,475 [INFO]: >>> Finished "Launching the whole pipeline" in 82.3654 secs
2025-03-13 15:44:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 50206 [episode count 1/20]
[retrieval_preprocessing] for episode 27687 [episode count 2/20], we have num_retrieval=np.int64(3072) num_query=np.int64(139)
2025-03-13 15:44:39,404 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:39,801 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:39
2025-03-13 15:44:39,801 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.54it/s]
2025-03-13 15:44:39,835 [INFO]: There are 3072 embeddings of dim 49152
2025-03-13 15:44:39,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 15:44:39,835 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:39
2025-03-13 15:44:39,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:39,835 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:44:39,835 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:39,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:39,835 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:39
2025-03-13 15:44:39,835 [INFO]: 634.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:39,836 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:44:39,836 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:39
2025-03-13 15:44:39,836 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:39,836 [INFO]: 	Creating the index 03/13/2025, 15:44:39
2025-03-13 15:44:39,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:39
2025-03-13 15:44:39,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:44:39,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:39
2025-03-13 15:44:39,837 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:44:39,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.26it/s] 62%|██████▏   | 8/13 [00:00<00:00, 39.11it/s]100%|██████████| 13/13 [00:02<00:00,  4.05it/s]100%|██████████| 13/13 [00:02<00:00,  4.98it/s]
2025-03-13 15:44:42,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:42
2025-03-13 15:45:36,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8662 secs
2025-03-13 15:45:36,317 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:45:36,317 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.52it/s]
2025-03-13 15:45:57,772 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4551 secs
2025-03-13 15:45:57,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9389 secs
2025-03-13 15:45:57,776 [INFO]: {
2025-03-13 15:45:57,776 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:57,776 [INFO]: 	index_param: efSearch=151
2025-03-13 15:45:57,776 [INFO]: 	index_path: knn.index
2025-03-13 15:45:57,776 [INFO]: 	size in bytes: 604396930
2025-03-13 15:45:57,776 [INFO]: 	avg_search_speed_ms: 10.424505436319054
2025-03-13 15:45:57,776 [INFO]: 	99p_search_speed_ms: 17.816547891125083
2025-03-13 15:45:57,776 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:57,776 [INFO]: 	nb vectors: 3072
2025-03-13 15:45:57,777 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:57,777 [INFO]: 	compression ratio: 0.9993098012592486
2025-03-13 15:45:57,777 [INFO]: }
2025-03-13 15:45:57,777 [INFO]: 	>>> Finished "Creating the index" in 77.9410 secs
2025-03-13 15:45:57,777 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9755 secs
2025-03-13 15:45:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 27687 [episode count 2/20]
[retrieval_preprocessing] for episode 11831 [episode count 3/20], we have num_retrieval=np.int64(3087) num_query=np.int64(124)
2025-03-13 15:45:59,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:00,180 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:00
2025-03-13 15:46:00,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.38it/s]
2025-03-13 15:46:00,458 [INFO]: There are 3087 embeddings of dim 49152
2025-03-13 15:46:00,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2778 secs
2025-03-13 15:46:00,459 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:00
2025-03-13 15:46:00,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:00,459 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:46:00,459 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:00,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:46:00,459 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:00
2025-03-13 15:46:00,459 [INFO]: 637.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:00,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:46:00,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:00
2025-03-13 15:46:00,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:00,460 [INFO]: 	Creating the index 03/13/2025, 15:46:00
2025-03-13 15:46:00,460 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:00
2025-03-13 15:46:00,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:46:00,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:00
2025-03-13 15:46:00,463 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:46:00,463 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.45it/s] 38%|███▊      | 5/13 [00:00<00:00, 20.65it/s] 62%|██████▏   | 8/13 [00:00<00:00, 24.20it/s] 85%|████████▍ | 11/13 [00:00<00:00, 26.18it/s]100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
2025-03-13 15:46:04,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:04
2025-03-13 15:46:43,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5952 secs
2025-03-13 15:46:43,281 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 15:46:43,281 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.22it/s]
2025-03-13 15:47:09,370 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0893 secs
2025-03-13 15:47:09,373 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9100 secs
2025-03-13 15:47:09,373 [INFO]: {
2025-03-13 15:47:09,373 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:09,373 [INFO]: 	index_param: efSearch=197
2025-03-13 15:47:09,373 [INFO]: 	index_path: knn.index
2025-03-13 15:47:09,373 [INFO]: 	size in bytes: 607348090
2025-03-13 15:47:09,373 [INFO]: 	avg_search_speed_ms: 9.61077233841759
2025-03-13 15:47:09,373 [INFO]: 	99p_search_speed_ms: 14.363980712369065
2025-03-13 15:47:09,373 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:09,373 [INFO]: 	nb vectors: 3087
2025-03-13 15:47:09,373 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:09,373 [INFO]: 	compression ratio: 0.9993097961335484
2025-03-13 15:47:09,373 [INFO]: }
2025-03-13 15:47:09,373 [INFO]: 	>>> Finished "Creating the index" in 68.9131 secs
2025-03-13 15:47:09,373 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1924 secs
2025-03-13 15:47:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 11831 [episode count 3/20]
[retrieval_preprocessing] for episode 45140 [episode count 4/20], we have num_retrieval=np.int64(3057) num_query=np.int64(154)
2025-03-13 15:47:12,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:13,353 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:13
2025-03-13 15:47:13,353 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1279.14it/s]
2025-03-13 15:47:13,390 [INFO]: There are 3057 embeddings of dim 49152
2025-03-13 15:47:13,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 15:47:13,391 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:13,391 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:47:13,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:13,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:13,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,391 [INFO]: 630.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:13,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:47:13,391 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:13
2025-03-13 15:47:13,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:13,391 [INFO]: 	Creating the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,391 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:13
2025-03-13 15:47:13,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:47:13,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:13
2025-03-13 15:47:13,393 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:47:13,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.60it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.86it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.76it/s]100%|██████████| 13/13 [00:03<00:00,  3.61it/s]
2025-03-13 15:47:16,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:16
2025-03-13 15:48:07,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2268 secs
2025-03-13 15:48:07,226 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:48:07,226 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.98it/s]
2025-03-13 15:48:36,308 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0818 secs
2025-03-13 15:48:36,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9180 secs
2025-03-13 15:48:36,311 [INFO]: {
2025-03-13 15:48:36,311 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:36,311 [INFO]: 	index_param: efSearch=177
2025-03-13 15:48:36,311 [INFO]: 	index_path: knn.index
2025-03-13 15:48:36,311 [INFO]: 	size in bytes: 601445710
2025-03-13 15:48:36,311 [INFO]: 	avg_search_speed_ms: 9.571668999848896
2025-03-13 15:48:36,311 [INFO]: 	99p_search_speed_ms: 15.704135447740555
2025-03-13 15:48:36,311 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:36,311 [INFO]: 	nb vectors: 3057
2025-03-13 15:48:36,311 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:36,311 [INFO]: 	compression ratio: 0.9993099061260242
2025-03-13 15:48:36,311 [INFO]: }
2025-03-13 15:48:36,311 [INFO]: 	>>> Finished "Creating the index" in 82.9198 secs
2025-03-13 15:48:36,311 [INFO]: >>> Finished "Launching the whole pipeline" in 82.9584 secs
2025-03-13 15:48:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 45140 [episode count 4/20]
[retrieval_preprocessing] for episode 19583 [episode count 5/20], we have num_retrieval=np.int64(3034) num_query=np.int64(177)
2025-03-13 15:48:37,780 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:39,169 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:39
2025-03-13 15:48:39,169 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1027.01it/s]
2025-03-13 15:48:39,201 [INFO]: There are 3034 embeddings of dim 49152
2025-03-13 15:48:39,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 15:48:39,202 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:39
2025-03-13 15:48:39,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:39,202 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:48:39,202 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:39,202 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:48:39,202 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:39
2025-03-13 15:48:39,203 [INFO]: 626.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:39,203 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:48:39,203 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:39
2025-03-13 15:48:39,203 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:39,204 [INFO]: 	Creating the index 03/13/2025, 15:48:39
2025-03-13 15:48:39,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:39
2025-03-13 15:48:39,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:48:39,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:39
2025-03-13 15:48:39,208 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:48:39,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.59it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.59it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.26it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]
2025-03-13 15:48:41,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:41
2025-03-13 15:49:19,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7757 secs
2025-03-13 15:49:19,506 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:49:19,506 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 15:49:53,776 [INFO]: 	>>> Finished "Compute fast metrics" in 34.2703 secs
2025-03-13 15:49:54,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.1453 secs
2025-03-13 15:49:54,353 [INFO]: {
2025-03-13 15:49:54,353 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:54,353 [INFO]: 	index_param: efSearch=202
2025-03-13 15:49:54,353 [INFO]: 	index_path: knn.index
2025-03-13 15:49:54,354 [INFO]: 	size in bytes: 596920630
2025-03-13 15:49:54,354 [INFO]: 	avg_search_speed_ms: 10.040166880374393
2025-03-13 15:49:54,354 [INFO]: 	99p_search_speed_ms: 16.64433678379282
2025-03-13 15:49:54,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:54,354 [INFO]: 	nb vectors: 3034
2025-03-13 15:49:54,354 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:54,354 [INFO]: 	compression ratio: 0.9993098613462229
2025-03-13 15:49:54,354 [INFO]: }
2025-03-13 15:49:54,354 [INFO]: 	>>> Finished "Creating the index" in 75.1503 secs
2025-03-13 15:49:54,354 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1850 secs
2025-03-13 15:49:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 19583 [episode count 5/20]
[retrieval_preprocessing] for episode 18568 [episode count 6/20], we have num_retrieval=np.int64(3076) num_query=np.int64(135)
2025-03-13 15:49:55,933 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:56,383 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:56
2025-03-13 15:49:56,383 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 15:49:56,413 [INFO]: There are 3076 embeddings of dim 49152
2025-03-13 15:49:56,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:49:56,413 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:56
2025-03-13 15:49:56,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:56,414 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:49:56,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:56,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:49:56,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:56
2025-03-13 15:49:56,415 [INFO]: 634.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:56,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:49:56,415 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:56
2025-03-13 15:49:56,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:56,415 [INFO]: 	Creating the index 03/13/2025, 15:49:56
2025-03-13 15:49:56,415 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:56
2025-03-13 15:49:56,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:49:56,419 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:56
2025-03-13 15:49:56,419 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:49:56,419 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 26.33it/s] 69%|██████▉   | 9/13 [00:00<00:00, 40.73it/s]100%|██████████| 13/13 [00:02<00:00,  5.49it/s]
2025-03-13 15:49:58,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:58
2025-03-13 15:50:40,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2968 secs
2025-03-13 15:50:40,088 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:50:40,088 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.34it/s]
2025-03-13 15:51:03,448 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3594 secs
2025-03-13 15:51:03,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0317 secs
2025-03-13 15:51:03,451 [INFO]: {
2025-03-13 15:51:03,451 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:03,451 [INFO]: 	index_param: efSearch=211
2025-03-13 15:51:03,451 [INFO]: 	index_path: knn.index
2025-03-13 15:51:03,451 [INFO]: 	size in bytes: 605183890
2025-03-13 15:51:03,451 [INFO]: 	avg_search_speed_ms: 11.109197977930307
2025-03-13 15:51:03,451 [INFO]: 	99p_search_speed_ms: 17.34498252160847
2025-03-13 15:51:03,451 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:03,451 [INFO]: 	nb vectors: 3076
2025-03-13 15:51:03,451 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:03,451 [INFO]: 	compression ratio: 0.9993098263075046
2025-03-13 15:51:03,451 [INFO]: }
2025-03-13 15:51:03,451 [INFO]: 	>>> Finished "Creating the index" in 67.0355 secs
2025-03-13 15:51:03,451 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0682 secs
2025-03-13 15:51:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 18568 [episode count 6/20]
[retrieval_preprocessing] for episode 42681 [episode count 7/20], we have num_retrieval=np.int64(3069) num_query=np.int64(142)
2025-03-13 15:51:05,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:06,429 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:06
2025-03-13 15:51:06,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.84it/s]
2025-03-13 15:51:06,460 [INFO]: There are 3069 embeddings of dim 49152
2025-03-13 15:51:06,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 15:51:06,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:06
2025-03-13 15:51:06,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:06,460 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:51:06,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:06,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:06,461 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:06
2025-03-13 15:51:06,461 [INFO]: 633.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:06,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:51:06,461 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:06
2025-03-13 15:51:06,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:06,461 [INFO]: 	Creating the index 03/13/2025, 15:51:06
2025-03-13 15:51:06,461 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:06
2025-03-13 15:51:06,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:51:06,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:06
2025-03-13 15:51:06,463 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:51:06,463 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.61it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.51it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.28it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.69it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.53it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.09it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.71it/s]100%|██████████| 13/13 [00:05<00:00,  1.12s/it]100%|██████████| 13/13 [00:05<00:00,  2.60it/s]
2025-03-13 15:51:11,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:11
2025-03-13 15:51:53,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2863 secs
2025-03-13 15:51:53,758 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:51:53,758 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.43it/s]
2025-03-13 15:52:18,546 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7883 secs
2025-03-13 15:52:18,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0859 secs
2025-03-13 15:52:18,549 [INFO]: {
2025-03-13 15:52:18,549 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:18,549 [INFO]: 	index_param: efSearch=205
2025-03-13 15:52:18,549 [INFO]: 	index_path: knn.index
2025-03-13 15:52:18,549 [INFO]: 	size in bytes: 603806710
2025-03-13 15:52:18,549 [INFO]: 	avg_search_speed_ms: 11.169312062657662
2025-03-13 15:52:18,549 [INFO]: 	99p_search_speed_ms: 16.918743369169526
2025-03-13 15:52:18,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:18,549 [INFO]: 	nb vectors: 3069
2025-03-13 15:52:18,549 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:18,549 [INFO]: 	compression ratio: 0.9993097824302085
2025-03-13 15:52:18,549 [INFO]: }
2025-03-13 15:52:18,549 [INFO]: 	>>> Finished "Creating the index" in 72.0877 secs
2025-03-13 15:52:18,549 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1193 secs
2025-03-13 15:52:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 42681 [episode count 7/20]
[retrieval_preprocessing] for episode 83134 [episode count 8/20], we have num_retrieval=np.int64(3054) num_query=np.int64(157)
2025-03-13 15:52:19,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:20,422 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:20
2025-03-13 15:52:20,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-13 15:52:20,454 [INFO]: There are 3054 embeddings of dim 49152
2025-03-13 15:52:20,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 15:52:20,455 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:20
2025-03-13 15:52:20,455 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:20,455 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:52:20,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:20,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:52:20,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:20
2025-03-13 15:52:20,456 [INFO]: 630.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:20,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:52:20,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:20
2025-03-13 15:52:20,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:20,457 [INFO]: 	Creating the index 03/13/2025, 15:52:20
2025-03-13 15:52:20,457 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:20
2025-03-13 15:52:20,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:52:20,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:20
2025-03-13 15:52:20,461 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:52:20,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.61it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.03it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.85it/s]100%|██████████| 13/13 [00:03<00:00,  4.19it/s]
2025-03-13 15:52:23,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:23
2025-03-13 15:53:06,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6211 secs
2025-03-13 15:53:06,192 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:53:06,192 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:15,  5.10s/it] 50%|█████     | 2/4 [00:06<00:06,  3.02s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.24s/it]
2025-03-13 15:53:40,823 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6305 secs
2025-03-13 15:53:40,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3647 secs
2025-03-13 15:53:40,825 [INFO]: {
2025-03-13 15:53:40,825 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:40,825 [INFO]: 	index_param: efSearch=196
2025-03-13 15:53:40,825 [INFO]: 	index_path: knn.index
2025-03-13 15:53:40,825 [INFO]: 	size in bytes: 600855430
2025-03-13 15:53:40,826 [INFO]: 	avg_search_speed_ms: 11.338401463330468
2025-03-13 15:53:40,826 [INFO]: 	99p_search_speed_ms: 22.36088729929177
2025-03-13 15:53:40,826 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:40,826 [INFO]: 	nb vectors: 3054
2025-03-13 15:53:40,826 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:40,826 [INFO]: 	compression ratio: 0.9993099870962304
2025-03-13 15:53:40,826 [INFO]: }
2025-03-13 15:53:40,826 [INFO]: 	>>> Finished "Creating the index" in 80.3686 secs
2025-03-13 15:53:40,826 [INFO]: >>> Finished "Launching the whole pipeline" in 80.4033 secs
2025-03-13 15:53:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 83134 [episode count 8/20]
[retrieval_preprocessing] for episode 52416 [episode count 9/20], we have num_retrieval=np.int64(3020) num_query=np.int64(191)
2025-03-13 15:53:43,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:44,629 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:44
2025-03-13 15:53:44,630 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1984.06it/s]
2025-03-13 15:53:44,659 [INFO]: There are 3020 embeddings of dim 49152
2025-03-13 15:53:44,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:53:44,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:44
2025-03-13 15:53:44,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:44,659 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:53:44,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:44,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:44,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:44
2025-03-13 15:53:44,659 [INFO]: 623.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:44,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:53:44,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:44
2025-03-13 15:53:44,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:44,660 [INFO]: 	Creating the index 03/13/2025, 15:53:44
2025-03-13 15:53:44,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:44
2025-03-13 15:53:44,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:53:44,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:44
2025-03-13 15:53:44,661 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:53:44,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.12it/s] 42%|████▏     | 5/12 [00:00<00:00, 20.20it/s] 67%|██████▋   | 8/12 [00:01<00:00,  4.14it/s] 83%|████████▎ | 10/12 [00:05<00:01,  1.28it/s] 92%|█████████▏| 11/12 [00:06<00:00,  1.24it/s]100%|██████████| 12/12 [00:08<00:00,  1.15s/it]100%|██████████| 12/12 [00:08<00:00,  1.34it/s]
2025-03-13 15:53:53,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:53
2025-03-13 15:54:28,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8166 secs
2025-03-13 15:54:28,433 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 15:54:28,433 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.69it/s]
2025-03-13 15:54:52,869 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4359 secs
2025-03-13 15:54:52,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2175 secs
2025-03-13 15:54:52,878 [INFO]: {
2025-03-13 15:54:52,878 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:52,878 [INFO]: 	index_param: efSearch=251
2025-03-13 15:54:52,878 [INFO]: 	index_path: knn.index
2025-03-13 15:54:52,878 [INFO]: 	size in bytes: 594166210
2025-03-13 15:54:52,878 [INFO]: 	avg_search_speed_ms: 12.694867589005131
2025-03-13 15:54:52,878 [INFO]: 	99p_search_speed_ms: 20.216508533339947
2025-03-13 15:54:52,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:52,878 [INFO]: 	nb vectors: 3020
2025-03-13 15:54:52,879 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:52,879 [INFO]: 	compression ratio: 0.999309873242371
2025-03-13 15:54:52,879 [INFO]: }
2025-03-13 15:54:52,879 [INFO]: 	>>> Finished "Creating the index" in 68.2190 secs
2025-03-13 15:54:52,879 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2491 secs
2025-03-13 15:54:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 52416 [episode count 9/20]
[retrieval_preprocessing] for episode 30940 [episode count 10/20], we have num_retrieval=np.int64(3032) num_query=np.int64(179)
2025-03-13 15:54:57,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:58,511 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:58
2025-03-13 15:54:58,511 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.07it/s]
2025-03-13 15:54:58,547 [INFO]: There are 3032 embeddings of dim 49152
2025-03-13 15:54:58,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 15:54:58,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:58
2025-03-13 15:54:58,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:58,548 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:54:58,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:58,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:58,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:58
2025-03-13 15:54:58,548 [INFO]: 625.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:58,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:58,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:58
2025-03-13 15:54:58,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:58,548 [INFO]: 	Creating the index 03/13/2025, 15:54:58
2025-03-13 15:54:58,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:58
2025-03-13 15:54:58,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:54:58,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:58
2025-03-13 15:54:58,550 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:54:58,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.94it/s] 42%|████▏     | 5/12 [00:00<00:00, 21.91it/s] 75%|███████▌  | 9/12 [00:00<00:00, 27.31it/s]100%|██████████| 12/12 [00:03<00:00,  2.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.75it/s]
2025-03-13 15:55:01,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:01
2025-03-13 15:55:38,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1962 secs
2025-03-13 15:55:38,949 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:55:38,949 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.78it/s]
2025-03-13 15:56:03,200 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2507 secs
2025-03-13 15:56:03,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1162 secs
2025-03-13 15:56:03,666 [INFO]: {
2025-03-13 15:56:03,666 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:03,666 [INFO]: 	index_param: efSearch=179
2025-03-13 15:56:03,667 [INFO]: 	index_path: knn.index
2025-03-13 15:56:03,667 [INFO]: 	size in bytes: 596527150
2025-03-13 15:56:03,667 [INFO]: 	avg_search_speed_ms: 12.281402952669312
2025-03-13 15:56:03,667 [INFO]: 	99p_search_speed_ms: 20.94993289327249
2025-03-13 15:56:03,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:03,667 [INFO]: 	nb vectors: 3032
2025-03-13 15:56:03,667 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:03,667 [INFO]: 	compression ratio: 0.9993098486799804
2025-03-13 15:56:03,667 [INFO]: }
2025-03-13 15:56:03,667 [INFO]: 	>>> Finished "Creating the index" in 65.1186 secs
2025-03-13 15:56:03,667 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1563 secs
2025-03-13 15:56:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 30940 [episode count 10/20]
[retrieval_preprocessing] for episode 91366 [episode count 11/20], we have num_retrieval=np.int64(3057) num_query=np.int64(154)
2025-03-13 15:56:05,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:06,312 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:06
2025-03-13 15:56:06,312 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-13 15:56:06,340 [INFO]: There are 3057 embeddings of dim 49152
2025-03-13 15:56:06,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:56:06,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:06
2025-03-13 15:56:06,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:06,341 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:56:06,341 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:06,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:56:06,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:06
2025-03-13 15:56:06,341 [INFO]: 630.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:06,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:56:06,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:06
2025-03-13 15:56:06,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:06,342 [INFO]: 	Creating the index 03/13/2025, 15:56:06
2025-03-13 15:56:06,342 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:06
2025-03-13 15:56:06,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:56:06,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:06
2025-03-13 15:56:06,343 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:56:06,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.40it/s] 31%|███       | 4/13 [00:00<00:00, 16.90it/s] 62%|██████▏   | 8/13 [00:00<00:00, 24.38it/s] 92%|█████████▏| 12/13 [00:00<00:00, 28.52it/s]100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
2025-03-13 15:56:09,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:09
2025-03-13 15:56:48,824 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3113 secs
2025-03-13 15:56:48,824 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:56:48,825 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 15:57:10,414 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5897 secs
2025-03-13 15:57:10,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0734 secs
2025-03-13 15:57:10,417 [INFO]: {
2025-03-13 15:57:10,417 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:10,417 [INFO]: 	index_param: efSearch=162
2025-03-13 15:57:10,417 [INFO]: 	index_path: knn.index
2025-03-13 15:57:10,417 [INFO]: 	size in bytes: 601445710
2025-03-13 15:57:10,417 [INFO]: 	avg_search_speed_ms: 8.632138681841486
2025-03-13 15:57:10,417 [INFO]: 	99p_search_speed_ms: 14.548454033210882
2025-03-13 15:57:10,417 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:10,417 [INFO]: 	nb vectors: 3057
2025-03-13 15:57:10,417 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:10,417 [INFO]: 	compression ratio: 0.9993099061260242
2025-03-13 15:57:10,417 [INFO]: }
2025-03-13 15:57:10,417 [INFO]: 	>>> Finished "Creating the index" in 64.0753 secs
2025-03-13 15:57:10,417 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1048 secs
2025-03-13 15:57:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 91366 [episode count 11/20]
[retrieval_preprocessing] for episode 21800 [episode count 12/20], we have num_retrieval=np.int64(3070) num_query=np.int64(141)
2025-03-13 15:57:11,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:12,179 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:12
2025-03-13 15:57:12,179 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.42it/s]
2025-03-13 15:57:12,211 [INFO]: There are 3070 embeddings of dim 49152
2025-03-13 15:57:12,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:57:12,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:12
2025-03-13 15:57:12,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:12,212 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:57:12,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:12,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:12,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:12
2025-03-13 15:57:12,213 [INFO]: 633.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:12,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:57:12,213 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:12
2025-03-13 15:57:12,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:12,213 [INFO]: 	Creating the index 03/13/2025, 15:57:12
2025-03-13 15:57:12,213 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:12
2025-03-13 15:57:12,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:57:12,214 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:12
2025-03-13 15:57:12,214 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:57:12,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.20it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.62it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.63it/s]100%|██████████| 13/13 [00:02<00:00,  4.37it/s]
2025-03-13 15:57:15,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:15
2025-03-13 15:58:02,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7402 secs
2025-03-13 15:58:02,935 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:58:02,935 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.46it/s]
2025-03-13 15:58:30,764 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8287 secs
2025-03-13 15:58:30,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5527 secs
2025-03-13 15:58:30,767 [INFO]: {
2025-03-13 15:58:30,767 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:30,767 [INFO]: 	index_param: efSearch=193
2025-03-13 15:58:30,767 [INFO]: 	index_path: knn.index
2025-03-13 15:58:30,767 [INFO]: 	size in bytes: 604003450
2025-03-13 15:58:30,767 [INFO]: 	avg_search_speed_ms: 10.016582301539744
2025-03-13 15:58:30,767 [INFO]: 	99p_search_speed_ms: 17.298721412662417
2025-03-13 15:58:30,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:30,767 [INFO]: 	nb vectors: 3070
2025-03-13 15:58:30,767 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:30,767 [INFO]: 	compression ratio: 0.9993097887106439
2025-03-13 15:58:30,767 [INFO]: }
2025-03-13 15:58:30,767 [INFO]: 	>>> Finished "Creating the index" in 78.5544 secs
2025-03-13 15:58:30,767 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5886 secs
2025-03-13 15:58:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 21800 [episode count 12/20]
[retrieval_preprocessing] for episode 58166 [episode count 13/20], we have num_retrieval=np.int64(3014) num_query=np.int64(197)
2025-03-13 15:58:32,911 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:33,560 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:33
2025-03-13 15:58:33,560 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.99it/s]
2025-03-13 15:58:33,593 [INFO]: There are 3014 embeddings of dim 49152
2025-03-13 15:58:33,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:58:33,594 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:33,594 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:58:33,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:33,595 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:58:33,595 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,595 [INFO]: 622.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:33,595 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:58:33,596 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:33
2025-03-13 15:58:33,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:33,596 [INFO]: 	Creating the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,596 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:33
2025-03-13 15:58:33,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:58:33,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:33
2025-03-13 15:58:33,600 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:58:33,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.24it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.79it/s]100%|██████████| 12/12 [00:02<00:00,  4.01it/s]100%|██████████| 12/12 [00:02<00:00,  4.89it/s]
2025-03-13 15:58:36,061 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:36
2025-03-13 15:59:14,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3315 secs
2025-03-13 15:59:14,393 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:59:14,393 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-13 15:59:43,157 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7635 secs
2025-03-13 15:59:43,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5600 secs
2025-03-13 15:59:43,160 [INFO]: {
2025-03-13 15:59:43,160 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:43,160 [INFO]: 	index_param: efSearch=154
2025-03-13 15:59:43,160 [INFO]: 	index_path: knn.index
2025-03-13 15:59:43,160 [INFO]: 	size in bytes: 592985770
2025-03-13 15:59:43,160 [INFO]: 	avg_search_speed_ms: 9.05656199429886
2025-03-13 15:59:43,160 [INFO]: 	99p_search_speed_ms: 13.891232325695455
2025-03-13 15:59:43,160 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:43,160 [INFO]: 	nb vectors: 3014
2025-03-13 15:59:43,160 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:43,160 [INFO]: 	compression ratio: 0.9993098350403923
2025-03-13 15:59:43,160 [INFO]: }
2025-03-13 15:59:43,160 [INFO]: 	>>> Finished "Creating the index" in 69.5642 secs
2025-03-13 15:59:43,160 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5999 secs
2025-03-13 15:59:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 58166 [episode count 13/20]
[retrieval_preprocessing] for episode 49655 [episode count 14/20], we have num_retrieval=np.int64(3063) num_query=np.int64(148)
2025-03-13 15:59:45,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:45,833 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:45
2025-03-13 15:59:45,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 823.38it/s]
2025-03-13 15:59:45,864 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 15:59:45,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 15:59:45,865 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:45
2025-03-13 15:59:45,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:45,865 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:59:45,865 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:45,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:45,865 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:45
2025-03-13 15:59:45,865 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:45,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:59:45,865 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:45
2025-03-13 15:59:45,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:45,865 [INFO]: 	Creating the index 03/13/2025, 15:59:45
2025-03-13 15:59:45,865 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:45
2025-03-13 15:59:45,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:59:45,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:45
2025-03-13 15:59:45,866 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:59:45,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.14it/s] 38%|███▊      | 5/13 [00:00<00:00, 20.44it/s] 69%|██████▉   | 9/13 [00:00<00:00, 26.77it/s]100%|██████████| 13/13 [00:03<00:00,  2.66it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]
2025-03-13 15:59:49,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:49
2025-03-13 16:00:35,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7561 secs
2025-03-13 16:00:35,251 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:00:35,251 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s]
2025-03-13 16:01:05,992 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7406 secs
2025-03-13 16:01:05,994 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.1277 secs
2025-03-13 16:01:05,994 [INFO]: {
2025-03-13 16:01:05,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:05,994 [INFO]: 	index_param: efSearch=219
2025-03-13 16:01:05,994 [INFO]: 	index_path: knn.index
2025-03-13 16:01:05,994 [INFO]: 	size in bytes: 602626270
2025-03-13 16:01:05,994 [INFO]: 	avg_search_speed_ms: 10.483772105115625
2025-03-13 16:01:05,994 [INFO]: 	99p_search_speed_ms: 15.543938935734332
2025-03-13 16:01:05,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:05,994 [INFO]: 	nb vectors: 3063
2025-03-13 16:01:05,994 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:05,994 [INFO]: 	compression ratio: 0.9993097446614798
2025-03-13 16:01:05,994 [INFO]: }
2025-03-13 16:01:05,994 [INFO]: 	>>> Finished "Creating the index" in 80.1292 secs
2025-03-13 16:01:05,994 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1614 secs
2025-03-13 16:01:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 49655 [episode count 14/20]
[retrieval_preprocessing] for episode 2557 [episode count 15/20], we have num_retrieval=np.int64(3077) num_query=np.int64(134)
2025-03-13 16:01:07,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:08,116 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:08
2025-03-13 16:01:08,116 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.16it/s]
2025-03-13 16:01:08,154 [INFO]: There are 3077 embeddings of dim 49152
2025-03-13 16:01:08,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 16:01:08,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:08
2025-03-13 16:01:08,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:08,154 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:01:08,154 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:08,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:08,154 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:08
2025-03-13 16:01:08,155 [INFO]: 635.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:08,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:01:08,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:08
2025-03-13 16:01:08,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:08,155 [INFO]: 	Creating the index 03/13/2025, 16:01:08
2025-03-13 16:01:08,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:08
2025-03-13 16:01:08,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:01:08,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:08
2025-03-13 16:01:08,156 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:01:08,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.50it/s] 38%|███▊      | 5/13 [00:00<00:00, 22.95it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.76it/s]100%|██████████| 13/13 [00:03<00:00,  2.67it/s]100%|██████████| 13/13 [00:03<00:00,  3.62it/s]
2025-03-13 16:01:11,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:11
2025-03-13 16:01:50,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8698 secs
2025-03-13 16:01:50,622 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 16:01:50,622 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 16:02:11,815 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1927 secs
2025-03-13 16:02:11,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6616 secs
2025-03-13 16:02:11,818 [INFO]: {
2025-03-13 16:02:11,818 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:11,818 [INFO]: 	index_param: efSearch=161
2025-03-13 16:02:11,818 [INFO]: 	index_path: knn.index
2025-03-13 16:02:11,818 [INFO]: 	size in bytes: 605380630
2025-03-13 16:02:11,818 [INFO]: 	avg_search_speed_ms: 12.840851693950947
2025-03-13 16:02:11,818 [INFO]: 	99p_search_speed_ms: 38.298976994119606
2025-03-13 16:02:11,818 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:11,818 [INFO]: 	nb vectors: 3077
2025-03-13 16:02:11,818 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:11,818 [INFO]: 	compression ratio: 0.9993098325593932
2025-03-13 16:02:11,818 [INFO]: }
2025-03-13 16:02:11,818 [INFO]: 	>>> Finished "Creating the index" in 63.6635 secs
2025-03-13 16:02:11,818 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7020 secs
2025-03-13 16:02:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 2557 [episode count 15/20]
[retrieval_preprocessing] for episode 69401 [episode count 16/20], we have num_retrieval=np.int64(3055) num_query=np.int64(156)
2025-03-13 16:02:13,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:13,745 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:13
2025-03-13 16:02:13,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.90it/s]
2025-03-13 16:02:13,775 [INFO]: There are 3055 embeddings of dim 49152
2025-03-13 16:02:13,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 16:02:13,775 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:13,775 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:02:13,775 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:13,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:02:13,775 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,775 [INFO]: 630.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:13,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:02:13,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:13
2025-03-13 16:02:13,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:13,776 [INFO]: 	Creating the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,776 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:13
2025-03-13 16:02:13,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:02:13,777 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:13
2025-03-13 16:02:13,777 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:02:13,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.96it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.22it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.06it/s]100%|██████████| 13/13 [00:03<00:00,  4.33it/s]
2025-03-13 16:02:16,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:16
2025-03-13 16:02:59,890 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1051 secs
2025-03-13 16:02:59,890 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 16:02:59,890 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.69it/s]
2025-03-13 16:03:42,661 [INFO]: 	>>> Finished "Compute fast metrics" in 42.7700 secs
2025-03-13 16:03:42,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.8855 secs
2025-03-13 16:03:42,663 [INFO]: {
2025-03-13 16:03:42,663 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:42,663 [INFO]: 	index_param: efSearch=209
2025-03-13 16:03:42,663 [INFO]: 	index_path: knn.index
2025-03-13 16:03:42,663 [INFO]: 	size in bytes: 601052230
2025-03-13 16:03:42,663 [INFO]: 	avg_search_speed_ms: 9.79416035220618
2025-03-13 16:03:42,663 [INFO]: 	99p_search_speed_ms: 14.995625941082833
2025-03-13 16:03:42,663 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:42,663 [INFO]: 	nb vectors: 3055
2025-03-13 16:03:42,663 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:42,663 [INFO]: 	compression ratio: 0.9993098935844561
2025-03-13 16:03:42,663 [INFO]: }
2025-03-13 16:03:42,663 [INFO]: 	>>> Finished "Creating the index" in 88.8873 secs
2025-03-13 16:03:42,663 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9177 secs
2025-03-13 16:03:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 69401 [episode count 16/20]
[retrieval_preprocessing] for episode 56097 [episode count 17/20], we have num_retrieval=np.int64(3035) num_query=np.int64(176)
2025-03-13 16:03:54,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:55,546 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:55
2025-03-13 16:03:55,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-13 16:03:55,579 [INFO]: There are 3035 embeddings of dim 49152
2025-03-13 16:03:55,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 16:03:55,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:55,580 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:03:55,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:55,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:03:55,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,581 [INFO]: 626.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:55,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:03:55,581 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:55
2025-03-13 16:03:55,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:55,582 [INFO]: 	Creating the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,582 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:55
2025-03-13 16:03:55,584 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:03:55,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,585 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:03:55,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 28.66it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.55it/s]100%|██████████| 12/12 [00:02<00:00,  4.91it/s]
2025-03-13 16:03:58,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:58
2025-03-13 16:04:47,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1752 secs
2025-03-13 16:04:47,210 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 16:04:47,210 [INFO]: 	Compute fast metrics 03/13/2025, 16:04:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 16:05:04,819 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6081 secs
2025-03-13 16:05:04,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2360 secs
2025-03-13 16:05:04,821 [INFO]: {
2025-03-13 16:05:04,821 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:04,821 [INFO]: 	index_param: efSearch=152
2025-03-13 16:05:04,821 [INFO]: 	index_path: knn.index
2025-03-13 16:05:04,821 [INFO]: 	size in bytes: 597117370
2025-03-13 16:05:04,821 [INFO]: 	avg_search_speed_ms: 9.432502113994351
2025-03-13 16:05:04,821 [INFO]: 	99p_search_speed_ms: 15.025077427271759
2025-03-13 16:05:04,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:04,821 [INFO]: 	nb vectors: 3035
2025-03-13 16:05:04,821 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:04,821 [INFO]: 	compression ratio: 0.999309867673084
2025-03-13 16:05:04,821 [INFO]: }
2025-03-13 16:05:04,821 [INFO]: 	>>> Finished "Creating the index" in 69.2397 secs
2025-03-13 16:05:04,821 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2753 secs
2025-03-13 16:05:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 56097 [episode count 17/20]
[retrieval_preprocessing] for episode 65913 [episode count 18/20], we have num_retrieval=np.int64(3031) num_query=np.int64(180)
2025-03-13 16:05:06,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:06,797 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:06
2025-03-13 16:05:06,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1568.55it/s]
2025-03-13 16:05:06,829 [INFO]: There are 3031 embeddings of dim 49152
2025-03-13 16:05:06,829 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 16:05:06,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:06
2025-03-13 16:05:06,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:06,830 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:05:06,830 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:06,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:05:06,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:06
2025-03-13 16:05:06,831 [INFO]: 625.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:06,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:05:06,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:06
2025-03-13 16:05:06,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:06,831 [INFO]: 	Creating the index 03/13/2025, 16:05:06
2025-03-13 16:05:06,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:06
2025-03-13 16:05:06,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:05:06,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:06
2025-03-13 16:05:06,835 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:05:06,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.28it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.12it/s]100%|██████████| 12/12 [00:03<00:00,  3.24it/s]100%|██████████| 12/12 [00:03<00:00,  3.98it/s]
2025-03-13 16:05:09,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:09
2025-03-13 16:05:51,022 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1504 secs
2025-03-13 16:05:51,023 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 16:05:51,023 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 16:06:17,710 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6869 secs
2025-03-13 16:06:18,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2797 secs
2025-03-13 16:06:18,115 [INFO]: {
2025-03-13 16:06:18,115 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:18,115 [INFO]: 	index_param: efSearch=210
2025-03-13 16:06:18,115 [INFO]: 	index_path: knn.index
2025-03-13 16:06:18,115 [INFO]: 	size in bytes: 596330350
2025-03-13 16:06:18,116 [INFO]: 	avg_search_speed_ms: 12.614528933648034
2025-03-13 16:06:18,116 [INFO]: 	99p_search_speed_ms: 25.134396366775054
2025-03-13 16:06:18,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:18,116 [INFO]: 	nb vectors: 3031
2025-03-13 16:06:18,116 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:18,116 [INFO]: 	compression ratio: 0.9993099428865225
2025-03-13 16:06:18,116 [INFO]: }
2025-03-13 16:06:18,116 [INFO]: 	>>> Finished "Creating the index" in 71.2844 secs
2025-03-13 16:06:18,116 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3191 secs
2025-03-13 16:06:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 65913 [episode count 18/20]
[retrieval_preprocessing] for episode 19328 [episode count 19/20], we have num_retrieval=np.int64(3033) num_query=np.int64(178)
2025-03-13 16:06:21,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:21,688 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:21
2025-03-13 16:06:21,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1286.20it/s]
2025-03-13 16:06:21,717 [INFO]: There are 3033 embeddings of dim 49152
2025-03-13 16:06:21,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 16:06:21,718 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:21
2025-03-13 16:06:21,718 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:21,718 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 16:06:21,718 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:21,718 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:21,718 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:21
2025-03-13 16:06:21,718 [INFO]: 625.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:21,718 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:06:21,718 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:21
2025-03-13 16:06:21,718 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:21,718 [INFO]: 	Creating the index 03/13/2025, 16:06:21
2025-03-13 16:06:21,718 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:21
2025-03-13 16:06:21,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:06:21,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:21
2025-03-13 16:06:21,720 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 16:06:21,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.99it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.61it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.31it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.98it/s] 50%|█████     | 6/12 [00:00<00:00,  8.99it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.42it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.64it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.67it/s]100%|██████████| 12/12 [00:03<00:00,  1.38it/s]100%|██████████| 12/12 [00:03<00:00,  3.00it/s]
2025-03-13 16:06:25,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:25
2025-03-13 16:07:10,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2857 secs
2025-03-13 16:07:10,013 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 16:07:10,013 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s]
2025-03-13 16:07:33,059 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0463 secs
2025-03-13 16:07:33,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3423 secs
2025-03-13 16:07:33,062 [INFO]: {
2025-03-13 16:07:33,062 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:33,062 [INFO]: 	index_param: efSearch=153
2025-03-13 16:07:33,062 [INFO]: 	index_path: knn.index
2025-03-13 16:07:33,062 [INFO]: 	size in bytes: 596723890
2025-03-13 16:07:33,062 [INFO]: 	avg_search_speed_ms: 11.093085266331357
2025-03-13 16:07:33,062 [INFO]: 	99p_search_speed_ms: 27.60970196686685
2025-03-13 16:07:33,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:33,063 [INFO]: 	nb vectors: 3033
2025-03-13 16:07:33,063 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:33,063 [INFO]: 	compression ratio: 0.9993098550151897
2025-03-13 16:07:33,063 [INFO]: }
2025-03-13 16:07:33,063 [INFO]: 	>>> Finished "Creating the index" in 71.3444 secs
2025-03-13 16:07:33,063 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3748 secs
2025-03-13 16:07:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 19328 [episode count 19/20]
2025-03-13 16:07:34: [retrieval_preprocessing] finished for 8481266618_put_cable_in_compartment [chosen_id count 3/196]
2025-03-13 16:07:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8626796008_fold_towel [chosen_id count 4/196]
2025-03-13 16:07:36: [retrieval_preprocessing] we have num_total=6806 embedding_dim=49152
[retrieval_preprocessing] for episode 55305 [episode count 0/20], we have num_retrieval=np.int64(6538) num_query=np.int64(268)
2025-03-13 16:07:37,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:38,489 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:38
2025-03-13 16:07:38,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 12.85it/s]
2025-03-13 16:07:38,603 [INFO]: There are 6538 embeddings of dim 49152
2025-03-13 16:07:38,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1150 secs
2025-03-13 16:07:38,604 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:38
2025-03-13 16:07:38,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:38,604 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:07:38,604 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:38,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:07:38,605 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:38
2025-03-13 16:07:38,605 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:38,605 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:07:38,605 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:38
2025-03-13 16:07:38,605 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:38,605 [INFO]: 	Creating the index 03/13/2025, 16:07:38
2025-03-13 16:07:38,605 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:38
2025-03-13 16:07:38,609 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:07:38,609 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:38
2025-03-13 16:07:38,609 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:07:38,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:02,  9.30it/s] 19%|█▊        | 5/27 [00:00<00:00, 26.36it/s] 33%|███▎      | 9/27 [00:00<00:00, 31.53it/s] 52%|█████▏    | 14/27 [00:00<00:00, 36.01it/s] 70%|███████   | 19/27 [00:00<00:00, 38.28it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.35it/s]100%|██████████| 27/27 [00:08<00:00,  1.94it/s]100%|██████████| 27/27 [00:08<00:00,  3.18it/s]
2025-03-13 16:07:47,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:47
2025-03-13 16:08:58,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.7393 secs
2025-03-13 16:08:58,507 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:08:58,507 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.45it/s]
2025-03-13 16:10:20,958 [INFO]: 	>>> Finished "Compute fast metrics" in 82.4508 secs
2025-03-13 16:10:20,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 162.3506 secs
2025-03-13 16:10:20,960 [INFO]: {
2025-03-13 16:10:20,960 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:20,960 [INFO]: 	index_param: efSearch=185
2025-03-13 16:10:20,960 [INFO]: 	index_path: knn.index
2025-03-13 16:10:20,960 [INFO]: 	size in bytes: 1286312590
2025-03-13 16:10:20,960 [INFO]: 	avg_search_speed_ms: 13.02327280730727
2025-03-13 16:10:20,960 [INFO]: 	99p_search_speed_ms: 26.661888605449352
2025-03-13 16:10:20,960 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:20,960 [INFO]: 	nb vectors: 6538
2025-03-13 16:10:20,960 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:20,960 [INFO]: 	compression ratio: 0.9993084993438492
2025-03-13 16:10:20,960 [INFO]: }
2025-03-13 16:10:20,960 [INFO]: 	>>> Finished "Creating the index" in 162.3549 secs
2025-03-13 16:10:20,960 [INFO]: >>> Finished "Launching the whole pipeline" in 162.4717 secs
2025-03-13 16:10:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 55305 [episode count 0/20]
[retrieval_preprocessing] for episode 12324 [episode count 1/20], we have num_retrieval=np.int64(6246) num_query=np.int64(560)
2025-03-13 16:10:25,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:26,364 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:26
2025-03-13 16:10:26,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1054.11it/s]
2025-03-13 16:10:26,400 [INFO]: There are 6246 embeddings of dim 49152
2025-03-13 16:10:26,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 16:10:26,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:26
2025-03-13 16:10:26,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:26,400 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:10:26,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:26,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:26,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:26
2025-03-13 16:10:26,401 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:26,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:26,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:26
2025-03-13 16:10:26,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:26,401 [INFO]: 	Creating the index 03/13/2025, 16:10:26
2025-03-13 16:10:26,401 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:26
2025-03-13 16:10:26,402 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:10:26,402 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:26
2025-03-13 16:10:26,402 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:10:26,402 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  7.36it/s] 19%|█▉        | 5/26 [00:00<00:00, 22.00it/s] 35%|███▍      | 9/26 [00:00<00:00, 27.70it/s] 50%|█████     | 13/26 [00:00<00:00, 30.66it/s] 65%|██████▌   | 17/26 [00:00<00:00, 32.15it/s] 81%|████████  | 21/26 [00:06<00:02,  1.81it/s] 96%|█████████▌| 25/26 [00:06<00:00,  2.66it/s]100%|██████████| 26/26 [00:09<00:00,  2.79it/s]
2025-03-13 16:10:35,741 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:35
2025-03-13 16:11:42,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.0348 secs
2025-03-13 16:11:42,776 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:11:42,777 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 16:12:21,370 [INFO]: 	>>> Finished "Compute fast metrics" in 38.5931 secs
2025-03-13 16:12:21,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.9686 secs
2025-03-13 16:12:21,371 [INFO]: {
2025-03-13 16:12:21,371 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:21,371 [INFO]: 	index_param: efSearch=185
2025-03-13 16:12:21,371 [INFO]: 	index_path: knn.index
2025-03-13 16:12:21,371 [INFO]: 	size in bytes: 1228863490
2025-03-13 16:12:21,371 [INFO]: 	avg_search_speed_ms: 10.06137667728824
2025-03-13 16:12:21,371 [INFO]: 	99p_search_speed_ms: 14.288099266123018
2025-03-13 16:12:21,371 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:21,371 [INFO]: 	nb vectors: 6246
2025-03-13 16:12:21,371 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:21,371 [INFO]: 	compression ratio: 0.9993083674412038
2025-03-13 16:12:21,371 [INFO]: }
2025-03-13 16:12:21,371 [INFO]: 	>>> Finished "Creating the index" in 114.9702 secs
2025-03-13 16:12:21,371 [INFO]: >>> Finished "Launching the whole pipeline" in 115.0067 secs
2025-03-13 16:12:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 12324 [episode count 1/20]
[retrieval_preprocessing] for episode 47195 [episode count 2/20], we have num_retrieval=np.int64(6456) num_query=np.int64(350)
2025-03-13 16:12:28,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:29,329 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:29
2025-03-13 16:12:29,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-13 16:12:29,361 [INFO]: There are 6456 embeddings of dim 49152
2025-03-13 16:12:29,361 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 16:12:29,361 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:29
2025-03-13 16:12:29,361 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:29,361 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:12:29,361 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:29,361 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:12:29,361 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:29
2025-03-13 16:12:29,362 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:29,362 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:12:29,362 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:29
2025-03-13 16:12:29,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:29,362 [INFO]: 	Creating the index 03/13/2025, 16:12:29
2025-03-13 16:12:29,362 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:29
2025-03-13 16:12:29,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:12:29,363 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:29
2025-03-13 16:12:29,363 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:12:29,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  8.29it/s] 22%|██▏       | 6/27 [00:00<00:00, 27.50it/s] 41%|████      | 11/27 [00:00<00:00, 34.69it/s] 59%|█████▉    | 16/27 [00:00<00:00, 38.32it/s] 78%|███████▊  | 21/27 [00:05<00:02,  2.50it/s] 96%|█████████▋| 26/27 [00:05<00:00,  3.76it/s]100%|██████████| 27/27 [00:07<00:00,  3.43it/s]
2025-03-13 16:12:37,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:37
2025-03-13 16:14:02,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.2604 secs
2025-03-13 16:14:02,495 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:14:02,495 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.97it/s]
2025-03-13 16:14:49,027 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5318 secs
2025-03-13 16:14:49,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.6658 secs
2025-03-13 16:14:49,029 [INFO]: {
2025-03-13 16:14:49,029 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:49,029 [INFO]: 	index_param: efSearch=225
2025-03-13 16:14:49,029 [INFO]: 	index_path: knn.index
2025-03-13 16:14:49,029 [INFO]: 	size in bytes: 1270179790
2025-03-13 16:14:49,029 [INFO]: 	avg_search_speed_ms: 13.13696107814905
2025-03-13 16:14:49,029 [INFO]: 	99p_search_speed_ms: 22.452836397569627
2025-03-13 16:14:49,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:49,029 [INFO]: 	nb vectors: 6456
2025-03-13 16:14:49,029 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:49,029 [INFO]: 	compression ratio: 0.9993083325629043
2025-03-13 16:14:49,029 [INFO]: }
2025-03-13 16:14:49,029 [INFO]: 	>>> Finished "Creating the index" in 139.6676 secs
2025-03-13 16:14:49,029 [INFO]: >>> Finished "Launching the whole pipeline" in 139.7005 secs
2025-03-13 16:14:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 47195 [episode count 2/20]
[retrieval_preprocessing] for episode 30814 [episode count 3/20], we have num_retrieval=np.int64(6504) num_query=np.int64(302)
2025-03-13 16:14:52,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:53,670 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:53
2025-03-13 16:14:53,671 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.35it/s]
2025-03-13 16:14:53,702 [INFO]: There are 6504 embeddings of dim 49152
2025-03-13 16:14:53,702 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 16:14:53,702 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:53
2025-03-13 16:14:53,702 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:53,703 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:14:53,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:53,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:14:53,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:53
2025-03-13 16:14:53,703 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:53,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:14:53,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:53
2025-03-13 16:14:53,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:53,703 [INFO]: 	Creating the index 03/13/2025, 16:14:53
2025-03-13 16:14:53,703 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:53
2025-03-13 16:14:53,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 16:14:53,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:53
2025-03-13 16:14:53,705 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:14:53,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  7.73it/s] 22%|██▏       | 6/27 [00:00<00:00, 27.20it/s] 41%|████      | 11/27 [00:00<00:00, 34.67it/s] 59%|█████▉    | 16/27 [00:00<00:00, 38.65it/s] 78%|███████▊  | 21/27 [00:04<00:01,  3.06it/s] 96%|█████████▋| 26/27 [00:04<00:00,  4.56it/s]100%|██████████| 27/27 [00:07<00:00,  3.67it/s]
2025-03-13 16:15:01,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:01
2025-03-13 16:16:06,169 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1015 secs
2025-03-13 16:16:06,170 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:16:06,170 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.98it/s]
2025-03-13 16:17:16,536 [INFO]: 	>>> Finished "Compute fast metrics" in 70.3660 secs
2025-03-13 16:17:16,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.8324 secs
2025-03-13 16:17:16,538 [INFO]: {
2025-03-13 16:17:16,538 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:16,538 [INFO]: 	index_param: efSearch=225
2025-03-13 16:17:16,538 [INFO]: 	index_path: knn.index
2025-03-13 16:17:16,538 [INFO]: 	size in bytes: 1279623370
2025-03-13 16:17:16,538 [INFO]: 	avg_search_speed_ms: 13.892799790159593
2025-03-13 16:17:16,538 [INFO]: 	99p_search_speed_ms: 26.43841904820873
2025-03-13 16:17:16,538 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:16,538 [INFO]: 	nb vectors: 6504
2025-03-13 16:17:16,538 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:16,538 [INFO]: 	compression ratio: 0.9993084387009906
2025-03-13 16:17:16,538 [INFO]: }
2025-03-13 16:17:16,538 [INFO]: 	>>> Finished "Creating the index" in 142.8347 secs
2025-03-13 16:17:16,538 [INFO]: >>> Finished "Launching the whole pipeline" in 142.8675 secs
2025-03-13 16:17:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 30814 [episode count 3/20]
[retrieval_preprocessing] for episode 65705 [episode count 4/20], we have num_retrieval=np.int64(6259) num_query=np.int64(547)
2025-03-13 16:17:19,898 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:20,966 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:20
2025-03-13 16:17:20,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-13 16:17:21,399 [INFO]: There are 6259 embeddings of dim 49152
2025-03-13 16:17:21,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4337 secs
2025-03-13 16:17:21,400 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:21
2025-03-13 16:17:21,400 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:21,400 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:17:21,400 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:21,400 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:21,400 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:21
2025-03-13 16:17:21,400 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:21,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:17:21,400 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:21
2025-03-13 16:17:21,400 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:21,400 [INFO]: 	Creating the index 03/13/2025, 16:17:21
2025-03-13 16:17:21,400 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:21
2025-03-13 16:17:21,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:17:21,401 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:21
2025-03-13 16:17:21,401 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:17:21,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  6.77it/s] 23%|██▎       | 6/26 [00:00<00:00, 25.64it/s] 42%|████▏     | 11/26 [00:00<00:00, 33.25it/s] 62%|██████▏   | 16/26 [00:00<00:00, 37.26it/s] 81%|████████  | 21/26 [00:06<00:02,  2.14it/s] 96%|█████████▌| 25/26 [00:06<00:00,  3.01it/s]100%|██████████| 26/26 [00:08<00:00,  2.91it/s]
2025-03-13 16:17:30,339 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:30
2025-03-13 16:18:33,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6695 secs
2025-03-13 16:18:33,009 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 16:18:33,009 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.04s/it] 50%|█████     | 2/4 [00:01<00:01,  1.89it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.50it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.25it/s]
2025-03-13 16:19:18,354 [INFO]: 	>>> Finished "Compute fast metrics" in 45.3448 secs
2025-03-13 16:19:18,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.9546 secs
2025-03-13 16:19:18,356 [INFO]: {
2025-03-13 16:19:18,356 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:18,356 [INFO]: 	index_param: efSearch=174
2025-03-13 16:19:18,356 [INFO]: 	index_path: knn.index
2025-03-13 16:19:18,356 [INFO]: 	size in bytes: 1231421110
2025-03-13 16:19:18,356 [INFO]: 	avg_search_speed_ms: 11.692090500167911
2025-03-13 16:19:18,356 [INFO]: 	99p_search_speed_ms: 22.75220878655094
2025-03-13 16:19:18,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:18,356 [INFO]: 	nb vectors: 6259
2025-03-13 16:19:18,356 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:18,356 [INFO]: 	compression ratio: 0.9993084104267143
2025-03-13 16:19:18,356 [INFO]: }
2025-03-13 16:19:18,356 [INFO]: 	>>> Finished "Creating the index" in 116.9563 secs
2025-03-13 16:19:18,356 [INFO]: >>> Finished "Launching the whole pipeline" in 117.3907 secs
2025-03-13 16:19:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65705 [episode count 4/20]
[retrieval_preprocessing] for episode 57555 [episode count 5/20], we have num_retrieval=np.int64(6533) num_query=np.int64(273)
2025-03-13 16:19:25,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:27,201 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:27
2025-03-13 16:19:27,201 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.52it/s]
2025-03-13 16:19:27,241 [INFO]: There are 6533 embeddings of dim 49152
2025-03-13 16:19:27,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 16:19:27,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:27
2025-03-13 16:19:27,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:27,242 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:19:27,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:27,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:19:27,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:27
2025-03-13 16:19:27,243 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:27,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:19:27,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:27
2025-03-13 16:19:27,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:27,244 [INFO]: 	Creating the index 03/13/2025, 16:19:27
2025-03-13 16:19:27,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:27
2025-03-13 16:19:27,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 16:19:27,248 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:27
2025-03-13 16:19:27,248 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:19:27,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  7.23it/s] 19%|█▊        | 5/27 [00:00<00:01, 21.34it/s] 30%|██▉       | 8/27 [00:00<00:00, 24.53it/s] 44%|████▍     | 12/27 [00:00<00:00, 27.96it/s] 59%|█████▉    | 16/27 [00:00<00:00, 29.90it/s] 74%|███████▍  | 20/27 [00:00<00:00, 30.90it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.20it/s]100%|██████████| 27/27 [00:08<00:00,  1.71it/s]100%|██████████| 27/27 [00:08<00:00,  3.14it/s]
2025-03-13 16:19:35,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:35
2025-03-13 16:20:36,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3723 secs
2025-03-13 16:20:36,223 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 16:20:36,223 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 16:21:26,057 [INFO]: 	>>> Finished "Compute fast metrics" in 49.8343 secs
2025-03-13 16:21:26,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.8110 secs
2025-03-13 16:21:26,059 [INFO]: {
2025-03-13 16:21:26,059 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:26,059 [INFO]: 	index_param: efSearch=119
2025-03-13 16:21:26,059 [INFO]: 	index_path: knn.index
2025-03-13 16:21:26,059 [INFO]: 	size in bytes: 1285328890
2025-03-13 16:21:26,059 [INFO]: 	avg_search_speed_ms: 7.550783740782834
2025-03-13 16:21:26,059 [INFO]: 	99p_search_speed_ms: 12.626312260981647
2025-03-13 16:21:26,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:26,059 [INFO]: 	nb vectors: 6533
2025-03-13 16:21:26,059 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:26,059 [INFO]: 	compression ratio: 0.9993084836053129
2025-03-13 16:21:26,059 [INFO]: }
2025-03-13 16:21:26,059 [INFO]: 	>>> Finished "Creating the index" in 118.8154 secs
2025-03-13 16:21:26,059 [INFO]: >>> Finished "Launching the whole pipeline" in 118.8587 secs
2025-03-13 16:21:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 57555 [episode count 5/20]
[retrieval_preprocessing] for episode 90641 [episode count 6/20], we have num_retrieval=np.int64(6491) num_query=np.int64(315)
2025-03-13 16:21:28,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:29,969 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:29
2025-03-13 16:21:29,969 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1778.00it/s]
2025-03-13 16:21:29,998 [INFO]: There are 6491 embeddings of dim 49152
2025-03-13 16:21:29,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 16:21:29,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:29,998 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:21:29,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:29,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:29,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,998 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:29,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:29,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:29
2025-03-13 16:21:29,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:29,999 [INFO]: 	Creating the index 03/13/2025, 16:21:29
2025-03-13 16:21:29,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:29
2025-03-13 16:21:30,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:21:30,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:30
2025-03-13 16:21:30,000 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:21:30,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  7.00it/s] 15%|█▍        | 4/27 [00:00<00:01, 18.42it/s] 30%|██▉       | 8/27 [00:00<00:00, 27.37it/s] 44%|████▍     | 12/27 [00:00<00:00, 31.91it/s] 59%|█████▉    | 16/27 [00:00<00:00, 33.94it/s] 74%|███████▍  | 20/27 [00:00<00:00, 35.81it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.00it/s]100%|██████████| 27/27 [00:09<00:00,  1.61it/s]100%|██████████| 27/27 [00:09<00:00,  2.96it/s]
2025-03-13 16:21:39,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:39
2025-03-13 16:22:40,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2163 secs
2025-03-13 16:22:40,355 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:22:40,355 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 16:23:42,728 [INFO]: 	>>> Finished "Compute fast metrics" in 62.3727 secs
2025-03-13 16:23:43,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.3868 secs
2025-03-13 16:23:43,387 [INFO]: {
2025-03-13 16:23:43,387 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:43,387 [INFO]: 	index_param: efSearch=242
2025-03-13 16:23:43,387 [INFO]: 	index_path: knn.index
2025-03-13 16:23:43,387 [INFO]: 	size in bytes: 1277065750
2025-03-13 16:23:43,387 [INFO]: 	avg_search_speed_ms: 16.15733696224532
2025-03-13 16:23:43,387 [INFO]: 	99p_search_speed_ms: 27.104035736992962
2025-03-13 16:23:43,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:43,387 [INFO]: 	nb vectors: 6491
2025-03-13 16:23:43,388 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:43,388 [INFO]: 	compression ratio: 0.9993083973945742
2025-03-13 16:23:43,388 [INFO]: }
2025-03-13 16:23:43,388 [INFO]: 	>>> Finished "Creating the index" in 133.3891 secs
2025-03-13 16:23:43,388 [INFO]: >>> Finished "Launching the whole pipeline" in 133.4184 secs
2025-03-13 16:23:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 90641 [episode count 6/20]
[retrieval_preprocessing] for episode 47913 [episode count 7/20], we have num_retrieval=np.int64(6424) num_query=np.int64(382)
2025-03-13 16:23:47,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:49,393 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:49
2025-03-13 16:23:49,393 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 16:23:49,423 [INFO]: There are 6424 embeddings of dim 49152
2025-03-13 16:23:49,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 16:23:49,423 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:49,423 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:23:49,423 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:49,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:49,423 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,424 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:49,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:49,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:49
2025-03-13 16:23:49,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:49,424 [INFO]: 	Creating the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,424 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:49
2025-03-13 16:23:49,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:23:49,425 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:49
2025-03-13 16:23:49,425 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:23:49,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:02,  9.49it/s] 22%|██▏       | 6/27 [00:00<00:00, 31.69it/s] 41%|████      | 11/27 [00:00<00:00, 39.49it/s] 59%|█████▉    | 16/27 [00:00<00:00, 43.47it/s] 78%|███████▊  | 21/27 [00:04<00:02,  2.79it/s] 89%|████████▉ | 24/27 [00:05<00:00,  3.38it/s]100%|██████████| 27/27 [00:08<00:00,  2.10it/s]100%|██████████| 27/27 [00:08<00:00,  3.32it/s]
2025-03-13 16:23:57,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:57
2025-03-13 16:25:09,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.9964 secs
2025-03-13 16:25:09,561 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 16:25:09,561 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.44it/s] 50%|█████     | 2/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 16:25:45,604 [INFO]: 	>>> Finished "Compute fast metrics" in 36.0430 secs
2025-03-13 16:25:45,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.1806 secs
2025-03-13 16:25:45,606 [INFO]: {
2025-03-13 16:25:45,606 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:45,606 [INFO]: 	index_param: efSearch=175
2025-03-13 16:25:45,606 [INFO]: 	index_path: knn.index
2025-03-13 16:25:45,606 [INFO]: 	size in bytes: 1263883870
2025-03-13 16:25:45,606 [INFO]: 	avg_search_speed_ms: 12.665630423145581
2025-03-13 16:25:45,606 [INFO]: 	99p_search_speed_ms: 24.977474485058377
2025-03-13 16:25:45,606 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:45,606 [INFO]: 	nb vectors: 6424
2025-03-13 16:25:45,606 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:45,606 [INFO]: 	compression ratio: 0.9993084190559375
2025-03-13 16:25:45,606 [INFO]: }
2025-03-13 16:25:45,606 [INFO]: 	>>> Finished "Creating the index" in 116.1824 secs
2025-03-13 16:25:45,606 [INFO]: >>> Finished "Launching the whole pipeline" in 116.2132 secs
2025-03-13 16:25:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 47913 [episode count 7/20]
[retrieval_preprocessing] for episode 88806 [episode count 8/20], we have num_retrieval=np.int64(6336) num_query=np.int64(470)
2025-03-13 16:25:51,023 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:51,985 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:51
2025-03-13 16:25:51,985 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.99it/s]
2025-03-13 16:25:52,017 [INFO]: There are 6336 embeddings of dim 49152
2025-03-13 16:25:52,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:25:52,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:52
2025-03-13 16:25:52,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:52,018 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:25:52,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:52,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:52,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:52
2025-03-13 16:25:52,018 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:52,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:25:52,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:52
2025-03-13 16:25:52,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:52,018 [INFO]: 	Creating the index 03/13/2025, 16:25:52
2025-03-13 16:25:52,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:52
2025-03-13 16:25:52,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:25:52,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:52
2025-03-13 16:25:52,020 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:25:52,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.22it/s] 12%|█▏        | 3/26 [00:00<00:02,  8.90it/s] 19%|█▉        | 5/26 [00:00<00:02,  9.85it/s] 27%|██▋       | 7/26 [00:00<00:01, 10.99it/s] 35%|███▍      | 9/26 [00:00<00:01, 11.52it/s] 42%|████▏     | 11/26 [00:01<00:01, 11.65it/s] 50%|█████     | 13/26 [00:01<00:01, 11.78it/s] 58%|█████▊    | 15/26 [00:01<00:00, 11.63it/s] 65%|██████▌   | 17/26 [00:01<00:00, 11.41it/s] 73%|███████▎  | 19/26 [00:01<00:00, 11.07it/s] 81%|████████  | 21/26 [00:06<00:04,  1.22it/s] 85%|████████▍ | 22/26 [00:06<00:02,  1.44it/s] 92%|█████████▏| 24/26 [00:06<00:00,  2.03it/s]100%|██████████| 26/26 [00:09<00:00,  1.39it/s]100%|██████████| 26/26 [00:09<00:00,  2.77it/s]
2025-03-13 16:26:01,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:01
2025-03-13 16:27:00,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1666 secs
2025-03-13 16:27:00,588 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 16:27:00,589 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.45it/s] 50%|█████     | 2/4 [00:00<00:00,  4.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.10it/s]
2025-03-13 16:27:25,900 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3110 secs
2025-03-13 16:27:27,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.0099 secs
2025-03-13 16:27:27,030 [INFO]: {
2025-03-13 16:27:27,030 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:27,030 [INFO]: 	index_param: efSearch=133
2025-03-13 16:27:27,030 [INFO]: 	index_path: knn.index
2025-03-13 16:27:27,030 [INFO]: 	size in bytes: 1246570450
2025-03-13 16:27:27,030 [INFO]: 	avg_search_speed_ms: 9.634750628949776
2025-03-13 16:27:27,030 [INFO]: 	99p_search_speed_ms: 17.70368230994786
2025-03-13 16:27:27,030 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:27,030 [INFO]: 	nb vectors: 6336
2025-03-13 16:27:27,030 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:27,030 [INFO]: 	compression ratio: 0.9993083728240149
2025-03-13 16:27:27,030 [INFO]: }
2025-03-13 16:27:27,031 [INFO]: 	>>> Finished "Creating the index" in 95.0125 secs
2025-03-13 16:27:27,031 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0452 secs
2025-03-13 16:27:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 88806 [episode count 8/20]
[retrieval_preprocessing] for episode 7120 [episode count 9/20], we have num_retrieval=np.int64(6421) num_query=np.int64(385)
2025-03-13 16:27:33,400 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:34,368 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:34
2025-03-13 16:27:34,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.14it/s]
2025-03-13 16:27:34,397 [INFO]: There are 6421 embeddings of dim 49152
2025-03-13 16:27:34,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 16:27:34,398 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:34
2025-03-13 16:27:34,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:34,399 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:27:34,399 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:34,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:27:34,399 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:34
2025-03-13 16:27:34,399 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:34,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:27:34,400 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:34
2025-03-13 16:27:34,400 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:34,400 [INFO]: 	Creating the index 03/13/2025, 16:27:34
2025-03-13 16:27:34,400 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:34
2025-03-13 16:27:34,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:27:34,404 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:34
2025-03-13 16:27:34,404 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:27:34,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.35it/s] 11%|█         | 3/27 [00:00<00:02,  8.67it/s] 19%|█▊        | 5/27 [00:00<00:02,  9.80it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.36it/s] 33%|███▎      | 9/27 [00:00<00:01, 10.70it/s] 41%|████      | 11/27 [00:01<00:01, 10.93it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.15it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.22it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.33it/s] 70%|███████   | 19/27 [00:01<00:00, 11.34it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.25it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.49it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.11it/s] 96%|█████████▋| 26/27 [00:07<00:00,  2.88it/s]100%|██████████| 27/27 [00:09<00:00,  2.79it/s]
2025-03-13 16:27:44,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:44
2025-03-13 16:28:37,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.2177 secs
2025-03-13 16:28:37,290 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 16:28:37,290 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 16:29:27,482 [INFO]: 	>>> Finished "Compute fast metrics" in 50.1916 secs
2025-03-13 16:29:27,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.0795 secs
2025-03-13 16:29:27,484 [INFO]: {
2025-03-13 16:29:27,484 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:27,484 [INFO]: 	index_param: efSearch=268
2025-03-13 16:29:27,484 [INFO]: 	index_path: knn.index
2025-03-13 16:29:27,484 [INFO]: 	size in bytes: 1263293650
2025-03-13 16:29:27,484 [INFO]: 	avg_search_speed_ms: 16.101649799271698
2025-03-13 16:29:27,484 [INFO]: 	99p_search_speed_ms: 31.088331341743448
2025-03-13 16:29:27,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:27,484 [INFO]: 	nb vectors: 6421
2025-03-13 16:29:27,484 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:27,484 [INFO]: 	compression ratio: 0.9993084094105911
2025-03-13 16:29:27,484 [INFO]: }
2025-03-13 16:29:27,484 [INFO]: 	>>> Finished "Creating the index" in 113.0836 secs
2025-03-13 16:29:27,484 [INFO]: >>> Finished "Launching the whole pipeline" in 113.1162 secs
2025-03-13 16:29:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 7120 [episode count 9/20]
[retrieval_preprocessing] for episode 37843 [episode count 10/20], we have num_retrieval=np.int64(6473) num_query=np.int64(333)
2025-03-13 16:29:35,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:37,123 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:37
2025-03-13 16:29:37,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1979.38it/s]
2025-03-13 16:29:37,149 [INFO]: There are 6473 embeddings of dim 49152
2025-03-13 16:29:37,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:29:37,150 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:37
2025-03-13 16:29:37,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:37,150 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:29:37,150 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:37,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:29:37,150 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:37
2025-03-13 16:29:37,150 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:37,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:37,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:37
2025-03-13 16:29:37,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:37,150 [INFO]: 	Creating the index 03/13/2025, 16:29:37
2025-03-13 16:29:37,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:37
2025-03-13 16:29:37,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:29:37,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:37
2025-03-13 16:29:37,152 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:29:37,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.35it/s]  7%|▋         | 2/27 [00:00<00:04,  5.85it/s] 11%|█         | 3/27 [00:00<00:03,  6.59it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.33it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.99it/s] 26%|██▌       | 7/27 [00:00<00:02,  9.13it/s] 30%|██▉       | 8/27 [00:01<00:02,  9.07it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.76it/s] 37%|███▋      | 10/27 [00:01<00:01,  8.57it/s] 41%|████      | 11/27 [00:01<00:01,  8.38it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.40it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.30it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.31it/s] 56%|█████▌    | 15/27 [00:01<00:01,  8.12it/s] 59%|█████▉    | 16/27 [00:01<00:01,  8.06it/s] 63%|██████▎   | 17/27 [00:02<00:01,  8.53it/s] 70%|███████   | 19/27 [00:02<00:00,  9.20it/s] 78%|███████▊  | 21/27 [00:07<00:06,  1.08s/it] 85%|████████▌ | 23/27 [00:07<00:02,  1.39it/s] 93%|█████████▎| 25/27 [00:07<00:00,  2.01it/s]100%|██████████| 27/27 [00:10<00:00,  1.34it/s]100%|██████████| 27/27 [00:10<00:00,  2.64it/s]
2025-03-13 16:29:47,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:47
2025-03-13 16:30:50,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.3766 secs
2025-03-13 16:30:50,775 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:30:50,775 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 16:31:19,886 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1102 secs
2025-03-13 16:31:19,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.7354 secs
2025-03-13 16:31:19,887 [INFO]: {
2025-03-13 16:31:19,887 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:19,887 [INFO]: 	index_param: efSearch=219
2025-03-13 16:31:19,887 [INFO]: 	index_path: knn.index
2025-03-13 16:31:19,887 [INFO]: 	size in bytes: 1273524370
2025-03-13 16:31:19,887 [INFO]: 	avg_search_speed_ms: 11.404195409629201
2025-03-13 16:31:19,887 [INFO]: 	99p_search_speed_ms: 18.128315564244986
2025-03-13 16:31:19,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:19,887 [INFO]: 	nb vectors: 6473
2025-03-13 16:31:19,887 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:19,887 [INFO]: 	compression ratio: 0.9993083870079377
2025-03-13 16:31:19,887 [INFO]: }
2025-03-13 16:31:19,887 [INFO]: 	>>> Finished "Creating the index" in 102.7370 secs
2025-03-13 16:31:19,887 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7639 secs
2025-03-13 16:31:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 37843 [episode count 10/20]
[retrieval_preprocessing] for episode 59326 [episode count 11/20], we have num_retrieval=np.int64(6505) num_query=np.int64(301)
2025-03-13 16:31:24,733 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:25,789 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:25
2025-03-13 16:31:25,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1092.27it/s]
2025-03-13 16:31:25,815 [INFO]: There are 6505 embeddings of dim 49152
2025-03-13 16:31:25,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:31:25,815 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:25,816 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:31:25,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:25,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:25,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,816 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:25,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:31:25,816 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:25
2025-03-13 16:31:25,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:25,816 [INFO]: 	Creating the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,816 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:25
2025-03-13 16:31:25,817 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:31:25,817 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:25
2025-03-13 16:31:25,817 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:31:25,817 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.45it/s]  7%|▋         | 2/27 [00:00<00:04,  6.14it/s] 11%|█         | 3/27 [00:00<00:03,  6.97it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.43it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.64it/s] 22%|██▏       | 6/27 [00:00<00:02,  7.87it/s] 26%|██▌       | 7/27 [00:00<00:02,  8.00it/s] 30%|██▉       | 8/27 [00:01<00:02,  8.09it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.13it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.22it/s] 41%|████      | 11/27 [00:01<00:01,  8.25it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.34it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.44it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.83it/s] 59%|█████▉    | 16/27 [00:01<00:01,  9.86it/s] 67%|██████▋   | 18/27 [00:02<00:00, 10.16it/s] 74%|███████▍  | 20/27 [00:02<00:00, 10.52it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.32it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.86it/s] 96%|█████████▋| 26/27 [00:06<00:00,  2.54it/s]100%|██████████| 27/27 [00:09<00:00,  1.24it/s]100%|██████████| 27/27 [00:09<00:00,  2.89it/s]
2025-03-13 16:31:35,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:35
2025-03-13 16:32:33,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7897 secs
2025-03-13 16:32:33,939 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 16:32:33,939 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 16:33:23,114 [INFO]: 	>>> Finished "Compute fast metrics" in 49.1745 secs
2025-03-13 16:33:23,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.2982 secs
2025-03-13 16:33:23,115 [INFO]: {
2025-03-13 16:33:23,115 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:23,115 [INFO]: 	index_param: efSearch=175
2025-03-13 16:33:23,115 [INFO]: 	index_path: knn.index
2025-03-13 16:33:23,115 [INFO]: 	size in bytes: 1279820110
2025-03-13 16:33:23,116 [INFO]: 	avg_search_speed_ms: 9.198479772277224
2025-03-13 16:33:23,116 [INFO]: 	99p_search_speed_ms: 14.697959907352933
2025-03-13 16:33:23,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:23,116 [INFO]: 	nb vectors: 6505
2025-03-13 16:33:23,116 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:23,116 [INFO]: 	compression ratio: 0.999308441871569
2025-03-13 16:33:23,116 [INFO]: }
2025-03-13 16:33:23,116 [INFO]: 	>>> Finished "Creating the index" in 117.2996 secs
2025-03-13 16:33:23,116 [INFO]: >>> Finished "Launching the whole pipeline" in 117.3263 secs
2025-03-13 16:33:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 59326 [episode count 11/20]
[retrieval_preprocessing] for episode 27657 [episode count 12/20], we have num_retrieval=np.int64(6565) num_query=np.int64(241)
2025-03-13 16:33:28,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:29,656 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:29
2025-03-13 16:33:29,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.43it/s]
2025-03-13 16:33:29,685 [INFO]: There are 6565 embeddings of dim 49152
2025-03-13 16:33:29,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:33:29,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:29
2025-03-13 16:33:29,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:29,686 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:33:29,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:29,686 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:33:29,686 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:29
2025-03-13 16:33:29,686 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:29,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:33:29,687 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:29
2025-03-13 16:33:29,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:29,687 [INFO]: 	Creating the index 03/13/2025, 16:33:29
2025-03-13 16:33:29,687 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:29
2025-03-13 16:33:29,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 16:33:29,689 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:29
2025-03-13 16:33:29,689 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:33:29,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:06,  3.94it/s]  7%|▋         | 2/27 [00:00<00:04,  6.05it/s] 15%|█▍        | 4/27 [00:00<00:02,  8.29it/s] 22%|██▏       | 6/27 [00:00<00:02,  9.21it/s] 30%|██▉       | 8/27 [00:00<00:01,  9.76it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.69it/s] 41%|████      | 11/27 [00:01<00:01,  9.59it/s] 48%|████▊     | 13/27 [00:01<00:01,  9.89it/s] 52%|█████▏    | 14/27 [00:01<00:01,  9.85it/s] 59%|█████▉    | 16/27 [00:01<00:01,  9.73it/s] 63%|██████▎   | 17/27 [00:01<00:01,  9.50it/s] 67%|██████▋   | 18/27 [00:01<00:00,  9.22it/s] 70%|███████   | 19/27 [00:02<00:00,  8.92it/s] 74%|███████▍  | 20/27 [00:02<00:00,  8.92it/s] 78%|███████▊  | 21/27 [00:06<00:07,  1.23s/it] 81%|████████▏ | 22/27 [00:06<00:04,  1.09it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.81it/s] 96%|█████████▋| 26/27 [00:06<00:00,  2.66it/s]100%|██████████| 27/27 [00:09<00:00,  1.14it/s]100%|██████████| 27/27 [00:09<00:00,  2.81it/s]
2025-03-13 16:33:39,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:39
2025-03-13 16:34:45,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.3790 secs
2025-03-13 16:34:45,700 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:34:45,700 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  4.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.84it/s]
2025-03-13 16:35:17,755 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0551 secs
2025-03-13 16:35:17,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.2812 secs
2025-03-13 16:35:17,971 [INFO]: {
2025-03-13 16:35:17,971 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:17,971 [INFO]: 	index_param: efSearch=242
2025-03-13 16:35:17,971 [INFO]: 	index_path: knn.index
2025-03-13 16:35:17,971 [INFO]: 	size in bytes: 1291624810
2025-03-13 16:35:17,971 [INFO]: 	avg_search_speed_ms: 12.272239464443702
2025-03-13 16:35:17,971 [INFO]: 	99p_search_speed_ms: 22.50840249937029
2025-03-13 16:35:17,971 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:17,971 [INFO]: 	nb vectors: 6565
2025-03-13 16:35:17,971 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:17,972 [INFO]: 	compression ratio: 0.9993083982336946
2025-03-13 16:35:17,972 [INFO]: }
2025-03-13 16:35:17,972 [INFO]: 	>>> Finished "Creating the index" in 108.2846 secs
2025-03-13 16:35:17,972 [INFO]: >>> Finished "Launching the whole pipeline" in 108.3154 secs
2025-03-13 16:35:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 27657 [episode count 12/20]
[retrieval_preprocessing] for episode 54127 [episode count 13/20], we have num_retrieval=np.int64(6469) num_query=np.int64(337)
2025-03-13 16:35:23,508 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:24,436 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:24
2025-03-13 16:35:24,436 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1153.23it/s]
2025-03-13 16:35:24,461 [INFO]: There are 6469 embeddings of dim 49152
2025-03-13 16:35:24,461 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:35:24,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:24
2025-03-13 16:35:24,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:24,462 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:35:24,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:24,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:24,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:24
2025-03-13 16:35:24,462 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:24,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:35:24,462 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:24
2025-03-13 16:35:24,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:24,462 [INFO]: 	Creating the index 03/13/2025, 16:35:24
2025-03-13 16:35:24,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:24
2025-03-13 16:35:24,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:35:24,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:24
2025-03-13 16:35:24,463 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:35:24,463 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.37it/s] 11%|█         | 3/27 [00:00<00:02,  8.56it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.45it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.30it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.02it/s] 41%|████      | 11/27 [00:01<00:01, 10.91it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.06it/s] 56%|█████▌    | 15/27 [00:01<00:01, 10.96it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.00it/s] 70%|███████   | 19/27 [00:01<00:00, 11.07it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.37it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.61it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.94it/s] 93%|█████████▎| 25/27 [00:06<00:00,  2.78it/s]100%|██████████| 27/27 [00:08<00:00,  1.53it/s]100%|██████████| 27/27 [00:08<00:00,  3.02it/s]
2025-03-13 16:35:33,410 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:33
2025-03-13 16:36:26,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.2132 secs
2025-03-13 16:36:26,625 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:36:26,625 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 16:36:58,329 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7040 secs
2025-03-13 16:36:58,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.8677 secs
2025-03-13 16:36:58,331 [INFO]: {
2025-03-13 16:36:58,331 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:58,331 [INFO]: 	index_param: efSearch=238
2025-03-13 16:36:58,331 [INFO]: 	index_path: knn.index
2025-03-13 16:36:58,331 [INFO]: 	size in bytes: 1272737410
2025-03-13 16:36:58,331 [INFO]: 	avg_search_speed_ms: 12.161564102867695
2025-03-13 16:36:58,331 [INFO]: 	99p_search_speed_ms: 20.66352452849966
2025-03-13 16:36:58,331 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:58,331 [INFO]: 	nb vectors: 6469
2025-03-13 16:36:58,331 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:58,331 [INFO]: 	compression ratio: 0.999308374223085
2025-03-13 16:36:58,331 [INFO]: }
2025-03-13 16:36:58,331 [INFO]: 	>>> Finished "Creating the index" in 93.8692 secs
2025-03-13 16:36:58,331 [INFO]: >>> Finished "Launching the whole pipeline" in 93.8952 secs
2025-03-13 16:37:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 54127 [episode count 13/20]
[retrieval_preprocessing] for episode 18401 [episode count 14/20], we have num_retrieval=np.int64(6573) num_query=np.int64(233)
2025-03-13 16:37:06,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:07,292 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:07
2025-03-13 16:37:07,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.60it/s]
2025-03-13 16:37:07,320 [INFO]: There are 6573 embeddings of dim 49152
2025-03-13 16:37:07,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:37:07,320 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:07
2025-03-13 16:37:07,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:07,320 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:37:07,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:07,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:37:07,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:07
2025-03-13 16:37:07,320 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:07,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:37:07,321 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:07
2025-03-13 16:37:07,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:07,321 [INFO]: 	Creating the index 03/13/2025, 16:37:07
2025-03-13 16:37:07,321 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:07
2025-03-13 16:37:07,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:37:07,322 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:07
2025-03-13 16:37:07,322 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:37:07,322 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.97it/s] 11%|█         | 3/27 [00:00<00:02,  8.57it/s] 19%|█▊        | 5/27 [00:00<00:02,  9.87it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.74it/s] 33%|███▎      | 9/27 [00:00<00:01, 10.98it/s] 41%|████      | 11/27 [00:01<00:01, 11.10it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.31it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.24it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.28it/s] 70%|███████   | 19/27 [00:01<00:00, 11.21it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.40it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.66it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.34it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.20it/s]100%|██████████| 27/27 [00:09<00:00,  2.90it/s]
2025-03-13 16:37:16,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:16
2025-03-13 16:38:16,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6161 secs
2025-03-13 16:38:16,259 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:38:16,259 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 16:38:50,888 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6294 secs
2025-03-13 16:38:50,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.5687 secs
2025-03-13 16:38:50,891 [INFO]: {
2025-03-13 16:38:50,891 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:50,891 [INFO]: 	index_param: efSearch=236
2025-03-13 16:38:50,891 [INFO]: 	index_path: knn.index
2025-03-13 16:38:50,891 [INFO]: 	size in bytes: 1293198730
2025-03-13 16:38:50,891 [INFO]: 	avg_search_speed_ms: 13.607562606406658
2025-03-13 16:38:50,891 [INFO]: 	99p_search_speed_ms: 25.696270079351926
2025-03-13 16:38:50,891 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:50,891 [INFO]: 	nb vectors: 6573
2025-03-13 16:38:50,891 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:50,891 [INFO]: 	compression ratio: 0.9993084233851668
2025-03-13 16:38:50,891 [INFO]: }
2025-03-13 16:38:50,891 [INFO]: 	>>> Finished "Creating the index" in 103.5704 secs
2025-03-13 16:38:50,891 [INFO]: >>> Finished "Launching the whole pipeline" in 103.5985 secs
2025-03-13 16:38:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 18401 [episode count 14/20]
[retrieval_preprocessing] for episode 26575 [episode count 15/20], we have num_retrieval=np.int64(6542) num_query=np.int64(264)
2025-03-13 16:38:58,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:00,564 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:00
2025-03-13 16:39:00,564 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.50it/s]
2025-03-13 16:39:00,593 [INFO]: There are 6542 embeddings of dim 49152
2025-03-13 16:39:00,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 16:39:00,593 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:00
2025-03-13 16:39:00,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:00,593 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:39:00,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:00,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:39:00,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:00
2025-03-13 16:39:00,594 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:00,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:39:00,594 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:00
2025-03-13 16:39:00,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:00,594 [INFO]: 	Creating the index 03/13/2025, 16:39:00
2025-03-13 16:39:00,594 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:00
2025-03-13 16:39:00,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:39:00,595 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:00
2025-03-13 16:39:00,595 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:39:00,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:06,  4.13it/s]  7%|▋         | 2/27 [00:00<00:04,  5.70it/s] 11%|█         | 3/27 [00:00<00:03,  6.51it/s] 15%|█▍        | 4/27 [00:00<00:03,  6.87it/s] 19%|█▊        | 5/27 [00:00<00:03,  7.16it/s] 22%|██▏       | 6/27 [00:00<00:02,  7.20it/s] 26%|██▌       | 7/27 [00:01<00:02,  7.31it/s] 30%|██▉       | 8/27 [00:01<00:02,  7.31it/s] 33%|███▎      | 9/27 [00:01<00:02,  7.36it/s] 37%|███▋      | 10/27 [00:01<00:02,  7.53it/s] 41%|████      | 11/27 [00:01<00:02,  7.53it/s] 44%|████▍     | 12/27 [00:01<00:02,  7.50it/s] 48%|████▊     | 13/27 [00:01<00:01,  7.52it/s] 52%|█████▏    | 14/27 [00:01<00:01,  7.48it/s] 56%|█████▌    | 15/27 [00:02<00:01,  7.59it/s] 59%|█████▉    | 16/27 [00:02<00:01,  8.10it/s] 67%|██████▋   | 18/27 [00:02<00:01,  8.90it/s] 74%|███████▍  | 20/27 [00:02<00:00,  9.34it/s] 78%|███████▊  | 21/27 [00:06<00:05,  1.03it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.30it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.67it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.15it/s] 93%|█████████▎| 25/27 [00:07<00:00,  2.73it/s] 96%|█████████▋| 26/27 [00:07<00:00,  3.43it/s]100%|██████████| 27/27 [00:09<00:00,  1.01it/s]100%|██████████| 27/27 [00:09<00:00,  2.74it/s]
2025-03-13 16:39:10,459 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:10
2025-03-13 16:40:09,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9572 secs
2025-03-13 16:40:09,417 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 16:40:09,417 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-13 16:41:19,544 [INFO]: 	>>> Finished "Compute fast metrics" in 70.1271 secs
2025-03-13 16:41:19,546 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.9510 secs
2025-03-13 16:41:19,547 [INFO]: {
2025-03-13 16:41:19,547 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:19,547 [INFO]: 	index_param: efSearch=282
2025-03-13 16:41:19,547 [INFO]: 	index_path: knn.index
2025-03-13 16:41:19,547 [INFO]: 	size in bytes: 1287099610
2025-03-13 16:41:19,547 [INFO]: 	avg_search_speed_ms: 14.61833912391782
2025-03-13 16:41:19,547 [INFO]: 	99p_search_speed_ms: 25.142206845339366
2025-03-13 16:41:19,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:19,547 [INFO]: 	nb vectors: 6542
2025-03-13 16:41:19,547 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:19,547 [INFO]: 	compression ratio: 0.9993084653331532
2025-03-13 16:41:19,547 [INFO]: }
2025-03-13 16:41:19,547 [INFO]: 	>>> Finished "Creating the index" in 138.9529 secs
2025-03-13 16:41:19,547 [INFO]: >>> Finished "Launching the whole pipeline" in 138.9829 secs
2025-03-13 16:41:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 26575 [episode count 15/20]
[retrieval_preprocessing] for episode 5959 [episode count 16/20], we have num_retrieval=np.int64(6575) num_query=np.int64(231)
2025-03-13 16:41:26,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:28,341 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:28
2025-03-13 16:41:28,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 753.29it/s]
2025-03-13 16:41:28,373 [INFO]: There are 6575 embeddings of dim 49152
2025-03-13 16:41:28,374 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 16:41:28,374 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:28
2025-03-13 16:41:28,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:28,375 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:41:28,375 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:28,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:41:28,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:28
2025-03-13 16:41:28,375 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:28,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:28,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:28
2025-03-13 16:41:28,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:28,376 [INFO]: 	Creating the index 03/13/2025, 16:41:28
2025-03-13 16:41:28,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:28
2025-03-13 16:41:28,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 16:41:28,380 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:28
2025-03-13 16:41:28,381 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:41:28,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.56it/s]  7%|▋         | 2/27 [00:00<00:04,  6.22it/s] 11%|█         | 3/27 [00:00<00:03,  7.01it/s] 15%|█▍        | 4/27 [00:00<00:02,  7.70it/s] 19%|█▊        | 5/27 [00:00<00:02,  8.33it/s] 26%|██▌       | 7/27 [00:00<00:02,  9.01it/s] 30%|██▉       | 8/27 [00:00<00:02,  9.00it/s] 33%|███▎      | 9/27 [00:01<00:01,  9.04it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.25it/s] 41%|████      | 11/27 [00:01<00:01,  9.39it/s] 48%|████▊     | 13/27 [00:01<00:01,  9.60it/s] 52%|█████▏    | 14/27 [00:01<00:01,  9.46it/s] 56%|█████▌    | 15/27 [00:01<00:01,  9.53it/s] 59%|█████▉    | 16/27 [00:01<00:01,  9.46it/s] 63%|██████▎   | 17/27 [00:01<00:01,  9.49it/s] 67%|██████▋   | 18/27 [00:02<00:00,  9.44it/s] 70%|███████   | 19/27 [00:02<00:00,  9.49it/s] 74%|███████▍  | 20/27 [00:02<00:00,  9.61it/s] 78%|███████▊  | 21/27 [00:06<00:08,  1.36s/it] 81%|████████▏ | 22/27 [00:06<00:04,  1.01it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.73it/s] 96%|█████████▋| 26/27 [00:07<00:00,  2.58it/s]100%|██████████| 27/27 [00:09<00:00,  1.15it/s]100%|██████████| 27/27 [00:09<00:00,  2.79it/s]
2025-03-13 16:41:38,063 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:38
2025-03-13 16:42:42,528 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.4641 secs
2025-03-13 16:42:42,528 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:42:42,528 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s]
2025-03-13 16:43:50,640 [INFO]: 	>>> Finished "Compute fast metrics" in 68.1111 secs
2025-03-13 16:43:50,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.2606 secs
2025-03-13 16:43:50,642 [INFO]: {
2025-03-13 16:43:50,642 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:50,642 [INFO]: 	index_param: efSearch=207
2025-03-13 16:43:50,642 [INFO]: 	index_path: knn.index
2025-03-13 16:43:50,642 [INFO]: 	size in bytes: 1293592270
2025-03-13 16:43:50,642 [INFO]: 	avg_search_speed_ms: 11.479797222128674
2025-03-13 16:43:50,642 [INFO]: 	99p_search_speed_ms: 18.47377438098192
2025-03-13 16:43:50,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:50,642 [INFO]: 	nb vectors: 6575
2025-03-13 16:43:50,642 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:50,642 [INFO]: 	compression ratio: 0.9993083833130821
2025-03-13 16:43:50,642 [INFO]: }
2025-03-13 16:43:50,642 [INFO]: 	>>> Finished "Creating the index" in 142.2656 secs
2025-03-13 16:43:50,642 [INFO]: >>> Finished "Launching the whole pipeline" in 142.3014 secs
2025-03-13 16:43:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 5959 [episode count 16/20]
[retrieval_preprocessing] for episode 3725 [episode count 17/20], we have num_retrieval=np.int64(6415) num_query=np.int64(391)
2025-03-13 16:43:55,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:56,785 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:56
2025-03-13 16:43:56,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.96it/s]
2025-03-13 16:43:56,809 [INFO]: There are 6415 embeddings of dim 49152
2025-03-13 16:43:56,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 16:43:56,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:56
2025-03-13 16:43:56,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:56,809 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:43:56,809 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:56,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:43:56,810 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:56
2025-03-13 16:43:56,810 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:56,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:43:56,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:56
2025-03-13 16:43:56,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:56,810 [INFO]: 	Creating the index 03/13/2025, 16:43:56
2025-03-13 16:43:56,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:56
2025-03-13 16:43:56,811 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:43:56,811 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:56
2025-03-13 16:43:56,811 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:43:56,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.77it/s]  7%|▋         | 2/27 [00:00<00:03,  6.73it/s] 11%|█         | 3/27 [00:00<00:03,  7.39it/s] 15%|█▍        | 4/27 [00:00<00:02,  7.74it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.89it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.03it/s] 26%|██▌       | 7/27 [00:00<00:02,  8.10it/s] 30%|██▉       | 8/27 [00:01<00:02,  8.10it/s] 33%|███▎      | 9/27 [00:01<00:02,  7.96it/s] 37%|███▋      | 10/27 [00:01<00:02,  7.96it/s] 41%|████      | 11/27 [00:01<00:02,  7.91it/s] 44%|████▍     | 12/27 [00:01<00:01,  7.93it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.08it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.17it/s] 56%|█████▌    | 15/27 [00:01<00:01,  8.38it/s] 59%|█████▉    | 16/27 [00:02<00:01,  8.39it/s] 63%|██████▎   | 17/27 [00:02<00:01,  8.48it/s] 67%|██████▋   | 18/27 [00:02<00:01,  8.55it/s] 70%|███████   | 19/27 [00:02<00:00,  8.59it/s] 74%|███████▍  | 20/27 [00:02<00:00,  8.88it/s] 78%|███████▊  | 21/27 [00:06<00:08,  1.40s/it] 81%|████████▏ | 22/27 [00:06<00:05,  1.01s/it] 89%|████████▉ | 24/27 [00:07<00:01,  1.70it/s] 96%|█████████▋| 26/27 [00:07<00:00,  2.54it/s]100%|██████████| 27/27 [00:09<00:00,  1.16it/s]100%|██████████| 27/27 [00:09<00:00,  2.73it/s]
2025-03-13 16:44:06,708 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:06
2025-03-13 16:45:10,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6566 secs
2025-03-13 16:45:10,366 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 16:45:10,366 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 16:46:02,576 [INFO]: 	>>> Finished "Compute fast metrics" in 52.2099 secs
2025-03-13 16:46:02,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.7665 secs
2025-03-13 16:46:02,578 [INFO]: {
2025-03-13 16:46:02,578 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:02,578 [INFO]: 	index_param: efSearch=258
2025-03-13 16:46:02,578 [INFO]: 	index_path: knn.index
2025-03-13 16:46:02,578 [INFO]: 	size in bytes: 1262113210
2025-03-13 16:46:02,578 [INFO]: 	avg_search_speed_ms: 12.719047966451116
2025-03-13 16:46:02,578 [INFO]: 	99p_search_speed_ms: 19.25914807943627
2025-03-13 16:46:02,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:02,578 [INFO]: 	nb vectors: 6415
2025-03-13 16:46:02,578 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:02,578 [INFO]: 	compression ratio: 0.9993083900928349
2025-03-13 16:46:02,578 [INFO]: }
2025-03-13 16:46:02,578 [INFO]: 	>>> Finished "Creating the index" in 125.7680 secs
2025-03-13 16:46:02,578 [INFO]: >>> Finished "Launching the whole pipeline" in 125.7929 secs
2025-03-13 16:46:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 3725 [episode count 17/20]
[retrieval_preprocessing] for episode 1738 [episode count 18/20], we have num_retrieval=np.int64(6441) num_query=np.int64(365)
2025-03-13 16:46:10,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:11,876 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:11
2025-03-13 16:46:11,876 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 902.39it/s]
2025-03-13 16:46:11,906 [INFO]: There are 6441 embeddings of dim 49152
2025-03-13 16:46:11,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:46:11,906 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:11
2025-03-13 16:46:11,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:11,907 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:46:11,907 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:11,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:46:11,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:11
2025-03-13 16:46:11,908 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:11,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:46:11,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:11
2025-03-13 16:46:11,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:46:11,909 [INFO]: 	Creating the index 03/13/2025, 16:46:11
2025-03-13 16:46:11,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:11
2025-03-13 16:46:11,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:46:11,913 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:11
2025-03-13 16:46:11,913 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:46:11,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.58it/s] 11%|█         | 3/27 [00:00<00:02,  8.96it/s] 19%|█▊        | 5/27 [00:00<00:02,  9.96it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.53it/s] 33%|███▎      | 9/27 [00:00<00:01, 10.75it/s] 41%|████      | 11/27 [00:01<00:01, 10.88it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.05it/s] 56%|█████▌    | 15/27 [00:01<00:01, 10.03it/s] 63%|██████▎   | 17/27 [00:01<00:01,  9.83it/s] 67%|██████▋   | 18/27 [00:01<00:00,  9.82it/s] 70%|███████   | 19/27 [00:01<00:00,  9.80it/s] 78%|███████▊  | 21/27 [00:05<00:04,  1.23it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.51it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.22it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.07it/s]100%|██████████| 27/27 [00:08<00:00,  1.33it/s]100%|██████████| 27/27 [00:08<00:00,  3.05it/s]
2025-03-13 16:46:20,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:20
2025-03-13 16:47:15,887 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1205 secs
2025-03-13 16:47:15,887 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 16:47:15,887 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 16:48:09,698 [INFO]: 	>>> Finished "Compute fast metrics" in 53.8110 secs
2025-03-13 16:48:09,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.7879 secs
2025-03-13 16:48:09,701 [INFO]: {
2025-03-13 16:48:09,701 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:09,701 [INFO]: 	index_param: efSearch=205
2025-03-13 16:48:09,701 [INFO]: 	index_path: knn.index
2025-03-13 16:48:09,701 [INFO]: 	size in bytes: 1267228450
2025-03-13 16:48:09,701 [INFO]: 	avg_search_speed_ms: 10.53141893745449
2025-03-13 16:48:09,701 [INFO]: 	99p_search_speed_ms: 16.738705290481448
2025-03-13 16:48:09,701 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:09,701 [INFO]: 	nb vectors: 6441
2025-03-13 16:48:09,701 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:09,701 [INFO]: 	compression ratio: 0.9993084735431879
2025-03-13 16:48:09,701 [INFO]: }
2025-03-13 16:48:09,701 [INFO]: 	>>> Finished "Creating the index" in 117.7922 secs
2025-03-13 16:48:09,701 [INFO]: >>> Finished "Launching the whole pipeline" in 117.8253 secs
2025-03-13 16:48:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 1738 [episode count 18/20]
[retrieval_preprocessing] for episode 40033 [episode count 19/20], we have num_retrieval=np.int64(6548) num_query=np.int64(258)
2025-03-13 16:48:16,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:17,288 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:17
2025-03-13 16:48:17,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.12it/s]
2025-03-13 16:48:17,311 [INFO]: There are 6548 embeddings of dim 49152
2025-03-13 16:48:17,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 16:48:17,311 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:17
2025-03-13 16:48:17,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:17,311 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 16:48:17,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:17,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:17,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:17
2025-03-13 16:48:17,311 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:17,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:17,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:17
2025-03-13 16:48:17,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:17,311 [INFO]: 	Creating the index 03/13/2025, 16:48:17
2025-03-13 16:48:17,312 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:17
2025-03-13 16:48:17,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:17,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:17
2025-03-13 16:48:17,313 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:48:17,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.77it/s]  7%|▋         | 2/27 [00:00<00:03,  6.75it/s] 11%|█         | 3/27 [00:00<00:03,  7.68it/s] 15%|█▍        | 4/27 [00:00<00:02,  8.16it/s] 19%|█▊        | 5/27 [00:00<00:02,  8.49it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.85it/s] 30%|██▉       | 8/27 [00:00<00:02,  9.50it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.68it/s] 44%|████▍     | 12/27 [00:01<00:01,  9.86it/s] 48%|████▊     | 13/27 [00:01<00:01,  9.89it/s] 52%|█████▏    | 14/27 [00:01<00:01,  9.18it/s] 56%|█████▌    | 15/27 [00:01<00:01,  8.68it/s] 59%|█████▉    | 16/27 [00:01<00:01,  8.47it/s] 63%|██████▎   | 17/27 [00:01<00:01,  8.40it/s] 67%|██████▋   | 18/27 [00:02<00:01,  8.25it/s] 70%|███████   | 19/27 [00:02<00:00,  8.21it/s] 74%|███████▍  | 20/27 [00:02<00:00,  8.62it/s] 78%|███████▊  | 21/27 [00:06<00:08,  1.33s/it] 81%|████████▏ | 22/27 [00:06<00:04,  1.03it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.40it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.87it/s] 93%|█████████▎| 25/27 [00:07<00:00,  2.46it/s]100%|██████████| 27/27 [00:10<00:00,  1.03it/s]100%|██████████| 27/27 [00:10<00:00,  2.62it/s]
2025-03-13 16:48:27,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:27
2025-03-13 16:49:33,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.1362 secs
2025-03-13 16:49:33,755 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 16:49:33,755 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s]
2025-03-13 16:50:32,236 [INFO]: 	>>> Finished "Compute fast metrics" in 58.4807 secs
2025-03-13 16:50:32,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.9244 secs
2025-03-13 16:50:32,237 [INFO]: {
2025-03-13 16:50:32,237 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:32,237 [INFO]: 	index_param: efSearch=202
2025-03-13 16:50:32,237 [INFO]: 	index_path: knn.index
2025-03-13 16:50:32,237 [INFO]: 	size in bytes: 1288280110
2025-03-13 16:50:32,237 [INFO]: 	avg_search_speed_ms: 8.951414148877696
2025-03-13 16:50:32,237 [INFO]: 	99p_search_speed_ms: 13.787716841325155
2025-03-13 16:50:32,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:32,237 [INFO]: 	nb vectors: 6548
2025-03-13 16:50:32,237 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:32,237 [INFO]: 	compression ratio: 0.9993084376657806
2025-03-13 16:50:32,237 [INFO]: }
2025-03-13 16:50:32,237 [INFO]: 	>>> Finished "Creating the index" in 134.9258 secs
2025-03-13 16:50:32,237 [INFO]: >>> Finished "Launching the whole pipeline" in 134.9492 secs
2025-03-13 16:50:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 40033 [episode count 19/20]
2025-03-13 16:50:34: [retrieval_preprocessing] finished for 8626796008_fold_towel [chosen_id count 4/196]
2025-03-13 16:50:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8626796008_toaster_lever_down [chosen_id count 5/196]
2025-03-13 16:50:36: [retrieval_preprocessing] we have num_total=2305 embedding_dim=49152
[retrieval_preprocessing] for episode 83994 [episode count 0/20], we have num_retrieval=np.int64(2189) num_query=np.int64(116)
2025-03-13 16:50:37,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:37,850 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:37
2025-03-13 16:50:37,850 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-13 16:50:37,874 [INFO]: There are 2189 embeddings of dim 49152
2025-03-13 16:50:37,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 16:50:37,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:37,874 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:50:37,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:37,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:37,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,874 [INFO]: 451.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:37,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:50:37,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:37
2025-03-13 16:50:37,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:37,874 [INFO]: 	Creating the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:37
2025-03-13 16:50:37,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:50:37,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:37
2025-03-13 16:50:37,876 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:50:37,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.80it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.00it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.48it/s]100%|██████████| 9/9 [00:01<00:00,  3.25it/s]100%|██████████| 9/9 [00:01<00:00,  4.52it/s]
2025-03-13 16:50:39,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:39
2025-03-13 16:51:03,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9781 secs
2025-03-13 16:51:03,848 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:51:03,848 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 16:51:26,689 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8409 secs
2025-03-13 16:51:26,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8155 secs
2025-03-13 16:51:26,691 [INFO]: {
2025-03-13 16:51:26,691 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:26,691 [INFO]: 	index_param: efSearch=238
2025-03-13 16:51:26,691 [INFO]: 	index_path: knn.index
2025-03-13 16:51:26,691 [INFO]: 	size in bytes: 430672570
2025-03-13 16:51:26,691 [INFO]: 	avg_search_speed_ms: 11.033661887111352
2025-03-13 16:51:26,691 [INFO]: 	99p_search_speed_ms: 16.170624166261405
2025-03-13 16:51:26,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:26,691 [INFO]: 	nb vectors: 2189
2025-03-13 16:51:26,691 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:26,691 [INFO]: 	compression ratio: 0.9993088531270984
2025-03-13 16:51:26,691 [INFO]: }
2025-03-13 16:51:26,691 [INFO]: 	>>> Finished "Creating the index" in 48.8169 secs
2025-03-13 16:51:26,691 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8417 secs
2025-03-13 16:51:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 83994 [episode count 0/20]
[retrieval_preprocessing] for episode 47133 [episode count 1/20], we have num_retrieval=np.int64(2172) num_query=np.int64(133)
2025-03-13 16:51:29,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:29,741 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:29
2025-03-13 16:51:29,742 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.66it/s]
2025-03-13 16:51:29,767 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 16:51:29,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:51:29,768 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:29
2025-03-13 16:51:29,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:29,768 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:51:29,768 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:29,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:51:29,768 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:29
2025-03-13 16:51:29,769 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:29,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:51:29,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:29
2025-03-13 16:51:29,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:29,769 [INFO]: 	Creating the index 03/13/2025, 16:51:29
2025-03-13 16:51:29,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:29
2025-03-13 16:51:29,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:51:29,772 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:29
2025-03-13 16:51:29,773 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:51:29,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.32it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.92it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.49it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.40it/s] 56%|█████▌    | 5/9 [00:00<00:00,  5.95it/s] 67%|██████▋   | 6/9 [00:00<00:00,  6.69it/s] 78%|███████▊  | 7/9 [00:01<00:00,  7.35it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.91it/s]100%|██████████| 9/9 [00:02<00:00,  1.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]
2025-03-13 16:51:33,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:33
2025-03-13 16:51:59,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3788 secs
2025-03-13 16:51:59,089 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:51:59,089 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-13 16:52:12,985 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8964 secs
2025-03-13 16:52:12,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2157 secs
2025-03-13 16:52:12,988 [INFO]: {
2025-03-13 16:52:12,988 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:12,988 [INFO]: 	index_param: efSearch=227
2025-03-13 16:52:12,988 [INFO]: 	index_path: knn.index
2025-03-13 16:52:12,988 [INFO]: 	size in bytes: 427327810
2025-03-13 16:52:12,988 [INFO]: 	avg_search_speed_ms: 10.224135901116155
2025-03-13 16:52:12,989 [INFO]: 	99p_search_speed_ms: 13.310517678037288
2025-03-13 16:52:12,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:12,989 [INFO]: 	nb vectors: 2172
2025-03-13 16:52:12,989 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:12,989 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 16:52:12,989 [INFO]: }
2025-03-13 16:52:12,989 [INFO]: 	>>> Finished "Creating the index" in 43.2193 secs
2025-03-13 16:52:12,989 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2471 secs
2025-03-13 16:52:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 47133 [episode count 1/20]
[retrieval_preprocessing] for episode 65586 [episode count 2/20], we have num_retrieval=np.int64(2198) num_query=np.int64(107)
2025-03-13 16:52:15,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:16,718 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:16
2025-03-13 16:52:16,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1763.05it/s]
2025-03-13 16:52:16,742 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 16:52:16,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 16:52:16,742 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:16
2025-03-13 16:52:16,742 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:16,742 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:52:16,743 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:16,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:52:16,743 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:16
2025-03-13 16:52:16,743 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:16,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:52:16,743 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:16
2025-03-13 16:52:16,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:16,743 [INFO]: 	Creating the index 03/13/2025, 16:52:16
2025-03-13 16:52:16,743 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:16
2025-03-13 16:52:16,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:52:16,744 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:16
2025-03-13 16:52:16,744 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:52:16,744 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.38it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.20it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.09it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.53it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.75it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.82it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.87it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.06it/s]100%|██████████| 9/9 [00:02<00:00,  1.70it/s]100%|██████████| 9/9 [00:02<00:00,  3.48it/s]
2025-03-13 16:52:19,330 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:19
2025-03-13 16:52:49,683 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3526 secs
2025-03-13 16:52:49,684 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:52:49,684 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s]
2025-03-13 16:53:16,727 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0430 secs
2025-03-13 16:53:16,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9855 secs
2025-03-13 16:53:16,730 [INFO]: {
2025-03-13 16:53:16,730 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:16,730 [INFO]: 	index_param: efSearch=219
2025-03-13 16:53:16,730 [INFO]: 	index_path: knn.index
2025-03-13 16:53:16,730 [INFO]: 	size in bytes: 432443230
2025-03-13 16:53:16,730 [INFO]: 	avg_search_speed_ms: 9.006369769833311
2025-03-13 16:53:16,730 [INFO]: 	99p_search_speed_ms: 14.291086448356522
2025-03-13 16:53:16,730 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:16,730 [INFO]: 	nb vectors: 2198
2025-03-13 16:53:16,730 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:16,730 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 16:53:16,730 [INFO]: }
2025-03-13 16:53:16,730 [INFO]: 	>>> Finished "Creating the index" in 59.9868 secs
2025-03-13 16:53:16,730 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0116 secs
2025-03-13 16:53:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 65586 [episode count 2/20]
[retrieval_preprocessing] for episode 51259 [episode count 3/20], we have num_retrieval=np.int64(2202) num_query=np.int64(103)
2025-03-13 16:53:18,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:19,184 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:19
2025-03-13 16:53:19,184 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1150.39it/s]
2025-03-13 16:53:19,210 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 16:53:19,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:53:19,210 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:19
2025-03-13 16:53:19,210 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:19,210 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:53:19,210 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:19,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:19,210 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:19
2025-03-13 16:53:19,210 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:19,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:53:19,210 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:19
2025-03-13 16:53:19,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:19,210 [INFO]: 	Creating the index 03/13/2025, 16:53:19
2025-03-13 16:53:19,210 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:19
2025-03-13 16:53:19,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:53:19,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:19
2025-03-13 16:53:19,212 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:53:19,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.27it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.65it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.31it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.50it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.70it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.78it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.78it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.80it/s]100%|██████████| 9/9 [00:02<00:00,  1.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.36it/s]
2025-03-13 16:53:21,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:21
2025-03-13 16:53:49,880 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9852 secs
2025-03-13 16:53:49,881 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:53:49,881 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 16:54:14,095 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2138 secs
2025-03-13 16:54:14,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8852 secs
2025-03-13 16:54:14,097 [INFO]: {
2025-03-13 16:54:14,097 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:14,097 [INFO]: 	index_param: efSearch=212
2025-03-13 16:54:14,097 [INFO]: 	index_path: knn.index
2025-03-13 16:54:14,097 [INFO]: 	size in bytes: 433230190
2025-03-13 16:54:14,097 [INFO]: 	avg_search_speed_ms: 10.962909436018794
2025-03-13 16:54:14,097 [INFO]: 	99p_search_speed_ms: 16.822881849948313
2025-03-13 16:54:14,097 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:14,097 [INFO]: 	nb vectors: 2202
2025-03-13 16:54:14,097 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:14,097 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 16:54:14,097 [INFO]: }
2025-03-13 16:54:14,097 [INFO]: 	>>> Finished "Creating the index" in 54.8869 secs
2025-03-13 16:54:14,097 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9134 secs
2025-03-13 16:54:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 51259 [episode count 3/20]
[retrieval_preprocessing] for episode 47188 [episode count 4/20], we have num_retrieval=np.int64(2210) num_query=np.int64(95)
2025-03-13 16:54:16,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:16,805 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:16
2025-03-13 16:54:16,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.84it/s]
2025-03-13 16:54:16,830 [INFO]: There are 2210 embeddings of dim 49152
2025-03-13 16:54:16,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:54:16,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:16
2025-03-13 16:54:16,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:16,830 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:54:16,830 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:16,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:16,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:16
2025-03-13 16:54:16,830 [INFO]: 456.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:16,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:54:16,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:16
2025-03-13 16:54:16,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:16,831 [INFO]: 	Creating the index 03/13/2025, 16:54:16
2025-03-13 16:54:16,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:16
2025-03-13 16:54:16,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:54:16,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:16
2025-03-13 16:54:16,832 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:54:16,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.44it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.18it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.19it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.25it/s]100%|██████████| 9/9 [00:02<00:00,  2.28it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-13 16:54:19,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:19
2025-03-13 16:54:46,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3190 secs
2025-03-13 16:54:46,843 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 16:54:46,843 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.93it/s] 50%|█████     | 2/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 16:55:04,430 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5869 secs
2025-03-13 16:55:04,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6001 secs
2025-03-13 16:55:04,432 [INFO]: {
2025-03-13 16:55:04,432 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:04,432 [INFO]: 	index_param: efSearch=190
2025-03-13 16:55:04,432 [INFO]: 	index_path: knn.index
2025-03-13 16:55:04,432 [INFO]: 	size in bytes: 434804110
2025-03-13 16:55:04,432 [INFO]: 	avg_search_speed_ms: 9.350341600971428
2025-03-13 16:55:04,432 [INFO]: 	99p_search_speed_ms: 13.0763036943972
2025-03-13 16:55:04,432 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:04,432 [INFO]: 	nb vectors: 2210
2025-03-13 16:55:04,432 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:04,432 [INFO]: 	compression ratio: 0.9993090451697892
2025-03-13 16:55:04,432 [INFO]: }
2025-03-13 16:55:04,432 [INFO]: 	>>> Finished "Creating the index" in 47.6017 secs
2025-03-13 16:55:04,432 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6271 secs
2025-03-13 16:55:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 47188 [episode count 4/20]
[retrieval_preprocessing] for episode 10331 [episode count 5/20], we have num_retrieval=np.int64(2187) num_query=np.int64(118)
2025-03-13 16:55:06,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:06,485 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:06
2025-03-13 16:55:06,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-13 16:55:06,510 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 16:55:06,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:55:06,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:06,510 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:55:06,510 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:06,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:06,510 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,510 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:06,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:55:06,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:06
2025-03-13 16:55:06,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:06,511 [INFO]: 	Creating the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,511 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:06
2025-03-13 16:55:06,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:55:06,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:06
2025-03-13 16:55:06,512 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:55:06,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.92it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.59it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.24it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.67it/s]100%|██████████| 9/9 [00:02<00:00,  2.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.73it/s]
2025-03-13 16:55:08,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:08
2025-03-13 16:55:36,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9984 secs
2025-03-13 16:55:36,926 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 16:55:36,926 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 16:56:01,741 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8145 secs
2025-03-13 16:56:01,743 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2312 secs
2025-03-13 16:56:01,743 [INFO]: {
2025-03-13 16:56:01,743 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:01,743 [INFO]: 	index_param: efSearch=199
2025-03-13 16:56:01,743 [INFO]: 	index_path: knn.index
2025-03-13 16:56:01,743 [INFO]: 	size in bytes: 430279030
2025-03-13 16:56:01,743 [INFO]: 	avg_search_speed_ms: 7.703917315918579
2025-03-13 16:56:01,743 [INFO]: 	99p_search_speed_ms: 10.646362206898628
2025-03-13 16:56:01,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:01,743 [INFO]: 	nb vectors: 2187
2025-03-13 16:56:01,743 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:01,743 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 16:56:01,743 [INFO]: }
2025-03-13 16:56:01,743 [INFO]: 	>>> Finished "Creating the index" in 55.2328 secs
2025-03-13 16:56:01,743 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2580 secs
2025-03-13 16:56:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 10331 [episode count 5/20]
[retrieval_preprocessing] for episode 86151 [episode count 6/20], we have num_retrieval=np.int64(2158) num_query=np.int64(147)
2025-03-13 16:56:03,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:04,394 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:04
2025-03-13 16:56:04,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.69it/s]
2025-03-13 16:56:04,953 [INFO]: There are 2158 embeddings of dim 49152
2025-03-13 16:56:04,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5601 secs
2025-03-13 16:56:04,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:04
2025-03-13 16:56:04,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:04,955 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:56:04,955 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:04,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:56:04,955 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:04
2025-03-13 16:56:04,955 [INFO]: 445.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:04,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:56:04,956 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:04
2025-03-13 16:56:04,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:04,956 [INFO]: 	Creating the index 03/13/2025, 16:56:04
2025-03-13 16:56:04,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:04
2025-03-13 16:56:04,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:56:04,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:04
2025-03-13 16:56:04,960 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:56:04,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.07it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.54it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.45it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.97it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.97it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.95it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.94it/s]100%|██████████| 9/9 [00:02<00:00,  2.05it/s]100%|██████████| 9/9 [00:02<00:00,  3.84it/s]
2025-03-13 16:56:07,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:07
2025-03-13 16:56:29,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0181 secs
2025-03-13 16:56:29,329 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 16:56:29,329 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.41it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 16:57:03,804 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4748 secs
2025-03-13 16:57:03,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8461 secs
2025-03-13 16:57:03,806 [INFO]: {
2025-03-13 16:57:03,806 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:03,806 [INFO]: 	index_param: efSearch=279
2025-03-13 16:57:03,806 [INFO]: 	index_path: knn.index
2025-03-13 16:57:03,806 [INFO]: 	size in bytes: 424573390
2025-03-13 16:57:03,806 [INFO]: 	avg_search_speed_ms: 12.141003622108329
2025-03-13 16:57:03,806 [INFO]: 	99p_search_speed_ms: 20.66867959219961
2025-03-13 16:57:03,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:03,806 [INFO]: 	nb vectors: 2158
2025-03-13 16:57:03,806 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:03,806 [INFO]: 	compression ratio: 0.9993091276869707
2025-03-13 16:57:03,806 [INFO]: }
2025-03-13 16:57:03,806 [INFO]: 	>>> Finished "Creating the index" in 58.8501 secs
2025-03-13 16:57:03,806 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4124 secs
2025-03-13 16:57:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 86151 [episode count 6/20]
[retrieval_preprocessing] for episode 94359 [episode count 7/20], we have num_retrieval=np.int64(2198) num_query=np.int64(107)
2025-03-13 16:57:06,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:06,517 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:06
2025-03-13 16:57:06,517 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.52it/s]
2025-03-13 16:57:06,542 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 16:57:06,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:57:06,543 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:06
2025-03-13 16:57:06,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:06,543 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:57:06,543 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:06,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:06,543 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:06
2025-03-13 16:57:06,543 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:06,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:57:06,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:06
2025-03-13 16:57:06,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:06,543 [INFO]: 	Creating the index 03/13/2025, 16:57:06
2025-03-13 16:57:06,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:06
2025-03-13 16:57:06,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:57:06,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:06
2025-03-13 16:57:06,544 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:57:06,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.93it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.19it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.33it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.73it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]100%|██████████| 9/9 [00:02<00:00,  4.22it/s]
2025-03-13 16:57:08,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:08
2025-03-13 16:57:36,916 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2362 secs
2025-03-13 16:57:36,916 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 16:57:36,916 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 16:57:54,948 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0312 secs
2025-03-13 16:57:54,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4057 secs
2025-03-13 16:57:54,950 [INFO]: {
2025-03-13 16:57:54,950 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:54,950 [INFO]: 	index_param: efSearch=162
2025-03-13 16:57:54,950 [INFO]: 	index_path: knn.index
2025-03-13 16:57:54,950 [INFO]: 	size in bytes: 432443230
2025-03-13 16:57:54,950 [INFO]: 	avg_search_speed_ms: 9.017061811432619
2025-03-13 16:57:54,950 [INFO]: 	99p_search_speed_ms: 14.78328390978278
2025-03-13 16:57:54,950 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:54,950 [INFO]: 	nb vectors: 2198
2025-03-13 16:57:54,950 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:54,950 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 16:57:54,950 [INFO]: }
2025-03-13 16:57:54,950 [INFO]: 	>>> Finished "Creating the index" in 48.4073 secs
2025-03-13 16:57:54,950 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4335 secs
2025-03-13 16:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 94359 [episode count 7/20]
[retrieval_preprocessing] for episode 32930 [episode count 8/20], we have num_retrieval=np.int64(2140) num_query=np.int64(165)
2025-03-13 16:57:56,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:56,964 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:56
2025-03-13 16:57:56,964 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.35it/s]
2025-03-13 16:57:56,989 [INFO]: There are 2140 embeddings of dim 49152
2025-03-13 16:57:56,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:57:56,989 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:56
2025-03-13 16:57:56,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:56,989 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:57:56,989 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:56,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:56,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:56
2025-03-13 16:57:56,990 [INFO]: 441.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:56,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:57:56,990 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:56
2025-03-13 16:57:56,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:56,990 [INFO]: 	Creating the index 03/13/2025, 16:57:56
2025-03-13 16:57:56,990 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:56
2025-03-13 16:57:56,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:57:56,991 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:56
2025-03-13 16:57:56,991 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:57:56,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.90it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.28it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.89it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.18it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.39it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.55it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.61it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.80it/s]100%|██████████| 9/9 [00:02<00:00,  1.58it/s]100%|██████████| 9/9 [00:02<00:00,  3.17it/s]
2025-03-13 16:57:59,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:59
2025-03-13 16:58:25,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7020 secs
2025-03-13 16:58:25,539 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 16:58:25,539 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.17it/s]
2025-03-13 16:58:42,638 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0999 secs
2025-03-13 16:58:42,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6497 secs
2025-03-13 16:58:42,641 [INFO]: {
2025-03-13 16:58:42,641 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:42,641 [INFO]: 	index_param: efSearch=228
2025-03-13 16:58:42,641 [INFO]: 	index_path: knn.index
2025-03-13 16:58:42,641 [INFO]: 	size in bytes: 421032010
2025-03-13 16:58:42,641 [INFO]: 	avg_search_speed_ms: 9.721679442161214
2025-03-13 16:58:42,641 [INFO]: 	99p_search_speed_ms: 12.92340662330389
2025-03-13 16:58:42,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:42,641 [INFO]: 	nb vectors: 2140
2025-03-13 16:58:42,641 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:42,641 [INFO]: 	compression ratio: 0.999309102412427
2025-03-13 16:58:42,641 [INFO]: }
2025-03-13 16:58:42,641 [INFO]: 	>>> Finished "Creating the index" in 45.6514 secs
2025-03-13 16:58:42,641 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6774 secs
2025-03-13 16:58:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 32930 [episode count 8/20]
[retrieval_preprocessing] for episode 10408 [episode count 9/20], we have num_retrieval=np.int64(2174) num_query=np.int64(131)
2025-03-13 16:58:45,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:45,526 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:45
2025-03-13 16:58:45,526 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.01it/s]
2025-03-13 16:58:45,553 [INFO]: There are 2174 embeddings of dim 49152
2025-03-13 16:58:45,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 16:58:45,553 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:45
2025-03-13 16:58:45,553 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:45,553 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:58:45,554 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:45,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:58:45,554 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:45
2025-03-13 16:58:45,554 [INFO]: 448.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:45,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:58:45,555 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:45
2025-03-13 16:58:45,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:45,555 [INFO]: 	Creating the index 03/13/2025, 16:58:45
2025-03-13 16:58:45,555 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:45
2025-03-13 16:58:45,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 16:58:45,558 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:45
2025-03-13 16:58:45,558 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:58:45,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.10it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.56it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.22it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.63it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.96it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.37it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.63it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.45it/s]100%|██████████| 9/9 [00:02<00:00,  1.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.40it/s]
2025-03-13 16:58:48,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:48
2025-03-13 16:59:14,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9533 secs
2025-03-13 16:59:14,166 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:59:14,166 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 16:59:36,923 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7563 secs
2025-03-13 16:59:36,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3672 secs
2025-03-13 16:59:36,925 [INFO]: {
2025-03-13 16:59:36,925 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:36,925 [INFO]: 	index_param: efSearch=207
2025-03-13 16:59:36,925 [INFO]: 	index_path: knn.index
2025-03-13 16:59:36,925 [INFO]: 	size in bytes: 427721350
2025-03-13 16:59:36,925 [INFO]: 	avg_search_speed_ms: 8.90556289063881
2025-03-13 16:59:36,925 [INFO]: 	99p_search_speed_ms: 11.70221522450447
2025-03-13 16:59:36,925 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:36,925 [INFO]: 	nb vectors: 2174
2025-03-13 16:59:36,925 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:36,925 [INFO]: 	compression ratio: 0.9993089940448379
2025-03-13 16:59:36,925 [INFO]: }
2025-03-13 16:59:36,925 [INFO]: 	>>> Finished "Creating the index" in 51.3705 secs
2025-03-13 16:59:36,925 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3993 secs
2025-03-13 16:59:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 10408 [episode count 9/20]
[retrieval_preprocessing] for episode 55514 [episode count 10/20], we have num_retrieval=np.int64(2196) num_query=np.int64(109)
2025-03-13 16:59:39,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:40,348 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:40
2025-03-13 16:59:40,348 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1999.19it/s]
2025-03-13 16:59:40,370 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 16:59:40,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 16:59:40,370 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:40
2025-03-13 16:59:40,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:40,370 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:59:40,371 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:40,371 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:40,371 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:40
2025-03-13 16:59:40,371 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:40,371 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:59:40,371 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:40
2025-03-13 16:59:40,371 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:40,371 [INFO]: 	Creating the index 03/13/2025, 16:59:40
2025-03-13 16:59:40,371 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:40
2025-03-13 16:59:40,372 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:59:40,372 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:40
2025-03-13 16:59:40,372 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:59:40,372 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.56it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.04it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.66it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.14it/s]100%|██████████| 9/9 [00:02<00:00,  2.70it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 16:59:42,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:42
2025-03-13 17:00:11,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5886 secs
2025-03-13 17:00:11,333 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:00:11,333 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 17:00:31,273 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9400 secs
2025-03-13 17:00:31,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9035 secs
2025-03-13 17:00:31,276 [INFO]: {
2025-03-13 17:00:31,276 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:31,276 [INFO]: 	index_param: efSearch=183
2025-03-13 17:00:31,276 [INFO]: 	index_path: knn.index
2025-03-13 17:00:31,276 [INFO]: 	size in bytes: 432049750
2025-03-13 17:00:31,276 [INFO]: 	avg_search_speed_ms: 9.367238540130806
2025-03-13 17:00:31,276 [INFO]: 	99p_search_speed_ms: 13.345074313692734
2025-03-13 17:00:31,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:31,276 [INFO]: 	nb vectors: 2196
2025-03-13 17:00:31,276 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:31,276 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 17:00:31,276 [INFO]: }
2025-03-13 17:00:31,276 [INFO]: 	>>> Finished "Creating the index" in 50.9049 secs
2025-03-13 17:00:31,276 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9277 secs
2025-03-13 17:00:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 55514 [episode count 10/20]
[retrieval_preprocessing] for episode 86234 [episode count 11/20], we have num_retrieval=np.int64(2213) num_query=np.int64(92)
2025-03-13 17:00:32,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:33,676 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:33
2025-03-13 17:00:33,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-13 17:00:33,704 [INFO]: There are 2213 embeddings of dim 49152
2025-03-13 17:00:33,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:00:33,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:33
2025-03-13 17:00:33,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:33,705 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:00:33,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:33,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:00:33,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:33
2025-03-13 17:00:33,705 [INFO]: 456.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:33,706 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:00:33,706 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:33
2025-03-13 17:00:33,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:33,706 [INFO]: 	Creating the index 03/13/2025, 17:00:33
2025-03-13 17:00:33,706 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:33
2025-03-13 17:00:33,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:00:33,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:33
2025-03-13 17:00:33,709 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:00:33,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.83it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.88it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.57it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.88it/s]100%|██████████| 9/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.92it/s]
2025-03-13 17:00:36,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:36
2025-03-13 17:01:04,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5718 secs
2025-03-13 17:01:04,586 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 17:01:04,586 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-13 17:01:27,969 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3823 secs
2025-03-13 17:01:27,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2623 secs
2025-03-13 17:01:27,971 [INFO]: {
2025-03-13 17:01:27,971 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:27,971 [INFO]: 	index_param: efSearch=236
2025-03-13 17:01:27,971 [INFO]: 	index_path: knn.index
2025-03-13 17:01:27,971 [INFO]: 	size in bytes: 435394330
2025-03-13 17:01:27,971 [INFO]: 	avg_search_speed_ms: 10.445037707715588
2025-03-13 17:01:27,971 [INFO]: 	99p_search_speed_ms: 14.371635527350008
2025-03-13 17:01:27,971 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:27,971 [INFO]: 	nb vectors: 2213
2025-03-13 17:01:27,971 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:27,971 [INFO]: 	compression ratio: 0.9993090723069361
2025-03-13 17:01:27,971 [INFO]: }
2025-03-13 17:01:27,971 [INFO]: 	>>> Finished "Creating the index" in 54.2653 secs
2025-03-13 17:01:27,971 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2948 secs
2025-03-13 17:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 86234 [episode count 11/20]
[retrieval_preprocessing] for episode 41191 [episode count 12/20], we have num_retrieval=np.int64(2208) num_query=np.int64(97)
2025-03-13 17:01:29,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:30,276 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:30
2025-03-13 17:01:30,276 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 17:01:30,301 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 17:01:30,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 17:01:30,301 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:30
2025-03-13 17:01:30,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:30,301 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:01:30,301 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:30,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:30,302 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:30
2025-03-13 17:01:30,302 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:30,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:01:30,302 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:30
2025-03-13 17:01:30,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:30,302 [INFO]: 	Creating the index 03/13/2025, 17:01:30
2025-03-13 17:01:30,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:30
2025-03-13 17:01:30,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:01:30,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:30
2025-03-13 17:01:30,303 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:01:30,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.87it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.35it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.37it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.76it/s]100%|██████████| 9/9 [00:02<00:00,  2.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.93it/s]
2025-03-13 17:01:32,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:32
2025-03-13 17:01:56,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9331 secs
2025-03-13 17:01:56,535 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 17:01:56,535 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
2025-03-13 17:02:21,474 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9390 secs
2025-03-13 17:02:21,476 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1733 secs
2025-03-13 17:02:21,476 [INFO]: {
2025-03-13 17:02:21,476 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:21,476 [INFO]: 	index_param: efSearch=226
2025-03-13 17:02:21,476 [INFO]: 	index_path: knn.index
2025-03-13 17:02:21,476 [INFO]: 	size in bytes: 434410630
2025-03-13 17:02:21,476 [INFO]: 	avg_search_speed_ms: 11.421198362099712
2025-03-13 17:02:21,476 [INFO]: 	99p_search_speed_ms: 18.227632099296898
2025-03-13 17:02:21,477 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:21,477 [INFO]: 	nb vectors: 2208
2025-03-13 17:02:21,477 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:21,477 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 17:02:21,477 [INFO]: }
2025-03-13 17:02:21,477 [INFO]: 	>>> Finished "Creating the index" in 51.1747 secs
2025-03-13 17:02:21,477 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2005 secs
2025-03-13 17:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 41191 [episode count 12/20]
[retrieval_preprocessing] for episode 71917 [episode count 13/20], we have num_retrieval=np.int64(2211) num_query=np.int64(94)
2025-03-13 17:02:23,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:23,528 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:23
2025-03-13 17:02:23,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.96it/s]
2025-03-13 17:02:23,550 [INFO]: There are 2211 embeddings of dim 49152
2025-03-13 17:02:23,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 17:02:23,550 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:23,550 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:02:23,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:23,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:02:23,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,550 [INFO]: 456.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:23,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:02:23,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:23
2025-03-13 17:02:23,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:23,550 [INFO]: 	Creating the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,551 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:23
2025-03-13 17:02:23,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:02:23,552 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,552 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:02:23,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.81it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.81it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.73it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.10it/s]100%|██████████| 9/9 [00:02<00:00,  2.55it/s]100%|██████████| 9/9 [00:02<00:00,  3.62it/s]
2025-03-13 17:02:26,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:26
2025-03-13 17:02:55,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6585 secs
2025-03-13 17:02:55,709 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:02:55,709 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 50%|█████     | 2/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-13 17:03:14,031 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3223 secs
2025-03-13 17:03:14,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4815 secs
2025-03-13 17:03:14,033 [INFO]: {
2025-03-13 17:03:14,033 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:14,033 [INFO]: 	index_param: efSearch=176
2025-03-13 17:03:14,033 [INFO]: 	index_path: knn.index
2025-03-13 17:03:14,033 [INFO]: 	size in bytes: 435000850
2025-03-13 17:03:14,033 [INFO]: 	avg_search_speed_ms: 9.417234438080376
2025-03-13 17:03:14,033 [INFO]: 	99p_search_speed_ms: 19.671222192701
2025-03-13 17:03:14,033 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:14,033 [INFO]: 	nb vectors: 2211
2025-03-13 17:03:14,033 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:14,033 [INFO]: 	compression ratio: 0.9993090542236871
2025-03-13 17:03:14,033 [INFO]: }
2025-03-13 17:03:14,034 [INFO]: 	>>> Finished "Creating the index" in 50.4830 secs
2025-03-13 17:03:14,034 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5056 secs
2025-03-13 17:03:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 71917 [episode count 13/20]
[retrieval_preprocessing] for episode 18561 [episode count 14/20], we have num_retrieval=np.int64(2196) num_query=np.int64(109)
2025-03-13 17:03:15,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:15,657 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:15
2025-03-13 17:03:15,657 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.07it/s]
2025-03-13 17:03:15,682 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 17:03:15,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:03:15,683 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:15
2025-03-13 17:03:15,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:15,683 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:03:15,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:15,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:03:15,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:15
2025-03-13 17:03:15,683 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:15,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:03:15,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:15
2025-03-13 17:03:15,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:15,683 [INFO]: 	Creating the index 03/13/2025, 17:03:15
2025-03-13 17:03:15,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:15
2025-03-13 17:03:15,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:03:15,685 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:15
2025-03-13 17:03:15,685 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:03:15,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.80it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.34it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.19it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.65it/s]100%|██████████| 9/9 [00:02<00:00,  2.70it/s]100%|██████████| 9/9 [00:02<00:00,  3.89it/s]
2025-03-13 17:03:18,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:18
2025-03-13 17:03:43,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0016 secs
2025-03-13 17:03:43,005 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:03:43,005 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 17:04:04,107 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1019 secs
2025-03-13 17:04:04,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4241 secs
2025-03-13 17:04:04,109 [INFO]: {
2025-03-13 17:04:04,109 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:04,109 [INFO]: 	index_param: efSearch=173
2025-03-13 17:04:04,109 [INFO]: 	index_path: knn.index
2025-03-13 17:04:04,109 [INFO]: 	size in bytes: 432049750
2025-03-13 17:04:04,109 [INFO]: 	avg_search_speed_ms: 7.823497469424735
2025-03-13 17:04:04,109 [INFO]: 	99p_search_speed_ms: 12.454951910767706
2025-03-13 17:04:04,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:04,109 [INFO]: 	nb vectors: 2196
2025-03-13 17:04:04,109 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:04,109 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 17:04:04,109 [INFO]: }
2025-03-13 17:04:04,109 [INFO]: 	>>> Finished "Creating the index" in 48.4259 secs
2025-03-13 17:04:04,109 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4524 secs
2025-03-13 17:04:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 18561 [episode count 14/20]
[retrieval_preprocessing] for episode 4357 [episode count 15/20], we have num_retrieval=np.int64(2195) num_query=np.int64(110)
2025-03-13 17:04:05,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:06,013 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:06
2025-03-13 17:04:06,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.38it/s]
2025-03-13 17:04:06,040 [INFO]: There are 2195 embeddings of dim 49152
2025-03-13 17:04:06,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:04:06,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:06
2025-03-13 17:04:06,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:06,040 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:04:06,040 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:06,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:04:06,040 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:06
2025-03-13 17:04:06,040 [INFO]: 453.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:06,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:04:06,040 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:06
2025-03-13 17:04:06,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:06,041 [INFO]: 	Creating the index 03/13/2025, 17:04:06
2025-03-13 17:04:06,041 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:06
2025-03-13 17:04:06,042 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:04:06,042 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:06
2025-03-13 17:04:06,042 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:04:06,042 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.72it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.44it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.91it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.04it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.56it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.49it/s]100%|██████████| 9/9 [00:03<00:00,  1.53it/s]100%|██████████| 9/9 [00:03<00:00,  2.96it/s]
2025-03-13 17:04:09,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:09
2025-03-13 17:04:36,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3726 secs
2025-03-13 17:04:36,454 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:04:36,454 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 17:04:59,923 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4687 secs
2025-03-13 17:04:59,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8830 secs
2025-03-13 17:04:59,925 [INFO]: {
2025-03-13 17:04:59,925 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:59,925 [INFO]: 	index_param: efSearch=228
2025-03-13 17:04:59,925 [INFO]: 	index_path: knn.index
2025-03-13 17:04:59,925 [INFO]: 	size in bytes: 431853010
2025-03-13 17:04:59,925 [INFO]: 	avg_search_speed_ms: 10.513851526570354
2025-03-13 17:04:59,925 [INFO]: 	99p_search_speed_ms: 14.526069979183376
2025-03-13 17:04:59,925 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:59,925 [INFO]: 	nb vectors: 2195
2025-03-13 17:04:59,925 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:59,925 [INFO]: 	compression ratio: 0.9993089083713924
2025-03-13 17:04:59,925 [INFO]: }
2025-03-13 17:04:59,925 [INFO]: 	>>> Finished "Creating the index" in 53.8845 secs
2025-03-13 17:04:59,925 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9119 secs
2025-03-13 17:05:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 4357 [episode count 15/20]
[retrieval_preprocessing] for episode 6411 [episode count 16/20], we have num_retrieval=np.int64(2172) num_query=np.int64(133)
2025-03-13 17:05:01,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:01,950 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:01
2025-03-13 17:05:01,950 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1949.93it/s]
2025-03-13 17:05:01,976 [INFO]: There are 2172 embeddings of dim 49152
2025-03-13 17:05:01,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:05:01,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:01
2025-03-13 17:05:01,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:01,977 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:05:01,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:01,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:05:01,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:01
2025-03-13 17:05:01,977 [INFO]: 448.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:01,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:05:01,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:01
2025-03-13 17:05:01,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:01,978 [INFO]: 	Creating the index 03/13/2025, 17:05:01
2025-03-13 17:05:01,978 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:01
2025-03-13 17:05:01,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:05:01,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:01
2025-03-13 17:05:01,981 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:05:01,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.49it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.21it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.89it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.22it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.43it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.51it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.60it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.75it/s]100%|██████████| 9/9 [00:02<00:00,  1.90it/s]100%|██████████| 9/9 [00:02<00:00,  3.75it/s]
2025-03-13 17:05:04,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:04
2025-03-13 17:05:26,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.5041 secs
2025-03-13 17:05:26,892 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 17:05:26,892 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 17:05:54,895 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0032 secs
2025-03-13 17:05:55,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5565 secs
2025-03-13 17:05:55,538 [INFO]: {
2025-03-13 17:05:55,538 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:55,538 [INFO]: 	index_param: efSearch=277
2025-03-13 17:05:55,538 [INFO]: 	index_path: knn.index
2025-03-13 17:05:55,538 [INFO]: 	size in bytes: 427327810
2025-03-13 17:05:55,538 [INFO]: 	avg_search_speed_ms: 12.719462500243734
2025-03-13 17:05:55,538 [INFO]: 	99p_search_speed_ms: 20.950477900914848
2025-03-13 17:05:55,538 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:55,538 [INFO]: 	nb vectors: 2172
2025-03-13 17:05:55,539 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:55,539 [INFO]: 	compression ratio: 0.9993091158752341
2025-03-13 17:05:55,539 [INFO]: }
2025-03-13 17:05:55,539 [INFO]: 	>>> Finished "Creating the index" in 53.5608 secs
2025-03-13 17:05:55,539 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5889 secs
2025-03-13 17:05:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 6411 [episode count 16/20]
[retrieval_preprocessing] for episode 33044 [episode count 17/20], we have num_retrieval=np.int64(2203) num_query=np.int64(102)
2025-03-13 17:05:57,905 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:58,351 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:58
2025-03-13 17:05:58,351 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.12it/s]
2025-03-13 17:05:58,380 [INFO]: There are 2203 embeddings of dim 49152
2025-03-13 17:05:58,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:05:58,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:58,380 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:05:58,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:58,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:58,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,380 [INFO]: 454.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:58,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:05:58,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:58
2025-03-13 17:05:58,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:58,380 [INFO]: 	Creating the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,380 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:58
2025-03-13 17:05:58,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:05:58,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:58
2025-03-13 17:05:58,382 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:05:58,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.49it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.90it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.84it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.92it/s]100%|██████████| 9/9 [00:02<00:00,  2.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.87it/s]
2025-03-13 17:06:00,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:00
2025-03-13 17:06:25,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2355 secs
2025-03-13 17:06:25,949 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:06:25,949 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 17:06:47,272 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3230 secs
2025-03-13 17:06:47,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8925 secs
2025-03-13 17:06:47,274 [INFO]: {
2025-03-13 17:06:47,274 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:47,274 [INFO]: 	index_param: efSearch=227
2025-03-13 17:06:47,274 [INFO]: 	index_path: knn.index
2025-03-13 17:06:47,274 [INFO]: 	size in bytes: 433426930
2025-03-13 17:06:47,275 [INFO]: 	avg_search_speed_ms: 10.108178851069436
2025-03-13 17:06:47,275 [INFO]: 	99p_search_speed_ms: 14.731341656297447
2025-03-13 17:06:47,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:47,275 [INFO]: 	nb vectors: 2203
2025-03-13 17:06:47,275 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:47,275 [INFO]: 	compression ratio: 0.9993089815623594
2025-03-13 17:06:47,275 [INFO]: }
2025-03-13 17:06:47,275 [INFO]: 	>>> Finished "Creating the index" in 48.8942 secs
2025-03-13 17:06:47,275 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9234 secs
2025-03-13 17:06:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 33044 [episode count 17/20]
[retrieval_preprocessing] for episode 76071 [episode count 18/20], we have num_retrieval=np.int64(2196) num_query=np.int64(109)
2025-03-13 17:06:49,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:49,878 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:49
2025-03-13 17:06:49,878 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1883.39it/s]
2025-03-13 17:06:49,902 [INFO]: There are 2196 embeddings of dim 49152
2025-03-13 17:06:49,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 17:06:49,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,903 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:49,903 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:06:49,903 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:49,903 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:06:49,903 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,903 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:49,903 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:06:49,903 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:49
2025-03-13 17:06:49,903 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:49,903 [INFO]: 	Creating the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,903 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:49
2025-03-13 17:06:49,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:06:49,904 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,904 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:06:49,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.06it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.71it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.46it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.83it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.84it/s]100%|██████████| 9/9 [00:02<00:00,  1.94it/s]100%|██████████| 9/9 [00:02<00:00,  3.45it/s]
2025-03-13 17:06:52,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:52
2025-03-13 17:07:19,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8354 secs
2025-03-13 17:07:19,351 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 17:07:19,351 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 17:07:44,498 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1469 secs
2025-03-13 17:07:44,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5965 secs
2025-03-13 17:07:44,501 [INFO]: {
2025-03-13 17:07:44,501 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:44,501 [INFO]: 	index_param: efSearch=240
2025-03-13 17:07:44,501 [INFO]: 	index_path: knn.index
2025-03-13 17:07:44,501 [INFO]: 	size in bytes: 432049750
2025-03-13 17:07:44,501 [INFO]: 	avg_search_speed_ms: 10.343989715627332
2025-03-13 17:07:44,501 [INFO]: 	99p_search_speed_ms: 16.077054091729252
2025-03-13 17:07:44,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:44,501 [INFO]: 	nb vectors: 2196
2025-03-13 17:07:44,501 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:44,501 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-13 17:07:44,501 [INFO]: }
2025-03-13 17:07:44,501 [INFO]: 	>>> Finished "Creating the index" in 54.5979 secs
2025-03-13 17:07:44,501 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6226 secs
2025-03-13 17:07:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 76071 [episode count 18/20]
[retrieval_preprocessing] for episode 27288 [episode count 19/20], we have num_retrieval=np.int64(2177) num_query=np.int64(128)
2025-03-13 17:07:45,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:46,329 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:46
2025-03-13 17:07:46,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.28it/s]
2025-03-13 17:07:46,358 [INFO]: There are 2177 embeddings of dim 49152
2025-03-13 17:07:46,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:07:46,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:46
2025-03-13 17:07:46,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:46,359 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:07:46,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:46,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:07:46,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:46
2025-03-13 17:07:46,360 [INFO]: 449.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:46,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:07:46,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:46
2025-03-13 17:07:46,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:46,361 [INFO]: 	Creating the index 03/13/2025, 17:07:46
2025-03-13 17:07:46,361 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:46
2025-03-13 17:07:46,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:07:46,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:46
2025-03-13 17:07:46,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:07:46,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.97it/s] 33%|███▎      | 3/9 [00:00<00:00, 14.31it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.98it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.31it/s]100%|██████████| 9/9 [00:02<00:00,  2.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 17:07:48,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:48
2025-03-13 17:08:12,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6955 secs
2025-03-13 17:08:12,456 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:08:12,456 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.86it/s] 50%|█████     | 2/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.65it/s]
2025-03-13 17:08:32,110 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6535 secs
2025-03-13 17:08:32,114 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7497 secs
2025-03-13 17:08:32,114 [INFO]: {
2025-03-13 17:08:32,114 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:32,114 [INFO]: 	index_param: efSearch=210
2025-03-13 17:08:32,114 [INFO]: 	index_path: knn.index
2025-03-13 17:08:32,114 [INFO]: 	size in bytes: 428311570
2025-03-13 17:08:32,114 [INFO]: 	avg_search_speed_ms: 10.305810975578416
2025-03-13 17:08:32,114 [INFO]: 	99p_search_speed_ms: 14.775175810791547
2025-03-13 17:08:32,114 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:32,114 [INFO]: 	nb vectors: 2177
2025-03-13 17:08:32,114 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:32,114 [INFO]: 	compression ratio: 0.9993090217011882
2025-03-13 17:08:32,114 [INFO]: }
2025-03-13 17:08:32,114 [INFO]: 	>>> Finished "Creating the index" in 45.7532 secs
2025-03-13 17:08:32,114 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7848 secs
2025-03-13 17:08:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 27288 [episode count 19/20]
2025-03-13 17:08:34: [retrieval_preprocessing] finished for 8626796008_toaster_lever_down [chosen_id count 5/196]
2025-03-13 17:08:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8626796008_toaster_lever_up [chosen_id count 6/196]
2025-03-13 17:08:36: [retrieval_preprocessing] we have num_total=2946 embedding_dim=49152
[retrieval_preprocessing] for episode 30747 [episode count 0/20], we have num_retrieval=np.int64(2729) num_query=np.int64(217)
2025-03-13 17:08:37,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:38,581 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:38
2025-03-13 17:08:38,581 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-13 17:08:38,611 [INFO]: There are 2729 embeddings of dim 49152
2025-03-13 17:08:38,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 17:08:38,612 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:38
2025-03-13 17:08:38,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:38,612 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:08:38,612 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:38,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:38,612 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:38
2025-03-13 17:08:38,612 [INFO]: 563.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:38,612 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:08:38,612 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:38
2025-03-13 17:08:38,612 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:38,612 [INFO]: 	Creating the index 03/13/2025, 17:08:38
2025-03-13 17:08:38,612 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:38
2025-03-13 17:08:38,614 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:08:38,614 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:38
2025-03-13 17:08:38,614 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:08:38,614 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.28it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.67it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.56it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.04it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.32it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.40it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.79it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.02it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.12it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.04it/s]100%|██████████| 11/11 [00:03<00:00,  1.26it/s]100%|██████████| 11/11 [00:03<00:00,  3.12it/s]
2025-03-13 17:08:42,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:42
2025-03-13 17:09:18,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3225 secs
2025-03-13 17:09:18,475 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 17:09:18,475 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 17:09:42,655 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1793 secs
2025-03-13 17:09:42,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0430 secs
2025-03-13 17:09:42,657 [INFO]: {
2025-03-13 17:09:42,657 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:42,657 [INFO]: 	index_param: efSearch=245
2025-03-13 17:09:42,657 [INFO]: 	index_path: knn.index
2025-03-13 17:09:42,657 [INFO]: 	size in bytes: 536913790
2025-03-13 17:09:42,657 [INFO]: 	avg_search_speed_ms: 10.525808601493114
2025-03-13 17:09:42,657 [INFO]: 	99p_search_speed_ms: 18.502225915435698
2025-03-13 17:09:42,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:42,657 [INFO]: 	nb vectors: 2729
2025-03-13 17:09:42,657 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:42,657 [INFO]: 	compression ratio: 0.9993098370596889
2025-03-13 17:09:42,657 [INFO]: }
2025-03-13 17:09:42,657 [INFO]: 	>>> Finished "Creating the index" in 64.0448 secs
2025-03-13 17:09:42,657 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0765 secs
2025-03-13 17:09:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 30747 [episode count 0/20]
[retrieval_preprocessing] for episode 37085 [episode count 1/20], we have num_retrieval=np.int64(2743) num_query=np.int64(203)
2025-03-13 17:09:45,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:46,812 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:46
2025-03-13 17:09:46,812 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1692.62it/s]
2025-03-13 17:09:46,840 [INFO]: There are 2743 embeddings of dim 49152
2025-03-13 17:09:46,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:09:46,840 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:46
2025-03-13 17:09:46,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:46,841 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:09:46,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:46,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:09:46,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:46
2025-03-13 17:09:46,841 [INFO]: 566.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:46,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:09:46,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:46
2025-03-13 17:09:46,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:46,842 [INFO]: 	Creating the index 03/13/2025, 17:09:46
2025-03-13 17:09:46,843 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:46
2025-03-13 17:09:46,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:09:46,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:46
2025-03-13 17:09:46,846 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:09:46,847 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.37it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.04it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.09it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.81it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.26it/s]100%|██████████| 11/11 [00:02<00:00,  2.32it/s]100%|██████████| 11/11 [00:02<00:00,  3.68it/s]
2025-03-13 17:09:49,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:49
2025-03-13 17:10:23,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9607 secs
2025-03-13 17:10:23,811 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 17:10:23,811 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 17:10:55,998 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1873 secs
2025-03-13 17:10:56,000 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1540 secs
2025-03-13 17:10:56,000 [INFO]: {
2025-03-13 17:10:56,000 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:56,000 [INFO]: 	index_param: efSearch=300
2025-03-13 17:10:56,000 [INFO]: 	index_path: knn.index
2025-03-13 17:10:56,000 [INFO]: 	size in bytes: 539668150
2025-03-13 17:10:56,000 [INFO]: 	avg_search_speed_ms: 11.058763835519404
2025-03-13 17:10:56,000 [INFO]: 	99p_search_speed_ms: 20.088328642304987
2025-03-13 17:10:56,000 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:56,000 [INFO]: 	nb vectors: 2743
2025-03-13 17:10:56,000 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:56,000 [INFO]: 	compression ratio: 0.9993099351888749
2025-03-13 17:10:56,000 [INFO]: }
2025-03-13 17:10:56,000 [INFO]: 	>>> Finished "Creating the index" in 69.1580 secs
2025-03-13 17:10:56,001 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1883 secs
2025-03-13 17:10:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 37085 [episode count 1/20]
[retrieval_preprocessing] for episode 8619 [episode count 2/20], we have num_retrieval=np.int64(2828) num_query=np.int64(118)
2025-03-13 17:10:59,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:59,897 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:59
2025-03-13 17:10:59,897 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1718.98it/s]
2025-03-13 17:11:00,346 [INFO]: There are 2828 embeddings of dim 49152
2025-03-13 17:11:00,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4489 secs
2025-03-13 17:11:00,346 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:00
2025-03-13 17:11:00,346 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:00,346 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:11:00,346 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:00,346 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:11:00,347 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:00
2025-03-13 17:11:00,347 [INFO]: 583.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:00,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:11:00,347 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:00
2025-03-13 17:11:00,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:00,347 [INFO]: 	Creating the index 03/13/2025, 17:11:00
2025-03-13 17:11:00,347 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:00
2025-03-13 17:11:00,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:11:00,349 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:00
2025-03-13 17:11:00,349 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:11:00,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.74it/s] 42%|████▏     | 5/12 [00:00<00:00, 20.75it/s] 75%|███████▌  | 9/12 [00:00<00:00, 28.09it/s]100%|██████████| 12/12 [00:02<00:00,  4.83it/s]
2025-03-13 17:11:02,842 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:02
2025-03-13 17:11:38,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6289 secs
2025-03-13 17:11:38,472 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 17:11:38,472 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.00it/s]
2025-03-13 17:12:00,022 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5496 secs
2025-03-13 17:12:00,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6761 secs
2025-03-13 17:12:00,026 [INFO]: {
2025-03-13 17:12:00,026 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:00,026 [INFO]: 	index_param: efSearch=123
2025-03-13 17:12:00,026 [INFO]: 	index_path: knn.index
2025-03-13 17:12:00,026 [INFO]: 	size in bytes: 556391470
2025-03-13 17:12:00,026 [INFO]: 	avg_search_speed_ms: 10.288342929813137
2025-03-13 17:12:00,026 [INFO]: 	99p_search_speed_ms: 16.717446024995297
2025-03-13 17:12:00,026 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:00,026 [INFO]: 	nb vectors: 2828
2025-03-13 17:12:00,026 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:00,026 [INFO]: 	compression ratio: 0.9993097557732149
2025-03-13 17:12:00,026 [INFO]: }
2025-03-13 17:12:00,026 [INFO]: 	>>> Finished "Creating the index" in 59.6787 secs
2025-03-13 17:12:00,026 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1290 secs
2025-03-13 17:12:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 8619 [episode count 2/20]
[retrieval_preprocessing] for episode 85734 [episode count 3/20], we have num_retrieval=np.int64(2813) num_query=np.int64(133)
2025-03-13 17:12:01,928 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:02,418 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:02
2025-03-13 17:12:02,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-13 17:12:02,445 [INFO]: There are 2813 embeddings of dim 49152
2025-03-13 17:12:02,445 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:12:02,445 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:02
2025-03-13 17:12:02,445 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:02,445 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:12:02,445 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:02,445 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:02,445 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:02
2025-03-13 17:12:02,445 [INFO]: 580.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:02,445 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:02,446 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:02
2025-03-13 17:12:02,446 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:02,446 [INFO]: 	Creating the index 03/13/2025, 17:12:02
2025-03-13 17:12:02,446 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:02
2025-03-13 17:12:02,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:12:02,447 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:02
2025-03-13 17:12:02,447 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:12:02,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.07it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.56it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.14it/s] 58%|█████▊    | 7/12 [00:00<00:00, 13.06it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.59it/s] 92%|█████████▏| 11/12 [00:00<00:00, 14.31it/s]100%|██████████| 12/12 [00:03<00:00,  3.58it/s]
2025-03-13 17:12:05,806 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:05
2025-03-13 17:12:46,039 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2327 secs
2025-03-13 17:12:46,039 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 17:12:46,039 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-13 17:13:08,647 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6074 secs
2025-03-13 17:13:08,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2028 secs
2025-03-13 17:13:08,650 [INFO]: {
2025-03-13 17:13:08,650 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:08,650 [INFO]: 	index_param: efSearch=233
2025-03-13 17:13:08,650 [INFO]: 	index_path: knn.index
2025-03-13 17:13:08,650 [INFO]: 	size in bytes: 553440310
2025-03-13 17:13:08,650 [INFO]: 	avg_search_speed_ms: 10.971742064429346
2025-03-13 17:13:08,650 [INFO]: 	99p_search_speed_ms: 16.283933212980624
2025-03-13 17:13:08,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:08,650 [INFO]: 	nb vectors: 2813
2025-03-13 17:13:08,650 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:08,650 [INFO]: 	compression ratio: 0.999309761155634
2025-03-13 17:13:08,650 [INFO]: }
2025-03-13 17:13:08,650 [INFO]: 	>>> Finished "Creating the index" in 66.2042 secs
2025-03-13 17:13:08,650 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2315 secs
2025-03-13 17:13:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 85734 [episode count 3/20]
[retrieval_preprocessing] for episode 23532 [episode count 4/20], we have num_retrieval=np.int64(2853) num_query=np.int64(93)
2025-03-13 17:13:11,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:13,023 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:13
2025-03-13 17:13:13,023 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-13 17:13:13,054 [INFO]: There are 2853 embeddings of dim 49152
2025-03-13 17:13:13,054 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 17:13:13,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:13
2025-03-13 17:13:13,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:13,055 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:13:13,055 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:13,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:13:13,055 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:13
2025-03-13 17:13:13,055 [INFO]: 588.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:13,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:13:13,056 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:13
2025-03-13 17:13:13,056 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:13,056 [INFO]: 	Creating the index 03/13/2025, 17:13:13
2025-03-13 17:13:13,056 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:13
2025-03-13 17:13:13,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:13:13,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:13
2025-03-13 17:13:13,060 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:13:13,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.01it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.56it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.41it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.75it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.01it/s] 50%|█████     | 6/12 [00:00<00:00,  8.19it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.30it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.40it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.55it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.64it/s]100%|██████████| 12/12 [00:03<00:00,  1.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.58it/s]
2025-03-13 17:13:16,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:16
2025-03-13 17:13:47,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9310 secs
2025-03-13 17:13:47,347 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 17:13:47,348 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-13 17:14:17,881 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5336 secs
2025-03-13 17:14:17,884 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8245 secs
2025-03-13 17:14:17,885 [INFO]: {
2025-03-13 17:14:17,885 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:17,885 [INFO]: 	index_param: efSearch=237
2025-03-13 17:14:17,885 [INFO]: 	index_path: knn.index
2025-03-13 17:14:17,885 [INFO]: 	size in bytes: 561310090
2025-03-13 17:14:17,885 [INFO]: 	avg_search_speed_ms: 10.590981604270953
2025-03-13 17:14:17,885 [INFO]: 	99p_search_speed_ms: 20.557507353369108
2025-03-13 17:14:17,885 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:17,885 [INFO]: 	nb vectors: 2853
2025-03-13 17:14:17,885 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:17,885 [INFO]: 	compression ratio: 0.999309711321954
2025-03-13 17:14:17,885 [INFO]: }
2025-03-13 17:14:17,885 [INFO]: 	>>> Finished "Creating the index" in 64.8289 secs
2025-03-13 17:14:17,885 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8619 secs
2025-03-13 17:14:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 23532 [episode count 4/20]
[retrieval_preprocessing] for episode 75080 [episode count 5/20], we have num_retrieval=np.int64(2826) num_query=np.int64(120)
2025-03-13 17:14:19,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:20,771 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:20
2025-03-13 17:14:20,771 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 17:14:20,798 [INFO]: There are 2826 embeddings of dim 49152
2025-03-13 17:14:20,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:14:20,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:20,799 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:14:20,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:20,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:20,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,799 [INFO]: 583.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:20,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:14:20,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:20
2025-03-13 17:14:20,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:20,799 [INFO]: 	Creating the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:20
2025-03-13 17:14:20,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:14:20,801 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:20
2025-03-13 17:14:20,801 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:14:20,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.62it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.62it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.06it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.27it/s] 50%|█████     | 6/12 [00:00<00:00,  8.21it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.05it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.02it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.85it/s]100%|██████████| 12/12 [00:03<00:00,  1.78it/s]100%|██████████| 12/12 [00:03<00:00,  3.41it/s]
2025-03-13 17:14:24,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:24
2025-03-13 17:14:57,731 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4037 secs
2025-03-13 17:14:57,731 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 17:14:57,731 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 17:15:30,560 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8284 secs
2025-03-13 17:15:30,562 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7611 secs
2025-03-13 17:15:30,562 [INFO]: {
2025-03-13 17:15:30,562 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:30,562 [INFO]: 	index_param: efSearch=294
2025-03-13 17:15:30,562 [INFO]: 	index_path: knn.index
2025-03-13 17:15:30,562 [INFO]: 	size in bytes: 555997990
2025-03-13 17:15:30,562 [INFO]: 	avg_search_speed_ms: 9.334192394751126
2025-03-13 17:15:30,562 [INFO]: 	99p_search_speed_ms: 12.362090172246099
2025-03-13 17:15:30,562 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:30,562 [INFO]: 	nb vectors: 2826
2025-03-13 17:15:30,562 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:30,562 [INFO]: 	compression ratio: 0.9993097421089597
2025-03-13 17:15:30,562 [INFO]: }
2025-03-13 17:15:30,562 [INFO]: 	>>> Finished "Creating the index" in 69.7629 secs
2025-03-13 17:15:30,562 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7912 secs
2025-03-13 17:15:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 75080 [episode count 5/20]
[retrieval_preprocessing] for episode 3437 [episode count 6/20], we have num_retrieval=np.int64(2810) num_query=np.int64(136)
2025-03-13 17:15:32,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:33,350 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:33
2025-03-13 17:15:33,350 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1653.91it/s]
2025-03-13 17:15:33,373 [INFO]: There are 2810 embeddings of dim 49152
2025-03-13 17:15:33,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 17:15:33,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:33
2025-03-13 17:15:33,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:33,374 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:15:33,374 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:33,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:33,374 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:33
2025-03-13 17:15:33,374 [INFO]: 579.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:33,374 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:15:33,374 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:33
2025-03-13 17:15:33,374 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:33,374 [INFO]: 	Creating the index 03/13/2025, 17:15:33
2025-03-13 17:15:33,374 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:33
2025-03-13 17:15:33,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:15:33,375 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:33
2025-03-13 17:15:33,375 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:15:33,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.54it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.46it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.02it/s] 50%|█████     | 6/12 [00:00<00:00,  9.47it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.44it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.51it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.61it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.15it/s]100%|██████████| 12/12 [00:02<00:00,  4.32it/s]
2025-03-13 17:15:36,156 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:36
2025-03-13 17:16:07,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7481 secs
2025-03-13 17:16:07,905 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 17:16:07,905 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 17:16:29,293 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3877 secs
2025-03-13 17:16:29,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9206 secs
2025-03-13 17:16:29,296 [INFO]: {
2025-03-13 17:16:29,296 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:29,296 [INFO]: 	index_param: efSearch=222
2025-03-13 17:16:29,296 [INFO]: 	index_path: knn.index
2025-03-13 17:16:29,296 [INFO]: 	size in bytes: 552850090
2025-03-13 17:16:29,296 [INFO]: 	avg_search_speed_ms: 8.868567469532287
2025-03-13 17:16:29,296 [INFO]: 	99p_search_speed_ms: 15.445839776657532
2025-03-13 17:16:29,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:29,296 [INFO]: 	nb vectors: 2810
2025-03-13 17:16:29,296 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:29,296 [INFO]: 	compression ratio: 0.9993097405482922
2025-03-13 17:16:29,296 [INFO]: }
2025-03-13 17:16:29,296 [INFO]: 	>>> Finished "Creating the index" in 55.9221 secs
2025-03-13 17:16:29,296 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9457 secs
2025-03-13 17:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 3437 [episode count 6/20]
[retrieval_preprocessing] for episode 74503 [episode count 7/20], we have num_retrieval=np.int64(2745) num_query=np.int64(201)
2025-03-13 17:16:33,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:33,444 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:33
2025-03-13 17:16:33,444 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.12it/s]
2025-03-13 17:16:33,472 [INFO]: There are 2745 embeddings of dim 49152
2025-03-13 17:16:33,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:16:33,473 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:33
2025-03-13 17:16:33,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:33,474 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:16:33,474 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:33,474 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:16:33,474 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:33
2025-03-13 17:16:33,474 [INFO]: 566.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:33,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:16:33,475 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:33
2025-03-13 17:16:33,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:33,475 [INFO]: 	Creating the index 03/13/2025, 17:16:33
2025-03-13 17:16:33,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:33
2025-03-13 17:16:33,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:16:33,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:33
2025-03-13 17:16:33,479 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:16:33,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.93it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.67it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.38it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.50it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.63it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.76it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.69it/s]100%|██████████| 11/11 [00:02<00:00,  1.88it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-13 17:16:36,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:36
2025-03-13 17:17:05,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9878 secs
2025-03-13 17:17:05,329 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 17:17:05,329 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.60it/s] 50%|█████     | 2/4 [00:00<00:00,  5.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.66it/s]
2025-03-13 17:17:28,420 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0906 secs
2025-03-13 17:17:28,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9433 secs
2025-03-13 17:17:28,422 [INFO]: {
2025-03-13 17:17:28,422 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:28,422 [INFO]: 	index_param: efSearch=233
2025-03-13 17:17:28,422 [INFO]: 	index_path: knn.index
2025-03-13 17:17:28,422 [INFO]: 	size in bytes: 540061630
2025-03-13 17:17:28,422 [INFO]: 	avg_search_speed_ms: 10.195503616563133
2025-03-13 17:17:28,422 [INFO]: 	99p_search_speed_ms: 21.48520709015432
2025-03-13 17:17:28,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:28,422 [INFO]: 	nb vectors: 2745
2025-03-13 17:17:28,422 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:28,422 [INFO]: 	compression ratio: 0.9993099491256211
2025-03-13 17:17:28,422 [INFO]: }
2025-03-13 17:17:28,422 [INFO]: 	>>> Finished "Creating the index" in 54.9470 secs
2025-03-13 17:17:28,422 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9785 secs
2025-03-13 17:17:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 74503 [episode count 7/20]
[retrieval_preprocessing] for episode 65086 [episode count 8/20], we have num_retrieval=np.int64(2843) num_query=np.int64(103)
2025-03-13 17:17:31,422 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:31,926 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:31
2025-03-13 17:17:31,926 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.20it/s]
2025-03-13 17:17:31,951 [INFO]: There are 2843 embeddings of dim 49152
2025-03-13 17:17:31,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:17:31,951 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:31
2025-03-13 17:17:31,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:31,951 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:17:31,951 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:31,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:17:31,952 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:31
2025-03-13 17:17:31,952 [INFO]: 586.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:31,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:17:31,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:31
2025-03-13 17:17:31,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:31,952 [INFO]: 	Creating the index 03/13/2025, 17:17:31
2025-03-13 17:17:31,952 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:31
2025-03-13 17:17:31,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:17:31,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:31
2025-03-13 17:17:31,953 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:17:31,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.12it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.64it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.75it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.99it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.22it/s] 50%|█████     | 6/12 [00:00<00:00,  8.39it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.53it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.70it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.62it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.57it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.65it/s]100%|██████████| 12/12 [00:03<00:00,  1.51it/s]100%|██████████| 12/12 [00:03<00:00,  3.68it/s]
2025-03-13 17:17:35,219 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:35
2025-03-13 17:18:07,287 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0681 secs
2025-03-13 17:18:07,287 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:18:07,287 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 17:18:29,431 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1432 secs
2025-03-13 17:18:29,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4799 secs
2025-03-13 17:18:29,433 [INFO]: {
2025-03-13 17:18:29,433 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:29,433 [INFO]: 	index_param: efSearch=213
2025-03-13 17:18:29,433 [INFO]: 	index_path: knn.index
2025-03-13 17:18:29,433 [INFO]: 	size in bytes: 559342690
2025-03-13 17:18:29,433 [INFO]: 	avg_search_speed_ms: 9.500539789094828
2025-03-13 17:18:29,433 [INFO]: 	99p_search_speed_ms: 15.247401762753727
2025-03-13 17:18:29,433 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:29,433 [INFO]: 	nb vectors: 2843
2025-03-13 17:18:29,433 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:29,433 [INFO]: 	compression ratio: 0.9993096432528689
2025-03-13 17:18:29,433 [INFO]: }
2025-03-13 17:18:29,433 [INFO]: 	>>> Finished "Creating the index" in 57.4815 secs
2025-03-13 17:18:29,433 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5077 secs
2025-03-13 17:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 65086 [episode count 8/20]
[retrieval_preprocessing] for episode 36248 [episode count 9/20], we have num_retrieval=np.int64(2714) num_query=np.int64(232)
2025-03-13 17:18:31,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:31,719 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:31
2025-03-13 17:18:31,719 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.05it/s]
2025-03-13 17:18:31,743 [INFO]: There are 2714 embeddings of dim 49152
2025-03-13 17:18:31,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 17:18:31,743 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:31,744 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:18:31,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:31,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:18:31,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,744 [INFO]: 560.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:31,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:18:31,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:31
2025-03-13 17:18:31,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:31,744 [INFO]: 	Creating the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,744 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:31
2025-03-13 17:18:31,745 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:18:31,745 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,745 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:18:31,745 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.79it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.20it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.23it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.87it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.93it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.62it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.49it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.28it/s]100%|██████████| 11/11 [00:03<00:00,  1.62it/s]100%|██████████| 11/11 [00:03<00:00,  3.50it/s]
2025-03-13 17:18:34,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:34
2025-03-13 17:19:06,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5337 secs
2025-03-13 17:19:06,424 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 17:19:06,424 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.65it/s]
2025-03-13 17:19:28,959 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5350 secs
2025-03-13 17:19:28,962 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2171 secs
2025-03-13 17:19:28,962 [INFO]: {
2025-03-13 17:19:28,962 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:28,962 [INFO]: 	index_param: efSearch=246
2025-03-13 17:19:28,962 [INFO]: 	index_path: knn.index
2025-03-13 17:19:28,962 [INFO]: 	size in bytes: 533962690
2025-03-13 17:19:28,962 [INFO]: 	avg_search_speed_ms: 11.389178546370433
2025-03-13 17:19:28,962 [INFO]: 	99p_search_speed_ms: 21.147541722748436
2025-03-13 17:19:28,962 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:28,962 [INFO]: 	nb vectors: 2714
2025-03-13 17:19:28,963 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:28,963 [INFO]: 	compression ratio: 0.9993097307978578
2025-03-13 17:19:28,963 [INFO]: }
2025-03-13 17:19:28,963 [INFO]: 	>>> Finished "Creating the index" in 57.2186 secs
2025-03-13 17:19:28,963 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2439 secs
2025-03-13 17:19:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 36248 [episode count 9/20]
[retrieval_preprocessing] for episode 9656 [episode count 10/20], we have num_retrieval=np.int64(2804) num_query=np.int64(142)
2025-03-13 17:19:33,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:33,667 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:33
2025-03-13 17:19:33,667 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.89it/s]
2025-03-13 17:19:33,697 [INFO]: There are 2804 embeddings of dim 49152
2025-03-13 17:19:33,697 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:19:33,697 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:33
2025-03-13 17:19:33,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:33,698 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:19:33,698 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:33,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:19:33,698 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:33
2025-03-13 17:19:33,699 [INFO]: 578.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:33,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:19:33,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:33
2025-03-13 17:19:33,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:33,700 [INFO]: 	Creating the index 03/13/2025, 17:19:33
2025-03-13 17:19:33,700 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:33
2025-03-13 17:19:33,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:19:33,702 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:33
2025-03-13 17:19:33,702 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:19:33,702 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.67it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.25it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.52it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.98it/s] 92%|█████████▏| 11/12 [00:00<00:00, 15.92it/s]100%|██████████| 12/12 [00:03<00:00,  3.99it/s]
2025-03-13 17:19:37,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:37
2025-03-13 17:20:12,614 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5388 secs
2025-03-13 17:20:12,615 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 17:20:12,615 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-13 17:20:39,661 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0458 secs
2025-03-13 17:20:39,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9622 secs
2025-03-13 17:20:39,664 [INFO]: {
2025-03-13 17:20:39,664 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:39,664 [INFO]: 	index_param: efSearch=177
2025-03-13 17:20:39,664 [INFO]: 	index_path: knn.index
2025-03-13 17:20:39,664 [INFO]: 	size in bytes: 551669650
2025-03-13 17:20:39,664 [INFO]: 	avg_search_speed_ms: 10.191788644625765
2025-03-13 17:20:39,664 [INFO]: 	99p_search_speed_ms: 18.267669389024412
2025-03-13 17:20:39,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:39,664 [INFO]: 	nb vectors: 2804
2025-03-13 17:20:39,664 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:39,664 [INFO]: 	compression ratio: 0.9993096992013245
2025-03-13 17:20:39,664 [INFO]: }
2025-03-13 17:20:39,664 [INFO]: 	>>> Finished "Creating the index" in 65.9645 secs
2025-03-13 17:20:39,664 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9971 secs
2025-03-13 17:20:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 9656 [episode count 10/20]
[retrieval_preprocessing] for episode 85252 [episode count 11/20], we have num_retrieval=np.int64(2803) num_query=np.int64(143)
2025-03-13 17:20:41,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:41,539 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:41
2025-03-13 17:20:41,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.76it/s]
2025-03-13 17:20:41,572 [INFO]: There are 2803 embeddings of dim 49152
2025-03-13 17:20:41,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 17:20:41,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:41
2025-03-13 17:20:41,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:41,572 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:20:41,572 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:41,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:41,572 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:41
2025-03-13 17:20:41,572 [INFO]: 578.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:41,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:20:41,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:41
2025-03-13 17:20:41,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:41,572 [INFO]: 	Creating the index 03/13/2025, 17:20:41
2025-03-13 17:20:41,573 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:41
2025-03-13 17:20:41,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:20:41,574 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:41
2025-03-13 17:20:41,574 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:20:41,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.52it/s] 50%|█████     | 6/12 [00:00<00:00, 28.34it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.21it/s]100%|██████████| 12/12 [00:02<00:00,  5.14it/s]
2025-03-13 17:20:43,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:43
2025-03-13 17:21:23,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9073 secs
2025-03-13 17:21:23,821 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:21:23,821 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-13 17:21:44,216 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3956 secs
2025-03-13 17:21:44,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2880 secs
2025-03-13 17:21:44,862 [INFO]: {
2025-03-13 17:21:44,862 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:44,862 [INFO]: 	index_param: efSearch=174
2025-03-13 17:21:44,862 [INFO]: 	index_path: knn.index
2025-03-13 17:21:44,862 [INFO]: 	size in bytes: 551472910
2025-03-13 17:21:44,862 [INFO]: 	avg_search_speed_ms: 8.395235454366487
2025-03-13 17:21:44,862 [INFO]: 	99p_search_speed_ms: 12.59902818128466
2025-03-13 17:21:44,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:44,862 [INFO]: 	nb vectors: 2803
2025-03-13 17:21:44,862 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:44,862 [INFO]: 	compression ratio: 0.9993096922929542
2025-03-13 17:21:44,862 [INFO]: }
2025-03-13 17:21:44,862 [INFO]: 	>>> Finished "Creating the index" in 63.2900 secs
2025-03-13 17:21:44,862 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3237 secs
2025-03-13 17:21:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 85252 [episode count 11/20]
[retrieval_preprocessing] for episode 11470 [episode count 12/20], we have num_retrieval=np.int64(2805) num_query=np.int64(141)
2025-03-13 17:21:46,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:47,139 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:47
2025-03-13 17:21:47,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 795.28it/s]
2025-03-13 17:21:47,171 [INFO]: There are 2805 embeddings of dim 49152
2025-03-13 17:21:47,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 17:21:47,172 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:47
2025-03-13 17:21:47,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:47,172 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:21:47,172 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:47,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:21:47,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:47
2025-03-13 17:21:47,173 [INFO]: 578.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:47,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:21:47,173 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:47
2025-03-13 17:21:47,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:21:47,174 [INFO]: 	Creating the index 03/13/2025, 17:21:47
2025-03-13 17:21:47,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:47
2025-03-13 17:21:47,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 17:21:47,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:47
2025-03-13 17:21:47,177 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:21:47,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.03it/s] 50%|█████     | 6/12 [00:00<00:00, 29.98it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.74it/s]100%|██████████| 12/12 [00:02<00:00,  4.78it/s]
2025-03-13 17:21:49,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:49
2025-03-13 17:22:29,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0231 secs
2025-03-13 17:22:29,717 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 17:22:29,717 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.86it/s]
2025-03-13 17:22:48,702 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9848 secs
2025-03-13 17:22:48,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5269 secs
2025-03-13 17:22:48,704 [INFO]: {
2025-03-13 17:22:48,704 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:48,704 [INFO]: 	index_param: efSearch=203
2025-03-13 17:22:48,704 [INFO]: 	index_path: knn.index
2025-03-13 17:22:48,704 [INFO]: 	size in bytes: 551866390
2025-03-13 17:22:48,704 [INFO]: 	avg_search_speed_ms: 9.055053181288278
2025-03-13 17:22:48,704 [INFO]: 	99p_search_speed_ms: 16.31236564135179
2025-03-13 17:22:48,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:48,704 [INFO]: 	nb vectors: 2805
2025-03-13 17:22:48,704 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:48,704 [INFO]: 	compression ratio: 0.9993097061047693
2025-03-13 17:22:48,704 [INFO]: }
2025-03-13 17:22:48,704 [INFO]: 	>>> Finished "Creating the index" in 61.5304 secs
2025-03-13 17:22:48,704 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5655 secs
2025-03-13 17:22:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 11470 [episode count 12/20]
[retrieval_preprocessing] for episode 50102 [episode count 13/20], we have num_retrieval=np.int64(2790) num_query=np.int64(156)
2025-03-13 17:22:50,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:50,544 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:50
2025-03-13 17:22:50,544 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.82it/s]
2025-03-13 17:22:50,702 [INFO]: There are 2790 embeddings of dim 49152
2025-03-13 17:22:50,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1587 secs
2025-03-13 17:22:50,703 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:50
2025-03-13 17:22:50,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:50,703 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:22:50,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:50,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:22:50,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:50
2025-03-13 17:22:50,703 [INFO]: 575.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:50,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:22:50,704 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:50
2025-03-13 17:22:50,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:50,704 [INFO]: 	Creating the index 03/13/2025, 17:22:50
2025-03-13 17:22:50,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:50
2025-03-13 17:22:50,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:22:50,706 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:50
2025-03-13 17:22:50,706 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:22:50,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.12it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.09it/s]100%|██████████| 11/11 [00:02<00:00,  4.81it/s]
2025-03-13 17:22:53,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:53
2025-03-13 17:23:33,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7743 secs
2025-03-13 17:23:33,776 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 17:23:33,776 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.09it/s]
2025-03-13 17:24:03,410 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6336 secs
2025-03-13 17:24:03,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7062 secs
2025-03-13 17:24:03,412 [INFO]: {
2025-03-13 17:24:03,412 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:03,412 [INFO]: 	index_param: efSearch=130
2025-03-13 17:24:03,412 [INFO]: 	index_path: knn.index
2025-03-13 17:24:03,412 [INFO]: 	size in bytes: 548915110
2025-03-13 17:24:03,412 [INFO]: 	avg_search_speed_ms: 7.120865798804728
2025-03-13 17:24:03,412 [INFO]: 	99p_search_speed_ms: 10.842268513515592
2025-03-13 17:24:03,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:03,413 [INFO]: 	nb vectors: 2790
2025-03-13 17:24:03,413 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:03,413 [INFO]: 	compression ratio: 0.9993099297266567
2025-03-13 17:24:03,413 [INFO]: }
2025-03-13 17:24:03,413 [INFO]: 	>>> Finished "Creating the index" in 72.7088 secs
2025-03-13 17:24:03,413 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8688 secs
2025-03-13 17:24:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 50102 [episode count 13/20]
[retrieval_preprocessing] for episode 29624 [episode count 14/20], we have num_retrieval=np.int64(2816) num_query=np.int64(130)
2025-03-13 17:24:04,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:05,151 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:05
2025-03-13 17:24:05,151 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.00it/s]
2025-03-13 17:24:05,181 [INFO]: There are 2816 embeddings of dim 49152
2025-03-13 17:24:05,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:24:05,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:05
2025-03-13 17:24:05,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:05,183 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:24:05,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:05,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:24:05,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:05
2025-03-13 17:24:05,184 [INFO]: 581.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:05,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:24:05,184 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:05
2025-03-13 17:24:05,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:05,184 [INFO]: 	Creating the index 03/13/2025, 17:24:05
2025-03-13 17:24:05,185 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:05
2025-03-13 17:24:05,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:24:05,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:05
2025-03-13 17:24:05,188 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:24:05,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.10it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.84it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]100%|██████████| 12/12 [00:02<00:00,  5.35it/s]
2025-03-13 17:24:07,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:07
2025-03-13 17:24:42,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2918 secs
2025-03-13 17:24:42,730 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 17:24:42,730 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-13 17:25:12,551 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8204 secs
2025-03-13 17:25:13,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1105 secs
2025-03-13 17:25:13,299 [INFO]: {
2025-03-13 17:25:13,299 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:13,299 [INFO]: 	index_param: efSearch=261
2025-03-13 17:25:13,299 [INFO]: 	index_path: knn.index
2025-03-13 17:25:13,299 [INFO]: 	size in bytes: 554030530
2025-03-13 17:25:13,299 [INFO]: 	avg_search_speed_ms: 12.323264154752376
2025-03-13 17:25:13,299 [INFO]: 	99p_search_speed_ms: 18.38041228009388
2025-03-13 17:25:13,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:13,299 [INFO]: 	nb vectors: 2816
2025-03-13 17:25:13,299 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:13,299 [INFO]: 	compression ratio: 0.9993097817190688
2025-03-13 17:25:13,299 [INFO]: }
2025-03-13 17:25:13,299 [INFO]: 	>>> Finished "Creating the index" in 68.1150 secs
2025-03-13 17:25:13,300 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1486 secs
2025-03-13 17:25:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 29624 [episode count 14/20]
[retrieval_preprocessing] for episode 66588 [episode count 15/20], we have num_retrieval=np.int64(2833) num_query=np.int64(113)
2025-03-13 17:25:14,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:15,378 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:15
2025-03-13 17:25:15,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1684.46it/s]
2025-03-13 17:25:15,408 [INFO]: There are 2833 embeddings of dim 49152
2025-03-13 17:25:15,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:25:15,408 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:15,408 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:25:15,408 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:15,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:15,408 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,408 [INFO]: 584.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:15,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:15,409 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:15
2025-03-13 17:25:15,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:15,409 [INFO]: 	Creating the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,409 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:15
2025-03-13 17:25:15,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:25:15,410 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,410 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:25:15,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.67it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.21it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.06it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]
2025-03-13 17:25:18,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:18
2025-03-13 17:25:50,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8267 secs
2025-03-13 17:25:50,965 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 17:25:50,965 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.04it/s]
2025-03-13 17:26:09,245 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2792 secs
2025-03-13 17:26:09,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8387 secs
2025-03-13 17:26:09,249 [INFO]: {
2025-03-13 17:26:09,249 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:09,249 [INFO]: 	index_param: efSearch=221
2025-03-13 17:26:09,249 [INFO]: 	index_path: knn.index
2025-03-13 17:26:09,249 [INFO]: 	size in bytes: 557375290
2025-03-13 17:26:09,249 [INFO]: 	avg_search_speed_ms: 12.448140354572207
2025-03-13 17:26:09,249 [INFO]: 	99p_search_speed_ms: 18.858138781506582
2025-03-13 17:26:09,249 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:09,249 [INFO]: 	nb vectors: 2833
2025-03-13 17:26:09,249 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:09,249 [INFO]: 	compression ratio: 0.9993095747032489
2025-03-13 17:26:09,249 [INFO]: }
2025-03-13 17:26:09,249 [INFO]: 	>>> Finished "Creating the index" in 53.8404 secs
2025-03-13 17:26:09,249 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8709 secs
2025-03-13 17:26:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 66588 [episode count 15/20]
[retrieval_preprocessing] for episode 31523 [episode count 16/20], we have num_retrieval=np.int64(2847) num_query=np.int64(99)
2025-03-13 17:26:10,928 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:11,591 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:11
2025-03-13 17:26:11,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 741.70it/s]
2025-03-13 17:26:11,623 [INFO]: There are 2847 embeddings of dim 49152
2025-03-13 17:26:11,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 17:26:11,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:11,624 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:26:11,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:11,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:26:11,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,625 [INFO]: 587.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:11,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:26:11,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:11
2025-03-13 17:26:11,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:11,626 [INFO]: 	Creating the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:11
2025-03-13 17:26:11,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:26:11,628 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:11
2025-03-13 17:26:11,629 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:26:11,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.43it/s] 33%|███▎      | 4/12 [00:00<00:00, 16.96it/s] 67%|██████▋   | 8/12 [00:00<00:00, 25.59it/s]100%|██████████| 12/12 [00:02<00:00,  3.08it/s]100%|██████████| 12/12 [00:02<00:00,  4.02it/s]
2025-03-13 17:26:14,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:14
2025-03-13 17:26:56,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8645 secs
2025-03-13 17:26:56,482 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 17:26:56,482 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.14it/s]
2025-03-13 17:27:26,928 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4454 secs
2025-03-13 17:27:26,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3018 secs
2025-03-13 17:27:26,930 [INFO]: {
2025-03-13 17:27:26,930 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:26,930 [INFO]: 	index_param: efSearch=219
2025-03-13 17:27:26,930 [INFO]: 	index_path: knn.index
2025-03-13 17:27:26,930 [INFO]: 	size in bytes: 560129650
2025-03-13 17:27:26,930 [INFO]: 	avg_search_speed_ms: 10.297675472689
2025-03-13 17:27:26,931 [INFO]: 	99p_search_speed_ms: 14.45752375293523
2025-03-13 17:27:26,931 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:26,931 [INFO]: 	nb vectors: 2847
2025-03-13 17:27:26,931 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:26,931 [INFO]: 	compression ratio: 0.9993096705378836
2025-03-13 17:27:26,931 [INFO]: }
2025-03-13 17:27:26,931 [INFO]: 	>>> Finished "Creating the index" in 75.3050 secs
2025-03-13 17:27:26,931 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3391 secs
2025-03-13 17:27:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 31523 [episode count 16/20]
[retrieval_preprocessing] for episode 19127 [episode count 17/20], we have num_retrieval=np.int64(2802) num_query=np.int64(144)
2025-03-13 17:27:27,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:28,407 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:28
2025-03-13 17:27:28,407 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.01it/s]
2025-03-13 17:27:28,441 [INFO]: There are 2802 embeddings of dim 49152
2025-03-13 17:27:28,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 17:27:28,441 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,442 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:28,442 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:27:28,442 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:28,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:27:28,442 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,442 [INFO]: 578.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:28,443 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:27:28,443 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:28
2025-03-13 17:27:28,443 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:28,443 [INFO]: 	Creating the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,443 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:28
2025-03-13 17:27:28,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:27:28,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,447 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:27:28,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.16it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.61it/s]100%|██████████| 12/12 [00:02<00:00,  3.60it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]
2025-03-13 17:27:31,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:31
2025-03-13 17:28:05,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1367 secs
2025-03-13 17:28:05,319 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:28:05,319 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 17:28:28,198 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8794 secs
2025-03-13 17:28:28,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7538 secs
2025-03-13 17:28:28,201 [INFO]: {
2025-03-13 17:28:28,201 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:28,201 [INFO]: 	index_param: efSearch=228
2025-03-13 17:28:28,201 [INFO]: 	index_path: knn.index
2025-03-13 17:28:28,201 [INFO]: 	size in bytes: 551276170
2025-03-13 17:28:28,201 [INFO]: 	avg_search_speed_ms: 8.524745909968757
2025-03-13 17:28:28,201 [INFO]: 	99p_search_speed_ms: 11.175640625879169
2025-03-13 17:28:28,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:28,201 [INFO]: 	nb vectors: 2802
2025-03-13 17:28:28,201 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:28,201 [INFO]: 	compression ratio: 0.9993096853796528
2025-03-13 17:28:28,201 [INFO]: }
2025-03-13 17:28:28,201 [INFO]: 	>>> Finished "Creating the index" in 59.7575 secs
2025-03-13 17:28:28,201 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7938 secs
2025-03-13 17:28:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 19127 [episode count 17/20]
[retrieval_preprocessing] for episode 53707 [episode count 18/20], we have num_retrieval=np.int64(2738) num_query=np.int64(208)
2025-03-13 17:28:29,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:29,971 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:29
2025-03-13 17:28:29,971 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.01it/s]
2025-03-13 17:28:29,998 [INFO]: There are 2738 embeddings of dim 49152
2025-03-13 17:28:29,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:28:29,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:29
2025-03-13 17:28:29,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:29,998 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:28:29,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:29,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:29,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:29
2025-03-13 17:28:29,999 [INFO]: 565.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:29,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:28:29,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:29
2025-03-13 17:28:29,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:29,999 [INFO]: 	Creating the index 03/13/2025, 17:28:29
2025-03-13 17:28:29,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:29
2025-03-13 17:28:30,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:28:30,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:30
2025-03-13 17:28:30,000 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:28:30,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.79it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.25it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]100%|██████████| 11/11 [00:02<00:00,  5.44it/s]
2025-03-13 17:28:32,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:32
2025-03-13 17:29:00,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9491 secs
2025-03-13 17:29:00,975 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 17:29:00,975 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.05it/s]
2025-03-13 17:29:28,553 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5784 secs
2025-03-13 17:29:28,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5553 secs
2025-03-13 17:29:28,556 [INFO]: {
2025-03-13 17:29:28,556 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:28,556 [INFO]: 	index_param: efSearch=259
2025-03-13 17:29:28,556 [INFO]: 	index_path: knn.index
2025-03-13 17:29:28,556 [INFO]: 	size in bytes: 538684450
2025-03-13 17:29:28,556 [INFO]: 	avg_search_speed_ms: 10.983001432840586
2025-03-13 17:29:28,556 [INFO]: 	99p_search_speed_ms: 14.497487130574882
2025-03-13 17:29:28,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:28,556 [INFO]: 	nb vectors: 2738
2025-03-13 17:29:28,556 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:28,556 [INFO]: 	compression ratio: 0.999309900257934
2025-03-13 17:29:28,556 [INFO]: }
2025-03-13 17:29:28,556 [INFO]: 	>>> Finished "Creating the index" in 58.5569 secs
2025-03-13 17:29:28,556 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5851 secs
2025-03-13 17:29:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 53707 [episode count 18/20]
[retrieval_preprocessing] for episode 9138 [episode count 19/20], we have num_retrieval=np.int64(2832) num_query=np.int64(114)
2025-03-13 17:29:34,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:35,234 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:35
2025-03-13 17:29:35,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1325.63it/s]
2025-03-13 17:29:35,264 [INFO]: There are 2832 embeddings of dim 49152
2025-03-13 17:29:35,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:29:35,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:35
2025-03-13 17:29:35,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:35,264 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:29:35,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:35,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:35,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:35
2025-03-13 17:29:35,264 [INFO]: 584.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:35,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:35,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:35
2025-03-13 17:29:35,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:35,264 [INFO]: 	Creating the index 03/13/2025, 17:29:35
2025-03-13 17:29:35,265 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:35
2025-03-13 17:29:35,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:29:35,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:35
2025-03-13 17:29:35,266 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:29:35,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.16it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.31it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.22it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.55it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.84it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.93it/s]100%|██████████| 12/12 [00:03<00:00,  3.52it/s]
2025-03-13 17:29:38,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:38
2025-03-13 17:30:18,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4222 secs
2025-03-13 17:30:18,107 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:30:18,107 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 17:30:46,119 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0119 secs
2025-03-13 17:30:46,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8564 secs
2025-03-13 17:30:46,122 [INFO]: {
2025-03-13 17:30:46,122 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:46,122 [INFO]: 	index_param: efSearch=218
2025-03-13 17:30:46,122 [INFO]: 	index_path: knn.index
2025-03-13 17:30:46,122 [INFO]: 	size in bytes: 557178430
2025-03-13 17:30:46,122 [INFO]: 	avg_search_speed_ms: 9.988961313347836
2025-03-13 17:30:46,122 [INFO]: 	99p_search_speed_ms: 20.35378012806177
2025-03-13 17:30:46,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:46,122 [INFO]: 	nb vectors: 2832
2025-03-13 17:30:46,122 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:46,122 [INFO]: 	compression ratio: 0.9993097830438268
2025-03-13 17:30:46,122 [INFO]: }
2025-03-13 17:30:46,122 [INFO]: 	>>> Finished "Creating the index" in 70.8580 secs
2025-03-13 17:30:46,123 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8883 secs
2025-03-13 17:30:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 9138 [episode count 19/20]
2025-03-13 17:30:47: [retrieval_preprocessing] finished for 8626796008_toaster_lever_up [chosen_id count 6/196]
2025-03-13 17:30:50: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8626796008_turn_off_toaster [chosen_id count 7/196]
2025-03-13 17:30:50: [retrieval_preprocessing] we have num_total=3367 embedding_dim=49152
[retrieval_preprocessing] for episode 93 [episode count 0/20], we have num_retrieval=np.int64(3167) num_query=np.int64(200)
2025-03-13 17:30:51,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:52,458 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:52
2025-03-13 17:30:52,458 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.05it/s]
2025-03-13 17:30:52,483 [INFO]: There are 3167 embeddings of dim 49152
2025-03-13 17:30:52,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 17:30:52,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:52
2025-03-13 17:30:52,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:52,484 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:30:52,484 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:52,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:52,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:52
2025-03-13 17:30:52,484 [INFO]: 653.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:52,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:30:52,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:52
2025-03-13 17:30:52,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:52,484 [INFO]: 	Creating the index 03/13/2025, 17:30:52
2025-03-13 17:30:52,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:52
2025-03-13 17:30:52,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:30:52,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:52
2025-03-13 17:30:52,485 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:30:52,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.79it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.08it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.57it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.80it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.72it/s] 77%|███████▋  | 10/13 [00:00<00:00, 11.19it/s] 92%|█████████▏| 12/13 [00:01<00:00, 10.29it/s]100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
2025-03-13 17:30:56,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:56
2025-03-13 17:31:30,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7743 secs
2025-03-13 17:31:30,957 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:31:30,957 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 17:31:57,107 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1499 secs
2025-03-13 17:31:57,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6241 secs
2025-03-13 17:31:57,110 [INFO]: {
2025-03-13 17:31:57,110 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:57,110 [INFO]: 	index_param: efSearch=157
2025-03-13 17:31:57,110 [INFO]: 	index_path: knn.index
2025-03-13 17:31:57,110 [INFO]: 	size in bytes: 623087650
2025-03-13 17:31:57,110 [INFO]: 	avg_search_speed_ms: 8.104039647245125
2025-03-13 17:31:57,110 [INFO]: 	99p_search_speed_ms: 17.171482157427825
2025-03-13 17:31:57,110 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:57,110 [INFO]: 	nb vectors: 3167
2025-03-13 17:31:57,110 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:57,110 [INFO]: 	compression ratio: 0.9993097054643917
2025-03-13 17:31:57,110 [INFO]: }
2025-03-13 17:31:57,110 [INFO]: 	>>> Finished "Creating the index" in 64.6258 secs
2025-03-13 17:31:57,110 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6518 secs
2025-03-13 17:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 93 [episode count 0/20]
[retrieval_preprocessing] for episode 63581 [episode count 1/20], we have num_retrieval=np.int64(3197) num_query=np.int64(170)
2025-03-13 17:32:00,229 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:01,460 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:01
2025-03-13 17:32:01,460 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.33it/s]
2025-03-13 17:32:01,491 [INFO]: There are 3197 embeddings of dim 49152
2025-03-13 17:32:01,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 17:32:01,492 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:01
2025-03-13 17:32:01,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:01,492 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:32:01,492 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:01,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:32:01,492 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:01
2025-03-13 17:32:01,493 [INFO]: 659.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:01,493 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:32:01,493 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:01
2025-03-13 17:32:01,493 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:01,493 [INFO]: 	Creating the index 03/13/2025, 17:32:01
2025-03-13 17:32:01,493 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:01
2025-03-13 17:32:01,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:32:01,497 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:01
2025-03-13 17:32:01,497 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:32:01,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.20it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.59it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.07it/s] 31%|███       | 4/13 [00:00<00:01,  7.41it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.66it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.78it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.00it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.03it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.00it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.01it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.05it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.11it/s]100%|██████████| 13/13 [00:03<00:00,  1.34it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-13 17:32:05,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:05
2025-03-13 17:32:37,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7409 secs
2025-03-13 17:32:37,972 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 17:32:37,972 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 17:33:00,639 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6666 secs
2025-03-13 17:33:00,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1450 secs
2025-03-13 17:33:00,642 [INFO]: {
2025-03-13 17:33:00,642 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:00,642 [INFO]: 	index_param: efSearch=253
2025-03-13 17:33:00,642 [INFO]: 	index_path: knn.index
2025-03-13 17:33:00,642 [INFO]: 	size in bytes: 628989910
2025-03-13 17:33:00,642 [INFO]: 	avg_search_speed_ms: 9.823965818771255
2025-03-13 17:33:00,642 [INFO]: 	99p_search_speed_ms: 17.807431141845885
2025-03-13 17:33:00,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:00,642 [INFO]: 	nb vectors: 3197
2025-03-13 17:33:00,642 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:00,642 [INFO]: 	compression ratio: 0.9993097917898238
2025-03-13 17:33:00,642 [INFO]: }
2025-03-13 17:33:00,642 [INFO]: 	>>> Finished "Creating the index" in 59.1488 secs
2025-03-13 17:33:00,642 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1821 secs
2025-03-13 17:33:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 63581 [episode count 1/20]
[retrieval_preprocessing] for episode 117 [episode count 2/20], we have num_retrieval=np.int64(3263) num_query=np.int64(104)
2025-03-13 17:33:03,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:04,005 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:04
2025-03-13 17:33:04,005 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 17:33:04,032 [INFO]: There are 3263 embeddings of dim 49152
2025-03-13 17:33:04,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:33:04,033 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:04
2025-03-13 17:33:04,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:04,033 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:33:04,033 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:04,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:33:04,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:04
2025-03-13 17:33:04,034 [INFO]: 673.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:04,034 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:33:04,034 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:04
2025-03-13 17:33:04,034 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:04,034 [INFO]: 	Creating the index 03/13/2025, 17:33:04
2025-03-13 17:33:04,034 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:04
2025-03-13 17:33:04,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:33:04,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:04
2025-03-13 17:33:04,038 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:33:04,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.43it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.51it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.46it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.01it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.18it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.04it/s]100%|██████████| 13/13 [00:03<00:00,  2.35it/s]100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
2025-03-13 17:33:07,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:07
2025-03-13 17:33:40,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2010 secs
2025-03-13 17:33:40,506 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 17:33:40,506 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 17:34:13,308 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8016 secs
2025-03-13 17:34:13,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2732 secs
2025-03-13 17:34:13,311 [INFO]: {
2025-03-13 17:34:13,312 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:13,312 [INFO]: 	index_param: efSearch=265
2025-03-13 17:34:13,312 [INFO]: 	index_path: knn.index
2025-03-13 17:34:13,312 [INFO]: 	size in bytes: 641975470
2025-03-13 17:34:13,312 [INFO]: 	avg_search_speed_ms: 9.896857156602684
2025-03-13 17:34:13,312 [INFO]: 	99p_search_speed_ms: 15.602826420217752
2025-03-13 17:34:13,312 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:13,312 [INFO]: 	nb vectors: 3263
2025-03-13 17:34:13,312 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:13,312 [INFO]: 	compression ratio: 0.999309060827511
2025-03-13 17:34:13,312 [INFO]: }
2025-03-13 17:34:13,312 [INFO]: 	>>> Finished "Creating the index" in 69.2775 secs
2025-03-13 17:34:13,312 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3070 secs
2025-03-13 17:34:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 117 [episode count 2/20]
[retrieval_preprocessing] for episode 43135 [episode count 3/20], we have num_retrieval=np.int64(3241) num_query=np.int64(126)
2025-03-13 17:34:17,767 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:18,246 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:18
2025-03-13 17:34:18,247 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.51it/s]
2025-03-13 17:34:18,273 [INFO]: There are 3241 embeddings of dim 49152
2025-03-13 17:34:18,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:34:18,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:18
2025-03-13 17:34:18,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:18,274 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:34:18,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:18,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:18,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:18
2025-03-13 17:34:18,274 [INFO]: 668.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:18,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:34:18,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:18
2025-03-13 17:34:18,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:18,274 [INFO]: 	Creating the index 03/13/2025, 17:34:18
2025-03-13 17:34:18,274 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:18
2025-03-13 17:34:18,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:34:18,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:18
2025-03-13 17:34:18,275 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:34:18,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.88it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.64it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.73it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.19it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.47it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.54it/s]100%|██████████| 13/13 [00:03<00:00,  2.29it/s]100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
2025-03-13 17:34:21,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:21
2025-03-13 17:34:56,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0278 secs
2025-03-13 17:34:56,590 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:34:56,590 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.77it/s]
2025-03-13 17:35:19,569 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9790 secs
2025-03-13 17:35:19,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2963 secs
2025-03-13 17:35:19,572 [INFO]: {
2025-03-13 17:35:19,572 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:19,572 [INFO]: 	index_param: efSearch=207
2025-03-13 17:35:19,572 [INFO]: 	index_path: knn.index
2025-03-13 17:35:19,572 [INFO]: 	size in bytes: 637647010
2025-03-13 17:35:19,572 [INFO]: 	avg_search_speed_ms: 10.369847661958566
2025-03-13 17:35:19,572 [INFO]: 	99p_search_speed_ms: 18.745866019744426
2025-03-13 17:35:19,572 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:19,572 [INFO]: 	nb vectors: 3241
2025-03-13 17:35:19,572 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:19,572 [INFO]: 	compression ratio: 0.9993092071426791
2025-03-13 17:35:19,572 [INFO]: }
2025-03-13 17:35:19,572 [INFO]: 	>>> Finished "Creating the index" in 61.2979 secs
2025-03-13 17:35:19,572 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3255 secs
2025-03-13 17:35:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 43135 [episode count 3/20]
[retrieval_preprocessing] for episode 57522 [episode count 4/20], we have num_retrieval=np.int64(3103) num_query=np.int64(264)
2025-03-13 17:35:21,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:23,243 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:23
2025-03-13 17:35:23,244 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.56it/s]
2025-03-13 17:35:23,274 [INFO]: There are 3103 embeddings of dim 49152
2025-03-13 17:35:23,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:35:23,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:23,275 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:35:23,275 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:23,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:35:23,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,275 [INFO]: 640.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:23,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:35:23,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:23
2025-03-13 17:35:23,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:23,276 [INFO]: 	Creating the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:23
2025-03-13 17:35:23,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:35:23,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,277 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:35:23,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.49it/s] 23%|██▎       | 3/13 [00:00<00:00, 13.77it/s] 38%|███▊      | 5/13 [00:00<00:00, 16.11it/s] 62%|██████▏   | 8/13 [00:00<00:00, 18.29it/s] 77%|███████▋  | 10/13 [00:00<00:00, 18.47it/s] 92%|█████████▏| 12/13 [00:00<00:00, 17.97it/s]100%|██████████| 13/13 [00:02<00:00,  4.46it/s]
2025-03-13 17:35:26,196 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:26
2025-03-13 17:36:00,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0450 secs
2025-03-13 17:36:00,242 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 17:36:00,242 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 17:36:26,114 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8719 secs
2025-03-13 17:36:26,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8402 secs
2025-03-13 17:36:26,118 [INFO]: {
2025-03-13 17:36:26,118 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:26,118 [INFO]: 	index_param: efSearch=132
2025-03-13 17:36:26,118 [INFO]: 	index_path: knn.index
2025-03-13 17:36:26,118 [INFO]: 	size in bytes: 610496050
2025-03-13 17:36:26,118 [INFO]: 	avg_search_speed_ms: 6.358381789847118
2025-03-13 17:36:26,118 [INFO]: 	99p_search_speed_ms: 12.609207339119148
2025-03-13 17:36:26,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:26,118 [INFO]: 	nb vectors: 3103
2025-03-13 17:36:26,118 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:26,118 [INFO]: 	compression ratio: 0.9993096990553829
2025-03-13 17:36:26,118 [INFO]: }
2025-03-13 17:36:26,118 [INFO]: 	>>> Finished "Creating the index" in 62.8423 secs
2025-03-13 17:36:26,118 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8744 secs
2025-03-13 17:36:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 57522 [episode count 4/20]
[retrieval_preprocessing] for episode 84171 [episode count 5/20], we have num_retrieval=np.int64(3249) num_query=np.int64(118)
2025-03-13 17:36:28,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:30,429 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:30
2025-03-13 17:36:30,429 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1275.25it/s]
2025-03-13 17:36:30,457 [INFO]: There are 3249 embeddings of dim 49152
2025-03-13 17:36:30,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 17:36:30,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:30
2025-03-13 17:36:30,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:30,458 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:36:30,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:30,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:30,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:30
2025-03-13 17:36:30,458 [INFO]: 670.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:30,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:36:30,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:30
2025-03-13 17:36:30,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:30,458 [INFO]: 	Creating the index 03/13/2025, 17:36:30
2025-03-13 17:36:30,458 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:30
2025-03-13 17:36:30,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:36:30,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:30
2025-03-13 17:36:30,459 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:36:30,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.38it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.30it/s] 31%|███       | 4/13 [00:00<00:00,  9.24it/s] 46%|████▌     | 6/13 [00:00<00:00, 10.20it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.75it/s] 77%|███████▋  | 10/13 [00:00<00:00, 11.03it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.02it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-13 17:36:33,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:33
2025-03-13 17:37:07,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2869 secs
2025-03-13 17:37:07,986 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 17:37:07,986 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 17:37:26,259 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2732 secs
2025-03-13 17:37:26,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8027 secs
2025-03-13 17:37:26,262 [INFO]: {
2025-03-13 17:37:26,262 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:26,262 [INFO]: 	index_param: efSearch=250
2025-03-13 17:37:26,262 [INFO]: 	index_path: knn.index
2025-03-13 17:37:26,262 [INFO]: 	size in bytes: 639220990
2025-03-13 17:37:26,262 [INFO]: 	avg_search_speed_ms: 10.670361585672566
2025-03-13 17:37:26,262 [INFO]: 	99p_search_speed_ms: 16.14038839004934
2025-03-13 17:37:26,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:26,262 [INFO]: 	nb vectors: 3249
2025-03-13 17:37:26,262 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:26,262 [INFO]: 	compression ratio: 0.9993091622351137
2025-03-13 17:37:26,262 [INFO]: }
2025-03-13 17:37:26,262 [INFO]: 	>>> Finished "Creating the index" in 55.8042 secs
2025-03-13 17:37:26,262 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8330 secs
2025-03-13 17:37:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 84171 [episode count 5/20]
[retrieval_preprocessing] for episode 24797 [episode count 6/20], we have num_retrieval=np.int64(3074) num_query=np.int64(293)
2025-03-13 17:37:29,468 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:30,150 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:30
2025-03-13 17:37:30,150 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.88it/s]
2025-03-13 17:37:30,177 [INFO]: There are 3074 embeddings of dim 49152
2025-03-13 17:37:30,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:37:30,177 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:30
2025-03-13 17:37:30,177 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:30,177 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:37:30,177 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:30,177 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:37:30,177 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:30
2025-03-13 17:37:30,178 [INFO]: 634.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:30,178 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:37:30,178 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:30
2025-03-13 17:37:30,178 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:30,178 [INFO]: 	Creating the index 03/13/2025, 17:37:30
2025-03-13 17:37:30,178 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:30
2025-03-13 17:37:30,179 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:37:30,179 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:30
2025-03-13 17:37:30,179 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:37:30,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.91it/s] 23%|██▎       | 3/13 [00:00<00:02,  3.96it/s] 38%|███▊      | 5/13 [00:00<00:01,  5.81it/s] 46%|████▌     | 6/13 [00:01<00:01,  5.37it/s] 54%|█████▍    | 7/13 [00:01<00:01,  5.16it/s] 62%|██████▏   | 8/13 [00:01<00:00,  5.56it/s] 69%|██████▉   | 9/13 [00:01<00:00,  5.72it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.75it/s] 92%|█████████▏| 12/13 [00:02<00:00,  6.25it/s]100%|██████████| 13/13 [00:04<00:00,  1.37it/s]100%|██████████| 13/13 [00:04<00:00,  2.93it/s]
2025-03-13 17:37:34,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:34
2025-03-13 17:38:06,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3087 secs
2025-03-13 17:38:06,937 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:38:06,937 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s]
2025-03-13 17:38:40,892 [INFO]: 	>>> Finished "Compute fast metrics" in 33.9543 secs
2025-03-13 17:38:40,895 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7152 secs
2025-03-13 17:38:40,895 [INFO]: {
2025-03-13 17:38:40,895 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:40,895 [INFO]: 	index_param: efSearch=210
2025-03-13 17:38:40,895 [INFO]: 	index_path: knn.index
2025-03-13 17:38:40,895 [INFO]: 	size in bytes: 604790410
2025-03-13 17:38:40,895 [INFO]: 	avg_search_speed_ms: 7.876618948770236
2025-03-13 17:38:40,895 [INFO]: 	99p_search_speed_ms: 14.090276416391127
2025-03-13 17:38:40,895 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:40,895 [INFO]: 	nb vectors: 3074
2025-03-13 17:38:40,895 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:40,895 [INFO]: 	compression ratio: 0.999309813791525
2025-03-13 17:38:40,895 [INFO]: }
2025-03-13 17:38:40,895 [INFO]: 	>>> Finished "Creating the index" in 70.7171 secs
2025-03-13 17:38:40,895 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7448 secs
2025-03-13 17:38:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 24797 [episode count 6/20]
[retrieval_preprocessing] for episode 28908 [episode count 7/20], we have num_retrieval=np.int64(3247) num_query=np.int64(120)
2025-03-13 17:38:44,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:45,394 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:45
2025-03-13 17:38:45,394 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.14it/s]
2025-03-13 17:38:45,422 [INFO]: There are 3247 embeddings of dim 49152
2025-03-13 17:38:45,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:38:45,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:45
2025-03-13 17:38:45,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:45,422 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:38:45,422 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:45,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:45,422 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:45
2025-03-13 17:38:45,422 [INFO]: 670.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:45,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:38:45,422 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:45
2025-03-13 17:38:45,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:45,422 [INFO]: 	Creating the index 03/13/2025, 17:38:45
2025-03-13 17:38:45,423 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:45
2025-03-13 17:38:45,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:38:45,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:45
2025-03-13 17:38:45,424 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:38:45,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.54it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.93it/s] 31%|███       | 4/13 [00:00<00:00, 10.02it/s] 46%|████▌     | 6/13 [00:00<00:00, 10.26it/s] 62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s] 77%|███████▋  | 10/13 [00:00<00:00, 10.75it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.19it/s]100%|██████████| 13/13 [00:03<00:00,  3.60it/s]
2025-03-13 17:38:49,045 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:49
2025-03-13 17:39:23,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7443 secs
2025-03-13 17:39:23,790 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:39:23,790 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 17:39:45,170 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3792 secs
2025-03-13 17:39:45,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7489 secs
2025-03-13 17:39:45,173 [INFO]: {
2025-03-13 17:39:45,173 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:45,173 [INFO]: 	index_param: efSearch=254
2025-03-13 17:39:45,173 [INFO]: 	index_path: knn.index
2025-03-13 17:39:45,173 [INFO]: 	size in bytes: 638827510
2025-03-13 17:39:45,173 [INFO]: 	avg_search_speed_ms: 9.698996317882731
2025-03-13 17:39:45,173 [INFO]: 	99p_search_speed_ms: 13.756393617950382
2025-03-13 17:39:45,173 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:45,173 [INFO]: 	nb vectors: 3247
2025-03-13 17:39:45,173 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:45,173 [INFO]: 	compression ratio: 0.9993091499769633
2025-03-13 17:39:45,173 [INFO]: }
2025-03-13 17:39:45,173 [INFO]: 	>>> Finished "Creating the index" in 59.7507 secs
2025-03-13 17:39:45,173 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7788 secs
2025-03-13 17:39:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 28908 [episode count 7/20]
[retrieval_preprocessing] for episode 73970 [episode count 8/20], we have num_retrieval=np.int64(3265) num_query=np.int64(102)
2025-03-13 17:39:47,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:47,633 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:47
2025-03-13 17:39:47,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.10it/s]
2025-03-13 17:39:47,657 [INFO]: There are 3265 embeddings of dim 49152
2025-03-13 17:39:47,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 17:39:47,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:47
2025-03-13 17:39:47,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:47,658 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:39:47,658 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:47,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:47,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:47
2025-03-13 17:39:47,658 [INFO]: 673.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:47,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:39:47,658 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:47
2025-03-13 17:39:47,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:47,658 [INFO]: 	Creating the index 03/13/2025, 17:39:47
2025-03-13 17:39:47,658 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:47
2025-03-13 17:39:47,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:39:47,659 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:47
2025-03-13 17:39:47,659 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:39:47,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.93it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.01it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.14it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.24it/s] 69%|██████▉   | 9/13 [00:00<00:00, 13.19it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.36it/s]100%|██████████| 13/13 [00:03<00:00,  2.38it/s]100%|██████████| 13/13 [00:03<00:00,  4.14it/s]
2025-03-13 17:39:50,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:50
2025-03-13 17:40:32,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2980 secs
2025-03-13 17:40:32,110 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:40:32,110 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.04it/s]
2025-03-13 17:40:56,323 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2131 secs
2025-03-13 17:40:56,326 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6663 secs
2025-03-13 17:40:56,326 [INFO]: {
2025-03-13 17:40:56,326 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:56,326 [INFO]: 	index_param: efSearch=162
2025-03-13 17:40:56,326 [INFO]: 	index_path: knn.index
2025-03-13 17:40:56,326 [INFO]: 	size in bytes: 642369010
2025-03-13 17:40:56,326 [INFO]: 	avg_search_speed_ms: 10.11874792161341
2025-03-13 17:40:56,326 [INFO]: 	99p_search_speed_ms: 17.232781837228682
2025-03-13 17:40:56,326 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:56,326 [INFO]: 	nb vectors: 3265
2025-03-13 17:40:56,326 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:56,326 [INFO]: 	compression ratio: 0.9993089797404766
2025-03-13 17:40:56,326 [INFO]: }
2025-03-13 17:40:56,326 [INFO]: 	>>> Finished "Creating the index" in 68.6681 secs
2025-03-13 17:40:56,326 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6935 secs
2025-03-13 17:40:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 73970 [episode count 8/20]
[retrieval_preprocessing] for episode 33018 [episode count 9/20], we have num_retrieval=np.int64(3200) num_query=np.int64(167)
2025-03-13 17:40:57,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:58,083 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:58
2025-03-13 17:40:58,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.62it/s]
2025-03-13 17:40:58,110 [INFO]: There are 3200 embeddings of dim 49152
2025-03-13 17:40:58,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:40:58,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:58,110 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:40:58,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:58,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:58,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,110 [INFO]: 660.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:58,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:40:58,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:58
2025-03-13 17:40:58,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:58,110 [INFO]: 	Creating the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:58
2025-03-13 17:40:58,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:40:58,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:58
2025-03-13 17:40:58,112 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:40:58,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.59it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.25it/s]100%|██████████| 13/13 [00:02<00:00,  4.05it/s]100%|██████████| 13/13 [00:02<00:00,  4.77it/s]
2025-03-13 17:41:00,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:00
2025-03-13 17:41:49,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.5216 secs
2025-03-13 17:41:49,365 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 17:41:49,365 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 17:42:08,039 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6736 secs
2025-03-13 17:42:08,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9296 secs
2025-03-13 17:42:08,041 [INFO]: {
2025-03-13 17:42:08,041 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:08,041 [INFO]: 	index_param: efSearch=188
2025-03-13 17:42:08,042 [INFO]: 	index_path: knn.index
2025-03-13 17:42:08,042 [INFO]: 	size in bytes: 629580130
2025-03-13 17:42:08,042 [INFO]: 	avg_search_speed_ms: 8.123428155278452
2025-03-13 17:42:08,042 [INFO]: 	99p_search_speed_ms: 11.751660169102252
2025-03-13 17:42:08,042 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:08,042 [INFO]: 	nb vectors: 3200
2025-03-13 17:42:08,042 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:08,042 [INFO]: 	compression ratio: 0.999309809856928
2025-03-13 17:42:08,042 [INFO]: }
2025-03-13 17:42:08,042 [INFO]: 	>>> Finished "Creating the index" in 69.9313 secs
2025-03-13 17:42:08,042 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9588 secs
2025-03-13 17:42:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 33018 [episode count 9/20]
[retrieval_preprocessing] for episode 2299 [episode count 10/20], we have num_retrieval=np.int64(3199) num_query=np.int64(168)
2025-03-13 17:42:09,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:09,932 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:09
2025-03-13 17:42:09,932 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1299.35it/s]
2025-03-13 17:42:09,962 [INFO]: There are 3199 embeddings of dim 49152
2025-03-13 17:42:09,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 17:42:09,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:09
2025-03-13 17:42:09,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:09,963 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:42:09,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:09,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:42:09,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:09
2025-03-13 17:42:09,964 [INFO]: 660.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:09,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:42:09,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:09
2025-03-13 17:42:09,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:09,965 [INFO]: 	Creating the index 03/13/2025, 17:42:09
2025-03-13 17:42:09,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:09
2025-03-13 17:42:09,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:42:09,968 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:09
2025-03-13 17:42:09,968 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:42:09,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 25.15it/s] 62%|██████▏   | 8/13 [00:00<00:00, 38.25it/s]100%|██████████| 13/13 [00:02<00:00,  3.68it/s]100%|██████████| 13/13 [00:02<00:00,  4.64it/s]
2025-03-13 17:42:12,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:12
2025-03-13 17:42:47,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2023 secs
2025-03-13 17:42:47,980 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:42:47,980 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s]
2025-03-13 17:43:11,613 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6321 secs
2025-03-13 17:43:11,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6468 secs
2025-03-13 17:43:11,615 [INFO]: {
2025-03-13 17:43:11,615 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:11,615 [INFO]: 	index_param: efSearch=270
2025-03-13 17:43:11,615 [INFO]: 	index_path: knn.index
2025-03-13 17:43:11,615 [INFO]: 	size in bytes: 629383390
2025-03-13 17:43:11,615 [INFO]: 	avg_search_speed_ms: 12.334046759625435
2025-03-13 17:43:11,615 [INFO]: 	99p_search_speed_ms: 19.229043950326737
2025-03-13 17:43:11,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:11,616 [INFO]: 	nb vectors: 3199
2025-03-13 17:43:11,616 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:11,616 [INFO]: 	compression ratio: 0.999309803838325
2025-03-13 17:43:11,616 [INFO]: }
2025-03-13 17:43:11,616 [INFO]: 	>>> Finished "Creating the index" in 61.6506 secs
2025-03-13 17:43:11,616 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6835 secs
2025-03-13 17:43:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 2299 [episode count 10/20]
[retrieval_preprocessing] for episode 31113 [episode count 11/20], we have num_retrieval=np.int64(3229) num_query=np.int64(138)
2025-03-13 17:43:16,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:16,687 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:16
2025-03-13 17:43:16,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.43it/s]
2025-03-13 17:43:16,716 [INFO]: There are 3229 embeddings of dim 49152
2025-03-13 17:43:16,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 17:43:16,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:16,716 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:43:16,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:16,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:16,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,716 [INFO]: 666.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:16,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:43:16,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:16
2025-03-13 17:43:16,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:16,717 [INFO]: 	Creating the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,717 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:16
2025-03-13 17:43:16,718 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:43:16,718 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,718 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:43:16,718 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.94it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.98it/s]100%|██████████| 13/13 [00:02<00:00,  4.39it/s]
2025-03-13 17:43:19,681 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:19
2025-03-13 17:43:52,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1076 secs
2025-03-13 17:43:52,789 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 17:43:52,789 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.68it/s]
2025-03-13 17:44:28,666 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8763 secs
2025-03-13 17:44:29,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3928 secs
2025-03-13 17:44:29,111 [INFO]: {
2025-03-13 17:44:29,111 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:29,111 [INFO]: 	index_param: efSearch=308
2025-03-13 17:44:29,111 [INFO]: 	index_path: knn.index
2025-03-13 17:44:29,111 [INFO]: 	size in bytes: 635285950
2025-03-13 17:44:29,111 [INFO]: 	avg_search_speed_ms: 10.509203658674005
2025-03-13 17:44:29,112 [INFO]: 	99p_search_speed_ms: 14.706639456562698
2025-03-13 17:44:29,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:29,112 [INFO]: 	nb vectors: 3229
2025-03-13 17:44:29,112 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:29,112 [INFO]: 	compression ratio: 0.9993094164918963
2025-03-13 17:44:29,112 [INFO]: }
2025-03-13 17:44:29,112 [INFO]: 	>>> Finished "Creating the index" in 72.3952 secs
2025-03-13 17:44:29,112 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4252 secs
2025-03-13 17:44:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 31113 [episode count 11/20]
[retrieval_preprocessing] for episode 35226 [episode count 12/20], we have num_retrieval=np.int64(3203) num_query=np.int64(164)
2025-03-13 17:44:30,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:31,497 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:31
2025-03-13 17:44:31,497 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1278.75it/s]
2025-03-13 17:44:31,525 [INFO]: There are 3203 embeddings of dim 49152
2025-03-13 17:44:31,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:44:31,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:31
2025-03-13 17:44:31,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:31,526 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:44:31,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:31,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:31,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:31
2025-03-13 17:44:31,526 [INFO]: 661.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:31,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:31,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:31
2025-03-13 17:44:31,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:31,526 [INFO]: 	Creating the index 03/13/2025, 17:44:31
2025-03-13 17:44:31,526 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:31
2025-03-13 17:44:31,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:44:31,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:31
2025-03-13 17:44:31,528 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:44:31,528 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.30it/s] 54%|█████▍    | 7/13 [00:00<00:00, 31.71it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.04it/s]100%|██████████| 13/13 [00:02<00:00,  5.08it/s]
2025-03-13 17:44:34,092 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:34
2025-03-13 17:45:11,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7460 secs
2025-03-13 17:45:11,839 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 17:45:11,839 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.57it/s]
2025-03-13 17:45:32,524 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6846 secs
2025-03-13 17:45:32,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2391 secs
2025-03-13 17:45:32,767 [INFO]: {
2025-03-13 17:45:32,767 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:32,767 [INFO]: 	index_param: efSearch=274
2025-03-13 17:45:32,767 [INFO]: 	index_path: knn.index
2025-03-13 17:45:32,767 [INFO]: 	size in bytes: 630170350
2025-03-13 17:45:32,767 [INFO]: 	avg_search_speed_ms: 11.468281453302335
2025-03-13 17:45:32,768 [INFO]: 	99p_search_speed_ms: 20.05768500035627
2025-03-13 17:45:32,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:32,768 [INFO]: 	nb vectors: 3203
2025-03-13 17:45:32,768 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:32,768 [INFO]: 	compression ratio: 0.9993098278901887
2025-03-13 17:45:32,768 [INFO]: }
2025-03-13 17:45:32,768 [INFO]: 	>>> Finished "Creating the index" in 61.2416 secs
2025-03-13 17:45:32,768 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2705 secs
2025-03-13 17:45:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 35226 [episode count 12/20]
[retrieval_preprocessing] for episode 66264 [episode count 13/20], we have num_retrieval=np.int64(2972) num_query=np.int64(395)
2025-03-13 17:45:34,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:35,328 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:35
2025-03-13 17:45:35,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-13 17:45:35,358 [INFO]: There are 2972 embeddings of dim 49152
2025-03-13 17:45:35,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:45:35,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:35
2025-03-13 17:45:35,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:35,359 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:45:35,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:35,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:45:35,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:35
2025-03-13 17:45:35,360 [INFO]: 613.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:35,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:45:35,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:35
2025-03-13 17:45:35,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:35,360 [INFO]: 	Creating the index 03/13/2025, 17:45:35
2025-03-13 17:45:35,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:35
2025-03-13 17:45:35,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:45:35,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:35
2025-03-13 17:45:35,364 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:45:35,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.01it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.79it/s]100%|██████████| 12/12 [00:02<00:00,  5.80it/s]
2025-03-13 17:45:37,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:37
2025-03-13 17:46:14,444 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0046 secs
2025-03-13 17:46:14,444 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:46:14,444 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 17:46:30,013 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5684 secs
2025-03-13 17:46:30,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6514 secs
2025-03-13 17:46:30,015 [INFO]: {
2025-03-13 17:46:30,015 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:30,015 [INFO]: 	index_param: efSearch=201
2025-03-13 17:46:30,015 [INFO]: 	index_path: knn.index
2025-03-13 17:46:30,015 [INFO]: 	size in bytes: 584722690
2025-03-13 17:46:30,015 [INFO]: 	avg_search_speed_ms: 10.227049786382278
2025-03-13 17:46:30,015 [INFO]: 	99p_search_speed_ms: 15.308100103866309
2025-03-13 17:46:30,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:30,015 [INFO]: 	nb vectors: 2972
2025-03-13 17:46:30,015 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:30,016 [INFO]: 	compression ratio: 0.9993095633076938
2025-03-13 17:46:30,016 [INFO]: }
2025-03-13 17:46:30,016 [INFO]: 	>>> Finished "Creating the index" in 54.6553 secs
2025-03-13 17:46:30,016 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6871 secs
2025-03-13 17:46:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 66264 [episode count 13/20]
[retrieval_preprocessing] for episode 37600 [episode count 14/20], we have num_retrieval=np.int64(3090) num_query=np.int64(277)
2025-03-13 17:46:33,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:34,477 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:34
2025-03-13 17:46:34,477 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-13 17:46:34,506 [INFO]: There are 3090 embeddings of dim 49152
2025-03-13 17:46:34,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:46:34,506 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:34
2025-03-13 17:46:34,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:34,506 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:46:34,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:34,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:34,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:34
2025-03-13 17:46:34,506 [INFO]: 637.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:34,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:46:34,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:34
2025-03-13 17:46:34,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:34,506 [INFO]: 	Creating the index 03/13/2025, 17:46:34
2025-03-13 17:46:34,507 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:34
2025-03-13 17:46:34,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:46:34,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:34
2025-03-13 17:46:34,508 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:46:34,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.59it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.39it/s] 69%|██████▉   | 9/13 [00:00<00:00, 29.37it/s]100%|██████████| 13/13 [00:02<00:00,  3.54it/s]100%|██████████| 13/13 [00:02<00:00,  4.73it/s]
2025-03-13 17:46:37,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:37
2025-03-13 17:47:10,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2554 secs
2025-03-13 17:47:10,514 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 17:47:10,514 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 17:47:31,646 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1320 secs
2025-03-13 17:47:31,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1407 secs
2025-03-13 17:47:31,649 [INFO]: {
2025-03-13 17:47:31,649 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:31,649 [INFO]: 	index_param: efSearch=240
2025-03-13 17:47:31,649 [INFO]: 	index_path: knn.index
2025-03-13 17:47:31,649 [INFO]: 	size in bytes: 607938310
2025-03-13 17:47:31,649 [INFO]: 	avg_search_speed_ms: 10.008532700508281
2025-03-13 17:47:31,649 [INFO]: 	99p_search_speed_ms: 16.558603309094906
2025-03-13 17:47:31,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:31,649 [INFO]: 	nb vectors: 3090
2025-03-13 17:47:31,649 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:31,649 [INFO]: 	compression ratio: 0.9993098148396011
2025-03-13 17:47:31,649 [INFO]: }
2025-03-13 17:47:31,649 [INFO]: 	>>> Finished "Creating the index" in 57.1425 secs
2025-03-13 17:47:31,649 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1719 secs
2025-03-13 17:47:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 37600 [episode count 14/20]
[retrieval_preprocessing] for episode 10999 [episode count 15/20], we have num_retrieval=np.int64(3262) num_query=np.int64(105)
2025-03-13 17:47:35,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:35,757 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:35
2025-03-13 17:47:35,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 17:47:35,797 [INFO]: There are 3262 embeddings of dim 49152
2025-03-13 17:47:35,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 17:47:35,797 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:35
2025-03-13 17:47:35,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:35,798 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:47:35,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:35,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:47:35,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:35
2025-03-13 17:47:35,799 [INFO]: 673.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:35,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:47:35,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:35
2025-03-13 17:47:35,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:35,800 [INFO]: 	Creating the index 03/13/2025, 17:47:35
2025-03-13 17:47:35,800 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:35
2025-03-13 17:47:35,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 17:47:35,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:35
2025-03-13 17:47:35,804 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:47:35,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.03it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.93it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.45it/s]100%|██████████| 13/13 [00:02<00:00,  4.42it/s]
2025-03-13 17:47:38,755 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:38
2025-03-13 17:48:08,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0912 secs
2025-03-13 17:48:08,847 [INFO]: The best hyperparameters are: efSearch=298
2025-03-13 17:48:08,847 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 17:48:39,919 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0711 secs
2025-03-13 17:48:39,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1176 secs
2025-03-13 17:48:39,922 [INFO]: {
2025-03-13 17:48:39,922 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:39,922 [INFO]: 	index_param: efSearch=298
2025-03-13 17:48:39,922 [INFO]: 	index_path: knn.index
2025-03-13 17:48:39,922 [INFO]: 	size in bytes: 641778730
2025-03-13 17:48:39,922 [INFO]: 	avg_search_speed_ms: 12.569491351643418
2025-03-13 17:48:39,922 [INFO]: 	99p_search_speed_ms: 21.78878627019003
2025-03-13 17:48:39,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:39,922 [INFO]: 	nb vectors: 3262
2025-03-13 17:48:39,922 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:39,922 [INFO]: 	compression ratio: 0.9993090546955334
2025-03-13 17:48:39,922 [INFO]: }
2025-03-13 17:48:39,922 [INFO]: 	>>> Finished "Creating the index" in 64.1221 secs
2025-03-13 17:48:39,922 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1650 secs
2025-03-13 17:48:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 10999 [episode count 15/20]
[retrieval_preprocessing] for episode 15115 [episode count 16/20], we have num_retrieval=np.int64(3260) num_query=np.int64(107)
2025-03-13 17:48:42,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:43,146 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:43
2025-03-13 17:48:43,146 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.49it/s]
2025-03-13 17:48:43,171 [INFO]: There are 3260 embeddings of dim 49152
2025-03-13 17:48:43,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:48:43,172 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:43
2025-03-13 17:48:43,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:43,172 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:48:43,172 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:43,172 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:43,172 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:43
2025-03-13 17:48:43,172 [INFO]: 672.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:43,172 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:48:43,172 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:43
2025-03-13 17:48:43,172 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:43,172 [INFO]: 	Creating the index 03/13/2025, 17:48:43
2025-03-13 17:48:43,172 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:43
2025-03-13 17:48:43,173 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:48:43,173 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:43
2025-03-13 17:48:43,173 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:48:43,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.83it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.82it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.75it/s]100%|██████████| 13/13 [00:02<00:00,  4.58it/s]
2025-03-13 17:48:46,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:46
2025-03-13 17:49:27,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4395 secs
2025-03-13 17:49:27,453 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:49:27,453 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 17:49:50,730 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2762 secs
2025-03-13 17:49:50,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5586 secs
2025-03-13 17:49:50,732 [INFO]: {
2025-03-13 17:49:50,732 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:50,732 [INFO]: 	index_param: efSearch=230
2025-03-13 17:49:50,732 [INFO]: 	index_path: knn.index
2025-03-13 17:49:50,732 [INFO]: 	size in bytes: 641385190
2025-03-13 17:49:50,732 [INFO]: 	avg_search_speed_ms: 7.772504095503338
2025-03-13 17:49:50,732 [INFO]: 	99p_search_speed_ms: 11.26418242231012
2025-03-13 17:49:50,732 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:50,732 [INFO]: 	nb vectors: 3260
2025-03-13 17:49:50,732 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:50,732 [INFO]: 	compression ratio: 0.9993091359031848
2025-03-13 17:49:50,732 [INFO]: }
2025-03-13 17:49:50,732 [INFO]: 	>>> Finished "Creating the index" in 67.5600 secs
2025-03-13 17:49:50,732 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5864 secs
2025-03-13 17:49:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 15115 [episode count 16/20]
[retrieval_preprocessing] for episode 43812 [episode count 17/20], we have num_retrieval=np.int64(3238) num_query=np.int64(129)
2025-03-13 17:49:52,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:52,598 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:52
2025-03-13 17:49:52,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1354.31it/s]
2025-03-13 17:49:52,628 [INFO]: There are 3238 embeddings of dim 49152
2025-03-13 17:49:52,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:49:52,628 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:52
2025-03-13 17:49:52,628 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:52,628 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:49:52,628 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:52,628 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:52,628 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:52
2025-03-13 17:49:52,628 [INFO]: 668.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:52,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:52,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:52
2025-03-13 17:49:52,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:52,629 [INFO]: 	Creating the index 03/13/2025, 17:49:52
2025-03-13 17:49:52,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:52
2025-03-13 17:49:52,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:49:52,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:52
2025-03-13 17:49:52,630 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:49:52,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.19it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.84it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.24it/s]100%|██████████| 13/13 [00:02<00:00,  5.55it/s]
2025-03-13 17:49:54,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:54
2025-03-13 17:50:23,159 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1819 secs
2025-03-13 17:50:23,160 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 17:50:23,160 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 17:50:47,323 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1631 secs
2025-03-13 17:50:47,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6951 secs
2025-03-13 17:50:47,325 [INFO]: {
2025-03-13 17:50:47,325 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:47,325 [INFO]: 	index_param: efSearch=262
2025-03-13 17:50:47,325 [INFO]: 	index_path: knn.index
2025-03-13 17:50:47,325 [INFO]: 	size in bytes: 637056790
2025-03-13 17:50:47,326 [INFO]: 	avg_search_speed_ms: 12.955622255037312
2025-03-13 17:50:47,326 [INFO]: 	99p_search_speed_ms: 21.074100572150193
2025-03-13 17:50:47,326 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:47,326 [INFO]: 	nb vectors: 3238
2025-03-13 17:50:47,326 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:47,326 [INFO]: 	compression ratio: 0.9993091887459515
2025-03-13 17:50:47,326 [INFO]: }
2025-03-13 17:50:47,326 [INFO]: 	>>> Finished "Creating the index" in 54.6969 secs
2025-03-13 17:50:47,326 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7271 secs
2025-03-13 17:50:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 43812 [episode count 17/20]
[retrieval_preprocessing] for episode 47673 [episode count 18/20], we have num_retrieval=np.int64(3252) num_query=np.int64(115)
2025-03-13 17:50:49,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:49,829 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:49
2025-03-13 17:50:49,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1289.76it/s]
2025-03-13 17:50:49,859 [INFO]: There are 3252 embeddings of dim 49152
2025-03-13 17:50:49,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:50:49,860 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,860 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:49,861 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:50:49,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:49,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:50:49,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,861 [INFO]: 671.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:49,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:50:49,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:49
2025-03-13 17:50:49,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:49,862 [INFO]: 	Creating the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:49
2025-03-13 17:50:49,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:50:49,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:49
2025-03-13 17:50:49,866 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:50:49,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.16it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.50it/s] 77%|███████▋  | 10/13 [00:00<00:00, 31.31it/s]100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
2025-03-13 17:50:53,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:53
2025-03-13 17:51:24,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6006 secs
2025-03-13 17:51:24,669 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:51:24,669 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.20it/s]
2025-03-13 17:51:46,007 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3378 secs
2025-03-13 17:51:46,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1430 secs
2025-03-13 17:51:46,009 [INFO]: {
2025-03-13 17:51:46,009 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:46,009 [INFO]: 	index_param: efSearch=228
2025-03-13 17:51:46,009 [INFO]: 	index_path: knn.index
2025-03-13 17:51:46,009 [INFO]: 	size in bytes: 639811210
2025-03-13 17:51:46,009 [INFO]: 	avg_search_speed_ms: 9.656216459291265
2025-03-13 17:51:46,009 [INFO]: 	99p_search_speed_ms: 17.092496994882826
2025-03-13 17:51:46,009 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:46,009 [INFO]: 	nb vectors: 3252
2025-03-13 17:51:46,009 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:46,009 [INFO]: 	compression ratio: 0.9993091805940693
2025-03-13 17:51:46,009 [INFO]: }
2025-03-13 17:51:46,009 [INFO]: 	>>> Finished "Creating the index" in 56.1472 secs
2025-03-13 17:51:46,009 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1803 secs
2025-03-13 17:51:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 47673 [episode count 18/20]
[retrieval_preprocessing] for episode 14912 [episode count 19/20], we have num_retrieval=np.int64(3262) num_query=np.int64(105)
2025-03-13 17:51:47,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:48,305 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:48
2025-03-13 17:51:48,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2148.72it/s]
2025-03-13 17:51:48,332 [INFO]: There are 3262 embeddings of dim 49152
2025-03-13 17:51:48,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:51:48,332 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:48
2025-03-13 17:51:48,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:48,332 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:51:48,332 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:48,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:48,332 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:48
2025-03-13 17:51:48,332 [INFO]: 673.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:48,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:51:48,333 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:48
2025-03-13 17:51:48,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:48,333 [INFO]: 	Creating the index 03/13/2025, 17:51:48
2025-03-13 17:51:48,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:48
2025-03-13 17:51:48,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:51:48,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:48
2025-03-13 17:51:48,334 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:51:48,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.59it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.58it/s] 92%|█████████▏| 12/13 [00:00<00:00, 40.25it/s]100%|██████████| 13/13 [00:02<00:00,  5.57it/s]
2025-03-13 17:51:50,672 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:50
2025-03-13 17:52:27,606 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9334 secs
2025-03-13 17:52:27,607 [INFO]: The best hyperparameters are: efSearch=119
2025-03-13 17:52:27,607 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-13 17:52:47,950 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3434 secs
2025-03-13 17:52:47,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6184 secs
2025-03-13 17:52:47,953 [INFO]: {
2025-03-13 17:52:47,953 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:47,953 [INFO]: 	index_param: efSearch=119
2025-03-13 17:52:47,953 [INFO]: 	index_path: knn.index
2025-03-13 17:52:47,953 [INFO]: 	size in bytes: 641778730
2025-03-13 17:52:47,953 [INFO]: 	avg_search_speed_ms: 6.4199068810845805
2025-03-13 17:52:47,953 [INFO]: 	99p_search_speed_ms: 10.763517133891584
2025-03-13 17:52:47,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:47,953 [INFO]: 	nb vectors: 3262
2025-03-13 17:52:47,953 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:47,953 [INFO]: 	compression ratio: 0.9993090546955334
2025-03-13 17:52:47,953 [INFO]: }
2025-03-13 17:52:47,953 [INFO]: 	>>> Finished "Creating the index" in 59.6201 secs
2025-03-13 17:52:47,953 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6478 secs
2025-03-13 17:52:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 14912 [episode count 19/20]
2025-03-13 17:52:48: [retrieval_preprocessing] finished for 8626796008_turn_off_toaster [chosen_id count 7/196]
2025-03-13 17:52:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8626796008_press_button_on_toaster [chosen_id count 8/196]
2025-03-13 17:52:51: [retrieval_preprocessing] we have num_total=3195 embedding_dim=49152
[retrieval_preprocessing] for episode 4184 [episode count 0/20], we have num_retrieval=np.int64(3044) num_query=np.int64(151)
2025-03-13 17:52:52,803 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:53,490 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:53
2025-03-13 17:52:53,490 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.94it/s]
2025-03-13 17:52:53,533 [INFO]: There are 3044 embeddings of dim 49152
2025-03-13 17:52:53,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0433 secs
2025-03-13 17:52:53,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:53
2025-03-13 17:52:53,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:53,534 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:52:53,534 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:53,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:52:53,535 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:53
2025-03-13 17:52:53,536 [INFO]: 628.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:53,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:52:53,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:53
2025-03-13 17:52:53,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:53,536 [INFO]: 	Creating the index 03/13/2025, 17:52:53
2025-03-13 17:52:53,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:53
2025-03-13 17:52:53,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:52:53,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:53
2025-03-13 17:52:53,538 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:52:53,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.25it/s] 25%|██▌       | 3/12 [00:00<00:00, 12.65it/s] 50%|█████     | 6/12 [00:00<00:00, 16.99it/s] 75%|███████▌  | 9/12 [00:00<00:00, 19.95it/s]100%|██████████| 12/12 [00:03<00:00,  2.38it/s]100%|██████████| 12/12 [00:03<00:00,  3.49it/s]
2025-03-13 17:52:56,983 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:56
2025-03-13 17:53:30,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8091 secs
2025-03-13 17:53:30,793 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:53:30,793 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 17:53:53,778 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9854 secs
2025-03-13 17:53:53,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2424 secs
2025-03-13 17:53:53,780 [INFO]: {
2025-03-13 17:53:53,780 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:53,780 [INFO]: 	index_param: efSearch=270
2025-03-13 17:53:53,780 [INFO]: 	index_path: knn.index
2025-03-13 17:53:53,780 [INFO]: 	size in bytes: 598888030
2025-03-13 17:53:53,780 [INFO]: 	avg_search_speed_ms: 9.887020508786332
2025-03-13 17:53:53,780 [INFO]: 	99p_search_speed_ms: 15.618006365839388
2025-03-13 17:53:53,780 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:53,780 [INFO]: 	nb vectors: 3044
2025-03-13 17:53:53,780 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:53,780 [INFO]: 	compression ratio: 0.9993099244277766
2025-03-13 17:53:53,780 [INFO]: }
2025-03-13 17:53:53,780 [INFO]: 	>>> Finished "Creating the index" in 60.2442 secs
2025-03-13 17:53:53,780 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2901 secs
2025-03-13 17:53:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 4184 [episode count 0/20]
[retrieval_preprocessing] for episode 30840 [episode count 1/20], we have num_retrieval=np.int64(2978) num_query=np.int64(217)
2025-03-13 17:53:55,418 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:55,823 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:55
2025-03-13 17:53:55,823 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.96it/s]
2025-03-13 17:53:55,853 [INFO]: There are 2978 embeddings of dim 49152
2025-03-13 17:53:55,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:53:55,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:55
2025-03-13 17:53:55,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:55,854 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:53:55,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:55,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:53:55,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:55
2025-03-13 17:53:55,855 [INFO]: 614.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:55,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:53:55,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:55
2025-03-13 17:53:55,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:55,856 [INFO]: 	Creating the index 03/13/2025, 17:53:55
2025-03-13 17:53:55,856 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:55
2025-03-13 17:53:55,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:53:55,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:55
2025-03-13 17:53:55,860 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:55,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.33it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.23it/s]100%|██████████| 12/12 [00:02<00:00,  4.81it/s]100%|██████████| 12/12 [00:02<00:00,  5.83it/s]
2025-03-13 17:53:57,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:57
2025-03-13 17:54:34,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9136 secs
2025-03-13 17:54:34,839 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 17:54:34,839 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.45it/s]
2025-03-13 17:55:09,805 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9661 secs
2025-03-13 17:55:09,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9474 secs
2025-03-13 17:55:09,807 [INFO]: {
2025-03-13 17:55:09,807 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:09,807 [INFO]: 	index_param: efSearch=279
2025-03-13 17:55:09,807 [INFO]: 	index_path: knn.index
2025-03-13 17:55:09,807 [INFO]: 	size in bytes: 585903130
2025-03-13 17:55:09,807 [INFO]: 	avg_search_speed_ms: 10.407421717315556
2025-03-13 17:55:09,807 [INFO]: 	99p_search_speed_ms: 17.087352927774187
2025-03-13 17:55:09,807 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:09,807 [INFO]: 	nb vectors: 2978
2025-03-13 17:55:09,807 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:09,807 [INFO]: 	compression ratio: 0.9993096025959104
2025-03-13 17:55:09,807 [INFO]: }
2025-03-13 17:55:09,807 [INFO]: 	>>> Finished "Creating the index" in 73.9514 secs
2025-03-13 17:55:09,807 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9844 secs
2025-03-13 17:55:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 30840 [episode count 1/20]
[retrieval_preprocessing] for episode 88251 [episode count 2/20], we have num_retrieval=np.int64(3022) num_query=np.int64(173)
2025-03-13 17:55:12,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:13,139 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:13
2025-03-13 17:55:13,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1797.82it/s]
2025-03-13 17:55:13,170 [INFO]: There are 3022 embeddings of dim 49152
2025-03-13 17:55:13,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 17:55:13,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,170 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:13,170 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:55:13,170 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:13,170 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:13,170 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,171 [INFO]: 623.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:13,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:55:13,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:13
2025-03-13 17:55:13,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:13,171 [INFO]: 	Creating the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:13
2025-03-13 17:55:13,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:55:13,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,172 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:55:13,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.76it/s] 50%|█████     | 6/12 [00:00<00:00, 27.67it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.14it/s]100%|██████████| 12/12 [00:02<00:00,  5.01it/s]
2025-03-13 17:55:15,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:15
2025-03-13 17:55:49,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2472 secs
2025-03-13 17:55:49,821 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:55:49,821 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 17:56:13,900 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0796 secs
2025-03-13 17:56:14,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1477 secs
2025-03-13 17:56:14,320 [INFO]: {
2025-03-13 17:56:14,320 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:14,320 [INFO]: 	index_param: efSearch=230
2025-03-13 17:56:14,320 [INFO]: 	index_path: knn.index
2025-03-13 17:56:14,320 [INFO]: 	size in bytes: 594559690
2025-03-13 17:56:14,320 [INFO]: 	avg_search_speed_ms: 9.167753438713707
2025-03-13 17:56:14,320 [INFO]: 	99p_search_speed_ms: 13.666296284645796
2025-03-13 17:56:14,320 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:14,320 [INFO]: 	nb vectors: 3022
2025-03-13 17:56:14,320 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:14,320 [INFO]: 	compression ratio: 0.9993098859426545
2025-03-13 17:56:14,321 [INFO]: }
2025-03-13 17:56:14,321 [INFO]: 	>>> Finished "Creating the index" in 61.1499 secs
2025-03-13 17:56:14,321 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1818 secs
2025-03-13 17:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 88251 [episode count 2/20]
[retrieval_preprocessing] for episode 184 [episode count 3/20], we have num_retrieval=np.int64(3025) num_query=np.int64(170)
2025-03-13 17:56:16,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:16,982 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:16
2025-03-13 17:56:16,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.76it/s]
2025-03-13 17:56:17,007 [INFO]: There are 3025 embeddings of dim 49152
2025-03-13 17:56:17,007 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:56:17,007 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:17
2025-03-13 17:56:17,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:17,007 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:56:17,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:17,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:56:17,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:17
2025-03-13 17:56:17,007 [INFO]: 624.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:17,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:56:17,007 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:17
2025-03-13 17:56:17,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:17,008 [INFO]: 	Creating the index 03/13/2025, 17:56:17
2025-03-13 17:56:17,008 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:17
2025-03-13 17:56:17,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:56:17,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:17
2025-03-13 17:56:17,009 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:56:17,009 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.05it/s] 33%|███▎      | 4/12 [00:00<00:00, 17.36it/s] 67%|██████▋   | 8/12 [00:00<00:00, 25.63it/s]100%|██████████| 12/12 [00:02<00:00,  3.46it/s]100%|██████████| 12/12 [00:02<00:00,  4.48it/s]
2025-03-13 17:56:19,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:19
2025-03-13 17:56:54,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2409 secs
2025-03-13 17:56:54,935 [INFO]: The best hyperparameters are: efSearch=311
2025-03-13 17:56:54,935 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 17:57:31,837 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9017 secs
2025-03-13 17:57:31,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8304 secs
2025-03-13 17:57:31,839 [INFO]: {
2025-03-13 17:57:31,839 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:31,839 [INFO]: 	index_param: efSearch=311
2025-03-13 17:57:31,839 [INFO]: 	index_path: knn.index
2025-03-13 17:57:31,839 [INFO]: 	size in bytes: 595149910
2025-03-13 17:57:31,839 [INFO]: 	avg_search_speed_ms: 11.929110177660514
2025-03-13 17:57:31,839 [INFO]: 	99p_search_speed_ms: 20.10508690495044
2025-03-13 17:57:31,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:31,839 [INFO]: 	nb vectors: 3025
2025-03-13 17:57:31,839 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:31,839 [INFO]: 	compression ratio: 0.999309904961592
2025-03-13 17:57:31,839 [INFO]: }
2025-03-13 17:57:31,839 [INFO]: 	>>> Finished "Creating the index" in 74.8317 secs
2025-03-13 17:57:31,839 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8574 secs
2025-03-13 17:57:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 184 [episode count 3/20]
[retrieval_preprocessing] for episode 86322 [episode count 4/20], we have num_retrieval=np.int64(3054) num_query=np.int64(141)
2025-03-13 17:57:33,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:33,968 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:33
2025-03-13 17:57:33,968 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-13 17:57:34,002 [INFO]: There are 3054 embeddings of dim 49152
2025-03-13 17:57:34,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 17:57:34,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:34
2025-03-13 17:57:34,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:34,003 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:57:34,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:34,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:57:34,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:34
2025-03-13 17:57:34,003 [INFO]: 630.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:34,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:34,003 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:34
2025-03-13 17:57:34,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:34,003 [INFO]: 	Creating the index 03/13/2025, 17:57:34
2025-03-13 17:57:34,003 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:34
2025-03-13 17:57:34,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:57:34,004 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:34
2025-03-13 17:57:34,004 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:57:34,004 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.66it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.27it/s] 92%|█████████▏| 12/13 [00:00<00:00, 40.33it/s]100%|██████████| 13/13 [00:02<00:00,  5.84it/s]
2025-03-13 17:57:36,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:36
2025-03-13 17:58:15,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4715 secs
2025-03-13 17:58:15,706 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 17:58:15,706 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 17:58:44,811 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1044 secs
2025-03-13 17:58:44,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8083 secs
2025-03-13 17:58:44,813 [INFO]: {
2025-03-13 17:58:44,813 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:44,813 [INFO]: 	index_param: efSearch=252
2025-03-13 17:58:44,813 [INFO]: 	index_path: knn.index
2025-03-13 17:58:44,813 [INFO]: 	size in bytes: 600855430
2025-03-13 17:58:44,813 [INFO]: 	avg_search_speed_ms: 10.395792425705
2025-03-13 17:58:44,813 [INFO]: 	99p_search_speed_ms: 18.825418581254777
2025-03-13 17:58:44,813 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:44,813 [INFO]: 	nb vectors: 3054
2025-03-13 17:58:44,813 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:44,813 [INFO]: 	compression ratio: 0.9993099870962304
2025-03-13 17:58:44,813 [INFO]: }
2025-03-13 17:58:44,813 [INFO]: 	>>> Finished "Creating the index" in 70.8098 secs
2025-03-13 17:58:44,813 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8449 secs
2025-03-13 17:58:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 86322 [episode count 4/20]
[retrieval_preprocessing] for episode 10748 [episode count 5/20], we have num_retrieval=np.int64(3068) num_query=np.int64(127)
2025-03-13 17:58:46,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:46,761 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:46
2025-03-13 17:58:46,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2057.04it/s]
2025-03-13 17:58:46,790 [INFO]: There are 3068 embeddings of dim 49152
2025-03-13 17:58:46,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 17:58:46,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:46
2025-03-13 17:58:46,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:46,790 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:58:46,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:46,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:46,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:46
2025-03-13 17:58:46,790 [INFO]: 633.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:46,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:58:46,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:46
2025-03-13 17:58:46,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:46,791 [INFO]: 	Creating the index 03/13/2025, 17:58:46
2025-03-13 17:58:46,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:46
2025-03-13 17:58:46,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:58:46,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:46
2025-03-13 17:58:46,792 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:58:46,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.16it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.13it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.67it/s]100%|██████████| 13/13 [00:02<00:00,  4.76it/s]
2025-03-13 17:58:49,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:49
2025-03-13 17:59:26,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0816 secs
2025-03-13 17:59:26,610 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:59:26,610 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-13 17:59:56,057 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4469 secs
2025-03-13 17:59:56,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2669 secs
2025-03-13 17:59:56,059 [INFO]: {
2025-03-13 17:59:56,059 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:56,059 [INFO]: 	index_param: efSearch=251
2025-03-13 17:59:56,059 [INFO]: 	index_path: knn.index
2025-03-13 17:59:56,059 [INFO]: 	size in bytes: 603609970
2025-03-13 17:59:56,059 [INFO]: 	avg_search_speed_ms: 9.415831588508594
2025-03-13 17:59:56,059 [INFO]: 	99p_search_speed_ms: 13.641142689157292
2025-03-13 17:59:56,059 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:56,059 [INFO]: 	nb vectors: 3068
2025-03-13 17:59:56,059 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:56,059 [INFO]: 	compression ratio: 0.999309776145679
2025-03-13 17:59:56,059 [INFO]: }
2025-03-13 17:59:56,059 [INFO]: 	>>> Finished "Creating the index" in 69.2686 secs
2025-03-13 17:59:56,059 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2981 secs
2025-03-13 17:59:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 10748 [episode count 5/20]
[retrieval_preprocessing] for episode 39441 [episode count 6/20], we have num_retrieval=np.int64(3043) num_query=np.int64(152)
2025-03-13 17:59:57,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:57,822 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:57
2025-03-13 17:59:57,822 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 943.60it/s]
2025-03-13 17:59:57,858 [INFO]: There are 3043 embeddings of dim 49152
2025-03-13 17:59:57,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 17:59:57,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:57,859 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 17:59:57,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:57,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:57,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,859 [INFO]: 628.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:57,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:59:57,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:57
2025-03-13 17:59:57,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:57,859 [INFO]: 	Creating the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:57
2025-03-13 17:59:57,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:59:57,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:57
2025-03-13 17:59:57,860 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:59:57,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.73it/s] 42%|████▏     | 5/12 [00:00<00:00, 22.36it/s] 75%|███████▌  | 9/12 [00:00<00:00, 27.20it/s]100%|██████████| 12/12 [00:03<00:00,  2.54it/s]100%|██████████| 12/12 [00:03<00:00,  3.63it/s]
2025-03-13 18:00:01,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:01
2025-03-13 18:00:40,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0104 secs
2025-03-13 18:00:40,185 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 18:00:40,185 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 18:00:57,656 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4706 secs
2025-03-13 18:00:57,658 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7981 secs
2025-03-13 18:00:57,658 [INFO]: {
2025-03-13 18:00:57,658 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:57,659 [INFO]: 	index_param: efSearch=239
2025-03-13 18:00:57,659 [INFO]: 	index_path: knn.index
2025-03-13 18:00:57,659 [INFO]: 	size in bytes: 598691290
2025-03-13 18:00:57,659 [INFO]: 	avg_search_speed_ms: 9.795204513495555
2025-03-13 18:00:57,659 [INFO]: 	99p_search_speed_ms: 16.573804058134517
2025-03-13 18:00:57,659 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:57,659 [INFO]: 	nb vectors: 3043
2025-03-13 18:00:57,659 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:57,659 [INFO]: 	compression ratio: 0.999309918138278
2025-03-13 18:00:57,659 [INFO]: }
2025-03-13 18:00:57,659 [INFO]: 	>>> Finished "Creating the index" in 59.7996 secs
2025-03-13 18:00:57,659 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8366 secs
2025-03-13 18:00:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 39441 [episode count 6/20]
[retrieval_preprocessing] for episode 25120 [episode count 7/20], we have num_retrieval=np.int64(2989) num_query=np.int64(206)
2025-03-13 18:00:59,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:59,733 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:59
2025-03-13 18:00:59,733 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.67it/s]
2025-03-13 18:00:59,762 [INFO]: There are 2989 embeddings of dim 49152
2025-03-13 18:00:59,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:00:59,762 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:59
2025-03-13 18:00:59,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:59,762 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:00:59,762 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:59,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:59,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:59
2025-03-13 18:00:59,763 [INFO]: 616.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:59,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:59,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:59
2025-03-13 18:00:59,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:59,763 [INFO]: 	Creating the index 03/13/2025, 18:00:59
2025-03-13 18:00:59,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:59
2025-03-13 18:00:59,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:00:59,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:59
2025-03-13 18:00:59,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:00:59,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.78it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.77it/s]100%|██████████| 12/12 [00:02<00:00,  4.11it/s]100%|██████████| 12/12 [00:02<00:00,  5.00it/s]
2025-03-13 18:01:02,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:02
2025-03-13 18:01:34,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1731 secs
2025-03-13 18:01:34,342 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 18:01:34,342 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 18:02:06,352 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0098 secs
2025-03-13 18:02:06,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5891 secs
2025-03-13 18:02:06,354 [INFO]: {
2025-03-13 18:02:06,354 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:06,354 [INFO]: 	index_param: efSearch=217
2025-03-13 18:02:06,354 [INFO]: 	index_path: knn.index
2025-03-13 18:02:06,354 [INFO]: 	size in bytes: 588067270
2025-03-13 18:02:06,354 [INFO]: 	avg_search_speed_ms: 9.24767378117169
2025-03-13 18:02:06,354 [INFO]: 	99p_search_speed_ms: 14.270623680204158
2025-03-13 18:02:06,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:06,354 [INFO]: 	nb vectors: 2989
2025-03-13 18:02:06,354 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:06,354 [INFO]: 	compression ratio: 0.9993096742146523
2025-03-13 18:02:06,354 [INFO]: }
2025-03-13 18:02:06,354 [INFO]: 	>>> Finished "Creating the index" in 66.5914 secs
2025-03-13 18:02:06,354 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6212 secs
2025-03-13 18:02:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 25120 [episode count 7/20]
[retrieval_preprocessing] for episode 57913 [episode count 8/20], we have num_retrieval=np.int64(3020) num_query=np.int64(175)
2025-03-13 18:02:08,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:09,237 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:09
2025-03-13 18:02:09,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-13 18:02:09,270 [INFO]: There are 3020 embeddings of dim 49152
2025-03-13 18:02:09,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 18:02:09,271 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:09
2025-03-13 18:02:09,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:09,271 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:02:09,271 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:09,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:09,271 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:09
2025-03-13 18:02:09,271 [INFO]: 623.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:09,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:02:09,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:09
2025-03-13 18:02:09,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:09,271 [INFO]: 	Creating the index 03/13/2025, 18:02:09
2025-03-13 18:02:09,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:09
2025-03-13 18:02:09,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:02:09,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:09
2025-03-13 18:02:09,273 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:02:09,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.23it/s] 50%|█████     | 6/12 [00:00<00:00, 28.89it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.94it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-13 18:02:11,808 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:11
2025-03-13 18:02:50,394 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5859 secs
2025-03-13 18:02:50,394 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 18:02:50,394 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.29it/s]
2025-03-13 18:03:10,932 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5378 secs
2025-03-13 18:03:10,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6624 secs
2025-03-13 18:03:10,935 [INFO]: {
2025-03-13 18:03:10,935 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:10,935 [INFO]: 	index_param: efSearch=217
2025-03-13 18:03:10,936 [INFO]: 	index_path: knn.index
2025-03-13 18:03:10,936 [INFO]: 	size in bytes: 594166210
2025-03-13 18:03:10,936 [INFO]: 	avg_search_speed_ms: 10.258484113101776
2025-03-13 18:03:10,936 [INFO]: 	99p_search_speed_ms: 16.288030804134905
2025-03-13 18:03:10,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:10,936 [INFO]: 	nb vectors: 3020
2025-03-13 18:03:10,936 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:10,936 [INFO]: 	compression ratio: 0.999309873242371
2025-03-13 18:03:10,936 [INFO]: }
2025-03-13 18:03:10,936 [INFO]: 	>>> Finished "Creating the index" in 61.6642 secs
2025-03-13 18:03:10,936 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6990 secs
2025-03-13 18:03:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 57913 [episode count 8/20]
[retrieval_preprocessing] for episode 43700 [episode count 9/20], we have num_retrieval=np.int64(3061) num_query=np.int64(134)
2025-03-13 18:03:12,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:13,447 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:13
2025-03-13 18:03:13,447 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1994.44it/s]
2025-03-13 18:03:13,472 [INFO]: There are 3061 embeddings of dim 49152
2025-03-13 18:03:13,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:03:13,473 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:13
2025-03-13 18:03:13,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:13,473 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:03:13,473 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:13,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:13,473 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:13
2025-03-13 18:03:13,473 [INFO]: 631.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:13,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:03:13,473 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:13
2025-03-13 18:03:13,473 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:13,473 [INFO]: 	Creating the index 03/13/2025, 18:03:13
2025-03-13 18:03:13,473 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:13
2025-03-13 18:03:13,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:03:13,474 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:13
2025-03-13 18:03:13,474 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:03:13,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.99it/s] 38%|███▊      | 5/13 [00:00<00:00, 21.04it/s] 69%|██████▉   | 9/13 [00:00<00:00, 26.44it/s]100%|██████████| 13/13 [00:03<00:00,  3.08it/s]100%|██████████| 13/13 [00:03<00:00,  4.12it/s]
2025-03-13 18:03:16,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:16
2025-03-13 18:03:51,002 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3713 secs
2025-03-13 18:03:51,003 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 18:03:51,003 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 18:04:14,034 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0307 secs
2025-03-13 18:04:14,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5616 secs
2025-03-13 18:04:14,036 [INFO]: {
2025-03-13 18:04:14,036 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:14,036 [INFO]: 	index_param: efSearch=199
2025-03-13 18:04:14,036 [INFO]: 	index_path: knn.index
2025-03-13 18:04:14,036 [INFO]: 	size in bytes: 602232730
2025-03-13 18:04:14,036 [INFO]: 	avg_search_speed_ms: 9.181588724395816
2025-03-13 18:04:14,036 [INFO]: 	99p_search_speed_ms: 16.568983457982537
2025-03-13 18:04:14,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:14,036 [INFO]: 	nb vectors: 3061
2025-03-13 18:04:14,036 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:14,036 [INFO]: 	compression ratio: 0.9993098315994882
2025-03-13 18:04:14,036 [INFO]: }
2025-03-13 18:04:14,036 [INFO]: 	>>> Finished "Creating the index" in 60.5632 secs
2025-03-13 18:04:14,036 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5891 secs
2025-03-13 18:04:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 43700 [episode count 9/20]
[retrieval_preprocessing] for episode 27372 [episode count 10/20], we have num_retrieval=np.int64(3045) num_query=np.int64(150)
2025-03-13 18:04:15,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:16,051 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:16
2025-03-13 18:04:16,052 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 904.33it/s]
2025-03-13 18:04:16,086 [INFO]: There are 3045 embeddings of dim 49152
2025-03-13 18:04:16,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 18:04:16,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:16,086 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:04:16,086 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:16,086 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:16,086 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,086 [INFO]: 628.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:16,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:16,086 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:16
2025-03-13 18:04:16,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:16,086 [INFO]: 	Creating the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,086 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:16
2025-03-13 18:04:16,087 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:04:16,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,088 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:04:16,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.80it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.53it/s]100%|██████████| 12/12 [00:02<00:00,  4.41it/s]100%|██████████| 12/12 [00:02<00:00,  5.36it/s]
2025-03-13 18:04:18,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:18
2025-03-13 18:04:53,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6130 secs
2025-03-13 18:04:53,461 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:04:53,461 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-13 18:05:25,386 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9248 secs
2025-03-13 18:05:25,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3009 secs
2025-03-13 18:05:25,389 [INFO]: {
2025-03-13 18:05:25,389 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:25,389 [INFO]: 	index_param: efSearch=212
2025-03-13 18:05:25,389 [INFO]: 	index_path: knn.index
2025-03-13 18:05:25,389 [INFO]: 	size in bytes: 599084770
2025-03-13 18:05:25,389 [INFO]: 	avg_search_speed_ms: 9.139141547344796
2025-03-13 18:05:25,389 [INFO]: 	99p_search_speed_ms: 14.334884299896654
2025-03-13 18:05:25,389 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:25,389 [INFO]: 	nb vectors: 3045
2025-03-13 18:05:25,389 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:25,389 [INFO]: 	compression ratio: 0.9993099307131443
2025-03-13 18:05:25,389 [INFO]: }
2025-03-13 18:05:25,389 [INFO]: 	>>> Finished "Creating the index" in 69.3026 secs
2025-03-13 18:05:25,389 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3375 secs
2025-03-13 18:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 27372 [episode count 10/20]
[retrieval_preprocessing] for episode 23619 [episode count 11/20], we have num_retrieval=np.int64(3082) num_query=np.int64(113)
2025-03-13 18:05:26,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:27,259 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:27
2025-03-13 18:05:27,259 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2079.48it/s]
2025-03-13 18:05:27,288 [INFO]: There are 3082 embeddings of dim 49152
2025-03-13 18:05:27,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:05:27,288 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:27
2025-03-13 18:05:27,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:27,288 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:05:27,288 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:27,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:27,288 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:27
2025-03-13 18:05:27,288 [INFO]: 636.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:27,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:05:27,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:27
2025-03-13 18:05:27,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:27,288 [INFO]: 	Creating the index 03/13/2025, 18:05:27
2025-03-13 18:05:27,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:27
2025-03-13 18:05:27,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:05:27,290 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:27
2025-03-13 18:05:27,290 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:05:27,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.78it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.09it/s] 85%|████████▍ | 11/13 [00:00<00:00, 33.69it/s]100%|██████████| 13/13 [00:02<00:00,  5.19it/s]
2025-03-13 18:05:29,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:29
2025-03-13 18:06:09,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4593 secs
2025-03-13 18:06:09,257 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 18:06:09,257 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.36it/s]
2025-03-13 18:06:38,757 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5002 secs
2025-03-13 18:06:38,760 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4705 secs
2025-03-13 18:06:38,760 [INFO]: {
2025-03-13 18:06:38,761 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:38,761 [INFO]: 	index_param: efSearch=243
2025-03-13 18:06:38,761 [INFO]: 	index_path: knn.index
2025-03-13 18:06:38,761 [INFO]: 	size in bytes: 606364330
2025-03-13 18:06:38,761 [INFO]: 	avg_search_speed_ms: 10.658745356807625
2025-03-13 18:06:38,761 [INFO]: 	99p_search_speed_ms: 17.11636499268934
2025-03-13 18:06:38,761 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:38,761 [INFO]: 	nb vectors: 3082
2025-03-13 18:06:38,761 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:38,761 [INFO]: 	compression ratio: 0.9993098637579819
2025-03-13 18:06:38,761 [INFO]: }
2025-03-13 18:06:38,761 [INFO]: 	>>> Finished "Creating the index" in 71.4722 secs
2025-03-13 18:06:38,761 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5013 secs
2025-03-13 18:06:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 23619 [episode count 11/20]
[retrieval_preprocessing] for episode 19627 [episode count 12/20], we have num_retrieval=np.int64(3082) num_query=np.int64(113)
2025-03-13 18:06:40,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:40,977 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:40
2025-03-13 18:06:40,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.14it/s]
2025-03-13 18:06:41,014 [INFO]: There are 3082 embeddings of dim 49152
2025-03-13 18:06:41,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 18:06:41,014 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:41
2025-03-13 18:06:41,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:41,014 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:06:41,014 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:41,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:41,014 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:41
2025-03-13 18:06:41,014 [INFO]: 636.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:41,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:06:41,014 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:41
2025-03-13 18:06:41,014 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:41,014 [INFO]: 	Creating the index 03/13/2025, 18:06:41
2025-03-13 18:06:41,014 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:41
2025-03-13 18:06:41,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:06:41,015 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:41
2025-03-13 18:06:41,016 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:06:41,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.12it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.12it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.72it/s]100%|██████████| 13/13 [00:02<00:00,  4.93it/s]
2025-03-13 18:06:43,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:43
2025-03-13 18:07:23,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3300 secs
2025-03-13 18:07:23,984 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:07:23,984 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 18:07:42,133 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1492 secs
2025-03-13 18:07:42,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1204 secs
2025-03-13 18:07:42,136 [INFO]: {
2025-03-13 18:07:42,136 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:42,136 [INFO]: 	index_param: efSearch=240
2025-03-13 18:07:42,136 [INFO]: 	index_path: knn.index
2025-03-13 18:07:42,136 [INFO]: 	size in bytes: 606364330
2025-03-13 18:07:42,136 [INFO]: 	avg_search_speed_ms: 11.714770934387465
2025-03-13 18:07:42,136 [INFO]: 	99p_search_speed_ms: 18.801996435504407
2025-03-13 18:07:42,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:42,136 [INFO]: 	nb vectors: 3082
2025-03-13 18:07:42,136 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:42,136 [INFO]: 	compression ratio: 0.9993098637579819
2025-03-13 18:07:42,136 [INFO]: }
2025-03-13 18:07:42,136 [INFO]: 	>>> Finished "Creating the index" in 61.1221 secs
2025-03-13 18:07:42,136 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1592 secs
2025-03-13 18:07:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 19627 [episode count 12/20]
[retrieval_preprocessing] for episode 5024 [episode count 13/20], we have num_retrieval=np.int64(3017) num_query=np.int64(178)
2025-03-13 18:07:43,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:44,112 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:44
2025-03-13 18:07:44,112 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1083.24it/s]
2025-03-13 18:07:44,141 [INFO]: There are 3017 embeddings of dim 49152
2025-03-13 18:07:44,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:07:44,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:44,141 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:07:44,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:44,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:44,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,141 [INFO]: 622.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:44,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:44,142 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:44
2025-03-13 18:07:44,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:44,142 [INFO]: 	Creating the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,142 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:44
2025-03-13 18:07:44,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:07:44,143 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,143 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:07:44,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 15.98it/s] 50%|█████     | 6/12 [00:00<00:00, 27.12it/s] 83%|████████▎ | 10/12 [00:00<00:00, 31.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.36it/s]
2025-03-13 18:07:46,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:46
2025-03-13 18:08:20,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3939 secs
2025-03-13 18:08:20,294 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:08:20,294 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 18:08:48,489 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1943 secs
2025-03-13 18:08:48,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3481 secs
2025-03-13 18:08:48,491 [INFO]: {
2025-03-13 18:08:48,491 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:48,491 [INFO]: 	index_param: efSearch=208
2025-03-13 18:08:48,491 [INFO]: 	index_path: knn.index
2025-03-13 18:08:48,491 [INFO]: 	size in bytes: 593575990
2025-03-13 18:08:48,491 [INFO]: 	avg_search_speed_ms: 8.108309265611345
2025-03-13 18:08:48,491 [INFO]: 	99p_search_speed_ms: 11.791608277708296
2025-03-13 18:08:48,491 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:48,491 [INFO]: 	nb vectors: 3017
2025-03-13 18:08:48,491 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:48,491 [INFO]: 	compression ratio: 0.9993098541603747
2025-03-13 18:08:48,491 [INFO]: }
2025-03-13 18:08:48,491 [INFO]: 	>>> Finished "Creating the index" in 64.3499 secs
2025-03-13 18:08:48,491 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3795 secs
2025-03-13 18:08:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 5024 [episode count 13/20]
[retrieval_preprocessing] for episode 19372 [episode count 14/20], we have num_retrieval=np.int64(3047) num_query=np.int64(148)
2025-03-13 18:08:50,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:50,442 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:50
2025-03-13 18:08:50,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1229.64it/s]
2025-03-13 18:08:50,472 [INFO]: There are 3047 embeddings of dim 49152
2025-03-13 18:08:50,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:08:50,472 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:50
2025-03-13 18:08:50,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:50,473 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:08:50,473 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:50,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:08:50,473 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:50
2025-03-13 18:08:50,473 [INFO]: 628.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:50,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:08:50,473 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:50
2025-03-13 18:08:50,473 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:50,474 [INFO]: 	Creating the index 03/13/2025, 18:08:50
2025-03-13 18:08:50,474 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:50
2025-03-13 18:08:50,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:08:50,476 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:50
2025-03-13 18:08:50,476 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:08:50,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.96it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.53it/s]100%|██████████| 12/12 [00:02<00:00,  4.45it/s]100%|██████████| 12/12 [00:02<00:00,  5.42it/s]
2025-03-13 18:08:52,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:52
2025-03-13 18:09:30,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2280 secs
2025-03-13 18:09:30,925 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 18:09:30,925 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 18:09:58,754 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8282 secs
2025-03-13 18:09:58,785 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3086 secs
2025-03-13 18:09:58,785 [INFO]: {
2025-03-13 18:09:58,785 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:58,785 [INFO]: 	index_param: efSearch=225
2025-03-13 18:09:58,785 [INFO]: 	index_path: knn.index
2025-03-13 18:09:58,785 [INFO]: 	size in bytes: 599478250
2025-03-13 18:09:58,785 [INFO]: 	avg_search_speed_ms: 11.45978357759171
2025-03-13 18:09:58,785 [INFO]: 	99p_search_speed_ms: 19.77925128303468
2025-03-13 18:09:58,785 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:58,785 [INFO]: 	nb vectors: 3047
2025-03-13 18:09:58,785 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:58,785 [INFO]: 	compression ratio: 0.9993099432715031
2025-03-13 18:09:58,785 [INFO]: }
2025-03-13 18:09:58,785 [INFO]: 	>>> Finished "Creating the index" in 68.3117 secs
2025-03-13 18:09:58,785 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3438 secs
2025-03-13 18:09:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 19372 [episode count 14/20]
[retrieval_preprocessing] for episode 58298 [episode count 15/20], we have num_retrieval=np.int64(3065) num_query=np.int64(130)
2025-03-13 18:10:00,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:01,235 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:01
2025-03-13 18:10:01,235 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1040.25it/s]
2025-03-13 18:10:01,265 [INFO]: There are 3065 embeddings of dim 49152
2025-03-13 18:10:01,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:10:01,266 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:01
2025-03-13 18:10:01,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:01,266 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:10:01,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:01,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:01,266 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:01
2025-03-13 18:10:01,266 [INFO]: 632.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:01,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:10:01,266 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:01
2025-03-13 18:10:01,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:01,266 [INFO]: 	Creating the index 03/13/2025, 18:10:01
2025-03-13 18:10:01,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:01
2025-03-13 18:10:01,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:10:01,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:01
2025-03-13 18:10:01,268 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:10:01,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.56it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.64it/s] 85%|████████▍ | 11/13 [00:00<00:00, 37.26it/s]100%|██████████| 13/13 [00:02<00:00,  4.97it/s]
2025-03-13 18:10:03,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:03
2025-03-13 18:10:43,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6990 secs
2025-03-13 18:10:43,589 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 18:10:43,589 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.67it/s]
2025-03-13 18:11:04,596 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0069 secs
2025-03-13 18:11:04,599 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3308 secs
2025-03-13 18:11:04,599 [INFO]: {
2025-03-13 18:11:04,599 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:04,599 [INFO]: 	index_param: efSearch=234
2025-03-13 18:11:04,599 [INFO]: 	index_path: knn.index
2025-03-13 18:11:04,599 [INFO]: 	size in bytes: 603019750
2025-03-13 18:11:04,599 [INFO]: 	avg_search_speed_ms: 10.12059028198196
2025-03-13 18:11:04,599 [INFO]: 	99p_search_speed_ms: 16.482373548205942
2025-03-13 18:11:04,599 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:04,599 [INFO]: 	nb vectors: 3065
2025-03-13 18:11:04,599 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:04,599 [INFO]: 	compression ratio: 0.9993097572674858
2025-03-13 18:11:04,599 [INFO]: }
2025-03-13 18:11:04,599 [INFO]: 	>>> Finished "Creating the index" in 63.3327 secs
2025-03-13 18:11:04,599 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3636 secs
2025-03-13 18:11:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 58298 [episode count 15/20]
[retrieval_preprocessing] for episode 3340 [episode count 16/20], we have num_retrieval=np.int64(3003) num_query=np.int64(192)
2025-03-13 18:11:06,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:07,359 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:07
2025-03-13 18:11:07,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.68it/s]
2025-03-13 18:11:07,397 [INFO]: There are 3003 embeddings of dim 49152
2025-03-13 18:11:07,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-13 18:11:07,397 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:07
2025-03-13 18:11:07,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:07,397 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:11:07,397 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:07,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:07,397 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:07
2025-03-13 18:11:07,398 [INFO]: 619.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:07,398 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:07,398 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:07
2025-03-13 18:11:07,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:07,398 [INFO]: 	Creating the index 03/13/2025, 18:11:07
2025-03-13 18:11:07,398 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:07
2025-03-13 18:11:07,399 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:11:07,399 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:07
2025-03-13 18:11:07,399 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:11:07,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.13it/s]100%|██████████| 12/12 [00:02<00:00,  3.52it/s]100%|██████████| 12/12 [00:02<00:00,  4.30it/s]
2025-03-13 18:11:10,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:10
2025-03-13 18:11:41,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2144 secs
2025-03-13 18:11:41,408 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 18:11:41,408 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.69it/s]
2025-03-13 18:12:08,344 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9357 secs
2025-03-13 18:12:08,346 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9465 secs
2025-03-13 18:12:08,346 [INFO]: {
2025-03-13 18:12:08,346 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:08,346 [INFO]: 	index_param: efSearch=287
2025-03-13 18:12:08,346 [INFO]: 	index_path: knn.index
2025-03-13 18:12:08,346 [INFO]: 	size in bytes: 590821630
2025-03-13 18:12:08,346 [INFO]: 	avg_search_speed_ms: 12.925371558054108
2025-03-13 18:12:08,346 [INFO]: 	99p_search_speed_ms: 21.1310450383462
2025-03-13 18:12:08,346 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:08,346 [INFO]: 	nb vectors: 3003
2025-03-13 18:12:08,346 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:08,346 [INFO]: 	compression ratio: 0.9993097646069593
2025-03-13 18:12:08,346 [INFO]: }
2025-03-13 18:12:08,346 [INFO]: 	>>> Finished "Creating the index" in 60.9483 secs
2025-03-13 18:12:08,346 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9871 secs
2025-03-13 18:12:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 3340 [episode count 16/20]
[retrieval_preprocessing] for episode 64775 [episode count 17/20], we have num_retrieval=np.int64(3085) num_query=np.int64(110)
2025-03-13 18:12:10,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:11,291 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:11
2025-03-13 18:12:11,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-13 18:12:11,317 [INFO]: There are 3085 embeddings of dim 49152
2025-03-13 18:12:11,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 18:12:11,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:11
2025-03-13 18:12:11,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:11,317 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:12:11,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:11,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:11,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:11
2025-03-13 18:12:11,317 [INFO]: 636.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:11,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:12:11,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:11
2025-03-13 18:12:11,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:11,318 [INFO]: 	Creating the index 03/13/2025, 18:12:11
2025-03-13 18:12:11,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:11
2025-03-13 18:12:11,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:12:11,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:11
2025-03-13 18:12:11,319 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:12:11,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.36it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.89it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.87it/s]100%|██████████| 13/13 [00:02<00:00,  5.33it/s]
2025-03-13 18:12:13,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:13
2025-03-13 18:12:49,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4698 secs
2025-03-13 18:12:49,230 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:12:49,231 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.62it/s]
2025-03-13 18:13:06,618 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3878 secs
2025-03-13 18:13:06,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4288 secs
2025-03-13 18:13:06,748 [INFO]: {
2025-03-13 18:13:06,748 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:06,748 [INFO]: 	index_param: efSearch=182
2025-03-13 18:13:06,748 [INFO]: 	index_path: knn.index
2025-03-13 18:13:06,748 [INFO]: 	size in bytes: 606954610
2025-03-13 18:13:06,748 [INFO]: 	avg_search_speed_ms: 11.560508774356604
2025-03-13 18:13:06,748 [INFO]: 	99p_search_speed_ms: 34.334080815315254
2025-03-13 18:13:06,748 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:06,748 [INFO]: 	nb vectors: 3085
2025-03-13 18:13:06,748 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:06,748 [INFO]: 	compression ratio: 0.9993097836426351
2025-03-13 18:13:06,749 [INFO]: }
2025-03-13 18:13:06,749 [INFO]: 	>>> Finished "Creating the index" in 55.4309 secs
2025-03-13 18:13:06,749 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4574 secs
2025-03-13 18:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 64775 [episode count 17/20]
[retrieval_preprocessing] for episode 26026 [episode count 18/20], we have num_retrieval=np.int64(2908) num_query=np.int64(287)
2025-03-13 18:13:08,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:08,879 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:08
2025-03-13 18:13:08,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.89it/s]
2025-03-13 18:13:08,914 [INFO]: There are 2908 embeddings of dim 49152
2025-03-13 18:13:08,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 18:13:08,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:08
2025-03-13 18:13:08,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:08,915 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:13:08,915 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:08,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:13:08,915 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:08
2025-03-13 18:13:08,915 [INFO]: 600.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:08,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:13:08,915 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:08
2025-03-13 18:13:08,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:08,915 [INFO]: 	Creating the index 03/13/2025, 18:13:08
2025-03-13 18:13:08,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:08
2025-03-13 18:13:08,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:13:08,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:08
2025-03-13 18:13:08,917 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:13:08,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.76it/s] 50%|█████     | 6/12 [00:00<00:00, 31.27it/s]100%|██████████| 12/12 [00:02<00:00,  4.97it/s]100%|██████████| 12/12 [00:02<00:00,  5.71it/s]
2025-03-13 18:13:11,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:11
2025-03-13 18:13:43,259 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2378 secs
2025-03-13 18:13:43,259 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 18:13:43,259 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s]
2025-03-13 18:14:10,718 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4584 secs
2025-03-13 18:14:10,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8032 secs
2025-03-13 18:14:10,720 [INFO]: {
2025-03-13 18:14:10,720 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:10,720 [INFO]: 	index_param: efSearch=278
2025-03-13 18:14:10,720 [INFO]: 	index_path: knn.index
2025-03-13 18:14:10,720 [INFO]: 	size in bytes: 572130910
2025-03-13 18:14:10,720 [INFO]: 	avg_search_speed_ms: 12.84263548483075
2025-03-13 18:14:10,720 [INFO]: 	99p_search_speed_ms: 19.549779095686976
2025-03-13 18:14:10,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:10,720 [INFO]: 	nb vectors: 2908
2025-03-13 18:14:10,720 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:10,720 [INFO]: 	compression ratio: 0.9993098677363892
2025-03-13 18:14:10,720 [INFO]: }
2025-03-13 18:14:10,720 [INFO]: 	>>> Finished "Creating the index" in 61.8050 secs
2025-03-13 18:14:10,720 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8413 secs
2025-03-13 18:14:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 26026 [episode count 18/20]
[retrieval_preprocessing] for episode 73073 [episode count 19/20], we have num_retrieval=np.int64(3067) num_query=np.int64(128)
2025-03-13 18:14:14,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:15,022 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:15
2025-03-13 18:14:15,022 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1107.26it/s]
2025-03-13 18:14:15,062 [INFO]: There are 3067 embeddings of dim 49152
2025-03-13 18:14:15,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0403 secs
2025-03-13 18:14:15,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:15
2025-03-13 18:14:15,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:15,063 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:14:15,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:15,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:14:15,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:15
2025-03-13 18:14:15,063 [INFO]: 633.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:15,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:14:15,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:15
2025-03-13 18:14:15,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:15,064 [INFO]: 	Creating the index 03/13/2025, 18:14:15
2025-03-13 18:14:15,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:15
2025-03-13 18:14:15,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:14:15,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:15
2025-03-13 18:14:15,068 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:14:15,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.82it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.73it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.93it/s]100%|██████████| 13/13 [00:02<00:00,  4.45it/s]
2025-03-13 18:14:17,995 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:17
2025-03-13 18:14:56,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6283 secs
2025-03-13 18:14:56,624 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 18:14:56,625 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 18:15:26,476 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8511 secs
2025-03-13 18:15:26,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4102 secs
2025-03-13 18:15:26,478 [INFO]: {
2025-03-13 18:15:26,478 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:26,478 [INFO]: 	index_param: efSearch=292
2025-03-13 18:15:26,478 [INFO]: 	index_path: knn.index
2025-03-13 18:15:26,478 [INFO]: 	size in bytes: 603413230
2025-03-13 18:15:26,478 [INFO]: 	avg_search_speed_ms: 10.291342156672842
2025-03-13 18:15:26,478 [INFO]: 	99p_search_speed_ms: 14.850761424750086
2025-03-13 18:15:26,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:26,478 [INFO]: 	nb vectors: 3067
2025-03-13 18:15:26,478 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:26,478 [INFO]: 	compression ratio: 0.9993097698570513
2025-03-13 18:15:26,478 [INFO]: }
2025-03-13 18:15:26,478 [INFO]: 	>>> Finished "Creating the index" in 71.4140 secs
2025-03-13 18:15:26,478 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4561 secs
2025-03-13 18:15:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 73073 [episode count 19/20]
2025-03-13 18:15:27: [retrieval_preprocessing] finished for 8626796008_press_button_on_toaster [chosen_id count 8/196]
2025-03-13 18:15:29: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8702636502_lid_on_pot [chosen_id count 9/196]
2025-03-13 18:15:29: [retrieval_preprocessing] we have num_total=5100 embedding_dim=49152
[retrieval_preprocessing] for episode 93263 [episode count 0/20], we have num_retrieval=np.int64(4874) num_query=np.int64(226)
2025-03-13 18:15:29,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:30,813 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:30
2025-03-13 18:15:30,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.37it/s]
2025-03-13 18:15:30,841 [INFO]: There are 4874 embeddings of dim 49152
2025-03-13 18:15:30,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:15:30,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:30,841 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:15:30,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:30,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:15:30,842 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,842 [INFO]: 1005.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:30,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:15:30,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:30
2025-03-13 18:15:30,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:30,842 [INFO]: 	Creating the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,842 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:30
2025-03-13 18:15:30,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:15:30,844 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:30
2025-03-13 18:15:30,844 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:15:30,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.90it/s] 20%|██        | 4/20 [00:00<00:00, 18.26it/s] 35%|███▌      | 7/20 [00:00<00:00, 20.66it/s] 55%|█████▌    | 11/20 [00:00<00:00, 25.77it/s] 75%|███████▌  | 15/20 [00:00<00:00, 28.84it/s] 95%|█████████▌| 19/20 [00:00<00:00, 30.11it/s]100%|██████████| 20/20 [00:05<00:00,  3.68it/s]
2025-03-13 18:15:36,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:36
2025-03-13 18:16:28,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2959 secs
2025-03-13 18:16:28,590 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:16:28,590 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.33it/s]
2025-03-13 18:17:12,138 [INFO]: 	>>> Finished "Compute fast metrics" in 43.5481 secs
2025-03-13 18:17:12,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.2973 secs
2025-03-13 18:17:12,141 [INFO]: {
2025-03-13 18:17:12,141 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:12,141 [INFO]: 	index_param: efSearch=160
2025-03-13 18:17:12,141 [INFO]: 	index_path: knn.index
2025-03-13 18:17:12,141 [INFO]: 	size in bytes: 958930270
2025-03-13 18:17:12,141 [INFO]: 	avg_search_speed_ms: 7.971453038879125
2025-03-13 18:17:12,141 [INFO]: 	99p_search_speed_ms: 12.000927305780353
2025-03-13 18:17:12,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:12,141 [INFO]: 	nb vectors: 4874
2025-03-13 18:17:12,141 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:12,141 [INFO]: 	compression ratio: 0.9993087318017398
2025-03-13 18:17:12,141 [INFO]: }
2025-03-13 18:17:12,142 [INFO]: 	>>> Finished "Creating the index" in 101.2995 secs
2025-03-13 18:17:12,142 [INFO]: >>> Finished "Launching the whole pipeline" in 101.3285 secs
2025-03-13 18:17:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 93263 [episode count 0/20]
[retrieval_preprocessing] for episode 34917 [episode count 1/20], we have num_retrieval=np.int64(4848) num_query=np.int64(252)
2025-03-13 18:17:14,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:14,940 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:14
2025-03-13 18:17:14,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2526.69it/s]
2025-03-13 18:17:14,963 [INFO]: There are 4848 embeddings of dim 49152
2025-03-13 18:17:14,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:17:14,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:14
2025-03-13 18:17:14,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:14,964 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:17:14,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:14,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:17:14,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:14
2025-03-13 18:17:14,964 [INFO]: 1000.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:14,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:17:14,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:14
2025-03-13 18:17:14,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:14,964 [INFO]: 	Creating the index 03/13/2025, 18:17:14
2025-03-13 18:17:14,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:14
2025-03-13 18:17:14,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:17:14,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:14
2025-03-13 18:17:14,965 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:17:14,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.56it/s] 30%|███       | 6/20 [00:00<00:00, 27.18it/s] 55%|█████▌    | 11/20 [00:00<00:00, 34.31it/s] 80%|████████  | 16/20 [00:00<00:00, 38.60it/s]100%|██████████| 20/20 [00:03<00:00,  3.20it/s]100%|██████████| 20/20 [00:03<00:00,  5.02it/s]
2025-03-13 18:17:18,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:18
2025-03-13 18:18:06,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7954 secs
2025-03-13 18:18:06,751 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:18:06,751 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 18:18:43,585 [INFO]: 	>>> Finished "Compute fast metrics" in 36.8334 secs
2025-03-13 18:18:43,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.6226 secs
2025-03-13 18:18:43,588 [INFO]: {
2025-03-13 18:18:43,588 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:43,588 [INFO]: 	index_param: efSearch=161
2025-03-13 18:18:43,588 [INFO]: 	index_path: knn.index
2025-03-13 18:18:43,588 [INFO]: 	size in bytes: 953815030
2025-03-13 18:18:43,588 [INFO]: 	avg_search_speed_ms: 8.27398647922434
2025-03-13 18:18:43,588 [INFO]: 	99p_search_speed_ms: 11.987160993739963
2025-03-13 18:18:43,588 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:43,588 [INFO]: 	nb vectors: 4848
2025-03-13 18:18:43,588 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:43,588 [INFO]: 	compression ratio: 0.9993086227630529
2025-03-13 18:18:43,588 [INFO]: }
2025-03-13 18:18:43,588 [INFO]: 	>>> Finished "Creating the index" in 88.6241 secs
2025-03-13 18:18:43,588 [INFO]: >>> Finished "Launching the whole pipeline" in 88.6483 secs
2025-03-13 18:18:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 34917 [episode count 1/20]
[retrieval_preprocessing] for episode 26727 [episode count 2/20], we have num_retrieval=np.int64(4898) num_query=np.int64(202)
2025-03-13 18:18:45,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:46,385 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:46
2025-03-13 18:18:46,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.89it/s]
2025-03-13 18:18:46,416 [INFO]: There are 4898 embeddings of dim 49152
2025-03-13 18:18:46,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 18:18:46,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:46
2025-03-13 18:18:46,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:46,416 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:18:46,416 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:46,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:46,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:46
2025-03-13 18:18:46,417 [INFO]: 1010.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:46,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:18:46,417 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:46
2025-03-13 18:18:46,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:46,417 [INFO]: 	Creating the index 03/13/2025, 18:18:46
2025-03-13 18:18:46,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:46
2025-03-13 18:18:46,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:18:46,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:46
2025-03-13 18:18:46,418 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:18:46,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.25it/s] 30%|███       | 6/20 [00:00<00:00, 26.63it/s] 55%|█████▌    | 11/20 [00:00<00:00, 34.01it/s] 80%|████████  | 16/20 [00:00<00:00, 37.35it/s]100%|██████████| 20/20 [00:04<00:00,  3.05it/s]100%|██████████| 20/20 [00:04<00:00,  4.79it/s]
2025-03-13 18:18:50,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:50
2025-03-13 18:19:35,960 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3590 secs
2025-03-13 18:19:35,961 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 18:19:35,961 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.07it/s]
2025-03-13 18:20:09,901 [INFO]: 	>>> Finished "Compute fast metrics" in 33.9401 secs
2025-03-13 18:20:09,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.4861 secs
2025-03-13 18:20:09,904 [INFO]: {
2025-03-13 18:20:09,904 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:09,904 [INFO]: 	index_param: efSearch=148
2025-03-13 18:20:09,904 [INFO]: 	index_path: knn.index
2025-03-13 18:20:09,904 [INFO]: 	size in bytes: 963652090
2025-03-13 18:20:09,904 [INFO]: 	avg_search_speed_ms: 7.8592170212921575
2025-03-13 18:20:09,904 [INFO]: 	99p_search_speed_ms: 14.516428722999985
2025-03-13 18:20:09,904 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:09,904 [INFO]: 	nb vectors: 4898
2025-03-13 18:20:09,904 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:09,904 [INFO]: 	compression ratio: 0.9993087692052844
2025-03-13 18:20:09,904 [INFO]: }
2025-03-13 18:20:09,904 [INFO]: 	>>> Finished "Creating the index" in 83.4876 secs
2025-03-13 18:20:09,904 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5194 secs
2025-03-13 18:20:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 26727 [episode count 2/20]
[retrieval_preprocessing] for episode 83567 [episode count 3/20], we have num_retrieval=np.int64(4845) num_query=np.int64(255)
2025-03-13 18:20:11,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:12,536 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:12
2025-03-13 18:20:12,536 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.07it/s]
2025-03-13 18:20:13,036 [INFO]: There are 4845 embeddings of dim 49152
2025-03-13 18:20:13,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4996 secs
2025-03-13 18:20:13,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:13
2025-03-13 18:20:13,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:13,036 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:20:13,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:13,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:20:13,037 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:13
2025-03-13 18:20:13,037 [INFO]: 999.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:13,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:20:13,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:13
2025-03-13 18:20:13,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:13,037 [INFO]: 	Creating the index 03/13/2025, 18:20:13
2025-03-13 18:20:13,038 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:13
2025-03-13 18:20:13,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:20:13,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:13
2025-03-13 18:20:13,040 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:20:13,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.09it/s] 30%|███       | 6/20 [00:00<00:00, 28.71it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.28it/s] 80%|████████  | 16/20 [00:00<00:00, 38.54it/s]100%|██████████| 20/20 [00:04<00:00,  2.84it/s]100%|██████████| 20/20 [00:04<00:00,  4.49it/s]
2025-03-13 18:20:17,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:17
2025-03-13 18:21:03,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3332 secs
2025-03-13 18:21:03,834 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 18:21:03,835 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.53it/s]
2025-03-13 18:21:31,750 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9147 secs
2025-03-13 18:21:31,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7124 secs
2025-03-13 18:21:31,753 [INFO]: {
2025-03-13 18:21:31,753 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:31,753 [INFO]: 	index_param: efSearch=185
2025-03-13 18:21:31,753 [INFO]: 	index_path: knn.index
2025-03-13 18:21:31,753 [INFO]: 	size in bytes: 953224810
2025-03-13 18:21:31,753 [INFO]: 	avg_search_speed_ms: 7.986885722177609
2025-03-13 18:21:31,753 [INFO]: 	99p_search_speed_ms: 12.27481361012906
2025-03-13 18:21:31,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:31,753 [INFO]: 	nb vectors: 4845
2025-03-13 18:21:31,753 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:31,753 [INFO]: 	compression ratio: 0.999308610106361
2025-03-13 18:21:31,753 [INFO]: }
2025-03-13 18:21:31,753 [INFO]: 	>>> Finished "Creating the index" in 78.7155 secs
2025-03-13 18:21:31,753 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2166 secs
2025-03-13 18:21:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 83567 [episode count 3/20]
[retrieval_preprocessing] for episode 4231 [episode count 4/20], we have num_retrieval=np.int64(4849) num_query=np.int64(251)
2025-03-13 18:21:33,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:34,738 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:34
2025-03-13 18:21:34,738 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-13 18:21:34,764 [INFO]: There are 4849 embeddings of dim 49152
2025-03-13 18:21:34,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:21:34,764 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:34
2025-03-13 18:21:34,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:34,765 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:21:34,765 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:34,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:34,765 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:34
2025-03-13 18:21:34,765 [INFO]: 1000.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:34,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:21:34,765 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:34
2025-03-13 18:21:34,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:34,765 [INFO]: 	Creating the index 03/13/2025, 18:21:34
2025-03-13 18:21:34,765 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:34
2025-03-13 18:21:34,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:21:34,766 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:34
2025-03-13 18:21:34,766 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:21:34,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.10it/s] 30%|███       | 6/20 [00:00<00:00, 29.50it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.00it/s] 80%|████████  | 16/20 [00:00<00:00, 40.70it/s]100%|██████████| 20/20 [00:03<00:00,  5.31it/s]
2025-03-13 18:21:38,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:38
2025-03-13 18:22:19,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6590 secs
2025-03-13 18:22:19,197 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 18:22:19,197 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-13 18:22:52,984 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7871 secs
2025-03-13 18:22:52,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2228 secs
2025-03-13 18:22:52,989 [INFO]: {
2025-03-13 18:22:52,989 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:52,989 [INFO]: 	index_param: efSearch=182
2025-03-13 18:22:52,989 [INFO]: 	index_path: knn.index
2025-03-13 18:22:52,989 [INFO]: 	size in bytes: 954011770
2025-03-13 18:22:52,989 [INFO]: 	avg_search_speed_ms: 10.26471492354385
2025-03-13 18:22:52,989 [INFO]: 	99p_search_speed_ms: 16.540553029626604
2025-03-13 18:22:52,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:52,989 [INFO]: 	nb vectors: 4849
2025-03-13 18:22:52,989 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:52,989 [INFO]: 	compression ratio: 0.9993086269784701
2025-03-13 18:22:52,989 [INFO]: }
2025-03-13 18:22:52,989 [INFO]: 	>>> Finished "Creating the index" in 78.2243 secs
2025-03-13 18:22:52,989 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2513 secs
2025-03-13 18:22:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 4231 [episode count 4/20]
[retrieval_preprocessing] for episode 35512 [episode count 5/20], we have num_retrieval=np.int64(4797) num_query=np.int64(303)
2025-03-13 18:22:55,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:57,419 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:57
2025-03-13 18:22:57,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.04it/s]
2025-03-13 18:22:57,452 [INFO]: There are 4797 embeddings of dim 49152
2025-03-13 18:22:57,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 18:22:57,452 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:57,452 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:22:57,452 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:57,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:57,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,452 [INFO]: 990.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:57,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:57,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:57
2025-03-13 18:22:57,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:57,452 [INFO]: 	Creating the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:57
2025-03-13 18:22:57,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:22:57,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:57
2025-03-13 18:22:57,454 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:22:57,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.23it/s] 16%|█▌        | 3/19 [00:00<00:01, 12.54it/s] 26%|██▋       | 5/19 [00:00<00:00, 14.62it/s] 37%|███▋      | 7/19 [00:00<00:00, 16.05it/s] 47%|████▋     | 9/19 [00:00<00:00, 16.91it/s] 63%|██████▎   | 12/19 [00:00<00:00, 17.86it/s] 74%|███████▎  | 14/19 [00:00<00:00, 14.26it/s] 84%|████████▍ | 16/19 [00:01<00:00, 13.70it/s] 95%|█████████▍| 18/19 [00:01<00:00, 12.11it/s]100%|██████████| 19/19 [00:06<00:00,  2.89it/s]
2025-03-13 18:23:04,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:04
2025-03-13 18:23:57,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.0949 secs
2025-03-13 18:23:57,144 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 18:23:57,144 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-13 18:24:31,354 [INFO]: 	>>> Finished "Compute fast metrics" in 34.2104 secs
2025-03-13 18:24:31,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.0693 secs
2025-03-13 18:24:31,524 [INFO]: {
2025-03-13 18:24:31,524 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:31,524 [INFO]: 	index_param: efSearch=143
2025-03-13 18:24:31,524 [INFO]: 	index_path: knn.index
2025-03-13 18:24:31,524 [INFO]: 	size in bytes: 943780990
2025-03-13 18:24:31,524 [INFO]: 	avg_search_speed_ms: 9.440731292597535
2025-03-13 18:24:31,524 [INFO]: 	99p_search_speed_ms: 15.088648982346077
2025-03-13 18:24:31,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:31,524 [INFO]: 	nb vectors: 4797
2025-03-13 18:24:31,524 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:31,524 [INFO]: 	compression ratio: 0.9993087230968701
2025-03-13 18:24:31,524 [INFO]: }
2025-03-13 18:24:31,524 [INFO]: 	>>> Finished "Creating the index" in 94.0718 secs
2025-03-13 18:24:31,524 [INFO]: >>> Finished "Launching the whole pipeline" in 94.1049 secs
2025-03-13 18:24:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 35512 [episode count 5/20]
[retrieval_preprocessing] for episode 3447 [episode count 6/20], we have num_retrieval=np.int64(4804) num_query=np.int64(296)
2025-03-13 18:24:34,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:34,986 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:34
2025-03-13 18:24:34,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-13 18:24:35,017 [INFO]: There are 4804 embeddings of dim 49152
2025-03-13 18:24:35,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 18:24:35,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:35,017 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:24:35,017 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:35,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:35,017 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,017 [INFO]: 991.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:35,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:24:35,017 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:35
2025-03-13 18:24:35,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:35,018 [INFO]: 	Creating the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:35
2025-03-13 18:24:35,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:24:35,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:35
2025-03-13 18:24:35,019 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:24:35,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.61it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.24it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.98it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.20it/s]100%|██████████| 19/19 [00:04<00:00,  4.00it/s]
2025-03-13 18:24:39,773 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:39
2025-03-13 18:25:22,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1338 secs
2025-03-13 18:25:22,908 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 18:25:22,908 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 18:25:57,036 [INFO]: 	>>> Finished "Compute fast metrics" in 34.1275 secs
2025-03-13 18:25:57,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0188 secs
2025-03-13 18:25:57,038 [INFO]: {
2025-03-13 18:25:57,038 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:57,038 [INFO]: 	index_param: efSearch=138
2025-03-13 18:25:57,038 [INFO]: 	index_path: knn.index
2025-03-13 18:25:57,038 [INFO]: 	size in bytes: 945158290
2025-03-13 18:25:57,038 [INFO]: 	avg_search_speed_ms: 6.563842496715452
2025-03-13 18:25:57,038 [INFO]: 	99p_search_speed_ms: 9.150076285004614
2025-03-13 18:25:57,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:57,038 [INFO]: 	nb vectors: 4804
2025-03-13 18:25:57,038 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:57,038 [INFO]: 	compression ratio: 0.9993086258599075
2025-03-13 18:25:57,038 [INFO]: }
2025-03-13 18:25:57,038 [INFO]: 	>>> Finished "Creating the index" in 82.0207 secs
2025-03-13 18:25:57,038 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0523 secs
2025-03-13 18:25:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 3447 [episode count 6/20]
[retrieval_preprocessing] for episode 76031 [episode count 7/20], we have num_retrieval=np.int64(4878) num_query=np.int64(222)
2025-03-13 18:25:59,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:00,085 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:00
2025-03-13 18:26:00,085 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1950.84it/s]
2025-03-13 18:26:00,112 [INFO]: There are 4878 embeddings of dim 49152
2025-03-13 18:26:00,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:26:00,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:00,112 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:26:00,112 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:00,112 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:00,112 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,112 [INFO]: 1006.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:00,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:00,112 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:00
2025-03-13 18:26:00,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:00,112 [INFO]: 	Creating the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:00
2025-03-13 18:26:00,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:26:00,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,114 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:26:00,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.71it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.81it/s] 70%|███████   | 14/20 [00:00<00:00, 47.60it/s]100%|██████████| 20/20 [00:03<00:00,  3.84it/s]100%|██████████| 20/20 [00:03<00:00,  5.17it/s]
2025-03-13 18:26:03,983 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:03
2025-03-13 18:26:49,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6839 secs
2025-03-13 18:26:49,668 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:26:49,668 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-13 18:27:12,216 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5481 secs
2025-03-13 18:27:12,219 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1058 secs
2025-03-13 18:27:12,220 [INFO]: {
2025-03-13 18:27:12,220 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:12,220 [INFO]: 	index_param: efSearch=147
2025-03-13 18:27:12,220 [INFO]: 	index_path: knn.index
2025-03-13 18:27:12,220 [INFO]: 	size in bytes: 959717290
2025-03-13 18:27:12,220 [INFO]: 	avg_search_speed_ms: 7.923066990948895
2025-03-13 18:27:12,220 [INFO]: 	99p_search_speed_ms: 15.344341506715883
2025-03-13 18:27:12,220 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:12,220 [INFO]: 	nb vectors: 4878
2025-03-13 18:27:12,220 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:12,220 [INFO]: 	compression ratio: 0.9993086859985612
2025-03-13 18:27:12,220 [INFO]: }
2025-03-13 18:27:12,220 [INFO]: 	>>> Finished "Creating the index" in 72.1075 secs
2025-03-13 18:27:12,220 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1354 secs
2025-03-13 18:27:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 76031 [episode count 7/20]
[retrieval_preprocessing] for episode 70930 [episode count 8/20], we have num_retrieval=np.int64(4709) num_query=np.int64(391)
2025-03-13 18:27:14,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:14,938 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:14
2025-03-13 18:27:14,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 18:27:14,975 [INFO]: There are 4709 embeddings of dim 49152
2025-03-13 18:27:14,975 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 18:27:14,975 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,975 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:14,975 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:27:14,975 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:14,975 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:14,975 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,975 [INFO]: 971.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:14,975 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:27:14,975 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:14
2025-03-13 18:27:14,975 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:14,975 [INFO]: 	Creating the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,975 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:14
2025-03-13 18:27:14,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:27:14,977 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:14
2025-03-13 18:27:14,977 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:27:14,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.24it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.84it/s] 58%|█████▊    | 11/19 [00:00<00:00, 37.84it/s] 84%|████████▍ | 16/19 [00:00<00:00, 41.82it/s]100%|██████████| 19/19 [00:03<00:00,  4.91it/s]
2025-03-13 18:27:18,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:18
2025-03-13 18:28:00,082 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2325 secs
2025-03-13 18:28:00,083 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:28:00,083 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-13 18:28:24,877 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7938 secs
2025-03-13 18:28:24,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9035 secs
2025-03-13 18:28:24,880 [INFO]: {
2025-03-13 18:28:24,880 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:24,880 [INFO]: 	index_param: efSearch=197
2025-03-13 18:28:24,880 [INFO]: 	index_path: knn.index
2025-03-13 18:28:24,880 [INFO]: 	size in bytes: 926467630
2025-03-13 18:28:24,880 [INFO]: 	avg_search_speed_ms: 10.04458122524848
2025-03-13 18:28:24,880 [INFO]: 	99p_search_speed_ms: 13.828149321489034
2025-03-13 18:28:24,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:24,880 [INFO]: 	nb vectors: 4709
2025-03-13 18:28:24,880 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:24,880 [INFO]: 	compression ratio: 0.9993086018558468
2025-03-13 18:28:24,880 [INFO]: }
2025-03-13 18:28:24,880 [INFO]: 	>>> Finished "Creating the index" in 69.9050 secs
2025-03-13 18:28:24,880 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9428 secs
2025-03-13 18:28:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 70930 [episode count 8/20]
[retrieval_preprocessing] for episode 63765 [episode count 9/20], we have num_retrieval=np.int64(4885) num_query=np.int64(215)
2025-03-13 18:28:27,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:28,243 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:28
2025-03-13 18:28:28,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.16it/s]
2025-03-13 18:28:28,269 [INFO]: There are 4885 embeddings of dim 49152
2025-03-13 18:28:28,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:28:28,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:28
2025-03-13 18:28:28,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:28,269 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:28:28,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:28,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:28,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:28
2025-03-13 18:28:28,269 [INFO]: 1008.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:28,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:28:28,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:28
2025-03-13 18:28:28,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:28,270 [INFO]: 	Creating the index 03/13/2025, 18:28:28
2025-03-13 18:28:28,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:28
2025-03-13 18:28:28,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:28:28,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:28
2025-03-13 18:28:28,271 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:28:28,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.79it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.69it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.87it/s] 95%|█████████▌| 19/20 [00:00<00:00, 47.24it/s]100%|██████████| 20/20 [00:03<00:00,  6.26it/s]
2025-03-13 18:28:31,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:31
2025-03-13 18:29:07,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2070 secs
2025-03-13 18:29:07,674 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 18:29:07,674 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 18:29:44,350 [INFO]: 	>>> Finished "Compute fast metrics" in 36.6764 secs
2025-03-13 18:29:44,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0833 secs
2025-03-13 18:29:44,354 [INFO]: {
2025-03-13 18:29:44,354 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:44,354 [INFO]: 	index_param: efSearch=223
2025-03-13 18:29:44,354 [INFO]: 	index_path: knn.index
2025-03-13 18:29:44,354 [INFO]: 	size in bytes: 961094470
2025-03-13 18:29:44,355 [INFO]: 	avg_search_speed_ms: 10.562144357065936
2025-03-13 18:29:44,355 [INFO]: 	99p_search_speed_ms: 14.898702716454862
2025-03-13 18:29:44,355 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:44,355 [INFO]: 	nb vectors: 4885
2025-03-13 18:29:44,355 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:44,355 [INFO]: 	compression ratio: 0.9993087151984134
2025-03-13 18:29:44,355 [INFO]: }
2025-03-13 18:29:44,355 [INFO]: 	>>> Finished "Creating the index" in 76.0850 secs
2025-03-13 18:29:44,355 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1120 secs
2025-03-13 18:29:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 63765 [episode count 9/20]
[retrieval_preprocessing] for episode 51017 [episode count 10/20], we have num_retrieval=np.int64(4846) num_query=np.int64(254)
2025-03-13 18:29:46,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:47,365 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:47
2025-03-13 18:29:47,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.25it/s]
2025-03-13 18:29:47,402 [INFO]: There are 4846 embeddings of dim 49152
2025-03-13 18:29:47,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 18:29:47,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:47
2025-03-13 18:29:47,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:47,403 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:29:47,404 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:47,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:29:47,404 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:47
2025-03-13 18:29:47,404 [INFO]: 1000.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:47,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:29:47,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:47
2025-03-13 18:29:47,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:47,405 [INFO]: 	Creating the index 03/13/2025, 18:29:47
2025-03-13 18:29:47,405 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:47
2025-03-13 18:29:47,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:29:47,408 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:47
2025-03-13 18:29:47,409 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:29:47,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.72it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.77it/s] 60%|██████    | 12/20 [00:00<00:00, 41.62it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.49it/s]100%|██████████| 20/20 [00:04<00:00,  4.51it/s]
2025-03-13 18:29:51,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:51
2025-03-13 18:30:38,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5865 secs
2025-03-13 18:30:38,432 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:30:38,432 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-13 18:31:01,034 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6018 secs
2025-03-13 18:31:01,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.6288 secs
2025-03-13 18:31:01,037 [INFO]: {
2025-03-13 18:31:01,037 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:01,037 [INFO]: 	index_param: efSearch=161
2025-03-13 18:31:01,037 [INFO]: 	index_path: knn.index
2025-03-13 18:31:01,037 [INFO]: 	size in bytes: 953421550
2025-03-13 18:31:01,037 [INFO]: 	avg_search_speed_ms: 6.744950679042873
2025-03-13 18:31:01,037 [INFO]: 	99p_search_speed_ms: 9.568390983622521
2025-03-13 18:31:01,037 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:01,037 [INFO]: 	nb vectors: 4846
2025-03-13 18:31:01,037 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:01,037 [INFO]: 	compression ratio: 0.9993086143269995
2025-03-13 18:31:01,038 [INFO]: }
2025-03-13 18:31:01,038 [INFO]: 	>>> Finished "Creating the index" in 73.6328 secs
2025-03-13 18:31:01,038 [INFO]: >>> Finished "Launching the whole pipeline" in 73.6722 secs
2025-03-13 18:31:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 51017 [episode count 10/20]
[retrieval_preprocessing] for episode 7514 [episode count 11/20], we have num_retrieval=np.int64(4922) num_query=np.int64(178)
2025-03-13 18:31:02,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:03,640 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:03
2025-03-13 18:31:03,640 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.54it/s]
2025-03-13 18:31:04,108 [INFO]: There are 4922 embeddings of dim 49152
2025-03-13 18:31:04,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4687 secs
2025-03-13 18:31:04,109 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:04
2025-03-13 18:31:04,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:04,110 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:31:04,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:04,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:31:04,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:04
2025-03-13 18:31:04,110 [INFO]: 1015.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:04,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:31:04,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:04
2025-03-13 18:31:04,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:04,110 [INFO]: 	Creating the index 03/13/2025, 18:31:04
2025-03-13 18:31:04,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:04
2025-03-13 18:31:04,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:31:04,113 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:04
2025-03-13 18:31:04,113 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:31:04,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.94it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.64it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.16it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.73it/s]100%|██████████| 20/20 [00:03<00:00,  5.15it/s]
2025-03-13 18:31:08,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:08
2025-03-13 18:31:50,097 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0971 secs
2025-03-13 18:31:50,098 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 18:31:50,098 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.90it/s]
2025-03-13 18:32:13,787 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6886 secs
2025-03-13 18:32:13,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6764 secs
2025-03-13 18:32:13,790 [INFO]: {
2025-03-13 18:32:13,790 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:13,790 [INFO]: 	index_param: efSearch=127
2025-03-13 18:32:13,790 [INFO]: 	index_path: knn.index
2025-03-13 18:32:13,790 [INFO]: 	size in bytes: 968373970
2025-03-13 18:32:13,790 [INFO]: 	avg_search_speed_ms: 6.105373754684606
2025-03-13 18:32:13,790 [INFO]: 	99p_search_speed_ms: 9.25421928055584
2025-03-13 18:32:13,790 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:13,790 [INFO]: 	nb vectors: 4922
2025-03-13 18:32:13,790 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:13,790 [INFO]: 	compression ratio: 0.9993087443273594
2025-03-13 18:32:13,790 [INFO]: }
2025-03-13 18:32:13,790 [INFO]: 	>>> Finished "Creating the index" in 69.6795 secs
2025-03-13 18:32:13,790 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1502 secs
2025-03-13 18:32:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 7514 [episode count 11/20]
[retrieval_preprocessing] for episode 30458 [episode count 12/20], we have num_retrieval=np.int64(4780) num_query=np.int64(320)
2025-03-13 18:32:15,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:15,952 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:15
2025-03-13 18:32:15,952 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1108.14it/s]
2025-03-13 18:32:15,981 [INFO]: There are 4780 embeddings of dim 49152
2025-03-13 18:32:15,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:32:15,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:15
2025-03-13 18:32:15,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:15,982 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:32:15,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:15,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:32:15,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:15
2025-03-13 18:32:15,983 [INFO]: 986.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:15,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:32:15,984 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:15
2025-03-13 18:32:15,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:15,984 [INFO]: 	Creating the index 03/13/2025, 18:32:15
2025-03-13 18:32:15,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:15
2025-03-13 18:32:15,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:32:15,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:15
2025-03-13 18:32:15,988 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:32:15,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.46it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.41it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.58it/s] 89%|████████▉ | 17/19 [00:00<00:00, 39.92it/s]100%|██████████| 19/19 [00:04<00:00,  4.36it/s]
2025-03-13 18:32:20,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:20
2025-03-13 18:33:03,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4941 secs
2025-03-13 18:33:03,425 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 18:33:03,426 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 18:33:34,263 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8375 secs
2025-03-13 18:33:34,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2784 secs
2025-03-13 18:33:34,266 [INFO]: {
2025-03-13 18:33:34,266 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:34,266 [INFO]: 	index_param: efSearch=129
2025-03-13 18:33:34,266 [INFO]: 	index_path: knn.index
2025-03-13 18:33:34,266 [INFO]: 	size in bytes: 940436410
2025-03-13 18:33:34,266 [INFO]: 	avg_search_speed_ms: 6.4392969879116055
2025-03-13 18:33:34,266 [INFO]: 	99p_search_speed_ms: 11.41203775070608
2025-03-13 18:33:34,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:34,266 [INFO]: 	nb vectors: 4780
2025-03-13 18:33:34,266 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:34,266 [INFO]: 	compression ratio: 0.9993086507571523
2025-03-13 18:33:34,266 [INFO]: }
2025-03-13 18:33:34,266 [INFO]: 	>>> Finished "Creating the index" in 78.2823 secs
2025-03-13 18:33:34,266 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3138 secs
2025-03-13 18:33:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 30458 [episode count 12/20]
[retrieval_preprocessing] for episode 27956 [episode count 13/20], we have num_retrieval=np.int64(4649) num_query=np.int64(451)
2025-03-13 18:33:37,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:37,913 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:37
2025-03-13 18:33:37,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.29it/s]
2025-03-13 18:33:37,947 [INFO]: There are 4649 embeddings of dim 49152
2025-03-13 18:33:37,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 18:33:37,947 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:37
2025-03-13 18:33:37,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:37,947 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 18:33:37,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:37,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:33:37,948 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:37
2025-03-13 18:33:37,948 [INFO]: 959.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:37,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:33:37,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:37
2025-03-13 18:33:37,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:37,948 [INFO]: 	Creating the index 03/13/2025, 18:33:37
2025-03-13 18:33:37,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:37
2025-03-13 18:33:37,949 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:33:37,949 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:37
2025-03-13 18:33:37,949 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:33:37,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.99it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.39it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.78it/s] 89%|████████▉ | 17/19 [00:00<00:00, 43.85it/s]100%|██████████| 19/19 [00:03<00:00,  5.35it/s]
2025-03-13 18:33:41,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:41
2025-03-13 18:34:20,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7825 secs
2025-03-13 18:34:20,285 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 18:34:20,285 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 18:34:46,430 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1451 secs
2025-03-13 18:34:46,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4844 secs
2025-03-13 18:34:46,433 [INFO]: {
2025-03-13 18:34:46,433 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:46,433 [INFO]: 	index_param: efSearch=148
2025-03-13 18:34:46,433 [INFO]: 	index_path: knn.index
2025-03-13 18:34:46,434 [INFO]: 	size in bytes: 914662810
2025-03-13 18:34:46,434 [INFO]: 	avg_search_speed_ms: 7.921915738430116
2025-03-13 18:34:46,434 [INFO]: 	99p_search_speed_ms: 11.465325423050672
2025-03-13 18:34:46,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:46,434 [INFO]: 	nb vectors: 4649
2025-03-13 18:34:46,434 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:46,434 [INFO]: 	compression ratio: 0.9993087966482425
2025-03-13 18:34:46,434 [INFO]: }
2025-03-13 18:34:46,434 [INFO]: 	>>> Finished "Creating the index" in 68.4858 secs
2025-03-13 18:34:46,434 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5207 secs
2025-03-13 18:34:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 27956 [episode count 13/20]
[retrieval_preprocessing] for episode 56657 [episode count 14/20], we have num_retrieval=np.int64(4855) num_query=np.int64(245)
2025-03-13 18:34:49,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:50,576 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:50
2025-03-13 18:34:50,576 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1114.32it/s]
2025-03-13 18:34:50,608 [INFO]: There are 4855 embeddings of dim 49152
2025-03-13 18:34:50,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 18:34:50,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:50
2025-03-13 18:34:50,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:50,609 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:34:50,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:50,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:34:50,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:50
2025-03-13 18:34:50,609 [INFO]: 1002.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:50,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:34:50,610 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:50
2025-03-13 18:34:50,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:50,610 [INFO]: 	Creating the index 03/13/2025, 18:34:50
2025-03-13 18:34:50,610 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:50
2025-03-13 18:34:50,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:34:50,614 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:50
2025-03-13 18:34:50,614 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:34:50,614 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.35it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.61it/s] 60%|██████    | 12/20 [00:00<00:00, 41.26it/s] 90%|█████████ | 18/20 [00:00<00:00, 45.60it/s]100%|██████████| 20/20 [00:03<00:00,  5.10it/s]
2025-03-13 18:34:54,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:54
2025-03-13 18:35:35,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8956 secs
2025-03-13 18:35:35,440 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 18:35:35,440 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 18:36:15,548 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1087 secs
2025-03-13 18:36:15,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9375 secs
2025-03-13 18:36:15,552 [INFO]: {
2025-03-13 18:36:15,552 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:15,552 [INFO]: 	index_param: efSearch=137
2025-03-13 18:36:15,552 [INFO]: 	index_path: knn.index
2025-03-13 18:36:15,552 [INFO]: 	size in bytes: 955192210
2025-03-13 18:36:15,552 [INFO]: 	avg_search_speed_ms: 7.556149115869022
2025-03-13 18:36:15,552 [INFO]: 	99p_search_speed_ms: 11.049639349803327
2025-03-13 18:36:15,552 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:15,552 [INFO]: 	nb vectors: 4855
2025-03-13 18:36:15,552 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:15,552 [INFO]: 	compression ratio: 0.9993086522345068
2025-03-13 18:36:15,552 [INFO]: }
2025-03-13 18:36:15,552 [INFO]: 	>>> Finished "Creating the index" in 84.9418 secs
2025-03-13 18:36:15,552 [INFO]: >>> Finished "Launching the whole pipeline" in 84.9754 secs
2025-03-13 18:36:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 56657 [episode count 14/20]
[retrieval_preprocessing] for episode 35031 [episode count 15/20], we have num_retrieval=np.int64(4893) num_query=np.int64(207)
2025-03-13 18:36:17,355 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:18,137 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:18
2025-03-13 18:36:18,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.12it/s]
2025-03-13 18:36:18,163 [INFO]: There are 4893 embeddings of dim 49152
2025-03-13 18:36:18,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:36:18,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:18
2025-03-13 18:36:18,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:18,163 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:36:18,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:18,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:18,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:18
2025-03-13 18:36:18,164 [INFO]: 1009.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:18,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:36:18,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:18
2025-03-13 18:36:18,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:18,164 [INFO]: 	Creating the index 03/13/2025, 18:36:18
2025-03-13 18:36:18,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:18
2025-03-13 18:36:18,165 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:36:18,165 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:18
2025-03-13 18:36:18,165 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:36:18,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.21it/s] 30%|███       | 6/20 [00:00<00:00, 25.17it/s] 60%|██████    | 12/20 [00:00<00:00, 37.93it/s] 90%|█████████ | 18/20 [00:00<00:00, 44.74it/s]100%|██████████| 20/20 [00:03<00:00,  5.21it/s]
2025-03-13 18:36:22,006 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:22
2025-03-13 18:37:06,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4566 secs
2025-03-13 18:37:06,464 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:37:06,464 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.99it/s]
2025-03-13 18:37:32,461 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9978 secs
2025-03-13 18:37:32,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2996 secs
2025-03-13 18:37:32,465 [INFO]: {
2025-03-13 18:37:32,465 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:32,465 [INFO]: 	index_param: efSearch=160
2025-03-13 18:37:32,465 [INFO]: 	index_path: knn.index
2025-03-13 18:37:32,465 [INFO]: 	size in bytes: 962668390
2025-03-13 18:37:32,465 [INFO]: 	avg_search_speed_ms: 8.473398533286685
2025-03-13 18:37:32,465 [INFO]: 	99p_search_speed_ms: 11.459426172077658
2025-03-13 18:37:32,465 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:32,465 [INFO]: 	nb vectors: 4893
2025-03-13 18:37:32,465 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:32,465 [INFO]: 	compression ratio: 0.999308748467372
2025-03-13 18:37:32,465 [INFO]: }
2025-03-13 18:37:32,465 [INFO]: 	>>> Finished "Creating the index" in 74.3014 secs
2025-03-13 18:37:32,465 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3284 secs
2025-03-13 18:37:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 35031 [episode count 15/20]
[retrieval_preprocessing] for episode 60638 [episode count 16/20], we have num_retrieval=np.int64(4884) num_query=np.int64(216)
2025-03-13 18:37:34,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:35,287 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:35
2025-03-13 18:37:35,287 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-13 18:37:35,322 [INFO]: There are 4884 embeddings of dim 49152
2025-03-13 18:37:35,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 18:37:35,323 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:35
2025-03-13 18:37:35,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:35,323 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:37:35,323 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:35,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:37:35,324 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:35
2025-03-13 18:37:35,324 [INFO]: 1007.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:35,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:37:35,324 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:35
2025-03-13 18:37:35,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:35,325 [INFO]: 	Creating the index 03/13/2025, 18:37:35
2025-03-13 18:37:35,325 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:35
2025-03-13 18:37:35,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:37:35,328 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:35
2025-03-13 18:37:35,329 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:37:35,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.30it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.12it/s] 60%|██████    | 12/20 [00:00<00:00, 40.84it/s] 85%|████████▌ | 17/20 [00:00<00:00, 43.56it/s]100%|██████████| 20/20 [00:04<00:00,  4.99it/s]
2025-03-13 18:37:39,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:39
2025-03-13 18:38:21,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9785 secs
2025-03-13 18:38:21,325 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:38:21,325 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-13 18:39:00,241 [INFO]: 	>>> Finished "Compute fast metrics" in 38.9155 secs
2025-03-13 18:39:00,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9159 secs
2025-03-13 18:39:00,245 [INFO]: {
2025-03-13 18:39:00,245 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:00,245 [INFO]: 	index_param: efSearch=240
2025-03-13 18:39:00,245 [INFO]: 	index_path: knn.index
2025-03-13 18:39:00,245 [INFO]: 	size in bytes: 960897730
2025-03-13 18:39:00,245 [INFO]: 	avg_search_speed_ms: 12.210399873033893
2025-03-13 18:39:00,245 [INFO]: 	99p_search_speed_ms: 18.046606536954638
2025-03-13 18:39:00,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:00,245 [INFO]: 	nb vectors: 4884
2025-03-13 18:39:00,245 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:00,245 [INFO]: 	compression ratio: 0.9993087110321304
2025-03-13 18:39:00,245 [INFO]: }
2025-03-13 18:39:00,245 [INFO]: 	>>> Finished "Creating the index" in 84.9201 secs
2025-03-13 18:39:00,245 [INFO]: >>> Finished "Launching the whole pipeline" in 84.9582 secs
2025-03-13 18:39:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 60638 [episode count 16/20]
[retrieval_preprocessing] for episode 65449 [episode count 17/20], we have num_retrieval=np.int64(4925) num_query=np.int64(175)
2025-03-13 18:39:03,724 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:04,414 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:04
2025-03-13 18:39:04,414 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.12it/s]
2025-03-13 18:39:04,444 [INFO]: There are 4925 embeddings of dim 49152
2025-03-13 18:39:04,445 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 18:39:04,445 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:04
2025-03-13 18:39:04,445 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:04,446 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:39:04,446 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:04,446 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:39:04,446 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:04
2025-03-13 18:39:04,447 [INFO]: 1016.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:04,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:39:04,447 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:04
2025-03-13 18:39:04,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:04,447 [INFO]: 	Creating the index 03/13/2025, 18:39:04
2025-03-13 18:39:04,448 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:04
2025-03-13 18:39:04,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:39:04,451 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:04
2025-03-13 18:39:04,451 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:39:04,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.55it/s] 35%|███▌      | 7/20 [00:00<00:00, 36.17it/s] 60%|██████    | 12/20 [00:00<00:00, 42.16it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.90it/s]100%|██████████| 20/20 [00:04<00:00,  4.58it/s]
2025-03-13 18:39:08,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:08
2025-03-13 18:40:01,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3645 secs
2025-03-13 18:40:01,194 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 18:40:01,194 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-13 18:40:27,782 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5882 secs
2025-03-13 18:40:28,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.1693 secs
2025-03-13 18:40:28,621 [INFO]: {
2025-03-13 18:40:28,621 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:28,621 [INFO]: 	index_param: efSearch=178
2025-03-13 18:40:28,621 [INFO]: 	index_path: knn.index
2025-03-13 18:40:28,621 [INFO]: 	size in bytes: 968964250
2025-03-13 18:40:28,621 [INFO]: 	avg_search_speed_ms: 8.740087051562737
2025-03-13 18:40:28,621 [INFO]: 	99p_search_speed_ms: 11.7320236749947
2025-03-13 18:40:28,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:28,622 [INFO]: 	nb vectors: 4925
2025-03-13 18:40:28,622 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:28,622 [INFO]: 	compression ratio: 0.9993086948254283
2025-03-13 18:40:28,622 [INFO]: }
2025-03-13 18:40:28,622 [INFO]: 	>>> Finished "Creating the index" in 84.1741 secs
2025-03-13 18:40:28,622 [INFO]: >>> Finished "Launching the whole pipeline" in 84.2080 secs
2025-03-13 18:40:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 65449 [episode count 17/20]
[retrieval_preprocessing] for episode 78207 [episode count 18/20], we have num_retrieval=np.int64(4873) num_query=np.int64(227)
2025-03-13 18:40:30,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:31,542 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:31
2025-03-13 18:40:31,542 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.87it/s]
2025-03-13 18:40:31,583 [INFO]: There are 4873 embeddings of dim 49152
2025-03-13 18:40:31,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0411 secs
2025-03-13 18:40:31,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:31,584 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:40:31,584 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:31,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:40:31,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,584 [INFO]: 1005.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:31,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:40:31,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:31
2025-03-13 18:40:31,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:31,585 [INFO]: 	Creating the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,585 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:31
2025-03-13 18:40:31,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:40:31,587 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:31
2025-03-13 18:40:31,587 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:40:31,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 16.57it/s] 35%|███▌      | 7/20 [00:00<00:00, 31.76it/s] 60%|██████    | 12/20 [00:00<00:00, 37.40it/s] 85%|████████▌ | 17/20 [00:00<00:00, 39.10it/s]100%|██████████| 20/20 [00:04<00:00,  4.35it/s]
2025-03-13 18:40:36,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:36
2025-03-13 18:41:18,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2628 secs
2025-03-13 18:41:18,457 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:41:18,457 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.84it/s]
2025-03-13 18:41:51,837 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3794 secs
2025-03-13 18:41:51,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.2520 secs
2025-03-13 18:41:51,839 [INFO]: {
2025-03-13 18:41:51,839 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:51,840 [INFO]: 	index_param: efSearch=213
2025-03-13 18:41:51,840 [INFO]: 	index_path: knn.index
2025-03-13 18:41:51,840 [INFO]: 	size in bytes: 958733530
2025-03-13 18:41:51,840 [INFO]: 	avg_search_speed_ms: 11.033846596081148
2025-03-13 18:41:51,840 [INFO]: 	99p_search_speed_ms: 16.128204204142094
2025-03-13 18:41:51,840 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:51,840 [INFO]: 	nb vectors: 4873
2025-03-13 18:41:51,840 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:51,840 [INFO]: 	compression ratio: 0.9993087276294592
2025-03-13 18:41:51,840 [INFO]: }
2025-03-13 18:41:51,840 [INFO]: 	>>> Finished "Creating the index" in 80.2551 secs
2025-03-13 18:41:51,840 [INFO]: >>> Finished "Launching the whole pipeline" in 80.2976 secs
2025-03-13 18:41:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 78207 [episode count 18/20]
[retrieval_preprocessing] for episode 68497 [episode count 19/20], we have num_retrieval=np.int64(4886) num_query=np.int64(214)
2025-03-13 18:41:53,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:54,439 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:54
2025-03-13 18:41:54,439 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.71it/s]
2025-03-13 18:41:54,469 [INFO]: There are 4886 embeddings of dim 49152
2025-03-13 18:41:54,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:41:54,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:54
2025-03-13 18:41:54,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:54,470 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 18:41:54,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:54,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:41:54,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:54
2025-03-13 18:41:54,470 [INFO]: 1008.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:54,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:54,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:54
2025-03-13 18:41:54,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:54,470 [INFO]: 	Creating the index 03/13/2025, 18:41:54
2025-03-13 18:41:54,471 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:54
2025-03-13 18:41:54,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:41:54,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:54
2025-03-13 18:41:54,472 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 18:41:54,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.95it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.78it/s] 60%|██████    | 12/20 [00:00<00:00, 40.55it/s] 85%|████████▌ | 17/20 [00:00<00:00, 43.47it/s]100%|██████████| 20/20 [00:03<00:00,  5.27it/s]
2025-03-13 18:41:58,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:58
2025-03-13 18:42:44,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5996 secs
2025-03-13 18:42:44,878 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 18:42:44,878 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.91it/s]
2025-03-13 18:43:07,948 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0699 secs
2025-03-13 18:43:07,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4780 secs
2025-03-13 18:43:07,951 [INFO]: {
2025-03-13 18:43:07,951 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:07,951 [INFO]: 	index_param: efSearch=127
2025-03-13 18:43:07,951 [INFO]: 	index_path: knn.index
2025-03-13 18:43:07,951 [INFO]: 	size in bytes: 961291210
2025-03-13 18:43:07,951 [INFO]: 	avg_search_speed_ms: 6.3674021595317845
2025-03-13 18:43:07,951 [INFO]: 	99p_search_speed_ms: 9.917919789440917
2025-03-13 18:43:07,951 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:07,951 [INFO]: 	nb vectors: 4886
2025-03-13 18:43:07,951 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:07,951 [INFO]: 	compression ratio: 0.9993087193629909
2025-03-13 18:43:07,951 [INFO]: }
2025-03-13 18:43:07,951 [INFO]: 	>>> Finished "Creating the index" in 73.4803 secs
2025-03-13 18:43:07,951 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5117 secs
2025-03-13 18:43:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 68497 [episode count 19/20]
2025-03-13 18:43:09: [retrieval_preprocessing] finished for 8702636502_lid_on_pot [chosen_id count 9/196]
2025-03-13 18:43:09: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
