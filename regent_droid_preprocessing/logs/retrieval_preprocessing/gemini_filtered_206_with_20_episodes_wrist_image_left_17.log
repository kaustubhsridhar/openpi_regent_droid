2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:04: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8756300955_put_blue_object_in_drawer_and_close [chosen_id count 0/196]
2025-03-13 14:35:04: [retrieval_preprocessing] we have num_total=2811 embedding_dim=49152
[retrieval_preprocessing] for episode 64534 [episode count 0/20], we have num_retrieval=np.int64(2622) num_query=np.int64(189)
2025-03-13 14:35:06,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:07,339 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:07
2025-03-13 14:35:07,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 616.27it/s]
2025-03-13 14:35:07,370 [INFO]: There are 2622 embeddings of dim 49152
2025-03-13 14:35:07,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 14:35:07,370 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,371 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:07,371 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:35:07,371 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:07,371 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:35:07,371 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,373 [INFO]: 541.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:07,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0014 secs
2025-03-13 14:35:07,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:07
2025-03-13 14:35:07,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:07,373 [INFO]: 	Creating the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,373 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:07
2025-03-13 14:35:07,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:35:07,376 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:07
2025-03-13 14:35:07,377 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:35:07,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.83it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.30it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.94it/s] 45%|████▌     | 5/11 [00:00<00:00,  6.92it/s] 55%|█████▍    | 6/11 [00:00<00:00,  6.93it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.79it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.59it/s]100%|██████████| 11/11 [00:04<00:00,  2.49it/s]
2025-03-13 14:35:11,806 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:11
2025-03-13 14:35:55,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6461 secs
2025-03-13 14:35:55,454 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 14:35:55,454 [INFO]: 	Compute fast metrics 03/13/2025, 14:35:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-13 14:36:12,238 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7835 secs
2025-03-13 14:36:12,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8643 secs
2025-03-13 14:36:12,241 [INFO]: {
2025-03-13 14:36:12,241 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:12,241 [INFO]: 	index_param: efSearch=128
2025-03-13 14:36:12,241 [INFO]: 	index_path: knn.index
2025-03-13 14:36:12,241 [INFO]: 	size in bytes: 515862430
2025-03-13 14:36:12,241 [INFO]: 	avg_search_speed_ms: 8.095768199449306
2025-03-13 14:36:12,241 [INFO]: 	99p_search_speed_ms: 12.08591816481203
2025-03-13 14:36:12,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:12,241 [INFO]: 	nb vectors: 2622
2025-03-13 14:36:12,241 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:12,241 [INFO]: 	compression ratio: 0.999309401151776
2025-03-13 14:36:12,241 [INFO]: }
2025-03-13 14:36:12,241 [INFO]: 	>>> Finished "Creating the index" in 64.8682 secs
2025-03-13 14:36:12,241 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9026 secs
2025-03-13 14:36:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 64534 [episode count 0/20]
[retrieval_preprocessing] for episode 90157 [episode count 1/20], we have num_retrieval=np.int64(2705) num_query=np.int64(106)
2025-03-13 14:36:13,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:14,454 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:14
2025-03-13 14:36:14,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.21it/s]
2025-03-13 14:36:14,488 [INFO]: There are 2705 embeddings of dim 49152
2025-03-13 14:36:14,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 14:36:14,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:14
2025-03-13 14:36:14,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:14,488 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:36:14,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:14,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:14,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:14
2025-03-13 14:36:14,489 [INFO]: 558.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:14,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:14,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:14
2025-03-13 14:36:14,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:14,489 [INFO]: 	Creating the index 03/13/2025, 14:36:14
2025-03-13 14:36:14,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:14
2025-03-13 14:36:14,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:36:14,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:14
2025-03-13 14:36:14,490 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:36:14,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.21it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.00it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.54it/s]
2025-03-13 14:36:16,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:16
2025-03-13 14:36:51,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8620 secs
2025-03-13 14:36:51,778 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 14:36:51,778 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.47it/s]
2025-03-13 14:37:06,317 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5391 secs
2025-03-13 14:37:06,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8289 secs
2025-03-13 14:37:06,319 [INFO]: {
2025-03-13 14:37:06,319 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:06,319 [INFO]: 	index_param: efSearch=197
2025-03-13 14:37:06,319 [INFO]: 	index_path: knn.index
2025-03-13 14:37:06,319 [INFO]: 	size in bytes: 532192030
2025-03-13 14:37:06,319 [INFO]: 	avg_search_speed_ms: 10.426100860597474
2025-03-13 14:37:06,320 [INFO]: 	99p_search_speed_ms: 15.64330204389989
2025-03-13 14:37:06,320 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:06,320 [INFO]: 	nb vectors: 2705
2025-03-13 14:37:06,320 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:06,320 [INFO]: 	compression ratio: 0.9993096664750879
2025-03-13 14:37:06,320 [INFO]: }
2025-03-13 14:37:06,320 [INFO]: 	>>> Finished "Creating the index" in 51.8307 secs
2025-03-13 14:37:06,320 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8656 secs
2025-03-13 14:37:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 90157 [episode count 1/20]
[retrieval_preprocessing] for episode 55347 [episode count 2/20], we have num_retrieval=np.int64(2645) num_query=np.int64(166)
2025-03-13 14:37:07,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:08,081 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:08
2025-03-13 14:37:08,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 923.25it/s]
2025-03-13 14:37:08,126 [INFO]: There are 2645 embeddings of dim 49152
2025-03-13 14:37:08,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0448 secs
2025-03-13 14:37:08,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:08
2025-03-13 14:37:08,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:08,127 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:37:08,127 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:08,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:37:08,127 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:08
2025-03-13 14:37:08,128 [INFO]: 545.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:08,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:37:08,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:08
2025-03-13 14:37:08,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:37:08,129 [INFO]: 	Creating the index 03/13/2025, 14:37:08
2025-03-13 14:37:08,129 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:08
2025-03-13 14:37:08,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:37:08,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:08
2025-03-13 14:37:08,133 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:37:08,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.46it/s] 36%|███▋      | 4/11 [00:00<00:00, 16.39it/s] 73%|███████▎  | 8/11 [00:00<00:00, 24.36it/s]100%|██████████| 11/11 [00:03<00:00,  2.52it/s]100%|██████████| 11/11 [00:03<00:00,  3.42it/s]
2025-03-13 14:37:11,355 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:11
2025-03-13 14:37:49,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8053 secs
2025-03-13 14:37:49,161 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 14:37:49,161 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.37it/s]
2025-03-13 14:38:07,528 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3666 secs
2025-03-13 14:38:07,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3983 secs
2025-03-13 14:38:07,531 [INFO]: {
2025-03-13 14:38:07,531 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:07,531 [INFO]: 	index_param: efSearch=134
2025-03-13 14:38:07,531 [INFO]: 	index_path: knn.index
2025-03-13 14:38:07,531 [INFO]: 	size in bytes: 520387510
2025-03-13 14:38:07,531 [INFO]: 	avg_search_speed_ms: 7.9283456925175715
2025-03-13 14:38:07,531 [INFO]: 	99p_search_speed_ms: 12.581368954852339
2025-03-13 14:38:07,531 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:07,531 [INFO]: 	nb vectors: 2645
2025-03-13 14:38:07,531 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:07,531 [INFO]: 	compression ratio: 0.999309456908372
2025-03-13 14:38:07,531 [INFO]: }
2025-03-13 14:38:07,531 [INFO]: 	>>> Finished "Creating the index" in 59.4023 secs
2025-03-13 14:38:07,531 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4500 secs
2025-03-13 14:38:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 55347 [episode count 2/20]
[retrieval_preprocessing] for episode 5688 [episode count 3/20], we have num_retrieval=np.int64(2650) num_query=np.int64(161)
2025-03-13 14:38:08,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:09,234 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:09
2025-03-13 14:38:09,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 931.45it/s]
2025-03-13 14:38:09,266 [INFO]: There are 2650 embeddings of dim 49152
2025-03-13 14:38:09,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 14:38:09,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:09
2025-03-13 14:38:09,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:09,267 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:38:09,267 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:09,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:38:09,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:09
2025-03-13 14:38:09,267 [INFO]: 546.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:09,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:38:09,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:09
2025-03-13 14:38:09,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:09,267 [INFO]: 	Creating the index 03/13/2025, 14:38:09
2025-03-13 14:38:09,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:09
2025-03-13 14:38:09,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:38:09,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:09
2025-03-13 14:38:09,268 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:38:09,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.39it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.99it/s]100%|██████████| 11/11 [00:02<00:00,  3.66it/s]100%|██████████| 11/11 [00:02<00:00,  4.32it/s]
2025-03-13 14:38:11,820 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:38:11
2025-03-13 14:38:47,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6345 secs
2025-03-13 14:38:47,456 [INFO]: The best hyperparameters are: efSearch=102
2025-03-13 14:38:47,456 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.33it/s]
2025-03-13 14:39:05,448 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9915 secs
2025-03-13 14:39:05,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1830 secs
2025-03-13 14:39:05,452 [INFO]: {
2025-03-13 14:39:05,452 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:05,452 [INFO]: 	index_param: efSearch=102
2025-03-13 14:39:05,452 [INFO]: 	index_path: knn.index
2025-03-13 14:39:05,452 [INFO]: 	size in bytes: 521371210
2025-03-13 14:39:05,452 [INFO]: 	avg_search_speed_ms: 10.83428175001933
2025-03-13 14:39:05,452 [INFO]: 	99p_search_speed_ms: 17.66958639491349
2025-03-13 14:39:05,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:05,452 [INFO]: 	nb vectors: 2650
2025-03-13 14:39:05,452 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:05,452 [INFO]: 	compression ratio: 0.9993094939016675
2025-03-13 14:39:05,452 [INFO]: }
2025-03-13 14:39:05,452 [INFO]: 	>>> Finished "Creating the index" in 56.1848 secs
2025-03-13 14:39:05,452 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2181 secs
2025-03-13 14:39:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 5688 [episode count 3/20]
[retrieval_preprocessing] for episode 39992 [episode count 4/20], we have num_retrieval=np.int64(2687) num_query=np.int64(124)
2025-03-13 14:39:07,334 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:07,849 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:07
2025-03-13 14:39:07,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-13 14:39:07,892 [INFO]: There are 2687 embeddings of dim 49152
2025-03-13 14:39:07,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0434 secs
2025-03-13 14:39:07,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:07
2025-03-13 14:39:07,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:07,893 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:39:07,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:39:07,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 14:39:07,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:07
2025-03-13 14:39:07,894 [INFO]: 554.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:07,895 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:39:07,895 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:07
2025-03-13 14:39:07,895 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:39:07,895 [INFO]: 	Creating the index 03/13/2025, 14:39:07
2025-03-13 14:39:07,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:39:07
2025-03-13 14:39:07,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 14:39:07,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:07
2025-03-13 14:39:07,900 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:39:07,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.20it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.23it/s] 91%|█████████ | 10/11 [00:00<00:00, 30.72it/s]100%|██████████| 11/11 [00:03<00:00,  3.21it/s]
2025-03-13 14:39:11,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:11
2025-03-13 14:39:47,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9599 secs
2025-03-13 14:39:47,292 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 14:39:47,292 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 14:40:01,997 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7045 secs
2025-03-13 14:40:02,000 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1006 secs
2025-03-13 14:40:02,000 [INFO]: {
2025-03-13 14:40:02,000 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:02,000 [INFO]: 	index_param: efSearch=148
2025-03-13 14:40:02,000 [INFO]: 	index_path: knn.index
2025-03-13 14:40:02,000 [INFO]: 	size in bytes: 528650590
2025-03-13 14:40:02,000 [INFO]: 	avg_search_speed_ms: 11.54551010736959
2025-03-13 14:40:02,001 [INFO]: 	99p_search_speed_ms: 17.74023537291214
2025-03-13 14:40:02,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:02,001 [INFO]: 	nb vectors: 2687
2025-03-13 14:40:02,001 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:02,001 [INFO]: 	compression ratio: 0.9993097633731951
2025-03-13 14:40:02,001 [INFO]: }
2025-03-13 14:40:02,001 [INFO]: 	>>> Finished "Creating the index" in 54.1053 secs
2025-03-13 14:40:02,001 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1518 secs
2025-03-13 14:40:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 39992 [episode count 4/20]
[retrieval_preprocessing] for episode 52822 [episode count 5/20], we have num_retrieval=np.int64(2685) num_query=np.int64(126)
2025-03-13 14:40:03,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:04,154 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:04
2025-03-13 14:40:04,154 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 885.25it/s]
2025-03-13 14:40:04,205 [INFO]: There are 2685 embeddings of dim 49152
2025-03-13 14:40:04,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0506 secs
2025-03-13 14:40:04,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:04
2025-03-13 14:40:04,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:04,205 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:40:04,205 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:04,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:04,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:04
2025-03-13 14:40:04,205 [INFO]: 554.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:04,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:40:04,205 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:04
2025-03-13 14:40:04,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:04,205 [INFO]: 	Creating the index 03/13/2025, 14:40:04
2025-03-13 14:40:04,205 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:04
2025-03-13 14:40:04,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:40:04,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:04
2025-03-13 14:40:04,207 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:40:04,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.57it/s] 45%|████▌     | 5/11 [00:00<00:00, 18.49it/s] 73%|███████▎  | 8/11 [00:00<00:00, 22.51it/s]100%|██████████| 11/11 [00:04<00:00,  1.94it/s]100%|██████████| 11/11 [00:04<00:00,  2.72it/s]
2025-03-13 14:40:08,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:08
2025-03-13 14:40:42,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1223 secs
2025-03-13 14:40:42,372 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 14:40:42,372 [INFO]: 	Compute fast metrics 03/13/2025, 14:40:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.54it/s]
2025-03-13 14:40:57,377 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0051 secs
2025-03-13 14:40:57,379 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1725 secs
2025-03-13 14:40:57,380 [INFO]: {
2025-03-13 14:40:57,380 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:57,380 [INFO]: 	index_param: efSearch=169
2025-03-13 14:40:57,380 [INFO]: 	index_path: knn.index
2025-03-13 14:40:57,380 [INFO]: 	size in bytes: 528257110
2025-03-13 14:40:57,380 [INFO]: 	avg_search_speed_ms: 9.275117190554738
2025-03-13 14:40:57,380 [INFO]: 	99p_search_speed_ms: 14.986373328138146
2025-03-13 14:40:57,380 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:57,380 [INFO]: 	nb vectors: 2685
2025-03-13 14:40:57,380 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:57,380 [INFO]: 	compression ratio: 0.9993097489970367
2025-03-13 14:40:57,380 [INFO]: }
2025-03-13 14:40:57,380 [INFO]: 	>>> Finished "Creating the index" in 53.1743 secs
2025-03-13 14:40:57,380 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2257 secs
2025-03-13 14:40:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 52822 [episode count 5/20]
[retrieval_preprocessing] for episode 26728 [episode count 6/20], we have num_retrieval=np.int64(2698) num_query=np.int64(113)
2025-03-13 14:40:58,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:58,870 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:58
2025-03-13 14:40:58,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.46it/s]
2025-03-13 14:40:58,903 [INFO]: There are 2698 embeddings of dim 49152
2025-03-13 14:40:58,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 14:40:58,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:58
2025-03-13 14:40:58,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:58,904 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:40:58,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:58,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:40:58,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:58
2025-03-13 14:40:58,904 [INFO]: 556.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:58,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:40:58,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:58
2025-03-13 14:40:58,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:58,904 [INFO]: 	Creating the index 03/13/2025, 14:40:58
2025-03-13 14:40:58,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:58
2025-03-13 14:40:58,905 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:40:58,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:58
2025-03-13 14:40:58,905 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:40:58,905 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.29it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]
2025-03-13 14:41:01,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:01
2025-03-13 14:41:43,713 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3081 secs
2025-03-13 14:41:43,713 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 14:41:43,713 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.44it/s]
2025-03-13 14:41:57,397 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6835 secs
2025-03-13 14:41:57,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4945 secs
2025-03-13 14:41:57,400 [INFO]: {
2025-03-13 14:41:57,400 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:57,400 [INFO]: 	index_param: efSearch=208
2025-03-13 14:41:57,400 [INFO]: 	index_path: knn.index
2025-03-13 14:41:57,400 [INFO]: 	size in bytes: 530814790
2025-03-13 14:41:57,400 [INFO]: 	avg_search_speed_ms: 12.651416129584502
2025-03-13 14:41:57,400 [INFO]: 	99p_search_speed_ms: 22.153694019652914
2025-03-13 14:41:57,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:57,400 [INFO]: 	nb vectors: 2698
2025-03-13 14:41:57,400 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:57,400 [INFO]: 	compression ratio: 0.999309729105325
2025-03-13 14:41:57,400 [INFO]: }
2025-03-13 14:41:57,400 [INFO]: 	>>> Finished "Creating the index" in 58.4960 secs
2025-03-13 14:41:57,400 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5299 secs
2025-03-13 14:41:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 26728 [episode count 6/20]
[retrieval_preprocessing] for episode 31405 [episode count 7/20], we have num_retrieval=np.int64(2701) num_query=np.int64(110)
2025-03-13 14:41:58,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:59,118 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:59
2025-03-13 14:41:59,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.98it/s]
2025-03-13 14:41:59,147 [INFO]: There are 2701 embeddings of dim 49152
2025-03-13 14:41:59,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 14:41:59,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:59
2025-03-13 14:41:59,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:59,148 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:41:59,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:59,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:41:59,148 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:59
2025-03-13 14:41:59,148 [INFO]: 557.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:59,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:41:59,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:59
2025-03-13 14:41:59,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:59,148 [INFO]: 	Creating the index 03/13/2025, 14:41:59
2025-03-13 14:41:59,148 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:59
2025-03-13 14:41:59,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:41:59,149 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:59
2025-03-13 14:41:59,149 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:41:59,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.45it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.53it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]100%|██████████| 11/11 [00:02<00:00,  5.36it/s]
2025-03-13 14:42:01,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:01
2025-03-13 14:42:31,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9589 secs
2025-03-13 14:42:31,164 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 14:42:31,164 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 14:42:48,787 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6231 secs
2025-03-13 14:42:48,791 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6423 secs
2025-03-13 14:42:48,792 [INFO]: {
2025-03-13 14:42:48,792 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:48,792 [INFO]: 	index_param: efSearch=181
2025-03-13 14:42:48,792 [INFO]: 	index_path: knn.index
2025-03-13 14:42:48,792 [INFO]: 	size in bytes: 531405010
2025-03-13 14:42:48,792 [INFO]: 	avg_search_speed_ms: 10.938112289773166
2025-03-13 14:42:48,792 [INFO]: 	99p_search_speed_ms: 18.885924690403044
2025-03-13 14:42:48,792 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:48,792 [INFO]: 	nb vectors: 2701
2025-03-13 14:42:48,792 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:48,792 [INFO]: 	compression ratio: 0.9993097505798826
2025-03-13 14:42:48,792 [INFO]: }
2025-03-13 14:42:48,792 [INFO]: 	>>> Finished "Creating the index" in 49.6440 secs
2025-03-13 14:42:48,792 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6742 secs
2025-03-13 14:42:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 31405 [episode count 7/20]
[retrieval_preprocessing] for episode 76007 [episode count 8/20], we have num_retrieval=np.int64(2688) num_query=np.int64(123)
2025-03-13 14:42:52,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:54,140 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:54
2025-03-13 14:42:54,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.25it/s]
2025-03-13 14:42:54,182 [INFO]: There are 2688 embeddings of dim 49152
2025-03-13 14:42:54,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0415 secs
2025-03-13 14:42:54,182 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:54,182 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:42:54,182 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:42:54,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:54,182 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,183 [INFO]: 554.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:54,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:42:54,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:54
2025-03-13 14:42:54,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:54,183 [INFO]: 	Creating the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,183 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:54
2025-03-13 14:42:54,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:42:54,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:54
2025-03-13 14:42:54,184 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:42:54,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.71it/s] 45%|████▌     | 5/11 [00:00<00:00, 19.04it/s] 82%|████████▏ | 9/11 [00:00<00:00, 24.63it/s]100%|██████████| 11/11 [00:04<00:00,  2.70it/s]
2025-03-13 14:42:58,258 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:58
2025-03-13 14:43:35,251 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9926 secs
2025-03-13 14:43:35,251 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 14:43:35,251 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 14:43:50,018 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7661 secs
2025-03-13 14:43:50,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8351 secs
2025-03-13 14:43:50,020 [INFO]: {
2025-03-13 14:43:50,020 [INFO]: 	index_key: HNSW15
2025-03-13 14:43:50,020 [INFO]: 	index_param: efSearch=183
2025-03-13 14:43:50,020 [INFO]: 	index_path: knn.index
2025-03-13 14:43:50,020 [INFO]: 	size in bytes: 528847330
2025-03-13 14:43:50,020 [INFO]: 	avg_search_speed_ms: 9.76222258606335
2025-03-13 14:43:50,020 [INFO]: 	99p_search_speed_ms: 14.826764939352868
2025-03-13 14:43:50,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:43:50,020 [INFO]: 	nb vectors: 2688
2025-03-13 14:43:50,020 [INFO]: 	vectors dimension: 49152
2025-03-13 14:43:50,020 [INFO]: 	compression ratio: 0.9993097705532521
2025-03-13 14:43:50,020 [INFO]: }
2025-03-13 14:43:50,020 [INFO]: 	>>> Finished "Creating the index" in 55.8368 secs
2025-03-13 14:43:50,020 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8794 secs
2025-03-13 14:43:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:43:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 76007 [episode count 8/20]
[retrieval_preprocessing] for episode 33014 [episode count 9/20], we have num_retrieval=np.int64(2676) num_query=np.int64(135)
2025-03-13 14:43:51,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:51,639 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:51
2025-03-13 14:43:51,639 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2130.17it/s]
2025-03-13 14:43:51,669 [INFO]: There are 2676 embeddings of dim 49152
2025-03-13 14:43:51,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 14:43:51,669 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:51
2025-03-13 14:43:51,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:51,669 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:43:51,669 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:51,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:51,669 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:51
2025-03-13 14:43:51,669 [INFO]: 552.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:51,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:43:51,669 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:51
2025-03-13 14:43:51,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:51,670 [INFO]: 	Creating the index 03/13/2025, 14:43:51
2025-03-13 14:43:51,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:51
2025-03-13 14:43:51,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:43:51,671 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:51
2025-03-13 14:43:51,671 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:43:51,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.45it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]100%|██████████| 11/11 [00:02<00:00,  5.21it/s]
2025-03-13 14:43:53,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:53
2025-03-13 14:44:26,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1765 secs
2025-03-13 14:44:26,964 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 14:44:26,964 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.42it/s]
2025-03-13 14:44:46,692 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7275 secs
2025-03-13 14:44:46,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0235 secs
2025-03-13 14:44:46,694 [INFO]: {
2025-03-13 14:44:46,694 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:46,695 [INFO]: 	index_param: efSearch=186
2025-03-13 14:44:46,695 [INFO]: 	index_path: knn.index
2025-03-13 14:44:46,695 [INFO]: 	size in bytes: 526486450
2025-03-13 14:44:46,695 [INFO]: 	avg_search_speed_ms: 10.021027981981128
2025-03-13 14:44:46,695 [INFO]: 	99p_search_speed_ms: 14.162842447403817
2025-03-13 14:44:46,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:46,695 [INFO]: 	nb vectors: 2676
2025-03-13 14:44:46,695 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:46,695 [INFO]: 	compression ratio: 0.9993096840384021
2025-03-13 14:44:46,695 [INFO]: }
2025-03-13 14:44:46,695 [INFO]: 	>>> Finished "Creating the index" in 55.0250 secs
2025-03-13 14:44:46,695 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0561 secs
2025-03-13 14:44:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 33014 [episode count 9/20]
[retrieval_preprocessing] for episode 75526 [episode count 10/20], we have num_retrieval=np.int64(2648) num_query=np.int64(163)
2025-03-13 14:44:49,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:50,226 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:50
2025-03-13 14:44:50,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1523.54it/s]
2025-03-13 14:44:50,252 [INFO]: There are 2648 embeddings of dim 49152
2025-03-13 14:44:50,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 14:44:50,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:50,252 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:44:50,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:50,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:44:50,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,253 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:50,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:44:50,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:50
2025-03-13 14:44:50,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:50,253 [INFO]: 	Creating the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:50
2025-03-13 14:44:50,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:44:50,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:50
2025-03-13 14:44:50,254 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:44:50,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.02it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.04it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.64it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.40it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.24it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.11it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.15it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.08it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.72it/s]100%|██████████| 11/11 [00:04<00:00,  1.07it/s]100%|██████████| 11/11 [00:04<00:00,  2.69it/s]
2025-03-13 14:44:54,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:54
2025-03-13 14:45:24,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1084 secs
2025-03-13 14:45:24,456 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 14:45:24,456 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.63s/it] 50%|█████     | 2/4 [00:04<00:04,  2.32s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.36s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.73s/it]
2025-03-13 14:45:46,469 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0125 secs
2025-03-13 14:45:46,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2171 secs
2025-03-13 14:45:46,472 [INFO]: {
2025-03-13 14:45:46,472 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:46,472 [INFO]: 	index_param: efSearch=168
2025-03-13 14:45:46,472 [INFO]: 	index_path: knn.index
2025-03-13 14:45:46,472 [INFO]: 	size in bytes: 520977730
2025-03-13 14:45:46,472 [INFO]: 	avg_search_speed_ms: 7.637447157819208
2025-03-13 14:45:46,472 [INFO]: 	99p_search_speed_ms: 10.447582276538016
2025-03-13 14:45:46,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:46,472 [INFO]: 	nb vectors: 2648
2025-03-13 14:45:46,472 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:46,472 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-13 14:45:46,472 [INFO]: }
2025-03-13 14:45:46,472 [INFO]: 	>>> Finished "Creating the index" in 56.2188 secs
2025-03-13 14:45:46,472 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2461 secs
2025-03-13 14:45:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 75526 [episode count 10/20]
[retrieval_preprocessing] for episode 93962 [episode count 11/20], we have num_retrieval=np.int64(2694) num_query=np.int64(117)
2025-03-13 14:45:48,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:49,389 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:49
2025-03-13 14:45:49,389 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-13 14:45:49,416 [INFO]: There are 2694 embeddings of dim 49152
2025-03-13 14:45:49,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 14:45:49,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:49
2025-03-13 14:45:49,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:49,418 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:45:49,418 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:49,418 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:45:49,418 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:49
2025-03-13 14:45:49,419 [INFO]: 556.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:49,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:45:49,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:49
2025-03-13 14:45:49,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:49,419 [INFO]: 	Creating the index 03/13/2025, 14:45:49
2025-03-13 14:45:49,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:49
2025-03-13 14:45:49,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:45:49,423 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:49
2025-03-13 14:45:49,423 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:45:49,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.37it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.11it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.88it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.48it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.79it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.98it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.27it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.25it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.23it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.25it/s]100%|██████████| 11/11 [00:03<00:00,  1.47it/s]100%|██████████| 11/11 [00:03<00:00,  3.52it/s]
2025-03-13 14:45:52,556 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:52
2025-03-13 14:46:21,507 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9508 secs
2025-03-13 14:46:21,507 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 14:46:21,508 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.22it/s]
2025-03-13 14:46:39,594 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0865 secs
2025-03-13 14:46:39,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1747 secs
2025-03-13 14:46:39,598 [INFO]: {
2025-03-13 14:46:39,598 [INFO]: 	index_key: HNSW15
2025-03-13 14:46:39,598 [INFO]: 	index_param: efSearch=191
2025-03-13 14:46:39,598 [INFO]: 	index_path: knn.index
2025-03-13 14:46:39,598 [INFO]: 	size in bytes: 530027770
2025-03-13 14:46:39,598 [INFO]: 	avg_search_speed_ms: 9.400513084409269
2025-03-13 14:46:39,598 [INFO]: 	99p_search_speed_ms: 15.738354842178486
2025-03-13 14:46:39,598 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:46:39,598 [INFO]: 	nb vectors: 2694
2025-03-13 14:46:39,598 [INFO]: 	vectors dimension: 49152
2025-03-13 14:46:39,598 [INFO]: 	compression ratio: 0.9993098135216576
2025-03-13 14:46:39,598 [INFO]: }
2025-03-13 14:46:39,598 [INFO]: 	>>> Finished "Creating the index" in 50.1786 secs
2025-03-13 14:46:39,598 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2088 secs
2025-03-13 14:46:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:46:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 93962 [episode count 11/20]
[retrieval_preprocessing] for episode 12592 [episode count 12/20], we have num_retrieval=np.int64(2686) num_query=np.int64(125)
2025-03-13 14:46:41,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:46:42,157 [INFO]: Launching the whole pipeline 03/13/2025, 14:46:42
2025-03-13 14:46:42,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:46:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.40it/s]
2025-03-13 14:46:42,183 [INFO]: There are 2686 embeddings of dim 49152
2025-03-13 14:46:42,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 14:46:42,183 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:46:42
2025-03-13 14:46:42,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:46:42,183 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:46:42,183 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:46:42,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:46:42,183 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:46:42
2025-03-13 14:46:42,183 [INFO]: 554.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:46:42,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:46:42,183 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:46:42
2025-03-13 14:46:42,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:46:42,183 [INFO]: 	Creating the index 03/13/2025, 14:46:42
2025-03-13 14:46:42,184 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:46:42
2025-03-13 14:46:42,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:46:42,185 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:46:42
2025-03-13 14:46:42,185 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:46:42,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.27it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.56it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.66it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.33it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.48it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.52it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.10it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.69it/s]100%|██████████| 11/11 [00:03<00:00,  1.22it/s]100%|██████████| 11/11 [00:03<00:00,  2.92it/s]
2025-03-13 14:46:45,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:46:45
2025-03-13 14:47:16,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0977 secs
2025-03-13 14:47:16,055 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 14:47:16,055 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 14:47:34,499 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4432 secs
2025-03-13 14:47:34,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3167 secs
2025-03-13 14:47:34,501 [INFO]: {
2025-03-13 14:47:34,501 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:34,501 [INFO]: 	index_param: efSearch=208
2025-03-13 14:47:34,501 [INFO]: 	index_path: knn.index
2025-03-13 14:47:34,501 [INFO]: 	size in bytes: 528453850
2025-03-13 14:47:34,501 [INFO]: 	avg_search_speed_ms: 9.391265822478303
2025-03-13 14:47:34,502 [INFO]: 	99p_search_speed_ms: 16.617685835808462
2025-03-13 14:47:34,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:34,502 [INFO]: 	nb vectors: 2686
2025-03-13 14:47:34,502 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:34,502 [INFO]: 	compression ratio: 0.9993097561877919
2025-03-13 14:47:34,502 [INFO]: }
2025-03-13 14:47:34,502 [INFO]: 	>>> Finished "Creating the index" in 52.3181 secs
2025-03-13 14:47:34,502 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3440 secs
2025-03-13 14:47:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 12592 [episode count 12/20]
[retrieval_preprocessing] for episode 71467 [episode count 13/20], we have num_retrieval=np.int64(2687) num_query=np.int64(124)
2025-03-13 14:47:36,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:37,345 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:37
2025-03-13 14:47:37,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.84it/s]
2025-03-13 14:47:37,373 [INFO]: There are 2687 embeddings of dim 49152
2025-03-13 14:47:37,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 14:47:37,373 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:37
2025-03-13 14:47:37,373 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:37,373 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:47:37,373 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:37,373 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:37,373 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:37
2025-03-13 14:47:37,373 [INFO]: 554.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:37,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:37,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:37
2025-03-13 14:47:37,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:37,374 [INFO]: 	Creating the index 03/13/2025, 14:47:37
2025-03-13 14:47:37,374 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:37
2025-03-13 14:47:37,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:47:37,375 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:37
2025-03-13 14:47:37,375 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:47:37,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.73it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.84it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.22it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.50it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.08it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.35it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.28it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.21it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.24it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.27it/s]100%|██████████| 11/11 [00:04<00:00,  1.06it/s]100%|██████████| 11/11 [00:04<00:00,  2.61it/s]
2025-03-13 14:47:41,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:41
2025-03-13 14:48:10,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7194 secs
2025-03-13 14:48:10,321 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 14:48:10,321 [INFO]: 	Compute fast metrics 03/13/2025, 14:48:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 14:48:25,476 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1548 secs
2025-03-13 14:48:25,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1031 secs
2025-03-13 14:48:25,478 [INFO]: {
2025-03-13 14:48:25,478 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:25,478 [INFO]: 	index_param: efSearch=199
2025-03-13 14:48:25,478 [INFO]: 	index_path: knn.index
2025-03-13 14:48:25,478 [INFO]: 	size in bytes: 528650590
2025-03-13 14:48:25,478 [INFO]: 	avg_search_speed_ms: 9.811096172597008
2025-03-13 14:48:25,478 [INFO]: 	99p_search_speed_ms: 18.373329578898844
2025-03-13 14:48:25,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:25,478 [INFO]: 	nb vectors: 2687
2025-03-13 14:48:25,478 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:25,478 [INFO]: 	compression ratio: 0.9993097633731951
2025-03-13 14:48:25,478 [INFO]: }
2025-03-13 14:48:25,478 [INFO]: 	>>> Finished "Creating the index" in 48.1048 secs
2025-03-13 14:48:25,478 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1330 secs
2025-03-13 14:48:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 71467 [episode count 13/20]
[retrieval_preprocessing] for episode 92993 [episode count 14/20], we have num_retrieval=np.int64(2686) num_query=np.int64(125)
2025-03-13 14:48:27,314 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:27,713 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:27
2025-03-13 14:48:27,713 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2055.02it/s]
2025-03-13 14:48:27,738 [INFO]: There are 2686 embeddings of dim 49152
2025-03-13 14:48:27,738 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 14:48:27,739 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:27
2025-03-13 14:48:27,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:27,739 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:48:27,739 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:27,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:48:27,739 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:27
2025-03-13 14:48:27,740 [INFO]: 554.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:27,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:48:27,740 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:27
2025-03-13 14:48:27,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:27,740 [INFO]: 	Creating the index 03/13/2025, 14:48:27
2025-03-13 14:48:27,741 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:27
2025-03-13 14:48:27,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:48:27,744 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:27
2025-03-13 14:48:27,744 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:48:27,744 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.21it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.02it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.86it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.18it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.36it/s]100%|██████████| 11/11 [00:03<00:00,  2.13it/s]100%|██████████| 11/11 [00:03<00:00,  3.46it/s]
2025-03-13 14:48:30,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:30
2025-03-13 14:49:01,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1777 secs
2025-03-13 14:49:01,106 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 14:49:01,106 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 14:49:26,145 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0386 secs
2025-03-13 14:49:26,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4033 secs
2025-03-13 14:49:26,147 [INFO]: {
2025-03-13 14:49:26,147 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:26,147 [INFO]: 	index_param: efSearch=222
2025-03-13 14:49:26,147 [INFO]: 	index_path: knn.index
2025-03-13 14:49:26,147 [INFO]: 	size in bytes: 528453850
2025-03-13 14:49:26,148 [INFO]: 	avg_search_speed_ms: 9.146321679412692
2025-03-13 14:49:26,148 [INFO]: 	99p_search_speed_ms: 14.252152252010983
2025-03-13 14:49:26,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:26,148 [INFO]: 	nb vectors: 2686
2025-03-13 14:49:26,148 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:26,148 [INFO]: 	compression ratio: 0.9993097561877919
2025-03-13 14:49:26,148 [INFO]: }
2025-03-13 14:49:26,148 [INFO]: 	>>> Finished "Creating the index" in 58.4072 secs
2025-03-13 14:49:26,148 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4344 secs
2025-03-13 14:49:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 92993 [episode count 14/20]
[retrieval_preprocessing] for episode 12137 [episode count 15/20], we have num_retrieval=np.int64(2681) num_query=np.int64(130)
2025-03-13 14:49:27,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:28,563 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:28
2025-03-13 14:49:28,563 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.87it/s]
2025-03-13 14:49:28,587 [INFO]: There are 2681 embeddings of dim 49152
2025-03-13 14:49:28,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 14:49:28,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:28
2025-03-13 14:49:28,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:28,587 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:49:28,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:28,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:49:28,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:28
2025-03-13 14:49:28,587 [INFO]: 553.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:28,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:49:28,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:28
2025-03-13 14:49:28,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:28,587 [INFO]: 	Creating the index 03/13/2025, 14:49:28
2025-03-13 14:49:28,588 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:28
2025-03-13 14:49:28,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:49:28,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:28
2025-03-13 14:49:28,589 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:49:28,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.35it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.22it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.24it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.94it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.22it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.57it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.81it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.98it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.09it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.02it/s]100%|██████████| 11/11 [00:03<00:00,  1.60it/s]100%|██████████| 11/11 [00:03<00:00,  3.49it/s]
2025-03-13 14:49:31,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:31
2025-03-13 14:50:01,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4122 secs
2025-03-13 14:50:01,157 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 14:50:01,158 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-13 14:50:19,024 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8668 secs
2025-03-13 14:50:19,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4388 secs
2025-03-13 14:50:19,028 [INFO]: {
2025-03-13 14:50:19,028 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:19,028 [INFO]: 	index_param: efSearch=163
2025-03-13 14:50:19,028 [INFO]: 	index_path: knn.index
2025-03-13 14:50:19,028 [INFO]: 	size in bytes: 527470150
2025-03-13 14:50:19,028 [INFO]: 	avg_search_speed_ms: 8.971687080756231
2025-03-13 14:50:19,028 [INFO]: 	99p_search_speed_ms: 14.526835433207422
2025-03-13 14:50:19,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:19,028 [INFO]: 	nb vectors: 2681
2025-03-13 14:50:19,028 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:19,028 [INFO]: 	compression ratio: 0.9993097201803742
2025-03-13 14:50:19,028 [INFO]: }
2025-03-13 14:50:19,028 [INFO]: 	>>> Finished "Creating the index" in 50.4403 secs
2025-03-13 14:50:19,028 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4649 secs
2025-03-13 14:50:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 12137 [episode count 15/20]
[retrieval_preprocessing] for episode 64367 [episode count 16/20], we have num_retrieval=np.int64(2638) num_query=np.int64(173)
2025-03-13 14:50:21,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:22,098 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:22
2025-03-13 14:50:22,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.34it/s]
2025-03-13 14:50:22,123 [INFO]: There are 2638 embeddings of dim 49152
2025-03-13 14:50:22,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 14:50:22,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:22,123 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:50:22,123 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:22,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:50:22,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,123 [INFO]: 544.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:22,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:50:22,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:22
2025-03-13 14:50:22,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:22,123 [INFO]: 	Creating the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,124 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:22
2025-03-13 14:50:22,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:50:22,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:22
2025-03-13 14:50:22,125 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:50:22,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.77it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.58it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.65it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.39it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.59it/s]100%|██████████| 11/11 [00:04<00:00,  1.54it/s]100%|██████████| 11/11 [00:04<00:00,  2.58it/s]
2025-03-13 14:50:26,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:26
2025-03-13 14:50:54,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4367 secs
2025-03-13 14:50:54,830 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 14:50:54,830 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-13 14:51:12,676 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8460 secs
2025-03-13 14:51:12,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5532 secs
2025-03-13 14:51:12,678 [INFO]: {
2025-03-13 14:51:12,678 [INFO]: 	index_key: HNSW15
2025-03-13 14:51:12,678 [INFO]: 	index_param: efSearch=136
2025-03-13 14:51:12,678 [INFO]: 	index_path: knn.index
2025-03-13 14:51:12,678 [INFO]: 	size in bytes: 519010330
2025-03-13 14:51:12,678 [INFO]: 	avg_search_speed_ms: 7.242883468870128
2025-03-13 14:51:12,678 [INFO]: 	99p_search_speed_ms: 12.850589172448965
2025-03-13 14:51:12,678 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:51:12,678 [INFO]: 	nb vectors: 2638
2025-03-13 14:51:12,678 [INFO]: 	vectors dimension: 49152
2025-03-13 14:51:12,678 [INFO]: 	compression ratio: 0.9993094048821726
2025-03-13 14:51:12,678 [INFO]: }
2025-03-13 14:51:12,678 [INFO]: 	>>> Finished "Creating the index" in 50.5548 secs
2025-03-13 14:51:12,678 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5805 secs
2025-03-13 14:51:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:51:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 64367 [episode count 16/20]
[retrieval_preprocessing] for episode 29090 [episode count 17/20], we have num_retrieval=np.int64(2631) num_query=np.int64(180)
2025-03-13 14:51:14,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:51:15,229 [INFO]: Launching the whole pipeline 03/13/2025, 14:51:15
2025-03-13 14:51:15,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:51:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.47it/s]
2025-03-13 14:51:15,257 [INFO]: There are 2631 embeddings of dim 49152
2025-03-13 14:51:15,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 14:51:15,258 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:51:15
2025-03-13 14:51:15,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:51:15,258 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:51:15,258 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:51:15,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:51:15,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:51:15
2025-03-13 14:51:15,259 [INFO]: 543.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:51:15,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:51:15,259 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:51:15
2025-03-13 14:51:15,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:51:15,259 [INFO]: 	Creating the index 03/13/2025, 14:51:15
2025-03-13 14:51:15,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:51:15
2025-03-13 14:51:15,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:51:15,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:51:15
2025-03-13 14:51:15,263 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:51:15,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.90it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.93it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.99it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.34it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.64it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.81it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.92it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.02it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.08it/s]100%|██████████| 11/11 [00:03<00:00,  1.45it/s]100%|██████████| 11/11 [00:03<00:00,  3.38it/s]
2025-03-13 14:51:18,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:18
2025-03-13 14:51:48,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5661 secs
2025-03-13 14:51:48,088 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 14:51:48,088 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 14:52:05,348 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2604 secs
2025-03-13 14:52:05,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1797 secs
2025-03-13 14:52:05,443 [INFO]: {
2025-03-13 14:52:05,443 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:05,443 [INFO]: 	index_param: efSearch=200
2025-03-13 14:52:05,443 [INFO]: 	index_path: knn.index
2025-03-13 14:52:05,443 [INFO]: 	size in bytes: 517633150
2025-03-13 14:52:05,443 [INFO]: 	avg_search_speed_ms: 8.91552336987958
2025-03-13 14:52:05,443 [INFO]: 	99p_search_speed_ms: 14.806708849500865
2025-03-13 14:52:05,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:05,443 [INFO]: 	nb vectors: 2631
2025-03-13 14:52:05,443 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:05,443 [INFO]: 	compression ratio: 0.9993093525791383
2025-03-13 14:52:05,443 [INFO]: }
2025-03-13 14:52:05,443 [INFO]: 	>>> Finished "Creating the index" in 50.1840 secs
2025-03-13 14:52:05,444 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2144 secs
2025-03-13 14:52:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 29090 [episode count 17/20]
[retrieval_preprocessing] for episode 54698 [episode count 18/20], we have num_retrieval=np.int64(2655) num_query=np.int64(156)
2025-03-13 14:52:09,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:10,996 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:10
2025-03-13 14:52:10,996 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2200.58it/s]
2025-03-13 14:52:11,018 [INFO]: There are 2655 embeddings of dim 49152
2025-03-13 14:52:11,019 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 14:52:11,019 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:11
2025-03-13 14:52:11,019 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:11,019 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:52:11,019 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:11,019 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:11,019 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:11
2025-03-13 14:52:11,019 [INFO]: 547.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:11,019 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:52:11,019 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:11
2025-03-13 14:52:11,019 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:11,019 [INFO]: 	Creating the index 03/13/2025, 14:52:11
2025-03-13 14:52:11,019 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:11
2025-03-13 14:52:11,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:52:11,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:11
2025-03-13 14:52:11,020 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:52:11,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.43it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.33it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.71it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.72it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.18it/s]100%|██████████| 11/11 [00:02<00:00,  2.51it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]
2025-03-13 14:52:13,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:13
2025-03-13 14:52:43,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7975 secs
2025-03-13 14:52:43,562 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 14:52:43,562 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.44it/s] 50%|█████     | 2/4 [00:00<00:00,  4.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.35it/s]
2025-03-13 14:53:00,054 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4916 secs
2025-03-13 14:53:00,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0371 secs
2025-03-13 14:53:00,057 [INFO]: {
2025-03-13 14:53:00,058 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:00,058 [INFO]: 	index_param: efSearch=160
2025-03-13 14:53:00,058 [INFO]: 	index_path: knn.index
2025-03-13 14:53:00,058 [INFO]: 	size in bytes: 522354910
2025-03-13 14:53:00,058 [INFO]: 	avg_search_speed_ms: 9.771428273552374
2025-03-13 14:53:00,058 [INFO]: 	99p_search_speed_ms: 19.726384279783815
2025-03-13 14:53:00,058 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:00,058 [INFO]: 	nb vectors: 2655
2025-03-13 14:53:00,058 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:00,058 [INFO]: 	compression ratio: 0.9993095307556312
2025-03-13 14:53:00,058 [INFO]: }
2025-03-13 14:53:00,058 [INFO]: 	>>> Finished "Creating the index" in 49.0387 secs
2025-03-13 14:53:00,058 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0623 secs
2025-03-13 14:53:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 54698 [episode count 18/20]
[retrieval_preprocessing] for episode 56751 [episode count 19/20], we have num_retrieval=np.int64(2646) num_query=np.int64(165)
2025-03-13 14:53:02,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:03,034 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:03
2025-03-13 14:53:03,034 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1711.26it/s]
2025-03-13 14:53:03,058 [INFO]: There are 2646 embeddings of dim 49152
2025-03-13 14:53:03,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 14:53:03,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:03
2025-03-13 14:53:03,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:03,058 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 14:53:03,058 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:03,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:03,058 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:03
2025-03-13 14:53:03,058 [INFO]: 546.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:03,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:03,058 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:03
2025-03-13 14:53:03,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:03,058 [INFO]: 	Creating the index 03/13/2025, 14:53:03
2025-03-13 14:53:03,058 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:03
2025-03-13 14:53:03,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:03,060 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:03
2025-03-13 14:53:03,060 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:53:03,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.26it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.47it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.18it/s] 82%|████████▏ | 9/11 [00:00<00:00, 16.03it/s]100%|██████████| 11/11 [00:02<00:00,  3.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.18it/s]
2025-03-13 14:53:05,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:05
2025-03-13 14:53:38,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7953 secs
2025-03-13 14:53:38,494 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 14:53:38,494 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 14:53:56,836 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3413 secs
2025-03-13 14:53:56,838 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7789 secs
2025-03-13 14:53:56,839 [INFO]: {
2025-03-13 14:53:56,839 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:56,839 [INFO]: 	index_param: efSearch=179
2025-03-13 14:53:56,839 [INFO]: 	index_path: knn.index
2025-03-13 14:53:56,839 [INFO]: 	size in bytes: 520584250
2025-03-13 14:53:56,839 [INFO]: 	avg_search_speed_ms: 10.031869464274589
2025-03-13 14:53:56,839 [INFO]: 	99p_search_speed_ms: 16.09237819910049
2025-03-13 14:53:56,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:56,839 [INFO]: 	nb vectors: 2646
2025-03-13 14:53:56,839 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:56,839 [INFO]: 	compression ratio: 0.9993094643182155
2025-03-13 14:53:56,839 [INFO]: }
2025-03-13 14:53:56,839 [INFO]: 	>>> Finished "Creating the index" in 53.7806 secs
2025-03-13 14:53:56,839 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8053 secs
2025-03-13 14:53:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 56751 [episode count 19/20]
2025-03-13 14:53:58: [retrieval_preprocessing] finished for 8756300955_put_blue_object_in_drawer_and_close [chosen_id count 0/196]
2025-03-13 14:53:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8756300955_pick_up_blue_object_from_counter_put_in_open_drawer_and_close [chosen_id count 1/196]
2025-03-13 14:53:59: [retrieval_preprocessing] we have num_total=2693 embedding_dim=49152
[retrieval_preprocessing] for episode 55809 [episode count 0/20], we have num_retrieval=np.int64(2547) num_query=np.int64(146)
2025-03-13 14:54:00,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:00,618 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:00
2025-03-13 14:54:00,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 715.87it/s]
2025-03-13 14:54:00,663 [INFO]: There are 2547 embeddings of dim 49152
2025-03-13 14:54:00,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0449 secs
2025-03-13 14:54:00,663 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:00
2025-03-13 14:54:00,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:00,664 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:54:00,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:00,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:54:00,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:00
2025-03-13 14:54:00,665 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:00,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:54:00,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:00
2025-03-13 14:54:00,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:00,665 [INFO]: 	Creating the index 03/13/2025, 14:54:00
2025-03-13 14:54:00,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:00
2025-03-13 14:54:00,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:54:00,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:00
2025-03-13 14:54:00,669 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:54:00,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.61it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.16it/s]100%|██████████| 11/11 [00:02<00:00,  3.28it/s]100%|██████████| 11/11 [00:02<00:00,  3.89it/s]
2025-03-13 14:54:03,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:03
2025-03-13 14:54:37,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5635 secs
2025-03-13 14:54:37,069 [INFO]: The best hyperparameters are: efSearch=63
2025-03-13 14:54:37,069 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.15it/s]
2025-03-13 14:55:24,880 [INFO]: 	>>> Finished "Compute fast metrics" in 47.8102 secs
2025-03-13 14:55:24,882 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.2129 secs
2025-03-13 14:55:24,882 [INFO]: {
2025-03-13 14:55:24,882 [INFO]: 	index_key: HNSW15
2025-03-13 14:55:24,882 [INFO]: 	index_param: efSearch=63
2025-03-13 14:55:24,882 [INFO]: 	index_path: knn.index
2025-03-13 14:55:24,882 [INFO]: 	size in bytes: 501106570
2025-03-13 14:55:24,882 [INFO]: 	avg_search_speed_ms: 4.9130587400868535
2025-03-13 14:55:24,882 [INFO]: 	99p_search_speed_ms: 7.388849360868335
2025-03-13 14:55:24,882 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:24,882 [INFO]: 	nb vectors: 2547
2025-03-13 14:55:24,882 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:24,882 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-13 14:55:24,882 [INFO]: }
2025-03-13 14:55:24,882 [INFO]: 	>>> Finished "Creating the index" in 84.2167 secs
2025-03-13 14:55:24,882 [INFO]: >>> Finished "Launching the whole pipeline" in 84.2638 secs
2025-03-13 14:55:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 55809 [episode count 0/20]
[retrieval_preprocessing] for episode 32260 [episode count 1/20], we have num_retrieval=np.int64(2567) num_query=np.int64(126)
2025-03-13 14:55:29,591 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:30,117 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:30
2025-03-13 14:55:30,117 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.40it/s]
2025-03-13 14:55:30,159 [INFO]: There are 2567 embeddings of dim 49152
2025-03-13 14:55:30,159 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0414 secs
2025-03-13 14:55:30,159 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,159 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:30,159 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:55:30,159 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:55:30,159 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:55:30,159 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,159 [INFO]: 529.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:30,159 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:55:30,159 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:30
2025-03-13 14:55:30,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:55:30,159 [INFO]: 	Creating the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,160 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:55:30
2025-03-13 14:55:30,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:55:30,161 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:30
2025-03-13 14:55:30,161 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:55:30,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.29it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.69it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.61it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]
2025-03-13 14:55:32,660 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:32
2025-03-13 14:56:14,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4172 secs
2025-03-13 14:56:14,078 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 14:56:14,078 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:12,  4.08s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.39s/it]
2025-03-13 14:56:44,831 [INFO]: 	>>> Finished "Compute fast metrics" in 30.7528 secs
2025-03-13 14:56:44,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6732 secs
2025-03-13 14:56:44,835 [INFO]: {
2025-03-13 14:56:44,835 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:44,835 [INFO]: 	index_param: efSearch=200
2025-03-13 14:56:44,835 [INFO]: 	index_path: knn.index
2025-03-13 14:56:44,835 [INFO]: 	size in bytes: 505041370
2025-03-13 14:56:44,835 [INFO]: 	avg_search_speed_ms: 11.652192958122628
2025-03-13 14:56:44,835 [INFO]: 	99p_search_speed_ms: 18.99668620433658
2025-03-13 14:56:44,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:44,835 [INFO]: 	nb vectors: 2567
2025-03-13 14:56:44,835 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:44,835 [INFO]: 	compression ratio: 0.9993096921941266
2025-03-13 14:56:44,835 [INFO]: }
2025-03-13 14:56:44,835 [INFO]: 	>>> Finished "Creating the index" in 74.6755 secs
2025-03-13 14:56:44,835 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7176 secs
2025-03-13 14:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 32260 [episode count 1/20]
[retrieval_preprocessing] for episode 66068 [episode count 2/20], we have num_retrieval=np.int64(2579) num_query=np.int64(114)
2025-03-13 14:56:46,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:46,575 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:46
2025-03-13 14:56:46,575 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.51it/s]
2025-03-13 14:56:46,613 [INFO]: There are 2579 embeddings of dim 49152
2025-03-13 14:56:46,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 14:56:46,614 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:46,614 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:56:46,614 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:46,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:56:46,614 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,614 [INFO]: 532.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:46,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:56:46,615 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:46
2025-03-13 14:56:46,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:46,615 [INFO]: 	Creating the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,615 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:46
2025-03-13 14:56:46,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 14:56:46,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:46
2025-03-13 14:56:46,618 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:56:46,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:02<00:26,  2.69s/it] 45%|████▌     | 5/11 [00:02<00:02,  2.31it/s] 73%|███████▎  | 8/11 [00:07<00:02,  1.05it/s] 82%|████████▏ | 9/11 [00:09<00:02,  1.18s/it]100%|██████████| 11/11 [00:11<00:00,  1.15s/it]100%|██████████| 11/11 [00:11<00:00,  1.07s/it]
2025-03-13 14:56:58,385 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:58
2025-03-13 14:57:32,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5862 secs
2025-03-13 14:57:32,972 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 14:57:32,972 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.38it/s]
2025-03-13 14:58:00,722 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7498 secs
2025-03-13 14:58:00,772 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1541 secs
2025-03-13 14:58:00,772 [INFO]: {
2025-03-13 14:58:00,772 [INFO]: 	index_key: HNSW15
2025-03-13 14:58:00,772 [INFO]: 	index_param: efSearch=186
2025-03-13 14:58:00,772 [INFO]: 	index_path: knn.index
2025-03-13 14:58:00,773 [INFO]: 	size in bytes: 507402430
2025-03-13 14:58:00,773 [INFO]: 	avg_search_speed_ms: 10.191885538706499
2025-03-13 14:58:00,773 [INFO]: 	99p_search_speed_ms: 17.721538397017856
2025-03-13 14:58:00,773 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:00,773 [INFO]: 	nb vectors: 2579
2025-03-13 14:58:00,773 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:00,773 [INFO]: 	compression ratio: 0.9993094278243799
2025-03-13 14:58:00,773 [INFO]: }
2025-03-13 14:58:00,773 [INFO]: 	>>> Finished "Creating the index" in 74.1581 secs
2025-03-13 14:58:00,773 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1983 secs
2025-03-13 14:58:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 66068 [episode count 2/20]
[retrieval_preprocessing] for episode 41 [episode count 3/20], we have num_retrieval=np.int64(2569) num_query=np.int64(124)
2025-03-13 14:58:02,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:02,718 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:02
2025-03-13 14:58:02,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.38it/s]
2025-03-13 14:58:02,753 [INFO]: There are 2569 embeddings of dim 49152
2025-03-13 14:58:02,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 14:58:02,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:02
2025-03-13 14:58:02,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:02,753 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:58:02,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:58:02,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:58:02,753 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:02
2025-03-13 14:58:02,754 [INFO]: 530.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:02,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:58:02,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:02
2025-03-13 14:58:02,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:58:02,754 [INFO]: 	Creating the index 03/13/2025, 14:58:02
2025-03-13 14:58:02,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:58:02
2025-03-13 14:58:02,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:58:02,755 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:02
2025-03-13 14:58:02,755 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:58:02,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.44it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.30it/s]100%|██████████| 11/11 [00:02<00:00,  3.98it/s]100%|██████████| 11/11 [00:02<00:00,  4.65it/s]
2025-03-13 14:58:05,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:05
2025-03-13 14:58:53,767 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6450 secs
2025-03-13 14:58:53,768 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 14:58:53,768 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 14:59:12,699 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9307 secs
2025-03-13 14:59:12,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.9457 secs
2025-03-13 14:59:12,701 [INFO]: {
2025-03-13 14:59:12,701 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:12,701 [INFO]: 	index_param: efSearch=109
2025-03-13 14:59:12,701 [INFO]: 	index_path: knn.index
2025-03-13 14:59:12,701 [INFO]: 	size in bytes: 505434850
2025-03-13 14:59:12,701 [INFO]: 	avg_search_speed_ms: 6.288554895165488
2025-03-13 14:59:12,701 [INFO]: 	99p_search_speed_ms: 13.003686668816947
2025-03-13 14:59:12,701 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:12,701 [INFO]: 	nb vectors: 2569
2025-03-13 14:59:12,701 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:12,701 [INFO]: 	compression ratio: 0.9993097072748347
2025-03-13 14:59:12,701 [INFO]: }
2025-03-13 14:59:12,701 [INFO]: 	>>> Finished "Creating the index" in 69.9473 secs
2025-03-13 14:59:12,701 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9826 secs
2025-03-13 14:59:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 41 [episode count 3/20]
[retrieval_preprocessing] for episode 77875 [episode count 4/20], we have num_retrieval=np.int64(2573) num_query=np.int64(120)
2025-03-13 14:59:13,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:13,935 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:13
2025-03-13 14:59:13,935 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 14:59:13,962 [INFO]: There are 2573 embeddings of dim 49152
2025-03-13 14:59:13,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 14:59:13,962 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:13
2025-03-13 14:59:13,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:13,962 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 14:59:13,962 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:13,962 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:59:13,962 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:13
2025-03-13 14:59:13,962 [INFO]: 531.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:13,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:59:13,962 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:13
2025-03-13 14:59:13,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:13,962 [INFO]: 	Creating the index 03/13/2025, 14:59:13
2025-03-13 14:59:13,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:13
2025-03-13 14:59:13,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:59:13,964 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:13
2025-03-13 14:59:13,964 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 14:59:13,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.81it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.22it/s]100%|██████████| 11/11 [00:02<00:00,  3.89it/s]100%|██████████| 11/11 [00:02<00:00,  4.73it/s]
2025-03-13 14:59:16,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:16
2025-03-13 14:59:55,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5550 secs
2025-03-13 14:59:55,849 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 14:59:55,849 [INFO]: 	Compute fast metrics 03/13/2025, 14:59:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 15:00:15,884 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0348 secs
2025-03-13 15:00:15,886 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9224 secs
2025-03-13 15:00:15,887 [INFO]: {
2025-03-13 15:00:15,887 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:15,887 [INFO]: 	index_param: efSearch=104
2025-03-13 15:00:15,887 [INFO]: 	index_path: knn.index
2025-03-13 15:00:15,887 [INFO]: 	size in bytes: 506221870
2025-03-13 15:00:15,887 [INFO]: 	avg_search_speed_ms: 6.876822349652546
2025-03-13 15:00:15,887 [INFO]: 	99p_search_speed_ms: 10.058507365174592
2025-03-13 15:00:15,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:15,887 [INFO]: 	nb vectors: 2573
2025-03-13 15:00:15,887 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:15,887 [INFO]: 	compression ratio: 0.9993096189226277
2025-03-13 15:00:15,887 [INFO]: }
2025-03-13 15:00:15,887 [INFO]: 	>>> Finished "Creating the index" in 61.9243 secs
2025-03-13 15:00:15,887 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9516 secs
2025-03-13 15:00:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 77875 [episode count 4/20]
[retrieval_preprocessing] for episode 13893 [episode count 5/20], we have num_retrieval=np.int64(2542) num_query=np.int64(151)
2025-03-13 15:00:16,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:17,339 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:17
2025-03-13 15:00:17,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-13 15:00:17,384 [INFO]: There are 2542 embeddings of dim 49152
2025-03-13 15:00:17,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0455 secs
2025-03-13 15:00:17,385 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:17
2025-03-13 15:00:17,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:17,385 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:00:17,385 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:17,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:00:17,385 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:17
2025-03-13 15:00:17,385 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:17,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:00:17,386 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:17
2025-03-13 15:00:17,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:17,386 [INFO]: 	Creating the index 03/13/2025, 15:00:17
2025-03-13 15:00:17,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:17
2025-03-13 15:00:17,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:00:17,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:17
2025-03-13 15:00:17,388 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:00:17,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.98it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.74it/s]100%|██████████| 11/11 [00:02<00:00,  3.37it/s]100%|██████████| 11/11 [00:02<00:00,  3.99it/s]
2025-03-13 15:00:20,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:20
2025-03-13 15:00:55,761 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6120 secs
2025-03-13 15:00:55,761 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 15:00:55,761 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.32s/it] 50%|█████     | 2/4 [00:01<00:01,  1.26it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.66it/s]
2025-03-13 15:01:14,639 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8776 secs
2025-03-13 15:01:14,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2534 secs
2025-03-13 15:01:14,641 [INFO]: {
2025-03-13 15:01:14,642 [INFO]: 	index_key: HNSW15
2025-03-13 15:01:14,642 [INFO]: 	index_param: efSearch=161
2025-03-13 15:01:14,642 [INFO]: 	index_path: knn.index
2025-03-13 15:01:14,642 [INFO]: 	size in bytes: 500122750
2025-03-13 15:01:14,642 [INFO]: 	avg_search_speed_ms: 11.296045275049758
2025-03-13 15:01:14,642 [INFO]: 	99p_search_speed_ms: 18.907510896679014
2025-03-13 15:01:14,642 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:14,642 [INFO]: 	nb vectors: 2542
2025-03-13 15:01:14,642 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:14,642 [INFO]: 	compression ratio: 0.999309741458472
2025-03-13 15:01:14,642 [INFO]: }
2025-03-13 15:01:14,642 [INFO]: 	>>> Finished "Creating the index" in 57.2558 secs
2025-03-13 15:01:14,642 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3025 secs
2025-03-13 15:01:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 13893 [episode count 5/20]
[retrieval_preprocessing] for episode 31818 [episode count 6/20], we have num_retrieval=np.int64(2571) num_query=np.int64(122)
2025-03-13 15:01:15,852 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:16,264 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:16
2025-03-13 15:01:16,264 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.65it/s]
2025-03-13 15:01:16,298 [INFO]: There are 2571 embeddings of dim 49152
2025-03-13 15:01:16,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 15:01:16,299 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:16
2025-03-13 15:01:16,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:16,299 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:01:16,299 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:01:16,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:01:16,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:16
2025-03-13 15:01:16,300 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:16,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:01:16,300 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:16
2025-03-13 15:01:16,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:01:16,301 [INFO]: 	Creating the index 03/13/2025, 15:01:16
2025-03-13 15:01:16,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:01:16
2025-03-13 15:01:16,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:01:16,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:16
2025-03-13 15:01:16,304 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:01:16,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.89it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.01it/s]100%|██████████| 11/11 [00:02<00:00,  3.98it/s]100%|██████████| 11/11 [00:02<00:00,  4.94it/s]
2025-03-13 15:01:18,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:18
2025-03-13 15:01:49,758 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2229 secs
2025-03-13 15:01:49,759 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 15:01:49,759 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.07it/s]
2025-03-13 15:02:21,104 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3453 secs
2025-03-13 15:02:21,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8021 secs
2025-03-13 15:02:21,106 [INFO]: {
2025-03-13 15:02:21,106 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:21,106 [INFO]: 	index_param: efSearch=236
2025-03-13 15:02:21,106 [INFO]: 	index_path: knn.index
2025-03-13 15:02:21,107 [INFO]: 	size in bytes: 505828330
2025-03-13 15:02:21,107 [INFO]: 	avg_search_speed_ms: 12.074908302649225
2025-03-13 15:02:21,107 [INFO]: 	99p_search_speed_ms: 17.139398935250938
2025-03-13 15:02:21,107 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:21,107 [INFO]: 	nb vectors: 2571
2025-03-13 15:02:21,107 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:21,107 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-13 15:02:21,107 [INFO]: }
2025-03-13 15:02:21,107 [INFO]: 	>>> Finished "Creating the index" in 64.8060 secs
2025-03-13 15:02:21,107 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8430 secs
2025-03-13 15:02:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 31818 [episode count 6/20]
[retrieval_preprocessing] for episode 68206 [episode count 7/20], we have num_retrieval=np.int64(2571) num_query=np.int64(122)
2025-03-13 15:02:22,753 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:23,165 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:23
2025-03-13 15:02:23,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-13 15:02:23,197 [INFO]: There are 2571 embeddings of dim 49152
2025-03-13 15:02:23,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 15:02:23,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:23
2025-03-13 15:02:23,198 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:23,198 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:02:23,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:23,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:23,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:23
2025-03-13 15:02:23,198 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:23,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:02:23,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:23
2025-03-13 15:02:23,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:23,198 [INFO]: 	Creating the index 03/13/2025, 15:02:23
2025-03-13 15:02:23,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:23
2025-03-13 15:02:23,199 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:02:23,199 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:23
2025-03-13 15:02:23,199 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:02:23,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.98it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.47it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.21it/s]
2025-03-13 15:02:25,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:25
2025-03-13 15:03:02,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3900 secs
2025-03-13 15:03:02,208 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 15:03:02,208 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-13 15:03:25,844 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6354 secs
2025-03-13 15:03:25,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6468 secs
2025-03-13 15:03:25,846 [INFO]: {
2025-03-13 15:03:25,846 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:25,846 [INFO]: 	index_param: efSearch=111
2025-03-13 15:03:25,846 [INFO]: 	index_path: knn.index
2025-03-13 15:03:25,846 [INFO]: 	size in bytes: 505828330
2025-03-13 15:03:25,846 [INFO]: 	avg_search_speed_ms: 8.594330215845849
2025-03-13 15:03:25,846 [INFO]: 	99p_search_speed_ms: 13.980014529079199
2025-03-13 15:03:25,846 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:25,846 [INFO]: 	nb vectors: 2571
2025-03-13 15:03:25,846 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:25,846 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-13 15:03:25,846 [INFO]: }
2025-03-13 15:03:25,846 [INFO]: 	>>> Finished "Creating the index" in 62.6483 secs
2025-03-13 15:03:25,846 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6812 secs
2025-03-13 15:03:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 68206 [episode count 7/20]
[retrieval_preprocessing] for episode 56966 [episode count 8/20], we have num_retrieval=np.int64(2503) num_query=np.int64(190)
2025-03-13 15:03:26,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:27,403 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:27
2025-03-13 15:03:27,403 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.01it/s]
2025-03-13 15:03:27,432 [INFO]: There are 2503 embeddings of dim 49152
2025-03-13 15:03:27,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:03:27,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:27
2025-03-13 15:03:27,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:27,432 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:03:27,432 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:27,432 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:03:27,433 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:27
2025-03-13 15:03:27,433 [INFO]: 516.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:27,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:03:27,433 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:27
2025-03-13 15:03:27,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:27,433 [INFO]: 	Creating the index 03/13/2025, 15:03:27
2025-03-13 15:03:27,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:27
2025-03-13 15:03:27,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:03:27,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:27
2025-03-13 15:03:27,434 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:03:27,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.44it/s] 50%|█████     | 5/10 [00:00<00:00, 25.49it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.57it/s]100%|██████████| 10/10 [00:02<00:00,  3.51it/s]
2025-03-13 15:03:30,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:30
2025-03-13 15:04:12,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5665 secs
2025-03-13 15:04:12,316 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 15:04:12,316 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.16it/s]
2025-03-13 15:04:28,853 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5367 secs
2025-03-13 15:04:28,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4210 secs
2025-03-13 15:04:28,855 [INFO]: {
2025-03-13 15:04:28,855 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:28,855 [INFO]: 	index_param: efSearch=123
2025-03-13 15:04:28,855 [INFO]: 	index_path: knn.index
2025-03-13 15:04:28,855 [INFO]: 	size in bytes: 492449590
2025-03-13 15:04:28,855 [INFO]: 	avg_search_speed_ms: 7.1388341049044834
2025-03-13 15:04:28,855 [INFO]: 	99p_search_speed_ms: 10.267904959619045
2025-03-13 15:04:28,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:28,855 [INFO]: 	nb vectors: 2503
2025-03-13 15:04:28,855 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:28,855 [INFO]: 	compression ratio: 0.9993100491768102
2025-03-13 15:04:28,855 [INFO]: }
2025-03-13 15:04:28,855 [INFO]: 	>>> Finished "Creating the index" in 61.4225 secs
2025-03-13 15:04:28,855 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4524 secs
2025-03-13 15:04:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 56966 [episode count 8/20]
[retrieval_preprocessing] for episode 64655 [episode count 9/20], we have num_retrieval=np.int64(2535) num_query=np.int64(158)
2025-03-13 15:04:30,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:30,644 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:30
2025-03-13 15:04:30,644 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1621.93it/s]
2025-03-13 15:04:30,676 [INFO]: There are 2535 embeddings of dim 49152
2025-03-13 15:04:30,677 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 15:04:30,677 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:30
2025-03-13 15:04:30,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:30,677 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:04:30,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:30,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:30,677 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:30
2025-03-13 15:04:30,677 [INFO]: 523.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:30,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:04:30,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:30
2025-03-13 15:04:30,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:30,677 [INFO]: 	Creating the index 03/13/2025, 15:04:30
2025-03-13 15:04:30,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:30
2025-03-13 15:04:30,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:04:30,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:30
2025-03-13 15:04:30,678 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:04:30,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.27it/s] 60%|██████    | 6/10 [00:00<00:00, 28.37it/s]100%|██████████| 10/10 [00:02<00:00,  3.41it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]
2025-03-13 15:04:33,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:33
2025-03-13 15:05:06,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9215 secs
2025-03-13 15:05:06,046 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 15:05:06,047 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.95it/s]
2025-03-13 15:05:29,853 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8061 secs
2025-03-13 15:05:29,855 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1767 secs
2025-03-13 15:05:29,855 [INFO]: {
2025-03-13 15:05:29,855 [INFO]: 	index_key: HNSW15
2025-03-13 15:05:29,855 [INFO]: 	index_param: efSearch=150
2025-03-13 15:05:29,855 [INFO]: 	index_path: knn.index
2025-03-13 15:05:29,855 [INFO]: 	size in bytes: 498745570
2025-03-13 15:05:29,855 [INFO]: 	avg_search_speed_ms: 9.246163309703267
2025-03-13 15:05:29,855 [INFO]: 	99p_search_speed_ms: 13.75071907648817
2025-03-13 15:05:29,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:05:29,856 [INFO]: 	nb vectors: 2535
2025-03-13 15:05:29,856 [INFO]: 	vectors dimension: 49152
2025-03-13 15:05:29,856 [INFO]: 	compression ratio: 0.9993096881040968
2025-03-13 15:05:29,856 [INFO]: }
2025-03-13 15:05:29,856 [INFO]: 	>>> Finished "Creating the index" in 59.1782 secs
2025-03-13 15:05:29,856 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2117 secs
2025-03-13 15:05:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:05:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 64655 [episode count 9/20]
[retrieval_preprocessing] for episode 68755 [episode count 10/20], we have num_retrieval=np.int64(2566) num_query=np.int64(127)
2025-03-13 15:05:31,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:05:31,927 [INFO]: Launching the whole pipeline 03/13/2025, 15:05:31
2025-03-13 15:05:31,927 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:05:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.74it/s]
2025-03-13 15:05:31,955 [INFO]: There are 2566 embeddings of dim 49152
2025-03-13 15:05:31,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 15:05:31,956 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:05:31,956 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:05:31,956 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:05:31,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:05:31,956 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,957 [INFO]: 529.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:05:31,957 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:05:31,957 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:05:31
2025-03-13 15:05:31,957 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:05:31,957 [INFO]: 	Creating the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:05:31
2025-03-13 15:05:31,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 15:05:31,961 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:05:31
2025-03-13 15:05:31,962 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:05:31,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.07it/s] 64%|██████▎   | 7/11 [00:00<00:00, 30.03it/s]100%|██████████| 11/11 [00:03<00:00,  2.81it/s]100%|██████████| 11/11 [00:03<00:00,  3.53it/s]
2025-03-13 15:05:35,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:35
2025-03-13 15:06:13,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9631 secs
2025-03-13 15:06:13,053 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:06:13,053 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-13 15:06:30,197 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1446 secs
2025-03-13 15:06:30,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2377 secs
2025-03-13 15:06:30,199 [INFO]: {
2025-03-13 15:06:30,199 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:30,199 [INFO]: 	index_param: efSearch=177
2025-03-13 15:06:30,199 [INFO]: 	index_path: knn.index
2025-03-13 15:06:30,199 [INFO]: 	size in bytes: 504844630
2025-03-13 15:06:30,199 [INFO]: 	avg_search_speed_ms: 10.646768618242158
2025-03-13 15:06:30,199 [INFO]: 	99p_search_speed_ms: 16.249753120355308
2025-03-13 15:06:30,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:30,200 [INFO]: 	nb vectors: 2566
2025-03-13 15:06:30,200 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:30,200 [INFO]: 	compression ratio: 0.999309684644957
2025-03-13 15:06:30,200 [INFO]: }
2025-03-13 15:06:30,200 [INFO]: 	>>> Finished "Creating the index" in 58.2421 secs
2025-03-13 15:06:30,200 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2727 secs
2025-03-13 15:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 68755 [episode count 10/20]
[retrieval_preprocessing] for episode 8363 [episode count 11/20], we have num_retrieval=np.int64(2574) num_query=np.int64(119)
2025-03-13 15:06:31,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:31,717 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:31
2025-03-13 15:06:31,717 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-13 15:06:31,749 [INFO]: There are 2574 embeddings of dim 49152
2025-03-13 15:06:31,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 15:06:31,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:31
2025-03-13 15:06:31,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:31,750 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:06:31,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:31,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:31,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:31
2025-03-13 15:06:31,750 [INFO]: 531.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:31,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:06:31,750 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:31
2025-03-13 15:06:31,750 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:31,750 [INFO]: 	Creating the index 03/13/2025, 15:06:31
2025-03-13 15:06:31,750 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:31
2025-03-13 15:06:31,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:06:31,751 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:31
2025-03-13 15:06:31,752 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:06:31,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.40it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.95it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.63it/s]
2025-03-13 15:06:34,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:34
2025-03-13 15:07:04,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3514 secs
2025-03-13 15:07:04,484 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:07:04,484 [INFO]: 	Compute fast metrics 03/13/2025, 15:07:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.64it/s]
2025-03-13 15:07:24,589 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1045 secs
2025-03-13 15:07:24,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8407 secs
2025-03-13 15:07:24,593 [INFO]: {
2025-03-13 15:07:24,593 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:24,593 [INFO]: 	index_param: efSearch=154
2025-03-13 15:07:24,593 [INFO]: 	index_path: knn.index
2025-03-13 15:07:24,593 [INFO]: 	size in bytes: 506418610
2025-03-13 15:07:24,593 [INFO]: 	avg_search_speed_ms: 10.136430632755191
2025-03-13 15:07:24,593 [INFO]: 	99p_search_speed_ms: 19.553596479818218
2025-03-13 15:07:24,593 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:24,593 [INFO]: 	nb vectors: 2574
2025-03-13 15:07:24,593 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:24,593 [INFO]: 	compression ratio: 0.9993096264767996
2025-03-13 15:07:24,593 [INFO]: }
2025-03-13 15:07:24,593 [INFO]: 	>>> Finished "Creating the index" in 52.8426 secs
2025-03-13 15:07:24,593 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8755 secs
2025-03-13 15:07:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 8363 [episode count 11/20]
[retrieval_preprocessing] for episode 41660 [episode count 12/20], we have num_retrieval=np.int64(2550) num_query=np.int64(143)
2025-03-13 15:07:27,518 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:27,992 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:27
2025-03-13 15:07:27,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-13 15:07:28,027 [INFO]: There are 2550 embeddings of dim 49152
2025-03-13 15:07:28,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 15:07:28,028 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:28,028 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:07:28,029 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:28,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:07:28,029 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,029 [INFO]: 526.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:28,029 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:07:28,029 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:28
2025-03-13 15:07:28,029 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:28,030 [INFO]: 	Creating the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,030 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:28
2025-03-13 15:07:28,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:07:28,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:28
2025-03-13 15:07:28,033 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:07:28,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.97it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.64it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.96it/s]100%|██████████| 11/11 [00:03<00:00,  3.48it/s]
2025-03-13 15:07:31,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:31
2025-03-13 15:08:09,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2539 secs
2025-03-13 15:08:09,452 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 15:08:09,452 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.02it/s]
2025-03-13 15:08:30,192 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7396 secs
2025-03-13 15:08:30,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1608 secs
2025-03-13 15:08:30,194 [INFO]: {
2025-03-13 15:08:30,194 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:30,194 [INFO]: 	index_param: efSearch=146
2025-03-13 15:08:30,194 [INFO]: 	index_path: knn.index
2025-03-13 15:08:30,194 [INFO]: 	size in bytes: 501696790
2025-03-13 15:08:30,194 [INFO]: 	avg_search_speed_ms: 8.513055718206662
2025-03-13 15:08:30,194 [INFO]: 	99p_search_speed_ms: 13.013375024311244
2025-03-13 15:08:30,194 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:30,194 [INFO]: 	nb vectors: 2550
2025-03-13 15:08:30,194 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:30,194 [INFO]: 	compression ratio: 0.9993095630530145
2025-03-13 15:08:30,195 [INFO]: }
2025-03-13 15:08:30,195 [INFO]: 	>>> Finished "Creating the index" in 62.1649 secs
2025-03-13 15:08:30,195 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2022 secs
2025-03-13 15:08:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 41660 [episode count 12/20]
[retrieval_preprocessing] for episode 13578 [episode count 13/20], we have num_retrieval=np.int64(2562) num_query=np.int64(131)
2025-03-13 15:08:31,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:32,217 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:32
2025-03-13 15:08:32,217 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.41it/s]
2025-03-13 15:08:32,255 [INFO]: There are 2562 embeddings of dim 49152
2025-03-13 15:08:32,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 15:08:32,256 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:32
2025-03-13 15:08:32,256 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:32,256 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:08:32,256 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:32,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:08:32,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:32
2025-03-13 15:08:32,257 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:32,257 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:08:32,257 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:32
2025-03-13 15:08:32,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:32,257 [INFO]: 	Creating the index 03/13/2025, 15:08:32
2025-03-13 15:08:32,258 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:32
2025-03-13 15:08:32,260 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 15:08:32,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:32
2025-03-13 15:08:32,261 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:08:32,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.46it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.65it/s] 82%|████████▏ | 9/11 [00:00<00:00, 30.67it/s]100%|██████████| 11/11 [00:02<00:00,  4.18it/s]
2025-03-13 15:08:34,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:34
2025-03-13 15:09:06,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0048 secs
2025-03-13 15:09:06,905 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:09:06,905 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.08it/s]
2025-03-13 15:09:25,458 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5525 secs
2025-03-13 15:09:25,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1993 secs
2025-03-13 15:09:25,460 [INFO]: {
2025-03-13 15:09:25,460 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:25,460 [INFO]: 	index_param: efSearch=183
2025-03-13 15:09:25,460 [INFO]: 	index_path: knn.index
2025-03-13 15:09:25,460 [INFO]: 	size in bytes: 504057670
2025-03-13 15:09:25,460 [INFO]: 	avg_search_speed_ms: 13.982342274117094
2025-03-13 15:09:25,460 [INFO]: 	99p_search_speed_ms: 22.313525793142617
2025-03-13 15:09:25,460 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:25,460 [INFO]: 	nb vectors: 2562
2025-03-13 15:09:25,460 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:25,460 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-13 15:09:25,460 [INFO]: }
2025-03-13 15:09:25,460 [INFO]: 	>>> Finished "Creating the index" in 53.2027 secs
2025-03-13 15:09:25,460 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2428 secs
2025-03-13 15:09:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 13578 [episode count 13/20]
[retrieval_preprocessing] for episode 41758 [episode count 14/20], we have num_retrieval=np.int64(2573) num_query=np.int64(120)
2025-03-13 15:09:26,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:27,245 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:27
2025-03-13 15:09:27,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1872.46it/s]
2025-03-13 15:09:27,272 [INFO]: There are 2573 embeddings of dim 49152
2025-03-13 15:09:27,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:09:27,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:27,272 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:09:27,272 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:27,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:27,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,273 [INFO]: 531.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:27,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:27,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:27
2025-03-13 15:09:27,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:27,273 [INFO]: 	Creating the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:27
2025-03-13 15:09:27,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:27,274 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:27
2025-03-13 15:09:27,274 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:09:27,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 14.62it/s] 45%|████▌     | 5/11 [00:00<00:00, 21.98it/s] 91%|█████████ | 10/11 [00:00<00:00, 31.17it/s]100%|██████████| 11/11 [00:03<00:00,  3.01it/s]
2025-03-13 15:09:31,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:31
2025-03-13 15:10:03,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9066 secs
2025-03-13 15:10:03,044 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:10:03,044 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.29it/s]
2025-03-13 15:10:25,307 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2624 secs
2025-03-13 15:10:25,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0355 secs
2025-03-13 15:10:25,310 [INFO]: {
2025-03-13 15:10:25,310 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:25,310 [INFO]: 	index_param: efSearch=156
2025-03-13 15:10:25,310 [INFO]: 	index_path: knn.index
2025-03-13 15:10:25,310 [INFO]: 	size in bytes: 506221870
2025-03-13 15:10:25,310 [INFO]: 	avg_search_speed_ms: 10.747275821900617
2025-03-13 15:10:25,310 [INFO]: 	99p_search_speed_ms: 17.87904198281467
2025-03-13 15:10:25,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:25,310 [INFO]: 	nb vectors: 2573
2025-03-13 15:10:25,310 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:25,310 [INFO]: 	compression ratio: 0.9993096189226277
2025-03-13 15:10:25,310 [INFO]: }
2025-03-13 15:10:25,310 [INFO]: 	>>> Finished "Creating the index" in 58.0372 secs
2025-03-13 15:10:25,310 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0649 secs
2025-03-13 15:10:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 41758 [episode count 14/20]
[retrieval_preprocessing] for episode 53539 [episode count 15/20], we have num_retrieval=np.int64(2557) num_query=np.int64(136)
2025-03-13 15:10:26,517 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:26,883 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:26
2025-03-13 15:10:26,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1584.55it/s]
2025-03-13 15:10:26,915 [INFO]: There are 2557 embeddings of dim 49152
2025-03-13 15:10:26,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 15:10:26,916 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:26
2025-03-13 15:10:26,916 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:26,916 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:10:26,916 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:26,916 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:26,916 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:26
2025-03-13 15:10:26,916 [INFO]: 527.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:26,916 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:10:26,916 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:26
2025-03-13 15:10:26,916 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:26,916 [INFO]: 	Creating the index 03/13/2025, 15:10:26
2025-03-13 15:10:26,916 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:26
2025-03-13 15:10:26,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:10:26,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:26
2025-03-13 15:10:26,917 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:10:26,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.35it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.33it/s]100%|██████████| 11/11 [00:02<00:00,  4.23it/s]100%|██████████| 11/11 [00:02<00:00,  4.96it/s]
2025-03-13 15:10:29,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:29
2025-03-13 15:11:02,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4000 secs
2025-03-13 15:11:02,537 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 15:11:02,537 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 15:11:20,344 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8070 secs
2025-03-13 15:11:20,346 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4291 secs
2025-03-13 15:11:20,347 [INFO]: {
2025-03-13 15:11:20,347 [INFO]: 	index_key: HNSW15
2025-03-13 15:11:20,347 [INFO]: 	index_param: efSearch=141
2025-03-13 15:11:20,347 [INFO]: 	index_path: knn.index
2025-03-13 15:11:20,347 [INFO]: 	size in bytes: 503073970
2025-03-13 15:11:20,347 [INFO]: 	avg_search_speed_ms: 9.075462297340366
2025-03-13 15:11:20,347 [INFO]: 	99p_search_speed_ms: 13.584008552134039
2025-03-13 15:11:20,347 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:20,347 [INFO]: 	nb vectors: 2557
2025-03-13 15:11:20,347 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:20,347 [INFO]: 	compression ratio: 0.999309616436724
2025-03-13 15:11:20,347 [INFO]: }
2025-03-13 15:11:20,347 [INFO]: 	>>> Finished "Creating the index" in 53.4310 secs
2025-03-13 15:11:20,347 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4643 secs
2025-03-13 15:11:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 53539 [episode count 15/20]
[retrieval_preprocessing] for episode 18726 [episode count 16/20], we have num_retrieval=np.int64(2576) num_query=np.int64(117)
2025-03-13 15:11:21,958 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:22,464 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:22
2025-03-13 15:11:22,464 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2178.86it/s]
2025-03-13 15:11:22,495 [INFO]: There are 2576 embeddings of dim 49152
2025-03-13 15:11:22,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 15:11:22,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:22
2025-03-13 15:11:22,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:22,495 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:11:22,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:11:22,495 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:22,495 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:22
2025-03-13 15:11:22,496 [INFO]: 531.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:22,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:11:22,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:22
2025-03-13 15:11:22,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:22,496 [INFO]: 	Creating the index 03/13/2025, 15:11:22
2025-03-13 15:11:22,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:11:22
2025-03-13 15:11:22,497 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:11:22,497 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:22
2025-03-13 15:11:22,497 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:11:22,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.22it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.12it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.38it/s]
2025-03-13 15:11:25,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:11:25
2025-03-13 15:12:03,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3707 secs
2025-03-13 15:12:03,380 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 15:12:03,381 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.45it/s]
2025-03-13 15:12:21,082 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7018 secs
2025-03-13 15:12:21,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5879 secs
2025-03-13 15:12:21,085 [INFO]: {
2025-03-13 15:12:21,085 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:21,085 [INFO]: 	index_param: efSearch=125
2025-03-13 15:12:21,085 [INFO]: 	index_path: knn.index
2025-03-13 15:12:21,085 [INFO]: 	size in bytes: 506812210
2025-03-13 15:12:21,085 [INFO]: 	avg_search_speed_ms: 7.930985985184938
2025-03-13 15:12:21,085 [INFO]: 	99p_search_speed_ms: 12.665505986660737
2025-03-13 15:12:21,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:21,085 [INFO]: 	nb vectors: 2576
2025-03-13 15:12:21,085 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:21,085 [INFO]: 	compression ratio: 0.9993094049569169
2025-03-13 15:12:21,085 [INFO]: }
2025-03-13 15:12:21,085 [INFO]: 	>>> Finished "Creating the index" in 58.5894 secs
2025-03-13 15:12:21,085 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6214 secs
2025-03-13 15:12:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 18726 [episode count 16/20]
[retrieval_preprocessing] for episode 77116 [episode count 17/20], we have num_retrieval=np.int64(2541) num_query=np.int64(152)
2025-03-13 15:12:22,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:22,566 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:22
2025-03-13 15:12:22,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2017.46it/s]
2025-03-13 15:12:22,593 [INFO]: There are 2541 embeddings of dim 49152
2025-03-13 15:12:22,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 15:12:22,593 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:22
2025-03-13 15:12:22,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:22,594 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:12:22,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:22,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:12:22,594 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:22
2025-03-13 15:12:22,595 [INFO]: 524.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:22,595 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:12:22,595 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:22
2025-03-13 15:12:22,595 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:22,595 [INFO]: 	Creating the index 03/13/2025, 15:12:22
2025-03-13 15:12:22,595 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:22
2025-03-13 15:12:22,598 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:12:22,598 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:22
2025-03-13 15:12:22,599 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:12:22,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.44it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.67it/s]100%|██████████| 11/11 [00:03<00:00,  2.28it/s]100%|██████████| 11/11 [00:03<00:00,  2.89it/s]
2025-03-13 15:12:26,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:26
2025-03-13 15:13:03,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5185 secs
2025-03-13 15:13:03,924 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:13:03,925 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.51it/s]
2025-03-13 15:13:25,802 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8768 secs
2025-03-13 15:13:25,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2051 secs
2025-03-13 15:13:25,804 [INFO]: {
2025-03-13 15:13:25,804 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:25,804 [INFO]: 	index_param: efSearch=156
2025-03-13 15:13:25,804 [INFO]: 	index_path: knn.index
2025-03-13 15:13:25,804 [INFO]: 	size in bytes: 499926010
2025-03-13 15:13:25,804 [INFO]: 	avg_search_speed_ms: 10.040736697374816
2025-03-13 15:13:25,804 [INFO]: 	99p_search_speed_ms: 17.0131418155506
2025-03-13 15:13:25,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:25,804 [INFO]: 	nb vectors: 2541
2025-03-13 15:13:25,804 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:25,804 [INFO]: 	compression ratio: 0.9993097338544158
2025-03-13 15:13:25,804 [INFO]: }
2025-03-13 15:13:25,804 [INFO]: 	>>> Finished "Creating the index" in 63.2087 secs
2025-03-13 15:13:25,804 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2383 secs
2025-03-13 15:13:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 77116 [episode count 17/20]
[retrieval_preprocessing] for episode 58710 [episode count 18/20], we have num_retrieval=np.int64(2569) num_query=np.int64(124)
2025-03-13 15:13:28,096 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:28,553 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:28
2025-03-13 15:13:28,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 15:13:28,605 [INFO]: There are 2569 embeddings of dim 49152
2025-03-13 15:13:28,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0521 secs
2025-03-13 15:13:28,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:28,606 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:13:28,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:28,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:13:28,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,606 [INFO]: 530.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:28,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:13:28,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:28
2025-03-13 15:13:28,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:28,606 [INFO]: 	Creating the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:28
2025-03-13 15:13:28,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:13:28,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:28
2025-03-13 15:13:28,608 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:13:28,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.55it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.55it/s]100%|██████████| 11/11 [00:02<00:00,  3.91it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]
2025-03-13 15:13:31,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:31
2025-03-13 15:14:05,470 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4624 secs
2025-03-13 15:14:05,471 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:14:05,471 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 15:14:30,676 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2052 secs
2025-03-13 15:14:30,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0701 secs
2025-03-13 15:14:30,678 [INFO]: {
2025-03-13 15:14:30,678 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:30,678 [INFO]: 	index_param: efSearch=189
2025-03-13 15:14:30,679 [INFO]: 	index_path: knn.index
2025-03-13 15:14:30,679 [INFO]: 	size in bytes: 505434850
2025-03-13 15:14:30,679 [INFO]: 	avg_search_speed_ms: 9.524983451036471
2025-03-13 15:14:30,679 [INFO]: 	99p_search_speed_ms: 13.346061345655471
2025-03-13 15:14:30,679 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:30,679 [INFO]: 	nb vectors: 2569
2025-03-13 15:14:30,679 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:30,679 [INFO]: 	compression ratio: 0.9993097072748347
2025-03-13 15:14:30,679 [INFO]: }
2025-03-13 15:14:30,679 [INFO]: 	>>> Finished "Creating the index" in 62.0725 secs
2025-03-13 15:14:30,679 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1256 secs
2025-03-13 15:14:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 58710 [episode count 18/20]
[retrieval_preprocessing] for episode 70499 [episode count 19/20], we have num_retrieval=np.int64(2542) num_query=np.int64(151)
2025-03-13 15:14:31,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:32,237 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:32
2025-03-13 15:14:32,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1134.21it/s]
2025-03-13 15:14:32,266 [INFO]: There are 2542 embeddings of dim 49152
2025-03-13 15:14:32,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 15:14:32,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:32,268 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 15:14:32,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:32,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:14:32,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,268 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:32,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:14:32,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:32
2025-03-13 15:14:32,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:32,269 [INFO]: 	Creating the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:32
2025-03-13 15:14:32,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:14:32,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:32
2025-03-13 15:14:32,273 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:14:32,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.17it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.28it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]100%|██████████| 11/11 [00:02<00:00,  5.29it/s]
2025-03-13 15:14:34,357 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:34
2025-03-13 15:15:10,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4473 secs
2025-03-13 15:15:10,805 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 15:15:10,805 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.49it/s]
2025-03-13 15:15:29,058 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2531 secs
2025-03-13 15:15:29,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7874 secs
2025-03-13 15:15:29,060 [INFO]: {
2025-03-13 15:15:29,061 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:29,061 [INFO]: 	index_param: efSearch=146
2025-03-13 15:15:29,061 [INFO]: 	index_path: knn.index
2025-03-13 15:15:29,061 [INFO]: 	size in bytes: 500122750
2025-03-13 15:15:29,061 [INFO]: 	avg_search_speed_ms: 9.36622248351232
2025-03-13 15:15:29,061 [INFO]: 	99p_search_speed_ms: 14.314718968234951
2025-03-13 15:15:29,061 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:29,061 [INFO]: 	nb vectors: 2542
2025-03-13 15:15:29,061 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:29,061 [INFO]: 	compression ratio: 0.999309741458472
2025-03-13 15:15:29,061 [INFO]: }
2025-03-13 15:15:29,061 [INFO]: 	>>> Finished "Creating the index" in 56.7919 secs
2025-03-13 15:15:29,061 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8238 secs
2025-03-13 15:15:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 70499 [episode count 19/20]
2025-03-13 15:15:30: [retrieval_preprocessing] finished for 8756300955_pick_up_blue_object_from_counter_put_in_open_drawer_and_close [chosen_id count 1/196]
2025-03-13 15:15:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8756300955_put_blue_block_in_drawer_and_close [chosen_id count 2/196]
2025-03-13 15:15:32: [retrieval_preprocessing] we have num_total=3023 embedding_dim=49152
[retrieval_preprocessing] for episode 50701 [episode count 0/20], we have num_retrieval=np.int64(2773) num_query=np.int64(250)
2025-03-13 15:15:32,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:33,243 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:33
2025-03-13 15:15:33,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1888.48it/s]
2025-03-13 15:15:33,384 [INFO]: There are 2773 embeddings of dim 49152
2025-03-13 15:15:33,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1414 secs
2025-03-13 15:15:33,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:33
2025-03-13 15:15:33,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:33,384 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:15:33,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:33,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:15:33,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:33
2025-03-13 15:15:33,385 [INFO]: 572.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:33,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:15:33,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:33
2025-03-13 15:15:33,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:33,385 [INFO]: 	Creating the index 03/13/2025, 15:15:33
2025-03-13 15:15:33,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:33
2025-03-13 15:15:33,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:15:33,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:33
2025-03-13 15:15:33,387 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:15:33,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.45it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.61it/s]100%|██████████| 11/11 [00:02<00:00,  3.14it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-13 15:15:36,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:36
2025-03-13 15:16:18,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5438 secs
2025-03-13 15:16:18,896 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:16:18,896 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 15:16:38,639 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7427 secs
2025-03-13 15:16:38,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2541 secs
2025-03-13 15:16:38,641 [INFO]: {
2025-03-13 15:16:38,641 [INFO]: 	index_key: HNSW15
2025-03-13 15:16:38,641 [INFO]: 	index_param: efSearch=167
2025-03-13 15:16:38,641 [INFO]: 	index_path: knn.index
2025-03-13 15:16:38,641 [INFO]: 	size in bytes: 545570530
2025-03-13 15:16:38,641 [INFO]: 	avg_search_speed_ms: 8.36839271985992
2025-03-13 15:16:38,641 [INFO]: 	99p_search_speed_ms: 12.860911530442532
2025-03-13 15:16:38,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:16:38,641 [INFO]: 	nb vectors: 2773
2025-03-13 15:16:38,641 [INFO]: 	vectors dimension: 49152
2025-03-13 15:16:38,641 [INFO]: 	compression ratio: 0.9993098124270019
2025-03-13 15:16:38,641 [INFO]: }
2025-03-13 15:16:38,641 [INFO]: 	>>> Finished "Creating the index" in 65.2565 secs
2025-03-13 15:16:38,641 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3989 secs
2025-03-13 15:16:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:16:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 50701 [episode count 0/20]
[retrieval_preprocessing] for episode 34330 [episode count 1/20], we have num_retrieval=np.int64(2891) num_query=np.int64(132)
2025-03-13 15:16:40,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:16:40,745 [INFO]: Launching the whole pipeline 03/13/2025, 15:16:40
2025-03-13 15:16:40,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:16:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 914.59it/s]
2025-03-13 15:16:40,774 [INFO]: There are 2891 embeddings of dim 49152
2025-03-13 15:16:40,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 15:16:40,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:16:40
2025-03-13 15:16:40,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:16:40,775 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:16:40,775 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:16:40,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:16:40,775 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:16:40
2025-03-13 15:16:40,775 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:16:40,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:16:40,775 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:16:40
2025-03-13 15:16:40,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:16:40,775 [INFO]: 	Creating the index 03/13/2025, 15:16:40
2025-03-13 15:16:40,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:16:40
2025-03-13 15:16:40,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:16:40,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:16:40
2025-03-13 15:16:40,776 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:16:40,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.49it/s] 42%|████▏     | 5/12 [00:00<00:00, 21.67it/s] 83%|████████▎ | 10/12 [00:00<00:00, 30.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.62it/s]
2025-03-13 15:16:43,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:16:43
2025-03-13 15:17:16,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3193 secs
2025-03-13 15:17:16,698 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 15:17:16,698 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.42it/s]
2025-03-13 15:17:34,499 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8006 secs
2025-03-13 15:17:34,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7299 secs
2025-03-13 15:17:34,506 [INFO]: {
2025-03-13 15:17:34,506 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:34,507 [INFO]: 	index_param: efSearch=209
2025-03-13 15:17:34,507 [INFO]: 	index_path: knn.index
2025-03-13 15:17:34,507 [INFO]: 	size in bytes: 568786330
2025-03-13 15:17:34,507 [INFO]: 	avg_search_speed_ms: 12.769718040303536
2025-03-13 15:17:34,507 [INFO]: 	99p_search_speed_ms: 20.96153542166575
2025-03-13 15:17:34,507 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:34,507 [INFO]: 	nb vectors: 2891
2025-03-13 15:17:34,507 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:34,507 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-13 15:17:34,507 [INFO]: }
2025-03-13 15:17:34,507 [INFO]: 	>>> Finished "Creating the index" in 53.7320 secs
2025-03-13 15:17:34,507 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7622 secs
2025-03-13 15:17:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 34330 [episode count 1/20]
[retrieval_preprocessing] for episode 94250 [episode count 2/20], we have num_retrieval=np.int64(2891) num_query=np.int64(132)
2025-03-13 15:17:38,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:39,525 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:39
2025-03-13 15:17:39,525 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.17it/s]
2025-03-13 15:17:39,563 [INFO]: There are 2891 embeddings of dim 49152
2025-03-13 15:17:39,563 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 15:17:39,563 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:39,564 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:17:39,564 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:39,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:17:39,564 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,564 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:39,564 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:39,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:39
2025-03-13 15:17:39,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:39,565 [INFO]: 	Creating the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,565 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:39
2025-03-13 15:17:39,568 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:17:39,568 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:39
2025-03-13 15:17:39,568 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:17:39,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.23it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.38it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.98it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.49it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.79it/s] 50%|█████     | 6/12 [00:00<00:00,  8.16it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.25it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.95it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.05it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.10it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.18it/s]100%|██████████| 12/12 [00:05<00:00,  1.39s/it]100%|██████████| 12/12 [00:05<00:00,  2.10it/s]
2025-03-13 15:17:45,284 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:45
2025-03-13 15:18:17,097 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8119 secs
2025-03-13 15:18:17,098 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 15:18:17,098 [INFO]: 	Compute fast metrics 03/13/2025, 15:18:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 15:18:43,828 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7304 secs
2025-03-13 15:18:43,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2624 secs
2025-03-13 15:18:43,831 [INFO]: {
2025-03-13 15:18:43,831 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:43,831 [INFO]: 	index_param: efSearch=260
2025-03-13 15:18:43,831 [INFO]: 	index_path: knn.index
2025-03-13 15:18:43,831 [INFO]: 	size in bytes: 568786330
2025-03-13 15:18:43,831 [INFO]: 	avg_search_speed_ms: 11.878301282076348
2025-03-13 15:18:43,831 [INFO]: 	99p_search_speed_ms: 18.312346446327865
2025-03-13 15:18:43,831 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:43,831 [INFO]: 	nb vectors: 2891
2025-03-13 15:18:43,831 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:43,831 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-13 15:18:43,831 [INFO]: }
2025-03-13 15:18:43,831 [INFO]: 	>>> Finished "Creating the index" in 64.2660 secs
2025-03-13 15:18:43,831 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3063 secs
2025-03-13 15:18:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 94250 [episode count 2/20]
[retrieval_preprocessing] for episode 37934 [episode count 3/20], we have num_retrieval=np.int64(2875) num_query=np.int64(148)
2025-03-13 15:18:46,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:47,842 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:47
2025-03-13 15:18:47,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1599.05it/s]
2025-03-13 15:18:47,870 [INFO]: There are 2875 embeddings of dim 49152
2025-03-13 15:18:47,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 15:18:47,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:47,871 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:18:47,871 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:47,871 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:18:47,871 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,871 [INFO]: 593.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:47,871 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:18:47,871 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:47
2025-03-13 15:18:47,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:47,871 [INFO]: 	Creating the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,871 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:47
2025-03-13 15:18:47,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:18:47,873 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:47
2025-03-13 15:18:47,873 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:18:47,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.29it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.55it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.87it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.51it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.16it/s] 92%|█████████▏| 11/12 [00:00<00:00, 12.31it/s]100%|██████████| 12/12 [00:03<00:00,  4.00it/s]
2025-03-13 15:18:50,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:50
2025-03-13 15:19:22,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5680 secs
2025-03-13 15:19:22,446 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 15:19:22,446 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 50%|█████     | 2/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 15:19:48,914 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4683 secs
2025-03-13 15:19:48,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0443 secs
2025-03-13 15:19:48,917 [INFO]: {
2025-03-13 15:19:48,917 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:48,917 [INFO]: 	index_param: efSearch=245
2025-03-13 15:19:48,917 [INFO]: 	index_path: knn.index
2025-03-13 15:19:48,917 [INFO]: 	size in bytes: 565638430
2025-03-13 15:19:48,917 [INFO]: 	avg_search_speed_ms: 10.457612737033235
2025-03-13 15:19:48,918 [INFO]: 	99p_search_speed_ms: 16.084593825507913
2025-03-13 15:19:48,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:48,918 [INFO]: 	nb vectors: 2875
2025-03-13 15:19:48,918 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:48,918 [INFO]: 	compression ratio: 0.9993097534055456
2025-03-13 15:19:48,918 [INFO]: }
2025-03-13 15:19:48,918 [INFO]: 	>>> Finished "Creating the index" in 61.0466 secs
2025-03-13 15:19:48,918 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0757 secs
2025-03-13 15:19:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 37934 [episode count 3/20]
[retrieval_preprocessing] for episode 74290 [episode count 4/20], we have num_retrieval=np.int64(2868) num_query=np.int64(155)
2025-03-13 15:19:57,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:58,048 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:58
2025-03-13 15:19:58,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-13 15:19:58,078 [INFO]: There are 2868 embeddings of dim 49152
2025-03-13 15:19:58,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:19:58,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:58
2025-03-13 15:19:58,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:58,079 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:19:58,079 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:58,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:19:58,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:58
2025-03-13 15:19:58,080 [INFO]: 591.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:58,080 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:19:58,080 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:58
2025-03-13 15:19:58,080 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:58,080 [INFO]: 	Creating the index 03/13/2025, 15:19:58
2025-03-13 15:19:58,080 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:58
2025-03-13 15:19:58,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:19:58,084 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:58
2025-03-13 15:19:58,084 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:19:58,084 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.82it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.18it/s] 42%|████▏     | 5/12 [00:00<00:00, 13.39it/s] 67%|██████▋   | 8/12 [00:00<00:00, 16.30it/s] 83%|████████▎ | 10/12 [00:00<00:00, 17.34it/s]100%|██████████| 12/12 [00:03<00:00,  2.28it/s]100%|██████████| 12/12 [00:03<00:00,  3.82it/s]
2025-03-13 15:20:01,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:01
2025-03-13 15:20:36,528 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1655 secs
2025-03-13 15:20:36,528 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:20:36,528 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 15:21:02,492 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9633 secs
2025-03-13 15:21:02,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4105 secs
2025-03-13 15:21:02,495 [INFO]: {
2025-03-13 15:21:02,495 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:02,495 [INFO]: 	index_param: efSearch=211
2025-03-13 15:21:02,495 [INFO]: 	index_path: knn.index
2025-03-13 15:21:02,495 [INFO]: 	size in bytes: 564261250
2025-03-13 15:21:02,495 [INFO]: 	avg_search_speed_ms: 9.72402797683943
2025-03-13 15:21:02,495 [INFO]: 	99p_search_speed_ms: 14.985301489941776
2025-03-13 15:21:02,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:02,495 [INFO]: 	nb vectors: 2868
2025-03-13 15:21:02,495 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:02,495 [INFO]: 	compression ratio: 0.9993097062752404
2025-03-13 15:21:02,495 [INFO]: }
2025-03-13 15:21:02,495 [INFO]: 	>>> Finished "Creating the index" in 64.4145 secs
2025-03-13 15:21:02,495 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4464 secs
2025-03-13 15:21:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 74290 [episode count 4/20]
[retrieval_preprocessing] for episode 55863 [episode count 5/20], we have num_retrieval=np.int64(2851) num_query=np.int64(172)
2025-03-13 15:21:05,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:05,726 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:05
2025-03-13 15:21:05,726 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 967.10it/s]
2025-03-13 15:21:05,755 [INFO]: There are 2851 embeddings of dim 49152
2025-03-13 15:21:05,755 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 15:21:05,755 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:05
2025-03-13 15:21:05,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:05,756 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:21:05,756 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:05,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:21:05,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:05
2025-03-13 15:21:05,756 [INFO]: 588.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:05,757 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:21:05,757 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:05
2025-03-13 15:21:05,757 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:05,757 [INFO]: 	Creating the index 03/13/2025, 15:21:05
2025-03-13 15:21:05,757 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:05
2025-03-13 15:21:05,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:21:05,761 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:05
2025-03-13 15:21:05,761 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:21:05,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.66it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.32it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.01it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.46it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.67it/s] 50%|█████     | 6/12 [00:00<00:00,  8.93it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.12it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.15it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.28it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.44it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.51it/s]100%|██████████| 12/12 [00:03<00:00,  1.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.46it/s]
2025-03-13 15:21:09,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:09
2025-03-13 15:21:45,448 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2119 secs
2025-03-13 15:21:45,449 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:21:45,449 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.12it/s] 50%|█████     | 2/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 15:22:12,792 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3434 secs
2025-03-13 15:22:12,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0339 secs
2025-03-13 15:22:12,795 [INFO]: {
2025-03-13 15:22:12,795 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:12,795 [INFO]: 	index_param: efSearch=156
2025-03-13 15:22:12,795 [INFO]: 	index_path: knn.index
2025-03-13 15:22:12,795 [INFO]: 	size in bytes: 560916610
2025-03-13 15:22:12,795 [INFO]: 	avg_search_speed_ms: 8.763868708406738
2025-03-13 15:22:12,795 [INFO]: 	99p_search_speed_ms: 16.73903488554059
2025-03-13 15:22:12,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:12,795 [INFO]: 	nb vectors: 2851
2025-03-13 15:22:12,795 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:12,795 [INFO]: 	compression ratio: 0.999309697746337
2025-03-13 15:22:12,795 [INFO]: }
2025-03-13 15:22:12,795 [INFO]: 	>>> Finished "Creating the index" in 67.0378 secs
2025-03-13 15:22:12,795 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0692 secs
2025-03-13 15:22:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 55863 [episode count 5/20]
[retrieval_preprocessing] for episode 62075 [episode count 6/20], we have num_retrieval=np.int64(2918) num_query=np.int64(105)
2025-03-13 15:22:14,971 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:15,388 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:15
2025-03-13 15:22:15,388 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-13 15:22:15,413 [INFO]: There are 2918 embeddings of dim 49152
2025-03-13 15:22:15,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:22:15,414 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:15
2025-03-13 15:22:15,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:15,414 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:22:15,414 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:15,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:15,414 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:15
2025-03-13 15:22:15,414 [INFO]: 602.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:15,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:22:15,414 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:15
2025-03-13 15:22:15,414 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:15,414 [INFO]: 	Creating the index 03/13/2025, 15:22:15
2025-03-13 15:22:15,414 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:15
2025-03-13 15:22:15,415 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:22:15,415 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:15
2025-03-13 15:22:15,415 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:22:15,415 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.40it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.06it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.40it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.00it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.28it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.56it/s]100%|██████████| 12/12 [00:03<00:00,  3.97it/s]
2025-03-13 15:22:18,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:18
2025-03-13 15:22:50,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5668 secs
2025-03-13 15:22:50,007 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 15:22:50,007 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-13 15:23:18,968 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9610 secs
2025-03-13 15:23:18,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5560 secs
2025-03-13 15:23:18,971 [INFO]: {
2025-03-13 15:23:18,971 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:18,971 [INFO]: 	index_param: efSearch=260
2025-03-13 15:23:18,971 [INFO]: 	index_path: knn.index
2025-03-13 15:23:18,971 [INFO]: 	size in bytes: 574098370
2025-03-13 15:23:18,971 [INFO]: 	avg_search_speed_ms: 13.1674329030303
2025-03-13 15:23:18,971 [INFO]: 	99p_search_speed_ms: 25.883466477971485
2025-03-13 15:23:18,971 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:18,972 [INFO]: 	nb vectors: 2918
2025-03-13 15:23:18,972 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:18,972 [INFO]: 	compression ratio: 0.9993098290803368
2025-03-13 15:23:18,972 [INFO]: }
2025-03-13 15:23:18,972 [INFO]: 	>>> Finished "Creating the index" in 63.5576 secs
2025-03-13 15:23:18,972 [INFO]: >>> Finished "Launching the whole pipeline" in 63.5835 secs
2025-03-13 15:23:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 62075 [episode count 6/20]
[retrieval_preprocessing] for episode 27761 [episode count 7/20], we have num_retrieval=np.int64(2880) num_query=np.int64(143)
2025-03-13 15:23:22,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:23:22,990 [INFO]: Launching the whole pipeline 03/13/2025, 15:23:22
2025-03-13 15:23:22,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:23:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.59it/s]
2025-03-13 15:23:23,017 [INFO]: There are 2880 embeddings of dim 49152
2025-03-13 15:23:23,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:23:23,017 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:23:23,018 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:23:23,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:23:23,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:23:23,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,018 [INFO]: 594.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:23:23,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:23:23,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:23:23
2025-03-13 15:23:23,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:23:23,018 [INFO]: 	Creating the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:23:23
2025-03-13 15:23:23,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:23:23,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:23:23
2025-03-13 15:23:23,019 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:23:23,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.21it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.48it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.05it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.18it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.52it/s] 50%|█████     | 6/12 [00:00<00:00,  7.73it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.97it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.02it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.04it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.20it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.21it/s]100%|██████████| 12/12 [00:04<00:00,  1.14it/s]100%|██████████| 12/12 [00:04<00:00,  2.98it/s]
2025-03-13 15:23:27,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:27
2025-03-13 15:24:00,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1558 secs
2025-03-13 15:24:00,210 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:24:00,210 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 15:24:17,320 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1101 secs
2025-03-13 15:24:17,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3037 secs
2025-03-13 15:24:17,323 [INFO]: {
2025-03-13 15:24:17,323 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:17,323 [INFO]: 	index_param: efSearch=231
2025-03-13 15:24:17,323 [INFO]: 	index_path: knn.index
2025-03-13 15:24:17,323 [INFO]: 	size in bytes: 566622190
2025-03-13 15:24:17,323 [INFO]: 	avg_search_speed_ms: 12.98967029947739
2025-03-13 15:24:17,323 [INFO]: 	99p_search_speed_ms: 26.06868132483213
2025-03-13 15:24:17,323 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:17,323 [INFO]: 	nb vectors: 2880
2025-03-13 15:24:17,323 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:17,323 [INFO]: 	compression ratio: 0.9993096811122063
2025-03-13 15:24:17,323 [INFO]: }
2025-03-13 15:24:17,323 [INFO]: 	>>> Finished "Creating the index" in 54.3054 secs
2025-03-13 15:24:17,323 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3329 secs
2025-03-13 15:24:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 27761 [episode count 7/20]
[retrieval_preprocessing] for episode 92788 [episode count 8/20], we have num_retrieval=np.int64(2881) num_query=np.int64(142)
2025-03-13 15:24:20,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:21,454 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:21
2025-03-13 15:24:21,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.38it/s]
2025-03-13 15:24:21,482 [INFO]: There are 2881 embeddings of dim 49152
2025-03-13 15:24:21,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 15:24:21,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:21
2025-03-13 15:24:21,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:21,483 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:24:21,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:21,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:24:21,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:21
2025-03-13 15:24:21,484 [INFO]: 594.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:21,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:24:21,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:21
2025-03-13 15:24:21,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:21,484 [INFO]: 	Creating the index 03/13/2025, 15:24:21
2025-03-13 15:24:21,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:21
2025-03-13 15:24:21,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:24:21,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:21
2025-03-13 15:24:21,486 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:24:21,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.24it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.34it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.82it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.89it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.16it/s] 50%|█████     | 6/12 [00:00<00:00,  7.29it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.37it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.47it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.57it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.76it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.96it/s]100%|██████████| 12/12 [00:03<00:00,  1.41it/s]100%|██████████| 12/12 [00:03<00:00,  3.39it/s]
2025-03-13 15:24:25,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:25
2025-03-13 15:24:54,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7367 secs
2025-03-13 15:24:54,771 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 15:24:54,771 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-13 15:25:17,643 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8719 secs
2025-03-13 15:25:17,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1598 secs
2025-03-13 15:25:17,646 [INFO]: {
2025-03-13 15:25:17,646 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:17,646 [INFO]: 	index_param: efSearch=305
2025-03-13 15:25:17,646 [INFO]: 	index_path: knn.index
2025-03-13 15:25:17,646 [INFO]: 	size in bytes: 566818930
2025-03-13 15:25:17,646 [INFO]: 	avg_search_speed_ms: 13.977700502965495
2025-03-13 15:25:17,646 [INFO]: 	99p_search_speed_ms: 26.33804216748107
2025-03-13 15:25:17,646 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:17,646 [INFO]: 	nb vectors: 2881
2025-03-13 15:25:17,646 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:17,646 [INFO]: 	compression ratio: 0.9993096878398187
2025-03-13 15:25:17,646 [INFO]: }
2025-03-13 15:25:17,646 [INFO]: 	>>> Finished "Creating the index" in 56.1620 secs
2025-03-13 15:25:17,646 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1916 secs
2025-03-13 15:25:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 92788 [episode count 8/20]
[retrieval_preprocessing] for episode 33498 [episode count 9/20], we have num_retrieval=np.int64(2889) num_query=np.int64(134)
2025-03-13 15:25:21,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:22,210 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:22
2025-03-13 15:25:22,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-13 15:25:22,236 [INFO]: There are 2889 embeddings of dim 49152
2025-03-13 15:25:22,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:25:22,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:22
2025-03-13 15:25:22,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:22,236 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:25:22,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:22,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:22,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:22
2025-03-13 15:25:22,237 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:22,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:25:22,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:22
2025-03-13 15:25:22,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:22,237 [INFO]: 	Creating the index 03/13/2025, 15:25:22
2025-03-13 15:25:22,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:22
2025-03-13 15:25:22,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:22,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:22
2025-03-13 15:25:22,238 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:25:22,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.13it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.07it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.63it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.04it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.55it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.81it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.02it/s]100%|██████████| 12/12 [00:03<00:00,  3.74it/s]
2025-03-13 15:25:25,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:25
2025-03-13 15:25:55,931 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4778 secs
2025-03-13 15:25:55,932 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:25:55,932 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-13 15:26:22,462 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5304 secs
2025-03-13 15:26:22,466 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2280 secs
2025-03-13 15:26:22,466 [INFO]: {
2025-03-13 15:26:22,466 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:22,466 [INFO]: 	index_param: efSearch=196
2025-03-13 15:26:22,466 [INFO]: 	index_path: knn.index
2025-03-13 15:26:22,466 [INFO]: 	size in bytes: 568392850
2025-03-13 15:26:22,466 [INFO]: 	avg_search_speed_ms: 9.868692715173294
2025-03-13 15:26:22,466 [INFO]: 	99p_search_speed_ms: 15.031358897686005
2025-03-13 15:26:22,466 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:22,466 [INFO]: 	nb vectors: 2889
2025-03-13 15:26:22,466 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:22,466 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-13 15:26:22,466 [INFO]: }
2025-03-13 15:26:22,466 [INFO]: 	>>> Finished "Creating the index" in 60.2297 secs
2025-03-13 15:26:22,466 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2562 secs
2025-03-13 15:26:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 33498 [episode count 9/20]
[retrieval_preprocessing] for episode 74458 [episode count 10/20], we have num_retrieval=np.int64(2902) num_query=np.int64(121)
2025-03-13 15:26:24,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:24,919 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:24
2025-03-13 15:26:24,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 966.21it/s]
2025-03-13 15:26:24,952 [INFO]: There are 2902 embeddings of dim 49152
2025-03-13 15:26:24,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 15:26:24,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:24
2025-03-13 15:26:24,952 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:24,952 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:26:24,953 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:24,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:26:24,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:24
2025-03-13 15:26:24,953 [INFO]: 598.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:24,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:26:24,953 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:24
2025-03-13 15:26:24,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:24,953 [INFO]: 	Creating the index 03/13/2025, 15:26:24
2025-03-13 15:26:24,953 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:24
2025-03-13 15:26:24,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:26:24,954 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:24
2025-03-13 15:26:24,955 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:26:24,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.20it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.74it/s] 75%|███████▌  | 9/12 [00:00<00:00, 30.26it/s]100%|██████████| 12/12 [00:03<00:00,  3.94it/s]
2025-03-13 15:26:28,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:28
2025-03-13 15:27:09,236 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2350 secs
2025-03-13 15:27:09,237 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 15:27:09,237 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.91it/s]
2025-03-13 15:27:40,992 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7548 secs
2025-03-13 15:27:41,507 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5525 secs
2025-03-13 15:27:41,508 [INFO]: {
2025-03-13 15:27:41,508 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:41,508 [INFO]: 	index_param: efSearch=153
2025-03-13 15:27:41,508 [INFO]: 	index_path: knn.index
2025-03-13 15:27:41,508 [INFO]: 	size in bytes: 570950470
2025-03-13 15:27:41,508 [INFO]: 	avg_search_speed_ms: 9.995541460421327
2025-03-13 15:27:41,508 [INFO]: 	99p_search_speed_ms: 17.364138970151544
2025-03-13 15:27:41,508 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:41,508 [INFO]: 	nb vectors: 2902
2025-03-13 15:27:41,508 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:41,508 [INFO]: 	compression ratio: 0.9993098280486572
2025-03-13 15:27:41,508 [INFO]: }
2025-03-13 15:27:41,508 [INFO]: 	>>> Finished "Creating the index" in 76.5553 secs
2025-03-13 15:27:41,508 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5891 secs
2025-03-13 15:27:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 74458 [episode count 10/20]
[retrieval_preprocessing] for episode 55471 [episode count 11/20], we have num_retrieval=np.int64(2858) num_query=np.int64(165)
2025-03-13 15:27:42,883 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:43,445 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:43
2025-03-13 15:27:43,446 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.65it/s]
2025-03-13 15:27:43,493 [INFO]: There are 2858 embeddings of dim 49152
2025-03-13 15:27:43,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0478 secs
2025-03-13 15:27:43,493 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:43
2025-03-13 15:27:43,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:43,494 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:27:43,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:43,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:27:43,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:43
2025-03-13 15:27:43,494 [INFO]: 589.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:43,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:27:43,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:43
2025-03-13 15:27:43,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:43,494 [INFO]: 	Creating the index 03/13/2025, 15:27:43
2025-03-13 15:27:43,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:43
2025-03-13 15:27:43,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 15:27:43,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:43
2025-03-13 15:27:43,496 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:27:43,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.66it/s] 42%|████▏     | 5/12 [00:00<00:00, 25.42it/s] 75%|███████▌  | 9/12 [00:00<00:00, 31.38it/s]100%|██████████| 12/12 [00:02<00:00,  4.13it/s]
2025-03-13 15:27:46,406 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:46
2025-03-13 15:28:27,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8251 secs
2025-03-13 15:28:27,232 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:28:27,232 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.60it/s]
2025-03-13 15:28:49,969 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7365 secs
2025-03-13 15:28:49,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4760 secs
2025-03-13 15:28:49,973 [INFO]: {
2025-03-13 15:28:49,973 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:49,973 [INFO]: 	index_param: efSearch=176
2025-03-13 15:28:49,973 [INFO]: 	index_path: knn.index
2025-03-13 15:28:49,973 [INFO]: 	size in bytes: 562293790
2025-03-13 15:28:49,973 [INFO]: 	avg_search_speed_ms: 10.69714688262678
2025-03-13 15:28:49,973 [INFO]: 	99p_search_speed_ms: 15.616569714620708
2025-03-13 15:28:49,973 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:49,973 [INFO]: 	nb vectors: 2858
2025-03-13 15:28:49,973 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:49,973 [INFO]: 	compression ratio: 0.9993097451778722
2025-03-13 15:28:49,973 [INFO]: }
2025-03-13 15:28:49,973 [INFO]: 	>>> Finished "Creating the index" in 66.4789 secs
2025-03-13 15:28:49,973 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5276 secs
2025-03-13 15:28:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 55471 [episode count 11/20]
[retrieval_preprocessing] for episode 40651 [episode count 12/20], we have num_retrieval=np.int64(2878) num_query=np.int64(145)
2025-03-13 15:28:53,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:53,768 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:53
2025-03-13 15:28:53,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1385.17it/s]
2025-03-13 15:28:53,800 [INFO]: There are 2878 embeddings of dim 49152
2025-03-13 15:28:53,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 15:28:53,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:53
2025-03-13 15:28:53,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:53,800 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:28:53,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:53,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:53,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:53
2025-03-13 15:28:53,801 [INFO]: 593.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:53,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:28:53,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:53
2025-03-13 15:28:53,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:53,801 [INFO]: 	Creating the index 03/13/2025, 15:28:53
2025-03-13 15:28:53,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:53
2025-03-13 15:28:53,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:28:53,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:53
2025-03-13 15:28:53,802 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:28:53,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.41it/s] 50%|█████     | 6/12 [00:00<00:00, 28.60it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.83it/s]100%|██████████| 12/12 [00:02<00:00,  4.61it/s]
2025-03-13 15:28:56,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:56
2025-03-13 15:29:34,236 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8236 secs
2025-03-13 15:29:34,237 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 15:29:34,237 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 15:29:58,010 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7736 secs
2025-03-13 15:29:58,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2117 secs
2025-03-13 15:29:58,014 [INFO]: {
2025-03-13 15:29:58,014 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:58,014 [INFO]: 	index_param: efSearch=251
2025-03-13 15:29:58,014 [INFO]: 	index_path: knn.index
2025-03-13 15:29:58,014 [INFO]: 	size in bytes: 566228650
2025-03-13 15:29:58,014 [INFO]: 	avg_search_speed_ms: 13.917000549139457
2025-03-13 15:29:58,014 [INFO]: 	99p_search_speed_ms: 21.355422828346494
2025-03-13 15:29:58,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:58,015 [INFO]: 	nb vectors: 2878
2025-03-13 15:29:58,015 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:58,015 [INFO]: 	compression ratio: 0.9993097735340661
2025-03-13 15:29:58,015 [INFO]: }
2025-03-13 15:29:58,015 [INFO]: 	>>> Finished "Creating the index" in 64.2136 secs
2025-03-13 15:29:58,015 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2461 secs
2025-03-13 15:29:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 40651 [episode count 12/20]
[retrieval_preprocessing] for episode 73030 [episode count 13/20], we have num_retrieval=np.int64(2883) num_query=np.int64(140)
2025-03-13 15:30:00,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:01,689 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:01
2025-03-13 15:30:01,689 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.38it/s]
2025-03-13 15:30:01,738 [INFO]: There are 2883 embeddings of dim 49152
2025-03-13 15:30:01,738 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0489 secs
2025-03-13 15:30:01,738 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,738 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:01,738 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:30:01,738 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:01,738 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:30:01,738 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,738 [INFO]: 595.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:01,739 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:30:01,739 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:01
2025-03-13 15:30:01,739 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:01,739 [INFO]: 	Creating the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,739 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:01
2025-03-13 15:30:01,740 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:30:01,740 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:01
2025-03-13 15:30:01,740 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:30:01,740 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.27it/s] 33%|███▎      | 4/12 [00:00<00:00, 14.60it/s] 67%|██████▋   | 8/12 [00:00<00:00, 22.37it/s]100%|██████████| 12/12 [00:03<00:00,  2.81it/s]100%|██████████| 12/12 [00:03<00:00,  3.65it/s]
2025-03-13 15:30:05,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:05
2025-03-13 15:30:44,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6593 secs
2025-03-13 15:30:44,694 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:30:44,694 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.23it/s]
2025-03-13 15:31:05,552 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8579 secs
2025-03-13 15:31:05,554 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8139 secs
2025-03-13 15:31:05,554 [INFO]: {
2025-03-13 15:31:05,554 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:05,554 [INFO]: 	index_param: efSearch=167
2025-03-13 15:31:05,554 [INFO]: 	index_path: knn.index
2025-03-13 15:31:05,554 [INFO]: 	size in bytes: 567212410
2025-03-13 15:31:05,554 [INFO]: 	avg_search_speed_ms: 9.936550384953382
2025-03-13 15:31:05,554 [INFO]: 	99p_search_speed_ms: 16.803468056023117
2025-03-13 15:31:05,554 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:05,554 [INFO]: 	nb vectors: 2883
2025-03-13 15:31:05,554 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:05,554 [INFO]: 	compression ratio: 0.9993097012810421
2025-03-13 15:31:05,555 [INFO]: }
2025-03-13 15:31:05,555 [INFO]: 	>>> Finished "Creating the index" in 63.8158 secs
2025-03-13 15:31:05,555 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8656 secs
2025-03-13 15:31:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 73030 [episode count 13/20]
[retrieval_preprocessing] for episode 44361 [episode count 14/20], we have num_retrieval=np.int64(2890) num_query=np.int64(133)
2025-03-13 15:31:06,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:07,318 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:07
2025-03-13 15:31:07,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-13 15:31:07,345 [INFO]: There are 2890 embeddings of dim 49152
2025-03-13 15:31:07,345 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:31:07,345 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:07
2025-03-13 15:31:07,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:07,345 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:31:07,345 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:07,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:07,345 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:07
2025-03-13 15:31:07,345 [INFO]: 596.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:07,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:31:07,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:07
2025-03-13 15:31:07,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:07,345 [INFO]: 	Creating the index 03/13/2025, 15:31:07
2025-03-13 15:31:07,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:07
2025-03-13 15:31:07,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:31:07,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:07
2025-03-13 15:31:07,347 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:31:07,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.17it/s] 50%|█████     | 6/12 [00:00<00:00, 29.34it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.78it/s]100%|██████████| 12/12 [00:02<00:00,  5.09it/s]
2025-03-13 15:31:09,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:09
2025-03-13 15:31:43,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8418 secs
2025-03-13 15:31:43,552 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 15:31:43,552 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 15:32:09,188 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6364 secs
2025-03-13 15:32:09,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9700 secs
2025-03-13 15:32:09,317 [INFO]: {
2025-03-13 15:32:09,317 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:09,317 [INFO]: 	index_param: efSearch=254
2025-03-13 15:32:09,317 [INFO]: 	index_path: knn.index
2025-03-13 15:32:09,317 [INFO]: 	size in bytes: 568589590
2025-03-13 15:32:09,317 [INFO]: 	avg_search_speed_ms: 13.351911300288462
2025-03-13 15:32:09,317 [INFO]: 	99p_search_speed_ms: 22.57895315997301
2025-03-13 15:32:09,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:09,317 [INFO]: 	nb vectors: 2890
2025-03-13 15:32:09,318 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:09,318 [INFO]: 	compression ratio: 0.9993097481788226
2025-03-13 15:32:09,318 [INFO]: }
2025-03-13 15:32:09,318 [INFO]: 	>>> Finished "Creating the index" in 61.9722 secs
2025-03-13 15:32:09,318 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9999 secs
2025-03-13 15:32:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 44361 [episode count 14/20]
[retrieval_preprocessing] for episode 5542 [episode count 15/20], we have num_retrieval=np.int64(2848) num_query=np.int64(175)
2025-03-13 15:32:14,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:14,743 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:14
2025-03-13 15:32:14,743 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1263.34it/s]
2025-03-13 15:32:14,779 [INFO]: There are 2848 embeddings of dim 49152
2025-03-13 15:32:14,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 15:32:14,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:14
2025-03-13 15:32:14,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:14,779 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:32:14,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:14,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:14,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:14
2025-03-13 15:32:14,779 [INFO]: 587.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:14,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:32:14,779 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:14
2025-03-13 15:32:14,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:14,779 [INFO]: 	Creating the index 03/13/2025, 15:32:14
2025-03-13 15:32:14,779 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:14
2025-03-13 15:32:14,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:32:14,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:14
2025-03-13 15:32:14,780 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:32:14,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.89it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.97it/s]100%|██████████| 12/12 [00:02<00:00,  3.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.58it/s]
2025-03-13 15:32:17,607 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:17
2025-03-13 15:32:53,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3787 secs
2025-03-13 15:32:53,987 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:32:53,987 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-13 15:33:10,314 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3271 secs
2025-03-13 15:33:10,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5354 secs
2025-03-13 15:33:10,316 [INFO]: {
2025-03-13 15:33:10,316 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:10,316 [INFO]: 	index_param: efSearch=179
2025-03-13 15:33:10,316 [INFO]: 	index_path: knn.index
2025-03-13 15:33:10,316 [INFO]: 	size in bytes: 560326390
2025-03-13 15:33:10,316 [INFO]: 	avg_search_speed_ms: 10.873359499711786
2025-03-13 15:33:10,316 [INFO]: 	99p_search_speed_ms: 17.92652738047763
2025-03-13 15:33:10,316 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:10,316 [INFO]: 	nb vectors: 2848
2025-03-13 15:33:10,316 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:10,316 [INFO]: 	compression ratio: 0.9993096773471619
2025-03-13 15:33:10,316 [INFO]: }
2025-03-13 15:33:10,316 [INFO]: 	>>> Finished "Creating the index" in 55.5368 secs
2025-03-13 15:33:10,316 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5736 secs
2025-03-13 15:33:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 5542 [episode count 15/20]
[retrieval_preprocessing] for episode 56803 [episode count 16/20], we have num_retrieval=np.int64(2887) num_query=np.int64(136)
2025-03-13 15:33:11,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:12,441 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:12
2025-03-13 15:33:12,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]
2025-03-13 15:33:12,470 [INFO]: There are 2887 embeddings of dim 49152
2025-03-13 15:33:12,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:33:12,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:12
2025-03-13 15:33:12,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:12,470 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:33:12,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:12,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:33:12,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:12
2025-03-13 15:33:12,470 [INFO]: 595.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:12,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:33:12,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:12
2025-03-13 15:33:12,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:12,470 [INFO]: 	Creating the index 03/13/2025, 15:33:12
2025-03-13 15:33:12,471 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:12
2025-03-13 15:33:12,471 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:33:12,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:12
2025-03-13 15:33:12,472 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:33:12,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.10it/s] 50%|█████     | 6/12 [00:00<00:00, 30.07it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.87it/s]100%|██████████| 12/12 [00:02<00:00,  4.11it/s]
2025-03-13 15:33:15,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:15
2025-03-13 15:33:46,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0771 secs
2025-03-13 15:33:46,475 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 15:33:46,475 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 15:34:11,469 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9944 secs
2025-03-13 15:34:11,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9997 secs
2025-03-13 15:34:11,472 [INFO]: {
2025-03-13 15:34:11,472 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:11,472 [INFO]: 	index_param: efSearch=288
2025-03-13 15:34:11,472 [INFO]: 	index_path: knn.index
2025-03-13 15:34:11,472 [INFO]: 	size in bytes: 567999370
2025-03-13 15:34:11,472 [INFO]: 	avg_search_speed_ms: 15.600645302267463
2025-03-13 15:34:11,472 [INFO]: 	99p_search_speed_ms: 25.604976341128378
2025-03-13 15:34:11,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:11,472 [INFO]: 	nb vectors: 2887
2025-03-13 15:34:11,472 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:11,472 [INFO]: 	compression ratio: 0.999309728107621
2025-03-13 15:34:11,472 [INFO]: }
2025-03-13 15:34:11,472 [INFO]: 	>>> Finished "Creating the index" in 59.0013 secs
2025-03-13 15:34:11,472 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0311 secs
2025-03-13 15:34:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 56803 [episode count 16/20]
[retrieval_preprocessing] for episode 50133 [episode count 17/20], we have num_retrieval=np.int64(2845) num_query=np.int64(178)
2025-03-13 15:34:15,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:15,939 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:15
2025-03-13 15:34:15,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1931.97it/s]
2025-03-13 15:34:15,981 [INFO]: There are 2845 embeddings of dim 49152
2025-03-13 15:34:15,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0417 secs
2025-03-13 15:34:15,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:15
2025-03-13 15:34:15,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:15,982 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:34:15,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:15,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:34:15,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:15
2025-03-13 15:34:15,983 [INFO]: 587.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:15,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:34:15,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:15
2025-03-13 15:34:15,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:15,984 [INFO]: 	Creating the index 03/13/2025, 15:34:15
2025-03-13 15:34:15,984 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:15
2025-03-13 15:34:15,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:34:15,987 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:15
2025-03-13 15:34:15,987 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:34:15,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.69it/s] 50%|█████     | 6/12 [00:00<00:00, 28.72it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.20it/s]100%|██████████| 12/12 [00:02<00:00,  4.36it/s]
2025-03-13 15:34:18,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:18
2025-03-13 15:34:57,962 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2166 secs
2025-03-13 15:34:57,962 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 15:34:57,962 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-13 15:35:18,568 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6061 secs
2025-03-13 15:35:18,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5837 secs
2025-03-13 15:35:18,571 [INFO]: {
2025-03-13 15:35:18,571 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:18,571 [INFO]: 	index_param: efSearch=99
2025-03-13 15:35:18,571 [INFO]: 	index_path: knn.index
2025-03-13 15:35:18,571 [INFO]: 	size in bytes: 559736170
2025-03-13 15:35:18,571 [INFO]: 	avg_search_speed_ms: 6.284569760217869
2025-03-13 15:35:18,571 [INFO]: 	99p_search_speed_ms: 10.45404630713164
2025-03-13 15:35:18,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:18,571 [INFO]: 	nb vectors: 2845
2025-03-13 15:35:18,571 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:18,571 [INFO]: 	compression ratio: 0.9993096569049665
2025-03-13 15:35:18,571 [INFO]: }
2025-03-13 15:35:18,571 [INFO]: 	>>> Finished "Creating the index" in 62.5871 secs
2025-03-13 15:35:18,571 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6313 secs
2025-03-13 15:35:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 50133 [episode count 17/20]
[retrieval_preprocessing] for episode 88529 [episode count 18/20], we have num_retrieval=np.int64(2812) num_query=np.int64(211)
2025-03-13 15:35:19,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:20,224 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:20
2025-03-13 15:35:20,225 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]
2025-03-13 15:35:20,251 [INFO]: There are 2812 embeddings of dim 49152
2025-03-13 15:35:20,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:35:20,251 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:20
2025-03-13 15:35:20,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:20,251 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:35:20,251 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:20,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:35:20,251 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:20
2025-03-13 15:35:20,251 [INFO]: 580.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:20,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:35:20,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:20
2025-03-13 15:35:20,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:20,251 [INFO]: 	Creating the index 03/13/2025, 15:35:20
2025-03-13 15:35:20,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:20
2025-03-13 15:35:20,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:35:20,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:20
2025-03-13 15:35:20,252 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:35:20,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.08it/s] 50%|█████     | 6/12 [00:00<00:00, 30.35it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.13it/s]100%|██████████| 12/12 [00:02<00:00,  4.42it/s]
2025-03-13 15:35:22,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:22
2025-03-13 15:35:57,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3555 secs
2025-03-13 15:35:57,329 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:35:57,329 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 15:36:22,734 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4047 secs
2025-03-13 15:36:22,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4837 secs
2025-03-13 15:36:22,736 [INFO]: {
2025-03-13 15:36:22,736 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:22,736 [INFO]: 	index_param: efSearch=185
2025-03-13 15:36:22,736 [INFO]: 	index_path: knn.index
2025-03-13 15:36:22,736 [INFO]: 	size in bytes: 553243570
2025-03-13 15:36:22,736 [INFO]: 	avg_search_speed_ms: 10.329456399300728
2025-03-13 15:36:22,736 [INFO]: 	99p_search_speed_ms: 16.25786377349874
2025-03-13 15:36:22,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:22,736 [INFO]: 	nb vectors: 2812
2025-03-13 15:36:22,736 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:22,736 [INFO]: 	compression ratio: 0.9993097542914054
2025-03-13 15:36:22,736 [INFO]: }
2025-03-13 15:36:22,736 [INFO]: 	>>> Finished "Creating the index" in 62.4850 secs
2025-03-13 15:36:22,736 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5118 secs
2025-03-13 15:36:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 88529 [episode count 18/20]
[retrieval_preprocessing] for episode 85787 [episode count 19/20], we have num_retrieval=np.int64(2917) num_query=np.int64(106)
2025-03-13 15:36:24,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:24,878 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:24
2025-03-13 15:36:24,878 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.95it/s]
2025-03-13 15:36:24,923 [INFO]: There are 2917 embeddings of dim 49152
2025-03-13 15:36:24,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0449 secs
2025-03-13 15:36:24,923 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,924 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:24,924 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:36:24,924 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:24,924 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:36:24,924 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,924 [INFO]: 602.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:24,924 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:36:24,924 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:24
2025-03-13 15:36:24,924 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:24,924 [INFO]: 	Creating the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,924 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:24
2025-03-13 15:36:24,926 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:36:24,926 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:24
2025-03-13 15:36:24,926 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:36:24,926 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.68it/s] 67%|██████▋   | 8/12 [00:00<00:00, 35.63it/s]100%|██████████| 12/12 [00:02<00:00,  3.16it/s]100%|██████████| 12/12 [00:02<00:00,  4.09it/s]
2025-03-13 15:36:27,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:27
2025-03-13 15:37:03,274 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4064 secs
2025-03-13 15:37:03,274 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:37:03,275 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 15:37:26,365 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0906 secs
2025-03-13 15:37:26,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4423 secs
2025-03-13 15:37:26,369 [INFO]: {
2025-03-13 15:37:26,369 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:26,369 [INFO]: 	index_param: efSearch=190
2025-03-13 15:37:26,369 [INFO]: 	index_path: knn.index
2025-03-13 15:37:26,369 [INFO]: 	size in bytes: 573901630
2025-03-13 15:37:26,369 [INFO]: 	avg_search_speed_ms: 14.682750577974119
2025-03-13 15:37:26,369 [INFO]: 	99p_search_speed_ms: 22.844698792323484
2025-03-13 15:37:26,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:26,369 [INFO]: 	nb vectors: 2917
2025-03-13 15:37:26,369 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:26,369 [INFO]: 	compression ratio: 0.9993098224864774
2025-03-13 15:37:26,369 [INFO]: }
2025-03-13 15:37:26,369 [INFO]: 	>>> Finished "Creating the index" in 61.4447 secs
2025-03-13 15:37:26,369 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4904 secs
2025-03-13 15:37:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 85787 [episode count 19/20]
2025-03-13 15:37:27: [retrieval_preprocessing] finished for 8756300955_put_blue_block_in_drawer_and_close [chosen_id count 2/196]
2025-03-13 15:37:30: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8791475098_hang_towel_on_drawer [chosen_id count 3/196]
2025-03-13 15:37:30: [retrieval_preprocessing] we have num_total=5847 embedding_dim=49152
[retrieval_preprocessing] for episode 37509 [episode count 0/20], we have num_retrieval=np.int64(5549) num_query=np.int64(298)
2025-03-13 15:37:31,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:32,823 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:32
2025-03-13 15:37:32,823 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.87it/s]
2025-03-13 15:37:32,866 [INFO]: There are 5549 embeddings of dim 49152
2025-03-13 15:37:32,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0432 secs
2025-03-13 15:37:32,867 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:32
2025-03-13 15:37:32,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:32,867 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:37:32,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:32,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:37:32,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:32
2025-03-13 15:37:32,867 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:32,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:37:32,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:32
2025-03-13 15:37:32,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:32,867 [INFO]: 	Creating the index 03/13/2025, 15:37:32
2025-03-13 15:37:32,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:32
2025-03-13 15:37:32,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:37:32,869 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:32
2025-03-13 15:37:32,869 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:37:32,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.14it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.85it/s] 22%|██▏       | 5/23 [00:00<00:01, 13.31it/s] 30%|███       | 7/23 [00:00<00:01, 14.87it/s] 39%|███▉      | 9/23 [00:00<00:00, 15.74it/s] 48%|████▊     | 11/23 [00:00<00:00, 16.69it/s] 57%|█████▋    | 13/23 [00:00<00:00, 17.34it/s] 70%|██████▉   | 16/23 [00:00<00:00, 20.51it/s] 83%|████████▎ | 19/23 [00:01<00:00, 23.07it/s] 96%|█████████▌| 22/23 [00:08<00:00,  1.06it/s]100%|██████████| 23/23 [00:10<00:00,  2.28it/s]
2025-03-13 15:37:42,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:42
2025-03-13 15:38:39,952 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0025 secs
2025-03-13 15:38:39,953 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 15:38:39,953 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.63s/it] 50%|█████     | 2/4 [00:06<00:05,  2.90s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.17s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.08s/it]
2025-03-13 15:39:35,579 [INFO]: 	>>> Finished "Compute fast metrics" in 55.6263 secs
2025-03-13 15:39:35,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.7115 secs
2025-03-13 15:39:35,581 [INFO]: {
2025-03-13 15:39:35,581 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:35,581 [INFO]: 	index_param: efSearch=241
2025-03-13 15:39:35,581 [INFO]: 	index_path: knn.index
2025-03-13 15:39:35,581 [INFO]: 	size in bytes: 1091733250
2025-03-13 15:39:35,581 [INFO]: 	avg_search_speed_ms: 13.683376348069098
2025-03-13 15:39:35,581 [INFO]: 	99p_search_speed_ms: 24.110912159085284
2025-03-13 15:39:35,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:35,581 [INFO]: 	nb vectors: 5549
2025-03-13 15:39:35,581 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:35,581 [INFO]: 	compression ratio: 0.9993080196101016
2025-03-13 15:39:35,581 [INFO]: }
2025-03-13 15:39:35,581 [INFO]: 	>>> Finished "Creating the index" in 122.7133 secs
2025-03-13 15:39:35,581 [INFO]: >>> Finished "Launching the whole pipeline" in 122.7576 secs
2025-03-13 15:39:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 37509 [episode count 0/20]
[retrieval_preprocessing] for episode 28678 [episode count 1/20], we have num_retrieval=np.int64(5547) num_query=np.int64(300)
2025-03-13 15:39:39,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:40,477 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:40
2025-03-13 15:39:40,477 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1223.54it/s]
2025-03-13 15:39:40,508 [INFO]: There are 5547 embeddings of dim 49152
2025-03-13 15:39:40,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 15:39:40,508 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:40
2025-03-13 15:39:40,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:40,508 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:39:40,508 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:40,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:40,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:40
2025-03-13 15:39:40,508 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:40,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:39:40,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:40
2025-03-13 15:39:40,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:40,509 [INFO]: 	Creating the index 03/13/2025, 15:39:40
2025-03-13 15:39:40,509 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:40
2025-03-13 15:39:40,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:39:40,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:40
2025-03-13 15:39:40,510 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:39:40,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.07it/s] 26%|██▌       | 6/23 [00:00<00:00, 27.40it/s] 48%|████▊     | 11/23 [00:00<00:00, 35.52it/s] 70%|██████▉   | 16/23 [00:00<00:00, 39.79it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.41it/s]100%|██████████| 23/23 [00:05<00:00,  4.09it/s]
2025-03-13 15:39:46,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:46
2025-03-13 15:40:45,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.4201 secs
2025-03-13 15:40:45,559 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 15:40:45,559 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 15:41:22,061 [INFO]: 	>>> Finished "Compute fast metrics" in 36.5024 secs
2025-03-13 15:41:22,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.5529 secs
2025-03-13 15:41:22,063 [INFO]: {
2025-03-13 15:41:22,063 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:22,063 [INFO]: 	index_param: efSearch=243
2025-03-13 15:41:22,063 [INFO]: 	index_path: knn.index
2025-03-13 15:41:22,063 [INFO]: 	size in bytes: 1091339770
2025-03-13 15:41:22,063 [INFO]: 	avg_search_speed_ms: 13.906580047236343
2025-03-13 15:41:22,063 [INFO]: 	99p_search_speed_ms: 23.697356311604405
2025-03-13 15:41:22,063 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:22,063 [INFO]: 	nb vectors: 5547
2025-03-13 15:41:22,063 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:22,063 [INFO]: 	compression ratio: 0.9993080120226903
2025-03-13 15:41:22,063 [INFO]: }
2025-03-13 15:41:22,063 [INFO]: 	>>> Finished "Creating the index" in 101.5544 secs
2025-03-13 15:41:22,063 [INFO]: >>> Finished "Launching the whole pipeline" in 101.5860 secs
2025-03-13 15:41:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 28678 [episode count 1/20]
[retrieval_preprocessing] for episode 92167 [episode count 2/20], we have num_retrieval=np.int64(5608) num_query=np.int64(239)
2025-03-13 15:41:28,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:29,380 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:29
2025-03-13 15:41:29,380 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 965.32it/s]
2025-03-13 15:41:29,409 [INFO]: There are 5608 embeddings of dim 49152
2025-03-13 15:41:29,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:41:29,409 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:29
2025-03-13 15:41:29,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:29,409 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:41:29,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:29,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:41:29,409 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:29
2025-03-13 15:41:29,410 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:29,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:41:29,410 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:29
2025-03-13 15:41:29,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:29,410 [INFO]: 	Creating the index 03/13/2025, 15:41:29
2025-03-13 15:41:29,410 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:29
2025-03-13 15:41:29,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:41:29,411 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:29
2025-03-13 15:41:29,411 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:41:29,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.03it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.60it/s] 21%|██        | 5/24 [00:00<00:01,  9.91it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.62it/s] 38%|███▊      | 9/24 [00:00<00:01, 10.90it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.00it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.04it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.13it/s] 71%|███████   | 17/24 [00:01<00:00, 11.01it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.08it/s] 88%|████████▊ | 21/24 [00:05<00:02,  1.50it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.76it/s]100%|██████████| 24/24 [00:07<00:00,  1.51it/s]100%|██████████| 24/24 [00:07<00:00,  3.18it/s]
2025-03-13 15:41:36,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:36
2025-03-13 15:42:34,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4240 secs
2025-03-13 15:42:34,392 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 15:42:34,392 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 15:43:13,601 [INFO]: 	>>> Finished "Compute fast metrics" in 39.2087 secs
2025-03-13 15:43:13,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1907 secs
2025-03-13 15:43:13,602 [INFO]: {
2025-03-13 15:43:13,602 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:13,602 [INFO]: 	index_param: efSearch=265
2025-03-13 15:43:13,602 [INFO]: 	index_path: knn.index
2025-03-13 15:43:13,602 [INFO]: 	size in bytes: 1103341210
2025-03-13 15:43:13,602 [INFO]: 	avg_search_speed_ms: 11.849634587142386
2025-03-13 15:43:13,602 [INFO]: 	99p_search_speed_ms: 17.21247578505424
2025-03-13 15:43:13,602 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:13,602 [INFO]: 	nb vectors: 5608
2025-03-13 15:43:13,602 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:13,602 [INFO]: 	compression ratio: 0.9993079692908415
2025-03-13 15:43:13,602 [INFO]: }
2025-03-13 15:43:13,602 [INFO]: 	>>> Finished "Creating the index" in 104.1925 secs
2025-03-13 15:43:13,602 [INFO]: >>> Finished "Launching the whole pipeline" in 104.2226 secs
2025-03-13 15:43:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 92167 [episode count 2/20]
[retrieval_preprocessing] for episode 13965 [episode count 3/20], we have num_retrieval=np.int64(5546) num_query=np.int64(301)
2025-03-13 15:43:18,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:19,130 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:19
2025-03-13 15:43:19,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.26it/s]
2025-03-13 15:43:19,159 [INFO]: There are 5546 embeddings of dim 49152
2025-03-13 15:43:19,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 15:43:19,160 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:19,161 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:43:19,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:19,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:43:19,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,161 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:19,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:43:19,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:19
2025-03-13 15:43:19,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:19,162 [INFO]: 	Creating the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,163 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:19
2025-03-13 15:43:19,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:43:19,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,167 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:43:19,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.87it/s]  9%|▊         | 2/23 [00:00<00:03,  6.53it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.16it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.91it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.51it/s] 26%|██▌       | 6/23 [00:00<00:01,  8.92it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.45it/s] 39%|███▉      | 9/23 [00:01<00:01,  9.43it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.39it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.19it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.16it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.90it/s] 61%|██████    | 14/23 [00:01<00:01,  8.63it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.31it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.05it/s] 74%|███████▍  | 17/23 [00:02<00:00,  7.85it/s] 78%|███████▊  | 18/23 [00:02<00:00,  7.73it/s] 83%|████████▎ | 19/23 [00:02<00:00,  7.19it/s] 87%|████████▋ | 20/23 [00:02<00:00,  7.17it/s] 91%|█████████▏| 21/23 [00:07<00:03,  1.71s/it] 96%|█████████▌| 22/23 [00:07<00:01,  1.23s/it]100%|██████████| 23/23 [00:09<00:00,  1.35s/it]100%|██████████| 23/23 [00:09<00:00,  2.40it/s]
2025-03-13 15:43:28,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:28
2025-03-13 15:44:21,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2694 secs
2025-03-13 15:44:21,045 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 15:44:21,045 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 15:45:01,056 [INFO]: 	>>> Finished "Compute fast metrics" in 40.0101 secs
2025-03-13 15:45:01,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.8902 secs
2025-03-13 15:45:01,057 [INFO]: {
2025-03-13 15:45:01,057 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:01,057 [INFO]: 	index_param: efSearch=258
2025-03-13 15:45:01,057 [INFO]: 	index_path: knn.index
2025-03-13 15:45:01,057 [INFO]: 	size in bytes: 1091143030
2025-03-13 15:45:01,057 [INFO]: 	avg_search_speed_ms: 10.62137813227263
2025-03-13 15:45:01,057 [INFO]: 	99p_search_speed_ms: 18.631828597281135
2025-03-13 15:45:01,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:01,057 [INFO]: 	nb vectors: 5546
2025-03-13 15:45:01,057 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:01,057 [INFO]: 	compression ratio: 0.9993080082269324
2025-03-13 15:45:01,057 [INFO]: }
2025-03-13 15:45:01,057 [INFO]: 	>>> Finished "Creating the index" in 101.8946 secs
2025-03-13 15:45:01,057 [INFO]: >>> Finished "Launching the whole pipeline" in 101.9274 secs
2025-03-13 15:45:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 13965 [episode count 3/20]
[retrieval_preprocessing] for episode 76056 [episode count 4/20], we have num_retrieval=np.int64(5437) num_query=np.int64(410)
2025-03-13 15:45:06,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:07,798 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:07
2025-03-13 15:45:07,798 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.46it/s]
2025-03-13 15:45:07,832 [INFO]: There are 5437 embeddings of dim 49152
2025-03-13 15:45:07,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-13 15:45:07,832 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:07
2025-03-13 15:45:07,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:07,833 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:45:07,833 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:07,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:45:07,833 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:07
2025-03-13 15:45:07,833 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:07,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:45:07,833 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:07
2025-03-13 15:45:07,834 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:07,834 [INFO]: 	Creating the index 03/13/2025, 15:45:07
2025-03-13 15:45:07,834 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:07
2025-03-13 15:45:07,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:45:07,837 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:07
2025-03-13 15:45:07,837 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:45:07,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.00it/s]  9%|▊         | 2/23 [00:00<00:03,  6.87it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.88it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.88it/s] 26%|██▌       | 6/23 [00:00<00:01, 11.56it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.60it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.50it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.01it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.74it/s] 61%|██████    | 14/23 [00:01<00:01,  8.59it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.42it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.28it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.17it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.10it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.13it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.10it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.20s/it]100%|██████████| 23/23 [00:07<00:00,  1.02it/s]100%|██████████| 23/23 [00:07<00:00,  3.02it/s]
2025-03-13 15:45:15,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:15
2025-03-13 15:46:12,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8382 secs
2025-03-13 15:46:12,295 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:46:12,296 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 15:46:42,836 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5404 secs
2025-03-13 15:46:42,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.9997 secs
2025-03-13 15:46:42,837 [INFO]: {
2025-03-13 15:46:42,837 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:42,837 [INFO]: 	index_param: efSearch=217
2025-03-13 15:46:42,837 [INFO]: 	index_path: knn.index
2025-03-13 15:46:42,837 [INFO]: 	size in bytes: 1069697830
2025-03-13 15:46:42,837 [INFO]: 	avg_search_speed_ms: 10.254031808457155
2025-03-13 15:46:42,837 [INFO]: 	99p_search_speed_ms: 14.848261256702244
2025-03-13 15:46:42,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:42,837 [INFO]: 	nb vectors: 5437
2025-03-13 15:46:42,837 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:42,837 [INFO]: 	compression ratio: 0.9993080905847963
2025-03-13 15:46:42,837 [INFO]: }
2025-03-13 15:46:42,837 [INFO]: 	>>> Finished "Creating the index" in 95.0032 secs
2025-03-13 15:46:42,837 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0394 secs
2025-03-13 15:46:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 76056 [episode count 4/20]
[retrieval_preprocessing] for episode 49439 [episode count 5/20], we have num_retrieval=np.int64(5533) num_query=np.int64(314)
2025-03-13 15:46:48,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:48,886 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:48
2025-03-13 15:46:48,886 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2142.14it/s]
2025-03-13 15:46:48,911 [INFO]: There are 5533 embeddings of dim 49152
2025-03-13 15:46:48,912 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:46:48,912 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:48
2025-03-13 15:46:48,912 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:48,912 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:46:48,912 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:48,912 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:46:48,912 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:48
2025-03-13 15:46:48,913 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:48,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:46:48,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:48
2025-03-13 15:46:48,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:48,913 [INFO]: 	Creating the index 03/13/2025, 15:46:48
2025-03-13 15:46:48,913 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:48
2025-03-13 15:46:48,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:46:48,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:48
2025-03-13 15:46:48,917 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:46:48,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.65it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.05it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.09it/s] 30%|███       | 7/23 [00:00<00:01, 10.54it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.87it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.09it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.31it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.27it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.24it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.28it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.49it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.76it/s]100%|██████████| 23/23 [00:07<00:00,  1.43it/s]100%|██████████| 23/23 [00:07<00:00,  3.26it/s]
2025-03-13 15:46:55,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:55
2025-03-13 15:47:54,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3515 secs
2025-03-13 15:47:54,322 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 15:47:54,322 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 15:48:25,292 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9707 secs
2025-03-13 15:48:25,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.3767 secs
2025-03-13 15:48:25,294 [INFO]: {
2025-03-13 15:48:25,294 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:25,294 [INFO]: 	index_param: efSearch=235
2025-03-13 15:48:25,294 [INFO]: 	index_path: knn.index
2025-03-13 15:48:25,294 [INFO]: 	size in bytes: 1088585410
2025-03-13 15:48:25,294 [INFO]: 	avg_search_speed_ms: 9.805555582530431
2025-03-13 15:48:25,294 [INFO]: 	99p_search_speed_ms: 12.899997909553347
2025-03-13 15:48:25,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:25,294 [INFO]: 	nb vectors: 5533
2025-03-13 15:48:25,294 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:25,294 [INFO]: 	compression ratio: 0.9993079587572279
2025-03-13 15:48:25,294 [INFO]: }
2025-03-13 15:48:25,294 [INFO]: 	>>> Finished "Creating the index" in 96.3805 secs
2025-03-13 15:48:25,294 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4080 secs
2025-03-13 15:48:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 49439 [episode count 5/20]
[retrieval_preprocessing] for episode 75307 [episode count 6/20], we have num_retrieval=np.int64(5612) num_query=np.int64(235)
2025-03-13 15:48:30,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:31,190 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:31
2025-03-13 15:48:31,190 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-13 15:48:31,217 [INFO]: There are 5612 embeddings of dim 49152
2025-03-13 15:48:31,217 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:48:31,217 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:31
2025-03-13 15:48:31,217 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:31,217 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:48:31,217 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:31,217 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:31,217 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:31
2025-03-13 15:48:31,217 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:31,217 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:48:31,217 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:31
2025-03-13 15:48:31,217 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:31,218 [INFO]: 	Creating the index 03/13/2025, 15:48:31
2025-03-13 15:48:31,218 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:31
2025-03-13 15:48:31,219 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:48:31,219 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:31
2025-03-13 15:48:31,219 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:48:31,219 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.84it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.39it/s] 21%|██        | 5/24 [00:00<00:02,  9.42it/s] 29%|██▉       | 7/24 [00:00<00:01,  9.72it/s] 38%|███▊      | 9/24 [00:00<00:01,  9.65it/s] 42%|████▏     | 10/24 [00:01<00:01,  9.44it/s] 46%|████▌     | 11/24 [00:01<00:01,  9.24it/s] 50%|█████     | 12/24 [00:01<00:01,  9.07it/s] 54%|█████▍    | 13/24 [00:01<00:01,  9.11it/s] 58%|█████▊    | 14/24 [00:01<00:01,  9.02it/s] 62%|██████▎   | 15/24 [00:01<00:01,  8.95it/s] 67%|██████▋   | 16/24 [00:01<00:00,  8.91it/s] 71%|███████   | 17/24 [00:01<00:00,  8.90it/s] 75%|███████▌  | 18/24 [00:01<00:00,  9.03it/s] 83%|████████▎ | 20/24 [00:02<00:00,  9.43it/s] 88%|████████▊ | 21/24 [00:05<00:02,  1.07it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.39it/s]100%|██████████| 24/24 [00:07<00:00,  1.45it/s]100%|██████████| 24/24 [00:07<00:00,  3.39it/s]
2025-03-13 15:48:38,292 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:38
2025-03-13 15:49:26,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9262 secs
2025-03-13 15:49:26,219 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 15:49:26,219 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 15:50:10,328 [INFO]: 	>>> Finished "Compute fast metrics" in 44.1083 secs
2025-03-13 15:50:10,329 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.1100 secs
2025-03-13 15:50:10,329 [INFO]: {
2025-03-13 15:50:10,329 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:10,329 [INFO]: 	index_param: efSearch=129
2025-03-13 15:50:10,329 [INFO]: 	index_path: knn.index
2025-03-13 15:50:10,329 [INFO]: 	size in bytes: 1104128170
2025-03-13 15:50:10,329 [INFO]: 	avg_search_speed_ms: 7.165101976350858
2025-03-13 15:50:10,329 [INFO]: 	99p_search_speed_ms: 9.239002503454685
2025-03-13 15:50:10,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:10,329 [INFO]: 	nb vectors: 5612
2025-03-13 15:50:10,329 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:10,329 [INFO]: 	compression ratio: 0.999307984325769
2025-03-13 15:50:10,329 [INFO]: }
2025-03-13 15:50:10,329 [INFO]: 	>>> Finished "Creating the index" in 99.1115 secs
2025-03-13 15:50:10,329 [INFO]: >>> Finished "Launching the whole pipeline" in 99.1387 secs
2025-03-13 15:50:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 75307 [episode count 6/20]
[retrieval_preprocessing] for episode 55597 [episode count 7/20], we have num_retrieval=np.int64(5615) num_query=np.int64(232)
2025-03-13 15:50:13,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:14,938 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:14
2025-03-13 15:50:14,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1882.54it/s]
2025-03-13 15:50:14,962 [INFO]: There are 5615 embeddings of dim 49152
2025-03-13 15:50:14,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 15:50:14,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:14
2025-03-13 15:50:14,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:14,964 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:50:14,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:14,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:50:14,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:14
2025-03-13 15:50:14,964 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:14,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:50:14,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:14
2025-03-13 15:50:14,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:14,965 [INFO]: 	Creating the index 03/13/2025, 15:50:14
2025-03-13 15:50:14,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:14
2025-03-13 15:50:14,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:50:14,969 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:14
2025-03-13 15:50:14,969 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:50:14,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.37it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.42it/s] 21%|██        | 5/24 [00:00<00:01,  9.70it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.33it/s] 38%|███▊      | 9/24 [00:00<00:01, 10.80it/s] 46%|████▌     | 11/24 [00:01<00:01, 10.51it/s] 54%|█████▍    | 13/24 [00:01<00:01, 10.79it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.38it/s] 71%|███████   | 17/24 [00:01<00:00, 11.90it/s] 79%|███████▉  | 19/24 [00:01<00:00, 12.36it/s] 88%|████████▊ | 21/24 [00:07<00:02,  1.11it/s] 96%|█████████▌| 23/24 [00:07<00:00,  1.54it/s]100%|██████████| 24/24 [00:09<00:00,  2.65it/s]
2025-03-13 15:50:24,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:24
2025-03-13 15:51:18,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0433 secs
2025-03-13 15:51:18,090 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:51:18,090 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.98it/s] 50%|█████     | 2/4 [00:01<00:01,  1.97it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.23it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.53it/s]
2025-03-13 15:51:56,261 [INFO]: 	>>> Finished "Compute fast metrics" in 38.1705 secs
2025-03-13 15:51:56,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.4945 secs
2025-03-13 15:51:56,464 [INFO]: {
2025-03-13 15:51:56,464 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:56,464 [INFO]: 	index_param: efSearch=151
2025-03-13 15:51:56,464 [INFO]: 	index_path: knn.index
2025-03-13 15:51:56,464 [INFO]: 	size in bytes: 1104718390
2025-03-13 15:51:56,464 [INFO]: 	avg_search_speed_ms: 7.534624179495329
2025-03-13 15:51:56,464 [INFO]: 	99p_search_speed_ms: 13.154318896122286
2025-03-13 15:51:56,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:56,464 [INFO]: 	nb vectors: 5615
2025-03-13 15:51:56,464 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:56,464 [INFO]: 	compression ratio: 0.9993079955879073
2025-03-13 15:51:56,464 [INFO]: }
2025-03-13 15:51:56,464 [INFO]: 	>>> Finished "Creating the index" in 101.4990 secs
2025-03-13 15:51:56,464 [INFO]: >>> Finished "Launching the whole pipeline" in 101.5265 secs
2025-03-13 15:51:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 55597 [episode count 7/20]
[retrieval_preprocessing] for episode 84019 [episode count 8/20], we have num_retrieval=np.int64(5586) num_query=np.int64(261)
2025-03-13 15:52:00,073 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:01,088 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:01
2025-03-13 15:52:01,088 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.15it/s]
2025-03-13 15:52:01,113 [INFO]: There are 5586 embeddings of dim 49152
2025-03-13 15:52:01,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 15:52:01,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:01
2025-03-13 15:52:01,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:01,113 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:52:01,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:01,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:52:01,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:01
2025-03-13 15:52:01,114 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:01,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:52:01,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:01
2025-03-13 15:52:01,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:01,114 [INFO]: 	Creating the index 03/13/2025, 15:52:01
2025-03-13 15:52:01,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:01
2025-03-13 15:52:01,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:52:01,115 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:01
2025-03-13 15:52:01,116 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:52:01,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 17.09it/s] 30%|███       | 7/23 [00:00<00:00, 33.74it/s] 52%|█████▏    | 12/23 [00:00<00:00, 39.48it/s] 74%|███████▍  | 17/23 [00:00<00:00, 41.71it/s] 96%|█████████▌| 22/23 [00:04<00:00,  3.04it/s]100%|██████████| 23/23 [00:05<00:00,  3.95it/s]
2025-03-13 15:52:07,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:52:07
2025-03-13 15:53:05,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6066 secs
2025-03-13 15:53:05,076 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:53:05,076 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.38s/it] 50%|█████     | 2/4 [00:01<00:01,  1.57it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.46it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.74it/s]
2025-03-13 15:53:41,313 [INFO]: 	>>> Finished "Compute fast metrics" in 36.2369 secs
2025-03-13 15:53:41,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.1997 secs
2025-03-13 15:53:41,315 [INFO]: {
2025-03-13 15:53:41,315 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:41,315 [INFO]: 	index_param: efSearch=199
2025-03-13 15:53:41,315 [INFO]: 	index_path: knn.index
2025-03-13 15:53:41,315 [INFO]: 	size in bytes: 1099012870
2025-03-13 15:53:41,315 [INFO]: 	avg_search_speed_ms: 10.868456600102313
2025-03-13 15:53:41,315 [INFO]: 	99p_search_speed_ms: 15.423980869818461
2025-03-13 15:53:41,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:41,315 [INFO]: 	nb vectors: 5586
2025-03-13 15:53:41,315 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:41,315 [INFO]: 	compression ratio: 0.9993079407705208
2025-03-13 15:53:41,315 [INFO]: }
2025-03-13 15:53:41,315 [INFO]: 	>>> Finished "Creating the index" in 100.2010 secs
2025-03-13 15:53:41,315 [INFO]: >>> Finished "Launching the whole pipeline" in 100.2270 secs
2025-03-13 15:53:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 84019 [episode count 8/20]
[retrieval_preprocessing] for episode 22842 [episode count 9/20], we have num_retrieval=np.int64(5547) num_query=np.int64(300)
2025-03-13 15:53:52,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:53,974 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:53
2025-03-13 15:53:53,974 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-13 15:53:54,000 [INFO]: There are 5547 embeddings of dim 49152
2025-03-13 15:53:54,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:53:54,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:54
2025-03-13 15:53:54,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:54,000 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:53:54,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:53:54,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:54,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:54
2025-03-13 15:53:54,000 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:54,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:53:54,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:54
2025-03-13 15:53:54,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:54,000 [INFO]: 	Creating the index 03/13/2025, 15:53:54
2025-03-13 15:53:54,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:54
2025-03-13 15:53:54,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:53:54,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:54
2025-03-13 15:53:54,001 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:53:54,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.86it/s]  9%|▊         | 2/23 [00:00<00:03,  6.84it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.24it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.79it/s] 35%|███▍      | 8/23 [00:00<00:01, 10.95it/s] 43%|████▎     | 10/23 [00:00<00:01, 11.90it/s] 52%|█████▏    | 12/23 [00:01<00:00, 12.48it/s] 61%|██████    | 14/23 [00:01<00:00, 12.38it/s] 70%|██████▉   | 16/23 [00:01<00:00, 10.88it/s] 78%|███████▊  | 18/23 [00:01<00:00, 10.03it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.25it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.29it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.57it/s]100%|██████████| 23/23 [00:07<00:00,  1.23it/s]100%|██████████| 23/23 [00:07<00:00,  3.14it/s]
2025-03-13 15:54:01,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:01
2025-03-13 15:54:53,736 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3994 secs
2025-03-13 15:54:53,737 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 15:54:53,737 [INFO]: 	Compute fast metrics 03/13/2025, 15:54:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 15:55:30,971 [INFO]: 	>>> Finished "Compute fast metrics" in 37.2341 secs
2025-03-13 15:55:30,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.9704 secs
2025-03-13 15:55:30,972 [INFO]: {
2025-03-13 15:55:30,972 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:30,972 [INFO]: 	index_param: efSearch=241
2025-03-13 15:55:30,972 [INFO]: 	index_path: knn.index
2025-03-13 15:55:30,972 [INFO]: 	size in bytes: 1091339770
2025-03-13 15:55:30,972 [INFO]: 	avg_search_speed_ms: 10.531493046222941
2025-03-13 15:55:30,972 [INFO]: 	99p_search_speed_ms: 16.073760797735304
2025-03-13 15:55:30,972 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:30,972 [INFO]: 	nb vectors: 5547
2025-03-13 15:55:30,972 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:30,972 [INFO]: 	compression ratio: 0.9993080120226903
2025-03-13 15:55:30,972 [INFO]: }
2025-03-13 15:55:30,972 [INFO]: 	>>> Finished "Creating the index" in 96.9717 secs
2025-03-13 15:55:30,972 [INFO]: >>> Finished "Launching the whole pipeline" in 96.9982 secs
2025-03-13 15:55:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 22842 [episode count 9/20]
[retrieval_preprocessing] for episode 52287 [episode count 10/20], we have num_retrieval=np.int64(5549) num_query=np.int64(298)
2025-03-13 15:55:37,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:38,822 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:38
2025-03-13 15:55:38,822 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1721.80it/s]
2025-03-13 15:55:38,847 [INFO]: There are 5549 embeddings of dim 49152
2025-03-13 15:55:38,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:55:38,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:38
2025-03-13 15:55:38,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:38,847 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:55:38,847 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:38,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:38,847 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:38
2025-03-13 15:55:38,847 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:38,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:55:38,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:38
2025-03-13 15:55:38,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:38,848 [INFO]: 	Creating the index 03/13/2025, 15:55:38
2025-03-13 15:55:38,848 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:38
2025-03-13 15:55:38,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:55:38,849 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:38
2025-03-13 15:55:38,849 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:55:38,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.90it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.37it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.00it/s] 30%|███       | 7/23 [00:00<00:01, 11.57it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.10it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.18it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.43it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.86it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.89it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.87it/s] 91%|█████████▏| 21/23 [00:08<00:02,  1.06s/it]100%|██████████| 23/23 [00:10<00:00,  1.03s/it]100%|██████████| 23/23 [00:10<00:00,  2.27it/s]
2025-03-13 15:55:49,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:49
2025-03-13 15:56:52,169 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.1650 secs
2025-03-13 15:56:52,170 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:56:52,170 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.71it/s]
2025-03-13 15:57:23,991 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8206 secs
2025-03-13 15:57:23,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.1435 secs
2025-03-13 15:57:23,992 [INFO]: {
2025-03-13 15:57:23,992 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:23,992 [INFO]: 	index_param: efSearch=185
2025-03-13 15:57:23,992 [INFO]: 	index_path: knn.index
2025-03-13 15:57:23,992 [INFO]: 	size in bytes: 1091733250
2025-03-13 15:57:23,992 [INFO]: 	avg_search_speed_ms: 11.005875539512049
2025-03-13 15:57:23,992 [INFO]: 	99p_search_speed_ms: 17.674354556947932
2025-03-13 15:57:23,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:23,992 [INFO]: 	nb vectors: 5549
2025-03-13 15:57:23,992 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:23,992 [INFO]: 	compression ratio: 0.9993080196101016
2025-03-13 15:57:23,992 [INFO]: }
2025-03-13 15:57:23,993 [INFO]: 	>>> Finished "Creating the index" in 105.1449 secs
2025-03-13 15:57:23,993 [INFO]: >>> Finished "Launching the whole pipeline" in 105.1708 secs
2025-03-13 15:57:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 52287 [episode count 10/20]
[retrieval_preprocessing] for episode 39745 [episode count 11/20], we have num_retrieval=np.int64(5545) num_query=np.int64(302)
2025-03-13 15:57:27,343 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:28,204 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:28
2025-03-13 15:57:28,204 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1669.04it/s]
2025-03-13 15:57:28,246 [INFO]: There are 5545 embeddings of dim 49152
2025-03-13 15:57:28,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0428 secs
2025-03-13 15:57:28,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:28
2025-03-13 15:57:28,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:28,247 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 15:57:28,248 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:28,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:57:28,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:28
2025-03-13 15:57:28,248 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:28,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:57:28,248 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:28
2025-03-13 15:57:28,248 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:28,248 [INFO]: 	Creating the index 03/13/2025, 15:57:28
2025-03-13 15:57:28,248 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:28
2025-03-13 15:57:28,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:57:28,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:28
2025-03-13 15:57:28,251 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:57:28,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.41it/s] 26%|██▌       | 6/23 [00:00<00:00, 28.29it/s] 48%|████▊     | 11/23 [00:00<00:00, 35.26it/s] 65%|██████▌   | 15/23 [00:00<00:00, 35.51it/s] 87%|████████▋ | 20/23 [00:00<00:00, 37.67it/s]100%|██████████| 23/23 [00:06<00:00,  3.57it/s]
2025-03-13 15:57:34,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:34
2025-03-13 15:58:37,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.3033 secs
2025-03-13 15:58:37,000 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:58:37,000 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.74it/s]
2025-03-13 15:59:12,807 [INFO]: 	>>> Finished "Compute fast metrics" in 35.8068 secs
2025-03-13 15:59:12,809 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.5577 secs
2025-03-13 15:59:12,809 [INFO]: {
2025-03-13 15:59:12,809 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:12,809 [INFO]: 	index_param: efSearch=217
2025-03-13 15:59:12,809 [INFO]: 	index_path: knn.index
2025-03-13 15:59:12,809 [INFO]: 	size in bytes: 1090946290
2025-03-13 15:59:12,809 [INFO]: 	avg_search_speed_ms: 11.552176005949049
2025-03-13 15:59:12,809 [INFO]: 	99p_search_speed_ms: 15.801393229048701
2025-03-13 15:59:12,809 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:12,809 [INFO]: 	nb vectors: 5545
2025-03-13 15:59:12,809 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:12,809 [INFO]: 	compression ratio: 0.9993080044298056
2025-03-13 15:59:12,809 [INFO]: }
2025-03-13 15:59:12,809 [INFO]: 	>>> Finished "Creating the index" in 104.5609 secs
2025-03-13 15:59:12,809 [INFO]: >>> Finished "Launching the whole pipeline" in 104.6052 secs
2025-03-13 15:59:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 39745 [episode count 11/20]
[retrieval_preprocessing] for episode 4035 [episode count 12/20], we have num_retrieval=np.int64(5572) num_query=np.int64(275)
2025-03-13 15:59:16,117 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:17,106 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:17
2025-03-13 15:59:17,107 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.35it/s]
2025-03-13 15:59:17,142 [INFO]: There are 5572 embeddings of dim 49152
2025-03-13 15:59:17,142 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 15:59:17,142 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:17
2025-03-13 15:59:17,142 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:17,142 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 15:59:17,142 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:17,142 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:17,142 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:17
2025-03-13 15:59:17,143 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:17,143 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:59:17,143 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:17
2025-03-13 15:59:17,143 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:17,143 [INFO]: 	Creating the index 03/13/2025, 15:59:17
2025-03-13 15:59:17,143 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:17
2025-03-13 15:59:17,144 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:59:17,144 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:17
2025-03-13 15:59:17,144 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 15:59:17,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.61it/s] 26%|██▌       | 6/23 [00:00<00:00, 27.59it/s] 48%|████▊     | 11/23 [00:00<00:00, 35.47it/s] 70%|██████▉   | 16/23 [00:00<00:00, 39.47it/s] 91%|█████████▏| 21/23 [00:05<00:00,  2.32it/s]100%|██████████| 23/23 [00:07<00:00,  3.23it/s]
2025-03-13 15:59:24,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:24
2025-03-13 16:00:22,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8910 secs
2025-03-13 16:00:22,519 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 16:00:22,519 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.57it/s]
2025-03-13 16:01:02,686 [INFO]: 	>>> Finished "Compute fast metrics" in 40.1670 secs
2025-03-13 16:01:02,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.5431 secs
2025-03-13 16:01:02,687 [INFO]: {
2025-03-13 16:01:02,687 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:02,687 [INFO]: 	index_param: efSearch=191
2025-03-13 16:01:02,687 [INFO]: 	index_path: knn.index
2025-03-13 16:01:02,688 [INFO]: 	size in bytes: 1096258450
2025-03-13 16:01:02,688 [INFO]: 	avg_search_speed_ms: 9.965209036451427
2025-03-13 16:01:02,688 [INFO]: 	99p_search_speed_ms: 14.003805890679361
2025-03-13 16:01:02,688 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:02,688 [INFO]: 	nb vectors: 5572
2025-03-13 16:01:02,688 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:02,688 [INFO]: 	compression ratio: 0.9993079423925991
2025-03-13 16:01:02,688 [INFO]: }
2025-03-13 16:01:02,688 [INFO]: 	>>> Finished "Creating the index" in 105.5449 secs
2025-03-13 16:01:02,688 [INFO]: >>> Finished "Launching the whole pipeline" in 105.5811 secs
2025-03-13 16:01:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 4035 [episode count 12/20]
[retrieval_preprocessing] for episode 10436 [episode count 13/20], we have num_retrieval=np.int64(5551) num_query=np.int64(296)
2025-03-13 16:01:05,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:06,281 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:06
2025-03-13 16:01:06,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.45it/s]
2025-03-13 16:01:06,326 [INFO]: There are 5551 embeddings of dim 49152
2025-03-13 16:01:06,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0453 secs
2025-03-13 16:01:06,327 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:06
2025-03-13 16:01:06,327 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:06,327 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:01:06,327 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:06,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:01:06,327 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:06
2025-03-13 16:01:06,328 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:06,328 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:01:06,328 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:06
2025-03-13 16:01:06,328 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:06,328 [INFO]: 	Creating the index 03/13/2025, 16:01:06
2025-03-13 16:01:06,329 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:06
2025-03-13 16:01:06,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:01:06,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:06
2025-03-13 16:01:06,332 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:01:06,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 17.50it/s] 30%|███       | 7/23 [00:00<00:00, 32.43it/s] 52%|█████▏    | 12/23 [00:00<00:00, 37.19it/s] 74%|███████▍  | 17/23 [00:00<00:00, 40.07it/s] 96%|█████████▌| 22/23 [00:04<00:00,  2.91it/s]100%|██████████| 23/23 [00:05<00:00,  3.93it/s]
2025-03-13 16:01:12,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:12
2025-03-13 16:01:58,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6853 secs
2025-03-13 16:01:58,880 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 16:01:58,880 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 16:02:20,878 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9976 secs
2025-03-13 16:02:20,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5468 secs
2025-03-13 16:02:20,879 [INFO]: {
2025-03-13 16:02:20,879 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:20,879 [INFO]: 	index_param: efSearch=128
2025-03-13 16:02:20,879 [INFO]: 	index_path: knn.index
2025-03-13 16:02:20,879 [INFO]: 	size in bytes: 1092126730
2025-03-13 16:02:20,879 [INFO]: 	avg_search_speed_ms: 8.306111239068569
2025-03-13 16:02:20,879 [INFO]: 	99p_search_speed_ms: 13.20633462863043
2025-03-13 16:02:20,879 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:20,879 [INFO]: 	nb vectors: 5551
2025-03-13 16:02:20,879 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:20,879 [INFO]: 	compression ratio: 0.9993080271920457
2025-03-13 16:02:20,879 [INFO]: }
2025-03-13 16:02:20,879 [INFO]: 	>>> Finished "Creating the index" in 74.5505 secs
2025-03-13 16:02:20,879 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5979 secs
2025-03-13 16:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 10436 [episode count 13/20]
[retrieval_preprocessing] for episode 78913 [episode count 14/20], we have num_retrieval=np.int64(5532) num_query=np.int64(315)
2025-03-13 16:02:23,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:24,157 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:24
2025-03-13 16:02:24,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1324.38it/s]
2025-03-13 16:02:24,195 [INFO]: There are 5532 embeddings of dim 49152
2025-03-13 16:02:24,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 16:02:24,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:24
2025-03-13 16:02:24,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:24,196 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:02:24,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:24,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:02:24,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:24
2025-03-13 16:02:24,196 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:24,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:02:24,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:24
2025-03-13 16:02:24,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:24,197 [INFO]: 	Creating the index 03/13/2025, 16:02:24
2025-03-13 16:02:24,197 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:24
2025-03-13 16:02:24,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:02:24,201 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:24
2025-03-13 16:02:24,201 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:02:24,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.84it/s] 26%|██▌       | 6/23 [00:00<00:00, 29.82it/s] 48%|████▊     | 11/23 [00:00<00:00, 36.14it/s] 70%|██████▉   | 16/23 [00:00<00:00, 38.93it/s] 91%|█████████▏| 21/23 [00:04<00:00,  2.90it/s]100%|██████████| 23/23 [00:05<00:00,  3.95it/s]
2025-03-13 16:02:30,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:30
2025-03-13 16:03:17,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8470 secs
2025-03-13 16:03:17,877 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 16:03:17,877 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 16:04:18,317 [INFO]: 	>>> Finished "Compute fast metrics" in 60.4394 secs
2025-03-13 16:04:18,318 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.1169 secs
2025-03-13 16:04:18,318 [INFO]: {
2025-03-13 16:04:18,318 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:18,318 [INFO]: 	index_param: efSearch=263
2025-03-13 16:04:18,318 [INFO]: 	index_path: knn.index
2025-03-13 16:04:18,318 [INFO]: 	size in bytes: 1088388670
2025-03-13 16:04:18,318 [INFO]: 	avg_search_speed_ms: 11.570778169071657
2025-03-13 16:04:18,318 [INFO]: 	99p_search_speed_ms: 15.689063267782332
2025-03-13 16:04:18,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:18,318 [INFO]: 	nb vectors: 5532
2025-03-13 16:04:18,318 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:18,318 [INFO]: 	compression ratio: 0.9993079549422359
2025-03-13 16:04:18,318 [INFO]: }
2025-03-13 16:04:18,318 [INFO]: 	>>> Finished "Creating the index" in 114.1209 secs
2025-03-13 16:04:18,318 [INFO]: >>> Finished "Launching the whole pipeline" in 114.1610 secs
2025-03-13 16:04:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 78913 [episode count 14/20]
[retrieval_preprocessing] for episode 25290 [episode count 15/20], we have num_retrieval=np.int64(5547) num_query=np.int64(300)
2025-03-13 16:04:23,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:25,080 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:25
2025-03-13 16:04:25,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.54it/s]
2025-03-13 16:04:25,114 [INFO]: There are 5547 embeddings of dim 49152
2025-03-13 16:04:25,114 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 16:04:25,114 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:25
2025-03-13 16:04:25,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:25,114 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:04:25,114 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:25,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:04:25,114 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:25
2025-03-13 16:04:25,114 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:25,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:04:25,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:25
2025-03-13 16:04:25,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:25,114 [INFO]: 	Creating the index 03/13/2025, 16:04:25
2025-03-13 16:04:25,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:25
2025-03-13 16:04:25,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:04:25,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:25
2025-03-13 16:04:25,116 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:04:25,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.00it/s] 22%|██▏       | 5/23 [00:00<00:00, 21.73it/s] 39%|███▉      | 9/23 [00:00<00:00, 25.31it/s] 52%|█████▏    | 12/23 [00:00<00:00, 23.05it/s] 65%|██████▌   | 15/23 [00:00<00:00, 22.63it/s] 83%|████████▎ | 19/23 [00:00<00:00, 25.67it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.56it/s]100%|██████████| 23/23 [00:08<00:00,  2.77it/s]
2025-03-13 16:04:33,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:33
2025-03-13 16:05:32,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4150 secs
2025-03-13 16:05:32,381 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:05:32,381 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-13 16:06:08,511 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1296 secs
2025-03-13 16:06:08,511 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.3959 secs
2025-03-13 16:06:08,512 [INFO]: {
2025-03-13 16:06:08,512 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:08,512 [INFO]: 	index_param: efSearch=236
2025-03-13 16:06:08,512 [INFO]: 	index_path: knn.index
2025-03-13 16:06:08,512 [INFO]: 	size in bytes: 1091339770
2025-03-13 16:06:08,512 [INFO]: 	avg_search_speed_ms: 11.002223543992843
2025-03-13 16:06:08,512 [INFO]: 	99p_search_speed_ms: 15.365736056119202
2025-03-13 16:06:08,512 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:08,512 [INFO]: 	nb vectors: 5547
2025-03-13 16:06:08,512 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:08,512 [INFO]: 	compression ratio: 0.9993080120226903
2025-03-13 16:06:08,512 [INFO]: }
2025-03-13 16:06:08,512 [INFO]: 	>>> Finished "Creating the index" in 103.3973 secs
2025-03-13 16:06:08,512 [INFO]: >>> Finished "Launching the whole pipeline" in 103.4314 secs
2025-03-13 16:06:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 25290 [episode count 15/20]
[retrieval_preprocessing] for episode 64207 [episode count 16/20], we have num_retrieval=np.int64(5604) num_query=np.int64(243)
2025-03-13 16:06:11,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:12,879 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:12
2025-03-13 16:06:12,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.03it/s]
2025-03-13 16:06:12,907 [INFO]: There are 5604 embeddings of dim 49152
2025-03-13 16:06:12,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 16:06:12,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:12,908 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:06:12,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:12,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:12,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,908 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:12,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:06:12,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:12
2025-03-13 16:06:12,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:12,908 [INFO]: 	Creating the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,908 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:12
2025-03-13 16:06:12,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:06:12,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:12
2025-03-13 16:06:12,909 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:06:12,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 16.00it/s] 29%|██▉       | 7/24 [00:00<00:00, 29.34it/s] 46%|████▌     | 11/24 [00:00<00:00, 33.27it/s] 62%|██████▎   | 15/24 [00:00<00:00, 35.33it/s] 79%|███████▉  | 19/24 [00:00<00:00, 36.52it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.58it/s]100%|██████████| 24/24 [00:06<00:00,  3.93it/s]
2025-03-13 16:06:19,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:19
2025-03-13 16:07:08,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3111 secs
2025-03-13 16:07:08,566 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 16:07:08,567 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 16:07:42,882 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3153 secs
2025-03-13 16:07:42,883 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.9745 secs
2025-03-13 16:07:42,884 [INFO]: {
2025-03-13 16:07:42,884 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:42,884 [INFO]: 	index_param: efSearch=164
2025-03-13 16:07:42,884 [INFO]: 	index_path: knn.index
2025-03-13 16:07:42,884 [INFO]: 	size in bytes: 1102554250
2025-03-13 16:07:42,884 [INFO]: 	avg_search_speed_ms: 9.369858162217506
2025-03-13 16:07:42,884 [INFO]: 	99p_search_speed_ms: 16.575821149162902
2025-03-13 16:07:42,884 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:42,884 [INFO]: 	nb vectors: 5604
2025-03-13 16:07:42,884 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:42,884 [INFO]: 	compression ratio: 0.9993079542344515
2025-03-13 16:07:42,884 [INFO]: }
2025-03-13 16:07:42,884 [INFO]: 	>>> Finished "Creating the index" in 89.9760 secs
2025-03-13 16:07:42,884 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0050 secs
2025-03-13 16:07:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 64207 [episode count 16/20]
[retrieval_preprocessing] for episode 95199 [episode count 17/20], we have num_retrieval=np.int64(5610) num_query=np.int64(237)
2025-03-13 16:07:47,296 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:48,280 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:48
2025-03-13 16:07:48,280 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 16:07:48,313 [INFO]: There are 5610 embeddings of dim 49152
2025-03-13 16:07:48,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 16:07:48,313 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:48
2025-03-13 16:07:48,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:48,313 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 16:07:48,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:48,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:48,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:48
2025-03-13 16:07:48,313 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:48,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:48,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:48
2025-03-13 16:07:48,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:48,314 [INFO]: 	Creating the index 03/13/2025, 16:07:48
2025-03-13 16:07:48,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:48
2025-03-13 16:07:48,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:07:48,315 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:48
2025-03-13 16:07:48,315 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:07:48,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.59it/s] 21%|██        | 5/24 [00:00<00:00, 24.13it/s] 42%|████▏     | 10/24 [00:00<00:00, 32.34it/s] 58%|█████▊    | 14/24 [00:00<00:00, 34.97it/s] 79%|███████▉  | 19/24 [00:00<00:00, 37.43it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.83it/s]100%|██████████| 24/24 [00:06<00:00,  3.82it/s]
2025-03-13 16:07:54,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:54
2025-03-13 16:08:48,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.4754 secs
2025-03-13 16:08:48,081 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 16:08:48,081 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.72it/s]
2025-03-13 16:09:52,203 [INFO]: 	>>> Finished "Compute fast metrics" in 64.1214 secs
2025-03-13 16:09:52,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.8887 secs
2025-03-13 16:09:52,204 [INFO]: {
2025-03-13 16:09:52,204 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:52,204 [INFO]: 	index_param: efSearch=265
2025-03-13 16:09:52,204 [INFO]: 	index_path: knn.index
2025-03-13 16:09:52,204 [INFO]: 	size in bytes: 1103734690
2025-03-13 16:09:52,204 [INFO]: 	avg_search_speed_ms: 9.75843331980996
2025-03-13 16:09:52,204 [INFO]: 	99p_search_speed_ms: 11.992782754823565
2025-03-13 16:09:52,204 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:52,204 [INFO]: 	nb vectors: 5610
2025-03-13 16:09:52,204 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:52,204 [INFO]: 	compression ratio: 0.9993079768109853
2025-03-13 16:09:52,204 [INFO]: }
2025-03-13 16:09:52,204 [INFO]: 	>>> Finished "Creating the index" in 123.8901 secs
2025-03-13 16:09:52,204 [INFO]: >>> Finished "Launching the whole pipeline" in 123.9237 secs
2025-03-13 16:09:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 95199 [episode count 17/20]
[retrieval_preprocessing] for episode 29682 [episode count 18/20], we have num_retrieval=np.int64(5509) num_query=np.int64(338)
2025-03-13 16:09:56,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:57,238 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:57
2025-03-13 16:09:57,238 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-13 16:09:57,267 [INFO]: There are 5509 embeddings of dim 49152
2025-03-13 16:09:57,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:09:57,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:57
2025-03-13 16:09:57,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:57,267 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:09:57,267 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:57,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:09:57,267 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:57
2025-03-13 16:09:57,267 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:57,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:09:57,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:57
2025-03-13 16:09:57,268 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:57,268 [INFO]: 	Creating the index 03/13/2025, 16:09:57
2025-03-13 16:09:57,268 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:57
2025-03-13 16:09:57,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:09:57,269 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:57
2025-03-13 16:09:57,269 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:09:57,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.98it/s] 30%|███       | 7/23 [00:00<00:00, 32.38it/s] 57%|█████▋    | 13/23 [00:00<00:00, 40.53it/s] 78%|███████▊  | 18/23 [00:00<00:00, 43.81it/s]100%|██████████| 23/23 [00:04<00:00,  2.91it/s]100%|██████████| 23/23 [00:04<00:00,  4.62it/s]
2025-03-13 16:10:02,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:02
2025-03-13 16:10:58,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0738 secs
2025-03-13 16:10:58,330 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 16:10:58,330 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-13 16:11:31,305 [INFO]: 	>>> Finished "Compute fast metrics" in 32.9742 secs
2025-03-13 16:11:31,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.0371 secs
2025-03-13 16:11:31,307 [INFO]: {
2025-03-13 16:11:31,307 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:31,307 [INFO]: 	index_param: efSearch=151
2025-03-13 16:11:31,307 [INFO]: 	index_path: knn.index
2025-03-13 16:11:31,307 [INFO]: 	size in bytes: 1083863470
2025-03-13 16:11:31,307 [INFO]: 	avg_search_speed_ms: 9.942561176709209
2025-03-13 16:11:31,307 [INFO]: 	99p_search_speed_ms: 14.619016321375998
2025-03-13 16:11:31,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:31,307 [INFO]: 	nb vectors: 5509
2025-03-13 16:11:31,307 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:31,307 [INFO]: 	compression ratio: 0.9993080327727993
2025-03-13 16:11:31,307 [INFO]: }
2025-03-13 16:11:31,307 [INFO]: 	>>> Finished "Creating the index" in 94.0395 secs
2025-03-13 16:11:31,307 [INFO]: >>> Finished "Launching the whole pipeline" in 94.0694 secs
2025-03-13 16:11:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 29682 [episode count 18/20]
[retrieval_preprocessing] for episode 43642 [episode count 19/20], we have num_retrieval=np.int64(5494) num_query=np.int64(353)
2025-03-13 16:11:34,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:35,472 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:35
2025-03-13 16:11:35,472 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.84it/s]
2025-03-13 16:11:35,512 [INFO]: There are 5494 embeddings of dim 49152
2025-03-13 16:11:35,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0406 secs
2025-03-13 16:11:35,513 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:35
2025-03-13 16:11:35,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:35,513 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 16:11:35,513 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:35,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:11:35,514 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:35
2025-03-13 16:11:35,514 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:35,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:11:35,514 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:35
2025-03-13 16:11:35,515 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:35,515 [INFO]: 	Creating the index 03/13/2025, 16:11:35
2025-03-13 16:11:35,515 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:35
2025-03-13 16:11:35,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:11:35,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:35
2025-03-13 16:11:35,519 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 16:11:35,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.54it/s] 22%|██▏       | 5/23 [00:00<00:00, 26.83it/s] 39%|███▉      | 9/23 [00:00<00:00, 32.62it/s] 61%|██████    | 14/23 [00:00<00:00, 37.11it/s] 83%|████████▎ | 19/23 [00:00<00:00, 41.05it/s]100%|██████████| 23/23 [00:05<00:00,  3.86it/s]
2025-03-13 16:11:41,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:41
2025-03-13 16:12:27,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.4953 secs
2025-03-13 16:12:27,973 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 16:12:27,973 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 16:13:16,256 [INFO]: 	>>> Finished "Compute fast metrics" in 48.2832 secs
2025-03-13 16:13:16,258 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.7388 secs
2025-03-13 16:13:16,258 [INFO]: {
2025-03-13 16:13:16,258 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:16,258 [INFO]: 	index_param: efSearch=160
2025-03-13 16:13:16,258 [INFO]: 	index_path: knn.index
2025-03-13 16:13:16,258 [INFO]: 	size in bytes: 1080912370
2025-03-13 16:13:16,258 [INFO]: 	avg_search_speed_ms: 8.265158557717896
2025-03-13 16:13:16,258 [INFO]: 	99p_search_speed_ms: 11.093932189978664
2025-03-13 16:13:16,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:16,258 [INFO]: 	nb vectors: 5494
2025-03-13 16:13:16,258 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:16,258 [INFO]: 	compression ratio: 0.9993079753541908
2025-03-13 16:13:16,258 [INFO]: }
2025-03-13 16:13:16,258 [INFO]: 	>>> Finished "Creating the index" in 100.7428 secs
2025-03-13 16:13:16,258 [INFO]: >>> Finished "Launching the whole pipeline" in 100.7862 secs
2025-03-13 16:13:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:13:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 43642 [episode count 19/20]
2025-03-13 16:13:18: [retrieval_preprocessing] finished for 8791475098_hang_towel_on_drawer [chosen_id count 3/196]
2025-03-13 16:13:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8833514968_put_blocks_in_bowl [chosen_id count 4/196]
2025-03-13 16:13:24: [retrieval_preprocessing] we have num_total=18680 embedding_dim=49152
[retrieval_preprocessing] for episode 80446 [episode count 0/20], we have num_retrieval=np.int64(17705) num_query=np.int64(975)
2025-03-13 16:14:03,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:07,854 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:07
2025-03-13 16:14:07,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.48it/s]
2025-03-13 16:14:07,909 [INFO]: There are 17705 embeddings of dim 49152
2025-03-13 16:14:07,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0559 secs
2025-03-13 16:14:07,910 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:07
2025-03-13 16:14:07,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:07,910 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 16:14:07,910 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:14:07,910 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:14:07,910 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:07
2025-03-13 16:14:07,911 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:07,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:14:07,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:07
2025-03-13 16:14:07,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:07,911 [INFO]: 	Creating the index 03/13/2025, 16:14:07
2025-03-13 16:14:07,911 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:14:07
2025-03-13 16:14:07,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 16:14:07,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:07
2025-03-13 16:14:07,912 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 16:14:07,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:16,  4.33it/s]  5%|▌         | 4/73 [00:00<00:05, 12.50it/s] 10%|▉         | 7/73 [00:00<00:03, 18.07it/s] 14%|█▎        | 10/73 [00:02<00:17,  3.53it/s] 18%|█▊        | 13/73 [00:02<00:11,  5.30it/s] 21%|██        | 15/73 [00:02<00:12,  4.74it/s] 27%|██▋       | 20/73 [00:02<00:06,  8.35it/s] 32%|███▏      | 23/73 [00:10<00:41,  1.20it/s] 40%|███▉      | 29/73 [00:10<00:20,  2.17it/s] 48%|████▊     | 35/73 [00:10<00:10,  3.50it/s] 56%|█████▌    | 41/73 [00:10<00:06,  5.28it/s] 63%|██████▎   | 46/73 [00:20<00:19,  1.38it/s] 70%|██████▉   | 51/73 [00:20<00:11,  1.95it/s] 77%|███████▋  | 56/73 [00:20<00:06,  2.73it/s] 82%|████████▏ | 60/73 [00:21<00:03,  3.58it/s] 88%|████████▊ | 64/73 [00:35<00:10,  1.18s/it] 95%|█████████▍| 69/73 [00:35<00:03,  1.24it/s]100%|██████████| 73/73 [00:43<00:00,  1.09s/it]100%|██████████| 73/73 [00:43<00:00,  1.69it/s]
2025-03-13 16:14:51,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:51
2025-03-13 16:17:48,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 177.6325 secs
2025-03-13 16:17:48,773 [INFO]: The best hyperparameters are: efSearch=38
2025-03-13 16:17:48,773 [INFO]: 	Compute fast metrics 03/13/2025, 16:17:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.55it/s] 50%|█████     | 2/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-13 16:18:51,685 [INFO]: 	>>> Finished "Compute fast metrics" in 62.9110 secs
2025-03-13 16:18:51,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 283.7751 secs
2025-03-13 16:18:51,687 [INFO]: {
2025-03-13 16:18:51,687 [INFO]: 	index_key: HNSW32
2025-03-13 16:18:51,687 [INFO]: 	index_param: efSearch=38
2025-03-13 16:18:51,687 [INFO]: 	index_path: knn.index
2025-03-13 16:18:51,687 [INFO]: 	size in bytes: 3485763278
2025-03-13 16:18:51,687 [INFO]: 	avg_search_speed_ms: 11.174400277987289
2025-03-13 16:18:51,687 [INFO]: 	99p_search_speed_ms: 22.329361364245326
2025-03-13 16:18:51,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:51,687 [INFO]: 	nb vectors: 17705
2025-03-13 16:18:51,687 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:51,687 [INFO]: 	compression ratio: 0.9986176232819904
2025-03-13 16:18:51,688 [INFO]: }
2025-03-13 16:18:51,688 [INFO]: 	>>> Finished "Creating the index" in 283.7767 secs
2025-03-13 16:18:51,688 [INFO]: >>> Finished "Launching the whole pipeline" in 283.8337 secs
2025-03-13 16:18:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 80446 [episode count 0/20]
[retrieval_preprocessing] for episode 17491 [episode count 1/20], we have num_retrieval=np.int64(17698) num_query=np.int64(982)
2025-03-13 16:18:59,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:01,870 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:01
2025-03-13 16:19:01,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1648.06it/s]
2025-03-13 16:19:01,910 [INFO]: There are 17698 embeddings of dim 49152
2025-03-13 16:19:01,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 16:19:01,910 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:01,910 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 16:19:01,910 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:19:01,910 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:19:01,911 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,911 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:01,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:01,911 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:01
2025-03-13 16:19:01,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:01,911 [INFO]: 	Creating the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,911 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:19:01
2025-03-13 16:19:01,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 16:19:01,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:01
2025-03-13 16:19:01,912 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 16:19:01,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:11,  6.47it/s]  5%|▌         | 4/73 [00:00<00:04, 16.97it/s] 11%|█         | 8/73 [00:00<00:02, 25.73it/s] 16%|█▋        | 12/73 [00:00<00:01, 30.58it/s] 22%|██▏       | 16/73 [00:00<00:01, 33.09it/s] 29%|██▉       | 21/73 [00:08<00:35,  1.47it/s] 33%|███▎      | 24/73 [00:09<00:28,  1.72it/s] 38%|███▊      | 28/73 [00:10<00:19,  2.28it/s] 41%|████      | 30/73 [00:10<00:18,  2.27it/s] 48%|████▊     | 35/73 [00:11<00:10,  3.69it/s] 55%|█████▍    | 40/73 [00:11<00:05,  5.54it/s] 59%|█████▉    | 43/73 [00:23<00:34,  1.14s/it] 62%|██████▏   | 45/73 [00:23<00:26,  1.06it/s] 66%|██████▌   | 48/73 [00:24<00:17,  1.42it/s] 68%|██████▊   | 50/73 [00:24<00:13,  1.75it/s] 71%|███████   | 52/73 [00:24<00:09,  2.18it/s] 74%|███████▍  | 54/73 [00:24<00:06,  2.74it/s] 77%|███████▋  | 56/73 [00:24<00:04,  3.41it/s] 79%|███████▉  | 58/73 [00:25<00:03,  4.20it/s] 82%|████████▏ | 60/73 [00:25<00:02,  5.07it/s] 85%|████████▍ | 62/73 [00:25<00:01,  5.83it/s] 85%|████████▍ | 62/73 [00:35<00:01,  5.83it/s] 86%|████████▋ | 63/73 [00:40<00:26,  2.64s/it] 88%|████████▊ | 64/73 [00:40<00:19,  2.15s/it] 90%|█████████ | 66/73 [00:40<00:09,  1.41s/it] 93%|█████████▎| 68/73 [00:40<00:04,  1.04it/s] 96%|█████████▌| 70/73 [00:40<00:02,  1.44it/s] 97%|█████████▋| 71/73 [00:41<00:01,  1.70it/s]100%|██████████| 73/73 [00:48<00:00,  1.62s/it]100%|██████████| 73/73 [00:48<00:00,  1.52it/s]
2025-03-13 16:19:50,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:50
2025-03-13 16:22:07,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 137.4809 secs
2025-03-13 16:22:07,584 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 16:22:07,584 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s]
2025-03-13 16:23:54,833 [INFO]: 	>>> Finished "Compute fast metrics" in 107.2486 secs
2025-03-13 16:23:54,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 292.9224 secs
2025-03-13 16:23:54,835 [INFO]: {
2025-03-13 16:23:54,835 [INFO]: 	index_key: HNSW32
2025-03-13 16:23:54,835 [INFO]: 	index_param: efSearch=96
2025-03-13 16:23:54,835 [INFO]: 	index_path: knn.index
2025-03-13 16:23:54,835 [INFO]: 	size in bytes: 3484385146
2025-03-13 16:23:54,835 [INFO]: 	avg_search_speed_ms: 17.45762639836673
2025-03-13 16:23:54,835 [INFO]: 	99p_search_speed_ms: 36.02120090275999
2025-03-13 16:23:54,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:54,835 [INFO]: 	nb vectors: 17698
2025-03-13 16:23:54,835 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:54,835 [INFO]: 	compression ratio: 0.9986176149311365
2025-03-13 16:23:54,835 [INFO]: }
2025-03-13 16:23:54,835 [INFO]: 	>>> Finished "Creating the index" in 292.9240 secs
2025-03-13 16:23:54,835 [INFO]: >>> Finished "Launching the whole pipeline" in 292.9652 secs
2025-03-13 16:24:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 17491 [episode count 1/20]
[retrieval_preprocessing] for episode 71767 [episode count 2/20], we have num_retrieval=np.int64(17883) num_query=np.int64(797)
2025-03-13 16:24:08,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:12,625 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:12
2025-03-13 16:24:12,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 888.06it/s]
2025-03-13 16:24:12,657 [INFO]: There are 17883 embeddings of dim 49152
2025-03-13 16:24:12,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 16:24:12,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:12
2025-03-13 16:24:12,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:12,658 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 16:24:12,658 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:24:12,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:24:12,658 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:12
2025-03-13 16:24:12,658 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:12,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:24:12,659 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:12
2025-03-13 16:24:12,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:24:12,659 [INFO]: 	Creating the index 03/13/2025, 16:24:12
2025-03-13 16:24:12,659 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:24:12
2025-03-13 16:24:12,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-13 16:24:12,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:12
2025-03-13 16:24:12,663 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 16:24:12,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:18,  3.95it/s]  3%|▎         | 2/74 [00:00<00:12,  5.79it/s]  5%|▌         | 4/74 [00:00<00:08,  8.34it/s]  8%|▊         | 6/74 [00:00<00:07,  9.34it/s] 11%|█         | 8/74 [00:00<00:06,  9.81it/s] 14%|█▎        | 10/74 [00:01<00:06,  9.98it/s] 16%|█▌        | 12/74 [00:01<00:06, 10.24it/s] 19%|█▉        | 14/74 [00:01<00:05, 10.22it/s] 22%|██▏       | 16/74 [00:01<00:06,  8.95it/s] 23%|██▎       | 17/74 [00:01<00:06,  9.04it/s] 26%|██▌       | 19/74 [00:02<00:05,  9.62it/s] 28%|██▊       | 21/74 [00:12<01:38,  1.85s/it] 34%|███▍      | 25/74 [00:12<00:47,  1.04it/s] 38%|███▊      | 28/74 [00:13<00:29,  1.55it/s] 42%|████▏     | 31/74 [00:13<00:19,  2.24it/s] 46%|████▌     | 34/74 [00:13<00:12,  3.15it/s] 50%|█████     | 37/74 [00:13<00:08,  4.35it/s] 54%|█████▍    | 40/74 [00:13<00:05,  5.83it/s] 55%|█████▌    | 41/74 [00:25<00:05,  5.83it/s] 57%|█████▋    | 42/74 [00:25<00:49,  1.55s/it] 61%|██████    | 45/74 [00:26<00:30,  1.06s/it] 65%|██████▍   | 48/74 [00:26<00:19,  1.36it/s] 69%|██████▉   | 51/74 [00:26<00:12,  1.89it/s] 72%|███████▏  | 53/74 [00:26<00:09,  2.33it/s] 74%|███████▍  | 55/74 [00:26<00:06,  2.86it/s] 77%|███████▋  | 57/74 [00:27<00:05,  3.25it/s] 80%|███████▉  | 59/74 [00:27<00:03,  3.75it/s] 82%|████████▏ | 61/74 [00:27<00:03,  4.25it/s] 84%|████████▍ | 62/74 [00:28<00:02,  4.49it/s] 85%|████████▌ | 63/74 [00:42<00:32,  2.99s/it] 86%|████████▋ | 64/74 [00:42<00:23,  2.37s/it] 89%|████████▉ | 66/74 [00:42<00:12,  1.51s/it] 91%|█████████ | 67/74 [00:43<00:08,  1.21s/it] 92%|█████████▏| 68/74 [00:43<00:05,  1.04it/s] 93%|█████████▎| 69/74 [00:43<00:03,  1.32it/s] 95%|█████████▍| 70/74 [00:43<00:02,  1.67it/s] 96%|█████████▌| 71/74 [00:43<00:01,  2.11it/s] 97%|█████████▋| 72/74 [00:43<00:00,  2.61it/s] 99%|█████████▊| 73/74 [00:44<00:00,  3.16it/s]100%|██████████| 74/74 [00:51<00:00,  2.26s/it]100%|██████████| 74/74 [00:51<00:00,  1.45it/s]
2025-03-13 16:25:03,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:03
2025-03-13 16:27:17,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 134.2727 secs
2025-03-13 16:27:17,989 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 16:27:17,989 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 16:28:35,200 [INFO]: 	>>> Finished "Compute fast metrics" in 77.2103 secs
2025-03-13 16:28:35,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 262.5399 secs
2025-03-13 16:28:35,203 [INFO]: {
2025-03-13 16:28:35,203 [INFO]: 	index_key: HNSW32
2025-03-13 16:28:35,203 [INFO]: 	index_param: efSearch=92
2025-03-13 16:28:35,203 [INFO]: 	index_path: knn.index
2025-03-13 16:28:35,203 [INFO]: 	size in bytes: 3520807462
2025-03-13 16:28:35,203 [INFO]: 	avg_search_speed_ms: 15.379003872136412
2025-03-13 16:28:35,203 [INFO]: 	99p_search_speed_ms: 26.523150503635406
2025-03-13 16:28:35,203 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:35,203 [INFO]: 	nb vectors: 17883
2025-03-13 16:28:35,203 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:35,203 [INFO]: 	compression ratio: 0.998617760825457
2025-03-13 16:28:35,203 [INFO]: }
2025-03-13 16:28:35,203 [INFO]: 	>>> Finished "Creating the index" in 262.5438 secs
2025-03-13 16:28:35,203 [INFO]: >>> Finished "Launching the whole pipeline" in 262.5775 secs
2025-03-13 16:28:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 71767 [episode count 2/20]
[retrieval_preprocessing] for episode 38508 [episode count 3/20], we have num_retrieval=np.int64(17777) num_query=np.int64(903)
2025-03-13 16:28:48,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:51,258 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:51
2025-03-13 16:28:51,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-13 16:28:51,284 [INFO]: There are 17777 embeddings of dim 49152
2025-03-13 16:28:51,284 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:28:51,284 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:51
2025-03-13 16:28:51,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:51,284 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 16:28:51,284 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:28:51,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:28:51,284 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:51
2025-03-13 16:28:51,285 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:51,285 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:28:51,285 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:51
2025-03-13 16:28:51,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:51,285 [INFO]: 	Creating the index 03/13/2025, 16:28:51
2025-03-13 16:28:51,285 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:28:51
2025-03-13 16:28:51,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:28:51,286 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:51
2025-03-13 16:28:51,286 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 16:28:51,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:18,  3.83it/s]  3%|▎         | 2/73 [00:00<00:12,  5.64it/s]  4%|▍         | 3/73 [00:00<00:10,  6.59it/s]  5%|▌         | 4/73 [00:00<00:09,  7.12it/s]  7%|▋         | 5/73 [00:00<00:09,  7.30it/s]  8%|▊         | 6/73 [00:00<00:09,  7.42it/s] 10%|▉         | 7/73 [00:01<00:09,  7.27it/s] 11%|█         | 8/73 [00:01<00:08,  7.32it/s] 12%|█▏        | 9/73 [00:01<00:08,  7.85it/s] 14%|█▎        | 10/73 [00:01<00:07,  8.36it/s] 15%|█▌        | 11/73 [00:01<00:07,  8.63it/s] 16%|█▋        | 12/73 [00:01<00:06,  8.74it/s] 18%|█▊        | 13/73 [00:01<00:07,  8.24it/s] 21%|██        | 15/73 [00:01<00:05, 10.28it/s] 23%|██▎       | 17/73 [00:02<00:04, 11.66it/s] 26%|██▌       | 19/73 [00:02<00:04, 12.57it/s] 29%|██▉       | 21/73 [00:09<01:11,  1.37s/it] 30%|███       | 22/73 [00:09<00:57,  1.13s/it] 32%|███▏      | 23/73 [00:10<00:45,  1.11it/s] 34%|███▍      | 25/73 [00:10<00:28,  1.69it/s] 36%|███▌      | 26/73 [00:10<00:22,  2.05it/s] 38%|███▊      | 28/73 [00:10<00:15,  2.94it/s] 40%|███▉      | 29/73 [00:10<00:12,  3.46it/s] 41%|████      | 30/73 [00:10<00:10,  4.07it/s] 42%|████▏     | 31/73 [00:10<00:08,  4.77it/s] 44%|████▍     | 32/73 [00:10<00:07,  5.51it/s] 47%|████▋     | 34/73 [00:11<00:05,  6.81it/s] 48%|████▊     | 35/73 [00:11<00:05,  7.32it/s] 51%|█████     | 37/73 [00:11<00:04,  8.49it/s] 53%|█████▎    | 39/73 [00:11<00:03,  8.74it/s] 55%|█████▍    | 40/73 [00:11<00:03,  8.90it/s] 56%|█████▌    | 41/73 [00:11<00:03,  8.87it/s] 58%|█████▊    | 42/73 [00:21<01:18,  2.53s/it] 59%|█████▉    | 43/73 [00:21<00:57,  1.91s/it] 60%|██████    | 44/73 [00:22<00:41,  1.42s/it] 62%|██████▏   | 45/73 [00:22<00:29,  1.05s/it] 63%|██████▎   | 46/73 [00:22<00:21,  1.27it/s] 64%|██████▍   | 47/73 [00:22<00:15,  1.70it/s] 66%|██████▌   | 48/73 [00:22<00:11,  2.22it/s] 67%|██████▋   | 49/73 [00:22<00:08,  2.85it/s] 68%|██████▊   | 50/73 [00:22<00:06,  3.55it/s] 71%|███████   | 52/73 [00:22<00:04,  5.08it/s] 74%|███████▍  | 54/73 [00:23<00:02,  6.38it/s] 77%|███████▋  | 56/73 [00:23<00:02,  7.45it/s] 79%|███████▉  | 58/73 [00:23<00:01,  8.15it/s] 81%|████████  | 59/73 [00:23<00:01,  8.34it/s] 82%|████████▏ | 60/73 [00:23<00:01,  7.73it/s] 84%|████████▎ | 61/73 [00:23<00:01,  7.53it/s] 86%|████████▋ | 63/73 [00:37<00:28,  2.82s/it] 89%|████████▉ | 65/73 [00:37<00:14,  1.82s/it] 92%|█████████▏| 67/73 [00:37<00:07,  1.23s/it] 95%|█████████▍| 69/73 [00:38<00:03,  1.17it/s] 97%|█████████▋| 71/73 [00:38<00:01,  1.63it/s]100%|██████████| 73/73 [00:46<00:00,  1.66s/it]100%|██████████| 73/73 [00:46<00:00,  1.58it/s]
2025-03-13 16:29:37,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:37
2025-03-13 16:31:47,542 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 130.0943 secs
2025-03-13 16:31:47,542 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 16:31:47,542 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 16:33:30,688 [INFO]: 	>>> Finished "Compute fast metrics" in 103.1463 secs
2025-03-13 16:33:30,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 279.4044 secs
2025-03-13 16:33:30,690 [INFO]: {
2025-03-13 16:33:30,690 [INFO]: 	index_key: HNSW32
2025-03-13 16:33:30,691 [INFO]: 	index_param: efSearch=103
2025-03-13 16:33:30,691 [INFO]: 	index_path: knn.index
2025-03-13 16:33:30,691 [INFO]: 	size in bytes: 3499938478
2025-03-13 16:33:30,691 [INFO]: 	avg_search_speed_ms: 19.99086950219677
2025-03-13 16:33:30,691 [INFO]: 	99p_search_speed_ms: 39.86007999628782
2025-03-13 16:33:30,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:30,691 [INFO]: 	nb vectors: 17777
2025-03-13 16:33:30,691 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:30,691 [INFO]: 	compression ratio: 0.9986176722732667
2025-03-13 16:33:30,691 [INFO]: }
2025-03-13 16:33:30,691 [INFO]: 	>>> Finished "Creating the index" in 279.4059 secs
2025-03-13 16:33:30,691 [INFO]: >>> Finished "Launching the whole pipeline" in 279.4330 secs
2025-03-13 16:33:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 38508 [episode count 3/20]
[retrieval_preprocessing] for episode 85642 [episode count 4/20], we have num_retrieval=np.int64(17927) num_query=np.int64(753)
2025-03-13 16:33:48,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:51,573 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:51
2025-03-13 16:33:51,573 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.85it/s]
2025-03-13 16:33:51,601 [INFO]: There are 17927 embeddings of dim 49152
2025-03-13 16:33:51,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:33:51,601 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:51
2025-03-13 16:33:51,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:51,601 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 16:33:51,601 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:33:51,601 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:51,601 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:51
2025-03-13 16:33:51,602 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:51,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:33:51,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:51
2025-03-13 16:33:51,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:51,602 [INFO]: 	Creating the index 03/13/2025, 16:33:51
2025-03-13 16:33:51,602 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:33:51
2025-03-13 16:33:51,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 16:33:51,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:51
2025-03-13 16:33:51,603 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 16:33:51,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:18,  3.88it/s]  3%|▎         | 2/74 [00:00<00:12,  5.97it/s]  4%|▍         | 3/74 [00:00<00:09,  7.21it/s]  5%|▌         | 4/74 [00:00<00:08,  8.05it/s]  7%|▋         | 5/74 [00:00<00:08,  8.48it/s]  8%|▊         | 6/74 [00:00<00:08,  8.45it/s]  9%|▉         | 7/74 [00:00<00:07,  8.76it/s] 11%|█         | 8/74 [00:01<00:07,  8.98it/s] 14%|█▎        | 10/74 [00:01<00:06,  9.60it/s] 16%|█▌        | 12/74 [00:01<00:06,  9.93it/s] 18%|█▊        | 13/74 [00:01<00:06,  9.88it/s] 20%|██        | 15/74 [00:01<00:05, 10.02it/s] 23%|██▎       | 17/74 [00:01<00:05, 10.12it/s] 26%|██▌       | 19/74 [00:02<00:05, 10.19it/s] 28%|██▊       | 21/74 [00:10<01:18,  1.47s/it] 30%|██▉       | 22/74 [00:10<01:03,  1.22s/it] 32%|███▏      | 24/74 [00:11<00:41,  1.22it/s] 35%|███▌      | 26/74 [00:11<00:27,  1.73it/s] 38%|███▊      | 28/74 [00:11<00:19,  2.39it/s] 41%|████      | 30/74 [00:11<00:13,  3.16it/s] 43%|████▎     | 32/74 [00:11<00:10,  4.04it/s] 46%|████▌     | 34/74 [00:11<00:08,  4.96it/s] 49%|████▊     | 36/74 [00:12<00:06,  5.91it/s] 51%|█████▏    | 38/74 [00:12<00:05,  6.84it/s] 54%|█████▍    | 40/74 [00:12<00:04,  7.27it/s] 55%|█████▌    | 41/74 [00:12<00:04,  7.54it/s] 57%|█████▋    | 42/74 [00:23<01:10,  2.21s/it] 58%|█████▊    | 43/74 [00:23<00:54,  1.75s/it] 59%|█████▉    | 44/74 [00:23<00:40,  1.35s/it] 61%|██████    | 45/74 [00:23<00:29,  1.03s/it] 62%|██████▏   | 46/74 [00:23<00:22,  1.27it/s] 64%|██████▎   | 47/74 [00:23<00:16,  1.66it/s] 65%|██████▍   | 48/74 [00:23<00:12,  2.16it/s] 66%|██████▌   | 49/74 [00:23<00:09,  2.74it/s] 68%|██████▊   | 50/74 [00:24<00:07,  3.42it/s] 69%|██████▉   | 51/74 [00:24<00:05,  4.20it/s] 70%|███████   | 52/74 [00:24<00:04,  4.99it/s] 72%|███████▏  | 53/74 [00:24<00:03,  5.78it/s] 73%|███████▎  | 54/74 [00:24<00:03,  6.55it/s] 74%|███████▍  | 55/74 [00:24<00:02,  7.22it/s] 76%|███████▌  | 56/74 [00:24<00:02,  7.74it/s] 77%|███████▋  | 57/74 [00:24<00:02,  8.17it/s] 78%|███████▊  | 58/74 [00:24<00:01,  8.48it/s] 80%|███████▉  | 59/74 [00:24<00:01,  8.84it/s] 81%|████████  | 60/74 [00:25<00:01,  9.09it/s] 82%|████████▏ | 61/74 [00:25<00:01,  9.30it/s] 84%|████████▍ | 62/74 [00:25<00:01,  9.48it/s] 85%|████████▌ | 63/74 [00:37<00:42,  3.84s/it] 86%|████████▋ | 64/74 [00:37<00:27,  2.73s/it] 88%|████████▊ | 65/74 [00:38<00:17,  1.94s/it] 89%|████████▉ | 66/74 [00:38<00:11,  1.39s/it] 92%|█████████▏| 68/74 [00:38<00:04,  1.26it/s] 95%|█████████▍| 70/74 [00:38<00:02,  1.93it/s] 96%|█████████▌| 71/74 [00:38<00:01,  2.35it/s] 99%|█████████▊| 73/74 [00:38<00:00,  3.35it/s]100%|██████████| 74/74 [00:45<00:00,  1.64s/it]100%|██████████| 74/74 [00:45<00:00,  1.63it/s]
2025-03-13 16:34:36,990 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:36
2025-03-13 16:36:40,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 123.4450 secs
2025-03-13 16:36:40,436 [INFO]: The best hyperparameters are: efSearch=104
2025-03-13 16:36:40,436 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-13 16:37:34,255 [INFO]: 	>>> Finished "Compute fast metrics" in 53.8197 secs
2025-03-13 16:37:34,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 222.6540 secs
2025-03-13 16:37:34,257 [INFO]: {
2025-03-13 16:37:34,257 [INFO]: 	index_key: HNSW32
2025-03-13 16:37:34,258 [INFO]: 	index_param: efSearch=104
2025-03-13 16:37:34,258 [INFO]: 	index_path: knn.index
2025-03-13 16:37:34,258 [INFO]: 	size in bytes: 3529470006
2025-03-13 16:37:34,258 [INFO]: 	avg_search_speed_ms: 19.319331693700352
2025-03-13 16:37:34,258 [INFO]: 	99p_search_speed_ms: 34.96291114017365
2025-03-13 16:37:34,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:34,258 [INFO]: 	nb vectors: 17927
2025-03-13 16:37:34,258 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:34,258 [INFO]: 	compression ratio: 0.9986178123084466
2025-03-13 16:37:34,258 [INFO]: }
2025-03-13 16:37:34,258 [INFO]: 	>>> Finished "Creating the index" in 222.6558 secs
2025-03-13 16:37:34,258 [INFO]: >>> Finished "Launching the whole pipeline" in 222.6849 secs
2025-03-13 16:37:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 85642 [episode count 4/20]
[retrieval_preprocessing] for episode 21144 [episode count 5/20], we have num_retrieval=np.int64(17625) num_query=np.int64(1055)
2025-03-13 16:37:50,819 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:54,081 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:54
2025-03-13 16:37:54,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.19it/s]
2025-03-13 16:37:54,107 [INFO]: There are 17625 embeddings of dim 49152
2025-03-13 16:37:54,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:37:54,108 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:54
2025-03-13 16:37:54,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:54,108 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 16:37:54,108 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:37:54,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:37:54,108 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:54
2025-03-13 16:37:54,108 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:54,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:37:54,108 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:54
2025-03-13 16:37:54,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:54,108 [INFO]: 	Creating the index 03/13/2025, 16:37:54
2025-03-13 16:37:54,108 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:37:54
2025-03-13 16:37:54,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 16:37:54,110 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:54
2025-03-13 16:37:54,110 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 16:37:54,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:16,  4.43it/s]  4%|▍         | 3/73 [00:00<00:08,  8.50it/s]  7%|▋         | 5/73 [00:00<00:06, 10.07it/s] 10%|▉         | 7/73 [00:00<00:05, 11.00it/s] 12%|█▏        | 9/73 [00:00<00:05, 11.52it/s] 15%|█▌        | 11/73 [00:01<00:05, 11.73it/s] 18%|█▊        | 13/73 [00:01<00:04, 12.04it/s] 21%|██        | 15/73 [00:01<00:04, 12.19it/s] 23%|██▎       | 17/73 [00:01<00:04, 12.35it/s] 26%|██▌       | 19/73 [00:01<00:04, 12.41it/s] 29%|██▉       | 21/73 [00:08<00:57,  1.10s/it] 32%|███▏      | 23/73 [00:08<00:39,  1.27it/s] 34%|███▍      | 25/73 [00:08<00:27,  1.75it/s] 37%|███▋      | 27/73 [00:08<00:19,  2.38it/s] 40%|███▉      | 29/73 [00:09<00:13,  3.17it/s] 42%|████▏     | 31/73 [00:09<00:10,  4.11it/s] 45%|████▌     | 33/73 [00:09<00:07,  5.17it/s] 48%|████▊     | 35/73 [00:09<00:06,  6.30it/s] 51%|█████     | 37/73 [00:09<00:05,  7.17it/s] 53%|█████▎    | 39/73 [00:09<00:04,  8.11it/s] 56%|█████▌    | 41/73 [00:10<00:03,  8.77it/s] 59%|█████▉    | 43/73 [00:19<00:47,  1.57s/it] 60%|██████    | 44/73 [00:20<00:38,  1.31s/it] 62%|██████▏   | 45/73 [00:20<00:29,  1.07s/it] 63%|██████▎   | 46/73 [00:20<00:23,  1.17it/s] 64%|██████▍   | 47/73 [00:20<00:17,  1.48it/s] 66%|██████▌   | 48/73 [00:20<00:13,  1.88it/s] 67%|██████▋   | 49/73 [00:20<00:10,  2.40it/s] 68%|██████▊   | 50/73 [00:20<00:07,  3.02it/s] 71%|███████   | 52/73 [00:20<00:04,  4.39it/s] 74%|███████▍  | 54/73 [00:21<00:03,  5.72it/s] 78%|███████▊  | 57/73 [00:21<00:01,  8.61it/s] 82%|████████▏ | 60/73 [00:21<00:01, 11.38it/s] 85%|████████▍ | 62/73 [00:33<00:00, 11.38it/s] 86%|████████▋ | 63/73 [00:41<00:24,  2.44s/it] 88%|████████▊ | 64/73 [00:41<00:19,  2.11s/it] 90%|█████████ | 66/73 [00:41<00:10,  1.53s/it] 93%|█████████▎| 68/73 [00:42<00:05,  1.12s/it] 95%|█████████▍| 69/73 [00:42<00:03,  1.05it/s] 96%|█████████▌| 70/73 [00:42<00:02,  1.27it/s] 97%|█████████▋| 71/73 [00:42<00:01,  1.55it/s] 99%|█████████▊| 72/73 [00:42<00:00,  1.92it/s]100%|██████████| 73/73 [00:51<00:00,  2.74s/it]100%|██████████| 73/73 [00:51<00:00,  1.41it/s]
2025-03-13 16:38:45,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:45
2025-03-13 16:41:28,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 162.1253 secs
2025-03-13 16:41:28,084 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 16:41:28,084 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.37it/s] 50%|█████     | 2/4 [00:00<00:00,  4.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.86it/s]
2025-03-13 16:42:37,131 [INFO]: 	>>> Finished "Compute fast metrics" in 69.0472 secs
2025-03-13 16:42:37,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 283.0237 secs
2025-03-13 16:42:37,134 [INFO]: {
2025-03-13 16:42:37,134 [INFO]: 	index_key: HNSW32
2025-03-13 16:42:37,134 [INFO]: 	index_param: efSearch=89
2025-03-13 16:42:37,134 [INFO]: 	index_path: knn.index
2025-03-13 16:42:37,134 [INFO]: 	size in bytes: 3470012686
2025-03-13 16:42:37,134 [INFO]: 	avg_search_speed_ms: 18.06457108096808
2025-03-13 16:42:37,134 [INFO]: 	99p_search_speed_ms: 41.47794122574851
2025-03-13 16:42:37,134 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:37,134 [INFO]: 	nb vectors: 17625
2025-03-13 16:42:37,134 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:37,134 [INFO]: 	compression ratio: 0.9986176747942875
2025-03-13 16:42:37,134 [INFO]: }
2025-03-13 16:42:37,134 [INFO]: 	>>> Finished "Creating the index" in 283.0255 secs
2025-03-13 16:42:37,134 [INFO]: >>> Finished "Launching the whole pipeline" in 283.0532 secs
2025-03-13 16:42:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 21144 [episode count 5/20]
[retrieval_preprocessing] for episode 90788 [episode count 6/20], we have num_retrieval=np.int64(17680) num_query=np.int64(1000)
2025-03-13 16:42:47,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:50,864 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:50
2025-03-13 16:42:50,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 912.60it/s]
2025-03-13 16:42:50,912 [INFO]: There are 17680 embeddings of dim 49152
2025-03-13 16:42:50,912 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0475 secs
2025-03-13 16:42:50,912 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:50
2025-03-13 16:42:50,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:50,913 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 16:42:50,913 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:42:50,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:42:50,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:50
2025-03-13 16:42:50,914 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:50,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:42:50,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:50
2025-03-13 16:42:50,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:42:50,915 [INFO]: 	Creating the index 03/13/2025, 16:42:50
2025-03-13 16:42:50,915 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:42:50
2025-03-13 16:42:50,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-13 16:42:50,918 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:50
2025-03-13 16:42:50,918 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 16:42:50,919 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:09,  7.52it/s]  7%|▋         | 5/73 [00:00<00:02, 24.33it/s] 14%|█▎        | 10/73 [00:00<00:01, 32.38it/s] 19%|█▉        | 14/73 [00:00<00:01, 33.28it/s] 25%|██▍       | 18/73 [00:00<00:01, 35.40it/s] 30%|███       | 22/73 [00:08<00:35,  1.44it/s] 37%|███▋      | 27/73 [00:08<00:20,  2.28it/s] 45%|████▌     | 33/73 [00:08<00:10,  3.67it/s] 53%|█████▎    | 39/73 [00:08<00:06,  5.52it/s] 60%|██████    | 44/73 [00:17<00:19,  1.47it/s] 66%|██████▌   | 48/73 [00:18<00:12,  1.95it/s] 71%|███████   | 52/73 [00:18<00:08,  2.62it/s] 79%|███████▉  | 58/73 [00:18<00:03,  4.01it/s] 86%|████████▋ | 63/73 [00:28<00:08,  1.22it/s] 89%|████████▉ | 65/73 [00:29<00:05,  1.41it/s] 95%|█████████▍| 69/73 [00:29<00:02,  1.90it/s] 99%|█████████▊| 72/73 [00:29<00:00,  2.36it/s]100%|██████████| 73/73 [00:36<00:00,  2.00it/s]
2025-03-13 16:43:27,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:27
2025-03-13 16:46:05,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 157.9595 secs
2025-03-13 16:46:05,381 [INFO]: The best hyperparameters are: efSearch=66
2025-03-13 16:46:05,382 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.83it/s]
2025-03-13 16:47:21,690 [INFO]: 	>>> Finished "Compute fast metrics" in 76.3077 secs
2025-03-13 16:47:21,694 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 270.7757 secs
2025-03-13 16:47:21,695 [INFO]: {
2025-03-13 16:47:21,695 [INFO]: 	index_key: HNSW32
2025-03-13 16:47:21,695 [INFO]: 	index_param: efSearch=66
2025-03-13 16:47:21,695 [INFO]: 	index_path: knn.index
2025-03-13 16:47:21,695 [INFO]: 	size in bytes: 3480841378
2025-03-13 16:47:21,695 [INFO]: 	avg_search_speed_ms: 14.865090727341123
2025-03-13 16:47:21,695 [INFO]: 	99p_search_speed_ms: 28.969292156398296
2025-03-13 16:47:21,695 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:21,695 [INFO]: 	nb vectors: 17680
2025-03-13 16:47:21,695 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:21,695 [INFO]: 	compression ratio: 0.9986175934271487
2025-03-13 16:47:21,695 [INFO]: }
2025-03-13 16:47:21,695 [INFO]: 	>>> Finished "Creating the index" in 270.7805 secs
2025-03-13 16:47:21,695 [INFO]: >>> Finished "Launching the whole pipeline" in 270.8309 secs
2025-03-13 16:47:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 90788 [episode count 6/20]
[retrieval_preprocessing] for episode 63189 [episode count 7/20], we have num_retrieval=np.int64(17786) num_query=np.int64(894)
2025-03-13 16:47:37,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:40,018 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:40
2025-03-13 16:47:40,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1107.26it/s]
2025-03-13 16:47:40,056 [INFO]: There are 17786 embeddings of dim 49152
2025-03-13 16:47:40,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 16:47:40,056 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:40
2025-03-13 16:47:40,056 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:40,056 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 16:47:40,056 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:47:40,056 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:40,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:40
2025-03-13 16:47:40,057 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:40,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:47:40,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:40
2025-03-13 16:47:40,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:40,057 [INFO]: 	Creating the index 03/13/2025, 16:47:40
2025-03-13 16:47:40,057 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:47:40
2025-03-13 16:47:40,058 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 16:47:40,058 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:40
2025-03-13 16:47:40,058 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 16:47:40,058 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:08,  8.39it/s]  7%|▋         | 5/73 [00:00<00:02, 25.38it/s] 14%|█▎        | 10/73 [00:00<00:01, 35.78it/s] 21%|██        | 15/73 [00:00<00:01, 39.80it/s] 27%|██▋       | 20/73 [00:00<00:01, 42.49it/s] 34%|███▍      | 25/73 [00:08<00:28,  1.69it/s] 41%|████      | 30/73 [00:08<00:17,  2.52it/s] 48%|████▊     | 35/73 [00:08<00:10,  3.65it/s] 55%|█████▍    | 40/73 [00:08<00:06,  5.17it/s] 62%|██████▏   | 45/73 [00:19<00:22,  1.24it/s] 68%|██████▊   | 50/73 [00:19<00:12,  1.78it/s] 75%|███████▌  | 55/73 [00:19<00:07,  2.52it/s] 82%|████████▏ | 60/73 [00:19<00:03,  3.54it/s] 89%|████████▉ | 65/73 [00:34<00:08,  1.08s/it] 93%|█████████▎| 68/73 [00:34<00:04,  1.16it/s]100%|██████████| 73/73 [00:42<00:00,  1.14s/it]100%|██████████| 73/73 [00:42<00:00,  1.70it/s]
2025-03-13 16:48:23,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:23
2025-03-13 16:50:36,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 133.6462 secs
2025-03-13 16:50:36,664 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 16:50:36,664 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.92it/s]
2025-03-13 16:51:47,135 [INFO]: 	>>> Finished "Compute fast metrics" in 70.4707 secs
2025-03-13 16:51:47,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 247.0787 secs
2025-03-13 16:51:47,137 [INFO]: {
2025-03-13 16:51:47,137 [INFO]: 	index_key: HNSW32
2025-03-13 16:51:47,137 [INFO]: 	index_param: efSearch=95
2025-03-13 16:51:47,137 [INFO]: 	index_path: knn.index
2025-03-13 16:51:47,137 [INFO]: 	size in bytes: 3501710362
2025-03-13 16:51:47,137 [INFO]: 	avg_search_speed_ms: 17.999368893960824
2025-03-13 16:51:47,137 [INFO]: 	99p_search_speed_ms: 27.24428856745363
2025-03-13 16:51:47,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:47,137 [INFO]: 	nb vectors: 17786
2025-03-13 16:51:47,137 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:47,137 [INFO]: 	compression ratio: 0.9986176829321671
2025-03-13 16:51:47,137 [INFO]: }
2025-03-13 16:51:47,137 [INFO]: 	>>> Finished "Creating the index" in 247.0806 secs
2025-03-13 16:51:47,137 [INFO]: >>> Finished "Launching the whole pipeline" in 247.1192 secs
2025-03-13 16:51:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 63189 [episode count 7/20]
[retrieval_preprocessing] for episode 80087 [episode count 8/20], we have num_retrieval=np.int64(17579) num_query=np.int64(1101)
2025-03-13 16:51:55,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:58,865 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:58
2025-03-13 16:51:58,865 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.80it/s]
2025-03-13 16:51:58,912 [INFO]: There are 17579 embeddings of dim 49152
2025-03-13 16:51:58,912 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0472 secs
2025-03-13 16:51:58,912 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:58
2025-03-13 16:51:58,912 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:58,912 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 16:51:58,912 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:51:58,912 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:58,912 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:58
2025-03-13 16:51:58,912 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:58,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:58,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:58
2025-03-13 16:51:58,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:58,913 [INFO]: 	Creating the index 03/13/2025, 16:51:58
2025-03-13 16:51:58,913 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:51:58
2025-03-13 16:51:58,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 16:51:58,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:58
2025-03-13 16:51:58,914 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 16:51:58,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:12,  5.82it/s]  5%|▌         | 4/73 [00:00<00:04, 16.41it/s] 11%|█         | 8/73 [00:00<00:02, 24.63it/s] 16%|█▋        | 12/73 [00:00<00:02, 28.70it/s] 22%|██▏       | 16/73 [00:00<00:01, 31.15it/s] 27%|██▋       | 20/73 [00:00<00:01, 33.24it/s] 33%|███▎      | 24/73 [00:09<00:37,  1.30it/s] 40%|███▉      | 29/73 [00:09<00:21,  2.05it/s] 47%|████▋     | 34/73 [00:09<00:12,  3.09it/s] 53%|█████▎    | 39/73 [00:09<00:07,  4.49it/s] 59%|█████▉    | 43/73 [00:22<00:31,  1.05s/it] 66%|██████▌   | 48/73 [00:22<00:17,  1.41it/s] 73%|███████▎  | 53/73 [00:22<00:09,  2.04it/s] 79%|███████▉  | 58/73 [00:23<00:05,  2.88it/s] 86%|████████▋ | 63/73 [00:36<00:10,  1.08s/it] 93%|█████████▎| 68/73 [00:36<00:03,  1.32it/s] 99%|█████████▊| 72/73 [00:36<00:00,  1.76it/s]100%|██████████| 73/73 [00:43<00:00,  1.70it/s]
2025-03-13 16:52:41,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:41
2025-03-13 16:54:58,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 136.2521 secs
2025-03-13 16:54:58,189 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 16:54:58,189 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 16:56:58,221 [INFO]: 	>>> Finished "Compute fast metrics" in 120.0317 secs
2025-03-13 16:56:58,624 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 299.7097 secs
2025-03-13 16:56:58,625 [INFO]: {
2025-03-13 16:56:58,625 [INFO]: 	index_key: HNSW32
2025-03-13 16:56:58,625 [INFO]: 	index_param: efSearch=103
2025-03-13 16:56:58,625 [INFO]: 	index_path: knn.index
2025-03-13 16:56:58,625 [INFO]: 	size in bytes: 3460956262
2025-03-13 16:56:58,625 [INFO]: 	avg_search_speed_ms: 18.96957169458002
2025-03-13 16:56:58,625 [INFO]: 	99p_search_speed_ms: 34.55443705432117
2025-03-13 16:56:58,625 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:58,625 [INFO]: 	nb vectors: 17579
2025-03-13 16:56:58,626 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:58,626 [INFO]: 	compression ratio: 0.9986176566134253
2025-03-13 16:56:58,626 [INFO]: }
2025-03-13 16:56:58,626 [INFO]: 	>>> Finished "Creating the index" in 299.7130 secs
2025-03-13 16:56:58,626 [INFO]: >>> Finished "Launching the whole pipeline" in 299.7609 secs
2025-03-13 16:57:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 80087 [episode count 8/20]
[retrieval_preprocessing] for episode 56083 [episode count 9/20], we have num_retrieval=np.int64(17751) num_query=np.int64(929)
2025-03-13 16:57:09,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:12,669 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:12
2025-03-13 16:57:12,669 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-13 16:57:12,711 [INFO]: There are 17751 embeddings of dim 49152
2025-03-13 16:57:12,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-13 16:57:12,712 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:12
2025-03-13 16:57:12,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:12,712 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 16:57:12,712 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:57:12,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:57:12,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:12
2025-03-13 16:57:12,713 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:12,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:57:12,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:12
2025-03-13 16:57:12,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:57:12,713 [INFO]: 	Creating the index 03/13/2025, 16:57:12
2025-03-13 16:57:12,713 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 16:57:12
2025-03-13 16:57:12,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0031 secs
2025-03-13 16:57:12,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:12
2025-03-13 16:57:12,717 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 16:57:12,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:11,  6.35it/s]  7%|▋         | 5/73 [00:00<00:03, 21.44it/s] 12%|█▏        | 9/73 [00:00<00:02, 28.34it/s] 18%|█▊        | 13/73 [00:00<00:01, 32.22it/s] 23%|██▎       | 17/73 [00:00<00:01, 34.12it/s] 29%|██▉       | 21/73 [00:09<00:44,  1.18it/s] 34%|███▍      | 25/73 [00:10<00:27,  1.75it/s] 41%|████      | 30/73 [00:10<00:15,  2.73it/s] 48%|████▊     | 35/73 [00:10<00:09,  4.05it/s] 55%|█████▍    | 40/73 [00:10<00:05,  5.78it/s] 60%|██████    | 44/73 [00:23<00:29,  1.02s/it] 66%|██████▌   | 48/73 [00:23<00:18,  1.35it/s] 71%|███████   | 52/73 [00:23<00:11,  1.86it/s] 77%|███████▋  | 56/73 [00:23<00:06,  2.57it/s] 82%|████████▏ | 60/73 [00:23<00:03,  3.53it/s] 85%|████████▍ | 62/73 [00:35<00:03,  3.53it/s] 86%|████████▋ | 63/73 [00:39<00:14,  1.43s/it] 88%|████████▊ | 64/73 [00:39<00:11,  1.29s/it] 92%|█████████▏| 67/73 [00:39<00:05,  1.07it/s] 96%|█████████▌| 70/73 [00:39<00:02,  1.47it/s] 99%|█████████▊| 72/73 [00:40<00:00,  1.82it/s]100%|██████████| 73/73 [00:46<00:00,  1.56it/s]
2025-03-13 16:57:59,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:59
2025-03-13 17:00:18,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 139.2746 secs
2025-03-13 17:00:18,795 [INFO]: The best hyperparameters are: efSearch=80
2025-03-13 17:00:18,796 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 17:01:49,383 [INFO]: 	>>> Finished "Compute fast metrics" in 90.5877 secs
2025-03-13 17:01:50,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 277.5231 secs
2025-03-13 17:01:50,241 [INFO]: {
2025-03-13 17:01:50,241 [INFO]: 	index_key: HNSW32
2025-03-13 17:01:50,241 [INFO]: 	index_param: efSearch=80
2025-03-13 17:01:50,241 [INFO]: 	index_path: knn.index
2025-03-13 17:01:50,241 [INFO]: 	size in bytes: 3494819702
2025-03-13 17:01:50,241 [INFO]: 	avg_search_speed_ms: 17.15325408273314
2025-03-13 17:01:50,241 [INFO]: 	99p_search_speed_ms: 27.30239195283502
2025-03-13 17:01:50,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:50,241 [INFO]: 	nb vectors: 17751
2025-03-13 17:01:50,241 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:50,241 [INFO]: 	compression ratio: 0.9986176414201753
2025-03-13 17:01:50,241 [INFO]: }
2025-03-13 17:01:50,241 [INFO]: 	>>> Finished "Creating the index" in 277.5279 secs
2025-03-13 17:01:50,241 [INFO]: >>> Finished "Launching the whole pipeline" in 277.5720 secs
2025-03-13 17:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 56083 [episode count 9/20]
[retrieval_preprocessing] for episode 92454 [episode count 10/20], we have num_retrieval=np.int64(17558) num_query=np.int64(1122)
2025-03-13 17:01:57,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:00,452 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:00
2025-03-13 17:02:00,452 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.60it/s]
2025-03-13 17:02:00,495 [INFO]: There are 17558 embeddings of dim 49152
2025-03-13 17:02:00,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 17:02:00,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:00,496 [INFO]: 		-> Add: 9.6 seconds
2025-03-13 17:02:00,496 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:02:00,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:00,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,496 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:00,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:02:00,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:00
2025-03-13 17:02:00,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:00,496 [INFO]: 	Creating the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,496 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:02:00
2025-03-13 17:02:00,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 17:02:00,498 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:00
2025-03-13 17:02:00,498 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 17:02:00,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:10,  6.83it/s]  7%|▋         | 5/73 [00:00<00:03, 21.92it/s] 14%|█▎        | 10/73 [00:00<00:02, 31.36it/s] 21%|██        | 15/73 [00:00<00:01, 36.38it/s] 27%|██▋       | 20/73 [00:00<00:01, 38.90it/s] 33%|███▎      | 24/73 [00:08<00:31,  1.55it/s] 40%|███▉      | 29/73 [00:08<00:18,  2.37it/s] 47%|████▋     | 34/73 [00:08<00:11,  3.50it/s] 53%|█████▎    | 39/73 [00:08<00:06,  5.01it/s] 60%|██████    | 44/73 [00:20<00:25,  1.15it/s] 67%|██████▋   | 49/73 [00:20<00:14,  1.65it/s] 74%|███████▍  | 54/73 [00:20<00:08,  2.34it/s] 81%|████████  | 59/73 [00:20<00:04,  3.29it/s] 88%|████████▊ | 64/73 [00:34<00:09,  1.06s/it] 93%|█████████▎| 68/73 [00:34<00:03,  1.26it/s]100%|██████████| 73/73 [00:42<00:00,  1.01it/s]100%|██████████| 73/73 [00:42<00:00,  1.74it/s]
2025-03-13 17:02:42,518 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:42
2025-03-13 17:04:52,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 129.6708 secs
2025-03-13 17:04:52,190 [INFO]: The best hyperparameters are: efSearch=117
2025-03-13 17:04:52,190 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-13 17:06:18,537 [INFO]: 	>>> Finished "Compute fast metrics" in 86.3471 secs
2025-03-13 17:06:18,540 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 258.0424 secs
2025-03-13 17:06:18,541 [INFO]: {
2025-03-13 17:06:18,541 [INFO]: 	index_key: HNSW32
2025-03-13 17:06:18,541 [INFO]: 	index_param: efSearch=117
2025-03-13 17:06:18,541 [INFO]: 	index_path: knn.index
2025-03-13 17:06:18,541 [INFO]: 	size in bytes: 3456821738
2025-03-13 17:06:18,541 [INFO]: 	avg_search_speed_ms: 22.145038940923172
2025-03-13 17:06:18,541 [INFO]: 	99p_search_speed_ms: 34.803258930332966
2025-03-13 17:06:18,541 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:18,541 [INFO]: 	nb vectors: 17558
2025-03-13 17:06:18,541 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:18,541 [INFO]: 	compression ratio: 0.9986176683780157
2025-03-13 17:06:18,541 [INFO]: }
2025-03-13 17:06:18,541 [INFO]: 	>>> Finished "Creating the index" in 258.0446 secs
2025-03-13 17:06:18,541 [INFO]: >>> Finished "Launching the whole pipeline" in 258.0891 secs
2025-03-13 17:06:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 92454 [episode count 10/20]
[retrieval_preprocessing] for episode 41777 [episode count 11/20], we have num_retrieval=np.int64(17730) num_query=np.int64(950)
2025-03-13 17:06:31,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:34,104 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:34
2025-03-13 17:06:34,104 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.98it/s]
2025-03-13 17:06:34,142 [INFO]: There are 17730 embeddings of dim 49152
2025-03-13 17:06:34,142 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 17:06:34,142 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:34
2025-03-13 17:06:34,142 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:34,142 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 17:06:34,142 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:06:34,143 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:06:34,143 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:34
2025-03-13 17:06:34,143 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:34,143 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:06:34,143 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:34
2025-03-13 17:06:34,143 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:34,143 [INFO]: 	Creating the index 03/13/2025, 17:06:34
2025-03-13 17:06:34,143 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:06:34
2025-03-13 17:06:34,144 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:06:34,144 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:34
2025-03-13 17:06:34,144 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:06:34,144 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:08,  8.55it/s]  7%|▋         | 5/73 [00:00<00:02, 23.44it/s] 12%|█▏        | 9/73 [00:00<00:02, 30.16it/s] 19%|█▉        | 14/73 [00:00<00:01, 36.09it/s] 26%|██▌       | 19/73 [00:00<00:01, 39.12it/s] 32%|███▏      | 23/73 [00:08<00:34,  1.47it/s] 36%|███▌      | 26/73 [00:09<00:24,  1.89it/s] 40%|███▉      | 29/73 [00:09<00:17,  2.44it/s] 45%|████▌     | 33/73 [00:09<00:11,  3.56it/s] 51%|█████     | 37/73 [00:09<00:07,  5.01it/s] 56%|█████▌    | 41/73 [00:09<00:04,  6.93it/s] 62%|██████▏   | 45/73 [00:22<00:29,  1.06s/it] 67%|██████▋   | 49/73 [00:22<00:17,  1.35it/s] 73%|███████▎  | 53/73 [00:22<00:10,  1.91it/s] 79%|███████▉  | 58/73 [00:22<00:05,  2.87it/s] 85%|████████▍ | 62/73 [00:33<00:03,  2.87it/s] 86%|████████▋ | 63/73 [00:36<00:11,  1.17s/it] 93%|█████████▎| 68/73 [00:36<00:04,  1.25it/s] 99%|█████████▊| 72/73 [00:36<00:00,  1.68it/s]100%|██████████| 73/73 [00:42<00:00,  1.70it/s]
2025-03-13 17:07:17,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:17
2025-03-13 17:09:25,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 128.8945 secs
2025-03-13 17:09:25,983 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 17:09:25,983 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-13 17:11:31,800 [INFO]: 	>>> Finished "Compute fast metrics" in 125.8170 secs
2025-03-13 17:11:31,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 297.6590 secs
2025-03-13 17:11:31,803 [INFO]: {
2025-03-13 17:11:31,803 [INFO]: 	index_key: HNSW32
2025-03-13 17:11:31,803 [INFO]: 	index_param: efSearch=111
2025-03-13 17:11:31,803 [INFO]: 	index_path: knn.index
2025-03-13 17:11:31,803 [INFO]: 	size in bytes: 3490685178
2025-03-13 17:11:31,804 [INFO]: 	avg_search_speed_ms: 20.837302629176218
2025-03-13 17:11:31,804 [INFO]: 	99p_search_speed_ms: 34.867451854515814
2025-03-13 17:11:31,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:31,804 [INFO]: 	nb vectors: 17730
2025-03-13 17:11:31,804 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:31,804 [INFO]: 	compression ratio: 0.9986176530526409
2025-03-13 17:11:31,804 [INFO]: }
2025-03-13 17:11:31,804 [INFO]: 	>>> Finished "Creating the index" in 297.6607 secs
2025-03-13 17:11:31,804 [INFO]: >>> Finished "Launching the whole pipeline" in 297.7000 secs
2025-03-13 17:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 41777 [episode count 11/20]
[retrieval_preprocessing] for episode 89459 [episode count 12/20], we have num_retrieval=np.int64(17879) num_query=np.int64(801)
2025-03-13 17:11:44,622 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:48,386 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:48
2025-03-13 17:11:48,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.36it/s]
2025-03-13 17:11:48,429 [INFO]: There are 17879 embeddings of dim 49152
2025-03-13 17:11:48,429 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0430 secs
2025-03-13 17:11:48,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:48
2025-03-13 17:11:48,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:48,429 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 17:11:48,429 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:11:48,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:48,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:48
2025-03-13 17:11:48,430 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:48,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:48,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:48
2025-03-13 17:11:48,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:48,430 [INFO]: 	Creating the index 03/13/2025, 17:11:48
2025-03-13 17:11:48,430 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:11:48
2025-03-13 17:11:48,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 17:11:48,431 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:48
2025-03-13 17:11:48,431 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:11:48,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:11,  6.25it/s]  5%|▌         | 4/74 [00:00<00:04, 17.20it/s]  9%|▉         | 7/74 [00:00<00:03, 21.68it/s] 15%|█▍        | 11/74 [00:00<00:02, 26.74it/s] 20%|██        | 15/74 [00:00<00:01, 30.19it/s] 26%|██▌       | 19/74 [00:00<00:01, 32.06it/s] 31%|███       | 23/74 [00:12<00:51,  1.01s/it] 36%|███▋      | 27/74 [00:12<00:31,  1.47it/s] 42%|████▏     | 31/74 [00:12<00:20,  2.13it/s] 47%|████▋     | 35/74 [00:12<00:12,  3.03it/s] 53%|█████▎    | 39/74 [00:12<00:08,  4.25it/s] 58%|█████▊    | 43/74 [00:23<00:30,  1.01it/s] 65%|██████▍   | 48/74 [00:23<00:16,  1.54it/s] 72%|███████▏  | 53/74 [00:23<00:09,  2.28it/s] 78%|███████▊  | 58/74 [00:23<00:04,  3.29it/s] 85%|████████▌ | 63/74 [00:38<00:12,  1.14s/it] 91%|█████████ | 67/74 [00:38<00:05,  1.18it/s] 96%|█████████▌| 71/74 [00:38<00:01,  1.61it/s]100%|██████████| 74/74 [00:45<00:00,  1.63it/s]
2025-03-13 17:12:33,816 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:33
2025-03-13 17:14:45,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 131.7308 secs
2025-03-13 17:14:45,548 [INFO]: The best hyperparameters are: efSearch=83
2025-03-13 17:14:45,548 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.76it/s]
2025-03-13 17:16:13,723 [INFO]: 	>>> Finished "Compute fast metrics" in 88.1750 secs
2025-03-13 17:16:13,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 265.2944 secs
2025-03-13 17:16:13,726 [INFO]: {
2025-03-13 17:16:13,726 [INFO]: 	index_key: HNSW32
2025-03-13 17:16:13,726 [INFO]: 	index_param: efSearch=83
2025-03-13 17:16:13,726 [INFO]: 	index_path: knn.index
2025-03-13 17:16:13,726 [INFO]: 	size in bytes: 3520019958
2025-03-13 17:16:13,726 [INFO]: 	avg_search_speed_ms: 18.582783295152662
2025-03-13 17:16:13,726 [INFO]: 	99p_search_speed_ms: 32.73278351407498
2025-03-13 17:16:13,726 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:13,726 [INFO]: 	nb vectors: 17879
2025-03-13 17:16:13,726 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:13,726 [INFO]: 	compression ratio: 0.9986177561326202
2025-03-13 17:16:13,726 [INFO]: }
2025-03-13 17:16:13,726 [INFO]: 	>>> Finished "Creating the index" in 265.2962 secs
2025-03-13 17:16:13,726 [INFO]: >>> Finished "Launching the whole pipeline" in 265.3400 secs
2025-03-13 17:16:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 89459 [episode count 12/20]
[retrieval_preprocessing] for episode 47999 [episode count 13/20], we have num_retrieval=np.int64(17819) num_query=np.int64(861)
2025-03-13 17:16:21,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:23,669 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:23
2025-03-13 17:16:23,669 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.91it/s]
2025-03-13 17:16:23,707 [INFO]: There are 17819 embeddings of dim 49152
2025-03-13 17:16:23,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-13 17:16:23,707 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:23
2025-03-13 17:16:23,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:23,707 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 17:16:23,707 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:16:23,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:23,707 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:23
2025-03-13 17:16:23,708 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:23,708 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:16:23,708 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:23
2025-03-13 17:16:23,708 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:23,708 [INFO]: 	Creating the index 03/13/2025, 17:16:23
2025-03-13 17:16:23,708 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:16:23
2025-03-13 17:16:23,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:16:23,709 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:23
2025-03-13 17:16:23,709 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:16:23,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:10,  7.01it/s]  7%|▋         | 5/74 [00:00<00:03, 21.72it/s] 14%|█▎        | 10/74 [00:00<00:02, 31.45it/s] 20%|██        | 15/74 [00:00<00:01, 36.61it/s] 27%|██▋       | 20/74 [00:00<00:01, 39.50it/s] 34%|███▍      | 25/74 [00:08<00:28,  1.71it/s] 39%|███▉      | 29/74 [00:08<00:18,  2.37it/s] 43%|████▎     | 32/74 [00:08<00:13,  3.01it/s] 49%|████▊     | 36/74 [00:08<00:09,  4.22it/s] 54%|█████▍    | 40/74 [00:08<00:05,  5.81it/s] 59%|█████▉    | 44/74 [00:19<00:27,  1.09it/s] 66%|██████▌   | 49/74 [00:19<00:14,  1.67it/s] 74%|███████▍  | 55/74 [00:19<00:07,  2.62it/s] 82%|████████▏ | 61/74 [00:19<00:03,  3.93it/s] 89%|████████▉ | 66/74 [00:32<00:07,  1.04it/s] 96%|█████████▌| 71/74 [00:33<00:02,  1.46it/s]100%|██████████| 74/74 [00:39<00:00,  1.86it/s]
2025-03-13 17:17:03,426 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:03
2025-03-13 17:19:21,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 138.3203 secs
2025-03-13 17:19:21,748 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 17:19:21,748 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 17:20:50,824 [INFO]: 	>>> Finished "Compute fast metrics" in 89.0761 secs
2025-03-13 17:20:50,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 267.1180 secs
2025-03-13 17:20:50,828 [INFO]: {
2025-03-13 17:20:50,828 [INFO]: 	index_key: HNSW32
2025-03-13 17:20:50,828 [INFO]: 	index_param: efSearch=101
2025-03-13 17:20:50,828 [INFO]: 	index_path: knn.index
2025-03-13 17:20:50,828 [INFO]: 	size in bytes: 3508207270
2025-03-13 17:20:50,828 [INFO]: 	avg_search_speed_ms: 19.88065562077931
2025-03-13 17:20:50,828 [INFO]: 	99p_search_speed_ms: 33.10236660065129
2025-03-13 17:20:50,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:50,828 [INFO]: 	nb vectors: 17819
2025-03-13 17:20:50,828 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:50,828 [INFO]: 	compression ratio: 0.9986177219226845
2025-03-13 17:20:50,828 [INFO]: }
2025-03-13 17:20:50,828 [INFO]: 	>>> Finished "Creating the index" in 267.1205 secs
2025-03-13 17:20:50,828 [INFO]: >>> Finished "Launching the whole pipeline" in 267.1590 secs
2025-03-13 17:20:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 47999 [episode count 13/20]
[retrieval_preprocessing] for episode 38796 [episode count 14/20], we have num_retrieval=np.int64(17783) num_query=np.int64(897)
2025-03-13 17:21:00,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:03,147 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:03
2025-03-13 17:21:03,147 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.49it/s]
2025-03-13 17:21:03,195 [INFO]: There are 17783 embeddings of dim 49152
2025-03-13 17:21:03,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0483 secs
2025-03-13 17:21:03,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:03
2025-03-13 17:21:03,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:03,196 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 17:21:03,196 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:21:03,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:21:03,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:03
2025-03-13 17:21:03,196 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:03,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:21:03,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:03
2025-03-13 17:21:03,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:21:03,197 [INFO]: 	Creating the index 03/13/2025, 17:21:03
2025-03-13 17:21:03,197 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:21:03
2025-03-13 17:21:03,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 17:21:03,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:03
2025-03-13 17:21:03,200 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:21:03,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:10,  6.93it/s]  7%|▋         | 5/73 [00:00<00:03, 22.65it/s] 14%|█▎        | 10/73 [00:00<00:01, 31.69it/s] 19%|█▉        | 14/73 [00:00<00:01, 33.58it/s] 26%|██▌       | 19/73 [00:00<00:01, 36.63it/s] 32%|███▏      | 23/73 [00:10<00:41,  1.22it/s] 38%|███▊      | 28/73 [00:10<00:23,  1.90it/s] 45%|████▌     | 33/73 [00:10<00:14,  2.83it/s] 52%|█████▏    | 38/73 [00:10<00:08,  4.10it/s] 58%|█████▊    | 42/73 [00:21<00:27,  1.14it/s] 64%|██████▍   | 47/73 [00:21<00:15,  1.67it/s] 71%|███████   | 52/73 [00:21<00:08,  2.41it/s] 78%|███████▊  | 57/73 [00:21<00:04,  3.42it/s] 85%|████████▍ | 62/73 [00:21<00:02,  4.79it/s] 92%|█████████▏| 67/73 [00:32<00:04,  1.23it/s] 97%|█████████▋| 71/73 [00:32<00:01,  1.64it/s]100%|██████████| 73/73 [00:39<00:00,  1.87it/s]
2025-03-13 17:21:42,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:42
2025-03-13 17:24:18,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 156.4659 secs
2025-03-13 17:24:18,720 [INFO]: The best hyperparameters are: efSearch=84
2025-03-13 17:24:18,720 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.75it/s]
2025-03-13 17:25:46,671 [INFO]: 	>>> Finished "Compute fast metrics" in 87.9508 secs
2025-03-13 17:25:46,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 283.4731 secs
2025-03-13 17:25:46,673 [INFO]: {
2025-03-13 17:25:46,673 [INFO]: 	index_key: HNSW32
2025-03-13 17:25:46,673 [INFO]: 	index_param: efSearch=84
2025-03-13 17:25:46,673 [INFO]: 	index_path: knn.index
2025-03-13 17:25:46,673 [INFO]: 	size in bytes: 3501119734
2025-03-13 17:25:46,673 [INFO]: 	avg_search_speed_ms: 18.160780449778166
2025-03-13 17:25:46,673 [INFO]: 	99p_search_speed_ms: 36.72393201850355
2025-03-13 17:25:46,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:46,673 [INFO]: 	nb vectors: 17783
2025-03-13 17:25:46,673 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:46,674 [INFO]: 	compression ratio: 0.998617679380399
2025-03-13 17:25:46,674 [INFO]: }
2025-03-13 17:25:46,674 [INFO]: 	>>> Finished "Creating the index" in 283.4768 secs
2025-03-13 17:25:46,674 [INFO]: >>> Finished "Launching the whole pipeline" in 283.5265 secs
2025-03-13 17:25:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 38796 [episode count 14/20]
[retrieval_preprocessing] for episode 46002 [episode count 15/20], we have num_retrieval=np.int64(17531) num_query=np.int64(1149)
2025-03-13 17:25:54,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:57,577 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:57
2025-03-13 17:25:57,577 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 17:25:57,616 [INFO]: There are 17531 embeddings of dim 49152
2025-03-13 17:25:57,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 17:25:57,616 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:57
2025-03-13 17:25:57,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:57,616 [INFO]: 		-> Add: 9.6 seconds
2025-03-13 17:25:57,616 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:25:57,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:25:57,616 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:57
2025-03-13 17:25:57,617 [INFO]: 3.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:57,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:57,617 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:57
2025-03-13 17:25:57,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:57,617 [INFO]: 	Creating the index 03/13/2025, 17:25:57
2025-03-13 17:25:57,617 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:25:57
2025-03-13 17:25:57,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 17:25:57,618 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:57
2025-03-13 17:25:57,618 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 17:25:57,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/72 [00:00<?, ?it/s]  1%|▏         | 1/72 [00:00<00:12,  5.71it/s]  7%|▋         | 5/72 [00:00<00:03, 19.70it/s] 14%|█▍        | 10/72 [00:00<00:02, 28.82it/s] 21%|██        | 15/72 [00:00<00:01, 33.57it/s] 26%|██▋       | 19/72 [00:00<00:01, 35.43it/s] 32%|███▏      | 23/72 [00:09<00:38,  1.28it/s] 39%|███▉      | 28/72 [00:09<00:22,  2.00it/s] 46%|████▌     | 33/72 [00:10<00:13,  2.98it/s] 53%|█████▎    | 38/72 [00:10<00:07,  4.30it/s] 57%|█████▋    | 41/72 [00:20<00:07,  4.30it/s] 58%|█████▊    | 42/72 [00:23<00:31,  1.06s/it] 64%|██████▍   | 46/72 [00:23<00:19,  1.31it/s] 69%|██████▉   | 50/72 [00:23<00:12,  1.81it/s] 75%|███████▌  | 54/72 [00:23<00:07,  2.50it/s] 81%|████████  | 58/72 [00:23<00:04,  3.44it/s] 86%|████████▌ | 62/72 [00:23<00:02,  4.69it/s] 92%|█████████▏| 66/72 [00:38<00:07,  1.24s/it] 97%|█████████▋| 70/72 [00:38<00:01,  1.14it/s]100%|██████████| 72/72 [00:45<00:00,  1.59it/s]
2025-03-13 17:26:42,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:42
2025-03-13 17:29:01,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 138.9015 secs
2025-03-13 17:29:01,755 [INFO]: The best hyperparameters are: efSearch=116
2025-03-13 17:29:01,755 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.33it/s]
2025-03-13 17:29:51,340 [INFO]: 	>>> Finished "Compute fast metrics" in 49.5847 secs
2025-03-13 17:29:51,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 233.7235 secs
2025-03-13 17:29:51,342 [INFO]: {
2025-03-13 17:29:51,342 [INFO]: 	index_key: HNSW32
2025-03-13 17:29:51,342 [INFO]: 	index_param: efSearch=116
2025-03-13 17:29:51,342 [INFO]: 	index_path: knn.index
2025-03-13 17:29:51,342 [INFO]: 	size in bytes: 3451505958
2025-03-13 17:29:51,342 [INFO]: 	avg_search_speed_ms: 21.186941122167585
2025-03-13 17:29:51,342 [INFO]: 	99p_search_speed_ms: 37.885984443128066
2025-03-13 17:29:51,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:51,342 [INFO]: 	nb vectors: 17531
2025-03-13 17:29:51,342 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:51,342 [INFO]: 	compression ratio: 0.9986176729641908
2025-03-13 17:29:51,342 [INFO]: }
2025-03-13 17:29:51,342 [INFO]: 	>>> Finished "Creating the index" in 233.7252 secs
2025-03-13 17:29:51,342 [INFO]: >>> Finished "Launching the whole pipeline" in 233.7648 secs
2025-03-13 17:29:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 46002 [episode count 15/20]
[retrieval_preprocessing] for episode 71094 [episode count 16/20], we have num_retrieval=np.int64(17898) num_query=np.int64(782)
2025-03-13 17:30:04,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:08,032 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:08
2025-03-13 17:30:08,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-13 17:30:08,077 [INFO]: There are 17898 embeddings of dim 49152
2025-03-13 17:30:08,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0448 secs
2025-03-13 17:30:08,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:08
2025-03-13 17:30:08,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:08,077 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 17:30:08,077 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:30:08,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:08,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:08
2025-03-13 17:30:08,078 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:08,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:30:08,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:08
2025-03-13 17:30:08,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:08,078 [INFO]: 	Creating the index 03/13/2025, 17:30:08
2025-03-13 17:30:08,078 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:30:08
2025-03-13 17:30:08,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0015 secs
2025-03-13 17:30:08,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:08
2025-03-13 17:30:08,080 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:30:08,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:11,  6.46it/s]  8%|▊         | 6/74 [00:00<00:02, 24.61it/s] 14%|█▎        | 10/74 [00:00<00:02, 30.38it/s] 20%|██        | 15/74 [00:00<00:01, 34.52it/s] 27%|██▋       | 20/74 [00:00<00:01, 37.06it/s] 32%|███▏      | 24/74 [00:10<00:38,  1.30it/s] 36%|███▋      | 27/74 [00:10<00:27,  1.68it/s] 41%|████      | 30/74 [00:10<00:20,  2.18it/s] 43%|████▎     | 32/74 [00:10<00:16,  2.60it/s] 46%|████▌     | 34/74 [00:11<00:12,  3.10it/s] 49%|████▊     | 36/74 [00:11<00:09,  3.80it/s] 51%|█████▏    | 38/74 [00:11<00:07,  4.76it/s] 54%|█████▍    | 40/74 [00:11<00:06,  5.46it/s] 57%|█████▋    | 42/74 [00:22<00:52,  1.63s/it] 64%|██████▎   | 47/74 [00:22<00:22,  1.20it/s] 72%|███████▏  | 53/74 [00:22<00:09,  2.18it/s] 80%|███████▉  | 59/74 [00:22<00:04,  3.52it/s] 85%|████████▌ | 63/74 [00:34<00:10,  1.02it/s] 86%|████████▋ | 64/74 [00:34<00:09,  1.10it/s] 91%|█████████ | 67/74 [00:34<00:04,  1.46it/s] 95%|█████████▍| 70/74 [00:34<00:02,  1.91it/s] 97%|█████████▋| 72/74 [00:35<00:00,  2.29it/s]100%|██████████| 74/74 [00:43<00:00,  1.29s/it]100%|██████████| 74/74 [00:43<00:00,  1.71it/s]
2025-03-13 17:30:51,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:51
2025-03-13 17:33:24,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 153.2199 secs
2025-03-13 17:33:24,904 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 17:33:24,905 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.62it/s] 50%|█████     | 2/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 17:34:50,378 [INFO]: 	>>> Finished "Compute fast metrics" in 85.4729 secs
2025-03-13 17:34:50,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 282.3011 secs
2025-03-13 17:34:50,381 [INFO]: {
2025-03-13 17:34:50,381 [INFO]: 	index_key: HNSW32
2025-03-13 17:34:50,381 [INFO]: 	index_param: efSearch=91
2025-03-13 17:34:50,381 [INFO]: 	index_path: knn.index
2025-03-13 17:34:50,381 [INFO]: 	size in bytes: 3523760602
2025-03-13 17:34:50,381 [INFO]: 	avg_search_speed_ms: 23.214381753214205
2025-03-13 17:34:50,381 [INFO]: 	99p_search_speed_ms: 48.18351014982909
2025-03-13 17:34:50,381 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:50,381 [INFO]: 	nb vectors: 17898
2025-03-13 17:34:50,381 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:50,381 [INFO]: 	compression ratio: 0.9986177784049133
2025-03-13 17:34:50,381 [INFO]: }
2025-03-13 17:34:50,381 [INFO]: 	>>> Finished "Creating the index" in 282.3035 secs
2025-03-13 17:34:50,382 [INFO]: >>> Finished "Launching the whole pipeline" in 282.3492 secs
2025-03-13 17:34:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 71094 [episode count 16/20]
[retrieval_preprocessing] for episode 87995 [episode count 17/20], we have num_retrieval=np.int64(17912) num_query=np.int64(768)
2025-03-13 17:34:58,311 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:00,962 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:00
2025-03-13 17:35:00,963 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-13 17:35:01,005 [INFO]: There are 17912 embeddings of dim 49152
2025-03-13 17:35:01,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0427 secs
2025-03-13 17:35:01,005 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:01
2025-03-13 17:35:01,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:01,006 [INFO]: 		-> Add: 9.8 seconds
2025-03-13 17:35:01,006 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:35:01,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:35:01,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:01
2025-03-13 17:35:01,007 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:01,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:35:01,007 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:01
2025-03-13 17:35:01,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:35:01,008 [INFO]: 	Creating the index 03/13/2025, 17:35:01
2025-03-13 17:35:01,008 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:35:01
2025-03-13 17:35:01,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-13 17:35:01,011 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:01
2025-03-13 17:35:01,011 [INFO]: The memory available for adding the vectors is 46.7GB(total available - used by the index)
2025-03-13 17:35:01,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:00<00:10,  7.14it/s]  7%|▋         | 5/74 [00:00<00:03, 21.21it/s] 14%|█▎        | 10/74 [00:00<00:02, 30.42it/s] 20%|██        | 15/74 [00:00<00:01, 34.65it/s] 26%|██▌       | 19/74 [00:00<00:01, 36.05it/s] 31%|███       | 23/74 [00:10<00:42,  1.21it/s] 35%|███▌      | 26/74 [00:10<00:30,  1.58it/s] 39%|███▉      | 29/74 [00:10<00:21,  2.08it/s] 42%|████▏     | 31/74 [00:11<00:17,  2.52it/s] 45%|████▍     | 33/74 [00:11<00:13,  3.04it/s] 47%|████▋     | 35/74 [00:11<00:10,  3.66it/s] 50%|█████     | 37/74 [00:11<00:08,  4.43it/s] 53%|█████▎    | 39/74 [00:11<00:06,  5.37it/s] 55%|█████▌    | 41/74 [00:11<00:05,  6.35it/s] 58%|█████▊    | 43/74 [00:24<00:58,  1.90s/it] 61%|██████    | 45/74 [00:24<00:39,  1.37s/it] 64%|██████▎   | 47/74 [00:24<00:26,  1.01it/s] 66%|██████▌   | 49/74 [00:24<00:18,  1.39it/s] 69%|██████▉   | 51/74 [00:25<00:12,  1.89it/s] 72%|███████▏  | 53/74 [00:25<00:08,  2.54it/s] 74%|███████▍  | 55/74 [00:25<00:05,  3.37it/s] 77%|███████▋  | 57/74 [00:25<00:03,  4.37it/s] 80%|███████▉  | 59/74 [00:25<00:02,  5.62it/s] 82%|████████▏ | 61/74 [00:25<00:01,  6.75it/s] 84%|████████▍ | 62/74 [00:36<00:01,  6.75it/s] 85%|████████▌ | 63/74 [00:39<00:24,  2.20s/it] 88%|████████▊ | 65/74 [00:39<00:14,  1.56s/it] 91%|█████████ | 67/74 [00:40<00:07,  1.13s/it] 93%|█████████▎| 69/74 [00:40<00:04,  1.22it/s] 96%|█████████▌| 71/74 [00:40<00:01,  1.66it/s] 99%|█████████▊| 73/74 [00:40<00:00,  2.22it/s]100%|██████████| 74/74 [00:48<00:00,  1.51it/s]
2025-03-13 17:35:50,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:50
2025-03-13 17:38:19,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 149.6023 secs
2025-03-13 17:38:19,622 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 17:38:19,623 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-13 17:39:37,916 [INFO]: 	>>> Finished "Compute fast metrics" in 78.2931 secs
2025-03-13 17:39:37,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 276.9068 secs
2025-03-13 17:39:37,918 [INFO]: {
2025-03-13 17:39:37,918 [INFO]: 	index_key: HNSW32
2025-03-13 17:39:37,918 [INFO]: 	index_param: efSearch=113
2025-03-13 17:39:37,918 [INFO]: 	index_path: knn.index
2025-03-13 17:39:37,918 [INFO]: 	size in bytes: 3526516866
2025-03-13 17:39:37,918 [INFO]: 	avg_search_speed_ms: 21.230149877522045
2025-03-13 17:39:37,918 [INFO]: 	99p_search_speed_ms: 35.995548628270654
2025-03-13 17:39:37,918 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:37,918 [INFO]: 	nb vectors: 17912
2025-03-13 17:39:37,918 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:37,918 [INFO]: 	compression ratio: 0.9986177947858423
2025-03-13 17:39:37,918 [INFO]: }
2025-03-13 17:39:37,918 [INFO]: 	>>> Finished "Creating the index" in 276.9107 secs
2025-03-13 17:39:37,918 [INFO]: >>> Finished "Launching the whole pipeline" in 276.9557 secs
2025-03-13 17:39:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 87995 [episode count 17/20]
[retrieval_preprocessing] for episode 38352 [episode count 18/20], we have num_retrieval=np.int64(17723) num_query=np.int64(957)
2025-03-13 17:39:51,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:54,508 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:54
2025-03-13 17:39:54,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 967.10it/s]
2025-03-13 17:39:54,536 [INFO]: There are 17723 embeddings of dim 49152
2025-03-13 17:39:54,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:39:54,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:54
2025-03-13 17:39:54,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:54,536 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 17:39:54,536 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:39:54,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:54,536 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:54
2025-03-13 17:39:54,536 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:54,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:54,537 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:54
2025-03-13 17:39:54,537 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:54,537 [INFO]: 	Creating the index 03/13/2025, 17:39:54
2025-03-13 17:39:54,537 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:39:54
2025-03-13 17:39:54,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:39:54,538 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:54
2025-03-13 17:39:54,538 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 17:39:54,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:11,  6.08it/s]  3%|▎         | 2/73 [00:00<00:13,  5.31it/s]  5%|▌         | 4/73 [00:00<00:08,  8.56it/s] 10%|▉         | 7/73 [00:00<00:05, 13.03it/s] 14%|█▎        | 10/73 [00:00<00:03, 16.19it/s] 18%|█▊        | 13/73 [00:00<00:03, 18.45it/s] 21%|██        | 15/73 [00:01<00:03, 17.76it/s] 25%|██▍       | 18/73 [00:01<00:02, 18.98it/s] 29%|██▉       | 21/73 [00:09<00:53,  1.03s/it] 32%|███▏      | 23/73 [00:10<00:40,  1.25it/s] 34%|███▍      | 25/73 [00:10<00:29,  1.62it/s] 37%|███▋      | 27/73 [00:10<00:21,  2.12it/s] 40%|███▉      | 29/73 [00:10<00:16,  2.74it/s] 42%|████▏     | 31/73 [00:10<00:11,  3.50it/s] 45%|████▌     | 33/73 [00:10<00:09,  4.39it/s] 48%|████▊     | 35/73 [00:11<00:06,  5.63it/s] 52%|█████▏    | 38/73 [00:11<00:04,  7.91it/s] 56%|█████▌    | 41/73 [00:11<00:03, 10.60it/s] 59%|█████▉    | 43/73 [00:22<00:44,  1.47s/it] 62%|██████▏   | 45/73 [00:22<00:30,  1.10s/it] 64%|██████▍   | 47/73 [00:22<00:21,  1.21it/s] 67%|██████▋   | 49/73 [00:22<00:14,  1.61it/s] 70%|██████▉   | 51/73 [00:23<00:10,  2.12it/s] 73%|███████▎  | 53/73 [00:23<00:07,  2.72it/s] 75%|███████▌  | 55/73 [00:23<00:05,  3.39it/s] 78%|███████▊  | 57/73 [00:23<00:03,  4.11it/s] 79%|███████▉  | 58/73 [00:23<00:03,  4.54it/s] 81%|████████  | 59/73 [00:24<00:02,  5.01it/s] 84%|████████▎ | 61/73 [00:24<00:01,  6.42it/s] 86%|████████▋ | 63/73 [00:37<00:23,  2.33s/it] 89%|████████▉ | 65/73 [00:37<00:12,  1.59s/it] 92%|█████████▏| 67/73 [00:37<00:06,  1.11s/it] 95%|█████████▍| 69/73 [00:37<00:03,  1.28it/s] 97%|█████████▋| 71/73 [00:37<00:01,  1.78it/s]100%|██████████| 73/73 [00:44<00:00,  1.34s/it]100%|██████████| 73/73 [00:44<00:00,  1.66it/s]
2025-03-13 17:40:38,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:38
2025-03-13 17:43:04,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 145.8505 secs
2025-03-13 17:43:04,465 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 17:43:04,465 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.02it/s] 50%|█████     | 2/4 [00:00<00:00,  3.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.63it/s]
2025-03-13 17:44:22,194 [INFO]: 	>>> Finished "Compute fast metrics" in 77.7294 secs
2025-03-13 17:44:22,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 267.6588 secs
2025-03-13 17:44:22,197 [INFO]: {
2025-03-13 17:44:22,197 [INFO]: 	index_key: HNSW32
2025-03-13 17:44:22,197 [INFO]: 	index_param: efSearch=105
2025-03-13 17:44:22,197 [INFO]: 	index_path: knn.index
2025-03-13 17:44:22,197 [INFO]: 	size in bytes: 3489307046
2025-03-13 17:44:22,197 [INFO]: 	avg_search_speed_ms: 15.628011953594978
2025-03-13 17:44:22,197 [INFO]: 	99p_search_speed_ms: 25.37498137913645
2025-03-13 17:44:22,197 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:22,197 [INFO]: 	nb vectors: 17723
2025-03-13 17:44:22,197 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:22,197 [INFO]: 	compression ratio: 0.9986176447253247
2025-03-13 17:44:22,197 [INFO]: }
2025-03-13 17:44:22,197 [INFO]: 	>>> Finished "Creating the index" in 267.6603 secs
2025-03-13 17:44:22,197 [INFO]: >>> Finished "Launching the whole pipeline" in 267.6889 secs
2025-03-13 17:44:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 38352 [episode count 18/20]
[retrieval_preprocessing] for episode 24224 [episode count 19/20], we have num_retrieval=np.int64(17676) num_query=np.int64(1004)
2025-03-13 17:44:38,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:41,962 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:41
2025-03-13 17:44:41,962 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 788.70it/s]
2025-03-13 17:44:41,995 [INFO]: There are 17676 embeddings of dim 49152
2025-03-13 17:44:41,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 17:44:41,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:41
2025-03-13 17:44:41,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:41,996 [INFO]: 		-> Add: 9.7 seconds
2025-03-13 17:44:41,996 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:44:41,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:44:41,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:41
2025-03-13 17:44:41,997 [INFO]: 3.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:41,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:44:41,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:41
2025-03-13 17:44:41,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:44:41,998 [INFO]: 	Creating the index 03/13/2025, 17:44:41
2025-03-13 17:44:41,998 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:44:41
2025-03-13 17:44:42,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 17:44:42,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:42
2025-03-13 17:44:42,001 [INFO]: The memory available for adding the vectors is 46.8GB(total available - used by the index)
2025-03-13 17:44:42,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/73 [00:00<?, ?it/s]  1%|▏         | 1/73 [00:00<00:18,  3.82it/s]  3%|▎         | 2/73 [00:00<00:14,  5.01it/s]  4%|▍         | 3/73 [00:00<00:11,  6.20it/s]  5%|▌         | 4/73 [00:00<00:09,  6.94it/s]  7%|▋         | 5/73 [00:00<00:09,  7.36it/s]  8%|▊         | 6/73 [00:00<00:08,  7.69it/s] 10%|▉         | 7/73 [00:01<00:08,  7.82it/s] 11%|█         | 8/73 [00:01<00:08,  8.10it/s] 12%|█▏        | 9/73 [00:01<00:08,  7.97it/s] 14%|█▎        | 10/73 [00:01<00:07,  8.06it/s] 15%|█▌        | 11/73 [00:01<00:07,  7.85it/s] 16%|█▋        | 12/73 [00:01<00:07,  8.14it/s] 18%|█▊        | 13/73 [00:01<00:07,  8.44it/s] 19%|█▉        | 14/73 [00:01<00:06,  8.85it/s] 21%|██        | 15/73 [00:01<00:06,  9.03it/s] 22%|██▏       | 16/73 [00:02<00:06,  9.08it/s] 23%|██▎       | 17/73 [00:02<00:06,  8.79it/s] 25%|██▍       | 18/73 [00:02<00:06,  8.58it/s] 26%|██▌       | 19/73 [00:02<00:06,  8.51it/s] 27%|██▋       | 20/73 [00:02<00:06,  8.34it/s] 29%|██▉       | 21/73 [00:11<02:24,  2.77s/it] 30%|███       | 22/73 [00:11<01:42,  2.01s/it] 32%|███▏      | 23/73 [00:11<01:13,  1.46s/it] 33%|███▎      | 24/73 [00:12<00:51,  1.06s/it] 34%|███▍      | 25/73 [00:12<00:37,  1.28it/s] 36%|███▌      | 26/73 [00:12<00:27,  1.71it/s] 37%|███▋      | 27/73 [00:12<00:20,  2.23it/s] 38%|███▊      | 28/73 [00:12<00:16,  2.80it/s] 40%|███▉      | 29/73 [00:12<00:12,  3.42it/s] 41%|████      | 30/73 [00:12<00:10,  4.05it/s] 42%|████▏     | 31/73 [00:12<00:09,  4.63it/s] 44%|████▍     | 32/73 [00:13<00:07,  5.14it/s] 45%|████▌     | 33/73 [00:13<00:07,  5.57it/s] 47%|████▋     | 34/73 [00:13<00:06,  5.90it/s] 48%|████▊     | 35/73 [00:13<00:05,  6.42it/s] 49%|████▉     | 36/73 [00:13<00:05,  6.67it/s] 51%|█████     | 37/73 [00:13<00:05,  6.98it/s] 52%|█████▏    | 38/73 [00:13<00:04,  7.11it/s] 53%|█████▎    | 39/73 [00:14<00:04,  7.12it/s] 55%|█████▍    | 40/73 [00:14<00:04,  7.36it/s] 56%|█████▌    | 41/73 [00:14<00:04,  7.69it/s] 58%|█████▊    | 42/73 [00:27<02:08,  4.15s/it] 59%|█████▉    | 43/73 [00:27<01:28,  2.93s/it] 62%|██████▏   | 45/73 [00:28<00:45,  1.62s/it] 64%|██████▍   | 47/73 [00:28<00:26,  1.01s/it] 67%|██████▋   | 49/73 [00:28<00:16,  1.49it/s] 70%|██████▉   | 51/73 [00:28<00:10,  2.13it/s] 73%|███████▎  | 53/73 [00:28<00:06,  2.92it/s] 75%|███████▌  | 55/73 [00:28<00:04,  3.83it/s] 78%|███████▊  | 57/73 [00:29<00:03,  4.80it/s] 81%|████████  | 59/73 [00:29<00:02,  5.69it/s] 84%|████████▎ | 61/73 [00:29<00:01,  6.49it/s] 86%|████████▋ | 63/73 [00:44<00:24,  2.44s/it] 88%|████████▊ | 64/73 [00:45<00:18,  2.05s/it] 89%|████████▉ | 65/73 [00:45<00:13,  1.66s/it] 90%|█████████ | 66/73 [00:45<00:09,  1.33s/it] 92%|█████████▏| 67/73 [00:45<00:06,  1.05s/it] 93%|█████████▎| 68/73 [00:45<00:04,  1.20it/s] 95%|█████████▍| 69/73 [00:46<00:02,  1.53it/s] 96%|█████████▌| 70/73 [00:46<00:01,  1.89it/s] 97%|█████████▋| 71/73 [00:46<00:00,  2.39it/s] 99%|█████████▊| 72/73 [00:46<00:00,  3.00it/s]100%|██████████| 73/73 [00:53<00:00,  2.16s/it]100%|██████████| 73/73 [00:53<00:00,  1.38it/s]
2025-03-13 17:45:35,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:35
2025-03-13 17:47:42,248 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 127.1728 secs
2025-03-13 17:47:42,249 [INFO]: The best hyperparameters are: efSearch=116
2025-03-13 17:47:42,249 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 17:49:03,295 [INFO]: 	>>> Finished "Compute fast metrics" in 81.0456 secs
2025-03-13 17:49:03,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 261.2960 secs
2025-03-13 17:49:03,297 [INFO]: {
2025-03-13 17:49:03,297 [INFO]: 	index_key: HNSW32
2025-03-13 17:49:03,297 [INFO]: 	index_param: efSearch=116
2025-03-13 17:49:03,297 [INFO]: 	index_path: knn.index
2025-03-13 17:49:03,297 [INFO]: 	size in bytes: 3480053874
2025-03-13 17:49:03,297 [INFO]: 	avg_search_speed_ms: 22.617495166238726
2025-03-13 17:49:03,297 [INFO]: 	99p_search_speed_ms: 39.635450625792124
2025-03-13 17:49:03,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:03,297 [INFO]: 	nb vectors: 17676
2025-03-13 17:49:03,297 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:03,297 [INFO]: 	compression ratio: 0.9986175886425372
2025-03-13 17:49:03,297 [INFO]: }
2025-03-13 17:49:03,297 [INFO]: 	>>> Finished "Creating the index" in 261.2998 secs
2025-03-13 17:49:03,297 [INFO]: >>> Finished "Launching the whole pipeline" in 261.3356 secs
2025-03-13 17:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 24224 [episode count 19/20]
2025-03-13 17:49:13: [retrieval_preprocessing] finished for 8833514968_put_blocks_in_bowl [chosen_id count 4/196]
2025-03-13 17:49:16: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8911427557_put_rubber_band_around_cup [chosen_id count 5/196]
2025-03-13 17:49:16: [retrieval_preprocessing] we have num_total=3012 embedding_dim=49152
[retrieval_preprocessing] for episode 94752 [episode count 0/20], we have num_retrieval=np.int64(2870) num_query=np.int64(142)
2025-03-13 17:49:17,349 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:18,624 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:18
2025-03-13 17:49:18,624 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 920.01it/s]
2025-03-13 17:49:18,651 [INFO]: There are 2870 embeddings of dim 49152
2025-03-13 17:49:18,652 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:49:18,652 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:18
2025-03-13 17:49:18,652 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:18,652 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:49:18,652 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:18,652 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:18,652 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:18
2025-03-13 17:49:18,652 [INFO]: 592.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:18,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:49:18,652 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:18
2025-03-13 17:49:18,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:18,652 [INFO]: 	Creating the index 03/13/2025, 17:49:18
2025-03-13 17:49:18,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:18
2025-03-13 17:49:18,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:49:18,653 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:18
2025-03-13 17:49:18,653 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:49:18,653 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.49it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.79it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.95it/s] 50%|█████     | 6/12 [00:00<00:00, 10.11it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.10it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.17it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.73it/s]100%|██████████| 12/12 [00:03<00:00,  1.59it/s]100%|██████████| 12/12 [00:03<00:00,  3.37it/s]
2025-03-13 17:49:22,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:22
2025-03-13 17:50:00,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0688 secs
2025-03-13 17:50:00,291 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 17:50:00,292 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 17:50:26,255 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9633 secs
2025-03-13 17:50:26,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6043 secs
2025-03-13 17:50:26,258 [INFO]: {
2025-03-13 17:50:26,258 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:26,258 [INFO]: 	index_param: efSearch=262
2025-03-13 17:50:26,258 [INFO]: 	index_path: knn.index
2025-03-13 17:50:26,258 [INFO]: 	size in bytes: 564654730
2025-03-13 17:50:26,258 [INFO]: 	avg_search_speed_ms: 11.107926396911758
2025-03-13 17:50:26,258 [INFO]: 	99p_search_speed_ms: 18.174665749538686
2025-03-13 17:50:26,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:26,258 [INFO]: 	nb vectors: 2870
2025-03-13 17:50:26,258 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:26,258 [INFO]: 	compression ratio: 0.999309719764501
2025-03-13 17:50:26,258 [INFO]: }
2025-03-13 17:50:26,258 [INFO]: 	>>> Finished "Creating the index" in 67.6057 secs
2025-03-13 17:50:26,258 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6338 secs
2025-03-13 17:50:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 94752 [episode count 0/20]
[retrieval_preprocessing] for episode 3109 [episode count 1/20], we have num_retrieval=np.int64(2868) num_query=np.int64(144)
2025-03-13 17:50:29,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:29,650 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:29
2025-03-13 17:50:29,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.02it/s]
2025-03-13 17:50:29,678 [INFO]: There are 2868 embeddings of dim 49152
2025-03-13 17:50:29,678 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:50:29,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:29
2025-03-13 17:50:29,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:29,679 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:50:29,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:29,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:50:29,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:29
2025-03-13 17:50:29,679 [INFO]: 591.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:29,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:50:29,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:29
2025-03-13 17:50:29,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:29,680 [INFO]: 	Creating the index 03/13/2025, 17:50:29
2025-03-13 17:50:29,681 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:29
2025-03-13 17:50:29,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:50:29,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:29
2025-03-13 17:50:29,684 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:50:29,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.51it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.42it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.27it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.86it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.99it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]
2025-03-13 17:50:32,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:32
2025-03-13 17:51:09,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9194 secs
2025-03-13 17:51:09,548 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:51:09,548 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 17:51:37,334 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7859 secs
2025-03-13 17:51:37,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6524 secs
2025-03-13 17:51:37,337 [INFO]: {
2025-03-13 17:51:37,337 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:37,337 [INFO]: 	index_param: efSearch=251
2025-03-13 17:51:37,337 [INFO]: 	index_path: knn.index
2025-03-13 17:51:37,337 [INFO]: 	size in bytes: 564261250
2025-03-13 17:51:37,337 [INFO]: 	avg_search_speed_ms: 9.24818035452924
2025-03-13 17:51:37,337 [INFO]: 	99p_search_speed_ms: 14.91279914043844
2025-03-13 17:51:37,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:37,337 [INFO]: 	nb vectors: 2868
2025-03-13 17:51:37,337 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:37,337 [INFO]: 	compression ratio: 0.9993097062752404
2025-03-13 17:51:37,337 [INFO]: }
2025-03-13 17:51:37,337 [INFO]: 	>>> Finished "Creating the index" in 67.6564 secs
2025-03-13 17:51:37,337 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6873 secs
2025-03-13 17:51:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 3109 [episode count 1/20]
[retrieval_preprocessing] for episode 95264 [episode count 2/20], we have num_retrieval=np.int64(2877) num_query=np.int64(135)
2025-03-13 17:51:40,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:40,624 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:40
2025-03-13 17:51:40,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1852.61it/s]
2025-03-13 17:51:40,648 [INFO]: There are 2877 embeddings of dim 49152
2025-03-13 17:51:40,649 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 17:51:40,649 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:40
2025-03-13 17:51:40,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:40,649 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:51:40,649 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:40,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:40,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:40
2025-03-13 17:51:40,649 [INFO]: 593.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:40,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:51:40,649 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:40
2025-03-13 17:51:40,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:40,650 [INFO]: 	Creating the index 03/13/2025, 17:51:40
2025-03-13 17:51:40,650 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:40
2025-03-13 17:51:40,651 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:51:40,651 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:40
2025-03-13 17:51:40,651 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:51:40,651 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.94it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.90it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.40it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.66it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.82it/s] 50%|█████     | 6/12 [00:00<00:00,  7.75it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.12it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.13it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.15it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.10it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.14it/s]100%|██████████| 12/12 [00:03<00:00,  1.47it/s]100%|██████████| 12/12 [00:03<00:00,  3.57it/s]
2025-03-13 17:51:44,016 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:44
2025-03-13 17:52:17,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0866 secs
2025-03-13 17:52:17,104 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:52:17,104 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s]
2025-03-13 17:52:40,070 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9666 secs
2025-03-13 17:52:40,474 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8225 secs
2025-03-13 17:52:40,474 [INFO]: {
2025-03-13 17:52:40,474 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:40,474 [INFO]: 	index_param: efSearch=232
2025-03-13 17:52:40,474 [INFO]: 	index_path: knn.index
2025-03-13 17:52:40,474 [INFO]: 	size in bytes: 566031910
2025-03-13 17:52:40,474 [INFO]: 	avg_search_speed_ms: 11.93885435266887
2025-03-13 17:52:40,474 [INFO]: 	99p_search_speed_ms: 19.955792394466698
2025-03-13 17:52:40,474 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:40,474 [INFO]: 	nb vectors: 2877
2025-03-13 17:52:40,474 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:40,474 [INFO]: 	compression ratio: 0.9993097668292235
2025-03-13 17:52:40,474 [INFO]: }
2025-03-13 17:52:40,474 [INFO]: 	>>> Finished "Creating the index" in 59.8247 secs
2025-03-13 17:52:40,474 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8498 secs
2025-03-13 17:52:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 95264 [episode count 2/20]
[retrieval_preprocessing] for episode 34351 [episode count 3/20], we have num_retrieval=np.int64(2856) num_query=np.int64(156)
2025-03-13 17:52:42,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:42,777 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:42
2025-03-13 17:52:42,777 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.01it/s]
2025-03-13 17:52:42,806 [INFO]: There are 2856 embeddings of dim 49152
2025-03-13 17:52:42,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:52:42,807 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:42
2025-03-13 17:52:42,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:42,807 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:52:42,807 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:42,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:42,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:42
2025-03-13 17:52:42,807 [INFO]: 589.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:42,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:42,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:42
2025-03-13 17:52:42,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:42,807 [INFO]: 	Creating the index 03/13/2025, 17:52:42
2025-03-13 17:52:42,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:42
2025-03-13 17:52:42,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:52:42,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:42
2025-03-13 17:52:42,808 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:52:42,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.72it/s] 42%|████▏     | 5/12 [00:00<00:00, 26.47it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.45it/s]
2025-03-13 17:52:45,510 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:45
2025-03-13 17:53:32,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6999 secs
2025-03-13 17:53:32,211 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 17:53:32,211 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s]
2025-03-13 17:53:55,623 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4121 secs
2025-03-13 17:53:55,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8176 secs
2025-03-13 17:53:55,626 [INFO]: {
2025-03-13 17:53:55,626 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:55,626 [INFO]: 	index_param: efSearch=190
2025-03-13 17:53:55,626 [INFO]: 	index_path: knn.index
2025-03-13 17:53:55,626 [INFO]: 	size in bytes: 561900310
2025-03-13 17:53:55,626 [INFO]: 	avg_search_speed_ms: 9.39047729373503
2025-03-13 17:53:55,626 [INFO]: 	99p_search_speed_ms: 13.299092696979642
2025-03-13 17:53:55,626 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:55,626 [INFO]: 	nb vectors: 2856
2025-03-13 17:53:55,626 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:55,626 [INFO]: 	compression ratio: 0.9993097316497298
2025-03-13 17:53:55,626 [INFO]: }
2025-03-13 17:53:55,626 [INFO]: 	>>> Finished "Creating the index" in 72.8190 secs
2025-03-13 17:53:55,626 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8495 secs
2025-03-13 17:53:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 34351 [episode count 3/20]
[retrieval_preprocessing] for episode 18490 [episode count 4/20], we have num_retrieval=np.int64(2886) num_query=np.int64(126)
2025-03-13 17:53:57,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:58,268 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:58
2025-03-13 17:53:58,268 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 17:53:58,292 [INFO]: There are 2886 embeddings of dim 49152
2025-03-13 17:53:58,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 17:53:58,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:58
2025-03-13 17:53:58,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:58,292 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:53:58,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:58,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:58,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:58
2025-03-13 17:53:58,293 [INFO]: 595.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:58,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:53:58,293 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:58
2025-03-13 17:53:58,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:58,293 [INFO]: 	Creating the index 03/13/2025, 17:53:58
2025-03-13 17:53:58,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:58
2025-03-13 17:53:58,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:53:58,294 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:58
2025-03-13 17:53:58,294 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:58,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.93it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.40it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.16it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.49it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.75it/s] 50%|█████     | 6/12 [00:00<00:00,  7.81it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.02it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.30it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.43it/s]100%|██████████| 12/12 [00:03<00:00,  3.31it/s]
2025-03-13 17:54:01,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:01
2025-03-13 17:54:38,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0965 secs
2025-03-13 17:54:38,020 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 17:54:38,020 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 17:55:11,197 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1775 secs
2025-03-13 17:55:11,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9062 secs
2025-03-13 17:55:11,200 [INFO]: {
2025-03-13 17:55:11,200 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:11,200 [INFO]: 	index_param: efSearch=289
2025-03-13 17:55:11,200 [INFO]: 	index_path: knn.index
2025-03-13 17:55:11,200 [INFO]: 	size in bytes: 567802630
2025-03-13 17:55:11,200 [INFO]: 	avg_search_speed_ms: 10.855419529413847
2025-03-13 17:55:11,200 [INFO]: 	99p_search_speed_ms: 16.90585343167184
2025-03-13 17:55:11,200 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:11,200 [INFO]: 	nb vectors: 2886
2025-03-13 17:55:11,200 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:11,200 [INFO]: 	compression ratio: 0.9993097214079477
2025-03-13 17:55:11,200 [INFO]: }
2025-03-13 17:55:11,200 [INFO]: 	>>> Finished "Creating the index" in 72.9076 secs
2025-03-13 17:55:11,200 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9324 secs
2025-03-13 17:55:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 18490 [episode count 4/20]
[retrieval_preprocessing] for episode 40030 [episode count 5/20], we have num_retrieval=np.int64(2807) num_query=np.int64(205)
2025-03-13 17:55:13,449 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:13,935 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:13
2025-03-13 17:55:13,935 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.50it/s]
2025-03-13 17:55:13,961 [INFO]: There are 2807 embeddings of dim 49152
2025-03-13 17:55:13,961 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:55:13,961 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,961 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:13,961 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:55:13,961 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:13,961 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:13,961 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,962 [INFO]: 579.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:13,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:55:13,962 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:13
2025-03-13 17:55:13,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:13,962 [INFO]: 	Creating the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,962 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:13
2025-03-13 17:55:13,963 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:55:13,963 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:13
2025-03-13 17:55:13,963 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:55:13,963 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.46it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.18it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.92it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.41it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.63it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.35it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.76it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.98it/s]100%|██████████| 12/12 [00:02<00:00,  2.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.00it/s]
2025-03-13 17:55:16,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:16
2025-03-13 17:55:49,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0825 secs
2025-03-13 17:55:49,048 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 17:55:49,048 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.97it/s] 50%|█████     | 2/4 [00:00<00:00,  4.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.18it/s]
2025-03-13 17:56:13,749 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7014 secs
2025-03-13 17:56:14,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3571 secs
2025-03-13 17:56:14,320 [INFO]: {
2025-03-13 17:56:14,320 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:14,321 [INFO]: 	index_param: efSearch=286
2025-03-13 17:56:14,321 [INFO]: 	index_path: knn.index
2025-03-13 17:56:14,321 [INFO]: 	size in bytes: 552259870
2025-03-13 17:56:14,321 [INFO]: 	avg_search_speed_ms: 12.301576691525009
2025-03-13 17:56:14,321 [INFO]: 	99p_search_speed_ms: 21.15766141563654
2025-03-13 17:56:14,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:14,321 [INFO]: 	nb vectors: 2807
2025-03-13 17:56:14,321 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:14,321 [INFO]: 	compression ratio: 0.9993097198969029
2025-03-13 17:56:14,321 [INFO]: }
2025-03-13 17:56:14,321 [INFO]: 	>>> Finished "Creating the index" in 60.3593 secs
2025-03-13 17:56:14,321 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3864 secs
2025-03-13 17:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 40030 [episode count 5/20]
[retrieval_preprocessing] for episode 91270 [episode count 6/20], we have num_retrieval=np.int64(2829) num_query=np.int64(183)
2025-03-13 17:56:17,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:18,121 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:18
2025-03-13 17:56:18,121 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-13 17:56:18,147 [INFO]: There are 2829 embeddings of dim 49152
2025-03-13 17:56:18,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:56:18,148 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:18
2025-03-13 17:56:18,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:18,148 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:56:18,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:18,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:56:18,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:18
2025-03-13 17:56:18,149 [INFO]: 583.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:18,149 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:56:18,149 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:18
2025-03-13 17:56:18,149 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:18,150 [INFO]: 	Creating the index 03/13/2025, 17:56:18
2025-03-13 17:56:18,150 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:18
2025-03-13 17:56:18,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:56:18,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:18
2025-03-13 17:56:18,153 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:56:18,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.88it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.75it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.39it/s] 50%|█████     | 6/12 [00:00<00:00, 10.10it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.29it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.51it/s]100%|██████████| 12/12 [00:03<00:00,  2.32it/s]100%|██████████| 12/12 [00:03<00:00,  3.80it/s]
2025-03-13 17:56:21,317 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:21
2025-03-13 17:56:56,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0240 secs
2025-03-13 17:56:56,342 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 17:56:56,342 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
2025-03-13 17:57:32,546 [INFO]: 	>>> Finished "Compute fast metrics" in 36.2040 secs
2025-03-13 17:57:33,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3643 secs
2025-03-13 17:57:33,518 [INFO]: {
2025-03-13 17:57:33,518 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:33,518 [INFO]: 	index_param: efSearch=293
2025-03-13 17:57:33,518 [INFO]: 	index_path: knn.index
2025-03-13 17:57:33,518 [INFO]: 	size in bytes: 556588210
2025-03-13 17:57:33,518 [INFO]: 	avg_search_speed_ms: 10.310290193607665
2025-03-13 17:57:33,518 [INFO]: 	99p_search_speed_ms: 17.341527277603735
2025-03-13 17:57:33,518 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:33,519 [INFO]: 	nb vectors: 2829
2025-03-13 17:57:33,519 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:33,519 [INFO]: 	compression ratio: 0.9993097625980975
2025-03-13 17:57:33,519 [INFO]: }
2025-03-13 17:57:33,519 [INFO]: 	>>> Finished "Creating the index" in 75.3691 secs
2025-03-13 17:57:33,519 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3978 secs
2025-03-13 17:57:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 91270 [episode count 6/20]
[retrieval_preprocessing] for episode 67832 [episode count 7/20], we have num_retrieval=np.int64(2889) num_query=np.int64(123)
2025-03-13 17:57:36,575 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:37,025 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:37
2025-03-13 17:57:37,025 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.31it/s]
2025-03-13 17:57:37,054 [INFO]: There are 2889 embeddings of dim 49152
2025-03-13 17:57:37,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:57:37,055 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:37
2025-03-13 17:57:37,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:37,056 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:57:37,056 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:37,056 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:57:37,056 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:37
2025-03-13 17:57:37,056 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:37,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:57:37,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:37
2025-03-13 17:57:37,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:37,057 [INFO]: 	Creating the index 03/13/2025, 17:57:37
2025-03-13 17:57:37,057 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:37
2025-03-13 17:57:37,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:57:37,060 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:37
2025-03-13 17:57:37,060 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:37,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.51it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.13it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.44it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.76it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.33it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.19it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.90it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.71it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.57it/s]100%|██████████| 12/12 [00:03<00:00,  1.36it/s]100%|██████████| 12/12 [00:03<00:00,  3.39it/s]
2025-03-13 17:57:40,603 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:40
2025-03-13 17:58:13,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6180 secs
2025-03-13 17:58:13,221 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 17:58:13,221 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 50%|█████     | 2/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 17:58:40,854 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6329 secs
2025-03-13 17:58:40,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7966 secs
2025-03-13 17:58:40,857 [INFO]: {
2025-03-13 17:58:40,857 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:40,857 [INFO]: 	index_param: efSearch=257
2025-03-13 17:58:40,857 [INFO]: 	index_path: knn.index
2025-03-13 17:58:40,857 [INFO]: 	size in bytes: 568392850
2025-03-13 17:58:40,857 [INFO]: 	avg_search_speed_ms: 9.581809411613962
2025-03-13 17:58:40,857 [INFO]: 	99p_search_speed_ms: 15.84005978656927
2025-03-13 17:58:40,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:40,857 [INFO]: 	nb vectors: 2889
2025-03-13 17:58:40,857 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:40,857 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-13 17:58:40,857 [INFO]: }
2025-03-13 17:58:40,857 [INFO]: 	>>> Finished "Creating the index" in 63.8001 secs
2025-03-13 17:58:40,857 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8317 secs
2025-03-13 17:58:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 67832 [episode count 7/20]
[retrieval_preprocessing] for episode 12081 [episode count 8/20], we have num_retrieval=np.int64(2867) num_query=np.int64(145)
2025-03-13 17:58:43,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:44,053 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:44
2025-03-13 17:58:44,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-13 17:58:44,560 [INFO]: There are 2867 embeddings of dim 49152
2025-03-13 17:58:44,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5077 secs
2025-03-13 17:58:44,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:44
2025-03-13 17:58:44,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:44,561 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:58:44,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:44,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:58:44,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:44
2025-03-13 17:58:44,561 [INFO]: 591.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:44,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:58:44,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:44
2025-03-13 17:58:44,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:44,562 [INFO]: 	Creating the index 03/13/2025, 17:58:44
2025-03-13 17:58:44,562 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:44
2025-03-13 17:58:44,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:58:44,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:44
2025-03-13 17:58:44,565 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:58:44,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.17it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.70it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.54it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.94it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.18it/s] 50%|█████     | 6/12 [00:00<00:00,  8.37it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.46it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.23it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.38it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.36it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.39it/s]100%|██████████| 12/12 [00:03<00:00,  1.54it/s]100%|██████████| 12/12 [00:03<00:00,  3.71it/s]
2025-03-13 17:58:47,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:47
2025-03-13 17:59:23,041 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2404 secs
2025-03-13 17:59:23,041 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 17:59:23,042 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 17:59:49,487 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4449 secs
2025-03-13 17:59:49,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9246 secs
2025-03-13 17:59:49,489 [INFO]: {
2025-03-13 17:59:49,489 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:49,489 [INFO]: 	index_param: efSearch=273
2025-03-13 17:59:49,489 [INFO]: 	index_path: knn.index
2025-03-13 17:59:49,489 [INFO]: 	size in bytes: 564064510
2025-03-13 17:59:49,489 [INFO]: 	avg_search_speed_ms: 11.465140181025404
2025-03-13 17:59:49,489 [INFO]: 	99p_search_speed_ms: 16.06196287786588
2025-03-13 17:59:49,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:49,489 [INFO]: 	nb vectors: 2867
2025-03-13 17:59:49,489 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:49,489 [INFO]: 	compression ratio: 0.9993096995235528
2025-03-13 17:59:49,489 [INFO]: }
2025-03-13 17:59:49,489 [INFO]: 	>>> Finished "Creating the index" in 64.9275 secs
2025-03-13 17:59:49,490 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4367 secs
2025-03-13 17:59:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 12081 [episode count 8/20]
[retrieval_preprocessing] for episode 48406 [episode count 9/20], we have num_retrieval=np.int64(2879) num_query=np.int64(133)
2025-03-13 17:59:51,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:52,282 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:52
2025-03-13 17:59:52,283 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.34it/s]
2025-03-13 17:59:52,308 [INFO]: There are 2879 embeddings of dim 49152
2025-03-13 17:59:52,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 17:59:52,308 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:52
2025-03-13 17:59:52,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:52,308 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:59:52,308 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:52,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:52,308 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:52
2025-03-13 17:59:52,308 [INFO]: 594.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:52,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:59:52,308 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:52
2025-03-13 17:59:52,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:52,308 [INFO]: 	Creating the index 03/13/2025, 17:59:52
2025-03-13 17:59:52,308 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:52
2025-03-13 17:59:52,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:59:52,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:52
2025-03-13 17:59:52,309 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:59:52,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.51it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.73it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.82it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.43it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.55it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.73it/s]
2025-03-13 17:59:55,526 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:55
2025-03-13 18:00:28,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1245 secs
2025-03-13 18:00:28,651 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 18:00:28,651 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 18:00:45,286 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6349 secs
2025-03-13 18:00:45,289 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9793 secs
2025-03-13 18:00:45,289 [INFO]: {
2025-03-13 18:00:45,289 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:45,289 [INFO]: 	index_param: efSearch=242
2025-03-13 18:00:45,289 [INFO]: 	index_path: knn.index
2025-03-13 18:00:45,289 [INFO]: 	size in bytes: 566425390
2025-03-13 18:00:45,289 [INFO]: 	avg_search_speed_ms: 9.196393280919802
2025-03-13 18:00:45,289 [INFO]: 	99p_search_speed_ms: 14.156772592104971
2025-03-13 18:00:45,289 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:45,289 [INFO]: 	nb vectors: 2879
2025-03-13 18:00:45,289 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:45,289 [INFO]: 	compression ratio: 0.9993097802342511
2025-03-13 18:00:45,289 [INFO]: }
2025-03-13 18:00:45,289 [INFO]: 	>>> Finished "Creating the index" in 52.9808 secs
2025-03-13 18:00:45,289 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0065 secs
2025-03-13 18:00:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 48406 [episode count 9/20]
[retrieval_preprocessing] for episode 40233 [episode count 10/20], we have num_retrieval=np.int64(2879) num_query=np.int64(133)
2025-03-13 18:00:48,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:48,694 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:48
2025-03-13 18:00:48,694 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.05it/s]
2025-03-13 18:00:48,730 [INFO]: There are 2879 embeddings of dim 49152
2025-03-13 18:00:48,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 18:00:48,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:48,732 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:00:48,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:48,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:48,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,732 [INFO]: 594.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:48,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:48,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:48
2025-03-13 18:00:48,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:48,732 [INFO]: 	Creating the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:48
2025-03-13 18:00:48,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:00:48,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:48
2025-03-13 18:00:48,734 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:00:48,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.97it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.69it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.27it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.48it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.70it/s] 50%|█████     | 6/12 [00:00<00:00,  7.79it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.97it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.98it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.13it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.39it/s]100%|██████████| 12/12 [00:03<00:00,  1.24it/s]100%|██████████| 12/12 [00:03<00:00,  3.16it/s]
2025-03-13 18:00:52,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:52
2025-03-13 18:01:26,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9589 secs
2025-03-13 18:01:26,497 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 18:01:26,497 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 18:01:53,382 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8853 secs
2025-03-13 18:01:53,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9216 secs
2025-03-13 18:01:53,655 [INFO]: {
2025-03-13 18:01:53,656 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:53,656 [INFO]: 	index_param: efSearch=276
2025-03-13 18:01:53,656 [INFO]: 	index_path: knn.index
2025-03-13 18:01:53,656 [INFO]: 	size in bytes: 566425390
2025-03-13 18:01:53,656 [INFO]: 	avg_search_speed_ms: 9.938419409092537
2025-03-13 18:01:53,656 [INFO]: 	99p_search_speed_ms: 15.813362470362339
2025-03-13 18:01:53,656 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:53,656 [INFO]: 	nb vectors: 2879
2025-03-13 18:01:53,656 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:53,656 [INFO]: 	compression ratio: 0.9993097802342511
2025-03-13 18:01:53,656 [INFO]: }
2025-03-13 18:01:53,656 [INFO]: 	>>> Finished "Creating the index" in 64.9239 secs
2025-03-13 18:01:53,656 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9624 secs
2025-03-13 18:01:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 40233 [episode count 10/20]
[retrieval_preprocessing] for episode 93878 [episode count 11/20], we have num_retrieval=np.int64(2841) num_query=np.int64(171)
2025-03-13 18:01:56,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:56,482 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:56
2025-03-13 18:01:56,482 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 5706.54it/s]
2025-03-13 18:01:56,511 [INFO]: There are 2841 embeddings of dim 49152
2025-03-13 18:01:56,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 18:01:56,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:56
2025-03-13 18:01:56,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:56,512 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:01:56,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:56,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:01:56,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:56
2025-03-13 18:01:56,513 [INFO]: 586.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:56,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:01:56,513 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:56
2025-03-13 18:01:56,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:56,513 [INFO]: 	Creating the index 03/13/2025, 18:01:56
2025-03-13 18:01:56,513 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:56
2025-03-13 18:01:56,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:01:56,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:56
2025-03-13 18:01:56,516 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:01:56,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.85it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.34it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.44it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.07it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.31it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.45it/s]100%|██████████| 12/12 [00:02<00:00,  4.33it/s]
2025-03-13 18:01:59,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:59
2025-03-13 18:02:33,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9188 secs
2025-03-13 18:02:33,213 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 18:02:33,213 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 18:02:56,304 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0906 secs
2025-03-13 18:02:56,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7904 secs
2025-03-13 18:02:56,307 [INFO]: {
2025-03-13 18:02:56,307 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:56,307 [INFO]: 	index_param: efSearch=279
2025-03-13 18:02:56,307 [INFO]: 	index_path: knn.index
2025-03-13 18:02:56,307 [INFO]: 	size in bytes: 558949210
2025-03-13 18:02:56,307 [INFO]: 	avg_search_speed_ms: 9.813159620352785
2025-03-13 18:02:56,307 [INFO]: 	99p_search_speed_ms: 17.302592950873077
2025-03-13 18:02:56,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:56,307 [INFO]: 	nb vectors: 2841
2025-03-13 18:02:56,307 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:56,307 [INFO]: 	compression ratio: 0.99930962958155
2025-03-13 18:02:56,307 [INFO]: }
2025-03-13 18:02:56,307 [INFO]: 	>>> Finished "Creating the index" in 59.7936 secs
2025-03-13 18:02:56,307 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8253 secs
2025-03-13 18:02:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 93878 [episode count 11/20]
[retrieval_preprocessing] for episode 25952 [episode count 12/20], we have num_retrieval=np.int64(2884) num_query=np.int64(128)
2025-03-13 18:02:59,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:00,051 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:00
2025-03-13 18:03:00,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.76it/s]
2025-03-13 18:03:00,075 [INFO]: There are 2884 embeddings of dim 49152
2025-03-13 18:03:00,075 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 18:03:00,076 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:00,076 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:03:00,076 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:00,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:03:00,076 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,076 [INFO]: 595.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:00,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:03:00,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:00
2025-03-13 18:03:00,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:00,077 [INFO]: 	Creating the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,077 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:00
2025-03-13 18:03:00,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:03:00,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:00
2025-03-13 18:03:00,081 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:03:00,081 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.29it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.07it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.16it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.30it/s] 50%|█████     | 6/12 [00:00<00:00,  9.42it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.50it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.58it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.45it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.50it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.55it/s]100%|██████████| 12/12 [00:04<00:00,  1.01it/s]100%|██████████| 12/12 [00:04<00:00,  2.85it/s]
2025-03-13 18:03:04,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:04
2025-03-13 18:03:44,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3574 secs
2025-03-13 18:03:44,657 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:03:44,658 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 18:04:12,958 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3007 secs
2025-03-13 18:04:12,961 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8804 secs
2025-03-13 18:04:12,961 [INFO]: {
2025-03-13 18:04:12,961 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:12,961 [INFO]: 	index_param: efSearch=253
2025-03-13 18:04:12,961 [INFO]: 	index_path: knn.index
2025-03-13 18:04:12,961 [INFO]: 	size in bytes: 567409150
2025-03-13 18:04:12,961 [INFO]: 	avg_search_speed_ms: 10.627615032470157
2025-03-13 18:04:12,961 [INFO]: 	99p_search_speed_ms: 20.840797014534473
2025-03-13 18:04:12,961 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:12,961 [INFO]: 	nb vectors: 2884
2025-03-13 18:04:12,961 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:12,961 [INFO]: 	compression ratio: 0.9993097079946631
2025-03-13 18:04:12,961 [INFO]: }
2025-03-13 18:04:12,961 [INFO]: 	>>> Finished "Creating the index" in 72.8841 secs
2025-03-13 18:04:12,961 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9105 secs
2025-03-13 18:04:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 25952 [episode count 12/20]
[retrieval_preprocessing] for episode 38245 [episode count 13/20], we have num_retrieval=np.int64(2863) num_query=np.int64(149)
2025-03-13 18:04:15,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:15,969 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:15
2025-03-13 18:04:15,969 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.92it/s]
2025-03-13 18:04:15,999 [INFO]: There are 2863 embeddings of dim 49152
2025-03-13 18:04:15,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:04:15,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:15
2025-03-13 18:04:16,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:16,000 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:04:16,000 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:16,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:04:16,000 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,000 [INFO]: 590.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:16,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:04:16,001 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:16
2025-03-13 18:04:16,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:16,001 [INFO]: 	Creating the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:16
2025-03-13 18:04:16,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:04:16,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:16
2025-03-13 18:04:16,005 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:04:16,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.35it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.59it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.75it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.17it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.71it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.68it/s]100%|██████████| 12/12 [00:02<00:00,  4.26it/s]
2025-03-13 18:04:19,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:19
2025-03-13 18:04:53,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2951 secs
2025-03-13 18:04:53,722 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 18:04:53,723 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 50%|█████     | 2/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s]
2025-03-13 18:05:24,606 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8829 secs
2025-03-13 18:05:24,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6035 secs
2025-03-13 18:05:24,609 [INFO]: {
2025-03-13 18:05:24,609 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:24,609 [INFO]: 	index_param: efSearch=277
2025-03-13 18:05:24,609 [INFO]: 	index_path: knn.index
2025-03-13 18:05:24,609 [INFO]: 	size in bytes: 563277550
2025-03-13 18:05:24,609 [INFO]: 	avg_search_speed_ms: 10.45744390437325
2025-03-13 18:05:24,609 [INFO]: 	99p_search_speed_ms: 18.517102859914313
2025-03-13 18:05:24,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:24,609 [INFO]: 	nb vectors: 2863
2025-03-13 18:05:24,609 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:24,609 [INFO]: 	compression ratio: 0.9993096724696378
2025-03-13 18:05:24,609 [INFO]: }
2025-03-13 18:05:24,609 [INFO]: 	>>> Finished "Creating the index" in 68.6074 secs
2025-03-13 18:05:24,609 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6395 secs
2025-03-13 18:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 38245 [episode count 13/20]
[retrieval_preprocessing] for episode 21677 [episode count 14/20], we have num_retrieval=np.int64(2872) num_query=np.int64(140)
2025-03-13 18:05:27,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:28,363 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:28
2025-03-13 18:05:28,363 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.38it/s]
2025-03-13 18:05:28,389 [INFO]: There are 2872 embeddings of dim 49152
2025-03-13 18:05:28,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:05:28,389 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:28,389 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:05:28,389 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:28,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:28,389 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,389 [INFO]: 592.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:28,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:05:28,389 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:28
2025-03-13 18:05:28,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:28,389 [INFO]: 	Creating the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,390 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:28
2025-03-13 18:05:28,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:05:28,391 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,391 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:05:28,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.77it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.38it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.87it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.16it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.66it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.65it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.00it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.77it/s]100%|██████████| 12/12 [00:03<00:00,  1.44it/s]100%|██████████| 12/12 [00:03<00:00,  3.29it/s]
2025-03-13 18:05:32,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:32
2025-03-13 18:06:04,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6250 secs
2025-03-13 18:06:04,997 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 18:06:04,997 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 18:06:33,908 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9112 secs
2025-03-13 18:06:33,911 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5195 secs
2025-03-13 18:06:33,911 [INFO]: {
2025-03-13 18:06:33,911 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:33,911 [INFO]: 	index_param: efSearch=302
2025-03-13 18:06:33,911 [INFO]: 	index_path: knn.index
2025-03-13 18:06:33,911 [INFO]: 	size in bytes: 565048210
2025-03-13 18:06:33,911 [INFO]: 	avg_search_speed_ms: 11.755103508030206
2025-03-13 18:06:33,911 [INFO]: 	99p_search_speed_ms: 17.095452873036265
2025-03-13 18:06:33,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:33,911 [INFO]: 	nb vectors: 2872
2025-03-13 18:06:33,911 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:33,911 [INFO]: 	compression ratio: 0.9993097332349747
2025-03-13 18:06:33,911 [INFO]: }
2025-03-13 18:06:33,911 [INFO]: 	>>> Finished "Creating the index" in 65.5214 secs
2025-03-13 18:06:33,911 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5482 secs
2025-03-13 18:06:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 21677 [episode count 14/20]
[retrieval_preprocessing] for episode 56596 [episode count 15/20], we have num_retrieval=np.int64(2847) num_query=np.int64(165)
2025-03-13 18:06:38,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:39,546 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:39
2025-03-13 18:06:39,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]
2025-03-13 18:06:39,569 [INFO]: There are 2847 embeddings of dim 49152
2025-03-13 18:06:39,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 18:06:39,569 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:39
2025-03-13 18:06:39,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:39,569 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:06:39,569 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:39,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:39,569 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:39
2025-03-13 18:06:39,569 [INFO]: 587.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:39,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:06:39,570 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:39
2025-03-13 18:06:39,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:39,570 [INFO]: 	Creating the index 03/13/2025, 18:06:39
2025-03-13 18:06:39,570 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:39
2025-03-13 18:06:39,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:06:39,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:39
2025-03-13 18:06:39,571 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:06:39,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.37it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.16it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.59it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.58it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.26it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.59it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.20it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.62it/s]100%|██████████| 12/12 [00:03<00:00,  3.43it/s]
2025-03-13 18:06:43,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:43
2025-03-13 18:07:19,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8772 secs
2025-03-13 18:07:19,575 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 18:07:19,575 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 18:07:40,117 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5421 secs
2025-03-13 18:07:40,120 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5490 secs
2025-03-13 18:07:40,120 [INFO]: {
2025-03-13 18:07:40,120 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:40,120 [INFO]: 	index_param: efSearch=272
2025-03-13 18:07:40,120 [INFO]: 	index_path: knn.index
2025-03-13 18:07:40,120 [INFO]: 	size in bytes: 560129650
2025-03-13 18:07:40,120 [INFO]: 	avg_search_speed_ms: 10.931147498592653
2025-03-13 18:07:40,120 [INFO]: 	99p_search_speed_ms: 16.407255954109136
2025-03-13 18:07:40,120 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:40,120 [INFO]: 	nb vectors: 2847
2025-03-13 18:07:40,120 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:40,120 [INFO]: 	compression ratio: 0.9993096705378836
2025-03-13 18:07:40,120 [INFO]: }
2025-03-13 18:07:40,120 [INFO]: 	>>> Finished "Creating the index" in 60.5506 secs
2025-03-13 18:07:40,120 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5745 secs
2025-03-13 18:07:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 56596 [episode count 15/20]
[retrieval_preprocessing] for episode 91068 [episode count 16/20], we have num_retrieval=np.int64(2880) num_query=np.int64(132)
2025-03-13 18:07:43,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:44,341 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:44
2025-03-13 18:07:44,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.46it/s]
2025-03-13 18:07:44,366 [INFO]: There are 2880 embeddings of dim 49152
2025-03-13 18:07:44,366 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:07:44,366 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,366 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:44,366 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:07:44,366 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:44,366 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:44,366 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,366 [INFO]: 594.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:44,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:44,367 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:44
2025-03-13 18:07:44,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:44,367 [INFO]: 	Creating the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,367 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:44
2025-03-13 18:07:44,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:44,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:44
2025-03-13 18:07:44,368 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:07:44,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.54it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.77it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.53it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.71it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.99it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.34it/s]100%|██████████| 12/12 [00:03<00:00,  3.83it/s]
2025-03-13 18:07:47,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:47
2025-03-13 18:08:16,595 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0908 secs
2025-03-13 18:08:16,595 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 18:08:16,595 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 18:08:36,795 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1996 secs
2025-03-13 18:08:36,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4293 secs
2025-03-13 18:08:36,797 [INFO]: {
2025-03-13 18:08:36,797 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:36,797 [INFO]: 	index_param: efSearch=255
2025-03-13 18:08:36,797 [INFO]: 	index_path: knn.index
2025-03-13 18:08:36,797 [INFO]: 	size in bytes: 566622190
2025-03-13 18:08:36,797 [INFO]: 	avg_search_speed_ms: 9.789339901420147
2025-03-13 18:08:36,797 [INFO]: 	99p_search_speed_ms: 15.0618276768364
2025-03-13 18:08:36,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:36,797 [INFO]: 	nb vectors: 2880
2025-03-13 18:08:36,797 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:36,797 [INFO]: 	compression ratio: 0.9993096811122063
2025-03-13 18:08:36,797 [INFO]: }
2025-03-13 18:08:36,797 [INFO]: 	>>> Finished "Creating the index" in 52.4309 secs
2025-03-13 18:08:36,798 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4567 secs
2025-03-13 18:08:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 91068 [episode count 16/20]
[retrieval_preprocessing] for episode 78487 [episode count 17/20], we have num_retrieval=np.int64(2814) num_query=np.int64(198)
2025-03-13 18:08:39,209 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:39,631 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:39
2025-03-13 18:08:39,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 18:08:39,656 [INFO]: There are 2814 embeddings of dim 49152
2025-03-13 18:08:39,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:08:39,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:39
2025-03-13 18:08:39,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:39,656 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:08:39,656 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:39,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:39,656 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:39
2025-03-13 18:08:39,656 [INFO]: 580.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:39,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:08:39,656 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:39
2025-03-13 18:08:39,656 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:39,656 [INFO]: 	Creating the index 03/13/2025, 18:08:39
2025-03-13 18:08:39,656 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:39
2025-03-13 18:08:39,657 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:08:39,657 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:39
2025-03-13 18:08:39,657 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:08:39,657 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.29it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.60it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.53it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.06it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.33it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.36it/s]100%|██████████| 12/12 [00:02<00:00,  4.24it/s]
2025-03-13 18:08:42,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:42
2025-03-13 18:09:16,661 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1673 secs
2025-03-13 18:09:16,662 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 18:09:16,662 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 18:09:41,927 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2649 secs
2025-03-13 18:09:41,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2720 secs
2025-03-13 18:09:41,929 [INFO]: {
2025-03-13 18:09:41,929 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:41,929 [INFO]: 	index_param: efSearch=262
2025-03-13 18:09:41,929 [INFO]: 	index_path: knn.index
2025-03-13 18:09:41,929 [INFO]: 	size in bytes: 553637050
2025-03-13 18:09:41,930 [INFO]: 	avg_search_speed_ms: 10.573720692383247
2025-03-13 18:09:41,930 [INFO]: 	99p_search_speed_ms: 23.580170597415393
2025-03-13 18:09:41,930 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:41,930 [INFO]: 	nb vectors: 2814
2025-03-13 18:09:41,930 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:41,930 [INFO]: 	compression ratio: 0.9993097680149838
2025-03-13 18:09:41,930 [INFO]: }
2025-03-13 18:09:41,930 [INFO]: 	>>> Finished "Creating the index" in 62.2734 secs
2025-03-13 18:09:41,930 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2984 secs
2025-03-13 18:09:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 78487 [episode count 17/20]
[retrieval_preprocessing] for episode 7345 [episode count 18/20], we have num_retrieval=np.int64(2868) num_query=np.int64(144)
2025-03-13 18:09:44,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:45,465 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:45
2025-03-13 18:09:45,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-13 18:09:45,491 [INFO]: There are 2868 embeddings of dim 49152
2025-03-13 18:09:45,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:09:45,491 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,491 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:45,491 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:09:45,492 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:45,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:45,492 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,492 [INFO]: 591.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:45,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:09:45,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:45
2025-03-13 18:09:45,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:45,492 [INFO]: 	Creating the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:45
2025-03-13 18:09:45,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:09:45,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,493 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:09:45,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.06it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.45it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.82it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.59it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.97it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.01it/s]100%|██████████| 12/12 [00:03<00:00,  3.73it/s]
2025-03-13 18:09:48,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:48
2025-03-13 18:10:22,645 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9294 secs
2025-03-13 18:10:22,645 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 18:10:22,645 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 18:10:39,814 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1685 secs
2025-03-13 18:10:39,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3235 secs
2025-03-13 18:10:39,817 [INFO]: {
2025-03-13 18:10:39,817 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:39,817 [INFO]: 	index_param: efSearch=178
2025-03-13 18:10:39,817 [INFO]: 	index_path: knn.index
2025-03-13 18:10:39,817 [INFO]: 	size in bytes: 564261250
2025-03-13 18:10:39,817 [INFO]: 	avg_search_speed_ms: 7.953302419093173
2025-03-13 18:10:39,817 [INFO]: 	99p_search_speed_ms: 13.84245411492889
2025-03-13 18:10:39,817 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:39,817 [INFO]: 	nb vectors: 2868
2025-03-13 18:10:39,817 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:39,817 [INFO]: 	compression ratio: 0.9993097062752404
2025-03-13 18:10:39,817 [INFO]: }
2025-03-13 18:10:39,817 [INFO]: 	>>> Finished "Creating the index" in 54.3250 secs
2025-03-13 18:10:39,817 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3516 secs
2025-03-13 18:10:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 7345 [episode count 18/20]
[retrieval_preprocessing] for episode 70833 [episode count 19/20], we have num_retrieval=np.int64(2852) num_query=np.int64(160)
2025-03-13 18:10:41,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:42,438 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:42
2025-03-13 18:10:42,438 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1138.52it/s]
2025-03-13 18:10:42,463 [INFO]: There are 2852 embeddings of dim 49152
2025-03-13 18:10:42,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:10:42,463 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:42
2025-03-13 18:10:42,463 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:42,463 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:10:42,463 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:42,463 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:42,463 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:42
2025-03-13 18:10:42,464 [INFO]: 588.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:42,464 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:10:42,464 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:42
2025-03-13 18:10:42,464 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:42,464 [INFO]: 	Creating the index 03/13/2025, 18:10:42
2025-03-13 18:10:42,464 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:42
2025-03-13 18:10:42,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:10:42,465 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:42
2025-03-13 18:10:42,465 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:10:42,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.39it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.88it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.43it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.72it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.89it/s] 50%|█████     | 6/12 [00:00<00:00,  8.01it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.16it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.18it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.17it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.15it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.37it/s]100%|██████████| 12/12 [00:03<00:00,  1.34it/s]100%|██████████| 12/12 [00:03<00:00,  3.35it/s]
2025-03-13 18:10:46,054 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:46
2025-03-13 18:11:19,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2792 secs
2025-03-13 18:11:19,334 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 18:11:19,334 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 18:11:49,073 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7390 secs
2025-03-13 18:11:49,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6102 secs
2025-03-13 18:11:49,075 [INFO]: {
2025-03-13 18:11:49,075 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:49,075 [INFO]: 	index_param: efSearch=296
2025-03-13 18:11:49,075 [INFO]: 	index_path: knn.index
2025-03-13 18:11:49,075 [INFO]: 	size in bytes: 561113350
2025-03-13 18:11:49,075 [INFO]: 	avg_search_speed_ms: 9.798970412103555
2025-03-13 18:11:49,075 [INFO]: 	99p_search_speed_ms: 13.687737146392461
2025-03-13 18:11:49,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:49,075 [INFO]: 	nb vectors: 2852
2025-03-13 18:11:49,075 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:49,075 [INFO]: 	compression ratio: 0.9993097045365255
2025-03-13 18:11:49,075 [INFO]: }
2025-03-13 18:11:49,075 [INFO]: 	>>> Finished "Creating the index" in 66.6116 secs
2025-03-13 18:11:49,075 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6371 secs
2025-03-13 18:11:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 70833 [episode count 19/20]
2025-03-13 18:11:50: [retrieval_preprocessing] finished for 8911427557_put_rubber_band_around_cup [chosen_id count 5/196]
2025-03-13 18:11:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8911427557_put_rubber_band_around_brown_cup [chosen_id count 6/196]
2025-03-13 18:11:52: [retrieval_preprocessing] we have num_total=2862 embedding_dim=49152
[retrieval_preprocessing] for episode 55869 [episode count 0/20], we have num_retrieval=np.int64(2722) num_query=np.int64(140)
2025-03-13 18:11:53,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:54,044 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:54
2025-03-13 18:11:54,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-13 18:11:54,070 [INFO]: There are 2722 embeddings of dim 49152
2025-03-13 18:11:54,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:11:54,070 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:54
2025-03-13 18:11:54,070 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:54,070 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:11:54,070 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:54,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:54,070 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:54
2025-03-13 18:11:54,070 [INFO]: 561.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:54,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:54,070 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:54
2025-03-13 18:11:54,070 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:54,070 [INFO]: 	Creating the index 03/13/2025, 18:11:54
2025-03-13 18:11:54,070 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:54
2025-03-13 18:11:54,071 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:11:54,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:54
2025-03-13 18:11:54,072 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:11:54,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.82it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.00it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.04it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.07it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.19it/s]100%|██████████| 11/11 [00:03<00:00,  1.84it/s]100%|██████████| 11/11 [00:03<00:00,  3.03it/s]
2025-03-13 18:11:57,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:57
2025-03-13 18:12:27,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1213 secs
2025-03-13 18:12:27,837 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 18:12:27,837 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 18:12:52,310 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4728 secs
2025-03-13 18:12:52,313 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2412 secs
2025-03-13 18:12:52,313 [INFO]: {
2025-03-13 18:12:52,313 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:52,313 [INFO]: 	index_param: efSearch=279
2025-03-13 18:12:52,313 [INFO]: 	index_path: knn.index
2025-03-13 18:12:52,313 [INFO]: 	size in bytes: 535536610
2025-03-13 18:12:52,313 [INFO]: 	avg_search_speed_ms: 11.15536400939285
2025-03-13 18:12:52,313 [INFO]: 	99p_search_speed_ms: 15.252172807231542
2025-03-13 18:12:52,313 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:52,313 [INFO]: 	nb vectors: 2722
2025-03-13 18:12:52,313 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:52,313 [INFO]: 	compression ratio: 0.999309787616574
2025-03-13 18:12:52,313 [INFO]: }
2025-03-13 18:12:52,313 [INFO]: 	>>> Finished "Creating the index" in 58.2429 secs
2025-03-13 18:12:52,313 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2690 secs
2025-03-13 18:12:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 55869 [episode count 0/20]
[retrieval_preprocessing] for episode 37456 [episode count 1/20], we have num_retrieval=np.int64(2721) num_query=np.int64(141)
2025-03-13 18:12:54,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:55,371 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:55
2025-03-13 18:12:55,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.81it/s]
2025-03-13 18:12:55,394 [INFO]: There are 2721 embeddings of dim 49152
2025-03-13 18:12:55,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 18:12:55,394 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:55,394 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:12:55,394 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:55,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:55,394 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,394 [INFO]: 561.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:55,394 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:12:55,394 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:55
2025-03-13 18:12:55,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:55,395 [INFO]: 	Creating the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:55
2025-03-13 18:12:55,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:12:55,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,396 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:12:55,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.57it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.25it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.97it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.19it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.41it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.36it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.39it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.52it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.74it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.87it/s]100%|██████████| 11/11 [00:03<00:00,  1.42it/s]100%|██████████| 11/11 [00:03<00:00,  3.39it/s]
2025-03-13 18:12:58,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:58
2025-03-13 18:13:33,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9863 secs
2025-03-13 18:13:33,633 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 18:13:33,633 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 18:14:07,472 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8390 secs
2025-03-13 18:14:08,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8809 secs
2025-03-13 18:14:08,277 [INFO]: {
2025-03-13 18:14:08,277 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:08,277 [INFO]: 	index_param: efSearch=280
2025-03-13 18:14:08,277 [INFO]: 	index_path: knn.index
2025-03-13 18:14:08,277 [INFO]: 	size in bytes: 535339870
2025-03-13 18:14:08,277 [INFO]: 	avg_search_speed_ms: 9.72368510777585
2025-03-13 18:14:08,277 [INFO]: 	99p_search_speed_ms: 13.698343932628637
2025-03-13 18:14:08,277 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:08,277 [INFO]: 	nb vectors: 2721
2025-03-13 18:14:08,277 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:08,277 [INFO]: 	compression ratio: 0.9993097805325054
2025-03-13 18:14:08,277 [INFO]: }
2025-03-13 18:14:08,278 [INFO]: 	>>> Finished "Creating the index" in 72.8830 secs
2025-03-13 18:14:08,278 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9060 secs
2025-03-13 18:14:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 37456 [episode count 1/20]
[retrieval_preprocessing] for episode 66644 [episode count 2/20], we have num_retrieval=np.int64(2733) num_query=np.int64(129)
2025-03-13 18:14:10,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:11,404 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:11
2025-03-13 18:14:11,404 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1715.46it/s]
2025-03-13 18:14:11,427 [INFO]: There are 2733 embeddings of dim 49152
2025-03-13 18:14:11,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 18:14:11,427 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:11
2025-03-13 18:14:11,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:11,427 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:14:11,427 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:11,427 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:11,427 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:11
2025-03-13 18:14:11,428 [INFO]: 564.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:11,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:14:11,428 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:11
2025-03-13 18:14:11,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:11,428 [INFO]: 	Creating the index 03/13/2025, 18:14:11
2025-03-13 18:14:11,428 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:11
2025-03-13 18:14:11,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:14:11,429 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:11
2025-03-13 18:14:11,429 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:14:11,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.78it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.99it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.26it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.09it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.38it/s]100%|██████████| 11/11 [00:03<00:00,  2.26it/s]100%|██████████| 11/11 [00:03<00:00,  3.61it/s]
2025-03-13 18:14:14,487 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:14
2025-03-13 18:14:47,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1537 secs
2025-03-13 18:14:47,642 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 18:14:47,642 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 18:15:13,704 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0616 secs
2025-03-13 18:15:14,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9431 secs
2025-03-13 18:15:14,372 [INFO]: {
2025-03-13 18:15:14,372 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:14,372 [INFO]: 	index_param: efSearch=242
2025-03-13 18:15:14,372 [INFO]: 	index_path: knn.index
2025-03-13 18:15:14,372 [INFO]: 	size in bytes: 537700750
2025-03-13 18:15:14,373 [INFO]: 	avg_search_speed_ms: 8.959404199123783
2025-03-13 18:15:14,373 [INFO]: 	99p_search_speed_ms: 15.72114782175048
2025-03-13 18:15:14,373 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:14,373 [INFO]: 	nb vectors: 2733
2025-03-13 18:15:14,373 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:14,373 [INFO]: 	compression ratio: 0.9993098651991837
2025-03-13 18:15:14,373 [INFO]: }
2025-03-13 18:15:14,373 [INFO]: 	>>> Finished "Creating the index" in 62.9452 secs
2025-03-13 18:15:14,373 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9685 secs
2025-03-13 18:15:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 66644 [episode count 2/20]
[retrieval_preprocessing] for episode 74859 [episode count 3/20], we have num_retrieval=np.int64(2700) num_query=np.int64(162)
2025-03-13 18:15:16,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:16,841 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:16
2025-03-13 18:15:16,841 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1295.34it/s]
2025-03-13 18:15:16,869 [INFO]: There are 2700 embeddings of dim 49152
2025-03-13 18:15:16,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 18:15:16,870 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:16
2025-03-13 18:15:16,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:16,870 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:15:16,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:16,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:15:16,870 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:16
2025-03-13 18:15:16,871 [INFO]: 557.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:16,871 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:15:16,871 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:16
2025-03-13 18:15:16,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:16,872 [INFO]: 	Creating the index 03/13/2025, 18:15:16
2025-03-13 18:15:16,872 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:16
2025-03-13 18:15:16,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:15:16,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:16
2025-03-13 18:15:16,875 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:15:16,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.78it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.26it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.89it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.24it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.49it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.58it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.65it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.61it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.59it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.69it/s]100%|██████████| 11/11 [00:03<00:00,  1.57it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-13 18:15:19,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:19
2025-03-13 18:15:52,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5447 secs
2025-03-13 18:15:52,451 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 18:15:52,451 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 18:16:11,231 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7793 secs
2025-03-13 18:16:11,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3577 secs
2025-03-13 18:16:11,233 [INFO]: {
2025-03-13 18:16:11,233 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:11,233 [INFO]: 	index_param: efSearch=281
2025-03-13 18:16:11,233 [INFO]: 	index_path: knn.index
2025-03-13 18:16:11,233 [INFO]: 	size in bytes: 531208270
2025-03-13 18:16:11,233 [INFO]: 	avg_search_speed_ms: 10.915212719050524
2025-03-13 18:16:11,233 [INFO]: 	99p_search_speed_ms: 14.898206049110742
2025-03-13 18:16:11,233 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:11,233 [INFO]: 	nb vectors: 2700
2025-03-13 18:16:11,233 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:11,233 [INFO]: 	compression ratio: 0.999309743426999
2025-03-13 18:16:11,233 [INFO]: }
2025-03-13 18:16:11,233 [INFO]: 	>>> Finished "Creating the index" in 54.3618 secs
2025-03-13 18:16:11,233 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3919 secs
2025-03-13 18:16:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 74859 [episode count 3/20]
[retrieval_preprocessing] for episode 86638 [episode count 4/20], we have num_retrieval=np.int64(2741) num_query=np.int64(121)
2025-03-13 18:16:14,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:15,286 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:15
2025-03-13 18:16:15,286 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.75it/s]
2025-03-13 18:16:15,313 [INFO]: There are 2741 embeddings of dim 49152
2025-03-13 18:16:15,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:16:15,313 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:15
2025-03-13 18:16:15,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:15,313 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:16:15,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:15,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:15,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:15
2025-03-13 18:16:15,313 [INFO]: 565.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:15,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:15,313 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:15
2025-03-13 18:16:15,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:15,313 [INFO]: 	Creating the index 03/13/2025, 18:16:15
2025-03-13 18:16:15,313 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:15
2025-03-13 18:16:15,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:16:15,315 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:15
2025-03-13 18:16:15,315 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:16:15,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.23it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.76it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.99it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.94it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.21it/s]100%|██████████| 11/11 [00:02<00:00,  3.84it/s]
2025-03-13 18:16:18,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:18
2025-03-13 18:16:49,836 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6447 secs
2025-03-13 18:16:49,836 [INFO]: The best hyperparameters are: efSearch=309
2025-03-13 18:16:49,836 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.46it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 18:17:23,893 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0572 secs
2025-03-13 18:17:23,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5814 secs
2025-03-13 18:17:23,896 [INFO]: {
2025-03-13 18:17:23,896 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:23,896 [INFO]: 	index_param: efSearch=309
2025-03-13 18:17:23,896 [INFO]: 	index_path: knn.index
2025-03-13 18:17:23,896 [INFO]: 	size in bytes: 539274670
2025-03-13 18:17:23,896 [INFO]: 	avg_search_speed_ms: 12.012646878462414
2025-03-13 18:17:23,896 [INFO]: 	99p_search_speed_ms: 23.13311981037257
2025-03-13 18:17:23,896 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:23,896 [INFO]: 	nb vectors: 2741
2025-03-13 18:17:23,896 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:23,896 [INFO]: 	compression ratio: 0.9993099212317909
2025-03-13 18:17:23,896 [INFO]: }
2025-03-13 18:17:23,896 [INFO]: 	>>> Finished "Creating the index" in 68.5831 secs
2025-03-13 18:17:23,896 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6101 secs
2025-03-13 18:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 86638 [episode count 4/20]
[retrieval_preprocessing] for episode 72923 [episode count 5/20], we have num_retrieval=np.int64(2732) num_query=np.int64(130)
2025-03-13 18:17:26,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:27,124 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:27
2025-03-13 18:17:27,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.70it/s]
2025-03-13 18:17:27,154 [INFO]: There are 2732 embeddings of dim 49152
2025-03-13 18:17:27,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:17:27,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:27,155 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:17:27,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:27,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:17:27,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,156 [INFO]: 563.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:27,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:17:27,156 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:27
2025-03-13 18:17:27,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:27,157 [INFO]: 	Creating the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:27
2025-03-13 18:17:27,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 18:17:27,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:27
2025-03-13 18:17:27,159 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:17:27,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.36it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.08it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.35it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.15it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.03it/s]100%|██████████| 11/11 [00:03<00:00,  2.31it/s]100%|██████████| 11/11 [00:03<00:00,  3.66it/s]
2025-03-13 18:17:30,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:30
2025-03-13 18:18:02,298 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1255 secs
2025-03-13 18:18:02,298 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 18:18:02,298 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 18:18:22,308 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0095 secs
2025-03-13 18:18:22,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5859 secs
2025-03-13 18:18:22,746 [INFO]: {
2025-03-13 18:18:22,746 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:22,746 [INFO]: 	index_param: efSearch=304
2025-03-13 18:18:22,746 [INFO]: 	index_path: knn.index
2025-03-13 18:18:22,746 [INFO]: 	size in bytes: 537504010
2025-03-13 18:18:22,746 [INFO]: 	avg_search_speed_ms: 12.035632887619819
2025-03-13 18:18:22,746 [INFO]: 	99p_search_speed_ms: 21.721870312467264
2025-03-13 18:18:22,746 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:22,746 [INFO]: 	nb vectors: 2732
2025-03-13 18:18:22,746 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:22,746 [INFO]: 	compression ratio: 0.9993098581720349
2025-03-13 18:18:22,746 [INFO]: }
2025-03-13 18:18:22,746 [INFO]: 	>>> Finished "Creating the index" in 55.5897 secs
2025-03-13 18:18:22,746 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6218 secs
2025-03-13 18:18:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 72923 [episode count 5/20]
[retrieval_preprocessing] for episode 11542 [episode count 6/20], we have num_retrieval=np.int64(2731) num_query=np.int64(131)
2025-03-13 18:18:29,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:29,687 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:29
2025-03-13 18:18:29,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.60it/s]
2025-03-13 18:18:29,714 [INFO]: There are 2731 embeddings of dim 49152
2025-03-13 18:18:29,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:18:29,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:29,715 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:18:29,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:29,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:18:29,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,715 [INFO]: 563.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:29,715 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:18:29,715 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:29
2025-03-13 18:18:29,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:29,715 [INFO]: 	Creating the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,715 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:29
2025-03-13 18:18:29,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:18:29,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:29
2025-03-13 18:18:29,717 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:18:29,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.62it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.90it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.99it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.61it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.85it/s]100%|██████████| 11/11 [00:02<00:00,  2.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.11it/s]
2025-03-13 18:18:32,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:32
2025-03-13 18:18:58,092 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6969 secs
2025-03-13 18:18:58,092 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 18:18:58,092 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-13 18:19:21,847 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7542 secs
2025-03-13 18:19:21,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1327 secs
2025-03-13 18:19:21,849 [INFO]: {
2025-03-13 18:19:21,849 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:21,849 [INFO]: 	index_param: efSearch=317
2025-03-13 18:19:21,849 [INFO]: 	index_path: knn.index
2025-03-13 18:19:21,850 [INFO]: 	size in bytes: 537307270
2025-03-13 18:19:21,850 [INFO]: 	avg_search_speed_ms: 11.474603595887098
2025-03-13 18:19:21,850 [INFO]: 	99p_search_speed_ms: 18.401908117812127
2025-03-13 18:19:21,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:21,850 [INFO]: 	nb vectors: 2731
2025-03-13 18:19:21,850 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:21,850 [INFO]: 	compression ratio: 0.9993098511397398
2025-03-13 18:19:21,850 [INFO]: }
2025-03-13 18:19:21,850 [INFO]: 	>>> Finished "Creating the index" in 52.1344 secs
2025-03-13 18:19:21,850 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1630 secs
2025-03-13 18:19:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 11542 [episode count 6/20]
[retrieval_preprocessing] for episode 87350 [episode count 7/20], we have num_retrieval=np.int64(2716) num_query=np.int64(146)
2025-03-13 18:19:24,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:25,288 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:25
2025-03-13 18:19:25,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.69it/s]
2025-03-13 18:19:25,318 [INFO]: There are 2716 embeddings of dim 49152
2025-03-13 18:19:25,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:19:25,318 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:25
2025-03-13 18:19:25,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:25,318 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:19:25,318 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:25,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:19:25,319 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:25
2025-03-13 18:19:25,319 [INFO]: 560.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:25,319 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:19:25,319 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:25
2025-03-13 18:19:25,319 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:25,319 [INFO]: 	Creating the index 03/13/2025, 18:19:25
2025-03-13 18:19:25,319 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:25
2025-03-13 18:19:25,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:19:25,320 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:25
2025-03-13 18:19:25,321 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:19:25,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.30it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.20it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.89it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.29it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.51it/s]100%|██████████| 11/11 [00:02<00:00,  2.49it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]
2025-03-13 18:19:28,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:28
2025-03-13 18:19:59,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3187 secs
2025-03-13 18:19:59,485 [INFO]: The best hyperparameters are: efSearch=329
2025-03-13 18:19:59,485 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s]
2025-03-13 18:20:24,852 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3664 secs
2025-03-13 18:20:24,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5337 secs
2025-03-13 18:20:24,854 [INFO]: {
2025-03-13 18:20:24,854 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:24,855 [INFO]: 	index_param: efSearch=329
2025-03-13 18:20:24,855 [INFO]: 	index_path: knn.index
2025-03-13 18:20:24,855 [INFO]: 	size in bytes: 534356170
2025-03-13 18:20:24,855 [INFO]: 	avg_search_speed_ms: 12.191003742633471
2025-03-13 18:20:24,855 [INFO]: 	99p_search_speed_ms: 16.82407688349485
2025-03-13 18:20:24,855 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:24,855 [INFO]: 	nb vectors: 2716
2025-03-13 18:20:24,855 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:24,855 [INFO]: 	compression ratio: 0.9993097450339162
2025-03-13 18:20:24,855 [INFO]: }
2025-03-13 18:20:24,855 [INFO]: 	>>> Finished "Creating the index" in 59.5355 secs
2025-03-13 18:20:24,855 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5667 secs
2025-03-13 18:20:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 87350 [episode count 7/20]
[retrieval_preprocessing] for episode 5953 [episode count 8/20], we have num_retrieval=np.int64(2662) num_query=np.int64(200)
2025-03-13 18:20:28,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:29,134 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:29
2025-03-13 18:20:29,134 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2208.69it/s]
2025-03-13 18:20:29,160 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 18:20:29,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:20:29,160 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:29
2025-03-13 18:20:29,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:29,161 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:20:29,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:29,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:29,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:29
2025-03-13 18:20:29,161 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:29,161 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:20:29,161 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:29
2025-03-13 18:20:29,161 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:29,161 [INFO]: 	Creating the index 03/13/2025, 18:20:29
2025-03-13 18:20:29,161 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:29
2025-03-13 18:20:29,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:20:29,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:29
2025-03-13 18:20:29,162 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:20:29,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.71it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.80it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.75it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.09it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.14it/s]100%|██████████| 11/11 [00:03<00:00,  1.70it/s]100%|██████████| 11/11 [00:03<00:00,  2.80it/s]
2025-03-13 18:20:33,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:33
2025-03-13 18:21:03,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4445 secs
2025-03-13 18:21:03,545 [INFO]: The best hyperparameters are: efSearch=320
2025-03-13 18:21:03,545 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 18:21:22,649 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1042 secs
2025-03-13 18:21:22,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4890 secs
2025-03-13 18:21:22,651 [INFO]: {
2025-03-13 18:21:22,651 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:22,651 [INFO]: 	index_param: efSearch=320
2025-03-13 18:21:22,652 [INFO]: 	index_path: knn.index
2025-03-13 18:21:22,652 [INFO]: 	size in bytes: 523732090
2025-03-13 18:21:22,652 [INFO]: 	avg_search_speed_ms: 10.396793458064758
2025-03-13 18:21:22,652 [INFO]: 	99p_search_speed_ms: 14.35182517627254
2025-03-13 18:21:22,652 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:22,652 [INFO]: 	nb vectors: 2662
2025-03-13 18:21:22,652 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:22,652 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 18:21:22,652 [INFO]: }
2025-03-13 18:21:22,652 [INFO]: 	>>> Finished "Creating the index" in 53.4906 secs
2025-03-13 18:21:22,652 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5179 secs
2025-03-13 18:21:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 5953 [episode count 8/20]
[retrieval_preprocessing] for episode 85335 [episode count 9/20], we have num_retrieval=np.int64(2723) num_query=np.int64(139)
2025-03-13 18:21:25,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:25,664 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:25
2025-03-13 18:21:25,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.92it/s]
2025-03-13 18:21:25,689 [INFO]: There are 2723 embeddings of dim 49152
2025-03-13 18:21:25,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:21:25,690 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:25
2025-03-13 18:21:25,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:25,690 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:21:25,690 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:25,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:25,690 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:25
2025-03-13 18:21:25,690 [INFO]: 562.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:25,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:21:25,690 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:25
2025-03-13 18:21:25,690 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:25,690 [INFO]: 	Creating the index 03/13/2025, 18:21:25
2025-03-13 18:21:25,690 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:25
2025-03-13 18:21:25,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:21:25,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:25
2025-03-13 18:21:25,691 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:21:25,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.59it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.31it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.69it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.39it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.58it/s]100%|██████████| 11/11 [00:02<00:00,  2.53it/s]100%|██████████| 11/11 [00:02<00:00,  4.09it/s]
2025-03-13 18:21:28,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:28
2025-03-13 18:21:56,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4641 secs
2025-03-13 18:21:56,852 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 18:21:56,852 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s]
2025-03-13 18:22:28,239 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3867 secs
2025-03-13 18:22:28,242 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5501 secs
2025-03-13 18:22:28,242 [INFO]: {
2025-03-13 18:22:28,242 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:28,242 [INFO]: 	index_param: efSearch=290
2025-03-13 18:22:28,242 [INFO]: 	index_path: knn.index
2025-03-13 18:22:28,242 [INFO]: 	size in bytes: 535733350
2025-03-13 18:22:28,242 [INFO]: 	avg_search_speed_ms: 10.070028063941518
2025-03-13 18:22:28,242 [INFO]: 	99p_search_speed_ms: 14.67243182472886
2025-03-13 18:22:28,242 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:28,242 [INFO]: 	nb vectors: 2723
2025-03-13 18:22:28,242 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:28,242 [INFO]: 	compression ratio: 0.9993097946954395
2025-03-13 18:22:28,242 [INFO]: }
2025-03-13 18:22:28,242 [INFO]: 	>>> Finished "Creating the index" in 62.5518 secs
2025-03-13 18:22:28,242 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5778 secs
2025-03-13 18:22:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 85335 [episode count 9/20]
[retrieval_preprocessing] for episode 32090 [episode count 10/20], we have num_retrieval=np.int64(2733) num_query=np.int64(129)
2025-03-13 18:22:33,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:33,935 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:33
2025-03-13 18:22:33,935 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1270.23it/s]
2025-03-13 18:22:33,964 [INFO]: There are 2733 embeddings of dim 49152
2025-03-13 18:22:33,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 18:22:33,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:33
2025-03-13 18:22:33,965 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:33,965 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:22:33,965 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:33,965 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:22:33,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:33
2025-03-13 18:22:33,966 [INFO]: 564.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:33,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:22:33,966 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:33
2025-03-13 18:22:33,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:33,967 [INFO]: 	Creating the index 03/13/2025, 18:22:33
2025-03-13 18:22:33,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:33
2025-03-13 18:22:33,970 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:22:33,970 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:33
2025-03-13 18:22:33,970 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:22:33,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.21it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.81it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.63it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.96it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.22it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.34it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.45it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.54it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.70it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.71it/s]100%|██████████| 11/11 [00:03<00:00,  1.39it/s]100%|██████████| 11/11 [00:03<00:00,  3.32it/s]
2025-03-13 18:22:37,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:37
2025-03-13 18:23:04,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2158 secs
2025-03-13 18:23:04,514 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 18:23:04,514 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.36it/s] 50%|█████     | 2/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s]
2025-03-13 18:23:24,821 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3072 secs
2025-03-13 18:23:24,824 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8537 secs
2025-03-13 18:23:24,824 [INFO]: {
2025-03-13 18:23:24,824 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:24,824 [INFO]: 	index_param: efSearch=223
2025-03-13 18:23:24,824 [INFO]: 	index_path: knn.index
2025-03-13 18:23:24,824 [INFO]: 	size in bytes: 537700750
2025-03-13 18:23:24,824 [INFO]: 	avg_search_speed_ms: 9.91903041468172
2025-03-13 18:23:24,824 [INFO]: 	99p_search_speed_ms: 14.726413199678063
2025-03-13 18:23:24,824 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:24,824 [INFO]: 	nb vectors: 2733
2025-03-13 18:23:24,824 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:24,824 [INFO]: 	compression ratio: 0.9993098651991837
2025-03-13 18:23:24,824 [INFO]: }
2025-03-13 18:23:24,824 [INFO]: 	>>> Finished "Creating the index" in 50.8578 secs
2025-03-13 18:23:24,824 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8897 secs
2025-03-13 18:23:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 32090 [episode count 10/20]
[retrieval_preprocessing] for episode 73096 [episode count 11/20], we have num_retrieval=np.int64(2725) num_query=np.int64(137)
2025-03-13 18:23:26,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:27,245 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:27
2025-03-13 18:23:27,245 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.63it/s]
2025-03-13 18:23:27,273 [INFO]: There are 2725 embeddings of dim 49152
2025-03-13 18:23:27,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:23:27,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:27
2025-03-13 18:23:27,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:27,275 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:23:27,275 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:27,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:23:27,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:27
2025-03-13 18:23:27,275 [INFO]: 562.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:27,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:23:27,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:27
2025-03-13 18:23:27,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:27,276 [INFO]: 	Creating the index 03/13/2025, 18:23:27
2025-03-13 18:23:27,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:27
2025-03-13 18:23:27,279 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:23:27,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:27
2025-03-13 18:23:27,280 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:23:27,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.17it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.33it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.22it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.94it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.32it/s] 91%|█████████ | 10/11 [00:01<00:00, 11.47it/s]100%|██████████| 11/11 [00:03<00:00,  3.63it/s]
2025-03-13 18:23:30,317 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:30
2025-03-13 18:23:57,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6734 secs
2025-03-13 18:23:57,991 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 18:23:57,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-13 18:24:21,333 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3410 secs
2025-03-13 18:24:21,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0555 secs
2025-03-13 18:24:21,335 [INFO]: {
2025-03-13 18:24:21,335 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:21,335 [INFO]: 	index_param: efSearch=293
2025-03-13 18:24:21,335 [INFO]: 	index_path: knn.index
2025-03-13 18:24:21,335 [INFO]: 	size in bytes: 536126830
2025-03-13 18:24:21,336 [INFO]: 	avg_search_speed_ms: 9.932835003251974
2025-03-13 18:24:21,336 [INFO]: 	99p_search_speed_ms: 14.000935200601814
2025-03-13 18:24:21,336 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:21,336 [INFO]: 	nb vectors: 2725
2025-03-13 18:24:21,336 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:21,336 [INFO]: 	compression ratio: 0.9993098088375842
2025-03-13 18:24:21,336 [INFO]: }
2025-03-13 18:24:21,336 [INFO]: 	>>> Finished "Creating the index" in 54.0597 secs
2025-03-13 18:24:21,336 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0908 secs
2025-03-13 18:24:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 73096 [episode count 11/20]
[retrieval_preprocessing] for episode 77203 [episode count 12/20], we have num_retrieval=np.int64(2731) num_query=np.int64(131)
2025-03-13 18:24:23,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:24,325 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:24
2025-03-13 18:24:24,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.01it/s]
2025-03-13 18:24:24,350 [INFO]: There are 2731 embeddings of dim 49152
2025-03-13 18:24:24,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 18:24:24,350 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:24
2025-03-13 18:24:24,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:24,350 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:24:24,350 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:24,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:24,351 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:24
2025-03-13 18:24:24,351 [INFO]: 563.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:24,351 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:24:24,351 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:24
2025-03-13 18:24:24,351 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:24,351 [INFO]: 	Creating the index 03/13/2025, 18:24:24
2025-03-13 18:24:24,351 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:24
2025-03-13 18:24:24,352 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:24:24,352 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:24
2025-03-13 18:24:24,352 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:24:24,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.80it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.13it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.00it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.28it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.53it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.63it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.62it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.81it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.03it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.32it/s]100%|██████████| 11/11 [00:03<00:00,  1.37it/s]100%|██████████| 11/11 [00:03<00:00,  3.21it/s]
2025-03-13 18:24:27,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:27
2025-03-13 18:24:55,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0336 secs
2025-03-13 18:24:55,822 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 18:24:55,822 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-13 18:25:15,477 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6552 secs
2025-03-13 18:25:15,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1276 secs
2025-03-13 18:25:15,480 [INFO]: {
2025-03-13 18:25:15,480 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:15,480 [INFO]: 	index_param: efSearch=302
2025-03-13 18:25:15,480 [INFO]: 	index_path: knn.index
2025-03-13 18:25:15,480 [INFO]: 	size in bytes: 537307270
2025-03-13 18:25:15,480 [INFO]: 	avg_search_speed_ms: 11.203200632209857
2025-03-13 18:25:15,480 [INFO]: 	99p_search_speed_ms: 19.01255050674081
2025-03-13 18:25:15,480 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:15,480 [INFO]: 	nb vectors: 2731
2025-03-13 18:25:15,480 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:15,480 [INFO]: 	compression ratio: 0.9993098511397398
2025-03-13 18:25:15,480 [INFO]: }
2025-03-13 18:25:15,480 [INFO]: 	>>> Finished "Creating the index" in 51.1290 secs
2025-03-13 18:25:15,480 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1547 secs
2025-03-13 18:25:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 77203 [episode count 12/20]
[retrieval_preprocessing] for episode 25499 [episode count 13/20], we have num_retrieval=np.int64(2725) num_query=np.int64(137)
2025-03-13 18:25:17,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:18,965 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:18
2025-03-13 18:25:18,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.16it/s]
2025-03-13 18:25:18,992 [INFO]: There are 2725 embeddings of dim 49152
2025-03-13 18:25:18,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 18:25:18,992 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:18
2025-03-13 18:25:18,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:18,992 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:25:18,992 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:18,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:18,992 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:18
2025-03-13 18:25:18,992 [INFO]: 562.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:18,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:25:18,993 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:18
2025-03-13 18:25:18,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:18,993 [INFO]: 	Creating the index 03/13/2025, 18:25:18
2025-03-13 18:25:18,993 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:18
2025-03-13 18:25:18,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:25:18,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:18
2025-03-13 18:25:18,994 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:25:18,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.71it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.67it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.46it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.46it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.31it/s] 73%|███████▎  | 8/11 [00:01<00:00,  6.72it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.10it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.25it/s]100%|██████████| 11/11 [00:03<00:00,  1.26it/s]100%|██████████| 11/11 [00:03<00:00,  2.93it/s]
2025-03-13 18:25:22,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:22
2025-03-13 18:25:58,394 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6428 secs
2025-03-13 18:25:58,394 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 18:25:58,395 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 18:26:31,718 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3230 secs
2025-03-13 18:26:31,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7268 secs
2025-03-13 18:26:31,721 [INFO]: {
2025-03-13 18:26:31,721 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:31,721 [INFO]: 	index_param: efSearch=249
2025-03-13 18:26:31,721 [INFO]: 	index_path: knn.index
2025-03-13 18:26:31,721 [INFO]: 	size in bytes: 536126830
2025-03-13 18:26:31,721 [INFO]: 	avg_search_speed_ms: 8.538568965028128
2025-03-13 18:26:31,721 [INFO]: 	99p_search_speed_ms: 13.254773151129477
2025-03-13 18:26:31,721 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:31,721 [INFO]: 	nb vectors: 2725
2025-03-13 18:26:31,721 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:31,721 [INFO]: 	compression ratio: 0.9993098088375842
2025-03-13 18:26:31,721 [INFO]: }
2025-03-13 18:26:31,721 [INFO]: 	>>> Finished "Creating the index" in 72.7283 secs
2025-03-13 18:26:31,721 [INFO]: >>> Finished "Launching the whole pipeline" in 72.7561 secs
2025-03-13 18:26:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 25499 [episode count 13/20]
[retrieval_preprocessing] for episode 77733 [episode count 14/20], we have num_retrieval=np.int64(2740) num_query=np.int64(122)
2025-03-13 18:26:33,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:34,505 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:34
2025-03-13 18:26:34,505 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-13 18:26:34,531 [INFO]: There are 2740 embeddings of dim 49152
2025-03-13 18:26:34,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:26:34,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:34,532 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:26:34,532 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:34,532 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:34,532 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,532 [INFO]: 565.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:34,532 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:34,532 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:34
2025-03-13 18:26:34,532 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:34,532 [INFO]: 	Creating the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,532 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:34
2025-03-13 18:26:34,533 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:26:34,533 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,533 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:26:34,533 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.62it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.81it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.74it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.07it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.11it/s]100%|██████████| 11/11 [00:03<00:00,  2.16it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 18:26:38,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:38
2025-03-13 18:27:12,039 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9106 secs
2025-03-13 18:27:12,040 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 18:27:12,040 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.33it/s]
2025-03-13 18:27:28,982 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9418 secs
2025-03-13 18:27:28,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4506 secs
2025-03-13 18:27:28,984 [INFO]: {
2025-03-13 18:27:28,984 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:28,984 [INFO]: 	index_param: efSearch=279
2025-03-13 18:27:28,984 [INFO]: 	index_path: knn.index
2025-03-13 18:27:28,984 [INFO]: 	size in bytes: 539077930
2025-03-13 18:27:28,984 [INFO]: 	avg_search_speed_ms: 11.312623643126694
2025-03-13 18:27:28,984 [INFO]: 	99p_search_speed_ms: 19.547194179613143
2025-03-13 18:27:28,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:28,984 [INFO]: 	nb vectors: 2740
2025-03-13 18:27:28,984 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:28,984 [INFO]: 	compression ratio: 0.9993099142456082
2025-03-13 18:27:28,984 [INFO]: }
2025-03-13 18:27:28,984 [INFO]: 	>>> Finished "Creating the index" in 54.4523 secs
2025-03-13 18:27:28,984 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4795 secs
2025-03-13 18:27:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 77733 [episode count 14/20]
[retrieval_preprocessing] for episode 76749 [episode count 15/20], we have num_retrieval=np.int64(2728) num_query=np.int64(134)
2025-03-13 18:27:32,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:33,154 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:33
2025-03-13 18:27:33,155 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 763.02it/s]
2025-03-13 18:27:33,187 [INFO]: There are 2728 embeddings of dim 49152
2025-03-13 18:27:33,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 18:27:33,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:33
2025-03-13 18:27:33,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:33,188 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:27:33,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:33,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:27:33,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:33
2025-03-13 18:27:33,188 [INFO]: 563.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:33,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:27:33,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:33
2025-03-13 18:27:33,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:33,189 [INFO]: 	Creating the index 03/13/2025, 18:27:33
2025-03-13 18:27:33,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:33
2025-03-13 18:27:33,192 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:27:33,192 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:33
2025-03-13 18:27:33,193 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:27:33,193 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.98it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.61it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.26it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.63it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.87it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.01it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.20it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.23it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.24it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.25it/s]100%|██████████| 11/11 [00:03<00:00,  1.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.29it/s]
2025-03-13 18:27:36,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:36
2025-03-13 18:28:11,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0247 secs
2025-03-13 18:28:11,574 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 18:28:11,575 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 18:28:29,918 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3425 secs
2025-03-13 18:28:29,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7273 secs
2025-03-13 18:28:29,920 [INFO]: {
2025-03-13 18:28:29,920 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:29,920 [INFO]: 	index_param: efSearch=278
2025-03-13 18:28:29,920 [INFO]: 	index_path: knn.index
2025-03-13 18:28:29,920 [INFO]: 	size in bytes: 536717050
2025-03-13 18:28:29,920 [INFO]: 	avg_search_speed_ms: 10.461645755160864
2025-03-13 18:28:29,920 [INFO]: 	99p_search_speed_ms: 18.74832855537535
2025-03-13 18:28:29,920 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:29,920 [INFO]: 	nb vectors: 2728
2025-03-13 18:28:29,920 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:29,920 [INFO]: 	compression ratio: 0.9993098300119215
2025-03-13 18:28:29,920 [INFO]: }
2025-03-13 18:28:29,920 [INFO]: 	>>> Finished "Creating the index" in 56.7315 secs
2025-03-13 18:28:29,920 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7658 secs
2025-03-13 18:28:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 76749 [episode count 15/20]
[retrieval_preprocessing] for episode 51664 [episode count 16/20], we have num_retrieval=np.int64(2744) num_query=np.int64(118)
2025-03-13 18:28:31,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:32,357 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:32
2025-03-13 18:28:32,357 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 18:28:32,382 [INFO]: There are 2744 embeddings of dim 49152
2025-03-13 18:28:32,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 18:28:32,383 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:32
2025-03-13 18:28:32,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:32,383 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:28:32,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:32,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:32,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:32
2025-03-13 18:28:32,383 [INFO]: 566.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:32,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:28:32,383 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:32
2025-03-13 18:28:32,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:32,383 [INFO]: 	Creating the index 03/13/2025, 18:28:32
2025-03-13 18:28:32,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:32
2025-03-13 18:28:32,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:28:32,384 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:32
2025-03-13 18:28:32,384 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:28:32,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.54it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.11it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.04it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.34it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.49it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.61it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.70it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.45it/s]100%|██████████| 11/11 [00:03<00:00,  1.93it/s]100%|██████████| 11/11 [00:03<00:00,  3.36it/s]
2025-03-13 18:28:35,664 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:35
2025-03-13 18:29:04,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6934 secs
2025-03-13 18:29:04,358 [INFO]: The best hyperparameters are: efSearch=320
2025-03-13 18:29:04,359 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.01it/s] 50%|█████     | 2/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 18:29:35,615 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2560 secs
2025-03-13 18:29:35,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2330 secs
2025-03-13 18:29:35,617 [INFO]: {
2025-03-13 18:29:35,618 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:35,618 [INFO]: 	index_param: efSearch=320
2025-03-13 18:29:35,618 [INFO]: 	index_path: knn.index
2025-03-13 18:29:35,618 [INFO]: 	size in bytes: 539864890
2025-03-13 18:29:35,618 [INFO]: 	avg_search_speed_ms: 10.175288874193617
2025-03-13 18:29:35,618 [INFO]: 	99p_search_speed_ms: 14.947794331237663
2025-03-13 18:29:35,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:35,618 [INFO]: 	nb vectors: 2744
2025-03-13 18:29:35,618 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:35,618 [INFO]: 	compression ratio: 0.9993099421597874
2025-03-13 18:29:35,618 [INFO]: }
2025-03-13 18:29:35,618 [INFO]: 	>>> Finished "Creating the index" in 63.2344 secs
2025-03-13 18:29:35,618 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2607 secs
2025-03-13 18:29:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 51664 [episode count 16/20]
[retrieval_preprocessing] for episode 57813 [episode count 17/20], we have num_retrieval=np.int64(2720) num_query=np.int64(142)
2025-03-13 18:29:39,045 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:39,502 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:39
2025-03-13 18:29:39,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1627.59it/s]
2025-03-13 18:29:39,536 [INFO]: There are 2720 embeddings of dim 49152
2025-03-13 18:29:39,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 18:29:39,537 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:39
2025-03-13 18:29:39,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:39,537 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:29:39,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:39,538 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:29:39,538 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:39
2025-03-13 18:29:39,538 [INFO]: 561.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:39,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:29:39,538 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:39
2025-03-13 18:29:39,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:39,538 [INFO]: 	Creating the index 03/13/2025, 18:29:39
2025-03-13 18:29:39,538 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:39
2025-03-13 18:29:39,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 18:29:39,541 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:39
2025-03-13 18:29:39,541 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:29:39,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.77it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.46it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.36it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.76it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.97it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.17it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.20it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.23it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.18it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.24it/s]100%|██████████| 11/11 [00:03<00:00,  1.23it/s]100%|██████████| 11/11 [00:03<00:00,  3.10it/s]
2025-03-13 18:29:43,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:43
2025-03-13 18:30:22,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6920 secs
2025-03-13 18:30:22,787 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 18:30:22,787 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.49it/s]
2025-03-13 18:30:39,570 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7825 secs
2025-03-13 18:30:39,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0313 secs
2025-03-13 18:30:39,572 [INFO]: {
2025-03-13 18:30:39,573 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:39,573 [INFO]: 	index_param: efSearch=266
2025-03-13 18:30:39,573 [INFO]: 	index_path: knn.index
2025-03-13 18:30:39,573 [INFO]: 	size in bytes: 535143130
2025-03-13 18:30:39,573 [INFO]: 	avg_search_speed_ms: 9.743442467539108
2025-03-13 18:30:39,573 [INFO]: 	99p_search_speed_ms: 13.204239192418754
2025-03-13 18:30:39,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:39,573 [INFO]: 	nb vectors: 2720
2025-03-13 18:30:39,573 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:39,573 [INFO]: 	compression ratio: 0.9993097734432281
2025-03-13 18:30:39,573 [INFO]: }
2025-03-13 18:30:39,573 [INFO]: 	>>> Finished "Creating the index" in 60.0343 secs
2025-03-13 18:30:39,573 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0707 secs
2025-03-13 18:30:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 57813 [episode count 17/20]
[retrieval_preprocessing] for episode 19931 [episode count 18/20], we have num_retrieval=np.int64(2656) num_query=np.int64(206)
2025-03-13 18:30:42,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:42,833 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:42
2025-03-13 18:30:42,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1284.23it/s]
2025-03-13 18:30:42,860 [INFO]: There are 2656 embeddings of dim 49152
2025-03-13 18:30:42,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:30:42,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:42
2025-03-13 18:30:42,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:42,861 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:30:42,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:42,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:30:42,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:42
2025-03-13 18:30:42,861 [INFO]: 548.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:42,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:30:42,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:42
2025-03-13 18:30:42,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:42,862 [INFO]: 	Creating the index 03/13/2025, 18:30:42
2025-03-13 18:30:42,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:42
2025-03-13 18:30:42,865 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:30:42,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:42
2025-03-13 18:30:42,866 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:30:42,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.59it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.68it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.32it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.77it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.60it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.15it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]
2025-03-13 18:30:45,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:45
2025-03-13 18:31:15,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2492 secs
2025-03-13 18:31:15,197 [INFO]: The best hyperparameters are: efSearch=323
2025-03-13 18:31:15,197 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-13 18:31:38,633 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4361 secs
2025-03-13 18:31:38,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7697 secs
2025-03-13 18:31:38,635 [INFO]: {
2025-03-13 18:31:38,635 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:38,636 [INFO]: 	index_param: efSearch=323
2025-03-13 18:31:38,636 [INFO]: 	index_path: knn.index
2025-03-13 18:31:38,636 [INFO]: 	size in bytes: 522551650
2025-03-13 18:31:38,636 [INFO]: 	avg_search_speed_ms: 10.684648087660138
2025-03-13 18:31:38,636 [INFO]: 	99p_search_speed_ms: 16.13553955685347
2025-03-13 18:31:38,636 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:38,636 [INFO]: 	nb vectors: 2656
2025-03-13 18:31:38,636 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:38,636 [INFO]: 	compression ratio: 0.9993095381097734
2025-03-13 18:31:38,636 [INFO]: }
2025-03-13 18:31:38,636 [INFO]: 	>>> Finished "Creating the index" in 55.7733 secs
2025-03-13 18:31:38,636 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8021 secs
2025-03-13 18:31:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 19931 [episode count 18/20]
[retrieval_preprocessing] for episode 8676 [episode count 19/20], we have num_retrieval=np.int64(2695) num_query=np.int64(167)
2025-03-13 18:31:42,399 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:42,876 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:42
2025-03-13 18:31:42,877 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2291.97it/s]
2025-03-13 18:31:42,901 [INFO]: There are 2695 embeddings of dim 49152
2025-03-13 18:31:42,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:31:42,902 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:42
2025-03-13 18:31:42,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:42,902 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:31:42,902 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:42,902 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:31:42,902 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:42
2025-03-13 18:31:42,903 [INFO]: 556.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:42,903 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:31:42,903 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:42
2025-03-13 18:31:42,903 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:42,903 [INFO]: 	Creating the index 03/13/2025, 18:31:42
2025-03-13 18:31:42,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:42
2025-03-13 18:31:42,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 18:31:42,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:42
2025-03-13 18:31:42,907 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:31:42,907 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.53it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.64it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.16it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.62it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.53it/s]100%|██████████| 11/11 [00:02<00:00,  2.46it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]
2025-03-13 18:31:45,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:45
2025-03-13 18:32:21,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6272 secs
2025-03-13 18:32:21,335 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 18:32:21,335 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 18:32:47,550 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2149 secs
2025-03-13 18:32:47,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6459 secs
2025-03-13 18:32:47,553 [INFO]: {
2025-03-13 18:32:47,553 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:47,553 [INFO]: 	index_param: efSearch=252
2025-03-13 18:32:47,553 [INFO]: 	index_path: knn.index
2025-03-13 18:32:47,553 [INFO]: 	size in bytes: 530224510
2025-03-13 18:32:47,553 [INFO]: 	avg_search_speed_ms: 9.237066505086416
2025-03-13 18:32:47,553 [INFO]: 	99p_search_speed_ms: 16.12007160671063
2025-03-13 18:32:47,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:47,553 [INFO]: 	nb vectors: 2695
2025-03-13 18:32:47,553 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:47,553 [INFO]: 	compression ratio: 0.9993098206644577
2025-03-13 18:32:47,553 [INFO]: }
2025-03-13 18:32:47,553 [INFO]: 	>>> Finished "Creating the index" in 64.6492 secs
2025-03-13 18:32:47,553 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6762 secs
2025-03-13 18:32:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 8676 [episode count 19/20]
2025-03-13 18:32:49: [retrieval_preprocessing] finished for 8911427557_put_rubber_band_around_brown_cup [chosen_id count 6/196]
2025-03-13 18:32:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8911427557_put_rubber_band_on_jar [chosen_id count 7/196]
2025-03-13 18:32:51: [retrieval_preprocessing] we have num_total=2809 embedding_dim=49152
[retrieval_preprocessing] for episode 37922 [episode count 0/20], we have num_retrieval=np.int64(2679) num_query=np.int64(130)
2025-03-13 18:32:52,424 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:52,936 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:52
2025-03-13 18:32:52,936 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.55it/s]
2025-03-13 18:32:52,965 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 18:32:52,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:32:52,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:52
2025-03-13 18:32:52,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:52,966 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:32:52,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:52,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:32:52,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:52
2025-03-13 18:32:52,967 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:52,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:32:52,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:52
2025-03-13 18:32:52,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:52,968 [INFO]: 	Creating the index 03/13/2025, 18:32:52
2025-03-13 18:32:52,968 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:52
2025-03-13 18:32:52,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:32:52,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:52
2025-03-13 18:32:52,971 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:32:52,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.37it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.04it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.71it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.38it/s]100%|██████████| 11/11 [00:02<00:00,  3.75it/s]
2025-03-13 18:32:55,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:55
2025-03-13 18:33:28,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7704 secs
2025-03-13 18:33:28,685 [INFO]: The best hyperparameters are: efSearch=319
2025-03-13 18:33:28,685 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 18:33:51,437 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7524 secs
2025-03-13 18:33:51,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0121 secs
2025-03-13 18:33:51,984 [INFO]: {
2025-03-13 18:33:51,984 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:51,984 [INFO]: 	index_param: efSearch=319
2025-03-13 18:33:51,984 [INFO]: 	index_path: knn.index
2025-03-13 18:33:51,984 [INFO]: 	size in bytes: 527076670
2025-03-13 18:33:51,984 [INFO]: 	avg_search_speed_ms: 9.717968950524158
2025-03-13 18:33:51,984 [INFO]: 	99p_search_speed_ms: 15.660632457584143
2025-03-13 18:33:51,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:51,984 [INFO]: 	nb vectors: 2679
2025-03-13 18:33:51,984 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:51,984 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 18:33:51,984 [INFO]: }
2025-03-13 18:33:51,984 [INFO]: 	>>> Finished "Creating the index" in 59.0165 secs
2025-03-13 18:33:51,984 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0479 secs
2025-03-13 18:33:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 37922 [episode count 0/20]
[retrieval_preprocessing] for episode 43111 [episode count 1/20], we have num_retrieval=np.int64(2671) num_query=np.int64(138)
2025-03-13 18:33:54,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:54,600 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:54
2025-03-13 18:33:54,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2232.20it/s]
2025-03-13 18:33:54,624 [INFO]: There are 2671 embeddings of dim 49152
2025-03-13 18:33:54,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 18:33:54,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:54
2025-03-13 18:33:54,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:54,624 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:33:54,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:54,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:33:54,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:54
2025-03-13 18:33:54,624 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:54,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:33:54,624 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:54
2025-03-13 18:33:54,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:54,624 [INFO]: 	Creating the index 03/13/2025, 18:33:54
2025-03-13 18:33:54,624 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:54
2025-03-13 18:33:54,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:33:54,625 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:54
2025-03-13 18:33:54,625 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:33:54,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.47it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.79it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.87it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.21it/s] 91%|█████████ | 10/11 [00:00<00:00, 13.69it/s]100%|██████████| 11/11 [00:02<00:00,  4.32it/s]
2025-03-13 18:33:57,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:57
2025-03-13 18:34:27,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9990 secs
2025-03-13 18:34:27,173 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 18:34:27,173 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.91it/s] 50%|█████     | 2/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 18:34:48,497 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3241 secs
2025-03-13 18:34:48,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8749 secs
2025-03-13 18:34:48,500 [INFO]: {
2025-03-13 18:34:48,500 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:48,500 [INFO]: 	index_param: efSearch=282
2025-03-13 18:34:48,500 [INFO]: 	index_path: knn.index
2025-03-13 18:34:48,500 [INFO]: 	size in bytes: 525502750
2025-03-13 18:34:48,501 [INFO]: 	avg_search_speed_ms: 12.312644844865565
2025-03-13 18:34:48,501 [INFO]: 	99p_search_speed_ms: 23.175952353049063
2025-03-13 18:34:48,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:48,501 [INFO]: 	nb vectors: 2671
2025-03-13 18:34:48,501 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:48,501 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-13 18:34:48,501 [INFO]: }
2025-03-13 18:34:48,501 [INFO]: 	>>> Finished "Creating the index" in 53.8765 secs
2025-03-13 18:34:48,501 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9003 secs
2025-03-13 18:34:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 43111 [episode count 1/20]
[retrieval_preprocessing] for episode 74366 [episode count 2/20], we have num_retrieval=np.int64(2663) num_query=np.int64(146)
2025-03-13 18:34:51,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:52,173 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:52
2025-03-13 18:34:52,173 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 670.23it/s]
2025-03-13 18:34:52,206 [INFO]: There are 2663 embeddings of dim 49152
2025-03-13 18:34:52,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 18:34:52,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:52
2025-03-13 18:34:52,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:52,207 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:34:52,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:52,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:34:52,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:52
2025-03-13 18:34:52,207 [INFO]: 549.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:52,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:34:52,208 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:52
2025-03-13 18:34:52,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:52,208 [INFO]: 	Creating the index 03/13/2025, 18:34:52
2025-03-13 18:34:52,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:52
2025-03-13 18:34:52,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:34:52,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:52
2025-03-13 18:34:52,212 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:34:52,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.91it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.23it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.76it/s] 36%|███▋      | 4/11 [00:00<00:01,  6.91it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.04it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.06it/s] 64%|██████▎   | 7/11 [00:01<00:00,  7.24it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.46it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.56it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.78it/s]100%|██████████| 11/11 [00:03<00:00,  1.44it/s]100%|██████████| 11/11 [00:03<00:00,  3.27it/s]
2025-03-13 18:34:55,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:55
2025-03-13 18:35:23,918 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3397 secs
2025-03-13 18:35:23,918 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:35:23,919 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.95it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 18:35:45,622 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7036 secs
2025-03-13 18:35:45,624 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4125 secs
2025-03-13 18:35:45,625 [INFO]: {
2025-03-13 18:35:45,625 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:45,625 [INFO]: 	index_param: efSearch=268
2025-03-13 18:35:45,625 [INFO]: 	index_path: knn.index
2025-03-13 18:35:45,625 [INFO]: 	size in bytes: 523928830
2025-03-13 18:35:45,625 [INFO]: 	avg_search_speed_ms: 8.880171891331646
2025-03-13 18:35:45,625 [INFO]: 	99p_search_speed_ms: 14.685831498354673
2025-03-13 18:35:45,625 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:45,625 [INFO]: 	nb vectors: 2663
2025-03-13 18:35:45,625 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:45,625 [INFO]: 	compression ratio: 0.9993095894341222
2025-03-13 18:35:45,625 [INFO]: }
2025-03-13 18:35:45,625 [INFO]: 	>>> Finished "Creating the index" in 53.4163 secs
2025-03-13 18:35:45,625 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4515 secs
2025-03-13 18:35:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 74366 [episode count 2/20]
[retrieval_preprocessing] for episode 9915 [episode count 3/20], we have num_retrieval=np.int64(2680) num_query=np.int64(129)
2025-03-13 18:35:47,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:48,293 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:48
2025-03-13 18:35:48,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.94it/s]
2025-03-13 18:35:48,321 [INFO]: There are 2680 embeddings of dim 49152
2025-03-13 18:35:48,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 18:35:48,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:48
2025-03-13 18:35:48,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:48,322 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:35:48,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:48,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:35:48,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:48
2025-03-13 18:35:48,323 [INFO]: 553.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:48,323 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:35:48,323 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:48
2025-03-13 18:35:48,323 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:48,323 [INFO]: 	Creating the index 03/13/2025, 18:35:48
2025-03-13 18:35:48,323 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:48
2025-03-13 18:35:48,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:35:48,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:48
2025-03-13 18:35:48,327 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:35:48,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.18it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.21it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.96it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.75it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.63it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.45it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.33it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.20it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.09it/s]100%|██████████| 11/11 [00:03<00:00,  1.33it/s]100%|██████████| 11/11 [00:03<00:00,  3.19it/s]
2025-03-13 18:35:51,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:51
2025-03-13 18:36:19,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4618 secs
2025-03-13 18:36:19,239 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:36:19,239 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 18:36:38,327 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0878 secs
2025-03-13 18:36:38,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0027 secs
2025-03-13 18:36:38,330 [INFO]: {
2025-03-13 18:36:38,330 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:38,330 [INFO]: 	index_param: efSearch=227
2025-03-13 18:36:38,330 [INFO]: 	index_path: knn.index
2025-03-13 18:36:38,330 [INFO]: 	size in bytes: 527273410
2025-03-13 18:36:38,330 [INFO]: 	avg_search_speed_ms: 8.603005963301579
2025-03-13 18:36:38,330 [INFO]: 	99p_search_speed_ms: 13.083653263747687
2025-03-13 18:36:38,330 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:38,330 [INFO]: 	nb vectors: 2680
2025-03-13 18:36:38,330 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:38,330 [INFO]: 	compression ratio: 0.9993097129627683
2025-03-13 18:36:38,330 [INFO]: }
2025-03-13 18:36:38,330 [INFO]: 	>>> Finished "Creating the index" in 50.0067 secs
2025-03-13 18:36:38,330 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0374 secs
2025-03-13 18:36:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 9915 [episode count 3/20]
[retrieval_preprocessing] for episode 75973 [episode count 4/20], we have num_retrieval=np.int64(2689) num_query=np.int64(120)
2025-03-13 18:36:41,258 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:41,784 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:41
2025-03-13 18:36:41,784 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.04it/s]
2025-03-13 18:36:41,812 [INFO]: There are 2689 embeddings of dim 49152
2025-03-13 18:36:41,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 18:36:41,812 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:41
2025-03-13 18:36:41,812 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:41,812 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:36:41,812 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:41,812 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:36:41,812 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:41
2025-03-13 18:36:41,812 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:41,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:36:41,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:41
2025-03-13 18:36:41,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:41,813 [INFO]: 	Creating the index 03/13/2025, 18:36:41
2025-03-13 18:36:41,813 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:41
2025-03-13 18:36:41,814 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:36:41,814 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:41
2025-03-13 18:36:41,814 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:36:41,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.15it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.43it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.01it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.37it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.82it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.88it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.89it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.91it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.96it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.29it/s]100%|██████████| 11/11 [00:03<00:00,  1.44it/s]100%|██████████| 11/11 [00:03<00:00,  3.34it/s]
2025-03-13 18:36:45,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:45
2025-03-13 18:37:16,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7294 secs
2025-03-13 18:37:16,844 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 18:37:16,844 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 18:37:34,629 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7855 secs
2025-03-13 18:37:34,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8186 secs
2025-03-13 18:37:34,633 [INFO]: {
2025-03-13 18:37:34,633 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:34,633 [INFO]: 	index_param: efSearch=252
2025-03-13 18:37:34,633 [INFO]: 	index_path: knn.index
2025-03-13 18:37:34,633 [INFO]: 	size in bytes: 529044070
2025-03-13 18:37:34,633 [INFO]: 	avg_search_speed_ms: 11.03637435305946
2025-03-13 18:37:34,633 [INFO]: 	99p_search_speed_ms: 16.164272266905765
2025-03-13 18:37:34,633 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:34,633 [INFO]: 	nb vectors: 2689
2025-03-13 18:37:34,633 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:34,633 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-13 18:37:34,633 [INFO]: }
2025-03-13 18:37:34,633 [INFO]: 	>>> Finished "Creating the index" in 52.8203 secs
2025-03-13 18:37:34,633 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8492 secs
2025-03-13 18:37:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 75973 [episode count 4/20]
[retrieval_preprocessing] for episode 67274 [episode count 5/20], we have num_retrieval=np.int64(2642) num_query=np.int64(167)
2025-03-13 18:37:36,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:37,356 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:37
2025-03-13 18:37:37,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1913.46it/s]
2025-03-13 18:37:37,382 [INFO]: There are 2642 embeddings of dim 49152
2025-03-13 18:37:37,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:37:37,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:37
2025-03-13 18:37:37,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:37,383 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:37:37,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:37,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:37:37,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:37
2025-03-13 18:37:37,383 [INFO]: 545.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:37,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:37:37,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:37
2025-03-13 18:37:37,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:37,384 [INFO]: 	Creating the index 03/13/2025, 18:37:37
2025-03-13 18:37:37,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:37
2025-03-13 18:37:37,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:37:37,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:37
2025-03-13 18:37:37,387 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:37:37,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.53it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.24it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.97it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.26it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.22it/s]100%|██████████| 11/11 [00:02<00:00,  2.52it/s]100%|██████████| 11/11 [00:02<00:00,  3.90it/s]
2025-03-13 18:37:40,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:40
2025-03-13 18:38:07,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5506 secs
2025-03-13 18:38:07,763 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 18:38:07,763 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s]
2025-03-13 18:38:36,525 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7612 secs
2025-03-13 18:38:36,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1395 secs
2025-03-13 18:38:36,527 [INFO]: {
2025-03-13 18:38:36,527 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:36,527 [INFO]: 	index_param: efSearch=328
2025-03-13 18:38:36,527 [INFO]: 	index_path: knn.index
2025-03-13 18:38:36,527 [INFO]: 	size in bytes: 519797290
2025-03-13 18:38:36,527 [INFO]: 	avg_search_speed_ms: 10.79702439097402
2025-03-13 18:38:36,527 [INFO]: 	99p_search_speed_ms: 17.861073662061244
2025-03-13 18:38:36,527 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:36,527 [INFO]: 	nb vectors: 2642
2025-03-13 18:38:36,527 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:36,527 [INFO]: 	compression ratio: 0.9993094346451864
2025-03-13 18:38:36,527 [INFO]: }
2025-03-13 18:38:36,527 [INFO]: 	>>> Finished "Creating the index" in 59.1432 secs
2025-03-13 18:38:36,527 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1709 secs
2025-03-13 18:38:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 67274 [episode count 5/20]
[retrieval_preprocessing] for episode 27851 [episode count 6/20], we have num_retrieval=np.int64(2661) num_query=np.int64(148)
2025-03-13 18:38:38,883 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:39,252 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:39
2025-03-13 18:38:39,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.15it/s]
2025-03-13 18:38:39,281 [INFO]: There are 2661 embeddings of dim 49152
2025-03-13 18:38:39,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:38:39,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:39
2025-03-13 18:38:39,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:39,282 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:38:39,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:39,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:38:39,283 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:39
2025-03-13 18:38:39,283 [INFO]: 549.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:39,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:38:39,284 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:39
2025-03-13 18:38:39,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:39,284 [INFO]: 	Creating the index 03/13/2025, 18:38:39
2025-03-13 18:38:39,284 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:39
2025-03-13 18:38:39,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:38:39,287 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:39
2025-03-13 18:38:39,288 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:38:39,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.18it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.61it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.66it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.11it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.10it/s]100%|██████████| 11/11 [00:02<00:00,  2.68it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]
2025-03-13 18:38:41,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:41
2025-03-13 18:39:08,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7533 secs
2025-03-13 18:39:08,698 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 18:39:08,698 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.65it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 18:39:28,204 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5056 secs
2025-03-13 18:39:28,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1410 secs
2025-03-13 18:39:28,430 [INFO]: {
2025-03-13 18:39:28,430 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:28,430 [INFO]: 	index_param: efSearch=317
2025-03-13 18:39:28,431 [INFO]: 	index_path: knn.index
2025-03-13 18:39:28,431 [INFO]: 	size in bytes: 523535350
2025-03-13 18:39:28,431 [INFO]: 	avg_search_speed_ms: 12.180306587139105
2025-03-13 18:39:28,431 [INFO]: 	99p_search_speed_ms: 19.448521593585603
2025-03-13 18:39:28,431 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:28,431 [INFO]: 	nb vectors: 2661
2025-03-13 18:39:28,431 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:28,431 [INFO]: 	compression ratio: 0.9993095747975758
2025-03-13 18:39:28,431 [INFO]: }
2025-03-13 18:39:28,431 [INFO]: 	>>> Finished "Creating the index" in 49.1473 secs
2025-03-13 18:39:28,431 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1790 secs
2025-03-13 18:39:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 27851 [episode count 6/20]
[retrieval_preprocessing] for episode 84712 [episode count 7/20], we have num_retrieval=np.int64(2667) num_query=np.int64(142)
2025-03-13 18:39:30,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:31,223 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:31
2025-03-13 18:39:31,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.83it/s]
2025-03-13 18:39:31,251 [INFO]: There are 2667 embeddings of dim 49152
2025-03-13 18:39:31,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:39:31,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:31
2025-03-13 18:39:31,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:31,252 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:39:31,252 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:31,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:39:31,252 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:31
2025-03-13 18:39:31,252 [INFO]: 550.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:31,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:39:31,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:31
2025-03-13 18:39:31,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:31,253 [INFO]: 	Creating the index 03/13/2025, 18:39:31
2025-03-13 18:39:31,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:31
2025-03-13 18:39:31,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:39:31,256 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:31
2025-03-13 18:39:31,256 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:39:31,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.84it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.50it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.07it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.50it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.67it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.00it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.96it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.06it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.17it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.12it/s]100%|██████████| 11/11 [00:02<00:00,  1.60it/s]100%|██████████| 11/11 [00:02<00:00,  3.73it/s]
2025-03-13 18:39:34,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:34
2025-03-13 18:40:04,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1976 secs
2025-03-13 18:40:04,410 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 18:40:04,410 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 18:40:25,148 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7383 secs
2025-03-13 18:40:25,150 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8936 secs
2025-03-13 18:40:25,150 [INFO]: {
2025-03-13 18:40:25,150 [INFO]: 	index_key: HNSW15
2025-03-13 18:40:25,150 [INFO]: 	index_param: efSearch=272
2025-03-13 18:40:25,150 [INFO]: 	index_path: knn.index
2025-03-13 18:40:25,150 [INFO]: 	size in bytes: 524715790
2025-03-13 18:40:25,150 [INFO]: 	avg_search_speed_ms: 9.270883741874016
2025-03-13 18:40:25,150 [INFO]: 	99p_search_speed_ms: 12.872465481050313
2025-03-13 18:40:25,150 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:40:25,150 [INFO]: 	nb vectors: 2667
2025-03-13 18:40:25,150 [INFO]: 	vectors dimension: 49152
2025-03-13 18:40:25,150 [INFO]: 	compression ratio: 0.9993096186413601
2025-03-13 18:40:25,150 [INFO]: }
2025-03-13 18:40:25,150 [INFO]: 	>>> Finished "Creating the index" in 53.8971 secs
2025-03-13 18:40:25,150 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9267 secs
2025-03-13 18:40:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:40:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 84712 [episode count 7/20]
[retrieval_preprocessing] for episode 46318 [episode count 8/20], we have num_retrieval=np.int64(2642) num_query=np.int64(167)
2025-03-13 18:40:27,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:40:27,655 [INFO]: Launching the whole pipeline 03/13/2025, 18:40:27
2025-03-13 18:40:27,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:40:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2137.77it/s]
2025-03-13 18:40:27,677 [INFO]: There are 2642 embeddings of dim 49152
2025-03-13 18:40:27,677 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 18:40:27,677 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:40:27
2025-03-13 18:40:27,677 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:40:27,677 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:40:27,677 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:40:27,677 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:40:27,678 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:40:27
2025-03-13 18:40:27,678 [INFO]: 545.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:40:27,678 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:40:27,678 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:40:27
2025-03-13 18:40:27,678 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:40:27,678 [INFO]: 	Creating the index 03/13/2025, 18:40:27
2025-03-13 18:40:27,678 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:40:27
2025-03-13 18:40:27,679 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:40:27,679 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:40:27
2025-03-13 18:40:27,679 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:40:27,679 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.74it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.24it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.43it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.06it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.49it/s]100%|██████████| 11/11 [00:02<00:00,  2.74it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]
2025-03-13 18:40:30,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:40:30
2025-03-13 18:40:56,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6509 secs
2025-03-13 18:40:56,940 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 18:40:56,940 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 18:41:18,071 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1315 secs
2025-03-13 18:41:18,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3942 secs
2025-03-13 18:41:18,073 [INFO]: {
2025-03-13 18:41:18,073 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:18,073 [INFO]: 	index_param: efSearch=294
2025-03-13 18:41:18,073 [INFO]: 	index_path: knn.index
2025-03-13 18:41:18,073 [INFO]: 	size in bytes: 519797290
2025-03-13 18:41:18,073 [INFO]: 	avg_search_speed_ms: 9.234172383638052
2025-03-13 18:41:18,073 [INFO]: 	99p_search_speed_ms: 13.26950031798333
2025-03-13 18:41:18,073 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:18,073 [INFO]: 	nb vectors: 2642
2025-03-13 18:41:18,073 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:18,073 [INFO]: 	compression ratio: 0.9993094346451864
2025-03-13 18:41:18,073 [INFO]: }
2025-03-13 18:41:18,074 [INFO]: 	>>> Finished "Creating the index" in 50.3956 secs
2025-03-13 18:41:18,074 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4187 secs
2025-03-13 18:41:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 46318 [episode count 8/20]
[retrieval_preprocessing] for episode 76037 [episode count 9/20], we have num_retrieval=np.int64(2666) num_query=np.int64(143)
2025-03-13 18:41:19,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:20,361 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:20
2025-03-13 18:41:20,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2199.43it/s]
2025-03-13 18:41:20,384 [INFO]: There are 2666 embeddings of dim 49152
2025-03-13 18:41:20,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 18:41:20,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:20
2025-03-13 18:41:20,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:20,384 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:41:20,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:20,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:20,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:20
2025-03-13 18:41:20,384 [INFO]: 550.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:20,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:20,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:20
2025-03-13 18:41:20,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:20,384 [INFO]: 	Creating the index 03/13/2025, 18:41:20
2025-03-13 18:41:20,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:20
2025-03-13 18:41:20,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:41:20,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:20
2025-03-13 18:41:20,385 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:41:20,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.57it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.75it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.68it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.21it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.49it/s]100%|██████████| 11/11 [00:02<00:00,  2.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.49it/s]
2025-03-13 18:41:22,835 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:22
2025-03-13 18:41:52,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0748 secs
2025-03-13 18:41:52,911 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 18:41:52,911 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.25it/s] 50%|█████     | 2/4 [00:00<00:00,  4.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-13 18:42:15,144 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2333 secs
2025-03-13 18:42:15,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0431 secs
2025-03-13 18:42:15,430 [INFO]: {
2025-03-13 18:42:15,430 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:15,430 [INFO]: 	index_param: efSearch=303
2025-03-13 18:42:15,430 [INFO]: 	index_path: knn.index
2025-03-13 18:42:15,430 [INFO]: 	size in bytes: 524519050
2025-03-13 18:42:15,430 [INFO]: 	avg_search_speed_ms: 10.154970547865112
2025-03-13 18:42:15,430 [INFO]: 	99p_search_speed_ms: 13.783857282251116
2025-03-13 18:42:15,430 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:15,430 [INFO]: 	nb vectors: 2666
2025-03-13 18:42:15,430 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:15,430 [INFO]: 	compression ratio: 0.9993096113477671
2025-03-13 18:42:15,430 [INFO]: }
2025-03-13 18:42:15,430 [INFO]: 	>>> Finished "Creating the index" in 55.0460 secs
2025-03-13 18:42:15,430 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0689 secs
2025-03-13 18:42:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 76037 [episode count 9/20]
[retrieval_preprocessing] for episode 30470 [episode count 10/20], we have num_retrieval=np.int64(2684) num_query=np.int64(125)
2025-03-13 18:42:18,086 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:18,536 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:18
2025-03-13 18:42:18,537 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2278.27it/s]
2025-03-13 18:42:18,560 [INFO]: There are 2684 embeddings of dim 49152
2025-03-13 18:42:18,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 18:42:18,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:18
2025-03-13 18:42:18,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:18,561 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:42:18,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:18,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:18,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:18
2025-03-13 18:42:18,561 [INFO]: 553.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:18,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:42:18,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:18
2025-03-13 18:42:18,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:18,561 [INFO]: 	Creating the index 03/13/2025, 18:42:18
2025-03-13 18:42:18,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:18
2025-03-13 18:42:18,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:42:18,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:18
2025-03-13 18:42:18,562 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:42:18,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.95it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.50it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.16it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.63it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.82it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.95it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.08it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.16it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.20it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.34it/s]100%|██████████| 11/11 [00:03<00:00,  1.64it/s]100%|██████████| 11/11 [00:03<00:00,  3.66it/s]
2025-03-13 18:42:21,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:21
2025-03-13 18:42:51,131 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5602 secs
2025-03-13 18:42:51,131 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 18:42:51,131 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s]
2025-03-13 18:43:12,572 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4408 secs
2025-03-13 18:43:12,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0120 secs
2025-03-13 18:43:12,574 [INFO]: {
2025-03-13 18:43:12,574 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:12,574 [INFO]: 	index_param: efSearch=286
2025-03-13 18:43:12,574 [INFO]: 	index_path: knn.index
2025-03-13 18:43:12,574 [INFO]: 	size in bytes: 528060370
2025-03-13 18:43:12,574 [INFO]: 	avg_search_speed_ms: 8.908124759798257
2025-03-13 18:43:12,574 [INFO]: 	99p_search_speed_ms: 12.299496387131512
2025-03-13 18:43:12,574 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:12,574 [INFO]: 	nb vectors: 2684
2025-03-13 18:43:12,574 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:12,574 [INFO]: 	compression ratio: 0.9993097418009232
2025-03-13 18:43:12,574 [INFO]: }
2025-03-13 18:43:12,574 [INFO]: 	>>> Finished "Creating the index" in 54.0134 secs
2025-03-13 18:43:12,574 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0378 secs
2025-03-13 18:43:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 30470 [episode count 10/20]
[retrieval_preprocessing] for episode 84227 [episode count 11/20], we have num_retrieval=np.int64(2690) num_query=np.int64(119)
2025-03-13 18:43:14,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:15,053 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:15
2025-03-13 18:43:15,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.58it/s]
2025-03-13 18:43:15,078 [INFO]: There are 2690 embeddings of dim 49152
2025-03-13 18:43:15,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 18:43:15,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:15
2025-03-13 18:43:15,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:15,078 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:43:15,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:15,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:43:15,078 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:15
2025-03-13 18:43:15,078 [INFO]: 555.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:15,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:15,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:15
2025-03-13 18:43:15,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:15,079 [INFO]: 	Creating the index 03/13/2025, 18:43:15
2025-03-13 18:43:15,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:15
2025-03-13 18:43:15,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:43:15,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:15
2025-03-13 18:43:15,080 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:43:15,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.90it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.14it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.39it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.85it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.11it/s]100%|██████████| 11/11 [00:02<00:00,  2.32it/s]100%|██████████| 11/11 [00:02<00:00,  3.68it/s]
2025-03-13 18:43:18,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:18
2025-03-13 18:43:48,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0948 secs
2025-03-13 18:43:48,171 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 18:43:48,171 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 18:44:05,872 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7005 secs
2025-03-13 18:44:05,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7940 secs
2025-03-13 18:44:05,874 [INFO]: {
2025-03-13 18:44:05,874 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:05,874 [INFO]: 	index_param: efSearch=147
2025-03-13 18:44:05,874 [INFO]: 	index_path: knn.index
2025-03-13 18:44:05,874 [INFO]: 	size in bytes: 529240810
2025-03-13 18:44:05,874 [INFO]: 	avg_search_speed_ms: 6.596711100303497
2025-03-13 18:44:05,874 [INFO]: 	99p_search_speed_ms: 11.242604954168193
2025-03-13 18:44:05,874 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:05,874 [INFO]: 	nb vectors: 2690
2025-03-13 18:44:05,874 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:05,874 [INFO]: 	compression ratio: 0.9993097848973513
2025-03-13 18:44:05,874 [INFO]: }
2025-03-13 18:44:05,874 [INFO]: 	>>> Finished "Creating the index" in 50.7956 secs
2025-03-13 18:44:05,874 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8207 secs
2025-03-13 18:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 84227 [episode count 11/20]
[retrieval_preprocessing] for episode 30991 [episode count 12/20], we have num_retrieval=np.int64(2662) num_query=np.int64(147)
2025-03-13 18:44:07,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:08,083 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:08
2025-03-13 18:44:08,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.07it/s]
2025-03-13 18:44:08,109 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 18:44:08,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:44:08,109 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:08
2025-03-13 18:44:08,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:08,110 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:44:08,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:08,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:44:08,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:08
2025-03-13 18:44:08,110 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:08,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:44:08,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:08
2025-03-13 18:44:08,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:08,110 [INFO]: 	Creating the index 03/13/2025, 18:44:08
2025-03-13 18:44:08,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:08
2025-03-13 18:44:08,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:44:08,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:08
2025-03-13 18:44:08,112 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:44:08,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:03,  2.83it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.51it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.42it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.54it/s] 82%|████████▏ | 9/11 [00:01<00:00, 10.33it/s]100%|██████████| 11/11 [00:02<00:00,  2.75it/s]100%|██████████| 11/11 [00:02<00:00,  3.99it/s]
2025-03-13 18:44:11,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:11
2025-03-13 18:44:41,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1332 secs
2025-03-13 18:44:41,551 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 18:44:41,551 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
2025-03-13 18:45:09,178 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6268 secs
2025-03-13 18:45:09,180 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0684 secs
2025-03-13 18:45:09,181 [INFO]: {
2025-03-13 18:45:09,181 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:09,181 [INFO]: 	index_param: efSearch=291
2025-03-13 18:45:09,181 [INFO]: 	index_path: knn.index
2025-03-13 18:45:09,181 [INFO]: 	size in bytes: 523732090
2025-03-13 18:45:09,181 [INFO]: 	avg_search_speed_ms: 9.172509427378895
2025-03-13 18:45:09,181 [INFO]: 	99p_search_speed_ms: 17.03451727284117
2025-03-13 18:45:09,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:09,181 [INFO]: 	nb vectors: 2662
2025-03-13 18:45:09,181 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:09,181 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 18:45:09,181 [INFO]: }
2025-03-13 18:45:09,181 [INFO]: 	>>> Finished "Creating the index" in 61.0706 secs
2025-03-13 18:45:09,181 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0979 secs
2025-03-13 18:45:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 30991 [episode count 12/20]
[retrieval_preprocessing] for episode 23348 [episode count 13/20], we have num_retrieval=np.int64(2664) num_query=np.int64(145)
2025-03-13 18:45:12,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:14,168 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:14
2025-03-13 18:45:14,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1640.32it/s]
2025-03-13 18:45:14,194 [INFO]: There are 2664 embeddings of dim 49152
2025-03-13 18:45:14,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:45:14,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:14,195 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:45:14,195 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:14,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:14,195 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,195 [INFO]: 549.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:14,195 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:45:14,195 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:14
2025-03-13 18:45:14,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:14,195 [INFO]: 	Creating the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,195 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:14
2025-03-13 18:45:14,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:45:14,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:14
2025-03-13 18:45:14,196 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:45:14,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.62it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.86it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.26it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.00it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.11it/s]100%|██████████| 11/11 [00:02<00:00,  2.48it/s]100%|██████████| 11/11 [00:02<00:00,  4.00it/s]
2025-03-13 18:45:16,951 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:16
2025-03-13 18:45:45,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2197 secs
2025-03-13 18:45:45,172 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 18:45:45,172 [INFO]: 	Compute fast metrics 03/13/2025, 18:45:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-13 18:46:05,626 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4540 secs
2025-03-13 18:46:05,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4314 secs
2025-03-13 18:46:05,628 [INFO]: {
2025-03-13 18:46:05,628 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:05,628 [INFO]: 	index_param: efSearch=283
2025-03-13 18:46:05,628 [INFO]: 	index_path: knn.index
2025-03-13 18:46:05,628 [INFO]: 	size in bytes: 524125570
2025-03-13 18:46:05,628 [INFO]: 	avg_search_speed_ms: 10.55118372886862
2025-03-13 18:46:05,628 [INFO]: 	99p_search_speed_ms: 19.437749886419578
2025-03-13 18:46:05,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:05,628 [INFO]: 	nb vectors: 2664
2025-03-13 18:46:05,628 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:05,628 [INFO]: 	compression ratio: 0.9993095967441543
2025-03-13 18:46:05,628 [INFO]: }
2025-03-13 18:46:05,628 [INFO]: 	>>> Finished "Creating the index" in 51.4330 secs
2025-03-13 18:46:05,628 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4600 secs
2025-03-13 18:46:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 23348 [episode count 13/20]
[retrieval_preprocessing] for episode 61236 [episode count 14/20], we have num_retrieval=np.int64(2660) num_query=np.int64(149)
2025-03-13 18:46:07,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:08,512 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:08
2025-03-13 18:46:08,513 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1922.23it/s]
2025-03-13 18:46:08,540 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 18:46:08,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 18:46:08,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:08
2025-03-13 18:46:08,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:08,541 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:46:08,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:08,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:46:08,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:08
2025-03-13 18:46:08,542 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:08,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:46:08,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:08
2025-03-13 18:46:08,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:08,543 [INFO]: 	Creating the index 03/13/2025, 18:46:08
2025-03-13 18:46:08,543 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:08
2025-03-13 18:46:08,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:46:08,547 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:08
2025-03-13 18:46:08,547 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:46:08,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.56it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.19it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.71it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.24it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.53it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.66it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.67it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.74it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.57it/s]100%|██████████| 11/11 [00:03<00:00,  1.50it/s]100%|██████████| 11/11 [00:03<00:00,  3.16it/s]
2025-03-13 18:46:12,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:12
2025-03-13 18:46:38,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4210 secs
2025-03-13 18:46:38,457 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 18:46:38,457 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 18:47:02,081 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6236 secs
2025-03-13 18:47:02,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5362 secs
2025-03-13 18:47:02,083 [INFO]: {
2025-03-13 18:47:02,083 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:02,083 [INFO]: 	index_param: efSearch=303
2025-03-13 18:47:02,083 [INFO]: 	index_path: knn.index
2025-03-13 18:47:02,083 [INFO]: 	size in bytes: 523338610
2025-03-13 18:47:02,083 [INFO]: 	avg_search_speed_ms: 9.737198753418454
2025-03-13 18:47:02,083 [INFO]: 	99p_search_speed_ms: 13.997592572122812
2025-03-13 18:47:02,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:02,083 [INFO]: 	nb vectors: 2660
2025-03-13 18:47:02,083 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:02,083 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 18:47:02,083 [INFO]: }
2025-03-13 18:47:02,083 [INFO]: 	>>> Finished "Creating the index" in 53.5402 secs
2025-03-13 18:47:02,083 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5705 secs
2025-03-13 18:47:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 61236 [episode count 14/20]
[retrieval_preprocessing] for episode 6988 [episode count 15/20], we have num_retrieval=np.int64(2686) num_query=np.int64(123)
2025-03-13 18:47:04,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:04,907 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:04
2025-03-13 18:47:04,907 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1893.59it/s]
2025-03-13 18:47:04,934 [INFO]: There are 2686 embeddings of dim 49152
2025-03-13 18:47:04,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 18:47:04,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:04,935 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:47:04,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:04,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:47:04,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,935 [INFO]: 554.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:04,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:47:04,936 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:04
2025-03-13 18:47:04,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:04,936 [INFO]: 	Creating the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:04
2025-03-13 18:47:04,939 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:47:04,939 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:04
2025-03-13 18:47:04,940 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:47:04,940 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.12it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.84it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.53it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.84it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.01it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.11it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.14it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.19it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.17it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.14it/s]100%|██████████| 11/11 [00:03<00:00,  1.35it/s]100%|██████████| 11/11 [00:03<00:00,  3.22it/s]
2025-03-13 18:47:08,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:08
2025-03-13 18:47:37,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6855 secs
2025-03-13 18:47:37,051 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 18:47:37,051 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 18:47:58,495 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4441 secs
2025-03-13 18:47:58,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5584 secs
2025-03-13 18:47:58,498 [INFO]: {
2025-03-13 18:47:58,498 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:58,498 [INFO]: 	index_param: efSearch=248
2025-03-13 18:47:58,498 [INFO]: 	index_path: knn.index
2025-03-13 18:47:58,498 [INFO]: 	size in bytes: 528453850
2025-03-13 18:47:58,498 [INFO]: 	avg_search_speed_ms: 9.441051622272255
2025-03-13 18:47:58,498 [INFO]: 	99p_search_speed_ms: 16.11474269535393
2025-03-13 18:47:58,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:58,498 [INFO]: 	nb vectors: 2686
2025-03-13 18:47:58,498 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:58,498 [INFO]: 	compression ratio: 0.9993097561877919
2025-03-13 18:47:58,498 [INFO]: }
2025-03-13 18:47:58,498 [INFO]: 	>>> Finished "Creating the index" in 53.5623 secs
2025-03-13 18:47:58,498 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5910 secs
2025-03-13 18:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 6988 [episode count 15/20]
[retrieval_preprocessing] for episode 66395 [episode count 16/20], we have num_retrieval=np.int64(2660) num_query=np.int64(149)
2025-03-13 18:48:01,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:01,861 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:01
2025-03-13 18:48:01,861 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 806.75it/s]
2025-03-13 18:48:01,900 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 18:48:01,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-13 18:48:01,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:01,901 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:48:01,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:01,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:48:01,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,901 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:01,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:48:01,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:01
2025-03-13 18:48:01,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:01,902 [INFO]: 	Creating the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:01
2025-03-13 18:48:01,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:48:01,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:01
2025-03-13 18:48:01,906 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:48:01,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.86it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.97it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.12it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.12it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.29it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.60it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.73it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.93it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.01it/s]100%|██████████| 11/11 [00:03<00:00,  1.58it/s]100%|██████████| 11/11 [00:03<00:00,  3.65it/s]
2025-03-13 18:48:04,926 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:04
2025-03-13 18:48:34,947 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0206 secs
2025-03-13 18:48:34,947 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 18:48:34,947 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-13 18:48:58,083 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1360 secs
2025-03-13 18:48:58,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3545 secs
2025-03-13 18:48:58,261 [INFO]: {
2025-03-13 18:48:58,261 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:58,261 [INFO]: 	index_param: efSearch=242
2025-03-13 18:48:58,261 [INFO]: 	index_path: knn.index
2025-03-13 18:48:58,261 [INFO]: 	size in bytes: 523338610
2025-03-13 18:48:58,261 [INFO]: 	avg_search_speed_ms: 8.117404065998997
2025-03-13 18:48:58,261 [INFO]: 	99p_search_speed_ms: 11.235995809547605
2025-03-13 18:48:58,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:58,261 [INFO]: 	nb vectors: 2660
2025-03-13 18:48:58,261 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:58,261 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 18:48:58,262 [INFO]: }
2025-03-13 18:48:58,262 [INFO]: 	>>> Finished "Creating the index" in 56.3594 secs
2025-03-13 18:48:58,262 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4008 secs
2025-03-13 18:48:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 66395 [episode count 16/20]
[retrieval_preprocessing] for episode 77151 [episode count 17/20], we have num_retrieval=np.int64(2668) num_query=np.int64(141)
2025-03-13 18:49:00,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:00,803 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:00
2025-03-13 18:49:00,803 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1122.07it/s]
2025-03-13 18:49:00,830 [INFO]: There are 2668 embeddings of dim 49152
2025-03-13 18:49:00,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:49:00,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:00
2025-03-13 18:49:00,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:00,830 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:49:00,830 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:00,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:49:00,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:00
2025-03-13 18:49:00,830 [INFO]: 550.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:00,830 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:49:00,830 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:00
2025-03-13 18:49:00,830 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:00,830 [INFO]: 	Creating the index 03/13/2025, 18:49:00
2025-03-13 18:49:00,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:00
2025-03-13 18:49:00,831 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:49:00,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:00
2025-03-13 18:49:00,832 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:49:00,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.54it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.12it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.60it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.33it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.63it/s]100%|██████████| 11/11 [00:02<00:00,  2.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.28it/s]
2025-03-13 18:49:03,404 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:03
2025-03-13 18:49:30,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4556 secs
2025-03-13 18:49:30,860 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 18:49:30,861 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s]
2025-03-13 18:49:57,761 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9000 secs
2025-03-13 18:49:57,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9311 secs
2025-03-13 18:49:57,763 [INFO]: {
2025-03-13 18:49:57,763 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:57,763 [INFO]: 	index_param: efSearch=315
2025-03-13 18:49:57,763 [INFO]: 	index_path: knn.index
2025-03-13 18:49:57,763 [INFO]: 	size in bytes: 524912530
2025-03-13 18:49:57,763 [INFO]: 	avg_search_speed_ms: 10.482368094600597
2025-03-13 18:49:57,763 [INFO]: 	99p_search_speed_ms: 13.968458296731114
2025-03-13 18:49:57,763 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:57,763 [INFO]: 	nb vectors: 2668
2025-03-13 18:49:57,763 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:57,763 [INFO]: 	compression ratio: 0.9993096259294858
2025-03-13 18:49:57,763 [INFO]: }
2025-03-13 18:49:57,763 [INFO]: 	>>> Finished "Creating the index" in 56.9326 secs
2025-03-13 18:49:57,763 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9597 secs
2025-03-13 18:49:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 77151 [episode count 17/20]
[retrieval_preprocessing] for episode 60782 [episode count 18/20], we have num_retrieval=np.int64(2689) num_query=np.int64(120)
2025-03-13 18:50:00,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:00,604 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:00
2025-03-13 18:50:00,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.56it/s]
2025-03-13 18:50:00,629 [INFO]: There are 2689 embeddings of dim 49152
2025-03-13 18:50:00,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:50:00,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:00
2025-03-13 18:50:00,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:00,629 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:50:00,629 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:00,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:00,629 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:00
2025-03-13 18:50:00,629 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:00,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:50:00,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:00
2025-03-13 18:50:00,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:00,629 [INFO]: 	Creating the index 03/13/2025, 18:50:00
2025-03-13 18:50:00,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:00
2025-03-13 18:50:00,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:50:00,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:00
2025-03-13 18:50:00,631 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:50:00,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.03it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.96it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.81it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.74it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.71it/s]100%|██████████| 11/11 [00:03<00:00,  2.27it/s]100%|██████████| 11/11 [00:03<00:00,  3.59it/s]
2025-03-13 18:50:03,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:03
2025-03-13 18:50:31,713 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0174 secs
2025-03-13 18:50:31,713 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 18:50:31,713 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 18:50:51,801 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0878 secs
2025-03-13 18:50:51,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1725 secs
2025-03-13 18:50:51,803 [INFO]: {
2025-03-13 18:50:51,803 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:51,803 [INFO]: 	index_param: efSearch=295
2025-03-13 18:50:51,803 [INFO]: 	index_path: knn.index
2025-03-13 18:50:51,803 [INFO]: 	size in bytes: 529044070
2025-03-13 18:50:51,803 [INFO]: 	avg_search_speed_ms: 9.26287420098325
2025-03-13 18:50:51,803 [INFO]: 	99p_search_speed_ms: 12.699501607567072
2025-03-13 18:50:51,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:51,803 [INFO]: 	nb vectors: 2689
2025-03-13 18:50:51,803 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:51,803 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-13 18:50:51,803 [INFO]: }
2025-03-13 18:50:51,803 [INFO]: 	>>> Finished "Creating the index" in 51.1738 secs
2025-03-13 18:50:51,803 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1996 secs
2025-03-13 18:50:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 60782 [episode count 18/20]
[retrieval_preprocessing] for episode 26073 [episode count 19/20], we have num_retrieval=np.int64(2648) num_query=np.int64(161)
2025-03-13 18:50:55,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:55,554 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:55
2025-03-13 18:50:55,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1975.65it/s]
2025-03-13 18:50:55,577 [INFO]: There are 2648 embeddings of dim 49152
2025-03-13 18:50:55,577 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 18:50:55,577 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:55
2025-03-13 18:50:55,577 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:55,577 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:50:55,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:55,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:55,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:55
2025-03-13 18:50:55,577 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:55,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:50:55,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:55
2025-03-13 18:50:55,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:55,577 [INFO]: 	Creating the index 03/13/2025, 18:50:55
2025-03-13 18:50:55,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:55
2025-03-13 18:50:55,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:50:55,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:55
2025-03-13 18:50:55,578 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:50:55,579 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.33it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.61it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.62it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.56it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.50it/s]100%|██████████| 11/11 [00:02<00:00,  2.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.95it/s]
2025-03-13 18:50:58,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:58
2025-03-13 18:51:24,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2725 secs
2025-03-13 18:51:24,637 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 18:51:24,637 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-13 18:51:42,069 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4317 secs
2025-03-13 18:51:42,071 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4922 secs
2025-03-13 18:51:42,071 [INFO]: {
2025-03-13 18:51:42,071 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:42,071 [INFO]: 	index_param: efSearch=279
2025-03-13 18:51:42,071 [INFO]: 	index_path: knn.index
2025-03-13 18:51:42,071 [INFO]: 	size in bytes: 520977730
2025-03-13 18:51:42,071 [INFO]: 	avg_search_speed_ms: 9.566597398325943
2025-03-13 18:51:42,071 [INFO]: 	99p_search_speed_ms: 16.213050736114372
2025-03-13 18:51:42,071 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:42,071 [INFO]: 	nb vectors: 2648
2025-03-13 18:51:42,071 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:42,071 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-13 18:51:42,071 [INFO]: }
2025-03-13 18:51:42,071 [INFO]: 	>>> Finished "Creating the index" in 46.4936 secs
2025-03-13 18:51:42,071 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5170 secs
2025-03-13 18:51:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 26073 [episode count 19/20]
2025-03-13 18:51:43: [retrieval_preprocessing] finished for 8911427557_put_rubber_band_on_jar [chosen_id count 7/196]
2025-03-13 18:51:45: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8911427557_put_elastic_around_bottle [chosen_id count 8/196]
2025-03-13 18:51:45: [retrieval_preprocessing] we have num_total=2756 embedding_dim=49152
[retrieval_preprocessing] for episode 58 [episode count 0/20], we have num_retrieval=np.int64(2625) num_query=np.int64(131)
2025-03-13 18:51:46,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:46,849 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:46
2025-03-13 18:51:46,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.16it/s]
2025-03-13 18:51:46,873 [INFO]: There are 2625 embeddings of dim 49152
2025-03-13 18:51:46,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:51:46,873 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:46
2025-03-13 18:51:46,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:46,873 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:51:46,873 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:46,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:51:46,873 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:46
2025-03-13 18:51:46,873 [INFO]: 541.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:46,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:51:46,873 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:46
2025-03-13 18:51:46,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:46,873 [INFO]: 	Creating the index 03/13/2025, 18:51:46
2025-03-13 18:51:46,873 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:46
2025-03-13 18:51:46,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:51:46,874 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:46
2025-03-13 18:51:46,874 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:51:46,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.39it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.53it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.88it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.62it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.81it/s]100%|██████████| 11/11 [00:02<00:00,  2.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]
2025-03-13 18:51:49,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:49
2025-03-13 18:52:19,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7232 secs
2025-03-13 18:52:19,249 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 18:52:19,249 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 18:52:41,261 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0122 secs
2025-03-13 18:52:41,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3895 secs
2025-03-13 18:52:41,264 [INFO]: {
2025-03-13 18:52:41,264 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:41,264 [INFO]: 	index_param: efSearch=308
2025-03-13 18:52:41,264 [INFO]: 	index_path: knn.index
2025-03-13 18:52:41,264 [INFO]: 	size in bytes: 516452650
2025-03-13 18:52:41,264 [INFO]: 	avg_search_speed_ms: 10.270521278278922
2025-03-13 18:52:41,264 [INFO]: 	99p_search_speed_ms: 16.211816400755186
2025-03-13 18:52:41,264 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:41,264 [INFO]: 	nb vectors: 2625
2025-03-13 18:52:41,264 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:41,264 [INFO]: 	compression ratio: 0.9993094236228626
2025-03-13 18:52:41,264 [INFO]: }
2025-03-13 18:52:41,264 [INFO]: 	>>> Finished "Creating the index" in 54.3909 secs
2025-03-13 18:52:41,264 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4152 secs
2025-03-13 18:52:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 58 [episode count 0/20]
[retrieval_preprocessing] for episode 32839 [episode count 1/20], we have num_retrieval=np.int64(2649) num_query=np.int64(107)
2025-03-13 18:52:44,069 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:44,441 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:44
2025-03-13 18:52:44,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1726.76it/s]
2025-03-13 18:52:44,466 [INFO]: There are 2649 embeddings of dim 49152
2025-03-13 18:52:44,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:52:44,466 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:44
2025-03-13 18:52:44,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:44,466 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:52:44,466 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:44,466 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:44,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:44
2025-03-13 18:52:44,466 [INFO]: 546.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:44,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:52:44,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:44
2025-03-13 18:52:44,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:44,466 [INFO]: 	Creating the index 03/13/2025, 18:52:44
2025-03-13 18:52:44,466 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:44
2025-03-13 18:52:44,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:52:44,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:44
2025-03-13 18:52:44,468 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:52:44,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.37it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.13it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.27it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.69it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.97it/s]100%|██████████| 11/11 [00:02<00:00,  2.53it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]
2025-03-13 18:52:47,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:47
2025-03-13 18:53:17,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6581 secs
2025-03-13 18:53:17,871 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 18:53:17,871 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 18:53:34,490 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6194 secs
2025-03-13 18:53:34,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0253 secs
2025-03-13 18:53:34,493 [INFO]: {
2025-03-13 18:53:34,493 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:34,493 [INFO]: 	index_param: efSearch=288
2025-03-13 18:53:34,493 [INFO]: 	index_path: knn.index
2025-03-13 18:53:34,493 [INFO]: 	size in bytes: 521174470
2025-03-13 18:53:34,493 [INFO]: 	avg_search_speed_ms: 10.608039855362486
2025-03-13 18:53:34,493 [INFO]: 	99p_search_speed_ms: 16.085397633723918
2025-03-13 18:53:34,493 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:34,493 [INFO]: 	nb vectors: 2649
2025-03-13 18:53:34,493 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:34,493 [INFO]: 	compression ratio: 0.9993094865141802
2025-03-13 18:53:34,493 [INFO]: }
2025-03-13 18:53:34,493 [INFO]: 	>>> Finished "Creating the index" in 50.0268 secs
2025-03-13 18:53:34,493 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0523 secs
2025-03-13 18:53:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 32839 [episode count 1/20]
[retrieval_preprocessing] for episode 39019 [episode count 2/20], we have num_retrieval=np.int64(2619) num_query=np.int64(137)
2025-03-13 18:53:36,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:36,635 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:36
2025-03-13 18:53:36,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.65it/s]
2025-03-13 18:53:36,659 [INFO]: There are 2619 embeddings of dim 49152
2025-03-13 18:53:36,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:53:36,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:36
2025-03-13 18:53:36,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:36,659 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:53:36,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:36,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:53:36,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:36
2025-03-13 18:53:36,660 [INFO]: 540.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:36,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:53:36,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:36
2025-03-13 18:53:36,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:36,660 [INFO]: 	Creating the index 03/13/2025, 18:53:36
2025-03-13 18:53:36,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:36
2025-03-13 18:53:36,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:53:36,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:36
2025-03-13 18:53:36,661 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:53:36,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.27it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.90it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.77it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.13it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.34it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.49it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.56it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.72it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.73it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.78it/s]100%|██████████| 11/11 [00:02<00:00,  1.68it/s]100%|██████████| 11/11 [00:02<00:00,  3.79it/s]
2025-03-13 18:53:39,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:39
2025-03-13 18:54:06,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1032 secs
2025-03-13 18:54:06,668 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 18:54:06,668 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 18:54:27,652 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9840 secs
2025-03-13 18:54:28,291 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6304 secs
2025-03-13 18:54:28,292 [INFO]: {
2025-03-13 18:54:28,292 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:28,292 [INFO]: 	index_param: efSearch=287
2025-03-13 18:54:28,292 [INFO]: 	index_path: knn.index
2025-03-13 18:54:28,292 [INFO]: 	size in bytes: 515272210
2025-03-13 18:54:28,292 [INFO]: 	avg_search_speed_ms: 10.020468128100411
2025-03-13 18:54:28,292 [INFO]: 	99p_search_speed_ms: 13.447527864482252
2025-03-13 18:54:28,292 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:28,292 [INFO]: 	nb vectors: 2619
2025-03-13 18:54:28,292 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:28,293 [INFO]: 	compression ratio: 0.9993093786292103
2025-03-13 18:54:28,293 [INFO]: }
2025-03-13 18:54:28,293 [INFO]: 	>>> Finished "Creating the index" in 51.6329 secs
2025-03-13 18:54:28,293 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6573 secs
2025-03-13 18:54:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 39019 [episode count 2/20]
[retrieval_preprocessing] for episode 54916 [episode count 3/20], we have num_retrieval=np.int64(2603) num_query=np.int64(153)
2025-03-13 18:54:30,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:30,979 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:30
2025-03-13 18:54:30,979 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.98it/s]
2025-03-13 18:54:31,008 [INFO]: There are 2603 embeddings of dim 49152
2025-03-13 18:54:31,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:54:31,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:31
2025-03-13 18:54:31,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:31,009 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:54:31,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:31,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:54:31,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:31
2025-03-13 18:54:31,009 [INFO]: 537.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:31,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:54:31,010 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:31
2025-03-13 18:54:31,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:31,010 [INFO]: 	Creating the index 03/13/2025, 18:54:31
2025-03-13 18:54:31,010 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:31
2025-03-13 18:54:31,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:54:31,013 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:31
2025-03-13 18:54:31,014 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:54:31,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.49it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.91it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.56it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.92it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.13it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.50it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.53it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.58it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.66it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.91it/s]100%|██████████| 11/11 [00:02<00:00,  1.64it/s]100%|██████████| 11/11 [00:02<00:00,  3.73it/s]
2025-03-13 18:54:33,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:33
2025-03-13 18:55:06,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2358 secs
2025-03-13 18:55:06,202 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 18:55:06,202 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 18:55:24,235 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0326 secs
2025-03-13 18:55:24,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2235 secs
2025-03-13 18:55:24,237 [INFO]: {
2025-03-13 18:55:24,237 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:24,237 [INFO]: 	index_param: efSearch=256
2025-03-13 18:55:24,237 [INFO]: 	index_path: knn.index
2025-03-13 18:55:24,237 [INFO]: 	size in bytes: 512124250
2025-03-13 18:55:24,237 [INFO]: 	avg_search_speed_ms: 10.345264106811696
2025-03-13 18:55:24,237 [INFO]: 	99p_search_speed_ms: 18.2463772688061
2025-03-13 18:55:24,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:24,237 [INFO]: 	nb vectors: 2603
2025-03-13 18:55:24,237 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:24,237 [INFO]: 	compression ratio: 0.9993094917883697
2025-03-13 18:55:24,237 [INFO]: }
2025-03-13 18:55:24,237 [INFO]: 	>>> Finished "Creating the index" in 53.2274 secs
2025-03-13 18:55:24,237 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2586 secs
2025-03-13 18:55:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 54916 [episode count 3/20]
[retrieval_preprocessing] for episode 5772 [episode count 4/20], we have num_retrieval=np.int64(2623) num_query=np.int64(133)
2025-03-13 18:55:27,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:28,676 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:28
2025-03-13 18:55:28,677 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1950.84it/s]
2025-03-13 18:55:28,703 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 18:55:28,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:55:28,703 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:28
2025-03-13 18:55:28,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:28,703 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:55:28,703 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:28,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:55:28,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:28
2025-03-13 18:55:28,703 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:28,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:55:28,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:28
2025-03-13 18:55:28,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:28,703 [INFO]: 	Creating the index 03/13/2025, 18:55:28
2025-03-13 18:55:28,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:28
2025-03-13 18:55:28,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:55:28,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:28
2025-03-13 18:55:28,705 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:55:28,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.91it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.66it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.53it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.79it/s] 91%|█████████ | 10/11 [00:00<00:00, 14.20it/s]100%|██████████| 11/11 [00:02<00:00,  4.30it/s]
2025-03-13 18:55:31,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:31
2025-03-13 18:55:59,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7740 secs
2025-03-13 18:55:59,043 [INFO]: The best hyperparameters are: efSearch=316
2025-03-13 18:55:59,043 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s]
2025-03-13 18:56:20,586 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5429 secs
2025-03-13 18:56:20,588 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8833 secs
2025-03-13 18:56:20,589 [INFO]: {
2025-03-13 18:56:20,589 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:20,589 [INFO]: 	index_param: efSearch=316
2025-03-13 18:56:20,589 [INFO]: 	index_path: knn.index
2025-03-13 18:56:20,589 [INFO]: 	size in bytes: 516059170
2025-03-13 18:56:20,589 [INFO]: 	avg_search_speed_ms: 9.978463863507805
2025-03-13 18:56:20,589 [INFO]: 	99p_search_speed_ms: 15.312731666490436
2025-03-13 18:56:20,589 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:20,589 [INFO]: 	nb vectors: 2623
2025-03-13 18:56:20,589 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:20,589 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 18:56:20,589 [INFO]: }
2025-03-13 18:56:20,589 [INFO]: 	>>> Finished "Creating the index" in 51.8854 secs
2025-03-13 18:56:20,589 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9124 secs
2025-03-13 18:56:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 5772 [episode count 4/20]
[retrieval_preprocessing] for episode 35500 [episode count 5/20], we have num_retrieval=np.int64(2613) num_query=np.int64(143)
2025-03-13 18:56:23,307 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:23,774 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:23
2025-03-13 18:56:23,774 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2187.95it/s]
2025-03-13 18:56:23,799 [INFO]: There are 2613 embeddings of dim 49152
2025-03-13 18:56:23,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 18:56:23,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:23
2025-03-13 18:56:23,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:23,799 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:56:23,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:23,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:23,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:23
2025-03-13 18:56:23,799 [INFO]: 539.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:23,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:56:23,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:23
2025-03-13 18:56:23,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:23,799 [INFO]: 	Creating the index 03/13/2025, 18:56:23
2025-03-13 18:56:23,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:23
2025-03-13 18:56:23,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:56:23,801 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:23
2025-03-13 18:56:23,801 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:56:23,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.95it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.31it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.38it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.14it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.54it/s]100%|██████████| 11/11 [00:02<00:00,  2.53it/s]100%|██████████| 11/11 [00:02<00:00,  3.96it/s]
2025-03-13 18:56:27,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:27
2025-03-13 18:56:55,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8566 secs
2025-03-13 18:56:55,860 [INFO]: The best hyperparameters are: efSearch=304
2025-03-13 18:56:55,860 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 18:57:15,658 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7980 secs
2025-03-13 18:57:15,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8599 secs
2025-03-13 18:57:15,661 [INFO]: {
2025-03-13 18:57:15,661 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:15,661 [INFO]: 	index_param: efSearch=304
2025-03-13 18:57:15,661 [INFO]: 	index_path: knn.index
2025-03-13 18:57:15,661 [INFO]: 	size in bytes: 514091710
2025-03-13 18:57:15,661 [INFO]: 	avg_search_speed_ms: 9.523470584037048
2025-03-13 18:57:15,661 [INFO]: 	99p_search_speed_ms: 13.444127747789024
2025-03-13 18:57:15,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:15,661 [INFO]: 	nb vectors: 2613
2025-03-13 18:57:15,661 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:15,661 [INFO]: 	compression ratio: 0.9993094500590177
2025-03-13 18:57:15,661 [INFO]: }
2025-03-13 18:57:15,661 [INFO]: 	>>> Finished "Creating the index" in 51.8615 secs
2025-03-13 18:57:15,661 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8866 secs
2025-03-13 18:57:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 35500 [episode count 5/20]
[retrieval_preprocessing] for episode 39599 [episode count 6/20], we have num_retrieval=np.int64(2574) num_query=np.int64(182)
2025-03-13 18:57:18,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:19,148 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:19
2025-03-13 18:57:19,148 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 18:57:19,173 [INFO]: There are 2574 embeddings of dim 49152
2025-03-13 18:57:19,173 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 18:57:19,173 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:19
2025-03-13 18:57:19,173 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:19,173 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:57:19,173 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:19,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:57:19,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:19
2025-03-13 18:57:19,173 [INFO]: 531.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:19,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:57:19,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:19
2025-03-13 18:57:19,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:57:19,174 [INFO]: 	Creating the index 03/13/2025, 18:57:19
2025-03-13 18:57:19,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:19
2025-03-13 18:57:19,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:57:19,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:19
2025-03-13 18:57:19,175 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:57:19,175 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.60it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.20it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.89it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.31it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.48it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.56it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.61it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.64it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.78it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.77it/s]100%|██████████| 11/11 [00:02<00:00,  1.73it/s]100%|██████████| 11/11 [00:02<00:00,  3.89it/s]
2025-03-13 18:57:22,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:22
2025-03-13 18:57:47,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1451 secs
2025-03-13 18:57:47,609 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 18:57:47,609 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 18:58:06,658 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0490 secs
2025-03-13 18:58:06,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4854 secs
2025-03-13 18:58:06,660 [INFO]: {
2025-03-13 18:58:06,660 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:06,660 [INFO]: 	index_param: efSearch=314
2025-03-13 18:58:06,660 [INFO]: 	index_path: knn.index
2025-03-13 18:58:06,661 [INFO]: 	size in bytes: 506418610
2025-03-13 18:58:06,661 [INFO]: 	avg_search_speed_ms: 10.152643109402302
2025-03-13 18:58:06,661 [INFO]: 	99p_search_speed_ms: 14.395530074834822
2025-03-13 18:58:06,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:06,661 [INFO]: 	nb vectors: 2574
2025-03-13 18:58:06,661 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:06,661 [INFO]: 	compression ratio: 0.9993096264767996
2025-03-13 18:58:06,661 [INFO]: }
2025-03-13 18:58:06,661 [INFO]: 	>>> Finished "Creating the index" in 47.4870 secs
2025-03-13 18:58:06,661 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5123 secs
2025-03-13 18:58:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 39599 [episode count 6/20]
[retrieval_preprocessing] for episode 69330 [episode count 7/20], we have num_retrieval=np.int64(2660) num_query=np.int64(96)
2025-03-13 18:58:09,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:09,573 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:09
2025-03-13 18:58:09,573 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.17it/s]
2025-03-13 18:58:09,602 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 18:58:09,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 18:58:09,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:09
2025-03-13 18:58:09,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:09,602 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:58:09,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:09,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:58:09,603 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:09
2025-03-13 18:58:09,603 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:09,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:58:09,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:09
2025-03-13 18:58:09,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:09,603 [INFO]: 	Creating the index 03/13/2025, 18:58:09
2025-03-13 18:58:09,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:09
2025-03-13 18:58:09,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:58:09,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:09
2025-03-13 18:58:09,604 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:58:09,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.50it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.16it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.11it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.69it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.94it/s]100%|██████████| 11/11 [00:02<00:00,  2.73it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]
2025-03-13 18:58:12,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:12
2025-03-13 18:58:38,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6106 secs
2025-03-13 18:58:38,844 [INFO]: The best hyperparameters are: efSearch=373
2025-03-13 18:58:38,844 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 18:59:02,885 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0413 secs
2025-03-13 18:59:02,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2826 secs
2025-03-13 18:59:02,887 [INFO]: {
2025-03-13 18:59:02,887 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:02,887 [INFO]: 	index_param: efSearch=373
2025-03-13 18:59:02,887 [INFO]: 	index_path: knn.index
2025-03-13 18:59:02,887 [INFO]: 	size in bytes: 523338610
2025-03-13 18:59:02,887 [INFO]: 	avg_search_speed_ms: 10.928106619187636
2025-03-13 18:59:02,887 [INFO]: 	99p_search_speed_ms: 14.573262138292193
2025-03-13 18:59:02,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:02,887 [INFO]: 	nb vectors: 2660
2025-03-13 18:59:02,887 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:02,887 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 18:59:02,887 [INFO]: }
2025-03-13 18:59:02,887 [INFO]: 	>>> Finished "Creating the index" in 53.2840 secs
2025-03-13 18:59:02,887 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3141 secs
2025-03-13 18:59:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 69330 [episode count 7/20]
[retrieval_preprocessing] for episode 94443 [episode count 8/20], we have num_retrieval=np.int64(2575) num_query=np.int64(181)
2025-03-13 18:59:05,161 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:05,656 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:05
2025-03-13 18:59:05,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.00it/s]
2025-03-13 18:59:05,679 [INFO]: There are 2575 embeddings of dim 49152
2025-03-13 18:59:05,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:59:05,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:05
2025-03-13 18:59:05,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:05,679 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:59:05,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:05,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:05,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:05
2025-03-13 18:59:05,680 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:05,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:59:05,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:05
2025-03-13 18:59:05,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:05,680 [INFO]: 	Creating the index 03/13/2025, 18:59:05
2025-03-13 18:59:05,680 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:05
2025-03-13 18:59:05,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:59:05,681 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:05
2025-03-13 18:59:05,681 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:59:05,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.28it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.28it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.23it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.08it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.66it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.29it/s]100%|██████████| 11/11 [00:02<00:00,  2.66it/s]100%|██████████| 11/11 [00:02<00:00,  4.05it/s]
2025-03-13 18:59:08,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:08
2025-03-13 18:59:34,126 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7262 secs
2025-03-13 18:59:34,126 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 18:59:34,126 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-13 19:00:02,668 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5420 secs
2025-03-13 19:00:03,778 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0975 secs
2025-03-13 19:00:03,778 [INFO]: {
2025-03-13 19:00:03,779 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:03,779 [INFO]: 	index_param: efSearch=305
2025-03-13 19:00:03,779 [INFO]: 	index_path: knn.index
2025-03-13 19:00:03,779 [INFO]: 	size in bytes: 506615410
2025-03-13 19:00:03,779 [INFO]: 	avg_search_speed_ms: 8.871416809630663
2025-03-13 19:00:03,779 [INFO]: 	99p_search_speed_ms: 14.845475601032376
2025-03-13 19:00:03,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:03,779 [INFO]: 	nb vectors: 2575
2025-03-13 19:00:03,779 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:03,779 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-13 19:00:03,779 [INFO]: }
2025-03-13 19:00:03,779 [INFO]: 	>>> Finished "Creating the index" in 58.0995 secs
2025-03-13 19:00:03,779 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1236 secs
2025-03-13 19:00:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 94443 [episode count 8/20]
[retrieval_preprocessing] for episode 68865 [episode count 9/20], we have num_retrieval=np.int64(2597) num_query=np.int64(159)
2025-03-13 19:00:06,045 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:06,372 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:06
2025-03-13 19:00:06,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1516.38it/s]
2025-03-13 19:00:06,396 [INFO]: There are 2597 embeddings of dim 49152
2025-03-13 19:00:06,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 19:00:06,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:06
2025-03-13 19:00:06,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:06,396 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:00:06,396 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:06,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:06,396 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:06
2025-03-13 19:00:06,396 [INFO]: 536.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:06,396 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:00:06,396 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:06
2025-03-13 19:00:06,396 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:06,396 [INFO]: 	Creating the index 03/13/2025, 19:00:06
2025-03-13 19:00:06,396 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:06
2025-03-13 19:00:06,397 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:00:06,397 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:06
2025-03-13 19:00:06,397 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:00:06,397 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.03it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.06it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.00it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.47it/s]100%|██████████| 11/11 [00:02<00:00,  2.74it/s]100%|██████████| 11/11 [00:02<00:00,  4.28it/s]
2025-03-13 19:00:08,970 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:08
2025-03-13 19:00:40,082 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1116 secs
2025-03-13 19:00:40,082 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:00:40,082 [INFO]: 	Compute fast metrics 03/13/2025, 19:00:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 19:00:57,325 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2429 secs
2025-03-13 19:00:57,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9295 secs
2025-03-13 19:00:57,327 [INFO]: {
2025-03-13 19:00:57,327 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:57,327 [INFO]: 	index_param: efSearch=280
2025-03-13 19:00:57,327 [INFO]: 	index_path: knn.index
2025-03-13 19:00:57,327 [INFO]: 	size in bytes: 510943810
2025-03-13 19:00:57,327 [INFO]: 	avg_search_speed_ms: 11.075937895388945
2025-03-13 19:00:57,327 [INFO]: 	99p_search_speed_ms: 19.302536123432223
2025-03-13 19:00:57,327 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:57,327 [INFO]: 	nb vectors: 2597
2025-03-13 19:00:57,327 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:57,327 [INFO]: 	compression ratio: 0.9993094465710427
2025-03-13 19:00:57,327 [INFO]: }
2025-03-13 19:00:57,327 [INFO]: 	>>> Finished "Creating the index" in 50.9308 secs
2025-03-13 19:00:57,327 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9554 secs
2025-03-13 19:00:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 68865 [episode count 9/20]
[retrieval_preprocessing] for episode 13059 [episode count 10/20], we have num_retrieval=np.int64(2618) num_query=np.int64(138)
2025-03-13 19:00:59,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:00,036 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:00
2025-03-13 19:01:00,036 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2451.38it/s]
2025-03-13 19:01:00,060 [INFO]: There are 2618 embeddings of dim 49152
2025-03-13 19:01:00,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 19:01:00,060 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:00
2025-03-13 19:01:00,060 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:00,060 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:01:00,060 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:00,060 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:00,060 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:00
2025-03-13 19:01:00,060 [INFO]: 540.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:00,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:01:00,060 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:00
2025-03-13 19:01:00,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:00,060 [INFO]: 	Creating the index 03/13/2025, 19:01:00
2025-03-13 19:01:00,060 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:00
2025-03-13 19:01:00,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:01:00,061 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:00
2025-03-13 19:01:00,061 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:01:00,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.49it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.55it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.45it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.69it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.75it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.17it/s]100%|██████████| 11/11 [00:03<00:00,  3.16it/s]
2025-03-13 19:01:03,542 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:03
2025-03-13 19:01:32,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0553 secs
2025-03-13 19:01:32,598 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 19:01:32,598 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 19:01:55,555 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9565 secs
2025-03-13 19:01:55,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9351 secs
2025-03-13 19:01:55,997 [INFO]: {
2025-03-13 19:01:55,997 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:55,997 [INFO]: 	index_param: efSearch=296
2025-03-13 19:01:55,997 [INFO]: 	index_path: knn.index
2025-03-13 19:01:55,997 [INFO]: 	size in bytes: 515075470
2025-03-13 19:01:55,997 [INFO]: 	avg_search_speed_ms: 9.686680548768418
2025-03-13 19:01:55,998 [INFO]: 	99p_search_speed_ms: 15.588024889584624
2025-03-13 19:01:55,998 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:55,998 [INFO]: 	nb vectors: 2618
2025-03-13 19:01:55,998 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:55,998 [INFO]: 	compression ratio: 0.9993093711102181
2025-03-13 19:01:55,998 [INFO]: }
2025-03-13 19:01:55,998 [INFO]: 	>>> Finished "Creating the index" in 55.9376 secs
2025-03-13 19:01:55,998 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9620 secs
2025-03-13 19:01:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:01:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 13059 [episode count 10/20]
[retrieval_preprocessing] for episode 73988 [episode count 11/20], we have num_retrieval=np.int64(2606) num_query=np.int64(150)
2025-03-13 19:01:58,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:58,453 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:58
2025-03-13 19:01:58,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 921.83it/s]
2025-03-13 19:01:58,478 [INFO]: There are 2606 embeddings of dim 49152
2025-03-13 19:01:58,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 19:01:58,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:58
2025-03-13 19:01:58,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:58,479 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:01:58,479 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:58,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:58,479 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:58
2025-03-13 19:01:58,479 [INFO]: 537.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:58,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:01:58,479 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:58
2025-03-13 19:01:58,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:58,479 [INFO]: 	Creating the index 03/13/2025, 19:01:58
2025-03-13 19:01:58,479 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:58
2025-03-13 19:01:58,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:01:58,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:58
2025-03-13 19:01:58,480 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:01:58,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.25it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.96it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.76it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.31it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.57it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.72it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.80it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.83it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.80it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.88it/s]100%|██████████| 11/11 [00:03<00:00,  1.47it/s]100%|██████████| 11/11 [00:03<00:00,  3.48it/s]
2025-03-13 19:02:01,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:01
2025-03-13 19:02:26,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2727 secs
2025-03-13 19:02:26,921 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 19:02:26,921 [INFO]: 	Compute fast metrics 03/13/2025, 19:02:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 19:02:44,136 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2148 secs
2025-03-13 19:02:44,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6592 secs
2025-03-13 19:02:44,140 [INFO]: {
2025-03-13 19:02:44,140 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:44,140 [INFO]: 	index_param: efSearch=295
2025-03-13 19:02:44,140 [INFO]: 	index_path: knn.index
2025-03-13 19:02:44,140 [INFO]: 	size in bytes: 512714470
2025-03-13 19:02:44,140 [INFO]: 	avg_search_speed_ms: 10.452654722167127
2025-03-13 19:02:44,140 [INFO]: 	99p_search_speed_ms: 14.360250420868395
2025-03-13 19:02:44,140 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:44,140 [INFO]: 	nb vectors: 2606
2025-03-13 19:02:44,140 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:44,140 [INFO]: 	compression ratio: 0.9993095143189542
2025-03-13 19:02:44,140 [INFO]: }
2025-03-13 19:02:44,140 [INFO]: 	>>> Finished "Creating the index" in 45.6611 secs
2025-03-13 19:02:44,140 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6874 secs
2025-03-13 19:02:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 73988 [episode count 11/20]
[retrieval_preprocessing] for episode 54593 [episode count 12/20], we have num_retrieval=np.int64(2631) num_query=np.int64(125)
2025-03-13 19:02:47,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:47,564 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:47
2025-03-13 19:02:47,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1697.41it/s]
2025-03-13 19:02:47,588 [INFO]: There are 2631 embeddings of dim 49152
2025-03-13 19:02:47,589 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:02:47,589 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:47
2025-03-13 19:02:47,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:47,589 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:02:47,589 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:47,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:02:47,589 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:47
2025-03-13 19:02:47,589 [INFO]: 543.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:47,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:02:47,589 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:47
2025-03-13 19:02:47,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:47,589 [INFO]: 	Creating the index 03/13/2025, 19:02:47
2025-03-13 19:02:47,589 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:47
2025-03-13 19:02:47,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:02:47,591 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:47
2025-03-13 19:02:47,591 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:02:47,591 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.83it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.22it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.53it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.08it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.62it/s]100%|██████████| 11/11 [00:02<00:00,  2.82it/s]100%|██████████| 11/11 [00:02<00:00,  4.33it/s]
2025-03-13 19:02:50,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:50
2025-03-13 19:03:17,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3407 secs
2025-03-13 19:03:17,478 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 19:03:17,478 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-13 19:03:39,938 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4603 secs
2025-03-13 19:03:39,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3491 secs
2025-03-13 19:03:39,940 [INFO]: {
2025-03-13 19:03:39,940 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:39,940 [INFO]: 	index_param: efSearch=300
2025-03-13 19:03:39,940 [INFO]: 	index_path: knn.index
2025-03-13 19:03:39,940 [INFO]: 	size in bytes: 517633150
2025-03-13 19:03:39,940 [INFO]: 	avg_search_speed_ms: 8.543855714627629
2025-03-13 19:03:39,940 [INFO]: 	99p_search_speed_ms: 12.582588368095458
2025-03-13 19:03:39,940 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:39,940 [INFO]: 	nb vectors: 2631
2025-03-13 19:03:39,940 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:39,940 [INFO]: 	compression ratio: 0.9993093525791383
2025-03-13 19:03:39,940 [INFO]: }
2025-03-13 19:03:39,940 [INFO]: 	>>> Finished "Creating the index" in 52.3508 secs
2025-03-13 19:03:39,940 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3755 secs
2025-03-13 19:03:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 54593 [episode count 12/20]
[retrieval_preprocessing] for episode 13646 [episode count 13/20], we have num_retrieval=np.int64(2603) num_query=np.int64(153)
2025-03-13 19:03:41,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:42,202 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:42
2025-03-13 19:03:42,202 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-13 19:03:42,225 [INFO]: There are 2603 embeddings of dim 49152
2025-03-13 19:03:42,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-13 19:03:42,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:42
2025-03-13 19:03:42,226 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:42,226 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:03:42,226 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:03:42,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:03:42,226 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:42
2025-03-13 19:03:42,226 [INFO]: 537.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:42,226 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:03:42,226 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:42
2025-03-13 19:03:42,226 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:42,226 [INFO]: 	Creating the index 03/13/2025, 19:03:42
2025-03-13 19:03:42,226 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:03:42
2025-03-13 19:03:42,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:03:42,227 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:42
2025-03-13 19:03:42,227 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:03:42,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.19it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.92it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.12it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.82it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.05it/s]100%|██████████| 11/11 [00:02<00:00,  3.00it/s]100%|██████████| 11/11 [00:02<00:00,  4.60it/s]
2025-03-13 19:03:44,621 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:44
2025-03-13 19:04:11,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8146 secs
2025-03-13 19:04:11,437 [INFO]: The best hyperparameters are: efSearch=369
2025-03-13 19:04:11,437 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 19:04:29,990 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5536 secs
2025-03-13 19:04:30,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6196 secs
2025-03-13 19:04:30,847 [INFO]: {
2025-03-13 19:04:30,847 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:30,847 [INFO]: 	index_param: efSearch=369
2025-03-13 19:04:30,847 [INFO]: 	index_path: knn.index
2025-03-13 19:04:30,847 [INFO]: 	size in bytes: 512124250
2025-03-13 19:04:30,847 [INFO]: 	avg_search_speed_ms: 11.474794626488016
2025-03-13 19:04:30,847 [INFO]: 	99p_search_speed_ms: 17.004507079254832
2025-03-13 19:04:30,847 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:30,847 [INFO]: 	nb vectors: 2603
2025-03-13 19:04:30,848 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:30,848 [INFO]: 	compression ratio: 0.9993094917883697
2025-03-13 19:04:30,848 [INFO]: }
2025-03-13 19:04:30,848 [INFO]: 	>>> Finished "Creating the index" in 48.6218 secs
2025-03-13 19:04:30,848 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6454 secs
2025-03-13 19:04:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 13646 [episode count 13/20]
[retrieval_preprocessing] for episode 81243 [episode count 14/20], we have num_retrieval=np.int64(2640) num_query=np.int64(116)
2025-03-13 19:04:34,096 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:34,442 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:34
2025-03-13 19:04:34,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2071.26it/s]
2025-03-13 19:04:34,467 [INFO]: There are 2640 embeddings of dim 49152
2025-03-13 19:04:34,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:04:34,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:34
2025-03-13 19:04:34,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:34,468 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 19:04:34,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:34,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:04:34,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:34
2025-03-13 19:04:34,468 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:34,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:04:34,468 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:34
2025-03-13 19:04:34,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:34,469 [INFO]: 	Creating the index 03/13/2025, 19:04:34
2025-03-13 19:04:34,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:34
2025-03-13 19:04:34,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:04:34,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:34
2025-03-13 19:04:34,472 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:04:34,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.19it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.04it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.30it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.01it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.37it/s]100%|██████████| 11/11 [00:02<00:00,  2.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.54it/s]
2025-03-13 19:04:36,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:36
2025-03-13 19:05:02,666 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7680 secs
2025-03-13 19:05:02,666 [INFO]: The best hyperparameters are: efSearch=343
2025-03-13 19:05:02,666 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s]
2025-03-13 19:05:21,450 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7839 secs
2025-03-13 19:05:21,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9799 secs
2025-03-13 19:05:21,452 [INFO]: {
2025-03-13 19:05:21,452 [INFO]: 	index_key: HNSW15
2025-03-13 19:05:21,452 [INFO]: 	index_param: efSearch=343
2025-03-13 19:05:21,452 [INFO]: 	index_path: knn.index
2025-03-13 19:05:21,452 [INFO]: 	size in bytes: 519403810
2025-03-13 19:05:21,452 [INFO]: 	avg_search_speed_ms: 11.656847699666896
2025-03-13 19:05:21,452 [INFO]: 	99p_search_speed_ms: 16.780562545172867
2025-03-13 19:05:21,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:05:21,452 [INFO]: 	nb vectors: 2640
2025-03-13 19:05:21,452 [INFO]: 	vectors dimension: 49152
2025-03-13 19:05:21,452 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-13 19:05:21,452 [INFO]: }
2025-03-13 19:05:21,453 [INFO]: 	>>> Finished "Creating the index" in 46.9838 secs
2025-03-13 19:05:21,453 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0107 secs
2025-03-13 19:05:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:05:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 81243 [episode count 14/20]
[retrieval_preprocessing] for episode 13679 [episode count 15/20], we have num_retrieval=np.int64(2611) num_query=np.int64(145)
2025-03-13 19:05:24,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:05:24,778 [INFO]: Launching the whole pipeline 03/13/2025, 19:05:24
2025-03-13 19:05:24,779 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:05:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.67it/s]
2025-03-13 19:05:24,806 [INFO]: There are 2611 embeddings of dim 49152
2025-03-13 19:05:24,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:05:24,807 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:05:24
2025-03-13 19:05:24,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:05:24,808 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:05:24,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:05:24,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:05:24,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:05:24
2025-03-13 19:05:24,808 [INFO]: 538.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:05:24,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:05:24,809 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:05:24
2025-03-13 19:05:24,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:05:24,809 [INFO]: 	Creating the index 03/13/2025, 19:05:24
2025-03-13 19:05:24,809 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:05:24
2025-03-13 19:05:24,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:05:24,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:05:24
2025-03-13 19:05:24,813 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:05:24,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.98it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.69it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.48it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.21it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.50it/s]100%|██████████| 11/11 [00:03<00:00,  2.32it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-13 19:05:27,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:27
2025-03-13 19:05:57,827 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9864 secs
2025-03-13 19:05:57,827 [INFO]: The best hyperparameters are: efSearch=368
2025-03-13 19:05:57,827 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 50%|█████     | 2/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 19:06:25,865 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0379 secs
2025-03-13 19:06:25,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0550 secs
2025-03-13 19:06:25,868 [INFO]: {
2025-03-13 19:06:25,868 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:25,868 [INFO]: 	index_param: efSearch=368
2025-03-13 19:06:25,868 [INFO]: 	index_path: knn.index
2025-03-13 19:06:25,868 [INFO]: 	size in bytes: 513698170
2025-03-13 19:06:25,868 [INFO]: 	avg_search_speed_ms: 10.779885664995728
2025-03-13 19:06:25,868 [INFO]: 	99p_search_speed_ms: 14.134150920435786
2025-03-13 19:06:25,868 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:25,868 [INFO]: 	nb vectors: 2611
2025-03-13 19:06:25,868 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:25,868 [INFO]: 	compression ratio: 0.9993095517548758
2025-03-13 19:06:25,868 [INFO]: }
2025-03-13 19:06:25,868 [INFO]: 	>>> Finished "Creating the index" in 61.0590 secs
2025-03-13 19:06:25,868 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0896 secs
2025-03-13 19:06:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 13679 [episode count 15/20]
[retrieval_preprocessing] for episode 77168 [episode count 16/20], we have num_retrieval=np.int64(2633) num_query=np.int64(123)
2025-03-13 19:06:28,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:29,331 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:29
2025-03-13 19:06:29,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1821.23it/s]
2025-03-13 19:06:29,354 [INFO]: There are 2633 embeddings of dim 49152
2025-03-13 19:06:29,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 19:06:29,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:29
2025-03-13 19:06:29,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:29,354 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:06:29,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:29,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:29,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:29
2025-03-13 19:06:29,354 [INFO]: 543.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:29,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:06:29,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:29
2025-03-13 19:06:29,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:29,354 [INFO]: 	Creating the index 03/13/2025, 19:06:29
2025-03-13 19:06:29,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:29
2025-03-13 19:06:29,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:06:29,355 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:29
2025-03-13 19:06:29,355 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:06:29,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.96it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.22it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.20it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.77it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.94it/s]100%|██████████| 11/11 [00:02<00:00,  2.75it/s]100%|██████████| 11/11 [00:02<00:00,  4.21it/s]
2025-03-13 19:06:31,969 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:31
2025-03-13 19:07:00,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2435 secs
2025-03-13 19:07:00,213 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 19:07:00,213 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 19:07:16,021 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8071 secs
2025-03-13 19:07:16,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6673 secs
2025-03-13 19:07:16,023 [INFO]: {
2025-03-13 19:07:16,023 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:16,023 [INFO]: 	index_param: efSearch=326
2025-03-13 19:07:16,023 [INFO]: 	index_path: knn.index
2025-03-13 19:07:16,023 [INFO]: 	size in bytes: 518026630
2025-03-13 19:07:16,023 [INFO]: 	avg_search_speed_ms: 10.608228732617464
2025-03-13 19:07:16,023 [INFO]: 	99p_search_speed_ms: 14.328542160801593
2025-03-13 19:07:16,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:16,023 [INFO]: 	nb vectors: 2633
2025-03-13 19:07:16,023 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:16,023 [INFO]: 	compression ratio: 0.9993093675512396
2025-03-13 19:07:16,023 [INFO]: }
2025-03-13 19:07:16,023 [INFO]: 	>>> Finished "Creating the index" in 46.6688 secs
2025-03-13 19:07:16,023 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6917 secs
2025-03-13 19:07:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 77168 [episode count 16/20]
[retrieval_preprocessing] for episode 8066 [episode count 17/20], we have num_retrieval=np.int64(2623) num_query=np.int64(133)
2025-03-13 19:07:17,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:18,139 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:18
2025-03-13 19:07:18,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.21it/s]
2025-03-13 19:07:18,163 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 19:07:18,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 19:07:18,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:18
2025-03-13 19:07:18,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:18,163 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:07:18,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:18,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:07:18,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:18
2025-03-13 19:07:18,163 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:18,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:07:18,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:18
2025-03-13 19:07:18,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:18,164 [INFO]: 	Creating the index 03/13/2025, 19:07:18
2025-03-13 19:07:18,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:18
2025-03-13 19:07:18,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:07:18,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:18
2025-03-13 19:07:18,165 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:07:18,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.64it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.84it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.37it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.08it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.36it/s]100%|██████████| 11/11 [00:02<00:00,  3.14it/s]100%|██████████| 11/11 [00:02<00:00,  4.77it/s]
2025-03-13 19:07:20,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:20
2025-03-13 19:07:43,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7851 secs
2025-03-13 19:07:43,261 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 19:07:43,261 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-13 19:08:09,005 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7445 secs
2025-03-13 19:08:09,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8429 secs
2025-03-13 19:08:09,008 [INFO]: {
2025-03-13 19:08:09,008 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:09,008 [INFO]: 	index_param: efSearch=291
2025-03-13 19:08:09,008 [INFO]: 	index_path: knn.index
2025-03-13 19:08:09,008 [INFO]: 	size in bytes: 516059170
2025-03-13 19:08:09,008 [INFO]: 	avg_search_speed_ms: 9.324148736064359
2025-03-13 19:08:09,008 [INFO]: 	99p_search_speed_ms: 14.765484081581231
2025-03-13 19:08:09,008 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:09,008 [INFO]: 	nb vectors: 2623
2025-03-13 19:08:09,008 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:09,008 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 19:08:09,008 [INFO]: }
2025-03-13 19:08:09,008 [INFO]: 	>>> Finished "Creating the index" in 50.8441 secs
2025-03-13 19:08:09,008 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8683 secs
2025-03-13 19:08:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 8066 [episode count 17/20]
[retrieval_preprocessing] for episode 87440 [episode count 18/20], we have num_retrieval=np.int64(2624) num_query=np.int64(132)
2025-03-13 19:08:10,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:11,231 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:11
2025-03-13 19:08:11,231 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-13 19:08:11,255 [INFO]: There are 2624 embeddings of dim 49152
2025-03-13 19:08:11,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 19:08:11,256 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:11
2025-03-13 19:08:11,256 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:11,256 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:08:11,256 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:11,256 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:11,256 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:11
2025-03-13 19:08:11,256 [INFO]: 541.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:11,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:11,256 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:11
2025-03-13 19:08:11,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:11,256 [INFO]: 	Creating the index 03/13/2025, 19:08:11
2025-03-13 19:08:11,256 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:11
2025-03-13 19:08:11,257 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:08:11,257 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:11
2025-03-13 19:08:11,257 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:08:11,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.38it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.06it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.87it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.28it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.51it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.75it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.80it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.84it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.91it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.94it/s]100%|██████████| 11/11 [00:02<00:00,  1.71it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]
2025-03-13 19:08:14,103 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:14
2025-03-13 19:08:43,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1188 secs
2025-03-13 19:08:43,222 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 19:08:43,222 [INFO]: 	Compute fast metrics 03/13/2025, 19:08:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 19:09:00,688 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4660 secs
2025-03-13 19:09:00,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4328 secs
2025-03-13 19:09:00,690 [INFO]: {
2025-03-13 19:09:00,690 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:00,690 [INFO]: 	index_param: efSearch=259
2025-03-13 19:09:00,690 [INFO]: 	index_path: knn.index
2025-03-13 19:09:00,690 [INFO]: 	size in bytes: 516255910
2025-03-13 19:09:00,690 [INFO]: 	avg_search_speed_ms: 8.7585523563491
2025-03-13 19:09:00,690 [INFO]: 	99p_search_speed_ms: 14.361422483343611
2025-03-13 19:09:00,690 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:00,690 [INFO]: 	nb vectors: 2624
2025-03-13 19:09:00,690 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:00,690 [INFO]: 	compression ratio: 0.9993094161382094
2025-03-13 19:09:00,690 [INFO]: }
2025-03-13 19:09:00,690 [INFO]: 	>>> Finished "Creating the index" in 49.4341 secs
2025-03-13 19:09:00,690 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4595 secs
2025-03-13 19:09:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 87440 [episode count 18/20]
[retrieval_preprocessing] for episode 76182 [episode count 19/20], we have num_retrieval=np.int64(2637) num_query=np.int64(119)
2025-03-13 19:09:02,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:02,947 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:02
2025-03-13 19:09:02,947 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1938.22it/s]
2025-03-13 19:09:02,969 [INFO]: There are 2637 embeddings of dim 49152
2025-03-13 19:09:02,970 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 19:09:02,970 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:02
2025-03-13 19:09:02,970 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:02,970 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:09:02,970 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:02,970 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:02,970 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:02
2025-03-13 19:09:02,970 [INFO]: 544.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:02,970 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:09:02,970 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:02
2025-03-13 19:09:02,970 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:02,970 [INFO]: 	Creating the index 03/13/2025, 19:09:02
2025-03-13 19:09:02,970 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:02
2025-03-13 19:09:02,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:09:02,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:02
2025-03-13 19:09:02,971 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:09:02,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.59it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.23it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.30it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.87it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.25it/s]100%|██████████| 11/11 [00:02<00:00,  2.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.55it/s]
2025-03-13 19:09:05,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:05
2025-03-13 19:09:31,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3039 secs
2025-03-13 19:09:31,693 [INFO]: The best hyperparameters are: efSearch=331
2025-03-13 19:09:31,693 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 19:09:50,013 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3196 secs
2025-03-13 19:09:50,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0445 secs
2025-03-13 19:09:50,016 [INFO]: {
2025-03-13 19:09:50,016 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:50,016 [INFO]: 	index_param: efSearch=331
2025-03-13 19:09:50,016 [INFO]: 	index_path: knn.index
2025-03-13 19:09:50,016 [INFO]: 	size in bytes: 518813590
2025-03-13 19:09:50,016 [INFO]: 	avg_search_speed_ms: 9.982911665866267
2025-03-13 19:09:50,016 [INFO]: 	99p_search_speed_ms: 15.425067069008946
2025-03-13 19:09:50,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:50,016 [INFO]: 	nb vectors: 2637
2025-03-13 19:09:50,016 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:50,016 [INFO]: 	compression ratio: 0.9993093974273111
2025-03-13 19:09:50,016 [INFO]: }
2025-03-13 19:09:50,016 [INFO]: 	>>> Finished "Creating the index" in 47.0461 secs
2025-03-13 19:09:50,016 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0695 secs
2025-03-13 19:09:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 76182 [episode count 19/20]
2025-03-13 19:09:51: [retrieval_preprocessing] finished for 8911427557_put_elastic_around_bottle [chosen_id count 8/196]
2025-03-13 19:09:53: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8922050678_open_bin [chosen_id count 9/196]
2025-03-13 19:09:53: [retrieval_preprocessing] we have num_total=2666 embedding_dim=49152
[retrieval_preprocessing] for episode 5120 [episode count 0/20], we have num_retrieval=np.int64(2489) num_query=np.int64(177)
2025-03-13 19:09:54,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:54,959 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:54
2025-03-13 19:09:54,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1796.28it/s]
2025-03-13 19:09:54,982 [INFO]: There are 2489 embeddings of dim 49152
2025-03-13 19:09:54,982 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 19:09:54,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:54
2025-03-13 19:09:54,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:54,982 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:09:54,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:54,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:09:54,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:54
2025-03-13 19:09:54,983 [INFO]: 513.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:54,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:09:54,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:54
2025-03-13 19:09:54,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:54,983 [INFO]: 	Creating the index 03/13/2025, 19:09:54
2025-03-13 19:09:54,983 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:54
2025-03-13 19:09:54,984 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:09:54,984 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:54
2025-03-13 19:09:54,984 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:09:54,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.64it/s] 30%|███       | 3/10 [00:00<00:00, 10.31it/s] 50%|█████     | 5/10 [00:00<00:00, 11.55it/s] 70%|███████   | 7/10 [00:00<00:00, 12.01it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.35it/s]100%|██████████| 10/10 [00:02<00:00,  4.42it/s]
2025-03-13 19:09:57,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:57
2025-03-13 19:10:21,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4239 secs
2025-03-13 19:10:21,679 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 19:10:21,679 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 19:10:40,602 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9235 secs
2025-03-13 19:10:40,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6203 secs
2025-03-13 19:10:40,604 [INFO]: {
2025-03-13 19:10:40,604 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:40,604 [INFO]: 	index_param: efSearch=335
2025-03-13 19:10:40,604 [INFO]: 	index_path: knn.index
2025-03-13 19:10:40,604 [INFO]: 	size in bytes: 489695170
2025-03-13 19:10:40,604 [INFO]: 	avg_search_speed_ms: 11.167869828828511
2025-03-13 19:10:40,604 [INFO]: 	99p_search_speed_ms: 15.637598175089805
2025-03-13 19:10:40,604 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:40,604 [INFO]: 	nb vectors: 2489
2025-03-13 19:10:40,604 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:40,604 [INFO]: 	compression ratio: 0.9993100646673726
2025-03-13 19:10:40,604 [INFO]: }
2025-03-13 19:10:40,604 [INFO]: 	>>> Finished "Creating the index" in 45.6216 secs
2025-03-13 19:10:40,604 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6454 secs
2025-03-13 19:10:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 5120 [episode count 0/20]
[retrieval_preprocessing] for episode 50715 [episode count 1/20], we have num_retrieval=np.int64(2500) num_query=np.int64(166)
2025-03-13 19:10:43,422 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:44,036 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:44
2025-03-13 19:10:44,036 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1739.65it/s]
2025-03-13 19:10:44,062 [INFO]: There are 2500 embeddings of dim 49152
2025-03-13 19:10:44,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 19:10:44,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:44,062 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:10:44,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:44,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:10:44,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,063 [INFO]: 515.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:44,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:10:44,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:44
2025-03-13 19:10:44,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:44,063 [INFO]: 	Creating the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,063 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:44
2025-03-13 19:10:44,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:10:44,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:44
2025-03-13 19:10:44,064 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:10:44,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.97it/s] 30%|███       | 3/10 [00:00<00:00, 10.34it/s] 50%|█████     | 5/10 [00:00<00:00, 10.94it/s] 70%|███████   | 7/10 [00:00<00:00, 10.56it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.57it/s]100%|██████████| 10/10 [00:02<00:00,  3.38it/s]
2025-03-13 19:10:47,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:47
2025-03-13 19:11:14,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1469 secs
2025-03-13 19:11:14,179 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:11:14,179 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-13 19:11:34,339 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1605 secs
2025-03-13 19:11:34,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2767 secs
2025-03-13 19:11:34,341 [INFO]: {
2025-03-13 19:11:34,341 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:34,341 [INFO]: 	index_param: efSearch=244
2025-03-13 19:11:34,341 [INFO]: 	index_path: knn.index
2025-03-13 19:11:34,341 [INFO]: 	size in bytes: 491859370
2025-03-13 19:11:34,341 [INFO]: 	avg_search_speed_ms: 8.886617977172136
2025-03-13 19:11:34,341 [INFO]: 	99p_search_speed_ms: 11.599386977031827
2025-03-13 19:11:34,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:34,341 [INFO]: 	nb vectors: 2500
2025-03-13 19:11:34,341 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:34,341 [INFO]: 	compression ratio: 0.9993100263597703
2025-03-13 19:11:34,341 [INFO]: }
2025-03-13 19:11:34,341 [INFO]: 	>>> Finished "Creating the index" in 50.2783 secs
2025-03-13 19:11:34,341 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3056 secs
2025-03-13 19:11:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 50715 [episode count 1/20]
[retrieval_preprocessing] for episode 32819 [episode count 2/20], we have num_retrieval=np.int64(2580) num_query=np.int64(86)
2025-03-13 19:11:36,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:36,881 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:36
2025-03-13 19:11:36,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.18it/s]
2025-03-13 19:11:36,906 [INFO]: There are 2580 embeddings of dim 49152
2025-03-13 19:11:36,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 19:11:36,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:36
2025-03-13 19:11:36,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:36,907 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:11:36,907 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:36,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:11:36,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:36
2025-03-13 19:11:36,908 [INFO]: 532.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:36,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:11:36,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:36
2025-03-13 19:11:36,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:36,908 [INFO]: 	Creating the index 03/13/2025, 19:11:36
2025-03-13 19:11:36,908 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:36
2025-03-13 19:11:36,911 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 19:11:36,911 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:36
2025-03-13 19:11:36,911 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:11:36,911 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.36it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.92it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.65it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.22it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.48it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.57it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.61it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.58it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.59it/s]100%|██████████| 11/11 [00:02<00:00,  1.72it/s]100%|██████████| 11/11 [00:02<00:00,  3.85it/s]
2025-03-13 19:11:39,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:39
2025-03-13 19:12:05,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7212 secs
2025-03-13 19:12:05,496 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 19:12:05,496 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 19:12:26,444 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9478 secs
2025-03-13 19:12:26,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5347 secs
2025-03-13 19:12:26,446 [INFO]: {
2025-03-13 19:12:26,446 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:26,446 [INFO]: 	index_param: efSearch=245
2025-03-13 19:12:26,446 [INFO]: 	index_path: knn.index
2025-03-13 19:12:26,446 [INFO]: 	size in bytes: 507599170
2025-03-13 19:12:26,446 [INFO]: 	avg_search_speed_ms: 9.393160054110375
2025-03-13 19:12:26,446 [INFO]: 	99p_search_speed_ms: 12.20536177046597
2025-03-13 19:12:26,446 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:26,446 [INFO]: 	nb vectors: 2580
2025-03-13 19:12:26,446 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:26,446 [INFO]: 	compression ratio: 0.99930943543505
2025-03-13 19:12:26,446 [INFO]: }
2025-03-13 19:12:26,446 [INFO]: 	>>> Finished "Creating the index" in 49.5379 secs
2025-03-13 19:12:26,446 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5651 secs
2025-03-13 19:12:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 32819 [episode count 2/20]
[retrieval_preprocessing] for episode 86070 [episode count 3/20], we have num_retrieval=np.int64(2527) num_query=np.int64(139)
2025-03-13 19:12:27,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:28,231 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:28
2025-03-13 19:12:28,231 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1403.72it/s]
2025-03-13 19:12:28,254 [INFO]: There are 2527 embeddings of dim 49152
2025-03-13 19:12:28,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:12:28,255 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:28
2025-03-13 19:12:28,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:28,255 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:12:28,255 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:28,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:12:28,255 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:28
2025-03-13 19:12:28,256 [INFO]: 521.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:28,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:12:28,256 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:28
2025-03-13 19:12:28,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:28,256 [INFO]: 	Creating the index 03/13/2025, 19:12:28
2025-03-13 19:12:28,256 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:28
2025-03-13 19:12:28,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:12:28,258 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:28
2025-03-13 19:12:28,258 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:12:28,258 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.97it/s] 20%|██        | 2/10 [00:00<00:01,  5.07it/s] 30%|███       | 3/10 [00:00<00:01,  6.26it/s] 40%|████      | 4/10 [00:00<00:00,  7.06it/s] 50%|█████     | 5/10 [00:00<00:00,  7.58it/s] 60%|██████    | 6/10 [00:00<00:00,  8.08it/s] 70%|███████   | 7/10 [00:00<00:00,  8.33it/s] 80%|████████  | 8/10 [00:01<00:00,  8.52it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.63it/s]100%|██████████| 10/10 [00:02<00:00,  1.74it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]
2025-03-13 19:12:31,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:31
2025-03-13 19:12:57,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1495 secs
2025-03-13 19:12:57,218 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 19:12:57,218 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.36it/s]
2025-03-13 19:13:19,355 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1373 secs
2025-03-13 19:13:19,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0989 secs
2025-03-13 19:13:19,357 [INFO]: {
2025-03-13 19:13:19,357 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:19,358 [INFO]: 	index_param: efSearch=228
2025-03-13 19:13:19,358 [INFO]: 	index_path: knn.index
2025-03-13 19:13:19,358 [INFO]: 	size in bytes: 497171530
2025-03-13 19:13:19,358 [INFO]: 	avg_search_speed_ms: 9.780821911699034
2025-03-13 19:13:19,358 [INFO]: 	99p_search_speed_ms: 15.7834763987921
2025-03-13 19:13:19,358 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:19,358 [INFO]: 	nb vectors: 2527
2025-03-13 19:13:19,358 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:19,358 [INFO]: 	compression ratio: 0.999309867964483
2025-03-13 19:13:19,358 [INFO]: }
2025-03-13 19:13:19,358 [INFO]: 	>>> Finished "Creating the index" in 51.1017 secs
2025-03-13 19:13:19,358 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1270 secs
2025-03-13 19:13:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 86070 [episode count 3/20]
[retrieval_preprocessing] for episode 31809 [episode count 4/20], we have num_retrieval=np.int64(2542) num_query=np.int64(124)
2025-03-13 19:13:21,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:22,514 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:22
2025-03-13 19:13:22,514 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.94it/s]
2025-03-13 19:13:22,541 [INFO]: There are 2542 embeddings of dim 49152
2025-03-13 19:13:22,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:13:22,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:22
2025-03-13 19:13:22,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:22,542 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:13:22,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:22,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:22,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:22
2025-03-13 19:13:22,542 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:22,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:13:22,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:22
2025-03-13 19:13:22,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:22,542 [INFO]: 	Creating the index 03/13/2025, 19:13:22
2025-03-13 19:13:22,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:22
2025-03-13 19:13:22,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:13:22,543 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:22
2025-03-13 19:13:22,543 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:13:22,543 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.27it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.56it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.15it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.76it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.24it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.43it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.66it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.77it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.94it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.94it/s]100%|██████████| 11/11 [00:02<00:00,  1.78it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]
2025-03-13 19:13:25,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:25
2025-03-13 19:13:49,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6489 secs
2025-03-13 19:13:49,991 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 19:13:49,991 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 19:14:09,716 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7251 secs
2025-03-13 19:14:09,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1747 secs
2025-03-13 19:14:09,718 [INFO]: {
2025-03-13 19:14:09,718 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:09,718 [INFO]: 	index_param: efSearch=241
2025-03-13 19:14:09,718 [INFO]: 	index_path: knn.index
2025-03-13 19:14:09,718 [INFO]: 	size in bytes: 500122750
2025-03-13 19:14:09,718 [INFO]: 	avg_search_speed_ms: 8.387289113512
2025-03-13 19:14:09,718 [INFO]: 	99p_search_speed_ms: 11.383634016383438
2025-03-13 19:14:09,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:09,718 [INFO]: 	nb vectors: 2542
2025-03-13 19:14:09,718 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:09,718 [INFO]: 	compression ratio: 0.999309741458472
2025-03-13 19:14:09,718 [INFO]: }
2025-03-13 19:14:09,718 [INFO]: 	>>> Finished "Creating the index" in 47.1762 secs
2025-03-13 19:14:09,718 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2042 secs
2025-03-13 19:14:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 31809 [episode count 4/20]
[retrieval_preprocessing] for episode 22085 [episode count 5/20], we have num_retrieval=np.int64(2581) num_query=np.int64(85)
2025-03-13 19:14:11,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:12,048 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:12
2025-03-13 19:14:12,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.66it/s]
2025-03-13 19:14:12,072 [INFO]: There are 2581 embeddings of dim 49152
2025-03-13 19:14:12,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 19:14:12,073 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:12
2025-03-13 19:14:12,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:12,073 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:14:12,073 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:12,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:12,073 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:12
2025-03-13 19:14:12,073 [INFO]: 532.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:12,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:14:12,073 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:12
2025-03-13 19:14:12,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:12,073 [INFO]: 	Creating the index 03/13/2025, 19:14:12
2025-03-13 19:14:12,073 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:12
2025-03-13 19:14:12,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:14:12,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:12
2025-03-13 19:14:12,075 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:14:12,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.02it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.65it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.87it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.63it/s]100%|██████████| 11/11 [00:02<00:00,  2.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.48it/s]
2025-03-13 19:14:14,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:14
2025-03-13 19:14:40,757 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2230 secs
2025-03-13 19:14:40,757 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 19:14:40,757 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-13 19:15:00,930 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1730 secs
2025-03-13 19:15:00,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8576 secs
2025-03-13 19:15:00,932 [INFO]: {
2025-03-13 19:15:00,933 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:00,933 [INFO]: 	index_param: efSearch=222
2025-03-13 19:15:00,933 [INFO]: 	index_path: knn.index
2025-03-13 19:15:00,933 [INFO]: 	size in bytes: 507795910
2025-03-13 19:15:00,933 [INFO]: 	avg_search_speed_ms: 8.97716345429367
2025-03-13 19:15:00,933 [INFO]: 	99p_search_speed_ms: 14.200402467977176
2025-03-13 19:15:00,933 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:00,933 [INFO]: 	nb vectors: 2581
2025-03-13 19:15:00,933 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:00,933 [INFO]: 	compression ratio: 0.9993094430398228
2025-03-13 19:15:00,933 [INFO]: }
2025-03-13 19:15:00,933 [INFO]: 	>>> Finished "Creating the index" in 48.8594 secs
2025-03-13 19:15:00,933 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8850 secs
2025-03-13 19:15:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 22085 [episode count 5/20]
[retrieval_preprocessing] for episode 89158 [episode count 6/20], we have num_retrieval=np.int64(2594) num_query=np.int64(72)
2025-03-13 19:15:05,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:05,802 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:05
2025-03-13 19:15:05,803 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2376.38it/s]
2025-03-13 19:15:05,826 [INFO]: There are 2594 embeddings of dim 49152
2025-03-13 19:15:05,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 19:15:05,826 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:05
2025-03-13 19:15:05,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:05,826 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:15:05,826 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:05,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:05,826 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:05
2025-03-13 19:15:05,827 [INFO]: 535.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:05,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:15:05,827 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:05
2025-03-13 19:15:05,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:05,827 [INFO]: 	Creating the index 03/13/2025, 19:15:05
2025-03-13 19:15:05,827 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:05
2025-03-13 19:15:05,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:15:05,828 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:05
2025-03-13 19:15:05,828 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:15:05,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.03it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.38it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.47it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.66it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.84it/s]100%|██████████| 11/11 [00:02<00:00,  3.12it/s]100%|██████████| 11/11 [00:02<00:00,  4.86it/s]
2025-03-13 19:15:08,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:08
2025-03-13 19:15:38,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7667 secs
2025-03-13 19:15:38,863 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 19:15:38,863 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 19:15:53,836 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9729 secs
2025-03-13 19:15:53,838 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0097 secs
2025-03-13 19:15:53,838 [INFO]: {
2025-03-13 19:15:53,838 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:53,838 [INFO]: 	index_param: efSearch=186
2025-03-13 19:15:53,838 [INFO]: 	index_path: knn.index
2025-03-13 19:15:53,838 [INFO]: 	size in bytes: 510353590
2025-03-13 19:15:53,838 [INFO]: 	avg_search_speed_ms: 8.267810900415995
2025-03-13 19:15:53,838 [INFO]: 	99p_search_speed_ms: 15.527928071096541
2025-03-13 19:15:53,838 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:53,838 [INFO]: 	nb vectors: 2594
2025-03-13 19:15:53,838 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:53,838 [INFO]: 	compression ratio: 0.999309423883939
2025-03-13 19:15:53,838 [INFO]: }
2025-03-13 19:15:53,838 [INFO]: 	>>> Finished "Creating the index" in 48.0112 secs
2025-03-13 19:15:53,838 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0355 secs
2025-03-13 19:15:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 89158 [episode count 6/20]
[retrieval_preprocessing] for episode 93765 [episode count 7/20], we have num_retrieval=np.int64(2528) num_query=np.int64(138)
2025-03-13 19:15:55,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:55,657 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:55
2025-03-13 19:15:55,657 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.91it/s]
2025-03-13 19:15:55,685 [INFO]: There are 2528 embeddings of dim 49152
2025-03-13 19:15:55,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:15:55,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:55
2025-03-13 19:15:55,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:55,686 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:15:55,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:55,686 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:15:55,686 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:55
2025-03-13 19:15:55,687 [INFO]: 521.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:55,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:15:55,687 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:55
2025-03-13 19:15:55,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:55,687 [INFO]: 	Creating the index 03/13/2025, 19:15:55
2025-03-13 19:15:55,687 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:55
2025-03-13 19:15:55,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:15:55,690 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:55
2025-03-13 19:15:55,691 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:15:55,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.23it/s] 30%|███       | 3/10 [00:00<00:00, 10.40it/s] 50%|█████     | 5/10 [00:00<00:00, 11.30it/s] 70%|███████   | 7/10 [00:00<00:00, 11.75it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.95it/s]100%|██████████| 10/10 [00:02<00:00,  4.23it/s]
2025-03-13 19:15:58,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:58
2025-03-13 19:16:22,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2940 secs
2025-03-13 19:16:22,360 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 19:16:22,360 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 19:16:39,231 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8711 secs
2025-03-13 19:16:39,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8441 secs
2025-03-13 19:16:39,535 [INFO]: {
2025-03-13 19:16:39,535 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:39,535 [INFO]: 	index_param: efSearch=269
2025-03-13 19:16:39,535 [INFO]: 	index_path: knn.index
2025-03-13 19:16:39,535 [INFO]: 	size in bytes: 497368330
2025-03-13 19:16:39,535 [INFO]: 	avg_search_speed_ms: 9.973180256756105
2025-03-13 19:16:39,535 [INFO]: 	99p_search_speed_ms: 12.693858854472637
2025-03-13 19:16:39,535 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:39,535 [INFO]: 	nb vectors: 2528
2025-03-13 19:16:39,536 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:39,536 [INFO]: 	compression ratio: 0.9993097550059128
2025-03-13 19:16:39,536 [INFO]: }
2025-03-13 19:16:39,536 [INFO]: 	>>> Finished "Creating the index" in 43.8484 secs
2025-03-13 19:16:39,536 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8785 secs
2025-03-13 19:16:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 93765 [episode count 7/20]
[retrieval_preprocessing] for episode 75343 [episode count 8/20], we have num_retrieval=np.int64(2570) num_query=np.int64(96)
2025-03-13 19:16:42,131 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:42,562 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:42
2025-03-13 19:16:42,563 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 19:16:42,593 [INFO]: There are 2570 embeddings of dim 49152
2025-03-13 19:16:42,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 19:16:42,594 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:42
2025-03-13 19:16:42,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:42,594 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:16:42,594 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:42,595 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 19:16:42,595 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:42
2025-03-13 19:16:42,595 [INFO]: 530.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:42,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:16:42,596 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:42
2025-03-13 19:16:42,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:42,596 [INFO]: 	Creating the index 03/13/2025, 19:16:42
2025-03-13 19:16:42,596 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:42
2025-03-13 19:16:42,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 19:16:42,600 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:42
2025-03-13 19:16:42,600 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:16:42,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.57it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.31it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.19it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.79it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.51it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.62it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.45it/s]100%|██████████| 11/11 [00:02<00:00,  2.27it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
2025-03-13 19:16:45,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:16:45
2025-03-13 19:17:13,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9164 secs
2025-03-13 19:17:13,462 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 19:17:13,462 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 19:17:31,549 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0875 secs
2025-03-13 19:17:31,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9511 secs
2025-03-13 19:17:31,551 [INFO]: {
2025-03-13 19:17:31,551 [INFO]: 	index_key: HNSW15
2025-03-13 19:17:31,551 [INFO]: 	index_param: efSearch=231
2025-03-13 19:17:31,551 [INFO]: 	index_path: knn.index
2025-03-13 19:17:31,551 [INFO]: 	size in bytes: 505631590
2025-03-13 19:17:31,551 [INFO]: 	avg_search_speed_ms: 8.447730462452258
2025-03-13 19:17:31,551 [INFO]: 	99p_search_speed_ms: 11.792858678381894
2025-03-13 19:17:31,551 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:17:31,551 [INFO]: 	nb vectors: 2570
2025-03-13 19:17:31,552 [INFO]: 	vectors dimension: 49152
2025-03-13 19:17:31,552 [INFO]: 	compression ratio: 0.999309714806387
2025-03-13 19:17:31,552 [INFO]: }
2025-03-13 19:17:31,552 [INFO]: 	>>> Finished "Creating the index" in 48.9552 secs
2025-03-13 19:17:31,552 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9890 secs
2025-03-13 19:17:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 75343 [episode count 8/20]
[retrieval_preprocessing] for episode 49245 [episode count 9/20], we have num_retrieval=np.int64(2574) num_query=np.int64(92)
2025-03-13 19:17:33,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:33,526 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:33
2025-03-13 19:17:33,526 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1123.57it/s]
2025-03-13 19:17:33,554 [INFO]: There are 2574 embeddings of dim 49152
2025-03-13 19:17:33,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 19:17:33,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:33
2025-03-13 19:17:33,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:33,555 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:17:33,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:33,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:17:33,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:33
2025-03-13 19:17:33,556 [INFO]: 531.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:33,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:17:33,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:33
2025-03-13 19:17:33,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:33,556 [INFO]: 	Creating the index 03/13/2025, 19:17:33
2025-03-13 19:17:33,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:33
2025-03-13 19:17:33,559 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:17:33,559 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:33
2025-03-13 19:17:33,560 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:17:33,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.09it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.93it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.45it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.64it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.79it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.88it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.92it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.05it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.04it/s]100%|██████████| 11/11 [00:02<00:00,  1.71it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]
2025-03-13 19:17:36,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:36
2025-03-13 19:18:01,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1890 secs
2025-03-13 19:18:01,587 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 19:18:01,587 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 19:18:19,353 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7663 secs
2025-03-13 19:18:19,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7959 secs
2025-03-13 19:18:19,355 [INFO]: {
2025-03-13 19:18:19,355 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:19,356 [INFO]: 	index_param: efSearch=200
2025-03-13 19:18:19,356 [INFO]: 	index_path: knn.index
2025-03-13 19:18:19,356 [INFO]: 	size in bytes: 506418610
2025-03-13 19:18:19,356 [INFO]: 	avg_search_speed_ms: 7.447877881462768
2025-03-13 19:18:19,356 [INFO]: 	99p_search_speed_ms: 10.369596921373155
2025-03-13 19:18:19,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:19,356 [INFO]: 	nb vectors: 2574
2025-03-13 19:18:19,356 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:19,356 [INFO]: 	compression ratio: 0.9993096264767996
2025-03-13 19:18:19,356 [INFO]: }
2025-03-13 19:18:19,356 [INFO]: 	>>> Finished "Creating the index" in 45.7994 secs
2025-03-13 19:18:19,356 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8297 secs
2025-03-13 19:18:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 49245 [episode count 9/20]
[retrieval_preprocessing] for episode 31326 [episode count 10/20], we have num_retrieval=np.int64(2461) num_query=np.int64(205)
2025-03-13 19:18:20,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:21,013 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:21
2025-03-13 19:18:21,013 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1397.64it/s]
2025-03-13 19:18:21,039 [INFO]: There are 2461 embeddings of dim 49152
2025-03-13 19:18:21,039 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 19:18:21,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:21
2025-03-13 19:18:21,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:21,040 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:18:21,040 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:21,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:18:21,040 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:21
2025-03-13 19:18:21,040 [INFO]: 507.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:21,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:18:21,041 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:21
2025-03-13 19:18:21,041 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:21,041 [INFO]: 	Creating the index 03/13/2025, 19:18:21
2025-03-13 19:18:21,041 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:21
2025-03-13 19:18:21,044 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:18:21,044 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:21
2025-03-13 19:18:21,044 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:18:21,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.19it/s] 30%|███       | 3/10 [00:00<00:00, 10.57it/s] 50%|█████     | 5/10 [00:00<00:00, 11.48it/s] 70%|███████   | 7/10 [00:00<00:00, 11.84it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.20it/s]100%|██████████| 10/10 [00:02<00:00,  3.88it/s]
2025-03-13 19:18:23,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:23
2025-03-13 19:18:50,612 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9783 secs
2025-03-13 19:18:50,612 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 19:18:50,612 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 19:19:08,551 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9385 secs
2025-03-13 19:19:08,553 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5082 secs
2025-03-13 19:19:08,553 [INFO]: {
2025-03-13 19:19:08,553 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:08,553 [INFO]: 	index_param: efSearch=259
2025-03-13 19:19:08,553 [INFO]: 	index_path: knn.index
2025-03-13 19:19:08,553 [INFO]: 	size in bytes: 484186390
2025-03-13 19:19:08,553 [INFO]: 	avg_search_speed_ms: 10.013910950636035
2025-03-13 19:19:08,553 [INFO]: 	99p_search_speed_ms: 14.228048636578022
2025-03-13 19:19:08,553 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:08,553 [INFO]: 	nb vectors: 2461
2025-03-13 19:19:08,553 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:08,553 [INFO]: 	compression ratio: 0.9993099723435018
2025-03-13 19:19:08,553 [INFO]: }
2025-03-13 19:19:08,553 [INFO]: 	>>> Finished "Creating the index" in 47.5118 secs
2025-03-13 19:19:08,553 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5399 secs
2025-03-13 19:19:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 31326 [episode count 10/20]
[retrieval_preprocessing] for episode 63587 [episode count 11/20], we have num_retrieval=np.int64(2504) num_query=np.int64(162)
2025-03-13 19:19:11,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:11,881 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:11
2025-03-13 19:19:11,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1722.51it/s]
2025-03-13 19:19:11,907 [INFO]: There are 2504 embeddings of dim 49152
2025-03-13 19:19:11,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:19:11,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:11
2025-03-13 19:19:11,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:11,908 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:19:11,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:11,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:19:11,909 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:11
2025-03-13 19:19:11,909 [INFO]: 516.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:11,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:19:11,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:11
2025-03-13 19:19:11,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:11,910 [INFO]: 	Creating the index 03/13/2025, 19:19:11
2025-03-13 19:19:11,910 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:11
2025-03-13 19:19:11,913 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:19:11,913 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:11
2025-03-13 19:19:11,913 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:19:11,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.97it/s] 30%|███       | 3/10 [00:00<00:00,  8.45it/s] 40%|████      | 4/10 [00:00<00:00,  8.48it/s] 50%|█████     | 5/10 [00:00<00:00,  8.64it/s] 60%|██████    | 6/10 [00:00<00:00,  8.65it/s] 80%|████████  | 8/10 [00:00<00:00,  9.37it/s]100%|██████████| 10/10 [00:02<00:00,  2.18it/s]100%|██████████| 10/10 [00:02<00:00,  3.50it/s]
2025-03-13 19:19:14,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:14
2025-03-13 19:19:39,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6346 secs
2025-03-13 19:19:39,581 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 19:19:39,582 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 19:19:59,385 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8026 secs
2025-03-13 19:19:59,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4736 secs
2025-03-13 19:19:59,387 [INFO]: {
2025-03-13 19:19:59,387 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:59,387 [INFO]: 	index_param: efSearch=258
2025-03-13 19:19:59,387 [INFO]: 	index_path: knn.index
2025-03-13 19:19:59,387 [INFO]: 	size in bytes: 492646330
2025-03-13 19:19:59,387 [INFO]: 	avg_search_speed_ms: 9.991634102839676
2025-03-13 19:19:59,387 [INFO]: 	99p_search_speed_ms: 15.596610959619284
2025-03-13 19:19:59,387 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:59,387 [INFO]: 	nb vectors: 2504
2025-03-13 19:19:59,387 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:59,387 [INFO]: 	compression ratio: 0.9993100567703407
2025-03-13 19:19:59,387 [INFO]: }
2025-03-13 19:19:59,387 [INFO]: 	>>> Finished "Creating the index" in 47.4773 secs
2025-03-13 19:19:59,387 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5060 secs
2025-03-13 19:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 63587 [episode count 11/20]
[retrieval_preprocessing] for episode 61057 [episode count 12/20], we have num_retrieval=np.int64(2574) num_query=np.int64(92)
2025-03-13 19:20:01,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:02,023 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:02
2025-03-13 19:20:02,023 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-13 19:20:02,047 [INFO]: There are 2574 embeddings of dim 49152
2025-03-13 19:20:02,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 19:20:02,047 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:02
2025-03-13 19:20:02,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:02,047 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:20:02,047 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:02,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:20:02,047 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:02
2025-03-13 19:20:02,047 [INFO]: 531.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:02,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:20:02,047 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:02
2025-03-13 19:20:02,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:02,048 [INFO]: 	Creating the index 03/13/2025, 19:20:02
2025-03-13 19:20:02,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:02
2025-03-13 19:20:02,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:20:02,049 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:02
2025-03-13 19:20:02,049 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:20:02,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.63it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.57it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.26it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.91it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.19it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.41it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]
2025-03-13 19:20:04,689 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:04
2025-03-13 19:20:32,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0399 secs
2025-03-13 19:20:32,730 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 19:20:32,730 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 19:20:48,125 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3948 secs
2025-03-13 19:20:48,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1180 secs
2025-03-13 19:20:48,167 [INFO]: {
2025-03-13 19:20:48,167 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:48,167 [INFO]: 	index_param: efSearch=225
2025-03-13 19:20:48,167 [INFO]: 	index_path: knn.index
2025-03-13 19:20:48,167 [INFO]: 	size in bytes: 506418610
2025-03-13 19:20:48,167 [INFO]: 	avg_search_speed_ms: 9.040799621782295
2025-03-13 19:20:48,167 [INFO]: 	99p_search_speed_ms: 12.372893956489863
2025-03-13 19:20:48,167 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:48,167 [INFO]: 	nb vectors: 2574
2025-03-13 19:20:48,167 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:48,167 [INFO]: 	compression ratio: 0.9993096264767996
2025-03-13 19:20:48,167 [INFO]: }
2025-03-13 19:20:48,168 [INFO]: 	>>> Finished "Creating the index" in 46.1199 secs
2025-03-13 19:20:48,168 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1441 secs
2025-03-13 19:20:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 61057 [episode count 12/20]
[retrieval_preprocessing] for episode 1689 [episode count 13/20], we have num_retrieval=np.int64(2533) num_query=np.int64(133)
2025-03-13 19:20:49,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:49,900 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:49
2025-03-13 19:20:49,900 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2133.42it/s]
2025-03-13 19:20:49,922 [INFO]: There are 2533 embeddings of dim 49152
2025-03-13 19:20:49,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 19:20:49,923 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:49
2025-03-13 19:20:49,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:49,923 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:20:49,923 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:49,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:20:49,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:49
2025-03-13 19:20:49,923 [INFO]: 522.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:49,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:20:49,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:49
2025-03-13 19:20:49,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:49,923 [INFO]: 	Creating the index 03/13/2025, 19:20:49
2025-03-13 19:20:49,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:49
2025-03-13 19:20:49,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:20:49,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:49
2025-03-13 19:20:49,924 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:20:49,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.97it/s] 30%|███       | 3/10 [00:00<00:00, 10.27it/s] 50%|█████     | 5/10 [00:00<00:00, 11.66it/s] 70%|███████   | 7/10 [00:00<00:00, 11.92it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.19it/s]100%|██████████| 10/10 [00:02<00:00,  4.22it/s]
2025-03-13 19:20:52,303 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:52
2025-03-13 19:21:21,933 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6297 secs
2025-03-13 19:21:21,934 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:21:21,934 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-13 19:21:44,700 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7664 secs
2025-03-13 19:21:44,702 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7779 secs
2025-03-13 19:21:44,702 [INFO]: {
2025-03-13 19:21:44,702 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:44,702 [INFO]: 	index_param: efSearch=257
2025-03-13 19:21:44,702 [INFO]: 	index_path: knn.index
2025-03-13 19:21:44,702 [INFO]: 	size in bytes: 498352090
2025-03-13 19:21:44,702 [INFO]: 	avg_search_speed_ms: 9.468511488883065
2025-03-13 19:21:44,702 [INFO]: 	99p_search_speed_ms: 13.363922026474029
2025-03-13 19:21:44,702 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:44,702 [INFO]: 	nb vectors: 2533
2025-03-13 19:21:44,702 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:44,702 [INFO]: 	compression ratio: 0.9993096728058269
2025-03-13 19:21:44,702 [INFO]: }
2025-03-13 19:21:44,702 [INFO]: 	>>> Finished "Creating the index" in 54.7792 secs
2025-03-13 19:21:44,702 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8024 secs
2025-03-13 19:21:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 1689 [episode count 13/20]
[retrieval_preprocessing] for episode 94372 [episode count 14/20], we have num_retrieval=np.int64(2509) num_query=np.int64(157)
2025-03-13 19:21:47,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:47,762 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:47
2025-03-13 19:21:47,762 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1220.34it/s]
2025-03-13 19:21:47,788 [INFO]: There are 2509 embeddings of dim 49152
2025-03-13 19:21:47,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 19:21:47,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:47
2025-03-13 19:21:47,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:47,789 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:21:47,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:47,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:47,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:47
2025-03-13 19:21:47,789 [INFO]: 517.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:47,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:21:47,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:47
2025-03-13 19:21:47,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:47,789 [INFO]: 	Creating the index 03/13/2025, 19:21:47
2025-03-13 19:21:47,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:47
2025-03-13 19:21:47,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:21:47,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:47
2025-03-13 19:21:47,790 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:21:47,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.90it/s] 30%|███       | 3/10 [00:00<00:00, 10.47it/s] 50%|█████     | 5/10 [00:00<00:00, 11.63it/s] 70%|███████   | 7/10 [00:00<00:00, 11.98it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.25it/s]100%|██████████| 10/10 [00:02<00:00,  4.46it/s]
2025-03-13 19:21:50,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:50
2025-03-13 19:22:16,795 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7580 secs
2025-03-13 19:22:16,795 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 19:22:16,795 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 19:22:32,702 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9069 secs
2025-03-13 19:22:32,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9134 secs
2025-03-13 19:22:32,704 [INFO]: {
2025-03-13 19:22:32,704 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:32,704 [INFO]: 	index_param: efSearch=233
2025-03-13 19:22:32,704 [INFO]: 	index_path: knn.index
2025-03-13 19:22:32,704 [INFO]: 	size in bytes: 493630150
2025-03-13 19:22:32,704 [INFO]: 	avg_search_speed_ms: 8.081941795365985
2025-03-13 19:22:32,704 [INFO]: 	99p_search_speed_ms: 11.348765464499595
2025-03-13 19:22:32,704 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:32,704 [INFO]: 	nb vectors: 2509
2025-03-13 19:22:32,704 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:32,704 [INFO]: 	compression ratio: 0.999309851717931
2025-03-13 19:22:32,704 [INFO]: }
2025-03-13 19:22:32,704 [INFO]: 	>>> Finished "Creating the index" in 44.9150 secs
2025-03-13 19:22:32,704 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9420 secs
2025-03-13 19:22:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 94372 [episode count 14/20]
[retrieval_preprocessing] for episode 20139 [episode count 15/20], we have num_retrieval=np.int64(2528) num_query=np.int64(138)
2025-03-13 19:22:34,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:35,257 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:35
2025-03-13 19:22:35,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1034.86it/s]
2025-03-13 19:22:35,282 [INFO]: There are 2528 embeddings of dim 49152
2025-03-13 19:22:35,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 19:22:35,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:35
2025-03-13 19:22:35,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:35,282 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:22:35,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:35,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:22:35,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:35
2025-03-13 19:22:35,282 [INFO]: 521.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:35,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:22:35,283 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:35
2025-03-13 19:22:35,283 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:35,283 [INFO]: 	Creating the index 03/13/2025, 19:22:35
2025-03-13 19:22:35,283 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:35
2025-03-13 19:22:35,284 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:22:35,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:35
2025-03-13 19:22:35,284 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:22:35,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.17it/s] 30%|███       | 3/10 [00:00<00:00, 10.11it/s] 50%|█████     | 5/10 [00:00<00:00, 11.39it/s] 70%|███████   | 7/10 [00:00<00:00, 12.01it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.33it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-13 19:22:37,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:37
2025-03-13 19:23:04,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0078 secs
2025-03-13 19:23:04,709 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 19:23:04,709 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.45it/s]
2025-03-13 19:23:24,299 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5897 secs
2025-03-13 19:23:24,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0166 secs
2025-03-13 19:23:24,301 [INFO]: {
2025-03-13 19:23:24,301 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:24,301 [INFO]: 	index_param: efSearch=254
2025-03-13 19:23:24,301 [INFO]: 	index_path: knn.index
2025-03-13 19:23:24,301 [INFO]: 	size in bytes: 497368330
2025-03-13 19:23:24,301 [INFO]: 	avg_search_speed_ms: 9.864004116452113
2025-03-13 19:23:24,301 [INFO]: 	99p_search_speed_ms: 13.535112850368023
2025-03-13 19:23:24,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:24,301 [INFO]: 	nb vectors: 2528
2025-03-13 19:23:24,301 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:24,301 [INFO]: 	compression ratio: 0.9993097550059128
2025-03-13 19:23:24,301 [INFO]: }
2025-03-13 19:23:24,301 [INFO]: 	>>> Finished "Creating the index" in 49.0182 secs
2025-03-13 19:23:24,301 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0440 secs
2025-03-13 19:23:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 20139 [episode count 15/20]
[retrieval_preprocessing] for episode 29368 [episode count 16/20], we have num_retrieval=np.int64(2516) num_query=np.int64(150)
2025-03-13 19:23:27,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:27,505 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:27
2025-03-13 19:23:27,505 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1849.34it/s]
2025-03-13 19:23:27,531 [INFO]: There are 2516 embeddings of dim 49152
2025-03-13 19:23:27,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:23:27,532 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:27
2025-03-13 19:23:27,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:27,532 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:23:27,532 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:27,532 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:23:27,532 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:27
2025-03-13 19:23:27,533 [INFO]: 519.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:27,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:23:27,533 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:27
2025-03-13 19:23:27,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:27,533 [INFO]: 	Creating the index 03/13/2025, 19:23:27
2025-03-13 19:23:27,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:27
2025-03-13 19:23:27,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 19:23:27,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:27
2025-03-13 19:23:27,537 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:23:27,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.52it/s] 30%|███       | 3/10 [00:00<00:00, 11.70it/s] 50%|█████     | 5/10 [00:00<00:00, 13.42it/s] 70%|███████   | 7/10 [00:00<00:00, 14.29it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.86it/s]100%|██████████| 10/10 [00:02<00:00,  4.34it/s]
2025-03-13 19:23:30,069 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:30
2025-03-13 19:23:56,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0515 secs
2025-03-13 19:23:56,121 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 19:23:56,121 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-13 19:24:14,554 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4329 secs
2025-03-13 19:24:14,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0198 secs
2025-03-13 19:24:14,556 [INFO]: {
2025-03-13 19:24:14,556 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:14,556 [INFO]: 	index_param: efSearch=258
2025-03-13 19:24:14,556 [INFO]: 	index_path: knn.index
2025-03-13 19:24:14,556 [INFO]: 	size in bytes: 495007330
2025-03-13 19:24:14,557 [INFO]: 	avg_search_speed_ms: 9.9643127180161
2025-03-13 19:24:14,557 [INFO]: 	99p_search_speed_ms: 13.427363601513207
2025-03-13 19:24:14,557 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:14,557 [INFO]: 	nb vectors: 2516
2025-03-13 19:24:14,557 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:14,557 [INFO]: 	compression ratio: 0.999309905168475
2025-03-13 19:24:14,557 [INFO]: }
2025-03-13 19:24:14,557 [INFO]: 	>>> Finished "Creating the index" in 47.0232 secs
2025-03-13 19:24:14,557 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0519 secs
2025-03-13 19:24:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 29368 [episode count 16/20]
[retrieval_preprocessing] for episode 67773 [episode count 17/20], we have num_retrieval=np.int64(2577) num_query=np.int64(89)
2025-03-13 19:24:16,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:17,318 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:17
2025-03-13 19:24:17,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-13 19:24:17,339 [INFO]: There are 2577 embeddings of dim 49152
2025-03-13 19:24:17,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0212 secs
2025-03-13 19:24:17,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:17
2025-03-13 19:24:17,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:17,339 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:24:17,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:17,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:24:17,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:17
2025-03-13 19:24:17,339 [INFO]: 531.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:17,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:24:17,339 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:17
2025-03-13 19:24:17,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:17,339 [INFO]: 	Creating the index 03/13/2025, 19:24:17
2025-03-13 19:24:17,339 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:17
2025-03-13 19:24:17,340 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:24:17,340 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:17
2025-03-13 19:24:17,340 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:24:17,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.83it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.01it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.60it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.05it/s]100%|██████████| 11/11 [00:02<00:00,  3.05it/s]100%|██████████| 11/11 [00:02<00:00,  4.65it/s]
2025-03-13 19:24:19,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:19
2025-03-13 19:24:46,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8140 secs
2025-03-13 19:24:46,525 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 19:24:46,525 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s]
2025-03-13 19:25:01,603 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0781 secs
2025-03-13 19:25:01,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2645 secs
2025-03-13 19:25:01,605 [INFO]: {
2025-03-13 19:25:01,605 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:01,605 [INFO]: 	index_param: efSearch=242
2025-03-13 19:25:01,605 [INFO]: 	index_path: knn.index
2025-03-13 19:25:01,605 [INFO]: 	size in bytes: 507008950
2025-03-13 19:25:01,605 [INFO]: 	avg_search_speed_ms: 7.612166804179289
2025-03-13 19:25:01,605 [INFO]: 	99p_search_speed_ms: 10.117429287638513
2025-03-13 19:25:01,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:01,605 [INFO]: 	nb vectors: 2577
2025-03-13 19:25:01,605 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:01,605 [INFO]: 	compression ratio: 0.9993094125853202
2025-03-13 19:25:01,605 [INFO]: }
2025-03-13 19:25:01,605 [INFO]: 	>>> Finished "Creating the index" in 44.2658 secs
2025-03-13 19:25:01,605 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2876 secs
2025-03-13 19:25:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 67773 [episode count 17/20]
[retrieval_preprocessing] for episode 59603 [episode count 18/20], we have num_retrieval=np.int64(2438) num_query=np.int64(228)
2025-03-13 19:25:03,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:03,446 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:03
2025-03-13 19:25:03,446 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.80it/s]
2025-03-13 19:25:03,470 [INFO]: There are 2438 embeddings of dim 49152
2025-03-13 19:25:03,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 19:25:03,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:03
2025-03-13 19:25:03,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:03,470 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 19:25:03,471 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:03,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:03,471 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:03
2025-03-13 19:25:03,471 [INFO]: 503.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:03,471 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:03,471 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:03
2025-03-13 19:25:03,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:03,471 [INFO]: 	Creating the index 03/13/2025, 19:25:03
2025-03-13 19:25:03,471 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:03
2025-03-13 19:25:03,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:25:03,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:03
2025-03-13 19:25:03,472 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 19:25:03,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.85it/s] 30%|███       | 3/10 [00:00<00:00, 10.79it/s] 50%|█████     | 5/10 [00:00<00:00, 12.09it/s] 70%|███████   | 7/10 [00:00<00:00, 12.53it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.49it/s]100%|██████████| 10/10 [00:02<00:00,  4.53it/s]
2025-03-13 19:25:05,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:05
2025-03-13 19:25:31,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5341 secs
2025-03-13 19:25:31,217 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 19:25:31,217 [INFO]: 	Compute fast metrics 03/13/2025, 19:25:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-13 19:25:46,850 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6322 secs
2025-03-13 19:25:46,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3794 secs
2025-03-13 19:25:46,852 [INFO]: {
2025-03-13 19:25:46,852 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:46,852 [INFO]: 	index_param: efSearch=233
2025-03-13 19:25:46,852 [INFO]: 	index_path: knn.index
2025-03-13 19:25:46,852 [INFO]: 	size in bytes: 479661310
2025-03-13 19:25:46,852 [INFO]: 	avg_search_speed_ms: 9.423536262988454
2025-03-13 19:25:46,852 [INFO]: 	99p_search_speed_ms: 15.821598004549909
2025-03-13 19:25:46,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:46,852 [INFO]: 	nb vectors: 2438
2025-03-13 19:25:46,852 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:46,852 [INFO]: 	compression ratio: 0.9993099172413968
2025-03-13 19:25:46,852 [INFO]: }
2025-03-13 19:25:46,852 [INFO]: 	>>> Finished "Creating the index" in 43.3810 secs
2025-03-13 19:25:46,852 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4056 secs
2025-03-13 19:25:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 59603 [episode count 18/20]
[retrieval_preprocessing] for episode 39136 [episode count 19/20], we have num_retrieval=np.int64(2529) num_query=np.int64(137)
2025-03-13 19:25:49,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:50,041 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:50
2025-03-13 19:25:50,041 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.81it/s]
2025-03-13 19:25:50,066 [INFO]: There are 2529 embeddings of dim 49152
2025-03-13 19:25:50,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 19:25:50,067 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:50
2025-03-13 19:25:50,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:50,067 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 19:25:50,067 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:50,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:50,067 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:50
2025-03-13 19:25:50,067 [INFO]: 521.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:50,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:25:50,067 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:50
2025-03-13 19:25:50,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:50,067 [INFO]: 	Creating the index 03/13/2025, 19:25:50
2025-03-13 19:25:50,067 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:50
2025-03-13 19:25:50,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:25:50,068 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:50
2025-03-13 19:25:50,068 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 19:25:50,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.60it/s] 30%|███       | 3/10 [00:00<00:00, 10.00it/s] 50%|█████     | 5/10 [00:00<00:00, 11.12it/s] 70%|███████   | 7/10 [00:00<00:00, 11.80it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.94it/s]
2025-03-13 19:25:52,616 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:52
2025-03-13 19:26:18,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3345 secs
2025-03-13 19:26:18,952 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 19:26:18,952 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 19:26:42,325 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3736 secs
2025-03-13 19:26:42,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4868 secs
2025-03-13 19:26:42,555 [INFO]: {
2025-03-13 19:26:42,556 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:42,556 [INFO]: 	index_param: efSearch=247
2025-03-13 19:26:42,556 [INFO]: 	index_path: knn.index
2025-03-13 19:26:42,556 [INFO]: 	size in bytes: 497565130
2025-03-13 19:26:42,556 [INFO]: 	avg_search_speed_ms: 9.88016220770423
2025-03-13 19:26:42,556 [INFO]: 	99p_search_speed_ms: 13.817209722474217
2025-03-13 19:26:42,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:42,556 [INFO]: 	nb vectors: 2529
2025-03-13 19:26:42,556 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:42,556 [INFO]: 	compression ratio: 0.9993096421366988
2025-03-13 19:26:42,556 [INFO]: }
2025-03-13 19:26:42,556 [INFO]: 	>>> Finished "Creating the index" in 52.4889 secs
2025-03-13 19:26:42,556 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5154 secs
2025-03-13 19:26:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 39136 [episode count 19/20]
2025-03-13 19:26:43: [retrieval_preprocessing] finished for 8922050678_open_bin [chosen_id count 9/196]
2025-03-13 19:26:43: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
