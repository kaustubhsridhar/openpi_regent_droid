Using cache found in /home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
2025-03-13 16:34:41: [embed_episodes] skipping episode 28175 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 31298 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 42068 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 50772 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 57957 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 19577 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 21636 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 42117 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 39074 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 85183 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 4288 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 70883 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 92536 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 21370 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 37317 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 2008 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 46361 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 62258 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 29510 [episode count 18/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 51037 [episode count 19/20]
2025-03-13 16:34:41: [embed_episodes] finished embedding all episodes for 8922050678_close_bin [chosen_id count 0/196]
2025-03-13 16:34:41: [embed_episodes] skipping episode 66561 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 87946 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 55436 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 8594 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 3989 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 85776 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 57763 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 65035 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 29745 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 90677 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 92983 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 5564 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 35906 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 4805 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 39889 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 60242 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 78425 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 52964 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 38373 [episode count 18/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 75108 [episode count 19/20]
2025-03-13 16:34:41: [embed_episodes] finished embedding all episodes for 9042802994_remove_pen_from_mug_put_on_table [chosen_id count 1/196]
2025-03-13 16:34:41: [embed_episodes] skipping episode 58037 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 2231 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 80569 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 46671 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 56392 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 28858 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 94502 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 84291 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 2943 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 74741 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 28387 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 90467 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 29022 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 73601 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 85483 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 7076 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 41766 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 12437 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 80521 [episode count 18/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 56443 [episode count 19/20]
2025-03-13 16:34:41: [embed_episodes] finished embedding all episodes for 9130122211_put_marker_in_cup [chosen_id count 2/196]
2025-03-13 16:34:41: [embed_episodes] skipping episode 83992 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 73247 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 8749 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 85551 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 30268 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 56383 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 12368 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 93268 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 55898 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 76923 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 74369 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 58001 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 95331 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 94908 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 75965 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 87231 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 7873 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 23752 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 91401 [episode count 18/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 7947 [episode count 19/20]
2025-03-13 16:34:41: [embed_episodes] finished embedding all episodes for 9130122211_remove_marker_from_mug_put_on_table [chosen_id count 3/196]
2025-03-13 16:34:41: [embed_episodes] skipping episode 92692 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 59414 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 53 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 74307 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 75331 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 26224 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 66175 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 46208 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 4744 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 73358 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 63643 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 70304 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 86178 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 53427 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 64182 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 54985 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 83666 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 65242 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 38619 [episode count 18/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 77536 [episode count 19/20]
2025-03-13 16:34:41: [embed_episodes] finished embedding all episodes for 9154343709_close_drawer [chosen_id count 4/196]
2025-03-13 16:34:41: [embed_episodes] skipping episode 66055 [episode count 0/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 62507 [episode count 1/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 94253 [episode count 2/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 65600 [episode count 3/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 44638 [episode count 4/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 13483 [episode count 5/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 7353 [episode count 6/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 2307 [episode count 7/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 94472 [episode count 8/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 15122 [episode count 9/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 76058 [episode count 10/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 79660 [episode count 11/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 71990 [episode count 12/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 40265 [episode count 13/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 77134 [episode count 14/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 9573 [episode count 15/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 66927 [episode count 16/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 5002 [episode count 17/20]
2025-03-13 16:34:41: [embed_episodes] skipping episode 9618 [episode count 18/20]
2025-03-13 16:34:42: [embed_episodes] embedded episode 13718 with 89 steps [episode count 19/20]
2025-03-13 16:34:42: [embed_episodes] finished embedding all episodes for 9154343709_close_open_drawer [chosen_id count 5/196]
2025-03-13 16:34:42: [embed_episodes] skipping episode 22537 [episode count 0/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 58405 [episode count 1/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 85546 [episode count 2/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 23632 [episode count 3/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 46220 [episode count 4/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 7828 [episode count 5/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 92845 [episode count 6/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 89262 [episode count 7/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 17066 [episode count 8/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 67774 [episode count 9/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 89819 [episode count 10/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 76012 [episode count 11/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 48889 [episode count 12/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 1275 [episode count 13/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 6405 [episode count 14/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 74034 [episode count 15/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 49466 [episode count 16/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 10051 [episode count 17/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 71569 [episode count 18/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 85382 [episode count 19/20]
2025-03-13 16:34:42: [embed_episodes] finished embedding all episodes for 9186164821_put_lid_on_table [chosen_id count 6/196]
2025-03-13 16:34:42: [embed_episodes] skipping episode 33793 [episode count 0/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 24066 [episode count 1/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 54276 [episode count 2/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 24587 [episode count 3/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 26646 [episode count 4/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 9267 [episode count 5/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 22579 [episode count 6/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 3127 [episode count 7/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 59979 [episode count 8/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 35927 [episode count 9/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 37464 [episode count 10/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 91767 [episode count 11/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 83064 [episode count 12/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 53881 [episode count 13/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 44155 [episode count 14/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 75387 [episode count 15/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 36997 [episode count 16/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 17046 [episode count 17/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 30358 [episode count 18/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 48278 [episode count 19/20]
2025-03-13 16:34:42: [embed_episodes] finished embedding all episodes for 9306310171_put_tape_on_plate [chosen_id count 7/196]
2025-03-13 16:34:42: [embed_episodes] skipping episode 26627 [episode count 0/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 44559 [episode count 1/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 50193 [episode count 2/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 81437 [episode count 3/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 18465 [episode count 4/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 57385 [episode count 5/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 57897 [episode count 6/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 63020 [episode count 7/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 78393 [episode count 8/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 8776 [episode count 9/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 51786 [episode count 10/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 63570 [episode count 11/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 51799 [episode count 12/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 40028 [episode count 13/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 28256 [episode count 14/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 63075 [episode count 15/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 11370 [episode count 16/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 51828 [episode count 17/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 31371 [episode count 18/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 32400 [episode count 19/20]
2025-03-13 16:34:42: [embed_episodes] finished embedding all episodes for 9306310171_remove_pen_put_on_table [chosen_id count 8/196]
2025-03-13 16:34:42: [embed_episodes] skipping episode 22017 [episode count 0/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 36354 [episode count 1/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 84488 [episode count 2/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 5650 [episode count 3/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 8215 [episode count 4/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 36901 [episode count 5/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 49189 [episode count 6/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 48168 [episode count 7/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 35887 [episode count 8/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 9777 [episode count 9/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 15933 [episode count 10/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 62035 [episode count 11/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 14938 [episode count 12/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 10334 [episode count 13/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 30825 [episode count 14/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 36462 [episode count 15/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 6802 [episode count 16/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 77972 [episode count 17/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 73879 [episode count 18/20]
2025-03-13 16:34:42: [embed_episodes] skipping episode 71321 [episode count 19/20]
2025-03-13 16:34:42: [embed_episodes] finished embedding all episodes for 9461650657_remove_one_tissue_and_place_on_table [chosen_id count 9/196]
2025-03-13 16:34:42: [embed_episodes] done!
2025-03-13 16:34:42: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 16:34:45: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 8922050678_close_bin [chosen_id count 0/196]
2025-03-13 16:34:45: [retrieval_preprocessing] we have num_total=3311 embedding_dim=49152
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 28175 [episode count 0/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 31298 [episode count 1/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 42068 [episode count 2/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 50772 [episode count 3/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 57957 [episode count 4/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 19577 [episode count 5/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 21636 [episode count 6/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 42117 [episode count 7/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 39074 [episode count 8/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 85183 [episode count 9/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 4288 [episode count 10/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 70883 [episode count 11/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 92536 [episode count 12/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 21370 [episode count 13/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 37317 [episode count 14/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 2008 [episode count 15/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 46361 [episode count 16/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 62258 [episode count 17/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 29510 [episode count 18/20]
2025-03-13 16:34:45: [retrieval_preprocessing] skipping episode 51037 [episode count 19/20]
2025-03-13 16:34:45: [retrieval_preprocessing] finished for 8922050678_close_bin [chosen_id count 0/196]
2025-03-13 16:34:47: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9042802994_remove_pen_from_mug_put_on_table [chosen_id count 1/196]
2025-03-13 16:34:47: [retrieval_preprocessing] we have num_total=2339 embedding_dim=49152
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 66561 [episode count 0/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 87946 [episode count 1/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 55436 [episode count 2/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 8594 [episode count 3/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 3989 [episode count 4/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 85776 [episode count 5/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 57763 [episode count 6/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 65035 [episode count 7/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 29745 [episode count 8/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 90677 [episode count 9/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 92983 [episode count 10/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 5564 [episode count 11/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 35906 [episode count 12/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 4805 [episode count 13/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 39889 [episode count 14/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 60242 [episode count 15/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 78425 [episode count 16/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 52964 [episode count 17/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 38373 [episode count 18/20]
2025-03-13 16:34:47: [retrieval_preprocessing] skipping episode 75108 [episode count 19/20]
2025-03-13 16:34:47: [retrieval_preprocessing] finished for 9042802994_remove_pen_from_mug_put_on_table [chosen_id count 1/196]
2025-03-13 16:34:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9130122211_put_marker_in_cup [chosen_id count 2/196]
2025-03-13 16:34:49: [retrieval_preprocessing] we have num_total=4121 embedding_dim=49152
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 58037 [episode count 0/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 2231 [episode count 1/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 80569 [episode count 2/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 46671 [episode count 3/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 56392 [episode count 4/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 28858 [episode count 5/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 94502 [episode count 6/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 84291 [episode count 7/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 2943 [episode count 8/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 74741 [episode count 9/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 28387 [episode count 10/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 90467 [episode count 11/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 29022 [episode count 12/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 73601 [episode count 13/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 85483 [episode count 14/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 7076 [episode count 15/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 41766 [episode count 16/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 12437 [episode count 17/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 80521 [episode count 18/20]
2025-03-13 16:34:49: [retrieval_preprocessing] skipping episode 56443 [episode count 19/20]
2025-03-13 16:34:49: [retrieval_preprocessing] finished for 9130122211_put_marker_in_cup [chosen_id count 2/196]
2025-03-13 16:34:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9130122211_remove_marker_from_mug_put_on_table [chosen_id count 3/196]
2025-03-13 16:34:51: [retrieval_preprocessing] we have num_total=3254 embedding_dim=49152
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 83992 [episode count 0/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 73247 [episode count 1/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 8749 [episode count 2/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 85551 [episode count 3/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 30268 [episode count 4/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 56383 [episode count 5/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 12368 [episode count 6/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 93268 [episode count 7/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 55898 [episode count 8/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 76923 [episode count 9/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 74369 [episode count 10/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 58001 [episode count 11/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 95331 [episode count 12/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 94908 [episode count 13/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 75965 [episode count 14/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 87231 [episode count 15/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 7873 [episode count 16/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 23752 [episode count 17/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 91401 [episode count 18/20]
2025-03-13 16:34:51: [retrieval_preprocessing] skipping episode 7947 [episode count 19/20]
2025-03-13 16:34:51: [retrieval_preprocessing] finished for 9130122211_remove_marker_from_mug_put_on_table [chosen_id count 3/196]
2025-03-13 16:34:53: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9154343709_close_drawer [chosen_id count 4/196]
2025-03-13 16:34:53: [retrieval_preprocessing] we have num_total=1874 embedding_dim=49152
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 92692 [episode count 0/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 59414 [episode count 1/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 53 [episode count 2/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 74307 [episode count 3/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 75331 [episode count 4/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 26224 [episode count 5/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 66175 [episode count 6/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 46208 [episode count 7/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 4744 [episode count 8/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 73358 [episode count 9/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 63643 [episode count 10/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 70304 [episode count 11/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 86178 [episode count 12/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 53427 [episode count 13/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 64182 [episode count 14/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 54985 [episode count 15/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 83666 [episode count 16/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 65242 [episode count 17/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 38619 [episode count 18/20]
2025-03-13 16:34:53: [retrieval_preprocessing] skipping episode 77536 [episode count 19/20]
2025-03-13 16:34:53: [retrieval_preprocessing] finished for 9154343709_close_drawer [chosen_id count 4/196]
2025-03-13 16:34:53: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9154343709_close_open_drawer [chosen_id count 5/196]
2025-03-13 16:34:53: [retrieval_preprocessing] we have num_total=1710 embedding_dim=49152
[retrieval_preprocessing] for episode 66055 [episode count 0/20], we have num_retrieval=np.int64(1620) num_query=np.int64(90)
2025-03-13 16:34:53,928 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:54,251 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:54
2025-03-13 16:34:54,252 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 11.88it/s]
2025-03-13 16:34:54,417 [INFO]: There are 1620 embeddings of dim 49152
2025-03-13 16:34:54,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1656 secs
2025-03-13 16:34:54,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:54
2025-03-13 16:34:54,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:54,418 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:34:54,418 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:54,418 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:34:54,418 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:54
2025-03-13 16:34:54,420 [INFO]: 334.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:54,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0016 secs
2025-03-13 16:34:54,420 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:54
2025-03-13 16:34:54,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:54,420 [INFO]: 	Creating the index 03/13/2025, 16:34:54
2025-03-13 16:34:54,421 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:54
2025-03-13 16:34:54,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 16:34:54,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:54
2025-03-13 16:34:54,424 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:34:54,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.90it/s]100%|██████████| 7/7 [00:01<00:00,  3.98it/s]100%|██████████| 7/7 [00:01<00:00,  4.26it/s]
2025-03-13 16:34:56,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:56
2025-03-13 16:35:20,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1319 secs
2025-03-13 16:35:20,717 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 16:35:20,717 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-13 16:35:44,358 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6405 secs
2025-03-13 16:35:44,360 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9359 secs
2025-03-13 16:35:44,360 [INFO]: {
2025-03-13 16:35:44,360 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:44,360 [INFO]: 	index_param: efSearch=276
2025-03-13 16:35:44,360 [INFO]: 	index_path: knn.index
2025-03-13 16:35:44,360 [INFO]: 	size in bytes: 318725230
2025-03-13 16:35:44,360 [INFO]: 	avg_search_speed_ms: 9.79012563809162
2025-03-13 16:35:44,360 [INFO]: 	99p_search_speed_ms: 12.459630751982331
2025-03-13 16:35:44,360 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:44,360 [INFO]: 	nb vectors: 1620
2025-03-13 16:35:44,360 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:44,360 [INFO]: 	compression ratio: 0.999308903157745
2025-03-13 16:35:44,360 [INFO]: }
2025-03-13 16:35:44,360 [INFO]: 	>>> Finished "Creating the index" in 49.9395 secs
2025-03-13 16:35:44,360 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1085 secs
2025-03-13 16:35:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 66055 [episode count 0/20]
[retrieval_preprocessing] for episode 62507 [episode count 1/20], we have num_retrieval=np.int64(1611) num_query=np.int64(99)
2025-03-13 16:35:45,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:45,455 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:45
2025-03-13 16:35:45,455 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-13 16:35:45,488 [INFO]: There are 1611 embeddings of dim 49152
2025-03-13 16:35:45,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 16:35:45,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:45,488 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:35:45,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:45,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:45,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,489 [INFO]: 332.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:45,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:35:45,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:45
2025-03-13 16:35:45,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:45,489 [INFO]: 	Creating the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:45
2025-03-13 16:35:45,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:35:45,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:45
2025-03-13 16:35:45,490 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:35:45,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.44it/s]100%|██████████| 7/7 [00:01<00:00,  3.96it/s]100%|██████████| 7/7 [00:01<00:00,  4.24it/s]
2025-03-13 16:35:47,146 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:47
2025-03-13 16:36:15,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9942 secs
2025-03-13 16:36:15,140 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 16:36:15,140 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.76it/s]
2025-03-13 16:36:38,066 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9253 secs
2025-03-13 16:36:38,068 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5777 secs
2025-03-13 16:36:38,068 [INFO]: {
2025-03-13 16:36:38,068 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:38,068 [INFO]: 	index_param: efSearch=247
2025-03-13 16:36:38,068 [INFO]: 	index_path: knn.index
2025-03-13 16:36:38,068 [INFO]: 	size in bytes: 316954510
2025-03-13 16:36:38,068 [INFO]: 	avg_search_speed_ms: 9.664077682708557
2025-03-13 16:36:38,068 [INFO]: 	99p_search_speed_ms: 12.644736738875508
2025-03-13 16:36:38,068 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:38,068 [INFO]: 	nb vectors: 1611
2025-03-13 16:36:38,068 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:38,068 [INFO]: 	compression ratio: 0.9993089797018506
2025-03-13 16:36:38,068 [INFO]: }
2025-03-13 16:36:38,068 [INFO]: 	>>> Finished "Creating the index" in 52.5792 secs
2025-03-13 16:36:38,068 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6126 secs
2025-03-13 16:36:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 62507 [episode count 1/20]
[retrieval_preprocessing] for episode 94253 [episode count 2/20], we have num_retrieval=np.int64(1643) num_query=np.int64(67)
2025-03-13 16:36:39,229 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:39,664 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:39
2025-03-13 16:36:39,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.66it/s]
2025-03-13 16:36:39,704 [INFO]: There are 1643 embeddings of dim 49152
2025-03-13 16:36:39,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 16:36:39,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:39,705 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:36:39,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:39,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:36:39,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,705 [INFO]: 339.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:39,706 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:36:39,706 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:39
2025-03-13 16:36:39,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:39,706 [INFO]: 	Creating the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,706 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:39
2025-03-13 16:36:39,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 16:36:39,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:39
2025-03-13 16:36:39,708 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:36:39,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 16.36it/s]100%|██████████| 7/7 [00:01<00:00,  3.65it/s]100%|██████████| 7/7 [00:01<00:00,  3.90it/s]
2025-03-13 16:36:41,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:41
2025-03-13 16:37:10,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2142 secs
2025-03-13 16:37:10,722 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 16:37:10,722 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.14it/s]
2025-03-13 16:37:30,347 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6257 secs
2025-03-13 16:37:30,349 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6406 secs
2025-03-13 16:37:30,349 [INFO]: {
2025-03-13 16:37:30,349 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:30,349 [INFO]: 	index_param: efSearch=253
2025-03-13 16:37:30,349 [INFO]: 	index_path: knn.index
2025-03-13 16:37:30,349 [INFO]: 	size in bytes: 323250310
2025-03-13 16:37:30,349 [INFO]: 	avg_search_speed_ms: 9.981142811499492
2025-03-13 16:37:30,349 [INFO]: 	99p_search_speed_ms: 19.395296731963764
2025-03-13 16:37:30,349 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:30,349 [INFO]: 	nb vectors: 1643
2025-03-13 16:37:30,349 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:30,349 [INFO]: 	compression ratio: 0.9993089998892809
2025-03-13 16:37:30,349 [INFO]: }
2025-03-13 16:37:30,349 [INFO]: 	>>> Finished "Creating the index" in 50.6433 secs
2025-03-13 16:37:30,349 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6850 secs
2025-03-13 16:37:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 94253 [episode count 2/20]
[retrieval_preprocessing] for episode 65600 [episode count 3/20], we have num_retrieval=np.int64(1606) num_query=np.int64(104)
2025-03-13 16:37:31,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:32,306 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:32
2025-03-13 16:37:32,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1528.54it/s]
2025-03-13 16:37:32,354 [INFO]: There are 1606 embeddings of dim 49152
2025-03-13 16:37:32,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0486 secs
2025-03-13 16:37:32,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:32
2025-03-13 16:37:32,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:32,355 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:37:32,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:32,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:37:32,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:32
2025-03-13 16:37:32,355 [INFO]: 331.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:32,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:37:32,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:32
2025-03-13 16:37:32,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:32,356 [INFO]: 	Creating the index 03/13/2025, 16:37:32
2025-03-13 16:37:32,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:32
2025-03-13 16:37:32,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:37:32,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:32
2025-03-13 16:37:32,358 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:37:32,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.81it/s]100%|██████████| 7/7 [00:01<00:00,  4.70it/s]100%|██████████| 7/7 [00:01<00:00,  5.00it/s]
2025-03-13 16:37:33,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:33
2025-03-13 16:37:54,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.9583 secs
2025-03-13 16:37:54,721 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 16:37:54,721 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.75it/s]
2025-03-13 16:38:20,779 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0573 secs
2025-03-13 16:38:20,781 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4230 secs
2025-03-13 16:38:20,781 [INFO]: {
2025-03-13 16:38:20,781 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:20,781 [INFO]: 	index_param: efSearch=289
2025-03-13 16:38:20,781 [INFO]: 	index_path: knn.index
2025-03-13 16:38:20,781 [INFO]: 	size in bytes: 315970810
2025-03-13 16:38:20,781 [INFO]: 	avg_search_speed_ms: 15.381620104711216
2025-03-13 16:38:20,781 [INFO]: 	99p_search_speed_ms: 27.9104913235642
2025-03-13 16:38:20,781 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:20,781 [INFO]: 	nb vectors: 1606
2025-03-13 16:38:20,781 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:20,781 [INFO]: 	compression ratio: 0.9993089171749757
2025-03-13 16:38:20,781 [INFO]: }
2025-03-13 16:38:20,781 [INFO]: 	>>> Finished "Creating the index" in 48.4254 secs
2025-03-13 16:38:20,781 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4750 secs
2025-03-13 16:38:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 65600 [episode count 3/20]
[retrieval_preprocessing] for episode 44638 [episode count 4/20], we have num_retrieval=np.int64(1647) num_query=np.int64(63)
2025-03-13 16:38:22,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:22,912 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:22
2025-03-13 16:38:22,913 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1648.06it/s]
2025-03-13 16:38:22,949 [INFO]: There are 1647 embeddings of dim 49152
2025-03-13 16:38:22,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 16:38:22,949 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:22
2025-03-13 16:38:22,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:22,949 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:38:22,949 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:22,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:22,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:22
2025-03-13 16:38:22,950 [INFO]: 339.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:22,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:38:22,950 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:22
2025-03-13 16:38:22,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:22,950 [INFO]: 	Creating the index 03/13/2025, 16:38:22
2025-03-13 16:38:22,950 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:22
2025-03-13 16:38:22,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:22,951 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:22
2025-03-13 16:38:22,951 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:38:22,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:01,  5.86it/s] 57%|█████▋    | 4/7 [00:00<00:00, 15.67it/s]100%|██████████| 7/7 [00:02<00:00,  2.20it/s]100%|██████████| 7/7 [00:02<00:00,  2.63it/s]
2025-03-13 16:38:25,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:25
2025-03-13 16:39:05,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2404 secs
2025-03-13 16:39:05,858 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:39:05,858 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.76it/s]
2025-03-13 16:39:21,074 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2152 secs
2025-03-13 16:39:21,076 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1245 secs
2025-03-13 16:39:21,076 [INFO]: {
2025-03-13 16:39:21,076 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:21,076 [INFO]: 	index_param: efSearch=179
2025-03-13 16:39:21,076 [INFO]: 	index_path: knn.index
2025-03-13 16:39:21,076 [INFO]: 	size in bytes: 324037330
2025-03-13 16:39:21,076 [INFO]: 	avg_search_speed_ms: 10.903750551862474
2025-03-13 16:39:21,076 [INFO]: 	99p_search_speed_ms: 14.205017434433103
2025-03-13 16:39:21,076 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:21,076 [INFO]: 	nb vectors: 1647
2025-03-13 16:39:21,076 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:21,076 [INFO]: 	compression ratio: 0.9993088635806251
2025-03-13 16:39:21,076 [INFO]: }
2025-03-13 16:39:21,076 [INFO]: 	>>> Finished "Creating the index" in 58.1264 secs
2025-03-13 16:39:21,076 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1638 secs
2025-03-13 16:39:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 44638 [episode count 4/20]
[retrieval_preprocessing] for episode 13483 [episode count 5/20], we have num_retrieval=np.int64(1639) num_query=np.int64(71)
2025-03-13 16:39:21,733 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:22,042 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:22
2025-03-13 16:39:22,042 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1015.32it/s]
2025-03-13 16:39:22,083 [INFO]: There are 1639 embeddings of dim 49152
2025-03-13 16:39:22,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0406 secs
2025-03-13 16:39:22,083 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:22,083 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:39:22,083 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:22,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:39:22,083 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,083 [INFO]: 338.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:22,083 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:39:22,083 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:22
2025-03-13 16:39:22,083 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:22,084 [INFO]: 	Creating the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:22
2025-03-13 16:39:22,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:39:22,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:22
2025-03-13 16:39:22,085 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:39:22,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.77it/s]100%|██████████| 7/7 [00:01<00:00,  3.91it/s]100%|██████████| 7/7 [00:01<00:00,  4.19it/s]
2025-03-13 16:39:23,759 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:23
2025-03-13 16:39:48,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9946 secs
2025-03-13 16:39:48,754 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 16:39:48,754 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 16:40:14,766 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0117 secs
2025-03-13 16:40:14,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6827 secs
2025-03-13 16:40:14,768 [INFO]: {
2025-03-13 16:40:14,768 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:14,768 [INFO]: 	index_param: efSearch=246
2025-03-13 16:40:14,768 [INFO]: 	index_path: knn.index
2025-03-13 16:40:14,768 [INFO]: 	size in bytes: 322463350
2025-03-13 16:40:14,768 [INFO]: 	avg_search_speed_ms: 8.373227297840094
2025-03-13 16:40:14,768 [INFO]: 	99p_search_speed_ms: 11.495352894999087
2025-03-13 16:40:14,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:14,768 [INFO]: 	nb vectors: 1639
2025-03-13 16:40:14,768 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:14,768 [INFO]: 	compression ratio: 0.9993089509241903
2025-03-13 16:40:14,768 [INFO]: }
2025-03-13 16:40:14,768 [INFO]: 	>>> Finished "Creating the index" in 52.6845 secs
2025-03-13 16:40:14,768 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7260 secs
2025-03-13 16:40:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 13483 [episode count 5/20]
[retrieval_preprocessing] for episode 7353 [episode count 6/20], we have num_retrieval=np.int64(1622) num_query=np.int64(88)
2025-03-13 16:40:15,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:15,596 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:15
2025-03-13 16:40:15,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.51it/s]
2025-03-13 16:40:15,625 [INFO]: There are 1622 embeddings of dim 49152
2025-03-13 16:40:15,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:40:15,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:15,625 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:40:15,625 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:15,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:40:15,625 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,625 [INFO]: 334.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:15,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:40:15,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:15
2025-03-13 16:40:15,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:15,625 [INFO]: 	Creating the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:15
2025-03-13 16:40:15,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:40:15,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:15
2025-03-13 16:40:15,627 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:40:15,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.53it/s]100%|██████████| 7/7 [00:01<00:00,  5.22it/s]100%|██████████| 7/7 [00:01<00:00,  5.31it/s]
2025-03-13 16:40:16,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:16
2025-03-13 16:40:36,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4592 secs
2025-03-13 16:40:36,409 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 16:40:36,409 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 16:41:04,347 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9372 secs
2025-03-13 16:41:04,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7215 secs
2025-03-13 16:41:04,348 [INFO]: {
2025-03-13 16:41:04,348 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:04,348 [INFO]: 	index_param: efSearch=227
2025-03-13 16:41:04,348 [INFO]: 	index_path: knn.index
2025-03-13 16:41:04,348 [INFO]: 	size in bytes: 319118770
2025-03-13 16:41:04,348 [INFO]: 	avg_search_speed_ms: 9.352411851992567
2025-03-13 16:41:04,348 [INFO]: 	99p_search_speed_ms: 13.281736355274914
2025-03-13 16:41:04,348 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:04,348 [INFO]: 	nb vectors: 1622
2025-03-13 16:41:04,348 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:04,348 [INFO]: 	compression ratio: 0.9993087401283227
2025-03-13 16:41:04,348 [INFO]: }
2025-03-13 16:41:04,349 [INFO]: 	>>> Finished "Creating the index" in 48.7231 secs
2025-03-13 16:41:04,349 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7525 secs
2025-03-13 16:41:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 7353 [episode count 6/20]
[retrieval_preprocessing] for episode 2307 [episode count 7/20], we have num_retrieval=np.int64(1628) num_query=np.int64(82)
2025-03-13 16:41:05,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:05,398 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:05
2025-03-13 16:41:05,398 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 782.23it/s]
2025-03-13 16:41:05,439 [INFO]: There are 1628 embeddings of dim 49152
2025-03-13 16:41:05,440 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 16:41:05,440 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:05
2025-03-13 16:41:05,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:05,441 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:41:05,441 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:05,441 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:41:05,441 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:05
2025-03-13 16:41:05,442 [INFO]: 336.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:05,442 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:05,442 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:05
2025-03-13 16:41:05,442 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:05,442 [INFO]: 	Creating the index 03/13/2025, 16:41:05
2025-03-13 16:41:05,442 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:05
2025-03-13 16:41:05,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:41:05,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:05
2025-03-13 16:41:05,446 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:41:05,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.09it/s]100%|██████████| 7/7 [00:01<00:00,  3.90it/s]100%|██████████| 7/7 [00:01<00:00,  4.17it/s]
2025-03-13 16:41:07,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:07
2025-03-13 16:41:35,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1005 secs
2025-03-13 16:41:35,230 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 16:41:35,230 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 16:41:53,741 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5101 secs
2025-03-13 16:41:53,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2963 secs
2025-03-13 16:41:53,742 [INFO]: {
2025-03-13 16:41:53,742 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:53,742 [INFO]: 	index_param: efSearch=249
2025-03-13 16:41:53,742 [INFO]: 	index_path: knn.index
2025-03-13 16:41:53,742 [INFO]: 	size in bytes: 320299210
2025-03-13 16:41:53,742 [INFO]: 	avg_search_speed_ms: 11.121410638761102
2025-03-13 16:41:53,742 [INFO]: 	99p_search_speed_ms: 15.075378655456003
2025-03-13 16:41:53,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:53,742 [INFO]: 	nb vectors: 1628
2025-03-13 16:41:53,742 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:53,742 [INFO]: 	compression ratio: 0.9993088150295469
2025-03-13 16:41:53,742 [INFO]: }
2025-03-13 16:41:53,742 [INFO]: 	>>> Finished "Creating the index" in 48.3001 secs
2025-03-13 16:41:53,742 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3438 secs
2025-03-13 16:41:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 2307 [episode count 7/20]
[retrieval_preprocessing] for episode 94472 [episode count 8/20], we have num_retrieval=np.int64(1632) num_query=np.int64(78)
2025-03-13 16:41:55,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:55,892 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:55
2025-03-13 16:41:55,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1892.74it/s]
2025-03-13 16:41:55,923 [INFO]: There are 1632 embeddings of dim 49152
2025-03-13 16:41:55,924 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 16:41:55,924 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:55
2025-03-13 16:41:55,924 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:55,924 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:41:55,924 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:55,924 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:41:55,924 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:55
2025-03-13 16:41:55,925 [INFO]: 336.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:55,925 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:55,925 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:55
2025-03-13 16:41:55,925 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:55,925 [INFO]: 	Creating the index 03/13/2025, 16:41:55
2025-03-13 16:41:55,925 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:55
2025-03-13 16:41:55,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 16:41:55,928 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:55
2025-03-13 16:41:55,928 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:41:55,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.64it/s] 57%|█████▋    | 4/7 [00:00<00:00, 19.79it/s]100%|██████████| 7/7 [00:01<00:00,  2.96it/s]100%|██████████| 7/7 [00:01<00:00,  3.54it/s]
2025-03-13 16:41:57,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:57
2025-03-13 16:42:19,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0234 secs
2025-03-13 16:42:19,932 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 16:42:19,932 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 16:42:36,579 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6469 secs
2025-03-13 16:42:36,581 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6532 secs
2025-03-13 16:42:36,581 [INFO]: {
2025-03-13 16:42:36,581 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:36,581 [INFO]: 	index_param: efSearch=217
2025-03-13 16:42:36,581 [INFO]: 	index_path: knn.index
2025-03-13 16:42:36,581 [INFO]: 	size in bytes: 321086170
2025-03-13 16:42:36,581 [INFO]: 	avg_search_speed_ms: 9.729018643931468
2025-03-13 16:42:36,581 [INFO]: 	99p_search_speed_ms: 15.118718249723345
2025-03-13 16:42:36,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:36,581 [INFO]: 	nb vectors: 1632
2025-03-13 16:42:36,581 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:36,581 [INFO]: 	compression ratio: 0.9993088646577335
2025-03-13 16:42:36,581 [INFO]: }
2025-03-13 16:42:36,581 [INFO]: 	>>> Finished "Creating the index" in 40.6560 secs
2025-03-13 16:42:36,581 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6889 secs
2025-03-13 16:42:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 94472 [episode count 8/20]
[retrieval_preprocessing] for episode 15122 [episode count 9/20], we have num_retrieval=np.int64(1605) num_query=np.int64(105)
2025-03-13 16:42:37,315 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:37,613 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:37
2025-03-13 16:42:37,613 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.74it/s]
2025-03-13 16:42:37,653 [INFO]: There are 1605 embeddings of dim 49152
2025-03-13 16:42:37,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0398 secs
2025-03-13 16:42:37,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:37
2025-03-13 16:42:37,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:37,653 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:42:37,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:37,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:42:37,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:37
2025-03-13 16:42:37,654 [INFO]: 331.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:37,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:42:37,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:37
2025-03-13 16:42:37,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:37,654 [INFO]: 	Creating the index 03/13/2025, 16:42:37
2025-03-13 16:42:37,654 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:37
2025-03-13 16:42:37,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:42:37,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:37
2025-03-13 16:42:37,656 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:42:37,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.97it/s] 86%|████████▌ | 6/7 [00:00<00:00, 30.22it/s]100%|██████████| 7/7 [00:01<00:00,  4.29it/s]
2025-03-13 16:42:39,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:39
2025-03-13 16:43:03,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3147 secs
2025-03-13 16:43:03,606 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 16:43:03,606 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 16:43:29,870 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2645 secs
2025-03-13 16:43:29,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2165 secs
2025-03-13 16:43:29,872 [INFO]: {
2025-03-13 16:43:29,872 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:29,872 [INFO]: 	index_param: efSearch=235
2025-03-13 16:43:29,872 [INFO]: 	index_path: knn.index
2025-03-13 16:43:29,872 [INFO]: 	size in bytes: 315774070
2025-03-13 16:43:29,872 [INFO]: 	avg_search_speed_ms: 10.753753954815048
2025-03-13 16:43:29,872 [INFO]: 	99p_search_speed_ms: 15.951605511363598
2025-03-13 16:43:29,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:29,872 [INFO]: 	nb vectors: 1605
2025-03-13 16:43:29,872 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:29,872 [INFO]: 	compression ratio: 0.9993089046228527
2025-03-13 16:43:29,872 [INFO]: }
2025-03-13 16:43:29,872 [INFO]: 	>>> Finished "Creating the index" in 52.2183 secs
2025-03-13 16:43:29,872 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2591 secs
2025-03-13 16:43:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 15122 [episode count 9/20]
[retrieval_preprocessing] for episode 76058 [episode count 10/20], we have num_retrieval=np.int64(1623) num_query=np.int64(87)
2025-03-13 16:43:31,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:31,590 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:31
2025-03-13 16:43:31,590 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 929.18it/s]
2025-03-13 16:43:31,623 [INFO]: There are 1623 embeddings of dim 49152
2025-03-13 16:43:31,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 16:43:31,623 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:31
2025-03-13 16:43:31,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:31,624 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:43:31,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:31,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:43:31,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:31
2025-03-13 16:43:31,625 [INFO]: 334.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:31,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:43:31,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:31
2025-03-13 16:43:31,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:31,625 [INFO]: 	Creating the index 03/13/2025, 16:43:31
2025-03-13 16:43:31,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:31
2025-03-13 16:43:31,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:43:31,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:31
2025-03-13 16:43:31,629 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:43:31,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.09it/s] 86%|████████▌ | 6/7 [00:00<00:00, 28.53it/s]100%|██████████| 7/7 [00:01<00:00,  4.12it/s]
2025-03-13 16:43:34,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:34
2025-03-13 16:44:03,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6620 secs
2025-03-13 16:44:03,689 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 16:44:03,689 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.57it/s]
2025-03-13 16:44:19,804 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1144 secs
2025-03-13 16:44:19,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1764 secs
2025-03-13 16:44:19,805 [INFO]: {
2025-03-13 16:44:19,805 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:19,805 [INFO]: 	index_param: efSearch=252
2025-03-13 16:44:19,805 [INFO]: 	index_path: knn.index
2025-03-13 16:44:19,805 [INFO]: 	size in bytes: 319315510
2025-03-13 16:44:19,806 [INFO]: 	avg_search_speed_ms: 11.761752820080694
2025-03-13 16:44:19,806 [INFO]: 	99p_search_speed_ms: 18.42760488158092
2025-03-13 16:44:19,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:19,806 [INFO]: 	nb vectors: 1623
2025-03-13 16:44:19,806 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:19,806 [INFO]: 	compression ratio: 0.9993087526503176
2025-03-13 16:44:19,806 [INFO]: }
2025-03-13 16:44:19,806 [INFO]: 	>>> Finished "Creating the index" in 48.1804 secs
2025-03-13 16:44:19,806 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2158 secs
2025-03-13 16:44:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 76058 [episode count 10/20]
[retrieval_preprocessing] for episode 79660 [episode count 11/20], we have num_retrieval=np.int64(1610) num_query=np.int64(100)
2025-03-13 16:44:20,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:20,843 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:20
2025-03-13 16:44:20,844 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.01it/s]
2025-03-13 16:44:20,879 [INFO]: There are 1610 embeddings of dim 49152
2025-03-13 16:44:20,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 16:44:20,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:20
2025-03-13 16:44:20,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:20,879 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:44:20,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:20,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:44:20,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:20
2025-03-13 16:44:20,879 [INFO]: 332.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:20,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:44:20,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:20
2025-03-13 16:44:20,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:20,879 [INFO]: 	Creating the index 03/13/2025, 16:44:20
2025-03-13 16:44:20,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:20
2025-03-13 16:44:20,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:44:20,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:20
2025-03-13 16:44:20,881 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:44:20,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.19it/s] 71%|███████▏  | 5/7 [00:00<00:00, 25.18it/s]100%|██████████| 7/7 [00:01<00:00,  3.73it/s]
2025-03-13 16:44:22,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:22
2025-03-13 16:44:49,364 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6028 secs
2025-03-13 16:44:49,364 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:44:49,364 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-13 16:45:08,577 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2127 secs
2025-03-13 16:45:08,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6974 secs
2025-03-13 16:45:08,579 [INFO]: {
2025-03-13 16:45:08,579 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:08,579 [INFO]: 	index_param: efSearch=219
2025-03-13 16:45:08,579 [INFO]: 	index_path: knn.index
2025-03-13 16:45:08,579 [INFO]: 	size in bytes: 316757770
2025-03-13 16:45:08,579 [INFO]: 	avg_search_speed_ms: 8.329632790715781
2025-03-13 16:45:08,579 [INFO]: 	99p_search_speed_ms: 11.536531150341034
2025-03-13 16:45:08,579 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:08,579 [INFO]: 	nb vectors: 1610
2025-03-13 16:45:08,579 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:08,579 [INFO]: 	compression ratio: 0.9993089672275443
2025-03-13 16:45:08,579 [INFO]: }
2025-03-13 16:45:08,579 [INFO]: 	>>> Finished "Creating the index" in 47.6995 secs
2025-03-13 16:45:08,579 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7355 secs
2025-03-13 16:45:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 79660 [episode count 11/20]
[retrieval_preprocessing] for episode 71990 [episode count 12/20], we have num_retrieval=np.int64(1642) num_query=np.int64(68)
2025-03-13 16:45:09,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:09,626 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:09
2025-03-13 16:45:09,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.97it/s]
2025-03-13 16:45:09,661 [INFO]: There are 1642 embeddings of dim 49152
2025-03-13 16:45:09,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 16:45:09,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:09
2025-03-13 16:45:09,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:09,662 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:45:09,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:09,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:45:09,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:09
2025-03-13 16:45:09,662 [INFO]: 338.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:09,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:09,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:09
2025-03-13 16:45:09,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:09,662 [INFO]: 	Creating the index 03/13/2025, 16:45:09
2025-03-13 16:45:09,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:09
2025-03-13 16:45:09,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:45:09,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:09
2025-03-13 16:45:09,663 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:45:09,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.09it/s]100%|██████████| 7/7 [00:01<00:00,  5.12it/s]100%|██████████| 7/7 [00:01<00:00,  5.45it/s]
2025-03-13 16:45:10,951 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:10
2025-03-13 16:45:37,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2347 secs
2025-03-13 16:45:37,187 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 16:45:37,187 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s]
2025-03-13 16:46:02,196 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0087 secs
2025-03-13 16:46:02,198 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5344 secs
2025-03-13 16:46:02,198 [INFO]: {
2025-03-13 16:46:02,198 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:02,198 [INFO]: 	index_param: efSearch=279
2025-03-13 16:46:02,198 [INFO]: 	index_path: knn.index
2025-03-13 16:46:02,198 [INFO]: 	size in bytes: 323053570
2025-03-13 16:46:02,198 [INFO]: 	avg_search_speed_ms: 13.780291892008307
2025-03-13 16:46:02,198 [INFO]: 	99p_search_speed_ms: 19.820663263089955
2025-03-13 16:46:02,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:02,198 [INFO]: 	nb vectors: 1642
2025-03-13 16:46:02,198 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:02,198 [INFO]: 	compression ratio: 0.999308987670373
2025-03-13 16:46:02,198 [INFO]: }
2025-03-13 16:46:02,198 [INFO]: 	>>> Finished "Creating the index" in 52.5361 secs
2025-03-13 16:46:02,198 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5721 secs
2025-03-13 16:46:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 71990 [episode count 12/20]
[retrieval_preprocessing] for episode 40265 [episode count 13/20], we have num_retrieval=np.int64(1605) num_query=np.int64(105)
2025-03-13 16:46:02,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:03,193 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:03
2025-03-13 16:46:03,194 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.63it/s]
2025-03-13 16:46:03,222 [INFO]: There are 1605 embeddings of dim 49152
2025-03-13 16:46:03,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:46:03,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:03,223 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:46:03,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:03,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:46:03,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,223 [INFO]: 331.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:03,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:46:03,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:03
2025-03-13 16:46:03,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:03,223 [INFO]: 	Creating the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:03
2025-03-13 16:46:03,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:46:03,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:03
2025-03-13 16:46:03,224 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:46:03,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.03it/s] 57%|█████▋    | 4/7 [00:00<00:00, 19.67it/s]100%|██████████| 7/7 [00:01<00:00,  3.69it/s]100%|██████████| 7/7 [00:01<00:00,  4.35it/s]
2025-03-13 16:46:04,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:04
2025-03-13 16:46:29,960 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1229 secs
2025-03-13 16:46:29,960 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 16:46:29,960 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.18it/s]
2025-03-13 16:46:47,945 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9850 secs
2025-03-13 16:46:47,947 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7221 secs
2025-03-13 16:46:47,947 [INFO]: {
2025-03-13 16:46:47,947 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:47,947 [INFO]: 	index_param: efSearch=248
2025-03-13 16:46:47,947 [INFO]: 	index_path: knn.index
2025-03-13 16:46:47,947 [INFO]: 	size in bytes: 315774070
2025-03-13 16:46:47,947 [INFO]: 	avg_search_speed_ms: 9.19868853482955
2025-03-13 16:46:47,947 [INFO]: 	99p_search_speed_ms: 11.8011645693332
2025-03-13 16:46:47,947 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:47,947 [INFO]: 	nb vectors: 1605
2025-03-13 16:46:47,947 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:47,947 [INFO]: 	compression ratio: 0.9993089046228527
2025-03-13 16:46:47,947 [INFO]: }
2025-03-13 16:46:47,947 [INFO]: 	>>> Finished "Creating the index" in 44.7235 secs
2025-03-13 16:46:47,947 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7533 secs
2025-03-13 16:46:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 40265 [episode count 13/20]
[retrieval_preprocessing] for episode 77134 [episode count 14/20], we have num_retrieval=np.int64(1614) num_query=np.int64(96)
2025-03-13 16:46:48,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:49,133 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:49
2025-03-13 16:46:49,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-13 16:46:49,168 [INFO]: There are 1614 embeddings of dim 49152
2025-03-13 16:46:49,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 16:46:49,169 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:49
2025-03-13 16:46:49,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:49,169 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:46:49,169 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:49,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:46:49,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:49
2025-03-13 16:46:49,169 [INFO]: 333.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:49,170 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:46:49,170 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:49
2025-03-13 16:46:49,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:49,170 [INFO]: 	Creating the index 03/13/2025, 16:46:49
2025-03-13 16:46:49,170 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:49
2025-03-13 16:46:49,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 16:46:49,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:49
2025-03-13 16:46:49,172 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:46:49,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.59it/s]100%|██████████| 7/7 [00:01<00:00,  4.78it/s]100%|██████████| 7/7 [00:01<00:00,  5.10it/s]
2025-03-13 16:46:50,551 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:50
2025-03-13 16:47:13,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1263 secs
2025-03-13 16:47:13,678 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 16:47:13,678 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.89it/s]
2025-03-13 16:47:35,131 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4525 secs
2025-03-13 16:47:35,133 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9601 secs
2025-03-13 16:47:35,133 [INFO]: {
2025-03-13 16:47:35,133 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:35,133 [INFO]: 	index_param: efSearch=283
2025-03-13 16:47:35,133 [INFO]: 	index_path: knn.index
2025-03-13 16:47:35,133 [INFO]: 	size in bytes: 317544730
2025-03-13 16:47:35,133 [INFO]: 	avg_search_speed_ms: 10.778148561979018
2025-03-13 16:47:35,133 [INFO]: 	99p_search_speed_ms: 17.946969934273515
2025-03-13 16:47:35,133 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:35,133 [INFO]: 	nb vectors: 1614
2025-03-13 16:47:35,133 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:35,133 [INFO]: 	compression ratio: 0.9993090170320257
2025-03-13 16:47:35,133 [INFO]: }
2025-03-13 16:47:35,133 [INFO]: 	>>> Finished "Creating the index" in 45.9630 secs
2025-03-13 16:47:35,133 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9998 secs
2025-03-13 16:47:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 77134 [episode count 14/20]
[retrieval_preprocessing] for episode 9573 [episode count 15/20], we have num_retrieval=np.int64(1628) num_query=np.int64(82)
2025-03-13 16:47:36,114 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:37,223 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:37
2025-03-13 16:47:37,223 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 866.23it/s]
2025-03-13 16:47:37,250 [INFO]: There are 1628 embeddings of dim 49152
2025-03-13 16:47:37,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 16:47:37,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:37
2025-03-13 16:47:37,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:37,250 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:47:37,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:37,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:47:37,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:37
2025-03-13 16:47:37,251 [INFO]: 336.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:37,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:47:37,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:37
2025-03-13 16:47:37,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:37,251 [INFO]: 	Creating the index 03/13/2025, 16:47:37
2025-03-13 16:47:37,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:37
2025-03-13 16:47:37,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:47:37,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:37
2025-03-13 16:47:37,252 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:47:37,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 17.98it/s]100%|██████████| 7/7 [00:01<00:00,  5.24it/s]100%|██████████| 7/7 [00:01<00:00,  5.57it/s]
2025-03-13 16:47:38,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:38
2025-03-13 16:48:00,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1901 secs
2025-03-13 16:48:00,702 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 16:48:00,702 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.84it/s]
2025-03-13 16:48:23,525 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8222 secs
2025-03-13 16:48:23,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5835 secs
2025-03-13 16:48:23,836 [INFO]: {
2025-03-13 16:48:23,836 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:23,836 [INFO]: 	index_param: efSearch=286
2025-03-13 16:48:23,836 [INFO]: 	index_path: knn.index
2025-03-13 16:48:23,836 [INFO]: 	size in bytes: 320299210
2025-03-13 16:48:23,836 [INFO]: 	avg_search_speed_ms: 16.733008557167466
2025-03-13 16:48:23,836 [INFO]: 	99p_search_speed_ms: 28.089260971173637
2025-03-13 16:48:23,836 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:23,836 [INFO]: 	nb vectors: 1628
2025-03-13 16:48:23,836 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:23,836 [INFO]: 	compression ratio: 0.9993088150295469
2025-03-13 16:48:23,836 [INFO]: }
2025-03-13 16:48:23,836 [INFO]: 	>>> Finished "Creating the index" in 46.5856 secs
2025-03-13 16:48:23,836 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6137 secs
2025-03-13 16:48:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 9573 [episode count 15/20]
[retrieval_preprocessing] for episode 66927 [episode count 16/20], we have num_retrieval=np.int64(1628) num_query=np.int64(82)
2025-03-13 16:48:24,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:25,062 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:25
2025-03-13 16:48:25,062 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.66it/s]
2025-03-13 16:48:25,101 [INFO]: There are 1628 embeddings of dim 49152
2025-03-13 16:48:25,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 16:48:25,102 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:25
2025-03-13 16:48:25,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:25,102 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:48:25,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:25,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:25,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:25
2025-03-13 16:48:25,102 [INFO]: 336.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:25,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:25,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:25
2025-03-13 16:48:25,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:25,102 [INFO]: 	Creating the index 03/13/2025, 16:48:25
2025-03-13 16:48:25,102 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:25
2025-03-13 16:48:25,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:48:25,103 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:25
2025-03-13 16:48:25,103 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:48:25,103 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  8.18it/s] 86%|████████▌ | 6/7 [00:00<00:00, 28.12it/s]100%|██████████| 7/7 [00:01<00:00,  4.26it/s]
2025-03-13 16:48:26,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:26
2025-03-13 16:48:54,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6751 secs
2025-03-13 16:48:54,425 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:48:54,425 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.68it/s]
2025-03-13 16:49:09,905 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4794 secs
2025-03-13 16:49:09,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8035 secs
2025-03-13 16:49:09,907 [INFO]: {
2025-03-13 16:49:09,907 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:09,907 [INFO]: 	index_param: efSearch=242
2025-03-13 16:49:09,907 [INFO]: 	index_path: knn.index
2025-03-13 16:49:09,907 [INFO]: 	size in bytes: 320299210
2025-03-13 16:49:09,907 [INFO]: 	avg_search_speed_ms: 11.223502603835623
2025-03-13 16:49:09,907 [INFO]: 	99p_search_speed_ms: 21.30307844839991
2025-03-13 16:49:09,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:09,907 [INFO]: 	nb vectors: 1628
2025-03-13 16:49:09,907 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:09,907 [INFO]: 	compression ratio: 0.9993088150295469
2025-03-13 16:49:09,907 [INFO]: }
2025-03-13 16:49:09,907 [INFO]: 	>>> Finished "Creating the index" in 44.8052 secs
2025-03-13 16:49:09,907 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8455 secs
2025-03-13 16:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 66927 [episode count 16/20]
[retrieval_preprocessing] for episode 5002 [episode count 17/20], we have num_retrieval=np.int64(1638) num_query=np.int64(72)
2025-03-13 16:49:10,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:11,095 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:11
2025-03-13 16:49:11,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.60it/s]
2025-03-13 16:49:11,127 [INFO]: There are 1638 embeddings of dim 49152
2025-03-13 16:49:11,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 16:49:11,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:11,128 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:49:11,128 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:11,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:11,128 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,128 [INFO]: 338.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:11,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:49:11,128 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:11
2025-03-13 16:49:11,128 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:11,128 [INFO]: 	Creating the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,128 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:11
2025-03-13 16:49:11,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:49:11,130 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,130 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:49:11,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.80it/s] 86%|████████▌ | 6/7 [00:00<00:00, 31.76it/s]100%|██████████| 7/7 [00:01<00:00,  4.37it/s]
2025-03-13 16:49:12,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:12
2025-03-13 16:49:33,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4835 secs
2025-03-13 16:49:33,220 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 16:49:33,220 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.41it/s]
2025-03-13 16:49:54,482 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2616 secs
2025-03-13 16:49:54,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3540 secs
2025-03-13 16:49:54,484 [INFO]: {
2025-03-13 16:49:54,484 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:54,484 [INFO]: 	index_param: efSearch=207
2025-03-13 16:49:54,484 [INFO]: 	index_path: knn.index
2025-03-13 16:49:54,484 [INFO]: 	size in bytes: 322266610
2025-03-13 16:49:54,484 [INFO]: 	avg_search_speed_ms: 7.075431270581543
2025-03-13 16:49:54,484 [INFO]: 	99p_search_speed_ms: 9.289273433387274
2025-03-13 16:49:54,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:54,484 [INFO]: 	nb vectors: 1638
2025-03-13 16:49:54,484 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:54,484 [INFO]: 	compression ratio: 0.9993089386455519
2025-03-13 16:49:54,484 [INFO]: }
2025-03-13 16:49:54,484 [INFO]: 	>>> Finished "Creating the index" in 43.3556 secs
2025-03-13 16:49:54,484 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3887 secs
2025-03-13 16:49:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 5002 [episode count 17/20]
[retrieval_preprocessing] for episode 9618 [episode count 18/20], we have num_retrieval=np.int64(1628) num_query=np.int64(82)
2025-03-13 16:49:55,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:56,754 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:56
2025-03-13 16:49:56,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.62it/s]
2025-03-13 16:49:56,789 [INFO]: There are 1628 embeddings of dim 49152
2025-03-13 16:49:56,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 16:49:56,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:56
2025-03-13 16:49:56,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:56,789 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:49:56,789 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:56,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:56,789 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:56
2025-03-13 16:49:56,790 [INFO]: 336.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:56,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:49:56,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:56
2025-03-13 16:49:56,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:56,790 [INFO]: 	Creating the index 03/13/2025, 16:49:56
2025-03-13 16:49:56,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:56
2025-03-13 16:49:56,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:49:56,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:56
2025-03-13 16:49:56,791 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:49:56,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 29%|██▊       | 2/7 [00:00<00:00, 18.14it/s]100%|██████████| 7/7 [00:01<00:00,  4.62it/s]100%|██████████| 7/7 [00:01<00:00,  4.94it/s]
2025-03-13 16:49:58,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:58
2025-03-13 16:50:18,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9766 secs
2025-03-13 16:50:18,189 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 16:50:18,189 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.80it/s]
2025-03-13 16:50:45,264 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0747 secs
2025-03-13 16:50:45,265 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4747 secs
2025-03-13 16:50:45,266 [INFO]: {
2025-03-13 16:50:45,266 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:45,266 [INFO]: 	index_param: efSearch=328
2025-03-13 16:50:45,266 [INFO]: 	index_path: knn.index
2025-03-13 16:50:45,266 [INFO]: 	size in bytes: 320299210
2025-03-13 16:50:45,266 [INFO]: 	avg_search_speed_ms: 11.759646950436254
2025-03-13 16:50:45,266 [INFO]: 	99p_search_speed_ms: 16.561970463953912
2025-03-13 16:50:45,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:45,266 [INFO]: 	nb vectors: 1628
2025-03-13 16:50:45,266 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:45,266 [INFO]: 	compression ratio: 0.9993088150295469
2025-03-13 16:50:45,266 [INFO]: }
2025-03-13 16:50:45,266 [INFO]: 	>>> Finished "Creating the index" in 48.4761 secs
2025-03-13 16:50:45,266 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5112 secs
2025-03-13 16:50:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 9618 [episode count 18/20]
[retrieval_preprocessing] for episode 13718 [episode count 19/20], we have num_retrieval=np.int64(1621) num_query=np.int64(89)
2025-03-13 16:50:46,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:46,612 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:46
2025-03-13 16:50:46,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 936.44it/s]
2025-03-13 16:50:46,643 [INFO]: There are 1621 embeddings of dim 49152
2025-03-13 16:50:46,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 16:50:46,643 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:46
2025-03-13 16:50:46,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:46,643 [INFO]: 		-> Add: 0.9 seconds
2025-03-13 16:50:46,643 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:46,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:46,643 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:46
2025-03-13 16:50:46,643 [INFO]: 334.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:46,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:50:46,643 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:46
2025-03-13 16:50:46,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:46,643 [INFO]: 	Creating the index 03/13/2025, 16:50:46
2025-03-13 16:50:46,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:46
2025-03-13 16:50:46,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:50:46,645 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:46
2025-03-13 16:50:46,645 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-13 16:50:46,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:00,  9.97it/s] 71%|███████▏  | 5/7 [00:00<00:00, 26.50it/s]100%|██████████| 7/7 [00:01<00:00,  4.16it/s]
2025-03-13 16:50:48,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:48
2025-03-13 16:51:19,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4439 secs
2025-03-13 16:51:19,778 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 16:51:19,778 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.39it/s]
2025-03-13 16:51:36,301 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5230 secs
2025-03-13 16:51:36,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6583 secs
2025-03-13 16:51:36,303 [INFO]: {
2025-03-13 16:51:36,303 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:36,303 [INFO]: 	index_param: efSearch=269
2025-03-13 16:51:36,303 [INFO]: 	index_path: knn.index
2025-03-13 16:51:36,303 [INFO]: 	size in bytes: 318921970
2025-03-13 16:51:36,303 [INFO]: 	avg_search_speed_ms: 13.006858540376738
2025-03-13 16:51:36,303 [INFO]: 	99p_search_speed_ms: 23.490047333761982
2025-03-13 16:51:36,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:36,303 [INFO]: 	nb vectors: 1621
2025-03-13 16:51:36,303 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:36,303 [INFO]: 	compression ratio: 0.9993089155946202
2025-03-13 16:51:36,303 [INFO]: }
2025-03-13 16:51:36,304 [INFO]: 	>>> Finished "Creating the index" in 49.6600 secs
2025-03-13 16:51:36,304 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6917 secs
2025-03-13 16:51:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 13718 [episode count 19/20]
2025-03-13 16:51:37: [retrieval_preprocessing] finished for 9154343709_close_open_drawer [chosen_id count 5/196]
2025-03-13 16:51:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9186164821_put_lid_on_table [chosen_id count 6/196]
2025-03-13 16:51:39: [retrieval_preprocessing] we have num_total=4745 embedding_dim=49152
[retrieval_preprocessing] for episode 22537 [episode count 0/20], we have num_retrieval=np.int64(4506) num_query=np.int64(239)
2025-03-13 16:51:39,890 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:41,069 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:41
2025-03-13 16:51:41,069 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1732.47it/s]
2025-03-13 16:51:41,112 [INFO]: There are 4506 embeddings of dim 49152
2025-03-13 16:51:41,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0431 secs
2025-03-13 16:51:41,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:41
2025-03-13 16:51:41,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:41,113 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:51:41,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:41,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:51:41,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:41
2025-03-13 16:51:41,113 [INFO]: 929.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:41,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 16:51:41,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:41
2025-03-13 16:51:41,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:41,114 [INFO]: 	Creating the index 03/13/2025, 16:51:41
2025-03-13 16:51:41,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:41
2025-03-13 16:51:41,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:51:41,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:41
2025-03-13 16:51:41,118 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:51:41,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.86it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.47it/s] 67%|██████▋   | 12/18 [00:00<00:00, 39.83it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.45it/s]100%|██████████| 18/18 [00:03<00:00,  4.61it/s]
2025-03-13 16:51:45,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:45
2025-03-13 16:52:40,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7681 secs
2025-03-13 16:52:40,801 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 16:52:40,801 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-13 16:53:20,444 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6421 secs
2025-03-13 16:53:20,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.3292 secs
2025-03-13 16:53:20,448 [INFO]: {
2025-03-13 16:53:20,448 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:20,448 [INFO]: 	index_param: efSearch=121
2025-03-13 16:53:20,448 [INFO]: 	index_path: knn.index
2025-03-13 16:53:20,448 [INFO]: 	size in bytes: 886528510
2025-03-13 16:53:20,448 [INFO]: 	avg_search_speed_ms: 8.92129322982507
2025-03-13 16:53:20,448 [INFO]: 	99p_search_speed_ms: 14.921025419607759
2025-03-13 16:53:20,448 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:20,448 [INFO]: 	nb vectors: 4506
2025-03-13 16:53:20,448 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:20,448 [INFO]: 	compression ratio: 0.999308694539333
2025-03-13 16:53:20,448 [INFO]: }
2025-03-13 16:53:20,448 [INFO]: 	>>> Finished "Creating the index" in 99.3334 secs
2025-03-13 16:53:20,448 [INFO]: >>> Finished "Launching the whole pipeline" in 99.3789 secs
2025-03-13 16:53:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 22537 [episode count 0/20]
[retrieval_preprocessing] for episode 58405 [episode count 1/20], we have num_retrieval=np.int64(4475) num_query=np.int64(270)
2025-03-13 16:53:22,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:23,495 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:23
2025-03-13 16:53:23,495 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 878.76it/s]
2025-03-13 16:53:23,715 [INFO]: There are 4475 embeddings of dim 49152
2025-03-13 16:53:23,716 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2206 secs
2025-03-13 16:53:23,716 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:23
2025-03-13 16:53:23,717 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:23,717 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:53:23,717 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:23,717 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:53:23,717 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:23
2025-03-13 16:53:23,718 [INFO]: 923.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:23,718 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:53:23,718 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:23
2025-03-13 16:53:23,718 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:23,718 [INFO]: 	Creating the index 03/13/2025, 16:53:23
2025-03-13 16:53:23,719 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:23
2025-03-13 16:53:23,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 16:53:23,722 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:23
2025-03-13 16:53:23,722 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:53:23,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.62it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.66it/s] 61%|██████    | 11/18 [00:00<00:00, 35.61it/s] 89%|████████▉ | 16/18 [00:00<00:00, 38.14it/s]100%|██████████| 18/18 [00:04<00:00,  4.18it/s]
2025-03-13 16:53:28,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:28
2025-03-13 16:54:19,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9752 secs
2025-03-13 16:54:19,011 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 16:54:19,011 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-13 16:54:38,121 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1103 secs
2025-03-13 16:54:38,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4028 secs
2025-03-13 16:54:38,125 [INFO]: {
2025-03-13 16:54:38,125 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:38,125 [INFO]: 	index_param: efSearch=113
2025-03-13 16:54:38,125 [INFO]: 	index_path: knn.index
2025-03-13 16:54:38,125 [INFO]: 	size in bytes: 880429450
2025-03-13 16:54:38,125 [INFO]: 	avg_search_speed_ms: 7.786511631415594
2025-03-13 16:54:38,125 [INFO]: 	99p_search_speed_ms: 13.080682498402895
2025-03-13 16:54:38,125 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:38,125 [INFO]: 	nb vectors: 4475
2025-03-13 16:54:38,125 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:38,125 [INFO]: 	compression ratio: 0.9993086896400387
2025-03-13 16:54:38,125 [INFO]: }
2025-03-13 16:54:38,125 [INFO]: 	>>> Finished "Creating the index" in 74.4065 secs
2025-03-13 16:54:38,125 [INFO]: >>> Finished "Launching the whole pipeline" in 74.6298 secs
2025-03-13 16:54:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 58405 [episode count 1/20]
[retrieval_preprocessing] for episode 85546 [episode count 2/20], we have num_retrieval=np.int64(4517) num_query=np.int64(228)
2025-03-13 16:54:42,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:43,535 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:43
2025-03-13 16:54:43,536 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1674.37it/s]
2025-03-13 16:54:43,583 [INFO]: There are 4517 embeddings of dim 49152
2025-03-13 16:54:43,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0477 secs
2025-03-13 16:54:43,584 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:43
2025-03-13 16:54:43,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:43,584 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:54:43,584 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:43,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 16:54:43,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:43
2025-03-13 16:54:43,585 [INFO]: 932.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:43,585 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:54:43,585 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:43
2025-03-13 16:54:43,585 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:43,586 [INFO]: 	Creating the index 03/13/2025, 16:54:43
2025-03-13 16:54:43,586 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:43
2025-03-13 16:54:43,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 16:54:43,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:43
2025-03-13 16:54:43,590 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:54:43,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.91it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.89it/s] 67%|██████▋   | 12/18 [00:00<00:00, 41.62it/s] 94%|█████████▍| 17/18 [00:00<00:00, 44.36it/s]100%|██████████| 18/18 [00:03<00:00,  4.63it/s]
2025-03-13 16:54:47,484 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:47
2025-03-13 16:55:35,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0859 secs
2025-03-13 16:55:35,571 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 16:55:35,571 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 16:56:15,358 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7868 secs
2025-03-13 16:56:15,360 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.7706 secs
2025-03-13 16:56:15,360 [INFO]: {
2025-03-13 16:56:15,360 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:15,360 [INFO]: 	index_param: efSearch=173
2025-03-13 16:56:15,360 [INFO]: 	index_path: knn.index
2025-03-13 16:56:15,360 [INFO]: 	size in bytes: 888692650
2025-03-13 16:56:15,360 [INFO]: 	avg_search_speed_ms: 9.88399193427993
2025-03-13 16:56:15,360 [INFO]: 	99p_search_speed_ms: 15.587220513261855
2025-03-13 16:56:15,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:15,361 [INFO]: 	nb vectors: 4517
2025-03-13 16:56:15,361 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:15,361 [INFO]: 	compression ratio: 0.9993087441423084
2025-03-13 16:56:15,361 [INFO]: }
2025-03-13 16:56:15,361 [INFO]: 	>>> Finished "Creating the index" in 91.7750 secs
2025-03-13 16:56:15,361 [INFO]: >>> Finished "Launching the whole pipeline" in 91.8250 secs
2025-03-13 16:56:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 85546 [episode count 2/20]
[retrieval_preprocessing] for episode 23632 [episode count 3/20], we have num_retrieval=np.int64(4491) num_query=np.int64(254)
2025-03-13 16:56:17,140 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:17,632 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:17
2025-03-13 16:56:17,632 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1115.80it/s]
2025-03-13 16:56:17,669 [INFO]: There are 4491 embeddings of dim 49152
2025-03-13 16:56:17,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 16:56:17,669 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:17
2025-03-13 16:56:17,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:17,670 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:56:17,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:17,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:56:17,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:17
2025-03-13 16:56:17,670 [INFO]: 926.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:17,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:56:17,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:17
2025-03-13 16:56:17,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:17,670 [INFO]: 	Creating the index 03/13/2025, 16:56:17
2025-03-13 16:56:17,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:17
2025-03-13 16:56:17,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:56:17,671 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:17
2025-03-13 16:56:17,671 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:56:17,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.66it/s] 39%|███▉      | 7/18 [00:00<00:00, 36.61it/s] 78%|███████▊  | 14/18 [00:00<00:00, 47.94it/s]100%|██████████| 18/18 [00:03<00:00,  5.32it/s]
2025-03-13 16:56:21,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:21
2025-03-13 16:57:04,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8015 secs
2025-03-13 16:57:04,862 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:57:04,862 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.66it/s]
2025-03-13 16:57:28,539 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6770 secs
2025-03-13 16:57:28,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8724 secs
2025-03-13 16:57:28,544 [INFO]: {
2025-03-13 16:57:28,544 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:28,544 [INFO]: 	index_param: efSearch=143
2025-03-13 16:57:28,544 [INFO]: 	index_path: knn.index
2025-03-13 16:57:28,544 [INFO]: 	size in bytes: 883577350
2025-03-13 16:57:28,544 [INFO]: 	avg_search_speed_ms: 13.589414004261767
2025-03-13 16:57:28,544 [INFO]: 	99p_search_speed_ms: 22.26085780421271
2025-03-13 16:57:28,544 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:28,544 [INFO]: 	nb vectors: 4491
2025-03-13 16:57:28,544 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:28,544 [INFO]: 	compression ratio: 0.9993086943661469
2025-03-13 16:57:28,544 [INFO]: }
2025-03-13 16:57:28,544 [INFO]: 	>>> Finished "Creating the index" in 70.8741 secs
2025-03-13 16:57:28,544 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9118 secs
2025-03-13 16:57:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 23632 [episode count 3/20]
[retrieval_preprocessing] for episode 46220 [episode count 4/20], we have num_retrieval=np.int64(4518) num_query=np.int64(227)
2025-03-13 16:57:31,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:33,260 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:33
2025-03-13 16:57:33,260 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.32it/s]
2025-03-13 16:57:33,339 [INFO]: There are 4518 embeddings of dim 49152
2025-03-13 16:57:33,340 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0798 secs
2025-03-13 16:57:33,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:33
2025-03-13 16:57:33,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:33,340 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:57:33,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:33,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:57:33,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:33
2025-03-13 16:57:33,340 [INFO]: 932.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:33,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:57:33,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:33
2025-03-13 16:57:33,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:33,341 [INFO]: 	Creating the index 03/13/2025, 16:57:33
2025-03-13 16:57:33,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:33
2025-03-13 16:57:33,342 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 16:57:33,342 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:33
2025-03-13 16:57:33,343 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:57:33,343 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.01it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.25it/s] 28%|██▊       | 5/18 [00:00<00:01, 12.88it/s] 44%|████▍     | 8/18 [00:00<00:00, 17.99it/s] 61%|██████    | 11/18 [00:00<00:00, 21.15it/s] 78%|███████▊  | 14/18 [00:00<00:00, 22.99it/s] 94%|█████████▍| 17/18 [00:00<00:00, 24.73it/s]100%|██████████| 18/18 [00:05<00:00,  3.01it/s]
2025-03-13 16:57:39,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:39
2025-03-13 16:58:31,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8941 secs
2025-03-13 16:58:31,227 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 16:58:31,227 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.22it/s]
2025-03-13 16:59:00,941 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7146 secs
2025-03-13 16:59:00,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.6017 secs
2025-03-13 16:59:00,945 [INFO]: {
2025-03-13 16:59:00,945 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:00,945 [INFO]: 	index_param: efSearch=106
2025-03-13 16:59:00,945 [INFO]: 	index_path: knn.index
2025-03-13 16:59:00,945 [INFO]: 	size in bytes: 888889390
2025-03-13 16:59:00,945 [INFO]: 	avg_search_speed_ms: 7.543098649078893
2025-03-13 16:59:00,945 [INFO]: 	99p_search_speed_ms: 10.123686282895505
2025-03-13 16:59:00,945 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:00,945 [INFO]: 	nb vectors: 4518
2025-03-13 16:59:00,945 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:00,945 [INFO]: 	compression ratio: 0.999308748639693
2025-03-13 16:59:00,945 [INFO]: }
2025-03-13 16:59:00,945 [INFO]: 	>>> Finished "Creating the index" in 87.6045 secs
2025-03-13 16:59:00,945 [INFO]: >>> Finished "Launching the whole pipeline" in 87.6853 secs
2025-03-13 16:59:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 46220 [episode count 4/20]
[retrieval_preprocessing] for episode 7828 [episode count 5/20], we have num_retrieval=np.int64(4491) num_query=np.int64(254)
2025-03-13 16:59:06,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:06,924 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:06
2025-03-13 16:59:06,924 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 837.02it/s]
2025-03-13 16:59:06,969 [INFO]: There are 4491 embeddings of dim 49152
2025-03-13 16:59:06,969 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0455 secs
2025-03-13 16:59:06,969 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:06
2025-03-13 16:59:06,969 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:06,969 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 16:59:06,969 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:06,969 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:06,969 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:06
2025-03-13 16:59:06,970 [INFO]: 926.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:06,970 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:06,970 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:06
2025-03-13 16:59:06,970 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:06,970 [INFO]: 	Creating the index 03/13/2025, 16:59:06
2025-03-13 16:59:06,970 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:06
2025-03-13 16:59:06,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:59:06,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:06
2025-03-13 16:59:06,971 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:59:06,971 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.89it/s] 33%|███▎      | 6/18 [00:00<00:00, 28.91it/s] 61%|██████    | 11/18 [00:00<00:00, 35.75it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.42it/s]100%|██████████| 18/18 [00:04<00:00,  4.05it/s]
2025-03-13 16:59:11,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:11
2025-03-13 16:59:58,900 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4772 secs
2025-03-13 16:59:58,900 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 16:59:58,900 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 17:00:29,014 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1136 secs
2025-03-13 17:00:29,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0456 secs
2025-03-13 17:00:29,017 [INFO]: {
2025-03-13 17:00:29,017 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:29,017 [INFO]: 	index_param: efSearch=139
2025-03-13 17:00:29,017 [INFO]: 	index_path: knn.index
2025-03-13 17:00:29,017 [INFO]: 	size in bytes: 883577350
2025-03-13 17:00:29,017 [INFO]: 	avg_search_speed_ms: 13.230075798842504
2025-03-13 17:00:29,017 [INFO]: 	99p_search_speed_ms: 20.87920372141528
2025-03-13 17:00:29,017 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:29,017 [INFO]: 	nb vectors: 4491
2025-03-13 17:00:29,017 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:29,017 [INFO]: 	compression ratio: 0.9993086943661469
2025-03-13 17:00:29,017 [INFO]: }
2025-03-13 17:00:29,017 [INFO]: 	>>> Finished "Creating the index" in 82.0474 secs
2025-03-13 17:00:29,017 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0935 secs
2025-03-13 17:00:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 7828 [episode count 5/20]
[retrieval_preprocessing] for episode 92845 [episode count 6/20], we have num_retrieval=np.int64(4566) num_query=np.int64(179)
2025-03-13 17:00:31,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:32,335 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:32
2025-03-13 17:00:32,336 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.60it/s]
2025-03-13 17:00:32,380 [INFO]: There are 4566 embeddings of dim 49152
2025-03-13 17:00:32,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0442 secs
2025-03-13 17:00:32,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:32
2025-03-13 17:00:32,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:32,380 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:00:32,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:32,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:32,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:32
2025-03-13 17:00:32,380 [INFO]: 942.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:32,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:00:32,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:32
2025-03-13 17:00:32,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:32,380 [INFO]: 	Creating the index 03/13/2025, 17:00:32
2025-03-13 17:00:32,381 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:32
2025-03-13 17:00:32,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:00:32,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:32
2025-03-13 17:00:32,382 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:00:32,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.90it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.99it/s] 61%|██████    | 11/18 [00:00<00:00, 34.56it/s] 89%|████████▉ | 16/18 [00:00<00:00, 37.76it/s]100%|██████████| 18/18 [00:04<00:00,  4.25it/s]
2025-03-13 17:00:36,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:36
2025-03-13 17:01:28,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4164 secs
2025-03-13 17:01:28,035 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 17:01:28,035 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.03it/s]
2025-03-13 17:02:03,191 [INFO]: 	>>> Finished "Compute fast metrics" in 35.1555 secs
2025-03-13 17:02:03,195 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8133 secs
2025-03-13 17:02:03,195 [INFO]: {
2025-03-13 17:02:03,195 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:03,195 [INFO]: 	index_param: efSearch=126
2025-03-13 17:02:03,195 [INFO]: 	index_path: knn.index
2025-03-13 17:02:03,195 [INFO]: 	size in bytes: 898333150
2025-03-13 17:02:03,195 [INFO]: 	avg_search_speed_ms: 8.693658563710562
2025-03-13 17:02:03,195 [INFO]: 	99p_search_speed_ms: 13.897426542825997
2025-03-13 17:02:03,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:03,195 [INFO]: 	nb vectors: 4566
2025-03-13 17:02:03,195 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:03,195 [INFO]: 	compression ratio: 0.9993086952206984
2025-03-13 17:02:03,195 [INFO]: }
2025-03-13 17:02:03,195 [INFO]: 	>>> Finished "Creating the index" in 90.8150 secs
2025-03-13 17:02:03,196 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8599 secs
2025-03-13 17:02:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 92845 [episode count 6/20]
[retrieval_preprocessing] for episode 89262 [episode count 7/20], we have num_retrieval=np.int64(4125) num_query=np.int64(620)
2025-03-13 17:02:08,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:09,343 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:09
2025-03-13 17:02:09,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 944.66it/s]
2025-03-13 17:02:09,385 [INFO]: There are 4125 embeddings of dim 49152
2025-03-13 17:02:09,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 17:02:09,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:09
2025-03-13 17:02:09,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:09,386 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:02:09,386 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:09,386 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:02:09,386 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:09
2025-03-13 17:02:09,387 [INFO]: 851.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:09,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:02:09,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:09
2025-03-13 17:02:09,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:09,387 [INFO]: 	Creating the index 03/13/2025, 17:02:09
2025-03-13 17:02:09,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:09
2025-03-13 17:02:09,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 17:02:09,390 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:09
2025-03-13 17:02:09,390 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:02:09,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.66it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.36it/s] 82%|████████▏ | 14/17 [00:00<00:00, 45.53it/s]100%|██████████| 17/17 [00:04<00:00,  3.86it/s]
2025-03-13 17:02:13,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:13
2025-03-13 17:03:04,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9358 secs
2025-03-13 17:03:04,733 [INFO]: The best hyperparameters are: efSearch=88
2025-03-13 17:03:04,733 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 17:03:32,646 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9127 secs
2025-03-13 17:03:32,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.2590 secs
2025-03-13 17:03:32,649 [INFO]: {
2025-03-13 17:03:32,649 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:32,649 [INFO]: 	index_param: efSearch=88
2025-03-13 17:03:32,649 [INFO]: 	index_path: knn.index
2025-03-13 17:03:32,649 [INFO]: 	size in bytes: 811569130
2025-03-13 17:03:32,649 [INFO]: 	avg_search_speed_ms: 6.6683225638436285
2025-03-13 17:03:32,649 [INFO]: 	99p_search_speed_ms: 10.398963890038429
2025-03-13 17:03:32,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:32,649 [INFO]: 	nb vectors: 4125
2025-03-13 17:03:32,649 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:32,649 [INFO]: 	compression ratio: 0.999308586318457
2025-03-13 17:03:32,649 [INFO]: }
2025-03-13 17:03:32,649 [INFO]: 	>>> Finished "Creating the index" in 83.2616 secs
2025-03-13 17:03:32,649 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3058 secs
2025-03-13 17:03:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 89262 [episode count 7/20]
[retrieval_preprocessing] for episode 17066 [episode count 8/20], we have num_retrieval=np.int64(4570) num_query=np.int64(175)
2025-03-13 17:03:35,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:36,487 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:36
2025-03-13 17:03:36,487 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.41it/s]
2025-03-13 17:03:36,535 [INFO]: There are 4570 embeddings of dim 49152
2025-03-13 17:03:36,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0480 secs
2025-03-13 17:03:36,535 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:36
2025-03-13 17:03:36,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:36,535 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:03:36,535 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:36,535 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:03:36,535 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:36
2025-03-13 17:03:36,536 [INFO]: 943.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:36,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:03:36,536 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:36
2025-03-13 17:03:36,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:36,536 [INFO]: 	Creating the index 03/13/2025, 17:03:36
2025-03-13 17:03:36,536 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:36
2025-03-13 17:03:36,537 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:03:36,537 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:36
2025-03-13 17:03:36,538 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:03:36,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.00it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.50it/s] 67%|██████▋   | 12/18 [00:00<00:00, 40.77it/s] 94%|█████████▍| 17/18 [00:00<00:00, 43.31it/s]100%|██████████| 18/18 [00:03<00:00,  4.82it/s]
2025-03-13 17:03:41,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:41
2025-03-13 17:04:28,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8348 secs
2025-03-13 17:04:28,839 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 17:04:28,839 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 17:04:50,532 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6926 secs
2025-03-13 17:04:50,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9974 secs
2025-03-13 17:04:50,535 [INFO]: {
2025-03-13 17:04:50,535 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:50,535 [INFO]: 	index_param: efSearch=125
2025-03-13 17:04:50,535 [INFO]: 	index_path: knn.index
2025-03-13 17:04:50,535 [INFO]: 	size in bytes: 899120110
2025-03-13 17:04:50,535 [INFO]: 	avg_search_speed_ms: 8.443519499229984
2025-03-13 17:04:50,535 [INFO]: 	99p_search_speed_ms: 13.740010517649353
2025-03-13 17:04:50,535 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:50,535 [INFO]: 	nb vectors: 4570
2025-03-13 17:04:50,535 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:50,535 [INFO]: 	compression ratio: 0.9993087130483601
2025-03-13 17:04:50,535 [INFO]: }
2025-03-13 17:04:50,535 [INFO]: 	>>> Finished "Creating the index" in 73.9994 secs
2025-03-13 17:04:50,535 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0484 secs
2025-03-13 17:04:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 17066 [episode count 8/20]
[retrieval_preprocessing] for episode 67774 [episode count 9/20], we have num_retrieval=np.int64(4488) num_query=np.int64(257)
2025-03-13 17:04:52,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:53,127 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:53
2025-03-13 17:04:53,127 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.07it/s]
2025-03-13 17:04:53,170 [INFO]: There are 4488 embeddings of dim 49152
2025-03-13 17:04:53,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0435 secs
2025-03-13 17:04:53,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:53
2025-03-13 17:04:53,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:53,171 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:04:53,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:53,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:04:53,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:53
2025-03-13 17:04:53,171 [INFO]: 926.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:53,171 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:04:53,171 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:53
2025-03-13 17:04:53,171 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:53,171 [INFO]: 	Creating the index 03/13/2025, 17:04:53
2025-03-13 17:04:53,171 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:53
2025-03-13 17:04:53,173 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:04:53,173 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:53
2025-03-13 17:04:53,173 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:04:53,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.78it/s] 44%|████▍     | 8/18 [00:00<00:00, 40.98it/s] 78%|███████▊  | 14/18 [00:00<00:00, 47.14it/s]100%|██████████| 18/18 [00:03<00:00,  5.25it/s]
2025-03-13 17:04:56,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:56
2025-03-13 17:05:47,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7034 secs
2025-03-13 17:05:47,410 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 17:05:47,410 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-13 17:06:11,909 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4996 secs
2025-03-13 17:06:11,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7404 secs
2025-03-13 17:06:11,913 [INFO]: {
2025-03-13 17:06:11,913 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:11,913 [INFO]: 	index_param: efSearch=123
2025-03-13 17:06:11,913 [INFO]: 	index_path: knn.index
2025-03-13 17:06:11,913 [INFO]: 	size in bytes: 882987130
2025-03-13 17:06:11,913 [INFO]: 	avg_search_speed_ms: 9.413241047242028
2025-03-13 17:06:11,913 [INFO]: 	99p_search_speed_ms: 13.65216374862942
2025-03-13 17:06:11,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:11,913 [INFO]: 	nb vectors: 4488
2025-03-13 17:06:11,913 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:11,913 [INFO]: 	compression ratio: 0.9993086807505337
2025-03-13 17:06:11,913 [INFO]: }
2025-03-13 17:06:11,913 [INFO]: 	>>> Finished "Creating the index" in 78.7421 secs
2025-03-13 17:06:11,913 [INFO]: >>> Finished "Launching the whole pipeline" in 78.7866 secs
2025-03-13 17:06:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 67774 [episode count 9/20]
[retrieval_preprocessing] for episode 89819 [episode count 10/20], we have num_retrieval=np.int64(4565) num_query=np.int64(180)
2025-03-13 17:06:13,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:14,554 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:14
2025-03-13 17:06:14,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-13 17:06:14,600 [INFO]: There are 4565 embeddings of dim 49152
2025-03-13 17:06:14,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0463 secs
2025-03-13 17:06:14,601 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:14
2025-03-13 17:06:14,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:14,602 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:06:14,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:14,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:06:14,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:14
2025-03-13 17:06:14,602 [INFO]: 942.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:14,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:06:14,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:14
2025-03-13 17:06:14,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:14,603 [INFO]: 	Creating the index 03/13/2025, 17:06:14
2025-03-13 17:06:14,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:14
2025-03-13 17:06:14,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:06:14,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:14
2025-03-13 17:06:14,607 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:06:14,607 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.42it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.54it/s] 67%|██████▋   | 12/18 [00:00<00:00, 39.70it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.06it/s]100%|██████████| 18/18 [00:05<00:00,  3.50it/s]
2025-03-13 17:06:19,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:19
2025-03-13 17:07:18,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1382 secs
2025-03-13 17:07:18,892 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 17:07:18,892 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-13 17:07:55,847 [INFO]: 	>>> Finished "Compute fast metrics" in 36.9550 secs
2025-03-13 17:07:55,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.2426 secs
2025-03-13 17:07:55,849 [INFO]: {
2025-03-13 17:07:55,849 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:55,849 [INFO]: 	index_param: efSearch=144
2025-03-13 17:07:55,849 [INFO]: 	index_path: knn.index
2025-03-13 17:07:55,849 [INFO]: 	size in bytes: 898136410
2025-03-13 17:07:55,849 [INFO]: 	avg_search_speed_ms: 7.574590153032632
2025-03-13 17:07:55,849 [INFO]: 	99p_search_speed_ms: 10.783718391321596
2025-03-13 17:07:55,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:55,850 [INFO]: 	nb vectors: 4565
2025-03-13 17:07:55,850 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:55,850 [INFO]: 	compression ratio: 0.9993086907589015
2025-03-13 17:07:55,850 [INFO]: }
2025-03-13 17:07:55,850 [INFO]: 	>>> Finished "Creating the index" in 101.2467 secs
2025-03-13 17:07:55,850 [INFO]: >>> Finished "Launching the whole pipeline" in 101.2952 secs
2025-03-13 17:07:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 89819 [episode count 10/20]
[retrieval_preprocessing] for episode 76012 [episode count 11/20], we have num_retrieval=np.int64(4527) num_query=np.int64(218)
2025-03-13 17:07:57,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:57,868 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:57
2025-03-13 17:07:57,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2091.92it/s]
2025-03-13 17:07:57,908 [INFO]: There are 4527 embeddings of dim 49152
2025-03-13 17:07:57,909 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-13 17:07:57,909 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:57
2025-03-13 17:07:57,909 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:57,909 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:07:57,909 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:57,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:07:57,910 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:57
2025-03-13 17:07:57,910 [INFO]: 934.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:57,910 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:07:57,910 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:57
2025-03-13 17:07:57,910 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:57,910 [INFO]: 	Creating the index 03/13/2025, 17:07:57
2025-03-13 17:07:57,911 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:57
2025-03-13 17:07:57,913 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:07:57,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:57
2025-03-13 17:07:57,914 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:07:57,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.01it/s] 44%|████▍     | 8/18 [00:00<00:00, 37.59it/s] 78%|███████▊  | 14/18 [00:00<00:00, 44.38it/s]100%|██████████| 18/18 [00:03<00:00,  4.75it/s]
2025-03-13 17:08:01,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:01
2025-03-13 17:08:56,085 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3792 secs
2025-03-13 17:08:56,085 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 17:08:56,085 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.59it/s]
2025-03-13 17:09:16,195 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1099 secs
2025-03-13 17:09:16,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2852 secs
2025-03-13 17:09:16,199 [INFO]: {
2025-03-13 17:09:16,199 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:16,199 [INFO]: 	index_param: efSearch=112
2025-03-13 17:09:16,199 [INFO]: 	index_path: knn.index
2025-03-13 17:09:16,199 [INFO]: 	size in bytes: 890660050
2025-03-13 17:09:16,199 [INFO]: 	avg_search_speed_ms: 8.014896025997587
2025-03-13 17:09:16,199 [INFO]: 	99p_search_speed_ms: 13.063246898818752
2025-03-13 17:09:16,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:16,199 [INFO]: 	nb vectors: 4527
2025-03-13 17:09:16,199 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:16,199 [INFO]: 	compression ratio: 0.9993087890267448
2025-03-13 17:09:16,199 [INFO]: }
2025-03-13 17:09:16,199 [INFO]: 	>>> Finished "Creating the index" in 78.2888 secs
2025-03-13 17:09:16,199 [INFO]: >>> Finished "Launching the whole pipeline" in 78.3308 secs
2025-03-13 17:09:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 76012 [episode count 11/20]
[retrieval_preprocessing] for episode 48889 [episode count 12/20], we have num_retrieval=np.int64(4551) num_query=np.int64(194)
2025-03-13 17:09:18,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:18,815 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:18
2025-03-13 17:09:18,815 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.06it/s]
2025-03-13 17:09:18,857 [INFO]: There are 4551 embeddings of dim 49152
2025-03-13 17:09:18,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-13 17:09:18,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:18
2025-03-13 17:09:18,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:18,858 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:09:18,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:18,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:18,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:18
2025-03-13 17:09:18,858 [INFO]: 939.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:18,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:09:18,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:18
2025-03-13 17:09:18,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:18,858 [INFO]: 	Creating the index 03/13/2025, 17:09:18
2025-03-13 17:09:18,858 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:18
2025-03-13 17:09:18,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:09:18,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:18
2025-03-13 17:09:18,860 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:09:18,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.44it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.46it/s] 61%|██████    | 11/18 [00:00<00:00, 35.30it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.45it/s]100%|██████████| 18/18 [00:04<00:00,  4.32it/s]
2025-03-13 17:09:23,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:23
2025-03-13 17:10:09,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5705 secs
2025-03-13 17:10:09,601 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:10:09,601 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.48it/s]
2025-03-13 17:10:51,327 [INFO]: 	>>> Finished "Compute fast metrics" in 41.7255 secs
2025-03-13 17:10:51,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.4720 secs
2025-03-13 17:10:51,332 [INFO]: {
2025-03-13 17:10:51,332 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:51,332 [INFO]: 	index_param: efSearch=153
2025-03-13 17:10:51,332 [INFO]: 	index_path: knn.index
2025-03-13 17:10:51,332 [INFO]: 	size in bytes: 895381930
2025-03-13 17:10:51,332 [INFO]: 	avg_search_speed_ms: 9.392211652916153
2025-03-13 17:10:51,332 [INFO]: 	99p_search_speed_ms: 12.662611361593008
2025-03-13 17:10:51,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:51,332 [INFO]: 	nb vectors: 4551
2025-03-13 17:10:51,332 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:51,332 [INFO]: 	compression ratio: 0.999308762016227
2025-03-13 17:10:51,332 [INFO]: }
2025-03-13 17:10:51,332 [INFO]: 	>>> Finished "Creating the index" in 92.4739 secs
2025-03-13 17:10:51,332 [INFO]: >>> Finished "Launching the whole pipeline" in 92.5171 secs
2025-03-13 17:10:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 48889 [episode count 12/20]
[retrieval_preprocessing] for episode 1275 [episode count 13/20], we have num_retrieval=np.int64(4561) num_query=np.int64(184)
2025-03-13 17:10:53,160 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:53,735 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:53
2025-03-13 17:10:53,735 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1047.79it/s]
2025-03-13 17:10:53,772 [INFO]: There are 4561 embeddings of dim 49152
2025-03-13 17:10:53,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 17:10:53,772 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:53
2025-03-13 17:10:53,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:53,772 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:10:53,772 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:53,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:10:53,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:53
2025-03-13 17:10:53,772 [INFO]: 941.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:53,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:10:53,772 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:53
2025-03-13 17:10:53,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:53,772 [INFO]: 	Creating the index 03/13/2025, 17:10:53
2025-03-13 17:10:53,772 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:53
2025-03-13 17:10:53,773 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:10:53,773 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:53
2025-03-13 17:10:53,773 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:10:53,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.19it/s] 39%|███▉      | 7/18 [00:00<00:00, 37.79it/s] 78%|███████▊  | 14/18 [00:00<00:00, 48.81it/s]100%|██████████| 18/18 [00:03<00:00,  5.42it/s]
2025-03-13 17:10:57,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:57
2025-03-13 17:11:42,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3825 secs
2025-03-13 17:11:42,483 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 17:11:42,483 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 17:12:10,449 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9656 secs
2025-03-13 17:12:10,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.6801 secs
2025-03-13 17:12:10,454 [INFO]: {
2025-03-13 17:12:10,454 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:10,454 [INFO]: 	index_param: efSearch=125
2025-03-13 17:12:10,454 [INFO]: 	index_path: knn.index
2025-03-13 17:12:10,454 [INFO]: 	size in bytes: 897349450
2025-03-13 17:12:10,454 [INFO]: 	avg_search_speed_ms: 13.552077264123694
2025-03-13 17:12:10,454 [INFO]: 	99p_search_speed_ms: 20.019850376993418
2025-03-13 17:12:10,454 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:10,454 [INFO]: 	nb vectors: 4561
2025-03-13 17:12:10,454 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:10,454 [INFO]: 	compression ratio: 0.9993086728921492
2025-03-13 17:12:10,454 [INFO]: }
2025-03-13 17:12:10,454 [INFO]: 	>>> Finished "Creating the index" in 76.6815 secs
2025-03-13 17:12:10,454 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7185 secs
2025-03-13 17:12:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 1275 [episode count 13/20]
[retrieval_preprocessing] for episode 6405 [episode count 14/20], we have num_retrieval=np.int64(4550) num_query=np.int64(195)
2025-03-13 17:12:12,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:13,018 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:13
2025-03-13 17:12:13,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 905.12it/s]
2025-03-13 17:12:13,068 [INFO]: There are 4550 embeddings of dim 49152
2025-03-13 17:12:13,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0504 secs
2025-03-13 17:12:13,068 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:13
2025-03-13 17:12:13,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:13,068 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:12:13,068 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:13,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:13,068 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:13
2025-03-13 17:12:13,068 [INFO]: 939.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:13,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:13,069 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:13
2025-03-13 17:12:13,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:13,069 [INFO]: 	Creating the index 03/13/2025, 17:12:13
2025-03-13 17:12:13,069 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:13
2025-03-13 17:12:13,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:12:13,070 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:13
2025-03-13 17:12:13,070 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:12:13,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.67it/s] 33%|███▎      | 6/18 [00:00<00:00, 26.45it/s] 61%|██████    | 11/18 [00:00<00:00, 34.24it/s] 83%|████████▎ | 15/18 [00:00<00:00, 35.94it/s]100%|██████████| 18/18 [00:05<00:00,  3.13it/s]
2025-03-13 17:12:18,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:18
2025-03-13 17:13:07,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8824 secs
2025-03-13 17:13:07,716 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 17:13:07,716 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.93it/s]
2025-03-13 17:13:44,037 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3212 secs
2025-03-13 17:13:44,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9707 secs
2025-03-13 17:13:44,041 [INFO]: {
2025-03-13 17:13:44,041 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:44,041 [INFO]: 	index_param: efSearch=143
2025-03-13 17:13:44,041 [INFO]: 	index_path: knn.index
2025-03-13 17:13:44,041 [INFO]: 	size in bytes: 895185190
2025-03-13 17:13:44,041 [INFO]: 	avg_search_speed_ms: 9.07595892954016
2025-03-13 17:13:44,041 [INFO]: 	99p_search_speed_ms: 12.90504254633561
2025-03-13 17:13:44,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:44,041 [INFO]: 	nb vectors: 4550
2025-03-13 17:13:44,041 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:44,041 [INFO]: 	compression ratio: 0.9993087575544005
2025-03-13 17:13:44,041 [INFO]: }
2025-03-13 17:13:44,041 [INFO]: 	>>> Finished "Creating the index" in 90.9721 secs
2025-03-13 17:13:44,041 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0232 secs
2025-03-13 17:13:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 6405 [episode count 14/20]
[retrieval_preprocessing] for episode 74034 [episode count 15/20], we have num_retrieval=np.int64(4538) num_query=np.int64(207)
2025-03-13 17:13:45,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:46,344 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:46
2025-03-13 17:13:46,344 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 821.29it/s]
2025-03-13 17:13:46,389 [INFO]: There are 4538 embeddings of dim 49152
2025-03-13 17:13:46,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0460 secs
2025-03-13 17:13:46,390 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:46
2025-03-13 17:13:46,390 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:46,391 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:13:46,391 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:46,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:13:46,391 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:46
2025-03-13 17:13:46,392 [INFO]: 936.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:46,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:13:46,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:46
2025-03-13 17:13:46,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:46,392 [INFO]: 	Creating the index 03/13/2025, 17:13:46
2025-03-13 17:13:46,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:46
2025-03-13 17:13:46,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:13:46,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:46
2025-03-13 17:13:46,396 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:13:46,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.28it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.78it/s] 67%|██████▋   | 12/18 [00:00<00:00, 40.25it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.85it/s]100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
2025-03-13 17:13:50,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:50
2025-03-13 17:14:37,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1908 secs
2025-03-13 17:14:37,782 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 17:14:37,782 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.78it/s]
2025-03-13 17:14:58,106 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3238 secs
2025-03-13 17:14:58,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7130 secs
2025-03-13 17:14:58,109 [INFO]: {
2025-03-13 17:14:58,109 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:58,109 [INFO]: 	index_param: efSearch=139
2025-03-13 17:14:58,109 [INFO]: 	index_path: knn.index
2025-03-13 17:14:58,109 [INFO]: 	size in bytes: 892824310
2025-03-13 17:14:58,109 [INFO]: 	avg_search_speed_ms: 10.917587109941046
2025-03-13 17:14:58,109 [INFO]: 	99p_search_speed_ms: 15.314201102592055
2025-03-13 17:14:58,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:58,109 [INFO]: 	nb vectors: 4538
2025-03-13 17:14:58,109 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:58,109 [INFO]: 	compression ratio: 0.9993087038591053
2025-03-13 17:14:58,109 [INFO]: }
2025-03-13 17:14:58,109 [INFO]: 	>>> Finished "Creating the index" in 71.7171 secs
2025-03-13 17:14:58,109 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7657 secs
2025-03-13 17:14:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 74034 [episode count 15/20]
[retrieval_preprocessing] for episode 49466 [episode count 16/20], we have num_retrieval=np.int64(4553) num_query=np.int64(192)
2025-03-13 17:14:59,961 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:01,563 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:01
2025-03-13 17:15:01,563 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 17:15:01,606 [INFO]: There are 4553 embeddings of dim 49152
2025-03-13 17:15:01,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0428 secs
2025-03-13 17:15:01,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:01,606 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:15:01,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:01,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:01,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,606 [INFO]: 939.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:01,607 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:15:01,607 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:01
2025-03-13 17:15:01,607 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:01,607 [INFO]: 	Creating the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,607 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:01
2025-03-13 17:15:01,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:15:01,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:01
2025-03-13 17:15:01,608 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:15:01,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.95it/s] 39%|███▉      | 7/18 [00:00<00:00, 31.83it/s] 67%|██████▋   | 12/18 [00:00<00:00, 36.47it/s] 94%|█████████▍| 17/18 [00:00<00:00, 38.54it/s]100%|██████████| 18/18 [00:04<00:00,  3.77it/s]
2025-03-13 17:15:06,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:06
2025-03-13 17:15:51,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1560 secs
2025-03-13 17:15:51,549 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 17:15:51,549 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-13 17:16:13,037 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4884 secs
2025-03-13 17:16:13,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4327 secs
2025-03-13 17:16:13,041 [INFO]: {
2025-03-13 17:16:13,041 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:13,041 [INFO]: 	index_param: efSearch=150
2025-03-13 17:16:13,041 [INFO]: 	index_path: knn.index
2025-03-13 17:16:13,041 [INFO]: 	size in bytes: 895775410
2025-03-13 17:16:13,041 [INFO]: 	avg_search_speed_ms: 12.313195712132645
2025-03-13 17:16:13,041 [INFO]: 	99p_search_speed_ms: 25.622123680077472
2025-03-13 17:16:13,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:13,041 [INFO]: 	nb vectors: 4553
2025-03-13 17:16:13,041 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:13,041 [INFO]: 	compression ratio: 0.9993087709340001
2025-03-13 17:16:13,041 [INFO]: }
2025-03-13 17:16:13,041 [INFO]: 	>>> Finished "Creating the index" in 71.4345 secs
2025-03-13 17:16:13,041 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4778 secs
2025-03-13 17:16:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 49466 [episode count 16/20]
[retrieval_preprocessing] for episode 10051 [episode count 17/20], we have num_retrieval=np.int64(4551) num_query=np.int64(194)
2025-03-13 17:16:15,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:16,132 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:16
2025-03-13 17:16:16,132 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.19it/s]
2025-03-13 17:16:16,179 [INFO]: There are 4551 embeddings of dim 49152
2025-03-13 17:16:16,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0470 secs
2025-03-13 17:16:16,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:16
2025-03-13 17:16:16,180 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:16,180 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:16:16,180 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:16,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:16,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:16
2025-03-13 17:16:16,180 [INFO]: 939.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:16,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:16:16,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:16
2025-03-13 17:16:16,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:16,180 [INFO]: 	Creating the index 03/13/2025, 17:16:16
2025-03-13 17:16:16,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:16
2025-03-13 17:16:16,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:16:16,181 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:16
2025-03-13 17:16:16,181 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:16:16,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.73it/s] 28%|██▊       | 5/18 [00:00<00:00, 22.51it/s] 56%|█████▌    | 10/18 [00:00<00:00, 30.60it/s] 83%|████████▎ | 15/18 [00:00<00:00, 34.95it/s]100%|██████████| 18/18 [00:04<00:00,  4.15it/s]
2025-03-13 17:16:20,526 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:20
2025-03-13 17:17:10,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5501 secs
2025-03-13 17:17:10,077 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 17:17:10,077 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 17:17:34,737 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6598 secs
2025-03-13 17:17:34,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5589 secs
2025-03-13 17:17:34,740 [INFO]: {
2025-03-13 17:17:34,740 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:34,740 [INFO]: 	index_param: efSearch=135
2025-03-13 17:17:34,740 [INFO]: 	index_path: knn.index
2025-03-13 17:17:34,740 [INFO]: 	size in bytes: 895381930
2025-03-13 17:17:34,740 [INFO]: 	avg_search_speed_ms: 10.456748042259537
2025-03-13 17:17:34,740 [INFO]: 	99p_search_speed_ms: 17.22993518924341
2025-03-13 17:17:34,740 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:34,740 [INFO]: 	nb vectors: 4551
2025-03-13 17:17:34,740 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:34,740 [INFO]: 	compression ratio: 0.999308762016227
2025-03-13 17:17:34,740 [INFO]: }
2025-03-13 17:17:34,740 [INFO]: 	>>> Finished "Creating the index" in 78.5604 secs
2025-03-13 17:17:34,740 [INFO]: >>> Finished "Launching the whole pipeline" in 78.6081 secs
2025-03-13 17:17:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 10051 [episode count 17/20]
[retrieval_preprocessing] for episode 71569 [episode count 18/20], we have num_retrieval=np.int64(4495) num_query=np.int64(250)
2025-03-13 17:17:36,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:37,614 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:37
2025-03-13 17:17:37,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.17it/s]
2025-03-13 17:17:37,663 [INFO]: There are 4495 embeddings of dim 49152
2025-03-13 17:17:37,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0492 secs
2025-03-13 17:17:37,663 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:37
2025-03-13 17:17:37,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:37,664 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:17:37,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:37,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:17:37,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:37
2025-03-13 17:17:37,664 [INFO]: 927.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:37,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:17:37,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:37
2025-03-13 17:17:37,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:37,665 [INFO]: 	Creating the index 03/13/2025, 17:17:37
2025-03-13 17:17:37,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:37
2025-03-13 17:17:37,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:17:37,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:37
2025-03-13 17:17:37,669 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:17:37,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.33it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.14it/s] 67%|██████▋   | 12/18 [00:00<00:00, 38.57it/s] 94%|█████████▍| 17/18 [00:00<00:00, 41.16it/s]100%|██████████| 18/18 [00:04<00:00,  4.31it/s]
2025-03-13 17:17:41,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:41
2025-03-13 17:18:30,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3773 secs
2025-03-13 17:18:30,226 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 17:18:30,226 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 17:18:59,172 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9458 secs
2025-03-13 17:18:59,176 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.5072 secs
2025-03-13 17:18:59,176 [INFO]: {
2025-03-13 17:18:59,176 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:59,176 [INFO]: 	index_param: efSearch=165
2025-03-13 17:18:59,176 [INFO]: 	index_path: knn.index
2025-03-13 17:18:59,176 [INFO]: 	size in bytes: 884364370
2025-03-13 17:18:59,176 [INFO]: 	avg_search_speed_ms: 11.568938025321833
2025-03-13 17:18:59,176 [INFO]: 	99p_search_speed_ms: 17.07224713638425
2025-03-13 17:18:59,176 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:59,176 [INFO]: 	nb vectors: 4495
2025-03-13 17:18:59,176 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:59,176 [INFO]: 	compression ratio: 0.9993086446935894
2025-03-13 17:18:59,176 [INFO]: }
2025-03-13 17:18:59,176 [INFO]: 	>>> Finished "Creating the index" in 81.5109 secs
2025-03-13 17:18:59,176 [INFO]: >>> Finished "Launching the whole pipeline" in 81.5625 secs
2025-03-13 17:19:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 71569 [episode count 18/20]
[retrieval_preprocessing] for episode 85382 [episode count 19/20], we have num_retrieval=np.int64(4517) num_query=np.int64(228)
2025-03-13 17:19:01,849 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:02,508 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:02
2025-03-13 17:19:02,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-13 17:19:02,550 [INFO]: There are 4517 embeddings of dim 49152
2025-03-13 17:19:02,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0420 secs
2025-03-13 17:19:02,550 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:02,550 [INFO]: 		-> Add: 2.5 seconds
2025-03-13 17:19:02,550 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:02,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:19:02,550 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,550 [INFO]: 932.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:02,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:19:02,550 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:02
2025-03-13 17:19:02,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:02,550 [INFO]: 	Creating the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,550 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:02
2025-03-13 17:19:02,551 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:19:02,552 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:02
2025-03-13 17:19:02,552 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:19:02,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.59it/s] 33%|███▎      | 6/18 [00:00<00:00, 32.02it/s] 61%|██████    | 11/18 [00:00<00:00, 39.02it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.93it/s]100%|██████████| 18/18 [00:03<00:00,  4.75it/s]
2025-03-13 17:19:06,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:06
2025-03-13 17:19:53,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3781 secs
2025-03-13 17:19:53,723 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 17:19:53,723 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-13 17:20:24,920 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1966 secs
2025-03-13 17:20:24,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3713 secs
2025-03-13 17:20:24,923 [INFO]: {
2025-03-13 17:20:24,923 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:24,923 [INFO]: 	index_param: efSearch=145
2025-03-13 17:20:24,923 [INFO]: 	index_path: knn.index
2025-03-13 17:20:24,923 [INFO]: 	size in bytes: 888692650
2025-03-13 17:20:24,923 [INFO]: 	avg_search_speed_ms: 9.004718001217697
2025-03-13 17:20:24,923 [INFO]: 	99p_search_speed_ms: 12.617377005517485
2025-03-13 17:20:24,923 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:24,923 [INFO]: 	nb vectors: 4517
2025-03-13 17:20:24,923 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:24,923 [INFO]: 	compression ratio: 0.9993087441423084
2025-03-13 17:20:24,923 [INFO]: }
2025-03-13 17:20:24,923 [INFO]: 	>>> Finished "Creating the index" in 82.3731 secs
2025-03-13 17:20:24,923 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4155 secs
2025-03-13 17:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 85382 [episode count 19/20]
2025-03-13 17:20:26: [retrieval_preprocessing] finished for 9186164821_put_lid_on_table [chosen_id count 6/196]
2025-03-13 17:20:27: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9306310171_put_tape_on_plate [chosen_id count 7/196]
2025-03-13 17:20:27: [retrieval_preprocessing] we have num_total=2430 embedding_dim=49152
[retrieval_preprocessing] for episode 33793 [episode count 0/20], we have num_retrieval=np.int64(2309) num_query=np.int64(121)
2025-03-13 17:20:27,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:28,077 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:28
2025-03-13 17:20:28,077 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1895.30it/s]
2025-03-13 17:20:28,108 [INFO]: There are 2309 embeddings of dim 49152
2025-03-13 17:20:28,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 17:20:28,108 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:28
2025-03-13 17:20:28,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:28,109 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:20:28,109 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:28,109 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:20:28,109 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:28
2025-03-13 17:20:28,109 [INFO]: 476.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:28,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:20:28,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:28
2025-03-13 17:20:28,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:28,110 [INFO]: 	Creating the index 03/13/2025, 17:20:28
2025-03-13 17:20:28,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:28
2025-03-13 17:20:28,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:20:28,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:28
2025-03-13 17:20:28,114 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:20:28,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.68it/s] 60%|██████    | 6/10 [00:00<00:00, 30.07it/s]100%|██████████| 10/10 [00:02<00:00,  3.62it/s]100%|██████████| 10/10 [00:02<00:00,  4.46it/s]
2025-03-13 17:20:30,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:30
2025-03-13 17:21:02,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9190 secs
2025-03-13 17:21:02,627 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:21:02,627 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.83it/s]
2025-03-13 17:21:22,852 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2254 secs
2025-03-13 17:21:22,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7421 secs
2025-03-13 17:21:22,856 [INFO]: {
2025-03-13 17:21:22,856 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:22,856 [INFO]: 	index_param: efSearch=202
2025-03-13 17:21:22,856 [INFO]: 	index_path: knn.index
2025-03-13 17:21:22,856 [INFO]: 	size in bytes: 454281610
2025-03-13 17:21:22,856 [INFO]: 	avg_search_speed_ms: 10.976726935540544
2025-03-13 17:21:22,856 [INFO]: 	99p_search_speed_ms: 20.15914677176622
2025-03-13 17:21:22,856 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:22,856 [INFO]: 	nb vectors: 2309
2025-03-13 17:21:22,856 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:22,856 [INFO]: 	compression ratio: 0.9993093755214965
2025-03-13 17:21:22,856 [INFO]: }
2025-03-13 17:21:22,856 [INFO]: 	>>> Finished "Creating the index" in 54.7462 secs
2025-03-13 17:21:22,856 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7795 secs
2025-03-13 17:21:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 33793 [episode count 0/20]
[retrieval_preprocessing] for episode 24066 [episode count 1/20], we have num_retrieval=np.int64(2293) num_query=np.int64(137)
2025-03-13 17:21:26,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:26,481 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:26
2025-03-13 17:21:26,481 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1287.39it/s]
2025-03-13 17:21:26,516 [INFO]: There are 2293 embeddings of dim 49152
2025-03-13 17:21:26,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-13 17:21:26,517 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:26
2025-03-13 17:21:26,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:26,517 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:21:26,517 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:26,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:21:26,517 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:26
2025-03-13 17:21:26,518 [INFO]: 473.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:26,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:21:26,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:26
2025-03-13 17:21:26,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:26,518 [INFO]: 	Creating the index 03/13/2025, 17:21:26
2025-03-13 17:21:26,519 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:26
2025-03-13 17:21:26,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:21:26,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:26
2025-03-13 17:21:26,522 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:21:26,523 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.22it/s] 30%|███       | 3/10 [00:00<00:00,  9.19it/s] 50%|█████     | 5/10 [00:00<00:00,  9.82it/s] 70%|███████   | 7/10 [00:00<00:00,  9.78it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.06it/s]100%|██████████| 10/10 [00:03<00:00,  3.21it/s]
2025-03-13 17:21:29,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:29
2025-03-13 17:22:04,466 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8240 secs
2025-03-13 17:22:04,466 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 17:22:04,467 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 17:22:24,689 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2222 secs
2025-03-13 17:22:24,697 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1742 secs
2025-03-13 17:22:24,697 [INFO]: {
2025-03-13 17:22:24,697 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:24,697 [INFO]: 	index_param: efSearch=221
2025-03-13 17:22:24,697 [INFO]: 	index_path: knn.index
2025-03-13 17:22:24,697 [INFO]: 	size in bytes: 451133710
2025-03-13 17:22:24,697 [INFO]: 	avg_search_speed_ms: 9.665347163785915
2025-03-13 17:22:24,697 [INFO]: 	99p_search_speed_ms: 12.998256338760255
2025-03-13 17:22:24,697 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:24,697 [INFO]: 	nb vectors: 2293
2025-03-13 17:22:24,697 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:24,697 [INFO]: 	compression ratio: 0.9993093710509906
2025-03-13 17:22:24,697 [INFO]: }
2025-03-13 17:22:24,697 [INFO]: 	>>> Finished "Creating the index" in 58.1783 secs
2025-03-13 17:22:24,697 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2160 secs
2025-03-13 17:22:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 24066 [episode count 1/20]
[retrieval_preprocessing] for episode 54276 [episode count 2/20], we have num_retrieval=np.int64(2334) num_query=np.int64(96)
2025-03-13 17:22:29,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:29,817 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:29
2025-03-13 17:22:29,817 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1228.56it/s]
2025-03-13 17:22:29,853 [INFO]: There are 2334 embeddings of dim 49152
2025-03-13 17:22:29,853 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 17:22:29,853 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:29
2025-03-13 17:22:29,853 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:29,853 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:22:29,853 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:29,853 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:29,853 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:29
2025-03-13 17:22:29,854 [INFO]: 481.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:29,854 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:22:29,854 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:29
2025-03-13 17:22:29,854 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:29,854 [INFO]: 	Creating the index 03/13/2025, 17:22:29
2025-03-13 17:22:29,854 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:29
2025-03-13 17:22:29,855 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:22:29,855 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:29
2025-03-13 17:22:29,855 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:22:29,855 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.64it/s] 70%|███████   | 7/10 [00:00<00:00, 31.43it/s]100%|██████████| 10/10 [00:01<00:00,  5.32it/s]
2025-03-13 17:22:31,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:31
2025-03-13 17:23:00,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8798 secs
2025-03-13 17:23:00,619 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:23:00,619 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 17:23:22,951 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3310 secs
2025-03-13 17:23:22,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0970 secs
2025-03-13 17:23:22,953 [INFO]: {
2025-03-13 17:23:22,953 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:22,953 [INFO]: 	index_param: efSearch=220
2025-03-13 17:23:22,953 [INFO]: 	index_path: knn.index
2025-03-13 17:23:22,953 [INFO]: 	size in bytes: 459200170
2025-03-13 17:23:22,953 [INFO]: 	avg_search_speed_ms: 10.64024498919025
2025-03-13 17:23:22,953 [INFO]: 	99p_search_speed_ms: 15.580598816741258
2025-03-13 17:23:22,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:22,953 [INFO]: 	nb vectors: 2334
2025-03-13 17:23:22,953 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:22,953 [INFO]: 	compression ratio: 0.9993094558305586
2025-03-13 17:23:22,953 [INFO]: }
2025-03-13 17:23:22,953 [INFO]: 	>>> Finished "Creating the index" in 53.0990 secs
2025-03-13 17:23:22,953 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1354 secs
2025-03-13 17:23:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 54276 [episode count 2/20]
[retrieval_preprocessing] for episode 24587 [episode count 3/20], we have num_retrieval=np.int64(2317) num_query=np.int64(113)
2025-03-13 17:23:24,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:24,498 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:24
2025-03-13 17:23:24,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.08it/s]
2025-03-13 17:23:24,547 [INFO]: There are 2317 embeddings of dim 49152
2025-03-13 17:23:24,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0494 secs
2025-03-13 17:23:24,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:24,548 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:23:24,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:24,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:23:24,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,548 [INFO]: 478.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:24,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:23:24,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:24
2025-03-13 17:23:24,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:24,549 [INFO]: 	Creating the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:24
2025-03-13 17:23:24,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:23:24,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,550 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:23:24,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.08it/s] 50%|█████     | 5/10 [00:00<00:00, 24.46it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.44it/s]100%|██████████| 10/10 [00:02<00:00,  4.29it/s]
2025-03-13 17:23:26,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:26
2025-03-13 17:24:01,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3333 secs
2025-03-13 17:24:01,218 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 17:24:01,218 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-13 17:24:19,081 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8635 secs
2025-03-13 17:24:19,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5333 secs
2025-03-13 17:24:19,084 [INFO]: {
2025-03-13 17:24:19,084 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:19,084 [INFO]: 	index_param: efSearch=213
2025-03-13 17:24:19,084 [INFO]: 	index_path: knn.index
2025-03-13 17:24:19,084 [INFO]: 	size in bytes: 455855530
2025-03-13 17:24:19,084 [INFO]: 	avg_search_speed_ms: 10.393921787591106
2025-03-13 17:24:19,084 [INFO]: 	99p_search_speed_ms: 13.995848812628536
2025-03-13 17:24:19,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:19,084 [INFO]: 	nb vectors: 2317
2025-03-13 17:24:19,084 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:19,084 [INFO]: 	compression ratio: 0.9993094434984698
2025-03-13 17:24:19,084 [INFO]: }
2025-03-13 17:24:19,084 [INFO]: 	>>> Finished "Creating the index" in 54.5354 secs
2025-03-13 17:24:19,084 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5861 secs
2025-03-13 17:24:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 24587 [episode count 3/20]
[retrieval_preprocessing] for episode 26646 [episode count 4/20], we have num_retrieval=np.int64(2288) num_query=np.int64(142)
2025-03-13 17:24:20,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:20,812 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:20
2025-03-13 17:24:20,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2007.80it/s]
2025-03-13 17:24:20,842 [INFO]: There are 2288 embeddings of dim 49152
2025-03-13 17:24:20,843 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 17:24:20,843 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:20
2025-03-13 17:24:20,843 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:20,843 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:24:20,843 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:20,843 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:24:20,843 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:20
2025-03-13 17:24:20,844 [INFO]: 472.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:20,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:24:20,844 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:20
2025-03-13 17:24:20,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:20,844 [INFO]: 	Creating the index 03/13/2025, 17:24:20
2025-03-13 17:24:20,844 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:20
2025-03-13 17:24:20,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:24:20,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:20
2025-03-13 17:24:20,846 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:24:20,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.75it/s] 50%|█████     | 5/10 [00:00<00:00, 22.50it/s] 90%|█████████ | 9/10 [00:00<00:00, 28.01it/s]100%|██████████| 10/10 [00:01<00:00,  5.33it/s]
2025-03-13 17:24:22,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:22
2025-03-13 17:24:53,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9322 secs
2025-03-13 17:24:53,658 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 17:24:53,658 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-13 17:25:15,772 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1144 secs
2025-03-13 17:25:15,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9283 secs
2025-03-13 17:25:15,774 [INFO]: {
2025-03-13 17:25:15,774 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:15,774 [INFO]: 	index_param: efSearch=278
2025-03-13 17:25:15,774 [INFO]: 	index_path: knn.index
2025-03-13 17:25:15,774 [INFO]: 	size in bytes: 450149950
2025-03-13 17:25:15,774 [INFO]: 	avg_search_speed_ms: 12.424090914775311
2025-03-13 17:25:15,774 [INFO]: 	99p_search_speed_ms: 16.617190148681402
2025-03-13 17:25:15,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:15,774 [INFO]: 	nb vectors: 2288
2025-03-13 17:25:15,774 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:15,774 [INFO]: 	compression ratio: 0.9993094612139799
2025-03-13 17:25:15,774 [INFO]: }
2025-03-13 17:25:15,774 [INFO]: 	>>> Finished "Creating the index" in 54.9304 secs
2025-03-13 17:25:15,774 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9618 secs
2025-03-13 17:25:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 26646 [episode count 4/20]
[retrieval_preprocessing] for episode 9267 [episode count 5/20], we have num_retrieval=np.int64(2303) num_query=np.int64(127)
2025-03-13 17:25:17,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:18,887 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:18
2025-03-13 17:25:18,888 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-13 17:25:18,914 [INFO]: There are 2303 embeddings of dim 49152
2025-03-13 17:25:18,914 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:25:18,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:18
2025-03-13 17:25:18,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:18,915 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:25:18,915 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:18,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:18,915 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:18
2025-03-13 17:25:18,915 [INFO]: 475.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:18,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:18,915 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:18
2025-03-13 17:25:18,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:18,915 [INFO]: 	Creating the index 03/13/2025, 17:25:18
2025-03-13 17:25:18,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:18
2025-03-13 17:25:18,916 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:25:18,916 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:18
2025-03-13 17:25:18,916 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:25:18,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.71it/s] 30%|███       | 3/10 [00:00<00:00, 10.29it/s] 50%|█████     | 5/10 [00:00<00:00, 11.14it/s] 70%|███████   | 7/10 [00:00<00:00, 10.83it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.32it/s]100%|██████████| 10/10 [00:02<00:00,  1.95it/s]100%|██████████| 10/10 [00:02<00:00,  3.40it/s]
2025-03-13 17:25:21,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:21
2025-03-13 17:25:54,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4907 secs
2025-03-13 17:25:54,357 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:25:54,357 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.91it/s] 50%|█████     | 2/4 [00:00<00:00,  4.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.99it/s]
2025-03-13 17:26:13,709 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3511 secs
2025-03-13 17:26:13,712 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7958 secs
2025-03-13 17:26:13,712 [INFO]: {
2025-03-13 17:26:13,713 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:13,713 [INFO]: 	index_param: efSearch=196
2025-03-13 17:26:13,713 [INFO]: 	index_path: knn.index
2025-03-13 17:26:13,713 [INFO]: 	size in bytes: 453101110
2025-03-13 17:26:13,713 [INFO]: 	avg_search_speed_ms: 9.834243243811112
2025-03-13 17:26:13,713 [INFO]: 	99p_search_speed_ms: 18.541433718055504
2025-03-13 17:26:13,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:13,713 [INFO]: 	nb vectors: 2303
2025-03-13 17:26:13,713 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:13,713 [INFO]: 	compression ratio: 0.9993094565581621
2025-03-13 17:26:13,713 [INFO]: }
2025-03-13 17:26:13,713 [INFO]: 	>>> Finished "Creating the index" in 54.7976 secs
2025-03-13 17:26:13,713 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8252 secs
2025-03-13 17:26:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 9267 [episode count 5/20]
[retrieval_preprocessing] for episode 22579 [episode count 6/20], we have num_retrieval=np.int64(2265) num_query=np.int64(165)
2025-03-13 17:26:17,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:17,592 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:17
2025-03-13 17:26:17,593 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 765.10it/s]
2025-03-13 17:26:17,632 [INFO]: There are 2265 embeddings of dim 49152
2025-03-13 17:26:17,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0401 secs
2025-03-13 17:26:17,633 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:17
2025-03-13 17:26:17,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:17,634 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 17:26:17,634 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:17,634 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:26:17,634 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:17
2025-03-13 17:26:17,634 [INFO]: 467.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:17,634 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:26:17,635 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:17
2025-03-13 17:26:17,635 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:17,635 [INFO]: 	Creating the index 03/13/2025, 17:26:17
2025-03-13 17:26:17,635 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:17
2025-03-13 17:26:17,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:26:17,638 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:17
2025-03-13 17:26:17,639 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:26:17,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.44it/s] 67%|██████▋   | 6/9 [00:00<00:00, 26.88it/s]100%|██████████| 9/9 [00:02<00:00,  2.68it/s]100%|██████████| 9/9 [00:02<00:00,  3.43it/s]
2025-03-13 17:26:20,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:20
2025-03-13 17:26:57,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9616 secs
2025-03-13 17:26:57,232 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 17:26:57,233 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 17:27:24,228 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9956 secs
2025-03-13 17:27:24,231 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5924 secs
2025-03-13 17:27:24,231 [INFO]: {
2025-03-13 17:27:24,231 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:24,231 [INFO]: 	index_param: efSearch=228
2025-03-13 17:27:24,231 [INFO]: 	index_path: knn.index
2025-03-13 17:27:24,231 [INFO]: 	size in bytes: 445624870
2025-03-13 17:27:24,231 [INFO]: 	avg_search_speed_ms: 10.88472611171531
2025-03-13 17:27:24,231 [INFO]: 	99p_search_speed_ms: 16.481215334497374
2025-03-13 17:27:24,231 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:24,231 [INFO]: 	nb vectors: 2265
2025-03-13 17:27:24,231 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:24,231 [INFO]: 	compression ratio: 0.9993093967129797
2025-03-13 17:27:24,231 [INFO]: }
2025-03-13 17:27:24,231 [INFO]: 	>>> Finished "Creating the index" in 66.5961 secs
2025-03-13 17:27:24,231 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6388 secs
2025-03-13 17:27:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 22579 [episode count 6/20]
[retrieval_preprocessing] for episode 3127 [episode count 7/20], we have num_retrieval=np.int64(2340) num_query=np.int64(90)
2025-03-13 17:27:26,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:27,385 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:27
2025-03-13 17:27:27,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 750.05it/s]
2025-03-13 17:27:27,421 [INFO]: There are 2340 embeddings of dim 49152
2025-03-13 17:27:27,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 17:27:27,422 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:27
2025-03-13 17:27:27,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:27,422 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:27:27,422 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:27,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:27:27,422 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:27
2025-03-13 17:27:27,422 [INFO]: 482.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:27,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:27:27,422 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:27
2025-03-13 17:27:27,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:27,422 [INFO]: 	Creating the index 03/13/2025, 17:27:27
2025-03-13 17:27:27,422 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:27
2025-03-13 17:27:27,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:27:27,424 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:27
2025-03-13 17:27:27,425 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:27:27,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.59it/s] 20%|██        | 2/10 [00:00<00:00,  8.15it/s] 40%|████      | 4/10 [00:00<00:00,  9.42it/s] 60%|██████    | 6/10 [00:00<00:00,  9.89it/s] 70%|███████   | 7/10 [00:00<00:00,  9.89it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.14it/s]100%|██████████| 10/10 [00:03<00:00,  2.89it/s]
2025-03-13 17:27:30,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:30
2025-03-13 17:28:05,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3707 secs
2025-03-13 17:28:05,266 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 17:28:05,266 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.85it/s]
2025-03-13 17:28:25,542 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2755 secs
2025-03-13 17:28:25,769 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3442 secs
2025-03-13 17:28:25,769 [INFO]: {
2025-03-13 17:28:25,769 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:25,769 [INFO]: 	index_param: efSearch=237
2025-03-13 17:28:25,769 [INFO]: 	index_path: knn.index
2025-03-13 17:28:25,769 [INFO]: 	size in bytes: 460380610
2025-03-13 17:28:25,769 [INFO]: 	avg_search_speed_ms: 9.715224496307044
2025-03-13 17:28:25,769 [INFO]: 	99p_search_speed_ms: 17.25060522556307
2025-03-13 17:28:25,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:25,769 [INFO]: 	nb vectors: 2340
2025-03-13 17:28:25,770 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:25,770 [INFO]: 	compression ratio: 0.9993095061062628
2025-03-13 17:28:25,770 [INFO]: }
2025-03-13 17:28:25,770 [INFO]: 	>>> Finished "Creating the index" in 58.3475 secs
2025-03-13 17:28:25,770 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3844 secs
2025-03-13 17:28:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 3127 [episode count 7/20]
[retrieval_preprocessing] for episode 59979 [episode count 8/20], we have num_retrieval=np.int64(2318) num_query=np.int64(112)
2025-03-13 17:28:27,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:27,673 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:27
2025-03-13 17:28:27,674 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1391.61it/s]
2025-03-13 17:28:27,701 [INFO]: There are 2318 embeddings of dim 49152
2025-03-13 17:28:27,702 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:28:27,702 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:27
2025-03-13 17:28:27,702 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:27,702 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:28:27,702 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:27,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:28:27,703 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:27
2025-03-13 17:28:27,703 [INFO]: 478.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:27,703 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:28:27,703 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:27
2025-03-13 17:28:27,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:27,703 [INFO]: 	Creating the index 03/13/2025, 17:28:27
2025-03-13 17:28:27,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:27
2025-03-13 17:28:27,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:28:27,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:27
2025-03-13 17:28:27,707 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:28:27,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.91it/s] 30%|███       | 3/10 [00:00<00:00, 12.24it/s] 60%|██████    | 6/10 [00:00<00:00, 13.75it/s] 80%|████████  | 8/10 [00:00<00:00, 14.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.16it/s]100%|██████████| 10/10 [00:02<00:00,  4.64it/s]
2025-03-13 17:28:29,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:29
2025-03-13 17:28:55,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2117 secs
2025-03-13 17:28:55,082 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:28:55,082 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 17:29:25,208 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1261 secs
2025-03-13 17:29:25,211 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5038 secs
2025-03-13 17:29:25,211 [INFO]: {
2025-03-13 17:29:25,211 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:25,211 [INFO]: 	index_param: efSearch=254
2025-03-13 17:29:25,211 [INFO]: 	index_path: knn.index
2025-03-13 17:29:25,211 [INFO]: 	size in bytes: 456052270
2025-03-13 17:29:25,211 [INFO]: 	avg_search_speed_ms: 10.743732665186283
2025-03-13 17:29:25,211 [INFO]: 	99p_search_speed_ms: 14.138455106876792
2025-03-13 17:29:25,211 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:25,211 [INFO]: 	nb vectors: 2318
2025-03-13 17:29:25,211 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:25,211 [INFO]: 	compression ratio: 0.9993094519626007
2025-03-13 17:29:25,211 [INFO]: }
2025-03-13 17:29:25,211 [INFO]: 	>>> Finished "Creating the index" in 57.5075 secs
2025-03-13 17:29:25,211 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5375 secs
2025-03-13 17:29:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 59979 [episode count 8/20]
[retrieval_preprocessing] for episode 35927 [episode count 9/20], we have num_retrieval=np.int64(2314) num_query=np.int64(116)
2025-03-13 17:29:27,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:27,845 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:27
2025-03-13 17:29:27,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 820.64it/s]
2025-03-13 17:29:27,869 [INFO]: There are 2314 embeddings of dim 49152
2025-03-13 17:29:27,869 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 17:29:27,869 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:27
2025-03-13 17:29:27,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:27,870 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:29:27,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:27,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:29:27,870 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:27
2025-03-13 17:29:27,870 [INFO]: 477.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:27,870 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:27,870 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:27
2025-03-13 17:29:27,870 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:27,871 [INFO]: 	Creating the index 03/13/2025, 17:29:27
2025-03-13 17:29:27,871 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:27
2025-03-13 17:29:27,872 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:29:27,873 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:27
2025-03-13 17:29:27,873 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:29:27,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.43it/s] 20%|██        | 2/10 [00:00<00:01,  6.11it/s] 30%|███       | 3/10 [00:00<00:00,  7.23it/s] 40%|████      | 4/10 [00:00<00:00,  7.91it/s] 50%|█████     | 5/10 [00:00<00:00,  8.47it/s] 60%|██████    | 6/10 [00:00<00:00,  8.80it/s] 70%|███████   | 7/10 [00:00<00:00,  9.04it/s] 80%|████████  | 8/10 [00:00<00:00,  8.97it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.05it/s]100%|██████████| 10/10 [00:03<00:00,  1.36it/s]100%|██████████| 10/10 [00:03<00:00,  3.09it/s]
2025-03-13 17:29:31,109 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:31
2025-03-13 17:30:03,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8714 secs
2025-03-13 17:30:03,981 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 17:30:03,981 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 17:30:23,759 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7783 secs
2025-03-13 17:30:24,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3612 secs
2025-03-13 17:30:24,234 [INFO]: {
2025-03-13 17:30:24,234 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:24,235 [INFO]: 	index_param: efSearch=229
2025-03-13 17:30:24,235 [INFO]: 	index_path: knn.index
2025-03-13 17:30:24,235 [INFO]: 	size in bytes: 455265310
2025-03-13 17:30:24,235 [INFO]: 	avg_search_speed_ms: 10.300055803466362
2025-03-13 17:30:24,235 [INFO]: 	99p_search_speed_ms: 20.20388632081447
2025-03-13 17:30:24,235 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:24,235 [INFO]: 	nb vectors: 2314
2025-03-13 17:30:24,235 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:24,235 [INFO]: 	compression ratio: 0.9993094180621844
2025-03-13 17:30:24,235 [INFO]: }
2025-03-13 17:30:24,235 [INFO]: 	>>> Finished "Creating the index" in 56.3644 secs
2025-03-13 17:30:24,235 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3903 secs
2025-03-13 17:30:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 35927 [episode count 9/20]
[retrieval_preprocessing] for episode 37464 [episode count 10/20], we have num_retrieval=np.int64(2287) num_query=np.int64(143)
2025-03-13 17:30:26,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:26,871 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:26
2025-03-13 17:30:26,872 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1030.04it/s]
2025-03-13 17:30:26,898 [INFO]: There are 2287 embeddings of dim 49152
2025-03-13 17:30:26,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:30:26,899 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:26
2025-03-13 17:30:26,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:26,899 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:30:26,900 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:26,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:30:26,900 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:26
2025-03-13 17:30:26,900 [INFO]: 472.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:26,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:30:26,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:26
2025-03-13 17:30:26,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:26,901 [INFO]: 	Creating the index 03/13/2025, 17:30:26
2025-03-13 17:30:26,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:26
2025-03-13 17:30:26,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:30:26,904 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:26
2025-03-13 17:30:26,905 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:30:26,905 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.42it/s] 20%|██        | 2/10 [00:00<00:01,  5.42it/s] 30%|███       | 3/10 [00:00<00:01,  5.45it/s] 40%|████      | 4/10 [00:00<00:01,  5.94it/s] 50%|█████     | 5/10 [00:00<00:00,  6.30it/s] 60%|██████    | 6/10 [00:00<00:00,  6.62it/s] 70%|███████   | 7/10 [00:01<00:00,  6.60it/s] 80%|████████  | 8/10 [00:01<00:00,  6.78it/s] 90%|█████████ | 9/10 [00:01<00:00,  6.81it/s]100%|██████████| 10/10 [00:03<00:00,  1.52it/s]100%|██████████| 10/10 [00:03<00:00,  3.12it/s]
2025-03-13 17:30:30,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:30
2025-03-13 17:31:00,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2482 secs
2025-03-13 17:31:00,368 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 17:31:00,368 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 17:31:20,013 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6445 secs
2025-03-13 17:31:20,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1113 secs
2025-03-13 17:31:20,016 [INFO]: {
2025-03-13 17:31:20,016 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:20,016 [INFO]: 	index_param: efSearch=221
2025-03-13 17:31:20,016 [INFO]: 	index_path: knn.index
2025-03-13 17:31:20,016 [INFO]: 	size in bytes: 449953210
2025-03-13 17:31:20,016 [INFO]: 	avg_search_speed_ms: 9.503590480642245
2025-03-13 17:31:20,016 [INFO]: 	99p_search_speed_ms: 16.487852951977402
2025-03-13 17:31:20,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:20,016 [INFO]: 	nb vectors: 2287
2025-03-13 17:31:20,016 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:20,016 [INFO]: 	compression ratio: 0.9993094526428647
2025-03-13 17:31:20,016 [INFO]: }
2025-03-13 17:31:20,016 [INFO]: 	>>> Finished "Creating the index" in 53.1155 secs
2025-03-13 17:31:20,016 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1448 secs
2025-03-13 17:31:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 37464 [episode count 10/20]
[retrieval_preprocessing] for episode 91767 [episode count 11/20], we have num_retrieval=np.int64(2326) num_query=np.int64(104)
2025-03-13 17:31:21,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:22,105 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:22
2025-03-13 17:31:22,105 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 949.37it/s]
2025-03-13 17:31:22,143 [INFO]: There are 2326 embeddings of dim 49152
2025-03-13 17:31:22,143 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 17:31:22,143 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:22
2025-03-13 17:31:22,143 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:22,144 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:31:22,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:22,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:31:22,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:22
2025-03-13 17:31:22,144 [INFO]: 480.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:22,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:31:22,144 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:22
2025-03-13 17:31:22,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:22,144 [INFO]: 	Creating the index 03/13/2025, 17:31:22
2025-03-13 17:31:22,144 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:22
2025-03-13 17:31:22,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:31:22,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:22
2025-03-13 17:31:22,146 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:31:22,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.59it/s] 60%|██████    | 6/10 [00:00<00:00, 28.91it/s]100%|██████████| 10/10 [00:02<00:00,  3.86it/s]100%|██████████| 10/10 [00:02<00:00,  4.63it/s]
2025-03-13 17:31:24,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:24
2025-03-13 17:32:05,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2224 secs
2025-03-13 17:32:05,535 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 17:32:05,535 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 17:32:29,325 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7898 secs
2025-03-13 17:32:29,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1815 secs
2025-03-13 17:32:29,328 [INFO]: {
2025-03-13 17:32:29,328 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:29,328 [INFO]: 	index_param: efSearch=171
2025-03-13 17:32:29,328 [INFO]: 	index_path: knn.index
2025-03-13 17:32:29,328 [INFO]: 	size in bytes: 457626250
2025-03-13 17:32:29,328 [INFO]: 	avg_search_speed_ms: 8.255325258931746
2025-03-13 17:32:29,328 [INFO]: 	99p_search_speed_ms: 11.223490512929864
2025-03-13 17:32:29,328 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:29,328 [INFO]: 	nb vectors: 2326
2025-03-13 17:32:29,328 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:29,328 [INFO]: 	compression ratio: 0.9993093883928206
2025-03-13 17:32:29,328 [INFO]: }
2025-03-13 17:32:29,328 [INFO]: 	>>> Finished "Creating the index" in 67.1836 secs
2025-03-13 17:32:29,328 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2225 secs
2025-03-13 17:32:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 91767 [episode count 11/20]
[retrieval_preprocessing] for episode 83064 [episode count 12/20], we have num_retrieval=np.int64(2301) num_query=np.int64(129)
2025-03-13 17:32:30,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:30,913 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:30
2025-03-13 17:32:30,914 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 851.64it/s]
2025-03-13 17:32:30,961 [INFO]: There are 2301 embeddings of dim 49152
2025-03-13 17:32:30,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0482 secs
2025-03-13 17:32:30,962 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:30
2025-03-13 17:32:30,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:30,962 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:32:30,962 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:30,962 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:30,962 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:30
2025-03-13 17:32:30,962 [INFO]: 474.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:30,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:32:30,962 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:30
2025-03-13 17:32:30,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:30,963 [INFO]: 	Creating the index 03/13/2025, 17:32:30
2025-03-13 17:32:30,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:30
2025-03-13 17:32:30,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:32:30,964 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:30
2025-03-13 17:32:30,964 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:32:30,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.10it/s] 70%|███████   | 7/10 [00:00<00:00, 34.38it/s]100%|██████████| 10/10 [00:01<00:00,  5.11it/s]
2025-03-13 17:32:33,480 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:33
2025-03-13 17:33:05,319 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8389 secs
2025-03-13 17:33:05,320 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 17:33:05,320 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 17:33:25,118 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7976 secs
2025-03-13 17:33:25,120 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1554 secs
2025-03-13 17:33:25,120 [INFO]: {
2025-03-13 17:33:25,120 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:25,120 [INFO]: 	index_param: efSearch=186
2025-03-13 17:33:25,120 [INFO]: 	index_path: knn.index
2025-03-13 17:33:25,120 [INFO]: 	size in bytes: 452707630
2025-03-13 17:33:25,120 [INFO]: 	avg_search_speed_ms: 11.315752177950147
2025-03-13 17:33:25,120 [INFO]: 	99p_search_speed_ms: 15.103893554769456
2025-03-13 17:33:25,120 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:25,120 [INFO]: 	nb vectors: 2301
2025-03-13 17:33:25,120 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:25,120 [INFO]: 	compression ratio: 0.999309439516184
2025-03-13 17:33:25,120 [INFO]: }
2025-03-13 17:33:25,120 [INFO]: 	>>> Finished "Creating the index" in 54.1578 secs
2025-03-13 17:33:25,120 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2067 secs
2025-03-13 17:33:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83064 [episode count 12/20]
[retrieval_preprocessing] for episode 53881 [episode count 13/20], we have num_retrieval=np.int64(2310) num_query=np.int64(120)
2025-03-13 17:33:26,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:27,383 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:27
2025-03-13 17:33:27,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.90it/s]
2025-03-13 17:33:27,417 [INFO]: There are 2310 embeddings of dim 49152
2025-03-13 17:33:27,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 17:33:27,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:27
2025-03-13 17:33:27,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:27,418 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:33:27,418 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:27,418 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:33:27,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:27
2025-03-13 17:33:27,419 [INFO]: 476.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:27,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:33:27,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:27
2025-03-13 17:33:27,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:27,420 [INFO]: 	Creating the index 03/13/2025, 17:33:27
2025-03-13 17:33:27,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:27
2025-03-13 17:33:27,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:33:27,423 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:27
2025-03-13 17:33:27,423 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:33:27,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.23it/s] 70%|███████   | 7/10 [00:00<00:00, 35.02it/s]100%|██████████| 10/10 [00:01<00:00,  5.13it/s]
2025-03-13 17:33:29,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:29
2025-03-13 17:33:56,001 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6203 secs
2025-03-13 17:33:56,001 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 17:33:56,001 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s]
2025-03-13 17:34:25,145 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1431 secs
2025-03-13 17:34:25,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7239 secs
2025-03-13 17:34:25,147 [INFO]: {
2025-03-13 17:34:25,147 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:25,147 [INFO]: 	index_param: efSearch=219
2025-03-13 17:34:25,147 [INFO]: 	index_path: knn.index
2025-03-13 17:34:25,147 [INFO]: 	size in bytes: 454478350
2025-03-13 17:34:25,147 [INFO]: 	avg_search_speed_ms: 9.514303269621506
2025-03-13 17:34:25,147 [INFO]: 	99p_search_speed_ms: 12.75473099667579
2025-03-13 17:34:25,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:25,147 [INFO]: 	nb vectors: 2310
2025-03-13 17:34:25,147 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:25,147 [INFO]: 	compression ratio: 0.9993093840443664
2025-03-13 17:34:25,147 [INFO]: }
2025-03-13 17:34:25,147 [INFO]: 	>>> Finished "Creating the index" in 57.7273 secs
2025-03-13 17:34:25,147 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7634 secs
2025-03-13 17:34:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 53881 [episode count 13/20]
[retrieval_preprocessing] for episode 44155 [episode count 14/20], we have num_retrieval=np.int64(2301) num_query=np.int64(129)
2025-03-13 17:34:26,218 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:26,582 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:26
2025-03-13 17:34:26,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-13 17:34:26,629 [INFO]: There are 2301 embeddings of dim 49152
2025-03-13 17:34:26,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0466 secs
2025-03-13 17:34:26,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:26
2025-03-13 17:34:26,630 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:26,630 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:34:26,630 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:26,630 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:34:26,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:26
2025-03-13 17:34:26,631 [INFO]: 474.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:26,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:34:26,631 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:26
2025-03-13 17:34:26,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:26,632 [INFO]: 	Creating the index 03/13/2025, 17:34:26
2025-03-13 17:34:26,632 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:26
2025-03-13 17:34:26,634 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:34:26,635 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:26
2025-03-13 17:34:26,635 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:34:26,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.45it/s] 50%|█████     | 5/10 [00:00<00:00, 24.90it/s]100%|██████████| 10/10 [00:01<00:00,  5.10it/s]100%|██████████| 10/10 [00:01<00:00,  5.83it/s]
2025-03-13 17:34:28,357 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:28
2025-03-13 17:35:11,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0982 secs
2025-03-13 17:35:11,456 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:35:11,456 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.46it/s]
2025-03-13 17:35:33,777 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3213 secs
2025-03-13 17:35:33,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1444 secs
2025-03-13 17:35:33,779 [INFO]: {
2025-03-13 17:35:33,779 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:33,779 [INFO]: 	index_param: efSearch=155
2025-03-13 17:35:33,779 [INFO]: 	index_path: knn.index
2025-03-13 17:35:33,779 [INFO]: 	size in bytes: 452707630
2025-03-13 17:35:33,779 [INFO]: 	avg_search_speed_ms: 7.50682779305332
2025-03-13 17:35:33,779 [INFO]: 	99p_search_speed_ms: 11.370359461288901
2025-03-13 17:35:33,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:33,779 [INFO]: 	nb vectors: 2301
2025-03-13 17:35:33,780 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:33,780 [INFO]: 	compression ratio: 0.999309439516184
2025-03-13 17:35:33,780 [INFO]: }
2025-03-13 17:35:33,780 [INFO]: 	>>> Finished "Creating the index" in 67.1476 secs
2025-03-13 17:35:33,780 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1970 secs
2025-03-13 17:35:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 44155 [episode count 14/20]
[retrieval_preprocessing] for episode 75387 [episode count 15/20], we have num_retrieval=np.int64(2293) num_query=np.int64(137)
2025-03-13 17:35:34,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:35,347 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:35
2025-03-13 17:35:35,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1711.96it/s]
2025-03-13 17:35:35,374 [INFO]: There are 2293 embeddings of dim 49152
2025-03-13 17:35:35,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:35:35,375 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:35,375 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:35:35,375 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:35,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:35:35,375 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,375 [INFO]: 473.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:35,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:35:35,375 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:35
2025-03-13 17:35:35,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:35,375 [INFO]: 	Creating the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,375 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:35
2025-03-13 17:35:35,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:35:35,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:35
2025-03-13 17:35:35,377 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:35:35,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.38it/s] 70%|███████   | 7/10 [00:00<00:00, 35.45it/s]100%|██████████| 10/10 [00:02<00:00,  4.84it/s]
2025-03-13 17:35:37,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:37
2025-03-13 17:36:08,849 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4024 secs
2025-03-13 17:36:08,849 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 17:36:08,849 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 17:36:26,810 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9602 secs
2025-03-13 17:36:26,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4351 secs
2025-03-13 17:36:26,812 [INFO]: {
2025-03-13 17:36:26,812 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:26,812 [INFO]: 	index_param: efSearch=243
2025-03-13 17:36:26,812 [INFO]: 	index_path: knn.index
2025-03-13 17:36:26,812 [INFO]: 	size in bytes: 451133710
2025-03-13 17:36:26,812 [INFO]: 	avg_search_speed_ms: 9.229251216002483
2025-03-13 17:36:26,812 [INFO]: 	99p_search_speed_ms: 12.378830707166351
2025-03-13 17:36:26,812 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:26,812 [INFO]: 	nb vectors: 2293
2025-03-13 17:36:26,812 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:26,812 [INFO]: 	compression ratio: 0.9993093710509906
2025-03-13 17:36:26,812 [INFO]: }
2025-03-13 17:36:26,812 [INFO]: 	>>> Finished "Creating the index" in 51.4366 secs
2025-03-13 17:36:26,812 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4652 secs
2025-03-13 17:36:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 75387 [episode count 15/20]
[retrieval_preprocessing] for episode 36997 [episode count 16/20], we have num_retrieval=np.int64(2335) num_query=np.int64(95)
2025-03-13 17:36:28,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:28,916 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:28
2025-03-13 17:36:28,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2128.01it/s]
2025-03-13 17:36:28,951 [INFO]: There are 2335 embeddings of dim 49152
2025-03-13 17:36:28,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 17:36:28,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:28
2025-03-13 17:36:28,952 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:28,952 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:36:28,952 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:28,952 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:28,952 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:28
2025-03-13 17:36:28,952 [INFO]: 481.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:28,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:28,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:28
2025-03-13 17:36:28,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:28,952 [INFO]: 	Creating the index 03/13/2025, 17:36:28
2025-03-13 17:36:28,952 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:28
2025-03-13 17:36:28,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:36:28,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:28
2025-03-13 17:36:28,953 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:36:28,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.19it/s] 70%|███████   | 7/10 [00:00<00:00, 35.97it/s]100%|██████████| 10/10 [00:01<00:00,  5.71it/s]
2025-03-13 17:36:30,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:30
2025-03-13 17:37:02,617 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9078 secs
2025-03-13 17:37:02,617 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:37:02,617 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-13 17:37:17,257 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6392 secs
2025-03-13 17:37:17,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3057 secs
2025-03-13 17:37:17,259 [INFO]: {
2025-03-13 17:37:17,259 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:17,259 [INFO]: 	index_param: efSearch=184
2025-03-13 17:37:17,259 [INFO]: 	index_path: knn.index
2025-03-13 17:37:17,259 [INFO]: 	size in bytes: 459396910
2025-03-13 17:37:17,259 [INFO]: 	avg_search_speed_ms: 7.9148969816742465
2025-03-13 17:37:17,259 [INFO]: 	99p_search_speed_ms: 10.000297650694838
2025-03-13 17:37:17,259 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:17,259 [INFO]: 	nb vectors: 2335
2025-03-13 17:37:17,259 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:17,259 [INFO]: 	compression ratio: 0.9993094642277851
2025-03-13 17:37:17,259 [INFO]: }
2025-03-13 17:37:17,259 [INFO]: 	>>> Finished "Creating the index" in 48.3073 secs
2025-03-13 17:37:17,259 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3435 secs
2025-03-13 17:37:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 36997 [episode count 16/20]
[retrieval_preprocessing] for episode 17046 [episode count 17/20], we have num_retrieval=np.int64(2295) num_query=np.int64(135)
2025-03-13 17:37:18,548 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:19,032 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:19
2025-03-13 17:37:19,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-13 17:37:19,063 [INFO]: There are 2295 embeddings of dim 49152
2025-03-13 17:37:19,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 17:37:19,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:19
2025-03-13 17:37:19,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:19,064 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:37:19,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:19,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:37:19,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:19
2025-03-13 17:37:19,064 [INFO]: 473.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:19,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:37:19,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:19
2025-03-13 17:37:19,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:19,064 [INFO]: 	Creating the index 03/13/2025, 17:37:19
2025-03-13 17:37:19,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:19
2025-03-13 17:37:19,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:37:19,066 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:19
2025-03-13 17:37:19,066 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:37:19,066 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.26it/s] 50%|█████     | 5/10 [00:00<00:00, 23.66it/s] 90%|█████████ | 9/10 [00:00<00:00, 30.06it/s]100%|██████████| 10/10 [00:02<00:00,  3.51it/s]
2025-03-13 17:37:21,917 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:21
2025-03-13 17:37:54,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8448 secs
2025-03-13 17:37:54,763 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 17:37:54,763 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-13 17:38:17,918 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1556 secs
2025-03-13 17:38:17,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8546 secs
2025-03-13 17:38:17,921 [INFO]: {
2025-03-13 17:38:17,921 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:17,921 [INFO]: 	index_param: efSearch=270
2025-03-13 17:38:17,921 [INFO]: 	index_path: knn.index
2025-03-13 17:38:17,921 [INFO]: 	size in bytes: 451527190
2025-03-13 17:38:17,921 [INFO]: 	avg_search_speed_ms: 12.065061284633593
2025-03-13 17:38:17,921 [INFO]: 	99p_search_speed_ms: 16.227376032620672
2025-03-13 17:38:17,921 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:17,921 [INFO]: 	nb vectors: 2295
2025-03-13 17:38:17,921 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:17,921 [INFO]: 	compression ratio: 0.9993093882120366
2025-03-13 17:38:17,921 [INFO]: }
2025-03-13 17:38:17,921 [INFO]: 	>>> Finished "Creating the index" in 58.8564 secs
2025-03-13 17:38:17,921 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8882 secs
2025-03-13 17:38:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 17046 [episode count 17/20]
[retrieval_preprocessing] for episode 30358 [episode count 18/20], we have num_retrieval=np.int64(2311) num_query=np.int64(119)
2025-03-13 17:38:19,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:20,247 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:20
2025-03-13 17:38:20,248 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 469.95it/s]
2025-03-13 17:38:20,303 [INFO]: There are 2311 embeddings of dim 49152
2025-03-13 17:38:20,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0556 secs
2025-03-13 17:38:20,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:20
2025-03-13 17:38:20,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:20,304 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:38:20,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:20,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:38:20,305 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:20
2025-03-13 17:38:20,305 [INFO]: 476.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:20,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:38:20,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:20
2025-03-13 17:38:20,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:20,306 [INFO]: 	Creating the index 03/13/2025, 17:38:20
2025-03-13 17:38:20,306 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:20
2025-03-13 17:38:20,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:38:20,309 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:20
2025-03-13 17:38:20,309 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:38:20,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.81it/s] 70%|███████   | 7/10 [00:00<00:00, 32.14it/s]100%|██████████| 10/10 [00:01<00:00,  5.16it/s]
2025-03-13 17:38:22,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:22
2025-03-13 17:38:52,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5655 secs
2025-03-13 17:38:52,818 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:38:52,818 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.75it/s]
2025-03-13 17:39:12,609 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7908 secs
2025-03-13 17:39:13,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7919 secs
2025-03-13 17:39:13,101 [INFO]: {
2025-03-13 17:39:13,102 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:13,102 [INFO]: 	index_param: efSearch=232
2025-03-13 17:39:13,102 [INFO]: 	index_path: knn.index
2025-03-13 17:39:13,102 [INFO]: 	size in bytes: 454675090
2025-03-13 17:39:13,102 [INFO]: 	avg_search_speed_ms: 10.198536653652651
2025-03-13 17:39:13,102 [INFO]: 	99p_search_speed_ms: 15.113225532695651
2025-03-13 17:39:13,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:13,102 [INFO]: 	nb vectors: 2311
2025-03-13 17:39:13,102 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:13,102 [INFO]: 	compression ratio: 0.9993093925598607
2025-03-13 17:39:13,102 [INFO]: }
2025-03-13 17:39:13,102 [INFO]: 	>>> Finished "Creating the index" in 52.7965 secs
2025-03-13 17:39:13,102 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8546 secs
2025-03-13 17:39:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 30358 [episode count 18/20]
[retrieval_preprocessing] for episode 48278 [episode count 19/20], we have num_retrieval=np.int64(2330) num_query=np.int64(100)
2025-03-13 17:39:14,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:15,072 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:15
2025-03-13 17:39:15,072 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.47it/s]
2025-03-13 17:39:15,110 [INFO]: There are 2330 embeddings of dim 49152
2025-03-13 17:39:15,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 17:39:15,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:15
2025-03-13 17:39:15,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:15,110 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:39:15,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:15,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:15,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:15
2025-03-13 17:39:15,110 [INFO]: 480.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:15,111 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:39:15,111 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:15
2025-03-13 17:39:15,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:15,111 [INFO]: 	Creating the index 03/13/2025, 17:39:15
2025-03-13 17:39:15,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:15
2025-03-13 17:39:15,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:39:15,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:15
2025-03-13 17:39:15,112 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:39:15,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.78it/s] 70%|███████   | 7/10 [00:00<00:00, 33.41it/s]100%|██████████| 10/10 [00:01<00:00,  5.82it/s]
2025-03-13 17:39:16,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:16
2025-03-13 17:39:46,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0963 secs
2025-03-13 17:39:46,931 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 17:39:46,931 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.71it/s]
2025-03-13 17:40:17,499 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5684 secs
2025-03-13 17:40:17,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3886 secs
2025-03-13 17:40:17,501 [INFO]: {
2025-03-13 17:40:17,501 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:17,501 [INFO]: 	index_param: efSearch=223
2025-03-13 17:40:17,501 [INFO]: 	index_path: knn.index
2025-03-13 17:40:17,501 [INFO]: 	size in bytes: 458413210
2025-03-13 17:40:17,501 [INFO]: 	avg_search_speed_ms: 8.437317736124628
2025-03-13 17:40:17,501 [INFO]: 	99p_search_speed_ms: 10.888622924685482
2025-03-13 17:40:17,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:17,501 [INFO]: 	nb vectors: 2330
2025-03-13 17:40:17,501 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:17,501 [INFO]: 	compression ratio: 0.999309422169575
2025-03-13 17:40:17,501 [INFO]: }
2025-03-13 17:40:17,501 [INFO]: 	>>> Finished "Creating the index" in 62.3905 secs
2025-03-13 17:40:17,501 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4296 secs
2025-03-13 17:40:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 48278 [episode count 19/20]
2025-03-13 17:40:18: [retrieval_preprocessing] finished for 9306310171_put_tape_on_plate [chosen_id count 7/196]
2025-03-13 17:40:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9306310171_remove_pen_put_on_table [chosen_id count 8/196]
2025-03-13 17:40:18: [retrieval_preprocessing] we have num_total=2591 embedding_dim=49152
[retrieval_preprocessing] for episode 26627 [episode count 0/20], we have num_retrieval=np.int64(2463) num_query=np.int64(128)
2025-03-13 17:40:19,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:19,492 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:19
2025-03-13 17:40:19,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 17:40:19,533 [INFO]: There are 2463 embeddings of dim 49152
2025-03-13 17:40:19,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 17:40:19,533 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:19
2025-03-13 17:40:19,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:19,533 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:40:19,533 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:19,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:40:19,533 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:19
2025-03-13 17:40:19,534 [INFO]: 508.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:19,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:40:19,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:19
2025-03-13 17:40:19,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:19,534 [INFO]: 	Creating the index 03/13/2025, 17:40:19
2025-03-13 17:40:19,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:19
2025-03-13 17:40:19,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:40:19,535 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:19
2025-03-13 17:40:19,535 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:40:19,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.13it/s] 70%|███████   | 7/10 [00:00<00:00, 33.78it/s]100%|██████████| 10/10 [00:02<00:00,  4.88it/s]
2025-03-13 17:40:21,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:21
2025-03-13 17:40:53,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9619 secs
2025-03-13 17:40:53,551 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:40:53,551 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 17:41:13,503 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9518 secs
2025-03-13 17:41:13,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9707 secs
2025-03-13 17:41:13,506 [INFO]: {
2025-03-13 17:41:13,506 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:13,506 [INFO]: 	index_param: efSearch=202
2025-03-13 17:41:13,506 [INFO]: 	index_path: knn.index
2025-03-13 17:41:13,506 [INFO]: 	size in bytes: 484579870
2025-03-13 17:41:13,506 [INFO]: 	avg_search_speed_ms: 12.567149677919925
2025-03-13 17:41:13,506 [INFO]: 	99p_search_speed_ms: 18.222998024430126
2025-03-13 17:41:13,506 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:13,506 [INFO]: 	nb vectors: 2463
2025-03-13 17:41:13,506 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:13,506 [INFO]: 	compression ratio: 0.9993099878457601
2025-03-13 17:41:13,506 [INFO]: }
2025-03-13 17:41:13,506 [INFO]: 	>>> Finished "Creating the index" in 53.9723 secs
2025-03-13 17:41:13,506 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0135 secs
2025-03-13 17:41:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 26627 [episode count 0/20]
[retrieval_preprocessing] for episode 44559 [episode count 1/20], we have num_retrieval=np.int64(2457) num_query=np.int64(134)
2025-03-13 17:41:15,519 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:16,054 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:16
2025-03-13 17:41:16,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1963.63it/s]
2025-03-13 17:41:16,084 [INFO]: There are 2457 embeddings of dim 49152
2025-03-13 17:41:16,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:41:16,084 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:16
2025-03-13 17:41:16,085 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:16,085 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:41:16,085 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:16,085 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:16,085 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:16
2025-03-13 17:41:16,085 [INFO]: 507.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:16,085 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:16,085 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:16
2025-03-13 17:41:16,085 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:16,085 [INFO]: 	Creating the index 03/13/2025, 17:41:16
2025-03-13 17:41:16,085 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:16
2025-03-13 17:41:16,086 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:41:16,086 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:16
2025-03-13 17:41:16,086 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:41:16,086 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.77it/s] 50%|█████     | 5/10 [00:00<00:00, 22.90it/s] 90%|█████████ | 9/10 [00:00<00:00, 27.98it/s]100%|██████████| 10/10 [00:02<00:00,  3.69it/s]
2025-03-13 17:41:18,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:18
2025-03-13 17:41:54,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2369 secs
2025-03-13 17:41:54,038 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:41:54,038 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 17:42:10,169 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1309 secs
2025-03-13 17:42:10,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0844 secs
2025-03-13 17:42:10,171 [INFO]: {
2025-03-13 17:42:10,171 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:10,171 [INFO]: 	index_param: efSearch=196
2025-03-13 17:42:10,171 [INFO]: 	index_path: knn.index
2025-03-13 17:42:10,171 [INFO]: 	size in bytes: 483399430
2025-03-13 17:42:10,171 [INFO]: 	avg_search_speed_ms: 9.62400441914008
2025-03-13 17:42:10,171 [INFO]: 	99p_search_speed_ms: 14.433991168625647
2025-03-13 17:42:10,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:10,171 [INFO]: 	nb vectors: 2457
2025-03-13 17:42:10,171 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:10,171 [INFO]: 	compression ratio: 0.9993099412632738
2025-03-13 17:42:10,171 [INFO]: }
2025-03-13 17:42:10,171 [INFO]: 	>>> Finished "Creating the index" in 54.0859 secs
2025-03-13 17:42:10,171 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1171 secs
2025-03-13 17:42:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 44559 [episode count 1/20]
[retrieval_preprocessing] for episode 50193 [episode count 2/20], we have num_retrieval=np.int64(2473) num_query=np.int64(118)
2025-03-13 17:42:12,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:13,102 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:13
2025-03-13 17:42:13,102 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1200.43it/s]
2025-03-13 17:42:13,146 [INFO]: There are 2473 embeddings of dim 49152
2025-03-13 17:42:13,146 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0445 secs
2025-03-13 17:42:13,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:13
2025-03-13 17:42:13,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:13,147 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:42:13,147 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:13,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:42:13,147 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:13
2025-03-13 17:42:13,148 [INFO]: 510.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:13,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:42:13,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:13
2025-03-13 17:42:13,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:13,148 [INFO]: 	Creating the index 03/13/2025, 17:42:13
2025-03-13 17:42:13,149 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:13
2025-03-13 17:42:13,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:42:13,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:13
2025-03-13 17:42:13,152 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:42:13,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.57it/s] 70%|███████   | 7/10 [00:00<00:00, 36.26it/s]100%|██████████| 10/10 [00:01<00:00,  5.41it/s]
2025-03-13 17:42:15,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:15
2025-03-13 17:42:42,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5443 secs
2025-03-13 17:42:42,551 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:42:42,552 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.29it/s]
2025-03-13 17:43:06,973 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4211 secs
2025-03-13 17:43:06,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8235 secs
2025-03-13 17:43:06,975 [INFO]: {
2025-03-13 17:43:06,976 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:06,976 [INFO]: 	index_param: efSearch=156
2025-03-13 17:43:06,976 [INFO]: 	index_path: knn.index
2025-03-13 17:43:06,976 [INFO]: 	size in bytes: 486547270
2025-03-13 17:43:06,976 [INFO]: 	avg_search_speed_ms: 8.42936073773828
2025-03-13 17:43:06,976 [INFO]: 	99p_search_speed_ms: 12.258649209979929
2025-03-13 17:43:06,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:06,976 [INFO]: 	nb vectors: 2473
2025-03-13 17:43:06,976 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:06,976 [INFO]: 	compression ratio: 0.9993100649809421
2025-03-13 17:43:06,976 [INFO]: }
2025-03-13 17:43:06,976 [INFO]: 	>>> Finished "Creating the index" in 53.8272 secs
2025-03-13 17:43:06,976 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8738 secs
2025-03-13 17:43:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 50193 [episode count 2/20]
[retrieval_preprocessing] for episode 81437 [episode count 3/20], we have num_retrieval=np.int64(2447) num_query=np.int64(144)
2025-03-13 17:43:08,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:08,828 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:08
2025-03-13 17:43:08,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.24it/s]
2025-03-13 17:43:08,858 [INFO]: There are 2447 embeddings of dim 49152
2025-03-13 17:43:08,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:43:08,859 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:08
2025-03-13 17:43:08,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:08,859 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:43:08,859 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:08,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:43:08,859 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:08
2025-03-13 17:43:08,859 [INFO]: 505.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:08,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:43:08,859 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:08
2025-03-13 17:43:08,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:08,859 [INFO]: 	Creating the index 03/13/2025, 17:43:08
2025-03-13 17:43:08,859 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:08
2025-03-13 17:43:08,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:43:08,860 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:08
2025-03-13 17:43:08,860 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:43:08,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.05it/s] 40%|████      | 4/10 [00:00<00:00, 14.69it/s] 80%|████████  | 8/10 [00:00<00:00, 22.34it/s]100%|██████████| 10/10 [00:02<00:00,  4.28it/s]
2025-03-13 17:43:11,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:11
2025-03-13 17:43:40,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9520 secs
2025-03-13 17:43:40,155 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 17:43:40,155 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-13 17:44:06,354 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1993 secs
2025-03-13 17:44:06,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4957 secs
2025-03-13 17:44:06,356 [INFO]: {
2025-03-13 17:44:06,356 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:06,356 [INFO]: 	index_param: efSearch=166
2025-03-13 17:44:06,356 [INFO]: 	index_path: knn.index
2025-03-13 17:44:06,356 [INFO]: 	size in bytes: 481431970
2025-03-13 17:44:06,356 [INFO]: 	avg_search_speed_ms: 7.567442518240863
2025-03-13 17:44:06,356 [INFO]: 	99p_search_speed_ms: 10.86183912120759
2025-03-13 17:44:06,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:06,356 [INFO]: 	nb vectors: 2447
2025-03-13 17:44:06,356 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:06,356 [INFO]: 	compression ratio: 0.9993099876603542
2025-03-13 17:44:06,356 [INFO]: }
2025-03-13 17:44:06,356 [INFO]: 	>>> Finished "Creating the index" in 57.4970 secs
2025-03-13 17:44:06,356 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5282 secs
2025-03-13 17:44:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 81437 [episode count 3/20]
[retrieval_preprocessing] for episode 18465 [episode count 4/20], we have num_retrieval=np.int64(2452) num_query=np.int64(139)
2025-03-13 17:44:07,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:07,755 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:07
2025-03-13 17:44:07,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1101.45it/s]
2025-03-13 17:44:07,795 [INFO]: There are 2452 embeddings of dim 49152
2025-03-13 17:44:07,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0394 secs
2025-03-13 17:44:07,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:07
2025-03-13 17:44:07,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:07,796 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:44:07,796 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:07,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:44:07,796 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:07
2025-03-13 17:44:07,796 [INFO]: 506.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:07,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:07,796 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:07
2025-03-13 17:44:07,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:07,796 [INFO]: 	Creating the index 03/13/2025, 17:44:07
2025-03-13 17:44:07,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:07
2025-03-13 17:44:07,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:44:07,798 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:07
2025-03-13 17:44:07,799 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:07,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.83it/s] 80%|████████  | 8/10 [00:00<00:00, 41.50it/s]100%|██████████| 10/10 [00:01<00:00,  5.42it/s]
2025-03-13 17:44:09,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:09
2025-03-13 17:44:34,578 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9277 secs
2025-03-13 17:44:34,578 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 17:44:34,578 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.37it/s]
2025-03-13 17:44:54,024 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4464 secs
2025-03-13 17:44:54,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2277 secs
2025-03-13 17:44:54,026 [INFO]: {
2025-03-13 17:44:54,026 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:54,026 [INFO]: 	index_param: efSearch=184
2025-03-13 17:44:54,026 [INFO]: 	index_path: knn.index
2025-03-13 17:44:54,026 [INFO]: 	size in bytes: 482415670
2025-03-13 17:44:54,026 [INFO]: 	avg_search_speed_ms: 10.507079536152002
2025-03-13 17:44:54,027 [INFO]: 	99p_search_speed_ms: 16.892733674030755
2025-03-13 17:44:54,027 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:54,027 [INFO]: 	nb vectors: 2452
2025-03-13 17:44:54,027 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:54,027 [INFO]: 	compression ratio: 0.9993100265586314
2025-03-13 17:44:54,027 [INFO]: }
2025-03-13 17:44:54,027 [INFO]: 	>>> Finished "Creating the index" in 46.2303 secs
2025-03-13 17:44:54,027 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2713 secs
2025-03-13 17:44:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 18465 [episode count 4/20]
[retrieval_preprocessing] for episode 57385 [episode count 5/20], we have num_retrieval=np.int64(2459) num_query=np.int64(132)
2025-03-13 17:44:55,517 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:55,955 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:55
2025-03-13 17:44:55,955 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-13 17:44:55,982 [INFO]: There are 2459 embeddings of dim 49152
2025-03-13 17:44:55,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:44:55,983 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:55
2025-03-13 17:44:55,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:55,983 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:44:55,983 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:55,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:44:55,983 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:55
2025-03-13 17:44:55,983 [INFO]: 507.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:55,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:44:55,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:55
2025-03-13 17:44:55,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:55,983 [INFO]: 	Creating the index 03/13/2025, 17:44:55
2025-03-13 17:44:55,983 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:55
2025-03-13 17:44:55,984 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-13 17:44:55,984 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:55
2025-03-13 17:44:55,984 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:44:55,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.43it/s] 70%|███████   | 7/10 [00:00<00:00, 33.92it/s]100%|██████████| 10/10 [00:02<00:00,  4.75it/s]
2025-03-13 17:44:58,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:58
2025-03-13 17:45:33,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9888 secs
2025-03-13 17:45:33,081 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 17:45:33,081 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.22it/s]
2025-03-13 17:45:53,829 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7483 secs
2025-03-13 17:45:53,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8472 secs
2025-03-13 17:45:53,832 [INFO]: {
2025-03-13 17:45:53,832 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:53,832 [INFO]: 	index_param: efSearch=172
2025-03-13 17:45:53,832 [INFO]: 	index_path: knn.index
2025-03-13 17:45:53,832 [INFO]: 	size in bytes: 483792910
2025-03-13 17:45:53,832 [INFO]: 	avg_search_speed_ms: 8.811966051852192
2025-03-13 17:45:53,832 [INFO]: 	99p_search_speed_ms: 12.4967484921217
2025-03-13 17:45:53,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:53,832 [INFO]: 	nb vectors: 2459
2025-03-13 17:45:53,832 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:53,832 [INFO]: 	compression ratio: 0.999309956816027
2025-03-13 17:45:53,832 [INFO]: }
2025-03-13 17:45:53,832 [INFO]: 	>>> Finished "Creating the index" in 57.8485 secs
2025-03-13 17:45:53,832 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8765 secs
2025-03-13 17:45:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 57385 [episode count 5/20]
[retrieval_preprocessing] for episode 57897 [episode count 6/20], we have num_retrieval=np.int64(2465) num_query=np.int64(126)
2025-03-13 17:45:55,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:55,811 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:55
2025-03-13 17:45:55,811 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1047.79it/s]
2025-03-13 17:45:55,857 [INFO]: There are 2465 embeddings of dim 49152
2025-03-13 17:45:55,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0463 secs
2025-03-13 17:45:55,858 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:55
2025-03-13 17:45:55,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:55,858 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:45:55,858 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:55,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:45:55,858 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:55
2025-03-13 17:45:55,858 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:55,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:45:55,858 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:55
2025-03-13 17:45:55,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:55,858 [INFO]: 	Creating the index 03/13/2025, 17:45:55
2025-03-13 17:45:55,858 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:55
2025-03-13 17:45:55,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:45:55,859 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:55
2025-03-13 17:45:55,859 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:45:55,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.31it/s] 50%|█████     | 5/10 [00:00<00:00, 26.34it/s] 90%|█████████ | 9/10 [00:00<00:00, 32.41it/s]100%|██████████| 10/10 [00:02<00:00,  3.63it/s]
2025-03-13 17:45:58,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:58
2025-03-13 17:46:29,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9865 secs
2025-03-13 17:46:29,604 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 17:46:29,605 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 17:46:44,733 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1287 secs
2025-03-13 17:46:44,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8762 secs
2025-03-13 17:46:44,736 [INFO]: {
2025-03-13 17:46:44,736 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:44,736 [INFO]: 	index_param: efSearch=152
2025-03-13 17:46:44,736 [INFO]: 	index_path: knn.index
2025-03-13 17:46:44,736 [INFO]: 	size in bytes: 484973350
2025-03-13 17:46:44,736 [INFO]: 	avg_search_speed_ms: 9.996229597134516
2025-03-13 17:46:44,736 [INFO]: 	99p_search_speed_ms: 15.571755587588994
2025-03-13 17:46:44,736 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:44,736 [INFO]: 	nb vectors: 2465
2025-03-13 17:46:44,736 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:44,736 [INFO]: 	compression ratio: 0.999310003322863
2025-03-13 17:46:44,736 [INFO]: }
2025-03-13 17:46:44,736 [INFO]: 	>>> Finished "Creating the index" in 48.8777 secs
2025-03-13 17:46:44,736 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9249 secs
2025-03-13 17:46:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 57897 [episode count 6/20]
[retrieval_preprocessing] for episode 63020 [episode count 7/20], we have num_retrieval=np.int64(2454) num_query=np.int64(137)
2025-03-13 17:46:46,016 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:46,430 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:46
2025-03-13 17:46:46,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1265.63it/s]
2025-03-13 17:46:46,466 [INFO]: There are 2454 embeddings of dim 49152
2025-03-13 17:46:46,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 17:46:46,466 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:46
2025-03-13 17:46:46,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:46,467 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:46:46,467 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:46,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 17:46:46,467 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:46
2025-03-13 17:46:46,468 [INFO]: 506.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:46,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:46:46,468 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:46
2025-03-13 17:46:46,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:46,468 [INFO]: 	Creating the index 03/13/2025, 17:46:46
2025-03-13 17:46:46,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:46
2025-03-13 17:46:46,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:46:46,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:46
2025-03-13 17:46:46,472 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:46,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.53it/s] 70%|███████   | 7/10 [00:00<00:00, 33.48it/s]100%|██████████| 10/10 [00:01<00:00,  5.26it/s]
2025-03-13 17:46:48,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:48
2025-03-13 17:47:17,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2109 secs
2025-03-13 17:47:17,592 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:47:17,592 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 17:47:36,116 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5231 secs
2025-03-13 17:47:36,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6457 secs
2025-03-13 17:47:36,118 [INFO]: {
2025-03-13 17:47:36,118 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:36,118 [INFO]: 	index_param: efSearch=194
2025-03-13 17:47:36,118 [INFO]: 	index_path: knn.index
2025-03-13 17:47:36,118 [INFO]: 	size in bytes: 482809150
2025-03-13 17:47:36,118 [INFO]: 	avg_search_speed_ms: 11.085618337401563
2025-03-13 17:47:36,118 [INFO]: 	99p_search_speed_ms: 16.09164696186781
2025-03-13 17:47:36,118 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:36,118 [INFO]: 	nb vectors: 2454
2025-03-13 17:47:36,118 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:36,118 [INFO]: 	compression ratio: 0.9993100420735606
2025-03-13 17:47:36,118 [INFO]: }
2025-03-13 17:47:36,118 [INFO]: 	>>> Finished "Creating the index" in 49.6497 secs
2025-03-13 17:47:36,118 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6882 secs
2025-03-13 17:47:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 63020 [episode count 7/20]
[retrieval_preprocessing] for episode 78393 [episode count 8/20], we have num_retrieval=np.int64(2456) num_query=np.int64(135)
2025-03-13 17:47:38,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:38,589 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:38
2025-03-13 17:47:38,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1341.32it/s]
2025-03-13 17:47:38,620 [INFO]: There are 2456 embeddings of dim 49152
2025-03-13 17:47:38,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 17:47:38,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:38
2025-03-13 17:47:38,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:38,622 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:47:38,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:38,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:47:38,622 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:38
2025-03-13 17:47:38,622 [INFO]: 506.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:38,622 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:47:38,622 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:38
2025-03-13 17:47:38,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:38,623 [INFO]: 	Creating the index 03/13/2025, 17:47:38
2025-03-13 17:47:38,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:38
2025-03-13 17:47:38,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:47:38,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:38
2025-03-13 17:47:38,626 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:47:38,627 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.95it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.01it/s]100%|██████████| 10/10 [00:01<00:00,  5.50it/s]
2025-03-13 17:47:40,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:40
2025-03-13 17:48:09,555 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1043 secs
2025-03-13 17:48:09,555 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:48:09,556 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 17:48:39,609 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0537 secs
2025-03-13 17:48:39,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9852 secs
2025-03-13 17:48:39,612 [INFO]: {
2025-03-13 17:48:39,612 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:39,612 [INFO]: 	index_param: efSearch=227
2025-03-13 17:48:39,612 [INFO]: 	index_path: knn.index
2025-03-13 17:48:39,612 [INFO]: 	size in bytes: 483202690
2025-03-13 17:48:39,612 [INFO]: 	avg_search_speed_ms: 12.550292625132869
2025-03-13 17:48:39,612 [INFO]: 	99p_search_speed_ms: 20.04971942864357
2025-03-13 17:48:39,612 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:39,612 [INFO]: 	nb vectors: 2456
2025-03-13 17:48:39,612 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:39,612 [INFO]: 	compression ratio: 0.9993099334773985
2025-03-13 17:48:39,612 [INFO]: }
2025-03-13 17:48:39,612 [INFO]: 	>>> Finished "Creating the index" in 60.9887 secs
2025-03-13 17:48:39,612 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0224 secs
2025-03-13 17:48:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 78393 [episode count 8/20]
[retrieval_preprocessing] for episode 8776 [episode count 9/20], we have num_retrieval=np.int64(2474) num_query=np.int64(117)
2025-03-13 17:48:41,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:41,968 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:41
2025-03-13 17:48:41,968 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.64it/s]100%|██████████| 1/1 [00:00<00:00,  2.64it/s]
2025-03-13 17:48:42,681 [INFO]: There are 2474 embeddings of dim 49152
2025-03-13 17:48:42,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7129 secs
2025-03-13 17:48:42,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:42
2025-03-13 17:48:42,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:42,682 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:48:42,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:42,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:48:42,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:42
2025-03-13 17:48:42,682 [INFO]: 510.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:42,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:48:42,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:42
2025-03-13 17:48:42,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:42,683 [INFO]: 	Creating the index 03/13/2025, 17:48:42
2025-03-13 17:48:42,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:42
2025-03-13 17:48:42,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:48:42,686 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:42
2025-03-13 17:48:42,686 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:48:42,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.22it/s] 80%|████████  | 8/10 [00:00<00:00, 38.36it/s]100%|██████████| 10/10 [00:02<00:00,  4.98it/s]
2025-03-13 17:48:44,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:44
2025-03-13 17:49:17,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8292 secs
2025-03-13 17:49:17,529 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 17:49:17,529 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.09it/s]
2025-03-13 17:49:33,831 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3019 secs
2025-03-13 17:49:33,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1471 secs
2025-03-13 17:49:33,833 [INFO]: {
2025-03-13 17:49:33,833 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:33,833 [INFO]: 	index_param: efSearch=172
2025-03-13 17:49:33,833 [INFO]: 	index_path: knn.index
2025-03-13 17:49:33,833 [INFO]: 	size in bytes: 486744010
2025-03-13 17:49:33,833 [INFO]: 	avg_search_speed_ms: 9.242771954065647
2025-03-13 17:49:33,833 [INFO]: 	99p_search_speed_ms: 13.256174477282913
2025-03-13 17:49:33,833 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:33,833 [INFO]: 	nb vectors: 2474
2025-03-13 17:49:33,833 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:33,833 [INFO]: 	compression ratio: 0.9993100726601648
2025-03-13 17:49:33,833 [INFO]: }
2025-03-13 17:49:33,833 [INFO]: 	>>> Finished "Creating the index" in 51.1507 secs
2025-03-13 17:49:33,833 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8648 secs
2025-03-13 17:49:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 8776 [episode count 9/20]
[retrieval_preprocessing] for episode 51786 [episode count 10/20], we have num_retrieval=np.int64(2461) num_query=np.int64(130)
2025-03-13 17:49:34,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:35,316 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:35
2025-03-13 17:49:35,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.65it/s]
2025-03-13 17:49:35,346 [INFO]: There are 2461 embeddings of dim 49152
2025-03-13 17:49:35,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 17:49:35,347 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:35
2025-03-13 17:49:35,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:35,347 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:49:35,348 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:35,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:49:35,348 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:35
2025-03-13 17:49:35,348 [INFO]: 507.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:35,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:49:35,349 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:35
2025-03-13 17:49:35,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:35,349 [INFO]: 	Creating the index 03/13/2025, 17:49:35
2025-03-13 17:49:35,349 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:35
2025-03-13 17:49:35,353 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 17:49:35,353 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:35
2025-03-13 17:49:35,354 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:49:35,354 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.23it/s] 70%|███████   | 7/10 [00:00<00:00, 34.96it/s]100%|██████████| 10/10 [00:02<00:00,  4.72it/s]
2025-03-13 17:49:37,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:37
2025-03-13 17:50:08,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9592 secs
2025-03-13 17:50:08,439 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 17:50:08,439 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.16it/s]
2025-03-13 17:50:29,722 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2831 secs
2025-03-13 17:50:29,723 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3699 secs
2025-03-13 17:50:29,724 [INFO]: {
2025-03-13 17:50:29,724 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:29,724 [INFO]: 	index_param: efSearch=233
2025-03-13 17:50:29,724 [INFO]: 	index_path: knn.index
2025-03-13 17:50:29,724 [INFO]: 	size in bytes: 484186390
2025-03-13 17:50:29,724 [INFO]: 	avg_search_speed_ms: 10.396237404031481
2025-03-13 17:50:29,724 [INFO]: 	99p_search_speed_ms: 16.944853560999036
2025-03-13 17:50:29,724 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:29,724 [INFO]: 	nb vectors: 2461
2025-03-13 17:50:29,724 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:29,724 [INFO]: 	compression ratio: 0.9993099723435018
2025-03-13 17:50:29,724 [INFO]: }
2025-03-13 17:50:29,724 [INFO]: 	>>> Finished "Creating the index" in 54.3745 secs
2025-03-13 17:50:29,724 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4081 secs
2025-03-13 17:50:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 51786 [episode count 10/20]
[retrieval_preprocessing] for episode 63570 [episode count 11/20], we have num_retrieval=np.int64(2463) num_query=np.int64(128)
2025-03-13 17:50:31,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:31,538 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:31
2025-03-13 17:50:31,538 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.71it/s]
2025-03-13 17:50:31,568 [INFO]: There are 2463 embeddings of dim 49152
2025-03-13 17:50:31,568 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 17:50:31,568 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:31
2025-03-13 17:50:31,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:31,568 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:50:31,569 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:31,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:31,569 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:31
2025-03-13 17:50:31,569 [INFO]: 508.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:31,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:31,569 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:31
2025-03-13 17:50:31,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:31,569 [INFO]: 	Creating the index 03/13/2025, 17:50:31
2025-03-13 17:50:31,569 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:31
2025-03-13 17:50:31,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:50:31,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:31
2025-03-13 17:50:31,570 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:50:31,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.40it/s] 70%|███████   | 7/10 [00:00<00:00, 30.67it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-13 17:50:34,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:34
2025-03-13 17:51:06,884 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8696 secs
2025-03-13 17:51:06,884 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:51:06,885 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.69it/s]
2025-03-13 17:51:27,824 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9399 secs
2025-03-13 17:51:27,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2562 secs
2025-03-13 17:51:27,826 [INFO]: {
2025-03-13 17:51:27,826 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:27,826 [INFO]: 	index_param: efSearch=198
2025-03-13 17:51:27,826 [INFO]: 	index_path: knn.index
2025-03-13 17:51:27,826 [INFO]: 	size in bytes: 484579870
2025-03-13 17:51:27,826 [INFO]: 	avg_search_speed_ms: 9.64210848431772
2025-03-13 17:51:27,826 [INFO]: 	99p_search_speed_ms: 14.987194864079358
2025-03-13 17:51:27,826 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:27,826 [INFO]: 	nb vectors: 2463
2025-03-13 17:51:27,826 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:27,826 [INFO]: 	compression ratio: 0.9993099878457601
2025-03-13 17:51:27,826 [INFO]: }
2025-03-13 17:51:27,826 [INFO]: 	>>> Finished "Creating the index" in 56.2575 secs
2025-03-13 17:51:27,826 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2884 secs
2025-03-13 17:51:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 63570 [episode count 11/20]
[retrieval_preprocessing] for episode 51799 [episode count 12/20], we have num_retrieval=np.int64(2474) num_query=np.int64(117)
2025-03-13 17:51:28,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:30,111 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:30
2025-03-13 17:51:30,111 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-13 17:51:30,150 [INFO]: There are 2474 embeddings of dim 49152
2025-03-13 17:51:30,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-13 17:51:30,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:30
2025-03-13 17:51:30,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:30,151 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:51:30,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:30,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:51:30,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:30
2025-03-13 17:51:30,152 [INFO]: 510.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:30,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:51:30,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:30
2025-03-13 17:51:30,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:30,153 [INFO]: 	Creating the index 03/13/2025, 17:51:30
2025-03-13 17:51:30,153 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:30
2025-03-13 17:51:30,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:51:30,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:30
2025-03-13 17:51:30,156 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:51:30,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.61it/s] 80%|████████  | 8/10 [00:00<00:00, 38.61it/s]100%|██████████| 10/10 [00:01<00:00,  5.35it/s]
2025-03-13 17:51:32,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:32
2025-03-13 17:52:02,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6133 secs
2025-03-13 17:52:02,646 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:52:02,646 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.82it/s]
2025-03-13 17:52:19,709 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0624 secs
2025-03-13 17:52:20,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0715 secs
2025-03-13 17:52:20,228 [INFO]: {
2025-03-13 17:52:20,228 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:20,228 [INFO]: 	index_param: efSearch=207
2025-03-13 17:52:20,228 [INFO]: 	index_path: knn.index
2025-03-13 17:52:20,228 [INFO]: 	size in bytes: 486744010
2025-03-13 17:52:20,228 [INFO]: 	avg_search_speed_ms: 11.744317676251134
2025-03-13 17:52:20,228 [INFO]: 	99p_search_speed_ms: 16.28764346940443
2025-03-13 17:52:20,229 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:20,229 [INFO]: 	nb vectors: 2474
2025-03-13 17:52:20,229 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:20,229 [INFO]: 	compression ratio: 0.9993100726601648
2025-03-13 17:52:20,229 [INFO]: }
2025-03-13 17:52:20,229 [INFO]: 	>>> Finished "Creating the index" in 50.0762 secs
2025-03-13 17:52:20,229 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1182 secs
2025-03-13 17:52:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 51799 [episode count 12/20]
[retrieval_preprocessing] for episode 40028 [episode count 13/20], we have num_retrieval=np.int64(2446) num_query=np.int64(145)
2025-03-13 17:52:22,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:22,834 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:22
2025-03-13 17:52:22,834 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 918.59it/s]
2025-03-13 17:52:22,877 [INFO]: There are 2446 embeddings of dim 49152
2025-03-13 17:52:22,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0429 secs
2025-03-13 17:52:22,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:22,878 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:52:22,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:22,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:52:22,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,878 [INFO]: 504.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:22,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:52:22,878 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:22
2025-03-13 17:52:22,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:22,878 [INFO]: 	Creating the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,879 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:22
2025-03-13 17:52:22,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:52:22,880 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,880 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:22,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.41it/s] 40%|████      | 4/10 [00:00<00:00, 15.15it/s] 70%|███████   | 7/10 [00:00<00:00, 20.52it/s]100%|██████████| 10/10 [00:03<00:00,  1.98it/s]100%|██████████| 10/10 [00:03<00:00,  2.71it/s]
2025-03-13 17:52:26,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:26
2025-03-13 17:52:57,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6187 secs
2025-03-13 17:52:57,196 [INFO]: The best hyperparameters are: efSearch=84
2025-03-13 17:52:57,196 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.46it/s]
2025-03-13 17:53:16,680 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4838 secs
2025-03-13 17:53:16,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8015 secs
2025-03-13 17:53:16,682 [INFO]: {
2025-03-13 17:53:16,682 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:16,682 [INFO]: 	index_param: efSearch=84
2025-03-13 17:53:16,682 [INFO]: 	index_path: knn.index
2025-03-13 17:53:16,682 [INFO]: 	size in bytes: 481235230
2025-03-13 17:53:16,682 [INFO]: 	avg_search_speed_ms: 5.992879102797174
2025-03-13 17:53:16,682 [INFO]: 	99p_search_speed_ms: 8.972796737216406
2025-03-13 17:53:16,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:16,682 [INFO]: 	nb vectors: 2446
2025-03-13 17:53:16,682 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:16,682 [INFO]: 	compression ratio: 0.9993099798616157
2025-03-13 17:53:16,682 [INFO]: }
2025-03-13 17:53:16,682 [INFO]: 	>>> Finished "Creating the index" in 53.8034 secs
2025-03-13 17:53:16,682 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8476 secs
2025-03-13 17:53:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 40028 [episode count 13/20]
[retrieval_preprocessing] for episode 28256 [episode count 14/20], we have num_retrieval=np.int64(2466) num_query=np.int64(125)
2025-03-13 17:53:17,759 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:18,168 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:18
2025-03-13 17:53:18,168 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2109.81it/s]
2025-03-13 17:53:18,208 [INFO]: There are 2466 embeddings of dim 49152
2025-03-13 17:53:18,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 17:53:18,208 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:18,208 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:53:18,208 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:18,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:18,208 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,208 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:18,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:18,209 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:18
2025-03-13 17:53:18,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:18,209 [INFO]: 	Creating the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,209 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:18
2025-03-13 17:53:18,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:53:18,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:18
2025-03-13 17:53:18,210 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:18,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.45it/s] 60%|██████    | 6/10 [00:00<00:00, 29.56it/s]100%|██████████| 10/10 [00:02<00:00,  3.40it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-13 17:53:20,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:20
2025-03-13 17:53:49,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2352 secs
2025-03-13 17:53:49,891 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 17:53:49,891 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-13 17:54:12,794 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9022 secs
2025-03-13 17:54:12,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5866 secs
2025-03-13 17:54:12,797 [INFO]: {
2025-03-13 17:54:12,797 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:12,797 [INFO]: 	index_param: efSearch=151
2025-03-13 17:54:12,797 [INFO]: 	index_path: knn.index
2025-03-13 17:54:12,797 [INFO]: 	size in bytes: 485170090
2025-03-13 17:54:12,797 [INFO]: 	avg_search_speed_ms: 8.541745051382115
2025-03-13 17:54:12,797 [INFO]: 	99p_search_speed_ms: 12.077523348852992
2025-03-13 17:54:12,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:12,797 [INFO]: 	nb vectors: 2466
2025-03-13 17:54:12,797 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:12,797 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-13 17:54:12,797 [INFO]: }
2025-03-13 17:54:12,797 [INFO]: 	>>> Finished "Creating the index" in 54.5883 secs
2025-03-13 17:54:12,797 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6291 secs
2025-03-13 17:54:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 28256 [episode count 14/20]
[retrieval_preprocessing] for episode 63075 [episode count 15/20], we have num_retrieval=np.int64(2450) num_query=np.int64(141)
2025-03-13 17:54:14,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:15,060 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:15
2025-03-13 17:54:15,060 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.08it/s]
2025-03-13 17:54:15,097 [INFO]: There are 2450 embeddings of dim 49152
2025-03-13 17:54:15,097 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 17:54:15,098 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:15,098 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:54:15,098 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:15,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:54:15,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,099 [INFO]: 505.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:15,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:54:15,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:15
2025-03-13 17:54:15,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:15,100 [INFO]: 	Creating the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:15
2025-03-13 17:54:15,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:54:15,103 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,104 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:54:15,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.71it/s] 50%|█████     | 5/10 [00:00<00:00, 23.59it/s] 90%|█████████ | 9/10 [00:00<00:00, 27.42it/s]100%|██████████| 10/10 [00:02<00:00,  3.75it/s]
2025-03-13 17:54:17,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:17
2025-03-13 17:54:46,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6513 secs
2025-03-13 17:54:46,429 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 17:54:46,430 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-13 17:55:17,638 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2086 secs
2025-03-13 17:55:18,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0790 secs
2025-03-13 17:55:18,183 [INFO]: {
2025-03-13 17:55:18,183 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:18,183 [INFO]: 	index_param: efSearch=215
2025-03-13 17:55:18,183 [INFO]: 	index_path: knn.index
2025-03-13 17:55:18,183 [INFO]: 	size in bytes: 482022190
2025-03-13 17:55:18,183 [INFO]: 	avg_search_speed_ms: 10.53117379570674
2025-03-13 17:55:18,183 [INFO]: 	99p_search_speed_ms: 14.649247163906692
2025-03-13 17:55:18,183 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:18,183 [INFO]: 	nb vectors: 2450
2025-03-13 17:55:18,183 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:18,183 [INFO]: 	compression ratio: 0.9993100110183724
2025-03-13 17:55:18,183 [INFO]: }
2025-03-13 17:55:18,184 [INFO]: 	>>> Finished "Creating the index" in 63.0834 secs
2025-03-13 17:55:18,184 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1239 secs
2025-03-13 17:55:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 63075 [episode count 15/20]
[retrieval_preprocessing] for episode 11370 [episode count 16/20], we have num_retrieval=np.int64(2460) num_query=np.int64(131)
2025-03-13 17:55:19,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:19,944 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:19
2025-03-13 17:55:19,945 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.60it/s]
2025-03-13 17:55:19,976 [INFO]: There are 2460 embeddings of dim 49152
2025-03-13 17:55:19,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 17:55:19,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:19
2025-03-13 17:55:19,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:19,977 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:55:19,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:19,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:55:19,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:19
2025-03-13 17:55:19,978 [INFO]: 507.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:19,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:55:19,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:19
2025-03-13 17:55:19,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:19,978 [INFO]: 	Creating the index 03/13/2025, 17:55:19
2025-03-13 17:55:19,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:19
2025-03-13 17:55:19,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:55:19,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:19
2025-03-13 17:55:19,982 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:55:19,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.71it/s] 70%|███████   | 7/10 [00:00<00:00, 35.38it/s]100%|██████████| 10/10 [00:01<00:00,  5.57it/s]
2025-03-13 17:55:21,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:21
2025-03-13 17:55:52,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8051 secs
2025-03-13 17:55:52,588 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 17:55:52,588 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.07it/s]
2025-03-13 17:56:13,630 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0422 secs
2025-03-13 17:56:13,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6649 secs
2025-03-13 17:56:13,647 [INFO]: {
2025-03-13 17:56:13,647 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:13,647 [INFO]: 	index_param: efSearch=203
2025-03-13 17:56:13,647 [INFO]: 	index_path: knn.index
2025-03-13 17:56:13,647 [INFO]: 	size in bytes: 483989650
2025-03-13 17:56:13,647 [INFO]: 	avg_search_speed_ms: 10.138321703294219
2025-03-13 17:56:13,647 [INFO]: 	99p_search_speed_ms: 13.388678990304468
2025-03-13 17:56:13,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:13,647 [INFO]: 	nb vectors: 2460
2025-03-13 17:56:13,647 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:13,647 [INFO]: 	compression ratio: 0.9993099645829203
2025-03-13 17:56:13,647 [INFO]: }
2025-03-13 17:56:13,647 [INFO]: 	>>> Finished "Creating the index" in 53.6689 secs
2025-03-13 17:56:13,647 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7029 secs
2025-03-13 17:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 11370 [episode count 16/20]
[retrieval_preprocessing] for episode 51828 [episode count 17/20], we have num_retrieval=np.int64(2477) num_query=np.int64(114)
2025-03-13 17:56:15,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:16,352 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:16
2025-03-13 17:56:16,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.98it/s]
2025-03-13 17:56:16,385 [INFO]: There are 2477 embeddings of dim 49152
2025-03-13 17:56:16,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 17:56:16,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:16
2025-03-13 17:56:16,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:16,386 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:56:16,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:16,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:56:16,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:16
2025-03-13 17:56:16,387 [INFO]: 511.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:16,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:56:16,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:16
2025-03-13 17:56:16,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:16,388 [INFO]: 	Creating the index 03/13/2025, 17:56:16
2025-03-13 17:56:16,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:16
2025-03-13 17:56:16,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:56:16,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:16
2025-03-13 17:56:16,392 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:56:16,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.35it/s] 60%|██████    | 6/10 [00:00<00:00, 29.54it/s]100%|██████████| 10/10 [00:02<00:00,  3.60it/s]100%|██████████| 10/10 [00:02<00:00,  4.44it/s]
2025-03-13 17:56:18,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:18
2025-03-13 17:56:49,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9926 secs
2025-03-13 17:56:49,646 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:56:49,646 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-13 17:57:16,761 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1141 secs
2025-03-13 17:57:17,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1408 secs
2025-03-13 17:57:17,533 [INFO]: {
2025-03-13 17:57:17,533 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:17,533 [INFO]: 	index_param: efSearch=220
2025-03-13 17:57:17,533 [INFO]: 	index_path: knn.index
2025-03-13 17:57:17,533 [INFO]: 	size in bytes: 487334230
2025-03-13 17:57:17,534 [INFO]: 	avg_search_speed_ms: 9.675756091660887
2025-03-13 17:57:17,534 [INFO]: 	99p_search_speed_ms: 13.074213864747431
2025-03-13 17:57:17,534 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:17,534 [INFO]: 	nb vectors: 2477
2025-03-13 17:57:17,534 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:17,534 [INFO]: 	compression ratio: 0.9993100956606311
2025-03-13 17:57:17,534 [INFO]: }
2025-03-13 17:57:17,534 [INFO]: 	>>> Finished "Creating the index" in 61.1457 secs
2025-03-13 17:57:17,534 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1817 secs
2025-03-13 17:57:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 51828 [episode count 17/20]
[retrieval_preprocessing] for episode 31371 [episode count 18/20], we have num_retrieval=np.int64(2467) num_query=np.int64(124)
2025-03-13 17:57:18,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:18,947 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:18
2025-03-13 17:57:18,947 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.66it/s]
2025-03-13 17:57:18,983 [INFO]: There are 2467 embeddings of dim 49152
2025-03-13 17:57:18,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 17:57:18,984 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:18,984 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:57:18,984 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:18,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:57:18,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,985 [INFO]: 509.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:18,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:57:18,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:18
2025-03-13 17:57:18,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:18,986 [INFO]: 	Creating the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:18
2025-03-13 17:57:18,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:57:18,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:18
2025-03-13 17:57:18,990 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:18,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.41it/s] 70%|███████   | 7/10 [00:00<00:00, 36.16it/s]100%|██████████| 10/10 [00:02<00:00,  4.51it/s]
2025-03-13 17:57:21,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:21
2025-03-13 17:57:55,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2132 secs
2025-03-13 17:57:55,424 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 17:57:55,425 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.12it/s]
2025-03-13 17:58:10,836 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4119 secs
2025-03-13 17:58:10,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8494 secs
2025-03-13 17:58:10,839 [INFO]: {
2025-03-13 17:58:10,839 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:10,839 [INFO]: 	index_param: efSearch=146
2025-03-13 17:58:10,839 [INFO]: 	index_path: knn.index
2025-03-13 17:58:10,839 [INFO]: 	size in bytes: 485366830
2025-03-13 17:58:10,839 [INFO]: 	avg_search_speed_ms: 9.318801262810869
2025-03-13 17:58:10,839 [INFO]: 	99p_search_speed_ms: 15.543438075110313
2025-03-13 17:58:10,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:10,839 [INFO]: 	nb vectors: 2467
2025-03-13 17:58:10,839 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:10,839 [INFO]: 	compression ratio: 0.9993100187748718
2025-03-13 17:58:10,839 [INFO]: }
2025-03-13 17:58:10,839 [INFO]: 	>>> Finished "Creating the index" in 51.8534 secs
2025-03-13 17:58:10,839 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8919 secs
2025-03-13 17:58:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 31371 [episode count 18/20]
[retrieval_preprocessing] for episode 32400 [episode count 19/20], we have num_retrieval=np.int64(2465) num_query=np.int64(126)
2025-03-13 17:58:11,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:12,257 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:12
2025-03-13 17:58:12,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.05it/s]
2025-03-13 17:58:12,284 [INFO]: There are 2465 embeddings of dim 49152
2025-03-13 17:58:12,284 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:58:12,284 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:12
2025-03-13 17:58:12,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:12,284 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:58:12,284 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:12,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:12,285 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:12
2025-03-13 17:58:12,285 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:12,285 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:12,285 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:12
2025-03-13 17:58:12,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:12,285 [INFO]: 	Creating the index 03/13/2025, 17:58:12
2025-03-13 17:58:12,285 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:12
2025-03-13 17:58:12,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:58:12,286 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:12
2025-03-13 17:58:12,286 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:58:12,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.22it/s] 60%|██████    | 6/10 [00:00<00:00, 32.33it/s]100%|██████████| 10/10 [00:01<00:00,  4.41it/s]100%|██████████| 10/10 [00:01<00:00,  5.26it/s]
2025-03-13 17:58:14,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:14
2025-03-13 17:58:43,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4479 secs
2025-03-13 17:58:43,637 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:58:43,637 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-13 17:59:08,830 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1927 secs
2025-03-13 17:59:08,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5464 secs
2025-03-13 17:59:08,832 [INFO]: {
2025-03-13 17:59:08,832 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:08,832 [INFO]: 	index_param: efSearch=202
2025-03-13 17:59:08,832 [INFO]: 	index_path: knn.index
2025-03-13 17:59:08,832 [INFO]: 	size in bytes: 484973350
2025-03-13 17:59:08,832 [INFO]: 	avg_search_speed_ms: 10.2872515685086
2025-03-13 17:59:08,832 [INFO]: 	99p_search_speed_ms: 18.62434988841414
2025-03-13 17:59:08,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:08,832 [INFO]: 	nb vectors: 2465
2025-03-13 17:59:08,832 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:08,832 [INFO]: 	compression ratio: 0.999310003322863
2025-03-13 17:59:08,833 [INFO]: }
2025-03-13 17:59:08,833 [INFO]: 	>>> Finished "Creating the index" in 56.5477 secs
2025-03-13 17:59:08,833 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5756 secs
2025-03-13 17:59:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 32400 [episode count 19/20]
2025-03-13 17:59:09: [retrieval_preprocessing] finished for 9306310171_remove_pen_put_on_table [chosen_id count 8/196]
2025-03-13 17:59:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9461650657_remove_one_tissue_and_place_on_table [chosen_id count 9/196]
2025-03-13 17:59:11: [retrieval_preprocessing] we have num_total=4045 embedding_dim=49152
[retrieval_preprocessing] for episode 22017 [episode count 0/20], we have num_retrieval=np.int64(3648) num_query=np.int64(397)
2025-03-13 17:59:11,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:12,583 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:12
2025-03-13 17:59:12,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1854.25it/s]
2025-03-13 17:59:12,628 [INFO]: There are 3648 embeddings of dim 49152
2025-03-13 17:59:12,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0457 secs
2025-03-13 17:59:12,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:12,629 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:59:12,629 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:12,630 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:59:12,630 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,630 [INFO]: 752.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:12,630 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:59:12,630 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:12
2025-03-13 17:59:12,630 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:12,630 [INFO]: 	Creating the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,630 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:12
2025-03-13 17:59:12,634 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:59:12,634 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,634 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:59:12,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.39it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.89it/s] 80%|████████  | 12/15 [00:00<00:00, 39.23it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-13 17:59:16,554 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:16
2025-03-13 17:59:54,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3665 secs
2025-03-13 17:59:54,922 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:59:54,922 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 18:00:20,321 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3993 secs
2025-03-13 18:00:20,324 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6896 secs
2025-03-13 18:00:20,324 [INFO]: {
2025-03-13 18:00:20,324 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:20,324 [INFO]: 	index_param: efSearch=157
2025-03-13 18:00:20,324 [INFO]: 	index_path: knn.index
2025-03-13 18:00:20,324 [INFO]: 	size in bytes: 717721750
2025-03-13 18:00:20,324 [INFO]: 	avg_search_speed_ms: 10.845445232100204
2025-03-13 18:00:20,324 [INFO]: 	99p_search_speed_ms: 15.391896681394428
2025-03-13 18:00:20,324 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:20,324 [INFO]: 	nb vectors: 3648
2025-03-13 18:00:20,324 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:20,324 [INFO]: 	compression ratio: 0.9993092504163348
2025-03-13 18:00:20,324 [INFO]: }
2025-03-13 18:00:20,324 [INFO]: 	>>> Finished "Creating the index" in 67.6938 secs
2025-03-13 18:00:20,324 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7412 secs
2025-03-13 18:00:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 22017 [episode count 0/20]
[retrieval_preprocessing] for episode 36354 [episode count 1/20], we have num_retrieval=np.int64(3891) num_query=np.int64(154)
2025-03-13 18:00:24,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:24,838 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:24
2025-03-13 18:00:24,839 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 699.98it/s]
2025-03-13 18:00:24,892 [INFO]: There are 3891 embeddings of dim 49152
2025-03-13 18:00:24,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0535 secs
2025-03-13 18:00:24,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:24
2025-03-13 18:00:24,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:24,892 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:00:24,892 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:24,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:00:24,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:24
2025-03-13 18:00:24,893 [INFO]: 803.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:24,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:00:24,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:24
2025-03-13 18:00:24,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:24,893 [INFO]: 	Creating the index 03/13/2025, 18:00:24
2025-03-13 18:00:24,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:24
2025-03-13 18:00:24,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:00:24,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:24
2025-03-13 18:00:24,895 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:00:24,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.85it/s] 25%|██▌       | 4/16 [00:00<00:00, 13.86it/s] 50%|█████     | 8/16 [00:00<00:00, 21.55it/s] 75%|███████▌  | 12/16 [00:00<00:00, 26.96it/s]100%|██████████| 16/16 [00:04<00:00,  2.42it/s]100%|██████████| 16/16 [00:04<00:00,  3.58it/s]
2025-03-13 18:00:29,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:29
2025-03-13 18:01:11,831 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4575 secs
2025-03-13 18:01:11,832 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 18:01:11,832 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 18:01:39,048 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2160 secs
2025-03-13 18:01:39,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1560 secs
2025-03-13 18:01:39,051 [INFO]: {
2025-03-13 18:01:39,051 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:39,051 [INFO]: 	index_param: efSearch=158
2025-03-13 18:01:39,051 [INFO]: 	index_path: knn.index
2025-03-13 18:01:39,051 [INFO]: 	size in bytes: 765530830
2025-03-13 18:01:39,051 [INFO]: 	avg_search_speed_ms: 9.926724589026962
2025-03-13 18:01:39,051 [INFO]: 	99p_search_speed_ms: 19.753884547389998
2025-03-13 18:01:39,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:39,051 [INFO]: 	nb vectors: 3891
2025-03-13 18:01:39,051 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:39,051 [INFO]: 	compression ratio: 0.9993088429893803
2025-03-13 18:01:39,051 [INFO]: }
2025-03-13 18:01:39,051 [INFO]: 	>>> Finished "Creating the index" in 74.1579 secs
2025-03-13 18:01:39,051 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2123 secs
2025-03-13 18:01:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 36354 [episode count 1/20]
[retrieval_preprocessing] for episode 84488 [episode count 2/20], we have num_retrieval=np.int64(3826) num_query=np.int64(219)
2025-03-13 18:01:40,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:41,650 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:41
2025-03-13 18:01:41,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 895.84it/s]
2025-03-13 18:01:41,704 [INFO]: There are 3826 embeddings of dim 49152
2025-03-13 18:01:41,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0545 secs
2025-03-13 18:01:41,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:41
2025-03-13 18:01:41,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:41,705 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:01:41,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:41,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:41,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:41
2025-03-13 18:01:41,705 [INFO]: 789.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:41,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:01:41,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:41
2025-03-13 18:01:41,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:41,705 [INFO]: 	Creating the index 03/13/2025, 18:01:41
2025-03-13 18:01:41,705 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:41
2025-03-13 18:01:41,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:01:41,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:41
2025-03-13 18:01:41,707 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:01:41,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.80it/s] 31%|███▏      | 5/16 [00:00<00:00, 18.66it/s] 56%|█████▋    | 9/16 [00:00<00:00, 23.98it/s] 81%|████████▏ | 13/16 [00:00<00:00, 27.09it/s]100%|██████████| 16/16 [00:03<00:00,  2.82it/s]100%|██████████| 16/16 [00:03<00:00,  4.39it/s]
2025-03-13 18:01:45,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:45
2025-03-13 18:02:22,995 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6351 secs
2025-03-13 18:02:22,995 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 18:02:22,995 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-13 18:02:45,686 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6903 secs
2025-03-13 18:02:45,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9818 secs
2025-03-13 18:02:45,689 [INFO]: {
2025-03-13 18:02:45,689 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:45,689 [INFO]: 	index_param: efSearch=162
2025-03-13 18:02:45,689 [INFO]: 	index_path: knn.index
2025-03-13 18:02:45,689 [INFO]: 	size in bytes: 752742310
2025-03-13 18:02:45,689 [INFO]: 	avg_search_speed_ms: 10.385277672348735
2025-03-13 18:02:45,689 [INFO]: 	99p_search_speed_ms: 18.579419711604714
2025-03-13 18:02:45,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:45,689 [INFO]: 	nb vectors: 3826
2025-03-13 18:02:45,689 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:45,689 [INFO]: 	compression ratio: 0.9993090570397192
2025-03-13 18:02:45,689 [INFO]: }
2025-03-13 18:02:45,689 [INFO]: 	>>> Finished "Creating the index" in 63.9837 secs
2025-03-13 18:02:45,689 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0390 secs
2025-03-13 18:02:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 84488 [episode count 2/20]
[retrieval_preprocessing] for episode 5650 [episode count 3/20], we have num_retrieval=np.int64(3677) num_query=np.int64(368)
2025-03-13 18:02:48,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:50,059 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:50
2025-03-13 18:02:50,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.08it/s]
2025-03-13 18:02:50,106 [INFO]: There are 3677 embeddings of dim 49152
2025-03-13 18:02:50,106 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0472 secs
2025-03-13 18:02:50,106 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:50
2025-03-13 18:02:50,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:50,106 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:02:50,106 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:50,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:50,106 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:50
2025-03-13 18:02:50,107 [INFO]: 758.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:50,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:02:50,107 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:50
2025-03-13 18:02:50,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:50,107 [INFO]: 	Creating the index 03/13/2025, 18:02:50
2025-03-13 18:02:50,107 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:50
2025-03-13 18:02:50,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:02:50,108 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:50
2025-03-13 18:02:50,108 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:02:50,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.86it/s] 40%|████      | 6/15 [00:00<00:00, 32.27it/s] 73%|███████▎  | 11/15 [00:00<00:00, 39.47it/s]100%|██████████| 15/15 [00:03<00:00,  3.08it/s]100%|██████████| 15/15 [00:03<00:00,  4.29it/s]
2025-03-13 18:02:53,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:53
2025-03-13 18:03:39,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2548 secs
2025-03-13 18:03:39,866 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 18:03:39,866 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 18:04:02,207 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3410 secs
2025-03-13 18:04:02,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1011 secs
2025-03-13 18:04:02,210 [INFO]: {
2025-03-13 18:04:02,210 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:02,210 [INFO]: 	index_param: efSearch=146
2025-03-13 18:04:02,210 [INFO]: 	index_path: knn.index
2025-03-13 18:04:02,210 [INFO]: 	size in bytes: 723427270
2025-03-13 18:04:02,210 [INFO]: 	avg_search_speed_ms: 7.738551976239949
2025-03-13 18:04:02,210 [INFO]: 	99p_search_speed_ms: 11.574284969829002
2025-03-13 18:04:02,210 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:02,210 [INFO]: 	nb vectors: 3677
2025-03-13 18:04:02,210 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:02,210 [INFO]: 	compression ratio: 0.9993093237969866
2025-03-13 18:04:02,210 [INFO]: }
2025-03-13 18:04:02,210 [INFO]: 	>>> Finished "Creating the index" in 72.1030 secs
2025-03-13 18:04:02,210 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1508 secs
2025-03-13 18:04:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 5650 [episode count 3/20]
[retrieval_preprocessing] for episode 8215 [episode count 4/20], we have num_retrieval=np.int64(3857) num_query=np.int64(188)
2025-03-13 18:04:05,813 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:07,001 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:07
2025-03-13 18:04:07,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1367.11it/s]
2025-03-13 18:04:07,039 [INFO]: There are 3857 embeddings of dim 49152
2025-03-13 18:04:07,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0388 secs
2025-03-13 18:04:07,040 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:07
2025-03-13 18:04:07,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:07,041 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:04:07,041 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:07,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:04:07,041 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:07
2025-03-13 18:04:07,041 [INFO]: 796.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:07,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:04:07,042 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:07
2025-03-13 18:04:07,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:07,042 [INFO]: 	Creating the index 03/13/2025, 18:04:07
2025-03-13 18:04:07,042 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:07
2025-03-13 18:04:07,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:04:07,045 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:07
2025-03-13 18:04:07,046 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:04:07,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.11it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.81it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.81it/s]100%|██████████| 16/16 [00:03<00:00,  4.15it/s]
2025-03-13 18:04:10,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:10
2025-03-13 18:04:53,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9571 secs
2025-03-13 18:04:53,864 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 18:04:53,864 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 18:05:28,751 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8873 secs
2025-03-13 18:05:28,755 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7089 secs
2025-03-13 18:05:28,755 [INFO]: {
2025-03-13 18:05:28,755 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:28,755 [INFO]: 	index_param: efSearch=151
2025-03-13 18:05:28,755 [INFO]: 	index_path: knn.index
2025-03-13 18:05:28,755 [INFO]: 	size in bytes: 758841490
2025-03-13 18:05:28,755 [INFO]: 	avg_search_speed_ms: 9.410211341350443
2025-03-13 18:05:28,755 [INFO]: 	99p_search_speed_ms: 14.746062457561491
2025-03-13 18:05:28,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:28,755 [INFO]: 	nb vectors: 3857
2025-03-13 18:05:28,755 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:28,755 [INFO]: 	compression ratio: 0.9993089017839549
2025-03-13 18:05:28,755 [INFO]: }
2025-03-13 18:05:28,755 [INFO]: 	>>> Finished "Creating the index" in 81.7127 secs
2025-03-13 18:05:28,755 [INFO]: >>> Finished "Launching the whole pipeline" in 81.7539 secs
2025-03-13 18:05:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 8215 [episode count 4/20]
[retrieval_preprocessing] for episode 36901 [episode count 5/20], we have num_retrieval=np.int64(3843) num_query=np.int64(202)
2025-03-13 18:05:30,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:31,573 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:31
2025-03-13 18:05:31,573 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.94it/s]
2025-03-13 18:05:31,618 [INFO]: There are 3843 embeddings of dim 49152
2025-03-13 18:05:31,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-13 18:05:31,618 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:31,619 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:05:31,619 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:31,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:05:31,619 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,620 [INFO]: 793.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:31,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:05:31,620 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:31
2025-03-13 18:05:31,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:31,620 [INFO]: 	Creating the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,620 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:31
2025-03-13 18:05:31,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:05:31,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:31
2025-03-13 18:05:31,624 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:05:31,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.53it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.06it/s] 75%|███████▌  | 12/16 [00:00<00:00, 35.94it/s]100%|██████████| 16/16 [00:03<00:00,  3.14it/s]100%|██████████| 16/16 [00:03<00:00,  4.48it/s]
2025-03-13 18:05:35,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:35
2025-03-13 18:06:23,740 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.5387 secs
2025-03-13 18:06:23,741 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 18:06:23,741 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.36it/s]
2025-03-13 18:06:54,127 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3858 secs
2025-03-13 18:06:54,131 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.5067 secs
2025-03-13 18:06:54,131 [INFO]: {
2025-03-13 18:06:54,131 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:54,131 [INFO]: 	index_param: efSearch=148
2025-03-13 18:06:54,131 [INFO]: 	index_path: knn.index
2025-03-13 18:06:54,131 [INFO]: 	size in bytes: 756087070
2025-03-13 18:06:54,131 [INFO]: 	avg_search_speed_ms: 9.458374091651157
2025-03-13 18:06:54,131 [INFO]: 	99p_search_speed_ms: 14.631605767644944
2025-03-13 18:06:54,131 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:54,131 [INFO]: 	nb vectors: 3843
2025-03-13 18:06:54,131 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:54,131 [INFO]: 	compression ratio: 0.9993089076367885
2025-03-13 18:06:54,131 [INFO]: }
2025-03-13 18:06:54,131 [INFO]: 	>>> Finished "Creating the index" in 82.5106 secs
2025-03-13 18:06:54,131 [INFO]: >>> Finished "Launching the whole pipeline" in 82.5577 secs
2025-03-13 18:06:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 36901 [episode count 5/20]
[retrieval_preprocessing] for episode 49189 [episode count 6/20], we have num_retrieval=np.int64(3876) num_query=np.int64(169)
2025-03-13 18:06:56,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:57,556 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:57
2025-03-13 18:06:57,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 835.19it/s]
2025-03-13 18:06:57,605 [INFO]: There are 3876 embeddings of dim 49152
2025-03-13 18:06:57,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0491 secs
2025-03-13 18:06:57,605 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:57
2025-03-13 18:06:57,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:57,605 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:06:57,605 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:57,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:06:57,605 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:57
2025-03-13 18:06:57,605 [INFO]: 799.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:57,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:06:57,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:57
2025-03-13 18:06:57,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:57,606 [INFO]: 	Creating the index 03/13/2025, 18:06:57
2025-03-13 18:06:57,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:57
2025-03-13 18:06:57,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:06:57,607 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:57
2025-03-13 18:06:57,608 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:06:57,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.58it/s] 31%|███▏      | 5/16 [00:00<00:00, 25.40it/s] 56%|█████▋    | 9/16 [00:00<00:00, 29.67it/s] 81%|████████▏ | 13/16 [00:00<00:00, 30.94it/s]100%|██████████| 16/16 [00:04<00:00,  3.35it/s]
2025-03-13 18:07:02,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:02
2025-03-13 18:07:48,145 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7578 secs
2025-03-13 18:07:48,145 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 18:07:48,145 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.74it/s]
2025-03-13 18:08:19,377 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2310 secs
2025-03-13 18:08:19,380 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7721 secs
2025-03-13 18:08:19,380 [INFO]: {
2025-03-13 18:08:19,380 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:19,380 [INFO]: 	index_param: efSearch=145
2025-03-13 18:08:19,380 [INFO]: 	index_path: knn.index
2025-03-13 18:08:19,380 [INFO]: 	size in bytes: 762579610
2025-03-13 18:08:19,380 [INFO]: 	avg_search_speed_ms: 9.4930759571012
2025-03-13 18:08:19,380 [INFO]: 	99p_search_speed_ms: 16.94422027794645
2025-03-13 18:08:19,380 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:19,380 [INFO]: 	nb vectors: 3876
2025-03-13 18:08:19,380 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:19,380 [INFO]: 	compression ratio: 0.9993089219891416
2025-03-13 18:08:19,380 [INFO]: }
2025-03-13 18:08:19,380 [INFO]: 	>>> Finished "Creating the index" in 81.7743 secs
2025-03-13 18:08:19,380 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8244 secs
2025-03-13 18:08:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 49189 [episode count 6/20]
[retrieval_preprocessing] for episode 48168 [episode count 7/20], we have num_retrieval=np.int64(3857) num_query=np.int64(188)
2025-03-13 18:08:21,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:22,622 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:22
2025-03-13 18:08:22,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 959.79it/s]
2025-03-13 18:08:22,663 [INFO]: There are 3857 embeddings of dim 49152
2025-03-13 18:08:22,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 18:08:22,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:22
2025-03-13 18:08:22,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:22,664 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:08:22,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:22,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:22,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:22
2025-03-13 18:08:22,664 [INFO]: 796.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:22,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:22,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:22
2025-03-13 18:08:22,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:22,664 [INFO]: 	Creating the index 03/13/2025, 18:08:22
2025-03-13 18:08:22,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:22
2025-03-13 18:08:22,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:08:22,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:22
2025-03-13 18:08:22,666 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:08:22,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.86it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.41it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.86it/s]100%|██████████| 16/16 [00:03<00:00,  3.38it/s]100%|██████████| 16/16 [00:03<00:00,  4.56it/s]
2025-03-13 18:08:26,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:26
2025-03-13 18:09:10,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8095 secs
2025-03-13 18:09:10,991 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 18:09:10,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.48it/s]
2025-03-13 18:09:34,952 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9605 secs
2025-03-13 18:09:34,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2894 secs
2025-03-13 18:09:34,955 [INFO]: {
2025-03-13 18:09:34,955 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:34,955 [INFO]: 	index_param: efSearch=144
2025-03-13 18:09:34,955 [INFO]: 	index_path: knn.index
2025-03-13 18:09:34,955 [INFO]: 	size in bytes: 758841490
2025-03-13 18:09:34,955 [INFO]: 	avg_search_speed_ms: 8.353322183980966
2025-03-13 18:09:34,955 [INFO]: 	99p_search_speed_ms: 11.970160165801643
2025-03-13 18:09:34,955 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:34,955 [INFO]: 	nb vectors: 3857
2025-03-13 18:09:34,955 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:34,955 [INFO]: 	compression ratio: 0.9993089017839549
2025-03-13 18:09:34,955 [INFO]: }
2025-03-13 18:09:34,955 [INFO]: 	>>> Finished "Creating the index" in 72.2911 secs
2025-03-13 18:09:34,955 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3332 secs
2025-03-13 18:09:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 48168 [episode count 7/20]
[retrieval_preprocessing] for episode 35887 [episode count 8/20], we have num_retrieval=np.int64(3854) num_query=np.int64(191)
2025-03-13 18:09:36,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:37,479 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:37
2025-03-13 18:09:37,479 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.24it/s]
2025-03-13 18:09:37,519 [INFO]: There are 3854 embeddings of dim 49152
2025-03-13 18:09:37,519 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0401 secs
2025-03-13 18:09:37,519 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:37
2025-03-13 18:09:37,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:37,519 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:09:37,519 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:37,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:37,519 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:37
2025-03-13 18:09:37,519 [INFO]: 795.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:37,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:37,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:37
2025-03-13 18:09:37,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:37,520 [INFO]: 	Creating the index 03/13/2025, 18:09:37
2025-03-13 18:09:37,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:37
2025-03-13 18:09:37,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:09:37,521 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:37
2025-03-13 18:09:37,521 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:09:37,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.04it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.63it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.25it/s]100%|██████████| 16/16 [00:04<00:00,  2.90it/s]100%|██████████| 16/16 [00:04<00:00,  3.93it/s]
2025-03-13 18:09:41,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:41
2025-03-13 18:10:32,992 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3943 secs
2025-03-13 18:10:32,993 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 18:10:32,993 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.61it/s]
2025-03-13 18:10:54,933 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9397 secs
2025-03-13 18:10:54,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.4139 secs
2025-03-13 18:10:54,936 [INFO]: {
2025-03-13 18:10:54,936 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:54,936 [INFO]: 	index_param: efSearch=136
2025-03-13 18:10:54,936 [INFO]: 	index_path: knn.index
2025-03-13 18:10:54,936 [INFO]: 	size in bytes: 758251210
2025-03-13 18:10:54,936 [INFO]: 	avg_search_speed_ms: 8.468720390856468
2025-03-13 18:10:54,936 [INFO]: 	99p_search_speed_ms: 13.6254754383117
2025-03-13 18:10:54,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:54,936 [INFO]: 	nb vectors: 3854
2025-03-13 18:10:54,936 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:54,936 [INFO]: 	compression ratio: 0.9993089651647242
2025-03-13 18:10:54,936 [INFO]: }
2025-03-13 18:10:54,936 [INFO]: 	>>> Finished "Creating the index" in 77.4154 secs
2025-03-13 18:10:54,936 [INFO]: >>> Finished "Launching the whole pipeline" in 77.4570 secs
2025-03-13 18:10:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 35887 [episode count 8/20]
[retrieval_preprocessing] for episode 9777 [episode count 9/20], we have num_retrieval=np.int64(3796) num_query=np.int64(249)
2025-03-13 18:10:56,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:57,400 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:57
2025-03-13 18:10:57,400 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 18:10:57,443 [INFO]: There are 3796 embeddings of dim 49152
2025-03-13 18:10:57,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0438 secs
2025-03-13 18:10:57,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:57
2025-03-13 18:10:57,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:57,444 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:10:57,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:57,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:57,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:57
2025-03-13 18:10:57,444 [INFO]: 783.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:57,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:10:57,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:57
2025-03-13 18:10:57,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:57,444 [INFO]: 	Creating the index 03/13/2025, 18:10:57
2025-03-13 18:10:57,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:57
2025-03-13 18:10:57,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:10:57,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:57
2025-03-13 18:10:57,446 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:10:57,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.45it/s] 47%|████▋     | 7/15 [00:00<00:00, 33.39it/s] 80%|████████  | 12/15 [00:00<00:00, 38.93it/s]100%|██████████| 15/15 [00:03<00:00,  4.37it/s]
2025-03-13 18:11:00,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:00
2025-03-13 18:11:42,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3726 secs
2025-03-13 18:11:42,256 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 18:11:42,256 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.64it/s]
2025-03-13 18:12:09,370 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1136 secs
2025-03-13 18:12:09,373 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9265 secs
2025-03-13 18:12:09,373 [INFO]: {
2025-03-13 18:12:09,373 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:09,373 [INFO]: 	index_param: efSearch=181
2025-03-13 18:12:09,373 [INFO]: 	index_path: knn.index
2025-03-13 18:12:09,373 [INFO]: 	size in bytes: 746839870
2025-03-13 18:12:09,373 [INFO]: 	avg_search_speed_ms: 12.360560472039287
2025-03-13 18:12:09,373 [INFO]: 	99p_search_speed_ms: 18.75479754991829
2025-03-13 18:12:09,373 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:09,373 [INFO]: 	nb vectors: 3796
2025-03-13 18:12:09,373 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:09,373 [INFO]: 	compression ratio: 0.9993092200607876
2025-03-13 18:12:09,373 [INFO]: }
2025-03-13 18:12:09,373 [INFO]: 	>>> Finished "Creating the index" in 71.9288 secs
2025-03-13 18:12:09,373 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9735 secs
2025-03-13 18:12:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 9777 [episode count 9/20]
[retrieval_preprocessing] for episode 15933 [episode count 10/20], we have num_retrieval=np.int64(3878) num_query=np.int64(167)
2025-03-13 18:12:11,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:12,558 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:12
2025-03-13 18:12:12,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1128.11it/s]
2025-03-13 18:12:12,608 [INFO]: There are 3878 embeddings of dim 49152
2025-03-13 18:12:12,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0497 secs
2025-03-13 18:12:12,608 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:12,608 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:12:12,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:12,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:12:12,609 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,609 [INFO]: 800.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:12,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:12:12,609 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:12
2025-03-13 18:12:12,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:12,609 [INFO]: 	Creating the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,609 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:12
2025-03-13 18:12:12,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 18:12:12,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:12
2025-03-13 18:12:12,612 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:12:12,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.95it/s] 31%|███▏      | 5/16 [00:00<00:00, 26.44it/s] 62%|██████▎   | 10/16 [00:00<00:00, 33.40it/s] 94%|█████████▍| 15/16 [00:00<00:00, 36.53it/s]100%|██████████| 16/16 [00:04<00:00,  3.96it/s]
2025-03-13 18:12:16,653 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:16
2025-03-13 18:13:07,799 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1455 secs
2025-03-13 18:13:07,799 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 18:13:07,799 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 18:13:30,818 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0180 secs
2025-03-13 18:13:30,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2081 secs
2025-03-13 18:13:30,820 [INFO]: {
2025-03-13 18:13:30,820 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:30,820 [INFO]: 	index_param: efSearch=114
2025-03-13 18:13:30,820 [INFO]: 	index_path: knn.index
2025-03-13 18:13:30,820 [INFO]: 	size in bytes: 762973090
2025-03-13 18:13:30,820 [INFO]: 	avg_search_speed_ms: 6.873501143722293
2025-03-13 18:13:30,820 [INFO]: 	99p_search_speed_ms: 9.874935019761327
2025-03-13 18:13:30,820 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:30,820 [INFO]: 	nb vectors: 3878
2025-03-13 18:13:30,820 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:30,820 [INFO]: 	compression ratio: 0.9993089323766321
2025-03-13 18:13:30,820 [INFO]: }
2025-03-13 18:13:30,820 [INFO]: 	>>> Finished "Creating the index" in 78.2111 secs
2025-03-13 18:13:30,820 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2622 secs
2025-03-13 18:13:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 15933 [episode count 10/20]
[retrieval_preprocessing] for episode 62035 [episode count 11/20], we have num_retrieval=np.int64(3828) num_query=np.int64(217)
2025-03-13 18:13:32,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:32,882 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:32
2025-03-13 18:13:32,882 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.50it/s]
2025-03-13 18:13:32,923 [INFO]: There are 3828 embeddings of dim 49152
2025-03-13 18:13:32,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0407 secs
2025-03-13 18:13:32,923 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:32
2025-03-13 18:13:32,924 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:32,924 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:13:32,924 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:32,924 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:13:32,924 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:32
2025-03-13 18:13:32,924 [INFO]: 790.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:32,926 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0014 secs
2025-03-13 18:13:32,926 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:32
2025-03-13 18:13:32,926 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:32,926 [INFO]: 	Creating the index 03/13/2025, 18:13:32
2025-03-13 18:13:32,926 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:32
2025-03-13 18:13:32,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:13:32,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:32
2025-03-13 18:13:32,930 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:13:32,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 25.77it/s] 56%|█████▋    | 9/16 [00:00<00:00, 41.12it/s] 94%|█████████▍| 15/16 [00:00<00:00, 45.82it/s]100%|██████████| 16/16 [00:03<00:00,  4.84it/s]
2025-03-13 18:13:36,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:36
2025-03-13 18:14:20,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7306 secs
2025-03-13 18:14:20,974 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 18:14:20,974 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-13 18:14:41,291 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3172 secs
2025-03-13 18:14:41,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3649 secs
2025-03-13 18:14:41,295 [INFO]: {
2025-03-13 18:14:41,295 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:41,295 [INFO]: 	index_param: efSearch=129
2025-03-13 18:14:41,295 [INFO]: 	index_path: knn.index
2025-03-13 18:14:41,295 [INFO]: 	size in bytes: 753135850
2025-03-13 18:14:41,295 [INFO]: 	avg_search_speed_ms: 11.174724139949546
2025-03-13 18:14:41,295 [INFO]: 	99p_search_speed_ms: 17.51582509372382
2025-03-13 18:14:41,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:41,295 [INFO]: 	nb vectors: 3828
2025-03-13 18:14:41,295 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:41,295 [INFO]: 	compression ratio: 0.9993089878804734
2025-03-13 18:14:41,295 [INFO]: }
2025-03-13 18:14:41,295 [INFO]: 	>>> Finished "Creating the index" in 68.3692 secs
2025-03-13 18:14:41,295 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4130 secs
2025-03-13 18:14:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 62035 [episode count 11/20]
[retrieval_preprocessing] for episode 14938 [episode count 12/20], we have num_retrieval=np.int64(3787) num_query=np.int64(258)
2025-03-13 18:14:43,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:44,708 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:44
2025-03-13 18:14:44,708 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-13 18:14:44,761 [INFO]: There are 3787 embeddings of dim 49152
2025-03-13 18:14:44,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0536 secs
2025-03-13 18:14:44,762 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:44
2025-03-13 18:14:44,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:44,762 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:14:44,762 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:44,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:44,762 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:44
2025-03-13 18:14:44,762 [INFO]: 781.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:44,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:44,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:44
2025-03-13 18:14:44,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:44,762 [INFO]: 	Creating the index 03/13/2025, 18:14:44
2025-03-13 18:14:44,762 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:44
2025-03-13 18:14:44,763 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:14:44,763 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:44
2025-03-13 18:14:44,763 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:14:44,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 33%|███▎      | 5/15 [00:00<00:00, 19.81it/s] 60%|██████    | 9/15 [00:00<00:00, 24.84it/s] 87%|████████▋ | 13/15 [00:00<00:00, 27.47it/s]100%|██████████| 15/15 [00:04<00:00,  3.58it/s]
2025-03-13 18:14:48,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:48
2025-03-13 18:15:26,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4740 secs
2025-03-13 18:15:26,434 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:15:26,434 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.84it/s]
2025-03-13 18:15:50,684 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2499 secs
2025-03-13 18:15:50,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9234 secs
2025-03-13 18:15:50,687 [INFO]: {
2025-03-13 18:15:50,687 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:50,687 [INFO]: 	index_param: efSearch=174
2025-03-13 18:15:50,687 [INFO]: 	index_path: knn.index
2025-03-13 18:15:50,687 [INFO]: 	size in bytes: 745069150
2025-03-13 18:15:50,687 [INFO]: 	avg_search_speed_ms: 10.838777031688945
2025-03-13 18:15:50,687 [INFO]: 	99p_search_speed_ms: 19.3662262475118
2025-03-13 18:15:50,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:50,687 [INFO]: 	nb vectors: 3787
2025-03-13 18:15:50,687 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:50,687 [INFO]: 	compression ratio: 0.9993092533760122
2025-03-13 18:15:50,687 [INFO]: }
2025-03-13 18:15:50,687 [INFO]: 	>>> Finished "Creating the index" in 65.9251 secs
2025-03-13 18:15:50,687 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9794 secs
2025-03-13 18:15:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 14938 [episode count 12/20]
[retrieval_preprocessing] for episode 10334 [episode count 13/20], we have num_retrieval=np.int64(3846) num_query=np.int64(199)
2025-03-13 18:15:53,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:53,999 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:53
2025-03-13 18:15:53,999 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1907.37it/s]
2025-03-13 18:15:54,036 [INFO]: There are 3846 embeddings of dim 49152
2025-03-13 18:15:54,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0369 secs
2025-03-13 18:15:54,036 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:54
2025-03-13 18:15:54,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:54,036 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:15:54,036 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:54,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:54,036 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:54
2025-03-13 18:15:54,037 [INFO]: 793.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:54,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:54,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:54
2025-03-13 18:15:54,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:54,037 [INFO]: 	Creating the index 03/13/2025, 18:15:54
2025-03-13 18:15:54,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:54
2025-03-13 18:15:54,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:15:54,038 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:54
2025-03-13 18:15:54,038 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:15:54,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.17it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.25it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.59it/s]100%|██████████| 16/16 [00:04<00:00,  2.75it/s]100%|██████████| 16/16 [00:04<00:00,  3.95it/s]
2025-03-13 18:15:58,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:58
2025-03-13 18:16:42,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3725 secs
2025-03-13 18:16:42,066 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:16:42,066 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 18:17:17,980 [INFO]: 	>>> Finished "Compute fast metrics" in 35.9140 secs
2025-03-13 18:17:17,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9449 secs
2025-03-13 18:17:17,983 [INFO]: {
2025-03-13 18:17:17,983 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:17,983 [INFO]: 	index_param: efSearch=211
2025-03-13 18:17:17,983 [INFO]: 	index_path: knn.index
2025-03-13 18:17:17,983 [INFO]: 	size in bytes: 756677290
2025-03-13 18:17:17,983 [INFO]: 	avg_search_speed_ms: 12.045365420061419
2025-03-13 18:17:17,983 [INFO]: 	99p_search_speed_ms: 19.007370015606288
2025-03-13 18:17:17,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:17,983 [INFO]: 	nb vectors: 3846
2025-03-13 18:17:17,983 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:17,983 [INFO]: 	compression ratio: 0.9993089233588601
2025-03-13 18:17:17,983 [INFO]: }
2025-03-13 18:17:17,983 [INFO]: 	>>> Finished "Creating the index" in 83.9464 secs
2025-03-13 18:17:17,983 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9838 secs
2025-03-13 18:17:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 10334 [episode count 13/20]
[retrieval_preprocessing] for episode 30825 [episode count 14/20], we have num_retrieval=np.int64(3862) num_query=np.int64(183)
2025-03-13 18:17:20,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:21,336 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:21
2025-03-13 18:17:21,337 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-13 18:17:21,505 [INFO]: There are 3862 embeddings of dim 49152
2025-03-13 18:17:21,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1685 secs
2025-03-13 18:17:21,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:21
2025-03-13 18:17:21,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:21,506 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:17:21,506 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:21,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:17:21,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:21
2025-03-13 18:17:21,506 [INFO]: 797.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:21,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:17:21,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:21
2025-03-13 18:17:21,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:21,506 [INFO]: 	Creating the index 03/13/2025, 18:17:21
2025-03-13 18:17:21,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:21
2025-03-13 18:17:21,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 18:17:21,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:21
2025-03-13 18:17:21,508 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:17:21,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.21it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.38it/s] 56%|█████▋    | 9/16 [00:00<00:00, 28.70it/s] 88%|████████▊ | 14/16 [00:00<00:00, 33.59it/s]100%|██████████| 16/16 [00:03<00:00,  4.29it/s]
2025-03-13 18:17:25,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:25
2025-03-13 18:18:08,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9447 secs
2025-03-13 18:18:08,185 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 18:18:08,185 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 18:18:36,401 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2152 secs
2025-03-13 18:18:36,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8949 secs
2025-03-13 18:18:36,403 [INFO]: {
2025-03-13 18:18:36,403 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:36,403 [INFO]: 	index_param: efSearch=153
2025-03-13 18:18:36,403 [INFO]: 	index_path: knn.index
2025-03-13 18:18:36,403 [INFO]: 	size in bytes: 759825250
2025-03-13 18:18:36,403 [INFO]: 	avg_search_speed_ms: 8.339618223550744
2025-03-13 18:18:36,403 [INFO]: 	99p_search_speed_ms: 11.700618420727551
2025-03-13 18:18:36,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:36,403 [INFO]: 	nb vectors: 3862
2025-03-13 18:18:36,403 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:36,403 [INFO]: 	compression ratio: 0.9993088489754717
2025-03-13 18:18:36,403 [INFO]: }
2025-03-13 18:18:36,403 [INFO]: 	>>> Finished "Creating the index" in 74.8972 secs
2025-03-13 18:18:36,403 [INFO]: >>> Finished "Launching the whole pipeline" in 75.0667 secs
2025-03-13 18:18:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 30825 [episode count 14/20]
[retrieval_preprocessing] for episode 36462 [episode count 15/20], we have num_retrieval=np.int64(3857) num_query=np.int64(188)
2025-03-13 18:18:38,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:38,847 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:38
2025-03-13 18:18:38,847 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1490.51it/s]
2025-03-13 18:18:38,889 [INFO]: There are 3857 embeddings of dim 49152
2025-03-13 18:18:38,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0427 secs
2025-03-13 18:18:38,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:38
2025-03-13 18:18:38,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:38,890 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:18:38,891 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:38,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:18:38,891 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:38
2025-03-13 18:18:38,891 [INFO]: 796.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:38,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:18:38,892 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:38
2025-03-13 18:18:38,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:38,892 [INFO]: 	Creating the index 03/13/2025, 18:18:38
2025-03-13 18:18:38,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:38
2025-03-13 18:18:38,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:18:38,896 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:38
2025-03-13 18:18:38,896 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:18:38,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.24it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.48it/s] 75%|███████▌  | 12/16 [00:00<00:00, 37.16it/s]100%|██████████| 16/16 [00:03<00:00,  3.30it/s]100%|██████████| 16/16 [00:03<00:00,  4.72it/s]
2025-03-13 18:18:42,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:42
2025-03-13 18:19:27,234 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9398 secs
2025-03-13 18:19:27,234 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 18:19:27,234 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-13 18:19:56,671 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4363 secs
2025-03-13 18:19:56,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.7768 secs
2025-03-13 18:19:56,673 [INFO]: {
2025-03-13 18:19:56,673 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:56,673 [INFO]: 	index_param: efSearch=165
2025-03-13 18:19:56,673 [INFO]: 	index_path: knn.index
2025-03-13 18:19:56,673 [INFO]: 	size in bytes: 758841490
2025-03-13 18:19:56,673 [INFO]: 	avg_search_speed_ms: 8.996956763125741
2025-03-13 18:19:56,673 [INFO]: 	99p_search_speed_ms: 12.862659555394208
2025-03-13 18:19:56,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:56,674 [INFO]: 	nb vectors: 3857
2025-03-13 18:19:56,674 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:56,674 [INFO]: 	compression ratio: 0.9993089017839549
2025-03-13 18:19:56,674 [INFO]: }
2025-03-13 18:19:56,674 [INFO]: 	>>> Finished "Creating the index" in 77.7814 secs
2025-03-13 18:19:56,674 [INFO]: >>> Finished "Launching the whole pipeline" in 77.8268 secs
2025-03-13 18:19:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 36462 [episode count 15/20]
[retrieval_preprocessing] for episode 6802 [episode count 16/20], we have num_retrieval=np.int64(3919) num_query=np.int64(126)
2025-03-13 18:19:58,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:58,984 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:58
2025-03-13 18:19:58,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.03it/s]
2025-03-13 18:19:59,475 [INFO]: There are 3919 embeddings of dim 49152
2025-03-13 18:19:59,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4909 secs
2025-03-13 18:19:59,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:59
2025-03-13 18:19:59,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:59,476 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:19:59,476 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:59,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:19:59,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:59
2025-03-13 18:19:59,476 [INFO]: 808.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:59,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:19:59,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:59
2025-03-13 18:19:59,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:59,476 [INFO]: 	Creating the index 03/13/2025, 18:19:59
2025-03-13 18:19:59,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:59
2025-03-13 18:19:59,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:19:59,478 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:59
2025-03-13 18:19:59,478 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:19:59,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.86it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.46it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.00it/s]100%|██████████| 16/16 [00:03<00:00,  3.47it/s]100%|██████████| 16/16 [00:03<00:00,  4.68it/s]
2025-03-13 18:20:02,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:02
2025-03-13 18:20:46,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8235 secs
2025-03-13 18:20:46,725 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 18:20:46,725 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s]
2025-03-13 18:21:04,302 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5767 secs
2025-03-13 18:21:04,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8273 secs
2025-03-13 18:21:04,305 [INFO]: {
2025-03-13 18:21:04,305 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:04,305 [INFO]: 	index_param: efSearch=161
2025-03-13 18:21:04,306 [INFO]: 	index_path: knn.index
2025-03-13 18:21:04,306 [INFO]: 	size in bytes: 771039910
2025-03-13 18:21:04,306 [INFO]: 	avg_search_speed_ms: 8.74588694256402
2025-03-13 18:21:04,306 [INFO]: 	99p_search_speed_ms: 12.386663774959743
2025-03-13 18:21:04,306 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:04,306 [INFO]: 	nb vectors: 3919
2025-03-13 18:21:04,306 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:04,306 [INFO]: 	compression ratio: 0.9993085208779919
2025-03-13 18:21:04,306 [INFO]: }
2025-03-13 18:21:04,306 [INFO]: 	>>> Finished "Creating the index" in 64.8294 secs
2025-03-13 18:21:04,306 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3212 secs
2025-03-13 18:21:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 6802 [episode count 16/20]
[retrieval_preprocessing] for episode 77972 [episode count 17/20], we have num_retrieval=np.int64(3915) num_query=np.int64(130)
2025-03-13 18:21:05,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:06,082 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:06
2025-03-13 18:21:06,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.75it/s]
2025-03-13 18:21:06,120 [INFO]: There are 3915 embeddings of dim 49152
2025-03-13 18:21:06,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 18:21:06,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:06
2025-03-13 18:21:06,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:06,121 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:21:06,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:06,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:21:06,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:06
2025-03-13 18:21:06,121 [INFO]: 808.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:06,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:21:06,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:06
2025-03-13 18:21:06,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:06,121 [INFO]: 	Creating the index 03/13/2025, 18:21:06
2025-03-13 18:21:06,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:06
2025-03-13 18:21:06,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:21:06,122 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:06
2025-03-13 18:21:06,122 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:21:06,122 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.67it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.85it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.22it/s]100%|██████████| 16/16 [00:03<00:00,  3.28it/s]100%|██████████| 16/16 [00:03<00:00,  4.44it/s]
2025-03-13 18:21:09,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:09
2025-03-13 18:21:48,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5641 secs
2025-03-13 18:21:48,293 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 18:21:48,293 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-13 18:22:24,485 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1917 secs
2025-03-13 18:22:24,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.3656 secs
2025-03-13 18:22:24,489 [INFO]: {
2025-03-13 18:22:24,489 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:24,489 [INFO]: 	index_param: efSearch=164
2025-03-13 18:22:24,489 [INFO]: 	index_path: knn.index
2025-03-13 18:22:24,489 [INFO]: 	size in bytes: 770252830
2025-03-13 18:22:24,489 [INFO]: 	avg_search_speed_ms: 9.336507701802821
2025-03-13 18:22:24,489 [INFO]: 	99p_search_speed_ms: 13.912457739934322
2025-03-13 18:22:24,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:24,489 [INFO]: 	nb vectors: 3915
2025-03-13 18:22:24,489 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:24,489 [INFO]: 	compression ratio: 0.9993086555748195
2025-03-13 18:22:24,489 [INFO]: }
2025-03-13 18:22:24,489 [INFO]: 	>>> Finished "Creating the index" in 78.3679 secs
2025-03-13 18:22:24,489 [INFO]: >>> Finished "Launching the whole pipeline" in 78.4067 secs
2025-03-13 18:22:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 77972 [episode count 17/20]
[retrieval_preprocessing] for episode 73879 [episode count 18/20], we have num_retrieval=np.int64(3918) num_query=np.int64(127)
2025-03-13 18:22:26,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:26,756 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:26
2025-03-13 18:22:26,756 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.24it/s]
2025-03-13 18:22:26,793 [INFO]: There are 3918 embeddings of dim 49152
2025-03-13 18:22:26,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-13 18:22:26,794 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:26
2025-03-13 18:22:26,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:26,794 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:22:26,794 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:26,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:26,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:26
2025-03-13 18:22:26,794 [INFO]: 808.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:26,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:26,794 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:26
2025-03-13 18:22:26,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:26,794 [INFO]: 	Creating the index 03/13/2025, 18:22:26
2025-03-13 18:22:26,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:26
2025-03-13 18:22:26,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:22:26,795 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:26
2025-03-13 18:22:26,795 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:22:26,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.01it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.99it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.26it/s]100%|██████████| 16/16 [00:03<00:00,  4.39it/s]
2025-03-13 18:22:30,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:30
2025-03-13 18:23:18,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3688 secs
2025-03-13 18:23:18,814 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 18:23:18,814 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-13 18:23:42,237 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4228 secs
2025-03-13 18:23:42,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4438 secs
2025-03-13 18:23:42,239 [INFO]: {
2025-03-13 18:23:42,239 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:42,239 [INFO]: 	index_param: efSearch=125
2025-03-13 18:23:42,239 [INFO]: 	index_path: knn.index
2025-03-13 18:23:42,239 [INFO]: 	size in bytes: 770843170
2025-03-13 18:23:42,239 [INFO]: 	avg_search_speed_ms: 8.61520054617786
2025-03-13 18:23:42,239 [INFO]: 	99p_search_speed_ms: 15.14347190968694
2025-03-13 18:23:42,239 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:42,239 [INFO]: 	nb vectors: 3918
2025-03-13 18:23:42,239 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:42,239 [INFO]: 	compression ratio: 0.9993085156348989
2025-03-13 18:23:42,239 [INFO]: }
2025-03-13 18:23:42,239 [INFO]: 	>>> Finished "Creating the index" in 75.4453 secs
2025-03-13 18:23:42,239 [INFO]: >>> Finished "Launching the whole pipeline" in 75.4837 secs
2025-03-13 18:23:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 73879 [episode count 18/20]
[retrieval_preprocessing] for episode 71321 [episode count 19/20], we have num_retrieval=np.int64(3920) num_query=np.int64(125)
2025-03-13 18:23:43,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:44,012 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:44
2025-03-13 18:23:44,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.28it/s]
2025-03-13 18:23:44,057 [INFO]: There are 3920 embeddings of dim 49152
2025-03-13 18:23:44,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0454 secs
2025-03-13 18:23:44,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:44
2025-03-13 18:23:44,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:44,058 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 18:23:44,059 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:44,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0011 secs
2025-03-13 18:23:44,059 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:44
2025-03-13 18:23:44,060 [INFO]: 809.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:44,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:23:44,060 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:44
2025-03-13 18:23:44,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:44,060 [INFO]: 	Creating the index 03/13/2025, 18:23:44
2025-03-13 18:23:44,061 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:44
2025-03-13 18:23:44,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:23:44,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:44
2025-03-13 18:23:44,064 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:23:44,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.01it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.01it/s] 75%|███████▌  | 12/16 [00:00<00:00, 35.54it/s]100%|██████████| 16/16 [00:03<00:00,  2.84it/s]100%|██████████| 16/16 [00:03<00:00,  4.08it/s]
2025-03-13 18:23:47,996 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:47
2025-03-13 18:24:31,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0733 secs
2025-03-13 18:24:31,070 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 18:24:31,070 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 18:24:54,131 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0610 secs
2025-03-13 18:24:54,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1092 secs
2025-03-13 18:24:54,174 [INFO]: {
2025-03-13 18:24:54,174 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:54,174 [INFO]: 	index_param: efSearch=139
2025-03-13 18:24:54,174 [INFO]: 	index_path: knn.index
2025-03-13 18:24:54,174 [INFO]: 	size in bytes: 771236650
2025-03-13 18:24:54,174 [INFO]: 	avg_search_speed_ms: 9.545958685361645
2025-03-13 18:24:54,174 [INFO]: 	99p_search_speed_ms: 15.424403061624613
2025-03-13 18:24:54,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:54,174 [INFO]: 	nb vectors: 3920
2025-03-13 18:24:54,174 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:54,174 [INFO]: 	compression ratio: 0.9993085261184099
2025-03-13 18:24:54,174 [INFO]: }
2025-03-13 18:24:54,174 [INFO]: 	>>> Finished "Creating the index" in 70.1136 secs
2025-03-13 18:24:54,174 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1616 secs
2025-03-13 18:24:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 71321 [episode count 19/20]
2025-03-13 18:24:55: [retrieval_preprocessing] finished for 9461650657_remove_one_tissue_and_place_on_table [chosen_id count 9/196]
2025-03-13 18:24:55: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
