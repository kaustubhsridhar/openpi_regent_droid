Using cache found in /home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/ksridhar/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
2025-03-13 17:07:44: [embed_episodes] skipping episode 4669 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 48222 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 89191 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 56947 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 71834 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 39588 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 61633 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 19209 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 56594 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 85269 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 26904 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 16169 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 31086 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 72565 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 19834 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 35202 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 10137 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 59293 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 27098 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 18893 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 9487913557_arrange_objects_surrounding_white_plate_on_plate [chosen_id count 0/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 82949 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 32779 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 92689 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 36373 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 55834 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 46108 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 31775 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 15400 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 82490 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 76883 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 24670 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 44147 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 41588 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 36988 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 34943 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 92803 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 57988 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 88211 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 63636 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 88726 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 9505766118_put_screwdriver_in_drawer_and_close [chosen_id count 1/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 21007 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 88079 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 8733 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 45600 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 64045 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 13377 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 19529 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 75855 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 41558 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 62550 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 3673 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 22105 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 86110 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 9316 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 76901 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 37478 [episode count 15/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 85096 [episode count 16/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 34927 [episode count 17/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 45679 [episode count 18/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 3187 [episode count 19/20]
2025-03-13 17:07:44: [embed_episodes] finished embedding all episodes for 9768740075_press_keyboard_key [chosen_id count 2/196]
2025-03-13 17:07:44: [embed_episodes] skipping episode 68623 [episode count 0/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 88086 [episode count 1/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 50760 [episode count 2/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 78480 [episode count 3/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 41118 [episode count 4/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 16062 [episode count 5/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 30926 [episode count 6/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 30430 [episode count 7/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 38626 [episode count 8/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 77563 [episode count 9/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 45314 [episode count 10/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 33062 [episode count 11/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 3371 [episode count 12/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 90445 [episode count 13/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 95581 [episode count 14/20]
2025-03-13 17:07:44: [embed_episodes] skipping episode 60770 [episode count 15/20]
2025-03-13 17:07:48: [embed_episodes] embedded episode 68962 with 131 steps [episode count 16/20]
2025-03-13 17:07:51: [embed_episodes] embedded episode 25465 with 121 steps [episode count 17/20]
2025-03-13 17:07:54: [embed_episodes] embedded episode 43401 with 201 steps [episode count 18/20]
2025-03-13 17:07:57: [embed_episodes] embedded episode 58285 with 214 steps [episode count 19/20]
2025-03-13 17:07:57: [embed_episodes] finished embedding all episodes for 9933578360_close_tap [chosen_id count 3/196]
2025-03-13 17:07:57: [embed_episodes] skipping episode 79897 [episode count 0/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 55377 [episode count 1/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 27223 [episode count 2/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 24155 [episode count 3/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 29310 [episode count 4/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 36539 [episode count 5/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 6352 [episode count 6/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 51970 [episode count 7/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 8457 [episode count 8/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 26418 [episode count 9/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 8524 [episode count 10/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 19295 [episode count 11/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 47458 [episode count 12/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 29540 [episode count 13/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 39788 [episode count 14/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 84406 [episode count 15/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 1430 [episode count 16/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 61923 [episode count 17/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 75764 [episode count 18/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 55130 [episode count 19/20]
2025-03-13 17:07:57: [embed_episodes] finished embedding all episodes for 9933578360_close_drawer [chosen_id count 4/196]
2025-03-13 17:07:57: [embed_episodes] skipping episode 69891 [episode count 0/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 71172 [episode count 1/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 33036 [episode count 2/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 16535 [episode count 3/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 35352 [episode count 4/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 80162 [episode count 5/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 90029 [episode count 6/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 77745 [episode count 7/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 93748 [episode count 8/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 93872 [episode count 9/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 82364 [episode count 10/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 78782 [episode count 11/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 79043 [episode count 12/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 30280 [episode count 13/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 71115 [episode count 14/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 83037 [episode count 15/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 89691 [episode count 16/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 11751 [episode count 17/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 85608 [episode count 18/20]
2025-03-13 17:07:57: [embed_episodes] skipping episode 12156 [episode count 19/20]
2025-03-13 17:07:57: [embed_episodes] finished embedding all episodes for 9934859632_put_marker_in_bowl [chosen_id count 5/196]
2025-03-13 17:07:57: [embed_episodes] done!
2025-03-13 17:07:57: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 17:08:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9487913557_arrange_objects_surrounding_white_plate_on_plate [chosen_id count 0/196]
2025-03-13 17:08:08: [retrieval_preprocessing] we have num_total=17644 embedding_dim=49152
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 4669 [episode count 0/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 48222 [episode count 1/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 89191 [episode count 2/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 56947 [episode count 3/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 71834 [episode count 4/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 39588 [episode count 5/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 61633 [episode count 6/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 19209 [episode count 7/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 56594 [episode count 8/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 85269 [episode count 9/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 26904 [episode count 10/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 16169 [episode count 11/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 31086 [episode count 12/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 72565 [episode count 13/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 19834 [episode count 14/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 35202 [episode count 15/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 10137 [episode count 16/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 59293 [episode count 17/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 27098 [episode count 18/20]
2025-03-13 17:08:08: [retrieval_preprocessing] skipping episode 18893 [episode count 19/20]
2025-03-13 17:08:08: [retrieval_preprocessing] finished for 9487913557_arrange_objects_surrounding_white_plate_on_plate [chosen_id count 0/196]
2025-03-13 17:08:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9505766118_put_screwdriver_in_drawer_and_close [chosen_id count 1/196]
2025-03-13 17:08:10: [retrieval_preprocessing] we have num_total=3522 embedding_dim=49152
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 82949 [episode count 0/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 32779 [episode count 1/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 92689 [episode count 2/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 36373 [episode count 3/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 55834 [episode count 4/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 46108 [episode count 5/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 31775 [episode count 6/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 15400 [episode count 7/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 82490 [episode count 8/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 76883 [episode count 9/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 24670 [episode count 10/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 44147 [episode count 11/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 41588 [episode count 12/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 36988 [episode count 13/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 34943 [episode count 14/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 92803 [episode count 15/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 57988 [episode count 16/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 88211 [episode count 17/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 63636 [episode count 18/20]
2025-03-13 17:08:10: [retrieval_preprocessing] skipping episode 88726 [episode count 19/20]
2025-03-13 17:08:10: [retrieval_preprocessing] finished for 9505766118_put_screwdriver_in_drawer_and_close [chosen_id count 1/196]
2025-03-13 17:08:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9768740075_press_keyboard_key [chosen_id count 2/196]
2025-03-13 17:08:12: [retrieval_preprocessing] we have num_total=3790 embedding_dim=49152
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 21007 [episode count 0/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 88079 [episode count 1/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 8733 [episode count 2/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 45600 [episode count 3/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 64045 [episode count 4/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 13377 [episode count 5/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 19529 [episode count 6/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 75855 [episode count 7/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 41558 [episode count 8/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 62550 [episode count 9/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 3673 [episode count 10/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 22105 [episode count 11/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 86110 [episode count 12/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 9316 [episode count 13/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 76901 [episode count 14/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 37478 [episode count 15/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 85096 [episode count 16/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 34927 [episode count 17/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 45679 [episode count 18/20]
2025-03-13 17:08:12: [retrieval_preprocessing] skipping episode 3187 [episode count 19/20]
2025-03-13 17:08:12: [retrieval_preprocessing] finished for 9768740075_press_keyboard_key [chosen_id count 2/196]
2025-03-13 17:08:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9933578360_close_tap [chosen_id count 3/196]
2025-03-13 17:08:13: [retrieval_preprocessing] we have num_total=3722 embedding_dim=49152
[retrieval_preprocessing] for episode 68623 [episode count 0/20], we have num_retrieval=np.int64(3474) num_query=np.int64(248)
2025-03-13 17:08:14,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:15,229 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:15
2025-03-13 17:08:15,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 489.25it/s]
2025-03-13 17:08:15,304 [INFO]: There are 3474 embeddings of dim 49152
2025-03-13 17:08:15,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0747 secs
2025-03-13 17:08:15,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:15,304 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:08:15,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:15,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:08:15,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,305 [INFO]: 716.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:15,306 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-13 17:08:15,306 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:15
2025-03-13 17:08:15,306 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:15,306 [INFO]: 	Creating the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,306 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:15
2025-03-13 17:08:15,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:08:15,308 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:15
2025-03-13 17:08:15,308 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:08:15,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.21it/s] 50%|█████     | 7/14 [00:00<00:00, 33.26it/s] 79%|███████▊  | 11/14 [00:00<00:00, 15.68it/s]100%|██████████| 14/14 [00:04<00:00,  2.04it/s]100%|██████████| 14/14 [00:04<00:00,  3.02it/s]
2025-03-13 17:08:19,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:19
2025-03-13 17:09:01,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8351 secs
2025-03-13 17:09:01,792 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 17:09:01,792 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-13 17:09:24,676 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8838 secs
2025-03-13 17:09:24,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3715 secs
2025-03-13 17:09:24,680 [INFO]: {
2025-03-13 17:09:24,680 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:24,680 [INFO]: 	index_param: efSearch=132
2025-03-13 17:09:24,680 [INFO]: 	index_path: knn.index
2025-03-13 17:09:24,680 [INFO]: 	size in bytes: 683488210
2025-03-13 17:09:24,680 [INFO]: 	avg_search_speed_ms: 8.249603217066552
2025-03-13 17:09:24,680 [INFO]: 	99p_search_speed_ms: 11.767395057249818
2025-03-13 17:09:24,680 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:24,680 [INFO]: 	nb vectors: 3474
2025-03-13 17:09:24,680 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:24,680 [INFO]: 	compression ratio: 0.9993093984752129
2025-03-13 17:09:24,680 [INFO]: }
2025-03-13 17:09:24,680 [INFO]: 	>>> Finished "Creating the index" in 69.3745 secs
2025-03-13 17:09:24,680 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4513 secs
2025-03-13 17:09:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 68623 [episode count 0/20]
[retrieval_preprocessing] for episode 88086 [episode count 1/20], we have num_retrieval=np.int64(3586) num_query=np.int64(136)
2025-03-13 17:09:27,554 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:28,151 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:28
2025-03-13 17:09:28,152 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.94it/s]
2025-03-13 17:09:28,183 [INFO]: There are 3586 embeddings of dim 49152
2025-03-13 17:09:28,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 17:09:28,183 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:28
2025-03-13 17:09:28,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:28,184 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:09:28,184 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:28,184 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:09:28,184 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:28
2025-03-13 17:09:28,184 [INFO]: 740.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:28,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:09:28,184 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:28
2025-03-13 17:09:28,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:28,185 [INFO]: 	Creating the index 03/13/2025, 17:09:28
2025-03-13 17:09:28,185 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:28
2025-03-13 17:09:28,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:09:28,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:28
2025-03-13 17:09:28,188 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:09:28,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.41it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.92it/s] 20%|██        | 3/15 [00:00<00:01,  7.73it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.08it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.31it/s] 40%|████      | 6/15 [00:00<00:01,  8.47it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.57it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.72it/s] 60%|██████    | 9/15 [00:01<00:00,  8.72it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.73it/s] 80%|████████  | 12/15 [00:01<00:00,  9.43it/s] 93%|█████████▎| 14/15 [00:01<00:00, 10.02it/s]100%|██████████| 15/15 [00:04<00:00,  1.30it/s]100%|██████████| 15/15 [00:04<00:00,  3.20it/s]
2025-03-13 17:09:32,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:32
2025-03-13 17:10:12,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7971 secs
2025-03-13 17:10:12,676 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 17:10:12,676 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-13 17:10:56,043 [INFO]: 	>>> Finished "Compute fast metrics" in 43.3670 secs
2025-03-13 17:10:56,047 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.8586 secs
2025-03-13 17:10:56,047 [INFO]: {
2025-03-13 17:10:56,047 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:56,047 [INFO]: 	index_param: efSearch=152
2025-03-13 17:10:56,047 [INFO]: 	index_path: knn.index
2025-03-13 17:10:56,047 [INFO]: 	size in bytes: 705523390
2025-03-13 17:10:56,047 [INFO]: 	avg_search_speed_ms: 8.46882614564974
2025-03-13 17:10:56,047 [INFO]: 	99p_search_speed_ms: 16.748944297432907
2025-03-13 17:10:56,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:56,047 [INFO]: 	nb vectors: 3586
2025-03-13 17:10:56,047 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:56,047 [INFO]: 	compression ratio: 0.9993095877374101
2025-03-13 17:10:56,047 [INFO]: }
2025-03-13 17:10:56,047 [INFO]: 	>>> Finished "Creating the index" in 87.8620 secs
2025-03-13 17:10:56,047 [INFO]: >>> Finished "Launching the whole pipeline" in 87.8954 secs
2025-03-13 17:10:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 88086 [episode count 1/20]
[retrieval_preprocessing] for episode 50760 [episode count 2/20], we have num_retrieval=np.int64(3523) num_query=np.int64(199)
2025-03-13 17:10:57,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:57,948 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:57
2025-03-13 17:10:57,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.01it/s]
2025-03-13 17:10:57,980 [INFO]: There are 3523 embeddings of dim 49152
2025-03-13 17:10:57,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 17:10:57,980 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:57
2025-03-13 17:10:57,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:57,980 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:10:57,980 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:57,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:10:57,980 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:57
2025-03-13 17:10:57,981 [INFO]: 727.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:57,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:10:57,981 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:57
2025-03-13 17:10:57,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:57,981 [INFO]: 	Creating the index 03/13/2025, 17:10:57
2025-03-13 17:10:57,981 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:57
2025-03-13 17:10:57,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:10:57,982 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:57
2025-03-13 17:10:57,982 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:10:57,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.26it/s] 57%|█████▋    | 8/14 [00:00<00:00, 40.80it/s]100%|██████████| 14/14 [00:03<00:00,  3.83it/s]100%|██████████| 14/14 [00:03<00:00,  4.65it/s]
2025-03-13 17:11:00,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:00
2025-03-13 17:11:47,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0433 secs
2025-03-13 17:11:47,042 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 17:11:47,042 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 17:12:13,229 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1866 secs
2025-03-13 17:12:13,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2501 secs
2025-03-13 17:12:13,232 [INFO]: {
2025-03-13 17:12:13,232 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:13,232 [INFO]: 	index_param: efSearch=111
2025-03-13 17:12:13,232 [INFO]: 	index_path: knn.index
2025-03-13 17:12:13,232 [INFO]: 	size in bytes: 693128530
2025-03-13 17:12:13,232 [INFO]: 	avg_search_speed_ms: 10.462846362692495
2025-03-13 17:12:13,232 [INFO]: 	99p_search_speed_ms: 21.392546594142935
2025-03-13 17:12:13,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:13,232 [INFO]: 	nb vectors: 3523
2025-03-13 17:12:13,232 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:13,232 [INFO]: 	compression ratio: 0.9993095854819307
2025-03-13 17:12:13,232 [INFO]: }
2025-03-13 17:12:13,232 [INFO]: 	>>> Finished "Creating the index" in 75.2516 secs
2025-03-13 17:12:13,232 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2847 secs
2025-03-13 17:12:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 50760 [episode count 2/20]
[retrieval_preprocessing] for episode 78480 [episode count 3/20], we have num_retrieval=np.int64(3615) num_query=np.int64(107)
2025-03-13 17:12:16,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:17,325 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:17
2025-03-13 17:12:17,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.93it/s]
2025-03-13 17:12:17,358 [INFO]: There are 3615 embeddings of dim 49152
2025-03-13 17:12:17,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 17:12:17,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:17
2025-03-13 17:12:17,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:17,360 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:12:17,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:17,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:12:17,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:17
2025-03-13 17:12:17,361 [INFO]: 746.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:17,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:12:17,361 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:17
2025-03-13 17:12:17,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:17,361 [INFO]: 	Creating the index 03/13/2025, 17:12:17
2025-03-13 17:12:17,362 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:17
2025-03-13 17:12:17,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:12:17,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:17
2025-03-13 17:12:17,366 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:12:17,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.32it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.91it/s] 20%|██        | 3/15 [00:00<00:01,  7.70it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.30it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.59it/s] 40%|████      | 6/15 [00:00<00:01,  8.90it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.00it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.98it/s] 60%|██████    | 9/15 [00:01<00:00,  9.08it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.99it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.02it/s] 80%|████████  | 12/15 [00:01<00:00,  9.22it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.42it/s]100%|██████████| 15/15 [00:06<00:00,  1.27s/it]100%|██████████| 15/15 [00:06<00:00,  2.23it/s]
2025-03-13 17:12:24,105 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:24
2025-03-13 17:13:05,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2399 secs
2025-03-13 17:13:05,346 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 17:13:05,346 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 17:13:36,859 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5127 secs
2025-03-13 17:13:36,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4966 secs
2025-03-13 17:13:36,862 [INFO]: {
2025-03-13 17:13:36,862 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:36,862 [INFO]: 	index_param: efSearch=93
2025-03-13 17:13:36,862 [INFO]: 	index_path: knn.index
2025-03-13 17:13:36,862 [INFO]: 	size in bytes: 711229030
2025-03-13 17:13:36,862 [INFO]: 	avg_search_speed_ms: 5.340917475216931
2025-03-13 17:13:36,862 [INFO]: 	99p_search_speed_ms: 7.603084109723563
2025-03-13 17:13:36,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:36,862 [INFO]: 	nb vectors: 3615
2025-03-13 17:13:36,862 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:36,862 [INFO]: 	compression ratio: 0.9993094910650652
2025-03-13 17:13:36,862 [INFO]: }
2025-03-13 17:13:36,862 [INFO]: 	>>> Finished "Creating the index" in 79.5008 secs
2025-03-13 17:13:36,862 [INFO]: >>> Finished "Launching the whole pipeline" in 79.5371 secs
2025-03-13 17:13:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 78480 [episode count 3/20]
[retrieval_preprocessing] for episode 41118 [episode count 4/20], we have num_retrieval=np.int64(3606) num_query=np.int64(116)
2025-03-13 17:13:38,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:39,226 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:39
2025-03-13 17:13:39,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1571.49it/s]
2025-03-13 17:13:39,250 [INFO]: There are 3606 embeddings of dim 49152
2025-03-13 17:13:39,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 17:13:39,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:39
2025-03-13 17:13:39,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:39,250 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:13:39,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:39,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:39,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:39
2025-03-13 17:13:39,250 [INFO]: 744.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:39,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:13:39,250 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:39
2025-03-13 17:13:39,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:39,250 [INFO]: 	Creating the index 03/13/2025, 17:13:39
2025-03-13 17:13:39,250 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:39
2025-03-13 17:13:39,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:13:39,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:39
2025-03-13 17:13:39,252 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:13:39,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.16it/s] 27%|██▋       | 4/15 [00:00<00:00, 13.52it/s] 40%|████      | 6/15 [00:00<00:00, 15.39it/s] 53%|█████▎    | 8/15 [00:00<00:00, 11.26it/s] 67%|██████▋   | 10/15 [00:00<00:00, 10.65it/s] 80%|████████  | 12/15 [00:01<00:00, 12.06it/s] 93%|█████████▎| 14/15 [00:01<00:00, 13.29it/s]100%|██████████| 15/15 [00:04<00:00,  3.67it/s]
2025-03-13 17:13:43,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:43
2025-03-13 17:14:25,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0254 secs
2025-03-13 17:14:25,371 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 17:14:25,371 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.56it/s] 50%|█████     | 2/4 [00:00<00:00,  3.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.52it/s]
2025-03-13 17:14:43,145 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7736 secs
2025-03-13 17:14:43,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8958 secs
2025-03-13 17:14:43,148 [INFO]: {
2025-03-13 17:14:43,148 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:43,148 [INFO]: 	index_param: efSearch=156
2025-03-13 17:14:43,148 [INFO]: 	index_path: knn.index
2025-03-13 17:14:43,148 [INFO]: 	size in bytes: 709458310
2025-03-13 17:14:43,148 [INFO]: 	avg_search_speed_ms: 10.37249220554481
2025-03-13 17:14:43,148 [INFO]: 	99p_search_speed_ms: 19.81497612548992
2025-03-13 17:14:43,148 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:43,148 [INFO]: 	nb vectors: 3606
2025-03-13 17:14:43,148 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:43,148 [INFO]: 	compression ratio: 0.9993095267289208
2025-03-13 17:14:43,148 [INFO]: }
2025-03-13 17:14:43,148 [INFO]: 	>>> Finished "Creating the index" in 63.8975 secs
2025-03-13 17:14:43,148 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9216 secs
2025-03-13 17:14:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 41118 [episode count 4/20]
[retrieval_preprocessing] for episode 16062 [episode count 5/20], we have num_retrieval=np.int64(3227) num_query=np.int64(495)
2025-03-13 17:14:46,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:47,339 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:47
2025-03-13 17:14:47,339 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1568.55it/s]
2025-03-13 17:14:47,362 [INFO]: There are 3227 embeddings of dim 49152
2025-03-13 17:14:47,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 17:14:47,363 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:47
2025-03-13 17:14:47,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:47,363 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 17:14:47,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:47,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:47,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:47
2025-03-13 17:14:47,363 [INFO]: 666.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:47,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:47,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:47
2025-03-13 17:14:47,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:47,363 [INFO]: 	Creating the index 03/13/2025, 17:14:47
2025-03-13 17:14:47,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:47
2025-03-13 17:14:47,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:14:47,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:47
2025-03-13 17:14:47,364 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:14:47,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.90it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.07it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.60it/s] 31%|███       | 4/13 [00:00<00:01,  6.83it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.03it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.20it/s] 54%|█████▍    | 7/13 [00:01<00:00,  7.18it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.56it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.54it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.24it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.12it/s]100%|██████████| 13/13 [00:04<00:00,  1.25it/s]100%|██████████| 13/13 [00:04<00:00,  3.10it/s]
2025-03-13 17:14:51,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:51
2025-03-13 17:15:24,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0965 secs
2025-03-13 17:15:24,659 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 17:15:24,659 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.01it/s]
2025-03-13 17:15:58,396 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7368 secs
2025-03-13 17:15:58,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0351 secs
2025-03-13 17:15:58,399 [INFO]: {
2025-03-13 17:15:58,399 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:58,399 [INFO]: 	index_param: efSearch=146
2025-03-13 17:15:58,399 [INFO]: 	index_path: knn.index
2025-03-13 17:15:58,399 [INFO]: 	size in bytes: 634892410
2025-03-13 17:15:58,400 [INFO]: 	avg_search_speed_ms: 7.897994201851047
2025-03-13 17:15:58,400 [INFO]: 	99p_search_speed_ms: 15.083010378293677
2025-03-13 17:15:58,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:58,400 [INFO]: 	nb vectors: 3227
2025-03-13 17:15:58,400 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:58,400 [INFO]: 	compression ratio: 0.999309498754285
2025-03-13 17:15:58,400 [INFO]: }
2025-03-13 17:15:58,400 [INFO]: 	>>> Finished "Creating the index" in 71.0365 secs
2025-03-13 17:15:58,400 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0604 secs
2025-03-13 17:16:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 16062 [episode count 5/20]
[retrieval_preprocessing] for episode 30926 [episode count 6/20], we have num_retrieval=np.int64(3628) num_query=np.int64(94)
2025-03-13 17:16:05,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:05,905 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:05
2025-03-13 17:16:05,906 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1248.30it/s]
2025-03-13 17:16:05,933 [INFO]: There are 3628 embeddings of dim 49152
2025-03-13 17:16:05,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:16:05,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:05
2025-03-13 17:16:05,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:05,933 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:16:05,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:05,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:05,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:05
2025-03-13 17:16:05,934 [INFO]: 748.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:05,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:16:05,934 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:05
2025-03-13 17:16:05,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:05,934 [INFO]: 	Creating the index 03/13/2025, 17:16:05
2025-03-13 17:16:05,934 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:05
2025-03-13 17:16:05,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:16:05,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:05
2025-03-13 17:16:05,935 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:16:05,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.96it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.57it/s] 20%|██        | 3/15 [00:00<00:01,  8.38it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.66it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.82it/s] 40%|████      | 6/15 [00:00<00:00,  9.13it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.30it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.45it/s] 60%|██████    | 9/15 [00:01<00:00,  9.53it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.18it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.54it/s]100%|██████████| 15/15 [00:04<00:00,  1.77it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-13 17:16:10,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:10
2025-03-13 17:16:54,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4740 secs
2025-03-13 17:16:54,551 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 17:16:54,551 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.84it/s] 50%|█████     | 2/4 [00:00<00:00,  4.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.42it/s]
2025-03-13 17:17:25,178 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6261 secs
2025-03-13 17:17:25,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2468 secs
2025-03-13 17:17:25,182 [INFO]: {
2025-03-13 17:17:25,182 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:25,182 [INFO]: 	index_param: efSearch=138
2025-03-13 17:17:25,182 [INFO]: 	index_path: knn.index
2025-03-13 17:17:25,182 [INFO]: 	size in bytes: 713786710
2025-03-13 17:17:25,182 [INFO]: 	avg_search_speed_ms: 8.36499272806718
2025-03-13 17:17:25,182 [INFO]: 	99p_search_speed_ms: 13.074452062137423
2025-03-13 17:17:25,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:25,182 [INFO]: 	nb vectors: 3628
2025-03-13 17:17:25,182 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:25,182 [INFO]: 	compression ratio: 0.9993094771966264
2025-03-13 17:17:25,182 [INFO]: }
2025-03-13 17:17:25,182 [INFO]: 	>>> Finished "Creating the index" in 79.2485 secs
2025-03-13 17:17:25,182 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2767 secs
2025-03-13 17:17:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 30926 [episode count 6/20]
[retrieval_preprocessing] for episode 30430 [episode count 7/20], we have num_retrieval=np.int64(3614) num_query=np.int64(108)
2025-03-13 17:17:27,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:28,130 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:28
2025-03-13 17:17:28,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.18it/s]
2025-03-13 17:17:28,157 [INFO]: There are 3614 embeddings of dim 49152
2025-03-13 17:17:28,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 17:17:28,157 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,157 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:28,157 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:17:28,157 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:28,157 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:28,157 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,157 [INFO]: 745.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:28,157 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:17:28,157 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:28
2025-03-13 17:17:28,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:28,157 [INFO]: 	Creating the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,158 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:28
2025-03-13 17:17:28,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:17:28,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,159 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:17:28,159 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.25it/s] 20%|██        | 3/15 [00:00<00:00, 14.48it/s] 33%|███▎      | 5/15 [00:00<00:00, 16.48it/s] 53%|█████▎    | 8/15 [00:00<00:00, 19.05it/s] 67%|██████▋   | 10/15 [00:00<00:00, 16.37it/s] 80%|████████  | 12/15 [00:00<00:00, 14.17it/s] 93%|█████████▎| 14/15 [00:00<00:00, 12.74it/s]100%|██████████| 15/15 [00:04<00:00,  3.64it/s]
2025-03-13 17:17:32,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:32
2025-03-13 17:18:10,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3070 secs
2025-03-13 17:18:10,586 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:18:10,586 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.99it/s] 50%|█████     | 2/4 [00:00<00:00,  3.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.76it/s]
2025-03-13 17:18:33,498 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9120 secs
2025-03-13 17:18:33,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3431 secs
2025-03-13 17:18:33,502 [INFO]: {
2025-03-13 17:18:33,502 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:33,502 [INFO]: 	index_param: efSearch=170
2025-03-13 17:18:33,502 [INFO]: 	index_path: knn.index
2025-03-13 17:18:33,502 [INFO]: 	size in bytes: 711032290
2025-03-13 17:18:33,502 [INFO]: 	avg_search_speed_ms: 9.580646206221589
2025-03-13 17:18:33,502 [INFO]: 	99p_search_speed_ms: 14.584886403754352
2025-03-13 17:18:33,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:33,502 [INFO]: 	nb vectors: 3614
2025-03-13 17:18:33,502 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:33,502 [INFO]: 	compression ratio: 0.9993094856493788
2025-03-13 17:18:33,502 [INFO]: }
2025-03-13 17:18:33,502 [INFO]: 	>>> Finished "Creating the index" in 65.3445 secs
2025-03-13 17:18:33,502 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3720 secs
2025-03-13 17:18:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 30430 [episode count 7/20]
[retrieval_preprocessing] for episode 38626 [episode count 8/20], we have num_retrieval=np.int64(3508) num_query=np.int64(214)
2025-03-13 17:18:35,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:36,438 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:36
2025-03-13 17:18:36,438 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.07it/s]
2025-03-13 17:18:36,462 [INFO]: There are 3508 embeddings of dim 49152
2025-03-13 17:18:36,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:18:36,463 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,463 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:36,463 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:18:36,463 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:36,463 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:18:36,463 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,463 [INFO]: 724.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:36,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:18:36,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:36
2025-03-13 17:18:36,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:36,463 [INFO]: 	Creating the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:36
2025-03-13 17:18:36,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:18:36,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:36
2025-03-13 17:18:36,464 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:18:36,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.36it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.87it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.46it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.70it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.09it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.60it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.27it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.73it/s]100%|██████████| 14/14 [00:04<00:00,  1.63it/s]100%|██████████| 14/14 [00:04<00:00,  3.06it/s]
2025-03-13 17:18:41,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:41
2025-03-13 17:19:17,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8558 secs
2025-03-13 17:19:17,903 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 17:19:17,903 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-13 17:19:45,737 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8344 secs
2025-03-13 17:19:45,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2766 secs
2025-03-13 17:19:45,741 [INFO]: {
2025-03-13 17:19:45,741 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:45,741 [INFO]: 	index_param: efSearch=106
2025-03-13 17:19:45,741 [INFO]: 	index_path: knn.index
2025-03-13 17:19:45,741 [INFO]: 	size in bytes: 690177430
2025-03-13 17:19:45,741 [INFO]: 	avg_search_speed_ms: 6.204505276147676
2025-03-13 17:19:45,741 [INFO]: 	99p_search_speed_ms: 11.226517125032846
2025-03-13 17:19:45,741 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:45,741 [INFO]: 	nb vectors: 3508
2025-03-13 17:19:45,741 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:45,741 [INFO]: 	compression ratio: 0.999309502195689
2025-03-13 17:19:45,741 [INFO]: }
2025-03-13 17:19:45,741 [INFO]: 	>>> Finished "Creating the index" in 69.2779 secs
2025-03-13 17:19:45,741 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3034 secs
2025-03-13 17:19:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 38626 [episode count 8/20]
[retrieval_preprocessing] for episode 77563 [episode count 9/20], we have num_retrieval=np.int64(3521) num_query=np.int64(201)
2025-03-13 17:19:48,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:48,805 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:48
2025-03-13 17:19:48,806 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.45it/s]
2025-03-13 17:19:48,838 [INFO]: There are 3521 embeddings of dim 49152
2025-03-13 17:19:48,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 17:19:48,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:48
2025-03-13 17:19:48,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:48,838 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:19:48,838 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:48,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:19:48,838 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:48
2025-03-13 17:19:48,839 [INFO]: 726.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:48,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:19:48,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:48
2025-03-13 17:19:48,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:48,839 [INFO]: 	Creating the index 03/13/2025, 17:19:48
2025-03-13 17:19:48,839 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:48
2025-03-13 17:19:48,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:19:48,841 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:48
2025-03-13 17:19:48,841 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:19:48,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.63it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.06it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.23it/s] 50%|█████     | 7/14 [00:00<00:00, 10.85it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.36it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.44it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.55it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-13 17:19:53,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:53
2025-03-13 17:20:33,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9622 secs
2025-03-13 17:20:33,313 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 17:20:33,313 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 17:20:58,050 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7371 secs
2025-03-13 17:20:58,053 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2122 secs
2025-03-13 17:20:58,053 [INFO]: {
2025-03-13 17:20:58,053 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:58,053 [INFO]: 	index_param: efSearch=160
2025-03-13 17:20:58,053 [INFO]: 	index_path: knn.index
2025-03-13 17:20:58,053 [INFO]: 	size in bytes: 692735050
2025-03-13 17:20:58,053 [INFO]: 	avg_search_speed_ms: 10.288807211363297
2025-03-13 17:20:58,053 [INFO]: 	99p_search_speed_ms: 16.623194895219054
2025-03-13 17:20:58,053 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:58,053 [INFO]: 	nb vectors: 3521
2025-03-13 17:20:58,053 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:58,053 [INFO]: 	compression ratio: 0.9993095744180982
2025-03-13 17:20:58,054 [INFO]: }
2025-03-13 17:20:58,054 [INFO]: 	>>> Finished "Creating the index" in 69.2145 secs
2025-03-13 17:20:58,054 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2479 secs
2025-03-13 17:21:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 77563 [episode count 9/20]
[retrieval_preprocessing] for episode 45314 [episode count 10/20], we have num_retrieval=np.int64(3507) num_query=np.int64(215)
2025-03-13 17:21:02,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:02,761 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:02
2025-03-13 17:21:02,762 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 17:21:02,782 [INFO]: There are 3507 embeddings of dim 49152
2025-03-13 17:21:02,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0209 secs
2025-03-13 17:21:02,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:02,783 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:21:02,783 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:02,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:21:02,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,783 [INFO]: 723.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:02,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:21:02,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:02
2025-03-13 17:21:02,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:02,783 [INFO]: 	Creating the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,783 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:02
2025-03-13 17:21:02,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:21:02,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:02
2025-03-13 17:21:02,784 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:21:02,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.68it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.97it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.77it/s] 50%|█████     | 7/14 [00:00<00:00, 10.76it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.08it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.36it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.78it/s]100%|██████████| 14/14 [00:04<00:00,  3.27it/s]
2025-03-13 17:21:07,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:07
2025-03-13 17:21:46,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3495 secs
2025-03-13 17:21:46,418 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 17:21:46,418 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 17:22:08,464 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0460 secs
2025-03-13 17:22:08,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6828 secs
2025-03-13 17:22:08,468 [INFO]: {
2025-03-13 17:22:08,468 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:08,468 [INFO]: 	index_param: efSearch=172
2025-03-13 17:22:08,468 [INFO]: 	index_path: knn.index
2025-03-13 17:22:08,468 [INFO]: 	size in bytes: 689980690
2025-03-13 17:22:08,468 [INFO]: 	avg_search_speed_ms: 8.934651570556097
2025-03-13 17:22:08,468 [INFO]: 	99p_search_speed_ms: 15.845398912206244
2025-03-13 17:22:08,468 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:08,468 [INFO]: 	nb vectors: 3507
2025-03-13 17:22:08,468 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:08,468 [INFO]: 	compression ratio: 0.9993094966179416
2025-03-13 17:22:08,468 [INFO]: }
2025-03-13 17:22:08,468 [INFO]: 	>>> Finished "Creating the index" in 65.6848 secs
2025-03-13 17:22:08,468 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7064 secs
2025-03-13 17:22:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 45314 [episode count 10/20]
[retrieval_preprocessing] for episode 33062 [episode count 11/20], we have num_retrieval=np.int64(3620) num_query=np.int64(102)
2025-03-13 17:22:11,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:12,190 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:12
2025-03-13 17:22:12,190 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-13 17:22:12,215 [INFO]: There are 3620 embeddings of dim 49152
2025-03-13 17:22:12,215 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:22:12,215 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:12
2025-03-13 17:22:12,215 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:12,215 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:22:12,215 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:12,215 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:12,216 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:12
2025-03-13 17:22:12,216 [INFO]: 747.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:12,216 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:12,216 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:12
2025-03-13 17:22:12,216 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:12,216 [INFO]: 	Creating the index 03/13/2025, 17:22:12
2025-03-13 17:22:12,216 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:12
2025-03-13 17:22:12,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:22:12,217 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:12
2025-03-13 17:22:12,217 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:22:12,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.12it/s] 20%|██        | 3/15 [00:00<00:01,  8.02it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.56it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.46it/s] 60%|██████    | 9/15 [00:00<00:00, 11.02it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.25it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.23it/s]100%|██████████| 15/15 [00:04<00:00,  1.94it/s]100%|██████████| 15/15 [00:04<00:00,  3.67it/s]
2025-03-13 17:22:16,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:16
2025-03-13 17:22:54,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1009 secs
2025-03-13 17:22:54,404 [INFO]: The best hyperparameters are: efSearch=75
2025-03-13 17:22:54,404 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 17:23:21,189 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7847 secs
2025-03-13 17:23:21,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4894 secs
2025-03-13 17:23:21,707 [INFO]: {
2025-03-13 17:23:21,707 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:21,707 [INFO]: 	index_param: efSearch=75
2025-03-13 17:23:21,707 [INFO]: 	index_path: knn.index
2025-03-13 17:23:21,707 [INFO]: 	size in bytes: 712212790
2025-03-13 17:23:21,707 [INFO]: 	avg_search_speed_ms: 5.272493299372042
2025-03-13 17:23:21,707 [INFO]: 	99p_search_speed_ms: 9.643244454637163
2025-03-13 17:23:21,707 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:21,707 [INFO]: 	nb vectors: 3620
2025-03-13 17:23:21,707 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:21,707 [INFO]: 	compression ratio: 0.9993094339123003
2025-03-13 17:23:21,707 [INFO]: }
2025-03-13 17:23:21,707 [INFO]: 	>>> Finished "Creating the index" in 69.4915 secs
2025-03-13 17:23:21,707 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5178 secs
2025-03-13 17:23:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 33062 [episode count 11/20]
[retrieval_preprocessing] for episode 3371 [episode count 12/20], we have num_retrieval=np.int64(3551) num_query=np.int64(171)
2025-03-13 17:23:25,057 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:25,725 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:25
2025-03-13 17:23:25,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1100.58it/s]
2025-03-13 17:23:25,752 [INFO]: There are 3551 embeddings of dim 49152
2025-03-13 17:23:25,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:23:25,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:25
2025-03-13 17:23:25,753 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:25,753 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:23:25,753 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:25,753 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:23:25,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:25
2025-03-13 17:23:25,754 [INFO]: 732.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:25,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:23:25,755 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:25
2025-03-13 17:23:25,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:25,755 [INFO]: 	Creating the index 03/13/2025, 17:23:25
2025-03-13 17:23:25,755 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:25
2025-03-13 17:23:25,758 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:23:25,758 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:25
2025-03-13 17:23:25,758 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:23:25,758 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.05it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.52it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.11it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.27it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.30it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.42it/s] 50%|█████     | 7/14 [00:00<00:00,  7.65it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.82it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.94it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.95it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.97it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.13it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.11it/s]100%|██████████| 14/14 [00:05<00:00,  1.10s/it]100%|██████████| 14/14 [00:05<00:00,  2.76it/s]
2025-03-13 17:23:30,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:30
2025-03-13 17:24:06,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2840 secs
2025-03-13 17:24:06,125 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 17:24:06,125 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 17:24:29,543 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4181 secs
2025-03-13 17:24:29,547 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7886 secs
2025-03-13 17:24:29,547 [INFO]: {
2025-03-13 17:24:29,547 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:29,547 [INFO]: 	index_param: efSearch=159
2025-03-13 17:24:29,547 [INFO]: 	index_path: knn.index
2025-03-13 17:24:29,547 [INFO]: 	size in bytes: 698637430
2025-03-13 17:24:29,547 [INFO]: 	avg_search_speed_ms: 9.855009367435994
2025-03-13 17:24:29,547 [INFO]: 	99p_search_speed_ms: 20.93068928923458
2025-03-13 17:24:29,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:29,547 [INFO]: 	nb vectors: 3551
2025-03-13 17:24:29,547 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:29,547 [INFO]: 	compression ratio: 0.9993094816004919
2025-03-13 17:24:29,547 [INFO]: }
2025-03-13 17:24:29,547 [INFO]: 	>>> Finished "Creating the index" in 63.7920 secs
2025-03-13 17:24:29,547 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8222 secs
2025-03-13 17:24:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 3371 [episode count 12/20]
[retrieval_preprocessing] for episode 90445 [episode count 13/20], we have num_retrieval=np.int64(3484) num_query=np.int64(238)
2025-03-13 17:24:32,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:32,616 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:32
2025-03-13 17:24:32,616 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 767.20it/s]
2025-03-13 17:24:32,644 [INFO]: There are 3484 embeddings of dim 49152
2025-03-13 17:24:32,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:24:32,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:32
2025-03-13 17:24:32,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:32,645 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:24:32,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:32,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:24:32,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:32
2025-03-13 17:24:32,645 [INFO]: 719.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:32,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:24:32,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:32
2025-03-13 17:24:32,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:32,645 [INFO]: 	Creating the index 03/13/2025, 17:24:32
2025-03-13 17:24:32,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:32
2025-03-13 17:24:32,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:24:32,648 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:32
2025-03-13 17:24:32,649 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:24:32,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.54it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.96it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.47it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.83it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.92it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.18it/s] 50%|█████     | 7/14 [00:00<00:00,  8.25it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.31it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.39it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.32it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.47it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.41it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.32it/s]100%|██████████| 14/14 [00:04<00:00,  1.14it/s]100%|██████████| 14/14 [00:04<00:00,  3.30it/s]
2025-03-13 17:24:37,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:37
2025-03-13 17:25:14,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4910 secs
2025-03-13 17:25:14,942 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 17:25:14,942 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.32it/s] 50%|█████     | 2/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s]
2025-03-13 17:25:40,294 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3523 secs
2025-03-13 17:25:40,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6489 secs
2025-03-13 17:25:40,298 [INFO]: {
2025-03-13 17:25:40,298 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:40,298 [INFO]: 	index_param: efSearch=137
2025-03-13 17:25:40,298 [INFO]: 	index_path: knn.index
2025-03-13 17:25:40,298 [INFO]: 	size in bytes: 685455610
2025-03-13 17:25:40,298 [INFO]: 	avg_search_speed_ms: 8.344380969596788
2025-03-13 17:25:40,298 [INFO]: 	99p_search_speed_ms: 14.621255511883644
2025-03-13 17:25:40,298 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:40,298 [INFO]: 	nb vectors: 3484
2025-03-13 17:25:40,298 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:40,298 [INFO]: 	compression ratio: 0.9993094549186051
2025-03-13 17:25:40,298 [INFO]: }
2025-03-13 17:25:40,298 [INFO]: 	>>> Finished "Creating the index" in 67.6522 secs
2025-03-13 17:25:40,298 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6816 secs
2025-03-13 17:25:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 90445 [episode count 13/20]
[retrieval_preprocessing] for episode 95581 [episode count 14/20], we have num_retrieval=np.int64(3532) num_query=np.int64(190)
2025-03-13 17:25:43,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:43,879 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:43
2025-03-13 17:25:43,879 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.86it/s]
2025-03-13 17:25:43,904 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 17:25:43,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:25:43,905 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:43
2025-03-13 17:25:43,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:43,905 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:25:43,905 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:43,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:25:43,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:43
2025-03-13 17:25:43,906 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:43,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:25:43,906 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:43
2025-03-13 17:25:43,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:43,906 [INFO]: 	Creating the index 03/13/2025, 17:25:43
2025-03-13 17:25:43,906 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:43
2025-03-13 17:25:43,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:25:43,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:43
2025-03-13 17:25:43,910 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:25:43,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.63it/s] 14%|█▍        | 2/14 [00:00<00:02,  5.94it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.56it/s] 29%|██▊       | 4/14 [00:00<00:01,  6.92it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.16it/s] 50%|█████     | 7/14 [00:00<00:00,  8.94it/s] 64%|██████▍   | 9/14 [00:01<00:00, 10.04it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.04it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.42it/s]100%|██████████| 14/14 [00:03<00:00,  3.53it/s]
2025-03-13 17:25:47,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:47
2025-03-13 17:26:28,719 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8266 secs
2025-03-13 17:26:28,719 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 17:26:28,719 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
2025-03-13 17:26:48,898 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1791 secs
2025-03-13 17:26:49,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4965 secs
2025-03-13 17:26:49,406 [INFO]: {
2025-03-13 17:26:49,407 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:49,407 [INFO]: 	index_param: efSearch=167
2025-03-13 17:26:49,407 [INFO]: 	index_path: knn.index
2025-03-13 17:26:49,407 [INFO]: 	size in bytes: 694899250
2025-03-13 17:26:49,407 [INFO]: 	avg_search_speed_ms: 9.324085051645595
2025-03-13 17:26:49,407 [INFO]: 	99p_search_speed_ms: 14.343421070370814
2025-03-13 17:26:49,407 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:49,407 [INFO]: 	nb vectors: 3532
2025-03-13 17:26:49,407 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:49,407 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 17:26:49,407 [INFO]: }
2025-03-13 17:26:49,407 [INFO]: 	>>> Finished "Creating the index" in 65.5011 secs
2025-03-13 17:26:49,407 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5280 secs
2025-03-13 17:26:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 95581 [episode count 14/20]
[retrieval_preprocessing] for episode 60770 [episode count 15/20], we have num_retrieval=np.int64(3501) num_query=np.int64(221)
2025-03-13 17:26:52,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:52,786 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:52
2025-03-13 17:26:52,786 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1675.71it/s]
2025-03-13 17:26:52,813 [INFO]: There are 3501 embeddings of dim 49152
2025-03-13 17:26:52,814 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 17:26:52,814 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:52
2025-03-13 17:26:52,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:52,815 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:26:52,815 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:52,815 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:26:52,815 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:52
2025-03-13 17:26:52,816 [INFO]: 722.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:52,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:26:52,816 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:52
2025-03-13 17:26:52,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:52,816 [INFO]: 	Creating the index 03/13/2025, 17:26:52
2025-03-13 17:26:52,816 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:52
2025-03-13 17:26:52,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:26:52,820 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:52
2025-03-13 17:26:52,820 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:26:52,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.92it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.06it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.16it/s] 50%|█████     | 7/14 [00:00<00:00, 12.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.70it/s] 79%|███████▊  | 11/14 [00:00<00:00, 14.40it/s] 93%|█████████▎| 13/14 [00:00<00:00, 14.53it/s]100%|██████████| 14/14 [00:03<00:00,  3.97it/s]
2025-03-13 17:26:56,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:56
2025-03-13 17:27:36,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1170 secs
2025-03-13 17:27:36,470 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 17:27:36,470 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.98it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-13 17:27:54,800 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3298 secs
2025-03-13 17:27:54,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9825 secs
2025-03-13 17:27:54,803 [INFO]: {
2025-03-13 17:27:54,803 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:54,803 [INFO]: 	index_param: efSearch=121
2025-03-13 17:27:54,803 [INFO]: 	index_path: knn.index
2025-03-13 17:27:54,803 [INFO]: 	size in bytes: 688800190
2025-03-13 17:27:54,803 [INFO]: 	avg_search_speed_ms: 7.753551492012691
2025-03-13 17:27:54,803 [INFO]: 	99p_search_speed_ms: 12.31624028878285
2025-03-13 17:27:54,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:54,803 [INFO]: 	nb vectors: 3501
2025-03-13 17:27:54,803 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:54,803 [INFO]: 	compression ratio: 0.9993095501323831
2025-03-13 17:27:54,803 [INFO]: }
2025-03-13 17:27:54,803 [INFO]: 	>>> Finished "Creating the index" in 61.9866 secs
2025-03-13 17:27:54,803 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0172 secs
2025-03-13 17:27:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 60770 [episode count 15/20]
[retrieval_preprocessing] for episode 68962 [episode count 16/20], we have num_retrieval=np.int64(3591) num_query=np.int64(131)
2025-03-13 17:27:59,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:00,053 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:00
2025-03-13 17:28:00,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.40it/s]
2025-03-13 17:28:00,078 [INFO]: There are 3591 embeddings of dim 49152
2025-03-13 17:28:00,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 17:28:00,078 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:00
2025-03-13 17:28:00,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:00,078 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:28:00,078 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:00,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:00,079 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:00
2025-03-13 17:28:00,079 [INFO]: 741.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:00,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:28:00,079 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:00
2025-03-13 17:28:00,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:00,079 [INFO]: 	Creating the index 03/13/2025, 17:28:00
2025-03-13 17:28:00,079 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:00
2025-03-13 17:28:00,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:28:00,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:00
2025-03-13 17:28:00,080 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:28:00,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.31it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.25it/s] 20%|██        | 3/15 [00:00<00:01,  8.08it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.51it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.71it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.55it/s] 60%|██████    | 9/15 [00:00<00:00, 11.62it/s] 73%|███████▎  | 11/15 [00:01<00:00, 12.19it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.94it/s]100%|██████████| 15/15 [00:04<00:00,  1.86it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-13 17:28:04,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:04
2025-03-13 17:28:41,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8477 secs
2025-03-13 17:28:41,345 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:28:41,345 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 17:29:20,900 [INFO]: 	>>> Finished "Compute fast metrics" in 39.5548 secs
2025-03-13 17:29:20,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.8226 secs
2025-03-13 17:29:20,903 [INFO]: {
2025-03-13 17:29:20,903 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:20,903 [INFO]: 	index_param: efSearch=200
2025-03-13 17:29:20,903 [INFO]: 	index_path: knn.index
2025-03-13 17:29:20,903 [INFO]: 	size in bytes: 706507090
2025-03-13 17:29:20,903 [INFO]: 	avg_search_speed_ms: 11.265695449289957
2025-03-13 17:29:20,903 [INFO]: 	99p_search_speed_ms: 18.195046903565526
2025-03-13 17:29:20,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:20,903 [INFO]: 	nb vectors: 3591
2025-03-13 17:29:20,903 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:20,903 [INFO]: 	compression ratio: 0.999309614854679
2025-03-13 17:29:20,903 [INFO]: }
2025-03-13 17:29:20,903 [INFO]: 	>>> Finished "Creating the index" in 80.8241 secs
2025-03-13 17:29:20,903 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8495 secs
2025-03-13 17:29:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 68962 [episode count 16/20]
[retrieval_preprocessing] for episode 25465 [episode count 17/20], we have num_retrieval=np.int64(3601) num_query=np.int64(121)
2025-03-13 17:29:24,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:25,580 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:25
2025-03-13 17:29:25,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.86it/s]
2025-03-13 17:29:25,605 [INFO]: There are 3601 embeddings of dim 49152
2025-03-13 17:29:25,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:29:25,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:25
2025-03-13 17:29:25,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:25,606 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:29:25,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:25,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:25,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:25
2025-03-13 17:29:25,606 [INFO]: 743.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:25,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:25,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:25
2025-03-13 17:29:25,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:25,606 [INFO]: 	Creating the index 03/13/2025, 17:29:25
2025-03-13 17:29:25,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:25
2025-03-13 17:29:25,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:29:25,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:25
2025-03-13 17:29:25,608 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:29:25,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.16it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.37it/s] 20%|██        | 3/15 [00:00<00:01,  6.89it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.73it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.74it/s] 40%|████      | 6/15 [00:00<00:01,  7.88it/s] 47%|████▋     | 7/15 [00:00<00:01,  7.96it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.32it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.17it/s] 80%|████████  | 12/15 [00:01<00:00,  9.65it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.76it/s]100%|██████████| 15/15 [00:04<00:00,  1.39it/s]100%|██████████| 15/15 [00:04<00:00,  3.19it/s]
2025-03-13 17:29:30,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:30
2025-03-13 17:30:09,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5557 secs
2025-03-13 17:30:09,864 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 17:30:09,864 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-13 17:30:36,110 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2465 secs
2025-03-13 17:30:36,114 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5062 secs
2025-03-13 17:30:36,114 [INFO]: {
2025-03-13 17:30:36,114 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:36,114 [INFO]: 	index_param: efSearch=170
2025-03-13 17:30:36,114 [INFO]: 	index_path: knn.index
2025-03-13 17:30:36,114 [INFO]: 	size in bytes: 708474490
2025-03-13 17:30:36,114 [INFO]: 	avg_search_speed_ms: 9.967225470746369
2025-03-13 17:30:36,114 [INFO]: 	99p_search_speed_ms: 18.103722715750344
2025-03-13 17:30:36,114 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:36,114 [INFO]: 	nb vectors: 3601
2025-03-13 17:30:36,114 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:36,114 [INFO]: 	compression ratio: 0.9993096688633065
2025-03-13 17:30:36,114 [INFO]: }
2025-03-13 17:30:36,114 [INFO]: 	>>> Finished "Creating the index" in 70.5079 secs
2025-03-13 17:30:36,114 [INFO]: >>> Finished "Launching the whole pipeline" in 70.5339 secs
2025-03-13 17:30:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25465 [episode count 17/20]
[retrieval_preprocessing] for episode 43401 [episode count 18/20], we have num_retrieval=np.int64(3521) num_query=np.int64(201)
2025-03-13 17:30:38,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:39,852 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:39
2025-03-13 17:30:39,852 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2122.62it/s]
2025-03-13 17:30:39,875 [INFO]: There are 3521 embeddings of dim 49152
2025-03-13 17:30:39,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 17:30:39,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:39
2025-03-13 17:30:39,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:39,876 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:30:39,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:39,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:39,876 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:39
2025-03-13 17:30:39,876 [INFO]: 726.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:39,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:39,876 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:39
2025-03-13 17:30:39,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:39,876 [INFO]: 	Creating the index 03/13/2025, 17:30:39
2025-03-13 17:30:39,876 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:39
2025-03-13 17:30:39,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:30:39,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:39
2025-03-13 17:30:39,877 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:30:39,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.76it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.02it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.53it/s] 29%|██▊       | 4/14 [00:00<00:01,  6.82it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.09it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.15it/s] 50%|█████     | 7/14 [00:01<00:00,  7.16it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.12it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.18it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.18it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.30it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.30it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.75it/s]100%|██████████| 14/14 [00:04<00:00,  1.02it/s]100%|██████████| 14/14 [00:04<00:00,  2.92it/s]
2025-03-13 17:30:44,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:44
2025-03-13 17:31:25,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4195 secs
2025-03-13 17:31:25,098 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 17:31:25,098 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 17:31:48,854 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7553 secs
2025-03-13 17:31:48,858 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9803 secs
2025-03-13 17:31:48,858 [INFO]: {
2025-03-13 17:31:48,858 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:48,858 [INFO]: 	index_param: efSearch=140
2025-03-13 17:31:48,858 [INFO]: 	index_path: knn.index
2025-03-13 17:31:48,858 [INFO]: 	size in bytes: 692735050
2025-03-13 17:31:48,858 [INFO]: 	avg_search_speed_ms: 7.830219874603378
2025-03-13 17:31:48,858 [INFO]: 	99p_search_speed_ms: 12.5793775357306
2025-03-13 17:31:48,858 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:48,858 [INFO]: 	nb vectors: 3521
2025-03-13 17:31:48,858 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:48,858 [INFO]: 	compression ratio: 0.9993095744180982
2025-03-13 17:31:48,858 [INFO]: }
2025-03-13 17:31:48,858 [INFO]: 	>>> Finished "Creating the index" in 68.9818 secs
2025-03-13 17:31:48,858 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0060 secs
2025-03-13 17:31:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 43401 [episode count 18/20]
[retrieval_preprocessing] for episode 58285 [episode count 19/20], we have num_retrieval=np.int64(3508) num_query=np.int64(214)
2025-03-13 17:31:52,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:52,966 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:52
2025-03-13 17:31:52,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.40it/s]
2025-03-13 17:31:52,995 [INFO]: There are 3508 embeddings of dim 49152
2025-03-13 17:31:52,995 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:31:52,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:52
2025-03-13 17:31:52,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:52,996 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 17:31:52,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:52,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:31:52,996 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:52
2025-03-13 17:31:52,997 [INFO]: 724.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:52,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:31:52,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:52
2025-03-13 17:31:52,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:52,998 [INFO]: 	Creating the index 03/13/2025, 17:31:52
2025-03-13 17:31:52,998 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:52
2025-03-13 17:31:53,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:31:53,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:53
2025-03-13 17:31:53,001 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 17:31:53,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.82it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.62it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.36it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.93it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.15it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.91it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.17it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.98it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.92it/s]100%|██████████| 14/14 [00:04<00:00,  1.43it/s]100%|██████████| 14/14 [00:04<00:00,  3.38it/s]
2025-03-13 17:31:57,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:57
2025-03-13 17:32:38,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6042 secs
2025-03-13 17:32:38,763 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 17:32:38,763 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-13 17:33:06,693 [INFO]: 	>>> Finished "Compute fast metrics" in 27.9295 secs
2025-03-13 17:33:06,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9628 secs
2025-03-13 17:33:06,964 [INFO]: {
2025-03-13 17:33:06,964 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:06,964 [INFO]: 	index_param: efSearch=162
2025-03-13 17:33:06,964 [INFO]: 	index_path: knn.index
2025-03-13 17:33:06,964 [INFO]: 	size in bytes: 690177430
2025-03-13 17:33:06,964 [INFO]: 	avg_search_speed_ms: 9.293807034733875
2025-03-13 17:33:06,964 [INFO]: 	99p_search_speed_ms: 14.651819423306733
2025-03-13 17:33:06,965 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:06,965 [INFO]: 	nb vectors: 3508
2025-03-13 17:33:06,965 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:06,965 [INFO]: 	compression ratio: 0.999309502195689
2025-03-13 17:33:06,965 [INFO]: }
2025-03-13 17:33:06,965 [INFO]: 	>>> Finished "Creating the index" in 73.9672 secs
2025-03-13 17:33:06,965 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9984 secs
2025-03-13 17:33:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 58285 [episode count 19/20]
2025-03-13 17:33:08: [retrieval_preprocessing] finished for 9933578360_close_tap [chosen_id count 3/196]
2025-03-13 17:33:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9933578360_close_drawer [chosen_id count 4/196]
2025-03-13 17:33:10: [retrieval_preprocessing] we have num_total=2507 embedding_dim=49152
[retrieval_preprocessing] for episode 79897 [episode count 0/20], we have num_retrieval=np.int64(2402) num_query=np.int64(105)
2025-03-13 17:33:11,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:12,418 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:12
2025-03-13 17:33:12,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.95it/s]
2025-03-13 17:33:12,443 [INFO]: There are 2402 embeddings of dim 49152
2025-03-13 17:33:12,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:33:12,443 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:12
2025-03-13 17:33:12,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:12,443 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:33:12,443 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:12,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:12,443 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:12
2025-03-13 17:33:12,444 [INFO]: 495.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:12,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:12,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:12
2025-03-13 17:33:12,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:12,444 [INFO]: 	Creating the index 03/13/2025, 17:33:12
2025-03-13 17:33:12,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:12
2025-03-13 17:33:12,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:33:12,445 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:12
2025-03-13 17:33:12,445 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:33:12,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.81it/s] 20%|██        | 2/10 [00:00<00:01,  7.01it/s] 30%|███       | 3/10 [00:00<00:00,  7.52it/s] 40%|████      | 4/10 [00:00<00:00,  7.92it/s] 50%|█████     | 5/10 [00:00<00:00,  8.02it/s] 60%|██████    | 6/10 [00:00<00:00,  7.96it/s] 70%|███████   | 7/10 [00:00<00:00,  8.06it/s] 80%|████████  | 8/10 [00:01<00:00,  8.08it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.23it/s]100%|██████████| 10/10 [00:02<00:00,  1.53it/s]100%|██████████| 10/10 [00:02<00:00,  3.35it/s]
2025-03-13 17:33:15,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:15
2025-03-13 17:33:46,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0401 secs
2025-03-13 17:33:46,478 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 17:33:46,478 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s]
2025-03-13 17:34:11,577 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0987 secs
2025-03-13 17:34:11,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1338 secs
2025-03-13 17:34:11,579 [INFO]: {
2025-03-13 17:34:11,579 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:11,579 [INFO]: 	index_param: efSearch=251
2025-03-13 17:34:11,579 [INFO]: 	index_path: knn.index
2025-03-13 17:34:11,579 [INFO]: 	size in bytes: 472578610
2025-03-13 17:34:11,579 [INFO]: 	avg_search_speed_ms: 10.687850664457322
2025-03-13 17:34:11,579 [INFO]: 	99p_search_speed_ms: 17.469477653503407
2025-03-13 17:34:11,579 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:11,579 [INFO]: 	nb vectors: 2402
2025-03-13 17:34:11,579 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:11,579 [INFO]: 	compression ratio: 0.9993097571639986
2025-03-13 17:34:11,579 [INFO]: }
2025-03-13 17:34:11,579 [INFO]: 	>>> Finished "Creating the index" in 59.1352 secs
2025-03-13 17:34:11,579 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1610 secs
2025-03-13 17:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 79897 [episode count 0/20]
[retrieval_preprocessing] for episode 55377 [episode count 1/20], we have num_retrieval=np.int64(2339) num_query=np.int64(168)
2025-03-13 17:34:14,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:14,820 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:14
2025-03-13 17:34:14,820 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 775.43it/s]
2025-03-13 17:34:14,847 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 17:34:14,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:34:14,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:14
2025-03-13 17:34:14,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:14,848 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:34:14,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:14,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:14,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:14
2025-03-13 17:34:14,848 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:14,848 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:14,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:14
2025-03-13 17:34:14,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:14,848 [INFO]: 	Creating the index 03/13/2025, 17:34:14
2025-03-13 17:34:14,848 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:14
2025-03-13 17:34:14,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:34:14,849 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:14
2025-03-13 17:34:14,849 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:34:14,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.90it/s] 20%|██        | 2/10 [00:00<00:01,  6.35it/s] 30%|███       | 3/10 [00:00<00:00,  7.13it/s] 40%|████      | 4/10 [00:00<00:00,  7.66it/s] 50%|█████     | 5/10 [00:00<00:00,  7.90it/s] 60%|██████    | 6/10 [00:00<00:00,  8.05it/s] 70%|███████   | 7/10 [00:00<00:00,  8.10it/s] 80%|████████  | 8/10 [00:01<00:00,  8.12it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.26it/s]100%|██████████| 10/10 [00:02<00:00,  1.64it/s]100%|██████████| 10/10 [00:02<00:00,  3.48it/s]
2025-03-13 17:34:17,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:17
2025-03-13 17:34:49,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8194 secs
2025-03-13 17:34:49,548 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 17:34:49,548 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 17:35:09,329 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7808 secs
2025-03-13 17:35:09,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4832 secs
2025-03-13 17:35:09,333 [INFO]: {
2025-03-13 17:35:09,333 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:09,333 [INFO]: 	index_param: efSearch=183
2025-03-13 17:35:09,333 [INFO]: 	index_path: knn.index
2025-03-13 17:35:09,333 [INFO]: 	size in bytes: 460183870
2025-03-13 17:35:09,333 [INFO]: 	avg_search_speed_ms: 9.435868082251751
2025-03-13 17:35:09,333 [INFO]: 	99p_search_speed_ms: 17.987281354144223
2025-03-13 17:35:09,333 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:09,333 [INFO]: 	nb vectors: 2339
2025-03-13 17:35:09,333 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:09,333 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 17:35:09,333 [INFO]: }
2025-03-13 17:35:09,333 [INFO]: 	>>> Finished "Creating the index" in 54.4850 secs
2025-03-13 17:35:09,333 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5132 secs
2025-03-13 17:35:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 55377 [episode count 1/20]
[retrieval_preprocessing] for episode 27223 [episode count 2/20], we have num_retrieval=np.int64(2386) num_query=np.int64(121)
2025-03-13 17:35:11,749 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:12,259 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:12
2025-03-13 17:35:12,259 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 690.19it/s]
2025-03-13 17:35:12,715 [INFO]: There are 2386 embeddings of dim 49152
2025-03-13 17:35:12,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4565 secs
2025-03-13 17:35:12,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:12
2025-03-13 17:35:12,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:12,716 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:35:12,716 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:12,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:35:12,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:12
2025-03-13 17:35:12,716 [INFO]: 492.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:12,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:35:12,716 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:12
2025-03-13 17:35:12,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:12,716 [INFO]: 	Creating the index 03/13/2025, 17:35:12
2025-03-13 17:35:12,717 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:12
2025-03-13 17:35:12,718 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 17:35:12,718 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:12
2025-03-13 17:35:12,719 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:35:12,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.54it/s] 30%|███       | 3/10 [00:00<00:00,  9.58it/s] 50%|█████     | 5/10 [00:00<00:00, 10.80it/s] 70%|███████   | 7/10 [00:00<00:00, 10.77it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.86it/s]100%|██████████| 10/10 [00:02<00:00,  3.46it/s]
2025-03-13 17:35:15,609 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:15
2025-03-13 17:35:50,062 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4522 secs
2025-03-13 17:35:50,062 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 17:35:50,062 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.31it/s] 50%|█████     | 2/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.53it/s]
2025-03-13 17:36:11,855 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7927 secs
2025-03-13 17:36:11,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1386 secs
2025-03-13 17:36:11,858 [INFO]: {
2025-03-13 17:36:11,858 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:11,858 [INFO]: 	index_param: efSearch=145
2025-03-13 17:36:11,858 [INFO]: 	index_path: knn.index
2025-03-13 17:36:11,858 [INFO]: 	size in bytes: 469430710
2025-03-13 17:36:11,858 [INFO]: 	avg_search_speed_ms: 7.637818707323955
2025-03-13 17:36:11,858 [INFO]: 	99p_search_speed_ms: 13.462259126827124
2025-03-13 17:36:11,858 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:11,858 [INFO]: 	nb vectors: 2386
2025-03-13 17:36:11,858 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:11,858 [INFO]: 	compression ratio: 0.9993097554269511
2025-03-13 17:36:11,858 [INFO]: }
2025-03-13 17:36:11,858 [INFO]: 	>>> Finished "Creating the index" in 59.1418 secs
2025-03-13 17:36:11,858 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5995 secs
2025-03-13 17:36:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 27223 [episode count 2/20]
[retrieval_preprocessing] for episode 24155 [episode count 3/20], we have num_retrieval=np.int64(2410) num_query=np.int64(97)
2025-03-13 17:36:13,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:15,341 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:15
2025-03-13 17:36:15,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.82it/s]
2025-03-13 17:36:15,369 [INFO]: There are 2410 embeddings of dim 49152
2025-03-13 17:36:15,369 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:36:15,369 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:15
2025-03-13 17:36:15,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:15,370 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:36:15,370 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:15,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:36:15,370 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:15
2025-03-13 17:36:15,370 [INFO]: 497.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:15,371 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:36:15,371 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:15
2025-03-13 17:36:15,371 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:15,371 [INFO]: 	Creating the index 03/13/2025, 17:36:15
2025-03-13 17:36:15,371 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:15
2025-03-13 17:36:15,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:36:15,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:15
2025-03-13 17:36:15,375 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:36:15,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.37it/s] 30%|███       | 3/10 [00:00<00:00,  9.01it/s] 50%|█████     | 5/10 [00:00<00:00,  9.80it/s] 70%|███████   | 7/10 [00:00<00:00, 10.04it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.69it/s]100%|██████████| 10/10 [00:02<00:00,  3.90it/s]
2025-03-13 17:36:17,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:17
2025-03-13 17:36:49,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1332 secs
2025-03-13 17:36:49,081 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:36:49,081 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 17:37:07,866 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7856 secs
2025-03-13 17:37:07,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4940 secs
2025-03-13 17:37:07,869 [INFO]: {
2025-03-13 17:37:07,869 [INFO]: 	index_key: HNSW15
2025-03-13 17:37:07,869 [INFO]: 	index_param: efSearch=185
2025-03-13 17:37:07,869 [INFO]: 	index_path: knn.index
2025-03-13 17:37:07,869 [INFO]: 	size in bytes: 474152590
2025-03-13 17:37:07,869 [INFO]: 	avg_search_speed_ms: 9.369453008311968
2025-03-13 17:37:07,869 [INFO]: 	99p_search_speed_ms: 13.292312882840632
2025-03-13 17:37:07,869 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:37:07,869 [INFO]: 	nb vectors: 2410
2025-03-13 17:37:07,869 [INFO]: 	vectors dimension: 49152
2025-03-13 17:37:07,869 [INFO]: 	compression ratio: 0.9993096947967742
2025-03-13 17:37:07,869 [INFO]: }
2025-03-13 17:37:07,869 [INFO]: 	>>> Finished "Creating the index" in 52.4974 secs
2025-03-13 17:37:07,869 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5273 secs
2025-03-13 17:37:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:37:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 24155 [episode count 3/20]
[retrieval_preprocessing] for episode 29310 [episode count 4/20], we have num_retrieval=np.int64(2400) num_query=np.int64(107)
2025-03-13 17:37:09,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:10,135 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:10
2025-03-13 17:37:10,135 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1889.33it/s]
2025-03-13 17:37:10,162 [INFO]: There are 2400 embeddings of dim 49152
2025-03-13 17:37:10,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:37:10,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:10
2025-03-13 17:37:10,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:10,163 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:37:10,164 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:37:10,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:37:10,164 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:10
2025-03-13 17:37:10,164 [INFO]: 495.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:10,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:37:10,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:10
2025-03-13 17:37:10,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:10,165 [INFO]: 	Creating the index 03/13/2025, 17:37:10
2025-03-13 17:37:10,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:37:10
2025-03-13 17:37:10,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:37:10,168 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:10
2025-03-13 17:37:10,168 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:37:10,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.24it/s] 30%|███       | 3/10 [00:00<00:00,  9.47it/s] 50%|█████     | 5/10 [00:00<00:00, 11.72it/s] 70%|███████   | 7/10 [00:00<00:00, 13.18it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.19it/s]100%|██████████| 10/10 [00:02<00:00,  3.84it/s]
2025-03-13 17:37:13,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:13
2025-03-13 17:37:46,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5147 secs
2025-03-13 17:37:46,547 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:37:46,547 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.99it/s]
2025-03-13 17:38:11,332 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7853 secs
2025-03-13 17:38:11,762 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5942 secs
2025-03-13 17:38:11,763 [INFO]: {
2025-03-13 17:38:11,763 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:11,763 [INFO]: 	index_param: efSearch=195
2025-03-13 17:38:11,763 [INFO]: 	index_path: knn.index
2025-03-13 17:38:11,763 [INFO]: 	size in bytes: 472185130
2025-03-13 17:38:11,763 [INFO]: 	avg_search_speed_ms: 9.414798453171333
2025-03-13 17:38:11,763 [INFO]: 	99p_search_speed_ms: 16.844197690952587
2025-03-13 17:38:11,763 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:11,763 [INFO]: 	nb vectors: 2400
2025-03-13 17:38:11,763 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:11,763 [INFO]: 	compression ratio: 0.9993097410754972
2025-03-13 17:38:11,763 [INFO]: }
2025-03-13 17:38:11,764 [INFO]: 	>>> Finished "Creating the index" in 61.5986 secs
2025-03-13 17:38:11,764 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6281 secs
2025-03-13 17:38:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 29310 [episode count 4/20]
[retrieval_preprocessing] for episode 36539 [episode count 5/20], we have num_retrieval=np.int64(2370) num_query=np.int64(137)
2025-03-13 17:38:13,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:14,311 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:14
2025-03-13 17:38:14,312 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.00it/s]
2025-03-13 17:38:14,339 [INFO]: There are 2370 embeddings of dim 49152
2025-03-13 17:38:14,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:38:14,340 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,340 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:14,340 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:38:14,340 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:14,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:38:14,340 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,341 [INFO]: 489.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:14,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:38:14,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:14
2025-03-13 17:38:14,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:14,341 [INFO]: 	Creating the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:14
2025-03-13 17:38:14,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:38:14,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:14
2025-03-13 17:38:14,345 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:38:14,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.16it/s] 30%|███       | 3/10 [00:00<00:00, 13.37it/s] 50%|█████     | 5/10 [00:00<00:00, 13.69it/s] 70%|███████   | 7/10 [00:00<00:00, 12.78it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.43it/s]100%|██████████| 10/10 [00:03<00:00,  3.19it/s]
2025-03-13 17:38:17,484 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:17
2025-03-13 17:38:43,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9975 secs
2025-03-13 17:38:43,482 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:38:43,482 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 17:39:05,875 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3930 secs
2025-03-13 17:39:05,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5328 secs
2025-03-13 17:39:05,878 [INFO]: {
2025-03-13 17:39:05,878 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:05,878 [INFO]: 	index_param: efSearch=200
2025-03-13 17:39:05,878 [INFO]: 	index_path: knn.index
2025-03-13 17:39:05,878 [INFO]: 	size in bytes: 466282870
2025-03-13 17:39:05,878 [INFO]: 	avg_search_speed_ms: 9.730723983216814
2025-03-13 17:39:05,878 [INFO]: 	99p_search_speed_ms: 15.19675033167005
2025-03-13 17:39:05,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:05,878 [INFO]: 	nb vectors: 2370
2025-03-13 17:39:05,878 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:05,878 [INFO]: 	compression ratio: 0.9993096250780132
2025-03-13 17:39:05,878 [INFO]: }
2025-03-13 17:39:05,878 [INFO]: 	>>> Finished "Creating the index" in 51.5367 secs
2025-03-13 17:39:05,878 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5663 secs
2025-03-13 17:39:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 36539 [episode count 5/20]
[retrieval_preprocessing] for episode 6352 [episode count 6/20], we have num_retrieval=np.int64(2349) num_query=np.int64(158)
2025-03-13 17:39:07,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:08,441 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:08
2025-03-13 17:39:08,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.89it/s]
2025-03-13 17:39:08,469 [INFO]: There are 2349 embeddings of dim 49152
2025-03-13 17:39:08,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:39:08,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:08
2025-03-13 17:39:08,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:08,470 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:39:08,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:08,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:39:08,471 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:08
2025-03-13 17:39:08,471 [INFO]: 484.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:08,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:39:08,472 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:08
2025-03-13 17:39:08,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:08,472 [INFO]: 	Creating the index 03/13/2025, 17:39:08
2025-03-13 17:39:08,472 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:08
2025-03-13 17:39:08,475 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:39:08,475 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:08
2025-03-13 17:39:08,475 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:39:08,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.06it/s] 30%|███       | 3/10 [00:00<00:00,  9.12it/s] 50%|█████     | 5/10 [00:00<00:00, 10.18it/s] 70%|███████   | 7/10 [00:00<00:00, 11.33it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.11it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]
2025-03-13 17:39:10,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:10
2025-03-13 17:39:42,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8623 secs
2025-03-13 17:39:42,787 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:39:42,787 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.50it/s] 50%|█████     | 2/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.68it/s]
2025-03-13 17:40:12,425 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6383 secs
2025-03-13 17:40:12,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9520 secs
2025-03-13 17:40:12,427 [INFO]: {
2025-03-13 17:40:12,427 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:12,427 [INFO]: 	index_param: efSearch=209
2025-03-13 17:40:12,428 [INFO]: 	index_path: knn.index
2025-03-13 17:40:12,428 [INFO]: 	size in bytes: 462151270
2025-03-13 17:40:12,428 [INFO]: 	avg_search_speed_ms: 10.395812082468394
2025-03-13 17:40:12,428 [INFO]: 	99p_search_speed_ms: 20.45988472178577
2025-03-13 17:40:12,428 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:12,428 [INFO]: 	nb vectors: 2349
2025-03-13 17:40:12,428 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:12,428 [INFO]: 	compression ratio: 0.9993095810382605
2025-03-13 17:40:12,428 [INFO]: }
2025-03-13 17:40:12,428 [INFO]: 	>>> Finished "Creating the index" in 63.9556 secs
2025-03-13 17:40:12,428 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9861 secs
2025-03-13 17:40:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 6352 [episode count 6/20]
[retrieval_preprocessing] for episode 51970 [episode count 7/20], we have num_retrieval=np.int64(2334) num_query=np.int64(173)
2025-03-13 17:40:15,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:15,717 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:15
2025-03-13 17:40:15,717 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 783.25it/s]
2025-03-13 17:40:15,749 [INFO]: There are 2334 embeddings of dim 49152
2025-03-13 17:40:15,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 17:40:15,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:15
2025-03-13 17:40:15,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:15,750 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:40:15,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:15,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:40:15,751 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:15
2025-03-13 17:40:15,751 [INFO]: 481.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:15,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:40:15,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:15
2025-03-13 17:40:15,752 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:15,752 [INFO]: 	Creating the index 03/13/2025, 17:40:15
2025-03-13 17:40:15,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:15
2025-03-13 17:40:15,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:40:15,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:15
2025-03-13 17:40:15,756 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:40:15,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.88it/s] 20%|██        | 2/10 [00:00<00:01,  6.66it/s] 30%|███       | 3/10 [00:00<00:00,  7.44it/s] 40%|████      | 4/10 [00:00<00:00,  7.88it/s] 50%|█████     | 5/10 [00:00<00:00,  8.00it/s] 60%|██████    | 6/10 [00:00<00:00,  8.31it/s] 70%|███████   | 7/10 [00:00<00:00,  8.50it/s] 80%|████████  | 8/10 [00:01<00:00,  8.73it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.87it/s]100%|██████████| 10/10 [00:02<00:00,  1.76it/s]100%|██████████| 10/10 [00:02<00:00,  3.70it/s]
2025-03-13 17:40:18,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:18
2025-03-13 17:40:47,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7377 secs
2025-03-13 17:40:47,199 [INFO]: The best hyperparameters are: efSearch=100
2025-03-13 17:40:47,199 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-13 17:41:07,022 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8230 secs
2025-03-13 17:41:07,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2690 secs
2025-03-13 17:41:07,025 [INFO]: {
2025-03-13 17:41:07,025 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:07,025 [INFO]: 	index_param: efSearch=100
2025-03-13 17:41:07,025 [INFO]: 	index_path: knn.index
2025-03-13 17:41:07,025 [INFO]: 	size in bytes: 459200170
2025-03-13 17:41:07,025 [INFO]: 	avg_search_speed_ms: 6.175796562783899
2025-03-13 17:41:07,025 [INFO]: 	99p_search_speed_ms: 10.551370440516619
2025-03-13 17:41:07,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:07,025 [INFO]: 	nb vectors: 2334
2025-03-13 17:41:07,025 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:07,025 [INFO]: 	compression ratio: 0.9993094558305586
2025-03-13 17:41:07,025 [INFO]: }
2025-03-13 17:41:07,025 [INFO]: 	>>> Finished "Creating the index" in 51.2732 secs
2025-03-13 17:41:07,025 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3078 secs
2025-03-13 17:41:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 51970 [episode count 7/20]
[retrieval_preprocessing] for episode 8457 [episode count 8/20], we have num_retrieval=np.int64(2339) num_query=np.int64(168)
2025-03-13 17:41:08,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:09,264 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:09
2025-03-13 17:41:09,264 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.22it/s]
2025-03-13 17:41:09,290 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 17:41:09,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:41:09,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:09
2025-03-13 17:41:09,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:09,290 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:41:09,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:09,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:09,290 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:09
2025-03-13 17:41:09,290 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:09,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:41:09,290 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:09
2025-03-13 17:41:09,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:09,290 [INFO]: 	Creating the index 03/13/2025, 17:41:09
2025-03-13 17:41:09,290 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:09
2025-03-13 17:41:09,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:41:09,291 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:09
2025-03-13 17:41:09,292 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:41:09,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.52it/s] 30%|███       | 3/10 [00:00<00:00, 10.89it/s] 50%|█████     | 5/10 [00:00<00:00, 11.45it/s] 70%|███████   | 7/10 [00:00<00:00, 10.72it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.38it/s]100%|██████████| 10/10 [00:02<00:00,  3.88it/s]
2025-03-13 17:41:11,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:11
2025-03-13 17:41:44,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7515 secs
2025-03-13 17:41:44,622 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:41:44,622 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-13 17:42:03,008 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3855 secs
2025-03-13 17:42:03,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7189 secs
2025-03-13 17:42:03,011 [INFO]: {
2025-03-13 17:42:03,011 [INFO]: 	index_key: HNSW15
2025-03-13 17:42:03,011 [INFO]: 	index_param: efSearch=194
2025-03-13 17:42:03,011 [INFO]: 	index_path: knn.index
2025-03-13 17:42:03,011 [INFO]: 	size in bytes: 460183870
2025-03-13 17:42:03,011 [INFO]: 	avg_search_speed_ms: 10.482931437617093
2025-03-13 17:42:03,011 [INFO]: 	99p_search_speed_ms: 22.03606479102748
2025-03-13 17:42:03,011 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:42:03,011 [INFO]: 	nb vectors: 2339
2025-03-13 17:42:03,011 [INFO]: 	vectors dimension: 49152
2025-03-13 17:42:03,011 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 17:42:03,011 [INFO]: }
2025-03-13 17:42:03,011 [INFO]: 	>>> Finished "Creating the index" in 53.7204 secs
2025-03-13 17:42:03,011 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7466 secs
2025-03-13 17:42:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:42:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 8457 [episode count 8/20]
[retrieval_preprocessing] for episode 26418 [episode count 9/20], we have num_retrieval=np.int64(2385) num_query=np.int64(122)
2025-03-13 17:42:04,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:42:05,305 [INFO]: Launching the whole pipeline 03/13/2025, 17:42:05
2025-03-13 17:42:05,305 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:42:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1490.51it/s]
2025-03-13 17:42:05,338 [INFO]: There are 2385 embeddings of dim 49152
2025-03-13 17:42:05,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 17:42:05,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:42:05
2025-03-13 17:42:05,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:42:05,339 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:42:05,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:42:05,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:42:05,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:42:05
2025-03-13 17:42:05,340 [INFO]: 492.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:42:05,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:42:05,340 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:42:05
2025-03-13 17:42:05,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:42:05,340 [INFO]: 	Creating the index 03/13/2025, 17:42:05
2025-03-13 17:42:05,340 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:42:05
2025-03-13 17:42:05,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:42:05,343 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:42:05
2025-03-13 17:42:05,343 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:42:05,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.32it/s] 30%|███       | 3/10 [00:00<00:00,  9.20it/s] 50%|█████     | 5/10 [00:00<00:00, 10.52it/s] 70%|███████   | 7/10 [00:00<00:00, 11.39it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.92it/s]100%|██████████| 10/10 [00:02<00:00,  3.89it/s]
2025-03-13 17:42:07,921 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:07
2025-03-13 17:42:36,377 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4557 secs
2025-03-13 17:42:36,378 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 17:42:36,378 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 17:43:01,813 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4351 secs
2025-03-13 17:43:01,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4725 secs
2025-03-13 17:43:01,816 [INFO]: {
2025-03-13 17:43:01,816 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:01,816 [INFO]: 	index_param: efSearch=214
2025-03-13 17:43:01,816 [INFO]: 	index_path: knn.index
2025-03-13 17:43:01,816 [INFO]: 	size in bytes: 469233970
2025-03-13 17:43:01,816 [INFO]: 	avg_search_speed_ms: 10.262733459466919
2025-03-13 17:43:01,816 [INFO]: 	99p_search_speed_ms: 18.171400383580465
2025-03-13 17:43:01,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:01,816 [INFO]: 	nb vectors: 2385
2025-03-13 17:43:01,816 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:01,816 [INFO]: 	compression ratio: 0.9993097473313792
2025-03-13 17:43:01,816 [INFO]: }
2025-03-13 17:43:01,816 [INFO]: 	>>> Finished "Creating the index" in 56.4759 secs
2025-03-13 17:43:01,816 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5114 secs
2025-03-13 17:43:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 26418 [episode count 9/20]
[retrieval_preprocessing] for episode 8524 [episode count 10/20], we have num_retrieval=np.int64(2435) num_query=np.int64(72)
2025-03-13 17:43:03,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:04,094 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:04
2025-03-13 17:43:04,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.56it/s]
2025-03-13 17:43:04,120 [INFO]: There are 2435 embeddings of dim 49152
2025-03-13 17:43:04,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:43:04,120 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:04
2025-03-13 17:43:04,120 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:04,120 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:43:04,120 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:04,120 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:04,120 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:04
2025-03-13 17:43:04,120 [INFO]: 502.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:04,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:43:04,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:04
2025-03-13 17:43:04,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:04,121 [INFO]: 	Creating the index 03/13/2025, 17:43:04
2025-03-13 17:43:04,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:04
2025-03-13 17:43:04,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 17:43:04,122 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:04
2025-03-13 17:43:04,123 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:43:04,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.02it/s] 30%|███       | 3/10 [00:00<00:00, 10.56it/s] 50%|█████     | 5/10 [00:00<00:00, 11.89it/s] 70%|███████   | 7/10 [00:00<00:00, 12.32it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.40it/s]100%|██████████| 10/10 [00:03<00:00,  3.17it/s]
2025-03-13 17:43:07,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:07
2025-03-13 17:43:41,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9322 secs
2025-03-13 17:43:41,210 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:43:41,210 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.32it/s]
2025-03-13 17:44:05,617 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4070 secs
2025-03-13 17:44:05,619 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4966 secs
2025-03-13 17:44:05,619 [INFO]: {
2025-03-13 17:44:05,619 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:05,619 [INFO]: 	index_param: efSearch=194
2025-03-13 17:44:05,619 [INFO]: 	index_path: knn.index
2025-03-13 17:44:05,619 [INFO]: 	size in bytes: 479071090
2025-03-13 17:44:05,619 [INFO]: 	avg_search_speed_ms: 7.441929888087016
2025-03-13 17:44:05,619 [INFO]: 	99p_search_speed_ms: 10.271814307197923
2025-03-13 17:44:05,619 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:05,619 [INFO]: 	nb vectors: 2435
2025-03-13 17:44:05,619 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:05,619 [INFO]: 	compression ratio: 0.9993098936527354
2025-03-13 17:44:05,619 [INFO]: }
2025-03-13 17:44:05,619 [INFO]: 	>>> Finished "Creating the index" in 61.4988 secs
2025-03-13 17:44:05,619 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5252 secs
2025-03-13 17:44:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 8524 [episode count 10/20]
[retrieval_preprocessing] for episode 19295 [episode count 11/20], we have num_retrieval=np.int64(2307) num_query=np.int64(200)
2025-03-13 17:44:12,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:12,612 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:12
2025-03-13 17:44:12,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2258.65it/s]
2025-03-13 17:44:12,639 [INFO]: There are 2307 embeddings of dim 49152
2025-03-13 17:44:12,639 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:44:12,639 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:12
2025-03-13 17:44:12,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:12,640 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:44:12,640 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:12,640 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:44:12,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:12
2025-03-13 17:44:12,641 [INFO]: 476.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:12,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:44:12,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:12
2025-03-13 17:44:12,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:12,642 [INFO]: 	Creating the index 03/13/2025, 17:44:12
2025-03-13 17:44:12,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:12
2025-03-13 17:44:12,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:44:12,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:12
2025-03-13 17:44:12,646 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:44:12,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:07,  1.16it/s] 30%|███       | 3/10 [00:01<00:02,  3.39it/s] 50%|█████     | 5/10 [00:01<00:00,  5.13it/s] 60%|██████    | 6/10 [00:01<00:00,  5.32it/s] 70%|███████   | 7/10 [00:03<00:02,  1.45it/s] 80%|████████  | 8/10 [00:03<00:01,  1.81it/s] 90%|█████████ | 9/10 [00:03<00:00,  2.06it/s]100%|██████████| 10/10 [00:05<00:00,  1.26it/s]100%|██████████| 10/10 [00:05<00:00,  1.82it/s]
2025-03-13 17:44:18,145 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:18
2025-03-13 17:44:44,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3994 secs
2025-03-13 17:44:44,545 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 17:44:44,545 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 17:45:01,113 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5677 secs
2025-03-13 17:45:01,116 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4697 secs
2025-03-13 17:45:01,116 [INFO]: {
2025-03-13 17:45:01,116 [INFO]: 	index_key: HNSW15
2025-03-13 17:45:01,116 [INFO]: 	index_param: efSearch=155
2025-03-13 17:45:01,116 [INFO]: 	index_path: knn.index
2025-03-13 17:45:01,116 [INFO]: 	size in bytes: 453888070
2025-03-13 17:45:01,116 [INFO]: 	avg_search_speed_ms: 8.765625423367325
2025-03-13 17:45:01,116 [INFO]: 	99p_search_speed_ms: 13.337599113583563
2025-03-13 17:45:01,116 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:45:01,116 [INFO]: 	nb vectors: 2307
2025-03-13 17:45:01,116 [INFO]: 	vectors dimension: 49152
2025-03-13 17:45:01,116 [INFO]: 	compression ratio: 0.999309490553475
2025-03-13 17:45:01,116 [INFO]: }
2025-03-13 17:45:01,116 [INFO]: 	>>> Finished "Creating the index" in 48.4741 secs
2025-03-13 17:45:01,116 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5047 secs
2025-03-13 17:45:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:45:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 19295 [episode count 11/20]
[retrieval_preprocessing] for episode 47458 [episode count 12/20], we have num_retrieval=np.int64(2366) num_query=np.int64(141)
2025-03-13 17:45:04,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:45:05,479 [INFO]: Launching the whole pipeline 03/13/2025, 17:45:05
2025-03-13 17:45:05,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:45:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1662.43it/s]
2025-03-13 17:45:05,509 [INFO]: There are 2366 embeddings of dim 49152
2025-03-13 17:45:05,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:45:05,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:45:05
2025-03-13 17:45:05,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:45:05,510 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:45:05,511 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:45:05,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:45:05,511 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:45:05
2025-03-13 17:45:05,511 [INFO]: 488.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:45:05,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:45:05,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:45:05
2025-03-13 17:45:05,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:45:05,512 [INFO]: 	Creating the index 03/13/2025, 17:45:05
2025-03-13 17:45:05,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:45:05
2025-03-13 17:45:05,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:45:05,515 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:45:05
2025-03-13 17:45:05,515 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:45:05,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.10it/s] 20%|██        | 2/10 [00:00<00:01,  6.75it/s] 30%|███       | 3/10 [00:00<00:00,  7.40it/s] 40%|████      | 4/10 [00:00<00:00,  7.73it/s] 50%|█████     | 5/10 [00:00<00:00,  7.92it/s] 60%|██████    | 6/10 [00:00<00:00,  8.03it/s] 70%|███████   | 7/10 [00:00<00:00,  8.13it/s] 80%|████████  | 8/10 [00:01<00:00,  8.31it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.33it/s]100%|██████████| 10/10 [00:03<00:00,  1.30it/s]100%|██████████| 10/10 [00:03<00:00,  2.97it/s]
2025-03-13 17:45:08,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:08
2025-03-13 17:45:44,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4496 secs
2025-03-13 17:45:44,338 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 17:45:44,338 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-13 17:46:05,681 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3427 secs
2025-03-13 17:46:05,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1676 secs
2025-03-13 17:46:05,683 [INFO]: {
2025-03-13 17:46:05,683 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:05,683 [INFO]: 	index_param: efSearch=224
2025-03-13 17:46:05,683 [INFO]: 	index_path: knn.index
2025-03-13 17:46:05,683 [INFO]: 	size in bytes: 465495910
2025-03-13 17:46:05,683 [INFO]: 	avg_search_speed_ms: 10.799397848954838
2025-03-13 17:46:05,683 [INFO]: 	99p_search_speed_ms: 18.78266694257036
2025-03-13 17:46:05,683 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:05,683 [INFO]: 	nb vectors: 2366
2025-03-13 17:46:05,683 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:05,683 [INFO]: 	compression ratio: 0.9993095922153215
2025-03-13 17:46:05,683 [INFO]: }
2025-03-13 17:46:05,683 [INFO]: 	>>> Finished "Creating the index" in 60.1708 secs
2025-03-13 17:46:05,683 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2034 secs
2025-03-13 17:46:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 47458 [episode count 12/20]
[retrieval_preprocessing] for episode 29540 [episode count 13/20], we have num_retrieval=np.int64(2384) num_query=np.int64(123)
2025-03-13 17:46:10,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:10,693 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:10
2025-03-13 17:46:10,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.60it/s]
2025-03-13 17:46:10,720 [INFO]: There are 2384 embeddings of dim 49152
2025-03-13 17:46:10,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:46:10,721 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:10
2025-03-13 17:46:10,721 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:10,721 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:46:10,721 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:10,721 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:10,721 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:10
2025-03-13 17:46:10,721 [INFO]: 492.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:10,721 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:46:10,721 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:10
2025-03-13 17:46:10,721 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:10,721 [INFO]: 	Creating the index 03/13/2025, 17:46:10
2025-03-13 17:46:10,721 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:10
2025-03-13 17:46:10,722 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:46:10,722 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:10
2025-03-13 17:46:10,723 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:46:10,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.28it/s] 20%|██        | 2/10 [00:00<00:01,  6.55it/s] 30%|███       | 3/10 [00:00<00:00,  7.12it/s] 40%|████      | 4/10 [00:00<00:00,  7.39it/s] 50%|█████     | 5/10 [00:00<00:00,  7.56it/s] 60%|██████    | 6/10 [00:00<00:00,  7.77it/s] 70%|███████   | 7/10 [00:00<00:00,  7.81it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.82it/s]100%|██████████| 10/10 [00:02<00:00,  1.95it/s]100%|██████████| 10/10 [00:02<00:00,  3.55it/s]
2025-03-13 17:46:13,540 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:13
2025-03-13 17:46:42,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1607 secs
2025-03-13 17:46:42,702 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 17:46:42,702 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 17:47:07,450 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7484 secs
2025-03-13 17:47:07,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7301 secs
2025-03-13 17:47:07,453 [INFO]: {
2025-03-13 17:47:07,453 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:07,453 [INFO]: 	index_param: efSearch=216
2025-03-13 17:47:07,453 [INFO]: 	index_path: knn.index
2025-03-13 17:47:07,453 [INFO]: 	size in bytes: 469037230
2025-03-13 17:47:07,453 [INFO]: 	avg_search_speed_ms: 9.154409359099322
2025-03-13 17:47:07,453 [INFO]: 	99p_search_speed_ms: 13.45131798647344
2025-03-13 17:47:07,453 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:07,453 [INFO]: 	nb vectors: 2384
2025-03-13 17:47:07,453 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:07,453 [INFO]: 	compression ratio: 0.999309739229016
2025-03-13 17:47:07,453 [INFO]: }
2025-03-13 17:47:07,453 [INFO]: 	>>> Finished "Creating the index" in 56.7318 secs
2025-03-13 17:47:07,453 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7604 secs
2025-03-13 17:47:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 29540 [episode count 13/20]
[retrieval_preprocessing] for episode 39788 [episode count 14/20], we have num_retrieval=np.int64(2356) num_query=np.int64(151)
2025-03-13 17:47:09,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:10,057 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:10
2025-03-13 17:47:10,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1369.79it/s]
2025-03-13 17:47:10,080 [INFO]: There are 2356 embeddings of dim 49152
2025-03-13 17:47:10,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 17:47:10,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:10,081 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:47:10,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:10,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:47:10,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,081 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:10,081 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:47:10,081 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:10
2025-03-13 17:47:10,081 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:10,081 [INFO]: 	Creating the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,081 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:10
2025-03-13 17:47:10,082 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:47:10,082 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:10
2025-03-13 17:47:10,082 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:47:10,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.98it/s] 20%|██        | 2/10 [00:00<00:01,  7.64it/s] 40%|████      | 4/10 [00:00<00:00,  9.31it/s] 60%|██████    | 6/10 [00:00<00:00, 10.29it/s] 80%|████████  | 8/10 [00:00<00:00, 10.66it/s]100%|██████████| 10/10 [00:02<00:00,  2.51it/s]100%|██████████| 10/10 [00:02<00:00,  3.75it/s]
2025-03-13 17:47:12,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:12
2025-03-13 17:47:42,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8966 secs
2025-03-13 17:47:42,649 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 17:47:42,649 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 17:48:15,765 [INFO]: 	>>> Finished "Compute fast metrics" in 33.1153 secs
2025-03-13 17:48:15,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6856 secs
2025-03-13 17:48:15,768 [INFO]: {
2025-03-13 17:48:15,768 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:15,768 [INFO]: 	index_param: efSearch=222
2025-03-13 17:48:15,768 [INFO]: 	index_path: knn.index
2025-03-13 17:48:15,768 [INFO]: 	size in bytes: 463528450
2025-03-13 17:48:15,768 [INFO]: 	avg_search_speed_ms: 9.008073299359697
2025-03-13 17:48:15,768 [INFO]: 	99p_search_speed_ms: 13.125065076164947
2025-03-13 17:48:15,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:15,768 [INFO]: 	nb vectors: 2356
2025-03-13 17:48:15,768 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:15,768 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-13 17:48:15,768 [INFO]: }
2025-03-13 17:48:15,768 [INFO]: 	>>> Finished "Creating the index" in 65.6870 secs
2025-03-13 17:48:15,768 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7114 secs
2025-03-13 17:48:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 39788 [episode count 14/20]
[retrieval_preprocessing] for episode 84406 [episode count 15/20], we have num_retrieval=np.int64(2395) num_query=np.int64(112)
2025-03-13 17:48:18,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:18,526 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:18
2025-03-13 17:48:18,527 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 17:48:18,553 [INFO]: There are 2395 embeddings of dim 49152
2025-03-13 17:48:18,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 17:48:18,554 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:18
2025-03-13 17:48:18,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:18,554 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:48:18,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:18,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0012 secs
2025-03-13 17:48:18,555 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:18
2025-03-13 17:48:18,556 [INFO]: 494.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:18,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:48:18,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:18
2025-03-13 17:48:18,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:18,556 [INFO]: 	Creating the index 03/13/2025, 17:48:18
2025-03-13 17:48:18,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:18
2025-03-13 17:48:18,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:48:18,558 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:18
2025-03-13 17:48:18,558 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:48:18,559 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.63it/s] 30%|███       | 3/10 [00:00<00:00,  8.91it/s] 50%|█████     | 5/10 [00:00<00:00,  9.82it/s] 70%|███████   | 7/10 [00:00<00:00, 10.10it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.34it/s]100%|██████████| 10/10 [00:02<00:00,  3.83it/s]
2025-03-13 17:48:21,173 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:21
2025-03-13 17:48:50,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3107 secs
2025-03-13 17:48:50,484 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 17:48:50,484 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.58it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-13 17:49:09,075 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5905 secs
2025-03-13 17:49:09,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5190 secs
2025-03-13 17:49:09,078 [INFO]: {
2025-03-13 17:49:09,078 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:09,078 [INFO]: 	index_param: efSearch=208
2025-03-13 17:49:09,078 [INFO]: 	index_path: knn.index
2025-03-13 17:49:09,078 [INFO]: 	size in bytes: 471201370
2025-03-13 17:49:09,078 [INFO]: 	avg_search_speed_ms: 10.957090387596194
2025-03-13 17:49:09,078 [INFO]: 	99p_search_speed_ms: 14.57481661811471
2025-03-13 17:49:09,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:09,078 [INFO]: 	nb vectors: 2395
2025-03-13 17:49:09,078 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:09,078 [INFO]: 	compression ratio: 0.9993098279828855
2025-03-13 17:49:09,078 [INFO]: }
2025-03-13 17:49:09,078 [INFO]: 	>>> Finished "Creating the index" in 50.5216 secs
2025-03-13 17:49:09,078 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5512 secs
2025-03-13 17:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 84406 [episode count 15/20]
[retrieval_preprocessing] for episode 1430 [episode count 16/20], we have num_retrieval=np.int64(2391) num_query=np.int64(116)
2025-03-13 17:49:11,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:11,761 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:11
2025-03-13 17:49:11,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.23it/s]
2025-03-13 17:49:11,789 [INFO]: There are 2391 embeddings of dim 49152
2025-03-13 17:49:11,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 17:49:11,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:11
2025-03-13 17:49:11,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:11,790 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:49:11,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:11,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:49:11,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:11
2025-03-13 17:49:11,790 [INFO]: 493.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:11,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:49:11,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:11
2025-03-13 17:49:11,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:11,790 [INFO]: 	Creating the index 03/13/2025, 17:49:11
2025-03-13 17:49:11,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:11
2025-03-13 17:49:11,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:49:11,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:11
2025-03-13 17:49:11,792 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:49:11,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.59it/s] 20%|██        | 2/10 [00:00<00:01,  5.99it/s] 30%|███       | 3/10 [00:00<00:01,  6.65it/s] 40%|████      | 4/10 [00:00<00:00,  7.02it/s] 50%|█████     | 5/10 [00:00<00:00,  7.32it/s] 60%|██████    | 6/10 [00:00<00:00,  7.43it/s] 70%|███████   | 7/10 [00:00<00:00,  7.49it/s] 80%|████████  | 8/10 [00:01<00:00,  7.56it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.59it/s]100%|██████████| 10/10 [00:03<00:00,  1.20it/s]100%|██████████| 10/10 [00:03<00:00,  2.72it/s]
2025-03-13 17:49:15,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:15
2025-03-13 17:49:46,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5507 secs
2025-03-13 17:49:46,018 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:49:46,018 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 17:50:17,243 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2255 secs
2025-03-13 17:50:17,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4539 secs
2025-03-13 17:50:17,246 [INFO]: {
2025-03-13 17:50:17,246 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:17,246 [INFO]: 	index_param: efSearch=200
2025-03-13 17:50:17,246 [INFO]: 	index_path: knn.index
2025-03-13 17:50:17,246 [INFO]: 	size in bytes: 470414410
2025-03-13 17:50:17,246 [INFO]: 	avg_search_speed_ms: 9.474644444935835
2025-03-13 17:50:17,246 [INFO]: 	99p_search_speed_ms: 18.121207668446036
2025-03-13 17:50:17,246 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:17,246 [INFO]: 	nb vectors: 2391
2025-03-13 17:50:17,246 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:17,246 [INFO]: 	compression ratio: 0.9993097958032365
2025-03-13 17:50:17,246 [INFO]: }
2025-03-13 17:50:17,246 [INFO]: 	>>> Finished "Creating the index" in 65.4555 secs
2025-03-13 17:50:17,246 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4846 secs
2025-03-13 17:50:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 1430 [episode count 16/20]
[retrieval_preprocessing] for episode 61923 [episode count 17/20], we have num_retrieval=np.int64(2440) num_query=np.int64(67)
2025-03-13 17:50:20,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:21,291 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:21
2025-03-13 17:50:21,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.29it/s]
2025-03-13 17:50:21,317 [INFO]: There are 2440 embeddings of dim 49152
2025-03-13 17:50:21,317 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:50:21,317 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,317 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:21,317 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:50:21,317 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:21,317 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:21,317 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,317 [INFO]: 503.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:21,318 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:50:21,318 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:21
2025-03-13 17:50:21,318 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:21,318 [INFO]: 	Creating the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:21
2025-03-13 17:50:21,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:50:21,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:21
2025-03-13 17:50:21,319 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:50:21,319 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.20it/s] 30%|███       | 3/10 [00:00<00:00,  9.02it/s] 50%|█████     | 5/10 [00:00<00:00, 10.02it/s] 70%|███████   | 7/10 [00:00<00:00, 10.38it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.69it/s]100%|██████████| 10/10 [00:03<00:00,  3.31it/s]
2025-03-13 17:50:24,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:24
2025-03-13 17:50:53,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6896 secs
2025-03-13 17:50:53,038 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 17:50:53,038 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 17:51:14,296 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2579 secs
2025-03-13 17:51:14,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9789 secs
2025-03-13 17:51:14,298 [INFO]: {
2025-03-13 17:51:14,298 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:14,298 [INFO]: 	index_param: efSearch=161
2025-03-13 17:51:14,298 [INFO]: 	index_path: knn.index
2025-03-13 17:51:14,298 [INFO]: 	size in bytes: 480054790
2025-03-13 17:51:14,298 [INFO]: 	avg_search_speed_ms: 7.941764009512837
2025-03-13 17:51:14,298 [INFO]: 	99p_search_speed_ms: 11.988655878230933
2025-03-13 17:51:14,298 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:14,298 [INFO]: 	nb vectors: 2440
2025-03-13 17:51:14,298 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:14,298 [INFO]: 	compression ratio: 0.9993099329349469
2025-03-13 17:51:14,298 [INFO]: }
2025-03-13 17:51:14,298 [INFO]: 	>>> Finished "Creating the index" in 52.9807 secs
2025-03-13 17:51:14,298 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0076 secs
2025-03-13 17:51:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:51:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 61923 [episode count 17/20]
[retrieval_preprocessing] for episode 75764 [episode count 18/20], we have num_retrieval=np.int64(2426) num_query=np.int64(81)
2025-03-13 17:51:15,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:51:15,949 [INFO]: Launching the whole pipeline 03/13/2025, 17:51:15
2025-03-13 17:51:15,949 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:51:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1611.33it/s]
2025-03-13 17:51:15,971 [INFO]: There are 2426 embeddings of dim 49152
2025-03-13 17:51:15,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 17:51:15,972 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:51:15,972 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:51:15,972 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:51:15,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:51:15,972 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,972 [INFO]: 500.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:51:15,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:51:15,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:51:15
2025-03-13 17:51:15,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:51:15,972 [INFO]: 	Creating the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:51:15
2025-03-13 17:51:15,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:51:15,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:51:15
2025-03-13 17:51:15,973 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:51:15,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.74it/s] 30%|███       | 3/10 [00:00<00:00,  8.89it/s] 50%|█████     | 5/10 [00:00<00:00,  9.53it/s] 70%|███████   | 7/10 [00:00<00:00,  9.57it/s] 80%|████████  | 8/10 [00:00<00:00,  9.44it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.50it/s]100%|██████████| 10/10 [00:03<00:00,  1.52it/s]100%|██████████| 10/10 [00:03<00:00,  3.13it/s]
2025-03-13 17:51:19,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:51:19
2025-03-13 17:51:44,983 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8124 secs
2025-03-13 17:51:44,983 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 17:51:44,983 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-13 17:52:10,272 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2882 secs
2025-03-13 17:52:10,274 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3009 secs
2025-03-13 17:52:10,274 [INFO]: {
2025-03-13 17:52:10,274 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:10,274 [INFO]: 	index_param: efSearch=192
2025-03-13 17:52:10,274 [INFO]: 	index_path: knn.index
2025-03-13 17:52:10,274 [INFO]: 	size in bytes: 477300430
2025-03-13 17:52:10,275 [INFO]: 	avg_search_speed_ms: 9.310282786763524
2025-03-13 17:52:10,275 [INFO]: 	99p_search_speed_ms: 13.520994333084662
2025-03-13 17:52:10,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:10,275 [INFO]: 	nb vectors: 2426
2025-03-13 17:52:10,275 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:10,275 [INFO]: 	compression ratio: 0.9993098225367197
2025-03-13 17:52:10,275 [INFO]: }
2025-03-13 17:52:10,275 [INFO]: 	>>> Finished "Creating the index" in 54.3023 secs
2025-03-13 17:52:10,275 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3252 secs
2025-03-13 17:52:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 75764 [episode count 18/20]
[retrieval_preprocessing] for episode 55130 [episode count 19/20], we have num_retrieval=np.int64(2419) num_query=np.int64(88)
2025-03-13 17:52:12,120 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:12,569 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:12
2025-03-13 17:52:12,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.60it/s]
2025-03-13 17:52:12,599 [INFO]: There are 2419 embeddings of dim 49152
2025-03-13 17:52:12,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:52:12,600 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:12
2025-03-13 17:52:12,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:12,600 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 17:52:12,601 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:12,601 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:52:12,601 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:12
2025-03-13 17:52:12,601 [INFO]: 499.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:12,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:52:12,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:12
2025-03-13 17:52:12,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:12,602 [INFO]: 	Creating the index 03/13/2025, 17:52:12
2025-03-13 17:52:12,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:12
2025-03-13 17:52:12,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 17:52:12,606 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:12
2025-03-13 17:52:12,606 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 17:52:12,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.57it/s] 20%|██        | 2/10 [00:00<00:01,  6.49it/s] 30%|███       | 3/10 [00:00<00:00,  7.33it/s] 40%|████      | 4/10 [00:00<00:00,  7.78it/s] 50%|█████     | 5/10 [00:00<00:00,  8.08it/s] 60%|██████    | 6/10 [00:00<00:00,  8.25it/s] 70%|███████   | 7/10 [00:00<00:00,  8.38it/s] 80%|████████  | 8/10 [00:01<00:00,  8.35it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.42it/s]100%|██████████| 10/10 [00:03<00:00,  1.34it/s]100%|██████████| 10/10 [00:03<00:00,  3.03it/s]
2025-03-13 17:52:15,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:15
2025-03-13 17:52:47,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1242 secs
2025-03-13 17:52:47,037 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 17:52:47,037 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-13 17:53:05,105 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0685 secs
2025-03-13 17:53:05,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5018 secs
2025-03-13 17:53:05,108 [INFO]: {
2025-03-13 17:53:05,108 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:05,108 [INFO]: 	index_param: efSearch=176
2025-03-13 17:53:05,108 [INFO]: 	index_path: knn.index
2025-03-13 17:53:05,108 [INFO]: 	size in bytes: 475923250
2025-03-13 17:53:05,108 [INFO]: 	avg_search_speed_ms: 8.719677161977488
2025-03-13 17:53:05,108 [INFO]: 	99p_search_speed_ms: 12.571160001680255
2025-03-13 17:53:05,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:05,108 [INFO]: 	nb vectors: 2419
2025-03-13 17:53:05,108 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:05,108 [INFO]: 	compression ratio: 0.9993097668584168
2025-03-13 17:53:05,108 [INFO]: }
2025-03-13 17:53:05,108 [INFO]: 	>>> Finished "Creating the index" in 52.5054 secs
2025-03-13 17:53:05,108 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5384 secs
2025-03-13 17:53:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 55130 [episode count 19/20]
2025-03-13 17:53:05: [retrieval_preprocessing] finished for 9933578360_close_drawer [chosen_id count 4/196]
2025-03-13 17:53:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 9934859632_put_marker_in_bowl [chosen_id count 5/196]
2025-03-13 17:53:08: [retrieval_preprocessing] we have num_total=3074 embedding_dim=49152
[retrieval_preprocessing] for episode 69891 [episode count 0/20], we have num_retrieval=np.int64(2912) num_query=np.int64(162)
2025-03-13 17:53:09,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:10,024 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:10
2025-03-13 17:53:10,024 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-13 17:53:10,049 [INFO]: There are 2912 embeddings of dim 49152
2025-03-13 17:53:10,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:53:10,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:10
2025-03-13 17:53:10,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:10,051 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:53:10,051 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:10,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:53:10,051 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:10
2025-03-13 17:53:10,051 [INFO]: 601.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:10,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:10,051 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:10
2025-03-13 17:53:10,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:10,051 [INFO]: 	Creating the index 03/13/2025, 17:53:10
2025-03-13 17:53:10,052 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:10
2025-03-13 17:53:10,052 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:53:10,053 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:10
2025-03-13 17:53:10,053 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:10,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  3.83it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.51it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.37it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.80it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.09it/s] 50%|█████     | 6/12 [00:00<00:00,  7.39it/s] 58%|█████▊    | 7/12 [00:01<00:00,  7.48it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.55it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.57it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.62it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.74it/s]100%|██████████| 12/12 [00:04<00:00,  1.12it/s]100%|██████████| 12/12 [00:04<00:00,  2.86it/s]
2025-03-13 17:53:14,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:14
2025-03-13 17:53:43,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6640 secs
2025-03-13 17:53:43,921 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 17:53:43,921 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.61it/s] 50%|█████     | 2/4 [00:00<00:00,  4.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.55it/s]
2025-03-13 17:54:10,926 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0048 secs
2025-03-13 17:54:10,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8762 secs
2025-03-13 17:54:10,929 [INFO]: {
2025-03-13 17:54:10,929 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:10,929 [INFO]: 	index_param: efSearch=168
2025-03-13 17:54:10,929 [INFO]: 	index_path: knn.index
2025-03-13 17:54:10,929 [INFO]: 	size in bytes: 572917870
2025-03-13 17:54:10,929 [INFO]: 	avg_search_speed_ms: 9.113542631365284
2025-03-13 17:54:10,929 [INFO]: 	99p_search_speed_ms: 13.217913080006838
2025-03-13 17:54:10,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:10,929 [INFO]: 	nb vectors: 2912
2025-03-13 17:54:10,929 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:10,929 [INFO]: 	compression ratio: 0.9993098941040188
2025-03-13 17:54:10,929 [INFO]: }
2025-03-13 17:54:10,929 [INFO]: 	>>> Finished "Creating the index" in 60.8777 secs
2025-03-13 17:54:10,929 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9049 secs
2025-03-13 17:54:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 69891 [episode count 0/20]
[retrieval_preprocessing] for episode 71172 [episode count 1/20], we have num_retrieval=np.int64(2940) num_query=np.int64(134)
2025-03-13 17:54:14,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:15,522 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:15
2025-03-13 17:54:15,522 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-13 17:54:15,547 [INFO]: There are 2940 embeddings of dim 49152
2025-03-13 17:54:15,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:54:15,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:15,548 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:54:15,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:15,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:54:15,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,549 [INFO]: 606.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:15,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:54:15,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:15
2025-03-13 17:54:15,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:15,549 [INFO]: 	Creating the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:15
2025-03-13 17:54:15,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:54:15,552 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:15
2025-03-13 17:54:15,553 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:54:15,553 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.18it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.86it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.23it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.39it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.46it/s]100%|██████████| 12/12 [00:03<00:00,  3.59it/s]
2025-03-13 17:54:18,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:18
2025-03-13 17:54:48,274 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3698 secs
2025-03-13 17:54:48,274 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 17:54:48,274 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.48it/s] 50%|█████     | 2/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-13 17:55:20,374 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1003 secs
2025-03-13 17:55:20,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8243 secs
2025-03-13 17:55:20,377 [INFO]: {
2025-03-13 17:55:20,377 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:20,377 [INFO]: 	index_param: efSearch=274
2025-03-13 17:55:20,377 [INFO]: 	index_path: knn.index
2025-03-13 17:55:20,377 [INFO]: 	size in bytes: 578426770
2025-03-13 17:55:20,377 [INFO]: 	avg_search_speed_ms: 13.525233354822204
2025-03-13 17:55:20,377 [INFO]: 	99p_search_speed_ms: 23.940549052786086
2025-03-13 17:55:20,377 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:20,377 [INFO]: 	nb vectors: 2940
2025-03-13 17:55:20,377 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:20,377 [INFO]: 	compression ratio: 0.9993097656942814
2025-03-13 17:55:20,377 [INFO]: }
2025-03-13 17:55:20,377 [INFO]: 	>>> Finished "Creating the index" in 64.8279 secs
2025-03-13 17:55:20,377 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8551 secs
2025-03-13 17:55:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 71172 [episode count 1/20]
[retrieval_preprocessing] for episode 33036 [episode count 2/20], we have num_retrieval=np.int64(2908) num_query=np.int64(166)
2025-03-13 17:55:26,193 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:26,754 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:26
2025-03-13 17:55:26,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1748.36it/s]
2025-03-13 17:55:26,781 [INFO]: There are 2908 embeddings of dim 49152
2025-03-13 17:55:26,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:55:26,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:26
2025-03-13 17:55:26,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:26,782 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:55:26,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:26,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:55:26,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:26
2025-03-13 17:55:26,783 [INFO]: 600.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:26,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:55:26,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:26
2025-03-13 17:55:26,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:26,783 [INFO]: 	Creating the index 03/13/2025, 17:55:26
2025-03-13 17:55:26,784 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:26
2025-03-13 17:55:26,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:55:26,787 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:26
2025-03-13 17:55:26,787 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:55:26,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.76it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.27it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.74it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.92it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.13it/s] 50%|█████     | 6/12 [00:00<00:00,  7.27it/s] 58%|█████▊    | 7/12 [00:01<00:00,  7.46it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.67it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.81it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.89it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.06it/s]100%|██████████| 12/12 [00:03<00:00,  1.24it/s]100%|██████████| 12/12 [00:03<00:00,  3.11it/s]
2025-03-13 17:55:30,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:30
2025-03-13 17:56:05,542 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8855 secs
2025-03-13 17:56:05,542 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:56:05,542 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.67it/s] 50%|█████     | 2/4 [00:00<00:00,  4.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 17:56:23,089 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5470 secs
2025-03-13 17:56:23,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3053 secs
2025-03-13 17:56:23,092 [INFO]: {
2025-03-13 17:56:23,092 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:23,092 [INFO]: 	index_param: efSearch=178
2025-03-13 17:56:23,092 [INFO]: 	index_path: knn.index
2025-03-13 17:56:23,093 [INFO]: 	size in bytes: 572130910
2025-03-13 17:56:23,093 [INFO]: 	avg_search_speed_ms: 10.360489108411528
2025-03-13 17:56:23,093 [INFO]: 	99p_search_speed_ms: 18.19275178015232
2025-03-13 17:56:23,093 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:23,093 [INFO]: 	nb vectors: 2908
2025-03-13 17:56:23,093 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:23,093 [INFO]: 	compression ratio: 0.9993098677363892
2025-03-13 17:56:23,093 [INFO]: }
2025-03-13 17:56:23,093 [INFO]: 	>>> Finished "Creating the index" in 56.3091 secs
2025-03-13 17:56:23,093 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3390 secs
2025-03-13 17:56:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 33036 [episode count 2/20]
[retrieval_preprocessing] for episode 16535 [episode count 3/20], we have num_retrieval=np.int64(2935) num_query=np.int64(139)
2025-03-13 17:56:25,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:25,992 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:25
2025-03-13 17:56:25,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 17:56:26,020 [INFO]: There are 2935 embeddings of dim 49152
2025-03-13 17:56:26,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 17:56:26,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:26,021 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:56:26,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:26,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:56:26,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,022 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:26,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:56:26,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:26
2025-03-13 17:56:26,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:26,022 [INFO]: 	Creating the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:26
2025-03-13 17:56:26,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:56:26,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:26
2025-03-13 17:56:26,025 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:56:26,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.56it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.75it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.80it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.20it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.38it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.58it/s]100%|██████████| 12/12 [00:03<00:00,  3.13it/s]
2025-03-13 17:56:29,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:29
2025-03-13 17:57:01,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2240 secs
2025-03-13 17:57:01,092 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 17:57:01,092 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 17:57:37,951 [INFO]: 	>>> Finished "Compute fast metrics" in 36.8594 secs
2025-03-13 17:57:38,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4463 secs
2025-03-13 17:57:38,471 [INFO]: {
2025-03-13 17:57:38,471 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:38,471 [INFO]: 	index_param: efSearch=269
2025-03-13 17:57:38,471 [INFO]: 	index_path: knn.index
2025-03-13 17:57:38,471 [INFO]: 	size in bytes: 577443070
2025-03-13 17:57:38,472 [INFO]: 	avg_search_speed_ms: 11.58317606971704
2025-03-13 17:57:38,472 [INFO]: 	99p_search_speed_ms: 14.909556861966848
2025-03-13 17:57:38,472 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:38,472 [INFO]: 	nb vectors: 2935
2025-03-13 17:57:38,472 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:38,472 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-13 17:57:38,472 [INFO]: }
2025-03-13 17:57:38,472 [INFO]: 	>>> Finished "Creating the index" in 72.4498 secs
2025-03-13 17:57:38,472 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4798 secs
2025-03-13 17:57:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 16535 [episode count 3/20]
[retrieval_preprocessing] for episode 35352 [episode count 4/20], we have num_retrieval=np.int64(2924) num_query=np.int64(150)
2025-03-13 17:57:41,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:42,001 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:42
2025-03-13 17:57:42,001 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1105.22it/s]
2025-03-13 17:57:42,023 [INFO]: There are 2924 embeddings of dim 49152
2025-03-13 17:57:42,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-13 17:57:42,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:42
2025-03-13 17:57:42,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:42,023 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:57:42,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:42,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:57:42,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:42
2025-03-13 17:57:42,023 [INFO]: 603.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:42,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:57:42,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:42
2025-03-13 17:57:42,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:42,024 [INFO]: 	Creating the index 03/13/2025, 17:57:42
2025-03-13 17:57:42,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:42
2025-03-13 17:57:42,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 17:57:42,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:42
2025-03-13 17:57:42,025 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:42,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.29it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.85it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.63it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.88it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.18it/s] 50%|█████     | 6/12 [00:00<00:00,  9.37it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.23it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.54it/s]100%|██████████| 12/12 [00:03<00:00,  1.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.08it/s]
2025-03-13 17:57:45,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:45
2025-03-13 17:58:22,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1630 secs
2025-03-13 17:58:22,093 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 17:58:22,093 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 17:58:47,774 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6806 secs
2025-03-13 17:58:47,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7509 secs
2025-03-13 17:58:47,776 [INFO]: {
2025-03-13 17:58:47,776 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:47,776 [INFO]: 	index_param: efSearch=231
2025-03-13 17:58:47,777 [INFO]: 	index_path: knn.index
2025-03-13 17:58:47,777 [INFO]: 	size in bytes: 575278810
2025-03-13 17:58:47,777 [INFO]: 	avg_search_speed_ms: 9.977030186280013
2025-03-13 17:58:47,777 [INFO]: 	99p_search_speed_ms: 13.861452792771162
2025-03-13 17:58:47,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:47,777 [INFO]: 	nb vectors: 2924
2025-03-13 17:58:47,777 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:47,777 [INFO]: 	compression ratio: 0.9993098685487825
2025-03-13 17:58:47,777 [INFO]: }
2025-03-13 17:58:47,777 [INFO]: 	>>> Finished "Creating the index" in 65.7530 secs
2025-03-13 17:58:47,777 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7759 secs
2025-03-13 17:58:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 35352 [episode count 4/20]
[retrieval_preprocessing] for episode 80162 [episode count 5/20], we have num_retrieval=np.int64(2931) num_query=np.int64(143)
2025-03-13 17:58:50,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:50,632 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:50
2025-03-13 17:58:50,632 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-13 17:58:50,656 [INFO]: There are 2931 embeddings of dim 49152
2025-03-13 17:58:50,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:58:50,657 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:50
2025-03-13 17:58:50,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:50,657 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 17:58:50,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:50,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:50,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:50
2025-03-13 17:58:50,657 [INFO]: 604.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:50,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:58:50,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:50
2025-03-13 17:58:50,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:50,657 [INFO]: 	Creating the index 03/13/2025, 17:58:50
2025-03-13 17:58:50,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:50
2025-03-13 17:58:50,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:58:50,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:50
2025-03-13 17:58:50,658 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:58:50,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.53it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.18it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.72it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.94it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.06it/s] 50%|█████     | 6/12 [00:00<00:00,  8.12it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.25it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.23it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.21it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.25it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.47it/s]100%|██████████| 12/12 [00:03<00:00,  1.44it/s]100%|██████████| 12/12 [00:03<00:00,  3.56it/s]
2025-03-13 17:58:54,034 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:54
2025-03-13 17:59:29,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0117 secs
2025-03-13 17:59:29,047 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 17:59:29,047 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 17:59:58,296 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2497 secs
2025-03-13 17:59:58,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6408 secs
2025-03-13 17:59:58,299 [INFO]: {
2025-03-13 17:59:58,299 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:58,299 [INFO]: 	index_param: efSearch=192
2025-03-13 17:59:58,299 [INFO]: 	index_path: knn.index
2025-03-13 17:59:58,299 [INFO]: 	size in bytes: 576656050
2025-03-13 17:59:58,299 [INFO]: 	avg_search_speed_ms: 10.005794633114645
2025-03-13 17:59:58,299 [INFO]: 	99p_search_speed_ms: 13.88287730515003
2025-03-13 17:59:58,299 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:58,299 [INFO]: 	nb vectors: 2931
2025-03-13 17:59:58,299 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:58,299 [INFO]: 	compression ratio: 0.9993098104147178
2025-03-13 17:59:58,299 [INFO]: }
2025-03-13 17:59:58,299 [INFO]: 	>>> Finished "Creating the index" in 67.6422 secs
2025-03-13 17:59:58,299 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6677 secs
2025-03-13 17:59:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 80162 [episode count 5/20]
[retrieval_preprocessing] for episode 90029 [episode count 6/20], we have num_retrieval=np.int64(2902) num_query=np.int64(172)
2025-03-13 18:00:00,905 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:01,471 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:01
2025-03-13 18:00:01,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1987.82it/s]
2025-03-13 18:00:01,495 [INFO]: There are 2902 embeddings of dim 49152
2025-03-13 18:00:01,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:00:01,495 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:01
2025-03-13 18:00:01,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:01,495 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:00:01,495 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:01,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:01,496 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:01
2025-03-13 18:00:01,496 [INFO]: 598.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:01,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:01,496 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:01
2025-03-13 18:00:01,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:01,496 [INFO]: 	Creating the index 03/13/2025, 18:00:01
2025-03-13 18:00:01,496 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:01
2025-03-13 18:00:01,497 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:01,497 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:01
2025-03-13 18:00:01,497 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:00:01,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.63it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.70it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.70it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.16it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.41it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.82it/s]100%|██████████| 12/12 [00:03<00:00,  3.58it/s]
2025-03-13 18:00:04,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:04
2025-03-13 18:00:39,440 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5898 secs
2025-03-13 18:00:39,440 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 18:00:39,440 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.09it/s]
2025-03-13 18:00:58,218 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7776 secs
2025-03-13 18:00:58,220 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7233 secs
2025-03-13 18:00:58,221 [INFO]: {
2025-03-13 18:00:58,221 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:58,221 [INFO]: 	index_param: efSearch=202
2025-03-13 18:00:58,221 [INFO]: 	index_path: knn.index
2025-03-13 18:00:58,221 [INFO]: 	size in bytes: 570950470
2025-03-13 18:00:58,221 [INFO]: 	avg_search_speed_ms: 10.389966752886895
2025-03-13 18:00:58,221 [INFO]: 	99p_search_speed_ms: 15.545937116257846
2025-03-13 18:00:58,221 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:58,221 [INFO]: 	nb vectors: 2902
2025-03-13 18:00:58,221 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:58,221 [INFO]: 	compression ratio: 0.9993098280486572
2025-03-13 18:00:58,221 [INFO]: }
2025-03-13 18:00:58,221 [INFO]: 	>>> Finished "Creating the index" in 56.7254 secs
2025-03-13 18:00:58,221 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7501 secs
2025-03-13 18:00:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 90029 [episode count 6/20]
[retrieval_preprocessing] for episode 77745 [episode count 7/20], we have num_retrieval=np.int64(2948) num_query=np.int64(126)
2025-03-13 18:01:00,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:01,095 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:01
2025-03-13 18:01:01,095 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2166.48it/s]
2025-03-13 18:01:01,121 [INFO]: There are 2948 embeddings of dim 49152
2025-03-13 18:01:01,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:01:01,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:01
2025-03-13 18:01:01,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:01,121 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:01:01,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:01,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:01:01,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:01
2025-03-13 18:01:01,122 [INFO]: 608.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:01,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:01:01,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:01
2025-03-13 18:01:01,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:01,122 [INFO]: 	Creating the index 03/13/2025, 18:01:01
2025-03-13 18:01:01,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:01
2025-03-13 18:01:01,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:01:01,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:01
2025-03-13 18:01:01,123 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:01:01,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.73it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.01it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.17it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.67it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.01it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.19it/s]100%|██████████| 12/12 [00:03<00:00,  3.60it/s]
2025-03-13 18:01:05,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:05
2025-03-13 18:01:36,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1700 secs
2025-03-13 18:01:36,432 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 18:01:36,432 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 18:02:05,261 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8291 secs
2025-03-13 18:02:05,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1397 secs
2025-03-13 18:02:05,263 [INFO]: {
2025-03-13 18:02:05,263 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:05,263 [INFO]: 	index_param: efSearch=233
2025-03-13 18:02:05,263 [INFO]: 	index_path: knn.index
2025-03-13 18:02:05,263 [INFO]: 	size in bytes: 580000690
2025-03-13 18:02:05,263 [INFO]: 	avg_search_speed_ms: 10.676436090450277
2025-03-13 18:02:05,263 [INFO]: 	99p_search_speed_ms: 17.965365853160616
2025-03-13 18:02:05,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:05,264 [INFO]: 	nb vectors: 2948
2025-03-13 18:02:05,264 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:05,264 [INFO]: 	compression ratio: 0.9993098180624578
2025-03-13 18:02:05,264 [INFO]: }
2025-03-13 18:02:05,264 [INFO]: 	>>> Finished "Creating the index" in 64.1417 secs
2025-03-13 18:02:05,264 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1687 secs
2025-03-13 18:02:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 77745 [episode count 7/20]
[retrieval_preprocessing] for episode 93748 [episode count 8/20], we have num_retrieval=np.int64(2927) num_query=np.int64(147)
2025-03-13 18:02:07,753 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:08,261 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:08
2025-03-13 18:02:08,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 857.38it/s]
2025-03-13 18:02:08,291 [INFO]: There are 2927 embeddings of dim 49152
2025-03-13 18:02:08,292 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:02:08,292 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:08
2025-03-13 18:02:08,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:08,293 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:02:08,293 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:08,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:02:08,293 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:08
2025-03-13 18:02:08,294 [INFO]: 604.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:08,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:02:08,294 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:08
2025-03-13 18:02:08,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:08,294 [INFO]: 	Creating the index 03/13/2025, 18:02:08
2025-03-13 18:02:08,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:08
2025-03-13 18:02:08,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:02:08,298 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:08
2025-03-13 18:02:08,298 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:02:08,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.89it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.20it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.77it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.24it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.55it/s] 50%|█████     | 6/12 [00:00<00:00,  7.79it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.04it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.08it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.26it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.65it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.55it/s]100%|██████████| 12/12 [00:03<00:00,  1.33it/s]100%|██████████| 12/12 [00:03<00:00,  3.31it/s]
2025-03-13 18:02:12,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:12
2025-03-13 18:02:43,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6846 secs
2025-03-13 18:02:43,965 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 18:02:43,965 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 18:03:06,646 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6806 secs
2025-03-13 18:03:06,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3503 secs
2025-03-13 18:03:06,648 [INFO]: {
2025-03-13 18:03:06,648 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:06,648 [INFO]: 	index_param: efSearch=254
2025-03-13 18:03:06,648 [INFO]: 	index_path: knn.index
2025-03-13 18:03:06,648 [INFO]: 	size in bytes: 575869030
2025-03-13 18:03:06,648 [INFO]: 	avg_search_speed_ms: 13.237250185936256
2025-03-13 18:03:06,649 [INFO]: 	99p_search_speed_ms: 24.35826249420644
2025-03-13 18:03:06,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:06,649 [INFO]: 	nb vectors: 2927
2025-03-13 18:03:06,649 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:06,649 [INFO]: 	compression ratio: 0.9993098882223272
2025-03-13 18:03:06,649 [INFO]: }
2025-03-13 18:03:06,649 [INFO]: 	>>> Finished "Creating the index" in 58.3541 secs
2025-03-13 18:03:06,649 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3873 secs
2025-03-13 18:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 93748 [episode count 8/20]
[retrieval_preprocessing] for episode 93872 [episode count 9/20], we have num_retrieval=np.int64(2879) num_query=np.int64(195)
2025-03-13 18:03:09,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:10,433 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:10
2025-03-13 18:03:10,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2017.46it/s]
2025-03-13 18:03:10,460 [INFO]: There are 2879 embeddings of dim 49152
2025-03-13 18:03:10,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 18:03:10,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:10
2025-03-13 18:03:10,461 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:10,461 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:03:10,461 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:10,461 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:03:10,461 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:10
2025-03-13 18:03:10,461 [INFO]: 594.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:10,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:03:10,462 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:10
2025-03-13 18:03:10,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:10,462 [INFO]: 	Creating the index 03/13/2025, 18:03:10
2025-03-13 18:03:10,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:10
2025-03-13 18:03:10,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:03:10,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:10
2025-03-13 18:03:10,466 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:03:10,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.84it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.33it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.69it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.89it/s] 50%|█████     | 6/12 [00:00<00:00,  9.05it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.95it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.63it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.74it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.81it/s]100%|██████████| 12/12 [00:04<00:00,  1.15it/s]100%|██████████| 12/12 [00:04<00:00,  2.96it/s]
2025-03-13 18:03:14,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:14
2025-03-13 18:03:48,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3774 secs
2025-03-13 18:03:48,905 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 18:03:48,905 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 18:04:14,950 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0448 secs
2025-03-13 18:04:14,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4872 secs
2025-03-13 18:04:14,953 [INFO]: {
2025-03-13 18:04:14,953 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:14,953 [INFO]: 	index_param: efSearch=239
2025-03-13 18:04:14,953 [INFO]: 	index_path: knn.index
2025-03-13 18:04:14,953 [INFO]: 	size in bytes: 566425390
2025-03-13 18:04:14,953 [INFO]: 	avg_search_speed_ms: 11.277653661733988
2025-03-13 18:04:14,953 [INFO]: 	99p_search_speed_ms: 18.4638069011271
2025-03-13 18:04:14,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:14,953 [INFO]: 	nb vectors: 2879
2025-03-13 18:04:14,953 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:14,953 [INFO]: 	compression ratio: 0.9993097802342511
2025-03-13 18:04:14,953 [INFO]: }
2025-03-13 18:04:14,953 [INFO]: 	>>> Finished "Creating the index" in 64.4912 secs
2025-03-13 18:04:14,953 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5201 secs
2025-03-13 18:04:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 93872 [episode count 9/20]
[retrieval_preprocessing] for episode 82364 [episode count 10/20], we have num_retrieval=np.int64(2950) num_query=np.int64(124)
2025-03-13 18:04:17,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:18,256 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:18
2025-03-13 18:04:18,257 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.55it/s]
2025-03-13 18:04:18,282 [INFO]: There are 2950 embeddings of dim 49152
2025-03-13 18:04:18,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:04:18,282 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:18
2025-03-13 18:04:18,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:18,282 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:04:18,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:18,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:18,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:18
2025-03-13 18:04:18,282 [INFO]: 608.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:18,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:04:18,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:18
2025-03-13 18:04:18,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:18,282 [INFO]: 	Creating the index 03/13/2025, 18:04:18
2025-03-13 18:04:18,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:18
2025-03-13 18:04:18,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:04:18,284 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:18
2025-03-13 18:04:18,284 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:04:18,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.10it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.87it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.51it/s] 50%|█████     | 6/12 [00:00<00:00,  9.19it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.37it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.66it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.07it/s]100%|██████████| 12/12 [00:03<00:00,  3.61it/s]
2025-03-13 18:04:21,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:21
2025-03-13 18:04:53,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4547 secs
2025-03-13 18:04:53,068 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:04:53,069 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
2025-03-13 18:05:25,135 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0667 secs
2025-03-13 18:05:25,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8548 secs
2025-03-13 18:05:25,139 [INFO]: {
2025-03-13 18:05:25,139 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:25,139 [INFO]: 	index_param: efSearch=197
2025-03-13 18:05:25,139 [INFO]: 	index_path: knn.index
2025-03-13 18:05:25,139 [INFO]: 	size in bytes: 580394170
2025-03-13 18:05:25,139 [INFO]: 	avg_search_speed_ms: 9.707639582717375
2025-03-13 18:05:25,139 [INFO]: 	99p_search_speed_ms: 14.934139347169554
2025-03-13 18:05:25,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:25,139 [INFO]: 	nb vectors: 2950
2025-03-13 18:05:25,139 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:25,139 [INFO]: 	compression ratio: 0.999309831110123
2025-03-13 18:05:25,139 [INFO]: }
2025-03-13 18:05:25,139 [INFO]: 	>>> Finished "Creating the index" in 66.8564 secs
2025-03-13 18:05:25,139 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8823 secs
2025-03-13 18:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 82364 [episode count 10/20]
[retrieval_preprocessing] for episode 78782 [episode count 11/20], we have num_retrieval=np.int64(2877) num_query=np.int64(197)
2025-03-13 18:05:27,454 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:27,909 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:27
2025-03-13 18:05:27,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.51it/s]
2025-03-13 18:05:28,241 [INFO]: There are 2877 embeddings of dim 49152
2025-03-13 18:05:28,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3330 secs
2025-03-13 18:05:28,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:28,242 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:05:28,243 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:28,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0010 secs
2025-03-13 18:05:28,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,244 [INFO]: 593.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:28,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:05:28,244 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:28
2025-03-13 18:05:28,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:28,244 [INFO]: 	Creating the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:28
2025-03-13 18:05:28,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:05:28,248 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:28
2025-03-13 18:05:28,248 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:05:28,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.96it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.17it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.77it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.12it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.56it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.95it/s]100%|██████████| 12/12 [00:03<00:00,  3.52it/s]
2025-03-13 18:05:32,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:32
2025-03-13 18:06:02,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8793 secs
2025-03-13 18:06:02,012 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:06:02,013 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-13 18:06:34,584 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5710 secs
2025-03-13 18:06:35,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1397 secs
2025-03-13 18:06:35,388 [INFO]: {
2025-03-13 18:06:35,388 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:35,388 [INFO]: 	index_param: efSearch=271
2025-03-13 18:06:35,388 [INFO]: 	index_path: knn.index
2025-03-13 18:06:35,388 [INFO]: 	size in bytes: 566031910
2025-03-13 18:06:35,388 [INFO]: 	avg_search_speed_ms: 12.326112642409418
2025-03-13 18:06:35,388 [INFO]: 	99p_search_speed_ms: 17.19633343629539
2025-03-13 18:06:35,388 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:35,388 [INFO]: 	nb vectors: 2877
2025-03-13 18:06:35,388 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:35,388 [INFO]: 	compression ratio: 0.9993097668292235
2025-03-13 18:06:35,389 [INFO]: }
2025-03-13 18:06:35,389 [INFO]: 	>>> Finished "Creating the index" in 67.1444 secs
2025-03-13 18:06:35,389 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4798 secs
2025-03-13 18:06:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 78782 [episode count 11/20]
[retrieval_preprocessing] for episode 79043 [episode count 12/20], we have num_retrieval=np.int64(2909) num_query=np.int64(165)
2025-03-13 18:06:42,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:43,087 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:43
2025-03-13 18:06:43,087 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 932.48it/s]
2025-03-13 18:06:43,118 [INFO]: There are 2909 embeddings of dim 49152
2025-03-13 18:06:43,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 18:06:43,118 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:43
2025-03-13 18:06:43,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:43,119 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:06:43,119 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:43,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:06:43,119 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:43
2025-03-13 18:06:43,120 [INFO]: 600.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:43,120 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:06:43,120 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:43
2025-03-13 18:06:43,120 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:43,120 [INFO]: 	Creating the index 03/13/2025, 18:06:43
2025-03-13 18:06:43,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:43
2025-03-13 18:06:43,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:06:43,124 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:43
2025-03-13 18:06:43,124 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:06:43,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.90it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.80it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.98it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.20it/s] 50%|█████     | 6/12 [00:00<00:00,  9.29it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.21it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.21it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.03it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.93it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.85it/s]100%|██████████| 12/12 [00:03<00:00,  1.27it/s]100%|██████████| 12/12 [00:03<00:00,  3.36it/s]
2025-03-13 18:06:46,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:46
2025-03-13 18:07:18,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8319 secs
2025-03-13 18:07:18,539 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 18:07:18,539 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 18:07:38,069 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5299 secs
2025-03-13 18:07:38,072 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9475 secs
2025-03-13 18:07:38,072 [INFO]: {
2025-03-13 18:07:38,072 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:38,072 [INFO]: 	index_param: efSearch=162
2025-03-13 18:07:38,072 [INFO]: 	index_path: knn.index
2025-03-13 18:07:38,072 [INFO]: 	size in bytes: 572327650
2025-03-13 18:07:38,072 [INFO]: 	avg_search_speed_ms: 8.506036298547654
2025-03-13 18:07:38,072 [INFO]: 	99p_search_speed_ms: 13.942294036969543
2025-03-13 18:07:38,072 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:38,072 [INFO]: 	nb vectors: 2909
2025-03-13 18:07:38,072 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:38,072 [INFO]: 	compression ratio: 0.9993098743350946
2025-03-13 18:07:38,072 [INFO]: }
2025-03-13 18:07:38,072 [INFO]: 	>>> Finished "Creating the index" in 54.9515 secs
2025-03-13 18:07:38,072 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9846 secs
2025-03-13 18:07:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 79043 [episode count 12/20]
[retrieval_preprocessing] for episode 30280 [episode count 13/20], we have num_retrieval=np.int64(2930) num_query=np.int64(144)
2025-03-13 18:07:40,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:41,648 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:41
2025-03-13 18:07:41,648 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.06it/s]
2025-03-13 18:07:41,671 [INFO]: There are 2930 embeddings of dim 49152
2025-03-13 18:07:41,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 18:07:41,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:41
2025-03-13 18:07:41,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:41,671 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:07:41,671 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:41,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:41,671 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:41
2025-03-13 18:07:41,671 [INFO]: 604.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:41,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:41,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:41
2025-03-13 18:07:41,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:41,671 [INFO]: 	Creating the index 03/13/2025, 18:07:41
2025-03-13 18:07:41,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:41
2025-03-13 18:07:41,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:07:41,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:41
2025-03-13 18:07:41,673 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:07:41,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.72it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.38it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.05it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.35it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.64it/s] 50%|█████     | 6/12 [00:00<00:00,  7.78it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.98it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.94it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.14it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.50it/s]100%|██████████| 12/12 [00:03<00:00,  1.68it/s]100%|██████████| 12/12 [00:03<00:00,  3.36it/s]
2025-03-13 18:07:45,251 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:45
2025-03-13 18:08:20,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0910 secs
2025-03-13 18:08:20,343 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 18:08:20,343 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-13 18:08:49,719 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3754 secs
2025-03-13 18:08:49,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0486 secs
2025-03-13 18:08:49,721 [INFO]: {
2025-03-13 18:08:49,721 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:49,721 [INFO]: 	index_param: efSearch=192
2025-03-13 18:08:49,721 [INFO]: 	index_path: knn.index
2025-03-13 18:08:49,721 [INFO]: 	size in bytes: 576459310
2025-03-13 18:08:49,721 [INFO]: 	avg_search_speed_ms: 9.528438139394337
2025-03-13 18:08:49,721 [INFO]: 	99p_search_speed_ms: 14.294585762545463
2025-03-13 18:08:49,721 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:49,721 [INFO]: 	nb vectors: 2930
2025-03-13 18:08:49,721 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:49,721 [INFO]: 	compression ratio: 0.999309803843744
2025-03-13 18:08:49,721 [INFO]: }
2025-03-13 18:08:49,721 [INFO]: 	>>> Finished "Creating the index" in 68.0499 secs
2025-03-13 18:08:49,721 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0732 secs
2025-03-13 18:08:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 30280 [episode count 13/20]
[retrieval_preprocessing] for episode 71115 [episode count 14/20], we have num_retrieval=np.int64(2887) num_query=np.int64(187)
2025-03-13 18:08:51,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:52,205 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:52
2025-03-13 18:08:52,205 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.00it/s]
2025-03-13 18:08:52,231 [INFO]: There are 2887 embeddings of dim 49152
2025-03-13 18:08:52,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:08:52,231 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:52
2025-03-13 18:08:52,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:52,231 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:08:52,231 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:52,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:52,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:52
2025-03-13 18:08:52,231 [INFO]: 595.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:52,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:08:52,232 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:52
2025-03-13 18:08:52,232 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:52,232 [INFO]: 	Creating the index 03/13/2025, 18:08:52
2025-03-13 18:08:52,232 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:52
2025-03-13 18:08:52,233 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:08:52,233 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:52
2025-03-13 18:08:52,233 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:08:52,233 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.28it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.82it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.48it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.86it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.10it/s] 50%|█████     | 6/12 [00:00<00:00,  8.22it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.32it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.47it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.48it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.48it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.50it/s]100%|██████████| 12/12 [00:03<00:00,  1.40it/s]100%|██████████| 12/12 [00:03<00:00,  3.49it/s]
2025-03-13 18:08:55,673 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:55
2025-03-13 18:09:25,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9689 secs
2025-03-13 18:09:25,642 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 18:09:25,642 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
2025-03-13 18:09:50,685 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0430 secs
2025-03-13 18:09:50,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4560 secs
2025-03-13 18:09:50,689 [INFO]: {
2025-03-13 18:09:50,689 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:50,689 [INFO]: 	index_param: efSearch=251
2025-03-13 18:09:50,689 [INFO]: 	index_path: knn.index
2025-03-13 18:09:50,689 [INFO]: 	size in bytes: 567999370
2025-03-13 18:09:50,689 [INFO]: 	avg_search_speed_ms: 11.623886475527744
2025-03-13 18:09:50,689 [INFO]: 	99p_search_speed_ms: 18.129319511353952
2025-03-13 18:09:50,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:50,689 [INFO]: 	nb vectors: 2887
2025-03-13 18:09:50,689 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:50,689 [INFO]: 	compression ratio: 0.999309728107621
2025-03-13 18:09:50,689 [INFO]: }
2025-03-13 18:09:50,689 [INFO]: 	>>> Finished "Creating the index" in 58.4575 secs
2025-03-13 18:09:50,689 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4837 secs
2025-03-13 18:09:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 71115 [episode count 14/20]
[retrieval_preprocessing] for episode 83037 [episode count 15/20], we have num_retrieval=np.int64(2925) num_query=np.int64(149)
2025-03-13 18:09:54,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:55,420 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:55
2025-03-13 18:09:55,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1892.74it/s]
2025-03-13 18:09:55,443 [INFO]: There are 2925 embeddings of dim 49152
2025-03-13 18:09:55,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:09:55,443 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:55
2025-03-13 18:09:55,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:55,444 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:09:55,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:55,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:09:55,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:55
2025-03-13 18:09:55,444 [INFO]: 603.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:55,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:09:55,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:55
2025-03-13 18:09:55,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:55,444 [INFO]: 	Creating the index 03/13/2025, 18:09:55
2025-03-13 18:09:55,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:55
2025-03-13 18:09:55,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:09:55,447 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:55
2025-03-13 18:09:55,447 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:09:55,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.51it/s] 17%|█▋        | 2/12 [00:00<00:01,  5.37it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.24it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.64it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.13it/s] 50%|█████     | 6/12 [00:00<00:00,  7.62it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.19it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.55it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.55it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.23it/s]100%|██████████| 12/12 [00:03<00:00,  1.50it/s]100%|██████████| 12/12 [00:03<00:00,  3.21it/s]
2025-03-13 18:09:59,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:59
2025-03-13 18:10:32,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6814 secs
2025-03-13 18:10:32,868 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:10:32,868 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 18:10:52,868 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9992 secs
2025-03-13 18:10:53,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4945 secs
2025-03-13 18:10:53,942 [INFO]: {
2025-03-13 18:10:53,942 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:53,942 [INFO]: 	index_param: efSearch=224
2025-03-13 18:10:53,942 [INFO]: 	index_path: knn.index
2025-03-13 18:10:53,942 [INFO]: 	size in bytes: 575475550
2025-03-13 18:10:53,942 [INFO]: 	avg_search_speed_ms: 10.414029402454617
2025-03-13 18:10:53,942 [INFO]: 	99p_search_speed_ms: 15.54029894992709
2025-03-13 18:10:53,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:53,942 [INFO]: 	nb vectors: 2925
2025-03-13 18:10:53,942 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:53,942 [INFO]: 	compression ratio: 0.9993098751111146
2025-03-13 18:10:53,942 [INFO]: }
2025-03-13 18:10:53,942 [INFO]: 	>>> Finished "Creating the index" in 58.4980 secs
2025-03-13 18:10:53,943 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5229 secs
2025-03-13 18:10:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 83037 [episode count 15/20]
[retrieval_preprocessing] for episode 89691 [episode count 16/20], we have num_retrieval=np.int64(2933) num_query=np.int64(141)
2025-03-13 18:10:56,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:56,658 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:56
2025-03-13 18:10:56,658 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.13it/s]
2025-03-13 18:10:56,682 [INFO]: There are 2933 embeddings of dim 49152
2025-03-13 18:10:56,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:10:56,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:56
2025-03-13 18:10:56,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:56,682 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:10:56,682 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:56,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:10:56,682 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:56
2025-03-13 18:10:56,682 [INFO]: 605.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:56,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:10:56,682 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:56
2025-03-13 18:10:56,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:56,682 [INFO]: 	Creating the index 03/13/2025, 18:10:56
2025-03-13 18:10:56,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:56
2025-03-13 18:10:56,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:10:56,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:56
2025-03-13 18:10:56,684 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:10:56,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.72it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.33it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.84it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.12it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.18it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.39it/s]100%|██████████| 12/12 [00:02<00:00,  4.07it/s]
2025-03-13 18:10:59,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:59
2025-03-13 18:11:27,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7068 secs
2025-03-13 18:11:27,340 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 18:11:27,340 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-13 18:12:01,815 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4747 secs
2025-03-13 18:12:01,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1346 secs
2025-03-13 18:12:01,818 [INFO]: {
2025-03-13 18:12:01,818 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:01,818 [INFO]: 	index_param: efSearch=296
2025-03-13 18:12:01,819 [INFO]: 	index_path: knn.index
2025-03-13 18:12:01,819 [INFO]: 	size in bytes: 577049590
2025-03-13 18:12:01,819 [INFO]: 	avg_search_speed_ms: 16.29759008572998
2025-03-13 18:12:01,819 [INFO]: 	99p_search_speed_ms: 28.506838951725516
2025-03-13 18:12:01,819 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:01,819 [INFO]: 	nb vectors: 2933
2025-03-13 18:12:01,819 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:01,819 [INFO]: 	compression ratio: 0.9993097196377871
2025-03-13 18:12:01,819 [INFO]: }
2025-03-13 18:12:01,819 [INFO]: 	>>> Finished "Creating the index" in 65.1361 secs
2025-03-13 18:12:01,819 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1607 secs
2025-03-13 18:12:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 89691 [episode count 16/20]
[retrieval_preprocessing] for episode 11751 [episode count 17/20], we have num_retrieval=np.int64(2935) num_query=np.int64(139)
2025-03-13 18:12:05,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:06,240 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:06
2025-03-13 18:12:06,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.30it/s]
2025-03-13 18:12:06,268 [INFO]: There are 2935 embeddings of dim 49152
2025-03-13 18:12:06,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 18:12:06,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:06
2025-03-13 18:12:06,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:06,270 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:12:06,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:06,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:12:06,270 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:06
2025-03-13 18:12:06,270 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:06,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:12:06,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:06
2025-03-13 18:12:06,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:06,271 [INFO]: 	Creating the index 03/13/2025, 18:12:06
2025-03-13 18:12:06,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:06
2025-03-13 18:12:06,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:12:06,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:06
2025-03-13 18:12:06,275 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:12:06,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.03it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.21it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.54it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.78it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.29it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.64it/s]100%|██████████| 12/12 [00:03<00:00,  3.60it/s]
2025-03-13 18:12:09,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:09
2025-03-13 18:12:39,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9117 secs
2025-03-13 18:12:39,795 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:12:39,795 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s]
2025-03-13 18:12:59,012 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2177 secs
2025-03-13 18:12:59,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7403 secs
2025-03-13 18:12:59,016 [INFO]: {
2025-03-13 18:12:59,016 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:59,016 [INFO]: 	index_param: efSearch=240
2025-03-13 18:12:59,016 [INFO]: 	index_path: knn.index
2025-03-13 18:12:59,016 [INFO]: 	size in bytes: 577443070
2025-03-13 18:12:59,016 [INFO]: 	avg_search_speed_ms: 11.718309688626132
2025-03-13 18:12:59,016 [INFO]: 	99p_search_speed_ms: 16.036763936281208
2025-03-13 18:12:59,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:59,016 [INFO]: 	nb vectors: 2935
2025-03-13 18:12:59,016 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:59,016 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-13 18:12:59,016 [INFO]: }
2025-03-13 18:12:59,016 [INFO]: 	>>> Finished "Creating the index" in 52.7443 secs
2025-03-13 18:12:59,016 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7755 secs
2025-03-13 18:13:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 11751 [episode count 17/20]
[retrieval_preprocessing] for episode 85608 [episode count 18/20], we have num_retrieval=np.int64(2915) num_query=np.int64(159)
2025-03-13 18:13:01,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:02,428 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:02
2025-03-13 18:13:02,428 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-13 18:13:02,452 [INFO]: There are 2915 embeddings of dim 49152
2025-03-13 18:13:02,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:13:02,452 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:02
2025-03-13 18:13:02,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:02,452 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:13:02,452 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:02,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:13:02,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:02
2025-03-13 18:13:02,452 [INFO]: 601.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:02,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:13:02,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:02
2025-03-13 18:13:02,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:02,453 [INFO]: 	Creating the index 03/13/2025, 18:13:02
2025-03-13 18:13:02,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:02
2025-03-13 18:13:02,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:13:02,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:02
2025-03-13 18:13:02,454 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:13:02,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.73it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.12it/s] 25%|██▌       | 3/12 [00:00<00:01,  6.75it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.20it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.34it/s] 50%|█████     | 6/12 [00:00<00:00,  7.41it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.45it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.47it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.51it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.60it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.61it/s]100%|██████████| 12/12 [00:04<00:00,  1.15it/s]100%|██████████| 12/12 [00:04<00:00,  2.95it/s]
2025-03-13 18:13:06,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:06
2025-03-13 18:13:37,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4793 secs
2025-03-13 18:13:37,005 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 18:13:37,005 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s]
2025-03-13 18:14:14,902 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8966 secs
2025-03-13 18:14:14,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4505 secs
2025-03-13 18:14:14,904 [INFO]: {
2025-03-13 18:14:14,904 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:14,904 [INFO]: 	index_param: efSearch=243
2025-03-13 18:14:14,904 [INFO]: 	index_path: knn.index
2025-03-13 18:14:14,904 [INFO]: 	size in bytes: 573508150
2025-03-13 18:14:14,905 [INFO]: 	avg_search_speed_ms: 10.779347977749522
2025-03-13 18:14:14,905 [INFO]: 	99p_search_speed_ms: 14.62843005778268
2025-03-13 18:14:14,905 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:14,905 [INFO]: 	nb vectors: 2915
2025-03-13 18:14:14,905 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:14,905 [INFO]: 	compression ratio: 0.9993098092851863
2025-03-13 18:14:14,905 [INFO]: }
2025-03-13 18:14:14,905 [INFO]: 	>>> Finished "Creating the index" in 72.4520 secs
2025-03-13 18:14:14,905 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4762 secs
2025-03-13 18:14:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 85608 [episode count 18/20]
[retrieval_preprocessing] for episode 12156 [episode count 19/20], we have num_retrieval=np.int64(2939) num_query=np.int64(135)
2025-03-13 18:14:18,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:18,929 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:18
2025-03-13 18:14:18,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2318.58it/s]
2025-03-13 18:14:18,963 [INFO]: There are 2939 embeddings of dim 49152
2025-03-13 18:14:18,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 18:14:18,963 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:18
2025-03-13 18:14:18,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:18,963 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 18:14:18,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:18,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:18,964 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:18
2025-03-13 18:14:18,964 [INFO]: 606.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:18,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:18,964 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:18
2025-03-13 18:14:18,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:18,964 [INFO]: 	Creating the index 03/13/2025, 18:14:18
2025-03-13 18:14:18,964 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:18
2025-03-13 18:14:18,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:14:18,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:18
2025-03-13 18:14:18,966 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:14:18,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.30it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.95it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.91it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.25it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.53it/s] 50%|█████     | 6/12 [00:00<00:00,  8.63it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.80it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.74it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.66it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.71it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.85it/s]100%|██████████| 12/12 [00:03<00:00,  1.30it/s]100%|██████████| 12/12 [00:03<00:00,  3.34it/s]
2025-03-13 18:14:22,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:22
2025-03-13 18:14:58,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2136 secs
2025-03-13 18:14:58,773 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 18:14:58,773 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 18:15:31,196 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4227 secs
2025-03-13 18:15:31,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2333 secs
2025-03-13 18:15:31,199 [INFO]: {
2025-03-13 18:15:31,199 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:31,199 [INFO]: 	index_param: efSearch=252
2025-03-13 18:15:31,199 [INFO]: 	index_path: knn.index
2025-03-13 18:15:31,199 [INFO]: 	size in bytes: 578230030
2025-03-13 18:15:31,199 [INFO]: 	avg_search_speed_ms: 10.32763173296655
2025-03-13 18:15:31,199 [INFO]: 	99p_search_speed_ms: 14.187977286055686
2025-03-13 18:15:31,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:31,199 [INFO]: 	nb vectors: 2939
2025-03-13 18:15:31,199 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:31,199 [INFO]: 	compression ratio: 0.9993097591282141
2025-03-13 18:15:31,199 [INFO]: }
2025-03-13 18:15:31,199 [INFO]: 	>>> Finished "Creating the index" in 72.2351 secs
2025-03-13 18:15:31,199 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2696 secs
2025-03-13 18:15:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 12156 [episode count 19/20]
2025-03-13 18:15:32: [retrieval_preprocessing] finished for 9934859632_put_marker_in_bowl [chosen_id count 5/196]
2025-03-13 18:15:32: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
