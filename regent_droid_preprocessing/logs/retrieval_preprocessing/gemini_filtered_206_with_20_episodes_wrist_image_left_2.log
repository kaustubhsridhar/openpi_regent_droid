2025-03-13 14:35:00: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_remove_cans_from_tray [chosen_id count 0/196]
2025-03-13 14:35:10: [retrieval_preprocessing] we have num_total=9961 embedding_dim=49152
[retrieval_preprocessing] for episode 41050 [episode count 0/20], we have num_retrieval=np.int64(9451) num_query=np.int64(510)
2025-03-13 14:35:14,512 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:16,420 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:16
2025-03-13 14:35:16,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 684.78it/s]
2025-03-13 14:35:16,457 [INFO]: There are 9451 embeddings of dim 49152
2025-03-13 14:35:16,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 14:35:16,457 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:16
2025-03-13 14:35:16,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:16,458 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:35:16,458 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:35:16,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:16,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:16
2025-03-13 14:35:16,458 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:16,459 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0009 secs
2025-03-13 14:35:16,459 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:16
2025-03-13 14:35:16,459 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:16,459 [INFO]: 	Creating the index 03/13/2025, 14:35:16
2025-03-13 14:35:16,459 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:16
2025-03-13 14:35:16,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 14:35:16,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:16
2025-03-13 14:35:16,461 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:35:16,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  5.53it/s]  8%|▊         | 3/39 [00:00<00:03, 11.62it/s] 13%|█▎        | 5/39 [00:00<00:02, 11.95it/s] 18%|█▊        | 7/39 [00:00<00:02, 13.66it/s] 23%|██▎       | 9/39 [00:00<00:02, 14.16it/s] 28%|██▊       | 11/39 [00:00<00:02, 12.35it/s] 33%|███▎      | 13/39 [00:01<00:01, 14.00it/s] 38%|███▊      | 15/39 [00:01<00:01, 15.14it/s] 44%|████▎     | 17/39 [00:01<00:01, 15.87it/s] 49%|████▊     | 19/39 [00:01<00:01, 16.39it/s] 54%|█████▍    | 21/39 [00:05<00:12,  1.39it/s] 59%|█████▉    | 23/39 [00:05<00:08,  1.89it/s] 64%|██████▍   | 25/39 [00:06<00:05,  2.50it/s] 69%|██████▉   | 27/39 [00:06<00:03,  3.25it/s] 74%|███████▍  | 29/39 [00:06<00:02,  4.13it/s] 79%|███████▉  | 31/39 [00:06<00:01,  5.00it/s] 85%|████████▍ | 33/39 [00:06<00:01,  5.73it/s] 87%|████████▋ | 34/39 [00:07<00:00,  6.12it/s] 90%|████████▉ | 35/39 [00:07<00:00,  6.49it/s] 92%|█████████▏| 36/39 [00:07<00:00,  6.85it/s] 95%|█████████▍| 37/39 [00:07<00:00,  7.18it/s] 97%|█████████▋| 38/39 [00:07<00:00,  7.47it/s]100%|██████████| 39/39 [00:11<00:00,  1.19s/it]100%|██████████| 39/39 [00:11<00:00,  3.36it/s]
2025-03-13 14:35:28,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:28
2025-03-13 14:37:00,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.7507 secs
2025-03-13 14:37:00,829 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 14:37:00,829 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.93it/s]
2025-03-13 14:37:27,372 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5427 secs
2025-03-13 14:37:27,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.9150 secs
2025-03-13 14:37:27,376 [INFO]: {
2025-03-13 14:37:27,376 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:27,376 [INFO]: 	index_param: efSearch=168
2025-03-13 14:37:27,376 [INFO]: 	index_path: knn.index
2025-03-13 14:37:27,376 [INFO]: 	size in bytes: 1859428270
2025-03-13 14:37:27,376 [INFO]: 	avg_search_speed_ms: 12.465405961593842
2025-03-13 14:37:27,376 [INFO]: 	99p_search_speed_ms: 20.3814368438907
2025-03-13 14:37:27,376 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:27,376 [INFO]: 	nb vectors: 9451
2025-03-13 14:37:27,376 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:27,376 [INFO]: 	compression ratio: 0.9993083562185489
2025-03-13 14:37:27,376 [INFO]: }
2025-03-13 14:37:27,376 [INFO]: 	>>> Finished "Creating the index" in 130.9173 secs
2025-03-13 14:37:27,376 [INFO]: >>> Finished "Launching the whole pipeline" in 130.9560 secs
2025-03-13 14:37:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 41050 [episode count 0/20]
[retrieval_preprocessing] for episode 72083 [episode count 1/20], we have num_retrieval=np.int64(9474) num_query=np.int64(487)
2025-03-13 14:37:33,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:35,107 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:35
2025-03-13 14:37:35,107 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.78it/s]
2025-03-13 14:37:35,139 [INFO]: There are 9474 embeddings of dim 49152
2025-03-13 14:37:35,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 14:37:35,139 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:35,139 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:37:35,139 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:37:35,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:35,139 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,139 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:35,139 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:35,139 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:35
2025-03-13 14:37:35,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:35,140 [INFO]: 	Creating the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:35
2025-03-13 14:37:35,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:37:35,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:35
2025-03-13 14:37:35,141 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:37:35,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  6.05it/s] 13%|█▎        | 5/39 [00:00<00:01, 21.15it/s] 26%|██▌       | 10/39 [00:00<00:00, 30.88it/s] 38%|███▊      | 15/39 [00:00<00:00, 36.15it/s] 51%|█████▏    | 20/39 [00:00<00:00, 39.26it/s] 64%|██████▍   | 25/39 [00:06<00:05,  2.41it/s] 74%|███████▍  | 29/39 [00:06<00:03,  3.32it/s] 85%|████████▍ | 33/39 [00:06<00:01,  4.53it/s] 95%|█████████▍| 37/39 [00:06<00:00,  6.10it/s]100%|██████████| 39/39 [00:12<00:00,  3.07it/s]
2025-03-13 14:37:47,868 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:47
2025-03-13 14:39:24,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.0099 secs
2025-03-13 14:39:24,879 [INFO]: The best hyperparameters are: efSearch=122
2025-03-13 14:39:24,879 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.53it/s]
2025-03-13 14:39:55,361 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4819 secs
2025-03-13 14:39:55,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.2240 secs
2025-03-13 14:39:55,365 [INFO]: {
2025-03-13 14:39:55,365 [INFO]: 	index_key: HNSW15
2025-03-13 14:39:55,365 [INFO]: 	index_param: efSearch=122
2025-03-13 14:39:55,365 [INFO]: 	index_path: knn.index
2025-03-13 14:39:55,365 [INFO]: 	size in bytes: 1863953350
2025-03-13 14:39:55,365 [INFO]: 	avg_search_speed_ms: 8.128630066275354
2025-03-13 14:39:55,365 [INFO]: 	99p_search_speed_ms: 17.48933469876648
2025-03-13 14:39:55,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:55,365 [INFO]: 	nb vectors: 9474
2025-03-13 14:39:55,365 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:55,365 [INFO]: 	compression ratio: 0.9993083743217072
2025-03-13 14:39:55,365 [INFO]: }
2025-03-13 14:39:55,365 [INFO]: 	>>> Finished "Creating the index" in 140.2257 secs
2025-03-13 14:39:55,365 [INFO]: >>> Finished "Launching the whole pipeline" in 140.2585 secs
2025-03-13 14:39:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 72083 [episode count 1/20]
[retrieval_preprocessing] for episode 37309 [episode count 2/20], we have num_retrieval=np.int64(9396) num_query=np.int64(565)
2025-03-13 14:40:01,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:02,697 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:02
2025-03-13 14:40:02,697 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1587.55it/s]
2025-03-13 14:40:02,731 [INFO]: There are 9396 embeddings of dim 49152
2025-03-13 14:40:02,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 14:40:02,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:02
2025-03-13 14:40:02,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:02,733 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:40:02,733 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:40:02,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:40:02,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:02
2025-03-13 14:40:02,734 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:02,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:40:02,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:02
2025-03-13 14:40:02,735 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:40:02,735 [INFO]: 	Creating the index 03/13/2025, 14:40:02
2025-03-13 14:40:02,735 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:02
2025-03-13 14:40:02,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:40:02,738 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:02
2025-03-13 14:40:02,738 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:40:02,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  7.31it/s] 13%|█▎        | 5/38 [00:00<00:01, 22.09it/s] 24%|██▎       | 9/38 [00:00<00:01, 28.76it/s] 34%|███▍      | 13/38 [00:00<00:00, 25.42it/s] 42%|████▏     | 16/38 [00:00<00:00, 23.82it/s] 53%|█████▎    | 20/38 [00:00<00:00, 26.04it/s] 61%|██████    | 23/38 [00:07<00:10,  1.39it/s] 74%|███████▎  | 28/38 [00:08<00:04,  2.30it/s] 87%|████████▋ | 33/38 [00:08<00:01,  3.54it/s]100%|██████████| 38/38 [00:13<00:00,  1.94it/s]100%|██████████| 38/38 [00:13<00:00,  2.92it/s]
2025-03-13 14:40:15,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:15
2025-03-13 14:41:58,941 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 103.1762 secs
2025-03-13 14:41:58,941 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 14:41:58,941 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.53it/s]
2025-03-13 14:42:29,823 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8812 secs
2025-03-13 14:42:30,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.9168 secs
2025-03-13 14:42:30,656 [INFO]: {
2025-03-13 14:42:30,656 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:30,656 [INFO]: 	index_param: efSearch=136
2025-03-13 14:42:30,656 [INFO]: 	index_path: knn.index
2025-03-13 14:42:30,656 [INFO]: 	size in bytes: 1848607510
2025-03-13 14:42:30,656 [INFO]: 	avg_search_speed_ms: 10.35507042134493
2025-03-13 14:42:30,656 [INFO]: 	99p_search_speed_ms: 17.703973618336022
2025-03-13 14:42:30,656 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:30,656 [INFO]: 	nb vectors: 9396
2025-03-13 14:42:30,656 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:30,656 [INFO]: 	compression ratio: 0.9993082674428819
2025-03-13 14:42:30,656 [INFO]: }
2025-03-13 14:42:30,656 [INFO]: 	>>> Finished "Creating the index" in 147.9211 secs
2025-03-13 14:42:30,656 [INFO]: >>> Finished "Launching the whole pipeline" in 147.9593 secs
2025-03-13 14:42:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 37309 [episode count 2/20]
[retrieval_preprocessing] for episode 80415 [episode count 3/20], we have num_retrieval=np.int64(9589) num_query=np.int64(372)
2025-03-13 14:42:35,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:37,199 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:37
2025-03-13 14:42:37,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.82it/s]
2025-03-13 14:42:37,228 [INFO]: There are 9589 embeddings of dim 49152
2025-03-13 14:42:37,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 14:42:37,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:37
2025-03-13 14:42:37,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:37,228 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 14:42:37,228 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:42:37,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:37,228 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:37
2025-03-13 14:42:37,228 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:37,229 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:42:37,229 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:37
2025-03-13 14:42:37,229 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:37,229 [INFO]: 	Creating the index 03/13/2025, 14:42:37
2025-03-13 14:42:37,229 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:42:37
2025-03-13 14:42:37,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 14:42:37,230 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:37
2025-03-13 14:42:37,230 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 14:42:37,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:09,  4.07it/s]  5%|▌         | 2/39 [00:00<00:06,  5.73it/s]  8%|▊         | 3/39 [00:00<00:05,  6.56it/s] 10%|█         | 4/39 [00:00<00:04,  7.09it/s] 13%|█▎        | 5/39 [00:00<00:04,  7.42it/s] 15%|█▌        | 6/39 [00:00<00:04,  7.73it/s] 18%|█▊        | 7/39 [00:00<00:04,  7.82it/s] 21%|██        | 8/39 [00:01<00:03,  7.85it/s] 23%|██▎       | 9/39 [00:01<00:03,  7.92it/s] 26%|██▌       | 10/39 [00:01<00:03,  7.97it/s] 28%|██▊       | 11/39 [00:01<00:03,  8.05it/s] 31%|███       | 12/39 [00:01<00:03,  8.16it/s] 33%|███▎      | 13/39 [00:01<00:03,  7.89it/s] 36%|███▌      | 14/39 [00:01<00:03,  7.95it/s] 38%|███▊      | 15/39 [00:01<00:03,  7.92it/s] 41%|████      | 16/39 [00:02<00:02,  7.99it/s] 44%|████▎     | 17/39 [00:02<00:02,  8.12it/s] 49%|████▊     | 19/39 [00:02<00:02,  9.15it/s] 54%|█████▍    | 21/39 [00:07<00:20,  1.12s/it] 56%|█████▋    | 22/39 [00:07<00:15,  1.12it/s] 59%|█████▉    | 23/39 [00:07<00:11,  1.41it/s] 62%|██████▏   | 24/39 [00:08<00:08,  1.81it/s] 64%|██████▍   | 25/39 [00:08<00:06,  2.31it/s] 67%|██████▋   | 26/39 [00:08<00:04,  2.90it/s] 72%|███████▏  | 28/39 [00:08<00:02,  4.28it/s] 74%|███████▍  | 29/39 [00:08<00:02,  4.95it/s] 79%|███████▉  | 31/39 [00:08<00:01,  6.25it/s] 85%|████████▍ | 33/39 [00:08<00:00,  7.40it/s] 90%|████████▉ | 35/39 [00:09<00:00,  8.54it/s] 95%|█████████▍| 37/39 [00:09<00:00,  9.68it/s]100%|██████████| 39/39 [00:15<00:00,  1.13s/it]100%|██████████| 39/39 [00:15<00:00,  2.45it/s]
2025-03-13 14:42:53,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:53
2025-03-13 14:44:17,928 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.0697 secs
2025-03-13 14:44:17,928 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 14:44:17,928 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 14:44:54,295 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3661 secs
2025-03-13 14:44:54,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.0694 secs
2025-03-13 14:44:54,300 [INFO]: {
2025-03-13 14:44:54,300 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:54,300 [INFO]: 	index_param: efSearch=136
2025-03-13 14:44:54,300 [INFO]: 	index_path: knn.index
2025-03-13 14:44:54,300 [INFO]: 	size in bytes: 1886578990
2025-03-13 14:44:54,300 [INFO]: 	avg_search_speed_ms: 10.301848021699998
2025-03-13 14:44:54,300 [INFO]: 	99p_search_speed_ms: 21.52496899710965
2025-03-13 14:44:54,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:54,300 [INFO]: 	nb vectors: 9589
2025-03-13 14:44:54,300 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:54,300 [INFO]: 	compression ratio: 0.9993083364084321
2025-03-13 14:44:54,300 [INFO]: }
2025-03-13 14:44:54,300 [INFO]: 	>>> Finished "Creating the index" in 137.0716 secs
2025-03-13 14:44:54,300 [INFO]: >>> Finished "Launching the whole pipeline" in 137.1008 secs
2025-03-13 14:44:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 80415 [episode count 3/20]
[retrieval_preprocessing] for episode 51836 [episode count 4/20], we have num_retrieval=np.int64(9434) num_query=np.int64(527)
2025-03-13 14:45:01,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:03,019 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:03
2025-03-13 14:45:03,019 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1087.17it/s]
2025-03-13 14:45:03,048 [INFO]: There are 9434 embeddings of dim 49152
2025-03-13 14:45:03,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 14:45:03,049 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:03
2025-03-13 14:45:03,049 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:03,049 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:45:03,049 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:45:03,049 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:45:03,049 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:03
2025-03-13 14:45:03,049 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:03,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:45:03,049 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:03
2025-03-13 14:45:03,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:03,049 [INFO]: 	Creating the index 03/13/2025, 14:45:03
2025-03-13 14:45:03,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:03
2025-03-13 14:45:03,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:45:03,051 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:03
2025-03-13 14:45:03,051 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:45:03,051 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:08,  4.47it/s]  8%|▊         | 3/39 [00:00<00:04,  8.26it/s] 13%|█▎        | 5/39 [00:00<00:03,  9.66it/s] 18%|█▊        | 7/39 [00:00<00:03, 10.36it/s] 23%|██▎       | 9/39 [00:00<00:02, 10.81it/s] 28%|██▊       | 11/39 [00:01<00:03,  8.95it/s] 31%|███       | 12/39 [00:01<00:03,  8.85it/s] 33%|███▎      | 13/39 [00:01<00:02,  8.75it/s] 36%|███▌      | 14/39 [00:01<00:02,  8.64it/s] 41%|████      | 16/39 [00:01<00:02, 10.62it/s] 46%|████▌     | 18/39 [00:01<00:01, 12.70it/s] 51%|█████▏    | 20/39 [00:01<00:01, 12.79it/s] 56%|█████▋    | 22/39 [00:06<00:14,  1.18it/s] 64%|██████▍   | 25/39 [00:06<00:07,  1.95it/s] 72%|███████▏  | 28/39 [00:07<00:03,  2.95it/s] 79%|███████▉  | 31/39 [00:07<00:01,  4.22it/s] 87%|████████▋ | 34/39 [00:07<00:00,  5.72it/s] 95%|█████████▍| 37/39 [00:07<00:00,  7.45it/s]100%|██████████| 39/39 [00:13<00:00,  1.28it/s]100%|██████████| 39/39 [00:13<00:00,  2.95it/s]
2025-03-13 14:45:16,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:16
2025-03-13 14:46:52,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.6598 secs
2025-03-13 14:46:52,955 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 14:46:52,955 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.16it/s]
2025-03-13 14:47:27,755 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8001 secs
2025-03-13 14:47:27,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.7078 secs
2025-03-13 14:47:27,759 [INFO]: {
2025-03-13 14:47:27,759 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:27,759 [INFO]: 	index_param: efSearch=114
2025-03-13 14:47:27,759 [INFO]: 	index_path: knn.index
2025-03-13 14:47:27,759 [INFO]: 	size in bytes: 1856083690
2025-03-13 14:47:27,759 [INFO]: 	avg_search_speed_ms: 8.487689172641923
2025-03-13 14:47:27,759 [INFO]: 	99p_search_speed_ms: 15.021809029858575
2025-03-13 14:47:27,759 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:27,759 [INFO]: 	nb vectors: 9434
2025-03-13 14:47:27,759 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:27,759 [INFO]: 	compression ratio: 0.999308318904521
2025-03-13 14:47:27,759 [INFO]: }
2025-03-13 14:47:27,759 [INFO]: 	>>> Finished "Creating the index" in 144.7096 secs
2025-03-13 14:47:27,759 [INFO]: >>> Finished "Launching the whole pipeline" in 144.7396 secs
2025-03-13 14:47:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 51836 [episode count 4/20]
[retrieval_preprocessing] for episode 17043 [episode count 5/20], we have num_retrieval=np.int64(9535) num_query=np.int64(426)
2025-03-13 14:47:33,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:35,735 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:35
2025-03-13 14:47:35,735 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 14:47:35,764 [INFO]: There are 9535 embeddings of dim 49152
2025-03-13 14:47:35,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 14:47:35,765 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:35
2025-03-13 14:47:35,765 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:35,765 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:47:35,765 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:47:35,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:35,765 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:35
2025-03-13 14:47:35,765 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:35,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:35,765 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:35
2025-03-13 14:47:35,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:35,765 [INFO]: 	Creating the index 03/13/2025, 14:47:35
2025-03-13 14:47:35,765 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:35
2025-03-13 14:47:35,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:47:35,766 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:35
2025-03-13 14:47:35,766 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:47:35,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:09,  4.16it/s]  8%|▊         | 3/39 [00:00<00:04,  7.71it/s] 13%|█▎        | 5/39 [00:00<00:03, 10.17it/s] 18%|█▊        | 7/39 [00:00<00:02, 11.85it/s] 23%|██▎       | 9/39 [00:00<00:02, 12.72it/s] 28%|██▊       | 11/39 [00:00<00:02, 13.54it/s] 33%|███▎      | 13/39 [00:01<00:02, 12.77it/s] 38%|███▊      | 15/39 [00:01<00:02, 11.52it/s] 44%|████▎     | 17/39 [00:01<00:02, 10.87it/s] 49%|████▊     | 19/39 [00:01<00:01, 10.37it/s] 54%|█████▍    | 21/39 [00:07<00:16,  1.07it/s] 56%|█████▋    | 22/39 [00:07<00:13,  1.28it/s] 62%|██████▏   | 24/39 [00:07<00:08,  1.82it/s] 67%|██████▋   | 26/39 [00:07<00:05,  2.50it/s] 72%|███████▏  | 28/39 [00:08<00:03,  3.28it/s] 77%|███████▋  | 30/39 [00:08<00:02,  4.19it/s] 82%|████████▏ | 32/39 [00:08<00:01,  5.17it/s] 87%|████████▋ | 34/39 [00:08<00:00,  6.20it/s] 92%|█████████▏| 36/39 [00:08<00:00,  7.19it/s] 97%|█████████▋| 38/39 [00:08<00:00,  8.06it/s]100%|██████████| 39/39 [00:14<00:00,  2.77it/s]
2025-03-13 14:47:49,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:49
2025-03-13 14:49:19,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.1894 secs
2025-03-13 14:49:19,036 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 14:49:19,036 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-13 14:50:10,036 [INFO]: 	>>> Finished "Compute fast metrics" in 50.9991 secs
2025-03-13 14:50:10,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.2735 secs
2025-03-13 14:50:10,040 [INFO]: {
2025-03-13 14:50:10,040 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:10,040 [INFO]: 	index_param: efSearch=193
2025-03-13 14:50:10,040 [INFO]: 	index_path: knn.index
2025-03-13 14:50:10,040 [INFO]: 	size in bytes: 1875954790
2025-03-13 14:50:10,040 [INFO]: 	avg_search_speed_ms: 10.928868007963228
2025-03-13 14:50:10,040 [INFO]: 	99p_search_speed_ms: 19.15868243202567
2025-03-13 14:50:10,040 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:10,040 [INFO]: 	nb vectors: 9535
2025-03-13 14:50:10,040 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:10,040 [INFO]: 	compression ratio: 0.9993083468711951
2025-03-13 14:50:10,040 [INFO]: }
2025-03-13 14:50:10,040 [INFO]: 	>>> Finished "Creating the index" in 154.2753 secs
2025-03-13 14:50:10,041 [INFO]: >>> Finished "Launching the whole pipeline" in 154.3053 secs
2025-03-13 14:50:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 17043 [episode count 5/20]
[retrieval_preprocessing] for episode 74422 [episode count 6/20], we have num_retrieval=np.int64(9614) num_query=np.int64(347)
2025-03-13 14:50:18,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:20,794 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:20
2025-03-13 14:50:20,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.69it/s]
2025-03-13 14:50:20,828 [INFO]: There are 9614 embeddings of dim 49152
2025-03-13 14:50:20,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 14:50:20,828 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:20
2025-03-13 14:50:20,829 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:20,829 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 14:50:20,829 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:50:20,829 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:50:20,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:20
2025-03-13 14:50:20,830 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:20,830 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:50:20,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:20
2025-03-13 14:50:20,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:20,831 [INFO]: 	Creating the index 03/13/2025, 14:50:20
2025-03-13 14:50:20,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:20
2025-03-13 14:50:20,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 14:50:20,835 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:20
2025-03-13 14:50:20,835 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 14:50:20,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:11,  3.44it/s]  5%|▌         | 2/39 [00:00<00:07,  4.78it/s]  8%|▊         | 3/39 [00:00<00:05,  6.13it/s] 10%|█         | 4/39 [00:00<00:04,  7.02it/s] 15%|█▌        | 6/39 [00:00<00:03, 10.20it/s] 23%|██▎       | 9/39 [00:00<00:02, 14.63it/s] 33%|███▎      | 13/39 [00:01<00:01, 19.97it/s] 44%|████▎     | 17/39 [00:01<00:00, 24.53it/s] 54%|█████▍    | 21/39 [00:06<00:08,  2.08it/s] 59%|█████▉    | 23/39 [00:06<00:06,  2.50it/s] 64%|██████▍   | 25/39 [00:06<00:04,  3.03it/s] 69%|██████▉   | 27/39 [00:06<00:03,  3.69it/s] 74%|███████▍  | 29/39 [00:06<00:02,  4.45it/s] 79%|███████▉  | 31/39 [00:06<00:01,  5.17it/s] 85%|████████▍ | 33/39 [00:07<00:01,  5.77it/s] 90%|████████▉ | 35/39 [00:07<00:00,  6.49it/s] 95%|█████████▍| 37/39 [00:07<00:00,  7.14it/s] 97%|█████████▋| 38/39 [00:07<00:00,  7.48it/s]100%|██████████| 39/39 [00:12<00:00,  1.02it/s]100%|██████████| 39/39 [00:12<00:00,  3.19it/s]
2025-03-13 14:50:33,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:33
2025-03-13 14:51:49,117 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.0421 secs
2025-03-13 14:51:49,118 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 14:51:49,118 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-13 14:52:28,868 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7499 secs
2025-03-13 14:52:28,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.0389 secs
2025-03-13 14:52:28,875 [INFO]: {
2025-03-13 14:52:28,875 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:28,875 [INFO]: 	index_param: efSearch=189
2025-03-13 14:52:28,875 [INFO]: 	index_path: knn.index
2025-03-13 14:52:28,875 [INFO]: 	size in bytes: 1891497550
2025-03-13 14:52:28,875 [INFO]: 	avg_search_speed_ms: 11.439025206533975
2025-03-13 14:52:28,875 [INFO]: 	99p_search_speed_ms: 17.047578007914122
2025-03-13 14:52:28,875 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:28,875 [INFO]: 	nb vectors: 9614
2025-03-13 14:52:28,875 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:28,875 [INFO]: 	compression ratio: 0.9993083586071787
2025-03-13 14:52:28,875 [INFO]: }
2025-03-13 14:52:28,875 [INFO]: 	>>> Finished "Creating the index" in 128.0439 secs
2025-03-13 14:52:28,875 [INFO]: >>> Finished "Launching the whole pipeline" in 128.0807 secs
2025-03-13 14:52:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 74422 [episode count 6/20]
[retrieval_preprocessing] for episode 80567 [episode count 7/20], we have num_retrieval=np.int64(9406) num_query=np.int64(555)
2025-03-13 14:52:36,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:37,757 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:37
2025-03-13 14:52:37,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1993.49it/s]
2025-03-13 14:52:37,779 [INFO]: There are 9406 embeddings of dim 49152
2025-03-13 14:52:37,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 14:52:37,779 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:37
2025-03-13 14:52:37,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:37,780 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:52:37,780 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:52:37,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:37,780 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:37
2025-03-13 14:52:37,780 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:37,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:52:37,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:37
2025-03-13 14:52:37,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:37,780 [INFO]: 	Creating the index 03/13/2025, 14:52:37
2025-03-13 14:52:37,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:37
2025-03-13 14:52:37,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:52:37,781 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:37
2025-03-13 14:52:37,781 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:52:37,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:08,  4.75it/s]  8%|▊         | 3/39 [00:00<00:04,  8.67it/s] 13%|█▎        | 5/39 [00:00<00:03,  9.91it/s] 18%|█▊        | 7/39 [00:00<00:03, 10.57it/s] 23%|██▎       | 9/39 [00:00<00:02, 10.99it/s] 28%|██▊       | 11/39 [00:01<00:02, 11.03it/s] 33%|███▎      | 13/39 [00:01<00:02, 10.00it/s] 38%|███▊      | 15/39 [00:01<00:02,  9.69it/s] 41%|████      | 16/39 [00:01<00:02,  9.36it/s] 44%|████▎     | 17/39 [00:01<00:02,  8.95it/s] 46%|████▌     | 18/39 [00:01<00:02,  8.54it/s] 49%|████▊     | 19/39 [00:02<00:02,  8.24it/s] 51%|█████▏    | 20/39 [00:02<00:02,  8.44it/s] 54%|█████▍    | 21/39 [00:06<00:22,  1.24s/it] 56%|█████▋    | 22/39 [00:06<00:15,  1.07it/s] 59%|█████▉    | 23/39 [00:06<00:11,  1.42it/s] 62%|██████▏   | 24/39 [00:06<00:08,  1.86it/s] 64%|██████▍   | 25/39 [00:06<00:05,  2.39it/s] 67%|██████▋   | 26/39 [00:07<00:04,  2.99it/s] 69%|██████▉   | 27/39 [00:07<00:03,  3.63it/s] 72%|███████▏  | 28/39 [00:07<00:02,  4.29it/s] 74%|███████▍  | 29/39 [00:07<00:02,  4.91it/s] 77%|███████▋  | 30/39 [00:07<00:01,  5.51it/s] 79%|███████▉  | 31/39 [00:07<00:01,  6.02it/s] 82%|████████▏ | 32/39 [00:07<00:01,  6.73it/s] 85%|████████▍ | 33/39 [00:07<00:00,  7.44it/s] 90%|████████▉ | 35/39 [00:08<00:00,  8.80it/s] 95%|█████████▍| 37/39 [00:08<00:00,  9.55it/s]100%|██████████| 39/39 [00:13<00:00,  1.03it/s]100%|██████████| 39/39 [00:13<00:00,  2.93it/s]
2025-03-13 14:52:51,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:51
2025-03-13 14:53:56,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.9191 secs
2025-03-13 14:53:56,011 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 14:53:56,011 [INFO]: 	Compute fast metrics 03/13/2025, 14:53:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 50%|█████     | 2/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 14:54:36,417 [INFO]: 	>>> Finished "Compute fast metrics" in 40.4062 secs
2025-03-13 14:54:36,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.6418 secs
2025-03-13 14:54:36,423 [INFO]: {
2025-03-13 14:54:36,423 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:36,423 [INFO]: 	index_param: efSearch=129
2025-03-13 14:54:36,423 [INFO]: 	index_path: knn.index
2025-03-13 14:54:36,423 [INFO]: 	size in bytes: 1850574910
2025-03-13 14:54:36,423 [INFO]: 	avg_search_speed_ms: 8.407348439902618
2025-03-13 14:54:36,423 [INFO]: 	99p_search_speed_ms: 16.198710771277547
2025-03-13 14:54:36,423 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:36,423 [INFO]: 	nb vectors: 9406
2025-03-13 14:54:36,423 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:36,423 [INFO]: 	compression ratio: 0.999308289552029
2025-03-13 14:54:36,423 [INFO]: }
2025-03-13 14:54:36,423 [INFO]: 	>>> Finished "Creating the index" in 118.6434 secs
2025-03-13 14:54:36,423 [INFO]: >>> Finished "Launching the whole pipeline" in 118.6664 secs
2025-03-13 14:54:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 80567 [episode count 7/20]
[retrieval_preprocessing] for episode 80644 [episode count 8/20], we have num_retrieval=np.int64(9486) num_query=np.int64(475)
2025-03-13 14:54:47,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:49,220 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:49
2025-03-13 14:54:49,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.40it/s]
2025-03-13 14:54:49,243 [INFO]: There are 9486 embeddings of dim 49152
2025-03-13 14:54:49,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 14:54:49,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:49
2025-03-13 14:54:49,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:49,243 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:54:49,243 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:54:49,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:54:49,243 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:49
2025-03-13 14:54:49,243 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:49,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:54:49,243 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:49
2025-03-13 14:54:49,243 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:49,243 [INFO]: 	Creating the index 03/13/2025, 14:54:49
2025-03-13 14:54:49,244 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:49
2025-03-13 14:54:49,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 14:54:49,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:49
2025-03-13 14:54:49,245 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:54:49,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:07,  4.99it/s]  5%|▌         | 2/39 [00:00<00:05,  6.63it/s]  8%|▊         | 3/39 [00:00<00:04,  7.66it/s] 13%|█▎        | 5/39 [00:00<00:03, 10.82it/s] 18%|█▊        | 7/39 [00:00<00:03, 10.54it/s] 23%|██▎       | 9/39 [00:00<00:03,  9.99it/s] 31%|███       | 12/39 [00:01<00:02, 13.18it/s] 38%|███▊      | 15/39 [00:01<00:01, 15.52it/s] 46%|████▌     | 18/39 [00:01<00:01, 17.10it/s] 51%|█████▏    | 20/39 [00:01<00:01, 17.42it/s] 56%|█████▋    | 22/39 [00:06<00:12,  1.39it/s] 64%|██████▍   | 25/39 [00:06<00:06,  2.11it/s] 72%|███████▏  | 28/39 [00:06<00:03,  3.07it/s] 79%|███████▉  | 31/39 [00:06<00:01,  4.32it/s] 87%|████████▋ | 34/39 [00:07<00:00,  5.89it/s] 95%|█████████▍| 37/39 [00:07<00:00,  7.78it/s]100%|██████████| 39/39 [00:11<00:00,  3.26it/s]
2025-03-13 14:55:01,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:55:01
2025-03-13 14:56:24,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.5729 secs
2025-03-13 14:56:24,797 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 14:56:24,797 [INFO]: 	Compute fast metrics 03/13/2025, 14:56:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.84s/it] 50%|█████     | 2/4 [00:02<00:02,  1.16s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.14it/s]
2025-03-13 14:56:57,342 [INFO]: 	>>> Finished "Compute fast metrics" in 32.5455 secs
2025-03-13 14:56:57,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.1029 secs
2025-03-13 14:56:57,348 [INFO]: {
2025-03-13 14:56:57,348 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:57,348 [INFO]: 	index_param: efSearch=133
2025-03-13 14:56:57,348 [INFO]: 	index_path: knn.index
2025-03-13 14:56:57,348 [INFO]: 	size in bytes: 1866314230
2025-03-13 14:56:57,348 [INFO]: 	avg_search_speed_ms: 8.47482963295464
2025-03-13 14:56:57,348 [INFO]: 	99p_search_speed_ms: 12.78747115284205
2025-03-13 14:56:57,348 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:57,348 [INFO]: 	nb vectors: 9486
2025-03-13 14:56:57,348 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:57,348 [INFO]: 	compression ratio: 0.9993084004937368
2025-03-13 14:56:57,348 [INFO]: }
2025-03-13 14:56:57,348 [INFO]: 	>>> Finished "Creating the index" in 128.1044 secs
2025-03-13 14:56:57,348 [INFO]: >>> Finished "Launching the whole pipeline" in 128.1280 secs
2025-03-13 14:56:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 80644 [episode count 8/20]
[retrieval_preprocessing] for episode 90434 [episode count 9/20], we have num_retrieval=np.int64(9535) num_query=np.int64(426)
2025-03-13 14:57:13,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:15,473 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:15
2025-03-13 14:57:15,473 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.14it/s]
2025-03-13 14:57:15,508 [INFO]: There are 9535 embeddings of dim 49152
2025-03-13 14:57:15,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 14:57:15,509 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:15
2025-03-13 14:57:15,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:15,509 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:57:15,509 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:57:15,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:57:15,509 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:15
2025-03-13 14:57:15,509 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:15,510 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 14:57:15,510 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:15
2025-03-13 14:57:15,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:15,510 [INFO]: 	Creating the index 03/13/2025, 14:57:15
2025-03-13 14:57:15,510 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:15
2025-03-13 14:57:15,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 14:57:15,511 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:15
2025-03-13 14:57:15,511 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:57:15,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  7.63it/s] 13%|█▎        | 5/39 [00:00<00:01, 24.14it/s] 26%|██▌       | 10/39 [00:00<00:00, 33.80it/s] 38%|███▊      | 15/39 [00:00<00:00, 38.63it/s] 51%|█████▏    | 20/39 [00:00<00:00, 41.24it/s] 64%|██████▍   | 25/39 [00:06<00:06,  2.27it/s] 77%|███████▋  | 30/39 [00:06<00:02,  3.37it/s] 92%|█████████▏| 36/39 [00:06<00:00,  5.15it/s]100%|██████████| 39/39 [00:10<00:00,  3.62it/s]
2025-03-13 14:57:26,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:57:26
2025-03-13 14:58:53,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.4385 secs
2025-03-13 14:58:53,717 [INFO]: The best hyperparameters are: efSearch=109
2025-03-13 14:58:53,717 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.49it/s] 50%|█████     | 2/4 [00:00<00:00,  5.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
2025-03-13 14:59:42,885 [INFO]: 	>>> Finished "Compute fast metrics" in 49.1679 secs
2025-03-13 14:59:43,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.5493 secs
2025-03-13 14:59:43,061 [INFO]: {
2025-03-13 14:59:43,061 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:43,061 [INFO]: 	index_param: efSearch=109
2025-03-13 14:59:43,061 [INFO]: 	index_path: knn.index
2025-03-13 14:59:43,061 [INFO]: 	size in bytes: 1875954790
2025-03-13 14:59:43,061 [INFO]: 	avg_search_speed_ms: 9.040356259818305
2025-03-13 14:59:43,062 [INFO]: 	99p_search_speed_ms: 15.104869997594506
2025-03-13 14:59:43,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:43,062 [INFO]: 	nb vectors: 9535
2025-03-13 14:59:43,062 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:43,062 [INFO]: 	compression ratio: 0.9993083468711951
2025-03-13 14:59:43,062 [INFO]: }
2025-03-13 14:59:43,062 [INFO]: 	>>> Finished "Creating the index" in 147.5521 secs
2025-03-13 14:59:43,062 [INFO]: >>> Finished "Launching the whole pipeline" in 147.5891 secs
2025-03-13 14:59:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 90434 [episode count 9/20]
[retrieval_preprocessing] for episode 79691 [episode count 10/20], we have num_retrieval=np.int64(9447) num_query=np.int64(514)
2025-03-13 14:59:47,314 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:51,124 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:51
2025-03-13 14:59:51,124 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 685.57it/s]
2025-03-13 14:59:51,171 [INFO]: There are 9447 embeddings of dim 49152
2025-03-13 14:59:51,171 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0469 secs
2025-03-13 14:59:51,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:51
2025-03-13 14:59:51,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:51,172 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 14:59:51,172 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:59:51,172 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 14:59:51,172 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:51
2025-03-13 14:59:51,173 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:51,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 14:59:51,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:51
2025-03-13 14:59:51,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:51,174 [INFO]: 	Creating the index 03/13/2025, 14:59:51
2025-03-13 14:59:51,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:51
2025-03-13 14:59:51,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 14:59:51,178 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:51
2025-03-13 14:59:51,179 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 14:59:51,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  6.09it/s] 10%|█         | 4/39 [00:00<00:02, 16.05it/s] 18%|█▊        | 7/39 [00:00<00:01, 20.69it/s] 26%|██▌       | 10/39 [00:00<00:01, 23.07it/s] 33%|███▎      | 13/39 [00:00<00:01, 24.32it/s] 41%|████      | 16/39 [00:00<00:00, 24.93it/s] 49%|████▊     | 19/39 [00:00<00:00, 26.11it/s] 56%|█████▋    | 22/39 [00:06<00:10,  1.62it/s] 69%|██████▉   | 27/39 [00:06<00:04,  2.79it/s] 82%|████████▏ | 32/39 [00:06<00:01,  4.35it/s] 95%|█████████▍| 37/39 [00:06<00:00,  6.37it/s]100%|██████████| 39/39 [00:11<00:00,  3.33it/s]
2025-03-13 15:00:02,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:02
2025-03-13 15:01:25,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.1158 secs
2025-03-13 15:01:25,030 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 15:01:25,030 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.33it/s]
2025-03-13 15:02:26,836 [INFO]: 	>>> Finished "Compute fast metrics" in 61.8053 secs
2025-03-13 15:02:26,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.6604 secs
2025-03-13 15:02:26,839 [INFO]: {
2025-03-13 15:02:26,839 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:26,839 [INFO]: 	index_param: efSearch=150
2025-03-13 15:02:26,839 [INFO]: 	index_path: knn.index
2025-03-13 15:02:26,839 [INFO]: 	size in bytes: 1858641310
2025-03-13 15:02:26,839 [INFO]: 	avg_search_speed_ms: 10.008861470661751
2025-03-13 15:02:26,839 [INFO]: 	99p_search_speed_ms: 19.39385857898742
2025-03-13 15:02:26,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:26,839 [INFO]: 	nb vectors: 9447
2025-03-13 15:02:26,839 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:26,839 [INFO]: 	compression ratio: 0.9993083474508592
2025-03-13 15:02:26,839 [INFO]: }
2025-03-13 15:02:26,839 [INFO]: 	>>> Finished "Creating the index" in 155.6653 secs
2025-03-13 15:02:26,839 [INFO]: >>> Finished "Launching the whole pipeline" in 155.7152 secs
2025-03-13 15:02:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 79691 [episode count 10/20]
[retrieval_preprocessing] for episode 89973 [episode count 11/20], we have num_retrieval=np.int64(9368) num_query=np.int64(593)
2025-03-13 15:02:31,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:33,078 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:33
2025-03-13 15:02:33,078 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.16it/s]
2025-03-13 15:02:33,109 [INFO]: There are 9368 embeddings of dim 49152
2025-03-13 15:02:33,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 15:02:33,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:33
2025-03-13 15:02:33,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:33,110 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 15:02:33,110 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:02:33,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:02:33,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:33
2025-03-13 15:02:33,110 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:33,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:02:33,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:33
2025-03-13 15:02:33,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:33,110 [INFO]: 	Creating the index 03/13/2025, 15:02:33
2025-03-13 15:02:33,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:33
2025-03-13 15:02:33,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:02:33,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:33
2025-03-13 15:02:33,111 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:02:33,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  7.06it/s] 11%|█         | 4/38 [00:00<00:01, 17.46it/s] 21%|██        | 8/38 [00:00<00:01, 26.29it/s] 32%|███▏      | 12/38 [00:00<00:00, 30.89it/s] 42%|████▏     | 16/38 [00:00<00:00, 33.56it/s] 53%|█████▎    | 20/38 [00:00<00:00, 35.53it/s] 63%|██████▎   | 24/38 [00:06<00:07,  1.95it/s] 71%|███████   | 27/38 [00:06<00:04,  2.60it/s] 79%|███████▉  | 30/38 [00:06<00:02,  3.48it/s] 89%|████████▉ | 34/38 [00:06<00:00,  5.03it/s]100%|██████████| 38/38 [00:12<00:00,  1.56it/s]100%|██████████| 38/38 [00:12<00:00,  2.93it/s]
2025-03-13 15:02:46,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:46
2025-03-13 15:04:18,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.3967 secs
2025-03-13 15:04:18,462 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 15:04:18,462 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.29it/s]
2025-03-13 15:04:53,484 [INFO]: 	>>> Finished "Compute fast metrics" in 35.0222 secs
2025-03-13 15:04:53,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.3771 secs
2025-03-13 15:04:53,489 [INFO]: {
2025-03-13 15:04:53,489 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:53,489 [INFO]: 	index_param: efSearch=112
2025-03-13 15:04:53,489 [INFO]: 	index_path: knn.index
2025-03-13 15:04:53,489 [INFO]: 	size in bytes: 1843098790
2025-03-13 15:04:53,489 [INFO]: 	avg_search_speed_ms: 8.777253457105491
2025-03-13 15:04:53,489 [INFO]: 	99p_search_speed_ms: 12.781913219951091
2025-03-13 15:04:53,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:53,489 [INFO]: 	nb vectors: 9368
2025-03-13 15:04:53,489 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:53,489 [INFO]: 	compression ratio: 0.9993082052861637
2025-03-13 15:04:53,489 [INFO]: }
2025-03-13 15:04:53,489 [INFO]: 	>>> Finished "Creating the index" in 140.3789 secs
2025-03-13 15:04:53,489 [INFO]: >>> Finished "Launching the whole pipeline" in 140.4108 secs
2025-03-13 15:04:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 89973 [episode count 11/20]
[retrieval_preprocessing] for episode 7521 [episode count 12/20], we have num_retrieval=np.int64(9393) num_query=np.int64(568)
2025-03-13 15:04:58,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:59,614 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:59
2025-03-13 15:04:59,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.78it/s]
2025-03-13 15:04:59,645 [INFO]: There are 9393 embeddings of dim 49152
2025-03-13 15:04:59,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 15:04:59,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:59
2025-03-13 15:04:59,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:59,645 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:04:59,645 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:04:59,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:59,646 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:59
2025-03-13 15:04:59,646 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:59,646 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:04:59,646 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:59
2025-03-13 15:04:59,646 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:59,646 [INFO]: 	Creating the index 03/13/2025, 15:04:59
2025-03-13 15:04:59,646 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:59
2025-03-13 15:04:59,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:04:59,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:59
2025-03-13 15:04:59,647 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:04:59,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:07,  4.63it/s] 11%|█         | 4/38 [00:00<00:02, 14.38it/s] 21%|██        | 8/38 [00:00<00:01, 23.21it/s] 34%|███▍      | 13/38 [00:00<00:00, 29.90it/s] 45%|████▍     | 17/38 [00:00<00:00, 32.96it/s] 55%|█████▌    | 21/38 [00:05<00:07,  2.29it/s] 68%|██████▊   | 26/38 [00:05<00:03,  3.59it/s] 82%|████████▏ | 31/38 [00:05<00:01,  5.31it/s] 95%|█████████▍| 36/38 [00:05<00:00,  7.56it/s]100%|██████████| 38/38 [00:10<00:00,  3.60it/s]
2025-03-13 15:05:10,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:05:10
2025-03-13 15:06:34,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.7885 secs
2025-03-13 15:06:34,998 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:06:34,998 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-13 15:07:31,688 [INFO]: 	>>> Finished "Compute fast metrics" in 56.6893 secs
2025-03-13 15:07:31,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.0443 secs
2025-03-13 15:07:31,692 [INFO]: {
2025-03-13 15:07:31,692 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:31,692 [INFO]: 	index_param: efSearch=159
2025-03-13 15:07:31,692 [INFO]: 	index_path: knn.index
2025-03-13 15:07:31,692 [INFO]: 	size in bytes: 1848017290
2025-03-13 15:07:31,692 [INFO]: 	avg_search_speed_ms: 12.853343462317723
2025-03-13 15:07:31,692 [INFO]: 	99p_search_speed_ms: 23.0480675213039
2025-03-13 15:07:31,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:31,692 [INFO]: 	nb vectors: 9393
2025-03-13 15:07:31,692 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:31,692 [INFO]: 	compression ratio: 0.9993082608009582
2025-03-13 15:07:31,692 [INFO]: }
2025-03-13 15:07:31,692 [INFO]: 	>>> Finished "Creating the index" in 152.0459 secs
2025-03-13 15:07:31,692 [INFO]: >>> Finished "Launching the whole pipeline" in 152.0775 secs
2025-03-13 15:07:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 7521 [episode count 12/20]
[retrieval_preprocessing] for episode 91282 [episode count 13/20], we have num_retrieval=np.int64(9396) num_query=np.int64(565)
2025-03-13 15:07:37,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:39,406 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:39
2025-03-13 15:07:39,406 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 966.65it/s]
2025-03-13 15:07:39,436 [INFO]: There are 9396 embeddings of dim 49152
2025-03-13 15:07:39,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 15:07:39,437 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:39
2025-03-13 15:07:39,437 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:39,438 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:07:39,438 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:07:39,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:07:39,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:39
2025-03-13 15:07:39,438 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:39,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:07:39,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:39
2025-03-13 15:07:39,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:39,439 [INFO]: 	Creating the index 03/13/2025, 15:07:39
2025-03-13 15:07:39,439 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:39
2025-03-13 15:07:39,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:07:39,442 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:39
2025-03-13 15:07:39,442 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:07:39,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  7.23it/s] 13%|█▎        | 5/38 [00:00<00:01, 21.88it/s] 26%|██▋       | 10/38 [00:00<00:00, 30.13it/s] 39%|███▉      | 15/38 [00:00<00:00, 34.17it/s] 53%|█████▎    | 20/38 [00:00<00:00, 36.72it/s] 63%|██████▎   | 24/38 [00:06<00:06,  2.02it/s] 74%|███████▎  | 28/38 [00:06<00:03,  2.85it/s] 84%|████████▍ | 32/38 [00:06<00:01,  3.96it/s] 95%|█████████▍| 36/38 [00:07<00:00,  5.41it/s]100%|██████████| 38/38 [00:12<00:00,  2.96it/s]
2025-03-13 15:07:52,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:52
2025-03-13 15:09:25,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 93.0826 secs
2025-03-13 15:09:25,373 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 15:09:25,373 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.30it/s]
2025-03-13 15:10:03,708 [INFO]: 	>>> Finished "Compute fast metrics" in 38.3344 secs
2025-03-13 15:10:03,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.2688 secs
2025-03-13 15:10:03,711 [INFO]: {
2025-03-13 15:10:03,711 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:03,711 [INFO]: 	index_param: efSearch=123
2025-03-13 15:10:03,711 [INFO]: 	index_path: knn.index
2025-03-13 15:10:03,711 [INFO]: 	size in bytes: 1848607510
2025-03-13 15:10:03,711 [INFO]: 	avg_search_speed_ms: 9.570329137921833
2025-03-13 15:10:03,711 [INFO]: 	99p_search_speed_ms: 16.92860834300517
2025-03-13 15:10:03,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:03,711 [INFO]: 	nb vectors: 9396
2025-03-13 15:10:03,712 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:03,712 [INFO]: 	compression ratio: 0.9993082674428819
2025-03-13 15:10:03,712 [INFO]: }
2025-03-13 15:10:03,712 [INFO]: 	>>> Finished "Creating the index" in 144.2723 secs
2025-03-13 15:10:03,712 [INFO]: >>> Finished "Launching the whole pipeline" in 144.3056 secs
2025-03-13 15:10:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 91282 [episode count 13/20]
[retrieval_preprocessing] for episode 7320 [episode count 14/20], we have num_retrieval=np.int64(9511) num_query=np.int64(450)
2025-03-13 15:10:07,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:09,357 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:09
2025-03-13 15:10:09,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1385.63it/s]
2025-03-13 15:10:09,386 [INFO]: There are 9511 embeddings of dim 49152
2025-03-13 15:10:09,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:10:09,386 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:09
2025-03-13 15:10:09,386 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:09,386 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:10:09,387 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:10:09,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:09,387 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:09
2025-03-13 15:10:09,387 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:09,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:09,387 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:09
2025-03-13 15:10:09,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:09,387 [INFO]: 	Creating the index 03/13/2025, 15:10:09
2025-03-13 15:10:09,387 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:09
2025-03-13 15:10:09,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:10:09,388 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:09
2025-03-13 15:10:09,388 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:10:09,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  8.44it/s] 15%|█▌        | 6/39 [00:00<00:01, 28.35it/s] 28%|██▊       | 11/39 [00:00<00:00, 35.07it/s] 41%|████      | 16/39 [00:00<00:00, 38.31it/s] 54%|█████▍    | 21/39 [00:04<00:06,  2.87it/s] 67%|██████▋   | 26/39 [00:04<00:03,  4.30it/s] 79%|███████▉  | 31/39 [00:04<00:01,  6.20it/s] 92%|█████████▏| 36/39 [00:05<00:00,  8.63it/s]100%|██████████| 39/39 [00:09<00:00,  3.93it/s]
2025-03-13 15:10:19,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:19
2025-03-13 15:11:42,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.3933 secs
2025-03-13 15:11:42,978 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 15:11:42,978 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-13 15:12:15,678 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6997 secs
2025-03-13 15:12:15,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.2930 secs
2025-03-13 15:12:15,682 [INFO]: {
2025-03-13 15:12:15,682 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:15,682 [INFO]: 	index_param: efSearch=89
2025-03-13 15:12:15,682 [INFO]: 	index_path: knn.index
2025-03-13 15:12:15,682 [INFO]: 	size in bytes: 1871232910
2025-03-13 15:12:15,682 [INFO]: 	avg_search_speed_ms: 6.642896944248547
2025-03-13 15:12:15,682 [INFO]: 	99p_search_speed_ms: 11.581290289759638
2025-03-13 15:12:15,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:15,682 [INFO]: 	nb vectors: 9511
2025-03-13 15:12:15,682 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:15,682 [INFO]: 	compression ratio: 0.9993083586799465
2025-03-13 15:12:15,682 [INFO]: }
2025-03-13 15:12:15,682 [INFO]: 	>>> Finished "Creating the index" in 126.2947 secs
2025-03-13 15:12:15,682 [INFO]: >>> Finished "Launching the whole pipeline" in 126.3242 secs
2025-03-13 15:12:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 7320 [episode count 14/20]
[retrieval_preprocessing] for episode 5865 [episode count 15/20], we have num_retrieval=np.int64(9564) num_query=np.int64(397)
2025-03-13 15:12:19,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:21,794 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:21
2025-03-13 15:12:21,794 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1408.90it/s]
2025-03-13 15:12:21,824 [INFO]: There are 9564 embeddings of dim 49152
2025-03-13 15:12:21,825 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 15:12:21,825 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:21,825 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:12:21,825 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:12:21,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:12:21,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,825 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:21,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:12:21,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:21
2025-03-13 15:12:21,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:21,825 [INFO]: 	Creating the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:21
2025-03-13 15:12:21,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:12:21,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:21
2025-03-13 15:12:21,827 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:12:21,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.89it/s] 13%|█▎        | 5/39 [00:00<00:01, 20.98it/s] 26%|██▌       | 10/39 [00:00<00:00, 30.05it/s] 38%|███▊      | 15/39 [00:00<00:00, 34.83it/s] 51%|█████▏    | 20/39 [00:00<00:00, 37.69it/s] 62%|██████▏   | 24/39 [00:06<00:07,  2.06it/s] 74%|███████▍  | 29/39 [00:06<00:03,  3.13it/s] 87%|████████▋ | 34/39 [00:06<00:01,  4.56it/s]100%|██████████| 39/39 [00:12<00:00,  1.97it/s]100%|██████████| 39/39 [00:12<00:00,  3.16it/s]
2025-03-13 15:12:34,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:34
2025-03-13 15:13:59,644 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4836 secs
2025-03-13 15:13:59,645 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:13:59,645 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.55it/s]
2025-03-13 15:14:53,870 [INFO]: 	>>> Finished "Compute fast metrics" in 54.2246 secs
2025-03-13 15:14:53,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.0465 secs
2025-03-13 15:14:53,873 [INFO]: {
2025-03-13 15:14:53,873 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:53,873 [INFO]: 	index_param: efSearch=157
2025-03-13 15:14:53,873 [INFO]: 	index_path: knn.index
2025-03-13 15:14:53,873 [INFO]: 	size in bytes: 1881660310
2025-03-13 15:14:53,873 [INFO]: 	avg_search_speed_ms: 11.851025210093194
2025-03-13 15:14:53,873 [INFO]: 	99p_search_speed_ms: 20.398766107391555
2025-03-13 15:14:53,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:53,873 [INFO]: 	nb vectors: 9564
2025-03-13 15:14:53,873 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:53,873 [INFO]: 	compression ratio: 0.9993083778229876
2025-03-13 15:14:53,873 [INFO]: }
2025-03-13 15:14:53,874 [INFO]: 	>>> Finished "Creating the index" in 152.0482 secs
2025-03-13 15:14:53,874 [INFO]: >>> Finished "Launching the whole pipeline" in 152.0798 secs
2025-03-13 15:14:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 5865 [episode count 15/20]
[retrieval_preprocessing] for episode 79814 [episode count 16/20], we have num_retrieval=np.int64(9396) num_query=np.int64(565)
2025-03-13 15:14:58,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:00,028 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:00
2025-03-13 15:15:00,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 819.20it/s]
2025-03-13 15:15:00,060 [INFO]: There are 9396 embeddings of dim 49152
2025-03-13 15:15:00,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 15:15:00,060 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,061 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:00,061 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:15:00,061 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:15:00,061 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:15:00,061 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,061 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:00,061 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:15:00,061 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:00
2025-03-13 15:15:00,061 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:00,061 [INFO]: 	Creating the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,061 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:00
2025-03-13 15:15:00,062 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:15:00,062 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:00
2025-03-13 15:15:00,062 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:15:00,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  7.00it/s] 13%|█▎        | 5/38 [00:00<00:01, 20.15it/s] 21%|██        | 8/38 [00:00<00:01, 19.76it/s] 29%|██▉       | 11/38 [00:00<00:01, 22.04it/s] 39%|███▉      | 15/38 [00:00<00:00, 26.54it/s] 50%|█████     | 19/38 [00:00<00:00, 29.48it/s] 61%|██████    | 23/38 [00:05<00:06,  2.44it/s] 74%|███████▎  | 28/38 [00:05<00:02,  3.85it/s] 87%|████████▋ | 33/38 [00:05<00:00,  5.73it/s]100%|██████████| 38/38 [00:09<00:00,  2.46it/s]100%|██████████| 38/38 [00:09<00:00,  3.93it/s]
2025-03-13 15:15:09,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:09
2025-03-13 15:16:34,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.8382 secs
2025-03-13 15:16:34,581 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 15:16:34,581 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 15:17:23,100 [INFO]: 	>>> Finished "Compute fast metrics" in 48.5183 secs
2025-03-13 15:17:23,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.0406 secs
2025-03-13 15:17:23,103 [INFO]: {
2025-03-13 15:17:23,103 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:23,103 [INFO]: 	index_param: efSearch=181
2025-03-13 15:17:23,103 [INFO]: 	index_path: knn.index
2025-03-13 15:17:23,103 [INFO]: 	size in bytes: 1848607510
2025-03-13 15:17:23,103 [INFO]: 	avg_search_speed_ms: 11.58792404614225
2025-03-13 15:17:23,103 [INFO]: 	99p_search_speed_ms: 18.544452886562794
2025-03-13 15:17:23,103 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:23,103 [INFO]: 	nb vectors: 9396
2025-03-13 15:17:23,103 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:23,103 [INFO]: 	compression ratio: 0.9993082674428819
2025-03-13 15:17:23,103 [INFO]: }
2025-03-13 15:17:23,103 [INFO]: 	>>> Finished "Creating the index" in 143.0421 secs
2025-03-13 15:17:23,103 [INFO]: >>> Finished "Launching the whole pipeline" in 143.0753 secs
2025-03-13 15:17:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 79814 [episode count 16/20]
[retrieval_preprocessing] for episode 54262 [episode count 17/20], we have num_retrieval=np.int64(9388) num_query=np.int64(573)
2025-03-13 15:17:29,520 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:31,864 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:31
2025-03-13 15:17:31,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.46it/s]
2025-03-13 15:17:31,896 [INFO]: There are 9388 embeddings of dim 49152
2025-03-13 15:17:31,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 15:17:31,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:31,896 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:17:31,896 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:17:31,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:17:31,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,896 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:31,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:17:31,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:31
2025-03-13 15:17:31,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:31,896 [INFO]: 	Creating the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,897 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:31
2025-03-13 15:17:31,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:17:31,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:31
2025-03-13 15:17:31,898 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:17:31,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:06,  6.11it/s] 13%|█▎        | 5/38 [00:00<00:01, 20.20it/s] 24%|██▎       | 9/38 [00:00<00:01, 26.88it/s] 34%|███▍      | 13/38 [00:00<00:00, 30.44it/s] 45%|████▍     | 17/38 [00:00<00:00, 32.21it/s] 55%|█████▌    | 21/38 [00:08<00:12,  1.38it/s] 63%|██████▎   | 24/38 [00:08<00:07,  1.87it/s] 71%|███████   | 27/38 [00:08<00:04,  2.53it/s] 79%|███████▉  | 30/38 [00:08<00:02,  3.44it/s] 87%|████████▋ | 33/38 [00:08<00:01,  4.62it/s] 95%|█████████▍| 36/38 [00:09<00:00,  6.14it/s]100%|██████████| 38/38 [00:15<00:00,  2.47it/s]
2025-03-13 15:17:47,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:47
2025-03-13 15:19:03,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.1531 secs
2025-03-13 15:19:03,426 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 15:19:03,426 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.77it/s]
2025-03-13 15:19:57,904 [INFO]: 	>>> Finished "Compute fast metrics" in 54.4778 secs
2025-03-13 15:19:58,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.3258 secs
2025-03-13 15:19:58,224 [INFO]: {
2025-03-13 15:19:58,224 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:58,224 [INFO]: 	index_param: efSearch=163
2025-03-13 15:19:58,224 [INFO]: 	index_path: knn.index
2025-03-13 15:19:58,224 [INFO]: 	size in bytes: 1847033590
2025-03-13 15:19:58,224 [INFO]: 	avg_search_speed_ms: 11.437031636812858
2025-03-13 15:19:58,224 [INFO]: 	99p_search_speed_ms: 19.851993229240176
2025-03-13 15:19:58,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:58,224 [INFO]: 	nb vectors: 9388
2025-03-13 15:19:58,224 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:58,225 [INFO]: 	compression ratio: 0.9993082497216523
2025-03-13 15:19:58,225 [INFO]: }
2025-03-13 15:19:58,225 [INFO]: 	>>> Finished "Creating the index" in 146.3281 secs
2025-03-13 15:19:58,225 [INFO]: >>> Finished "Launching the whole pipeline" in 146.3606 secs
2025-03-13 15:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 54262 [episode count 17/20]
[retrieval_preprocessing] for episode 42052 [episode count 18/20], we have num_retrieval=np.int64(9362) num_query=np.int64(599)
2025-03-13 15:20:04,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:06,074 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:06
2025-03-13 15:20:06,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1871.62it/s]
2025-03-13 15:20:06,104 [INFO]: There are 9362 embeddings of dim 49152
2025-03-13 15:20:06,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 15:20:06,105 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:06
2025-03-13 15:20:06,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:06,105 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 15:20:06,105 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:20:06,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:06,105 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:06
2025-03-13 15:20:06,105 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:06,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:06,105 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:06
2025-03-13 15:20:06,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:06,105 [INFO]: 	Creating the index 03/13/2025, 15:20:06
2025-03-13 15:20:06,105 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:06
2025-03-13 15:20:06,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:20:06,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:06
2025-03-13 15:20:06,106 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:20:06,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  7.45it/s] 13%|█▎        | 5/38 [00:00<00:01, 23.41it/s] 26%|██▋       | 10/38 [00:00<00:00, 31.42it/s] 37%|███▋      | 14/38 [00:00<00:00, 34.28it/s] 47%|████▋     | 18/38 [00:00<00:00, 35.71it/s] 58%|█████▊    | 22/38 [00:05<00:07,  2.07it/s] 68%|██████▊   | 26/38 [00:06<00:03,  3.01it/s] 79%|███████▉  | 30/38 [00:06<00:01,  4.26it/s] 89%|████████▉ | 34/38 [00:06<00:00,  5.90it/s]100%|██████████| 38/38 [00:10<00:00,  2.22it/s]100%|██████████| 38/38 [00:10<00:00,  3.59it/s]
2025-03-13 15:20:16,703 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:16
2025-03-13 15:21:41,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.9829 secs
2025-03-13 15:21:41,686 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 15:21:41,686 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-13 15:22:32,087 [INFO]: 	>>> Finished "Compute fast metrics" in 50.4007 secs
2025-03-13 15:22:32,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.9839 secs
2025-03-13 15:22:32,090 [INFO]: {
2025-03-13 15:22:32,090 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:32,090 [INFO]: 	index_param: efSearch=135
2025-03-13 15:22:32,090 [INFO]: 	index_path: knn.index
2025-03-13 15:22:32,090 [INFO]: 	size in bytes: 1841918350
2025-03-13 15:22:32,090 [INFO]: 	avg_search_speed_ms: 9.480118240401925
2025-03-13 15:22:32,090 [INFO]: 	99p_search_speed_ms: 14.921210650354626
2025-03-13 15:22:32,090 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:32,090 [INFO]: 	nb vectors: 9362
2025-03-13 15:22:32,090 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:32,090 [INFO]: 	compression ratio: 0.9993081919184963
2025-03-13 15:22:32,091 [INFO]: }
2025-03-13 15:22:32,091 [INFO]: 	>>> Finished "Creating the index" in 145.9854 secs
2025-03-13 15:22:32,091 [INFO]: >>> Finished "Launching the whole pipeline" in 146.0159 secs
2025-03-13 15:22:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 42052 [episode count 18/20]
[retrieval_preprocessing] for episode 25882 [episode count 19/20], we have num_retrieval=np.int64(9514) num_query=np.int64(447)
2025-03-13 15:22:38,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:40,693 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:40
2025-03-13 15:22:40,693 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]
2025-03-13 15:22:40,721 [INFO]: There are 9514 embeddings of dim 49152
2025-03-13 15:22:40,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:22:40,722 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:40
2025-03-13 15:22:40,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:40,722 [INFO]: 		-> Add: 5.2 seconds
2025-03-13 15:22:40,723 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:22:40,723 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:22:40,723 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:40
2025-03-13 15:22:40,723 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:40,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:22:40,724 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:40
2025-03-13 15:22:40,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:40,724 [INFO]: 	Creating the index 03/13/2025, 15:22:40
2025-03-13 15:22:40,724 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:40
2025-03-13 15:22:40,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 15:22:40,727 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:40
2025-03-13 15:22:40,728 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 15:22:40,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  8.29it/s] 15%|█▌        | 6/39 [00:00<00:01, 29.40it/s] 28%|██▊       | 11/39 [00:00<00:00, 37.83it/s] 41%|████      | 16/39 [00:00<00:00, 41.98it/s] 54%|█████▍    | 21/39 [00:04<00:06,  2.86it/s] 67%|██████▋   | 26/39 [00:04<00:03,  4.30it/s] 82%|████████▏ | 32/39 [00:04<00:01,  6.58it/s] 95%|█████████▍| 37/39 [00:05<00:00,  9.01it/s]100%|██████████| 39/39 [00:09<00:00,  4.31it/s]
2025-03-13 15:22:49,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:49
2025-03-13 15:24:13,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.1394 secs
2025-03-13 15:24:13,912 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 15:24:13,913 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 15:24:54,722 [INFO]: 	>>> Finished "Compute fast metrics" in 40.8090 secs
2025-03-13 15:24:54,725 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.9973 secs
2025-03-13 15:24:54,725 [INFO]: {
2025-03-13 15:24:54,725 [INFO]: 	index_key: HNSW15
2025-03-13 15:24:54,725 [INFO]: 	index_param: efSearch=155
2025-03-13 15:24:54,725 [INFO]: 	index_path: knn.index
2025-03-13 15:24:54,725 [INFO]: 	size in bytes: 1871823190
2025-03-13 15:24:54,725 [INFO]: 	avg_search_speed_ms: 9.232758463765403
2025-03-13 15:24:54,725 [INFO]: 	99p_search_speed_ms: 14.799563540145757
2025-03-13 15:24:54,725 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:24:54,725 [INFO]: 	nb vectors: 9514
2025-03-13 15:24:54,725 [INFO]: 	vectors dimension: 49152
2025-03-13 15:24:54,725 [INFO]: 	compression ratio: 0.9993083331764898
2025-03-13 15:24:54,725 [INFO]: }
2025-03-13 15:24:54,725 [INFO]: 	>>> Finished "Creating the index" in 134.0008 secs
2025-03-13 15:24:54,725 [INFO]: >>> Finished "Launching the whole pipeline" in 134.0320 secs
2025-03-13 15:24:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:24:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 25882 [episode count 19/20]
2025-03-13 15:24:57: [retrieval_preprocessing] finished for 1656877278_remove_cans_from_tray [chosen_id count 0/196]
2025-03-13 15:25:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1656877278_put_cups_on_tray [chosen_id count 1/196]
2025-03-13 15:25:01: [retrieval_preprocessing] we have num_total=10161 embedding_dim=49152
[retrieval_preprocessing] for episode 41093 [episode count 0/20], we have num_retrieval=np.int64(9766) num_query=np.int64(395)
2025-03-13 15:25:02,496 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:04,351 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:04
2025-03-13 15:25:04,351 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.91it/s]
2025-03-13 15:25:04,378 [INFO]: There are 9766 embeddings of dim 49152
2025-03-13 15:25:04,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:25:04,378 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:04
2025-03-13 15:25:04,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:04,378 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 15:25:04,379 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:25:04,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:04,379 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:04
2025-03-13 15:25:04,379 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:04,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:25:04,379 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:04
2025-03-13 15:25:04,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:04,379 [INFO]: 	Creating the index 03/13/2025, 15:25:04
2025-03-13 15:25:04,379 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:04
2025-03-13 15:25:04,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:25:04,380 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:04
2025-03-13 15:25:04,380 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:25:04,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.14it/s] 10%|█         | 4/40 [00:00<00:01, 18.39it/s] 22%|██▎       | 9/40 [00:00<00:01, 29.66it/s] 35%|███▌      | 14/40 [00:00<00:00, 35.01it/s] 48%|████▊     | 19/40 [00:00<00:00, 37.91it/s] 57%|█████▊    | 23/40 [00:04<00:06,  2.76it/s] 70%|███████   | 28/40 [00:05<00:02,  4.18it/s] 82%|████████▎ | 33/40 [00:05<00:01,  6.03it/s] 95%|█████████▌| 38/40 [00:05<00:00,  8.36it/s]100%|██████████| 40/40 [00:10<00:00,  3.92it/s]
2025-03-13 15:25:14,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:14
2025-03-13 15:26:32,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.4050 secs
2025-03-13 15:26:33,000 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 15:26:33,000 [INFO]: 	Compute fast metrics 03/13/2025, 15:26:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.40it/s]
2025-03-13 15:27:18,525 [INFO]: 	>>> Finished "Compute fast metrics" in 45.5256 secs
2025-03-13 15:27:18,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.1479 secs
2025-03-13 15:27:18,528 [INFO]: {
2025-03-13 15:27:18,528 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:18,528 [INFO]: 	index_param: efSearch=198
2025-03-13 15:27:18,528 [INFO]: 	index_path: knn.index
2025-03-13 15:27:18,528 [INFO]: 	size in bytes: 1921402570
2025-03-13 15:27:18,528 [INFO]: 	avg_search_speed_ms: 12.850735793225372
2025-03-13 15:27:18,528 [INFO]: 	99p_search_speed_ms: 20.27916653547436
2025-03-13 15:27:18,529 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:18,529 [INFO]: 	nb vectors: 9766
2025-03-13 15:27:18,529 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:18,529 [INFO]: 	compression ratio: 0.9993084000090622
2025-03-13 15:27:18,529 [INFO]: }
2025-03-13 15:27:18,529 [INFO]: 	>>> Finished "Creating the index" in 134.1496 secs
2025-03-13 15:27:18,529 [INFO]: >>> Finished "Launching the whole pipeline" in 134.1778 secs
2025-03-13 15:27:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 41093 [episode count 0/20]
[retrieval_preprocessing] for episode 37319 [episode count 1/20], we have num_retrieval=np.int64(9591) num_query=np.int64(570)
2025-03-13 15:27:23,707 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:25,176 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:25
2025-03-13 15:27:25,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.44it/s]
2025-03-13 15:27:25,205 [INFO]: There are 9591 embeddings of dim 49152
2025-03-13 15:27:25,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:27:25,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:25
2025-03-13 15:27:25,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:25,205 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:27:25,205 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:27:25,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:25,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:25
2025-03-13 15:27:25,205 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:25,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:25,205 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:25
2025-03-13 15:27:25,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:25,205 [INFO]: 	Creating the index 03/13/2025, 15:27:25
2025-03-13 15:27:25,205 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:25
2025-03-13 15:27:25,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:27:25,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:25
2025-03-13 15:27:25,207 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:27:25,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.50it/s] 15%|█▌        | 6/39 [00:00<00:01, 25.97it/s] 28%|██▊       | 11/39 [00:00<00:00, 34.50it/s] 41%|████      | 16/39 [00:00<00:00, 38.99it/s] 54%|█████▍    | 21/39 [00:04<00:05,  3.19it/s] 67%|██████▋   | 26/39 [00:04<00:02,  4.76it/s] 79%|███████▉  | 31/39 [00:04<00:01,  6.84it/s] 92%|█████████▏| 36/39 [00:04<00:00,  9.49it/s]100%|██████████| 39/39 [00:08<00:00,  4.39it/s]
2025-03-13 15:27:34,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:34
2025-03-13 15:29:01,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.9522 secs
2025-03-13 15:29:01,040 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:29:01,040 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.73it/s]
2025-03-13 15:29:46,750 [INFO]: 	>>> Finished "Compute fast metrics" in 45.7100 secs
2025-03-13 15:29:46,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.5468 secs
2025-03-13 15:29:46,754 [INFO]: {
2025-03-13 15:29:46,754 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:46,754 [INFO]: 	index_param: efSearch=149
2025-03-13 15:29:46,754 [INFO]: 	index_path: knn.index
2025-03-13 15:29:46,754 [INFO]: 	size in bytes: 1886972470
2025-03-13 15:29:46,754 [INFO]: 	avg_search_speed_ms: 9.055789859553773
2025-03-13 15:29:46,754 [INFO]: 	99p_search_speed_ms: 13.297944315709179
2025-03-13 15:29:46,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:46,754 [INFO]: 	nb vectors: 9591
2025-03-13 15:29:46,754 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:46,754 [INFO]: 	compression ratio: 0.9993083407305884
2025-03-13 15:29:46,754 [INFO]: }
2025-03-13 15:29:46,754 [INFO]: 	>>> Finished "Creating the index" in 141.5483 secs
2025-03-13 15:29:46,754 [INFO]: >>> Finished "Launching the whole pipeline" in 141.5772 secs
2025-03-13 15:29:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 37319 [episode count 1/20]
[retrieval_preprocessing] for episode 57603 [episode count 2/20], we have num_retrieval=np.int64(9802) num_query=np.int64(359)
2025-03-13 15:29:54,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:56,213 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:56
2025-03-13 15:29:56,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 750.99it/s]
2025-03-13 15:29:56,246 [INFO]: There are 9802 embeddings of dim 49152
2025-03-13 15:29:56,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 15:29:56,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:56,248 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 15:29:56,248 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:29:56,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:29:56,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,248 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:56,248 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:29:56,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:56
2025-03-13 15:29:56,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:56,249 [INFO]: 	Creating the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,249 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:56
2025-03-13 15:29:56,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:29:56,253 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:56
2025-03-13 15:29:56,253 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:29:56,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.27it/s] 12%|█▎        | 5/40 [00:00<00:01, 23.50it/s] 22%|██▎       | 9/40 [00:00<00:01, 29.24it/s] 32%|███▎      | 13/40 [00:00<00:00, 32.51it/s] 42%|████▎     | 17/40 [00:00<00:00, 34.64it/s] 52%|█████▎    | 21/40 [00:06<00:10,  1.89it/s] 60%|██████    | 24/40 [00:06<00:06,  2.35it/s] 65%|██████▌   | 26/40 [00:07<00:05,  2.73it/s] 70%|███████   | 28/40 [00:07<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:07<00:02,  3.86it/s] 80%|████████  | 32/40 [00:07<00:01,  4.58it/s] 88%|████████▊ | 35/40 [00:07<00:00,  6.40it/s] 98%|█████████▊| 39/40 [00:07<00:00,  9.50it/s]100%|██████████| 40/40 [00:13<00:00,  3.06it/s]
2025-03-13 15:30:09,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:09
2025-03-13 15:31:30,578 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.2535 secs
2025-03-13 15:31:30,579 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:31:30,579 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.51it/s]
2025-03-13 15:32:27,471 [INFO]: 	>>> Finished "Compute fast metrics" in 56.8918 secs
2025-03-13 15:32:27,475 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.2222 secs
2025-03-13 15:32:27,475 [INFO]: {
2025-03-13 15:32:27,475 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:27,475 [INFO]: 	index_param: efSearch=176
2025-03-13 15:32:27,475 [INFO]: 	index_path: knn.index
2025-03-13 15:32:27,475 [INFO]: 	size in bytes: 1928485450
2025-03-13 15:32:27,475 [INFO]: 	avg_search_speed_ms: 11.456244699294249
2025-03-13 15:32:27,475 [INFO]: 	99p_search_speed_ms: 16.981893228366967
2025-03-13 15:32:27,475 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:27,475 [INFO]: 	nb vectors: 9802
2025-03-13 15:32:27,475 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:27,475 [INFO]: 	compression ratio: 0.9993083515356571
2025-03-13 15:32:27,475 [INFO]: }
2025-03-13 15:32:27,475 [INFO]: 	>>> Finished "Creating the index" in 151.2264 secs
2025-03-13 15:32:27,475 [INFO]: >>> Finished "Launching the whole pipeline" in 151.2623 secs
2025-03-13 15:32:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 57603 [episode count 2/20]
[retrieval_preprocessing] for episode 14983 [episode count 3/20], we have num_retrieval=np.int64(9572) num_query=np.int64(589)
2025-03-13 15:32:32,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:34,570 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:34
2025-03-13 15:32:34,570 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 828.91it/s]
2025-03-13 15:32:34,601 [INFO]: There are 9572 embeddings of dim 49152
2025-03-13 15:32:34,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 15:32:34,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:34
2025-03-13 15:32:34,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:34,602 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:32:34,602 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:32:34,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:32:34,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:34
2025-03-13 15:32:34,602 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:34,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:34,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:34
2025-03-13 15:32:34,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:34,602 [INFO]: 	Creating the index 03/13/2025, 15:32:34
2025-03-13 15:32:34,602 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:34
2025-03-13 15:32:34,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:32:34,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:34
2025-03-13 15:32:34,604 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:32:34,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:07,  5.39it/s] 10%|█         | 4/39 [00:00<00:02, 14.94it/s] 21%|██        | 8/39 [00:00<00:01, 22.46it/s] 31%|███       | 12/39 [00:00<00:00, 27.01it/s] 41%|████      | 16/39 [00:00<00:00, 29.92it/s] 51%|█████▏    | 20/39 [00:00<00:00, 31.69it/s] 62%|██████▏   | 24/39 [00:05<00:06,  2.45it/s] 74%|███████▍  | 29/39 [00:05<00:02,  3.82it/s] 87%|████████▋ | 34/39 [00:05<00:00,  5.64it/s]100%|██████████| 39/39 [00:09<00:00,  2.60it/s]100%|██████████| 39/39 [00:09<00:00,  4.10it/s]
2025-03-13 15:32:44,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:44
2025-03-13 15:34:10,159 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.0297 secs
2025-03-13 15:34:10,159 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 15:34:10,159 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.77it/s]
2025-03-13 15:34:44,774 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6149 secs
2025-03-13 15:34:44,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 130.1734 secs
2025-03-13 15:34:44,777 [INFO]: {
2025-03-13 15:34:44,777 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:44,777 [INFO]: 	index_param: efSearch=142
2025-03-13 15:34:44,777 [INFO]: 	index_path: knn.index
2025-03-13 15:34:44,777 [INFO]: 	size in bytes: 1883234230
2025-03-13 15:34:44,777 [INFO]: 	avg_search_speed_ms: 11.311648228117244
2025-03-13 15:34:44,777 [INFO]: 	99p_search_speed_ms: 20.26672636158764
2025-03-13 15:34:44,778 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:44,778 [INFO]: 	nb vectors: 9572
2025-03-13 15:34:44,778 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:44,778 [INFO]: 	compression ratio: 0.9993083951113186
2025-03-13 15:34:44,778 [INFO]: }
2025-03-13 15:34:44,778 [INFO]: 	>>> Finished "Creating the index" in 130.1753 secs
2025-03-13 15:34:44,778 [INFO]: >>> Finished "Launching the whole pipeline" in 130.2076 secs
2025-03-13 15:34:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 14983 [episode count 3/20]
[retrieval_preprocessing] for episode 80465 [episode count 4/20], we have num_retrieval=np.int64(9569) num_query=np.int64(592)
2025-03-13 15:34:49,465 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:51,143 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:51
2025-03-13 15:34:51,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1344.76it/s]
2025-03-13 15:34:51,166 [INFO]: There are 9569 embeddings of dim 49152
2025-03-13 15:34:51,167 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 15:34:51,167 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:51
2025-03-13 15:34:51,167 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:51,167 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:34:51,167 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:34:51,167 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:51,167 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:51
2025-03-13 15:34:51,167 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:51,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:51,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:51
2025-03-13 15:34:51,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:51,167 [INFO]: 	Creating the index 03/13/2025, 15:34:51
2025-03-13 15:34:51,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:51
2025-03-13 15:34:51,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:34:51,169 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:51
2025-03-13 15:34:51,169 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:34:51,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.42it/s] 10%|█         | 4/39 [00:00<00:02, 16.51it/s] 21%|██        | 8/39 [00:00<00:01, 25.32it/s] 33%|███▎      | 13/39 [00:00<00:00, 31.36it/s] 44%|████▎     | 17/39 [00:00<00:00, 31.78it/s] 54%|█████▍    | 21/39 [00:06<00:08,  2.04it/s] 64%|██████▍   | 25/39 [00:06<00:04,  2.97it/s] 74%|███████▍  | 29/39 [00:06<00:02,  4.21it/s] 85%|████████▍ | 33/39 [00:06<00:01,  5.84it/s] 95%|█████████▍| 37/39 [00:06<00:00,  7.87it/s]100%|██████████| 39/39 [00:10<00:00,  3.59it/s]
2025-03-13 15:35:02,023 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:02
2025-03-13 15:36:22,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.1918 secs
2025-03-13 15:36:22,215 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 15:36:22,216 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-13 15:37:15,396 [INFO]: 	>>> Finished "Compute fast metrics" in 53.1796 secs
2025-03-13 15:37:15,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.2307 secs
2025-03-13 15:37:15,400 [INFO]: {
2025-03-13 15:37:15,400 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:15,400 [INFO]: 	index_param: efSearch=176
2025-03-13 15:37:15,400 [INFO]: 	index_path: knn.index
2025-03-13 15:37:15,400 [INFO]: 	size in bytes: 1882644010
2025-03-13 15:37:15,400 [INFO]: 	avg_search_speed_ms: 11.401826178627418
2025-03-13 15:37:15,400 [INFO]: 	99p_search_speed_ms: 18.38114734739065
2025-03-13 15:37:15,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:15,400 [INFO]: 	nb vectors: 9569
2025-03-13 15:37:15,400 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:15,400 [INFO]: 	compression ratio: 0.999308388631582
2025-03-13 15:37:15,400 [INFO]: }
2025-03-13 15:37:15,400 [INFO]: 	>>> Finished "Creating the index" in 144.2323 secs
2025-03-13 15:37:15,400 [INFO]: >>> Finished "Launching the whole pipeline" in 144.2571 secs
2025-03-13 15:37:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 80465 [episode count 4/20]
[retrieval_preprocessing] for episode 80914 [episode count 5/20], we have num_retrieval=np.int64(9616) num_query=np.int64(545)
2025-03-13 15:37:22,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:25,451 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:25
2025-03-13 15:37:25,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.61it/s]
2025-03-13 15:37:25,489 [INFO]: There are 9616 embeddings of dim 49152
2025-03-13 15:37:25,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0391 secs
2025-03-13 15:37:25,490 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:25
2025-03-13 15:37:25,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:25,491 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:37:25,491 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:37:25,491 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:37:25,491 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:25
2025-03-13 15:37:25,491 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:25,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:37:25,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:25
2025-03-13 15:37:25,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:25,492 [INFO]: 	Creating the index 03/13/2025, 15:37:25
2025-03-13 15:37:25,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:25
2025-03-13 15:37:25,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:37:25,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:25
2025-03-13 15:37:25,496 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:37:25,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.74it/s] 10%|█         | 4/39 [00:00<00:02, 17.42it/s] 21%|██        | 8/39 [00:00<00:01, 24.17it/s] 31%|███       | 12/39 [00:00<00:00, 27.81it/s] 41%|████      | 16/39 [00:00<00:00, 30.07it/s] 51%|█████▏    | 20/39 [00:00<00:00, 31.68it/s] 62%|██████▏   | 24/39 [00:05<00:07,  2.14it/s] 69%|██████▉   | 27/39 [00:06<00:04,  2.84it/s] 77%|███████▋  | 30/39 [00:06<00:02,  3.78it/s] 85%|████████▍ | 33/39 [00:06<00:01,  4.99it/s] 92%|█████████▏| 36/39 [00:06<00:00,  6.48it/s]100%|██████████| 39/39 [00:14<00:00,  1.07it/s]100%|██████████| 39/39 [00:14<00:00,  2.62it/s]
2025-03-13 15:37:40,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:40
2025-03-13 15:38:55,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.8712 secs
2025-03-13 15:38:55,253 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:38:55,253 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.46it/s] 50%|█████     | 2/4 [00:00<00:00,  3.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.69it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.80it/s]
2025-03-13 15:39:41,823 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5704 secs
2025-03-13 15:39:41,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.3314 secs
2025-03-13 15:39:41,827 [INFO]: {
2025-03-13 15:39:41,827 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:41,827 [INFO]: 	index_param: efSearch=159
2025-03-13 15:39:41,827 [INFO]: 	index_path: knn.index
2025-03-13 15:39:41,827 [INFO]: 	size in bytes: 1891891030
2025-03-13 15:39:41,827 [INFO]: 	avg_search_speed_ms: 11.670356433808177
2025-03-13 15:39:41,828 [INFO]: 	99p_search_speed_ms: 32.11490238085325
2025-03-13 15:39:41,828 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:41,828 [INFO]: 	nb vectors: 9616
2025-03-13 15:39:41,828 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:41,828 [INFO]: 	compression ratio: 0.9993083629134814
2025-03-13 15:39:41,828 [INFO]: }
2025-03-13 15:39:41,828 [INFO]: 	>>> Finished "Creating the index" in 136.3354 secs
2025-03-13 15:39:41,828 [INFO]: >>> Finished "Launching the whole pipeline" in 136.3769 secs
2025-03-13 15:39:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 80914 [episode count 5/20]
[retrieval_preprocessing] for episode 19493 [episode count 6/20], we have num_retrieval=np.int64(9619) num_query=np.int64(542)
2025-03-13 15:39:47,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:49,325 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:49
2025-03-13 15:39:49,325 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.40it/s]
2025-03-13 15:39:49,361 [INFO]: There are 9619 embeddings of dim 49152
2025-03-13 15:39:49,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-13 15:39:49,362 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:49
2025-03-13 15:39:49,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:49,363 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:39:49,363 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:39:49,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:39:49,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:49
2025-03-13 15:39:49,363 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:49,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:39:49,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:49
2025-03-13 15:39:49,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:49,364 [INFO]: 	Creating the index 03/13/2025, 15:39:49
2025-03-13 15:39:49,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:49
2025-03-13 15:39:49,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:39:49,367 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:49
2025-03-13 15:39:49,367 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:39:49,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:04,  8.20it/s] 13%|█▎        | 5/39 [00:00<00:01, 24.38it/s] 23%|██▎       | 9/39 [00:00<00:00, 30.38it/s] 33%|███▎      | 13/39 [00:00<00:00, 33.75it/s] 46%|████▌     | 18/39 [00:00<00:00, 36.54it/s] 56%|█████▋    | 22/39 [00:05<00:06,  2.52it/s] 64%|██████▍   | 25/39 [00:05<00:04,  3.30it/s] 72%|███████▏  | 28/39 [00:05<00:02,  4.35it/s] 82%|████████▏ | 32/39 [00:05<00:01,  6.23it/s] 92%|█████████▏| 36/39 [00:05<00:00,  8.56it/s]100%|██████████| 39/39 [00:11<00:00,  3.47it/s]
2025-03-13 15:40:00,609 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:00
2025-03-13 15:41:17,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.0471 secs
2025-03-13 15:41:17,657 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 15:41:17,657 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.61it/s]
2025-03-13 15:42:02,613 [INFO]: 	>>> Finished "Compute fast metrics" in 44.9563 secs
2025-03-13 15:42:02,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2508 secs
2025-03-13 15:42:02,619 [INFO]: {
2025-03-13 15:42:02,619 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:02,619 [INFO]: 	index_param: efSearch=127
2025-03-13 15:42:02,619 [INFO]: 	index_path: knn.index
2025-03-13 15:42:02,619 [INFO]: 	size in bytes: 1892481250
2025-03-13 15:42:02,619 [INFO]: 	avg_search_speed_ms: 8.118222508044285
2025-03-13 15:42:02,619 [INFO]: 	99p_search_speed_ms: 16.05940137524158
2025-03-13 15:42:02,619 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:02,619 [INFO]: 	nb vectors: 9619
2025-03-13 15:42:02,619 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:02,619 [INFO]: 	compression ratio: 0.9993083693695777
2025-03-13 15:42:02,619 [INFO]: }
2025-03-13 15:42:02,619 [INFO]: 	>>> Finished "Creating the index" in 133.2547 secs
2025-03-13 15:42:02,619 [INFO]: >>> Finished "Launching the whole pipeline" in 133.2934 secs
2025-03-13 15:42:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 19493 [episode count 6/20]
[retrieval_preprocessing] for episode 29753 [episode count 7/20], we have num_retrieval=np.int64(9695) num_query=np.int64(466)
2025-03-13 15:42:07,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:09,384 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:09
2025-03-13 15:42:09,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1474.79it/s]
2025-03-13 15:42:09,792 [INFO]: There are 9695 embeddings of dim 49152
2025-03-13 15:42:09,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4084 secs
2025-03-13 15:42:09,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:09
2025-03-13 15:42:09,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:09,793 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:42:09,793 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:42:09,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:42:09,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:09
2025-03-13 15:42:09,794 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:09,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:42:09,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:09
2025-03-13 15:42:09,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:09,795 [INFO]: 	Creating the index 03/13/2025, 15:42:09
2025-03-13 15:42:09,795 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:09
2025-03-13 15:42:09,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:42:09,798 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:09
2025-03-13 15:42:09,799 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:42:09,799 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  8.62it/s] 15%|█▌        | 6/40 [00:00<00:01, 28.99it/s] 28%|██▊       | 11/40 [00:00<00:00, 37.38it/s] 40%|████      | 16/40 [00:00<00:00, 41.64it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.68it/s] 62%|██████▎   | 25/40 [00:05<00:03,  3.76it/s] 75%|███████▌  | 30/40 [00:05<00:01,  5.55it/s] 88%|████████▊ | 35/40 [00:05<00:00,  7.86it/s]100%|██████████| 40/40 [00:12<00:00,  1.92it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
2025-03-13 15:42:21,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:21
2025-03-13 15:43:40,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.8787 secs
2025-03-13 15:43:40,787 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:43:40,787 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.37it/s]
2025-03-13 15:44:18,639 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8525 secs
2025-03-13 15:44:18,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.8440 secs
2025-03-13 15:44:18,643 [INFO]: {
2025-03-13 15:44:18,643 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:18,643 [INFO]: 	index_param: efSearch=149
2025-03-13 15:44:18,643 [INFO]: 	index_path: knn.index
2025-03-13 15:44:18,643 [INFO]: 	size in bytes: 1907433550
2025-03-13 15:44:18,643 [INFO]: 	avg_search_speed_ms: 8.52283968287163
2025-03-13 15:44:18,643 [INFO]: 	99p_search_speed_ms: 12.681786101311443
2025-03-13 15:44:18,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:18,643 [INFO]: 	nb vectors: 9695
2025-03-13 15:44:18,643 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:18,643 [INFO]: 	compression ratio: 0.9993085001571876
2025-03-13 15:44:18,643 [INFO]: }
2025-03-13 15:44:18,643 [INFO]: 	>>> Finished "Creating the index" in 128.8480 secs
2025-03-13 15:44:18,643 [INFO]: >>> Finished "Launching the whole pipeline" in 129.2591 secs
2025-03-13 15:44:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 29753 [episode count 7/20]
[retrieval_preprocessing] for episode 91214 [episode count 8/20], we have num_retrieval=np.int64(9653) num_query=np.int64(508)
2025-03-13 15:44:22,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:24,493 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:24
2025-03-13 15:44:24,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.42it/s]
2025-03-13 15:44:24,523 [INFO]: There are 9653 embeddings of dim 49152
2025-03-13 15:44:24,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 15:44:24,524 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:24
2025-03-13 15:44:24,524 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:24,524 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:44:24,524 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:44:24,524 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:24,524 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:24
2025-03-13 15:44:24,524 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:24,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:44:24,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:24
2025-03-13 15:44:24,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:24,524 [INFO]: 	Creating the index 03/13/2025, 15:44:24
2025-03-13 15:44:24,524 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:24
2025-03-13 15:44:24,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:44:24,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:24
2025-03-13 15:44:24,525 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:44:24,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:06,  6.26it/s] 13%|█▎        | 5/39 [00:00<00:01, 21.16it/s] 26%|██▌       | 10/39 [00:00<00:00, 30.02it/s] 38%|███▊      | 15/39 [00:00<00:00, 36.34it/s] 51%|█████▏    | 20/39 [00:00<00:00, 40.24it/s] 64%|██████▍   | 25/39 [00:04<00:04,  3.10it/s] 77%|███████▋  | 30/39 [00:04<00:01,  4.54it/s] 90%|████████▉ | 35/39 [00:05<00:00,  6.44it/s]100%|██████████| 39/39 [00:09<00:00,  2.43it/s]100%|██████████| 39/39 [00:09<00:00,  4.13it/s]
2025-03-13 15:44:33,975 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:33
2025-03-13 15:45:55,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 81.2328 secs
2025-03-13 15:45:55,209 [INFO]: The best hyperparameters are: efSearch=136
2025-03-13 15:45:55,209 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.33it/s]
2025-03-13 15:46:31,561 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3515 secs
2025-03-13 15:46:31,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 127.0382 secs
2025-03-13 15:46:31,564 [INFO]: {
2025-03-13 15:46:31,564 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:31,564 [INFO]: 	index_param: efSearch=136
2025-03-13 15:46:31,564 [INFO]: 	index_path: knn.index
2025-03-13 15:46:31,564 [INFO]: 	size in bytes: 1899170470
2025-03-13 15:46:31,564 [INFO]: 	avg_search_speed_ms: 9.516252134328479
2025-03-13 15:46:31,564 [INFO]: 	99p_search_speed_ms: 19.686326617375016
2025-03-13 15:46:31,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:31,564 [INFO]: 	nb vectors: 9653
2025-03-13 15:46:31,564 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:31,564 [INFO]: 	compression ratio: 0.999308410687325
2025-03-13 15:46:31,564 [INFO]: }
2025-03-13 15:46:31,564 [INFO]: 	>>> Finished "Creating the index" in 127.0398 secs
2025-03-13 15:46:31,564 [INFO]: >>> Finished "Launching the whole pipeline" in 127.0704 secs
2025-03-13 15:46:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 91214 [episode count 8/20]
[retrieval_preprocessing] for episode 50608 [episode count 9/20], we have num_retrieval=np.int64(9614) num_query=np.int64(547)
2025-03-13 15:46:35,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:37,636 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:37
2025-03-13 15:46:37,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 606.03it/s]
2025-03-13 15:46:37,667 [INFO]: There are 9614 embeddings of dim 49152
2025-03-13 15:46:37,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 15:46:37,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:37
2025-03-13 15:46:37,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:37,669 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:46:37,669 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:46:37,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:46:37,669 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:37
2025-03-13 15:46:37,669 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:37,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:46:37,670 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:37
2025-03-13 15:46:37,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:37,670 [INFO]: 	Creating the index 03/13/2025, 15:46:37
2025-03-13 15:46:37,670 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:37
2025-03-13 15:46:37,674 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 15:46:37,674 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:37
2025-03-13 15:46:37,674 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:46:37,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:08,  4.30it/s] 13%|█▎        | 5/39 [00:00<00:02, 16.75it/s] 23%|██▎       | 9/39 [00:00<00:01, 23.36it/s] 33%|███▎      | 13/39 [00:00<00:00, 27.68it/s] 44%|████▎     | 17/39 [00:00<00:00, 30.56it/s] 54%|█████▍    | 21/39 [00:05<00:07,  2.31it/s] 64%|██████▍   | 25/39 [00:05<00:04,  3.39it/s] 77%|███████▋  | 30/39 [00:05<00:01,  5.18it/s] 90%|████████▉ | 35/39 [00:05<00:00,  7.48it/s]100%|██████████| 39/39 [00:09<00:00,  2.65it/s]100%|██████████| 39/39 [00:09<00:00,  4.06it/s]
2025-03-13 15:46:47,295 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:47
2025-03-13 15:48:07,530 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.2342 secs
2025-03-13 15:48:07,531 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 15:48:07,531 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.37it/s]
2025-03-13 15:49:04,708 [INFO]: 	>>> Finished "Compute fast metrics" in 57.1767 secs
2025-03-13 15:49:04,952 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 147.2777 secs
2025-03-13 15:49:04,952 [INFO]: {
2025-03-13 15:49:04,953 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:04,953 [INFO]: 	index_param: efSearch=141
2025-03-13 15:49:04,953 [INFO]: 	index_path: knn.index
2025-03-13 15:49:04,953 [INFO]: 	size in bytes: 1891497550
2025-03-13 15:49:04,953 [INFO]: 	avg_search_speed_ms: 8.249738200483975
2025-03-13 15:49:04,953 [INFO]: 	99p_search_speed_ms: 13.292962126433848
2025-03-13 15:49:04,953 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:04,953 [INFO]: 	nb vectors: 9614
2025-03-13 15:49:04,953 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:04,953 [INFO]: 	compression ratio: 0.9993083586071787
2025-03-13 15:49:04,953 [INFO]: }
2025-03-13 15:49:04,953 [INFO]: 	>>> Finished "Creating the index" in 147.2829 secs
2025-03-13 15:49:04,953 [INFO]: >>> Finished "Launching the whole pipeline" in 147.3170 secs
2025-03-13 15:49:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 50608 [episode count 9/20]
[retrieval_preprocessing] for episode 66894 [episode count 10/20], we have num_retrieval=np.int64(9662) num_query=np.int64(499)
2025-03-13 15:49:09,530 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:11,534 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:11
2025-03-13 15:49:11,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-13 15:49:11,564 [INFO]: There are 9662 embeddings of dim 49152
2025-03-13 15:49:11,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 15:49:11,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:11,564 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:49:11,564 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:49:11,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:11,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,565 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:11,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:49:11,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:11
2025-03-13 15:49:11,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:11,565 [INFO]: 	Creating the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,565 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:11
2025-03-13 15:49:11,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:49:11,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:11
2025-03-13 15:49:11,566 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:49:11,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  6.93it/s] 15%|█▌        | 6/40 [00:00<00:01, 26.27it/s] 28%|██▊       | 11/40 [00:00<00:00, 34.51it/s] 40%|████      | 16/40 [00:00<00:00, 37.57it/s] 52%|█████▎    | 21/40 [00:05<00:08,  2.34it/s] 60%|██████    | 24/40 [00:05<00:05,  3.04it/s] 68%|██████▊   | 27/40 [00:05<00:03,  3.98it/s] 78%|███████▊  | 31/40 [00:06<00:01,  5.61it/s] 88%|████████▊ | 35/40 [00:06<00:00,  7.66it/s] 98%|█████████▊| 39/40 [00:06<00:00, 10.13it/s]100%|██████████| 40/40 [00:10<00:00,  3.67it/s]
2025-03-13 15:49:22,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:22
2025-03-13 15:50:36,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.0243 secs
2025-03-13 15:50:36,492 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 15:50:36,492 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 15:51:24,530 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0375 secs
2025-03-13 15:51:24,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 132.9667 secs
2025-03-13 15:51:24,533 [INFO]: {
2025-03-13 15:51:24,533 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:24,533 [INFO]: 	index_param: efSearch=153
2025-03-13 15:51:24,533 [INFO]: 	index_path: knn.index
2025-03-13 15:51:24,533 [INFO]: 	size in bytes: 1900941130
2025-03-13 15:51:24,533 [INFO]: 	avg_search_speed_ms: 9.39959336726058
2025-03-13 15:51:24,533 [INFO]: 	99p_search_speed_ms: 16.734696074854558
2025-03-13 15:51:24,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:24,533 [INFO]: 	nb vectors: 9662
2025-03-13 15:51:24,533 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:24,533 [INFO]: 	compression ratio: 0.9993084299249183
2025-03-13 15:51:24,533 [INFO]: }
2025-03-13 15:51:24,533 [INFO]: 	>>> Finished "Creating the index" in 132.9683 secs
2025-03-13 15:51:24,533 [INFO]: >>> Finished "Launching the whole pipeline" in 132.9986 secs
2025-03-13 15:51:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 66894 [episode count 10/20]
[retrieval_preprocessing] for episode 53033 [episode count 11/20], we have num_retrieval=np.int64(9640) num_query=np.int64(521)
2025-03-13 15:51:28,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:29,443 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:29
2025-03-13 15:51:29,443 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-13 15:51:29,469 [INFO]: There are 9640 embeddings of dim 49152
2025-03-13 15:51:29,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:51:29,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:29
2025-03-13 15:51:29,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:29,469 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:51:29,469 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:51:29,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:51:29,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:29
2025-03-13 15:51:29,469 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:29,469 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:51:29,469 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:29
2025-03-13 15:51:29,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:29,469 [INFO]: 	Creating the index 03/13/2025, 15:51:29
2025-03-13 15:51:29,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:29
2025-03-13 15:51:29,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:51:29,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:29
2025-03-13 15:51:29,471 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:51:29,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  7.41it/s] 18%|█▊        | 7/39 [00:00<00:01, 31.44it/s] 33%|███▎      | 13/39 [00:00<00:00, 40.53it/s] 49%|████▊     | 19/39 [00:00<00:00, 44.92it/s] 62%|██████▏   | 24/39 [00:03<00:03,  3.93it/s] 77%|███████▋  | 30/39 [00:04<00:01,  6.01it/s] 92%|█████████▏| 36/39 [00:04<00:00,  8.69it/s]100%|██████████| 39/39 [00:08<00:00,  4.84it/s]
2025-03-13 15:51:37,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:37
2025-03-13 15:52:58,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.5004 secs
2025-03-13 15:52:58,034 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 15:52:58,034 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:14,  4.71s/it] 50%|█████     | 2/4 [00:05<00:05,  2.55s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.34s/it]
2025-03-13 15:53:51,485 [INFO]: 	>>> Finished "Compute fast metrics" in 53.4507 secs
2025-03-13 15:53:51,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.0180 secs
2025-03-13 15:53:51,489 [INFO]: {
2025-03-13 15:53:51,489 [INFO]: 	index_key: HNSW15
2025-03-13 15:53:51,489 [INFO]: 	index_param: efSearch=160
2025-03-13 15:53:51,489 [INFO]: 	index_path: knn.index
2025-03-13 15:53:51,489 [INFO]: 	size in bytes: 1896612790
2025-03-13 15:53:51,489 [INFO]: 	avg_search_speed_ms: 10.79614002768959
2025-03-13 15:53:51,489 [INFO]: 	99p_search_speed_ms: 16.115784435532987
2025-03-13 15:53:51,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:53:51,489 [INFO]: 	nb vectors: 9640
2025-03-13 15:53:51,489 [INFO]: 	vectors dimension: 49152
2025-03-13 15:53:51,489 [INFO]: 	compression ratio: 0.9993084144497412
2025-03-13 15:53:51,489 [INFO]: }
2025-03-13 15:53:51,489 [INFO]: 	>>> Finished "Creating the index" in 142.0195 secs
2025-03-13 15:53:51,489 [INFO]: >>> Finished "Launching the whole pipeline" in 142.0462 secs
2025-03-13 15:53:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:53:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 53033 [episode count 11/20]
[retrieval_preprocessing] for episode 85802 [episode count 12/20], we have num_retrieval=np.int64(9662) num_query=np.int64(499)
2025-03-13 15:53:56,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:53:58,759 [INFO]: Launching the whole pipeline 03/13/2025, 15:53:58
2025-03-13 15:53:58,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:53:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.89it/s]
2025-03-13 15:53:58,789 [INFO]: There are 9662 embeddings of dim 49152
2025-03-13 15:53:58,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 15:53:58,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:53:58
2025-03-13 15:53:58,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:53:58,790 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:53:58,790 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:53:58,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:53:58,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:53:58
2025-03-13 15:53:58,790 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:53:58,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:53:58,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:53:58
2025-03-13 15:53:58,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:53:58,790 [INFO]: 	Creating the index 03/13/2025, 15:53:58
2025-03-13 15:53:58,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:53:58
2025-03-13 15:53:58,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:53:58,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:53:58
2025-03-13 15:53:58,791 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:53:58,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  6.58it/s] 15%|█▌        | 6/40 [00:00<00:01, 26.23it/s] 28%|██▊       | 11/40 [00:00<00:00, 35.16it/s] 40%|████      | 16/40 [00:00<00:00, 39.75it/s] 52%|█████▎    | 21/40 [00:04<00:05,  3.26it/s] 65%|██████▌   | 26/40 [00:04<00:02,  4.88it/s] 78%|███████▊  | 31/40 [00:04<00:01,  7.00it/s] 92%|█████████▎| 37/40 [00:04<00:00, 10.25it/s]100%|██████████| 40/40 [00:08<00:00,  4.51it/s]
2025-03-13 15:54:07,662 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:07
2025-03-13 15:55:34,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.3280 secs
2025-03-13 15:55:34,991 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 15:55:34,991 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.05it/s]
2025-03-13 15:56:17,042 [INFO]: 	>>> Finished "Compute fast metrics" in 42.0506 secs
2025-03-13 15:56:17,045 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.2534 secs
2025-03-13 15:56:17,045 [INFO]: {
2025-03-13 15:56:17,045 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:17,045 [INFO]: 	index_param: efSearch=148
2025-03-13 15:56:17,045 [INFO]: 	index_path: knn.index
2025-03-13 15:56:17,045 [INFO]: 	size in bytes: 1900941130
2025-03-13 15:56:17,045 [INFO]: 	avg_search_speed_ms: 11.481444664132685
2025-03-13 15:56:17,045 [INFO]: 	99p_search_speed_ms: 19.623111886903637
2025-03-13 15:56:17,045 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:17,045 [INFO]: 	nb vectors: 9662
2025-03-13 15:56:17,045 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:17,045 [INFO]: 	compression ratio: 0.9993084299249183
2025-03-13 15:56:17,045 [INFO]: }
2025-03-13 15:56:17,045 [INFO]: 	>>> Finished "Creating the index" in 138.2553 secs
2025-03-13 15:56:17,045 [INFO]: >>> Finished "Launching the whole pipeline" in 138.2864 secs
2025-03-13 15:56:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 85802 [episode count 12/20]
[retrieval_preprocessing] for episode 31633 [episode count 13/20], we have num_retrieval=np.int64(9674) num_query=np.int64(487)
2025-03-13 15:56:21,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:23,725 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:23
2025-03-13 15:56:23,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.78it/s]
2025-03-13 15:56:23,761 [INFO]: There are 9674 embeddings of dim 49152
2025-03-13 15:56:23,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 15:56:23,761 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:23
2025-03-13 15:56:23,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:23,761 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:56:23,761 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:56:23,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:56:23,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:23
2025-03-13 15:56:23,762 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:23,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:56:23,762 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:23
2025-03-13 15:56:23,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:23,762 [INFO]: 	Creating the index 03/13/2025, 15:56:23
2025-03-13 15:56:23,762 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:23
2025-03-13 15:56:23,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:56:23,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:23
2025-03-13 15:56:23,764 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:56:23,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:04,  9.34it/s] 15%|█▌        | 6/40 [00:00<00:01, 30.32it/s] 28%|██▊       | 11/40 [00:00<00:00, 37.31it/s] 40%|████      | 16/40 [00:00<00:00, 40.59it/s] 52%|█████▎    | 21/40 [00:05<00:07,  2.55it/s] 62%|██████▎   | 25/40 [00:05<00:04,  3.56it/s] 72%|███████▎  | 29/40 [00:05<00:02,  4.89it/s] 82%|████████▎ | 33/40 [00:05<00:01,  6.60it/s] 92%|█████████▎| 37/40 [00:05<00:00,  8.74it/s]100%|██████████| 40/40 [00:11<00:00,  3.54it/s]
2025-03-13 15:56:35,141 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:35
2025-03-13 15:58:04,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2110 secs
2025-03-13 15:58:04,354 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 15:58:04,354 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.86it/s]
2025-03-13 15:59:05,024 [INFO]: 	>>> Finished "Compute fast metrics" in 60.6702 secs
2025-03-13 15:59:05,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.2633 secs
2025-03-13 15:59:05,027 [INFO]: {
2025-03-13 15:59:05,027 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:05,028 [INFO]: 	index_param: efSearch=154
2025-03-13 15:59:05,028 [INFO]: 	index_path: knn.index
2025-03-13 15:59:05,028 [INFO]: 	size in bytes: 1903302010
2025-03-13 15:59:05,028 [INFO]: 	avg_search_speed_ms: 9.56785180503556
2025-03-13 15:59:05,028 [INFO]: 	99p_search_speed_ms: 14.566053403541446
2025-03-13 15:59:05,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:05,028 [INFO]: 	nb vectors: 9674
2025-03-13 15:59:05,028 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:05,028 [INFO]: 	compression ratio: 0.9993084555193634
2025-03-13 15:59:05,028 [INFO]: }
2025-03-13 15:59:05,028 [INFO]: 	>>> Finished "Creating the index" in 161.2657 secs
2025-03-13 15:59:05,028 [INFO]: >>> Finished "Launching the whole pipeline" in 161.3023 secs
2025-03-13 15:59:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 31633 [episode count 13/20]
[retrieval_preprocessing] for episode 23482 [episode count 14/20], we have num_retrieval=np.int64(9666) num_query=np.int64(495)
2025-03-13 15:59:10,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:12,149 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:12
2025-03-13 15:59:12,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 874.00it/s]
2025-03-13 15:59:12,176 [INFO]: There are 9666 embeddings of dim 49152
2025-03-13 15:59:12,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:59:12,176 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:12
2025-03-13 15:59:12,176 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:12,176 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 15:59:12,176 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:59:12,176 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:59:12,176 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:12
2025-03-13 15:59:12,176 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:12,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:59:12,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:12
2025-03-13 15:59:12,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:12,177 [INFO]: 	Creating the index 03/13/2025, 15:59:12
2025-03-13 15:59:12,177 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:12
2025-03-13 15:59:12,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 15:59:12,178 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:12
2025-03-13 15:59:12,179 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:59:12,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.29it/s] 12%|█▎        | 5/40 [00:00<00:01, 21.86it/s] 20%|██        | 8/40 [00:00<00:01, 24.43it/s] 30%|███       | 12/40 [00:00<00:00, 29.44it/s] 40%|████      | 16/40 [00:00<00:00, 32.19it/s] 50%|█████     | 20/40 [00:00<00:00, 33.73it/s] 60%|██████    | 24/40 [00:04<00:05,  2.72it/s] 68%|██████▊   | 27/40 [00:04<00:03,  3.59it/s] 78%|███████▊  | 31/40 [00:04<00:01,  5.19it/s] 90%|█████████ | 36/40 [00:05<00:00,  7.78it/s]100%|██████████| 40/40 [00:11<00:00,  1.76it/s]100%|██████████| 40/40 [00:11<00:00,  3.50it/s]
2025-03-13 15:59:24,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:24
2025-03-13 16:00:44,699 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.5127 secs
2025-03-13 16:00:44,699 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 16:00:44,699 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 16:01:52,240 [INFO]: 	>>> Finished "Compute fast metrics" in 67.5403 secs
2025-03-13 16:01:52,243 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 160.0645 secs
2025-03-13 16:01:52,243 [INFO]: {
2025-03-13 16:01:52,243 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:52,243 [INFO]: 	index_param: efSearch=193
2025-03-13 16:01:52,243 [INFO]: 	index_path: knn.index
2025-03-13 16:01:52,243 [INFO]: 	size in bytes: 1901728090
2025-03-13 16:01:52,243 [INFO]: 	avg_search_speed_ms: 13.473741153962058
2025-03-13 16:01:52,243 [INFO]: 	99p_search_speed_ms: 22.355245389044292
2025-03-13 16:01:52,243 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:52,243 [INFO]: 	nb vectors: 9666
2025-03-13 16:01:52,243 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:52,243 [INFO]: 	compression ratio: 0.9993084384634608
2025-03-13 16:01:52,243 [INFO]: }
2025-03-13 16:01:52,243 [INFO]: 	>>> Finished "Creating the index" in 160.0669 secs
2025-03-13 16:01:52,243 [INFO]: >>> Finished "Launching the whole pipeline" in 160.0946 secs
2025-03-13 16:01:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 23482 [episode count 14/20]
[retrieval_preprocessing] for episode 67240 [episode count 15/20], we have num_retrieval=np.int64(9666) num_query=np.int64(495)
2025-03-13 16:01:58,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:00,664 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:00
2025-03-13 16:02:00,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.71it/s]
2025-03-13 16:02:00,693 [INFO]: There are 9666 embeddings of dim 49152
2025-03-13 16:02:00,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 16:02:00,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:00,694 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 16:02:00,694 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:02:00,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:02:00,694 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,694 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:00,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:02:00,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:00
2025-03-13 16:02:00,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:00,694 [INFO]: 	Creating the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:00
2025-03-13 16:02:00,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:02:00,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:00
2025-03-13 16:02:00,695 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 16:02:00,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:06,  5.71it/s] 12%|█▎        | 5/40 [00:00<00:01, 20.09it/s] 25%|██▌       | 10/40 [00:00<00:01, 29.52it/s] 38%|███▊      | 15/40 [00:00<00:00, 34.82it/s] 50%|█████     | 20/40 [00:00<00:00, 37.38it/s] 60%|██████    | 24/40 [00:06<00:07,  2.04it/s] 72%|███████▎  | 29/40 [00:06<00:03,  3.10it/s] 85%|████████▌ | 34/40 [00:06<00:01,  4.51it/s] 95%|█████████▌| 38/40 [00:07<00:00,  5.98it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
2025-03-13 16:02:12,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:12
2025-03-13 16:03:32,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.1707 secs
2025-03-13 16:03:32,036 [INFO]: The best hyperparameters are: efSearch=219
2025-03-13 16:03:32,036 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.22it/s]
2025-03-13 16:04:36,958 [INFO]: 	>>> Finished "Compute fast metrics" in 64.9219 secs
2025-03-13 16:04:36,962 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.2671 secs
2025-03-13 16:04:36,963 [INFO]: {
2025-03-13 16:04:36,963 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:36,963 [INFO]: 	index_param: efSearch=219
2025-03-13 16:04:36,963 [INFO]: 	index_path: knn.index
2025-03-13 16:04:36,963 [INFO]: 	size in bytes: 1901728090
2025-03-13 16:04:36,963 [INFO]: 	avg_search_speed_ms: 18.27460111851335
2025-03-13 16:04:36,963 [INFO]: 	99p_search_speed_ms: 33.343982524238506
2025-03-13 16:04:36,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:36,963 [INFO]: 	nb vectors: 9666
2025-03-13 16:04:36,963 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:36,963 [INFO]: 	compression ratio: 0.9993084384634608
2025-03-13 16:04:36,963 [INFO]: }
2025-03-13 16:04:36,963 [INFO]: 	>>> Finished "Creating the index" in 156.2689 secs
2025-03-13 16:04:36,963 [INFO]: >>> Finished "Launching the whole pipeline" in 156.2988 secs
2025-03-13 16:04:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 67240 [episode count 15/20]
[retrieval_preprocessing] for episode 74207 [episode count 16/20], we have num_retrieval=np.int64(9744) num_query=np.int64(417)
2025-03-13 16:04:44,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:47,070 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:47
2025-03-13 16:04:47,071 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.60it/s]
2025-03-13 16:04:47,106 [INFO]: There are 9744 embeddings of dim 49152
2025-03-13 16:04:47,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-13 16:04:47,107 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:47
2025-03-13 16:04:47,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:47,108 [INFO]: 		-> Add: 5.4 seconds
2025-03-13 16:04:47,108 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:04:47,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:04:47,108 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:47
2025-03-13 16:04:47,109 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:47,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:04:47,109 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:47
2025-03-13 16:04:47,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:47,109 [INFO]: 	Creating the index 03/13/2025, 16:04:47
2025-03-13 16:04:47,109 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:47
2025-03-13 16:04:47,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:04:47,113 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:47
2025-03-13 16:04:47,113 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 16:04:47,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:05,  7.76it/s] 15%|█▌        | 6/40 [00:00<00:01, 26.39it/s] 25%|██▌       | 10/40 [00:00<00:00, 30.60it/s] 38%|███▊      | 15/40 [00:00<00:00, 35.97it/s] 50%|█████     | 20/40 [00:00<00:00, 38.99it/s] 60%|██████    | 24/40 [00:05<00:06,  2.31it/s] 72%|███████▎  | 29/40 [00:05<00:03,  3.50it/s] 85%|████████▌ | 34/40 [00:06<00:01,  5.10it/s] 98%|█████████▊| 39/40 [00:06<00:00,  7.17it/s]100%|██████████| 40/40 [00:10<00:00,  3.74it/s]
2025-03-13 16:04:58,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:58
2025-03-13 16:06:11,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 73.9064 secs
2025-03-13 16:06:11,920 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 16:06:11,920 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 16:07:12,463 [INFO]: 	>>> Finished "Compute fast metrics" in 60.5431 secs
2025-03-13 16:07:12,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.3537 secs
2025-03-13 16:07:12,467 [INFO]: {
2025-03-13 16:07:12,467 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:12,467 [INFO]: 	index_param: efSearch=197
2025-03-13 16:07:12,467 [INFO]: 	index_path: knn.index
2025-03-13 16:07:12,467 [INFO]: 	size in bytes: 1917074170
2025-03-13 16:07:12,467 [INFO]: 	avg_search_speed_ms: 11.775885096798323
2025-03-13 16:07:12,467 [INFO]: 	99p_search_speed_ms: 20.579281039536
2025-03-13 16:07:12,467 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:12,467 [INFO]: 	nb vectors: 9744
2025-03-13 16:07:12,467 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:12,467 [INFO]: 	compression ratio: 0.9993084159075598
2025-03-13 16:07:12,467 [INFO]: }
2025-03-13 16:07:12,467 [INFO]: 	>>> Finished "Creating the index" in 145.3579 secs
2025-03-13 16:07:12,467 [INFO]: >>> Finished "Launching the whole pipeline" in 145.3966 secs
2025-03-13 16:07:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 74207 [episode count 16/20]
[retrieval_preprocessing] for episode 50551 [episode count 17/20], we have num_retrieval=np.int64(9563) num_query=np.int64(598)
2025-03-13 16:07:17,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:19,531 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:19
2025-03-13 16:07:19,531 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-13 16:07:19,560 [INFO]: There are 9563 embeddings of dim 49152
2025-03-13 16:07:19,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:07:19,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:19
2025-03-13 16:07:19,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:19,560 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 16:07:19,560 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:07:19,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:07:19,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:19
2025-03-13 16:07:19,560 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:19,560 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:19,560 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:19
2025-03-13 16:07:19,560 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:19,560 [INFO]: 	Creating the index 03/13/2025, 16:07:19
2025-03-13 16:07:19,560 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:19
2025-03-13 16:07:19,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:07:19,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:19
2025-03-13 16:07:19,562 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 16:07:19,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  6.53it/s] 15%|█▌        | 6/39 [00:00<00:01, 26.62it/s] 28%|██▊       | 11/39 [00:00<00:00, 35.18it/s] 38%|███▊      | 15/39 [00:00<00:00, 36.73it/s] 51%|█████▏    | 20/39 [00:00<00:00, 38.58it/s] 62%|██████▏   | 24/39 [00:05<00:06,  2.41it/s] 74%|███████▍  | 29/39 [00:05<00:02,  3.68it/s] 87%|████████▋ | 34/39 [00:05<00:00,  5.37it/s]100%|██████████| 39/39 [00:09<00:00,  2.58it/s]100%|██████████| 39/39 [00:09<00:00,  3.99it/s]
2025-03-13 16:07:29,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:29
2025-03-13 16:08:58,584 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2459 secs
2025-03-13 16:08:58,584 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 16:08:58,584 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.74it/s]
2025-03-13 16:10:28,085 [INFO]: 	>>> Finished "Compute fast metrics" in 89.5005 secs
2025-03-13 16:10:28,569 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 189.0072 secs
2025-03-13 16:10:28,570 [INFO]: {
2025-03-13 16:10:28,570 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:28,570 [INFO]: 	index_param: efSearch=172
2025-03-13 16:10:28,570 [INFO]: 	index_path: knn.index
2025-03-13 16:10:28,570 [INFO]: 	size in bytes: 1881463570
2025-03-13 16:10:28,570 [INFO]: 	avg_search_speed_ms: 13.372229993029592
2025-03-13 16:10:28,570 [INFO]: 	99p_search_speed_ms: 23.508903344627434
2025-03-13 16:10:28,570 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:28,570 [INFO]: 	nb vectors: 9563
2025-03-13 16:10:28,571 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:28,571 [INFO]: 	compression ratio: 0.9993083756599125
2025-03-13 16:10:28,571 [INFO]: }
2025-03-13 16:10:28,571 [INFO]: 	>>> Finished "Creating the index" in 189.0104 secs
2025-03-13 16:10:28,571 [INFO]: >>> Finished "Launching the whole pipeline" in 189.0402 secs
2025-03-13 16:10:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 50551 [episode count 17/20]
[retrieval_preprocessing] for episode 7531 [episode count 18/20], we have num_retrieval=np.int64(9565) num_query=np.int64(596)
2025-03-13 16:10:36,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:37,893 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:37
2025-03-13 16:10:37,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-13 16:10:37,922 [INFO]: There are 9565 embeddings of dim 49152
2025-03-13 16:10:37,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:10:37,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:37
2025-03-13 16:10:37,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:37,922 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 16:10:37,922 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:10:37,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:10:37,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:37
2025-03-13 16:10:37,922 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:37,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:10:37,922 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:37
2025-03-13 16:10:37,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:37,922 [INFO]: 	Creating the index 03/13/2025, 16:10:37
2025-03-13 16:10:37,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:37
2025-03-13 16:10:37,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:10:37,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:37
2025-03-13 16:10:37,924 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 16:10:37,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/39 [00:00<?, ?it/s]  3%|▎         | 1/39 [00:00<00:05,  7.16it/s] 15%|█▌        | 6/39 [00:00<00:01, 26.61it/s] 28%|██▊       | 11/39 [00:00<00:00, 34.29it/s] 41%|████      | 16/39 [00:00<00:00, 38.30it/s] 54%|█████▍    | 21/39 [00:04<00:06,  2.77it/s] 64%|██████▍   | 25/39 [00:05<00:03,  3.87it/s] 77%|███████▋  | 30/39 [00:05<00:01,  5.71it/s] 90%|████████▉ | 35/39 [00:05<00:00,  8.06it/s]100%|██████████| 39/39 [00:10<00:00,  2.36it/s]100%|██████████| 39/39 [00:10<00:00,  3.87it/s]
2025-03-13 16:10:48,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:48
2025-03-13 16:12:14,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.6966 secs
2025-03-13 16:12:14,709 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 16:12:14,709 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.96it/s]
2025-03-13 16:13:16,045 [INFO]: 	>>> Finished "Compute fast metrics" in 61.3361 secs
2025-03-13 16:13:16,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 158.1262 secs
2025-03-13 16:13:16,050 [INFO]: {
2025-03-13 16:13:16,050 [INFO]: 	index_key: HNSW15
2025-03-13 16:13:16,050 [INFO]: 	index_param: efSearch=169
2025-03-13 16:13:16,050 [INFO]: 	index_path: knn.index
2025-03-13 16:13:16,050 [INFO]: 	size in bytes: 1881857050
2025-03-13 16:13:16,050 [INFO]: 	avg_search_speed_ms: 9.810334733907604
2025-03-13 16:13:16,050 [INFO]: 	99p_search_speed_ms: 16.450827182270586
2025-03-13 16:13:16,050 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:13:16,050 [INFO]: 	nb vectors: 9565
2025-03-13 16:13:16,050 [INFO]: 	vectors dimension: 49152
2025-03-13 16:13:16,050 [INFO]: 	compression ratio: 0.9993083799856105
2025-03-13 16:13:16,050 [INFO]: }
2025-03-13 16:13:16,050 [INFO]: 	>>> Finished "Creating the index" in 158.1280 secs
2025-03-13 16:13:16,050 [INFO]: >>> Finished "Launching the whole pipeline" in 158.1570 secs
2025-03-13 16:13:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:13:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 7531 [episode count 18/20]
[retrieval_preprocessing] for episode 32332 [episode count 19/20], we have num_retrieval=np.int64(9720) num_query=np.int64(441)
2025-03-13 16:13:21,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:13:23,387 [INFO]: Launching the whole pipeline 03/13/2025, 16:13:23
2025-03-13 16:13:23,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:13:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.93it/s]
2025-03-13 16:13:23,415 [INFO]: There are 9720 embeddings of dim 49152
2025-03-13 16:13:23,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 16:13:23,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:13:23
2025-03-13 16:13:23,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:13:23,416 [INFO]: 		-> Add: 5.3 seconds
2025-03-13 16:13:23,416 [INFO]: 		Total: 16.8 minutes
2025-03-13 16:13:23,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:13:23,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:13:23
2025-03-13 16:13:23,416 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:13:23,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:13:23,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:13:23
2025-03-13 16:13:23,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:13:23,416 [INFO]: 	Creating the index 03/13/2025, 16:13:23
2025-03-13 16:13:23,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:13:23
2025-03-13 16:13:23,417 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:13:23,417 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:13:23
2025-03-13 16:13:23,417 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 16:13:23,417 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:06,  6.38it/s] 10%|█         | 4/40 [00:00<00:02, 17.54it/s] 22%|██▎       | 9/40 [00:00<00:01, 29.25it/s] 35%|███▌      | 14/40 [00:00<00:00, 35.68it/s] 48%|████▊     | 19/40 [00:00<00:00, 39.39it/s] 57%|█████▊    | 23/40 [00:13<00:00, 39.39it/s] 60%|██████    | 24/40 [00:17<00:19,  1.23s/it] 62%|██████▎   | 25/40 [00:21<00:22,  1.50s/it] 70%|███████   | 28/40 [00:29<00:22,  1.84s/it] 75%|███████▌  | 30/40 [00:32<00:17,  1.76s/it] 80%|████████  | 32/40 [00:35<00:13,  1.70s/it] 82%|████████▎ | 33/40 [00:35<00:10,  1.47s/it] 85%|████████▌ | 34/40 [00:36<00:08,  1.43s/it] 88%|████████▊ | 35/40 [00:36<00:06,  1.24s/it] 90%|█████████ | 36/40 [00:38<00:05,  1.31s/it] 95%|█████████▌| 38/40 [00:38<00:01,  1.21it/s]100%|██████████| 40/40 [00:43<00:00,  1.40s/it]100%|██████████| 40/40 [00:43<00:00,  1.09s/it]
2025-03-13 16:14:06,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:06
2025-03-13 16:15:50,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 103.9129 secs
2025-03-13 16:15:50,775 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 16:15:50,775 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.63it/s]
2025-03-13 16:17:12,642 [INFO]: 	>>> Finished "Compute fast metrics" in 81.8672 secs
2025-03-13 16:17:12,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 229.2738 secs
2025-03-13 16:17:12,691 [INFO]: {
2025-03-13 16:17:12,691 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:12,691 [INFO]: 	index_param: efSearch=144
2025-03-13 16:17:12,691 [INFO]: 	index_path: knn.index
2025-03-13 16:17:12,691 [INFO]: 	size in bytes: 1912352110
2025-03-13 16:17:12,691 [INFO]: 	avg_search_speed_ms: 9.017119962198036
2025-03-13 16:17:12,692 [INFO]: 	99p_search_speed_ms: 17.70502582192423
2025-03-13 16:17:12,692 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:12,692 [INFO]: 	nb vectors: 9720
2025-03-13 16:17:12,692 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:12,692 [INFO]: 	compression ratio: 0.9993085216926918
2025-03-13 16:17:12,692 [INFO]: }
2025-03-13 16:17:12,692 [INFO]: 	>>> Finished "Creating the index" in 229.2755 secs
2025-03-13 16:17:12,692 [INFO]: >>> Finished "Launching the whole pipeline" in 229.3047 secs
2025-03-13 16:17:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 32332 [episode count 19/20]
2025-03-13 16:17:15: [retrieval_preprocessing] finished for 1656877278_put_cups_on_tray [chosen_id count 1/196]
2025-03-13 16:17:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1688824394_put_straw_in_cup [chosen_id count 2/196]
2025-03-13 16:17:18: [retrieval_preprocessing] we have num_total=7250 embedding_dim=49152
[retrieval_preprocessing] for episode 27136 [episode count 0/20], we have num_retrieval=np.int64(7030) num_query=np.int64(220)
2025-03-13 16:17:19,577 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:20,934 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:20
2025-03-13 16:17:20,935 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 990.86it/s]
2025-03-13 16:17:20,962 [INFO]: There are 7030 embeddings of dim 49152
2025-03-13 16:17:20,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 16:17:20,962 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:20
2025-03-13 16:17:20,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:20,963 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:17:20,963 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:20,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:20,963 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:20
2025-03-13 16:17:20,963 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:20,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:17:20,963 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:20
2025-03-13 16:17:20,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:20,963 [INFO]: 	Creating the index 03/13/2025, 16:17:20
2025-03-13 16:17:20,963 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:20
2025-03-13 16:17:20,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:17:20,965 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:20
2025-03-13 16:17:20,965 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:17:20,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.58it/s] 21%|██        | 6/29 [00:00<00:00, 26.40it/s] 38%|███▊      | 11/29 [00:00<00:00, 34.69it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.72it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.42it/s] 83%|████████▎ | 24/29 [00:05<00:01,  3.13it/s] 93%|█████████▎| 27/29 [00:05<00:00,  4.07it/s]100%|██████████| 29/29 [00:08<00:00,  3.57it/s]
2025-03-13 16:17:29,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:29
2025-03-13 16:18:38,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.6571 secs
2025-03-13 16:18:38,755 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:18:38,755 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.59s/it] 50%|█████     | 2/4 [00:01<00:01,  1.39it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.71it/s]
2025-03-13 16:19:18,498 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7421 secs
2025-03-13 16:19:18,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.5356 secs
2025-03-13 16:19:18,500 [INFO]: {
2025-03-13 16:19:18,500 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:18,500 [INFO]: 	index_param: efSearch=201
2025-03-13 16:19:18,500 [INFO]: 	index_path: knn.index
2025-03-13 16:19:18,500 [INFO]: 	size in bytes: 1383110890
2025-03-13 16:19:18,501 [INFO]: 	avg_search_speed_ms: 11.40060824922954
2025-03-13 16:19:18,501 [INFO]: 	99p_search_speed_ms: 18.411029055714607
2025-03-13 16:19:18,501 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:18,501 [INFO]: 	nb vectors: 7030
2025-03-13 16:19:18,501 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:18,501 [INFO]: 	compression ratio: 0.9993083345616633
2025-03-13 16:19:18,501 [INFO]: }
2025-03-13 16:19:18,501 [INFO]: 	>>> Finished "Creating the index" in 117.5374 secs
2025-03-13 16:19:18,501 [INFO]: >>> Finished "Launching the whole pipeline" in 117.5661 secs
2025-03-13 16:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 27136 [episode count 0/20]
[retrieval_preprocessing] for episode 55822 [episode count 1/20], we have num_retrieval=np.int64(6732) num_query=np.int64(518)
2025-03-13 16:19:22,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:23,752 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:23
2025-03-13 16:19:23,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 622.76it/s]
2025-03-13 16:19:23,781 [INFO]: There are 6732 embeddings of dim 49152
2025-03-13 16:19:23,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 16:19:23,782 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:23
2025-03-13 16:19:23,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:23,782 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:19:23,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:23,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:23,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:23
2025-03-13 16:19:23,782 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:23,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:23,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:23
2025-03-13 16:19:23,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:23,782 [INFO]: 	Creating the index 03/13/2025, 16:19:23
2025-03-13 16:19:23,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:23
2025-03-13 16:19:23,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:19:23,784 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:23
2025-03-13 16:19:23,784 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:19:23,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  5.68it/s] 14%|█▍        | 4/28 [00:00<00:01, 16.32it/s] 29%|██▊       | 8/28 [00:00<00:00, 23.12it/s] 43%|████▎     | 12/28 [00:00<00:00, 26.35it/s] 54%|█████▎    | 15/28 [00:00<00:00, 27.43it/s] 68%|██████▊   | 19/28 [00:00<00:00, 28.73it/s] 79%|███████▊  | 22/28 [00:05<00:02,  2.05it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.09it/s]100%|██████████| 28/28 [00:07<00:00,  3.50it/s]
2025-03-13 16:19:31,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:31
2025-03-13 16:20:32,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8027 secs
2025-03-13 16:20:32,589 [INFO]: The best hyperparameters are: efSearch=78
2025-03-13 16:20:32,589 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.64it/s]
2025-03-13 16:21:00,613 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0239 secs
2025-03-13 16:21:00,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.8304 secs
2025-03-13 16:21:00,614 [INFO]: {
2025-03-13 16:21:00,614 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:00,614 [INFO]: 	index_param: efSearch=78
2025-03-13 16:21:00,614 [INFO]: 	index_path: knn.index
2025-03-13 16:21:00,614 [INFO]: 	size in bytes: 1324481050
2025-03-13 16:21:00,614 [INFO]: 	avg_search_speed_ms: 4.811397467274219
2025-03-13 16:21:00,614 [INFO]: 	99p_search_speed_ms: 9.399192596320061
2025-03-13 16:21:00,614 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:00,614 [INFO]: 	nb vectors: 6732
2025-03-13 16:21:00,614 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:00,614 [INFO]: 	compression ratio: 0.9993084129063228
2025-03-13 16:21:00,614 [INFO]: }
2025-03-13 16:21:00,615 [INFO]: 	>>> Finished "Creating the index" in 96.8322 secs
2025-03-13 16:21:00,615 [INFO]: >>> Finished "Launching the whole pipeline" in 96.8627 secs
2025-03-13 16:21:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 55822 [episode count 1/20]
[retrieval_preprocessing] for episode 94266 [episode count 2/20], we have num_retrieval=np.int64(7057) num_query=np.int64(193)
2025-03-13 16:21:03,983 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:04,951 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:04
2025-03-13 16:21:04,951 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-13 16:21:04,978 [INFO]: There are 7057 embeddings of dim 49152
2025-03-13 16:21:04,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:21:04,978 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:04
2025-03-13 16:21:04,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:04,978 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:21:04,978 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:04,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:04,978 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:04
2025-03-13 16:21:04,978 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:04,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:04,979 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:04
2025-03-13 16:21:04,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:04,979 [INFO]: 	Creating the index 03/13/2025, 16:21:04
2025-03-13 16:21:04,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:04
2025-03-13 16:21:04,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:21:04,980 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:04
2025-03-13 16:21:04,980 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:21:04,980 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.86it/s] 21%|██        | 6/29 [00:00<00:00, 32.27it/s] 38%|███▊      | 11/29 [00:00<00:00, 40.17it/s] 55%|█████▌    | 16/29 [00:00<00:00, 43.99it/s] 72%|███████▏  | 21/29 [00:03<00:02,  3.90it/s] 93%|█████████▎| 27/29 [00:03<00:00,  6.18it/s]100%|██████████| 29/29 [00:05<00:00,  5.52it/s]
2025-03-13 16:21:10,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:10
2025-03-13 16:22:09,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0735 secs
2025-03-13 16:22:09,312 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 16:22:09,312 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 16:23:02,248 [INFO]: 	>>> Finished "Compute fast metrics" in 52.9359 secs
2025-03-13 16:23:02,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.3715 secs
2025-03-13 16:23:02,352 [INFO]: {
2025-03-13 16:23:02,352 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:02,352 [INFO]: 	index_param: efSearch=202
2025-03-13 16:23:02,352 [INFO]: 	index_path: knn.index
2025-03-13 16:23:02,352 [INFO]: 	size in bytes: 1388422990
2025-03-13 16:23:02,352 [INFO]: 	avg_search_speed_ms: 7.787878177748163
2025-03-13 16:23:02,352 [INFO]: 	99p_search_speed_ms: 11.222429629415279
2025-03-13 16:23:02,352 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:02,352 [INFO]: 	nb vectors: 7057
2025-03-13 16:23:02,352 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:02,353 [INFO]: 	compression ratio: 0.9993083275003967
2025-03-13 16:23:02,353 [INFO]: }
2025-03-13 16:23:02,353 [INFO]: 	>>> Finished "Creating the index" in 117.3740 secs
2025-03-13 16:23:02,353 [INFO]: >>> Finished "Launching the whole pipeline" in 117.4013 secs
2025-03-13 16:23:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 94266 [episode count 2/20]
[retrieval_preprocessing] for episode 20036 [episode count 3/20], we have num_retrieval=np.int64(6920) num_query=np.int64(330)
2025-03-13 16:23:04,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:05,459 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:05
2025-03-13 16:23:05,459 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 16:23:05,484 [INFO]: There are 6920 embeddings of dim 49152
2025-03-13 16:23:05,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:23:05,485 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:05
2025-03-13 16:23:05,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:05,485 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:23:05,485 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:05,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:05,485 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:05
2025-03-13 16:23:05,485 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:05,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:05,485 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:05
2025-03-13 16:23:05,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:05,485 [INFO]: 	Creating the index 03/13/2025, 16:23:05
2025-03-13 16:23:05,485 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:05
2025-03-13 16:23:05,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:23:05,486 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:05
2025-03-13 16:23:05,486 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:23:05,486 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.33it/s] 21%|██        | 6/29 [00:00<00:00, 28.19it/s] 38%|███▊      | 11/29 [00:00<00:00, 36.40it/s] 55%|█████▌    | 16/29 [00:00<00:00, 39.19it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.15it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.69it/s]100%|██████████| 29/29 [00:06<00:00,  4.49it/s]
2025-03-13 16:23:11,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:11
2025-03-13 16:24:11,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6995 secs
2025-03-13 16:24:11,654 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:24:11,654 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.90it/s]
2025-03-13 16:24:38,332 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6776 secs
2025-03-13 16:24:38,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8483 secs
2025-03-13 16:24:38,335 [INFO]: {
2025-03-13 16:24:38,335 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:38,335 [INFO]: 	index_param: efSearch=187
2025-03-13 16:24:38,335 [INFO]: 	index_path: knn.index
2025-03-13 16:24:38,335 [INFO]: 	size in bytes: 1361469010
2025-03-13 16:24:38,335 [INFO]: 	avg_search_speed_ms: 11.415840870463963
2025-03-13 16:24:38,335 [INFO]: 	99p_search_speed_ms: 21.612354842945937
2025-03-13 16:24:38,335 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:38,335 [INFO]: 	nb vectors: 6920
2025-03-13 16:24:38,335 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:38,335 [INFO]: 	compression ratio: 0.9993083573749505
2025-03-13 16:24:38,335 [INFO]: }
2025-03-13 16:24:38,335 [INFO]: 	>>> Finished "Creating the index" in 92.8500 secs
2025-03-13 16:24:38,335 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8763 secs
2025-03-13 16:24:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 20036 [episode count 3/20]
[retrieval_preprocessing] for episode 55369 [episode count 4/20], we have num_retrieval=np.int64(6954) num_query=np.int64(296)
2025-03-13 16:24:42,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:43,513 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:43
2025-03-13 16:24:43,514 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-13 16:24:43,540 [INFO]: There are 6954 embeddings of dim 49152
2025-03-13 16:24:43,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:24:43,540 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:43
2025-03-13 16:24:43,540 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:43,540 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:24:43,540 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:43,540 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:43,540 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:43
2025-03-13 16:24:43,540 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:43,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:24:43,540 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:43
2025-03-13 16:24:43,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:43,540 [INFO]: 	Creating the index 03/13/2025, 16:24:43
2025-03-13 16:24:43,540 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:43
2025-03-13 16:24:43,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:24:43,542 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:43
2025-03-13 16:24:43,542 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:24:43,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.46it/s] 21%|██        | 6/29 [00:00<00:00, 24.68it/s] 38%|███▊      | 11/29 [00:00<00:00, 31.97it/s] 55%|█████▌    | 16/29 [00:00<00:00, 35.28it/s] 72%|███████▏  | 21/29 [00:05<00:03,  2.39it/s] 86%|████████▌ | 25/29 [00:05<00:01,  3.35it/s]100%|██████████| 29/29 [00:07<00:00,  2.74it/s]100%|██████████| 29/29 [00:07<00:00,  3.68it/s]
2025-03-13 16:24:51,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:51
2025-03-13 16:25:52,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2812 secs
2025-03-13 16:25:52,702 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 16:25:52,702 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.50it/s]
2025-03-13 16:26:53,269 [INFO]: 	>>> Finished "Compute fast metrics" in 60.5671 secs
2025-03-13 16:26:53,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 129.7291 secs
2025-03-13 16:26:53,271 [INFO]: {
2025-03-13 16:26:53,271 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:53,271 [INFO]: 	index_param: efSearch=181
2025-03-13 16:26:53,271 [INFO]: 	index_path: knn.index
2025-03-13 16:26:53,271 [INFO]: 	size in bytes: 1368158350
2025-03-13 16:26:53,271 [INFO]: 	avg_search_speed_ms: 8.570336530842175
2025-03-13 16:26:53,271 [INFO]: 	99p_search_speed_ms: 15.685583478771143
2025-03-13 16:26:53,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:53,271 [INFO]: 	nb vectors: 6954
2025-03-13 16:26:53,271 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:53,271 [INFO]: 	compression ratio: 0.9993083271391795
2025-03-13 16:26:53,271 [INFO]: }
2025-03-13 16:26:53,271 [INFO]: 	>>> Finished "Creating the index" in 129.7306 secs
2025-03-13 16:26:53,271 [INFO]: >>> Finished "Launching the whole pipeline" in 129.7575 secs
2025-03-13 16:26:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 55369 [episode count 4/20]
[retrieval_preprocessing] for episode 83543 [episode count 5/20], we have num_retrieval=np.int64(6906) num_query=np.int64(344)
2025-03-13 16:26:56,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:57,288 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:57
2025-03-13 16:26:57,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.39it/s]
2025-03-13 16:26:57,315 [INFO]: There are 6906 embeddings of dim 49152
2025-03-13 16:26:57,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 16:26:57,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:57
2025-03-13 16:26:57,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:57,316 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:26:57,316 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:57,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:26:57,316 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:57
2025-03-13 16:26:57,317 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:57,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:26:57,317 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:57
2025-03-13 16:26:57,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:57,318 [INFO]: 	Creating the index 03/13/2025, 16:26:57
2025-03-13 16:26:57,318 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:57
2025-03-13 16:26:57,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:26:57,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:57
2025-03-13 16:26:57,321 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:26:57,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.97it/s] 21%|██        | 6/29 [00:00<00:00, 30.04it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.58it/s] 55%|█████▌    | 16/29 [00:00<00:00, 37.86it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.06it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.59it/s]100%|██████████| 29/29 [00:06<00:00,  4.50it/s]
2025-03-13 16:27:03,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:03
2025-03-13 16:28:07,487 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7187 secs
2025-03-13 16:28:07,487 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 16:28:07,488 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s]
2025-03-13 16:28:54,382 [INFO]: 	>>> Finished "Compute fast metrics" in 46.8941 secs
2025-03-13 16:28:54,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.0623 secs
2025-03-13 16:28:54,384 [INFO]: {
2025-03-13 16:28:54,384 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:54,384 [INFO]: 	index_param: efSearch=182
2025-03-13 16:28:54,384 [INFO]: 	index_path: knn.index
2025-03-13 16:28:54,384 [INFO]: 	size in bytes: 1358714530
2025-03-13 16:28:54,384 [INFO]: 	avg_search_speed_ms: 8.036689127389629
2025-03-13 16:28:54,384 [INFO]: 	99p_search_speed_ms: 14.732881884556246
2025-03-13 16:28:54,384 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:54,384 [INFO]: 	nb vectors: 6906
2025-03-13 16:28:54,384 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:54,384 [INFO]: 	compression ratio: 0.999308403657095
2025-03-13 16:28:54,384 [INFO]: }
2025-03-13 16:28:54,384 [INFO]: 	>>> Finished "Creating the index" in 117.0661 secs
2025-03-13 16:28:54,384 [INFO]: >>> Finished "Launching the whole pipeline" in 117.0958 secs
2025-03-13 16:28:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 83543 [episode count 5/20]
[retrieval_preprocessing] for episode 25730 [episode count 6/20], we have num_retrieval=np.int64(6762) num_query=np.int64(488)
2025-03-13 16:28:57,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:58,565 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:58
2025-03-13 16:28:58,565 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-13 16:28:58,832 [INFO]: There are 6762 embeddings of dim 49152
2025-03-13 16:28:58,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2679 secs
2025-03-13 16:28:58,833 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:58
2025-03-13 16:28:58,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:58,834 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:28:58,834 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:58,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:28:58,834 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:58
2025-03-13 16:28:58,834 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:58,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:28:58,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:58
2025-03-13 16:28:58,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:58,835 [INFO]: 	Creating the index 03/13/2025, 16:28:58
2025-03-13 16:28:58,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:58
2025-03-13 16:28:58,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:28:58,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:58
2025-03-13 16:28:58,839 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:28:58,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.82it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.11it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.44it/s] 57%|█████▋    | 16/28 [00:00<00:00, 38.30it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.06it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.57it/s]100%|██████████| 28/28 [00:06<00:00,  4.20it/s]
2025-03-13 16:29:05,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:05
2025-03-13 16:30:09,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.5200 secs
2025-03-13 16:30:09,026 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 16:30:09,027 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.73it/s]
2025-03-13 16:30:34,010 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9829 secs
2025-03-13 16:30:34,011 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.1723 secs
2025-03-13 16:30:34,011 [INFO]: {
2025-03-13 16:30:34,011 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:34,011 [INFO]: 	index_param: efSearch=143
2025-03-13 16:30:34,011 [INFO]: 	index_path: knn.index
2025-03-13 16:30:34,011 [INFO]: 	size in bytes: 1330383310
2025-03-13 16:30:34,012 [INFO]: 	avg_search_speed_ms: 6.4973312384727135
2025-03-13 16:30:34,012 [INFO]: 	99p_search_speed_ms: 10.961488164030003
2025-03-13 16:30:34,012 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:34,012 [INFO]: 	nb vectors: 6762
2025-03-13 16:30:34,012 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:34,012 [INFO]: 	compression ratio: 0.999308459454441
2025-03-13 16:30:34,012 [INFO]: }
2025-03-13 16:30:34,012 [INFO]: 	>>> Finished "Creating the index" in 95.1762 secs
2025-03-13 16:30:34,012 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4468 secs
2025-03-13 16:30:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 25730 [episode count 6/20]
[retrieval_preprocessing] for episode 13971 [episode count 7/20], we have num_retrieval=np.int64(6769) num_query=np.int64(481)
2025-03-13 16:30:37,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:39,258 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:39
2025-03-13 16:30:39,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.42it/s]
2025-03-13 16:30:39,286 [INFO]: There are 6769 embeddings of dim 49152
2025-03-13 16:30:39,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 16:30:39,287 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:39
2025-03-13 16:30:39,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:39,287 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:30:39,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:39,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:30:39,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:39
2025-03-13 16:30:39,288 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:39,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:30:39,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:39
2025-03-13 16:30:39,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:39,289 [INFO]: 	Creating the index 03/13/2025, 16:30:39
2025-03-13 16:30:39,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:39
2025-03-13 16:30:39,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:30:39,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:39
2025-03-13 16:30:39,292 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:30:39,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 17.01it/s] 25%|██▌       | 7/28 [00:00<00:00, 34.82it/s] 43%|████▎     | 12/28 [00:00<00:00, 40.15it/s] 61%|██████    | 17/28 [00:00<00:00, 42.50it/s] 79%|███████▊  | 22/28 [00:04<00:01,  3.30it/s] 96%|█████████▋| 27/28 [00:04<00:00,  4.91it/s]100%|██████████| 28/28 [00:06<00:00,  4.50it/s]
2025-03-13 16:30:45,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:45
2025-03-13 16:31:42,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9349 secs
2025-03-13 16:31:42,455 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:31:42,455 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 16:32:09,283 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8277 secs
2025-03-13 16:32:09,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.9919 secs
2025-03-13 16:32:09,284 [INFO]: {
2025-03-13 16:32:09,284 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:09,284 [INFO]: 	index_param: efSearch=185
2025-03-13 16:32:09,284 [INFO]: 	index_path: knn.index
2025-03-13 16:32:09,284 [INFO]: 	size in bytes: 1331760490
2025-03-13 16:32:09,284 [INFO]: 	avg_search_speed_ms: 8.552481509566665
2025-03-13 16:32:09,284 [INFO]: 	99p_search_speed_ms: 16.13653991371393
2025-03-13 16:32:09,284 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:09,284 [INFO]: 	nb vectors: 6769
2025-03-13 16:32:09,284 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:09,284 [INFO]: 	compression ratio: 0.9993084807614319
2025-03-13 16:32:09,284 [INFO]: }
2025-03-13 16:32:09,284 [INFO]: 	>>> Finished "Creating the index" in 89.9959 secs
2025-03-13 16:32:09,284 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0264 secs
2025-03-13 16:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 13971 [episode count 7/20]
[retrieval_preprocessing] for episode 69780 [episode count 8/20], we have num_retrieval=np.int64(6919) num_query=np.int64(331)
2025-03-13 16:32:12,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:13,618 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:13
2025-03-13 16:32:13,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.69it/s]
2025-03-13 16:32:13,644 [INFO]: There are 6919 embeddings of dim 49152
2025-03-13 16:32:13,645 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:32:13,645 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:13
2025-03-13 16:32:13,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:13,645 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:32:13,645 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:13,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:32:13,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:13
2025-03-13 16:32:13,645 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:13,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:32:13,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:13
2025-03-13 16:32:13,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:13,645 [INFO]: 	Creating the index 03/13/2025, 16:32:13
2025-03-13 16:32:13,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:13
2025-03-13 16:32:13,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:32:13,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:13
2025-03-13 16:32:13,646 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:32:13,647 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.85it/s] 21%|██        | 6/29 [00:00<00:00, 28.87it/s] 38%|███▊      | 11/29 [00:00<00:00, 37.14it/s] 55%|█████▌    | 16/29 [00:00<00:00, 41.24it/s] 72%|███████▏  | 21/29 [00:03<00:02,  3.68it/s] 90%|████████▉ | 26/29 [00:03<00:00,  5.49it/s]100%|██████████| 29/29 [00:05<00:00,  5.31it/s]
2025-03-13 16:32:19,114 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:19
2025-03-13 16:33:21,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.9897 secs
2025-03-13 16:33:21,104 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 16:33:21,104 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.57it/s]
2025-03-13 16:33:57,991 [INFO]: 	>>> Finished "Compute fast metrics" in 36.8866 secs
2025-03-13 16:33:57,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.3470 secs
2025-03-13 16:33:57,994 [INFO]: {
2025-03-13 16:33:57,994 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:57,994 [INFO]: 	index_param: efSearch=162
2025-03-13 16:33:57,994 [INFO]: 	index_path: knn.index
2025-03-13 16:33:57,994 [INFO]: 	size in bytes: 1361272270
2025-03-13 16:33:57,994 [INFO]: 	avg_search_speed_ms: 8.471956620213843
2025-03-13 16:33:57,994 [INFO]: 	99p_search_speed_ms: 13.650491619482642
2025-03-13 16:33:57,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:57,994 [INFO]: 	nb vectors: 6919
2025-03-13 16:33:57,994 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:57,994 [INFO]: 	compression ratio: 0.9993083543823309
2025-03-13 16:33:57,994 [INFO]: }
2025-03-13 16:33:57,994 [INFO]: 	>>> Finished "Creating the index" in 104.3487 secs
2025-03-13 16:33:57,994 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3758 secs
2025-03-13 16:33:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 69780 [episode count 8/20]
[retrieval_preprocessing] for episode 76458 [episode count 9/20], we have num_retrieval=np.int64(6885) num_query=np.int64(365)
2025-03-13 16:34:02,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:03,605 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:03
2025-03-13 16:34:03,605 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 693.85it/s]
2025-03-13 16:34:03,640 [INFO]: There are 6885 embeddings of dim 49152
2025-03-13 16:34:03,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 16:34:03,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:03
2025-03-13 16:34:03,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:03,642 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:34:03,642 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:03,642 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:34:03,642 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:03
2025-03-13 16:34:03,643 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:03,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:34:03,643 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:03
2025-03-13 16:34:03,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:03,643 [INFO]: 	Creating the index 03/13/2025, 16:34:03
2025-03-13 16:34:03,644 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:03
2025-03-13 16:34:03,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:34:03,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:03
2025-03-13 16:34:03,647 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:34:03,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.38it/s] 17%|█▋        | 5/29 [00:00<00:01, 20.73it/s] 28%|██▊       | 8/29 [00:00<00:00, 24.28it/s] 38%|███▊      | 11/29 [00:00<00:00, 25.22it/s] 48%|████▊     | 14/29 [00:00<00:00, 26.41it/s] 59%|█████▊    | 17/29 [00:00<00:00, 27.50it/s] 69%|██████▉   | 20/29 [00:00<00:00, 23.97it/s] 79%|███████▉  | 23/29 [00:05<00:03,  1.97it/s] 97%|█████████▋| 28/29 [00:05<00:00,  3.35it/s]100%|██████████| 29/29 [00:07<00:00,  3.93it/s]
2025-03-13 16:34:11,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:11
2025-03-13 16:35:16,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1599 secs
2025-03-13 16:35:16,518 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:35:16,519 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 16:36:17,914 [INFO]: 	>>> Finished "Compute fast metrics" in 61.3954 secs
2025-03-13 16:36:17,915 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.2691 secs
2025-03-13 16:36:17,916 [INFO]: {
2025-03-13 16:36:17,916 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:17,916 [INFO]: 	index_param: efSearch=179
2025-03-13 16:36:17,916 [INFO]: 	index_path: knn.index
2025-03-13 16:36:17,916 [INFO]: 	size in bytes: 1354582810
2025-03-13 16:36:17,916 [INFO]: 	avg_search_speed_ms: 9.849842434767359
2025-03-13 16:36:17,916 [INFO]: 	99p_search_speed_ms: 15.37687996402383
2025-03-13 16:36:17,916 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:17,916 [INFO]: 	nb vectors: 6885
2025-03-13 16:36:17,916 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:17,916 [INFO]: 	compression ratio: 0.9993084734332337
2025-03-13 16:36:17,916 [INFO]: }
2025-03-13 16:36:17,916 [INFO]: 	>>> Finished "Creating the index" in 134.2722 secs
2025-03-13 16:36:17,916 [INFO]: >>> Finished "Launching the whole pipeline" in 134.3107 secs
2025-03-13 16:36:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 76458 [episode count 9/20]
[retrieval_preprocessing] for episode 43692 [episode count 10/20], we have num_retrieval=np.int64(6765) num_query=np.int64(485)
2025-03-13 16:36:22,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:23,011 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:23
2025-03-13 16:36:23,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.32it/s]
2025-03-13 16:36:23,036 [INFO]: There are 6765 embeddings of dim 49152
2025-03-13 16:36:23,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:36:23,037 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:23
2025-03-13 16:36:23,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:23,037 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:36:23,037 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:23,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:23,037 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:23
2025-03-13 16:36:23,037 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:23,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:36:23,037 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:23
2025-03-13 16:36:23,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:23,037 [INFO]: 	Creating the index 03/13/2025, 16:36:23
2025-03-13 16:36:23,037 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:23
2025-03-13 16:36:23,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:36:23,038 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:23
2025-03-13 16:36:23,038 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:36:23,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.56it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.92it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.14it/s] 57%|█████▋    | 16/28 [00:00<00:00, 38.46it/s] 75%|███████▌  | 21/28 [00:03<00:01,  3.79it/s] 93%|█████████▎| 26/28 [00:03<00:00,  5.63it/s]100%|██████████| 28/28 [00:05<00:00,  5.18it/s]
2025-03-13 16:36:28,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:28
2025-03-13 16:37:31,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.7194 secs
2025-03-13 16:37:31,162 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 16:37:31,162 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 16:38:22,022 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8602 secs
2025-03-13 16:38:22,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.9864 secs
2025-03-13 16:38:22,025 [INFO]: {
2025-03-13 16:38:22,025 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:22,025 [INFO]: 	index_param: efSearch=144
2025-03-13 16:38:22,025 [INFO]: 	index_path: knn.index
2025-03-13 16:38:22,025 [INFO]: 	size in bytes: 1330973530
2025-03-13 16:38:22,025 [INFO]: 	avg_search_speed_ms: 10.456878379441283
2025-03-13 16:38:22,025 [INFO]: 	99p_search_speed_ms: 18.643953022547066
2025-03-13 16:38:22,025 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:22,025 [INFO]: 	nb vectors: 6765
2025-03-13 16:38:22,025 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:22,025 [INFO]: 	compression ratio: 0.9993084685914077
2025-03-13 16:38:22,025 [INFO]: }
2025-03-13 16:38:22,025 [INFO]: 	>>> Finished "Creating the index" in 118.9878 secs
2025-03-13 16:38:22,025 [INFO]: >>> Finished "Launching the whole pipeline" in 119.0142 secs
2025-03-13 16:38:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 43692 [episode count 10/20]
[retrieval_preprocessing] for episode 70333 [episode count 11/20], we have num_retrieval=np.int64(6782) num_query=np.int64(468)
2025-03-13 16:38:27,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:29,555 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:29
2025-03-13 16:38:29,555 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 545.85it/s]
2025-03-13 16:38:29,595 [INFO]: There are 6782 embeddings of dim 49152
2025-03-13 16:38:29,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0397 secs
2025-03-13 16:38:29,596 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:29
2025-03-13 16:38:29,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:29,596 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:38:29,597 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:29,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:38:29,597 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:29
2025-03-13 16:38:29,597 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:29,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:38:29,598 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:29
2025-03-13 16:38:29,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:29,598 [INFO]: 	Creating the index 03/13/2025, 16:38:29
2025-03-13 16:38:29,599 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:29
2025-03-13 16:38:29,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 16:38:29,601 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:29
2025-03-13 16:38:29,602 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:38:29,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:06,  4.11it/s] 14%|█▍        | 4/28 [00:00<00:02, 11.78it/s] 25%|██▌       | 7/28 [00:00<00:01, 15.25it/s] 32%|███▏      | 9/28 [00:00<00:01, 16.12it/s] 39%|███▉      | 11/28 [00:00<00:00, 17.02it/s] 46%|████▋     | 13/28 [00:00<00:00, 17.68it/s] 54%|█████▎    | 15/28 [00:00<00:00, 18.17it/s] 61%|██████    | 17/28 [00:01<00:00, 18.45it/s] 71%|███████▏  | 20/28 [00:01<00:00, 19.08it/s] 79%|███████▊  | 22/28 [00:09<00:06,  1.13s/it] 93%|█████████▎| 26/28 [00:09<00:01,  1.56it/s]100%|██████████| 28/28 [00:12<00:00,  2.30it/s]
2025-03-13 16:38:41,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:41
2025-03-13 16:39:50,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.1320 secs
2025-03-13 16:39:50,935 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 16:39:50,935 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-13 16:40:53,165 [INFO]: 	>>> Finished "Compute fast metrics" in 62.2294 secs
2025-03-13 16:40:53,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.5644 secs
2025-03-13 16:40:53,166 [INFO]: {
2025-03-13 16:40:53,166 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:53,166 [INFO]: 	index_param: efSearch=181
2025-03-13 16:40:53,166 [INFO]: 	index_path: knn.index
2025-03-13 16:40:53,166 [INFO]: 	size in bytes: 1334318230
2025-03-13 16:40:53,166 [INFO]: 	avg_search_speed_ms: 6.853404862779391
2025-03-13 16:40:53,166 [INFO]: 	99p_search_speed_ms: 10.617113839834934
2025-03-13 16:40:53,166 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:53,166 [INFO]: 	nb vectors: 6782
2025-03-13 16:40:53,166 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:53,166 [INFO]: 	compression ratio: 0.9993084303434872
2025-03-13 16:40:53,166 [INFO]: }
2025-03-13 16:40:53,166 [INFO]: 	>>> Finished "Creating the index" in 143.5678 secs
2025-03-13 16:40:53,166 [INFO]: >>> Finished "Launching the whole pipeline" in 143.6110 secs
2025-03-13 16:40:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 70333 [episode count 11/20]
[retrieval_preprocessing] for episode 63692 [episode count 12/20], we have num_retrieval=np.int64(6812) num_query=np.int64(438)
2025-03-13 16:40:56,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:57,827 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:57
2025-03-13 16:40:57,827 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.84it/s]
2025-03-13 16:40:57,854 [INFO]: There are 6812 embeddings of dim 49152
2025-03-13 16:40:57,854 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:40:57,854 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:57
2025-03-13 16:40:57,854 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:57,854 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:40:57,854 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:57,854 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:40:57,854 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:57
2025-03-13 16:40:57,855 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:57,855 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:40:57,855 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:57
2025-03-13 16:40:57,855 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:57,855 [INFO]: 	Creating the index 03/13/2025, 16:40:57
2025-03-13 16:40:57,855 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:57
2025-03-13 16:40:57,856 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:40:57,856 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:57
2025-03-13 16:40:57,856 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:40:57,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.52it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.25it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.99it/s] 57%|█████▋    | 16/28 [00:00<00:00, 38.89it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.38it/s] 93%|█████████▎| 26/28 [00:04<00:00,  5.05it/s]100%|██████████| 28/28 [00:05<00:00,  4.70it/s]
2025-03-13 16:41:03,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:03
2025-03-13 16:42:10,440 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.6167 secs
2025-03-13 16:42:10,440 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 16:42:10,441 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.33it/s]
2025-03-13 16:42:38,598 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1577 secs
2025-03-13 16:42:38,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.7439 secs
2025-03-13 16:42:38,600 [INFO]: {
2025-03-13 16:42:38,600 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:38,600 [INFO]: 	index_param: efSearch=171
2025-03-13 16:42:38,600 [INFO]: 	index_path: knn.index
2025-03-13 16:42:38,600 [INFO]: 	size in bytes: 1340220550
2025-03-13 16:42:38,600 [INFO]: 	avg_search_speed_ms: 8.042567527300447
2025-03-13 16:42:38,600 [INFO]: 	99p_search_speed_ms: 13.347842113580555
2025-03-13 16:42:38,600 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:38,600 [INFO]: 	nb vectors: 6812
2025-03-13 16:42:38,600 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:38,601 [INFO]: 	compression ratio: 0.9993084317353588
2025-03-13 16:42:38,601 [INFO]: }
2025-03-13 16:42:38,601 [INFO]: 	>>> Finished "Creating the index" in 100.7457 secs
2025-03-13 16:42:38,601 [INFO]: >>> Finished "Launching the whole pipeline" in 100.7738 secs
2025-03-13 16:42:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 63692 [episode count 12/20]
[retrieval_preprocessing] for episode 42189 [episode count 13/20], we have num_retrieval=np.int64(6741) num_query=np.int64(509)
2025-03-13 16:42:43,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:46,056 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:46
2025-03-13 16:42:46,056 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.03it/s]
2025-03-13 16:42:46,085 [INFO]: There are 6741 embeddings of dim 49152
2025-03-13 16:42:46,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:42:46,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:46
2025-03-13 16:42:46,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:46,086 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 16:42:46,086 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:46,086 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:42:46,086 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:46
2025-03-13 16:42:46,086 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:46,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:42:46,086 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:46
2025-03-13 16:42:46,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:46,086 [INFO]: 	Creating the index 03/13/2025, 16:42:46
2025-03-13 16:42:46,086 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:46
2025-03-13 16:42:46,087 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:42:46,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:46
2025-03-13 16:42:46,088 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:42:46,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.59it/s] 29%|██▊       | 8/28 [00:00<00:00, 36.87it/s] 46%|████▋     | 13/28 [00:00<00:00, 41.63it/s] 68%|██████▊   | 19/28 [00:00<00:00, 45.48it/s] 86%|████████▌ | 24/28 [00:04<00:01,  3.67it/s]100%|██████████| 28/28 [00:05<00:00,  3.20it/s]100%|██████████| 28/28 [00:05<00:00,  4.85it/s]
2025-03-13 16:42:51,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:51
2025-03-13 16:43:50,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1358 secs
2025-03-13 16:43:50,996 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 16:43:50,996 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 16:44:21,472 [INFO]: 	>>> Finished "Compute fast metrics" in 30.4758 secs
2025-03-13 16:44:21,475 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.3870 secs
2025-03-13 16:44:21,475 [INFO]: {
2025-03-13 16:44:21,475 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:21,475 [INFO]: 	index_param: efSearch=167
2025-03-13 16:44:21,475 [INFO]: 	index_path: knn.index
2025-03-13 16:44:21,475 [INFO]: 	size in bytes: 1326251770
2025-03-13 16:44:21,475 [INFO]: 	avg_search_speed_ms: 8.777027458273025
2025-03-13 16:44:21,475 [INFO]: 	99p_search_speed_ms: 15.424286238849161
2025-03-13 16:44:21,475 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:21,475 [INFO]: 	nb vectors: 6741
2025-03-13 16:44:21,475 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:21,475 [INFO]: 	compression ratio: 0.9993083952679663
2025-03-13 16:44:21,475 [INFO]: }
2025-03-13 16:44:21,475 [INFO]: 	>>> Finished "Creating the index" in 95.3890 secs
2025-03-13 16:44:21,475 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4191 secs
2025-03-13 16:44:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 42189 [episode count 13/20]
[retrieval_preprocessing] for episode 86226 [episode count 14/20], we have num_retrieval=np.int64(6868) num_query=np.int64(382)
2025-03-13 16:44:25,956 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:27,118 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:27
2025-03-13 16:44:27,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.04it/s]
2025-03-13 16:44:27,144 [INFO]: There are 6868 embeddings of dim 49152
2025-03-13 16:44:27,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:44:27,145 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:27
2025-03-13 16:44:27,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:27,145 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:44:27,145 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:27,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:44:27,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:27
2025-03-13 16:44:27,145 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:27,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:44:27,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:27
2025-03-13 16:44:27,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:27,145 [INFO]: 	Creating the index 03/13/2025, 16:44:27
2025-03-13 16:44:27,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:27
2025-03-13 16:44:27,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:44:27,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:27
2025-03-13 16:44:27,146 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:44:27,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.50it/s] 17%|█▋        | 5/29 [00:00<00:01, 21.67it/s] 34%|███▍      | 10/29 [00:00<00:00, 30.70it/s] 52%|█████▏    | 15/29 [00:00<00:00, 35.19it/s] 69%|██████▉   | 20/29 [00:00<00:00, 37.71it/s] 83%|████████▎ | 24/29 [00:04<00:01,  2.84it/s] 97%|█████████▋| 28/29 [00:05<00:00,  3.96it/s]100%|██████████| 29/29 [00:07<00:00,  3.77it/s]
2025-03-13 16:44:34,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:34
2025-03-13 16:45:29,931 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0911 secs
2025-03-13 16:45:29,931 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 16:45:29,931 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.75it/s]
2025-03-13 16:46:16,713 [INFO]: 	>>> Finished "Compute fast metrics" in 46.7817 secs
2025-03-13 16:46:16,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.5685 secs
2025-03-13 16:46:16,715 [INFO]: {
2025-03-13 16:46:16,715 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:16,715 [INFO]: 	index_param: efSearch=208
2025-03-13 16:46:16,715 [INFO]: 	index_path: knn.index
2025-03-13 16:46:16,715 [INFO]: 	size in bytes: 1351238170
2025-03-13 16:46:16,715 [INFO]: 	avg_search_speed_ms: 11.403891350065136
2025-03-13 16:46:16,715 [INFO]: 	99p_search_speed_ms: 21.53048590756953
2025-03-13 16:46:16,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:16,715 [INFO]: 	nb vectors: 6868
2025-03-13 16:46:16,715 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:16,715 [INFO]: 	compression ratio: 0.9993084668411936
2025-03-13 16:46:16,715 [INFO]: }
2025-03-13 16:46:16,715 [INFO]: 	>>> Finished "Creating the index" in 109.5701 secs
2025-03-13 16:46:16,715 [INFO]: >>> Finished "Launching the whole pipeline" in 109.5969 secs
2025-03-13 16:46:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 86226 [episode count 14/20]
[retrieval_preprocessing] for episode 5352 [episode count 15/20], we have num_retrieval=np.int64(7005) num_query=np.int64(245)
2025-03-13 16:46:20,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:21,937 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:21
2025-03-13 16:46:21,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.80it/s]
2025-03-13 16:46:21,964 [INFO]: There are 7005 embeddings of dim 49152
2025-03-13 16:46:21,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:46:21,964 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:21
2025-03-13 16:46:21,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:21,964 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:46:21,964 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:21,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:21,965 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:21
2025-03-13 16:46:21,965 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:21,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:46:21,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:21
2025-03-13 16:46:21,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:21,965 [INFO]: 	Creating the index 03/13/2025, 16:46:21
2025-03-13 16:46:21,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:21
2025-03-13 16:46:21,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:46:21,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:21
2025-03-13 16:46:21,966 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:46:21,966 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.12it/s] 21%|██        | 6/29 [00:00<00:00, 27.24it/s] 38%|███▊      | 11/29 [00:00<00:00, 35.56it/s] 55%|█████▌    | 16/29 [00:00<00:00, 39.38it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.97it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.45it/s]100%|██████████| 29/29 [00:06<00:00,  4.35it/s]
2025-03-13 16:46:28,639 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:28
2025-03-13 16:47:26,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9875 secs
2025-03-13 16:47:26,628 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 16:47:26,628 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.34it/s]
2025-03-13 16:48:27,039 [INFO]: 	>>> Finished "Compute fast metrics" in 60.4115 secs
2025-03-13 16:48:27,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.0756 secs
2025-03-13 16:48:27,042 [INFO]: {
2025-03-13 16:48:27,042 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:27,042 [INFO]: 	index_param: efSearch=142
2025-03-13 16:48:27,042 [INFO]: 	index_path: knn.index
2025-03-13 16:48:27,042 [INFO]: 	size in bytes: 1378192390
2025-03-13 16:48:27,042 [INFO]: 	avg_search_speed_ms: 9.208432898486228
2025-03-13 16:48:27,042 [INFO]: 	99p_search_speed_ms: 16.699422278907157
2025-03-13 16:48:27,042 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:27,042 [INFO]: 	nb vectors: 7005
2025-03-13 16:48:27,042 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:27,042 [INFO]: 	compression ratio: 0.9993082605832703
2025-03-13 16:48:27,042 [INFO]: }
2025-03-13 16:48:27,042 [INFO]: 	>>> Finished "Creating the index" in 125.0770 secs
2025-03-13 16:48:27,042 [INFO]: >>> Finished "Launching the whole pipeline" in 125.1043 secs
2025-03-13 16:48:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 5352 [episode count 15/20]
[retrieval_preprocessing] for episode 32521 [episode count 16/20], we have num_retrieval=np.int64(7004) num_query=np.int64(246)
2025-03-13 16:48:30,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:31,442 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:31
2025-03-13 16:48:31,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 894.69it/s]
2025-03-13 16:48:31,469 [INFO]: There are 7004 embeddings of dim 49152
2025-03-13 16:48:31,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:48:31,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:31
2025-03-13 16:48:31,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:31,469 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:48:31,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:31,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:31,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:31
2025-03-13 16:48:31,469 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:31,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:48:31,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:31
2025-03-13 16:48:31,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:31,470 [INFO]: 	Creating the index 03/13/2025, 16:48:31
2025-03-13 16:48:31,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:31
2025-03-13 16:48:31,471 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:48:31,471 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:31
2025-03-13 16:48:31,471 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:48:31,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.22it/s] 17%|█▋        | 5/29 [00:00<00:01, 21.28it/s] 31%|███       | 9/29 [00:00<00:00, 28.09it/s] 45%|████▍     | 13/29 [00:00<00:00, 31.77it/s] 62%|██████▏   | 18/29 [00:00<00:00, 35.55it/s] 76%|███████▌  | 22/29 [00:04<00:02,  2.77it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.26it/s]100%|██████████| 29/29 [00:06<00:00,  4.30it/s]
2025-03-13 16:48:38,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:38
2025-03-13 16:49:39,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3895 secs
2025-03-13 16:49:39,604 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 16:49:39,604 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.59it/s]
2025-03-13 16:50:50,507 [INFO]: 	>>> Finished "Compute fast metrics" in 70.9022 secs
2025-03-13 16:50:50,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.0386 secs
2025-03-13 16:50:50,510 [INFO]: {
2025-03-13 16:50:50,510 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:50,510 [INFO]: 	index_param: efSearch=206
2025-03-13 16:50:50,510 [INFO]: 	index_path: knn.index
2025-03-13 16:50:50,510 [INFO]: 	size in bytes: 1377995650
2025-03-13 16:50:50,510 [INFO]: 	avg_search_speed_ms: 11.026259765309991
2025-03-13 16:50:50,510 [INFO]: 	99p_search_speed_ms: 17.46228697011247
2025-03-13 16:50:50,510 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:50,510 [INFO]: 	nb vectors: 7004
2025-03-13 16:50:50,510 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:50,510 [INFO]: 	compression ratio: 0.9993082576131499
2025-03-13 16:50:50,510 [INFO]: }
2025-03-13 16:50:50,510 [INFO]: 	>>> Finished "Creating the index" in 139.0401 secs
2025-03-13 16:50:50,510 [INFO]: >>> Finished "Launching the whole pipeline" in 139.0681 secs
2025-03-13 16:50:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 32521 [episode count 16/20]
[retrieval_preprocessing] for episode 93966 [episode count 17/20], we have num_retrieval=np.int64(6977) num_query=np.int64(273)
2025-03-13 16:50:54,044 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:55,932 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:55
2025-03-13 16:50:55,932 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 963.99it/s]
2025-03-13 16:50:55,964 [INFO]: There are 6977 embeddings of dim 49152
2025-03-13 16:50:55,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 16:50:55,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:55
2025-03-13 16:50:55,965 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:55,965 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:50:55,965 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:55,965 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:50:55,965 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:55
2025-03-13 16:50:55,965 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:55,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:50:55,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:55
2025-03-13 16:50:55,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:55,965 [INFO]: 	Creating the index 03/13/2025, 16:50:55
2025-03-13 16:50:55,966 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:55
2025-03-13 16:50:55,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:50:55,967 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:55
2025-03-13 16:50:55,967 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:50:55,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:05,  4.80it/s]  7%|▋         | 2/29 [00:00<00:04,  6.74it/s] 14%|█▍        | 4/29 [00:00<00:02,  8.42it/s] 17%|█▋        | 5/29 [00:00<00:02,  8.74it/s] 21%|██        | 6/29 [00:00<00:02,  8.97it/s] 28%|██▊       | 8/29 [00:00<00:02,  9.63it/s] 34%|███▍      | 10/29 [00:01<00:01,  9.91it/s] 38%|███▊      | 11/29 [00:01<00:01,  9.88it/s] 45%|████▍     | 13/29 [00:01<00:01, 10.16it/s] 52%|█████▏    | 15/29 [00:01<00:01, 10.21it/s] 59%|█████▊    | 17/29 [00:01<00:01, 10.15it/s] 66%|██████▌   | 19/29 [00:01<00:00, 10.04it/s] 72%|███████▏  | 21/29 [00:07<00:06,  1.16it/s] 76%|███████▌  | 22/29 [00:07<00:05,  1.38it/s] 83%|████████▎ | 24/29 [00:07<00:02,  1.97it/s] 86%|████████▌ | 25/29 [00:07<00:01,  2.34it/s] 90%|████████▉ | 26/29 [00:07<00:01,  2.80it/s] 93%|█████████▎| 27/29 [00:07<00:00,  3.34it/s]100%|██████████| 29/29 [00:11<00:00,  1.06it/s]100%|██████████| 29/29 [00:11<00:00,  2.54it/s]
2025-03-13 16:51:07,370 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:07
2025-03-13 16:52:08,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8951 secs
2025-03-13 16:52:08,267 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 16:52:08,267 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-13 16:52:45,050 [INFO]: 	>>> Finished "Compute fast metrics" in 36.7835 secs
2025-03-13 16:52:45,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.0849 secs
2025-03-13 16:52:45,052 [INFO]: {
2025-03-13 16:52:45,052 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:45,052 [INFO]: 	index_param: efSearch=191
2025-03-13 16:52:45,052 [INFO]: 	index_path: knn.index
2025-03-13 16:52:45,052 [INFO]: 	size in bytes: 1372683430
2025-03-13 16:52:45,052 [INFO]: 	avg_search_speed_ms: 9.120579074556687
2025-03-13 16:52:45,052 [INFO]: 	99p_search_speed_ms: 17.212777573149637
2025-03-13 16:52:45,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:45,052 [INFO]: 	nb vectors: 6977
2025-03-13 16:52:45,052 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:45,052 [INFO]: 	compression ratio: 0.9993083518171411
2025-03-13 16:52:45,052 [INFO]: }
2025-03-13 16:52:45,052 [INFO]: 	>>> Finished "Creating the index" in 109.0869 secs
2025-03-13 16:52:45,052 [INFO]: >>> Finished "Launching the whole pipeline" in 109.1205 secs
2025-03-13 16:52:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:52:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 93966 [episode count 17/20]
[retrieval_preprocessing] for episode 55059 [episode count 18/20], we have num_retrieval=np.int64(6849) num_query=np.int64(401)
2025-03-13 16:52:50,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:52:50,886 [INFO]: Launching the whole pipeline 03/13/2025, 16:52:50
2025-03-13 16:52:50,886 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:52:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.49it/s]
2025-03-13 16:52:50,914 [INFO]: There are 6849 embeddings of dim 49152
2025-03-13 16:52:50,915 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 16:52:50,915 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,915 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:52:50,915 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 16:52:50,915 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:52:50,915 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:52:50,915 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,915 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:52:50,915 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:52:50,915 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:52:50
2025-03-13 16:52:50,915 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:52:50,915 [INFO]: 	Creating the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,915 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:52:50
2025-03-13 16:52:50,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:52:50,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:52:50
2025-03-13 16:52:50,917 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:52:50,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.00it/s] 11%|█         | 3/28 [00:00<00:02,  8.39it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.17it/s] 21%|██▏       | 6/28 [00:00<00:02,  9.27it/s] 25%|██▌       | 7/28 [00:00<00:02,  8.75it/s] 29%|██▊       | 8/28 [00:00<00:02,  8.80it/s] 32%|███▏      | 9/28 [00:01<00:02,  8.84it/s] 36%|███▌      | 10/28 [00:01<00:02,  8.73it/s] 39%|███▉      | 11/28 [00:01<00:01,  8.71it/s] 43%|████▎     | 12/28 [00:01<00:01,  8.30it/s] 46%|████▋     | 13/28 [00:01<00:01,  8.12it/s] 50%|█████     | 14/28 [00:01<00:01,  8.14it/s] 54%|█████▎    | 15/28 [00:01<00:01,  8.05it/s] 57%|█████▋    | 16/28 [00:01<00:01,  8.28it/s] 61%|██████    | 17/28 [00:02<00:01,  8.47it/s] 64%|██████▍   | 18/28 [00:02<00:01,  8.51it/s] 68%|██████▊   | 19/28 [00:02<00:01,  8.53it/s] 71%|███████▏  | 20/28 [00:02<00:00,  8.46it/s] 75%|███████▌  | 21/28 [00:06<00:08,  1.25s/it] 79%|███████▊  | 22/28 [00:06<00:05,  1.10it/s] 86%|████████▌ | 24/28 [00:06<00:02,  1.89it/s] 93%|█████████▎| 26/28 [00:06<00:00,  2.82it/s]100%|██████████| 28/28 [00:08<00:00,  1.65it/s]100%|██████████| 28/28 [00:08<00:00,  3.17it/s]
2025-03-13 16:52:59,747 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:52:59
2025-03-13 16:53:50,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4390 secs
2025-03-13 16:53:50,187 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:53:50,187 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 16:54:23,788 [INFO]: 	>>> Finished "Compute fast metrics" in 33.6008 secs
2025-03-13 16:54:23,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8737 secs
2025-03-13 16:54:23,791 [INFO]: {
2025-03-13 16:54:23,791 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:23,791 [INFO]: 	index_param: efSearch=179
2025-03-13 16:54:23,791 [INFO]: 	index_path: knn.index
2025-03-13 16:54:23,791 [INFO]: 	size in bytes: 1347500050
2025-03-13 16:54:23,791 [INFO]: 	avg_search_speed_ms: 9.165420525815717
2025-03-13 16:54:23,791 [INFO]: 	99p_search_speed_ms: 16.509337187744613
2025-03-13 16:54:23,791 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:23,791 [INFO]: 	nb vectors: 6849
2025-03-13 16:54:23,791 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:23,791 [INFO]: 	compression ratio: 0.9993084542000573
2025-03-13 16:54:23,791 [INFO]: }
2025-03-13 16:54:23,791 [INFO]: 	>>> Finished "Creating the index" in 92.8755 secs
2025-03-13 16:54:23,791 [INFO]: >>> Finished "Launching the whole pipeline" in 92.9048 secs
2025-03-13 16:54:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 55059 [episode count 18/20]
[retrieval_preprocessing] for episode 64306 [episode count 19/20], we have num_retrieval=np.int64(7013) num_query=np.int64(237)
2025-03-13 16:54:30,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:31,498 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:31
2025-03-13 16:54:31,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1250.91it/s]
2025-03-13 16:54:31,523 [INFO]: There are 7013 embeddings of dim 49152
2025-03-13 16:54:31,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:54:31,523 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:31,523 [INFO]: 		-> Add: 3.9 seconds
2025-03-13 16:54:31,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:31,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:31,523 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,523 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:31,523 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:54:31,523 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:31
2025-03-13 16:54:31,523 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:31,523 [INFO]: 	Creating the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,523 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:31
2025-03-13 16:54:31,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:54:31,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:31
2025-03-13 16:54:31,525 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 16:54:31,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.26it/s] 10%|█         | 3/29 [00:00<00:02,  9.52it/s] 17%|█▋        | 5/29 [00:00<00:02, 10.64it/s] 24%|██▍       | 7/29 [00:00<00:01, 12.73it/s] 31%|███       | 9/29 [00:00<00:01, 12.22it/s] 38%|███▊      | 11/29 [00:00<00:01, 11.84it/s] 45%|████▍     | 13/29 [00:01<00:01, 11.51it/s] 52%|█████▏    | 15/29 [00:01<00:01, 11.24it/s] 59%|█████▊    | 17/29 [00:01<00:01, 11.12it/s] 66%|██████▌   | 19/29 [00:01<00:00, 11.19it/s] 72%|███████▏  | 21/29 [00:05<00:04,  1.71it/s] 76%|███████▌  | 22/29 [00:05<00:03,  2.00it/s] 83%|████████▎ | 24/29 [00:05<00:01,  2.80it/s] 90%|████████▉ | 26/29 [00:05<00:00,  3.72it/s] 97%|█████████▋| 28/29 [00:05<00:00,  4.71it/s]100%|██████████| 29/29 [00:08<00:00,  3.52it/s]
2025-03-13 16:54:39,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:39
2025-03-13 16:55:36,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8748 secs
2025-03-13 16:55:36,642 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:55:36,642 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-13 16:56:44,821 [INFO]: 	>>> Finished "Compute fast metrics" in 68.1783 secs
2025-03-13 16:56:44,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2977 secs
2025-03-13 16:56:44,823 [INFO]: {
2025-03-13 16:56:44,823 [INFO]: 	index_key: HNSW15
2025-03-13 16:56:44,823 [INFO]: 	index_param: efSearch=192
2025-03-13 16:56:44,823 [INFO]: 	index_path: knn.index
2025-03-13 16:56:44,823 [INFO]: 	size in bytes: 1379766310
2025-03-13 16:56:44,823 [INFO]: 	avg_search_speed_ms: 8.802716374318575
2025-03-13 16:56:44,823 [INFO]: 	99p_search_speed_ms: 16.589733958244388
2025-03-13 16:56:44,823 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:56:44,823 [INFO]: 	nb vectors: 7013
2025-03-13 16:56:44,823 [INFO]: 	vectors dimension: 49152
2025-03-13 16:56:44,823 [INFO]: 	compression ratio: 0.9993082843137401
2025-03-13 16:56:44,823 [INFO]: }
2025-03-13 16:56:44,823 [INFO]: 	>>> Finished "Creating the index" in 133.2992 secs
2025-03-13 16:56:44,823 [INFO]: >>> Finished "Launching the whole pipeline" in 133.3245 secs
2025-03-13 16:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 64306 [episode count 19/20]
2025-03-13 16:56:46: [retrieval_preprocessing] finished for 1688824394_put_straw_in_cup [chosen_id count 2/196]
2025-03-13 16:56:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1712293193_remove_marker_from_cup [chosen_id count 3/196]
2025-03-13 16:56:49: [retrieval_preprocessing] we have num_total=4298 embedding_dim=49152
[retrieval_preprocessing] for episode 58880 [episode count 0/20], we have num_retrieval=np.int64(4085) num_query=np.int64(213)
2025-03-13 16:56:51,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:56:52,732 [INFO]: Launching the whole pipeline 03/13/2025, 16:56:52
2025-03-13 16:56:52,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:56:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.03it/s]
2025-03-13 16:56:52,758 [INFO]: There are 4085 embeddings of dim 49152
2025-03-13 16:56:52,758 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:56:52,758 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:56:52
2025-03-13 16:56:52,758 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:56:52,758 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:56:52,758 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:56:52,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:56:52,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:56:52
2025-03-13 16:56:52,759 [INFO]: 843.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:56:52,759 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:56:52,759 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:56:52
2025-03-13 16:56:52,759 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:56:52,759 [INFO]: 	Creating the index 03/13/2025, 16:56:52
2025-03-13 16:56:52,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:56:52
2025-03-13 16:56:52,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:56:52,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:56:52
2025-03-13 16:56:52,760 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:56:52,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.33it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.97it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.66it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.30it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.56it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.60it/s] 41%|████      | 7/17 [00:00<00:01,  8.57it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.60it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.73it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.97it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.50it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.94it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.76it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.72it/s]100%|██████████| 17/17 [00:04<00:00,  1.34it/s]100%|██████████| 17/17 [00:04<00:00,  3.60it/s]
2025-03-13 16:56:57,483 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:56:57
2025-03-13 16:57:37,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8089 secs
2025-03-13 16:57:37,293 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 16:57:37,293 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 16:58:00,783 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4904 secs
2025-03-13 16:58:00,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0272 secs
2025-03-13 16:58:00,787 [INFO]: {
2025-03-13 16:58:00,787 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:00,787 [INFO]: 	index_param: efSearch=154
2025-03-13 16:58:00,787 [INFO]: 	index_path: knn.index
2025-03-13 16:58:00,788 [INFO]: 	size in bytes: 803699350
2025-03-13 16:58:00,788 [INFO]: 	avg_search_speed_ms: 8.70115876143508
2025-03-13 16:58:00,788 [INFO]: 	99p_search_speed_ms: 13.428916558623314
2025-03-13 16:58:00,788 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:00,788 [INFO]: 	nb vectors: 4085
2025-03-13 16:58:00,788 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:00,788 [INFO]: 	compression ratio: 0.9993086096187586
2025-03-13 16:58:00,788 [INFO]: }
2025-03-13 16:58:00,788 [INFO]: 	>>> Finished "Creating the index" in 68.0289 secs
2025-03-13 16:58:00,788 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0560 secs
2025-03-13 16:58:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 58880 [episode count 0/20]
[retrieval_preprocessing] for episode 67589 [episode count 1/20], we have num_retrieval=np.int64(4121) num_query=np.int64(177)
2025-03-13 16:58:04,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:05,225 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:05
2025-03-13 16:58:05,225 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1313.59it/s]
2025-03-13 16:58:05,250 [INFO]: There are 4121 embeddings of dim 49152
2025-03-13 16:58:05,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:58:05,250 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:05
2025-03-13 16:58:05,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:05,250 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:58:05,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:05,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:05,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:05
2025-03-13 16:58:05,250 [INFO]: 850.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:05,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:05,251 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:05
2025-03-13 16:58:05,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:05,251 [INFO]: 	Creating the index 03/13/2025, 16:58:05
2025-03-13 16:58:05,251 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:05
2025-03-13 16:58:05,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:58:05,252 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:05
2025-03-13 16:58:05,252 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:58:05,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.99it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.31it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.74it/s] 41%|████      | 7/17 [00:00<00:00, 11.04it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.25it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.27it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.91it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.30it/s]100%|██████████| 17/17 [00:05<00:00,  1.54it/s]100%|██████████| 17/17 [00:05<00:00,  3.32it/s]
2025-03-13 16:58:10,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:10
2025-03-13 16:58:56,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0168 secs
2025-03-13 16:58:56,399 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 16:58:56,399 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
2025-03-13 16:59:30,869 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4697 secs
2025-03-13 16:59:30,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.6211 secs
2025-03-13 16:59:30,873 [INFO]: {
2025-03-13 16:59:30,873 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:30,873 [INFO]: 	index_param: efSearch=195
2025-03-13 16:59:30,873 [INFO]: 	index_path: knn.index
2025-03-13 16:59:30,873 [INFO]: 	size in bytes: 810782170
2025-03-13 16:59:30,873 [INFO]: 	avg_search_speed_ms: 10.227319420932398
2025-03-13 16:59:30,873 [INFO]: 	99p_search_speed_ms: 19.397630738094456
2025-03-13 16:59:30,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:30,873 [INFO]: 	nb vectors: 4121
2025-03-13 16:59:30,873 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:30,873 [INFO]: 	compression ratio: 0.9993085664426982
2025-03-13 16:59:30,873 [INFO]: }
2025-03-13 16:59:30,873 [INFO]: 	>>> Finished "Creating the index" in 85.6228 secs
2025-03-13 16:59:30,873 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6488 secs
2025-03-13 16:59:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 67589 [episode count 1/20]
[retrieval_preprocessing] for episode 60935 [episode count 2/20], we have num_retrieval=np.int64(4013) num_query=np.int64(285)
2025-03-13 16:59:34,588 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:35,260 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:35
2025-03-13 16:59:35,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 16:59:35,290 [INFO]: There are 4013 embeddings of dim 49152
2025-03-13 16:59:35,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 16:59:35,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:35
2025-03-13 16:59:35,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:35,291 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 16:59:35,291 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:35,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:59:35,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:35
2025-03-13 16:59:35,292 [INFO]: 828.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:35,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:59:35,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:35
2025-03-13 16:59:35,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:35,292 [INFO]: 	Creating the index 03/13/2025, 16:59:35
2025-03-13 16:59:35,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:35
2025-03-13 16:59:35,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:59:35,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:35
2025-03-13 16:59:35,296 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 16:59:35,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.25it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.65it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.36it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.89it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.10it/s] 50%|█████     | 8/16 [00:00<00:00,  9.48it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.67it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.46it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.54it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.54it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.50it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.14it/s]100%|██████████| 16/16 [00:05<00:00,  1.03s/it]100%|██████████| 16/16 [00:05<00:00,  3.15it/s]
2025-03-13 16:59:40,392 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:40
2025-03-13 17:00:23,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0320 secs
2025-03-13 17:00:23,424 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 17:00:23,425 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s]
2025-03-13 17:00:48,248 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8230 secs
2025-03-13 17:00:48,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3838 secs
2025-03-13 17:00:48,680 [INFO]: {
2025-03-13 17:00:48,680 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:48,680 [INFO]: 	index_param: efSearch=151
2025-03-13 17:00:48,680 [INFO]: 	index_path: knn.index
2025-03-13 17:00:48,680 [INFO]: 	size in bytes: 789533890
2025-03-13 17:00:48,680 [INFO]: 	avg_search_speed_ms: 8.617179378353317
2025-03-13 17:00:48,681 [INFO]: 	99p_search_speed_ms: 16.668147805612538
2025-03-13 17:00:48,681 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:48,681 [INFO]: 	nb vectors: 4013
2025-03-13 17:00:48,681 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:48,681 [INFO]: 	compression ratio: 0.9993084704698363
2025-03-13 17:00:48,681 [INFO]: }
2025-03-13 17:00:48,681 [INFO]: 	>>> Finished "Creating the index" in 73.3883 secs
2025-03-13 17:00:48,681 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4203 secs
2025-03-13 17:00:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 60935 [episode count 2/20]
[retrieval_preprocessing] for episode 83976 [episode count 3/20], we have num_retrieval=np.int64(4129) num_query=np.int64(169)
2025-03-13 17:00:51,919 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:52,521 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:52
2025-03-13 17:00:52,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.99it/s]
2025-03-13 17:00:52,546 [INFO]: There are 4129 embeddings of dim 49152
2025-03-13 17:00:52,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:00:52,546 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:52
2025-03-13 17:00:52,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:52,546 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:00:52,546 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:52,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:52,546 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:52
2025-03-13 17:00:52,546 [INFO]: 852.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:52,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:00:52,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:52
2025-03-13 17:00:52,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:52,547 [INFO]: 	Creating the index 03/13/2025, 17:00:52
2025-03-13 17:00:52,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:52
2025-03-13 17:00:52,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:00:52,548 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:52
2025-03-13 17:00:52,548 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:00:52,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.09it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.49it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.79it/s] 41%|████      | 7/17 [00:00<00:00, 11.16it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.38it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.68it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.89it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.00it/s]100%|██████████| 17/17 [00:04<00:00,  1.72it/s]100%|██████████| 17/17 [00:04<00:00,  3.65it/s]
2025-03-13 17:00:57,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:57
2025-03-13 17:01:43,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1470 secs
2025-03-13 17:01:43,356 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 17:01:43,356 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 17:02:19,538 [INFO]: 	>>> Finished "Compute fast metrics" in 36.1825 secs
2025-03-13 17:02:19,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.9941 secs
2025-03-13 17:02:19,542 [INFO]: {
2025-03-13 17:02:19,542 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:19,542 [INFO]: 	index_param: efSearch=181
2025-03-13 17:02:19,542 [INFO]: 	index_path: knn.index
2025-03-13 17:02:19,542 [INFO]: 	size in bytes: 812356090
2025-03-13 17:02:19,542 [INFO]: 	avg_search_speed_ms: 10.766242153088456
2025-03-13 17:02:19,542 [INFO]: 	99p_search_speed_ms: 18.006542455404997
2025-03-13 17:02:19,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:19,542 [INFO]: 	nb vectors: 4129
2025-03-13 17:02:19,542 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:19,542 [INFO]: 	compression ratio: 0.9993086061557069
2025-03-13 17:02:19,542 [INFO]: }
2025-03-13 17:02:19,542 [INFO]: 	>>> Finished "Creating the index" in 86.9958 secs
2025-03-13 17:02:19,542 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0213 secs
2025-03-13 17:02:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 83976 [episode count 3/20]
[retrieval_preprocessing] for episode 50704 [episode count 4/20], we have num_retrieval=np.int64(4108) num_query=np.int64(190)
2025-03-13 17:02:22,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:23,409 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:23
2025-03-13 17:02:23,410 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1978.45it/s]
2025-03-13 17:02:23,432 [INFO]: There are 4108 embeddings of dim 49152
2025-03-13 17:02:23,432 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 17:02:23,432 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,432 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:23,432 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:02:23,432 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:23,432 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:23,432 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,432 [INFO]: 847.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:23,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:02:23,432 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:23
2025-03-13 17:02:23,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:23,433 [INFO]: 	Creating the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,433 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:23
2025-03-13 17:02:23,434 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:02:23,434 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:23
2025-03-13 17:02:23,434 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:02:23,434 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.14it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.13it/s] 24%|██▎       | 4/17 [00:00<00:01,  9.07it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.95it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.25it/s] 59%|█████▉    | 10/17 [00:01<00:00, 10.45it/s] 71%|███████   | 12/17 [00:01<00:00, 10.27it/s] 82%|████████▏ | 14/17 [00:01<00:00, 10.11it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.87it/s]100%|██████████| 17/17 [00:07<00:00,  1.09s/it]100%|██████████| 17/17 [00:07<00:00,  2.41it/s]
2025-03-13 17:02:30,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:30
2025-03-13 17:03:14,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7340 secs
2025-03-13 17:03:14,230 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 17:03:14,230 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 17:03:43,299 [INFO]: 	>>> Finished "Compute fast metrics" in 29.0689 secs
2025-03-13 17:03:43,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8684 secs
2025-03-13 17:03:43,302 [INFO]: {
2025-03-13 17:03:43,302 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:43,302 [INFO]: 	index_param: efSearch=180
2025-03-13 17:03:43,302 [INFO]: 	index_path: knn.index
2025-03-13 17:03:43,302 [INFO]: 	size in bytes: 808224430
2025-03-13 17:03:43,302 [INFO]: 	avg_search_speed_ms: 9.658873604232634
2025-03-13 17:03:43,302 [INFO]: 	99p_search_speed_ms: 17.092992113903165
2025-03-13 17:03:43,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:43,302 [INFO]: 	nb vectors: 4108
2025-03-13 17:03:43,302 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:43,302 [INFO]: 	compression ratio: 0.9993086499501135
2025-03-13 17:03:43,302 [INFO]: }
2025-03-13 17:03:43,302 [INFO]: 	>>> Finished "Creating the index" in 79.8699 secs
2025-03-13 17:03:43,302 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8929 secs
2025-03-13 17:03:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 50704 [episode count 4/20]
[retrieval_preprocessing] for episode 90643 [episode count 5/20], we have num_retrieval=np.int64(4064) num_query=np.int64(234)
2025-03-13 17:03:46,657 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:48,112 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:48
2025-03-13 17:03:48,112 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1651.95it/s]
2025-03-13 17:03:48,314 [INFO]: There are 4064 embeddings of dim 49152
2025-03-13 17:03:48,314 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2022 secs
2025-03-13 17:03:48,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:48
2025-03-13 17:03:48,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:48,315 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:03:48,315 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:48,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:03:48,315 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:48
2025-03-13 17:03:48,316 [INFO]: 838.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:48,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:03:48,316 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:48
2025-03-13 17:03:48,316 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:48,316 [INFO]: 	Creating the index 03/13/2025, 17:03:48
2025-03-13 17:03:48,316 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:48
2025-03-13 17:03:48,319 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:03:48,319 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:48
2025-03-13 17:03:48,319 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:03:48,320 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.09it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.56it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.40it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.77it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.81it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.61it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.75it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.87it/s]100%|██████████| 16/16 [00:04<00:00,  3.38it/s]
2025-03-13 17:03:53,070 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:53
2025-03-13 17:04:35,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8842 secs
2025-03-13 17:04:35,955 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:04:35,955 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 17:05:05,233 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2787 secs
2025-03-13 17:05:05,236 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9170 secs
2025-03-13 17:05:05,237 [INFO]: {
2025-03-13 17:05:05,237 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:05,237 [INFO]: 	index_param: efSearch=174
2025-03-13 17:05:05,237 [INFO]: 	index_path: knn.index
2025-03-13 17:05:05,237 [INFO]: 	size in bytes: 799567690
2025-03-13 17:05:05,237 [INFO]: 	avg_search_speed_ms: 9.473860175631037
2025-03-13 17:05:05,237 [INFO]: 	99p_search_speed_ms: 15.471573336981239
2025-03-13 17:05:05,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:05,237 [INFO]: 	nb vectors: 4064
2025-03-13 17:05:05,237 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:05,237 [INFO]: 	compression ratio: 0.9993086539052122
2025-03-13 17:05:05,237 [INFO]: }
2025-03-13 17:05:05,237 [INFO]: 	>>> Finished "Creating the index" in 76.9206 secs
2025-03-13 17:05:05,237 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1246 secs
2025-03-13 17:05:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 90643 [episode count 5/20]
[retrieval_preprocessing] for episode 87076 [episode count 6/20], we have num_retrieval=np.int64(4137) num_query=np.int64(161)
2025-03-13 17:05:08,904 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:09,526 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:09
2025-03-13 17:05:09,526 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.61it/s]
2025-03-13 17:05:09,551 [INFO]: There are 4137 embeddings of dim 49152
2025-03-13 17:05:09,551 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:05:09,551 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:09
2025-03-13 17:05:09,551 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:09,552 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:05:09,552 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:09,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:05:09,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:09
2025-03-13 17:05:09,552 [INFO]: 853.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:09,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:09,552 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:09
2025-03-13 17:05:09,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:09,552 [INFO]: 	Creating the index 03/13/2025, 17:05:09
2025-03-13 17:05:09,552 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:09
2025-03-13 17:05:09,553 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:05:09,553 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:09
2025-03-13 17:05:09,553 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:05:09,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.78it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.22it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.83it/s] 41%|████      | 7/17 [00:00<00:00, 12.33it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.35it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.41it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.48it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.48it/s]100%|██████████| 17/17 [00:04<00:00,  1.88it/s]100%|██████████| 17/17 [00:04<00:00,  3.96it/s]
2025-03-13 17:05:13,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:13
2025-03-13 17:06:01,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6918 secs
2025-03-13 17:06:01,540 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 17:06:01,540 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 17:06:21,575 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0351 secs
2025-03-13 17:06:21,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0250 secs
2025-03-13 17:06:21,579 [INFO]: {
2025-03-13 17:06:21,579 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:21,579 [INFO]: 	index_param: efSearch=159
2025-03-13 17:06:21,579 [INFO]: 	index_path: knn.index
2025-03-13 17:06:21,579 [INFO]: 	size in bytes: 813930010
2025-03-13 17:06:21,579 [INFO]: 	avg_search_speed_ms: 8.979445426596104
2025-03-13 17:06:21,579 [INFO]: 	99p_search_speed_ms: 15.366219663992464
2025-03-13 17:06:21,579 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:21,579 [INFO]: 	nb vectors: 4137
2025-03-13 17:06:21,579 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:21,579 [INFO]: 	compression ratio: 0.9993086457151272
2025-03-13 17:06:21,579 [INFO]: }
2025-03-13 17:06:21,579 [INFO]: 	>>> Finished "Creating the index" in 72.0268 secs
2025-03-13 17:06:21,579 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0532 secs
2025-03-13 17:06:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 87076 [episode count 6/20]
[retrieval_preprocessing] for episode 88615 [episode count 7/20], we have num_retrieval=np.int64(4079) num_query=np.int64(219)
2025-03-13 17:06:24,406 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:25,050 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:25
2025-03-13 17:06:25,050 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 906.88it/s]
2025-03-13 17:06:25,075 [INFO]: There are 4079 embeddings of dim 49152
2025-03-13 17:06:25,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:06:25,076 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:25
2025-03-13 17:06:25,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:25,076 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:06:25,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:25,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:06:25,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:25
2025-03-13 17:06:25,077 [INFO]: 841.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:25,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:06:25,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:25
2025-03-13 17:06:25,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:25,078 [INFO]: 	Creating the index 03/13/2025, 17:06:25
2025-03-13 17:06:25,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:25
2025-03-13 17:06:25,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:06:25,080 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:25
2025-03-13 17:06:25,080 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:06:25,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.18it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.82it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.71it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.23it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.56it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.78it/s] 41%|████      | 7/17 [00:00<00:01,  8.04it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.14it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.19it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.25it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.28it/s] 71%|███████   | 12/17 [00:01<00:00,  8.39it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.33it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.31it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.32it/s] 94%|█████████▍| 16/17 [00:02<00:00,  8.32it/s]100%|██████████| 17/17 [00:05<00:00,  1.12s/it]100%|██████████| 17/17 [00:05<00:00,  3.10it/s]
2025-03-13 17:06:30,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:30
2025-03-13 17:07:11,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9529 secs
2025-03-13 17:07:11,521 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 17:07:11,522 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 17:07:39,352 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8302 secs
2025-03-13 17:07:39,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2749 secs
2025-03-13 17:07:39,356 [INFO]: {
2025-03-13 17:07:39,356 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:39,356 [INFO]: 	index_param: efSearch=158
2025-03-13 17:07:39,356 [INFO]: 	index_path: knn.index
2025-03-13 17:07:39,356 [INFO]: 	size in bytes: 802518910
2025-03-13 17:07:39,356 [INFO]: 	avg_search_speed_ms: 8.038730882190563
2025-03-13 17:07:39,356 [INFO]: 	99p_search_speed_ms: 14.193917994853097
2025-03-13 17:07:39,356 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:39,356 [INFO]: 	nb vectors: 4079
2025-03-13 17:07:39,356 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:39,356 [INFO]: 	compression ratio: 0.9993085795324125
2025-03-13 17:07:39,356 [INFO]: }
2025-03-13 17:07:39,356 [INFO]: 	>>> Finished "Creating the index" in 74.2781 secs
2025-03-13 17:07:39,356 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3061 secs
2025-03-13 17:07:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 88615 [episode count 7/20]
[retrieval_preprocessing] for episode 23101 [episode count 8/20], we have num_retrieval=np.int64(4111) num_query=np.int64(187)
2025-03-13 17:07:42,023 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:43,416 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:43
2025-03-13 17:07:43,416 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1002.22it/s]
2025-03-13 17:07:43,455 [INFO]: There are 4111 embeddings of dim 49152
2025-03-13 17:07:43,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0394 secs
2025-03-13 17:07:43,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:43
2025-03-13 17:07:43,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:43,456 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:07:43,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:43,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:07:43,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:43
2025-03-13 17:07:43,457 [INFO]: 848.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:43,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:07:43,457 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:43
2025-03-13 17:07:43,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:43,458 [INFO]: 	Creating the index 03/13/2025, 17:07:43
2025-03-13 17:07:43,458 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:43
2025-03-13 17:07:43,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 17:07:43,462 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:43
2025-03-13 17:07:43,462 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:07:43,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.63it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.53it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.26it/s] 41%|████      | 7/17 [00:00<00:01,  9.54it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.34it/s] 71%|███████   | 12/17 [00:01<00:00, 13.58it/s] 88%|████████▊ | 15/17 [00:01<00:00, 16.40it/s]100%|██████████| 17/17 [00:04<00:00,  1.94it/s]100%|██████████| 17/17 [00:04<00:00,  3.63it/s]
2025-03-13 17:07:48,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:48
2025-03-13 17:08:29,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1916 secs
2025-03-13 17:08:29,356 [INFO]: The best hyperparameters are: efSearch=172
2025-03-13 17:08:29,356 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.79it/s] 50%|█████     | 2/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-13 17:08:48,701 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3450 secs
2025-03-13 17:08:48,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2432 secs
2025-03-13 17:08:48,705 [INFO]: {
2025-03-13 17:08:48,705 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:48,705 [INFO]: 	index_param: efSearch=172
2025-03-13 17:08:48,705 [INFO]: 	index_path: knn.index
2025-03-13 17:08:48,705 [INFO]: 	size in bytes: 808814710
2025-03-13 17:08:48,705 [INFO]: 	avg_search_speed_ms: 11.135904667567138
2025-03-13 17:08:48,705 [INFO]: 	99p_search_speed_ms: 23.028518471401163
2025-03-13 17:08:48,705 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:48,705 [INFO]: 	nb vectors: 4111
2025-03-13 17:08:48,705 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:48,705 [INFO]: 	compression ratio: 0.9993085907154187
2025-03-13 17:08:48,705 [INFO]: }
2025-03-13 17:08:48,705 [INFO]: 	>>> Finished "Creating the index" in 65.2476 secs
2025-03-13 17:08:48,705 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2893 secs
2025-03-13 17:08:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 23101 [episode count 8/20]
[retrieval_preprocessing] for episode 18494 [episode count 9/20], we have num_retrieval=np.int64(3997) num_query=np.int64(301)
2025-03-13 17:08:52,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:52,721 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:52
2025-03-13 17:08:52,721 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1200.09it/s]
2025-03-13 17:08:52,750 [INFO]: There are 3997 embeddings of dim 49152
2025-03-13 17:08:52,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 17:08:52,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:52
2025-03-13 17:08:52,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:52,750 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:08:52,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:52,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:08:52,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:52
2025-03-13 17:08:52,751 [INFO]: 824.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:52,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:08:52,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:52
2025-03-13 17:08:52,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:52,751 [INFO]: 	Creating the index 03/13/2025, 17:08:52
2025-03-13 17:08:52,751 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:52
2025-03-13 17:08:52,752 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:08:52,752 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:52
2025-03-13 17:08:52,752 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:08:52,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  3.82it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.47it/s] 19%|█▉        | 3/16 [00:00<00:02,  6.26it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.75it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.15it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.30it/s] 44%|████▍     | 7/16 [00:01<00:01,  7.35it/s] 50%|█████     | 8/16 [00:01<00:01,  7.41it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.57it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.00it/s] 69%|██████▉   | 11/16 [00:01<00:00,  7.51it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.83it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.14it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.36it/s] 94%|█████████▍| 15/16 [00:02<00:00,  8.56it/s]100%|██████████| 16/16 [00:06<00:00,  1.33s/it]100%|██████████| 16/16 [00:06<00:00,  2.60it/s]
2025-03-13 17:08:58,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:58
2025-03-13 17:09:46,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1497 secs
2025-03-13 17:09:46,077 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:09:46,078 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-13 17:10:17,024 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9464 secs
2025-03-13 17:10:18,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.2628 secs
2025-03-13 17:10:18,015 [INFO]: {
2025-03-13 17:10:18,015 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:18,015 [INFO]: 	index_param: efSearch=153
2025-03-13 17:10:18,016 [INFO]: 	index_path: knn.index
2025-03-13 17:10:18,016 [INFO]: 	size in bytes: 786385930
2025-03-13 17:10:18,016 [INFO]: 	avg_search_speed_ms: 8.885017194267776
2025-03-13 17:10:18,016 [INFO]: 	99p_search_speed_ms: 16.099407840520136
2025-03-13 17:10:18,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:18,016 [INFO]: 	nb vectors: 3997
2025-03-13 17:10:18,016 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:18,016 [INFO]: 	compression ratio: 0.9993085405279314
2025-03-13 17:10:18,016 [INFO]: }
2025-03-13 17:10:18,016 [INFO]: 	>>> Finished "Creating the index" in 85.2653 secs
2025-03-13 17:10:18,016 [INFO]: >>> Finished "Launching the whole pipeline" in 85.2951 secs
2025-03-13 17:10:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 18494 [episode count 9/20]
[retrieval_preprocessing] for episode 92748 [episode count 10/20], we have num_retrieval=np.int64(4101) num_query=np.int64(197)
2025-03-13 17:10:21,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:22,055 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:22
2025-03-13 17:10:22,055 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 925.28it/s]
2025-03-13 17:10:22,081 [INFO]: There are 4101 embeddings of dim 49152
2025-03-13 17:10:22,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:10:22,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:22
2025-03-13 17:10:22,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:22,081 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:10:22,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:22,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:10:22,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:22
2025-03-13 17:10:22,082 [INFO]: 846.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:22,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:10:22,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:22
2025-03-13 17:10:22,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:22,082 [INFO]: 	Creating the index 03/13/2025, 17:10:22
2025-03-13 17:10:22,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:22
2025-03-13 17:10:22,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:10:22,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:22
2025-03-13 17:10:22,083 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:10:22,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.71it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.65it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.73it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.29it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.78it/s] 41%|████      | 7/17 [00:00<00:00, 10.99it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.74it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.48it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.35it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.34it/s]100%|██████████| 17/17 [00:04<00:00,  1.77it/s]100%|██████████| 17/17 [00:04<00:00,  3.65it/s]
2025-03-13 17:10:26,740 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:26
2025-03-13 17:11:03,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1308 secs
2025-03-13 17:11:03,871 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 17:11:03,871 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 17:11:36,296 [INFO]: 	>>> Finished "Compute fast metrics" in 32.4251 secs
2025-03-13 17:11:36,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2180 secs
2025-03-13 17:11:36,301 [INFO]: {
2025-03-13 17:11:36,301 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:36,301 [INFO]: 	index_param: efSearch=196
2025-03-13 17:11:36,301 [INFO]: 	index_path: knn.index
2025-03-13 17:11:36,301 [INFO]: 	size in bytes: 806847190
2025-03-13 17:11:36,301 [INFO]: 	avg_search_speed_ms: 11.067077624395209
2025-03-13 17:11:36,301 [INFO]: 	99p_search_speed_ms: 16.51917769107968
2025-03-13 17:11:36,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:36,301 [INFO]: 	nb vectors: 4101
2025-03-13 17:11:36,301 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:36,301 [INFO]: 	compression ratio: 0.9993086894186246
2025-03-13 17:11:36,301 [INFO]: }
2025-03-13 17:11:36,301 [INFO]: 	>>> Finished "Creating the index" in 74.2196 secs
2025-03-13 17:11:36,301 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2466 secs
2025-03-13 17:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 92748 [episode count 10/20]
[retrieval_preprocessing] for episode 84045 [episode count 11/20], we have num_retrieval=np.int64(3949) num_query=np.int64(349)
2025-03-13 17:11:40,029 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:40,706 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:40
2025-03-13 17:11:40,706 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 991.80it/s]
2025-03-13 17:11:40,732 [INFO]: There are 3949 embeddings of dim 49152
2025-03-13 17:11:40,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:11:40,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:40
2025-03-13 17:11:40,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:40,732 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:11:40,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:40,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:40,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:40
2025-03-13 17:11:40,732 [INFO]: 815.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:40,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:40,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:40
2025-03-13 17:11:40,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:40,732 [INFO]: 	Creating the index 03/13/2025, 17:11:40
2025-03-13 17:11:40,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:40
2025-03-13 17:11:40,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:11:40,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:40
2025-03-13 17:11:40,734 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:11:40,734 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.43it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.10it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.11it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.48it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.91it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.19it/s] 50%|█████     | 8/16 [00:00<00:00, 10.08it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.57it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.74it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.92it/s]100%|██████████| 16/16 [00:04<00:00,  1.72it/s]100%|██████████| 16/16 [00:04<00:00,  3.50it/s]
2025-03-13 17:11:45,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:45
2025-03-13 17:12:29,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1301 secs
2025-03-13 17:12:29,597 [INFO]: The best hyperparameters are: efSearch=102
2025-03-13 17:12:29,597 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.10it/s] 50%|█████     | 2/4 [00:00<00:00,  5.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.74it/s]
2025-03-13 17:12:54,133 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5367 secs
2025-03-13 17:12:54,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4031 secs
2025-03-13 17:12:54,137 [INFO]: {
2025-03-13 17:12:54,137 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:54,137 [INFO]: 	index_param: efSearch=102
2025-03-13 17:12:54,137 [INFO]: 	index_path: knn.index
2025-03-13 17:12:54,137 [INFO]: 	size in bytes: 776942230
2025-03-13 17:12:54,137 [INFO]: 	avg_search_speed_ms: 5.782624631215204
2025-03-13 17:12:54,137 [INFO]: 	99p_search_speed_ms: 8.796291286125781
2025-03-13 17:12:54,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:54,137 [INFO]: 	nb vectors: 3949
2025-03-13 17:12:54,137 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:54,137 [INFO]: 	compression ratio: 0.9993085225911842
2025-03-13 17:12:54,137 [INFO]: }
2025-03-13 17:12:54,137 [INFO]: 	>>> Finished "Creating the index" in 73.4048 secs
2025-03-13 17:12:54,137 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4312 secs
2025-03-13 17:12:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 84045 [episode count 11/20]
[retrieval_preprocessing] for episode 54863 [episode count 12/20], we have num_retrieval=np.int64(4113) num_query=np.int64(185)
2025-03-13 17:12:57,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:58,423 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:58
2025-03-13 17:12:58,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 17:12:58,449 [INFO]: There are 4113 embeddings of dim 49152
2025-03-13 17:12:58,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:12:58,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:58,450 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:12:58,450 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:58,450 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:58,450 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,450 [INFO]: 848.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:58,450 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:58,450 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:58
2025-03-13 17:12:58,450 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:58,450 [INFO]: 	Creating the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:58
2025-03-13 17:12:58,451 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:12:58,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:58
2025-03-13 17:12:58,452 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:12:58,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.18it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.41it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.47it/s] 41%|████      | 7/17 [00:00<00:01,  9.86it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.17it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.19it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.26it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.16it/s]100%|██████████| 17/17 [00:06<00:00,  1.28it/s]100%|██████████| 17/17 [00:06<00:00,  2.81it/s]
2025-03-13 17:13:04,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:04
2025-03-13 17:13:44,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4404 secs
2025-03-13 17:13:44,954 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 17:13:44,954 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 17:14:22,868 [INFO]: 	>>> Finished "Compute fast metrics" in 37.9140 secs
2025-03-13 17:14:22,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.4211 secs
2025-03-13 17:14:22,873 [INFO]: {
2025-03-13 17:14:22,873 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:22,873 [INFO]: 	index_param: efSearch=126
2025-03-13 17:14:22,873 [INFO]: 	index_path: knn.index
2025-03-13 17:14:22,873 [INFO]: 	size in bytes: 809208190
2025-03-13 17:14:22,873 [INFO]: 	avg_search_speed_ms: 7.7895155562696194
2025-03-13 17:14:22,873 [INFO]: 	99p_search_speed_ms: 15.555188190192
2025-03-13 17:14:22,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:22,873 [INFO]: 	nb vectors: 4113
2025-03-13 17:14:22,873 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:22,873 [INFO]: 	compression ratio: 0.99930860067049
2025-03-13 17:14:22,873 [INFO]: }
2025-03-13 17:14:22,873 [INFO]: 	>>> Finished "Creating the index" in 84.4230 secs
2025-03-13 17:14:22,873 [INFO]: >>> Finished "Launching the whole pipeline" in 84.4499 secs
2025-03-13 17:14:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 54863 [episode count 12/20]
[retrieval_preprocessing] for episode 45137 [episode count 13/20], we have num_retrieval=np.int64(4145) num_query=np.int64(153)
2025-03-13 17:14:26,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:27,196 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:27
2025-03-13 17:14:27,196 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 921.62it/s]
2025-03-13 17:14:27,239 [INFO]: There are 4145 embeddings of dim 49152
2025-03-13 17:14:27,240 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0434 secs
2025-03-13 17:14:27,240 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,241 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:27,241 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:14:27,241 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:27,241 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:14:27,241 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,241 [INFO]: 855.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:27,241 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:14:27,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:27
2025-03-13 17:14:27,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:27,242 [INFO]: 	Creating the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:27
2025-03-13 17:14:27,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:14:27,245 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:27
2025-03-13 17:14:27,246 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:14:27,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.33it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.88it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.81it/s] 24%|██▎       | 4/17 [00:00<00:01,  6.99it/s] 29%|██▉       | 5/17 [00:00<00:01,  6.95it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.20it/s] 41%|████      | 7/17 [00:01<00:01,  7.56it/s] 47%|████▋     | 8/17 [00:01<00:01,  7.75it/s] 53%|█████▎    | 9/17 [00:01<00:01,  7.75it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.78it/s] 65%|██████▍   | 11/17 [00:01<00:00,  7.89it/s] 71%|███████   | 12/17 [00:01<00:00,  7.93it/s] 76%|███████▋  | 13/17 [00:01<00:00,  7.99it/s] 82%|████████▏ | 14/17 [00:01<00:00,  7.94it/s] 88%|████████▊ | 15/17 [00:02<00:00,  7.97it/s] 94%|█████████▍| 16/17 [00:02<00:00,  7.87it/s]100%|██████████| 17/17 [00:06<00:00,  1.40s/it]100%|██████████| 17/17 [00:06<00:00,  2.61it/s]
2025-03-13 17:14:33,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:33
2025-03-13 17:15:21,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4376 secs
2025-03-13 17:15:21,200 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 17:15:21,201 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 17:16:02,856 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6549 secs
2025-03-13 17:16:02,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.6160 secs
2025-03-13 17:16:02,862 [INFO]: {
2025-03-13 17:16:02,862 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:02,862 [INFO]: 	index_param: efSearch=205
2025-03-13 17:16:02,862 [INFO]: 	index_path: knn.index
2025-03-13 17:16:02,862 [INFO]: 	size in bytes: 815503930
2025-03-13 17:16:02,862 [INFO]: 	avg_search_speed_ms: 12.283084282445852
2025-03-13 17:16:02,862 [INFO]: 	99p_search_speed_ms: 22.432954800315205
2025-03-13 17:16:02,862 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:02,862 [INFO]: 	nb vectors: 4145
2025-03-13 17:16:02,862 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:02,862 [INFO]: 	compression ratio: 0.9993086851218486
2025-03-13 17:16:02,862 [INFO]: }
2025-03-13 17:16:02,862 [INFO]: 	>>> Finished "Creating the index" in 95.6201 secs
2025-03-13 17:16:02,862 [INFO]: >>> Finished "Launching the whole pipeline" in 95.6656 secs
2025-03-13 17:16:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 45137 [episode count 13/20]
[retrieval_preprocessing] for episode 20052 [episode count 14/20], we have num_retrieval=np.int64(4151) num_query=np.int64(147)
2025-03-13 17:16:06,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:07,794 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:07
2025-03-13 17:16:07,794 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1933.75it/s]
2025-03-13 17:16:07,818 [INFO]: There are 4151 embeddings of dim 49152
2025-03-13 17:16:07,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 17:16:07,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:07,818 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:16:07,818 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:07,818 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:07,818 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,818 [INFO]: 856.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:07,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:07,818 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:07
2025-03-13 17:16:07,819 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:07,819 [INFO]: 	Creating the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,819 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:07
2025-03-13 17:16:07,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:16:07,820 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:07
2025-03-13 17:16:07,820 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:16:07,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.06it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.44it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.81it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.68it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.71it/s] 41%|████      | 7/17 [00:00<00:01,  8.94it/s] 47%|████▋     | 8/17 [00:01<00:00,  9.19it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.36it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.13it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.95it/s] 71%|███████   | 12/17 [00:01<00:00,  8.80it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.68it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.56it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.46it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.52it/s]100%|██████████| 17/17 [00:05<00:00,  1.05s/it]100%|██████████| 17/17 [00:05<00:00,  3.29it/s]
2025-03-13 17:16:12,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:12
2025-03-13 17:16:54,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8426 secs
2025-03-13 17:16:54,836 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 17:16:54,836 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 17:17:24,577 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7413 secs
2025-03-13 17:17:24,582 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7620 secs
2025-03-13 17:17:24,582 [INFO]: {
2025-03-13 17:17:24,582 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:24,582 [INFO]: 	index_param: efSearch=144
2025-03-13 17:17:24,582 [INFO]: 	index_path: knn.index
2025-03-13 17:17:24,582 [INFO]: 	size in bytes: 816684370
2025-03-13 17:17:24,582 [INFO]: 	avg_search_speed_ms: 8.289148637200173
2025-03-13 17:17:24,582 [INFO]: 	99p_search_speed_ms: 15.782496461179127
2025-03-13 17:17:24,582 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:24,582 [INFO]: 	nb vectors: 4151
2025-03-13 17:17:24,582 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:24,582 [INFO]: 	compression ratio: 0.9993087145772117
2025-03-13 17:17:24,582 [INFO]: }
2025-03-13 17:17:24,582 [INFO]: 	>>> Finished "Creating the index" in 76.7636 secs
2025-03-13 17:17:24,582 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7880 secs
2025-03-13 17:17:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 20052 [episode count 14/20]
[retrieval_preprocessing] for episode 34396 [episode count 15/20], we have num_retrieval=np.int64(3959) num_query=np.int64(339)
2025-03-13 17:17:27,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:28,365 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:28
2025-03-13 17:17:28,365 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1501.72it/s]
2025-03-13 17:17:28,391 [INFO]: There are 3959 embeddings of dim 49152
2025-03-13 17:17:28,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:17:28,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:28,392 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:17:28,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:28,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:28,392 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,392 [INFO]: 817.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:28,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:17:28,392 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:28
2025-03-13 17:17:28,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:28,392 [INFO]: 	Creating the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,392 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:28
2025-03-13 17:17:28,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:17:28,393 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:28
2025-03-13 17:17:28,393 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:17:28,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.97it/s] 25%|██▌       | 4/16 [00:00<00:00, 16.50it/s] 38%|███▊      | 6/16 [00:00<00:00, 13.61it/s] 50%|█████     | 8/16 [00:00<00:00, 12.29it/s] 62%|██████▎   | 10/16 [00:00<00:00, 11.74it/s] 75%|███████▌  | 12/16 [00:00<00:00, 11.50it/s] 88%|████████▊ | 14/16 [00:01<00:00, 11.63it/s]100%|██████████| 16/16 [00:05<00:00,  1.48it/s]100%|██████████| 16/16 [00:05<00:00,  3.15it/s]
2025-03-13 17:17:33,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:33
2025-03-13 17:18:19,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9555 secs
2025-03-13 17:18:19,425 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 17:18:19,425 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 17:18:38,172 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7468 secs
2025-03-13 17:18:38,219 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8257 secs
2025-03-13 17:18:38,219 [INFO]: {
2025-03-13 17:18:38,219 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:38,219 [INFO]: 	index_param: efSearch=167
2025-03-13 17:18:38,219 [INFO]: 	index_path: knn.index
2025-03-13 17:18:38,219 [INFO]: 	size in bytes: 778909690
2025-03-13 17:18:38,219 [INFO]: 	avg_search_speed_ms: 9.426570021039144
2025-03-13 17:18:38,219 [INFO]: 	99p_search_speed_ms: 15.910380752757268
2025-03-13 17:18:38,219 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:38,219 [INFO]: 	nb vectors: 3959
2025-03-13 17:18:38,219 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:38,219 [INFO]: 	compression ratio: 0.9993084974973158
2025-03-13 17:18:38,219 [INFO]: }
2025-03-13 17:18:38,220 [INFO]: 	>>> Finished "Creating the index" in 69.8276 secs
2025-03-13 17:18:38,220 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8541 secs
2025-03-13 17:18:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 34396 [episode count 15/20]
[retrieval_preprocessing] for episode 100 [episode count 16/20], we have num_retrieval=np.int64(4076) num_query=np.int64(222)
2025-03-13 17:18:42,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:43,032 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:43
2025-03-13 17:18:43,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-13 17:18:43,665 [INFO]: There are 4076 embeddings of dim 49152
2025-03-13 17:18:43,665 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6333 secs
2025-03-13 17:18:43,665 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:43
2025-03-13 17:18:43,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:43,666 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:18:43,666 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:43,666 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:18:43,666 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:43
2025-03-13 17:18:43,666 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:43,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:18:43,666 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:43
2025-03-13 17:18:43,666 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:43,666 [INFO]: 	Creating the index 03/13/2025, 17:18:43
2025-03-13 17:18:43,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:43
2025-03-13 17:18:43,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:18:43,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:43
2025-03-13 17:18:43,669 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:18:43,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.56it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.92it/s] 29%|██▉       | 5/17 [00:00<00:00, 12.79it/s] 41%|████      | 7/17 [00:00<00:00, 13.60it/s] 53%|█████▎    | 9/17 [00:00<00:00, 14.18it/s] 65%|██████▍   | 11/17 [00:00<00:00, 14.86it/s] 76%|███████▋  | 13/17 [00:00<00:00, 15.05it/s] 88%|████████▊ | 15/17 [00:01<00:00, 15.61it/s]100%|██████████| 17/17 [00:04<00:00,  1.96it/s]100%|██████████| 17/17 [00:04<00:00,  4.22it/s]
2025-03-13 17:18:47,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:47
2025-03-13 17:19:29,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9234 secs
2025-03-13 17:19:29,623 [INFO]: The best hyperparameters are: efSearch=113
2025-03-13 17:19:29,623 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-13 17:20:06,413 [INFO]: 	>>> Finished "Compute fast metrics" in 36.7897 secs
2025-03-13 17:20:06,416 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.7470 secs
2025-03-13 17:20:06,416 [INFO]: {
2025-03-13 17:20:06,416 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:06,416 [INFO]: 	index_param: efSearch=113
2025-03-13 17:20:06,416 [INFO]: 	index_path: knn.index
2025-03-13 17:20:06,416 [INFO]: 	size in bytes: 801928630
2025-03-13 17:20:06,416 [INFO]: 	avg_search_speed_ms: 7.121798783863107
2025-03-13 17:20:06,416 [INFO]: 	99p_search_speed_ms: 15.048677932936704
2025-03-13 17:20:06,416 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:06,416 [INFO]: 	nb vectors: 4076
2025-03-13 17:20:06,416 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:06,416 [INFO]: 	compression ratio: 0.999308639223917
2025-03-13 17:20:06,416 [INFO]: }
2025-03-13 17:20:06,416 [INFO]: 	>>> Finished "Creating the index" in 82.7498 secs
2025-03-13 17:20:06,416 [INFO]: >>> Finished "Launching the whole pipeline" in 83.3843 secs
2025-03-13 17:20:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 100 [episode count 16/20]
[retrieval_preprocessing] for episode 92260 [episode count 17/20], we have num_retrieval=np.int64(4034) num_query=np.int64(264)
2025-03-13 17:20:10,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:11,701 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:11
2025-03-13 17:20:11,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.40it/s]
2025-03-13 17:20:11,730 [INFO]: There are 4034 embeddings of dim 49152
2025-03-13 17:20:11,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 17:20:11,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:11
2025-03-13 17:20:11,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:11,732 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 17:20:11,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:11,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:20:11,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:11
2025-03-13 17:20:11,733 [INFO]: 832.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:11,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:20:11,733 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:11
2025-03-13 17:20:11,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:11,734 [INFO]: 	Creating the index 03/13/2025, 17:20:11
2025-03-13 17:20:11,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:11
2025-03-13 17:20:11,736 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 17:20:11,736 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:11
2025-03-13 17:20:11,737 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:20:11,737 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:04,  3.43it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.43it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.70it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.66it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.26it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.62it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.91it/s] 50%|█████     | 8/16 [00:01<00:00,  9.19it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.95it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.28it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.58it/s]100%|██████████| 16/16 [00:05<00:00,  1.50it/s]100%|██████████| 16/16 [00:05<00:00,  3.15it/s]
2025-03-13 17:20:16,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:16
2025-03-13 17:20:57,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7444 secs
2025-03-13 17:20:57,580 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 17:20:57,580 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.10it/s]
2025-03-13 17:21:23,193 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6128 secs
2025-03-13 17:21:23,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4601 secs
2025-03-13 17:21:23,197 [INFO]: {
2025-03-13 17:21:23,197 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:23,197 [INFO]: 	index_param: efSearch=129
2025-03-13 17:21:23,197 [INFO]: 	index_path: knn.index
2025-03-13 17:21:23,197 [INFO]: 	size in bytes: 793665430
2025-03-13 17:21:23,197 [INFO]: 	avg_search_speed_ms: 7.168995876565384
2025-03-13 17:21:23,197 [INFO]: 	99p_search_speed_ms: 11.045381496660408
2025-03-13 17:21:23,197 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:23,197 [INFO]: 	nb vectors: 4034
2025-03-13 17:21:23,197 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:23,197 [INFO]: 	compression ratio: 0.9993085776710723
2025-03-13 17:21:23,197 [INFO]: }
2025-03-13 17:21:23,197 [INFO]: 	>>> Finished "Creating the index" in 71.4635 secs
2025-03-13 17:21:23,197 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4963 secs
2025-03-13 17:21:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 92260 [episode count 17/20]
[retrieval_preprocessing] for episode 20592 [episode count 18/20], we have num_retrieval=np.int64(4146) num_query=np.int64(152)
2025-03-13 17:21:26,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:27,128 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:27
2025-03-13 17:21:27,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.25it/s]
2025-03-13 17:21:27,155 [INFO]: There are 4146 embeddings of dim 49152
2025-03-13 17:21:27,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:21:27,156 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:27
2025-03-13 17:21:27,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:27,156 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:21:27,156 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:27,156 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:21:27,156 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:27
2025-03-13 17:21:27,156 [INFO]: 855.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:27,157 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:21:27,157 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:27
2025-03-13 17:21:27,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:27,157 [INFO]: 	Creating the index 03/13/2025, 17:21:27
2025-03-13 17:21:27,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:27
2025-03-13 17:21:27,160 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:21:27,160 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:27
2025-03-13 17:21:27,161 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:21:27,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.74it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.64it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.33it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.38it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.70it/s] 53%|█████▎    | 9/17 [00:00<00:00,  9.67it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.61it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.60it/s] 71%|███████   | 12/17 [00:01<00:00,  9.62it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.73it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.69it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.59it/s]100%|██████████| 17/17 [00:05<00:00,  1.09s/it]100%|██████████| 17/17 [00:05<00:00,  3.09it/s]
2025-03-13 17:21:32,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:32
2025-03-13 17:22:17,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0886 secs
2025-03-13 17:22:17,755 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:22:17,755 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.52it/s] 50%|█████     | 2/4 [00:00<00:00,  5.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.61it/s]
2025-03-13 17:22:43,623 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8677 secs
2025-03-13 17:22:43,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.4658 secs
2025-03-13 17:22:43,627 [INFO]: {
2025-03-13 17:22:43,627 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:43,627 [INFO]: 	index_param: efSearch=174
2025-03-13 17:22:43,627 [INFO]: 	index_path: knn.index
2025-03-13 17:22:43,627 [INFO]: 	size in bytes: 815700670
2025-03-13 17:22:43,627 [INFO]: 	avg_search_speed_ms: 9.231268292394427
2025-03-13 17:22:43,627 [INFO]: 	99p_search_speed_ms: 13.778597079217436
2025-03-13 17:22:43,627 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:43,627 [INFO]: 	nb vectors: 4146
2025-03-13 17:22:43,627 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:43,627 [INFO]: 	compression ratio: 0.9993086900369961
2025-03-13 17:22:43,627 [INFO]: }
2025-03-13 17:22:43,627 [INFO]: 	>>> Finished "Creating the index" in 76.4695 secs
2025-03-13 17:22:43,627 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4983 secs
2025-03-13 17:22:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20592 [episode count 18/20]
[retrieval_preprocessing] for episode 19068 [episode count 19/20], we have num_retrieval=np.int64(4144) num_query=np.int64(154)
2025-03-13 17:22:47,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:47,954 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:47
2025-03-13 17:22:47,954 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-13 17:22:47,981 [INFO]: There are 4144 embeddings of dim 49152
2025-03-13 17:22:47,982 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 17:22:47,982 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:47
2025-03-13 17:22:47,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:47,982 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:22:47,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:47,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:47,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:47
2025-03-13 17:22:47,982 [INFO]: 855.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:47,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:47,982 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:47
2025-03-13 17:22:47,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:47,982 [INFO]: 	Creating the index 03/13/2025, 17:22:47
2025-03-13 17:22:47,982 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:47
2025-03-13 17:22:47,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:22:47,984 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:47
2025-03-13 17:22:47,984 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:22:47,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.41it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.22it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.09it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.65it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.85it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.60it/s] 59%|█████▉    | 10/17 [00:01<00:00, 10.97it/s] 71%|███████   | 12/17 [00:01<00:00, 11.18it/s] 82%|████████▏ | 14/17 [00:01<00:00, 11.30it/s] 94%|█████████▍| 16/17 [00:01<00:00, 11.10it/s]100%|██████████| 17/17 [00:05<00:00,  3.13it/s]
2025-03-13 17:22:53,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:53
2025-03-13 17:23:34,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0524 secs
2025-03-13 17:23:34,473 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:23:34,473 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 17:24:05,723 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2492 secs
2025-03-13 17:24:05,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.7424 secs
2025-03-13 17:24:05,727 [INFO]: {
2025-03-13 17:24:05,727 [INFO]: 	index_key: HNSW15
2025-03-13 17:24:05,727 [INFO]: 	index_param: efSearch=157
2025-03-13 17:24:05,727 [INFO]: 	index_path: knn.index
2025-03-13 17:24:05,727 [INFO]: 	size in bytes: 815307190
2025-03-13 17:24:05,727 [INFO]: 	avg_search_speed_ms: 8.901634036695198
2025-03-13 17:24:05,727 [INFO]: 	99p_search_speed_ms: 15.859929961152375
2025-03-13 17:24:05,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:24:05,727 [INFO]: 	nb vectors: 4144
2025-03-13 17:24:05,727 [INFO]: 	vectors dimension: 49152
2025-03-13 17:24:05,727 [INFO]: 	compression ratio: 0.9993086802043288
2025-03-13 17:24:05,727 [INFO]: }
2025-03-13 17:24:05,727 [INFO]: 	>>> Finished "Creating the index" in 77.7448 secs
2025-03-13 17:24:05,727 [INFO]: >>> Finished "Launching the whole pipeline" in 77.7732 secs
2025-03-13 17:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 19068 [episode count 19/20]
2025-03-13 17:24:08: [retrieval_preprocessing] finished for 1712293193_remove_marker_from_cup [chosen_id count 3/196]
2025-03-13 17:24:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1712293193_remove_marker_from_mug [chosen_id count 4/196]
2025-03-13 17:24:12: [retrieval_preprocessing] we have num_total=3915 embedding_dim=49152
[retrieval_preprocessing] for episode 76803 [episode count 0/20], we have num_retrieval=np.int64(3604) num_query=np.int64(311)
2025-03-13 17:24:15,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:15,931 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:15
2025-03-13 17:24:15,931 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.36it/s]
2025-03-13 17:24:15,958 [INFO]: There are 3604 embeddings of dim 49152
2025-03-13 17:24:15,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:24:15,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:15
2025-03-13 17:24:15,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:15,958 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:24:15,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:15,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:15,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:15
2025-03-13 17:24:15,958 [INFO]: 743.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:15,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:24:15,959 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:15
2025-03-13 17:24:15,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:15,959 [INFO]: 	Creating the index 03/13/2025, 17:24:15
2025-03-13 17:24:15,959 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:15
2025-03-13 17:24:15,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:24:15,960 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:15
2025-03-13 17:24:15,960 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:24:15,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.66it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.99it/s] 20%|██        | 3/15 [00:00<00:01,  6.68it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.23it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.81it/s] 40%|████      | 6/15 [00:00<00:01,  8.14it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.25it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.36it/s] 60%|██████    | 9/15 [00:01<00:00,  8.44it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.67it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.84it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.22it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.31it/s]100%|██████████| 15/15 [00:05<00:00,  1.04s/it]100%|██████████| 15/15 [00:05<00:00,  2.79it/s]
2025-03-13 17:24:21,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:21
2025-03-13 17:25:00,666 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3308 secs
2025-03-13 17:25:00,666 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:25:00,666 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 17:25:27,642 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9751 secs
2025-03-13 17:25:27,645 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6846 secs
2025-03-13 17:25:27,645 [INFO]: {
2025-03-13 17:25:27,645 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:27,645 [INFO]: 	index_param: efSearch=194
2025-03-13 17:25:27,645 [INFO]: 	index_path: knn.index
2025-03-13 17:25:27,645 [INFO]: 	size in bytes: 709064770
2025-03-13 17:25:27,645 [INFO]: 	avg_search_speed_ms: 11.084498324433545
2025-03-13 17:25:27,645 [INFO]: 	99p_search_speed_ms: 16.38703170930967
2025-03-13 17:25:27,645 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:27,645 [INFO]: 	nb vectors: 3604
2025-03-13 17:25:27,645 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:27,645 [INFO]: 	compression ratio: 0.9993096004473611
2025-03-13 17:25:27,645 [INFO]: }
2025-03-13 17:25:27,645 [INFO]: 	>>> Finished "Creating the index" in 71.6862 secs
2025-03-13 17:25:27,645 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7141 secs
2025-03-13 17:25:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 76803 [episode count 0/20]
[retrieval_preprocessing] for episode 81926 [episode count 1/20], we have num_retrieval=np.int64(3736) num_query=np.int64(179)
2025-03-13 17:25:31,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:32,561 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:32
2025-03-13 17:25:32,561 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-13 17:25:32,590 [INFO]: There are 3736 embeddings of dim 49152
2025-03-13 17:25:32,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:25:32,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:32,591 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:25:32,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:32,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:25:32,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,591 [INFO]: 771.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:32,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:25:32,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:32
2025-03-13 17:25:32,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:32,592 [INFO]: 	Creating the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,592 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:32
2025-03-13 17:25:32,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:25:32,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:32
2025-03-13 17:25:32,596 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:25:32,596 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:07,  1.94it/s] 13%|█▎        | 2/15 [00:00<00:03,  3.46it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.16it/s] 33%|███▎      | 5/15 [00:00<00:01,  6.79it/s] 40%|████      | 6/15 [00:01<00:01,  7.22it/s] 47%|████▋     | 7/15 [00:01<00:01,  7.40it/s] 53%|█████▎    | 8/15 [00:01<00:00,  7.59it/s] 60%|██████    | 9/15 [00:01<00:00,  7.78it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.08it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.24it/s] 80%|████████  | 12/15 [00:01<00:00,  8.51it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.90it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.71it/s]100%|██████████| 15/15 [00:05<00:00,  1.08s/it]100%|██████████| 15/15 [00:05<00:00,  2.82it/s]
2025-03-13 17:25:37,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:37
2025-03-13 17:26:17,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4226 secs
2025-03-13 17:26:17,355 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:26:17,355 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 17:26:38,336 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9806 secs
2025-03-13 17:26:38,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7436 secs
2025-03-13 17:26:38,340 [INFO]: {
2025-03-13 17:26:38,340 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:38,340 [INFO]: 	index_param: efSearch=200
2025-03-13 17:26:38,340 [INFO]: 	index_path: knn.index
2025-03-13 17:26:38,340 [INFO]: 	size in bytes: 735035230
2025-03-13 17:26:38,340 [INFO]: 	avg_search_speed_ms: 9.880983210426457
2025-03-13 17:26:38,340 [INFO]: 	99p_search_speed_ms: 15.552181389648462
2025-03-13 17:26:38,340 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:38,340 [INFO]: 	nb vectors: 3736
2025-03-13 17:26:38,340 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:38,340 [INFO]: 	compression ratio: 0.9993092276679038
2025-03-13 17:26:38,340 [INFO]: }
2025-03-13 17:26:38,340 [INFO]: 	>>> Finished "Creating the index" in 65.7477 secs
2025-03-13 17:26:38,340 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7792 secs
2025-03-13 17:26:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 81926 [episode count 1/20]
[retrieval_preprocessing] for episode 16396 [episode count 2/20], we have num_retrieval=np.int64(3725) num_query=np.int64(190)
2025-03-13 17:26:42,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:42,903 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:42
2025-03-13 17:26:42,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1700.16it/s]
2025-03-13 17:26:42,926 [INFO]: There are 3725 embeddings of dim 49152
2025-03-13 17:26:42,926 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 17:26:42,927 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:42
2025-03-13 17:26:42,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:42,927 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:26:42,927 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:42,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:42,927 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:42
2025-03-13 17:26:42,927 [INFO]: 768.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:42,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:42,927 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:42
2025-03-13 17:26:42,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:42,927 [INFO]: 	Creating the index 03/13/2025, 17:26:42
2025-03-13 17:26:42,927 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:42
2025-03-13 17:26:42,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:26:42,928 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:42
2025-03-13 17:26:42,928 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:26:42,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.03it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.49it/s] 20%|██        | 3/15 [00:00<00:01,  7.07it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.43it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.74it/s] 53%|█████▎    | 8/15 [00:00<00:00, 13.99it/s] 73%|███████▎  | 11/15 [00:00<00:00, 15.69it/s] 87%|████████▋ | 13/15 [00:01<00:00, 14.05it/s]100%|██████████| 15/15 [00:04<00:00,  1.98it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-13 17:26:47,061 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:47
2025-03-13 17:27:23,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4152 secs
2025-03-13 17:27:23,477 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 17:27:23,477 [INFO]: 	Compute fast metrics 03/13/2025, 17:27:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 17:27:42,407 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9306 secs
2025-03-13 17:27:42,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4820 secs
2025-03-13 17:27:42,410 [INFO]: {
2025-03-13 17:27:42,410 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:42,410 [INFO]: 	index_param: efSearch=205
2025-03-13 17:27:42,410 [INFO]: 	index_path: knn.index
2025-03-13 17:27:42,410 [INFO]: 	size in bytes: 732870970
2025-03-13 17:27:42,410 [INFO]: 	avg_search_speed_ms: 11.11665638939788
2025-03-13 17:27:42,410 [INFO]: 	99p_search_speed_ms: 15.322268730960786
2025-03-13 17:27:42,410 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:42,410 [INFO]: 	nb vectors: 3725
2025-03-13 17:27:42,410 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:42,410 [INFO]: 	compression ratio: 0.999309332719237
2025-03-13 17:27:42,410 [INFO]: }
2025-03-13 17:27:42,410 [INFO]: 	>>> Finished "Creating the index" in 59.4834 secs
2025-03-13 17:27:42,410 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5077 secs
2025-03-13 17:27:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 16396 [episode count 2/20]
[retrieval_preprocessing] for episode 30229 [episode count 3/20], we have num_retrieval=np.int64(3707) num_query=np.int64(208)
2025-03-13 17:27:45,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:46,188 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:46
2025-03-13 17:27:46,188 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1739.65it/s]
2025-03-13 17:27:46,213 [INFO]: There are 3707 embeddings of dim 49152
2025-03-13 17:27:46,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:27:46,213 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:46
2025-03-13 17:27:46,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:46,213 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:27:46,213 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:46,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:46,213 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:46
2025-03-13 17:27:46,214 [INFO]: 765.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:46,214 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:27:46,214 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:46
2025-03-13 17:27:46,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:46,214 [INFO]: 	Creating the index 03/13/2025, 17:27:46
2025-03-13 17:27:46,214 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:46
2025-03-13 17:27:46,215 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:27:46,215 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:46
2025-03-13 17:27:46,215 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:27:46,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.83it/s] 20%|██        | 3/15 [00:00<00:01,  8.62it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.38it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.77it/s] 60%|██████    | 9/15 [00:00<00:00, 10.22it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.90it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.20it/s]100%|██████████| 15/15 [00:04<00:00,  1.89it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-13 17:27:50,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:50
2025-03-13 17:28:27,562 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2113 secs
2025-03-13 17:28:27,563 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 17:28:27,563 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-13 17:29:10,762 [INFO]: 	>>> Finished "Compute fast metrics" in 43.1994 secs
2025-03-13 17:29:10,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.5511 secs
2025-03-13 17:29:10,766 [INFO]: {
2025-03-13 17:29:10,766 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:10,766 [INFO]: 	index_param: efSearch=257
2025-03-13 17:29:10,766 [INFO]: 	index_path: knn.index
2025-03-13 17:29:10,766 [INFO]: 	size in bytes: 729329470
2025-03-13 17:29:10,766 [INFO]: 	avg_search_speed_ms: 11.603956486761847
2025-03-13 17:29:10,766 [INFO]: 	99p_search_speed_ms: 19.29914922453463
2025-03-13 17:29:10,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:10,766 [INFO]: 	nb vectors: 3707
2025-03-13 17:29:10,766 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:10,766 [INFO]: 	compression ratio: 0.9993094835452077
2025-03-13 17:29:10,766 [INFO]: }
2025-03-13 17:29:10,766 [INFO]: 	>>> Finished "Creating the index" in 84.5526 secs
2025-03-13 17:29:10,766 [INFO]: >>> Finished "Launching the whole pipeline" in 84.5784 secs
2025-03-13 17:29:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 30229 [episode count 3/20]
[retrieval_preprocessing] for episode 57365 [episode count 4/20], we have num_retrieval=np.int64(3736) num_query=np.int64(179)
2025-03-13 17:29:15,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:16,185 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:16
2025-03-13 17:29:16,185 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.38it/s]
2025-03-13 17:29:16,210 [INFO]: There are 3736 embeddings of dim 49152
2025-03-13 17:29:16,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:29:16,210 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:16
2025-03-13 17:29:16,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:16,211 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:29:16,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:16,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:16,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:16
2025-03-13 17:29:16,211 [INFO]: 771.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:16,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:29:16,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:16
2025-03-13 17:29:16,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:16,211 [INFO]: 	Creating the index 03/13/2025, 17:29:16
2025-03-13 17:29:16,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:16
2025-03-13 17:29:16,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:29:16,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:16
2025-03-13 17:29:16,212 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:29:16,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.83it/s] 20%|██        | 3/15 [00:00<00:01, 11.00it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.56it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.30it/s] 60%|██████    | 9/15 [00:00<00:00, 13.97it/s] 73%|███████▎  | 11/15 [00:00<00:00, 14.42it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.65it/s]100%|██████████| 15/15 [00:04<00:00,  1.85it/s]100%|██████████| 15/15 [00:04<00:00,  3.73it/s]
2025-03-13 17:29:20,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:20
2025-03-13 17:30:01,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4765 secs
2025-03-13 17:30:01,722 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:30:01,722 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.84it/s] 50%|█████     | 2/4 [00:00<00:00,  5.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.80it/s]
2025-03-13 17:30:26,419 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6964 secs
2025-03-13 17:30:26,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2096 secs
2025-03-13 17:30:26,422 [INFO]: {
2025-03-13 17:30:26,422 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:26,422 [INFO]: 	index_param: efSearch=209
2025-03-13 17:30:26,422 [INFO]: 	index_path: knn.index
2025-03-13 17:30:26,422 [INFO]: 	size in bytes: 735035230
2025-03-13 17:30:26,422 [INFO]: 	avg_search_speed_ms: 9.735926757444208
2025-03-13 17:30:26,422 [INFO]: 	99p_search_speed_ms: 13.363701803609729
2025-03-13 17:30:26,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:26,422 [INFO]: 	nb vectors: 3736
2025-03-13 17:30:26,422 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:26,422 [INFO]: 	compression ratio: 0.9993092276679038
2025-03-13 17:30:26,422 [INFO]: }
2025-03-13 17:30:26,422 [INFO]: 	>>> Finished "Creating the index" in 70.2112 secs
2025-03-13 17:30:26,422 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2369 secs
2025-03-13 17:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 57365 [episode count 4/20]
[retrieval_preprocessing] for episode 58905 [episode count 5/20], we have num_retrieval=np.int64(3761) num_query=np.int64(154)
2025-03-13 17:30:29,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:30,129 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:30
2025-03-13 17:30:30,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-13 17:30:30,152 [INFO]: There are 3761 embeddings of dim 49152
2025-03-13 17:30:30,152 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 17:30:30,152 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:30
2025-03-13 17:30:30,152 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:30,152 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:30:30,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:30,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:30,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:30
2025-03-13 17:30:30,152 [INFO]: 776.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:30,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:30:30,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:30
2025-03-13 17:30:30,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:30,152 [INFO]: 	Creating the index 03/13/2025, 17:30:30
2025-03-13 17:30:30,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:30
2025-03-13 17:30:30,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:30:30,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:30
2025-03-13 17:30:30,154 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:30:30,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.85it/s] 20%|██        | 3/15 [00:00<00:01,  8.83it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.00it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.39it/s] 60%|██████    | 9/15 [00:00<00:00, 11.30it/s] 73%|███████▎  | 11/15 [00:01<00:00, 12.45it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.84it/s]100%|██████████| 15/15 [00:04<00:00,  1.55it/s]100%|██████████| 15/15 [00:04<00:00,  3.11it/s]
2025-03-13 17:30:34,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:34
2025-03-13 17:31:15,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3893 secs
2025-03-13 17:31:15,378 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:31:15,378 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s]
2025-03-13 17:31:38,672 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2940 secs
2025-03-13 17:31:38,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5214 secs
2025-03-13 17:31:38,675 [INFO]: {
2025-03-13 17:31:38,675 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:38,675 [INFO]: 	index_param: efSearch=207
2025-03-13 17:31:38,675 [INFO]: 	index_path: knn.index
2025-03-13 17:31:38,675 [INFO]: 	size in bytes: 739953910
2025-03-13 17:31:38,675 [INFO]: 	avg_search_speed_ms: 9.571693071863796
2025-03-13 17:31:38,675 [INFO]: 	99p_search_speed_ms: 14.154495447874066
2025-03-13 17:31:38,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:38,675 [INFO]: 	nb vectors: 3761
2025-03-13 17:31:38,675 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:38,675 [INFO]: 	compression ratio: 0.9993091164286165
2025-03-13 17:31:38,675 [INFO]: }
2025-03-13 17:31:38,675 [INFO]: 	>>> Finished "Creating the index" in 68.5228 secs
2025-03-13 17:31:38,675 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5457 secs
2025-03-13 17:31:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 58905 [episode count 5/20]
[retrieval_preprocessing] for episode 39964 [episode count 6/20], we have num_retrieval=np.int64(3660) num_query=np.int64(255)
2025-03-13 17:31:41,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:41,917 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:41
2025-03-13 17:31:41,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.68it/s]
2025-03-13 17:31:41,946 [INFO]: There are 3660 embeddings of dim 49152
2025-03-13 17:31:41,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:31:41,947 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:41,947 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:31:41,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:41,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:31:41,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,948 [INFO]: 755.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:41,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:31:41,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:41
2025-03-13 17:31:41,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:41,948 [INFO]: 	Creating the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:41
2025-03-13 17:31:41,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:31:41,952 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:41
2025-03-13 17:31:41,952 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:31:41,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.30it/s] 20%|██        | 3/15 [00:00<00:01,  9.61it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.67it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.21it/s] 60%|██████    | 9/15 [00:00<00:00, 11.37it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.35it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.09it/s]100%|██████████| 15/15 [00:04<00:00,  1.64it/s]100%|██████████| 15/15 [00:04<00:00,  3.26it/s]
2025-03-13 17:31:46,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:46
2025-03-13 17:32:23,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9328 secs
2025-03-13 17:32:23,498 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:32:23,498 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 17:32:49,850 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3516 secs
2025-03-13 17:32:49,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9013 secs
2025-03-13 17:32:49,853 [INFO]: {
2025-03-13 17:32:49,853 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:49,853 [INFO]: 	index_param: efSearch=198
2025-03-13 17:32:49,853 [INFO]: 	index_path: knn.index
2025-03-13 17:32:49,853 [INFO]: 	size in bytes: 720082690
2025-03-13 17:32:49,853 [INFO]: 	avg_search_speed_ms: 10.15267105806184
2025-03-13 17:32:49,853 [INFO]: 	99p_search_speed_ms: 15.168045526370404
2025-03-13 17:32:49,853 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:49,854 [INFO]: 	nb vectors: 3660
2025-03-13 17:32:49,854 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:49,854 [INFO]: 	compression ratio: 0.9993092321105511
2025-03-13 17:32:49,854 [INFO]: }
2025-03-13 17:32:49,854 [INFO]: 	>>> Finished "Creating the index" in 67.9053 secs
2025-03-13 17:32:49,854 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9367 secs
2025-03-13 17:32:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 39964 [episode count 6/20]
[retrieval_preprocessing] for episode 45597 [episode count 7/20], we have num_retrieval=np.int64(3751) num_query=np.int64(164)
2025-03-13 17:32:53,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:53,718 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:53
2025-03-13 17:32:53,718 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 952.82it/s]
2025-03-13 17:32:53,747 [INFO]: There are 3751 embeddings of dim 49152
2025-03-13 17:32:53,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:32:53,747 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:53
2025-03-13 17:32:53,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:53,747 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:32:53,747 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:53,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:53,747 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:53
2025-03-13 17:32:53,747 [INFO]: 774.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:53,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:32:53,748 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:53
2025-03-13 17:32:53,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:53,748 [INFO]: 	Creating the index 03/13/2025, 17:32:53
2025-03-13 17:32:53,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:53
2025-03-13 17:32:53,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:32:53,749 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:53
2025-03-13 17:32:53,749 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:32:53,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.42it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.22it/s] 20%|██        | 3/15 [00:00<00:01,  8.16it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.75it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.65it/s] 60%|██████    | 9/15 [00:00<00:00, 10.96it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.87it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.94it/s]100%|██████████| 15/15 [00:04<00:00,  1.70it/s]100%|██████████| 15/15 [00:04<00:00,  3.32it/s]
2025-03-13 17:32:58,280 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:58
2025-03-13 17:33:35,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4061 secs
2025-03-13 17:33:35,687 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 17:33:35,687 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-13 17:34:07,487 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7997 secs
2025-03-13 17:34:07,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7407 secs
2025-03-13 17:34:07,490 [INFO]: {
2025-03-13 17:34:07,490 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:07,490 [INFO]: 	index_param: efSearch=212
2025-03-13 17:34:07,490 [INFO]: 	index_path: knn.index
2025-03-13 17:34:07,490 [INFO]: 	size in bytes: 737986450
2025-03-13 17:34:07,490 [INFO]: 	avg_search_speed_ms: 9.61149672265702
2025-03-13 17:34:07,490 [INFO]: 	99p_search_speed_ms: 14.774110501166408
2025-03-13 17:34:07,490 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:07,490 [INFO]: 	nb vectors: 3751
2025-03-13 17:34:07,490 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:07,490 [INFO]: 	compression ratio: 0.9993091444971652
2025-03-13 17:34:07,490 [INFO]: }
2025-03-13 17:34:07,490 [INFO]: 	>>> Finished "Creating the index" in 73.7422 secs
2025-03-13 17:34:07,490 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7716 secs
2025-03-13 17:34:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 45597 [episode count 7/20]
[retrieval_preprocessing] for episode 87587 [episode count 8/20], we have num_retrieval=np.int64(3708) num_query=np.int64(207)
2025-03-13 17:34:10,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:10,750 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:10
2025-03-13 17:34:10,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-13 17:34:10,777 [INFO]: There are 3708 embeddings of dim 49152
2025-03-13 17:34:10,777 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 17:34:10,777 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:10
2025-03-13 17:34:10,777 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:10,777 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:34:10,777 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:10,777 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:10,777 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:10
2025-03-13 17:34:10,777 [INFO]: 765.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:10,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:10,777 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:10
2025-03-13 17:34:10,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:10,778 [INFO]: 	Creating the index 03/13/2025, 17:34:10
2025-03-13 17:34:10,778 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:10
2025-03-13 17:34:10,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:34:10,779 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:10
2025-03-13 17:34:10,779 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:34:10,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.91it/s] 20%|██        | 3/15 [00:00<00:01,  9.33it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.50it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.93it/s] 60%|██████    | 9/15 [00:00<00:00, 11.05it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.19it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.67it/s]100%|██████████| 15/15 [00:04<00:00,  1.78it/s]100%|██████████| 15/15 [00:04<00:00,  3.48it/s]
2025-03-13 17:34:15,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:15
2025-03-13 17:34:56,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8428 secs
2025-03-13 17:34:56,945 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:34:56,945 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.96it/s]
2025-03-13 17:35:19,645 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6995 secs
2025-03-13 17:35:19,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8685 secs
2025-03-13 17:35:19,648 [INFO]: {
2025-03-13 17:35:19,648 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:19,648 [INFO]: 	index_param: efSearch=173
2025-03-13 17:35:19,648 [INFO]: 	index_path: knn.index
2025-03-13 17:35:19,648 [INFO]: 	size in bytes: 729526210
2025-03-13 17:35:19,648 [INFO]: 	avg_search_speed_ms: 10.214242989775764
2025-03-13 17:35:19,648 [INFO]: 	99p_search_speed_ms: 18.831062582321465
2025-03-13 17:35:19,648 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:19,648 [INFO]: 	nb vectors: 3708
2025-03-13 17:35:19,648 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:19,648 [INFO]: 	compression ratio: 0.9993094888256311
2025-03-13 17:35:19,648 [INFO]: }
2025-03-13 17:35:19,648 [INFO]: 	>>> Finished "Creating the index" in 68.8704 secs
2025-03-13 17:35:19,648 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8983 secs
2025-03-13 17:35:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 87587 [episode count 8/20]
[retrieval_preprocessing] for episode 25125 [episode count 9/20], we have num_retrieval=np.int64(3759) num_query=np.int64(156)
2025-03-13 17:35:22,835 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:23,927 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:23
2025-03-13 17:35:23,927 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 17:35:23,953 [INFO]: There are 3759 embeddings of dim 49152
2025-03-13 17:35:23,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:35:23,953 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:23,953 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:35:23,953 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:23,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:35:23,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,953 [INFO]: 775.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:23,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:35:23,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:23
2025-03-13 17:35:23,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:23,954 [INFO]: 	Creating the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:23
2025-03-13 17:35:23,955 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 17:35:23,955 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:23
2025-03-13 17:35:23,955 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:35:23,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.36it/s] 20%|██        | 3/15 [00:00<00:00, 13.91it/s] 40%|████      | 6/15 [00:00<00:00, 18.14it/s] 60%|██████    | 9/15 [00:00<00:00, 15.13it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.24it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.04it/s]100%|██████████| 15/15 [00:04<00:00,  1.73it/s]100%|██████████| 15/15 [00:04<00:00,  3.38it/s]
2025-03-13 17:35:28,400 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:28
2025-03-13 17:36:16,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7616 secs
2025-03-13 17:36:16,162 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 17:36:16,162 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 17:36:50,090 [INFO]: 	>>> Finished "Compute fast metrics" in 33.9278 secs
2025-03-13 17:36:50,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.1396 secs
2025-03-13 17:36:50,095 [INFO]: {
2025-03-13 17:36:50,095 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:50,095 [INFO]: 	index_param: efSearch=197
2025-03-13 17:36:50,095 [INFO]: 	index_path: knn.index
2025-03-13 17:36:50,095 [INFO]: 	size in bytes: 739560430
2025-03-13 17:36:50,095 [INFO]: 	avg_search_speed_ms: 10.584385978383205
2025-03-13 17:36:50,095 [INFO]: 	99p_search_speed_ms: 16.627097185701118
2025-03-13 17:36:50,095 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:50,095 [INFO]: 	nb vectors: 3759
2025-03-13 17:36:50,095 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:50,095 [INFO]: 	compression ratio: 0.9993091058157344
2025-03-13 17:36:50,095 [INFO]: }
2025-03-13 17:36:50,095 [INFO]: 	>>> Finished "Creating the index" in 86.1416 secs
2025-03-13 17:36:50,095 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1685 secs
2025-03-13 17:36:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 25125 [episode count 9/20]
[retrieval_preprocessing] for episode 9260 [episode count 10/20], we have num_retrieval=np.int64(3744) num_query=np.int64(171)
2025-03-13 17:36:53,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:53,721 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:53
2025-03-13 17:36:53,721 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.44it/s]
2025-03-13 17:36:53,747 [INFO]: There are 3744 embeddings of dim 49152
2025-03-13 17:36:53,748 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:36:53,748 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:53
2025-03-13 17:36:53,748 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:53,748 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:36:53,748 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:53,748 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:36:53,748 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:53
2025-03-13 17:36:53,748 [INFO]: 772.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:53,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:53,748 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:53
2025-03-13 17:36:53,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:53,748 [INFO]: 	Creating the index 03/13/2025, 17:36:53
2025-03-13 17:36:53,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:53
2025-03-13 17:36:53,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:36:53,749 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:53
2025-03-13 17:36:53,749 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:36:53,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.31it/s] 20%|██        | 3/15 [00:00<00:01,  8.27it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.45it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.04it/s] 60%|██████    | 9/15 [00:00<00:00, 10.29it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.62it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.90it/s]100%|██████████| 15/15 [00:04<00:00,  1.85it/s]100%|██████████| 15/15 [00:04<00:00,  3.53it/s]
2025-03-13 17:36:58,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:58
2025-03-13 17:37:38,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6680 secs
2025-03-13 17:37:38,682 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:37:38,682 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s]
2025-03-13 17:38:10,238 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5553 secs
2025-03-13 17:38:10,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.4912 secs
2025-03-13 17:38:10,240 [INFO]: {
2025-03-13 17:38:10,241 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:10,241 [INFO]: 	index_param: efSearch=174
2025-03-13 17:38:10,241 [INFO]: 	index_path: knn.index
2025-03-13 17:38:10,241 [INFO]: 	size in bytes: 736609210
2025-03-13 17:38:10,241 [INFO]: 	avg_search_speed_ms: 8.894875888618246
2025-03-13 17:38:10,241 [INFO]: 	99p_search_speed_ms: 15.007361609023064
2025-03-13 17:38:10,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:10,241 [INFO]: 	nb vectors: 3744
2025-03-13 17:38:10,241 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:10,241 [INFO]: 	compression ratio: 0.9993091886537775
2025-03-13 17:38:10,241 [INFO]: }
2025-03-13 17:38:10,241 [INFO]: 	>>> Finished "Creating the index" in 76.4925 secs
2025-03-13 17:38:10,241 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5193 secs
2025-03-13 17:38:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 9260 [episode count 10/20]
[retrieval_preprocessing] for episode 47157 [episode count 11/20], we have num_retrieval=np.int64(3713) num_query=np.int64(202)
2025-03-13 17:38:12,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:13,038 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:13
2025-03-13 17:38:13,038 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.20it/s]
2025-03-13 17:38:13,063 [INFO]: There are 3713 embeddings of dim 49152
2025-03-13 17:38:13,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 17:38:13,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,063 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:13,063 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:38:13,063 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:13,063 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:13,063 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,063 [INFO]: 766.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:13,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:38:13,064 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:13
2025-03-13 17:38:13,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:13,064 [INFO]: 	Creating the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,064 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:13
2025-03-13 17:38:13,065 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:38:13,065 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:13
2025-03-13 17:38:13,065 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:38:13,065 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.70it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.84it/s] 27%|██▋       | 4/15 [00:00<00:01,  9.95it/s] 40%|████      | 6/15 [00:00<00:00, 11.01it/s] 53%|█████▎    | 8/15 [00:00<00:00, 11.82it/s] 67%|██████▋   | 10/15 [00:00<00:00, 11.59it/s] 87%|████████▋ | 13/15 [00:01<00:00, 14.75it/s]100%|██████████| 15/15 [00:04<00:00,  1.80it/s]100%|██████████| 15/15 [00:04<00:00,  3.33it/s]
2025-03-13 17:38:17,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:17
2025-03-13 17:38:55,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8169 secs
2025-03-13 17:38:55,393 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:38:55,393 [INFO]: 	Compute fast metrics 03/13/2025, 17:38:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 17:39:20,672 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2792 secs
2025-03-13 17:39:20,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6110 secs
2025-03-13 17:39:20,676 [INFO]: {
2025-03-13 17:39:20,676 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:20,676 [INFO]: 	index_param: efSearch=201
2025-03-13 17:39:20,676 [INFO]: 	index_path: knn.index
2025-03-13 17:39:20,676 [INFO]: 	size in bytes: 730509970
2025-03-13 17:39:20,676 [INFO]: 	avg_search_speed_ms: 10.003148663323373
2025-03-13 17:39:20,676 [INFO]: 	99p_search_speed_ms: 13.434120337478817
2025-03-13 17:39:20,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:20,676 [INFO]: 	nb vectors: 3713
2025-03-13 17:39:20,676 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:20,676 [INFO]: 	compression ratio: 0.9993094331073948
2025-03-13 17:39:20,676 [INFO]: }
2025-03-13 17:39:20,676 [INFO]: 	>>> Finished "Creating the index" in 67.6126 secs
2025-03-13 17:39:20,676 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6386 secs
2025-03-13 17:39:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 47157 [episode count 11/20]
[retrieval_preprocessing] for episode 6208 [episode count 12/20], we have num_retrieval=np.int64(3768) num_query=np.int64(147)
2025-03-13 17:39:23,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:24,627 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:24
2025-03-13 17:39:24,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2053.01it/s]
2025-03-13 17:39:24,650 [INFO]: There are 3768 embeddings of dim 49152
2025-03-13 17:39:24,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 17:39:24,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:24
2025-03-13 17:39:24,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:24,650 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:39:24,650 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:24,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:39:24,650 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:24
2025-03-13 17:39:24,650 [INFO]: 777.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:24,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:39:24,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:24
2025-03-13 17:39:24,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:24,650 [INFO]: 	Creating the index 03/13/2025, 17:39:24
2025-03-13 17:39:24,651 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:24
2025-03-13 17:39:24,652 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:39:24,652 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:24
2025-03-13 17:39:24,652 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:39:24,652 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.70it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.60it/s] 20%|██        | 3/15 [00:00<00:01,  8.35it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.30it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.59it/s] 60%|██████    | 9/15 [00:00<00:00, 10.54it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.59it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.58it/s]100%|██████████| 15/15 [00:04<00:00,  1.63it/s]100%|██████████| 15/15 [00:04<00:00,  3.21it/s]
2025-03-13 17:39:29,332 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:29
2025-03-13 17:40:04,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5210 secs
2025-03-13 17:40:04,854 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 17:40:04,854 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-13 17:40:40,546 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6919 secs
2025-03-13 17:40:40,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8968 secs
2025-03-13 17:40:40,549 [INFO]: {
2025-03-13 17:40:40,549 [INFO]: 	index_key: HNSW15
2025-03-13 17:40:40,549 [INFO]: 	index_param: efSearch=181
2025-03-13 17:40:40,549 [INFO]: 	index_path: knn.index
2025-03-13 17:40:40,549 [INFO]: 	size in bytes: 741331090
2025-03-13 17:40:40,549 [INFO]: 	avg_search_speed_ms: 10.76145258289035
2025-03-13 17:40:40,549 [INFO]: 	99p_search_speed_ms: 21.74610505811871
2025-03-13 17:40:40,549 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:40,549 [INFO]: 	nb vectors: 3768
2025-03-13 17:40:40,549 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:40,549 [INFO]: 	compression ratio: 0.9993091534849834
2025-03-13 17:40:40,549 [INFO]: }
2025-03-13 17:40:40,549 [INFO]: 	>>> Finished "Creating the index" in 75.8983 secs
2025-03-13 17:40:40,549 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9220 secs
2025-03-13 17:40:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 6208 [episode count 12/20]
[retrieval_preprocessing] for episode 82008 [episode count 13/20], we have num_retrieval=np.int64(3638) num_query=np.int64(277)
2025-03-13 17:40:42,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:40:43,263 [INFO]: Launching the whole pipeline 03/13/2025, 17:40:43
2025-03-13 17:40:43,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:40:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1813.36it/s]
2025-03-13 17:40:43,291 [INFO]: There are 3638 embeddings of dim 49152
2025-03-13 17:40:43,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 17:40:43,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:40:43
2025-03-13 17:40:43,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:40:43,292 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:40:43,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:40:43,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:40:43,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:40:43
2025-03-13 17:40:43,292 [INFO]: 750.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:40:43,292 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:40:43,292 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:40:43
2025-03-13 17:40:43,292 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:40:43,292 [INFO]: 	Creating the index 03/13/2025, 17:40:43
2025-03-13 17:40:43,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:40:43
2025-03-13 17:40:43,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:40:43,295 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:40:43
2025-03-13 17:40:43,295 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:40:43,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.84it/s] 20%|██        | 3/15 [00:00<00:01, 11.59it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.07it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.72it/s] 60%|██████    | 9/15 [00:00<00:00, 12.97it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.89it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.67it/s]100%|██████████| 15/15 [00:04<00:00,  1.61it/s]100%|██████████| 15/15 [00:04<00:00,  3.28it/s]
2025-03-13 17:40:47,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:40:47
2025-03-13 17:41:32,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4729 secs
2025-03-13 17:41:32,345 [INFO]: The best hyperparameters are: efSearch=133
2025-03-13 17:41:32,345 [INFO]: 	Compute fast metrics 03/13/2025, 17:41:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.90it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-13 17:41:52,291 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9459 secs
2025-03-13 17:41:52,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9993 secs
2025-03-13 17:41:52,295 [INFO]: {
2025-03-13 17:41:52,295 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:52,295 [INFO]: 	index_param: efSearch=133
2025-03-13 17:41:52,295 [INFO]: 	index_path: knn.index
2025-03-13 17:41:52,295 [INFO]: 	size in bytes: 715754290
2025-03-13 17:41:52,295 [INFO]: 	avg_search_speed_ms: 7.222704740101203
2025-03-13 17:41:52,295 [INFO]: 	99p_search_speed_ms: 11.0138686047867
2025-03-13 17:41:52,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:52,295 [INFO]: 	nb vectors: 3638
2025-03-13 17:41:52,295 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:52,295 [INFO]: 	compression ratio: 0.9993092797250297
2025-03-13 17:41:52,295 [INFO]: }
2025-03-13 17:41:52,295 [INFO]: 	>>> Finished "Creating the index" in 69.0028 secs
2025-03-13 17:41:52,295 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0327 secs
2025-03-13 17:41:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 82008 [episode count 13/20]
[retrieval_preprocessing] for episode 2639 [episode count 14/20], we have num_retrieval=np.int64(3746) num_query=np.int64(169)
2025-03-13 17:41:55,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:56,452 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:56
2025-03-13 17:41:56,452 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1150.70it/s]
2025-03-13 17:41:56,476 [INFO]: There are 3746 embeddings of dim 49152
2025-03-13 17:41:56,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 17:41:56,476 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:56
2025-03-13 17:41:56,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:56,476 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:41:56,476 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:56,476 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:56,476 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:56
2025-03-13 17:41:56,476 [INFO]: 773.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:56,476 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:41:56,476 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:56
2025-03-13 17:41:56,476 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:56,476 [INFO]: 	Creating the index 03/13/2025, 17:41:56
2025-03-13 17:41:56,476 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:56
2025-03-13 17:41:56,477 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:41:56,477 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:56
2025-03-13 17:41:56,477 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:41:56,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.02it/s] 20%|██        | 3/15 [00:00<00:01,  8.99it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.86it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.07it/s] 60%|██████    | 9/15 [00:00<00:00, 10.21it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.13it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.18it/s]100%|██████████| 15/15 [00:04<00:00,  1.65it/s]100%|██████████| 15/15 [00:04<00:00,  3.22it/s]
2025-03-13 17:42:01,141 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:42:01
2025-03-13 17:42:37,936 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7941 secs
2025-03-13 17:42:37,936 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 17:42:37,936 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-13 17:43:10,283 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3462 secs
2025-03-13 17:43:10,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8090 secs
2025-03-13 17:43:10,287 [INFO]: {
2025-03-13 17:43:10,287 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:10,287 [INFO]: 	index_param: efSearch=250
2025-03-13 17:43:10,287 [INFO]: 	index_path: knn.index
2025-03-13 17:43:10,287 [INFO]: 	size in bytes: 737002690
2025-03-13 17:43:10,287 [INFO]: 	avg_search_speed_ms: 14.709061063298197
2025-03-13 17:43:10,287 [INFO]: 	99p_search_speed_ms: 32.442836742848165
2025-03-13 17:43:10,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:10,287 [INFO]: 	nb vectors: 3746
2025-03-13 17:43:10,287 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:10,287 [INFO]: 	compression ratio: 0.9993091992649308
2025-03-13 17:43:10,287 [INFO]: }
2025-03-13 17:43:10,287 [INFO]: 	>>> Finished "Creating the index" in 73.8104 secs
2025-03-13 17:43:10,287 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8351 secs
2025-03-13 17:43:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 2639 [episode count 14/20]
[retrieval_preprocessing] for episode 93820 [episode count 15/20], we have num_retrieval=np.int64(3715) num_query=np.int64(200)
2025-03-13 17:43:13,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:14,547 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:14
2025-03-13 17:43:14,548 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.07it/s]
2025-03-13 17:43:14,574 [INFO]: There are 3715 embeddings of dim 49152
2025-03-13 17:43:14,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 17:43:14,574 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:14
2025-03-13 17:43:14,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:14,574 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:43:14,574 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:14,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:43:14,574 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:14
2025-03-13 17:43:14,574 [INFO]: 766.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:14,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:43:14,574 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:14
2025-03-13 17:43:14,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:14,574 [INFO]: 	Creating the index 03/13/2025, 17:43:14
2025-03-13 17:43:14,574 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:14
2025-03-13 17:43:14,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:43:14,575 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:14
2025-03-13 17:43:14,576 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:43:14,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.09it/s] 20%|██        | 3/15 [00:00<00:01,  9.12it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.20it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.91it/s] 60%|██████    | 9/15 [00:00<00:00, 11.10it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.31it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.51it/s]100%|██████████| 15/15 [00:03<00:00,  2.01it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-13 17:43:18,492 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:18
2025-03-13 17:43:54,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9440 secs
2025-03-13 17:43:54,437 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 17:43:54,437 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.32it/s]
2025-03-13 17:44:37,385 [INFO]: 	>>> Finished "Compute fast metrics" in 42.9474 secs
2025-03-13 17:44:37,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8123 secs
2025-03-13 17:44:37,388 [INFO]: {
2025-03-13 17:44:37,388 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:37,388 [INFO]: 	index_param: efSearch=295
2025-03-13 17:44:37,388 [INFO]: 	index_path: knn.index
2025-03-13 17:44:37,388 [INFO]: 	size in bytes: 730903450
2025-03-13 17:44:37,388 [INFO]: 	avg_search_speed_ms: 12.58609686017552
2025-03-13 17:44:37,388 [INFO]: 	99p_search_speed_ms: 17.18084726482629
2025-03-13 17:44:37,388 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:37,388 [INFO]: 	nb vectors: 3715
2025-03-13 17:44:37,388 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:37,388 [INFO]: 	compression ratio: 0.999309443675495
2025-03-13 17:44:37,388 [INFO]: }
2025-03-13 17:44:37,388 [INFO]: 	>>> Finished "Creating the index" in 82.8138 secs
2025-03-13 17:44:37,388 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8406 secs
2025-03-13 17:44:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 93820 [episode count 15/20]
[retrieval_preprocessing] for episode 71316 [episode count 16/20], we have num_retrieval=np.int64(3698) num_query=np.int64(217)
2025-03-13 17:44:41,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:42,308 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:42
2025-03-13 17:44:42,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 823.06it/s]
2025-03-13 17:44:42,337 [INFO]: There are 3698 embeddings of dim 49152
2025-03-13 17:44:42,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 17:44:42,338 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:42
2025-03-13 17:44:42,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:42,339 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:44:42,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:42,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:44:42,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:42
2025-03-13 17:44:42,340 [INFO]: 763.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:42,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:44:42,340 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:42
2025-03-13 17:44:42,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:42,341 [INFO]: 	Creating the index 03/13/2025, 17:44:42
2025-03-13 17:44:42,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:42
2025-03-13 17:44:42,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:44:42,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:42
2025-03-13 17:44:42,344 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:44:42,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.91it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.39it/s] 20%|██        | 3/15 [00:00<00:01,  6.59it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.36it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.74it/s] 40%|████      | 6/15 [00:00<00:01,  7.85it/s] 47%|████▋     | 7/15 [00:00<00:01,  7.87it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.15it/s] 60%|██████    | 9/15 [00:01<00:00,  8.31it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.19it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.97it/s]100%|██████████| 15/15 [00:04<00:00,  1.63it/s]100%|██████████| 15/15 [00:04<00:00,  3.28it/s]
2025-03-13 17:44:46,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:44:46
2025-03-13 17:45:35,976 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0553 secs
2025-03-13 17:45:35,976 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:45:35,976 [INFO]: 	Compute fast metrics 03/13/2025, 17:45:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 17:46:02,203 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2263 secs
2025-03-13 17:46:02,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8621 secs
2025-03-13 17:46:02,206 [INFO]: {
2025-03-13 17:46:02,206 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:02,206 [INFO]: 	index_param: efSearch=169
2025-03-13 17:46:02,206 [INFO]: 	index_path: knn.index
2025-03-13 17:46:02,206 [INFO]: 	size in bytes: 727558810
2025-03-13 17:46:02,206 [INFO]: 	avg_search_speed_ms: 8.5750208451935
2025-03-13 17:46:02,206 [INFO]: 	99p_search_speed_ms: 12.689034559298307
2025-03-13 17:46:02,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:02,206 [INFO]: 	nb vectors: 3698
2025-03-13 17:46:02,206 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:02,206 [INFO]: 	compression ratio: 0.9993094358928868
2025-03-13 17:46:02,206 [INFO]: }
2025-03-13 17:46:02,206 [INFO]: 	>>> Finished "Creating the index" in 79.8655 secs
2025-03-13 17:46:02,206 [INFO]: >>> Finished "Launching the whole pipeline" in 79.8982 secs
2025-03-13 17:46:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 71316 [episode count 16/20]
[retrieval_preprocessing] for episode 80029 [episode count 17/20], we have num_retrieval=np.int64(3733) num_query=np.int64(182)
2025-03-13 17:46:05,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:05,827 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:05
2025-03-13 17:46:05,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.82it/s]
2025-03-13 17:46:05,852 [INFO]: There are 3733 embeddings of dim 49152
2025-03-13 17:46:05,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 17:46:05,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:05
2025-03-13 17:46:05,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:05,852 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:46:05,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:05,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:46:05,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:05
2025-03-13 17:46:05,852 [INFO]: 770.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:05,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:46:05,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:05
2025-03-13 17:46:05,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:05,852 [INFO]: 	Creating the index 03/13/2025, 17:46:05
2025-03-13 17:46:05,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:05
2025-03-13 17:46:05,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:46:05,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:05
2025-03-13 17:46:05,854 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:46:05,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.24it/s] 20%|██        | 3/15 [00:00<00:01,  9.43it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.40it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.76it/s] 60%|██████    | 9/15 [00:00<00:00, 11.26it/s] 73%|███████▎  | 11/15 [00:01<00:00, 11.51it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.39it/s]100%|██████████| 15/15 [00:04<00:00,  1.87it/s]100%|██████████| 15/15 [00:04<00:00,  3.62it/s]
2025-03-13 17:46:10,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:10
2025-03-13 17:46:48,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5089 secs
2025-03-13 17:46:48,515 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:46:48,515 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-13 17:47:15,608 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0929 secs
2025-03-13 17:47:15,611 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7571 secs
2025-03-13 17:47:15,611 [INFO]: {
2025-03-13 17:47:15,611 [INFO]: 	index_key: HNSW15
2025-03-13 17:47:15,611 [INFO]: 	index_param: efSearch=235
2025-03-13 17:47:15,611 [INFO]: 	index_path: knn.index
2025-03-13 17:47:15,611 [INFO]: 	size in bytes: 734445010
2025-03-13 17:47:15,611 [INFO]: 	avg_search_speed_ms: 11.447494603678567
2025-03-13 17:47:15,611 [INFO]: 	99p_search_speed_ms: 19.322533151134845
2025-03-13 17:47:15,611 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:47:15,611 [INFO]: 	nb vectors: 3733
2025-03-13 17:47:15,611 [INFO]: 	vectors dimension: 49152
2025-03-13 17:47:15,611 [INFO]: 	compression ratio: 0.9993092117270972
2025-03-13 17:47:15,611 [INFO]: }
2025-03-13 17:47:15,611 [INFO]: 	>>> Finished "Creating the index" in 69.7586 secs
2025-03-13 17:47:15,611 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7835 secs
2025-03-13 17:47:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:47:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 80029 [episode count 17/20]
[retrieval_preprocessing] for episode 39594 [episode count 18/20], we have num_retrieval=np.int64(3754) num_query=np.int64(161)
2025-03-13 17:47:18,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:47:19,493 [INFO]: Launching the whole pipeline 03/13/2025, 17:47:19
2025-03-13 17:47:19,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:47:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 17:47:19,862 [INFO]: There are 3754 embeddings of dim 49152
2025-03-13 17:47:19,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3689 secs
2025-03-13 17:47:19,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:47:19
2025-03-13 17:47:19,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:47:19,863 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 17:47:19,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:47:19,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:47:19,863 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:47:19
2025-03-13 17:47:19,863 [INFO]: 774.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:47:19,863 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:47:19,863 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:47:19
2025-03-13 17:47:19,863 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:47:19,863 [INFO]: 	Creating the index 03/13/2025, 17:47:19
2025-03-13 17:47:19,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:47:19
2025-03-13 17:47:19,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 17:47:19,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:47:19
2025-03-13 17:47:19,866 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:47:19,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.57it/s] 20%|██        | 3/15 [00:00<00:01,  9.34it/s] 40%|████      | 6/15 [00:00<00:00, 15.30it/s] 53%|█████▎    | 8/15 [00:00<00:00, 14.38it/s] 67%|██████▋   | 10/15 [00:00<00:00, 13.06it/s] 80%|████████  | 12/15 [00:00<00:00, 12.47it/s] 93%|█████████▎| 14/15 [00:01<00:00, 11.64it/s]100%|██████████| 15/15 [00:04<00:00,  3.14it/s]
2025-03-13 17:47:24,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:47:24
2025-03-13 17:48:01,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5571 secs
2025-03-13 17:48:01,213 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 17:48:01,213 [INFO]: 	Compute fast metrics 03/13/2025, 17:48:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.97it/s]
2025-03-13 17:48:34,047 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8333 secs
2025-03-13 17:48:34,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1843 secs
2025-03-13 17:48:34,050 [INFO]: {
2025-03-13 17:48:34,051 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:34,051 [INFO]: 	index_param: efSearch=269
2025-03-13 17:48:34,051 [INFO]: 	index_path: knn.index
2025-03-13 17:48:34,051 [INFO]: 	size in bytes: 738576670
2025-03-13 17:48:34,051 [INFO]: 	avg_search_speed_ms: 13.296839528769116
2025-03-13 17:48:34,051 [INFO]: 	99p_search_speed_ms: 25.58206419227645
2025-03-13 17:48:34,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:34,051 [INFO]: 	nb vectors: 3754
2025-03-13 17:48:34,051 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:34,051 [INFO]: 	compression ratio: 0.999309160415262
2025-03-13 17:48:34,051 [INFO]: }
2025-03-13 17:48:34,051 [INFO]: 	>>> Finished "Creating the index" in 74.1873 secs
2025-03-13 17:48:34,051 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5576 secs
2025-03-13 17:48:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 39594 [episode count 18/20]
[retrieval_preprocessing] for episode 30385 [episode count 19/20], we have num_retrieval=np.int64(3729) num_query=np.int64(186)
2025-03-13 17:48:39,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:39,824 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:39
2025-03-13 17:48:39,824 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.44it/s]
2025-03-13 17:48:39,852 [INFO]: There are 3729 embeddings of dim 49152
2025-03-13 17:48:39,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:48:39,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:39
2025-03-13 17:48:39,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:39,852 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 17:48:39,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:39,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:39,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:39
2025-03-13 17:48:39,852 [INFO]: 769.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:39,853 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:48:39,853 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:39
2025-03-13 17:48:39,853 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:39,853 [INFO]: 	Creating the index 03/13/2025, 17:48:39
2025-03-13 17:48:39,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:39
2025-03-13 17:48:39,854 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:48:39,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:39
2025-03-13 17:48:39,854 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 17:48:39,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.71it/s] 20%|██        | 3/15 [00:00<00:01,  8.21it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.73it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.06it/s] 40%|████      | 6/15 [00:00<00:00,  9.33it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.45it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.51it/s] 60%|██████    | 9/15 [00:01<00:00,  9.38it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.39it/s] 80%|████████  | 12/15 [00:01<00:00,  9.56it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.66it/s]100%|██████████| 15/15 [00:04<00:00,  1.36it/s]100%|██████████| 15/15 [00:04<00:00,  3.23it/s]
2025-03-13 17:48:44,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:44
2025-03-13 17:49:24,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4890 secs
2025-03-13 17:49:24,996 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 17:49:24,996 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.85it/s] 50%|█████     | 2/4 [00:00<00:00,  5.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.78it/s]
2025-03-13 17:49:44,314 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3179 secs
2025-03-13 17:49:44,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4631 secs
2025-03-13 17:49:44,317 [INFO]: {
2025-03-13 17:49:44,317 [INFO]: 	index_key: HNSW15
2025-03-13 17:49:44,317 [INFO]: 	index_param: efSearch=163
2025-03-13 17:49:44,317 [INFO]: 	index_path: knn.index
2025-03-13 17:49:44,317 [INFO]: 	size in bytes: 733657990
2025-03-13 17:49:44,317 [INFO]: 	avg_search_speed_ms: 7.669853750563461
2025-03-13 17:49:44,317 [INFO]: 	99p_search_speed_ms: 10.90397321386263
2025-03-13 17:49:44,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:49:44,317 [INFO]: 	nb vectors: 3729
2025-03-13 17:49:44,317 [INFO]: 	vectors dimension: 49152
2025-03-13 17:49:44,317 [INFO]: 	compression ratio: 0.9993092721582709
2025-03-13 17:49:44,318 [INFO]: }
2025-03-13 17:49:44,318 [INFO]: 	>>> Finished "Creating the index" in 64.4648 secs
2025-03-13 17:49:44,318 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4935 secs
2025-03-13 17:49:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:49:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 30385 [episode count 19/20]
2025-03-13 17:49:45: [retrieval_preprocessing] finished for 1712293193_remove_marker_from_mug [chosen_id count 4/196]
2025-03-13 17:49:48: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1730074336_wipe_table_with_yellow_towel [chosen_id count 5/196]
2025-03-13 17:49:48: [retrieval_preprocessing] we have num_total=2905 embedding_dim=49152
[retrieval_preprocessing] for episode 30212 [episode count 0/20], we have num_retrieval=np.int64(2749) num_query=np.int64(156)
2025-03-13 17:49:49,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:49:49,883 [INFO]: Launching the whole pipeline 03/13/2025, 17:49:49
2025-03-13 17:49:49,883 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:49:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2149.82it/s]
2025-03-13 17:49:49,907 [INFO]: There are 2749 embeddings of dim 49152
2025-03-13 17:49:49,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 17:49:49,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:49:49
2025-03-13 17:49:49,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:49:49,908 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:49:49,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:49:49,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:49:49,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:49:49
2025-03-13 17:49:49,908 [INFO]: 567.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:49:49,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:49:49,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:49:49
2025-03-13 17:49:49,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:49:49,909 [INFO]: 	Creating the index 03/13/2025, 17:49:49
2025-03-13 17:49:49,909 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:49:49
2025-03-13 17:49:49,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:49:49,912 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:49:49
2025-03-13 17:49:49,913 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:49:49,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.95it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.72it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.82it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.42it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.39it/s]100%|██████████| 11/11 [00:03<00:00,  2.10it/s]100%|██████████| 11/11 [00:03<00:00,  3.37it/s]
2025-03-13 17:49:53,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:53
2025-03-13 17:50:26,126 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9331 secs
2025-03-13 17:50:26,126 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 17:50:26,126 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 17:50:49,721 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5946 secs
2025-03-13 17:50:49,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8115 secs
2025-03-13 17:50:49,724 [INFO]: {
2025-03-13 17:50:49,724 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:49,724 [INFO]: 	index_param: efSearch=220
2025-03-13 17:50:49,724 [INFO]: 	index_path: knn.index
2025-03-13 17:50:49,724 [INFO]: 	size in bytes: 540848590
2025-03-13 17:50:49,724 [INFO]: 	avg_search_speed_ms: 11.32131286048766
2025-03-13 17:50:49,724 [INFO]: 	99p_search_speed_ms: 15.437561599537725
2025-03-13 17:50:49,724 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:49,724 [INFO]: 	nb vectors: 2749
2025-03-13 17:50:49,724 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:49,724 [INFO]: 	compression ratio: 0.9993099769382777
2025-03-13 17:50:49,724 [INFO]: }
2025-03-13 17:50:49,724 [INFO]: 	>>> Finished "Creating the index" in 59.8152 secs
2025-03-13 17:50:49,724 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8417 secs
2025-03-13 17:50:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 30212 [episode count 0/20]
[retrieval_preprocessing] for episode 8716 [episode count 1/20], we have num_retrieval=np.int64(2752) num_query=np.int64(153)
2025-03-13 17:50:54,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:54,795 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:54
2025-03-13 17:50:54,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.84it/s]
2025-03-13 17:50:54,820 [INFO]: There are 2752 embeddings of dim 49152
2025-03-13 17:50:54,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:50:54,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:54
2025-03-13 17:50:54,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:54,820 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:50:54,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:54,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:50:54,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:54
2025-03-13 17:50:54,821 [INFO]: 567.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:54,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:50:54,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:54
2025-03-13 17:50:54,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:54,821 [INFO]: 	Creating the index 03/13/2025, 17:50:54
2025-03-13 17:50:54,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:54
2025-03-13 17:50:54,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:50:54,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:54
2025-03-13 17:50:54,822 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:50:54,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.75it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.07it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.87it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.49it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.81it/s]100%|██████████| 11/11 [00:02<00:00,  2.55it/s]100%|██████████| 11/11 [00:02<00:00,  4.02it/s]
2025-03-13 17:50:57,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:57
2025-03-13 17:51:37,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4861 secs
2025-03-13 17:51:37,053 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 17:51:37,053 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
2025-03-13 17:51:59,584 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5314 secs
2025-03-13 17:51:59,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0591 secs
2025-03-13 17:51:59,881 [INFO]: {
2025-03-13 17:51:59,881 [INFO]: 	index_key: HNSW15
2025-03-13 17:51:59,881 [INFO]: 	index_param: efSearch=255
2025-03-13 17:51:59,881 [INFO]: 	index_path: knn.index
2025-03-13 17:51:59,882 [INFO]: 	size in bytes: 541438810
2025-03-13 17:51:59,882 [INFO]: 	avg_search_speed_ms: 11.36051948997192
2025-03-13 17:51:59,882 [INFO]: 	99p_search_speed_ms: 16.42255285987631
2025-03-13 17:51:59,882 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:59,882 [INFO]: 	nb vectors: 2752
2025-03-13 17:51:59,882 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:59,882 [INFO]: 	compression ratio: 0.9993099977447129
2025-03-13 17:51:59,882 [INFO]: }
2025-03-13 17:51:59,882 [INFO]: 	>>> Finished "Creating the index" in 65.0612 secs
2025-03-13 17:51:59,882 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0872 secs
2025-03-13 17:52:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 8716 [episode count 1/20]
[retrieval_preprocessing] for episode 94735 [episode count 2/20], we have num_retrieval=np.int64(2780) num_query=np.int64(125)
2025-03-13 17:52:02,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:02,994 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:02
2025-03-13 17:52:02,994 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 17:52:03,022 [INFO]: There are 2780 embeddings of dim 49152
2025-03-13 17:52:03,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 17:52:03,022 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:03,022 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:52:03,022 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:03,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:03,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,023 [INFO]: 573.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:03,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:03,023 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:03
2025-03-13 17:52:03,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:03,023 [INFO]: 	Creating the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:03
2025-03-13 17:52:03,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:52:03,024 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:03
2025-03-13 17:52:03,024 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:52:03,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.06it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.39it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.61it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.92it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.89it/s]100%|██████████| 11/11 [00:03<00:00,  2.29it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-13 17:52:06,056 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:06
2025-03-13 17:52:57,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0913 secs
2025-03-13 17:52:57,148 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 17:52:57,148 [INFO]: 	Compute fast metrics 03/13/2025, 17:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-13 17:53:18,297 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1483 secs
2025-03-13 17:53:18,299 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2749 secs
2025-03-13 17:53:18,300 [INFO]: {
2025-03-13 17:53:18,300 [INFO]: 	index_key: HNSW15
2025-03-13 17:53:18,300 [INFO]: 	index_param: efSearch=182
2025-03-13 17:53:18,300 [INFO]: 	index_path: knn.index
2025-03-13 17:53:18,300 [INFO]: 	size in bytes: 546947710
2025-03-13 17:53:18,300 [INFO]: 	avg_search_speed_ms: 10.456200591171605
2025-03-13 17:53:18,300 [INFO]: 	99p_search_speed_ms: 16.904763225466013
2025-03-13 17:53:18,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:53:18,300 [INFO]: 	nb vectors: 2780
2025-03-13 17:53:18,300 [INFO]: 	vectors dimension: 49152
2025-03-13 17:53:18,300 [INFO]: 	compression ratio: 0.9993098609005969
2025-03-13 17:53:18,300 [INFO]: }
2025-03-13 17:53:18,300 [INFO]: 	>>> Finished "Creating the index" in 75.2772 secs
2025-03-13 17:53:18,300 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3057 secs
2025-03-13 17:53:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:53:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 94735 [episode count 2/20]
[retrieval_preprocessing] for episode 61463 [episode count 3/20], we have num_retrieval=np.int64(2757) num_query=np.int64(148)
2025-03-13 17:53:20,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:53:21,580 [INFO]: Launching the whole pipeline 03/13/2025, 17:53:21
2025-03-13 17:53:21,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:53:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1674.37it/s]
2025-03-13 17:53:21,607 [INFO]: There are 2757 embeddings of dim 49152
2025-03-13 17:53:21,607 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 17:53:21,607 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:53:21
2025-03-13 17:53:21,608 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:53:21,608 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:53:21,608 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:53:21,608 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:53:21,608 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:53:21
2025-03-13 17:53:21,608 [INFO]: 569.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:53:21,608 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:53:21,608 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:53:21
2025-03-13 17:53:21,608 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:53:21,608 [INFO]: 	Creating the index 03/13/2025, 17:53:21
2025-03-13 17:53:21,608 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:53:21
2025-03-13 17:53:21,609 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:53:21,609 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:53:21
2025-03-13 17:53:21,609 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:53:21,609 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.16it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.17it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.43it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.26it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.12it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.33it/s]100%|██████████| 11/11 [00:03<00:00,  3.62it/s]
2025-03-13 17:53:24,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:53:24
2025-03-13 17:54:07,975 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3188 secs
2025-03-13 17:54:07,975 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:54:07,975 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 17:54:25,458 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4824 secs
2025-03-13 17:54:25,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8507 secs
2025-03-13 17:54:25,460 [INFO]: {
2025-03-13 17:54:25,460 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:25,460 [INFO]: 	index_param: efSearch=207
2025-03-13 17:54:25,460 [INFO]: 	index_path: knn.index
2025-03-13 17:54:25,460 [INFO]: 	size in bytes: 542422510
2025-03-13 17:54:25,460 [INFO]: 	avg_search_speed_ms: 10.609919017907686
2025-03-13 17:54:25,460 [INFO]: 	99p_search_speed_ms: 14.90740783046932
2025-03-13 17:54:25,460 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:25,460 [INFO]: 	nb vectors: 2757
2025-03-13 17:54:25,460 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:25,460 [INFO]: 	compression ratio: 0.9993100323214831
2025-03-13 17:54:25,460 [INFO]: }
2025-03-13 17:54:25,460 [INFO]: 	>>> Finished "Creating the index" in 63.8522 secs
2025-03-13 17:54:25,460 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8800 secs
2025-03-13 17:54:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 61463 [episode count 3/20]
[retrieval_preprocessing] for episode 19997 [episode count 4/20], we have num_retrieval=np.int64(2742) num_query=np.int64(163)
2025-03-13 17:54:27,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:28,176 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:28
2025-03-13 17:54:28,177 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1827.58it/s]
2025-03-13 17:54:28,201 [INFO]: There are 2742 embeddings of dim 49152
2025-03-13 17:54:28,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 17:54:28,201 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:28
2025-03-13 17:54:28,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:28,201 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:54:28,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:28,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:28,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:28
2025-03-13 17:54:28,201 [INFO]: 565.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:28,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:54:28,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:28
2025-03-13 17:54:28,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:28,201 [INFO]: 	Creating the index 03/13/2025, 17:54:28
2025-03-13 17:54:28,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:28
2025-03-13 17:54:28,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:54:28,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:28
2025-03-13 17:54:28,203 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:54:28,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.48it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.69it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.67it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.10it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.39it/s]100%|██████████| 11/11 [00:03<00:00,  2.24it/s]100%|██████████| 11/11 [00:03<00:00,  3.59it/s]
2025-03-13 17:54:31,274 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:31
2025-03-13 17:55:15,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1985 secs
2025-03-13 17:55:15,474 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 17:55:15,474 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.74it/s]
2025-03-13 17:55:38,040 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5659 secs
2025-03-13 17:55:39,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0360 secs
2025-03-13 17:55:39,239 [INFO]: {
2025-03-13 17:55:39,239 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:39,239 [INFO]: 	index_param: efSearch=204
2025-03-13 17:55:39,239 [INFO]: 	index_path: knn.index
2025-03-13 17:55:39,240 [INFO]: 	size in bytes: 539471410
2025-03-13 17:55:39,240 [INFO]: 	avg_search_speed_ms: 10.891529586123534
2025-03-13 17:55:39,240 [INFO]: 	99p_search_speed_ms: 20.819930592551827
2025-03-13 17:55:39,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:39,240 [INFO]: 	nb vectors: 2742
2025-03-13 17:55:39,240 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:39,240 [INFO]: 	compression ratio: 0.9993099282128779
2025-03-13 17:55:39,240 [INFO]: }
2025-03-13 17:55:39,240 [INFO]: 	>>> Finished "Creating the index" in 71.0387 secs
2025-03-13 17:55:39,240 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0637 secs
2025-03-13 17:55:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 19997 [episode count 4/20]
[retrieval_preprocessing] for episode 59427 [episode count 5/20], we have num_retrieval=np.int64(2721) num_query=np.int64(184)
2025-03-13 17:55:41,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:41,787 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:41
2025-03-13 17:55:41,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.20it/s]
2025-03-13 17:55:41,817 [INFO]: There are 2721 embeddings of dim 49152
2025-03-13 17:55:41,817 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:55:41,817 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:41
2025-03-13 17:55:41,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:41,817 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:55:41,817 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:55:41,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:55:41,817 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:41
2025-03-13 17:55:41,817 [INFO]: 561.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:41,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:55:41,818 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:41
2025-03-13 17:55:41,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:41,818 [INFO]: 	Creating the index 03/13/2025, 17:55:41
2025-03-13 17:55:41,818 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:55:41
2025-03-13 17:55:41,819 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:55:41,819 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:41
2025-03-13 17:55:41,819 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:55:41,819 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.50it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.80it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.21it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.83it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.00it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.17it/s]100%|██████████| 11/11 [00:03<00:00,  1.95it/s]100%|██████████| 11/11 [00:03<00:00,  3.41it/s]
2025-03-13 17:55:45,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:55:45
2025-03-13 17:56:18,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3764 secs
2025-03-13 17:56:18,435 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 17:56:18,435 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 17:56:34,642 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2071 secs
2025-03-13 17:56:34,645 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8255 secs
2025-03-13 17:56:34,645 [INFO]: {
2025-03-13 17:56:34,645 [INFO]: 	index_key: HNSW15
2025-03-13 17:56:34,645 [INFO]: 	index_param: efSearch=210
2025-03-13 17:56:34,645 [INFO]: 	index_path: knn.index
2025-03-13 17:56:34,645 [INFO]: 	size in bytes: 535339870
2025-03-13 17:56:34,645 [INFO]: 	avg_search_speed_ms: 10.636929686656817
2025-03-13 17:56:34,645 [INFO]: 	99p_search_speed_ms: 15.857080505229534
2025-03-13 17:56:34,645 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:56:34,645 [INFO]: 	nb vectors: 2721
2025-03-13 17:56:34,645 [INFO]: 	vectors dimension: 49152
2025-03-13 17:56:34,645 [INFO]: 	compression ratio: 0.9993097805325054
2025-03-13 17:56:34,645 [INFO]: }
2025-03-13 17:56:34,645 [INFO]: 	>>> Finished "Creating the index" in 52.8272 secs
2025-03-13 17:56:34,645 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8573 secs
2025-03-13 17:56:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:56:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 59427 [episode count 5/20]
[retrieval_preprocessing] for episode 78402 [episode count 6/20], we have num_retrieval=np.int64(2795) num_query=np.int64(110)
2025-03-13 17:56:37,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:38,385 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:38
2025-03-13 17:56:38,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.49it/s]
2025-03-13 17:56:38,414 [INFO]: There are 2795 embeddings of dim 49152
2025-03-13 17:56:38,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:56:38,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:38
2025-03-13 17:56:38,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:38,415 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:56:38,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:38,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:56:38,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:38
2025-03-13 17:56:38,416 [INFO]: 576.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:38,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:56:38,417 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:38
2025-03-13 17:56:38,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:38,417 [INFO]: 	Creating the index 03/13/2025, 17:56:38
2025-03-13 17:56:38,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:38
2025-03-13 17:56:38,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:56:38,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:38
2025-03-13 17:56:38,421 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:56:38,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.28it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.89it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.59it/s] 50%|█████     | 6/12 [00:00<00:00,  9.65it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.71it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.03it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.49it/s]100%|██████████| 12/12 [00:03<00:00,  3.72it/s]
2025-03-13 17:56:41,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:41
2025-03-13 17:57:18,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8933 secs
2025-03-13 17:57:18,549 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 17:57:18,549 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-13 17:57:46,645 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0964 secs
2025-03-13 17:57:46,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2268 secs
2025-03-13 17:57:46,648 [INFO]: {
2025-03-13 17:57:46,648 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:46,648 [INFO]: 	index_param: efSearch=259
2025-03-13 17:57:46,648 [INFO]: 	index_path: knn.index
2025-03-13 17:57:46,648 [INFO]: 	size in bytes: 549898870
2025-03-13 17:57:46,648 [INFO]: 	avg_search_speed_ms: 12.44467567242404
2025-03-13 17:57:46,648 [INFO]: 	99p_search_speed_ms: 19.289873263332996
2025-03-13 17:57:46,648 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:46,648 [INFO]: 	nb vectors: 2795
2025-03-13 17:57:46,648 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:46,648 [INFO]: 	compression ratio: 0.9993098549193237
2025-03-13 17:57:46,648 [INFO]: }
2025-03-13 17:57:46,648 [INFO]: 	>>> Finished "Creating the index" in 68.2306 secs
2025-03-13 17:57:46,648 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2631 secs
2025-03-13 17:57:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 78402 [episode count 6/20]
[retrieval_preprocessing] for episode 71255 [episode count 7/20], we have num_retrieval=np.int64(2751) num_query=np.int64(154)
2025-03-13 17:57:49,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:49,524 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:49
2025-03-13 17:57:49,524 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.90it/s]
2025-03-13 17:57:49,547 [INFO]: There are 2751 embeddings of dim 49152
2025-03-13 17:57:49,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 17:57:49,547 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:49,547 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:57:49,547 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:49,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:57:49,547 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,548 [INFO]: 567.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:49,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:57:49,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:49
2025-03-13 17:57:49,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:49,548 [INFO]: 	Creating the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:49
2025-03-13 17:57:49,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:57:49,549 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:49
2025-03-13 17:57:49,549 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:49,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.46it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.80it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.88it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.52it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.57it/s]100%|██████████| 11/11 [00:03<00:00,  1.90it/s]100%|██████████| 11/11 [00:03<00:00,  3.10it/s]
2025-03-13 17:57:53,102 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:53
2025-03-13 17:58:38,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2252 secs
2025-03-13 17:58:38,328 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 17:58:38,328 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 17:59:07,708 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3798 secs
2025-03-13 17:59:07,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1616 secs
2025-03-13 17:59:07,710 [INFO]: {
2025-03-13 17:59:07,710 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:07,711 [INFO]: 	index_param: efSearch=217
2025-03-13 17:59:07,711 [INFO]: 	index_path: knn.index
2025-03-13 17:59:07,711 [INFO]: 	size in bytes: 541242070
2025-03-13 17:59:07,711 [INFO]: 	avg_search_speed_ms: 10.167421800996806
2025-03-13 17:59:07,711 [INFO]: 	99p_search_speed_ms: 13.554745616856959
2025-03-13 17:59:07,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:07,711 [INFO]: 	nb vectors: 2751
2025-03-13 17:59:07,711 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:07,711 [INFO]: 	compression ratio: 0.9993099908142765
2025-03-13 17:59:07,711 [INFO]: }
2025-03-13 17:59:07,711 [INFO]: 	>>> Finished "Creating the index" in 78.1630 secs
2025-03-13 17:59:07,711 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1869 secs
2025-03-13 17:59:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 71255 [episode count 7/20]
[retrieval_preprocessing] for episode 1126 [episode count 8/20], we have num_retrieval=np.int64(2691) num_query=np.int64(214)
2025-03-13 17:59:09,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:10,331 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:10
2025-03-13 17:59:10,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1782.53it/s]
2025-03-13 17:59:10,360 [INFO]: There are 2691 embeddings of dim 49152
2025-03-13 17:59:10,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 17:59:10,360 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,361 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:10,361 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:59:10,361 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:10,361 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:59:10,361 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,361 [INFO]: 555.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:10,362 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:59:10,362 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:10
2025-03-13 17:59:10,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:10,362 [INFO]: 	Creating the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,362 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:10
2025-03-13 17:59:10,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:59:10,366 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:10
2025-03-13 17:59:10,366 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:59:10,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.42it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.66it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.57it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.88it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.31it/s]100%|██████████| 11/11 [00:03<00:00,  2.03it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 17:59:13,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:13
2025-03-13 17:59:49,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1508 secs
2025-03-13 17:59:49,853 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 17:59:49,853 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 18:00:14,826 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9730 secs
2025-03-13 18:00:14,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4627 secs
2025-03-13 18:00:14,829 [INFO]: {
2025-03-13 18:00:14,829 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:14,829 [INFO]: 	index_param: efSearch=175
2025-03-13 18:00:14,829 [INFO]: 	index_path: knn.index
2025-03-13 18:00:14,829 [INFO]: 	size in bytes: 529437550
2025-03-13 18:00:14,829 [INFO]: 	avg_search_speed_ms: 8.680023410003438
2025-03-13 18:00:14,829 [INFO]: 	99p_search_speed_ms: 17.26076344028116
2025-03-13 18:00:14,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:14,829 [INFO]: 	nb vectors: 2691
2025-03-13 18:00:14,829 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:14,829 [INFO]: 	compression ratio: 0.9993097920614056
2025-03-13 18:00:14,829 [INFO]: }
2025-03-13 18:00:14,829 [INFO]: 	>>> Finished "Creating the index" in 64.4665 secs
2025-03-13 18:00:14,829 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4980 secs
2025-03-13 18:00:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 1126 [episode count 8/20]
[retrieval_preprocessing] for episode 88194 [episode count 9/20], we have num_retrieval=np.int64(2778) num_query=np.int64(127)
2025-03-13 18:00:17,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:17,648 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:17
2025-03-13 18:00:17,648 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.98it/s]
2025-03-13 18:00:17,671 [INFO]: There are 2778 embeddings of dim 49152
2025-03-13 18:00:17,672 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:00:17,672 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:17
2025-03-13 18:00:17,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:17,672 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:00:17,672 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:17,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:00:17,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:17
2025-03-13 18:00:17,672 [INFO]: 573.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:17,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:00:17,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:17
2025-03-13 18:00:17,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:17,672 [INFO]: 	Creating the index 03/13/2025, 18:00:17
2025-03-13 18:00:17,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:17
2025-03-13 18:00:17,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:00:17,673 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:17
2025-03-13 18:00:17,673 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:00:17,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.04it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.53it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.23it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.86it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.46it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.93it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.19it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.40it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.37it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.95it/s]100%|██████████| 11/11 [00:03<00:00,  1.29it/s]100%|██████████| 11/11 [00:03<00:00,  3.16it/s]
2025-03-13 18:00:21,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:21
2025-03-13 18:01:02,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2685 secs
2025-03-13 18:01:02,429 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:01:02,429 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 18:01:26,422 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9925 secs
2025-03-13 18:01:26,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7509 secs
2025-03-13 18:01:26,424 [INFO]: {
2025-03-13 18:01:26,424 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:26,424 [INFO]: 	index_param: efSearch=213
2025-03-13 18:01:26,424 [INFO]: 	index_path: knn.index
2025-03-13 18:01:26,424 [INFO]: 	size in bytes: 546554230
2025-03-13 18:01:26,424 [INFO]: 	avg_search_speed_ms: 10.638998817662372
2025-03-13 18:01:26,424 [INFO]: 	99p_search_speed_ms: 17.473596537020068
2025-03-13 18:01:26,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:26,425 [INFO]: 	nb vectors: 2778
2025-03-13 18:01:26,425 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:26,425 [INFO]: 	compression ratio: 0.9993098470759251
2025-03-13 18:01:26,425 [INFO]: }
2025-03-13 18:01:26,425 [INFO]: 	>>> Finished "Creating the index" in 68.7523 secs
2025-03-13 18:01:26,425 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7767 secs
2025-03-13 18:01:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 88194 [episode count 9/20]
[retrieval_preprocessing] for episode 75400 [episode count 10/20], we have num_retrieval=np.int64(2751) num_query=np.int64(154)
2025-03-13 18:01:28,262 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:28,728 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:28
2025-03-13 18:01:28,728 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.86it/s]
2025-03-13 18:01:28,754 [INFO]: There are 2751 embeddings of dim 49152
2025-03-13 18:01:28,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:01:28,754 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:28,754 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:01:28,754 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:28,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:28,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,754 [INFO]: 567.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:28,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:01:28,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:28
2025-03-13 18:01:28,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:28,755 [INFO]: 	Creating the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,755 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:28
2025-03-13 18:01:28,756 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:01:28,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:28
2025-03-13 18:01:28,756 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:01:28,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.47it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.88it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.26it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.89it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.40it/s]100%|██████████| 11/11 [00:03<00:00,  2.27it/s]100%|██████████| 11/11 [00:03<00:00,  3.61it/s]
2025-03-13 18:01:31,814 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:31
2025-03-13 18:02:14,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6236 secs
2025-03-13 18:02:14,438 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 18:02:14,438 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 18:02:37,282 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8431 secs
2025-03-13 18:02:37,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5280 secs
2025-03-13 18:02:37,284 [INFO]: {
2025-03-13 18:02:37,284 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:37,284 [INFO]: 	index_param: efSearch=196
2025-03-13 18:02:37,284 [INFO]: 	index_path: knn.index
2025-03-13 18:02:37,284 [INFO]: 	size in bytes: 541242070
2025-03-13 18:02:37,284 [INFO]: 	avg_search_speed_ms: 9.180133001998477
2025-03-13 18:02:37,284 [INFO]: 	99p_search_speed_ms: 13.778016490396109
2025-03-13 18:02:37,284 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:37,284 [INFO]: 	nb vectors: 2751
2025-03-13 18:02:37,284 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:37,284 [INFO]: 	compression ratio: 0.9993099908142765
2025-03-13 18:02:37,284 [INFO]: }
2025-03-13 18:02:37,284 [INFO]: 	>>> Finished "Creating the index" in 68.5297 secs
2025-03-13 18:02:37,284 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5562 secs
2025-03-13 18:02:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 75400 [episode count 10/20]
[retrieval_preprocessing] for episode 29856 [episode count 11/20], we have num_retrieval=np.int64(2797) num_query=np.int64(108)
2025-03-13 18:02:39,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:39,840 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:39
2025-03-13 18:02:39,840 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-13 18:02:39,866 [INFO]: There are 2797 embeddings of dim 49152
2025-03-13 18:02:39,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:02:39,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:39,866 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:02:39,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:39,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:02:39,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,867 [INFO]: 577.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:39,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:02:39,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:39
2025-03-13 18:02:39,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:39,867 [INFO]: 	Creating the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,867 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:39
2025-03-13 18:02:39,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:02:39,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:39
2025-03-13 18:02:39,869 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:02:39,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.04it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.50it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.17it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.70it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.90it/s] 50%|█████     | 6/12 [00:00<00:00,  7.98it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.03it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.01it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.91it/s]100%|██████████| 12/12 [00:03<00:00,  2.14it/s]100%|██████████| 12/12 [00:03<00:00,  3.72it/s]
2025-03-13 18:02:43,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:43
2025-03-13 18:03:15,704 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6028 secs
2025-03-13 18:03:15,704 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:03:15,704 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 18:03:33,369 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6648 secs
2025-03-13 18:03:33,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5032 secs
2025-03-13 18:03:33,372 [INFO]: {
2025-03-13 18:03:33,372 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:33,372 [INFO]: 	index_param: efSearch=160
2025-03-13 18:03:33,372 [INFO]: 	index_path: knn.index
2025-03-13 18:03:33,372 [INFO]: 	size in bytes: 550292350
2025-03-13 18:03:33,372 [INFO]: 	avg_search_speed_ms: 8.999127455174749
2025-03-13 18:03:33,372 [INFO]: 	99p_search_speed_ms: 17.563160951249344
2025-03-13 18:03:33,372 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:33,372 [INFO]: 	nb vectors: 2797
2025-03-13 18:03:33,372 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:33,372 [INFO]: 	compression ratio: 0.9993098686543617
2025-03-13 18:03:33,372 [INFO]: }
2025-03-13 18:03:33,372 [INFO]: 	>>> Finished "Creating the index" in 53.5050 secs
2025-03-13 18:03:33,372 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5319 secs
2025-03-13 18:03:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 29856 [episode count 11/20]
[retrieval_preprocessing] for episode 70823 [episode count 12/20], we have num_retrieval=np.int64(2758) num_query=np.int64(147)
2025-03-13 18:03:35,195 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:35,626 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:35
2025-03-13 18:03:35,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.33it/s]
2025-03-13 18:03:35,653 [INFO]: There are 2758 embeddings of dim 49152
2025-03-13 18:03:35,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:03:35,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:35
2025-03-13 18:03:35,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:35,654 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:03:35,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:35,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:35,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:35
2025-03-13 18:03:35,654 [INFO]: 569.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:35,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:03:35,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:35
2025-03-13 18:03:35,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:35,654 [INFO]: 	Creating the index 03/13/2025, 18:03:35
2025-03-13 18:03:35,654 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:35
2025-03-13 18:03:35,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:03:35,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:35
2025-03-13 18:03:35,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:03:35,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.64it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.14it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.24it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.51it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.78it/s]100%|██████████| 11/11 [00:03<00:00,  1.95it/s]100%|██████████| 11/11 [00:03<00:00,  3.17it/s]
2025-03-13 18:03:39,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:39
2025-03-13 18:04:14,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3103 secs
2025-03-13 18:04:14,442 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:04:14,442 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-13 18:04:39,701 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2585 secs
2025-03-13 18:04:39,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0476 secs
2025-03-13 18:04:39,703 [INFO]: {
2025-03-13 18:04:39,703 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:39,703 [INFO]: 	index_param: efSearch=228
2025-03-13 18:04:39,703 [INFO]: 	index_path: knn.index
2025-03-13 18:04:39,703 [INFO]: 	size in bytes: 542619250
2025-03-13 18:04:39,703 [INFO]: 	avg_search_speed_ms: 11.782996204009255
2025-03-13 18:04:39,703 [INFO]: 	99p_search_speed_ms: 22.96909806318581
2025-03-13 18:04:39,703 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:39,703 [INFO]: 	nb vectors: 2758
2025-03-13 18:04:39,703 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:39,703 [INFO]: 	compression ratio: 0.9993100392217932
2025-03-13 18:04:39,703 [INFO]: }
2025-03-13 18:04:39,703 [INFO]: 	>>> Finished "Creating the index" in 64.0493 secs
2025-03-13 18:04:39,703 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0770 secs
2025-03-13 18:04:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 70823 [episode count 12/20]
[retrieval_preprocessing] for episode 86760 [episode count 13/20], we have num_retrieval=np.int64(2786) num_query=np.int64(119)
2025-03-13 18:04:42,193 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:42,645 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:42
2025-03-13 18:04:42,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1758.62it/s]
2025-03-13 18:04:42,679 [INFO]: There are 2786 embeddings of dim 49152
2025-03-13 18:04:42,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 18:04:42,679 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:42
2025-03-13 18:04:42,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:42,679 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:04:42,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:42,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:04:42,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:42
2025-03-13 18:04:42,679 [INFO]: 575.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:42,680 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:04:42,680 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:42
2025-03-13 18:04:42,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:42,680 [INFO]: 	Creating the index 03/13/2025, 18:04:42
2025-03-13 18:04:42,680 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:42
2025-03-13 18:04:42,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:04:42,682 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:42
2025-03-13 18:04:42,682 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:04:42,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.93it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.51it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.75it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.75it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.64it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.58it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.52it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.46it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.38it/s]100%|██████████| 11/11 [00:03<00:00,  1.28it/s]100%|██████████| 11/11 [00:03<00:00,  3.15it/s]
2025-03-13 18:04:46,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:46
2025-03-13 18:05:27,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9923 secs
2025-03-13 18:05:27,173 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 18:05:27,174 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-13 18:05:50,128 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9542 secs
2025-03-13 18:05:50,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4485 secs
2025-03-13 18:05:50,130 [INFO]: {
2025-03-13 18:05:50,130 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:50,130 [INFO]: 	index_param: efSearch=210
2025-03-13 18:05:50,130 [INFO]: 	index_path: knn.index
2025-03-13 18:05:50,130 [INFO]: 	size in bytes: 548128150
2025-03-13 18:05:50,130 [INFO]: 	avg_search_speed_ms: 9.804582148881666
2025-03-13 18:05:50,130 [INFO]: 	99p_search_speed_ms: 13.90154954278841
2025-03-13 18:05:50,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:50,130 [INFO]: 	nb vectors: 2786
2025-03-13 18:05:50,130 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:50,130 [INFO]: 	compression ratio: 0.9993099022555219
2025-03-13 18:05:50,130 [INFO]: }
2025-03-13 18:05:50,130 [INFO]: 	>>> Finished "Creating the index" in 67.4507 secs
2025-03-13 18:05:50,130 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4853 secs
2025-03-13 18:05:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 86760 [episode count 13/20]
[retrieval_preprocessing] for episode 66830 [episode count 14/20], we have num_retrieval=np.int64(2755) num_query=np.int64(150)
2025-03-13 18:05:52,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:52,602 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:52
2025-03-13 18:05:52,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1121.77it/s]
2025-03-13 18:05:52,632 [INFO]: There are 2755 embeddings of dim 49152
2025-03-13 18:05:52,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:05:52,633 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:52
2025-03-13 18:05:52,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:52,633 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:05:52,634 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:52,634 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 18:05:52,634 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:52
2025-03-13 18:05:52,635 [INFO]: 568.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:52,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:05:52,635 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:52
2025-03-13 18:05:52,635 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:52,636 [INFO]: 	Creating the index 03/13/2025, 18:05:52
2025-03-13 18:05:52,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:52
2025-03-13 18:05:52,641 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0050 secs
2025-03-13 18:05:52,642 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:52
2025-03-13 18:05:52,642 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:05:52,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.91it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.95it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.05it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.68it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.17it/s]100%|██████████| 11/11 [00:03<00:00,  2.22it/s]100%|██████████| 11/11 [00:03<00:00,  3.54it/s]
2025-03-13 18:05:55,759 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:55
2025-03-13 18:06:32,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3723 secs
2025-03-13 18:06:32,132 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 18:06:32,132 [INFO]: 	Compute fast metrics 03/13/2025, 18:06:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s]
2025-03-13 18:06:59,171 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0383 secs
2025-03-13 18:06:59,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5319 secs
2025-03-13 18:06:59,174 [INFO]: {
2025-03-13 18:06:59,174 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:59,174 [INFO]: 	index_param: efSearch=225
2025-03-13 18:06:59,174 [INFO]: 	index_path: knn.index
2025-03-13 18:06:59,174 [INFO]: 	size in bytes: 542029030
2025-03-13 18:06:59,174 [INFO]: 	avg_search_speed_ms: 11.049368955599963
2025-03-13 18:06:59,174 [INFO]: 	99p_search_speed_ms: 21.183388598728992
2025-03-13 18:06:59,174 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:59,174 [INFO]: 	nb vectors: 2755
2025-03-13 18:06:59,174 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:59,174 [INFO]: 	compression ratio: 0.9993100185058353
2025-03-13 18:06:59,174 [INFO]: }
2025-03-13 18:06:59,174 [INFO]: 	>>> Finished "Creating the index" in 66.5383 secs
2025-03-13 18:06:59,174 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5719 secs
2025-03-13 18:07:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 66830 [episode count 14/20]
[retrieval_preprocessing] for episode 11539 [episode count 15/20], we have num_retrieval=np.int64(2772) num_query=np.int64(133)
2025-03-13 18:07:02,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:02,540 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:02
2025-03-13 18:07:02,541 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.35it/s]
2025-03-13 18:07:02,579 [INFO]: There are 2772 embeddings of dim 49152
2025-03-13 18:07:02,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 18:07:02,579 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:02
2025-03-13 18:07:02,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:02,580 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:07:02,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:02,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:07:02,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:02
2025-03-13 18:07:02,580 [INFO]: 572.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:02,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:07:02,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:02
2025-03-13 18:07:02,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:02,580 [INFO]: 	Creating the index 03/13/2025, 18:07:02
2025-03-13 18:07:02,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:02
2025-03-13 18:07:02,583 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:07:02,583 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:02
2025-03-13 18:07:02,583 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:07:02,583 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.37it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.28it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.78it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.08it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.33it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.57it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.64it/s]100%|██████████| 11/11 [00:03<00:00,  1.68it/s]100%|██████████| 11/11 [00:03<00:00,  3.10it/s]
2025-03-13 18:07:06,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:06
2025-03-13 18:07:43,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5604 secs
2025-03-13 18:07:43,700 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:07:43,700 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s]
2025-03-13 18:08:01,602 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9022 secs
2025-03-13 18:08:02,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4218 secs
2025-03-13 18:08:02,005 [INFO]: {
2025-03-13 18:08:02,005 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:02,005 [INFO]: 	index_param: efSearch=208
2025-03-13 18:08:02,005 [INFO]: 	index_path: knn.index
2025-03-13 18:08:02,005 [INFO]: 	size in bytes: 545373790
2025-03-13 18:08:02,005 [INFO]: 	avg_search_speed_ms: 8.866961369850733
2025-03-13 18:08:02,005 [INFO]: 	99p_search_speed_ms: 12.044180312659591
2025-03-13 18:08:02,006 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:02,006 [INFO]: 	nb vectors: 2772
2025-03-13 18:08:02,006 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:02,006 [INFO]: 	compression ratio: 0.999309805482218
2025-03-13 18:08:02,006 [INFO]: }
2025-03-13 18:08:02,006 [INFO]: 	>>> Finished "Creating the index" in 59.4254 secs
2025-03-13 18:08:02,006 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4653 secs
2025-03-13 18:08:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 11539 [episode count 15/20]
[retrieval_preprocessing] for episode 10543 [episode count 16/20], we have num_retrieval=np.int64(2778) num_query=np.int64(127)
2025-03-13 18:08:04,141 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:04,610 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:04
2025-03-13 18:08:04,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.62it/s]
2025-03-13 18:08:04,635 [INFO]: There are 2778 embeddings of dim 49152
2025-03-13 18:08:04,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 18:08:04,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:04
2025-03-13 18:08:04,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:04,635 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:08:04,635 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:04,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:04,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:04
2025-03-13 18:08:04,636 [INFO]: 573.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:04,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:08:04,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:04
2025-03-13 18:08:04,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:04,636 [INFO]: 	Creating the index 03/13/2025, 18:08:04
2025-03-13 18:08:04,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:04
2025-03-13 18:08:04,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:08:04,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:04
2025-03-13 18:08:04,637 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:08:04,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.42it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.67it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.75it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.09it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.30it/s]100%|██████████| 11/11 [00:02<00:00,  2.42it/s]100%|██████████| 11/11 [00:02<00:00,  3.83it/s]
2025-03-13 18:08:07,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:07
2025-03-13 18:08:44,427 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9059 secs
2025-03-13 18:08:44,427 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 18:08:44,428 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s]
2025-03-13 18:09:10,122 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6937 secs
2025-03-13 18:09:10,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4874 secs
2025-03-13 18:09:10,125 [INFO]: {
2025-03-13 18:09:10,125 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:10,125 [INFO]: 	index_param: efSearch=236
2025-03-13 18:09:10,125 [INFO]: 	index_path: knn.index
2025-03-13 18:09:10,125 [INFO]: 	size in bytes: 546554230
2025-03-13 18:09:10,125 [INFO]: 	avg_search_speed_ms: 10.916168060037815
2025-03-13 18:09:10,125 [INFO]: 	99p_search_speed_ms: 18.179489835165448
2025-03-13 18:09:10,125 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:10,125 [INFO]: 	nb vectors: 2778
2025-03-13 18:09:10,125 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:10,125 [INFO]: 	compression ratio: 0.9993098470759251
2025-03-13 18:09:10,125 [INFO]: }
2025-03-13 18:09:10,125 [INFO]: 	>>> Finished "Creating the index" in 65.4896 secs
2025-03-13 18:09:10,125 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5148 secs
2025-03-13 18:09:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 10543 [episode count 16/20]
[retrieval_preprocessing] for episode 91953 [episode count 17/20], we have num_retrieval=np.int64(2758) num_query=np.int64(147)
2025-03-13 18:09:14,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:15,101 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:15
2025-03-13 18:09:15,101 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.05it/s]
2025-03-13 18:09:15,126 [INFO]: There are 2758 embeddings of dim 49152
2025-03-13 18:09:15,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 18:09:15,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:15
2025-03-13 18:09:15,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:15,126 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:09:15,126 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:15,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:09:15,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:15
2025-03-13 18:09:15,126 [INFO]: 569.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:15,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:15,127 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:15
2025-03-13 18:09:15,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:15,127 [INFO]: 	Creating the index 03/13/2025, 18:09:15
2025-03-13 18:09:15,127 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:15
2025-03-13 18:09:15,128 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:09:15,128 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:15
2025-03-13 18:09:15,128 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:09:15,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.33it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.00it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.23it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.37it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.34it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.49it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.41it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.31it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.32it/s]100%|██████████| 11/11 [00:03<00:00,  1.37it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 18:09:18,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:18
2025-03-13 18:09:57,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6730 secs
2025-03-13 18:09:57,147 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:09:57,147 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.47it/s]
2025-03-13 18:10:14,612 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4644 secs
2025-03-13 18:10:14,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4869 secs
2025-03-13 18:10:14,615 [INFO]: {
2025-03-13 18:10:14,615 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:14,615 [INFO]: 	index_param: efSearch=228
2025-03-13 18:10:14,615 [INFO]: 	index_path: knn.index
2025-03-13 18:10:14,615 [INFO]: 	size in bytes: 542619250
2025-03-13 18:10:14,615 [INFO]: 	avg_search_speed_ms: 11.880768085011411
2025-03-13 18:10:14,615 [INFO]: 	99p_search_speed_ms: 16.571852560155097
2025-03-13 18:10:14,615 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:14,615 [INFO]: 	nb vectors: 2758
2025-03-13 18:10:14,615 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:14,615 [INFO]: 	compression ratio: 0.9993100392217932
2025-03-13 18:10:14,615 [INFO]: }
2025-03-13 18:10:14,615 [INFO]: 	>>> Finished "Creating the index" in 59.4884 secs
2025-03-13 18:10:14,615 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5139 secs
2025-03-13 18:10:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 91953 [episode count 17/20]
[retrieval_preprocessing] for episode 17718 [episode count 18/20], we have num_retrieval=np.int64(2787) num_query=np.int64(118)
2025-03-13 18:10:17,649 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:18,262 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:18
2025-03-13 18:10:18,262 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1665.73it/s]
2025-03-13 18:10:18,292 [INFO]: There are 2787 embeddings of dim 49152
2025-03-13 18:10:18,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 18:10:18,293 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:18,293 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:10:18,294 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:18,294 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:10:18,294 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,294 [INFO]: 575.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:18,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:10:18,295 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:18
2025-03-13 18:10:18,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:18,295 [INFO]: 	Creating the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,295 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:18
2025-03-13 18:10:18,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:10:18,299 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:18
2025-03-13 18:10:18,299 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:10:18,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.11it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.60it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.16it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.54it/s]100%|██████████| 11/11 [00:03<00:00,  2.09it/s]100%|██████████| 11/11 [00:03<00:00,  3.40it/s]
2025-03-13 18:10:21,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:21
2025-03-13 18:10:57,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4914 secs
2025-03-13 18:10:57,042 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:10:57,042 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 18:11:21,127 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0849 secs
2025-03-13 18:11:21,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8304 secs
2025-03-13 18:11:21,129 [INFO]: {
2025-03-13 18:11:21,129 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:21,129 [INFO]: 	index_param: efSearch=228
2025-03-13 18:11:21,129 [INFO]: 	index_path: knn.index
2025-03-13 18:11:21,129 [INFO]: 	size in bytes: 548324890
2025-03-13 18:11:21,129 [INFO]: 	avg_search_speed_ms: 9.672465864109592
2025-03-13 18:11:21,129 [INFO]: 	99p_search_speed_ms: 12.82194767612964
2025-03-13 18:11:21,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:21,129 [INFO]: 	nb vectors: 2787
2025-03-13 18:11:21,129 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:21,129 [INFO]: 	compression ratio: 0.9993099091306981
2025-03-13 18:11:21,129 [INFO]: }
2025-03-13 18:11:21,129 [INFO]: 	>>> Finished "Creating the index" in 62.8343 secs
2025-03-13 18:11:21,129 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8671 secs
2025-03-13 18:11:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 17718 [episode count 18/20]
[retrieval_preprocessing] for episode 1339 [episode count 19/20], we have num_retrieval=np.int64(2737) num_query=np.int64(168)
2025-03-13 18:11:27,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:27,860 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:27
2025-03-13 18:11:27,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2321.14it/s]
2025-03-13 18:11:27,883 [INFO]: There are 2737 embeddings of dim 49152
2025-03-13 18:11:27,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 18:11:27,883 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:27
2025-03-13 18:11:27,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:27,883 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:11:27,883 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:27,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:11:27,884 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:27
2025-03-13 18:11:27,884 [INFO]: 564.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:27,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:11:27,884 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:27
2025-03-13 18:11:27,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:27,884 [INFO]: 	Creating the index 03/13/2025, 18:11:27
2025-03-13 18:11:27,884 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:27
2025-03-13 18:11:27,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:11:27,885 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:27
2025-03-13 18:11:27,885 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:11:27,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.68it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.62it/s] 45%|████▌     | 5/11 [00:00<00:00, 13.35it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.85it/s] 82%|████████▏ | 9/11 [00:00<00:00, 14.67it/s]100%|██████████| 11/11 [00:02<00:00,  2.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.24it/s]
2025-03-13 18:11:30,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:30
2025-03-13 18:11:59,101 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6093 secs
2025-03-13 18:11:59,101 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 18:11:59,101 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.72it/s]
2025-03-13 18:12:18,487 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3855 secs
2025-03-13 18:12:18,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6041 secs
2025-03-13 18:12:18,489 [INFO]: {
2025-03-13 18:12:18,489 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:18,489 [INFO]: 	index_param: efSearch=106
2025-03-13 18:12:18,489 [INFO]: 	index_path: knn.index
2025-03-13 18:12:18,489 [INFO]: 	size in bytes: 538487710
2025-03-13 18:12:18,489 [INFO]: 	avg_search_speed_ms: 6.312976693069716
2025-03-13 18:12:18,489 [INFO]: 	99p_search_speed_ms: 11.562837590463488
2025-03-13 18:12:18,489 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:18,489 [INFO]: 	nb vectors: 2737
2025-03-13 18:12:18,489 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:18,490 [INFO]: 	compression ratio: 0.999309893256431
2025-03-13 18:12:18,490 [INFO]: }
2025-03-13 18:12:18,490 [INFO]: 	>>> Finished "Creating the index" in 50.6057 secs
2025-03-13 18:12:18,490 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6299 secs
2025-03-13 18:12:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 1339 [episode count 19/20]
2025-03-13 18:12:19: [retrieval_preprocessing] finished for 1730074336_wipe_table_with_yellow_towel [chosen_id count 5/196]
2025-03-13 18:12:21: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 1769954912_keyboard_press [chosen_id count 6/196]
2025-03-13 18:12:21: [retrieval_preprocessing] we have num_total=2295 embedding_dim=49152
[retrieval_preprocessing] for episode 61699 [episode count 0/20], we have num_retrieval=np.int64(2171) num_query=np.int64(124)
2025-03-13 18:12:22,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:23,313 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:23
2025-03-13 18:12:23,313 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 961.33it/s]
2025-03-13 18:12:23,341 [INFO]: There are 2171 embeddings of dim 49152
2025-03-13 18:12:23,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 18:12:23,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:23
2025-03-13 18:12:23,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:23,342 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:12:23,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:23,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:12:23,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:23
2025-03-13 18:12:23,343 [INFO]: 448.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:23,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:12:23,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:23
2025-03-13 18:12:23,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:23,344 [INFO]: 	Creating the index 03/13/2025, 18:12:23
2025-03-13 18:12:23,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:23
2025-03-13 18:12:23,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 18:12:23,348 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:23
2025-03-13 18:12:23,349 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:12:23,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.66it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.77it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.20it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.42it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.55it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.14it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.19it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.15it/s]100%|██████████| 9/9 [00:02<00:00,  1.86it/s]100%|██████████| 9/9 [00:02<00:00,  3.62it/s]
2025-03-13 18:12:25,842 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:25
2025-03-13 18:12:50,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6299 secs
2025-03-13 18:12:50,472 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:12:50,472 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 18:13:06,939 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4663 secs
2025-03-13 18:13:06,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5927 secs
2025-03-13 18:13:06,941 [INFO]: {
2025-03-13 18:13:06,941 [INFO]: 	index_key: HNSW15
2025-03-13 18:13:06,941 [INFO]: 	index_param: efSearch=174
2025-03-13 18:13:06,941 [INFO]: 	index_path: knn.index
2025-03-13 18:13:06,941 [INFO]: 	size in bytes: 427131070
2025-03-13 18:13:06,941 [INFO]: 	avg_search_speed_ms: 7.753684323265154
2025-03-13 18:13:06,942 [INFO]: 	99p_search_speed_ms: 10.568693103268737
2025-03-13 18:13:06,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:13:06,942 [INFO]: 	nb vectors: 2171
2025-03-13 18:13:06,942 [INFO]: 	vectors dimension: 49152
2025-03-13 18:13:06,942 [INFO]: 	compression ratio: 0.9993091066870878
2025-03-13 18:13:06,942 [INFO]: }
2025-03-13 18:13:06,942 [INFO]: 	>>> Finished "Creating the index" in 43.5971 secs
2025-03-13 18:13:06,942 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6285 secs
2025-03-13 18:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:13:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 61699 [episode count 0/20]
[retrieval_preprocessing] for episode 46348 [episode count 1/20], we have num_retrieval=np.int64(2183) num_query=np.int64(112)
2025-03-13 18:13:08,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:13:09,090 [INFO]: Launching the whole pipeline 03/13/2025, 18:13:09
2025-03-13 18:13:09,091 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:13:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.72it/s]
2025-03-13 18:13:09,119 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 18:13:09,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:13:09,120 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:13:09
2025-03-13 18:13:09,120 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:13:09,120 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:13:09,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:13:09,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:13:09,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:13:09
2025-03-13 18:13:09,121 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:13:09,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:13:09,122 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:13:09
2025-03-13 18:13:09,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:13:09,123 [INFO]: 	Creating the index 03/13/2025, 18:13:09
2025-03-13 18:13:09,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:13:09
2025-03-13 18:13:09,126 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 18:13:09,127 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:13:09
2025-03-13 18:13:09,127 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:13:09,127 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.11it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.14it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.17it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.17it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.19it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.83it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.61it/s]100%|██████████| 9/9 [00:02<00:00,  1.84it/s]100%|██████████| 9/9 [00:02<00:00,  3.58it/s]
2025-03-13 18:13:11,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:11
2025-03-13 18:13:34,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0821 secs
2025-03-13 18:13:34,732 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 18:13:34,732 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-13 18:14:03,636 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9040 secs
2025-03-13 18:14:03,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5111 secs
2025-03-13 18:14:03,638 [INFO]: {
2025-03-13 18:14:03,638 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:03,638 [INFO]: 	index_param: efSearch=263
2025-03-13 18:14:03,638 [INFO]: 	index_path: knn.index
2025-03-13 18:14:03,638 [INFO]: 	size in bytes: 429492010
2025-03-13 18:14:03,638 [INFO]: 	avg_search_speed_ms: 8.281843795602356
2025-03-13 18:14:03,638 [INFO]: 	99p_search_speed_ms: 10.963115901686251
2025-03-13 18:14:03,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:03,638 [INFO]: 	nb vectors: 2183
2025-03-13 18:14:03,638 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:03,638 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 18:14:03,638 [INFO]: }
2025-03-13 18:14:03,638 [INFO]: 	>>> Finished "Creating the index" in 54.5154 secs
2025-03-13 18:14:03,638 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5477 secs
2025-03-13 18:14:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 46348 [episode count 1/20]
[retrieval_preprocessing] for episode 33791 [episode count 2/20], we have num_retrieval=np.int64(2149) num_query=np.int64(146)
2025-03-13 18:14:05,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:06,401 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:06
2025-03-13 18:14:06,401 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1488.93it/s]
2025-03-13 18:14:06,428 [INFO]: There are 2149 embeddings of dim 49152
2025-03-13 18:14:06,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:14:06,428 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:06
2025-03-13 18:14:06,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:06,428 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:14:06,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:06,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:06,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:06
2025-03-13 18:14:06,429 [INFO]: 443.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:06,429 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:06,429 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:06
2025-03-13 18:14:06,429 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:06,429 [INFO]: 	Creating the index 03/13/2025, 18:14:06
2025-03-13 18:14:06,429 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:06
2025-03-13 18:14:06,430 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:14:06,430 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:06
2025-03-13 18:14:06,430 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:14:06,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.80it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.44it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.72it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.86it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.15it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.16it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.18it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.64it/s]
2025-03-13 18:14:08,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:08
2025-03-13 18:14:35,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5971 secs
2025-03-13 18:14:35,505 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 18:14:35,506 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 18:14:51,381 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8750 secs
2025-03-13 18:14:51,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9525 secs
2025-03-13 18:14:51,383 [INFO]: {
2025-03-13 18:14:51,383 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:51,383 [INFO]: 	index_param: efSearch=170
2025-03-13 18:14:51,383 [INFO]: 	index_path: knn.index
2025-03-13 18:14:51,383 [INFO]: 	size in bytes: 422802670
2025-03-13 18:14:51,383 [INFO]: 	avg_search_speed_ms: 7.951782370251422
2025-03-13 18:14:51,383 [INFO]: 	99p_search_speed_ms: 12.556527443230168
2025-03-13 18:14:51,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:51,383 [INFO]: 	nb vectors: 2149
2025-03-13 18:14:51,383 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:51,383 [INFO]: 	compression ratio: 0.9993091860086881
2025-03-13 18:14:51,383 [INFO]: }
2025-03-13 18:14:51,383 [INFO]: 	>>> Finished "Creating the index" in 44.9541 secs
2025-03-13 18:14:51,383 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9822 secs
2025-03-13 18:14:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 33791 [episode count 2/20]
[retrieval_preprocessing] for episode 92195 [episode count 3/20], we have num_retrieval=np.int64(2187) num_query=np.int64(108)
2025-03-13 18:14:53,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:53,589 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:53
2025-03-13 18:14:53,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.18it/s]
2025-03-13 18:14:53,632 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 18:14:53,632 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0427 secs
2025-03-13 18:14:53,632 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:53
2025-03-13 18:14:53,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:53,633 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:14:53,633 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:53,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:14:53,633 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:53
2025-03-13 18:14:53,633 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:53,633 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:14:53,633 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:53
2025-03-13 18:14:53,633 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:53,633 [INFO]: 	Creating the index 03/13/2025, 18:14:53
2025-03-13 18:14:53,633 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:53
2025-03-13 18:14:53,636 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:14:53,636 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:53
2025-03-13 18:14:53,636 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:14:53,636 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.24it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.88it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.67it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.66it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.70it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.80it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.79it/s]100%|██████████| 9/9 [00:02<00:00,  2.00it/s]100%|██████████| 9/9 [00:02<00:00,  3.78it/s]
2025-03-13 18:14:56,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:56
2025-03-13 18:15:20,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9054 secs
2025-03-13 18:15:20,864 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 18:15:20,864 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-13 18:15:42,570 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7058 secs
2025-03-13 18:15:42,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9366 secs
2025-03-13 18:15:42,573 [INFO]: {
2025-03-13 18:15:42,573 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:42,573 [INFO]: 	index_param: efSearch=287
2025-03-13 18:15:42,573 [INFO]: 	index_path: knn.index
2025-03-13 18:15:42,573 [INFO]: 	size in bytes: 430279030
2025-03-13 18:15:42,573 [INFO]: 	avg_search_speed_ms: 10.085557113803413
2025-03-13 18:15:42,573 [INFO]: 	99p_search_speed_ms: 15.989928431808954
2025-03-13 18:15:42,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:42,573 [INFO]: 	nb vectors: 2187
2025-03-13 18:15:42,573 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:42,573 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 18:15:42,573 [INFO]: }
2025-03-13 18:15:42,573 [INFO]: 	>>> Finished "Creating the index" in 48.9395 secs
2025-03-13 18:15:42,573 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9837 secs
2025-03-13 18:15:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 92195 [episode count 3/20]
[retrieval_preprocessing] for episode 36134 [episode count 4/20], we have num_retrieval=np.int64(2190) num_query=np.int64(105)
2025-03-13 18:15:44,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:44,966 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:44
2025-03-13 18:15:44,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1733.18it/s]
2025-03-13 18:15:44,990 [INFO]: There are 2190 embeddings of dim 49152
2025-03-13 18:15:44,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:15:44,990 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:44
2025-03-13 18:15:44,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:44,990 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:15:44,990 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:44,990 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:44,990 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:44
2025-03-13 18:15:44,990 [INFO]: 452.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:44,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:44,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:44
2025-03-13 18:15:44,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:44,991 [INFO]: 	Creating the index 03/13/2025, 18:15:44
2025-03-13 18:15:44,991 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:44
2025-03-13 18:15:44,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:15:44,992 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:44
2025-03-13 18:15:44,992 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:15:44,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.23it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.59it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.76it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.23it/s]100%|██████████| 9/9 [00:02<00:00,  3.09it/s]100%|██████████| 9/9 [00:02<00:00,  4.32it/s]
2025-03-13 18:15:47,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:47
2025-03-13 18:16:12,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8990 secs
2025-03-13 18:16:12,619 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 18:16:12,619 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 18:16:33,237 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6183 secs
2025-03-13 18:16:33,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2474 secs
2025-03-13 18:16:33,239 [INFO]: {
2025-03-13 18:16:33,239 [INFO]: 	index_key: HNSW15
2025-03-13 18:16:33,239 [INFO]: 	index_param: efSearch=266
2025-03-13 18:16:33,239 [INFO]: 	index_path: knn.index
2025-03-13 18:16:33,239 [INFO]: 	size in bytes: 430869310
2025-03-13 18:16:33,239 [INFO]: 	avg_search_speed_ms: 9.40689527642539
2025-03-13 18:16:33,239 [INFO]: 	99p_search_speed_ms: 14.011872210539874
2025-03-13 18:16:33,239 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:16:33,240 [INFO]: 	nb vectors: 2190
2025-03-13 18:16:33,240 [INFO]: 	vectors dimension: 49152
2025-03-13 18:16:33,240 [INFO]: 	compression ratio: 0.9993088623555018
2025-03-13 18:16:33,240 [INFO]: }
2025-03-13 18:16:33,240 [INFO]: 	>>> Finished "Creating the index" in 48.2489 secs
2025-03-13 18:16:33,240 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2733 secs
2025-03-13 18:16:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 36134 [episode count 4/20]
[retrieval_preprocessing] for episode 80042 [episode count 5/20], we have num_retrieval=np.int64(2197) num_query=np.int64(98)
2025-03-13 18:16:35,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:36,076 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:36
2025-03-13 18:16:36,076 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.54it/s]
2025-03-13 18:16:36,100 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 18:16:36,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 18:16:36,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:36
2025-03-13 18:16:36,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:36,100 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:16:36,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:16:36,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:16:36,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:36
2025-03-13 18:16:36,100 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:36,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:16:36,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:36
2025-03-13 18:16:36,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:16:36,100 [INFO]: 	Creating the index 03/13/2025, 18:16:36
2025-03-13 18:16:36,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:16:36
2025-03-13 18:16:36,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:16:36,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:36
2025-03-13 18:16:36,102 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:16:36,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.76it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.28it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.25it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.70it/s]100%|██████████| 9/9 [00:01<00:00,  3.35it/s]100%|██████████| 9/9 [00:01<00:00,  4.65it/s]
2025-03-13 18:16:38,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:38
2025-03-13 18:17:00,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7888 secs
2025-03-13 18:17:00,828 [INFO]: The best hyperparameters are: efSearch=357
2025-03-13 18:17:00,828 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 18:17:25,932 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1040 secs
2025-03-13 18:17:25,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8328 secs
2025-03-13 18:17:25,935 [INFO]: {
2025-03-13 18:17:25,935 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:25,935 [INFO]: 	index_param: efSearch=357
2025-03-13 18:17:25,935 [INFO]: 	index_path: knn.index
2025-03-13 18:17:25,935 [INFO]: 	size in bytes: 432246490
2025-03-13 18:17:25,935 [INFO]: 	avg_search_speed_ms: 11.599367695132361
2025-03-13 18:17:25,935 [INFO]: 	99p_search_speed_ms: 14.52409342629835
2025-03-13 18:17:25,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:25,935 [INFO]: 	nb vectors: 2197
2025-03-13 18:17:25,935 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:25,935 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 18:17:25,935 [INFO]: }
2025-03-13 18:17:25,935 [INFO]: 	>>> Finished "Creating the index" in 49.8344 secs
2025-03-13 18:17:25,935 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8589 secs
2025-03-13 18:17:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 80042 [episode count 5/20]
[retrieval_preprocessing] for episode 62125 [episode count 6/20], we have num_retrieval=np.int64(2164) num_query=np.int64(131)
2025-03-13 18:17:29,303 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:29,818 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:29
2025-03-13 18:17:29,818 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]
2025-03-13 18:17:29,847 [INFO]: There are 2164 embeddings of dim 49152
2025-03-13 18:17:29,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 18:17:29,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:29
2025-03-13 18:17:29,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:29,848 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:17:29,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:29,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:17:29,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:29
2025-03-13 18:17:29,848 [INFO]: 446.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:29,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:17:29,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:29
2025-03-13 18:17:29,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:29,849 [INFO]: 	Creating the index 03/13/2025, 18:17:29
2025-03-13 18:17:29,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:29
2025-03-13 18:17:29,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 18:17:29,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:29
2025-03-13 18:17:29,853 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:17:29,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.92it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.32it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.06it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.37it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.63it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.88it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.08it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.17it/s]100%|██████████| 9/9 [00:02<00:00,  1.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]
2025-03-13 18:17:32,379 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:32
2025-03-13 18:17:58,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2364 secs
2025-03-13 18:17:58,616 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:17:58,617 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 50%|█████     | 2/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-13 18:18:14,210 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5936 secs
2025-03-13 18:18:14,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3590 secs
2025-03-13 18:18:14,212 [INFO]: {
2025-03-13 18:18:14,212 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:14,212 [INFO]: 	index_param: efSearch=271
2025-03-13 18:18:14,212 [INFO]: 	index_path: knn.index
2025-03-13 18:18:14,212 [INFO]: 	size in bytes: 425753830
2025-03-13 18:18:14,212 [INFO]: 	avg_search_speed_ms: 9.056136102341386
2025-03-13 18:18:14,212 [INFO]: 	99p_search_speed_ms: 12.931829371955248
2025-03-13 18:18:14,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:14,213 [INFO]: 	nb vectors: 2164
2025-03-13 18:18:14,213 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:14,213 [INFO]: 	compression ratio: 0.999309182961431
2025-03-13 18:18:14,213 [INFO]: }
2025-03-13 18:18:14,213 [INFO]: 	>>> Finished "Creating the index" in 44.3632 secs
2025-03-13 18:18:14,213 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3946 secs
2025-03-13 18:18:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 62125 [episode count 6/20]
[retrieval_preprocessing] for episode 35249 [episode count 7/20], we have num_retrieval=np.int64(2156) num_query=np.int64(139)
2025-03-13 18:18:15,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:16,008 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:16
2025-03-13 18:18:16,008 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.96it/s]
2025-03-13 18:18:16,035 [INFO]: There are 2156 embeddings of dim 49152
2025-03-13 18:18:16,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:18:16,035 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:16
2025-03-13 18:18:16,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:16,035 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:18:16,035 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:16,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:18:16,035 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:16
2025-03-13 18:18:16,036 [INFO]: 444.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:16,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:18:16,036 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:16
2025-03-13 18:18:16,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:16,036 [INFO]: 	Creating the index 03/13/2025, 18:18:16
2025-03-13 18:18:16,036 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:16
2025-03-13 18:18:16,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:18:16,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:16
2025-03-13 18:18:16,037 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:18:16,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.41it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.81it/s]100%|██████████| 9/9 [00:01<00:00,  5.06it/s]
2025-03-13 18:18:17,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:17
2025-03-13 18:18:43,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9539 secs
2025-03-13 18:18:43,775 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 18:18:43,775 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-13 18:19:06,850 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0749 secs
2025-03-13 18:19:06,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8152 secs
2025-03-13 18:19:06,852 [INFO]: {
2025-03-13 18:19:06,853 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:06,853 [INFO]: 	index_param: efSearch=186
2025-03-13 18:19:06,853 [INFO]: 	index_path: knn.index
2025-03-13 18:19:06,853 [INFO]: 	size in bytes: 424179910
2025-03-13 18:19:06,853 [INFO]: 	avg_search_speed_ms: 8.116017393964379
2025-03-13 18:19:06,853 [INFO]: 	99p_search_speed_ms: 11.311845311429357
2025-03-13 18:19:06,853 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:06,853 [INFO]: 	nb vectors: 2156
2025-03-13 18:19:06,853 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:06,853 [INFO]: 	compression ratio: 0.9993091091937852
2025-03-13 18:19:06,853 [INFO]: }
2025-03-13 18:19:06,853 [INFO]: 	>>> Finished "Creating the index" in 50.8168 secs
2025-03-13 18:19:06,853 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8446 secs
2025-03-13 18:19:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 35249 [episode count 7/20]
[retrieval_preprocessing] for episode 80949 [episode count 8/20], we have num_retrieval=np.int64(2189) num_query=np.int64(106)
2025-03-13 18:19:08,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:08,850 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:08
2025-03-13 18:19:08,850 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.97it/s]
2025-03-13 18:19:08,885 [INFO]: There are 2189 embeddings of dim 49152
2025-03-13 18:19:08,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 18:19:08,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:08,886 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:19:08,886 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:08,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:19:08,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,887 [INFO]: 451.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:08,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 18:19:08,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:08
2025-03-13 18:19:08,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:08,888 [INFO]: 	Creating the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,888 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:08
2025-03-13 18:19:08,891 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:19:08,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:08
2025-03-13 18:19:08,892 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:19:08,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.76it/s] 78%|███████▊  | 7/9 [00:00<00:00, 32.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.27it/s]
2025-03-13 18:19:10,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:10
2025-03-13 18:19:41,761 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1546 secs
2025-03-13 18:19:41,761 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 18:19:41,761 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 18:20:05,783 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0216 secs
2025-03-13 18:20:05,785 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8935 secs
2025-03-13 18:20:05,785 [INFO]: {
2025-03-13 18:20:05,785 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:05,785 [INFO]: 	index_param: efSearch=176
2025-03-13 18:20:05,785 [INFO]: 	index_path: knn.index
2025-03-13 18:20:05,785 [INFO]: 	size in bytes: 430672570
2025-03-13 18:20:05,785 [INFO]: 	avg_search_speed_ms: 8.14171282973456
2025-03-13 18:20:05,785 [INFO]: 	99p_search_speed_ms: 14.893963672220735
2025-03-13 18:20:05,785 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:05,786 [INFO]: 	nb vectors: 2189
2025-03-13 18:20:05,786 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:05,786 [INFO]: 	compression ratio: 0.9993088531270984
2025-03-13 18:20:05,786 [INFO]: }
2025-03-13 18:20:05,786 [INFO]: 	>>> Finished "Creating the index" in 56.8977 secs
2025-03-13 18:20:05,786 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9357 secs
2025-03-13 18:20:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 80949 [episode count 8/20]
[retrieval_preprocessing] for episode 75706 [episode count 9/20], we have num_retrieval=np.int64(2176) num_query=np.int64(119)
2025-03-13 18:20:07,185 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:07,528 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:07
2025-03-13 18:20:07,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1257.29it/s]
2025-03-13 18:20:08,058 [INFO]: There are 2176 embeddings of dim 49152
2025-03-13 18:20:08,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5299 secs
2025-03-13 18:20:08,058 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:08
2025-03-13 18:20:08,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:08,058 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:20:08,058 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:08,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:08,058 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:08
2025-03-13 18:20:08,058 [INFO]: 449.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:08,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:08,059 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:08
2025-03-13 18:20:08,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:08,059 [INFO]: 	Creating the index 03/13/2025, 18:20:08
2025-03-13 18:20:08,059 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:08
2025-03-13 18:20:08,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:20:08,060 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:08
2025-03-13 18:20:08,060 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:20:08,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.47it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.62it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.29it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.31it/s]100%|██████████| 9/9 [00:02<00:00,  2.74it/s]100%|██████████| 9/9 [00:02<00:00,  3.88it/s]
2025-03-13 18:20:10,385 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:10
2025-03-13 18:20:38,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0858 secs
2025-03-13 18:20:38,472 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 18:20:38,472 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.19it/s]
2025-03-13 18:20:54,293 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8211 secs
2025-03-13 18:20:54,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.2352 secs
2025-03-13 18:20:54,295 [INFO]: {
2025-03-13 18:20:54,295 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:54,295 [INFO]: 	index_param: efSearch=286
2025-03-13 18:20:54,295 [INFO]: 	index_path: knn.index
2025-03-13 18:20:54,295 [INFO]: 	size in bytes: 428114830
2025-03-13 18:20:54,295 [INFO]: 	avg_search_speed_ms: 9.911115241594192
2025-03-13 18:20:54,295 [INFO]: 	99p_search_speed_ms: 14.155942369252442
2025-03-13 18:20:54,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:54,295 [INFO]: 	nb vectors: 2176
2025-03-13 18:20:54,295 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:54,295 [INFO]: 	compression ratio: 0.9993090124908778
2025-03-13 18:20:54,295 [INFO]: }
2025-03-13 18:20:54,295 [INFO]: 	>>> Finished "Creating the index" in 46.2368 secs
2025-03-13 18:20:54,295 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7673 secs
2025-03-13 18:20:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 75706 [episode count 9/20]
[retrieval_preprocessing] for episode 95292 [episode count 10/20], we have num_retrieval=np.int64(2161) num_query=np.int64(134)
2025-03-13 18:20:56,090 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:56,398 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:56
2025-03-13 18:20:56,398 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-13 18:20:56,424 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 18:20:56,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:20:56,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:56
2025-03-13 18:20:56,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:56,424 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:20:56,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:56,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:56,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:56
2025-03-13 18:20:56,424 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:56,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:56,425 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:56
2025-03-13 18:20:56,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:56,425 [INFO]: 	Creating the index 03/13/2025, 18:20:56
2025-03-13 18:20:56,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:56
2025-03-13 18:20:56,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:20:56,426 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:56
2025-03-13 18:20:56,426 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:20:56,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.95it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.27it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.10it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.35it/s]100%|██████████| 9/9 [00:02<00:00,  3.25it/s]100%|██████████| 9/9 [00:02<00:00,  4.44it/s]
2025-03-13 18:20:58,456 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:58
2025-03-13 18:21:22,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7981 secs
2025-03-13 18:21:22,254 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 18:21:22,255 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s]
2025-03-13 18:21:44,569 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3141 secs
2025-03-13 18:21:44,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4228 secs
2025-03-13 18:21:44,849 [INFO]: {
2025-03-13 18:21:44,849 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:44,849 [INFO]: 	index_param: efSearch=301
2025-03-13 18:21:44,850 [INFO]: 	index_path: knn.index
2025-03-13 18:21:44,850 [INFO]: 	size in bytes: 425163610
2025-03-13 18:21:44,850 [INFO]: 	avg_search_speed_ms: 9.257535823983037
2025-03-13 18:21:44,850 [INFO]: 	99p_search_speed_ms: 15.637208572588897
2025-03-13 18:21:44,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:44,850 [INFO]: 	nb vectors: 2161
2025-03-13 18:21:44,850 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:44,850 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 18:21:44,850 [INFO]: }
2025-03-13 18:21:44,850 [INFO]: 	>>> Finished "Creating the index" in 48.4252 secs
2025-03-13 18:21:44,850 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4518 secs
2025-03-13 18:21:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 95292 [episode count 10/20]
[retrieval_preprocessing] for episode 77889 [episode count 11/20], we have num_retrieval=np.int64(2201) num_query=np.int64(94)
2025-03-13 18:21:46,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:47,262 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:47
2025-03-13 18:21:47,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1093.98it/s]
2025-03-13 18:21:47,291 [INFO]: There are 2201 embeddings of dim 49152
2025-03-13 18:21:47,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:21:47,291 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:47
2025-03-13 18:21:47,292 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:47,292 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:21:47,292 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:47,292 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:21:47,292 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:47
2025-03-13 18:21:47,292 [INFO]: 454.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:47,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:21:47,293 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:47
2025-03-13 18:21:47,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:47,293 [INFO]: 	Creating the index 03/13/2025, 18:21:47
2025-03-13 18:21:47,293 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:47
2025-03-13 18:21:47,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:21:47,296 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:47
2025-03-13 18:21:47,296 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:21:47,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.17it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.54it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.26it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.69it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.80it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.62it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.61it/s]100%|██████████| 9/9 [00:02<00:00,  2.08it/s]100%|██████████| 9/9 [00:02<00:00,  3.78it/s]
2025-03-13 18:21:49,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:49
2025-03-13 18:22:13,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9222 secs
2025-03-13 18:22:13,603 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 18:22:13,603 [INFO]: 	Compute fast metrics 03/13/2025, 18:22:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s]
2025-03-13 18:22:35,820 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2172 secs
2025-03-13 18:22:36,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8773 secs
2025-03-13 18:22:36,174 [INFO]: {
2025-03-13 18:22:36,174 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:36,174 [INFO]: 	index_param: efSearch=222
2025-03-13 18:22:36,174 [INFO]: 	index_path: knn.index
2025-03-13 18:22:36,174 [INFO]: 	size in bytes: 433033450
2025-03-13 18:22:36,174 [INFO]: 	avg_search_speed_ms: 7.070464931054323
2025-03-13 18:22:36,174 [INFO]: 	99p_search_speed_ms: 10.721653562504795
2025-03-13 18:22:36,175 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:36,175 [INFO]: 	nb vectors: 2201
2025-03-13 18:22:36,175 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:36,175 [INFO]: 	compression ratio: 0.9993089633144968
2025-03-13 18:22:36,175 [INFO]: }
2025-03-13 18:22:36,175 [INFO]: 	>>> Finished "Creating the index" in 48.8817 secs
2025-03-13 18:22:36,175 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9123 secs
2025-03-13 18:22:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 77889 [episode count 11/20]
[retrieval_preprocessing] for episode 65355 [episode count 12/20], we have num_retrieval=np.int64(2189) num_query=np.int64(106)
2025-03-13 18:22:37,922 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:38,219 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:38
2025-03-13 18:22:38,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.54it/s]
2025-03-13 18:22:38,244 [INFO]: There are 2189 embeddings of dim 49152
2025-03-13 18:22:38,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 18:22:38,244 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:38
2025-03-13 18:22:38,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:38,244 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:22:38,245 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:38,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:38,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:38
2025-03-13 18:22:38,245 [INFO]: 451.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:38,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:22:38,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:38
2025-03-13 18:22:38,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:38,245 [INFO]: 	Creating the index 03/13/2025, 18:22:38
2025-03-13 18:22:38,245 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:38
2025-03-13 18:22:38,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:22:38,246 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:38
2025-03-13 18:22:38,246 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:22:38,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.93it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.71it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.63it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.02it/s]100%|██████████| 9/9 [00:01<00:00,  3.27it/s]100%|██████████| 9/9 [00:01<00:00,  4.53it/s]
2025-03-13 18:22:40,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:40
2025-03-13 18:23:06,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1780 secs
2025-03-13 18:23:06,418 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:23:06,418 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-13 18:23:23,724 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3065 secs
2025-03-13 18:23:23,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4805 secs
2025-03-13 18:23:23,727 [INFO]: {
2025-03-13 18:23:23,727 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:23,727 [INFO]: 	index_param: efSearch=204
2025-03-13 18:23:23,727 [INFO]: 	index_path: knn.index
2025-03-13 18:23:23,727 [INFO]: 	size in bytes: 430672570
2025-03-13 18:23:23,727 [INFO]: 	avg_search_speed_ms: 8.532016562121528
2025-03-13 18:23:23,727 [INFO]: 	99p_search_speed_ms: 16.954229716211533
2025-03-13 18:23:23,727 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:23,727 [INFO]: 	nb vectors: 2189
2025-03-13 18:23:23,727 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:23,727 [INFO]: 	compression ratio: 0.9993088531270984
2025-03-13 18:23:23,727 [INFO]: }
2025-03-13 18:23:23,727 [INFO]: 	>>> Finished "Creating the index" in 45.4820 secs
2025-03-13 18:23:23,727 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5080 secs
2025-03-13 18:23:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65355 [episode count 12/20]
[retrieval_preprocessing] for episode 50129 [episode count 13/20], we have num_retrieval=np.int64(2184) num_query=np.int64(111)
2025-03-13 18:23:25,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:25,903 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:25
2025-03-13 18:23:25,904 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.84it/s]
2025-03-13 18:23:25,930 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 18:23:25,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 18:23:25,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:25
2025-03-13 18:23:25,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:25,930 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:23:25,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:25,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:25,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:25
2025-03-13 18:23:25,930 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:25,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:25,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:25
2025-03-13 18:23:25,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:25,931 [INFO]: 	Creating the index 03/13/2025, 18:23:25
2025-03-13 18:23:25,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:25
2025-03-13 18:23:25,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:23:25,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:25
2025-03-13 18:23:25,932 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:23:25,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.59it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.56it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.13it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.43it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]100%|██████████| 9/9 [00:02<00:00,  4.35it/s]
2025-03-13 18:23:28,006 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:28
2025-03-13 18:23:52,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2198 secs
2025-03-13 18:23:52,226 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 18:23:52,226 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:24:12,994 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7677 secs
2025-03-13 18:24:12,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0654 secs
2025-03-13 18:24:12,997 [INFO]: {
2025-03-13 18:24:12,997 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:12,998 [INFO]: 	index_param: efSearch=280
2025-03-13 18:24:12,998 [INFO]: 	index_path: knn.index
2025-03-13 18:24:12,998 [INFO]: 	size in bytes: 429688750
2025-03-13 18:24:12,998 [INFO]: 	avg_search_speed_ms: 8.1638309239809
2025-03-13 18:24:12,998 [INFO]: 	99p_search_speed_ms: 10.593318678438663
2025-03-13 18:24:12,998 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:12,998 [INFO]: 	nb vectors: 2184
2025-03-13 18:24:12,998 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:12,998 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 18:24:12,998 [INFO]: }
2025-03-13 18:24:12,998 [INFO]: 	>>> Finished "Creating the index" in 47.0674 secs
2025-03-13 18:24:12,998 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0944 secs
2025-03-13 18:24:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 50129 [episode count 13/20]
[retrieval_preprocessing] for episode 9694 [episode count 14/20], we have num_retrieval=np.int64(2176) num_query=np.int64(119)
2025-03-13 18:24:15,151 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:15,538 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:15
2025-03-13 18:24:15,538 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.05it/s]
2025-03-13 18:24:15,563 [INFO]: There are 2176 embeddings of dim 49152
2025-03-13 18:24:15,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:24:15,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:15
2025-03-13 18:24:15,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:15,564 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:24:15,564 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:15,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:24:15,564 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:15
2025-03-13 18:24:15,564 [INFO]: 449.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:15,564 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:24:15,564 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:15
2025-03-13 18:24:15,564 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:15,564 [INFO]: 	Creating the index 03/13/2025, 18:24:15
2025-03-13 18:24:15,564 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:15
2025-03-13 18:24:15,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:24:15,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:15
2025-03-13 18:24:15,566 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:24:15,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.11it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.55it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.54it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.09it/s]100%|██████████| 9/9 [00:02<00:00,  3.14it/s]100%|██████████| 9/9 [00:02<00:00,  4.36it/s]
2025-03-13 18:24:17,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:17
2025-03-13 18:24:42,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3567 secs
2025-03-13 18:24:42,991 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 18:24:42,991 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.95it/s]
2025-03-13 18:25:03,227 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2363 secs
2025-03-13 18:25:03,230 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6641 secs
2025-03-13 18:25:03,230 [INFO]: {
2025-03-13 18:25:03,230 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:03,230 [INFO]: 	index_param: efSearch=280
2025-03-13 18:25:03,230 [INFO]: 	index_path: knn.index
2025-03-13 18:25:03,230 [INFO]: 	size in bytes: 428114830
2025-03-13 18:25:03,230 [INFO]: 	avg_search_speed_ms: 10.135196695215585
2025-03-13 18:25:03,230 [INFO]: 	99p_search_speed_ms: 18.306153416633602
2025-03-13 18:25:03,230 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:03,230 [INFO]: 	nb vectors: 2176
2025-03-13 18:25:03,230 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:03,230 [INFO]: 	compression ratio: 0.9993090124908778
2025-03-13 18:25:03,230 [INFO]: }
2025-03-13 18:25:03,230 [INFO]: 	>>> Finished "Creating the index" in 47.6657 secs
2025-03-13 18:25:03,230 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6917 secs
2025-03-13 18:25:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 9694 [episode count 14/20]
[retrieval_preprocessing] for episode 5601 [episode count 15/20], we have num_retrieval=np.int64(2202) num_query=np.int64(93)
2025-03-13 18:25:05,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:05,679 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:05
2025-03-13 18:25:05,679 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.80it/s]
2025-03-13 18:25:05,706 [INFO]: There are 2202 embeddings of dim 49152
2025-03-13 18:25:05,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:25:05,706 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:05
2025-03-13 18:25:05,706 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:05,706 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:25:05,706 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:05,706 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:25:05,706 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:05
2025-03-13 18:25:05,706 [INFO]: 454.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:05,706 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:25:05,706 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:05
2025-03-13 18:25:05,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:05,706 [INFO]: 	Creating the index 03/13/2025, 18:25:05
2025-03-13 18:25:05,706 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:05
2025-03-13 18:25:05,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:25:05,708 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:05
2025-03-13 18:25:05,708 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:25:05,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.84it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.15it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.22it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.63it/s]100%|██████████| 9/9 [00:02<00:00,  2.89it/s]100%|██████████| 9/9 [00:02<00:00,  4.04it/s]
2025-03-13 18:25:07,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:07
2025-03-13 18:25:32,227 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2833 secs
2025-03-13 18:25:32,227 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 18:25:32,227 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 18:25:58,132 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9051 secs
2025-03-13 18:25:58,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4267 secs
2025-03-13 18:25:58,134 [INFO]: {
2025-03-13 18:25:58,135 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:58,135 [INFO]: 	index_param: efSearch=303
2025-03-13 18:25:58,135 [INFO]: 	index_path: knn.index
2025-03-13 18:25:58,135 [INFO]: 	size in bytes: 433230190
2025-03-13 18:25:58,135 [INFO]: 	avg_search_speed_ms: 9.761213726960705
2025-03-13 18:25:58,135 [INFO]: 	99p_search_speed_ms: 13.264752468094228
2025-03-13 18:25:58,135 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:58,135 [INFO]: 	nb vectors: 2202
2025-03-13 18:25:58,135 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:58,135 [INFO]: 	compression ratio: 0.9993089724425714
2025-03-13 18:25:58,135 [INFO]: }
2025-03-13 18:25:58,135 [INFO]: 	>>> Finished "Creating the index" in 52.4282 secs
2025-03-13 18:25:58,135 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4553 secs
2025-03-13 18:25:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 5601 [episode count 15/20]
[retrieval_preprocessing] for episode 42858 [episode count 16/20], we have num_retrieval=np.int64(2176) num_query=np.int64(119)
2025-03-13 18:25:59,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:00,035 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:00
2025-03-13 18:26:00,035 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-13 18:26:00,059 [INFO]: There are 2176 embeddings of dim 49152
2025-03-13 18:26:00,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 18:26:00,059 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:00,059 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:26:00,059 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:00,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:00,059 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,059 [INFO]: 449.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:00,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:00,059 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:00
2025-03-13 18:26:00,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:00,059 [INFO]: 	Creating the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,059 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:00
2025-03-13 18:26:00,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:26:00,060 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:00
2025-03-13 18:26:00,060 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:26:00,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.53it/s] 33%|███▎      | 3/9 [00:00<00:00, 12.13it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.58it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.80it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.92it/s]100%|██████████| 9/9 [00:02<00:00,  2.21it/s]100%|██████████| 9/9 [00:02<00:00,  3.82it/s]
2025-03-13 18:26:02,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:02
2025-03-13 18:26:23,666 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.2461 secs
2025-03-13 18:26:23,666 [INFO]: The best hyperparameters are: efSearch=316
2025-03-13 18:26:23,666 [INFO]: 	Compute fast metrics 03/13/2025, 18:26:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 18:26:46,512 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8456 secs
2025-03-13 18:26:46,514 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4537 secs
2025-03-13 18:26:46,514 [INFO]: {
2025-03-13 18:26:46,514 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:46,514 [INFO]: 	index_param: efSearch=316
2025-03-13 18:26:46,514 [INFO]: 	index_path: knn.index
2025-03-13 18:26:46,514 [INFO]: 	size in bytes: 428114830
2025-03-13 18:26:46,514 [INFO]: 	avg_search_speed_ms: 12.174448160706156
2025-03-13 18:26:46,514 [INFO]: 	99p_search_speed_ms: 16.445213854312893
2025-03-13 18:26:46,514 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:46,514 [INFO]: 	nb vectors: 2176
2025-03-13 18:26:46,514 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:46,514 [INFO]: 	compression ratio: 0.9993090124908778
2025-03-13 18:26:46,514 [INFO]: }
2025-03-13 18:26:46,514 [INFO]: 	>>> Finished "Creating the index" in 46.4550 secs
2025-03-13 18:26:46,514 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4798 secs
2025-03-13 18:26:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 42858 [episode count 16/20]
[retrieval_preprocessing] for episode 62186 [episode count 17/20], we have num_retrieval=np.int64(2185) num_query=np.int64(110)
2025-03-13 18:26:48,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:48,829 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:48
2025-03-13 18:26:48,829 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2366.99it/s]
2025-03-13 18:26:48,851 [INFO]: There are 2185 embeddings of dim 49152
2025-03-13 18:26:48,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 18:26:48,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:48,851 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:26:48,851 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:48,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:26:48,851 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,851 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:48,851 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:26:48,851 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:48
2025-03-13 18:26:48,851 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:48,851 [INFO]: 	Creating the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,851 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:48
2025-03-13 18:26:48,852 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:26:48,852 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:48
2025-03-13 18:26:48,853 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:26:48,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.19it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.06it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.35it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.35it/s]100%|██████████| 9/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.83it/s]
2025-03-13 18:26:51,203 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:51
2025-03-13 18:27:21,507 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3041 secs
2025-03-13 18:27:21,508 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 18:27:21,508 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 18:27:39,124 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6162 secs
2025-03-13 18:27:39,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2736 secs
2025-03-13 18:27:39,127 [INFO]: {
2025-03-13 18:27:39,127 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:39,127 [INFO]: 	index_param: efSearch=221
2025-03-13 18:27:39,127 [INFO]: 	index_path: knn.index
2025-03-13 18:27:39,127 [INFO]: 	size in bytes: 429885490
2025-03-13 18:27:39,127 [INFO]: 	avg_search_speed_ms: 8.101196128292374
2025-03-13 18:27:39,127 [INFO]: 	99p_search_speed_ms: 11.906549127306791
2025-03-13 18:27:39,127 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:39,127 [INFO]: 	nb vectors: 2185
2025-03-13 18:27:39,127 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:39,127 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-13 18:27:39,127 [INFO]: }
2025-03-13 18:27:39,127 [INFO]: 	>>> Finished "Creating the index" in 50.2754 secs
2025-03-13 18:27:39,127 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2982 secs
2025-03-13 18:27:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 62186 [episode count 17/20]
[retrieval_preprocessing] for episode 47214 [episode count 18/20], we have num_retrieval=np.int64(2181) num_query=np.int64(114)
2025-03-13 18:27:40,575 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:41,209 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:41
2025-03-13 18:27:41,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.73it/s]
2025-03-13 18:27:41,236 [INFO]: There are 2181 embeddings of dim 49152
2025-03-13 18:27:41,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:27:41,237 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:41
2025-03-13 18:27:41,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:41,237 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:27:41,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:41,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:41,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:41
2025-03-13 18:27:41,237 [INFO]: 450.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:41,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:27:41,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:41
2025-03-13 18:27:41,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:41,237 [INFO]: 	Creating the index 03/13/2025, 18:27:41
2025-03-13 18:27:41,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:41
2025-03-13 18:27:41,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:27:41,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:41
2025-03-13 18:27:41,238 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:27:41,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.56it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.96it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.50it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.06it/s]100%|██████████| 9/9 [00:02<00:00,  2.62it/s]100%|██████████| 9/9 [00:02<00:00,  3.73it/s]
2025-03-13 18:27:43,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:43
2025-03-13 18:28:08,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4961 secs
2025-03-13 18:28:08,152 [INFO]: The best hyperparameters are: efSearch=298
2025-03-13 18:28:08,152 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s]
2025-03-13 18:28:26,886 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7341 secs
2025-03-13 18:28:26,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6500 secs
2025-03-13 18:28:26,888 [INFO]: {
2025-03-13 18:28:26,888 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:26,889 [INFO]: 	index_param: efSearch=298
2025-03-13 18:28:26,889 [INFO]: 	index_path: knn.index
2025-03-13 18:28:26,889 [INFO]: 	size in bytes: 429098530
2025-03-13 18:28:26,889 [INFO]: 	avg_search_speed_ms: 9.947452552162519
2025-03-13 18:28:26,889 [INFO]: 	99p_search_speed_ms: 15.640702163800604
2025-03-13 18:28:26,889 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:26,889 [INFO]: 	nb vectors: 2181
2025-03-13 18:28:26,889 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:26,889 [INFO]: 	compression ratio: 0.9993090584579724
2025-03-13 18:28:26,889 [INFO]: }
2025-03-13 18:28:26,889 [INFO]: 	>>> Finished "Creating the index" in 45.6514 secs
2025-03-13 18:28:26,889 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6798 secs
2025-03-13 18:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 47214 [episode count 18/20]
[retrieval_preprocessing] for episode 90093 [episode count 19/20], we have num_retrieval=np.int64(2188) num_query=np.int64(107)
2025-03-13 18:28:28,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:29,040 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:29
2025-03-13 18:28:29,040 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.82it/s]
2025-03-13 18:28:29,065 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 18:28:29,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:28:29,066 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:29
2025-03-13 18:28:29,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:29,066 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 18:28:29,066 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:29,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:28:29,066 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:29
2025-03-13 18:28:29,066 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:29,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:28:29,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:29
2025-03-13 18:28:29,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:29,066 [INFO]: 	Creating the index 03/13/2025, 18:28:29
2025-03-13 18:28:29,066 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:29
2025-03-13 18:28:29,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:28:29,067 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:29
2025-03-13 18:28:29,068 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 18:28:29,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.92it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.50it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.74it/s] 67%|██████▋   | 6/9 [00:00<00:00, 10.28it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.02it/s]100%|██████████| 9/9 [00:02<00:00,  3.99it/s]
2025-03-13 18:28:31,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:31
2025-03-13 18:28:53,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2843 secs
2025-03-13 18:28:53,609 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 18:28:53,609 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 18:29:16,515 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9059 secs
2025-03-13 18:29:16,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4492 secs
2025-03-13 18:29:16,517 [INFO]: {
2025-03-13 18:29:16,517 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:16,517 [INFO]: 	index_param: efSearch=305
2025-03-13 18:29:16,517 [INFO]: 	index_path: knn.index
2025-03-13 18:29:16,517 [INFO]: 	size in bytes: 430475830
2025-03-13 18:29:16,517 [INFO]: 	avg_search_speed_ms: 8.491331717933896
2025-03-13 18:29:16,517 [INFO]: 	99p_search_speed_ms: 11.279299021698536
2025-03-13 18:29:16,517 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:16,517 [INFO]: 	nb vectors: 2188
2025-03-13 18:29:16,517 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:16,517 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 18:29:16,517 [INFO]: }
2025-03-13 18:29:16,517 [INFO]: 	>>> Finished "Creating the index" in 47.4508 secs
2025-03-13 18:29:16,517 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4767 secs
2025-03-13 18:29:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 90093 [episode count 19/20]
2025-03-13 18:29:17: [retrieval_preprocessing] finished for 1769954912_keyboard_press [chosen_id count 6/196]
2025-03-13 18:29:20: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2476969100_blocks_in_bowl [chosen_id count 7/196]
2025-03-13 18:29:20: [retrieval_preprocessing] we have num_total=3213 embedding_dim=49152
[retrieval_preprocessing] for episode 45580 [episode count 0/20], we have num_retrieval=np.int64(3068) num_query=np.int64(145)
2025-03-13 18:29:20,820 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:21,181 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:21
2025-03-13 18:29:21,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.83it/s]
2025-03-13 18:29:21,206 [INFO]: There are 3068 embeddings of dim 49152
2025-03-13 18:29:21,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:29:21,207 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:21
2025-03-13 18:29:21,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:21,207 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:29:21,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:21,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:29:21,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:21
2025-03-13 18:29:21,207 [INFO]: 633.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:21,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:29:21,207 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:21
2025-03-13 18:29:21,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:21,207 [INFO]: 	Creating the index 03/13/2025, 18:29:21
2025-03-13 18:29:21,207 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:21
2025-03-13 18:29:21,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:29:21,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:21
2025-03-13 18:29:21,209 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:29:21,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.53it/s] 62%|██████▏   | 8/13 [00:00<00:00, 41.32it/s]100%|██████████| 13/13 [00:02<00:00,  3.54it/s]100%|██████████| 13/13 [00:02<00:00,  4.38it/s]
2025-03-13 18:29:24,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:24
2025-03-13 18:30:16,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5133 secs
2025-03-13 18:30:16,693 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 18:30:16,693 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.28it/s]
2025-03-13 18:30:35,719 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0260 secs
2025-03-13 18:30:35,722 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5128 secs
2025-03-13 18:30:35,722 [INFO]: {
2025-03-13 18:30:35,722 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:35,722 [INFO]: 	index_param: efSearch=156
2025-03-13 18:30:35,722 [INFO]: 	index_path: knn.index
2025-03-13 18:30:35,722 [INFO]: 	size in bytes: 603609970
2025-03-13 18:30:35,722 [INFO]: 	avg_search_speed_ms: 10.61798910899068
2025-03-13 18:30:35,722 [INFO]: 	99p_search_speed_ms: 14.391663833521312
2025-03-13 18:30:35,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:35,722 [INFO]: 	nb vectors: 3068
2025-03-13 18:30:35,722 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:35,722 [INFO]: 	compression ratio: 0.999309776145679
2025-03-13 18:30:35,722 [INFO]: }
2025-03-13 18:30:35,722 [INFO]: 	>>> Finished "Creating the index" in 74.5145 secs
2025-03-13 18:30:35,722 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5410 secs
2025-03-13 18:30:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 45580 [episode count 0/20]
[retrieval_preprocessing] for episode 89492 [episode count 1/20], we have num_retrieval=np.int64(3083) num_query=np.int64(130)
2025-03-13 18:30:38,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:38,787 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:38
2025-03-13 18:30:38,787 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1074.91it/s]
2025-03-13 18:30:38,824 [INFO]: There are 3083 embeddings of dim 49152
2025-03-13 18:30:38,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0376 secs
2025-03-13 18:30:38,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,825 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:38,825 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:30:38,825 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:38,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:30:38,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,825 [INFO]: 636.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:38,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:30:38,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:38
2025-03-13 18:30:38,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:38,825 [INFO]: 	Creating the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:38
2025-03-13 18:30:38,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:30:38,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:38
2025-03-13 18:30:38,827 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:30:38,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.18it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.36it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.94it/s]100%|██████████| 13/13 [00:03<00:00,  4.30it/s]
2025-03-13 18:30:41,859 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:41
2025-03-13 18:31:18,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9443 secs
2025-03-13 18:31:18,805 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 18:31:18,805 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 18:31:43,896 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0902 secs
2025-03-13 18:31:44,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3951 secs
2025-03-13 18:31:44,223 [INFO]: {
2025-03-13 18:31:44,223 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:44,223 [INFO]: 	index_param: efSearch=209
2025-03-13 18:31:44,223 [INFO]: 	index_path: knn.index
2025-03-13 18:31:44,223 [INFO]: 	size in bytes: 606561070
2025-03-13 18:31:44,223 [INFO]: 	avg_search_speed_ms: 10.972453957053897
2025-03-13 18:31:44,223 [INFO]: 	99p_search_speed_ms: 17.598023766186085
2025-03-13 18:31:44,223 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:44,223 [INFO]: 	nb vectors: 3083
2025-03-13 18:31:44,223 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:44,223 [INFO]: 	compression ratio: 0.9993098699855565
2025-03-13 18:31:44,223 [INFO]: }
2025-03-13 18:31:44,223 [INFO]: 	>>> Finished "Creating the index" in 65.3981 secs
2025-03-13 18:31:44,223 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4367 secs
2025-03-13 18:31:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 89492 [episode count 1/20]
[retrieval_preprocessing] for episode 91029 [episode count 2/20], we have num_retrieval=np.int64(3077) num_query=np.int64(136)
2025-03-13 18:31:46,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:46,782 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:46
2025-03-13 18:31:46,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-13 18:31:46,808 [INFO]: There are 3077 embeddings of dim 49152
2025-03-13 18:31:46,809 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 18:31:46,809 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:46
2025-03-13 18:31:46,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:46,809 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:31:46,809 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:46,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:31:46,809 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:46
2025-03-13 18:31:46,809 [INFO]: 635.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:46,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:31:46,809 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:46
2025-03-13 18:31:46,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:46,809 [INFO]: 	Creating the index 03/13/2025, 18:31:46
2025-03-13 18:31:46,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:46
2025-03-13 18:31:46,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:31:46,811 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:46
2025-03-13 18:31:46,811 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:31:46,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.64it/s] 38%|███▊      | 5/13 [00:00<00:00, 24.69it/s] 69%|██████▉   | 9/13 [00:00<00:00, 30.11it/s]100%|██████████| 13/13 [00:02<00:00,  3.48it/s]100%|██████████| 13/13 [00:02<00:00,  4.68it/s]
2025-03-13 18:31:49,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:49
2025-03-13 18:32:23,039 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4491 secs
2025-03-13 18:32:23,039 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:32:23,039 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-13 18:32:51,342 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3026 secs
2025-03-13 18:32:51,344 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5335 secs
2025-03-13 18:32:51,344 [INFO]: {
2025-03-13 18:32:51,344 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:51,344 [INFO]: 	index_param: efSearch=213
2025-03-13 18:32:51,344 [INFO]: 	index_path: knn.index
2025-03-13 18:32:51,344 [INFO]: 	size in bytes: 605380630
2025-03-13 18:32:51,344 [INFO]: 	avg_search_speed_ms: 10.325506622917466
2025-03-13 18:32:51,344 [INFO]: 	99p_search_speed_ms: 14.486056501045816
2025-03-13 18:32:51,344 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:51,344 [INFO]: 	nb vectors: 3077
2025-03-13 18:32:51,344 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:51,344 [INFO]: 	compression ratio: 0.9993098325593932
2025-03-13 18:32:51,344 [INFO]: }
2025-03-13 18:32:51,344 [INFO]: 	>>> Finished "Creating the index" in 64.5349 secs
2025-03-13 18:32:51,344 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5619 secs
2025-03-13 18:32:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 91029 [episode count 2/20]
[retrieval_preprocessing] for episode 83451 [episode count 3/20], we have num_retrieval=np.int64(3037) num_query=np.int64(176)
2025-03-13 18:32:52,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:53,361 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:53
2025-03-13 18:32:53,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2284.48it/s]
2025-03-13 18:32:53,384 [INFO]: There are 3037 embeddings of dim 49152
2025-03-13 18:32:53,384 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 18:32:53,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:53
2025-03-13 18:32:53,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:53,384 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:32:53,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:53,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:32:53,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:53
2025-03-13 18:32:53,384 [INFO]: 626.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:53,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:32:53,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:53
2025-03-13 18:32:53,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:53,384 [INFO]: 	Creating the index 03/13/2025, 18:32:53
2025-03-13 18:32:53,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:53
2025-03-13 18:32:53,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:32:53,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:53
2025-03-13 18:32:53,385 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:32:53,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.59it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.72it/s]100%|██████████| 12/12 [00:02<00:00,  3.57it/s]100%|██████████| 12/12 [00:02<00:00,  4.29it/s]
2025-03-13 18:32:56,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:56
2025-03-13 18:33:37,690 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5001 secs
2025-03-13 18:33:37,690 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:33:37,690 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 18:34:04,337 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6463 secs
2025-03-13 18:34:04,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9537 secs
2025-03-13 18:34:04,339 [INFO]: {
2025-03-13 18:34:04,339 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:04,339 [INFO]: 	index_param: efSearch=224
2025-03-13 18:34:04,339 [INFO]: 	index_path: knn.index
2025-03-13 18:34:04,339 [INFO]: 	size in bytes: 597510850
2025-03-13 18:34:04,339 [INFO]: 	avg_search_speed_ms: 10.157937403333369
2025-03-13 18:34:04,339 [INFO]: 	99p_search_speed_ms: 14.154667453840373
2025-03-13 18:34:04,339 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:04,339 [INFO]: 	nb vectors: 3037
2025-03-13 18:34:04,339 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:04,339 [INFO]: 	compression ratio: 0.9993098803143072
2025-03-13 18:34:04,339 [INFO]: }
2025-03-13 18:34:04,339 [INFO]: 	>>> Finished "Creating the index" in 70.9550 secs
2025-03-13 18:34:04,339 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9783 secs
2025-03-13 18:34:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 83451 [episode count 3/20]
[retrieval_preprocessing] for episode 41248 [episode count 4/20], we have num_retrieval=np.int64(3068) num_query=np.int64(145)
2025-03-13 18:34:07,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:08,361 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:08
2025-03-13 18:34:08,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.01it/s]
2025-03-13 18:34:08,393 [INFO]: There are 3068 embeddings of dim 49152
2025-03-13 18:34:08,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 18:34:08,393 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:08
2025-03-13 18:34:08,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:08,394 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:34:08,394 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:08,394 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:08,394 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:08
2025-03-13 18:34:08,394 [INFO]: 633.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:08,394 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:08,394 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:08
2025-03-13 18:34:08,394 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:08,394 [INFO]: 	Creating the index 03/13/2025, 18:34:08
2025-03-13 18:34:08,394 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:08
2025-03-13 18:34:08,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:34:08,395 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:08
2025-03-13 18:34:08,395 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:34:08,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.44it/s] 46%|████▌     | 6/13 [00:00<00:00, 26.37it/s] 85%|████████▍ | 11/13 [00:00<00:00, 32.88it/s]100%|██████████| 13/13 [00:02<00:00,  4.64it/s]
2025-03-13 18:34:11,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:11
2025-03-13 18:34:49,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9478 secs
2025-03-13 18:34:49,150 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 18:34:49,150 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 18:35:09,005 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8550 secs
2025-03-13 18:35:09,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6113 secs
2025-03-13 18:35:09,007 [INFO]: {
2025-03-13 18:35:09,007 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:09,007 [INFO]: 	index_param: efSearch=179
2025-03-13 18:35:09,007 [INFO]: 	index_path: knn.index
2025-03-13 18:35:09,007 [INFO]: 	size in bytes: 603609970
2025-03-13 18:35:09,007 [INFO]: 	avg_search_speed_ms: 9.04103671537399
2025-03-13 18:35:09,007 [INFO]: 	99p_search_speed_ms: 13.162042980547996
2025-03-13 18:35:09,007 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:09,007 [INFO]: 	nb vectors: 3068
2025-03-13 18:35:09,007 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:09,007 [INFO]: 	compression ratio: 0.999309776145679
2025-03-13 18:35:09,007 [INFO]: }
2025-03-13 18:35:09,007 [INFO]: 	>>> Finished "Creating the index" in 60.6131 secs
2025-03-13 18:35:09,007 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6459 secs
2025-03-13 18:35:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 41248 [episode count 4/20]
[retrieval_preprocessing] for episode 92193 [episode count 5/20], we have num_retrieval=np.int64(3036) num_query=np.int64(177)
2025-03-13 18:35:10,364 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:10,767 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:10
2025-03-13 18:35:10,767 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.21it/s]
2025-03-13 18:35:10,791 [INFO]: There are 3036 embeddings of dim 49152
2025-03-13 18:35:10,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:35:10,791 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:10
2025-03-13 18:35:10,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:10,791 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:35:10,791 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:10,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:35:10,791 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:10
2025-03-13 18:35:10,791 [INFO]: 626.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:10,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:35:10,791 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:10
2025-03-13 18:35:10,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:10,791 [INFO]: 	Creating the index 03/13/2025, 18:35:10
2025-03-13 18:35:10,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:10
2025-03-13 18:35:10,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:35:10,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:10
2025-03-13 18:35:10,792 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:35:10,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.19it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.00it/s]100%|██████████| 12/12 [00:02<00:00,  4.11it/s]100%|██████████| 12/12 [00:02<00:00,  5.15it/s]
2025-03-13 18:35:13,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:13
2025-03-13 18:35:53,419 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2935 secs
2025-03-13 18:35:53,420 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:35:53,420 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.04it/s]
2025-03-13 18:36:18,386 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9663 secs
2025-03-13 18:36:18,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5960 secs
2025-03-13 18:36:18,389 [INFO]: {
2025-03-13 18:36:18,389 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:18,389 [INFO]: 	index_param: efSearch=212
2025-03-13 18:36:18,389 [INFO]: 	index_path: knn.index
2025-03-13 18:36:18,389 [INFO]: 	size in bytes: 597314110
2025-03-13 18:36:18,389 [INFO]: 	avg_search_speed_ms: 10.64199575847213
2025-03-13 18:36:18,389 [INFO]: 	99p_search_speed_ms: 16.282593747600917
2025-03-13 18:36:18,389 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:18,389 [INFO]: 	nb vectors: 3036
2025-03-13 18:36:18,389 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:18,389 [INFO]: 	compression ratio: 0.9993098739957775
2025-03-13 18:36:18,389 [INFO]: }
2025-03-13 18:36:18,389 [INFO]: 	>>> Finished "Creating the index" in 67.5975 secs
2025-03-13 18:36:18,389 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6218 secs
2025-03-13 18:36:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 92193 [episode count 5/20]
[retrieval_preprocessing] for episode 57640 [episode count 6/20], we have num_retrieval=np.int64(3069) num_query=np.int64(144)
2025-03-13 18:36:21,088 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:21,743 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:21
2025-03-13 18:36:21,743 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1799.36it/s]
2025-03-13 18:36:21,772 [INFO]: There are 3069 embeddings of dim 49152
2025-03-13 18:36:21,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 18:36:21,773 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:21
2025-03-13 18:36:21,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:21,773 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:36:21,773 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:21,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:36:21,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:21
2025-03-13 18:36:21,774 [INFO]: 633.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:21,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:36:21,774 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:21
2025-03-13 18:36:21,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:21,775 [INFO]: 	Creating the index 03/13/2025, 18:36:21
2025-03-13 18:36:21,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:21
2025-03-13 18:36:21,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:36:21,778 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:21
2025-03-13 18:36:21,778 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:36:21,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.65it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.01it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.60it/s]100%|██████████| 13/13 [00:02<00:00,  5.02it/s]
2025-03-13 18:36:24,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:24
2025-03-13 18:37:07,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3906 secs
2025-03-13 18:37:07,763 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 18:37:07,763 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 18:37:29,204 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4413 secs
2025-03-13 18:37:29,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4283 secs
2025-03-13 18:37:29,207 [INFO]: {
2025-03-13 18:37:29,207 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:29,207 [INFO]: 	index_param: efSearch=180
2025-03-13 18:37:29,207 [INFO]: 	index_path: knn.index
2025-03-13 18:37:29,207 [INFO]: 	size in bytes: 603806710
2025-03-13 18:37:29,207 [INFO]: 	avg_search_speed_ms: 9.63950452286219
2025-03-13 18:37:29,207 [INFO]: 	99p_search_speed_ms: 13.739860318601128
2025-03-13 18:37:29,207 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:29,207 [INFO]: 	nb vectors: 3069
2025-03-13 18:37:29,207 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:29,207 [INFO]: 	compression ratio: 0.9993097824302085
2025-03-13 18:37:29,207 [INFO]: }
2025-03-13 18:37:29,207 [INFO]: 	>>> Finished "Creating the index" in 67.4322 secs
2025-03-13 18:37:29,207 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4645 secs
2025-03-13 18:37:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 57640 [episode count 6/20]
[retrieval_preprocessing] for episode 37420 [episode count 7/20], we have num_retrieval=np.int64(3075) num_query=np.int64(138)
2025-03-13 18:37:31,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:32,106 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:32
2025-03-13 18:37:32,106 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1076.01it/s]
2025-03-13 18:37:32,136 [INFO]: There are 3075 embeddings of dim 49152
2025-03-13 18:37:32,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:37:32,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:32
2025-03-13 18:37:32,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:32,137 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:37:32,137 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:37:32,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:37:32,137 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:32
2025-03-13 18:37:32,137 [INFO]: 634.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:32,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:37:32,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:32
2025-03-13 18:37:32,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:32,137 [INFO]: 	Creating the index 03/13/2025, 18:37:32
2025-03-13 18:37:32,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:32
2025-03-13 18:37:32,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 18:37:32,139 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:32
2025-03-13 18:37:32,140 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:37:32,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.55it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.09it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.03it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-13 18:37:34,978 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:34
2025-03-13 18:38:12,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3846 secs
2025-03-13 18:38:12,364 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 18:38:12,364 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.99it/s]
2025-03-13 18:38:47,009 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6454 secs
2025-03-13 18:38:47,011 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8720 secs
2025-03-13 18:38:47,012 [INFO]: {
2025-03-13 18:38:47,012 [INFO]: 	index_key: HNSW15
2025-03-13 18:38:47,012 [INFO]: 	index_param: efSearch=232
2025-03-13 18:38:47,012 [INFO]: 	index_path: knn.index
2025-03-13 18:38:47,012 [INFO]: 	size in bytes: 604987150
2025-03-13 18:38:47,012 [INFO]: 	avg_search_speed_ms: 9.955182187815211
2025-03-13 18:38:47,012 [INFO]: 	99p_search_speed_ms: 15.116262687370186
2025-03-13 18:38:47,012 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:47,012 [INFO]: 	nb vectors: 3075
2025-03-13 18:38:47,012 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:47,012 [INFO]: 	compression ratio: 0.9993098200515499
2025-03-13 18:38:47,012 [INFO]: }
2025-03-13 18:38:47,012 [INFO]: 	>>> Finished "Creating the index" in 74.8744 secs
2025-03-13 18:38:47,012 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9059 secs
2025-03-13 18:38:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:38:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 37420 [episode count 7/20]
[retrieval_preprocessing] for episode 91696 [episode count 8/20], we have num_retrieval=np.int64(3032) num_query=np.int64(181)
2025-03-13 18:38:50,028 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:38:50,492 [INFO]: Launching the whole pipeline 03/13/2025, 18:38:50
2025-03-13 18:38:50,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:38:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1602.10it/s]
2025-03-13 18:38:50,520 [INFO]: There are 3032 embeddings of dim 49152
2025-03-13 18:38:50,521 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 18:38:50,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:38:50
2025-03-13 18:38:50,521 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:38:50,521 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:38:50,521 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:38:50,521 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:38:50,521 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:38:50
2025-03-13 18:38:50,521 [INFO]: 625.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:38:50,521 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:38:50,521 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:38:50
2025-03-13 18:38:50,521 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:38:50,521 [INFO]: 	Creating the index 03/13/2025, 18:38:50
2025-03-13 18:38:50,521 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:38:50
2025-03-13 18:38:50,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:38:50,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:38:50
2025-03-13 18:38:50,522 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:38:50,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.33it/s] 50%|█████     | 6/12 [00:00<00:00, 31.32it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.92it/s]100%|██████████| 12/12 [00:02<00:00,  4.09it/s]
2025-03-13 18:38:53,458 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:38:53
2025-03-13 18:39:39,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1117 secs
2025-03-13 18:39:39,570 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 18:39:39,570 [INFO]: 	Compute fast metrics 03/13/2025, 18:39:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.44it/s]
2025-03-13 18:39:55,272 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7022 secs
2025-03-13 18:39:55,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7522 secs
2025-03-13 18:39:55,275 [INFO]: {
2025-03-13 18:39:55,275 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:55,275 [INFO]: 	index_param: efSearch=170
2025-03-13 18:39:55,275 [INFO]: 	index_path: knn.index
2025-03-13 18:39:55,275 [INFO]: 	size in bytes: 596527150
2025-03-13 18:39:55,275 [INFO]: 	avg_search_speed_ms: 9.647765366823961
2025-03-13 18:39:55,275 [INFO]: 	99p_search_speed_ms: 15.018290560692552
2025-03-13 18:39:55,275 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:55,275 [INFO]: 	nb vectors: 3032
2025-03-13 18:39:55,275 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:55,275 [INFO]: 	compression ratio: 0.9993098486799804
2025-03-13 18:39:55,275 [INFO]: }
2025-03-13 18:39:55,275 [INFO]: 	>>> Finished "Creating the index" in 64.7536 secs
2025-03-13 18:39:55,275 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7833 secs
2025-03-13 18:39:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 91696 [episode count 8/20]
[retrieval_preprocessing] for episode 2103 [episode count 9/20], we have num_retrieval=np.int64(3016) num_query=np.int64(197)
2025-03-13 18:39:56,816 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:57,234 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:57
2025-03-13 18:39:57,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-13 18:39:57,267 [INFO]: There are 3016 embeddings of dim 49152
2025-03-13 18:39:57,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 18:39:57,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:57
2025-03-13 18:39:57,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:57,269 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:39:57,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:57,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:39:57,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:57
2025-03-13 18:39:57,269 [INFO]: 622.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:57,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:39:57,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:57
2025-03-13 18:39:57,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:57,270 [INFO]: 	Creating the index 03/13/2025, 18:39:57
2025-03-13 18:39:57,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:57
2025-03-13 18:39:57,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:39:57,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:57
2025-03-13 18:39:57,273 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:39:57,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.72it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.40it/s]100%|██████████| 12/12 [00:02<00:00,  4.03it/s]100%|██████████| 12/12 [00:02<00:00,  4.92it/s]
2025-03-13 18:39:59,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:59
2025-03-13 18:40:37,968 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2494 secs
2025-03-13 18:40:37,968 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 18:40:37,968 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 18:41:03,239 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2711 secs
2025-03-13 18:41:03,242 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9685 secs
2025-03-13 18:41:03,242 [INFO]: {
2025-03-13 18:41:03,242 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:03,242 [INFO]: 	index_param: efSearch=214
2025-03-13 18:41:03,242 [INFO]: 	index_path: knn.index
2025-03-13 18:41:03,242 [INFO]: 	size in bytes: 593379250
2025-03-13 18:41:03,242 [INFO]: 	avg_search_speed_ms: 9.569447844079807
2025-03-13 18:41:03,242 [INFO]: 	99p_search_speed_ms: 13.779167737811804
2025-03-13 18:41:03,242 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:03,242 [INFO]: 	nb vectors: 3016
2025-03-13 18:41:03,242 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:03,242 [INFO]: 	compression ratio: 0.9993098477912734
2025-03-13 18:41:03,242 [INFO]: }
2025-03-13 18:41:03,242 [INFO]: 	>>> Finished "Creating the index" in 65.9722 secs
2025-03-13 18:41:03,242 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0077 secs
2025-03-13 18:41:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 2103 [episode count 9/20]
[retrieval_preprocessing] for episode 88377 [episode count 10/20], we have num_retrieval=np.int64(3070) num_query=np.int64(143)
2025-03-13 18:41:05,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:05,452 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:05
2025-03-13 18:41:05,452 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.83it/s]
2025-03-13 18:41:05,477 [INFO]: There are 3070 embeddings of dim 49152
2025-03-13 18:41:05,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:41:05,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:05
2025-03-13 18:41:05,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:05,478 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:41:05,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:05,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:05,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:05
2025-03-13 18:41:05,478 [INFO]: 633.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:05,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:05,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:05
2025-03-13 18:41:05,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:05,478 [INFO]: 	Creating the index 03/13/2025, 18:41:05
2025-03-13 18:41:05,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:05
2025-03-13 18:41:05,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:41:05,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:05
2025-03-13 18:41:05,480 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:41:05,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.90it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.08it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.59it/s]100%|██████████| 13/13 [00:02<00:00,  4.98it/s]
2025-03-13 18:41:08,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:08
2025-03-13 18:41:48,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2744 secs
2025-03-13 18:41:48,371 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 18:41:48,371 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.27it/s]
2025-03-13 18:42:12,627 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2559 secs
2025-03-13 18:42:12,629 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1494 secs
2025-03-13 18:42:12,629 [INFO]: {
2025-03-13 18:42:12,629 [INFO]: 	index_key: HNSW15
2025-03-13 18:42:12,629 [INFO]: 	index_param: efSearch=171
2025-03-13 18:42:12,629 [INFO]: 	index_path: knn.index
2025-03-13 18:42:12,629 [INFO]: 	size in bytes: 604003450
2025-03-13 18:42:12,629 [INFO]: 	avg_search_speed_ms: 10.162344889296977
2025-03-13 18:42:12,629 [INFO]: 	99p_search_speed_ms: 15.09491937234997
2025-03-13 18:42:12,629 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:12,629 [INFO]: 	nb vectors: 3070
2025-03-13 18:42:12,629 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:12,629 [INFO]: 	compression ratio: 0.9993097887106439
2025-03-13 18:42:12,629 [INFO]: }
2025-03-13 18:42:12,629 [INFO]: 	>>> Finished "Creating the index" in 67.1511 secs
2025-03-13 18:42:12,629 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1776 secs
2025-03-13 18:42:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 88377 [episode count 10/20]
[retrieval_preprocessing] for episode 36321 [episode count 11/20], we have num_retrieval=np.int64(3029) num_query=np.int64(184)
2025-03-13 18:42:14,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:14,521 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:14
2025-03-13 18:42:14,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-13 18:42:14,548 [INFO]: There are 3029 embeddings of dim 49152
2025-03-13 18:42:14,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 18:42:14,549 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:14,549 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:42:14,549 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:42:14,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:14,549 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,549 [INFO]: 625.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:14,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:42:14,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:14
2025-03-13 18:42:14,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:14,549 [INFO]: 	Creating the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:42:14
2025-03-13 18:42:14,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:42:14,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:14
2025-03-13 18:42:14,551 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:42:14,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.50it/s] 50%|█████     | 6/12 [00:00<00:00, 30.90it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.83it/s]100%|██████████| 12/12 [00:02<00:00,  4.57it/s]
2025-03-13 18:42:17,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:17
2025-03-13 18:43:00,775 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5960 secs
2025-03-13 18:43:00,775 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 18:43:00,775 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.52it/s]
2025-03-13 18:43:22,253 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4784 secs
2025-03-13 18:43:22,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7047 secs
2025-03-13 18:43:22,255 [INFO]: {
2025-03-13 18:43:22,255 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:22,255 [INFO]: 	index_param: efSearch=202
2025-03-13 18:43:22,255 [INFO]: 	index_path: knn.index
2025-03-13 18:43:22,255 [INFO]: 	size in bytes: 595936870
2025-03-13 18:43:22,255 [INFO]: 	avg_search_speed_ms: 9.458283909623816
2025-03-13 18:43:22,255 [INFO]: 	99p_search_speed_ms: 14.187436914071444
2025-03-13 18:43:22,255 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:22,255 [INFO]: 	nb vectors: 3029
2025-03-13 18:43:22,255 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:22,255 [INFO]: 	compression ratio: 0.9993099302615729
2025-03-13 18:43:22,255 [INFO]: }
2025-03-13 18:43:22,255 [INFO]: 	>>> Finished "Creating the index" in 67.7063 secs
2025-03-13 18:43:22,255 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7343 secs
2025-03-13 18:43:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 36321 [episode count 11/20]
[retrieval_preprocessing] for episode 2658 [episode count 12/20], we have num_retrieval=np.int64(3081) num_query=np.int64(132)
2025-03-13 18:43:23,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:23,992 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:23
2025-03-13 18:43:23,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2186.81it/s]
2025-03-13 18:43:24,015 [INFO]: There are 3081 embeddings of dim 49152
2025-03-13 18:43:24,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 18:43:24,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:24
2025-03-13 18:43:24,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:24,015 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:43:24,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:43:24,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:24,015 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:24
2025-03-13 18:43:24,015 [INFO]: 635.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:24,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:24,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:24
2025-03-13 18:43:24,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:24,016 [INFO]: 	Creating the index 03/13/2025, 18:43:24
2025-03-13 18:43:24,016 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:24
2025-03-13 18:43:24,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:43:24,017 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:24
2025-03-13 18:43:24,017 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:43:24,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.58it/s] 62%|██████▏   | 8/13 [00:00<00:00, 41.26it/s]100%|██████████| 13/13 [00:02<00:00,  4.99it/s]100%|██████████| 13/13 [00:02<00:00,  5.98it/s]
2025-03-13 18:43:26,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:26
2025-03-13 18:43:58,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3210 secs
2025-03-13 18:43:58,514 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 18:43:58,514 [INFO]: 	Compute fast metrics 03/13/2025, 18:43:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.71it/s]
2025-03-13 18:44:17,222 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7083 secs
2025-03-13 18:44:17,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2083 secs
2025-03-13 18:44:17,225 [INFO]: {
2025-03-13 18:44:17,225 [INFO]: 	index_key: HNSW15
2025-03-13 18:44:17,225 [INFO]: 	index_param: efSearch=211
2025-03-13 18:44:17,225 [INFO]: 	index_path: knn.index
2025-03-13 18:44:17,225 [INFO]: 	size in bytes: 606167590
2025-03-13 18:44:17,225 [INFO]: 	avg_search_speed_ms: 10.005583898164332
2025-03-13 18:44:17,226 [INFO]: 	99p_search_speed_ms: 14.914642726071177
2025-03-13 18:44:17,226 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:44:17,226 [INFO]: 	nb vectors: 3081
2025-03-13 18:44:17,226 [INFO]: 	vectors dimension: 49152
2025-03-13 18:44:17,226 [INFO]: 	compression ratio: 0.9993098575263649
2025-03-13 18:44:17,226 [INFO]: }
2025-03-13 18:44:17,226 [INFO]: 	>>> Finished "Creating the index" in 53.2100 secs
2025-03-13 18:44:17,226 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2337 secs
2025-03-13 18:44:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:44:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 2658 [episode count 12/20]
[retrieval_preprocessing] for episode 37222 [episode count 13/20], we have num_retrieval=np.int64(3010) num_query=np.int64(203)
2025-03-13 18:44:18,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:44:19,455 [INFO]: Launching the whole pipeline 03/13/2025, 18:44:19
2025-03-13 18:44:19,455 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:44:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-13 18:44:19,480 [INFO]: There are 3010 embeddings of dim 49152
2025-03-13 18:44:19,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 18:44:19,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:44:19,481 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:44:19,481 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:44:19,481 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:44:19,481 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,481 [INFO]: 621.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:44:19,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:44:19,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:44:19
2025-03-13 18:44:19,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:44:19,481 [INFO]: 	Creating the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:44:19
2025-03-13 18:44:19,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:44:19,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:44:19
2025-03-13 18:44:19,482 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:44:19,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.54it/s] 50%|█████     | 6/12 [00:00<00:00, 31.75it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.73it/s]100%|██████████| 12/12 [00:02<00:00,  5.26it/s]
2025-03-13 18:44:21,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:44:21
2025-03-13 18:44:48,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9523 secs
2025-03-13 18:44:48,718 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 18:44:48,718 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.94it/s]
2025-03-13 18:45:12,982 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2642 secs
2025-03-13 18:45:13,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2320 secs
2025-03-13 18:45:13,715 [INFO]: {
2025-03-13 18:45:13,715 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:13,715 [INFO]: 	index_param: efSearch=293
2025-03-13 18:45:13,715 [INFO]: 	index_path: knn.index
2025-03-13 18:45:13,715 [INFO]: 	size in bytes: 592198810
2025-03-13 18:45:13,715 [INFO]: 	avg_search_speed_ms: 12.373933544967988
2025-03-13 18:45:13,715 [INFO]: 	99p_search_speed_ms: 17.136074991431073
2025-03-13 18:45:13,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:13,715 [INFO]: 	nb vectors: 3010
2025-03-13 18:45:13,715 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:13,715 [INFO]: 	compression ratio: 0.9993098094877968
2025-03-13 18:45:13,716 [INFO]: }
2025-03-13 18:45:13,716 [INFO]: 	>>> Finished "Creating the index" in 54.2347 secs
2025-03-13 18:45:13,716 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2609 secs
2025-03-13 18:45:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 37222 [episode count 13/20]
[retrieval_preprocessing] for episode 56807 [episode count 14/20], we have num_retrieval=np.int64(3006) num_query=np.int64(207)
2025-03-13 18:45:18,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:19,410 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:19
2025-03-13 18:45:19,411 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1753.47it/s]
2025-03-13 18:45:19,437 [INFO]: There are 3006 embeddings of dim 49152
2025-03-13 18:45:19,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:45:19,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:19
2025-03-13 18:45:19,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:19,439 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:45:19,439 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:19,439 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:45:19,439 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:19
2025-03-13 18:45:19,439 [INFO]: 620.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:19,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:45:19,440 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:19
2025-03-13 18:45:19,440 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:19,440 [INFO]: 	Creating the index 03/13/2025, 18:45:19
2025-03-13 18:45:19,440 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:19
2025-03-13 18:45:19,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 18:45:19,442 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:19
2025-03-13 18:45:19,443 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:45:19,443 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.01it/s] 33%|███▎      | 4/12 [00:00<00:00, 17.96it/s] 67%|██████▋   | 8/12 [00:00<00:00, 26.03it/s]100%|██████████| 12/12 [00:03<00:00,  2.54it/s]100%|██████████| 12/12 [00:03<00:00,  3.37it/s]
2025-03-13 18:45:23,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:23
2025-03-13 18:46:02,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3528 secs
2025-03-13 18:46:02,368 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 18:46:02,368 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.40it/s]
2025-03-13 18:46:18,561 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1926 secs
2025-03-13 18:46:18,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1205 secs
2025-03-13 18:46:18,563 [INFO]: {
2025-03-13 18:46:18,563 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:18,563 [INFO]: 	index_param: efSearch=163
2025-03-13 18:46:18,563 [INFO]: 	index_path: knn.index
2025-03-13 18:46:18,563 [INFO]: 	size in bytes: 591411850
2025-03-13 18:46:18,563 [INFO]: 	avg_search_speed_ms: 8.929237788626258
2025-03-13 18:46:18,563 [INFO]: 	99p_search_speed_ms: 13.286589523777366
2025-03-13 18:46:18,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:18,563 [INFO]: 	nb vectors: 3006
2025-03-13 18:46:18,563 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:18,563 [INFO]: 	compression ratio: 0.9993097838671985
2025-03-13 18:46:18,563 [INFO]: }
2025-03-13 18:46:18,563 [INFO]: 	>>> Finished "Creating the index" in 59.1235 secs
2025-03-13 18:46:18,563 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1528 secs
2025-03-13 18:46:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 56807 [episode count 14/20]
[retrieval_preprocessing] for episode 64113 [episode count 15/20], we have num_retrieval=np.int64(3084) num_query=np.int64(129)
2025-03-13 18:46:20,103 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:20,550 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:20
2025-03-13 18:46:20,550 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2109.81it/s]
2025-03-13 18:46:20,575 [INFO]: There are 3084 embeddings of dim 49152
2025-03-13 18:46:20,575 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 18:46:20,575 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:20
2025-03-13 18:46:20,575 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:20,575 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:46:20,575 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:20,575 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:20,575 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:20
2025-03-13 18:46:20,575 [INFO]: 636.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:20,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:20,575 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:20
2025-03-13 18:46:20,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:20,575 [INFO]: 	Creating the index 03/13/2025, 18:46:20
2025-03-13 18:46:20,575 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:20
2025-03-13 18:46:20,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:46:20,576 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:20
2025-03-13 18:46:20,577 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:46:20,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.91it/s] 62%|██████▏   | 8/13 [00:00<00:00, 37.16it/s]100%|██████████| 13/13 [00:02<00:00,  4.38it/s]100%|██████████| 13/13 [00:02<00:00,  5.37it/s]
2025-03-13 18:46:23,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:23
2025-03-13 18:46:57,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5320 secs
2025-03-13 18:46:57,533 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 18:46:57,533 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 18:47:20,017 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4846 secs
2025-03-13 18:47:20,019 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4427 secs
2025-03-13 18:47:20,019 [INFO]: {
2025-03-13 18:47:20,019 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:20,019 [INFO]: 	index_param: efSearch=229
2025-03-13 18:47:20,019 [INFO]: 	index_path: knn.index
2025-03-13 18:47:20,019 [INFO]: 	size in bytes: 606757870
2025-03-13 18:47:20,019 [INFO]: 	avg_search_speed_ms: 10.650747679064846
2025-03-13 18:47:20,020 [INFO]: 	99p_search_speed_ms: 14.768576179631054
2025-03-13 18:47:20,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:20,020 [INFO]: 	nb vectors: 3084
2025-03-13 18:47:20,020 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:20,020 [INFO]: 	compression ratio: 0.9993097773911033
2025-03-13 18:47:20,020 [INFO]: }
2025-03-13 18:47:20,020 [INFO]: 	>>> Finished "Creating the index" in 59.4442 secs
2025-03-13 18:47:20,020 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4692 secs
2025-03-13 18:47:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 64113 [episode count 15/20]
[retrieval_preprocessing] for episode 21497 [episode count 16/20], we have num_retrieval=np.int64(3054) num_query=np.int64(159)
2025-03-13 18:47:21,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:22,132 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:22
2025-03-13 18:47:22,132 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1369.79it/s]
2025-03-13 18:47:22,161 [INFO]: There are 3054 embeddings of dim 49152
2025-03-13 18:47:22,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:47:22,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:22
2025-03-13 18:47:22,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:22,162 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:47:22,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:22,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:47:22,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:22
2025-03-13 18:47:22,163 [INFO]: 630.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:22,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:47:22,163 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:22
2025-03-13 18:47:22,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:22,163 [INFO]: 	Creating the index 03/13/2025, 18:47:22
2025-03-13 18:47:22,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:22
2025-03-13 18:47:22,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:47:22,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:22
2025-03-13 18:47:22,167 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:47:22,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 27.05it/s] 69%|██████▉   | 9/13 [00:00<00:00, 42.77it/s]100%|██████████| 13/13 [00:02<00:00,  5.09it/s]
2025-03-13 18:47:24,727 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:24
2025-03-13 18:48:04,021 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2940 secs
2025-03-13 18:48:04,022 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 18:48:04,022 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.73it/s]
2025-03-13 18:48:22,080 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0583 secs
2025-03-13 18:48:22,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9154 secs
2025-03-13 18:48:22,082 [INFO]: {
2025-03-13 18:48:22,082 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:22,082 [INFO]: 	index_param: efSearch=159
2025-03-13 18:48:22,082 [INFO]: 	index_path: knn.index
2025-03-13 18:48:22,082 [INFO]: 	size in bytes: 600855430
2025-03-13 18:48:22,082 [INFO]: 	avg_search_speed_ms: 8.34448284932874
2025-03-13 18:48:22,082 [INFO]: 	99p_search_speed_ms: 11.354197016917169
2025-03-13 18:48:22,082 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:22,082 [INFO]: 	nb vectors: 3054
2025-03-13 18:48:22,082 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:22,082 [INFO]: 	compression ratio: 0.9993099870962304
2025-03-13 18:48:22,082 [INFO]: }
2025-03-13 18:48:22,082 [INFO]: 	>>> Finished "Creating the index" in 59.9189 secs
2025-03-13 18:48:22,082 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9501 secs
2025-03-13 18:48:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 21497 [episode count 16/20]
[retrieval_preprocessing] for episode 10746 [episode count 17/20], we have num_retrieval=np.int64(3048) num_query=np.int64(165)
2025-03-13 18:48:23,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:23,915 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:23
2025-03-13 18:48:23,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.19it/s]
2025-03-13 18:48:23,942 [INFO]: There are 3048 embeddings of dim 49152
2025-03-13 18:48:23,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:48:23,942 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:23
2025-03-13 18:48:23,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:23,942 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:48:23,942 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:23,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:48:23,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:23
2025-03-13 18:48:23,943 [INFO]: 629.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:23,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:48:23,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:23
2025-03-13 18:48:23,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:23,943 [INFO]: 	Creating the index 03/13/2025, 18:48:23
2025-03-13 18:48:23,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:23
2025-03-13 18:48:23,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:48:23,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:23
2025-03-13 18:48:23,944 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:48:23,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.47it/s] 50%|█████     | 6/12 [00:00<00:00, 32.04it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.38it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]
2025-03-13 18:48:26,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:26
2025-03-13 18:49:06,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3080 secs
2025-03-13 18:49:06,069 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 18:49:06,069 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 18:49:25,125 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0558 secs
2025-03-13 18:49:25,127 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1824 secs
2025-03-13 18:49:25,127 [INFO]: {
2025-03-13 18:49:25,127 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:25,127 [INFO]: 	index_param: efSearch=187
2025-03-13 18:49:25,127 [INFO]: 	index_path: knn.index
2025-03-13 18:49:25,127 [INFO]: 	size in bytes: 599674990
2025-03-13 18:49:25,127 [INFO]: 	avg_search_speed_ms: 9.833342489816665
2025-03-13 18:49:25,127 [INFO]: 	99p_search_speed_ms: 13.62229598686099
2025-03-13 18:49:25,127 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:25,127 [INFO]: 	nb vectors: 3048
2025-03-13 18:49:25,127 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:25,127 [INFO]: 	compression ratio: 0.9993099495445025
2025-03-13 18:49:25,127 [INFO]: }
2025-03-13 18:49:25,127 [INFO]: 	>>> Finished "Creating the index" in 61.1838 secs
2025-03-13 18:49:25,127 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2112 secs
2025-03-13 18:49:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 10746 [episode count 17/20]
[retrieval_preprocessing] for episode 22781 [episode count 18/20], we have num_retrieval=np.int64(3055) num_query=np.int64(158)
2025-03-13 18:49:26,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:26,909 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:26
2025-03-13 18:49:26,910 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2172.09it/s]
2025-03-13 18:49:26,933 [INFO]: There are 3055 embeddings of dim 49152
2025-03-13 18:49:26,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 18:49:26,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:26
2025-03-13 18:49:26,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:26,933 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:49:26,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:49:26,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:49:26,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:26
2025-03-13 18:49:26,933 [INFO]: 630.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:26,933 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:49:26,933 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:26
2025-03-13 18:49:26,933 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:26,933 [INFO]: 	Creating the index 03/13/2025, 18:49:26
2025-03-13 18:49:26,933 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:26
2025-03-13 18:49:26,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:49:26,934 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:26
2025-03-13 18:49:26,934 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:49:26,934 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.60it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.81it/s]100%|██████████| 13/13 [00:02<00:00,  4.30it/s]100%|██████████| 13/13 [00:02<00:00,  5.05it/s]
2025-03-13 18:49:29,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:29
2025-03-13 18:50:10,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4090 secs
2025-03-13 18:50:10,922 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 18:50:10,922 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 18:50:28,432 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5103 secs
2025-03-13 18:50:28,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5001 secs
2025-03-13 18:50:28,434 [INFO]: {
2025-03-13 18:50:28,435 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:28,435 [INFO]: 	index_param: efSearch=174
2025-03-13 18:50:28,435 [INFO]: 	index_path: knn.index
2025-03-13 18:50:28,435 [INFO]: 	size in bytes: 601052230
2025-03-13 18:50:28,435 [INFO]: 	avg_search_speed_ms: 10.174185864481457
2025-03-13 18:50:28,435 [INFO]: 	99p_search_speed_ms: 15.811620000749807
2025-03-13 18:50:28,435 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:28,435 [INFO]: 	nb vectors: 3055
2025-03-13 18:50:28,435 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:28,435 [INFO]: 	compression ratio: 0.9993098935844561
2025-03-13 18:50:28,435 [INFO]: }
2025-03-13 18:50:28,435 [INFO]: 	>>> Finished "Creating the index" in 61.5014 secs
2025-03-13 18:50:28,435 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5251 secs
2025-03-13 18:50:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 22781 [episode count 18/20]
[retrieval_preprocessing] for episode 10623 [episode count 19/20], we have num_retrieval=np.int64(3049) num_query=np.int64(164)
2025-03-13 18:50:29,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:30,250 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:30
2025-03-13 18:50:30,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-13 18:50:30,274 [INFO]: There are 3049 embeddings of dim 49152
2025-03-13 18:50:30,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 18:50:30,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:30
2025-03-13 18:50:30,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:30,274 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 18:50:30,274 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:30,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:30,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:30
2025-03-13 18:50:30,274 [INFO]: 629.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:30,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:30,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:30
2025-03-13 18:50:30,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:30,275 [INFO]: 	Creating the index 03/13/2025, 18:50:30
2025-03-13 18:50:30,275 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:30
2025-03-13 18:50:30,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:50:30,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:30
2025-03-13 18:50:30,276 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 18:50:30,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 25.26it/s] 62%|██████▏   | 8/13 [00:00<00:00, 38.67it/s]100%|██████████| 13/13 [00:02<00:00,  4.38it/s]100%|██████████| 13/13 [00:02<00:00,  5.49it/s]
2025-03-13 18:50:32,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:32
2025-03-13 18:51:08,738 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0923 secs
2025-03-13 18:51:08,738 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:51:08,738 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.35it/s]
2025-03-13 18:51:31,283 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5450 secs
2025-03-13 18:51:31,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0101 secs
2025-03-13 18:51:31,286 [INFO]: {
2025-03-13 18:51:31,286 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:31,286 [INFO]: 	index_param: efSearch=216
2025-03-13 18:51:31,286 [INFO]: 	index_path: knn.index
2025-03-13 18:51:31,286 [INFO]: 	size in bytes: 599871730
2025-03-13 18:51:31,286 [INFO]: 	avg_search_speed_ms: 10.407734096571648
2025-03-13 18:51:31,286 [INFO]: 	99p_search_speed_ms: 14.878559624776244
2025-03-13 18:51:31,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:31,286 [INFO]: 	nb vectors: 3049
2025-03-13 18:51:31,287 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:31,287 [INFO]: 	compression ratio: 0.999309955813387
2025-03-13 18:51:31,287 [INFO]: }
2025-03-13 18:51:31,287 [INFO]: 	>>> Finished "Creating the index" in 61.0120 secs
2025-03-13 18:51:31,287 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0363 secs
2025-03-13 18:51:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 10623 [episode count 19/20]
2025-03-13 18:51:32: [retrieval_preprocessing] finished for 2476969100_blocks_in_bowl [chosen_id count 7/196]
2025-03-13 18:51:35: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2515873443_wipe_counter_with_towel [chosen_id count 8/196]
2025-03-13 18:51:35: [retrieval_preprocessing] we have num_total=8326 embedding_dim=49152
[retrieval_preprocessing] for episode 47109 [episode count 0/20], we have num_retrieval=np.int64(7964) num_query=np.int64(362)
2025-03-13 18:51:36,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:37,230 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:37
2025-03-13 18:51:37,230 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2009.73it/s]
2025-03-13 18:51:37,256 [INFO]: There are 7964 embeddings of dim 49152
2025-03-13 18:51:37,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 18:51:37,256 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:37
2025-03-13 18:51:37,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:37,257 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 18:51:37,257 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:37,257 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:51:37,257 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:37
2025-03-13 18:51:37,257 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:37,257 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:51:37,257 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:37
2025-03-13 18:51:37,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:37,257 [INFO]: 	Creating the index 03/13/2025, 18:51:37
2025-03-13 18:51:37,257 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:37
2025-03-13 18:51:37,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:51:37,259 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:37
2025-03-13 18:51:37,259 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:51:37,259 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.77it/s] 15%|█▌        | 5/33 [00:00<00:01, 25.44it/s] 30%|███       | 10/33 [00:00<00:00, 33.57it/s] 45%|████▌     | 15/33 [00:00<00:00, 39.53it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.44it/s] 82%|████████▏ | 27/33 [00:04<00:01,  5.40it/s]100%|██████████| 33/33 [00:06<00:00,  3.98it/s]100%|██████████| 33/33 [00:06<00:00,  5.06it/s]
2025-03-13 18:51:43,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:43
2025-03-13 18:52:36,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5850 secs
2025-03-13 18:52:36,371 [INFO]: The best hyperparameters are: efSearch=379
2025-03-13 18:52:36,372 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.58it/s]
2025-03-13 18:53:08,388 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0162 secs
2025-03-13 18:53:08,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1315 secs
2025-03-13 18:53:08,390 [INFO]: {
2025-03-13 18:53:08,390 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:08,390 [INFO]: 	index_param: efSearch=379
2025-03-13 18:53:08,390 [INFO]: 	index_path: knn.index
2025-03-13 18:53:08,390 [INFO]: 	size in bytes: 1566870130
2025-03-13 18:53:08,390 [INFO]: 	avg_search_speed_ms: 15.647938957434958
2025-03-13 18:53:08,390 [INFO]: 	99p_search_speed_ms: 24.349958058446646
2025-03-13 18:53:08,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:08,390 [INFO]: 	nb vectors: 7964
2025-03-13 18:53:08,390 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:08,390 [INFO]: 	compression ratio: 0.9993081634659792
2025-03-13 18:53:08,390 [INFO]: }
2025-03-13 18:53:08,390 [INFO]: 	>>> Finished "Creating the index" in 91.1332 secs
2025-03-13 18:53:08,390 [INFO]: >>> Finished "Launching the whole pipeline" in 91.1607 secs
2025-03-13 18:53:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 47109 [episode count 0/20]
[retrieval_preprocessing] for episode 64773 [episode count 1/20], we have num_retrieval=np.int64(8013) num_query=np.int64(313)
2025-03-13 18:53:16,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:17,855 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:17
2025-03-13 18:53:17,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.87it/s]
2025-03-13 18:53:17,885 [INFO]: There are 8013 embeddings of dim 49152
2025-03-13 18:53:17,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 18:53:17,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:17
2025-03-13 18:53:17,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:17,886 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 18:53:17,886 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:17,886 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:53:17,886 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:17
2025-03-13 18:53:17,887 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:17,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:53:17,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:17
2025-03-13 18:53:17,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:17,887 [INFO]: 	Creating the index 03/13/2025, 18:53:17
2025-03-13 18:53:17,888 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:17
2025-03-13 18:53:17,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:53:17,891 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:17
2025-03-13 18:53:17,891 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:53:17,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.72it/s] 18%|█▊        | 6/33 [00:00<00:00, 30.95it/s] 33%|███▎      | 11/33 [00:00<00:00, 37.37it/s] 48%|████▊     | 16/33 [00:00<00:00, 40.02it/s] 64%|██████▎   | 21/33 [00:03<00:03,  3.68it/s] 79%|███████▉  | 26/33 [00:03<00:01,  5.49it/s] 97%|█████████▋| 32/33 [00:03<00:00,  8.31it/s]100%|██████████| 33/33 [00:06<00:00,  5.21it/s]
2025-03-13 18:53:24,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:24
2025-03-13 18:54:14,800 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.5644 secs
2025-03-13 18:54:14,800 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 18:54:14,800 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.68it/s]
2025-03-13 18:54:48,898 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0971 secs
2025-03-13 18:54:48,899 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.0085 secs
2025-03-13 18:54:48,900 [INFO]: {
2025-03-13 18:54:48,900 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:48,900 [INFO]: 	index_param: efSearch=289
2025-03-13 18:54:48,900 [INFO]: 	index_path: knn.index
2025-03-13 18:54:48,900 [INFO]: 	size in bytes: 1576510510
2025-03-13 18:54:48,900 [INFO]: 	avg_search_speed_ms: 12.050831144260444
2025-03-13 18:54:48,900 [INFO]: 	99p_search_speed_ms: 20.10032732272521
2025-03-13 18:54:48,900 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:48,900 [INFO]: 	nb vectors: 8013
2025-03-13 18:54:48,900 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:48,900 [INFO]: 	compression ratio: 0.9993082152049846
2025-03-13 18:54:48,900 [INFO]: }
2025-03-13 18:54:48,900 [INFO]: 	>>> Finished "Creating the index" in 91.0122 secs
2025-03-13 18:54:48,900 [INFO]: >>> Finished "Launching the whole pipeline" in 91.0444 secs
2025-03-13 18:54:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 64773 [episode count 1/20]
[retrieval_preprocessing] for episode 90889 [episode count 2/20], we have num_retrieval=np.int64(7938) num_query=np.int64(388)
2025-03-13 18:54:54,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:56,158 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:56
2025-03-13 18:54:56,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 923.25it/s]
2025-03-13 18:54:56,185 [INFO]: There are 7938 embeddings of dim 49152
2025-03-13 18:54:56,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 18:54:56,186 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:56
2025-03-13 18:54:56,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:56,186 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 18:54:56,186 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:56,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:56,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:56
2025-03-13 18:54:56,186 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:56,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:54:56,186 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:56
2025-03-13 18:54:56,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:56,186 [INFO]: 	Creating the index 03/13/2025, 18:54:56
2025-03-13 18:54:56,186 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:56
2025-03-13 18:54:56,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:54:56,187 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:56
2025-03-13 18:54:56,188 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:54:56,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:05,  5.94it/s] 18%|█▊        | 6/33 [00:00<00:01, 23.63it/s] 33%|███▎      | 11/33 [00:00<00:00, 31.34it/s] 48%|████▊     | 16/33 [00:00<00:00, 35.68it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.00it/s] 73%|███████▎  | 24/33 [00:04<00:02,  3.69it/s] 82%|████████▏ | 27/33 [00:05<00:01,  4.53it/s] 88%|████████▊ | 29/33 [00:05<00:00,  5.21it/s] 94%|█████████▍| 31/33 [00:05<00:00,  5.93it/s]100%|██████████| 33/33 [00:08<00:00,  1.90it/s]100%|██████████| 33/33 [00:08<00:00,  3.78it/s]
2025-03-13 18:55:04,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:04
2025-03-13 18:56:09,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3773 secs
2025-03-13 18:56:09,306 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:56:09,306 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-13 18:56:47,428 [INFO]: 	>>> Finished "Compute fast metrics" in 38.1225 secs
2025-03-13 18:56:47,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.2439 secs
2025-03-13 18:56:47,432 [INFO]: {
2025-03-13 18:56:47,432 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:47,432 [INFO]: 	index_param: efSearch=240
2025-03-13 18:56:47,432 [INFO]: 	index_path: knn.index
2025-03-13 18:56:47,432 [INFO]: 	size in bytes: 1561754710
2025-03-13 18:56:47,432 [INFO]: 	avg_search_speed_ms: 13.967628350452776
2025-03-13 18:56:47,432 [INFO]: 	99p_search_speed_ms: 29.539489734452257
2025-03-13 18:56:47,432 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:47,432 [INFO]: 	nb vectors: 7938
2025-03-13 18:56:47,432 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:47,432 [INFO]: 	compression ratio: 0.9993082101862206
2025-03-13 18:56:47,432 [INFO]: }
2025-03-13 18:56:47,432 [INFO]: 	>>> Finished "Creating the index" in 111.2457 secs
2025-03-13 18:56:47,432 [INFO]: >>> Finished "Launching the whole pipeline" in 111.2742 secs
2025-03-13 18:56:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 90889 [episode count 2/20]
[retrieval_preprocessing] for episode 93066 [episode count 3/20], we have num_retrieval=np.int64(7868) num_query=np.int64(458)
2025-03-13 18:56:53,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:55,087 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:55
2025-03-13 18:56:55,087 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1321.04it/s]
2025-03-13 18:56:55,116 [INFO]: There are 7868 embeddings of dim 49152
2025-03-13 18:56:55,117 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:56:55,117 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:55
2025-03-13 18:56:55,117 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:55,117 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 18:56:55,117 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:55,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:55,117 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:55
2025-03-13 18:56:55,117 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:55,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:56:55,117 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:55
2025-03-13 18:56:55,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:55,117 [INFO]: 	Creating the index 03/13/2025, 18:56:55
2025-03-13 18:56:55,117 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:55
2025-03-13 18:56:55,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:56:55,119 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:55
2025-03-13 18:56:55,119 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 18:56:55,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.79it/s] 16%|█▌        | 5/32 [00:00<00:01, 21.07it/s] 28%|██▊       | 9/32 [00:00<00:00, 28.26it/s] 44%|████▍     | 14/32 [00:00<00:00, 33.25it/s] 59%|█████▉    | 19/32 [00:00<00:00, 36.18it/s] 72%|███████▏  | 23/32 [00:04<00:02,  3.36it/s] 91%|█████████ | 29/32 [00:04<00:00,  5.45it/s]100%|██████████| 32/32 [00:06<00:00,  4.83it/s]
2025-03-13 18:57:01,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:57:01
2025-03-13 18:57:56,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0946 secs
2025-03-13 18:57:56,844 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 18:57:56,844 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.41it/s]
2025-03-13 18:58:24,948 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1042 secs
2025-03-13 18:58:25,690 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.5708 secs
2025-03-13 18:58:25,690 [INFO]: {
2025-03-13 18:58:25,690 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:25,690 [INFO]: 	index_param: efSearch=175
2025-03-13 18:58:25,690 [INFO]: 	index_path: knn.index
2025-03-13 18:58:25,690 [INFO]: 	size in bytes: 1547982790
2025-03-13 18:58:25,691 [INFO]: 	avg_search_speed_ms: 8.726971653041415
2025-03-13 18:58:25,691 [INFO]: 	99p_search_speed_ms: 14.678192522842437
2025-03-13 18:58:25,691 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:25,691 [INFO]: 	nb vectors: 7868
2025-03-13 18:58:25,691 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:25,691 [INFO]: 	compression ratio: 0.9993081021268977
2025-03-13 18:58:25,691 [INFO]: }
2025-03-13 18:58:25,691 [INFO]: 	>>> Finished "Creating the index" in 90.5735 secs
2025-03-13 18:58:25,691 [INFO]: >>> Finished "Launching the whole pipeline" in 90.6038 secs
2025-03-13 18:58:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 93066 [episode count 3/20]
[retrieval_preprocessing] for episode 19853 [episode count 4/20], we have num_retrieval=np.int64(7939) num_query=np.int64(387)
2025-03-13 18:58:29,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:30,899 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:30
2025-03-13 18:58:30,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.05it/s]
2025-03-13 18:58:30,929 [INFO]: There are 7939 embeddings of dim 49152
2025-03-13 18:58:30,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 18:58:30,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:30
2025-03-13 18:58:30,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:30,931 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 18:58:30,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:30,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:58:30,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:30
2025-03-13 18:58:30,931 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:30,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:58:30,932 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:30
2025-03-13 18:58:30,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:30,932 [INFO]: 	Creating the index 03/13/2025, 18:58:30
2025-03-13 18:58:30,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:30
2025-03-13 18:58:30,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:58:30,936 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:30
2025-03-13 18:58:30,936 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 18:58:30,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.27it/s] 21%|██        | 7/33 [00:00<00:00, 36.25it/s] 39%|███▉      | 13/33 [00:00<00:00, 44.51it/s] 58%|█████▊    | 19/33 [00:00<00:00, 49.23it/s] 73%|███████▎  | 24/33 [00:03<00:02,  4.23it/s] 91%|█████████ | 30/33 [00:03<00:00,  6.45it/s]100%|██████████| 33/33 [00:06<00:00,  5.11it/s]
2025-03-13 18:58:37,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:37
2025-03-13 18:59:31,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8879 secs
2025-03-13 18:59:31,284 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 18:59:31,284 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.55it/s]
2025-03-13 19:00:26,772 [INFO]: 	>>> Finished "Compute fast metrics" in 55.4874 secs
2025-03-13 19:00:26,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.8382 secs
2025-03-13 19:00:26,774 [INFO]: {
2025-03-13 19:00:26,774 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:26,774 [INFO]: 	index_param: efSearch=235
2025-03-13 19:00:26,774 [INFO]: 	index_path: knn.index
2025-03-13 19:00:26,774 [INFO]: 	size in bytes: 1561951450
2025-03-13 19:00:26,774 [INFO]: 	avg_search_speed_ms: 11.479259545868851
2025-03-13 19:00:26,774 [INFO]: 	99p_search_speed_ms: 20.450349757447828
2025-03-13 19:00:26,774 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:26,774 [INFO]: 	nb vectors: 7939
2025-03-13 19:00:26,774 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:26,774 [INFO]: 	compression ratio: 0.9993082128128886
2025-03-13 19:00:26,774 [INFO]: }
2025-03-13 19:00:26,774 [INFO]: 	>>> Finished "Creating the index" in 115.8421 secs
2025-03-13 19:00:26,774 [INFO]: >>> Finished "Launching the whole pipeline" in 115.8753 secs
2025-03-13 19:00:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 19853 [episode count 4/20]
[retrieval_preprocessing] for episode 42899 [episode count 5/20], we have num_retrieval=np.int64(7966) num_query=np.int64(360)
2025-03-13 19:00:31,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:32,356 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:32
2025-03-13 19:00:32,356 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-13 19:00:32,383 [INFO]: There are 7966 embeddings of dim 49152
2025-03-13 19:00:32,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 19:00:32,384 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:32
2025-03-13 19:00:32,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:32,384 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:00:32,384 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:32,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:32,384 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:32
2025-03-13 19:00:32,384 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:32,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:00:32,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:32
2025-03-13 19:00:32,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:32,384 [INFO]: 	Creating the index 03/13/2025, 19:00:32
2025-03-13 19:00:32,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:32
2025-03-13 19:00:32,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:00:32,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:32
2025-03-13 19:00:32,385 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:00:32,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:05,  5.82it/s] 18%|█▊        | 6/33 [00:00<00:01, 24.32it/s] 33%|███▎      | 11/33 [00:00<00:00, 32.28it/s] 48%|████▊     | 16/33 [00:00<00:00, 36.46it/s] 64%|██████▎   | 21/33 [00:03<00:03,  3.52it/s] 79%|███████▉  | 26/33 [00:04<00:01,  5.25it/s] 94%|█████████▍| 31/33 [00:04<00:00,  7.50it/s]100%|██████████| 33/33 [00:06<00:00,  4.91it/s]
2025-03-13 19:00:39,115 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:39
2025-03-13 19:01:39,952 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8369 secs
2025-03-13 19:01:39,952 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 19:01:39,953 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-13 19:02:25,600 [INFO]: 	>>> Finished "Compute fast metrics" in 45.6474 secs
2025-03-13 19:02:27,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.6155 secs
2025-03-13 19:02:27,001 [INFO]: {
2025-03-13 19:02:27,001 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:27,001 [INFO]: 	index_param: efSearch=257
2025-03-13 19:02:27,001 [INFO]: 	index_path: knn.index
2025-03-13 19:02:27,001 [INFO]: 	size in bytes: 1567263610
2025-03-13 19:02:27,001 [INFO]: 	avg_search_speed_ms: 11.444362165199623
2025-03-13 19:02:27,001 [INFO]: 	99p_search_speed_ms: 18.012078716419634
2025-03-13 19:02:27,001 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:27,001 [INFO]: 	nb vectors: 7966
2025-03-13 19:02:27,002 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:27,002 [INFO]: 	compression ratio: 0.999308168713239
2025-03-13 19:02:27,002 [INFO]: }
2025-03-13 19:02:27,002 [INFO]: 	>>> Finished "Creating the index" in 114.6176 secs
2025-03-13 19:02:27,002 [INFO]: >>> Finished "Launching the whole pipeline" in 114.6453 secs
2025-03-13 19:02:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 42899 [episode count 5/20]
[retrieval_preprocessing] for episode 21525 [episode count 6/20], we have num_retrieval=np.int64(7830) num_query=np.int64(496)
2025-03-13 19:02:33,551 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:36,090 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:36
2025-03-13 19:02:36,091 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.65it/s]
2025-03-13 19:02:36,122 [INFO]: There are 7830 embeddings of dim 49152
2025-03-13 19:02:36,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 19:02:36,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:36
2025-03-13 19:02:36,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:36,123 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:02:36,123 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:36,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:02:36,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:36
2025-03-13 19:02:36,123 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:36,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:02:36,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:36
2025-03-13 19:02:36,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:36,123 [INFO]: 	Creating the index 03/13/2025, 19:02:36
2025-03-13 19:02:36,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:36
2025-03-13 19:02:36,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:02:36,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:36
2025-03-13 19:02:36,125 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:02:36,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.27it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.07it/s] 34%|███▍      | 11/32 [00:00<00:00, 33.09it/s] 47%|████▋     | 15/32 [00:00<00:00, 32.08it/s] 62%|██████▎   | 20/32 [00:00<00:00, 35.79it/s] 75%|███████▌  | 24/32 [00:04<00:02,  2.72it/s] 91%|█████████ | 29/32 [00:05<00:00,  4.12it/s]100%|██████████| 32/32 [00:07<00:00,  4.25it/s]
2025-03-13 19:02:43,865 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:43
2025-03-13 19:03:41,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6691 secs
2025-03-13 19:03:41,535 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 19:03:41,535 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 19:04:16,962 [INFO]: 	>>> Finished "Compute fast metrics" in 35.4272 secs
2025-03-13 19:04:16,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.8392 secs
2025-03-13 19:04:16,964 [INFO]: {
2025-03-13 19:04:16,964 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:16,964 [INFO]: 	index_param: efSearch=287
2025-03-13 19:04:16,964 [INFO]: 	index_path: knn.index
2025-03-13 19:04:16,964 [INFO]: 	size in bytes: 1540506550
2025-03-13 19:04:16,964 [INFO]: 	avg_search_speed_ms: 11.554383510921589
2025-03-13 19:04:16,964 [INFO]: 	99p_search_speed_ms: 17.98305560369046
2025-03-13 19:04:16,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:16,964 [INFO]: 	nb vectors: 7830
2025-03-13 19:04:16,964 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:16,964 [INFO]: 	compression ratio: 0.999308078242186
2025-03-13 19:04:16,964 [INFO]: }
2025-03-13 19:04:16,964 [INFO]: 	>>> Finished "Creating the index" in 100.8412 secs
2025-03-13 19:04:16,964 [INFO]: >>> Finished "Launching the whole pipeline" in 100.8739 secs
2025-03-13 19:04:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 21525 [episode count 6/20]
[retrieval_preprocessing] for episode 36155 [episode count 7/20], we have num_retrieval=np.int64(7785) num_query=np.int64(541)
2025-03-13 19:04:26,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:28,002 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:28
2025-03-13 19:04:28,002 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.01it/s]
2025-03-13 19:04:28,032 [INFO]: There are 7785 embeddings of dim 49152
2025-03-13 19:04:28,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 19:04:28,033 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:28
2025-03-13 19:04:28,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:28,033 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:04:28,033 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:28,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:04:28,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:28
2025-03-13 19:04:28,033 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:28,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:04:28,033 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:28
2025-03-13 19:04:28,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:28,033 [INFO]: 	Creating the index 03/13/2025, 19:04:28
2025-03-13 19:04:28,033 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:28
2025-03-13 19:04:28,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:04:28,035 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:28
2025-03-13 19:04:28,035 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:04:28,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.89it/s] 22%|██▏       | 7/32 [00:00<00:00, 34.34it/s] 41%|████      | 13/32 [00:00<00:00, 43.68it/s] 59%|█████▉    | 19/32 [00:00<00:00, 48.98it/s] 75%|███████▌  | 24/32 [00:03<00:02,  3.92it/s] 94%|█████████▍| 30/32 [00:04<00:00,  5.99it/s]100%|██████████| 32/32 [00:06<00:00,  5.18it/s]
2025-03-13 19:04:34,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:34
2025-03-13 19:05:29,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9818 secs
2025-03-13 19:05:29,199 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 19:05:29,199 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.98it/s]
2025-03-13 19:06:21,404 [INFO]: 	>>> Finished "Compute fast metrics" in 52.2042 secs
2025-03-13 19:06:21,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.3709 secs
2025-03-13 19:06:21,406 [INFO]: {
2025-03-13 19:06:21,406 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:21,406 [INFO]: 	index_param: efSearch=215
2025-03-13 19:06:21,406 [INFO]: 	index_path: knn.index
2025-03-13 19:06:21,406 [INFO]: 	size in bytes: 1531653190
2025-03-13 19:06:21,406 [INFO]: 	avg_search_speed_ms: 8.966321329040433
2025-03-13 19:06:21,406 [INFO]: 	99p_search_speed_ms: 13.357775949407369
2025-03-13 19:06:21,406 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:21,406 [INFO]: 	nb vectors: 7785
2025-03-13 19:06:21,406 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:21,406 [INFO]: 	compression ratio: 0.9993079960875477
2025-03-13 19:06:21,406 [INFO]: }
2025-03-13 19:06:21,406 [INFO]: 	>>> Finished "Creating the index" in 113.3727 secs
2025-03-13 19:06:21,406 [INFO]: >>> Finished "Launching the whole pipeline" in 113.4042 secs
2025-03-13 19:06:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 36155 [episode count 7/20]
[retrieval_preprocessing] for episode 52671 [episode count 8/20], we have num_retrieval=np.int64(7718) num_query=np.int64(608)
2025-03-13 19:06:26,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:27,353 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:27
2025-03-13 19:06:27,354 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1582.16it/s]
2025-03-13 19:06:27,380 [INFO]: There are 7718 embeddings of dim 49152
2025-03-13 19:06:27,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 19:06:27,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:27
2025-03-13 19:06:27,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:27,381 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 19:06:27,381 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:27,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:27,381 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:27
2025-03-13 19:06:27,381 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:27,381 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:06:27,381 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:27
2025-03-13 19:06:27,381 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:27,381 [INFO]: 	Creating the index 03/13/2025, 19:06:27
2025-03-13 19:06:27,381 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:27
2025-03-13 19:06:27,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:06:27,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:27
2025-03-13 19:06:27,382 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:06:27,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.69it/s] 19%|█▉        | 6/32 [00:00<00:00, 29.14it/s] 38%|███▊      | 12/32 [00:00<00:00, 39.69it/s] 53%|█████▎    | 17/32 [00:00<00:00, 43.28it/s] 69%|██████▉   | 22/32 [00:04<00:03,  3.30it/s] 88%|████████▊ | 28/32 [00:04<00:00,  5.20it/s]100%|██████████| 32/32 [00:07<00:00,  3.03it/s]100%|██████████| 32/32 [00:07<00:00,  4.42it/s]
2025-03-13 19:06:34,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:34
2025-03-13 19:07:30,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0144 secs
2025-03-13 19:07:30,634 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:07:30,634 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.87it/s]
2025-03-13 19:08:19,536 [INFO]: 	>>> Finished "Compute fast metrics" in 48.9020 secs
2025-03-13 19:08:19,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.1558 secs
2025-03-13 19:08:19,538 [INFO]: {
2025-03-13 19:08:19,538 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:19,538 [INFO]: 	index_param: efSearch=280
2025-03-13 19:08:19,538 [INFO]: 	index_path: knn.index
2025-03-13 19:08:19,538 [INFO]: 	size in bytes: 1518471310
2025-03-13 19:08:19,538 [INFO]: 	avg_search_speed_ms: 10.373042796398378
2025-03-13 19:08:19,538 [INFO]: 	99p_search_speed_ms: 14.516930859535933
2025-03-13 19:08:19,538 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:19,538 [INFO]: 	nb vectors: 7718
2025-03-13 19:08:19,538 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:19,538 [INFO]: 	compression ratio: 0.9993080106334047
2025-03-13 19:08:19,538 [INFO]: }
2025-03-13 19:08:19,538 [INFO]: 	>>> Finished "Creating the index" in 112.1572 secs
2025-03-13 19:08:19,538 [INFO]: >>> Finished "Launching the whole pipeline" in 112.1847 secs
2025-03-13 19:08:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 52671 [episode count 8/20]
[retrieval_preprocessing] for episode 17192 [episode count 9/20], we have num_retrieval=np.int64(7976) num_query=np.int64(350)
2025-03-13 19:08:27,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:28,827 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:28
2025-03-13 19:08:28,828 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.87it/s]
2025-03-13 19:08:28,855 [INFO]: There are 7976 embeddings of dim 49152
2025-03-13 19:08:28,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 19:08:28,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:28
2025-03-13 19:08:28,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:28,856 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:08:28,856 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:28,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:28,856 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:28
2025-03-13 19:08:28,856 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:28,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:28,856 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:28
2025-03-13 19:08:28,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:28,856 [INFO]: 	Creating the index 03/13/2025, 19:08:28
2025-03-13 19:08:28,856 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:28
2025-03-13 19:08:28,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 19:08:28,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:28
2025-03-13 19:08:28,859 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:08:28,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:06,  5.28it/s]  9%|▉         | 3/33 [00:00<00:02, 10.83it/s] 18%|█▊        | 6/33 [00:00<00:01, 17.40it/s] 30%|███       | 10/33 [00:00<00:00, 23.07it/s] 42%|████▏     | 14/33 [00:00<00:00, 26.28it/s] 55%|█████▍    | 18/33 [00:00<00:00, 28.42it/s] 64%|██████▎   | 21/33 [00:05<00:05,  2.20it/s] 79%|███████▉  | 26/33 [00:05<00:01,  3.61it/s] 94%|█████████▍| 31/33 [00:05<00:00,  5.48it/s]100%|██████████| 33/33 [00:08<00:00,  3.99it/s]
2025-03-13 19:08:37,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:37
2025-03-13 19:09:31,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.4552 secs
2025-03-13 19:09:31,588 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 19:09:31,588 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.67it/s]
2025-03-13 19:09:58,842 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2544 secs
2025-03-13 19:09:58,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.9858 secs
2025-03-13 19:09:58,844 [INFO]: {
2025-03-13 19:09:58,845 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:58,845 [INFO]: 	index_param: efSearch=175
2025-03-13 19:09:58,845 [INFO]: 	index_path: knn.index
2025-03-13 19:09:58,845 [INFO]: 	size in bytes: 1569231010
2025-03-13 19:09:58,845 [INFO]: 	avg_search_speed_ms: 7.9064608619662495
2025-03-13 19:09:58,845 [INFO]: 	99p_search_speed_ms: 14.2203726619482
2025-03-13 19:09:58,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:58,845 [INFO]: 	nb vectors: 7976
2025-03-13 19:09:58,845 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:58,845 [INFO]: 	compression ratio: 0.9993081949100662
2025-03-13 19:09:58,845 [INFO]: }
2025-03-13 19:09:58,845 [INFO]: 	>>> Finished "Creating the index" in 89.9884 secs
2025-03-13 19:09:58,845 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0171 secs
2025-03-13 19:10:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 17192 [episode count 9/20]
[retrieval_preprocessing] for episode 49832 [episode count 10/20], we have num_retrieval=np.int64(7835) num_query=np.int64(491)
2025-03-13 19:10:02,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:04,917 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:04
2025-03-13 19:10:04,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 877.65it/s]
2025-03-13 19:10:04,948 [INFO]: There are 7835 embeddings of dim 49152
2025-03-13 19:10:04,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 19:10:04,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:04
2025-03-13 19:10:04,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:04,948 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:10:04,948 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:10:04,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:04,948 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:04
2025-03-13 19:10:04,948 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:04,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:10:04,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:04
2025-03-13 19:10:04,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:04,949 [INFO]: 	Creating the index 03/13/2025, 19:10:04
2025-03-13 19:10:04,949 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:04
2025-03-13 19:10:04,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:10:04,950 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:04
2025-03-13 19:10:04,950 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:10:04,950 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.55it/s] 16%|█▌        | 5/32 [00:00<00:01, 22.64it/s] 31%|███▏      | 10/32 [00:00<00:00, 31.82it/s] 50%|█████     | 16/32 [00:00<00:00, 39.47it/s] 66%|██████▌   | 21/32 [00:03<00:02,  3.73it/s] 81%|████████▏ | 26/32 [00:03<00:01,  5.50it/s]100%|██████████| 32/32 [00:06<00:00,  3.74it/s]100%|██████████| 32/32 [00:06<00:00,  5.00it/s]
2025-03-13 19:10:11,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:11
2025-03-13 19:11:11,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6214 secs
2025-03-13 19:11:11,974 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 19:11:11,974 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 19:11:43,389 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4143 secs
2025-03-13 19:11:43,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.4405 secs
2025-03-13 19:11:43,391 [INFO]: {
2025-03-13 19:11:43,391 [INFO]: 	index_key: HNSW15
2025-03-13 19:11:43,391 [INFO]: 	index_param: efSearch=238
2025-03-13 19:11:43,391 [INFO]: 	index_path: knn.index
2025-03-13 19:11:43,391 [INFO]: 	size in bytes: 1541490310
2025-03-13 19:11:43,391 [INFO]: 	avg_search_speed_ms: 10.549769285164443
2025-03-13 19:11:43,391 [INFO]: 	99p_search_speed_ms: 15.883018036838621
2025-03-13 19:11:43,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:11:43,391 [INFO]: 	nb vectors: 7835
2025-03-13 19:11:43,391 [INFO]: 	vectors dimension: 49152
2025-03-13 19:11:43,391 [INFO]: 	compression ratio: 0.9993080527376134
2025-03-13 19:11:43,391 [INFO]: }
2025-03-13 19:11:43,391 [INFO]: 	>>> Finished "Creating the index" in 98.4422 secs
2025-03-13 19:11:43,391 [INFO]: >>> Finished "Launching the whole pipeline" in 98.4736 secs
2025-03-13 19:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:11:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 49832 [episode count 10/20]
[retrieval_preprocessing] for episode 76719 [episode count 11/20], we have num_retrieval=np.int64(8000) num_query=np.int64(326)
2025-03-13 19:11:48,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:50,817 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:50
2025-03-13 19:11:50,817 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.24it/s]
2025-03-13 19:11:50,844 [INFO]: There are 8000 embeddings of dim 49152
2025-03-13 19:11:50,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 19:11:50,844 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:50
2025-03-13 19:11:50,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:50,844 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:11:50,844 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:50,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:11:50,844 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:50
2025-03-13 19:11:50,844 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:50,845 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:11:50,845 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:50
2025-03-13 19:11:50,845 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:50,845 [INFO]: 	Creating the index 03/13/2025, 19:11:50
2025-03-13 19:11:50,845 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:50
2025-03-13 19:11:50,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:11:50,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:50
2025-03-13 19:11:50,846 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:11:50,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  6%|▌         | 2/33 [00:00<00:01, 16.67it/s] 24%|██▍       | 8/33 [00:00<00:00, 37.73it/s] 42%|████▏     | 14/33 [00:00<00:00, 44.76it/s] 61%|██████    | 20/33 [00:00<00:00, 48.27it/s] 76%|███████▌  | 25/33 [00:04<00:02,  3.63it/s] 91%|█████████ | 30/33 [00:04<00:00,  5.21it/s]100%|██████████| 33/33 [00:07<00:00,  4.71it/s]
2025-03-13 19:11:57,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:57
2025-03-13 19:12:55,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6301 secs
2025-03-13 19:12:55,485 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:12:55,485 [INFO]: 	Compute fast metrics 03/13/2025, 19:12:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 19:13:30,016 [INFO]: 	>>> Finished "Compute fast metrics" in 34.5308 secs
2025-03-13 19:13:30,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.1720 secs
2025-03-13 19:13:30,018 [INFO]: {
2025-03-13 19:13:30,018 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:30,018 [INFO]: 	index_param: efSearch=280
2025-03-13 19:13:30,018 [INFO]: 	index_path: knn.index
2025-03-13 19:13:30,018 [INFO]: 	size in bytes: 1573952890
2025-03-13 19:13:30,018 [INFO]: 	avg_search_speed_ms: 12.289938931948338
2025-03-13 19:13:30,018 [INFO]: 	99p_search_speed_ms: 24.878758522681892
2025-03-13 19:13:30,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:30,018 [INFO]: 	nb vectors: 8000
2025-03-13 19:13:30,018 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:30,018 [INFO]: 	compression ratio: 0.9993081813268249
2025-03-13 19:13:30,018 [INFO]: }
2025-03-13 19:13:30,018 [INFO]: 	>>> Finished "Creating the index" in 99.1736 secs
2025-03-13 19:13:30,018 [INFO]: >>> Finished "Launching the whole pipeline" in 99.2009 secs
2025-03-13 19:13:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 76719 [episode count 11/20]
[retrieval_preprocessing] for episode 85431 [episode count 12/20], we have num_retrieval=np.int64(8053) num_query=np.int64(273)
2025-03-13 19:13:34,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:36,143 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:36
2025-03-13 19:13:36,143 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2156.45it/s]
2025-03-13 19:13:36,171 [INFO]: There are 8053 embeddings of dim 49152
2025-03-13 19:13:36,171 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 19:13:36,171 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:36
2025-03-13 19:13:36,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:36,171 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:13:36,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:36,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:13:36,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:36
2025-03-13 19:13:36,172 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:36,172 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:13:36,172 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:36
2025-03-13 19:13:36,172 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:36,172 [INFO]: 	Creating the index 03/13/2025, 19:13:36
2025-03-13 19:13:36,172 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:36
2025-03-13 19:13:36,174 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 19:13:36,174 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:36
2025-03-13 19:13:36,174 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:13:36,174 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.36it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.53it/s] 33%|███▎      | 11/33 [00:00<00:00, 35.95it/s] 52%|█████▏    | 17/33 [00:00<00:00, 43.16it/s] 67%|██████▋   | 22/33 [00:04<00:03,  3.45it/s] 85%|████████▍ | 28/33 [00:04<00:00,  5.38it/s]100%|██████████| 33/33 [00:07<00:00,  3.28it/s]100%|██████████| 33/33 [00:07<00:00,  4.62it/s]
2025-03-13 19:13:43,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:43
2025-03-13 19:14:41,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7123 secs
2025-03-13 19:14:41,042 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:14:41,042 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 19:15:22,027 [INFO]: 	>>> Finished "Compute fast metrics" in 40.9847 secs
2025-03-13 19:15:22,029 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.8550 secs
2025-03-13 19:15:22,029 [INFO]: {
2025-03-13 19:15:22,029 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:22,029 [INFO]: 	index_param: efSearch=280
2025-03-13 19:15:22,029 [INFO]: 	index_path: knn.index
2025-03-13 19:15:22,029 [INFO]: 	size in bytes: 1584380290
2025-03-13 19:15:22,029 [INFO]: 	avg_search_speed_ms: 11.771772911991267
2025-03-13 19:15:22,029 [INFO]: 	99p_search_speed_ms: 17.73176013957709
2025-03-13 19:15:22,029 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:22,029 [INFO]: 	nb vectors: 8053
2025-03-13 19:15:22,029 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:22,029 [INFO]: 	compression ratio: 0.9993082052289353
2025-03-13 19:15:22,029 [INFO]: }
2025-03-13 19:15:22,029 [INFO]: 	>>> Finished "Creating the index" in 105.8573 secs
2025-03-13 19:15:22,029 [INFO]: >>> Finished "Launching the whole pipeline" in 105.8864 secs
2025-03-13 19:15:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 85431 [episode count 12/20]
[retrieval_preprocessing] for episode 39112 [episode count 13/20], we have num_retrieval=np.int64(7941) num_query=np.int64(385)
2025-03-13 19:15:25,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:26,992 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:26
2025-03-13 19:15:26,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.92it/s]
2025-03-13 19:15:27,022 [INFO]: There are 7941 embeddings of dim 49152
2025-03-13 19:15:27,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 19:15:27,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:27,024 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:15:27,024 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:27,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 19:15:27,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,024 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:27,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:15:27,025 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:27
2025-03-13 19:15:27,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:27,025 [INFO]: 	Creating the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,025 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:27
2025-03-13 19:15:27,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:15:27,028 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:27
2025-03-13 19:15:27,029 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:15:27,029 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  9.00it/s] 21%|██        | 7/33 [00:00<00:00, 35.19it/s] 39%|███▉      | 13/33 [00:00<00:00, 43.66it/s] 58%|█████▊    | 19/33 [00:00<00:00, 48.00it/s] 73%|███████▎  | 24/33 [00:04<00:02,  3.12it/s] 88%|████████▊ | 29/33 [00:04<00:00,  4.50it/s]100%|██████████| 33/33 [00:08<00:00,  2.58it/s]100%|██████████| 33/33 [00:08<00:00,  3.98it/s]
2025-03-13 19:15:35,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:35
2025-03-13 19:16:30,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1763 secs
2025-03-13 19:16:30,497 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 19:16:30,497 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 19:16:58,276 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7786 secs
2025-03-13 19:16:58,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2498 secs
2025-03-13 19:16:58,278 [INFO]: {
2025-03-13 19:16:58,278 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:58,279 [INFO]: 	index_param: efSearch=292
2025-03-13 19:16:58,279 [INFO]: 	index_path: knn.index
2025-03-13 19:16:58,279 [INFO]: 	size in bytes: 1562344930
2025-03-13 19:16:58,279 [INFO]: 	avg_search_speed_ms: 11.916769654584407
2025-03-13 19:16:58,279 [INFO]: 	99p_search_speed_ms: 17.305021220818162
2025-03-13 19:16:58,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:58,279 [INFO]: 	nb vectors: 7941
2025-03-13 19:16:58,279 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:58,279 [INFO]: 	compression ratio: 0.9993082180642402
2025-03-13 19:16:58,279 [INFO]: }
2025-03-13 19:16:58,279 [INFO]: 	>>> Finished "Creating the index" in 91.2537 secs
2025-03-13 19:16:58,279 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2865 secs
2025-03-13 19:17:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:17:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 39112 [episode count 13/20]
[retrieval_preprocessing] for episode 42953 [episode count 14/20], we have num_retrieval=np.int64(7982) num_query=np.int64(344)
2025-03-13 19:17:03,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:17:04,296 [INFO]: Launching the whole pipeline 03/13/2025, 19:17:04
2025-03-13 19:17:04,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:17:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1639.04it/s]
2025-03-13 19:17:04,321 [INFO]: There are 7982 embeddings of dim 49152
2025-03-13 19:17:04,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 19:17:04,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:17:04
2025-03-13 19:17:04,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:17:04,322 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:17:04,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:17:04,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:17:04,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:17:04
2025-03-13 19:17:04,322 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:17:04,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:17:04,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:17:04
2025-03-13 19:17:04,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:17:04,322 [INFO]: 	Creating the index 03/13/2025, 19:17:04
2025-03-13 19:17:04,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:17:04
2025-03-13 19:17:04,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:17:04,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:17:04
2025-03-13 19:17:04,324 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:17:04,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.81it/s] 21%|██        | 7/33 [00:00<00:00, 33.81it/s] 39%|███▉      | 13/33 [00:00<00:00, 42.03it/s] 58%|█████▊    | 19/33 [00:00<00:00, 45.90it/s] 73%|███████▎  | 24/33 [00:04<00:02,  3.66it/s] 91%|█████████ | 30/33 [00:04<00:00,  5.61it/s]100%|██████████| 33/33 [00:06<00:00,  4.82it/s]
2025-03-13 19:17:11,171 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:11
2025-03-13 19:18:04,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6129 secs
2025-03-13 19:18:04,784 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 19:18:04,784 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 19:18:28,268 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4840 secs
2025-03-13 19:18:28,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.9466 secs
2025-03-13 19:18:28,270 [INFO]: {
2025-03-13 19:18:28,270 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:28,270 [INFO]: 	index_param: efSearch=208
2025-03-13 19:18:28,270 [INFO]: 	index_path: knn.index
2025-03-13 19:18:28,270 [INFO]: 	size in bytes: 1570411510
2025-03-13 19:18:28,270 [INFO]: 	avg_search_speed_ms: 9.130877136894965
2025-03-13 19:18:28,270 [INFO]: 	99p_search_speed_ms: 14.261069125495847
2025-03-13 19:18:28,270 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:28,270 [INFO]: 	nb vectors: 7982
2025-03-13 19:18:28,270 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:28,270 [INFO]: 	compression ratio: 0.9993081724165407
2025-03-13 19:18:28,270 [INFO]: }
2025-03-13 19:18:28,270 [INFO]: 	>>> Finished "Creating the index" in 83.9484 secs
2025-03-13 19:18:28,270 [INFO]: >>> Finished "Launching the whole pipeline" in 83.9743 secs
2025-03-13 19:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 42953 [episode count 14/20]
[retrieval_preprocessing] for episode 14798 [episode count 15/20], we have num_retrieval=np.int64(7847) num_query=np.int64(479)
2025-03-13 19:18:30,942 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:32,423 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:32
2025-03-13 19:18:32,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.26it/s]
2025-03-13 19:18:32,449 [INFO]: There are 7847 embeddings of dim 49152
2025-03-13 19:18:32,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 19:18:32,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:32
2025-03-13 19:18:32,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:32,450 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:18:32,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:32,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:18:32,451 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:32
2025-03-13 19:18:32,451 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:32,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:18:32,451 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:32
2025-03-13 19:18:32,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:32,452 [INFO]: 	Creating the index 03/13/2025, 19:18:32
2025-03-13 19:18:32,452 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:32
2025-03-13 19:18:32,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:18:32,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:32
2025-03-13 19:18:32,455 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:18:32,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 17.19it/s] 25%|██▌       | 8/32 [00:00<00:00, 38.90it/s] 44%|████▍     | 14/32 [00:00<00:00, 46.69it/s] 62%|██████▎   | 20/32 [00:00<00:00, 50.40it/s] 81%|████████▏ | 26/32 [00:03<00:01,  4.90it/s]100%|██████████| 32/32 [00:05<00:00,  3.88it/s]100%|██████████| 32/32 [00:05<00:00,  5.73it/s]
2025-03-13 19:18:38,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:38
2025-03-13 19:19:31,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1926 secs
2025-03-13 19:19:31,241 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 19:19:31,241 [INFO]: 	Compute fast metrics 03/13/2025, 19:19:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-13 19:20:01,926 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6853 secs
2025-03-13 19:20:01,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.4731 secs
2025-03-13 19:20:01,928 [INFO]: {
2025-03-13 19:20:01,928 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:01,928 [INFO]: 	index_param: efSearch=314
2025-03-13 19:20:01,928 [INFO]: 	index_path: knn.index
2025-03-13 19:20:01,928 [INFO]: 	size in bytes: 1543851190
2025-03-13 19:20:01,929 [INFO]: 	avg_search_speed_ms: 15.499275418477069
2025-03-13 19:20:01,929 [INFO]: 	99p_search_speed_ms: 26.765908999368527
2025-03-13 19:20:01,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:01,929 [INFO]: 	nb vectors: 7847
2025-03-13 19:20:01,929 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:01,929 [INFO]: 	compression ratio: 0.9993080848679464
2025-03-13 19:20:01,929 [INFO]: }
2025-03-13 19:20:01,929 [INFO]: 	>>> Finished "Creating the index" in 89.4768 secs
2025-03-13 19:20:01,929 [INFO]: >>> Finished "Launching the whole pipeline" in 89.5058 secs
2025-03-13 19:20:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 14798 [episode count 15/20]
[retrieval_preprocessing] for episode 41294 [episode count 16/20], we have num_retrieval=np.int64(7862) num_query=np.int64(464)
2025-03-13 19:20:08,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:09,215 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:09
2025-03-13 19:20:09,215 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-13 19:20:09,242 [INFO]: There are 7862 embeddings of dim 49152
2025-03-13 19:20:09,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 19:20:09,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:09
2025-03-13 19:20:09,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:09,242 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:20:09,242 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:09,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:20:09,242 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:09
2025-03-13 19:20:09,242 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:09,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:20:09,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:09
2025-03-13 19:20:09,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:09,243 [INFO]: 	Creating the index 03/13/2025, 19:20:09
2025-03-13 19:20:09,243 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:09
2025-03-13 19:20:09,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:20:09,244 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:09
2025-03-13 19:20:09,244 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:20:09,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.21it/s] 22%|██▏       | 7/32 [00:00<00:00, 33.54it/s] 41%|████      | 13/32 [00:00<00:00, 43.27it/s] 59%|█████▉    | 19/32 [00:00<00:00, 48.47it/s] 75%|███████▌  | 24/32 [00:03<00:02,  3.87it/s] 88%|████████▊ | 28/32 [00:04<00:00,  4.61it/s] 97%|█████████▋| 31/32 [00:04<00:00,  5.61it/s]100%|██████████| 32/32 [00:06<00:00,  4.60it/s]
2025-03-13 19:20:16,206 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:16
2025-03-13 19:21:10,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.4510 secs
2025-03-13 19:21:10,658 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 19:21:10,658 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-13 19:21:52,363 [INFO]: 	>>> Finished "Compute fast metrics" in 41.7048 secs
2025-03-13 19:21:52,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.1211 secs
2025-03-13 19:21:52,365 [INFO]: {
2025-03-13 19:21:52,365 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:52,365 [INFO]: 	index_param: efSearch=280
2025-03-13 19:21:52,365 [INFO]: 	index_path: knn.index
2025-03-13 19:21:52,365 [INFO]: 	size in bytes: 1546802350
2025-03-13 19:21:52,365 [INFO]: 	avg_search_speed_ms: 10.95101645324473
2025-03-13 19:21:52,365 [INFO]: 	99p_search_speed_ms: 16.920062666758895
2025-03-13 19:21:52,365 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:52,365 [INFO]: 	nb vectors: 7862
2025-03-13 19:21:52,365 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:52,365 [INFO]: 	compression ratio: 0.9993080861300735
2025-03-13 19:21:52,365 [INFO]: }
2025-03-13 19:21:52,365 [INFO]: 	>>> Finished "Creating the index" in 103.1226 secs
2025-03-13 19:21:52,365 [INFO]: >>> Finished "Launching the whole pipeline" in 103.1502 secs
2025-03-13 19:21:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 41294 [episode count 16/20]
[retrieval_preprocessing] for episode 65273 [episode count 17/20], we have num_retrieval=np.int64(7871) num_query=np.int64(455)
2025-03-13 19:21:58,046 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:59,315 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:59
2025-03-13 19:21:59,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.73it/s]
2025-03-13 19:21:59,342 [INFO]: There are 7871 embeddings of dim 49152
2025-03-13 19:21:59,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 19:21:59,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:59
2025-03-13 19:21:59,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:59,342 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:21:59,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:59,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:59,342 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:59
2025-03-13 19:21:59,342 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:59,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:21:59,342 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:59
2025-03-13 19:21:59,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:59,343 [INFO]: 	Creating the index 03/13/2025, 19:21:59
2025-03-13 19:21:59,343 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:59
2025-03-13 19:21:59,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:21:59,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:59
2025-03-13 19:21:59,344 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:21:59,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.52it/s] 22%|██▏       | 7/32 [00:00<00:00, 34.60it/s] 41%|████      | 13/32 [00:00<00:00, 44.30it/s] 59%|█████▉    | 19/32 [00:00<00:00, 49.28it/s] 75%|███████▌  | 24/32 [00:03<00:02,  3.90it/s] 91%|█████████ | 29/32 [00:04<00:00,  5.58it/s]100%|██████████| 32/32 [00:06<00:00,  5.02it/s]
2025-03-13 19:22:05,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:05
2025-03-13 19:22:59,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0976 secs
2025-03-13 19:22:59,819 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 19:22:59,819 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 19:23:28,151 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3316 secs
2025-03-13 19:23:28,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.8093 secs
2025-03-13 19:23:28,153 [INFO]: {
2025-03-13 19:23:28,153 [INFO]: 	index_key: HNSW15
2025-03-13 19:23:28,153 [INFO]: 	index_param: efSearch=206
2025-03-13 19:23:28,153 [INFO]: 	index_path: knn.index
2025-03-13 19:23:28,153 [INFO]: 	size in bytes: 1548573010
2025-03-13 19:23:28,154 [INFO]: 	avg_search_speed_ms: 9.129585654272555
2025-03-13 19:23:28,154 [INFO]: 	99p_search_speed_ms: 13.828799955081186
2025-03-13 19:23:28,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:23:28,154 [INFO]: 	nb vectors: 7871
2025-03-13 19:23:28,154 [INFO]: 	vectors dimension: 49152
2025-03-13 19:23:28,154 [INFO]: 	compression ratio: 0.9993081101161643
2025-03-13 19:23:28,154 [INFO]: }
2025-03-13 19:23:28,154 [INFO]: 	>>> Finished "Creating the index" in 88.8111 secs
2025-03-13 19:23:28,154 [INFO]: >>> Finished "Launching the whole pipeline" in 88.8386 secs
2025-03-13 19:23:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:23:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 65273 [episode count 17/20]
[retrieval_preprocessing] for episode 71127 [episode count 18/20], we have num_retrieval=np.int64(7876) num_query=np.int64(450)
2025-03-13 19:23:32,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:23:33,498 [INFO]: Launching the whole pipeline 03/13/2025, 19:23:33
2025-03-13 19:23:33,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:23:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1718.27it/s]
2025-03-13 19:23:33,781 [INFO]: There are 7876 embeddings of dim 49152
2025-03-13 19:23:33,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2830 secs
2025-03-13 19:23:33,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:23:33
2025-03-13 19:23:33,781 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:23:33,782 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 19:23:33,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:23:33,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:23:33,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:23:33
2025-03-13 19:23:33,782 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:23:33,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:23:33,782 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:23:33
2025-03-13 19:23:33,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:23:33,782 [INFO]: 	Creating the index 03/13/2025, 19:23:33
2025-03-13 19:23:33,782 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:23:33
2025-03-13 19:23:33,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:23:33,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:23:33
2025-03-13 19:23:33,783 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 19:23:33,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.68it/s] 22%|██▏       | 7/32 [00:00<00:00, 38.49it/s] 44%|████▍     | 14/32 [00:00<00:00, 49.42it/s] 66%|██████▌   | 21/32 [00:03<00:02,  4.48it/s] 84%|████████▍ | 27/32 [00:03<00:00,  6.69it/s]100%|██████████| 32/32 [00:06<00:00,  3.98it/s]100%|██████████| 32/32 [00:06<00:00,  5.24it/s]
2025-03-13 19:23:39,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:23:39
2025-03-13 19:24:33,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8275 secs
2025-03-13 19:24:33,718 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 19:24:33,718 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-13 19:24:58,655 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9372 secs
2025-03-13 19:24:58,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.8739 secs
2025-03-13 19:24:58,657 [INFO]: {
2025-03-13 19:24:58,657 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:58,657 [INFO]: 	index_param: efSearch=229
2025-03-13 19:24:58,657 [INFO]: 	index_path: knn.index
2025-03-13 19:24:58,657 [INFO]: 	size in bytes: 1549556710
2025-03-13 19:24:58,657 [INFO]: 	avg_search_speed_ms: 9.016256220134881
2025-03-13 19:24:58,657 [INFO]: 	99p_search_speed_ms: 15.994430752471096
2025-03-13 19:24:58,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:58,657 [INFO]: 	nb vectors: 7876
2025-03-13 19:24:58,657 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:58,657 [INFO]: 	compression ratio: 0.9993081234180838
2025-03-13 19:24:58,657 [INFO]: }
2025-03-13 19:24:58,657 [INFO]: 	>>> Finished "Creating the index" in 84.8753 secs
2025-03-13 19:24:58,657 [INFO]: >>> Finished "Launching the whole pipeline" in 85.1589 secs
2025-03-13 19:25:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 71127 [episode count 18/20]
[retrieval_preprocessing] for episode 82905 [episode count 19/20], we have num_retrieval=np.int64(7930) num_query=np.int64(396)
2025-03-13 19:25:03,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:05,165 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:05
2025-03-13 19:25:05,165 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-13 19:25:05,194 [INFO]: There are 7930 embeddings of dim 49152
2025-03-13 19:25:05,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 19:25:05,194 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:05
2025-03-13 19:25:05,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:05,194 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 19:25:05,194 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:05,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:05,194 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:05
2025-03-13 19:25:05,194 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:05,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:25:05,194 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:05
2025-03-13 19:25:05,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:05,195 [INFO]: 	Creating the index 03/13/2025, 19:25:05
2025-03-13 19:25:05,195 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:05
2025-03-13 19:25:05,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:25:05,196 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:05
2025-03-13 19:25:05,196 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 19:25:05,196 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.58it/s] 18%|█▊        | 6/33 [00:00<00:00, 31.03it/s] 36%|███▋      | 12/33 [00:00<00:00, 41.57it/s] 55%|█████▍    | 18/33 [00:00<00:00, 46.36it/s] 70%|██████▉   | 23/33 [00:03<00:02,  3.96it/s] 88%|████████▊ | 29/33 [00:03<00:00,  6.12it/s]100%|██████████| 33/33 [00:06<00:00,  5.36it/s]
2025-03-13 19:25:11,353 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:11
2025-03-13 19:26:06,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.0296 secs
2025-03-13 19:26:06,384 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 19:26:06,384 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-13 19:26:45,740 [INFO]: 	>>> Finished "Compute fast metrics" in 39.3558 secs
2025-03-13 19:26:45,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.5461 secs
2025-03-13 19:26:45,742 [INFO]: {
2025-03-13 19:26:45,742 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:45,742 [INFO]: 	index_param: efSearch=305
2025-03-13 19:26:45,742 [INFO]: 	index_path: knn.index
2025-03-13 19:26:45,742 [INFO]: 	size in bytes: 1560180790
2025-03-13 19:26:45,742 [INFO]: 	avg_search_speed_ms: 14.40128157947132
2025-03-13 19:26:45,742 [INFO]: 	99p_search_speed_ms: 25.739879910833935
2025-03-13 19:26:45,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:45,742 [INFO]: 	nb vectors: 7930
2025-03-13 19:26:45,742 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:45,742 [INFO]: 	compression ratio: 0.9993081891490281
2025-03-13 19:26:45,743 [INFO]: }
2025-03-13 19:26:45,743 [INFO]: 	>>> Finished "Creating the index" in 100.5480 secs
2025-03-13 19:26:45,743 [INFO]: >>> Finished "Launching the whole pipeline" in 100.5775 secs
2025-03-13 19:26:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 82905 [episode count 19/20]
2025-03-13 19:26:50: [retrieval_preprocessing] finished for 2515873443_wipe_counter_with_towel [chosen_id count 8/196]
2025-03-13 19:26:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2515873443_wipe_counter_with_cloth [chosen_id count 9/196]
2025-03-13 19:26:52: [retrieval_preprocessing] we have num_total=7270 embedding_dim=49152
[retrieval_preprocessing] for episode 59783 [episode count 0/20], we have num_retrieval=np.int64(6895) num_query=np.int64(375)
2025-03-13 19:26:53,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:54,588 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:54
2025-03-13 19:26:54,588 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1265.25it/s]
2025-03-13 19:26:54,620 [INFO]: There are 6895 embeddings of dim 49152
2025-03-13 19:26:54,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 19:26:54,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:54
2025-03-13 19:26:54,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:54,621 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:26:54,621 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:54,621 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:26:54,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:54
2025-03-13 19:26:54,621 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:54,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:26:54,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:54
2025-03-13 19:26:54,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:54,621 [INFO]: 	Creating the index 03/13/2025, 19:26:54
2025-03-13 19:26:54,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:54
2025-03-13 19:26:54,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:26:54,623 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:54
2025-03-13 19:26:54,623 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:26:54,623 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  5.74it/s] 21%|██        | 6/29 [00:00<00:00, 23.62it/s] 38%|███▊      | 11/29 [00:00<00:00, 31.11it/s] 55%|█████▌    | 16/29 [00:00<00:00, 35.06it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.97it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.77it/s]100%|██████████| 29/29 [00:06<00:00,  4.60it/s]
2025-03-13 19:27:00,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:00
2025-03-13 19:27:48,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7058 secs
2025-03-13 19:27:48,639 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 19:27:48,640 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.61it/s]
2025-03-13 19:28:09,891 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2514 secs
2025-03-13 19:28:09,893 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2700 secs
2025-03-13 19:28:09,893 [INFO]: {
2025-03-13 19:28:09,893 [INFO]: 	index_key: HNSW15
2025-03-13 19:28:09,893 [INFO]: 	index_param: efSearch=297
2025-03-13 19:28:09,893 [INFO]: 	index_path: knn.index
2025-03-13 19:28:09,893 [INFO]: 	size in bytes: 1356550330
2025-03-13 19:28:09,893 [INFO]: 	avg_search_speed_ms: 11.7955845777925
2025-03-13 19:28:09,893 [INFO]: 	99p_search_speed_ms: 15.553432486485688
2025-03-13 19:28:09,893 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:28:09,893 [INFO]: 	nb vectors: 6895
2025-03-13 19:28:09,893 [INFO]: 	vectors dimension: 49152
2025-03-13 19:28:09,893 [INFO]: 	compression ratio: 0.9993084148967771
2025-03-13 19:28:09,893 [INFO]: }
2025-03-13 19:28:09,893 [INFO]: 	>>> Finished "Creating the index" in 75.2717 secs
2025-03-13 19:28:09,893 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3051 secs
2025-03-13 19:28:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:28:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 59783 [episode count 0/20]
[retrieval_preprocessing] for episode 62856 [episode count 1/20], we have num_retrieval=np.int64(6907) num_query=np.int64(363)
2025-03-13 19:28:14,086 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:28:14,920 [INFO]: Launching the whole pipeline 03/13/2025, 19:28:14
2025-03-13 19:28:14,920 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:28:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.25it/s]
2025-03-13 19:28:14,946 [INFO]: There are 6907 embeddings of dim 49152
2025-03-13 19:28:14,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:28:14,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:28:14
2025-03-13 19:28:14,946 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:28:14,946 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:28:14,946 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:28:14,946 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:28:14,946 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:28:14
2025-03-13 19:28:14,946 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:28:14,946 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:28:14,946 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:28:14
2025-03-13 19:28:14,946 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:28:14,946 [INFO]: 	Creating the index 03/13/2025, 19:28:14
2025-03-13 19:28:14,946 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:28:14
2025-03-13 19:28:14,947 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:28:14,948 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:28:14
2025-03-13 19:28:14,948 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:28:14,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.71it/s] 24%|██▍       | 7/29 [00:00<00:00, 31.92it/s] 45%|████▍     | 13/29 [00:00<00:00, 40.14it/s] 66%|██████▌   | 19/29 [00:00<00:00, 43.98it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.66it/s]100%|██████████| 29/29 [00:05<00:00,  3.39it/s]100%|██████████| 29/29 [00:05<00:00,  4.90it/s]
2025-03-13 19:28:20,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:28:20
2025-03-13 19:29:10,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5594 secs
2025-03-13 19:29:10,431 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 19:29:10,431 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.63it/s]
2025-03-13 19:29:27,861 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4297 secs
2025-03-13 19:29:27,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9150 secs
2025-03-13 19:29:27,863 [INFO]: {
2025-03-13 19:29:27,863 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:27,863 [INFO]: 	index_param: efSearch=299
2025-03-13 19:29:27,863 [INFO]: 	index_path: knn.index
2025-03-13 19:29:27,863 [INFO]: 	size in bytes: 1358911270
2025-03-13 19:29:27,863 [INFO]: 	avg_search_speed_ms: 11.676382243550679
2025-03-13 19:29:27,863 [INFO]: 	99p_search_speed_ms: 16.93041002377867
2025-03-13 19:29:27,863 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:27,863 [INFO]: 	nb vectors: 6907
2025-03-13 19:29:27,863 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:27,863 [INFO]: 	compression ratio: 0.9993084066482133
2025-03-13 19:29:27,863 [INFO]: }
2025-03-13 19:29:27,863 [INFO]: 	>>> Finished "Creating the index" in 72.9167 secs
2025-03-13 19:29:27,863 [INFO]: >>> Finished "Launching the whole pipeline" in 72.9425 secs
2025-03-13 19:29:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 62856 [episode count 1/20]
[retrieval_preprocessing] for episode 69384 [episode count 2/20], we have num_retrieval=np.int64(6788) num_query=np.int64(482)
2025-03-13 19:29:31,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:32,815 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:32
2025-03-13 19:29:32,815 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1123.27it/s]
2025-03-13 19:29:32,841 [INFO]: There are 6788 embeddings of dim 49152
2025-03-13 19:29:32,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 19:29:32,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:32
2025-03-13 19:29:32,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:32,841 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 19:29:32,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:32,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:32,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:32
2025-03-13 19:29:32,841 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:32,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:29:32,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:32
2025-03-13 19:29:32,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:32,841 [INFO]: 	Creating the index 03/13/2025, 19:29:32
2025-03-13 19:29:32,841 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:32
2025-03-13 19:29:32,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:29:32,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:32
2025-03-13 19:29:32,843 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 19:29:32,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.21it/s] 21%|██▏       | 6/28 [00:00<00:00, 31.16it/s] 39%|███▉      | 11/28 [00:00<00:00, 38.16it/s] 57%|█████▋    | 16/28 [00:00<00:00, 41.57it/s] 75%|███████▌  | 21/28 [00:03<00:02,  3.48it/s] 93%|█████████▎| 26/28 [00:04<00:00,  5.19it/s]100%|██████████| 28/28 [00:05<00:00,  5.00it/s]
2025-03-13 19:29:38,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:38
2025-03-13 19:30:31,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6221 secs
2025-03-13 19:30:31,069 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 19:30:31,070 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 19:30:54,459 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3897 secs
2025-03-13 19:30:54,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6184 secs
2025-03-13 19:30:54,461 [INFO]: {
2025-03-13 19:30:54,461 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:54,461 [INFO]: 	index_param: efSearch=296
2025-03-13 19:30:54,461 [INFO]: 	index_path: knn.index
2025-03-13 19:30:54,461 [INFO]: 	size in bytes: 1335498670
2025-03-13 19:30:54,461 [INFO]: 	avg_search_speed_ms: 11.935672485758605
2025-03-13 19:30:54,461 [INFO]: 	99p_search_speed_ms: 19.59728857502341
2025-03-13 19:30:54,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:54,461 [INFO]: 	nb vectors: 6788
2025-03-13 19:30:54,461 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:54,461 [INFO]: 	compression ratio: 0.9993084485812329
2025-03-13 19:30:54,461 [INFO]: }
2025-03-13 19:30:54,461 [INFO]: 	>>> Finished "Creating the index" in 81.6199 secs
2025-03-13 19:30:54,461 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6465 secs
2025-03-13 19:30:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 69384 [episode count 2/20]
[retrieval_preprocessing] for episode 13 [episode count 3/20], we have num_retrieval=np.int64(6841) num_query=np.int64(429)
2025-03-13 19:31:00,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:01,512 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:01
2025-03-13 19:31:01,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2565.32it/s]
2025-03-13 19:31:01,534 [INFO]: There are 6841 embeddings of dim 49152
2025-03-13 19:31:01,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 19:31:01,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:01
2025-03-13 19:31:01,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:01,534 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:31:01,534 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:01,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:31:01,534 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:01
2025-03-13 19:31:01,535 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:01,535 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:31:01,535 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:01
2025-03-13 19:31:01,535 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:01,535 [INFO]: 	Creating the index 03/13/2025, 19:31:01
2025-03-13 19:31:01,535 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:01
2025-03-13 19:31:01,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:31:01,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:01
2025-03-13 19:31:01,536 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:31:01,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.53it/s] 25%|██▌       | 7/28 [00:00<00:00, 32.04it/s] 46%|████▋     | 13/28 [00:00<00:00, 40.63it/s] 68%|██████▊   | 19/28 [00:00<00:00, 44.80it/s] 86%|████████▌ | 24/28 [00:04<00:01,  3.84it/s]100%|██████████| 28/28 [00:05<00:00,  3.21it/s]100%|██████████| 28/28 [00:05<00:00,  4.84it/s]
2025-03-13 19:31:07,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:07
2025-03-13 19:31:58,362 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0303 secs
2025-03-13 19:31:58,362 [INFO]: The best hyperparameters are: efSearch=353
2025-03-13 19:31:58,363 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-13 19:32:22,770 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4070 secs
2025-03-13 19:32:22,771 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2353 secs
2025-03-13 19:32:22,771 [INFO]: {
2025-03-13 19:32:22,771 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:22,771 [INFO]: 	index_param: efSearch=353
2025-03-13 19:32:22,771 [INFO]: 	index_path: knn.index
2025-03-13 19:32:22,772 [INFO]: 	size in bytes: 1345926130
2025-03-13 19:32:22,772 [INFO]: 	avg_search_speed_ms: 11.919616962448917
2025-03-13 19:32:22,772 [INFO]: 	99p_search_speed_ms: 18.35065718740225
2025-03-13 19:32:22,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:22,772 [INFO]: 	nb vectors: 6841
2025-03-13 19:32:22,772 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:22,772 [INFO]: 	compression ratio: 0.9993084300993547
2025-03-13 19:32:22,772 [INFO]: }
2025-03-13 19:32:22,772 [INFO]: 	>>> Finished "Creating the index" in 81.2367 secs
2025-03-13 19:32:22,772 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2597 secs
2025-03-13 19:32:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 13 [episode count 3/20]
[retrieval_preprocessing] for episode 62747 [episode count 4/20], we have num_retrieval=np.int64(6821) num_query=np.int64(449)
2025-03-13 19:32:29,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:32:30,785 [INFO]: Launching the whole pipeline 03/13/2025, 19:32:30
2025-03-13 19:32:30,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:32:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 982.96it/s]
2025-03-13 19:32:30,813 [INFO]: There are 6821 embeddings of dim 49152
2025-03-13 19:32:30,814 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 19:32:30,814 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:32:30
2025-03-13 19:32:30,814 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:32:30,814 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 19:32:30,814 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:32:30,814 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:32:30,814 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:32:30
2025-03-13 19:32:30,814 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:32:30,814 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:32:30,814 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:32:30
2025-03-13 19:32:30,814 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:32:30,815 [INFO]: 	Creating the index 03/13/2025, 19:32:30
2025-03-13 19:32:30,815 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:32:30
2025-03-13 19:32:30,816 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:32:30,816 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:32:30
2025-03-13 19:32:30,816 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 19:32:30,816 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.06it/s] 21%|██▏       | 6/28 [00:00<00:00, 26.41it/s] 39%|███▉      | 11/28 [00:00<00:00, 33.83it/s] 57%|█████▋    | 16/28 [00:00<00:00, 37.39it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.22it/s] 96%|█████████▋| 27/28 [00:04<00:00,  5.15it/s]100%|██████████| 28/28 [00:06<00:00,  4.61it/s]
2025-03-13 19:32:36,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:32:36
2025-03-13 19:33:28,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2274 secs
2025-03-13 19:33:28,125 [INFO]: The best hyperparameters are: efSearch=313
2025-03-13 19:33:28,125 [INFO]: 	Compute fast metrics 03/13/2025, 19:33:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.49it/s]
2025-03-13 19:33:56,612 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4867 secs
2025-03-13 19:33:56,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7973 secs
2025-03-13 19:33:56,613 [INFO]: {
2025-03-13 19:33:56,613 [INFO]: 	index_key: HNSW15
2025-03-13 19:33:56,613 [INFO]: 	index_param: efSearch=313
2025-03-13 19:33:56,613 [INFO]: 	index_path: knn.index
2025-03-13 19:33:56,613 [INFO]: 	size in bytes: 1341991210
2025-03-13 19:33:56,613 [INFO]: 	avg_search_speed_ms: 11.049416462816792
2025-03-13 19:33:56,613 [INFO]: 	99p_search_speed_ms: 17.22026827046649
2025-03-13 19:33:56,613 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:33:56,613 [INFO]: 	nb vectors: 6821
2025-03-13 19:33:56,613 [INFO]: 	vectors dimension: 49152
2025-03-13 19:33:56,613 [INFO]: 	compression ratio: 0.9993084589577901
2025-03-13 19:33:56,613 [INFO]: }
2025-03-13 19:33:56,613 [INFO]: 	>>> Finished "Creating the index" in 85.7988 secs
2025-03-13 19:33:56,613 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8279 secs
2025-03-13 19:33:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:34:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 62747 [episode count 4/20]
[retrieval_preprocessing] for episode 11933 [episode count 5/20], we have num_retrieval=np.int64(6922) num_query=np.int64(348)
2025-03-13 19:34:01,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:34:02,352 [INFO]: Launching the whole pipeline 03/13/2025, 19:34:02
2025-03-13 19:34:02,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:34:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1480.52it/s]
2025-03-13 19:34:02,379 [INFO]: There are 6922 embeddings of dim 49152
2025-03-13 19:34:02,380 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 19:34:02,380 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:34:02
2025-03-13 19:34:02,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:34:02,380 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:34:02,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:34:02,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:34:02,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:34:02
2025-03-13 19:34:02,380 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:34:02,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:34:02,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:34:02
2025-03-13 19:34:02,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:34:02,380 [INFO]: 	Creating the index 03/13/2025, 19:34:02
2025-03-13 19:34:02,380 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:34:02
2025-03-13 19:34:02,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:34:02,382 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:34:02
2025-03-13 19:34:02,382 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:34:02,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.72it/s] 21%|██        | 6/29 [00:00<00:00, 30.45it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.83it/s] 59%|█████▊    | 17/29 [00:00<00:00, 43.35it/s] 76%|███████▌  | 22/29 [00:03<00:01,  3.80it/s]100%|██████████| 29/29 [00:05<00:00,  3.83it/s]100%|██████████| 29/29 [00:05<00:00,  5.20it/s]
2025-03-13 19:34:07,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:34:07
2025-03-13 19:35:02,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.2132 secs
2025-03-13 19:35:02,179 [INFO]: The best hyperparameters are: efSearch=318
2025-03-13 19:35:02,179 [INFO]: 	Compute fast metrics 03/13/2025, 19:35:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.52it/s]
2025-03-13 19:35:31,562 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3830 secs
2025-03-13 19:35:31,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.1814 secs
2025-03-13 19:35:31,563 [INFO]: {
2025-03-13 19:35:31,563 [INFO]: 	index_key: HNSW15
2025-03-13 19:35:31,563 [INFO]: 	index_param: efSearch=318
2025-03-13 19:35:31,563 [INFO]: 	index_path: knn.index
2025-03-13 19:35:31,563 [INFO]: 	size in bytes: 1361862550
2025-03-13 19:35:31,564 [INFO]: 	avg_search_speed_ms: 10.641650390375327
2025-03-13 19:35:31,564 [INFO]: 	99p_search_speed_ms: 16.23538773274049
2025-03-13 19:35:31,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:35:31,564 [INFO]: 	nb vectors: 6922
2025-03-13 19:35:31,564 [INFO]: 	vectors dimension: 49152
2025-03-13 19:35:31,564 [INFO]: 	compression ratio: 0.9993083193307577
2025-03-13 19:35:31,564 [INFO]: }
2025-03-13 19:35:31,564 [INFO]: 	>>> Finished "Creating the index" in 89.1831 secs
2025-03-13 19:35:31,564 [INFO]: >>> Finished "Launching the whole pipeline" in 89.2120 secs
2025-03-13 19:35:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:35:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 11933 [episode count 5/20]
[retrieval_preprocessing] for episode 17054 [episode count 6/20], we have num_retrieval=np.int64(6942) num_query=np.int64(328)
2025-03-13 19:35:35,925 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:35:36,750 [INFO]: Launching the whole pipeline 03/13/2025, 19:35:36
2025-03-13 19:35:36,750 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:35:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.85it/s]
2025-03-13 19:35:36,774 [INFO]: There are 6942 embeddings of dim 49152
2025-03-13 19:35:36,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 19:35:36,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:35:36
2025-03-13 19:35:36,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:35:36,774 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:35:36,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:35:36,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:35:36,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:35:36
2025-03-13 19:35:36,774 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:35:36,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:35:36,775 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:35:36
2025-03-13 19:35:36,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:35:36,775 [INFO]: 	Creating the index 03/13/2025, 19:35:36
2025-03-13 19:35:36,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:35:36
2025-03-13 19:35:36,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:35:36,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:35:36
2025-03-13 19:35:36,776 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:35:36,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.50it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.48it/s] 45%|████▍     | 13/29 [00:00<00:00, 43.21it/s] 66%|██████▌   | 19/29 [00:00<00:00, 47.47it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.82it/s]100%|██████████| 29/29 [00:05<00:00,  3.54it/s]100%|██████████| 29/29 [00:05<00:00,  5.12it/s]
2025-03-13 19:35:42,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:35:42
2025-03-13 19:36:33,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3413 secs
2025-03-13 19:36:33,782 [INFO]: The best hyperparameters are: efSearch=308
2025-03-13 19:36:33,782 [INFO]: 	Compute fast metrics 03/13/2025, 19:36:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.22it/s]
2025-03-13 19:37:02,120 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3380 secs
2025-03-13 19:37:02,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.3449 secs
2025-03-13 19:37:02,121 [INFO]: {
2025-03-13 19:37:02,121 [INFO]: 	index_key: HNSW15
2025-03-13 19:37:02,121 [INFO]: 	index_param: efSearch=308
2025-03-13 19:37:02,121 [INFO]: 	index_path: knn.index
2025-03-13 19:37:02,121 [INFO]: 	size in bytes: 1365797410
2025-03-13 19:37:02,121 [INFO]: 	avg_search_speed_ms: 11.200124414821238
2025-03-13 19:37:02,121 [INFO]: 	99p_search_speed_ms: 16.848264494910836
2025-03-13 19:37:02,121 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:37:02,121 [INFO]: 	nb vectors: 6942
2025-03-13 19:37:02,121 [INFO]: 	vectors dimension: 49152
2025-03-13 19:37:02,121 [INFO]: 	compression ratio: 0.999308335194456
2025-03-13 19:37:02,121 [INFO]: }
2025-03-13 19:37:02,121 [INFO]: 	>>> Finished "Creating the index" in 85.3467 secs
2025-03-13 19:37:02,121 [INFO]: >>> Finished "Launching the whole pipeline" in 85.3719 secs
2025-03-13 19:37:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:37:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 17054 [episode count 6/20]
[retrieval_preprocessing] for episode 57373 [episode count 7/20], we have num_retrieval=np.int64(6966) num_query=np.int64(304)
2025-03-13 19:37:05,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:37:06,857 [INFO]: Launching the whole pipeline 03/13/2025, 19:37:06
2025-03-13 19:37:06,857 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:37:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-13 19:37:06,881 [INFO]: There are 6966 embeddings of dim 49152
2025-03-13 19:37:06,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 19:37:06,882 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:37:06
2025-03-13 19:37:06,882 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:37:06,882 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:37:06,882 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:37:06,882 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:37:06,882 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:37:06
2025-03-13 19:37:06,882 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:37:06,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:37:06,882 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:37:06
2025-03-13 19:37:06,882 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:37:06,882 [INFO]: 	Creating the index 03/13/2025, 19:37:06
2025-03-13 19:37:06,882 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:37:06
2025-03-13 19:37:06,883 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:37:06,883 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:37:06
2025-03-13 19:37:06,884 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:37:06,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.54it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.51it/s] 38%|███▊      | 11/29 [00:00<00:00, 39.67it/s] 59%|█████▊    | 17/29 [00:00<00:00, 46.66it/s] 76%|███████▌  | 22/29 [00:03<00:01,  4.10it/s] 97%|█████████▋| 28/29 [00:03<00:00,  6.36it/s]100%|██████████| 29/29 [00:05<00:00,  5.52it/s]
2025-03-13 19:37:12,145 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:37:12
2025-03-13 19:38:03,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7210 secs
2025-03-13 19:38:03,867 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 19:38:03,867 [INFO]: 	Compute fast metrics 03/13/2025, 19:38:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-13 19:38:28,728 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8611 secs
2025-03-13 19:38:28,730 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.8461 secs
2025-03-13 19:38:28,730 [INFO]: {
2025-03-13 19:38:28,730 [INFO]: 	index_key: HNSW15
2025-03-13 19:38:28,730 [INFO]: 	index_param: efSearch=307
2025-03-13 19:38:28,730 [INFO]: 	index_path: knn.index
2025-03-13 19:38:28,730 [INFO]: 	size in bytes: 1370519290
2025-03-13 19:38:28,730 [INFO]: 	avg_search_speed_ms: 9.523258553596126
2025-03-13 19:38:28,730 [INFO]: 	99p_search_speed_ms: 16.237553933169693
2025-03-13 19:38:28,730 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:38:28,730 [INFO]: 	nb vectors: 6966
2025-03-13 19:38:28,730 [INFO]: 	vectors dimension: 49152
2025-03-13 19:38:28,730 [INFO]: 	compression ratio: 0.9993083191116559
2025-03-13 19:38:28,730 [INFO]: }
2025-03-13 19:38:28,730 [INFO]: 	>>> Finished "Creating the index" in 81.8475 secs
2025-03-13 19:38:28,730 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8729 secs
2025-03-13 19:38:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:38:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 57373 [episode count 7/20]
[retrieval_preprocessing] for episode 7712 [episode count 8/20], we have num_retrieval=np.int64(6916) num_query=np.int64(354)
2025-03-13 19:38:32,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:38:33,597 [INFO]: Launching the whole pipeline 03/13/2025, 19:38:33
2025-03-13 19:38:33,597 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:38:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.80it/s]
2025-03-13 19:38:33,624 [INFO]: There are 6916 embeddings of dim 49152
2025-03-13 19:38:33,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 19:38:33,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:38:33
2025-03-13 19:38:33,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:38:33,624 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:38:33,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:38:33,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:38:33,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:38:33
2025-03-13 19:38:33,624 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:38:33,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:38:33,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:38:33
2025-03-13 19:38:33,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:38:33,625 [INFO]: 	Creating the index 03/13/2025, 19:38:33
2025-03-13 19:38:33,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:38:33
2025-03-13 19:38:33,626 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:38:33,626 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:38:33
2025-03-13 19:38:33,626 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:38:33,626 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.37it/s] 24%|██▍       | 7/29 [00:00<00:00, 35.10it/s] 45%|████▍     | 13/29 [00:00<00:00, 42.98it/s] 66%|██████▌   | 19/29 [00:00<00:00, 46.70it/s] 83%|████████▎ | 24/29 [00:03<00:01,  3.88it/s]100%|██████████| 29/29 [00:05<00:00,  3.42it/s]100%|██████████| 29/29 [00:05<00:00,  5.01it/s]
2025-03-13 19:38:39,418 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:38:39
2025-03-13 19:39:32,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9239 secs
2025-03-13 19:39:32,343 [INFO]: The best hyperparameters are: efSearch=328
2025-03-13 19:39:32,343 [INFO]: 	Compute fast metrics 03/13/2025, 19:39:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 19:39:57,399 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0560 secs
2025-03-13 19:39:57,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.7742 secs
2025-03-13 19:39:57,400 [INFO]: {
2025-03-13 19:39:57,400 [INFO]: 	index_key: HNSW15
2025-03-13 19:39:57,400 [INFO]: 	index_param: efSearch=328
2025-03-13 19:39:57,400 [INFO]: 	index_path: knn.index
2025-03-13 19:39:57,400 [INFO]: 	size in bytes: 1360682050
2025-03-13 19:39:57,400 [INFO]: 	avg_search_speed_ms: 11.469495151119323
2025-03-13 19:39:57,400 [INFO]: 	99p_search_speed_ms: 17.685883161611855
2025-03-13 19:39:57,400 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:39:57,400 [INFO]: 	nb vectors: 6916
2025-03-13 19:39:57,400 [INFO]: 	vectors dimension: 49152
2025-03-13 19:39:57,400 [INFO]: 	compression ratio: 0.9993083453992797
2025-03-13 19:39:57,400 [INFO]: }
2025-03-13 19:39:57,400 [INFO]: 	>>> Finished "Creating the index" in 83.7758 secs
2025-03-13 19:39:57,400 [INFO]: >>> Finished "Launching the whole pipeline" in 83.8034 secs
2025-03-13 19:39:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:40:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 7712 [episode count 8/20]
[retrieval_preprocessing] for episode 18213 [episode count 9/20], we have num_retrieval=np.int64(6977) num_query=np.int64(293)
2025-03-13 19:40:01,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:40:02,200 [INFO]: Launching the whole pipeline 03/13/2025, 19:40:02
2025-03-13 19:40:02,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:40:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-13 19:40:02,228 [INFO]: There are 6977 embeddings of dim 49152
2025-03-13 19:40:02,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:40:02,228 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:40:02
2025-03-13 19:40:02,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:40:02,229 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:40:02,229 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:40:02,229 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:40:02,229 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:40:02
2025-03-13 19:40:02,229 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:40:02,229 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:40:02,229 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:40:02
2025-03-13 19:40:02,229 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:40:02,229 [INFO]: 	Creating the index 03/13/2025, 19:40:02
2025-03-13 19:40:02,229 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:40:02
2025-03-13 19:40:02,231 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 19:40:02,231 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:40:02
2025-03-13 19:40:02,231 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:40:02,231 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.77it/s] 24%|██▍       | 7/29 [00:00<00:00, 36.20it/s] 45%|████▍     | 13/29 [00:00<00:00, 45.64it/s] 66%|██████▌   | 19/29 [00:00<00:00, 50.18it/s] 86%|████████▌ | 25/29 [00:03<00:00,  4.98it/s]100%|██████████| 29/29 [00:04<00:00,  4.03it/s]100%|██████████| 29/29 [00:04<00:00,  5.99it/s]
2025-03-13 19:40:07,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:40:07
2025-03-13 19:40:57,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7200 secs
2025-03-13 19:40:57,798 [INFO]: The best hyperparameters are: efSearch=330
2025-03-13 19:40:57,798 [INFO]: 	Compute fast metrics 03/13/2025, 19:40:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-13 19:41:18,834 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0361 secs
2025-03-13 19:41:18,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.6036 secs
2025-03-13 19:41:18,835 [INFO]: {
2025-03-13 19:41:18,835 [INFO]: 	index_key: HNSW15
2025-03-13 19:41:18,835 [INFO]: 	index_param: efSearch=330
2025-03-13 19:41:18,835 [INFO]: 	index_path: knn.index
2025-03-13 19:41:18,835 [INFO]: 	size in bytes: 1372683430
2025-03-13 19:41:18,835 [INFO]: 	avg_search_speed_ms: 10.85820454127335
2025-03-13 19:41:18,835 [INFO]: 	99p_search_speed_ms: 17.076130639761683
2025-03-13 19:41:18,835 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:41:18,835 [INFO]: 	nb vectors: 6977
2025-03-13 19:41:18,835 [INFO]: 	vectors dimension: 49152
2025-03-13 19:41:18,835 [INFO]: 	compression ratio: 0.9993083518171411
2025-03-13 19:41:18,835 [INFO]: }
2025-03-13 19:41:18,835 [INFO]: 	>>> Finished "Creating the index" in 76.6062 secs
2025-03-13 19:41:18,835 [INFO]: >>> Finished "Launching the whole pipeline" in 76.6351 secs
2025-03-13 19:41:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:41:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 18213 [episode count 9/20]
[retrieval_preprocessing] for episode 18469 [episode count 10/20], we have num_retrieval=np.int64(6651) num_query=np.int64(619)
2025-03-13 19:41:22,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:41:22,775 [INFO]: Launching the whole pipeline 03/13/2025, 19:41:22
2025-03-13 19:41:22,775 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:41:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-13 19:41:22,798 [INFO]: There are 6651 embeddings of dim 49152
2025-03-13 19:41:22,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 19:41:22,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:41:22
2025-03-13 19:41:22,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:41:22,799 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 19:41:22,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:41:22,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:41:22,799 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:41:22
2025-03-13 19:41:22,799 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:41:22,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:41:22,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:41:22
2025-03-13 19:41:22,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:41:22,799 [INFO]: 	Creating the index 03/13/2025, 19:41:22
2025-03-13 19:41:22,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:41:22
2025-03-13 19:41:22,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:41:22,800 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:41:22
2025-03-13 19:41:22,800 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 19:41:22,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.74it/s] 29%|██▊       | 8/28 [00:00<00:00, 38.88it/s] 54%|█████▎    | 15/28 [00:00<00:00, 50.89it/s] 75%|███████▌  | 21/28 [00:03<00:01,  4.81it/s] 96%|█████████▋| 27/28 [00:03<00:00,  7.26it/s]100%|██████████| 28/28 [00:04<00:00,  6.16it/s]
2025-03-13 19:41:27,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:41:27
2025-03-13 19:42:18,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0432 secs
2025-03-13 19:42:18,389 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 19:42:18,389 [INFO]: 	Compute fast metrics 03/13/2025, 19:42:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.12it/s]
2025-03-13 19:42:37,362 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9727 secs
2025-03-13 19:42:37,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5635 secs
2025-03-13 19:42:37,364 [INFO]: {
2025-03-13 19:42:37,364 [INFO]: 	index_key: HNSW15
2025-03-13 19:42:37,364 [INFO]: 	index_param: efSearch=288
2025-03-13 19:42:37,364 [INFO]: 	index_path: knn.index
2025-03-13 19:42:37,364 [INFO]: 	size in bytes: 1308544870
2025-03-13 19:42:37,364 [INFO]: 	avg_search_speed_ms: 9.385365707752614
2025-03-13 19:42:37,364 [INFO]: 	99p_search_speed_ms: 13.879813265521078
2025-03-13 19:42:37,364 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:42:37,364 [INFO]: 	nb vectors: 6651
2025-03-13 19:42:37,364 [INFO]: 	vectors dimension: 49152
2025-03-13 19:42:37,364 [INFO]: 	compression ratio: 0.9993083446958911
2025-03-13 19:42:37,364 [INFO]: }
2025-03-13 19:42:37,364 [INFO]: 	>>> Finished "Creating the index" in 74.5652 secs
2025-03-13 19:42:37,364 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5889 secs
2025-03-13 19:42:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:42:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 18469 [episode count 10/20]
[retrieval_preprocessing] for episode 34343 [episode count 11/20], we have num_retrieval=np.int64(6926) num_query=np.int64(344)
2025-03-13 19:42:43,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:42:44,152 [INFO]: Launching the whole pipeline 03/13/2025, 19:42:44
2025-03-13 19:42:44,153 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:42:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.33it/s]
2025-03-13 19:42:44,178 [INFO]: There are 6926 embeddings of dim 49152
2025-03-13 19:42:44,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 19:42:44,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:42:44
2025-03-13 19:42:44,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:42:44,179 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:42:44,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:42:44,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:42:44,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:42:44
2025-03-13 19:42:44,179 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:42:44,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:42:44,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:42:44
2025-03-13 19:42:44,180 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:42:44,180 [INFO]: 	Creating the index 03/13/2025, 19:42:44
2025-03-13 19:42:44,180 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:42:44
2025-03-13 19:42:44,182 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 19:42:44,182 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:42:44
2025-03-13 19:42:44,182 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:42:44,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.32it/s] 28%|██▊       | 8/29 [00:00<00:00, 39.49it/s] 52%|█████▏    | 15/29 [00:00<00:00, 50.49it/s] 72%|███████▏  | 21/29 [00:03<00:01,  4.77it/s] 93%|█████████▎| 27/29 [00:03<00:00,  7.20it/s]100%|██████████| 29/29 [00:04<00:00,  6.07it/s]
2025-03-13 19:42:48,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:42:48
2025-03-13 19:43:37,584 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6190 secs
2025-03-13 19:43:37,584 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 19:43:37,584 [INFO]: 	Compute fast metrics 03/13/2025, 19:43:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 19:43:59,026 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4420 secs
2025-03-13 19:43:59,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8455 secs
2025-03-13 19:43:59,028 [INFO]: {
2025-03-13 19:43:59,028 [INFO]: 	index_key: HNSW15
2025-03-13 19:43:59,028 [INFO]: 	index_param: efSearch=344
2025-03-13 19:43:59,028 [INFO]: 	index_path: knn.index
2025-03-13 19:43:59,028 [INFO]: 	size in bytes: 1362649510
2025-03-13 19:43:59,028 [INFO]: 	avg_search_speed_ms: 10.706197282965485
2025-03-13 19:43:59,028 [INFO]: 	99p_search_speed_ms: 16.65169755229726
2025-03-13 19:43:59,028 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:43:59,028 [INFO]: 	nb vectors: 6926
2025-03-13 19:43:59,028 [INFO]: 	vectors dimension: 49152
2025-03-13 19:43:59,028 [INFO]: 	compression ratio: 0.9993083313111087
2025-03-13 19:43:59,028 [INFO]: }
2025-03-13 19:43:59,028 [INFO]: 	>>> Finished "Creating the index" in 74.8479 secs
2025-03-13 19:43:59,028 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8752 secs
2025-03-13 19:44:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:44:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 34343 [episode count 11/20]
[retrieval_preprocessing] for episode 1345 [episode count 12/20], we have num_retrieval=np.int64(6929) num_query=np.int64(341)
2025-03-13 19:44:04,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:44:05,226 [INFO]: Launching the whole pipeline 03/13/2025, 19:44:05
2025-03-13 19:44:05,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:44:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.82it/s]
2025-03-13 19:44:05,254 [INFO]: There are 6929 embeddings of dim 49152
2025-03-13 19:44:05,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 19:44:05,254 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:44:05,254 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:44:05,254 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:44:05,254 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:44:05,254 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,255 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:44:05,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:44:05,255 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:44:05
2025-03-13 19:44:05,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:44:05,255 [INFO]: 	Creating the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,255 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:44:05
2025-03-13 19:44:05,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:44:05,256 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:44:05
2025-03-13 19:44:05,256 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:44:05,256 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.84it/s] 17%|█▋        | 5/29 [00:00<00:01, 23.17it/s] 34%|███▍      | 10/29 [00:00<00:00, 33.37it/s] 52%|█████▏    | 15/29 [00:00<00:00, 38.38it/s] 69%|██████▉   | 20/29 [00:00<00:00, 40.76it/s] 86%|████████▌ | 25/29 [00:04<00:01,  3.26it/s] 97%|█████████▋| 28/29 [00:04<00:00,  3.97it/s]100%|██████████| 29/29 [00:06<00:00,  4.25it/s]
2025-03-13 19:44:12,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:44:12
2025-03-13 19:45:03,977 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8979 secs
2025-03-13 19:45:03,977 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 19:45:03,977 [INFO]: 	Compute fast metrics 03/13/2025, 19:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.76it/s]
2025-03-13 19:45:23,916 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9384 secs
2025-03-13 19:45:23,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.6612 secs
2025-03-13 19:45:23,917 [INFO]: {
2025-03-13 19:45:23,917 [INFO]: 	index_key: HNSW15
2025-03-13 19:45:23,917 [INFO]: 	index_param: efSearch=301
2025-03-13 19:45:23,917 [INFO]: 	index_path: knn.index
2025-03-13 19:45:23,917 [INFO]: 	size in bytes: 1363239730
2025-03-13 19:45:23,917 [INFO]: 	avg_search_speed_ms: 10.732760673384842
2025-03-13 19:45:23,917 [INFO]: 	99p_search_speed_ms: 16.568109812214963
2025-03-13 19:45:23,917 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:45:23,917 [INFO]: 	nb vectors: 6929
2025-03-13 19:45:23,917 [INFO]: 	vectors dimension: 49152
2025-03-13 19:45:23,917 [INFO]: 	compression ratio: 0.9993083402872949
2025-03-13 19:45:23,917 [INFO]: }
2025-03-13 19:45:23,918 [INFO]: 	>>> Finished "Creating the index" in 78.6627 secs
2025-03-13 19:45:23,918 [INFO]: >>> Finished "Launching the whole pipeline" in 78.6918 secs
2025-03-13 19:45:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:45:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 1345 [episode count 12/20]
[retrieval_preprocessing] for episode 16454 [episode count 13/20], we have num_retrieval=np.int64(7006) num_query=np.int64(264)
2025-03-13 19:45:27,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:45:28,627 [INFO]: Launching the whole pipeline 03/13/2025, 19:45:28
2025-03-13 19:45:28,627 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:45:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.17it/s]
2025-03-13 19:45:28,652 [INFO]: There are 7006 embeddings of dim 49152
2025-03-13 19:45:28,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 19:45:28,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:45:28
2025-03-13 19:45:28,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:45:28,653 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:45:28,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:45:28,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:45:28,653 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:45:28
2025-03-13 19:45:28,653 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:45:28,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:45:28,653 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:45:28
2025-03-13 19:45:28,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:45:28,653 [INFO]: 	Creating the index 03/13/2025, 19:45:28
2025-03-13 19:45:28,653 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:45:28
2025-03-13 19:45:28,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:45:28,654 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:45:28
2025-03-13 19:45:28,654 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:45:28,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.79it/s] 28%|██▊       | 8/29 [00:00<00:00, 42.33it/s] 55%|█████▌    | 16/29 [00:00<00:00, 56.43it/s] 76%|███████▌  | 22/29 [00:03<00:01,  5.27it/s]100%|██████████| 29/29 [00:04<00:00,  5.09it/s]100%|██████████| 29/29 [00:04<00:00,  6.41it/s]
2025-03-13 19:45:33,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:45:33
2025-03-13 19:46:20,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2386 secs
2025-03-13 19:46:20,420 [INFO]: The best hyperparameters are: efSearch=365
2025-03-13 19:46:20,420 [INFO]: 	Compute fast metrics 03/13/2025, 19:46:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.64it/s]
2025-03-13 19:46:42,045 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6251 secs
2025-03-13 19:46:42,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3920 secs
2025-03-13 19:46:42,046 [INFO]: {
2025-03-13 19:46:42,047 [INFO]: 	index_key: HNSW15
2025-03-13 19:46:42,047 [INFO]: 	index_param: efSearch=365
2025-03-13 19:46:42,047 [INFO]: 	index_path: knn.index
2025-03-13 19:46:42,047 [INFO]: 	size in bytes: 1378389130
2025-03-13 19:46:42,047 [INFO]: 	avg_search_speed_ms: 10.88850099975456
2025-03-13 19:46:42,047 [INFO]: 	99p_search_speed_ms: 17.0027683256194
2025-03-13 19:46:42,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:46:42,047 [INFO]: 	nb vectors: 7006
2025-03-13 19:46:42,047 [INFO]: 	vectors dimension: 49152
2025-03-13 19:46:42,047 [INFO]: 	compression ratio: 0.9993082635525427
2025-03-13 19:46:42,047 [INFO]: }
2025-03-13 19:46:42,047 [INFO]: 	>>> Finished "Creating the index" in 73.3936 secs
2025-03-13 19:46:42,047 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4195 secs
2025-03-13 19:46:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:46:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 16454 [episode count 13/20]
[retrieval_preprocessing] for episode 19922 [episode count 14/20], we have num_retrieval=np.int64(6998) num_query=np.int64(272)
2025-03-13 19:46:46,197 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:46:47,048 [INFO]: Launching the whole pipeline 03/13/2025, 19:46:47
2025-03-13 19:46:47,048 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:46:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.01it/s]
2025-03-13 19:46:47,071 [INFO]: There are 6998 embeddings of dim 49152
2025-03-13 19:46:47,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 19:46:47,071 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:46:47
2025-03-13 19:46:47,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:46:47,072 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:46:47,072 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:46:47,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:46:47,072 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:46:47
2025-03-13 19:46:47,072 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:46:47,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:46:47,072 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:46:47
2025-03-13 19:46:47,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:46:47,072 [INFO]: 	Creating the index 03/13/2025, 19:46:47
2025-03-13 19:46:47,072 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:46:47
2025-03-13 19:46:47,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:46:47,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:46:47
2025-03-13 19:46:47,073 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:46:47,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  9.02it/s] 24%|██▍       | 7/29 [00:00<00:00, 37.63it/s] 48%|████▊     | 14/29 [00:00<00:00, 49.91it/s] 72%|███████▏  | 21/29 [00:03<00:01,  4.97it/s] 97%|█████████▋| 28/29 [00:03<00:00,  7.86it/s]100%|██████████| 29/29 [00:04<00:00,  6.23it/s]
2025-03-13 19:46:51,732 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:46:51
2025-03-13 19:47:32,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9347 secs
2025-03-13 19:47:32,667 [INFO]: The best hyperparameters are: efSearch=434
2025-03-13 19:47:32,667 [INFO]: 	Compute fast metrics 03/13/2025, 19:47:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.41it/s]
2025-03-13 19:47:49,698 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0308 secs
2025-03-13 19:47:49,699 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6262 secs
2025-03-13 19:47:49,699 [INFO]: {
2025-03-13 19:47:49,700 [INFO]: 	index_key: HNSW15
2025-03-13 19:47:49,700 [INFO]: 	index_param: efSearch=434
2025-03-13 19:47:49,700 [INFO]: 	index_path: knn.index
2025-03-13 19:47:49,700 [INFO]: 	size in bytes: 1376815150
2025-03-13 19:47:49,700 [INFO]: 	avg_search_speed_ms: 11.324721050742983
2025-03-13 19:47:49,700 [INFO]: 	99p_search_speed_ms: 17.718768725171685
2025-03-13 19:47:49,700 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:47:49,700 [INFO]: 	nb vectors: 6998
2025-03-13 19:47:49,700 [INFO]: 	vectors dimension: 49152
2025-03-13 19:47:49,700 [INFO]: 	compression ratio: 0.9993082833232915
2025-03-13 19:47:49,700 [INFO]: }
2025-03-13 19:47:49,700 [INFO]: 	>>> Finished "Creating the index" in 62.6277 secs
2025-03-13 19:47:49,700 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6520 secs
2025-03-13 19:47:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:47:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 19922 [episode count 14/20]
[retrieval_preprocessing] for episode 92118 [episode count 15/20], we have num_retrieval=np.int64(6911) num_query=np.int64(359)
2025-03-13 19:47:53,693 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:47:54,470 [INFO]: Launching the whole pipeline 03/13/2025, 19:47:54
2025-03-13 19:47:54,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:47:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2037.06it/s]
2025-03-13 19:47:54,492 [INFO]: There are 6911 embeddings of dim 49152
2025-03-13 19:47:54,492 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 19:47:54,492 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:47:54
2025-03-13 19:47:54,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:47:54,492 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:47:54,492 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:47:54,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:47:54,492 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:47:54
2025-03-13 19:47:54,492 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:47:54,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:47:54,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:47:54
2025-03-13 19:47:54,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:47:54,492 [INFO]: 	Creating the index 03/13/2025, 19:47:54
2025-03-13 19:47:54,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:47:54
2025-03-13 19:47:54,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:47:54,493 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:47:54
2025-03-13 19:47:54,493 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:47:54,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 17.56it/s] 31%|███       | 9/29 [00:00<00:00, 45.91it/s] 55%|█████▌    | 16/29 [00:00<00:00, 56.06it/s] 76%|███████▌  | 22/29 [00:02<00:01,  5.32it/s]100%|██████████| 29/29 [00:04<00:00,  5.26it/s]100%|██████████| 29/29 [00:04<00:00,  6.69it/s]
2025-03-13 19:47:58,833 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:47:58
2025-03-13 19:48:39,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7782 secs
2025-03-13 19:48:39,611 [INFO]: The best hyperparameters are: efSearch=434
2025-03-13 19:48:39,611 [INFO]: 	Compute fast metrics 03/13/2025, 19:48:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.72it/s]
2025-03-13 19:48:56,261 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6494 secs
2025-03-13 19:48:56,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7688 secs
2025-03-13 19:48:56,262 [INFO]: {
2025-03-13 19:48:56,262 [INFO]: 	index_key: HNSW15
2025-03-13 19:48:56,262 [INFO]: 	index_param: efSearch=434
2025-03-13 19:48:56,262 [INFO]: 	index_path: knn.index
2025-03-13 19:48:56,262 [INFO]: 	size in bytes: 1359698230
2025-03-13 19:48:56,262 [INFO]: 	avg_search_speed_ms: 11.510317700393113
2025-03-13 19:48:56,262 [INFO]: 	99p_search_speed_ms: 17.126347022131085
2025-03-13 19:48:56,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:48:56,262 [INFO]: 	nb vectors: 6911
2025-03-13 19:48:56,262 [INFO]: 	vectors dimension: 49152
2025-03-13 19:48:56,262 [INFO]: 	compression ratio: 0.999308418604031
2025-03-13 19:48:56,262 [INFO]: }
2025-03-13 19:48:56,262 [INFO]: 	>>> Finished "Creating the index" in 61.7700 secs
2025-03-13 19:48:56,262 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7925 secs
2025-03-13 19:49:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:49:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 92118 [episode count 15/20]
[retrieval_preprocessing] for episode 59227 [episode count 16/20], we have num_retrieval=np.int64(6934) num_query=np.int64(336)
2025-03-13 19:49:02,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:49:02,788 [INFO]: Launching the whole pipeline 03/13/2025, 19:49:02
2025-03-13 19:49:02,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:49:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2441.39it/s]
2025-03-13 19:49:02,811 [INFO]: There are 6934 embeddings of dim 49152
2025-03-13 19:49:02,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 19:49:02,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:49:02
2025-03-13 19:49:02,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:49:02,811 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:49:02,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:49:02,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:49:02,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:49:02
2025-03-13 19:49:02,811 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:49:02,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:49:02,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:49:02
2025-03-13 19:49:02,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:49:02,812 [INFO]: 	Creating the index 03/13/2025, 19:49:02
2025-03-13 19:49:02,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:49:02
2025-03-13 19:49:02,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:49:02,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:49:02
2025-03-13 19:49:02,813 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:49:02,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.48it/s] 28%|██▊       | 8/29 [00:00<00:00, 43.04it/s] 52%|█████▏    | 15/29 [00:00<00:00, 54.24it/s] 72%|███████▏  | 21/29 [00:03<00:01,  4.80it/s] 97%|█████████▋| 28/29 [00:03<00:00,  7.71it/s]100%|██████████| 29/29 [00:04<00:00,  6.19it/s]
2025-03-13 19:49:07,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:49:07
2025-03-13 19:49:54,470 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9684 secs
2025-03-13 19:49:54,470 [INFO]: The best hyperparameters are: efSearch=346
2025-03-13 19:49:54,471 [INFO]: 	Compute fast metrics 03/13/2025, 19:49:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.29it/s]
2025-03-13 19:50:13,129 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6585 secs
2025-03-13 19:50:13,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3176 secs
2025-03-13 19:50:13,130 [INFO]: {
2025-03-13 19:50:13,131 [INFO]: 	index_key: HNSW15
2025-03-13 19:50:13,131 [INFO]: 	index_param: efSearch=346
2025-03-13 19:50:13,131 [INFO]: 	index_path: knn.index
2025-03-13 19:50:13,131 [INFO]: 	size in bytes: 1364223430
2025-03-13 19:50:13,131 [INFO]: 	avg_search_speed_ms: 10.42671764790973
2025-03-13 19:50:13,131 [INFO]: 	99p_search_speed_ms: 15.182146308943627
2025-03-13 19:50:13,131 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:50:13,131 [INFO]: 	nb vectors: 6934
2025-03-13 19:50:13,131 [INFO]: 	vectors dimension: 49152
2025-03-13 19:50:13,131 [INFO]: 	compression ratio: 0.9993083552303452
2025-03-13 19:50:13,131 [INFO]: }
2025-03-13 19:50:13,131 [INFO]: 	>>> Finished "Creating the index" in 70.3190 secs
2025-03-13 19:50:13,131 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3423 secs
2025-03-13 19:50:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:50:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 59227 [episode count 16/20]
[retrieval_preprocessing] for episode 32092 [episode count 17/20], we have num_retrieval=np.int64(6840) num_query=np.int64(430)
2025-03-13 19:50:17,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:50:18,651 [INFO]: Launching the whole pipeline 03/13/2025, 19:50:18
2025-03-13 19:50:18,651 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:50:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2417.47it/s]
2025-03-13 19:50:18,675 [INFO]: There are 6840 embeddings of dim 49152
2025-03-13 19:50:18,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 19:50:18,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:50:18
2025-03-13 19:50:18,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:50:18,676 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:50:18,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:50:18,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:50:18,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:50:18
2025-03-13 19:50:18,677 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:50:18,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:50:18,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:50:18
2025-03-13 19:50:18,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:50:18,677 [INFO]: 	Creating the index 03/13/2025, 19:50:18
2025-03-13 19:50:18,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:50:18
2025-03-13 19:50:18,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 19:50:18,681 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:50:18
2025-03-13 19:50:18,681 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:50:18,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s] 11%|█         | 3/28 [00:00<00:00, 27.99it/s] 39%|███▉      | 11/28 [00:00<00:00, 57.41it/s] 71%|███████▏  | 20/28 [00:00<00:00, 68.92it/s] 96%|█████████▋| 27/28 [00:03<00:00,  5.74it/s]100%|██████████| 28/28 [00:04<00:00,  5.80it/s]
2025-03-13 19:50:23,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:50:23
2025-03-13 19:51:08,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1316 secs
2025-03-13 19:51:08,649 [INFO]: The best hyperparameters are: efSearch=365
2025-03-13 19:51:08,649 [INFO]: 	Compute fast metrics 03/13/2025, 19:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.84it/s]
2025-03-13 19:51:24,828 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1792 secs
2025-03-13 19:51:24,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1490 secs
2025-03-13 19:51:24,830 [INFO]: {
2025-03-13 19:51:24,830 [INFO]: 	index_key: HNSW15
2025-03-13 19:51:24,830 [INFO]: 	index_param: efSearch=365
2025-03-13 19:51:24,830 [INFO]: 	index_path: knn.index
2025-03-13 19:51:24,830 [INFO]: 	size in bytes: 1345729390
2025-03-13 19:51:24,830 [INFO]: 	avg_search_speed_ms: 10.569766595030309
2025-03-13 19:51:24,830 [INFO]: 	99p_search_speed_ms: 16.30883705802262
2025-03-13 19:51:24,830 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:51:24,830 [INFO]: 	nb vectors: 6840
2025-03-13 19:51:24,830 [INFO]: 	vectors dimension: 49152
2025-03-13 19:51:24,830 [INFO]: 	compression ratio: 0.999308427082803
2025-03-13 19:51:24,830 [INFO]: }
2025-03-13 19:51:24,830 [INFO]: 	>>> Finished "Creating the index" in 66.1526 secs
2025-03-13 19:51:24,830 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1786 secs
2025-03-13 19:51:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:51:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 32092 [episode count 17/20]
[retrieval_preprocessing] for episode 57185 [episode count 18/20], we have num_retrieval=np.int64(6977) num_query=np.int64(293)
2025-03-13 19:51:31,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:51:31,985 [INFO]: Launching the whole pipeline 03/13/2025, 19:51:31
2025-03-13 19:51:31,985 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:51:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-13 19:51:32,010 [INFO]: There are 6977 embeddings of dim 49152
2025-03-13 19:51:32,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 19:51:32,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:51:32
2025-03-13 19:51:32,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:51:32,010 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:51:32,010 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:51:32,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:51:32,010 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:51:32
2025-03-13 19:51:32,011 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:51:32,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:51:32,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:51:32
2025-03-13 19:51:32,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:51:32,011 [INFO]: 	Creating the index 03/13/2025, 19:51:32
2025-03-13 19:51:32,011 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:51:32
2025-03-13 19:51:32,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:51:32,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:51:32
2025-03-13 19:51:32,012 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:51:32,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.41it/s] 31%|███       | 9/29 [00:00<00:00, 48.82it/s] 62%|██████▏   | 18/29 [00:00<00:00, 64.56it/s] 86%|████████▌ | 25/29 [00:03<00:00,  5.74it/s]100%|██████████| 29/29 [00:04<00:00,  4.58it/s]100%|██████████| 29/29 [00:04<00:00,  6.26it/s]
2025-03-13 19:51:36,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:51:36
2025-03-13 19:52:22,736 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0863 secs
2025-03-13 19:52:22,736 [INFO]: The best hyperparameters are: efSearch=361
2025-03-13 19:52:22,736 [INFO]: 	Compute fast metrics 03/13/2025, 19:52:22
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.50it/s]
2025-03-13 19:52:39,642 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9056 secs
2025-03-13 19:52:39,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6307 secs
2025-03-13 19:52:39,643 [INFO]: {
2025-03-13 19:52:39,643 [INFO]: 	index_key: HNSW15
2025-03-13 19:52:39,643 [INFO]: 	index_param: efSearch=361
2025-03-13 19:52:39,643 [INFO]: 	index_path: knn.index
2025-03-13 19:52:39,643 [INFO]: 	size in bytes: 1372683430
2025-03-13 19:52:39,643 [INFO]: 	avg_search_speed_ms: 10.950957229299801
2025-03-13 19:52:39,643 [INFO]: 	99p_search_speed_ms: 17.06827509915456
2025-03-13 19:52:39,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:52:39,643 [INFO]: 	nb vectors: 6977
2025-03-13 19:52:39,643 [INFO]: 	vectors dimension: 49152
2025-03-13 19:52:39,643 [INFO]: 	compression ratio: 0.9993083518171411
2025-03-13 19:52:39,643 [INFO]: }
2025-03-13 19:52:39,643 [INFO]: 	>>> Finished "Creating the index" in 67.6323 secs
2025-03-13 19:52:39,643 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6583 secs
2025-03-13 19:52:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:52:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 57185 [episode count 18/20]
[retrieval_preprocessing] for episode 6117 [episode count 19/20], we have num_retrieval=np.int64(6983) num_query=np.int64(287)
2025-03-13 19:52:44,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:52:44,885 [INFO]: Launching the whole pipeline 03/13/2025, 19:52:44
2025-03-13 19:52:44,885 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:52:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2474.52it/s]
2025-03-13 19:52:44,907 [INFO]: There are 6983 embeddings of dim 49152
2025-03-13 19:52:44,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0218 secs
2025-03-13 19:52:44,907 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:52:44
2025-03-13 19:52:44,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:52:44,907 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 19:52:44,907 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:52:44,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:52:44,907 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:52:44
2025-03-13 19:52:44,907 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:52:44,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:52:44,908 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:52:44
2025-03-13 19:52:44,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:52:44,908 [INFO]: 	Creating the index 03/13/2025, 19:52:44
2025-03-13 19:52:44,908 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:52:44
2025-03-13 19:52:44,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:52:44,909 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:52:44
2025-03-13 19:52:44,909 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 19:52:44,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.08it/s] 28%|██▊       | 8/29 [00:00<00:00, 40.09it/s] 55%|█████▌    | 16/29 [00:00<00:00, 54.04it/s] 76%|███████▌  | 22/29 [00:03<00:01,  5.01it/s]100%|██████████| 29/29 [00:04<00:00,  4.94it/s]100%|██████████| 29/29 [00:04<00:00,  6.19it/s]
2025-03-13 19:52:49,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:52:49
2025-03-13 19:53:35,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3366 secs
2025-03-13 19:53:35,932 [INFO]: The best hyperparameters are: efSearch=359
2025-03-13 19:53:35,932 [INFO]: 	Compute fast metrics 03/13/2025, 19:53:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.90it/s]
2025-03-13 19:53:52,226 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2939 secs
2025-03-13 19:53:52,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3184 secs
2025-03-13 19:53:52,227 [INFO]: {
2025-03-13 19:53:52,227 [INFO]: 	index_key: HNSW15
2025-03-13 19:53:52,227 [INFO]: 	index_param: efSearch=359
2025-03-13 19:53:52,227 [INFO]: 	index_path: knn.index
2025-03-13 19:53:52,227 [INFO]: 	size in bytes: 1373863930
2025-03-13 19:53:52,227 [INFO]: 	avg_search_speed_ms: 10.92500309968229
2025-03-13 19:53:52,227 [INFO]: 	99p_search_speed_ms: 16.975213564001027
2025-03-13 19:53:52,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:53:52,227 [INFO]: 	nb vectors: 6983
2025-03-13 19:53:52,227 [INFO]: 	vectors dimension: 49152
2025-03-13 19:53:52,227 [INFO]: 	compression ratio: 0.999308325970826
2025-03-13 19:53:52,227 [INFO]: }
2025-03-13 19:53:52,227 [INFO]: 	>>> Finished "Creating the index" in 67.3197 secs
2025-03-13 19:53:52,227 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3420 secs
2025-03-13 19:53:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:53:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 6117 [episode count 19/20]
2025-03-13 19:53:56: [retrieval_preprocessing] finished for 2515873443_wipe_counter_with_cloth [chosen_id count 9/196]
2025-03-13 19:53:56: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
