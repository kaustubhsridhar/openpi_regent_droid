nohup: ignoring input
2025-03-13 10:49:55: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:50:31: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2495127464_move_left [chosen_id count 0/260]
2025-03-13 10:50:31: [retrieval_preprocessing] we have num_total=5243 embedding_dim=49152
[retrieval_preprocessing] for episode 15875 [episode count 0/20], we have num_retrieval=np.int64(5134) num_query=np.int64(109)
2025-03-13 10:50:34,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:35,309 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:35
2025-03-13 10:50:35,309 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 683.56it/s]
2025-03-13 10:50:35,353 [INFO]: There are 5134 embeddings of dim 49152
2025-03-13 10:50:35,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0443 secs
2025-03-13 10:50:35,353 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,353 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:35,353 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 10:50:35,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:35,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:50:35,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,355 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:35,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0014 secs
2025-03-13 10:50:35,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:35
2025-03-13 10:50:35,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:35,355 [INFO]: 	Creating the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:35
2025-03-13 10:50:35,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 10:50:35,359 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,359 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:50:35,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.94it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.46it/s] 45%|████▌     | 10/22 [00:03<00:05,  2.13it/s] 55%|█████▍    | 12/22 [00:04<00:03,  2.55it/s] 64%|██████▎   | 14/22 [00:04<00:02,  3.27it/s] 77%|███████▋  | 17/22 [00:04<00:01,  4.87it/s] 95%|█████████▌| 21/22 [00:08<00:00,  1.80it/s]100%|██████████| 22/22 [00:09<00:00,  2.33it/s]
2025-03-13 10:50:44,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:44
2025-03-13 10:51:33,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6316 secs
2025-03-13 10:51:33,428 [INFO]: The best hyperparameters are: efSearch=138
2025-03-13 10:51:33,428 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 10:51:47,051 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6222 secs
2025-03-13 10:51:47,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6928 secs
2025-03-13 10:51:47,052 [INFO]: {
2025-03-13 10:51:47,052 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:47,052 [INFO]: 	index_param: efSearch=138
2025-03-13 10:51:47,052 [INFO]: 	index_path: knn.index
2025-03-13 10:51:47,052 [INFO]: 	size in bytes: 1010083990
2025-03-13 10:51:47,052 [INFO]: 	avg_search_speed_ms: 10.532922250904926
2025-03-13 10:51:47,052 [INFO]: 	99p_search_speed_ms: 18.202457015868273
2025-03-13 10:51:47,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:47,052 [INFO]: 	nb vectors: 5134
2025-03-13 10:51:47,052 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:47,052 [INFO]: 	compression ratio: 0.9993084555275448
2025-03-13 10:51:47,052 [INFO]: }
2025-03-13 10:51:47,052 [INFO]: 	>>> Finished "Creating the index" in 71.6964 secs
2025-03-13 10:51:47,052 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7431 secs
2025-03-13 10:51:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 15875 [episode count 0/20]
[retrieval_preprocessing] for episode 57891 [episode count 1/20], we have num_retrieval=np.int64(5031) num_query=np.int64(212)
2025-03-13 10:51:49,095 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:49,948 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:49
2025-03-13 10:51:49,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-13 10:51:49,976 [INFO]: There are 5031 embeddings of dim 49152
2025-03-13 10:51:49,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 10:51:49,977 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:49
2025-03-13 10:51:49,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:49,977 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 10:51:49,977 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:49,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:51:49,977 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:49
2025-03-13 10:51:49,978 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:49,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:51:49,978 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:49
2025-03-13 10:51:49,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:49,979 [INFO]: 	Creating the index 03/13/2025, 10:51:49
2025-03-13 10:51:49,979 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:49
2025-03-13 10:51:49,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 10:51:49,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:49
2025-03-13 10:51:49,982 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:51:49,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.01it/s] 20%|██        | 4/20 [00:00<00:01, 11.58it/s] 30%|███       | 6/20 [00:00<00:01, 10.20it/s] 40%|████      | 8/20 [00:00<00:01,  9.83it/s] 50%|█████     | 10/20 [00:00<00:00, 11.62it/s] 75%|███████▌  | 15/20 [00:01<00:00, 19.69it/s]100%|██████████| 20/20 [00:06<00:00,  1.95it/s]100%|██████████| 20/20 [00:06<00:00,  3.07it/s]
2025-03-13 10:51:56,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:56
2025-03-13 10:52:46,303 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7952 secs
2025-03-13 10:52:46,303 [INFO]: The best hyperparameters are: efSearch=142
2025-03-13 10:52:46,303 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 10:53:02,449 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1456 secs
2025-03-13 10:53:02,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4705 secs
2025-03-13 10:53:02,452 [INFO]: {
2025-03-13 10:53:02,452 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:02,452 [INFO]: 	index_param: efSearch=142
2025-03-13 10:53:02,452 [INFO]: 	index_path: knn.index
2025-03-13 10:53:02,452 [INFO]: 	size in bytes: 989819290
2025-03-13 10:53:02,452 [INFO]: 	avg_search_speed_ms: 9.3807421548652
2025-03-13 10:53:02,452 [INFO]: 	99p_search_speed_ms: 14.519321476109317
2025-03-13 10:53:02,452 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:02,452 [INFO]: 	nb vectors: 5031
2025-03-13 10:53:02,452 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:02,452 [INFO]: 	compression ratio: 0.9993085182245741
2025-03-13 10:53:02,452 [INFO]: }
2025-03-13 10:53:02,452 [INFO]: 	>>> Finished "Creating the index" in 72.4736 secs
2025-03-13 10:53:02,452 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5048 secs
2025-03-13 10:53:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 57891 [episode count 1/20]
[retrieval_preprocessing] for episode 71210 [episode count 2/20], we have num_retrieval=np.int64(4953) num_query=np.int64(290)
2025-03-13 10:53:04,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:05,532 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:05
2025-03-13 10:53:05,532 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.52it/s]
2025-03-13 10:53:05,562 [INFO]: There are 4953 embeddings of dim 49152
2025-03-13 10:53:05,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 10:53:05,562 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:05
2025-03-13 10:53:05,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:05,562 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:53:05,562 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:05,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:05,562 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:05
2025-03-13 10:53:05,562 [INFO]: 1022.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:05,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:05,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:05
2025-03-13 10:53:05,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:05,563 [INFO]: 	Creating the index 03/13/2025, 10:53:05
2025-03-13 10:53:05,563 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:05
2025-03-13 10:53:05,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:53:05,564 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:05
2025-03-13 10:53:05,564 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:53:05,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.70it/s] 25%|██▌       | 5/20 [00:00<00:00, 24.27it/s] 45%|████▌     | 9/20 [00:00<00:00, 30.75it/s] 65%|██████▌   | 13/20 [00:00<00:00, 34.04it/s] 85%|████████▌ | 17/20 [00:00<00:00, 35.92it/s]100%|██████████| 20/20 [00:05<00:00,  3.68it/s]
2025-03-13 10:53:10,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:10
2025-03-13 10:53:54,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6275 secs
2025-03-13 10:53:54,627 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 10:53:54,627 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.86it/s]
2025-03-13 10:54:07,123 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4960 secs
2025-03-13 10:54:07,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5617 secs
2025-03-13 10:54:07,126 [INFO]: {
2025-03-13 10:54:07,126 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:07,126 [INFO]: 	index_param: efSearch=137
2025-03-13 10:54:07,126 [INFO]: 	index_path: knn.index
2025-03-13 10:54:07,126 [INFO]: 	size in bytes: 974473150
2025-03-13 10:54:07,126 [INFO]: 	avg_search_speed_ms: 9.036200093913086
2025-03-13 10:54:07,126 [INFO]: 	99p_search_speed_ms: 14.376601525582375
2025-03-13 10:54:07,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:07,126 [INFO]: 	nb vectors: 4953
2025-03-13 10:54:07,126 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:07,126 [INFO]: 	compression ratio: 0.9993086253838805
2025-03-13 10:54:07,126 [INFO]: }
2025-03-13 10:54:07,126 [INFO]: 	>>> Finished "Creating the index" in 61.5631 secs
2025-03-13 10:54:07,126 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5936 secs
2025-03-13 10:54:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 71210 [episode count 2/20]
[retrieval_preprocessing] for episode 63024 [episode count 3/20], we have num_retrieval=np.int64(4917) num_query=np.int64(326)
2025-03-13 10:54:09,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:10,318 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:10
2025-03-13 10:54:10,318 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-13 10:54:10,342 [INFO]: There are 4917 embeddings of dim 49152
2025-03-13 10:54:10,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 10:54:10,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:10
2025-03-13 10:54:10,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:10,343 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:54:10,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:10,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:54:10,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:10
2025-03-13 10:54:10,343 [INFO]: 1014.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:10,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:10,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:10
2025-03-13 10:54:10,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:10,343 [INFO]: 	Creating the index 03/13/2025, 10:54:10
2025-03-13 10:54:10,343 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:10
2025-03-13 10:54:10,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:54:10,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:10
2025-03-13 10:54:10,344 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:54:10,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.58it/s] 30%|███       | 6/20 [00:00<00:00, 25.92it/s] 55%|█████▌    | 11/20 [00:00<00:00, 33.44it/s] 80%|████████  | 16/20 [00:00<00:00, 38.89it/s]100%|██████████| 20/20 [00:04<00:00,  4.17it/s]
2025-03-13 10:54:15,141 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:15
2025-03-13 10:55:00,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1738 secs
2025-03-13 10:55:00,315 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 10:55:00,316 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-13 10:55:15,028 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7123 secs
2025-03-13 10:55:15,031 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6866 secs
2025-03-13 10:55:15,031 [INFO]: {
2025-03-13 10:55:15,031 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:15,031 [INFO]: 	index_param: efSearch=96
2025-03-13 10:55:15,031 [INFO]: 	index_path: knn.index
2025-03-13 10:55:15,031 [INFO]: 	size in bytes: 967390210
2025-03-13 10:55:15,031 [INFO]: 	avg_search_speed_ms: 6.346953820483287
2025-03-13 10:55:15,031 [INFO]: 	99p_search_speed_ms: 10.040876513812691
2025-03-13 10:55:15,031 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:15,031 [INFO]: 	nb vectors: 4917
2025-03-13 10:55:15,031 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:15,031 [INFO]: 	compression ratio: 0.9993087856450398
2025-03-13 10:55:15,031 [INFO]: }
2025-03-13 10:55:15,031 [INFO]: 	>>> Finished "Creating the index" in 64.6881 secs
2025-03-13 10:55:15,031 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7137 secs
2025-03-13 10:55:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 63024 [episode count 3/20]
[retrieval_preprocessing] for episode 21577 [episode count 4/20], we have num_retrieval=np.int64(4831) num_query=np.int64(412)
2025-03-13 10:55:17,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:18,184 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:18
2025-03-13 10:55:18,184 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 10:55:18,211 [INFO]: There are 4831 embeddings of dim 49152
2025-03-13 10:55:18,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 10:55:18,211 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:18
2025-03-13 10:55:18,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:18,211 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:55:18,211 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:18,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:18,211 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:18
2025-03-13 10:55:18,211 [INFO]: 997.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:18,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:55:18,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:18
2025-03-13 10:55:18,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:18,211 [INFO]: 	Creating the index 03/13/2025, 10:55:18
2025-03-13 10:55:18,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:18
2025-03-13 10:55:18,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:55:18,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:18
2025-03-13 10:55:18,212 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:55:18,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.29it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.62it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.55it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.14it/s]100%|██████████| 20/20 [00:05<00:00,  3.93it/s]
2025-03-13 10:55:23,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:23
2025-03-13 10:56:08,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4559 secs
2025-03-13 10:56:08,765 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 10:56:08,765 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-13 10:56:21,859 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0946 secs
2025-03-13 10:56:21,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6500 secs
2025-03-13 10:56:21,863 [INFO]: {
2025-03-13 10:56:21,863 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:21,863 [INFO]: 	index_param: efSearch=158
2025-03-13 10:56:21,863 [INFO]: 	index_path: knn.index
2025-03-13 10:56:21,863 [INFO]: 	size in bytes: 950470390
2025-03-13 10:56:21,863 [INFO]: 	avg_search_speed_ms: 10.687858215284447
2025-03-13 10:56:21,863 [INFO]: 	99p_search_speed_ms: 17.38057524198666
2025-03-13 10:56:21,863 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:21,863 [INFO]: 	nb vectors: 4831
2025-03-13 10:56:21,863 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:21,863 [INFO]: 	compression ratio: 0.9993086139169469
2025-03-13 10:56:21,863 [INFO]: }
2025-03-13 10:56:21,863 [INFO]: 	>>> Finished "Creating the index" in 63.6516 secs
2025-03-13 10:56:21,863 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6786 secs
2025-03-13 10:56:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 21577 [episode count 4/20]
[retrieval_preprocessing] for episode 32338 [episode count 5/20], we have num_retrieval=np.int64(5001) num_query=np.int64(242)
2025-03-13 10:56:25,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:26,439 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:26
2025-03-13 10:56:26,439 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-13 10:56:26,468 [INFO]: There are 5001 embeddings of dim 49152
2025-03-13 10:56:26,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 10:56:26,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:26
2025-03-13 10:56:26,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:26,469 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:56:26,469 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:26,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:26,469 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:26
2025-03-13 10:56:26,469 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:26,469 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:56:26,469 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:26
2025-03-13 10:56:26,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:26,469 [INFO]: 	Creating the index 03/13/2025, 10:56:26
2025-03-13 10:56:26,469 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:26
2025-03-13 10:56:26,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 10:56:26,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:26
2025-03-13 10:56:26,471 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:56:26,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.70it/s] 30%|███       | 6/20 [00:00<00:00, 29.39it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.49it/s] 80%|████████  | 16/20 [00:00<00:00, 39.75it/s]100%|██████████| 20/20 [00:05<00:00,  2.41it/s]100%|██████████| 20/20 [00:05<00:00,  3.85it/s]
2025-03-13 10:56:31,673 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:31
2025-03-13 10:57:16,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3066 secs
2025-03-13 10:57:16,980 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 10:57:16,980 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 10:57:30,123 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1421 secs
2025-03-13 10:57:30,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6551 secs
2025-03-13 10:57:30,126 [INFO]: {
2025-03-13 10:57:30,126 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:30,126 [INFO]: 	index_param: efSearch=145
2025-03-13 10:57:30,126 [INFO]: 	index_path: knn.index
2025-03-13 10:57:30,126 [INFO]: 	size in bytes: 983916970
2025-03-13 10:57:30,126 [INFO]: 	avg_search_speed_ms: 9.09091926920651
2025-03-13 10:57:30,126 [INFO]: 	99p_search_speed_ms: 14.956395386252549
2025-03-13 10:57:30,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:30,126 [INFO]: 	nb vectors: 5001
2025-03-13 10:57:30,126 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:30,126 [INFO]: 	compression ratio: 0.9993085168558481
2025-03-13 10:57:30,126 [INFO]: }
2025-03-13 10:57:30,126 [INFO]: 	>>> Finished "Creating the index" in 63.6569 secs
2025-03-13 10:57:30,126 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6872 secs
2025-03-13 10:57:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 32338 [episode count 5/20]
[retrieval_preprocessing] for episode 92777 [episode count 6/20], we have num_retrieval=np.int64(4965) num_query=np.int64(278)
2025-03-13 10:57:32,374 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:33,139 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:33
2025-03-13 10:57:33,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2022.33it/s]
2025-03-13 10:57:33,164 [INFO]: There are 4965 embeddings of dim 49152
2025-03-13 10:57:33,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 10:57:33,164 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:33
2025-03-13 10:57:33,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:33,164 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:57:33,164 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:33,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:33,164 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:33
2025-03-13 10:57:33,164 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:33,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:33,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:33
2025-03-13 10:57:33,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:33,165 [INFO]: 	Creating the index 03/13/2025, 10:57:33
2025-03-13 10:57:33,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:33
2025-03-13 10:57:33,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:57:33,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:33
2025-03-13 10:57:33,166 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:57:33,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.01it/s] 30%|███       | 6/20 [00:00<00:00, 27.73it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.44it/s] 80%|████████  | 16/20 [00:00<00:00, 39.74it/s]100%|██████████| 20/20 [00:04<00:00,  4.34it/s]
2025-03-13 10:57:37,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:37
2025-03-13 10:58:22,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1567 secs
2025-03-13 10:58:22,939 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 10:58:22,939 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.03it/s]
2025-03-13 10:58:37,898 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9590 secs
2025-03-13 10:58:37,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7357 secs
2025-03-13 10:58:37,901 [INFO]: {
2025-03-13 10:58:37,902 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:37,902 [INFO]: 	index_param: efSearch=101
2025-03-13 10:58:37,902 [INFO]: 	index_path: knn.index
2025-03-13 10:58:37,902 [INFO]: 	size in bytes: 976834030
2025-03-13 10:58:37,902 [INFO]: 	avg_search_speed_ms: 6.010627522650443
2025-03-13 10:58:37,902 [INFO]: 	99p_search_speed_ms: 9.201097774785007
2025-03-13 10:58:37,902 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:37,902 [INFO]: 	nb vectors: 4965
2025-03-13 10:58:37,902 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:37,902 [INFO]: 	compression ratio: 0.9993086747807097
2025-03-13 10:58:37,902 [INFO]: }
2025-03-13 10:58:37,902 [INFO]: 	>>> Finished "Creating the index" in 64.7371 secs
2025-03-13 10:58:37,902 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7624 secs
2025-03-13 10:58:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 92777 [episode count 6/20]
[retrieval_preprocessing] for episode 36861 [episode count 7/20], we have num_retrieval=np.int64(4889) num_query=np.int64(354)
2025-03-13 10:58:39,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:40,634 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:40
2025-03-13 10:58:40,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.96it/s]
2025-03-13 10:58:40,661 [INFO]: There are 4889 embeddings of dim 49152
2025-03-13 10:58:40,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 10:58:40,661 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:40,661 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 10:58:40,661 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:40,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:40,661 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,661 [INFO]: 1009.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:40,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:58:40,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:40
2025-03-13 10:58:40,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:40,662 [INFO]: 	Creating the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:40
2025-03-13 10:58:40,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:58:40,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:40
2025-03-13 10:58:40,663 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:58:40,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.53it/s] 30%|███       | 6/20 [00:00<00:00, 29.57it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.78it/s] 80%|████████  | 16/20 [00:00<00:00, 41.12it/s]100%|██████████| 20/20 [00:04<00:00,  4.29it/s]
2025-03-13 10:58:45,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:45
2025-03-13 10:59:28,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5458 secs
2025-03-13 10:59:28,875 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 10:59:28,875 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.95it/s]
2025-03-13 10:59:41,482 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6070 secs
2025-03-13 10:59:41,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8232 secs
2025-03-13 10:59:41,486 [INFO]: {
2025-03-13 10:59:41,486 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:41,486 [INFO]: 	index_param: efSearch=159
2025-03-13 10:59:41,486 [INFO]: 	index_path: knn.index
2025-03-13 10:59:41,486 [INFO]: 	size in bytes: 961881430
2025-03-13 10:59:41,486 [INFO]: 	avg_search_speed_ms: 9.150986566718698
2025-03-13 10:59:41,486 [INFO]: 	99p_search_speed_ms: 12.944008307531474
2025-03-13 10:59:41,486 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:41,486 [INFO]: 	nb vectors: 4889
2025-03-13 10:59:41,486 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:41,486 [INFO]: 	compression ratio: 0.9993087318465022
2025-03-13 10:59:41,486 [INFO]: }
2025-03-13 10:59:41,486 [INFO]: 	>>> Finished "Creating the index" in 60.8245 secs
2025-03-13 10:59:41,486 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8516 secs
2025-03-13 10:59:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 36861 [episode count 7/20]
[retrieval_preprocessing] for episode 24253 [episode count 8/20], we have num_retrieval=np.int64(5090) num_query=np.int64(153)
2025-03-13 10:59:44,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:45,375 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:45
2025-03-13 10:59:45,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-13 10:59:45,401 [INFO]: There are 5090 embeddings of dim 49152
2025-03-13 10:59:45,401 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 10:59:45,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:45
2025-03-13 10:59:45,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:45,401 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 10:59:45,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:45,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:45,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:45
2025-03-13 10:59:45,401 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:45,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:59:45,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:45
2025-03-13 10:59:45,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:45,402 [INFO]: 	Creating the index 03/13/2025, 10:59:45
2025-03-13 10:59:45,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:45
2025-03-13 10:59:45,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:59:45,403 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:45
2025-03-13 10:59:45,403 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 10:59:45,403 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.80it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.75it/s] 50%|█████     | 11/22 [00:00<00:00, 38.96it/s] 68%|██████▊   | 15/22 [00:00<00:00, 36.77it/s] 86%|████████▋ | 19/22 [00:00<00:00, 34.55it/s]100%|██████████| 22/22 [00:05<00:00,  3.85it/s]
2025-03-13 10:59:51,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:51
2025-03-13 11:00:34,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1109 secs
2025-03-13 11:00:34,233 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 11:00:34,233 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.82it/s]
2025-03-13 11:00:47,321 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0877 secs
2025-03-13 11:00:47,590 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1873 secs
2025-03-13 11:00:47,590 [INFO]: {
2025-03-13 11:00:47,590 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:47,590 [INFO]: 	index_param: efSearch=124
2025-03-13 11:00:47,590 [INFO]: 	index_path: knn.index
2025-03-13 11:00:47,591 [INFO]: 	size in bytes: 1001427190
2025-03-13 11:00:47,591 [INFO]: 	avg_search_speed_ms: 7.332326129626461
2025-03-13 11:00:47,591 [INFO]: 	99p_search_speed_ms: 10.627149601932613
2025-03-13 11:00:47,591 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:47,591 [INFO]: 	nb vectors: 5090
2025-03-13 11:00:47,591 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:47,591 [INFO]: 	compression ratio: 0.9993085168777972
2025-03-13 11:00:47,591 [INFO]: }
2025-03-13 11:00:47,591 [INFO]: 	>>> Finished "Creating the index" in 62.1894 secs
2025-03-13 11:00:47,591 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2163 secs
2025-03-13 11:00:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 24253 [episode count 8/20]
[retrieval_preprocessing] for episode 57550 [episode count 9/20], we have num_retrieval=np.int64(5056) num_query=np.int64(187)
2025-03-13 11:00:49,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:49,928 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:49
2025-03-13 11:00:49,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2191.38it/s]
2025-03-13 11:00:49,953 [INFO]: There are 5056 embeddings of dim 49152
2025-03-13 11:00:49,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:00:49,954 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:49,954 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:00:49,954 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:49,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:00:49,955 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,955 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:49,955 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:00:49,955 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:49
2025-03-13 11:00:49,955 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:49,956 [INFO]: 	Creating the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,956 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:49
2025-03-13 11:00:49,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:00:49,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:49
2025-03-13 11:00:49,959 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:00:49,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.49it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.15it/s] 60%|██████    | 12/20 [00:00<00:00, 37.39it/s] 85%|████████▌ | 17/20 [00:00<00:00, 38.68it/s]100%|██████████| 20/20 [00:05<00:00,  3.85it/s]
2025-03-13 11:00:55,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:55
2025-03-13 11:01:40,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8542 secs
2025-03-13 11:01:40,018 [INFO]: The best hyperparameters are: efSearch=152
2025-03-13 11:01:40,018 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.57it/s]
2025-03-13 11:01:52,597 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5790 secs
2025-03-13 11:01:52,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6417 secs
2025-03-13 11:01:52,601 [INFO]: {
2025-03-13 11:01:52,601 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:52,601 [INFO]: 	index_param: efSearch=152
2025-03-13 11:01:52,601 [INFO]: 	index_path: knn.index
2025-03-13 11:01:52,601 [INFO]: 	size in bytes: 994737970
2025-03-13 11:01:52,601 [INFO]: 	avg_search_speed_ms: 9.247987342838288
2025-03-13 11:01:52,601 [INFO]: 	99p_search_speed_ms: 13.009340104181325
2025-03-13 11:01:52,601 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:52,601 [INFO]: 	nb vectors: 5056
2025-03-13 11:01:52,601 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:52,601 [INFO]: 	compression ratio: 0.9993084389851933
2025-03-13 11:01:52,601 [INFO]: }
2025-03-13 11:01:52,601 [INFO]: 	>>> Finished "Creating the index" in 62.6453 secs
2025-03-13 11:01:52,601 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6724 secs
2025-03-13 11:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 57550 [episode count 9/20]
[retrieval_preprocessing] for episode 10941 [episode count 10/20], we have num_retrieval=np.int64(5052) num_query=np.int64(191)
2025-03-13 11:01:54,459 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:55,128 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:55
2025-03-13 11:01:55,129 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-13 11:01:55,151 [INFO]: There are 5052 embeddings of dim 49152
2025-03-13 11:01:55,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:01:55,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:55
2025-03-13 11:01:55,152 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:55,152 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:01:55,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:55,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:01:55,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:55
2025-03-13 11:01:55,152 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:55,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:01:55,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:55
2025-03-13 11:01:55,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:55,152 [INFO]: 	Creating the index 03/13/2025, 11:01:55
2025-03-13 11:01:55,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:55
2025-03-13 11:01:55,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:01:55,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:55
2025-03-13 11:01:55,153 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:01:55,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.09it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.07it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.42it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.03it/s]100%|██████████| 20/20 [00:05<00:00,  3.89it/s]
2025-03-13 11:02:00,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:00
2025-03-13 11:02:44,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4357 secs
2025-03-13 11:02:44,734 [INFO]: The best hyperparameters are: efSearch=135
2025-03-13 11:02:44,734 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.20it/s]
2025-03-13 11:02:57,220 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4853 secs
2025-03-13 11:02:57,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0696 secs
2025-03-13 11:02:57,223 [INFO]: {
2025-03-13 11:02:57,223 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:57,223 [INFO]: 	index_param: efSearch=135
2025-03-13 11:02:57,223 [INFO]: 	index_path: knn.index
2025-03-13 11:02:57,223 [INFO]: 	size in bytes: 993951010
2025-03-13 11:02:57,223 [INFO]: 	avg_search_speed_ms: 8.620346083851723
2025-03-13 11:02:57,223 [INFO]: 	99p_search_speed_ms: 12.663594849873338
2025-03-13 11:02:57,223 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:57,223 [INFO]: 	nb vectors: 5052
2025-03-13 11:02:57,223 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:57,223 [INFO]: 	compression ratio: 0.9993084226555593
2025-03-13 11:02:57,223 [INFO]: }
2025-03-13 11:02:57,223 [INFO]: 	>>> Finished "Creating the index" in 62.0710 secs
2025-03-13 11:02:57,223 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0943 secs
2025-03-13 11:02:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 10941 [episode count 10/20]
[retrieval_preprocessing] for episode 44320 [episode count 11/20], we have num_retrieval=np.int64(5043) num_query=np.int64(200)
2025-03-13 11:02:58,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:59,662 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:59
2025-03-13 11:02:59,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1628.22it/s]
2025-03-13 11:02:59,687 [INFO]: There are 5043 embeddings of dim 49152
2025-03-13 11:02:59,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:02:59,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:59
2025-03-13 11:02:59,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:59,688 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:02:59,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:59,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:02:59,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:59
2025-03-13 11:02:59,688 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:59,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:02:59,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:59
2025-03-13 11:02:59,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:59,688 [INFO]: 	Creating the index 03/13/2025, 11:02:59
2025-03-13 11:02:59,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:59
2025-03-13 11:02:59,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:02:59,689 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:59
2025-03-13 11:02:59,689 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:02:59,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.74it/s] 30%|███       | 6/20 [00:00<00:00, 29.11it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.25it/s] 80%|████████  | 16/20 [00:00<00:00, 41.38it/s]100%|██████████| 20/20 [00:04<00:00,  4.24it/s]
2025-03-13 11:03:04,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:04
2025-03-13 11:03:49,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8932 secs
2025-03-13 11:03:49,306 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 11:03:49,306 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 11:04:02,148 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8418 secs
2025-03-13 11:04:02,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4616 secs
2025-03-13 11:04:02,151 [INFO]: {
2025-03-13 11:04:02,151 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:02,151 [INFO]: 	index_param: efSearch=105
2025-03-13 11:04:02,151 [INFO]: 	index_path: knn.index
2025-03-13 11:04:02,151 [INFO]: 	size in bytes: 992180290
2025-03-13 11:04:02,151 [INFO]: 	avg_search_speed_ms: 7.618479873461582
2025-03-13 11:04:02,151 [INFO]: 	99p_search_speed_ms: 16.21688493527471
2025-03-13 11:04:02,151 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:02,151 [INFO]: 	nb vectors: 5043
2025-03-13 11:04:02,151 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:02,151 [INFO]: 	compression ratio: 0.9993084462502274
2025-03-13 11:04:02,151 [INFO]: }
2025-03-13 11:04:02,151 [INFO]: 	>>> Finished "Creating the index" in 62.4630 secs
2025-03-13 11:04:02,151 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4889 secs
2025-03-13 11:04:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 44320 [episode count 11/20]
[retrieval_preprocessing] for episode 17210 [episode count 12/20], we have num_retrieval=np.int64(5069) num_query=np.int64(174)
2025-03-13 11:04:03,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:04,474 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:04
2025-03-13 11:04:04,474 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2216.86it/s]
2025-03-13 11:04:04,499 [INFO]: There are 5069 embeddings of dim 49152
2025-03-13 11:04:04,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:04:04,499 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:04
2025-03-13 11:04:04,499 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:04,499 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:04:04,499 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:04,499 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:04:04,499 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:04
2025-03-13 11:04:04,499 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:04,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:04:04,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:04
2025-03-13 11:04:04,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:04,499 [INFO]: 	Creating the index 03/13/2025, 11:04:04
2025-03-13 11:04:04,500 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:04
2025-03-13 11:04:04,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:04:04,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:04
2025-03-13 11:04:04,501 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:04:04,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.43it/s] 40%|████      | 8/20 [00:00<00:00, 37.96it/s] 70%|███████   | 14/20 [00:00<00:00, 44.68it/s]100%|██████████| 20/20 [00:04<00:00,  3.03it/s]100%|██████████| 20/20 [00:04<00:00,  4.23it/s]
2025-03-13 11:04:09,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:09
2025-03-13 11:04:55,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0923 secs
2025-03-13 11:04:55,325 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 11:04:55,325 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 11:05:07,905 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5803 secs
2025-03-13 11:05:07,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4075 secs
2025-03-13 11:05:07,908 [INFO]: {
2025-03-13 11:05:07,908 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:07,908 [INFO]: 	index_param: efSearch=125
2025-03-13 11:05:07,908 [INFO]: 	index_path: knn.index
2025-03-13 11:05:07,908 [INFO]: 	size in bytes: 997295590
2025-03-13 11:05:07,908 [INFO]: 	avg_search_speed_ms: 7.93970547291258
2025-03-13 11:05:07,908 [INFO]: 	99p_search_speed_ms: 12.576751674059789
2025-03-13 11:05:07,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:07,908 [INFO]: 	nb vectors: 5069
2025-03-13 11:05:07,908 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:07,908 [INFO]: 	compression ratio: 0.9993084918785212
2025-03-13 11:05:07,908 [INFO]: }
2025-03-13 11:05:07,908 [INFO]: 	>>> Finished "Creating the index" in 63.4089 secs
2025-03-13 11:05:07,908 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4345 secs
2025-03-13 11:05:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 17210 [episode count 12/20]
[retrieval_preprocessing] for episode 58179 [episode count 13/20], we have num_retrieval=np.int64(4961) num_query=np.int64(282)
2025-03-13 11:05:09,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:10,785 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:10
2025-03-13 11:05:10,785 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-13 11:05:10,815 [INFO]: There are 4961 embeddings of dim 49152
2025-03-13 11:05:10,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:05:10,815 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:10
2025-03-13 11:05:10,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:10,816 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:05:10,816 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:10,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:05:10,816 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:10
2025-03-13 11:05:10,817 [INFO]: 1023.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:10,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:05:10,817 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:10
2025-03-13 11:05:10,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:10,817 [INFO]: 	Creating the index 03/13/2025, 11:05:10
2025-03-13 11:05:10,818 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:10
2025-03-13 11:05:10,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:05:10,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:10
2025-03-13 11:05:10,821 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:05:10,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.74it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.29it/s] 60%|██████    | 12/20 [00:00<00:00, 40.15it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.46it/s]100%|██████████| 20/20 [00:04<00:00,  4.08it/s]
2025-03-13 11:05:15,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:15
2025-03-13 11:06:01,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0404 secs
2025-03-13 11:06:01,772 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 11:06:01,772 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 11:06:18,291 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5182 secs
2025-03-13 11:06:18,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4730 secs
2025-03-13 11:06:18,294 [INFO]: {
2025-03-13 11:06:18,294 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:18,294 [INFO]: 	index_param: efSearch=134
2025-03-13 11:06:18,294 [INFO]: 	index_path: knn.index
2025-03-13 11:06:18,294 [INFO]: 	size in bytes: 976047070
2025-03-13 11:06:18,294 [INFO]: 	avg_search_speed_ms: 8.919355715168457
2025-03-13 11:06:18,294 [INFO]: 	99p_search_speed_ms: 12.696308223530648
2025-03-13 11:06:18,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:18,294 [INFO]: 	nb vectors: 4961
2025-03-13 11:06:18,294 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:18,294 [INFO]: 	compression ratio: 0.9993086583416515
2025-03-13 11:06:18,294 [INFO]: }
2025-03-13 11:06:18,294 [INFO]: 	>>> Finished "Creating the index" in 67.4768 secs
2025-03-13 11:06:18,294 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5092 secs
2025-03-13 11:06:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 58179 [episode count 13/20]
[retrieval_preprocessing] for episode 15231 [episode count 14/20], we have num_retrieval=np.int64(5066) num_query=np.int64(177)
2025-03-13 11:06:20,641 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:21,345 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:21
2025-03-13 11:06:21,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.90it/s]
2025-03-13 11:06:21,374 [INFO]: There are 5066 embeddings of dim 49152
2025-03-13 11:06:21,374 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:06:21,374 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:21,374 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:06:21,374 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:21,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:21,374 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,374 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:21,374 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:06:21,374 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:21
2025-03-13 11:06:21,374 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:21,374 [INFO]: 	Creating the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,375 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:21
2025-03-13 11:06:21,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:06:21,376 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:21
2025-03-13 11:06:21,376 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:06:21,376 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.86it/s] 25%|██▌       | 5/20 [00:00<00:00, 22.86it/s] 50%|█████     | 10/20 [00:00<00:00, 31.34it/s] 70%|███████   | 14/20 [00:00<00:00, 33.43it/s] 95%|█████████▌| 19/20 [00:00<00:00, 36.50it/s]100%|██████████| 20/20 [00:05<00:00,  3.84it/s]
2025-03-13 11:06:26,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:26
2025-03-13 11:07:11,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3645 secs
2025-03-13 11:07:11,959 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 11:07:11,959 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-13 11:07:24,690 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7307 secs
2025-03-13 11:07:24,693 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3176 secs
2025-03-13 11:07:24,694 [INFO]: {
2025-03-13 11:07:24,694 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:24,694 [INFO]: 	index_param: efSearch=140
2025-03-13 11:07:24,694 [INFO]: 	index_path: knn.index
2025-03-13 11:07:24,694 [INFO]: 	size in bytes: 996705370
2025-03-13 11:07:24,694 [INFO]: 	avg_search_speed_ms: 9.54413415712148
2025-03-13 11:07:24,694 [INFO]: 	99p_search_speed_ms: 16.520724219735712
2025-03-13 11:07:24,694 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:24,694 [INFO]: 	nb vectors: 5066
2025-03-13 11:07:24,694 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:24,694 [INFO]: 	compression ratio: 0.9993084796964623
2025-03-13 11:07:24,694 [INFO]: }
2025-03-13 11:07:24,694 [INFO]: 	>>> Finished "Creating the index" in 63.3193 secs
2025-03-13 11:07:24,694 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3483 secs
2025-03-13 11:07:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 15231 [episode count 14/20]
[retrieval_preprocessing] for episode 9601 [episode count 15/20], we have num_retrieval=np.int64(4990) num_query=np.int64(253)
2025-03-13 11:07:26,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:27,867 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:27
2025-03-13 11:07:27,867 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1753.47it/s]
2025-03-13 11:07:27,894 [INFO]: There are 4990 embeddings of dim 49152
2025-03-13 11:07:27,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:07:27,894 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:27
2025-03-13 11:07:27,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:27,894 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:07:27,894 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:27,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:07:27,895 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:27
2025-03-13 11:07:27,895 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:27,895 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:07:27,895 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:27
2025-03-13 11:07:27,895 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:27,895 [INFO]: 	Creating the index 03/13/2025, 11:07:27
2025-03-13 11:07:27,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:27
2025-03-13 11:07:27,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 11:07:27,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:27
2025-03-13 11:07:27,898 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:07:27,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.94it/s] 35%|███▌      | 7/20 [00:00<00:00, 32.62it/s] 60%|██████    | 12/20 [00:00<00:00, 36.41it/s] 85%|████████▌ | 17/20 [00:00<00:00, 38.02it/s]100%|██████████| 20/20 [00:05<00:00,  3.91it/s]
2025-03-13 11:07:33,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:33
2025-03-13 11:08:18,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3722 secs
2025-03-13 11:08:18,393 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 11:08:18,393 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.17it/s]
2025-03-13 11:08:31,942 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5487 secs
2025-03-13 11:08:31,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0473 secs
2025-03-13 11:08:31,946 [INFO]: {
2025-03-13 11:08:31,946 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:31,946 [INFO]: 	index_param: efSearch=153
2025-03-13 11:08:31,946 [INFO]: 	index_path: knn.index
2025-03-13 11:08:31,946 [INFO]: 	size in bytes: 981752710
2025-03-13 11:08:31,946 [INFO]: 	avg_search_speed_ms: 10.28386889267732
2025-03-13 11:08:31,946 [INFO]: 	99p_search_speed_ms: 16.10089841298759
2025-03-13 11:08:31,946 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:31,946 [INFO]: 	nb vectors: 4990
2025-03-13 11:08:31,946 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:31,946 [INFO]: 	compression ratio: 0.9993085937088985
2025-03-13 11:08:31,946 [INFO]: }
2025-03-13 11:08:31,946 [INFO]: 	>>> Finished "Creating the index" in 64.0505 secs
2025-03-13 11:08:31,946 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0789 secs
2025-03-13 11:08:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 9601 [episode count 15/20]
[retrieval_preprocessing] for episode 53183 [episode count 16/20], we have num_retrieval=np.int64(5009) num_query=np.int64(234)
2025-03-13 11:08:34,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:35,211 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:35
2025-03-13 11:08:35,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.20it/s]
2025-03-13 11:08:35,234 [INFO]: There are 5009 embeddings of dim 49152
2025-03-13 11:08:35,234 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 11:08:35,234 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,234 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:35,234 [INFO]: 		-> Add: 2.8 seconds
2025-03-13 11:08:35,235 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:35,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:35,235 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,235 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:35,235 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:35,235 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:35
2025-03-13 11:08:35,235 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:35,235 [INFO]: 	Creating the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,235 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:35
2025-03-13 11:08:35,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:08:35,236 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:35
2025-03-13 11:08:35,236 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:08:35,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 16.09it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.99it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.86it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.82it/s]100%|██████████| 20/20 [00:05<00:00,  3.79it/s]
2025-03-13 11:08:40,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:40
2025-03-13 11:09:25,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4553 secs
2025-03-13 11:09:25,970 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 11:09:25,970 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.79it/s]
2025-03-13 11:09:40,881 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9108 secs
2025-03-13 11:09:40,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6484 secs
2025-03-13 11:09:40,885 [INFO]: {
2025-03-13 11:09:40,885 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:40,885 [INFO]: 	index_param: efSearch=144
2025-03-13 11:09:40,885 [INFO]: 	index_path: knn.index
2025-03-13 11:09:40,885 [INFO]: 	size in bytes: 985490890
2025-03-13 11:09:40,885 [INFO]: 	avg_search_speed_ms: 9.028928836854679
2025-03-13 11:09:40,885 [INFO]: 	99p_search_speed_ms: 13.682847179006796
2025-03-13 11:09:40,885 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:40,885 [INFO]: 	nb vectors: 5009
2025-03-13 11:09:40,885 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:40,885 [INFO]: 	compression ratio: 0.9993085496711187
2025-03-13 11:09:40,885 [INFO]: }
2025-03-13 11:09:40,885 [INFO]: 	>>> Finished "Creating the index" in 65.6500 secs
2025-03-13 11:09:40,885 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6736 secs
2025-03-13 11:09:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 53183 [episode count 16/20]
[retrieval_preprocessing] for episode 77257 [episode count 17/20], we have num_retrieval=np.int64(4883) num_query=np.int64(360)
2025-03-13 11:09:43,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:43,936 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:43
2025-03-13 11:09:43,937 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1750.54it/s]
2025-03-13 11:09:43,966 [INFO]: There are 4883 embeddings of dim 49152
2025-03-13 11:09:43,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 11:09:43,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:43
2025-03-13 11:09:43,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:43,967 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:09:43,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:43,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:09:43,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:43
2025-03-13 11:09:43,967 [INFO]: 1007.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:43,968 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:09:43,968 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:43
2025-03-13 11:09:43,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:43,968 [INFO]: 	Creating the index 03/13/2025, 11:09:43
2025-03-13 11:09:43,968 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:43
2025-03-13 11:09:43,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:09:43,972 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:43
2025-03-13 11:09:43,972 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:09:43,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.58it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.28it/s] 60%|██████    | 12/20 [00:00<00:00, 41.65it/s] 90%|█████████ | 18/20 [00:00<00:00, 45.17it/s]100%|██████████| 20/20 [00:04<00:00,  4.29it/s]
2025-03-13 11:09:48,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:48
2025-03-13 11:10:34,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1730 secs
2025-03-13 11:10:34,808 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 11:10:34,809 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 11:10:48,294 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4858 secs
2025-03-13 11:10:48,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3256 secs
2025-03-13 11:10:48,297 [INFO]: {
2025-03-13 11:10:48,297 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:48,297 [INFO]: 	index_param: efSearch=121
2025-03-13 11:10:48,297 [INFO]: 	index_path: knn.index
2025-03-13 11:10:48,297 [INFO]: 	size in bytes: 960700990
2025-03-13 11:10:48,297 [INFO]: 	avg_search_speed_ms: 8.440106359353674
2025-03-13 11:10:48,298 [INFO]: 	99p_search_speed_ms: 12.86807333119214
2025-03-13 11:10:48,298 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:48,298 [INFO]: 	nb vectors: 4883
2025-03-13 11:10:48,298 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:48,298 [INFO]: 	compression ratio: 0.999308706864141
2025-03-13 11:10:48,298 [INFO]: }
2025-03-13 11:10:48,298 [INFO]: 	>>> Finished "Creating the index" in 64.3294 secs
2025-03-13 11:10:48,298 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3611 secs
2025-03-13 11:10:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 77257 [episode count 17/20]
[retrieval_preprocessing] for episode 4565 [episode count 18/20], we have num_retrieval=np.int64(4826) num_query=np.int64(417)
2025-03-13 11:10:51,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:51,808 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:51
2025-03-13 11:10:51,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.85it/s]
2025-03-13 11:10:51,836 [INFO]: There are 4826 embeddings of dim 49152
2025-03-13 11:10:51,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 11:10:51,837 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:51
2025-03-13 11:10:51,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:51,837 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:10:51,837 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:51,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:51,837 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:51
2025-03-13 11:10:51,837 [INFO]: 996.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:51,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:10:51,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:51
2025-03-13 11:10:51,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:51,837 [INFO]: 	Creating the index 03/13/2025, 11:10:51
2025-03-13 11:10:51,837 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:51
2025-03-13 11:10:51,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:10:51,838 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:51
2025-03-13 11:10:51,838 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:10:51,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.71it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.73it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.86it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.26it/s]100%|██████████| 19/19 [00:04<00:00,  3.83it/s]
2025-03-13 11:10:56,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:56
2025-03-13 11:11:42,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5040 secs
2025-03-13 11:11:42,307 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 11:11:42,307 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 11:11:58,704 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3968 secs
2025-03-13 11:11:58,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1442 secs
2025-03-13 11:11:58,983 [INFO]: {
2025-03-13 11:11:58,983 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:58,983 [INFO]: 	index_param: efSearch=150
2025-03-13 11:11:58,983 [INFO]: 	index_path: knn.index
2025-03-13 11:11:58,983 [INFO]: 	size in bytes: 949486690
2025-03-13 11:11:58,983 [INFO]: 	avg_search_speed_ms: 10.503055120352656
2025-03-13 11:11:58,983 [INFO]: 	99p_search_speed_ms: 17.428298322483897
2025-03-13 11:11:58,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:58,984 [INFO]: 	nb vectors: 4826
2025-03-13 11:11:58,984 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:58,984 [INFO]: 	compression ratio: 0.9993085927302467
2025-03-13 11:11:58,984 [INFO]: }
2025-03-13 11:11:58,984 [INFO]: 	>>> Finished "Creating the index" in 67.1468 secs
2025-03-13 11:11:58,984 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1756 secs
2025-03-13 11:12:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 4565 [episode count 18/20]
[retrieval_preprocessing] for episode 90611 [episode count 19/20], we have num_retrieval=np.int64(4851) num_query=np.int64(392)
2025-03-13 11:12:02,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:03,421 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:03
2025-03-13 11:12:03,421 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.00it/s]
2025-03-13 11:12:03,447 [INFO]: There are 4851 embeddings of dim 49152
2025-03-13 11:12:03,447 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:12:03,447 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:03
2025-03-13 11:12:03,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:03,447 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 11:12:03,447 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:03,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:03,447 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:03
2025-03-13 11:12:03,447 [INFO]: 1001.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:03,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:03,447 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:03
2025-03-13 11:12:03,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:03,447 [INFO]: 	Creating the index 03/13/2025, 11:12:03
2025-03-13 11:12:03,447 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:03
2025-03-13 11:12:03,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:12:03,448 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:03
2025-03-13 11:12:03,448 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 11:12:03,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.15it/s] 25%|██▌       | 5/20 [00:00<00:00, 22.70it/s] 45%|████▌     | 9/20 [00:00<00:00, 28.26it/s] 65%|██████▌   | 13/20 [00:00<00:00, 32.34it/s] 85%|████████▌ | 17/20 [00:00<00:00, 34.83it/s]100%|██████████| 20/20 [00:05<00:00,  3.66it/s]
2025-03-13 11:12:08,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:08
2025-03-13 11:12:56,628 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7052 secs
2025-03-13 11:12:56,628 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 11:12:56,628 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 11:13:09,757 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1288 secs
2025-03-13 11:13:09,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3126 secs
2025-03-13 11:13:09,761 [INFO]: {
2025-03-13 11:13:09,761 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:09,761 [INFO]: 	index_param: efSearch=139
2025-03-13 11:13:09,761 [INFO]: 	index_path: knn.index
2025-03-13 11:13:09,761 [INFO]: 	size in bytes: 954405250
2025-03-13 11:13:09,761 [INFO]: 	avg_search_speed_ms: 10.089570098751855
2025-03-13 11:13:09,761 [INFO]: 	99p_search_speed_ms: 16.722792449872948
2025-03-13 11:13:09,761 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:09,761 [INFO]: 	nb vectors: 4851
2025-03-13 11:13:09,761 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:09,761 [INFO]: 	compression ratio: 0.9993086354040907
2025-03-13 11:13:09,761 [INFO]: }
2025-03-13 11:13:09,761 [INFO]: 	>>> Finished "Creating the index" in 66.3141 secs
2025-03-13 11:13:09,761 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3405 secs
2025-03-13 11:13:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 90611 [episode count 19/20]
2025-03-13 11:13:12: [retrieval_preprocessing] finished for 2495127464_move_left [chosen_id count 0/260]
2025-03-13 11:13:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2495127464_move_right [chosen_id count 1/260]
2025-03-13 11:13:13: [retrieval_preprocessing] we have num_total=6125 embedding_dim=49152
[retrieval_preprocessing] for episode 59426 [episode count 0/20], we have num_retrieval=np.int64(5598) num_query=np.int64(527)
2025-03-13 11:13:14,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:15,319 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:15
2025-03-13 11:13:15,320 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1701.54it/s]
2025-03-13 11:13:15,343 [INFO]: There are 5598 embeddings of dim 49152
2025-03-13 11:13:15,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 11:13:15,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:15,343 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 11:13:15,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:15,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:15,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,344 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:15,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:13:15,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:15
2025-03-13 11:13:15,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:15,344 [INFO]: 	Creating the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:15
2025-03-13 11:13:15,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:13:15,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:15
2025-03-13 11:13:15,345 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:13:15,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.14it/s] 25%|██▌       | 6/24 [00:00<00:00, 27.72it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.89it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.05it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.36it/s]100%|██████████| 24/24 [00:07<00:00,  2.31it/s]100%|██████████| 24/24 [00:07<00:00,  3.38it/s]
2025-03-13 11:13:22,456 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:22
2025-03-13 11:14:13,817 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.3604 secs
2025-03-13 11:14:13,817 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 11:14:13,817 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.73it/s]
2025-03-13 11:14:28,714 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8968 secs
2025-03-13 11:14:28,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3700 secs
2025-03-13 11:14:28,715 [INFO]: {
2025-03-13 11:14:28,715 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:28,715 [INFO]: 	index_param: efSearch=127
2025-03-13 11:14:28,715 [INFO]: 	index_path: knn.index
2025-03-13 11:14:28,715 [INFO]: 	size in bytes: 1101373750
2025-03-13 11:14:28,715 [INFO]: 	avg_search_speed_ms: 7.973373122290489
2025-03-13 11:14:28,715 [INFO]: 	99p_search_speed_ms: 12.249799396377059
2025-03-13 11:14:28,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:28,715 [INFO]: 	nb vectors: 5598
2025-03-13 11:14:28,715 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:28,715 [INFO]: 	compression ratio: 0.9993079860492408
2025-03-13 11:14:28,715 [INFO]: }
2025-03-13 11:14:28,715 [INFO]: 	>>> Finished "Creating the index" in 73.3714 secs
2025-03-13 11:14:28,715 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3958 secs
2025-03-13 11:14:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 59426 [episode count 0/20]
[retrieval_preprocessing] for episode 49202 [episode count 1/20], we have num_retrieval=np.int64(5914) num_query=np.int64(211)
2025-03-13 11:14:32,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:33,180 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:33
2025-03-13 11:14:33,180 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1471.17it/s]
2025-03-13 11:14:33,205 [INFO]: There are 5914 embeddings of dim 49152
2025-03-13 11:14:33,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 11:14:33,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:33
2025-03-13 11:14:33,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:33,206 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:14:33,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:33,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:33,206 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:33
2025-03-13 11:14:33,206 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:33,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:14:33,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:33
2025-03-13 11:14:33,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:33,206 [INFO]: 	Creating the index 03/13/2025, 11:14:33
2025-03-13 11:14:33,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:33
2025-03-13 11:14:33,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:14:33,208 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:33
2025-03-13 11:14:33,208 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:14:33,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.74it/s] 24%|██▍       | 6/25 [00:00<00:00, 27.07it/s] 44%|████▍     | 11/25 [00:00<00:00, 35.44it/s] 64%|██████▍   | 16/25 [00:00<00:00, 39.07it/s] 84%|████████▍ | 21/25 [00:05<00:01,  2.47it/s]100%|██████████| 25/25 [00:07<00:00,  2.30it/s]100%|██████████| 25/25 [00:07<00:00,  3.33it/s]
2025-03-13 11:14:40,729 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:40
2025-03-13 11:15:31,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4380 secs
2025-03-13 11:15:31,168 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 11:15:31,168 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-13 11:15:45,125 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9565 secs
2025-03-13 11:15:45,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9181 secs
2025-03-13 11:15:45,126 [INFO]: {
2025-03-13 11:15:45,126 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:45,126 [INFO]: 	index_param: efSearch=103
2025-03-13 11:15:45,126 [INFO]: 	index_path: knn.index
2025-03-13 11:15:45,126 [INFO]: 	size in bytes: 1163544730
2025-03-13 11:15:45,126 [INFO]: 	avg_search_speed_ms: 6.115719490892479
2025-03-13 11:15:45,126 [INFO]: 	99p_search_speed_ms: 9.647850575856868
2025-03-13 11:15:45,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:45,126 [INFO]: 	nb vectors: 5914
2025-03-13 11:15:45,126 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:45,126 [INFO]: 	compression ratio: 0.999308133173359
2025-03-13 11:15:45,126 [INFO]: }
2025-03-13 11:15:45,126 [INFO]: 	>>> Finished "Creating the index" in 71.9197 secs
2025-03-13 11:15:45,126 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9458 secs
2025-03-13 11:15:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 49202 [episode count 1/20]
[retrieval_preprocessing] for episode 42039 [episode count 2/20], we have num_retrieval=np.int64(5788) num_query=np.int64(337)
2025-03-13 11:15:47,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:48,094 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:48
2025-03-13 11:15:48,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.58it/s]
2025-03-13 11:15:48,127 [INFO]: There are 5788 embeddings of dim 49152
2025-03-13 11:15:48,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 11:15:48,127 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:48,128 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:15:48,128 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:48,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:15:48,128 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,128 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:48,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:15:48,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:48
2025-03-13 11:15:48,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:48,129 [INFO]: 	Creating the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,129 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:48
2025-03-13 11:15:48,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:15:48,132 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,132 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:15:48,133 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.18it/s] 29%|██▉       | 7/24 [00:00<00:00, 33.93it/s] 50%|█████     | 12/24 [00:00<00:00, 40.27it/s] 71%|███████   | 17/24 [00:00<00:00, 43.36it/s] 92%|█████████▏| 22/24 [00:05<00:00,  2.52it/s]100%|██████████| 24/24 [00:06<00:00,  3.46it/s]
2025-03-13 11:15:55,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:55
2025-03-13 11:16:47,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1992 secs
2025-03-13 11:16:47,275 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 11:16:47,275 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 11:17:03,896 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6210 secs
2025-03-13 11:17:03,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.7650 secs
2025-03-13 11:17:03,897 [INFO]: {
2025-03-13 11:17:03,898 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:03,898 [INFO]: 	index_param: efSearch=103
2025-03-13 11:17:03,898 [INFO]: 	index_path: knn.index
2025-03-13 11:17:03,898 [INFO]: 	size in bytes: 1138754890
2025-03-13 11:17:03,898 [INFO]: 	avg_search_speed_ms: 7.183911505485778
2025-03-13 11:17:03,898 [INFO]: 	99p_search_speed_ms: 13.807231297250821
2025-03-13 11:17:03,898 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:03,898 [INFO]: 	nb vectors: 5788
2025-03-13 11:17:03,898 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:03,898 [INFO]: 	compression ratio: 0.9993082040683926
2025-03-13 11:17:03,898 [INFO]: }
2025-03-13 11:17:03,898 [INFO]: 	>>> Finished "Creating the index" in 75.7687 secs
2025-03-13 11:17:03,898 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8037 secs
2025-03-13 11:17:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 42039 [episode count 2/20]
[retrieval_preprocessing] for episode 77900 [episode count 3/20], we have num_retrieval=np.int64(5474) num_query=np.int64(651)
2025-03-13 11:17:06,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:07,133 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:07
2025-03-13 11:17:07,133 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.09it/s]
2025-03-13 11:17:07,159 [INFO]: There are 5474 embeddings of dim 49152
2025-03-13 11:17:07,159 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:17:07,159 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:07
2025-03-13 11:17:07,159 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:07,159 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 11:17:07,159 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:07,159 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:07,159 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:07
2025-03-13 11:17:07,159 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:07,159 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:17:07,159 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:07
2025-03-13 11:17:07,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:07,159 [INFO]: 	Creating the index 03/13/2025, 11:17:07
2025-03-13 11:17:07,159 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:07
2025-03-13 11:17:07,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:17:07,161 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:07
2025-03-13 11:17:07,161 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:17:07,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.29it/s] 30%|███       | 7/23 [00:00<00:00, 36.69it/s] 57%|█████▋    | 13/23 [00:00<00:00, 45.93it/s] 83%|████████▎ | 19/23 [00:00<00:00, 49.89it/s]100%|██████████| 23/23 [00:05<00:00,  4.10it/s]
2025-03-13 11:17:12,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:12
2025-03-13 11:18:01,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8212 secs
2025-03-13 11:18:01,592 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 11:18:01,592 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 11:18:15,384 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7917 secs
2025-03-13 11:18:15,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2242 secs
2025-03-13 11:18:15,385 [INFO]: {
2025-03-13 11:18:15,385 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:15,385 [INFO]: 	index_param: efSearch=111
2025-03-13 11:18:15,385 [INFO]: 	index_path: knn.index
2025-03-13 11:18:15,385 [INFO]: 	size in bytes: 1076977450
2025-03-13 11:18:15,385 [INFO]: 	avg_search_speed_ms: 6.916871043675699
2025-03-13 11:18:15,385 [INFO]: 	99p_search_speed_ms: 12.515013129450377
2025-03-13 11:18:15,385 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:15,385 [INFO]: 	nb vectors: 5474
2025-03-13 11:18:15,385 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:15,385 [INFO]: 	compression ratio: 0.9993080096523841
2025-03-13 11:18:15,385 [INFO]: }
2025-03-13 11:18:15,385 [INFO]: 	>>> Finished "Creating the index" in 68.2257 secs
2025-03-13 11:18:15,385 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2524 secs
2025-03-13 11:18:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 77900 [episode count 3/20]
[retrieval_preprocessing] for episode 46714 [episode count 4/20], we have num_retrieval=np.int64(5932) num_query=np.int64(193)
2025-03-13 11:18:19,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:20,504 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:20
2025-03-13 11:18:20,504 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.09it/s]
2025-03-13 11:18:20,534 [INFO]: There are 5932 embeddings of dim 49152
2025-03-13 11:18:20,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 11:18:20,536 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:20
2025-03-13 11:18:20,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:20,536 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:18:20,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:20,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:18:20,537 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:20
2025-03-13 11:18:20,537 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:20,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:18:20,537 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:20
2025-03-13 11:18:20,537 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:20,537 [INFO]: 	Creating the index 03/13/2025, 11:18:20
2025-03-13 11:18:20,538 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:20
2025-03-13 11:18:20,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:18:20,541 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:20
2025-03-13 11:18:20,541 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:18:20,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.97it/s] 24%|██▍       | 6/25 [00:00<00:00, 27.34it/s] 44%|████▍     | 11/25 [00:00<00:00, 33.51it/s] 64%|██████▍   | 16/25 [00:00<00:00, 36.51it/s] 84%|████████▍ | 21/25 [00:04<00:01,  2.76it/s]100%|██████████| 25/25 [00:06<00:00,  2.62it/s]100%|██████████| 25/25 [00:06<00:00,  3.76it/s]
2025-03-13 11:18:27,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:27
2025-03-13 11:19:18,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1683 secs
2025-03-13 11:19:18,358 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 11:19:18,358 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.00it/s]
2025-03-13 11:19:34,652 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2931 secs
2025-03-13 11:19:34,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1116 secs
2025-03-13 11:19:34,653 [INFO]: {
2025-03-13 11:19:34,653 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:34,653 [INFO]: 	index_param: efSearch=140
2025-03-13 11:19:34,653 [INFO]: 	index_path: knn.index
2025-03-13 11:19:34,653 [INFO]: 	size in bytes: 1167086170
2025-03-13 11:19:34,653 [INFO]: 	avg_search_speed_ms: 7.944108667725001
2025-03-13 11:19:34,653 [INFO]: 	99p_search_speed_ms: 15.009522540494808
2025-03-13 11:19:34,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:34,653 [INFO]: 	nb vectors: 5932
2025-03-13 11:19:34,653 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:34,653 [INFO]: 	compression ratio: 0.9993080939344864
2025-03-13 11:19:34,653 [INFO]: }
2025-03-13 11:19:34,653 [INFO]: 	>>> Finished "Creating the index" in 74.1156 secs
2025-03-13 11:19:34,653 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1488 secs
2025-03-13 11:19:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 46714 [episode count 4/20]
[retrieval_preprocessing] for episode 60035 [episode count 5/20], we have num_retrieval=np.int64(5839) num_query=np.int64(286)
2025-03-13 11:19:36,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:37,622 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:37
2025-03-13 11:19:37,623 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2258.65it/s]
2025-03-13 11:19:37,648 [INFO]: There are 5839 embeddings of dim 49152
2025-03-13 11:19:37,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:19:37,648 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:37
2025-03-13 11:19:37,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:37,649 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:19:37,649 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:37,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:19:37,649 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:37
2025-03-13 11:19:37,649 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:37,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:19:37,650 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:37
2025-03-13 11:19:37,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:37,650 [INFO]: 	Creating the index 03/13/2025, 11:19:37
2025-03-13 11:19:37,650 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:37
2025-03-13 11:19:37,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:19:37,653 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:37
2025-03-13 11:19:37,653 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:19:37,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.63it/s] 29%|██▉       | 7/24 [00:00<00:00, 35.50it/s] 54%|█████▍    | 13/24 [00:00<00:00, 43.14it/s] 79%|███████▉  | 19/24 [00:00<00:00, 46.61it/s]100%|██████████| 24/24 [00:05<00:00,  2.52it/s]100%|██████████| 24/24 [00:05<00:00,  4.05it/s]
2025-03-13 11:19:43,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:43
2025-03-13 11:20:35,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9888 secs
2025-03-13 11:20:35,575 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 11:20:35,575 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-13 11:20:48,845 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2703 secs
2025-03-13 11:20:48,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1927 secs
2025-03-13 11:20:48,846 [INFO]: {
2025-03-13 11:20:48,846 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:48,846 [INFO]: 	index_param: efSearch=123
2025-03-13 11:20:48,846 [INFO]: 	index_path: knn.index
2025-03-13 11:20:48,846 [INFO]: 	size in bytes: 1148788810
2025-03-13 11:20:48,846 [INFO]: 	avg_search_speed_ms: 7.558902815154677
2025-03-13 11:20:48,846 [INFO]: 	99p_search_speed_ms: 12.217096015810966
2025-03-13 11:20:48,846 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:48,846 [INFO]: 	nb vectors: 5839
2025-03-13 11:20:48,846 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:48,846 [INFO]: 	compression ratio: 0.9993082296823557
2025-03-13 11:20:48,846 [INFO]: }
2025-03-13 11:20:48,846 [INFO]: 	>>> Finished "Creating the index" in 71.1965 secs
2025-03-13 11:20:48,846 [INFO]: >>> Finished "Launching the whole pipeline" in 71.2238 secs
2025-03-13 11:20:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 60035 [episode count 5/20]
[retrieval_preprocessing] for episode 9894 [episode count 6/20], we have num_retrieval=np.int64(5886) num_query=np.int64(239)
2025-03-13 11:20:51,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:51,849 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:51
2025-03-13 11:20:51,849 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.22it/s]
2025-03-13 11:20:51,874 [INFO]: There are 5886 embeddings of dim 49152
2025-03-13 11:20:51,875 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:20:51,875 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:51
2025-03-13 11:20:51,875 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:51,875 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:20:51,875 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:51,875 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:20:51,875 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:51
2025-03-13 11:20:51,875 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:51,875 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:20:51,875 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:51
2025-03-13 11:20:51,875 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:51,875 [INFO]: 	Creating the index 03/13/2025, 11:20:51
2025-03-13 11:20:51,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:51
2025-03-13 11:20:51,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:20:51,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:51
2025-03-13 11:20:51,876 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:20:51,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.47it/s] 24%|██▍       | 6/25 [00:00<00:00, 28.91it/s] 44%|████▍     | 11/25 [00:00<00:00, 37.57it/s] 64%|██████▍   | 16/25 [00:00<00:00, 41.85it/s] 84%|████████▍ | 21/25 [00:04<00:01,  2.90it/s]100%|██████████| 25/25 [00:06<00:00,  2.79it/s]100%|██████████| 25/25 [00:06<00:00,  4.00it/s]
2025-03-13 11:20:58,139 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:58
2025-03-13 11:21:49,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6999 secs
2025-03-13 11:21:49,839 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 11:21:49,839 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 11:22:05,135 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2953 secs
2025-03-13 11:22:05,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2591 secs
2025-03-13 11:22:05,136 [INFO]: {
2025-03-13 11:22:05,136 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:05,136 [INFO]: 	index_param: efSearch=131
2025-03-13 11:22:05,136 [INFO]: 	index_path: knn.index
2025-03-13 11:22:05,136 [INFO]: 	size in bytes: 1158035710
2025-03-13 11:22:05,136 [INFO]: 	avg_search_speed_ms: 7.717284885950869
2025-03-13 11:22:05,136 [INFO]: 	99p_search_speed_ms: 12.982888950500636
2025-03-13 11:22:05,136 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:05,136 [INFO]: 	nb vectors: 5886
2025-03-13 11:22:05,136 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:05,136 [INFO]: 	compression ratio: 0.9993082924878025
2025-03-13 11:22:05,136 [INFO]: }
2025-03-13 11:22:05,136 [INFO]: 	>>> Finished "Creating the index" in 73.2605 secs
2025-03-13 11:22:05,136 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2872 secs
2025-03-13 11:22:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 9894 [episode count 6/20]
[retrieval_preprocessing] for episode 82087 [episode count 7/20], we have num_retrieval=np.int64(5207) num_query=np.int64(918)
2025-03-13 11:22:07,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:07,957 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:07
2025-03-13 11:22:07,957 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.18it/s]
2025-03-13 11:22:07,983 [INFO]: There are 5207 embeddings of dim 49152
2025-03-13 11:22:07,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 11:22:07,984 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:07
2025-03-13 11:22:07,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:07,984 [INFO]: 		-> Add: 2.9 seconds
2025-03-13 11:22:07,985 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:07,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:22:07,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:07
2025-03-13 11:22:07,985 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:07,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:22:07,985 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:07
2025-03-13 11:22:07,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:07,986 [INFO]: 	Creating the index 03/13/2025, 11:22:07
2025-03-13 11:22:07,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:07
2025-03-13 11:22:07,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:22:07,989 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:07
2025-03-13 11:22:07,989 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 11:22:07,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 18.15it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.46it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.49it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.71it/s]100%|██████████| 22/22 [00:05<00:00,  2.63it/s]100%|██████████| 22/22 [00:05<00:00,  4.20it/s]
2025-03-13 11:22:13,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:13
2025-03-13 11:22:59,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6332 secs
2025-03-13 11:22:59,872 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 11:22:59,872 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 11:23:16,426 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5543 secs
2025-03-13 11:23:16,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4375 secs
2025-03-13 11:23:16,427 [INFO]: {
2025-03-13 11:23:16,427 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:16,427 [INFO]: 	index_param: efSearch=140
2025-03-13 11:23:16,427 [INFO]: 	index_path: knn.index
2025-03-13 11:23:16,427 [INFO]: 	size in bytes: 1024446430
2025-03-13 11:23:16,427 [INFO]: 	avg_search_speed_ms: 9.210771510144268
2025-03-13 11:23:16,427 [INFO]: 	99p_search_speed_ms: 18.17287218291313
2025-03-13 11:23:16,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:16,427 [INFO]: 	nb vectors: 5207
2025-03-13 11:23:16,427 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:16,427 [INFO]: 	compression ratio: 0.9993083347462102
2025-03-13 11:23:16,427 [INFO]: }
2025-03-13 11:23:16,427 [INFO]: 	>>> Finished "Creating the index" in 68.4414 secs
2025-03-13 11:23:16,427 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4703 secs
2025-03-13 11:23:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 82087 [episode count 7/20]
[retrieval_preprocessing] for episode 685 [episode count 8/20], we have num_retrieval=np.int64(5937) num_query=np.int64(188)
2025-03-13 11:23:23,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:24,080 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:24
2025-03-13 11:23:24,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.68it/s]
2025-03-13 11:23:24,111 [INFO]: There are 5937 embeddings of dim 49152
2025-03-13 11:23:24,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 11:23:24,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:24,113 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:23:24,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:24,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:23:24,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,113 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:24,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:23:24,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:24
2025-03-13 11:23:24,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:24,114 [INFO]: 	Creating the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:24
2025-03-13 11:23:24,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:23:24,118 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:24
2025-03-13 11:23:24,118 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:23:24,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  9.69it/s] 24%|██▍       | 6/25 [00:00<00:00, 29.39it/s] 44%|████▍     | 11/25 [00:00<00:00, 35.18it/s] 64%|██████▍   | 16/25 [00:00<00:00, 38.99it/s] 84%|████████▍ | 21/25 [00:05<00:01,  2.70it/s]100%|██████████| 25/25 [00:06<00:00,  2.69it/s]100%|██████████| 25/25 [00:06<00:00,  3.83it/s]
2025-03-13 11:23:30,652 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:30
2025-03-13 11:24:20,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8449 secs
2025-03-13 11:24:20,498 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 11:24:20,498 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.04it/s]
2025-03-13 11:24:36,200 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7026 secs
2025-03-13 11:24:36,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0838 secs
2025-03-13 11:24:36,202 [INFO]: {
2025-03-13 11:24:36,202 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:36,202 [INFO]: 	index_param: efSearch=101
2025-03-13 11:24:36,202 [INFO]: 	index_path: knn.index
2025-03-13 11:24:36,202 [INFO]: 	size in bytes: 1168069870
2025-03-13 11:24:36,202 [INFO]: 	avg_search_speed_ms: 6.355323066953877
2025-03-13 11:24:36,202 [INFO]: 	99p_search_speed_ms: 10.844758409075439
2025-03-13 11:24:36,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:36,202 [INFO]: 	nb vectors: 5937
2025-03-13 11:24:36,202 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:36,202 [INFO]: 	compression ratio: 0.999308111594386
2025-03-13 11:24:36,202 [INFO]: }
2025-03-13 11:24:36,202 [INFO]: 	>>> Finished "Creating the index" in 72.0876 secs
2025-03-13 11:24:36,202 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1214 secs
2025-03-13 11:24:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 685 [episode count 8/20]
[retrieval_preprocessing] for episode 74931 [episode count 9/20], we have num_retrieval=np.int64(5927) num_query=np.int64(198)
2025-03-13 11:24:37,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:38,881 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:38
2025-03-13 11:24:38,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 966.21it/s]
2025-03-13 11:24:38,909 [INFO]: There are 5927 embeddings of dim 49152
2025-03-13 11:24:38,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:24:38,910 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:38
2025-03-13 11:24:38,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:38,910 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:24:38,910 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:38,910 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:24:38,910 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:38
2025-03-13 11:24:38,910 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:38,910 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:24:38,910 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:38
2025-03-13 11:24:38,910 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:38,910 [INFO]: 	Creating the index 03/13/2025, 11:24:38
2025-03-13 11:24:38,910 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:38
2025-03-13 11:24:38,911 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:24:38,911 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:38
2025-03-13 11:24:38,911 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:24:38,911 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.05it/s] 20%|██        | 5/25 [00:00<00:00, 23.55it/s] 40%|████      | 10/25 [00:00<00:00, 31.39it/s] 60%|██████    | 15/25 [00:00<00:00, 34.90it/s] 76%|███████▌  | 19/25 [00:00<00:00, 36.42it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.41it/s]100%|██████████| 25/25 [00:07<00:00,  3.52it/s]
2025-03-13 11:24:46,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:46
2025-03-13 11:25:37,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4253 secs
2025-03-13 11:25:37,438 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 11:25:37,438 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 11:25:51,236 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7982 secs
2025-03-13 11:25:51,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3255 secs
2025-03-13 11:25:51,237 [INFO]: {
2025-03-13 11:25:51,237 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:51,237 [INFO]: 	index_param: efSearch=121
2025-03-13 11:25:51,237 [INFO]: 	index_path: knn.index
2025-03-13 11:25:51,237 [INFO]: 	size in bytes: 1166102410
2025-03-13 11:25:51,237 [INFO]: 	avg_search_speed_ms: 6.962155775052903
2025-03-13 11:25:51,237 [INFO]: 	99p_search_speed_ms: 11.259127687662843
2025-03-13 11:25:51,237 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:51,237 [INFO]: 	nb vectors: 5927
2025-03-13 11:25:51,237 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:51,237 [INFO]: 	compression ratio: 0.9993081276626468
2025-03-13 11:25:51,237 [INFO]: }
2025-03-13 11:25:51,237 [INFO]: 	>>> Finished "Creating the index" in 72.3271 secs
2025-03-13 11:25:51,237 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3558 secs
2025-03-13 11:25:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 74931 [episode count 9/20]
[retrieval_preprocessing] for episode 22329 [episode count 10/20], we have num_retrieval=np.int64(5988) num_query=np.int64(137)
2025-03-13 11:25:53,152 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:54,136 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:54
2025-03-13 11:25:54,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.78it/s]
2025-03-13 11:25:54,161 [INFO]: There are 5988 embeddings of dim 49152
2025-03-13 11:25:54,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:25:54,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,161 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:54,161 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:25:54,161 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:54,161 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:25:54,161 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,161 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:54,161 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:25:54,161 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:54
2025-03-13 11:25:54,161 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:54,161 [INFO]: 	Creating the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,161 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:54
2025-03-13 11:25:54,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:25:54,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:54
2025-03-13 11:25:54,163 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:25:54,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.48it/s] 28%|██▊       | 7/25 [00:00<00:00, 34.48it/s] 52%|█████▏    | 13/25 [00:00<00:00, 43.46it/s] 76%|███████▌  | 19/25 [00:00<00:00, 47.86it/s] 96%|█████████▌| 24/25 [00:04<00:00,  3.11it/s]100%|██████████| 25/25 [00:06<00:00,  3.78it/s]
2025-03-13 11:26:00,776 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:00
2025-03-13 11:26:52,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7703 secs
2025-03-13 11:26:52,547 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 11:26:52,547 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-13 11:27:06,397 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8505 secs
2025-03-13 11:27:06,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2362 secs
2025-03-13 11:27:06,399 [INFO]: {
2025-03-13 11:27:06,399 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:06,399 [INFO]: 	index_param: efSearch=126
2025-03-13 11:27:06,399 [INFO]: 	index_path: knn.index
2025-03-13 11:27:06,399 [INFO]: 	size in bytes: 1178103610
2025-03-13 11:27:06,399 [INFO]: 	avg_search_speed_ms: 7.318393878521476
2025-03-13 11:27:06,399 [INFO]: 	99p_search_speed_ms: 14.28652905160561
2025-03-13 11:27:06,399 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:06,399 [INFO]: 	nb vectors: 5988
2025-03-13 11:27:06,399 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:06,399 [INFO]: 	compression ratio: 0.9993082900408055
2025-03-13 11:27:06,399 [INFO]: }
2025-03-13 11:27:06,399 [INFO]: 	>>> Finished "Creating the index" in 72.2377 secs
2025-03-13 11:27:06,399 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2631 secs
2025-03-13 11:27:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 22329 [episode count 10/20]
[retrieval_preprocessing] for episode 10451 [episode count 11/20], we have num_retrieval=np.int64(5840) num_query=np.int64(285)
2025-03-13 11:27:07,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:08,758 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:08
2025-03-13 11:27:08,758 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.00it/s]
2025-03-13 11:27:08,784 [INFO]: There are 5840 embeddings of dim 49152
2025-03-13 11:27:08,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:27:08,784 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:08,784 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:27:08,784 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:08,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:08,784 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,785 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:08,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:08,785 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:08
2025-03-13 11:27:08,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:08,785 [INFO]: 	Creating the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,785 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:08
2025-03-13 11:27:08,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:27:08,786 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,786 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:27:08,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.63it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.51it/s] 50%|█████     | 12/24 [00:00<00:00, 39.26it/s] 75%|███████▌  | 18/24 [00:00<00:00, 43.78it/s] 96%|█████████▌| 23/24 [00:04<00:00,  3.14it/s]100%|██████████| 24/24 [00:06<00:00,  3.89it/s]
2025-03-13 11:27:14,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:14
2025-03-13 11:28:06,772 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8160 secs
2025-03-13 11:28:06,773 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 11:28:06,773 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-13 11:28:27,574 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8008 secs
2025-03-13 11:28:27,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7892 secs
2025-03-13 11:28:27,575 [INFO]: {
2025-03-13 11:28:27,575 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:27,575 [INFO]: 	index_param: efSearch=120
2025-03-13 11:28:27,575 [INFO]: 	index_path: knn.index
2025-03-13 11:28:27,575 [INFO]: 	size in bytes: 1148985550
2025-03-13 11:28:27,575 [INFO]: 	avg_search_speed_ms: 7.001092992833859
2025-03-13 11:28:27,575 [INFO]: 	99p_search_speed_ms: 11.668346503283828
2025-03-13 11:28:27,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:27,575 [INFO]: 	nb vectors: 5840
2025-03-13 11:28:27,575 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:27,575 [INFO]: 	compression ratio: 0.9993082332497567
2025-03-13 11:28:27,575 [INFO]: }
2025-03-13 11:28:27,575 [INFO]: 	>>> Finished "Creating the index" in 78.7905 secs
2025-03-13 11:28:27,575 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8177 secs
2025-03-13 11:28:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 10451 [episode count 11/20]
[retrieval_preprocessing] for episode 9456 [episode count 12/20], we have num_retrieval=np.int64(5917) num_query=np.int64(208)
2025-03-13 11:28:30,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:31,174 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:31
2025-03-13 11:28:31,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1676.38it/s]
2025-03-13 11:28:31,205 [INFO]: There are 5917 embeddings of dim 49152
2025-03-13 11:28:31,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 11:28:31,206 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:31
2025-03-13 11:28:31,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:31,206 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:28:31,206 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:31,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:28:31,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:31
2025-03-13 11:28:31,207 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:31,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:28:31,208 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:31
2025-03-13 11:28:31,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:31,208 [INFO]: 	Creating the index 03/13/2025, 11:28:31
2025-03-13 11:28:31,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:31
2025-03-13 11:28:31,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:28:31,211 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:31
2025-03-13 11:28:31,211 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:28:31,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 17.78it/s] 28%|██▊       | 7/25 [00:00<00:00, 35.07it/s] 48%|████▊     | 12/25 [00:00<00:00, 40.87it/s] 68%|██████▊   | 17/25 [00:00<00:00, 43.72it/s] 88%|████████▊ | 22/25 [00:04<00:01,  3.00it/s]100%|██████████| 25/25 [00:06<00:00,  2.59it/s]100%|██████████| 25/25 [00:06<00:00,  3.99it/s]
2025-03-13 11:28:37,485 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:37
2025-03-13 11:29:27,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6133 secs
2025-03-13 11:29:27,099 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 11:29:27,099 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.49it/s]
2025-03-13 11:29:43,309 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2099 secs
2025-03-13 11:29:43,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0986 secs
2025-03-13 11:29:43,310 [INFO]: {
2025-03-13 11:29:43,310 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:43,310 [INFO]: 	index_param: efSearch=105
2025-03-13 11:29:43,310 [INFO]: 	index_path: knn.index
2025-03-13 11:29:43,310 [INFO]: 	size in bytes: 1164135010
2025-03-13 11:29:43,310 [INFO]: 	avg_search_speed_ms: 6.058289323945268
2025-03-13 11:29:43,310 [INFO]: 	99p_search_speed_ms: 10.271038045175374
2025-03-13 11:29:43,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:43,310 [INFO]: 	nb vectors: 5917
2025-03-13 11:29:43,310 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:43,310 [INFO]: 	compression ratio: 0.9993080922804649
2025-03-13 11:29:43,310 [INFO]: }
2025-03-13 11:29:43,310 [INFO]: 	>>> Finished "Creating the index" in 72.1020 secs
2025-03-13 11:29:43,310 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1365 secs
2025-03-13 11:29:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 9456 [episode count 12/20]
[retrieval_preprocessing] for episode 36087 [episode count 13/20], we have num_retrieval=np.int64(5968) num_query=np.int64(157)
2025-03-13 11:29:45,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:46,243 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:46
2025-03-13 11:29:46,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2240.55it/s]
2025-03-13 11:29:46,267 [INFO]: There are 5968 embeddings of dim 49152
2025-03-13 11:29:46,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 11:29:46,267 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:46
2025-03-13 11:29:46,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:46,268 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:29:46,268 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:46,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:29:46,268 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:46
2025-03-13 11:29:46,268 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:46,268 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:29:46,268 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:46
2025-03-13 11:29:46,268 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:46,268 [INFO]: 	Creating the index 03/13/2025, 11:29:46
2025-03-13 11:29:46,268 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:46
2025-03-13 11:29:46,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:29:46,269 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:46
2025-03-13 11:29:46,269 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:29:46,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.74it/s] 24%|██▍       | 6/25 [00:00<00:00, 26.37it/s] 44%|████▍     | 11/25 [00:00<00:00, 33.56it/s] 64%|██████▍   | 16/25 [00:00<00:00, 36.95it/s] 84%|████████▍ | 21/25 [00:04<00:01,  2.99it/s]100%|██████████| 25/25 [00:06<00:00,  2.80it/s]100%|██████████| 25/25 [00:06<00:00,  4.01it/s]
2025-03-13 11:29:52,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:52
2025-03-13 11:30:43,769 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2638 secs
2025-03-13 11:30:43,770 [INFO]: The best hyperparameters are: efSearch=131
2025-03-13 11:30:43,770 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.56it/s]
2025-03-13 11:30:57,414 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6437 secs
2025-03-13 11:30:57,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1457 secs
2025-03-13 11:30:57,415 [INFO]: {
2025-03-13 11:30:57,415 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:57,415 [INFO]: 	index_param: efSearch=131
2025-03-13 11:30:57,415 [INFO]: 	index_path: knn.index
2025-03-13 11:30:57,415 [INFO]: 	size in bytes: 1174168810
2025-03-13 11:30:57,415 [INFO]: 	avg_search_speed_ms: 7.76631269305337
2025-03-13 11:30:57,415 [INFO]: 	99p_search_speed_ms: 13.38773966534063
2025-03-13 11:30:57,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:57,415 [INFO]: 	nb vectors: 5968
2025-03-13 11:30:57,415 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:57,415 [INFO]: 	compression ratio: 0.9993082204253066
2025-03-13 11:30:57,415 [INFO]: }
2025-03-13 11:30:57,415 [INFO]: 	>>> Finished "Creating the index" in 71.1471 secs
2025-03-13 11:30:57,415 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1725 secs
2025-03-13 11:30:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 36087 [episode count 13/20]
[retrieval_preprocessing] for episode 17743 [episode count 14/20], we have num_retrieval=np.int64(5934) num_query=np.int64(191)
2025-03-13 11:30:59,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:59,761 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:59
2025-03-13 11:30:59,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.34it/s]
2025-03-13 11:30:59,790 [INFO]: There are 5934 embeddings of dim 49152
2025-03-13 11:30:59,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:30:59,791 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:59
2025-03-13 11:30:59,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:59,791 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:30:59,791 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:59,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:30:59,792 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:59
2025-03-13 11:30:59,792 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:59,792 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:30:59,792 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:59
2025-03-13 11:30:59,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:59,793 [INFO]: 	Creating the index 03/13/2025, 11:30:59
2025-03-13 11:30:59,793 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:59
2025-03-13 11:30:59,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:30:59,796 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:59
2025-03-13 11:30:59,797 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:30:59,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 19.14it/s] 32%|███▏      | 8/25 [00:00<00:00, 38.91it/s] 56%|█████▌    | 14/25 [00:00<00:00, 44.80it/s] 80%|████████  | 20/25 [00:00<00:00, 47.44it/s]100%|██████████| 25/25 [00:06<00:00,  2.45it/s]100%|██████████| 25/25 [00:06<00:00,  4.00it/s]
2025-03-13 11:31:06,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:06
2025-03-13 11:31:55,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.2706 secs
2025-03-13 11:31:55,325 [INFO]: The best hyperparameters are: efSearch=108
2025-03-13 11:31:55,325 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 11:32:09,547 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2220 secs
2025-03-13 11:32:09,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7518 secs
2025-03-13 11:32:09,548 [INFO]: {
2025-03-13 11:32:09,548 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:09,548 [INFO]: 	index_param: efSearch=108
2025-03-13 11:32:09,548 [INFO]: 	index_path: knn.index
2025-03-13 11:32:09,548 [INFO]: 	size in bytes: 1167479650
2025-03-13 11:32:09,548 [INFO]: 	avg_search_speed_ms: 7.27209746837616
2025-03-13 11:32:09,548 [INFO]: 	99p_search_speed_ms: 13.529373463243246
2025-03-13 11:32:09,548 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:09,548 [INFO]: 	nb vectors: 5934
2025-03-13 11:32:09,548 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:09,548 [INFO]: 	compression ratio: 0.9993081010020175
2025-03-13 11:32:09,549 [INFO]: }
2025-03-13 11:32:09,549 [INFO]: 	>>> Finished "Creating the index" in 69.7559 secs
2025-03-13 11:32:09,549 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7872 secs
2025-03-13 11:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 17743 [episode count 14/20]
[retrieval_preprocessing] for episode 20923 [episode count 15/20], we have num_retrieval=np.int64(5926) num_query=np.int64(199)
2025-03-13 11:32:11,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:11,870 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:11
2025-03-13 11:32:11,870 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1247.19it/s]
2025-03-13 11:32:11,896 [INFO]: There are 5926 embeddings of dim 49152
2025-03-13 11:32:11,896 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:32:11,896 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:11
2025-03-13 11:32:11,896 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:11,896 [INFO]: 		-> Add: 3.3 seconds
2025-03-13 11:32:11,896 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:11,896 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:11,896 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:11
2025-03-13 11:32:11,896 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:11,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:11,896 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:11
2025-03-13 11:32:11,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:11,896 [INFO]: 	Creating the index 03/13/2025, 11:32:11
2025-03-13 11:32:11,897 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:11
2025-03-13 11:32:11,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:32:11,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:11
2025-03-13 11:32:11,898 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:32:11,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.28it/s] 28%|██▊       | 7/25 [00:00<00:00, 35.70it/s] 56%|█████▌    | 14/25 [00:00<00:00, 47.28it/s] 84%|████████▍ | 21/25 [00:04<00:01,  3.70it/s]100%|██████████| 25/25 [00:05<00:00,  3.39it/s]100%|██████████| 25/25 [00:05<00:00,  4.38it/s]
2025-03-13 11:32:17,609 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:17
2025-03-13 11:33:09,286 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6767 secs
2025-03-13 11:33:09,287 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 11:33:09,287 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.68it/s]
2025-03-13 11:33:23,282 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9945 secs
2025-03-13 11:33:23,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3847 secs
2025-03-13 11:33:23,282 [INFO]: {
2025-03-13 11:33:23,282 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:23,282 [INFO]: 	index_param: efSearch=105
2025-03-13 11:33:23,282 [INFO]: 	index_path: knn.index
2025-03-13 11:33:23,282 [INFO]: 	size in bytes: 1165905670
2025-03-13 11:33:23,283 [INFO]: 	avg_search_speed_ms: 6.923731992897059
2025-03-13 11:33:23,283 [INFO]: 	99p_search_speed_ms: 11.844405694864689
2025-03-13 11:33:23,283 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:23,283 [INFO]: 	nb vectors: 5926
2025-03-13 11:33:23,283 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:23,283 [INFO]: 	compression ratio: 0.9993081241298021
2025-03-13 11:33:23,283 [INFO]: }
2025-03-13 11:33:23,283 [INFO]: 	>>> Finished "Creating the index" in 71.3861 secs
2025-03-13 11:33:23,283 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4124 secs
2025-03-13 11:33:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 20923 [episode count 15/20]
[retrieval_preprocessing] for episode 51008 [episode count 16/20], we have num_retrieval=np.int64(5887) num_query=np.int64(238)
2025-03-13 11:33:25,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:26,084 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:26
2025-03-13 11:33:26,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2289.47it/s]
2025-03-13 11:33:26,111 [INFO]: There are 5887 embeddings of dim 49152
2025-03-13 11:33:26,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:33:26,111 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:26
2025-03-13 11:33:26,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:26,112 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:33:26,112 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:26,112 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:33:26,112 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:26
2025-03-13 11:33:26,112 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:26,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:33:26,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:26
2025-03-13 11:33:26,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:26,113 [INFO]: 	Creating the index 03/13/2025, 11:33:26
2025-03-13 11:33:26,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:26
2025-03-13 11:33:26,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:33:26,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:26
2025-03-13 11:33:26,116 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:33:26,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 18.19it/s] 32%|███▏      | 8/25 [00:00<00:00, 38.54it/s] 56%|█████▌    | 14/25 [00:00<00:00, 44.68it/s] 76%|███████▌  | 19/25 [00:00<00:00, 46.19it/s] 96%|█████████▌| 24/25 [00:05<00:00,  2.58it/s]100%|██████████| 25/25 [00:07<00:00,  3.51it/s]
2025-03-13 11:33:33,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:33
2025-03-13 11:34:22,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1022 secs
2025-03-13 11:34:22,343 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 11:34:22,343 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-13 11:34:37,492 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1492 secs
2025-03-13 11:34:37,494 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3774 secs
2025-03-13 11:34:37,494 [INFO]: {
2025-03-13 11:34:37,494 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:37,494 [INFO]: 	index_param: efSearch=144
2025-03-13 11:34:37,494 [INFO]: 	index_path: knn.index
2025-03-13 11:34:37,494 [INFO]: 	size in bytes: 1158232450
2025-03-13 11:34:37,494 [INFO]: 	avg_search_speed_ms: 8.164463934051444
2025-03-13 11:34:37,494 [INFO]: 	99p_search_speed_ms: 13.862391402944922
2025-03-13 11:34:37,494 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:37,494 [INFO]: 	nb vectors: 5887
2025-03-13 11:34:37,494 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:37,494 [INFO]: 	compression ratio: 0.9993082960160544
2025-03-13 11:34:37,494 [INFO]: }
2025-03-13 11:34:37,494 [INFO]: 	>>> Finished "Creating the index" in 71.3810 secs
2025-03-13 11:34:37,494 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4098 secs
2025-03-13 11:34:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 51008 [episode count 16/20]
[retrieval_preprocessing] for episode 10749 [episode count 17/20], we have num_retrieval=np.int64(5795) num_query=np.int64(330)
2025-03-13 11:34:39,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:40,893 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:40
2025-03-13 11:34:40,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.77it/s]
2025-03-13 11:34:40,922 [INFO]: There are 5795 embeddings of dim 49152
2025-03-13 11:34:40,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 11:34:40,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:40
2025-03-13 11:34:40,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:40,923 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:34:40,923 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:40,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:34:40,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:40
2025-03-13 11:34:40,923 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:40,924 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:34:40,924 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:40
2025-03-13 11:34:40,924 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:40,924 [INFO]: 	Creating the index 03/13/2025, 11:34:40
2025-03-13 11:34:40,924 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:40
2025-03-13 11:34:40,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:34:40,928 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:40
2025-03-13 11:34:40,928 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:34:40,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.45it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.45it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.72it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.34it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.09it/s]100%|██████████| 24/24 [00:05<00:00,  2.82it/s]100%|██████████| 24/24 [00:05<00:00,  4.15it/s]
2025-03-13 11:34:46,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:46
2025-03-13 11:35:36,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9833 secs
2025-03-13 11:35:36,702 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 11:35:36,702 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.16it/s]
2025-03-13 11:35:52,267 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5657 secs
2025-03-13 11:35:52,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3405 secs
2025-03-13 11:35:52,268 [INFO]: {
2025-03-13 11:35:52,268 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:52,268 [INFO]: 	index_param: efSearch=129
2025-03-13 11:35:52,268 [INFO]: 	index_path: knn.index
2025-03-13 11:35:52,268 [INFO]: 	size in bytes: 1140132130
2025-03-13 11:35:52,268 [INFO]: 	avg_search_speed_ms: 7.120089954448022
2025-03-13 11:35:52,268 [INFO]: 	99p_search_speed_ms: 11.232096208259467
2025-03-13 11:35:52,269 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:52,269 [INFO]: 	nb vectors: 5795
2025-03-13 11:35:52,269 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:52,269 [INFO]: 	compression ratio: 0.9993081766759788
2025-03-13 11:35:52,269 [INFO]: }
2025-03-13 11:35:52,269 [INFO]: 	>>> Finished "Creating the index" in 71.3451 secs
2025-03-13 11:35:52,269 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3758 secs
2025-03-13 11:35:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 10749 [episode count 17/20]
[retrieval_preprocessing] for episode 77637 [episode count 18/20], we have num_retrieval=np.int64(5787) num_query=np.int64(338)
2025-03-13 11:35:54,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:55,493 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:55
2025-03-13 11:35:55,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1576.21it/s]
2025-03-13 11:35:55,519 [INFO]: There are 5787 embeddings of dim 49152
2025-03-13 11:35:55,520 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:35:55,520 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:55
2025-03-13 11:35:55,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:55,520 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:35:55,520 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:55,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:55,520 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:55
2025-03-13 11:35:55,520 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:55,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:35:55,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:55
2025-03-13 11:35:55,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:55,520 [INFO]: 	Creating the index 03/13/2025, 11:35:55
2025-03-13 11:35:55,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:55
2025-03-13 11:35:55,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:35:55,521 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:55
2025-03-13 11:35:55,521 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:35:55,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.08it/s] 21%|██        | 5/24 [00:00<00:00, 22.72it/s] 42%|████▏     | 10/24 [00:00<00:00, 31.56it/s] 62%|██████▎   | 15/24 [00:00<00:00, 35.57it/s] 83%|████████▎ | 20/24 [00:00<00:00, 37.62it/s]100%|██████████| 24/24 [00:06<00:00,  1.99it/s]100%|██████████| 24/24 [00:06<00:00,  3.53it/s]
2025-03-13 11:36:02,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:02
2025-03-13 11:36:53,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8192 secs
2025-03-13 11:36:53,147 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 11:36:53,147 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.17it/s]
2025-03-13 11:37:09,050 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9028 secs
2025-03-13 11:37:09,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.5296 secs
2025-03-13 11:37:09,051 [INFO]: {
2025-03-13 11:37:09,051 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:09,051 [INFO]: 	index_param: efSearch=127
2025-03-13 11:37:09,051 [INFO]: 	index_path: knn.index
2025-03-13 11:37:09,051 [INFO]: 	size in bytes: 1138558150
2025-03-13 11:37:09,051 [INFO]: 	avg_search_speed_ms: 7.782398839028197
2025-03-13 11:37:09,051 [INFO]: 	99p_search_speed_ms: 14.2888290155679
2025-03-13 11:37:09,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:09,051 [INFO]: 	nb vectors: 5787
2025-03-13 11:37:09,051 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:09,051 [INFO]: 	compression ratio: 0.9993082004638938
2025-03-13 11:37:09,051 [INFO]: }
2025-03-13 11:37:09,051 [INFO]: 	>>> Finished "Creating the index" in 73.5309 secs
2025-03-13 11:37:09,051 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5573 secs
2025-03-13 11:37:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 77637 [episode count 18/20]
[retrieval_preprocessing] for episode 74664 [episode count 19/20], we have num_retrieval=np.int64(5831) num_query=np.int64(294)
2025-03-13 11:37:11,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:12,175 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:12
2025-03-13 11:37:12,176 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2286.97it/s]
2025-03-13 11:37:12,199 [INFO]: There are 5831 embeddings of dim 49152
2025-03-13 11:37:12,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:37:12,200 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:12
2025-03-13 11:37:12,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:12,200 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 11:37:12,200 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:12,200 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:12,200 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:12
2025-03-13 11:37:12,200 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:12,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:12,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:12
2025-03-13 11:37:12,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:12,200 [INFO]: 	Creating the index 03/13/2025, 11:37:12
2025-03-13 11:37:12,200 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:12
2025-03-13 11:37:12,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:12,201 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:12
2025-03-13 11:37:12,201 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 11:37:12,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.08it/s] 29%|██▉       | 7/24 [00:00<00:00, 34.67it/s] 54%|█████▍    | 13/24 [00:00<00:00, 45.27it/s] 79%|███████▉  | 19/24 [00:00<00:00, 50.02it/s]100%|██████████| 24/24 [00:05<00:00,  4.08it/s]
2025-03-13 11:37:18,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:18
2025-03-13 11:38:09,530 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4461 secs
2025-03-13 11:38:09,530 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 11:38:09,530 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-13 11:38:24,975 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4447 secs
2025-03-13 11:38:24,976 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.7746 secs
2025-03-13 11:38:24,976 [INFO]: {
2025-03-13 11:38:24,976 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:24,976 [INFO]: 	index_param: efSearch=89
2025-03-13 11:38:24,976 [INFO]: 	index_path: knn.index
2025-03-13 11:38:24,976 [INFO]: 	size in bytes: 1147214890
2025-03-13 11:38:24,976 [INFO]: 	avg_search_speed_ms: 6.00121416459542
2025-03-13 11:38:24,976 [INFO]: 	99p_search_speed_ms: 9.736862708814437
2025-03-13 11:38:24,976 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:24,976 [INFO]: 	nb vectors: 5831
2025-03-13 11:38:24,976 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:24,976 [INFO]: 	compression ratio: 0.9993082010990983
2025-03-13 11:38:24,976 [INFO]: }
2025-03-13 11:38:24,976 [INFO]: 	>>> Finished "Creating the index" in 72.7759 secs
2025-03-13 11:38:24,976 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8005 secs
2025-03-13 11:38:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 74664 [episode count 19/20]
2025-03-13 11:38:26: [retrieval_preprocessing] finished for 2495127464_move_right [chosen_id count 1/260]
2025-03-13 11:38:28: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2515873443_wipe_counter_with_towel [chosen_id count 2/260]
2025-03-13 11:38:28: [retrieval_preprocessing] we have num_total=8326 embedding_dim=49152
[retrieval_preprocessing] for episode 47109 [episode count 0/20], we have num_retrieval=np.int64(7964) num_query=np.int64(362)
2025-03-13 11:38:28,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:30,137 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:30
2025-03-13 11:38:30,137 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.63it/s]
2025-03-13 11:38:30,161 [INFO]: There are 7964 embeddings of dim 49152
2025-03-13 11:38:30,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:38:30,162 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:30
2025-03-13 11:38:30,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:30,163 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:38:30,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:30,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:38:30,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:30
2025-03-13 11:38:30,164 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:30,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:38:30,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:30
2025-03-13 11:38:30,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:30,164 [INFO]: 	Creating the index 03/13/2025, 11:38:30
2025-03-13 11:38:30,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:30
2025-03-13 11:38:30,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:38:30,168 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:30
2025-03-13 11:38:30,168 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:38:30,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.65it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.64it/s] 33%|███▎      | 11/33 [00:00<00:00, 35.38it/s] 48%|████▊     | 16/33 [00:00<00:00, 38.72it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.34it/s] 79%|███████▉  | 26/33 [00:04<00:01,  4.99it/s] 97%|█████████▋| 32/33 [00:04<00:00,  7.61it/s]100%|██████████| 33/33 [00:06<00:00,  4.72it/s]
2025-03-13 11:38:37,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:37
2025-03-13 11:39:32,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3288 secs
2025-03-13 11:39:32,495 [INFO]: The best hyperparameters are: efSearch=322
2025-03-13 11:39:32,495 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.89it/s]
2025-03-13 11:39:51,033 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5380 secs
2025-03-13 11:39:51,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.8671 secs
2025-03-13 11:39:51,035 [INFO]: {
2025-03-13 11:39:51,035 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:51,036 [INFO]: 	index_param: efSearch=322
2025-03-13 11:39:51,036 [INFO]: 	index_path: knn.index
2025-03-13 11:39:51,036 [INFO]: 	size in bytes: 1566870130
2025-03-13 11:39:51,036 [INFO]: 	avg_search_speed_ms: 13.269984681500166
2025-03-13 11:39:51,036 [INFO]: 	99p_search_speed_ms: 18.41549788368866
2025-03-13 11:39:51,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:51,036 [INFO]: 	nb vectors: 7964
2025-03-13 11:39:51,036 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:51,036 [INFO]: 	compression ratio: 0.9993081634659792
2025-03-13 11:39:51,036 [INFO]: }
2025-03-13 11:39:51,036 [INFO]: 	>>> Finished "Creating the index" in 80.8710 secs
2025-03-13 11:39:51,036 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8984 secs
2025-03-13 11:39:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 47109 [episode count 0/20]
[retrieval_preprocessing] for episode 64773 [episode count 1/20], we have num_retrieval=np.int64(8013) num_query=np.int64(313)
2025-03-13 11:39:57,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:58,178 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:58
2025-03-13 11:39:58,178 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.74it/s]
2025-03-13 11:39:58,204 [INFO]: There are 8013 embeddings of dim 49152
2025-03-13 11:39:58,204 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 11:39:58,205 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:58
2025-03-13 11:39:58,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:58,205 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:39:58,205 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:58,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:39:58,205 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:58
2025-03-13 11:39:58,205 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:58,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:39:58,206 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:58
2025-03-13 11:39:58,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:58,206 [INFO]: 	Creating the index 03/13/2025, 11:39:58
2025-03-13 11:39:58,206 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:58
2025-03-13 11:39:58,210 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:39:58,210 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:58
2025-03-13 11:39:58,210 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:39:58,211 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.03it/s] 21%|██        | 7/33 [00:00<00:00, 32.82it/s] 39%|███▉      | 13/33 [00:00<00:00, 41.71it/s] 58%|█████▊    | 19/33 [00:00<00:00, 46.19it/s] 73%|███████▎  | 24/33 [00:03<00:02,  4.10it/s] 88%|████████▊ | 29/33 [00:03<00:00,  5.89it/s]100%|██████████| 33/33 [00:06<00:00,  3.15it/s]100%|██████████| 33/33 [00:06<00:00,  4.92it/s]
2025-03-13 11:40:04,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:04
2025-03-13 11:41:03,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9495 secs
2025-03-13 11:41:03,877 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:41:03,877 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 11:41:24,109 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2319 secs
2025-03-13 11:41:24,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.9006 secs
2025-03-13 11:41:24,111 [INFO]: {
2025-03-13 11:41:24,111 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:24,111 [INFO]: 	index_param: efSearch=249
2025-03-13 11:41:24,111 [INFO]: 	index_path: knn.index
2025-03-13 11:41:24,111 [INFO]: 	size in bytes: 1576510510
2025-03-13 11:41:24,111 [INFO]: 	avg_search_speed_ms: 10.345158792238571
2025-03-13 11:41:24,111 [INFO]: 	99p_search_speed_ms: 14.75982276722789
2025-03-13 11:41:24,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:24,111 [INFO]: 	nb vectors: 8013
2025-03-13 11:41:24,111 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:24,111 [INFO]: 	compression ratio: 0.9993082152049846
2025-03-13 11:41:24,111 [INFO]: }
2025-03-13 11:41:24,111 [INFO]: 	>>> Finished "Creating the index" in 85.9049 secs
2025-03-13 11:41:24,111 [INFO]: >>> Finished "Launching the whole pipeline" in 85.9332 secs
2025-03-13 11:41:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 64773 [episode count 1/20]
[retrieval_preprocessing] for episode 90889 [episode count 2/20], we have num_retrieval=np.int64(7938) num_query=np.int64(388)
2025-03-13 11:41:27,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:28,996 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:28
2025-03-13 11:41:28,996 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1925.76it/s]
2025-03-13 11:41:29,024 [INFO]: There are 7938 embeddings of dim 49152
2025-03-13 11:41:29,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:41:29,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:29
2025-03-13 11:41:29,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:29,025 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:41:29,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:29,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:41:29,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:29
2025-03-13 11:41:29,026 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:29,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:41:29,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:29
2025-03-13 11:41:29,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:29,027 [INFO]: 	Creating the index 03/13/2025, 11:41:29
2025-03-13 11:41:29,027 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:29
2025-03-13 11:41:29,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:41:29,030 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:29
2025-03-13 11:41:29,031 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:41:29,031 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.62it/s] 18%|█▊        | 6/33 [00:00<00:00, 29.92it/s] 33%|███▎      | 11/33 [00:00<00:00, 36.86it/s] 48%|████▊     | 16/33 [00:00<00:00, 39.98it/s] 64%|██████▎   | 21/33 [00:03<00:03,  3.51it/s] 79%|███████▉  | 26/33 [00:04<00:01,  5.22it/s] 94%|█████████▍| 31/33 [00:04<00:00,  7.46it/s]100%|██████████| 33/33 [00:06<00:00,  4.75it/s]
2025-03-13 11:41:35,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:35
2025-03-13 11:42:34,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0619 secs
2025-03-13 11:42:34,047 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 11:42:34,047 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 11:42:50,672 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6249 secs
2025-03-13 11:42:50,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6430 secs
2025-03-13 11:42:50,674 [INFO]: {
2025-03-13 11:42:50,674 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:50,674 [INFO]: 	index_param: efSearch=205
2025-03-13 11:42:50,674 [INFO]: 	index_path: knn.index
2025-03-13 11:42:50,674 [INFO]: 	size in bytes: 1561754710
2025-03-13 11:42:50,674 [INFO]: 	avg_search_speed_ms: 9.352593146259325
2025-03-13 11:42:50,674 [INFO]: 	99p_search_speed_ms: 16.678031589835882
2025-03-13 11:42:50,674 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:50,674 [INFO]: 	nb vectors: 7938
2025-03-13 11:42:50,674 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:50,674 [INFO]: 	compression ratio: 0.9993082101862206
2025-03-13 11:42:50,674 [INFO]: }
2025-03-13 11:42:50,674 [INFO]: 	>>> Finished "Creating the index" in 81.6469 secs
2025-03-13 11:42:50,674 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6775 secs
2025-03-13 11:42:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 90889 [episode count 2/20]
[retrieval_preprocessing] for episode 93066 [episode count 3/20], we have num_retrieval=np.int64(7868) num_query=np.int64(458)
2025-03-13 11:42:53,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:54,922 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:54
2025-03-13 11:42:54,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.05it/s]
2025-03-13 11:42:54,950 [INFO]: There are 7868 embeddings of dim 49152
2025-03-13 11:42:54,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:42:54,951 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:54
2025-03-13 11:42:54,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:54,951 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 11:42:54,951 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:54,951 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:42:54,951 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:54
2025-03-13 11:42:54,952 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:54,952 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:42:54,952 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:54
2025-03-13 11:42:54,952 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:54,952 [INFO]: 	Creating the index 03/13/2025, 11:42:54
2025-03-13 11:42:54,953 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:54
2025-03-13 11:42:54,956 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:42:54,956 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:54
2025-03-13 11:42:54,956 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:42:54,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 16.47it/s] 25%|██▌       | 8/32 [00:00<00:00, 36.78it/s] 44%|████▍     | 14/32 [00:00<00:00, 43.41it/s] 59%|█████▉    | 19/32 [00:00<00:00, 45.41it/s] 75%|███████▌  | 24/32 [00:04<00:02,  3.64it/s] 88%|████████▊ | 28/32 [00:04<00:00,  4.92it/s]100%|██████████| 32/32 [00:06<00:00,  2.91it/s]100%|██████████| 32/32 [00:06<00:00,  4.60it/s]
2025-03-13 11:43:01,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:01
2025-03-13 11:44:01,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.4589 secs
2025-03-13 11:44:01,375 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 11:44:01,375 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s]
2025-03-13 11:44:17,620 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2447 secs
2025-03-13 11:44:17,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6654 secs
2025-03-13 11:44:17,622 [INFO]: {
2025-03-13 11:44:17,622 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:17,622 [INFO]: 	index_param: efSearch=255
2025-03-13 11:44:17,622 [INFO]: 	index_path: knn.index
2025-03-13 11:44:17,622 [INFO]: 	size in bytes: 1547982790
2025-03-13 11:44:17,622 [INFO]: 	avg_search_speed_ms: 12.028458951905263
2025-03-13 11:44:17,622 [INFO]: 	99p_search_speed_ms: 20.516648753546168
2025-03-13 11:44:17,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:17,622 [INFO]: 	nb vectors: 7868
2025-03-13 11:44:17,622 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:17,622 [INFO]: 	compression ratio: 0.9993081021268977
2025-03-13 11:44:17,622 [INFO]: }
2025-03-13 11:44:17,622 [INFO]: 	>>> Finished "Creating the index" in 82.6693 secs
2025-03-13 11:44:17,622 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6994 secs
2025-03-13 11:44:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 93066 [episode count 3/20]
[retrieval_preprocessing] for episode 19853 [episode count 4/20], we have num_retrieval=np.int64(7939) num_query=np.int64(387)
2025-03-13 11:44:22,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:23,747 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:23
2025-03-13 11:44:23,747 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1048.58it/s]
2025-03-13 11:44:23,774 [INFO]: There are 7939 embeddings of dim 49152
2025-03-13 11:44:23,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:44:23,774 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:23
2025-03-13 11:44:23,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:23,774 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:44:23,774 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:23,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:23,774 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:23
2025-03-13 11:44:23,775 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:23,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:44:23,775 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:23
2025-03-13 11:44:23,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:23,775 [INFO]: 	Creating the index 03/13/2025, 11:44:23
2025-03-13 11:44:23,775 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:23
2025-03-13 11:44:23,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:44:23,776 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:23
2025-03-13 11:44:23,776 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:44:23,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.17it/s] 18%|█▊        | 6/33 [00:00<00:01, 26.36it/s] 33%|███▎      | 11/33 [00:00<00:00, 34.69it/s] 48%|████▊     | 16/33 [00:00<00:00, 38.96it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.15it/s] 79%|███████▉  | 26/33 [00:04<00:01,  4.72it/s] 97%|█████████▋| 32/33 [00:04<00:00,  7.22it/s]100%|██████████| 33/33 [00:07<00:00,  4.36it/s]
2025-03-13 11:44:31,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:31
2025-03-13 11:45:29,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0391 secs
2025-03-13 11:45:29,391 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 11:45:29,391 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.83it/s]
2025-03-13 11:45:47,222 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8309 secs
2025-03-13 11:45:47,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.4479 secs
2025-03-13 11:45:47,224 [INFO]: {
2025-03-13 11:45:47,224 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:47,224 [INFO]: 	index_param: efSearch=185
2025-03-13 11:45:47,224 [INFO]: 	index_path: knn.index
2025-03-13 11:45:47,224 [INFO]: 	size in bytes: 1561951450
2025-03-13 11:45:47,224 [INFO]: 	avg_search_speed_ms: 11.543965899260762
2025-03-13 11:45:47,224 [INFO]: 	99p_search_speed_ms: 19.370557134971023
2025-03-13 11:45:47,224 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:47,224 [INFO]: 	nb vectors: 7939
2025-03-13 11:45:47,224 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:47,224 [INFO]: 	compression ratio: 0.9993082128128886
2025-03-13 11:45:47,224 [INFO]: }
2025-03-13 11:45:47,224 [INFO]: 	>>> Finished "Creating the index" in 83.4494 secs
2025-03-13 11:45:47,224 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4770 secs
2025-03-13 11:45:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 19853 [episode count 4/20]
[retrieval_preprocessing] for episode 42899 [episode count 5/20], we have num_retrieval=np.int64(7966) num_query=np.int64(360)
2025-03-13 11:45:50,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:51,867 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:51
2025-03-13 11:45:51,867 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.44it/s]
2025-03-13 11:45:51,897 [INFO]: There are 7966 embeddings of dim 49152
2025-03-13 11:45:51,898 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 11:45:51,898 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,898 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:51,898 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:45:51,899 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:51,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:45:51,899 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,899 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:51,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:45:51,900 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:51
2025-03-13 11:45:51,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:51,900 [INFO]: 	Creating the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,900 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:51
2025-03-13 11:45:51,903 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:45:51,904 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:51
2025-03-13 11:45:51,904 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:45:51,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:31,  1.03it/s]  6%|▌         | 2/33 [00:02<00:39,  1.26s/it] 21%|██        | 7/33 [00:02<00:06,  3.87it/s] 36%|███▋      | 12/33 [00:02<00:02,  7.62it/s] 52%|█████▏    | 17/33 [00:02<00:01, 11.97it/s] 64%|██████▎   | 21/33 [00:06<00:04,  2.55it/s] 73%|███████▎  | 24/33 [00:09<00:04,  2.04it/s] 79%|███████▉  | 26/33 [00:09<00:03,  2.23it/s] 85%|████████▍ | 28/33 [00:11<00:02,  1.67it/s] 88%|████████▊ | 29/33 [00:12<00:02,  1.64it/s] 91%|█████████ | 30/33 [00:12<00:01,  1.86it/s]100%|██████████| 33/33 [00:15<00:00,  1.46it/s]100%|██████████| 33/33 [00:15<00:00,  2.13it/s]
2025-03-13 11:46:07,385 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:07
2025-03-13 11:47:04,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1146 secs
2025-03-13 11:47:04,500 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 11:47:04,500 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.36it/s]
2025-03-13 11:47:26,879 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3788 secs
2025-03-13 11:47:26,883 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.9788 secs
2025-03-13 11:47:26,883 [INFO]: {
2025-03-13 11:47:26,883 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:26,883 [INFO]: 	index_param: efSearch=266
2025-03-13 11:47:26,883 [INFO]: 	index_path: knn.index
2025-03-13 11:47:26,883 [INFO]: 	size in bytes: 1567263610
2025-03-13 11:47:26,883 [INFO]: 	avg_search_speed_ms: 13.317437696465342
2025-03-13 11:47:26,883 [INFO]: 	99p_search_speed_ms: 27.72584545891732
2025-03-13 11:47:26,883 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:26,883 [INFO]: 	nb vectors: 7966
2025-03-13 11:47:26,883 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:26,883 [INFO]: 	compression ratio: 0.999308168713239
2025-03-13 11:47:26,883 [INFO]: }
2025-03-13 11:47:26,883 [INFO]: 	>>> Finished "Creating the index" in 94.9830 secs
2025-03-13 11:47:26,883 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0163 secs
2025-03-13 11:47:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 42899 [episode count 5/20]
[retrieval_preprocessing] for episode 21525 [episode count 6/20], we have num_retrieval=np.int64(7830) num_query=np.int64(496)
2025-03-13 11:47:31,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:32,832 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:32
2025-03-13 11:47:32,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.74it/s]
2025-03-13 11:47:32,861 [INFO]: There are 7830 embeddings of dim 49152
2025-03-13 11:47:32,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 11:47:32,862 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:32
2025-03-13 11:47:32,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:32,862 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 11:47:32,862 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:32,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:47:32,862 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:32
2025-03-13 11:47:32,863 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:32,863 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:47:32,863 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:32
2025-03-13 11:47:32,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:47:32,864 [INFO]: 	Creating the index 03/13/2025, 11:47:32
2025-03-13 11:47:32,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:32
2025-03-13 11:47:32,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:47:32,868 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:32
2025-03-13 11:47:32,868 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:47:32,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.86it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.18it/s] 34%|███▍      | 11/32 [00:00<00:00, 34.07it/s] 50%|█████     | 16/32 [00:00<00:00, 37.19it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.36it/s] 81%|████████▏ | 26/32 [00:04<00:01,  5.00it/s] 97%|█████████▋| 31/32 [00:04<00:00,  7.14it/s]100%|██████████| 32/32 [00:06<00:00,  4.58it/s]
2025-03-13 11:47:39,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:39
2025-03-13 11:48:38,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5414 secs
2025-03-13 11:48:38,399 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 11:48:38,399 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 11:49:08,144 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7452 secs
2025-03-13 11:49:08,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.2784 secs
2025-03-13 11:49:08,147 [INFO]: {
2025-03-13 11:49:08,147 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:08,147 [INFO]: 	index_param: efSearch=253
2025-03-13 11:49:08,147 [INFO]: 	index_path: knn.index
2025-03-13 11:49:08,147 [INFO]: 	size in bytes: 1540506550
2025-03-13 11:49:08,147 [INFO]: 	avg_search_speed_ms: 13.553586880282719
2025-03-13 11:49:08,147 [INFO]: 	99p_search_speed_ms: 21.86450322624296
2025-03-13 11:49:08,147 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:08,147 [INFO]: 	nb vectors: 7830
2025-03-13 11:49:08,147 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:08,147 [INFO]: 	compression ratio: 0.999308078242186
2025-03-13 11:49:08,147 [INFO]: }
2025-03-13 11:49:08,147 [INFO]: 	>>> Finished "Creating the index" in 95.2829 secs
2025-03-13 11:49:08,147 [INFO]: >>> Finished "Launching the whole pipeline" in 95.3149 secs
2025-03-13 11:49:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 21525 [episode count 6/20]
[retrieval_preprocessing] for episode 36155 [episode count 7/20], we have num_retrieval=np.int64(7785) num_query=np.int64(541)
2025-03-13 11:49:14,038 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:15,276 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:15
2025-03-13 11:49:15,276 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 979.98it/s]
2025-03-13 11:49:15,302 [INFO]: There are 7785 embeddings of dim 49152
2025-03-13 11:49:15,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 11:49:15,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:15,302 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 11:49:15,302 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:15,302 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:49:15,302 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,302 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:15,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:49:15,302 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:15
2025-03-13 11:49:15,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:15,302 [INFO]: 	Creating the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,302 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:15
2025-03-13 11:49:15,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:49:15,304 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:15
2025-03-13 11:49:15,304 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:49:15,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.60it/s] 16%|█▌        | 5/32 [00:00<00:01, 21.42it/s] 31%|███▏      | 10/32 [00:00<00:00, 30.55it/s] 47%|████▋     | 15/32 [00:00<00:00, 33.68it/s] 59%|█████▉    | 19/32 [00:00<00:00, 32.13it/s] 72%|███████▏  | 23/32 [00:05<00:03,  2.34it/s] 88%|████████▊ | 28/32 [00:05<00:01,  3.62it/s]100%|██████████| 32/32 [00:08<00:00,  2.40it/s]100%|██████████| 32/32 [00:08<00:00,  3.69it/s]
2025-03-13 11:49:23,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:23
2025-03-13 11:50:17,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.3553 secs
2025-03-13 11:50:17,329 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 11:50:17,329 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.26it/s]
2025-03-13 11:50:50,560 [INFO]: 	>>> Finished "Compute fast metrics" in 33.2313 secs
2025-03-13 11:50:50,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.2593 secs
2025-03-13 11:50:50,563 [INFO]: {
2025-03-13 11:50:50,563 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:50,563 [INFO]: 	index_param: efSearch=274
2025-03-13 11:50:50,563 [INFO]: 	index_path: knn.index
2025-03-13 11:50:50,563 [INFO]: 	size in bytes: 1531653190
2025-03-13 11:50:50,563 [INFO]: 	avg_search_speed_ms: 11.303234084819755
2025-03-13 11:50:50,563 [INFO]: 	99p_search_speed_ms: 15.920690484344957
2025-03-13 11:50:50,563 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:50,563 [INFO]: 	nb vectors: 7785
2025-03-13 11:50:50,563 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:50,563 [INFO]: 	compression ratio: 0.9993079960875477
2025-03-13 11:50:50,563 [INFO]: }
2025-03-13 11:50:50,563 [INFO]: 	>>> Finished "Creating the index" in 95.2610 secs
2025-03-13 11:50:50,563 [INFO]: >>> Finished "Launching the whole pipeline" in 95.2875 secs
2025-03-13 11:50:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 36155 [episode count 7/20]
[retrieval_preprocessing] for episode 52671 [episode count 8/20], we have num_retrieval=np.int64(7718) num_query=np.int64(608)
2025-03-13 11:50:58,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:59,687 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:59
2025-03-13 11:50:59,687 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1666.39it/s]
2025-03-13 11:50:59,713 [INFO]: There are 7718 embeddings of dim 49152
2025-03-13 11:50:59,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 11:50:59,713 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:59
2025-03-13 11:50:59,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:59,713 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:50:59,713 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:59,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:50:59,713 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:59
2025-03-13 11:50:59,713 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:59,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:50:59,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:59
2025-03-13 11:50:59,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:59,714 [INFO]: 	Creating the index 03/13/2025, 11:50:59
2025-03-13 11:50:59,714 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:59
2025-03-13 11:50:59,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:50:59,715 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:59
2025-03-13 11:50:59,715 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:50:59,715 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.28it/s] 19%|█▉        | 6/32 [00:00<00:00, 26.73it/s] 34%|███▍      | 11/32 [00:00<00:00, 33.97it/s] 50%|█████     | 16/32 [00:00<00:00, 37.47it/s] 66%|██████▌   | 21/32 [00:05<00:04,  2.61it/s] 78%|███████▊  | 25/32 [00:05<00:01,  3.66it/s] 94%|█████████▍| 30/32 [00:05<00:00,  5.42it/s]100%|██████████| 32/32 [00:07<00:00,  4.01it/s]
2025-03-13 11:51:07,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:07
2025-03-13 11:52:03,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6783 secs
2025-03-13 11:52:03,371 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 11:52:03,371 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 11:52:30,673 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3018 secs
2025-03-13 11:52:30,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9605 secs
2025-03-13 11:52:30,676 [INFO]: {
2025-03-13 11:52:30,676 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:30,676 [INFO]: 	index_param: efSearch=275
2025-03-13 11:52:30,676 [INFO]: 	index_path: knn.index
2025-03-13 11:52:30,676 [INFO]: 	size in bytes: 1518471310
2025-03-13 11:52:30,676 [INFO]: 	avg_search_speed_ms: 13.007827376842654
2025-03-13 11:52:30,676 [INFO]: 	99p_search_speed_ms: 19.476624224334937
2025-03-13 11:52:30,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:30,676 [INFO]: 	nb vectors: 7718
2025-03-13 11:52:30,676 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:30,676 [INFO]: 	compression ratio: 0.9993080106334047
2025-03-13 11:52:30,676 [INFO]: }
2025-03-13 11:52:30,676 [INFO]: 	>>> Finished "Creating the index" in 90.9623 secs
2025-03-13 11:52:30,676 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9892 secs
2025-03-13 11:52:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 52671 [episode count 8/20]
[retrieval_preprocessing] for episode 17192 [episode count 9/20], we have num_retrieval=np.int64(7976) num_query=np.int64(350)
2025-03-13 11:52:37,880 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:39,420 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:39
2025-03-13 11:52:39,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.34it/s]
2025-03-13 11:52:39,996 [INFO]: There are 7976 embeddings of dim 49152
2025-03-13 11:52:39,996 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5757 secs
2025-03-13 11:52:39,996 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:39
2025-03-13 11:52:39,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:39,996 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:52:39,996 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:39,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:52:39,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:39
2025-03-13 11:52:39,997 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:39,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:52:39,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:39
2025-03-13 11:52:39,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:39,997 [INFO]: 	Creating the index 03/13/2025, 11:52:39
2025-03-13 11:52:39,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:39
2025-03-13 11:52:39,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:52:40,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:40
2025-03-13 11:52:40,000 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:52:40,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.64it/s] 15%|█▌        | 5/33 [00:00<00:01, 24.38it/s] 27%|██▋       | 9/33 [00:00<00:00, 30.95it/s] 42%|████▏     | 14/33 [00:00<00:00, 34.86it/s] 55%|█████▍    | 18/33 [00:00<00:00, 36.55it/s] 67%|██████▋   | 22/33 [00:04<00:04,  2.63it/s] 85%|████████▍ | 28/33 [00:04<00:01,  4.39it/s]100%|██████████| 33/33 [00:07<00:00,  2.93it/s]100%|██████████| 33/33 [00:07<00:00,  4.25it/s]
2025-03-13 11:52:47,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:47
2025-03-13 11:53:44,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.3896 secs
2025-03-13 11:53:44,335 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 11:53:44,335 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.72it/s]
2025-03-13 11:54:11,600 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2646 secs
2025-03-13 11:54:11,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6022 secs
2025-03-13 11:54:11,602 [INFO]: {
2025-03-13 11:54:11,602 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:11,602 [INFO]: 	index_param: efSearch=255
2025-03-13 11:54:11,602 [INFO]: 	index_path: knn.index
2025-03-13 11:54:11,602 [INFO]: 	size in bytes: 1569231010
2025-03-13 11:54:11,602 [INFO]: 	avg_search_speed_ms: 10.516532489170098
2025-03-13 11:54:11,602 [INFO]: 	99p_search_speed_ms: 15.31434094067663
2025-03-13 11:54:11,602 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:11,602 [INFO]: 	nb vectors: 7976
2025-03-13 11:54:11,602 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:11,602 [INFO]: 	compression ratio: 0.9993081949100662
2025-03-13 11:54:11,602 [INFO]: }
2025-03-13 11:54:11,602 [INFO]: 	>>> Finished "Creating the index" in 91.6051 secs
2025-03-13 11:54:11,602 [INFO]: >>> Finished "Launching the whole pipeline" in 92.1820 secs
2025-03-13 11:54:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17192 [episode count 9/20]
[retrieval_preprocessing] for episode 49832 [episode count 10/20], we have num_retrieval=np.int64(7835) num_query=np.int64(491)
2025-03-13 11:54:15,824 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:16,866 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:16
2025-03-13 11:54:16,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1067.25it/s]
2025-03-13 11:54:16,892 [INFO]: There are 7835 embeddings of dim 49152
2025-03-13 11:54:16,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:54:16,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:16
2025-03-13 11:54:16,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:16,893 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 11:54:16,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:16,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:16,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:16
2025-03-13 11:54:16,893 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:16,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:54:16,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:16
2025-03-13 11:54:16,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:16,893 [INFO]: 	Creating the index 03/13/2025, 11:54:16
2025-03-13 11:54:16,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:16
2025-03-13 11:54:16,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:54:16,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:16
2025-03-13 11:54:16,894 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:54:16,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.56it/s] 16%|█▌        | 5/32 [00:00<00:01, 19.53it/s] 28%|██▊       | 9/32 [00:00<00:00, 27.01it/s] 44%|████▍     | 14/32 [00:00<00:00, 32.54it/s] 59%|█████▉    | 19/32 [00:00<00:00, 35.63it/s] 72%|███████▏  | 23/32 [00:05<00:03,  2.55it/s] 84%|████████▍ | 27/32 [00:05<00:01,  3.62it/s] 97%|█████████▋| 31/32 [00:05<00:00,  5.04it/s]100%|██████████| 32/32 [00:08<00:00,  3.87it/s]
2025-03-13 11:54:25,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:25
2025-03-13 11:55:21,947 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7831 secs
2025-03-13 11:55:21,948 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 11:55:21,948 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.43it/s]
2025-03-13 11:55:52,031 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0829 secs
2025-03-13 11:55:52,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.1385 secs
2025-03-13 11:55:52,033 [INFO]: {
2025-03-13 11:55:52,033 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:52,033 [INFO]: 	index_param: efSearch=227
2025-03-13 11:55:52,033 [INFO]: 	index_path: knn.index
2025-03-13 11:55:52,033 [INFO]: 	size in bytes: 1541490310
2025-03-13 11:55:52,033 [INFO]: 	avg_search_speed_ms: 10.141334895509281
2025-03-13 11:55:52,033 [INFO]: 	99p_search_speed_ms: 18.92901798710227
2025-03-13 11:55:52,033 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:52,033 [INFO]: 	nb vectors: 7835
2025-03-13 11:55:52,033 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:52,033 [INFO]: 	compression ratio: 0.9993080527376134
2025-03-13 11:55:52,033 [INFO]: }
2025-03-13 11:55:52,033 [INFO]: 	>>> Finished "Creating the index" in 95.1401 secs
2025-03-13 11:55:52,033 [INFO]: >>> Finished "Launching the whole pipeline" in 95.1671 secs
2025-03-13 11:55:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 49832 [episode count 10/20]
[retrieval_preprocessing] for episode 76719 [episode count 11/20], we have num_retrieval=np.int64(8000) num_query=np.int64(326)
2025-03-13 11:55:57,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:58,507 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:58
2025-03-13 11:55:58,508 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.81it/s]
2025-03-13 11:55:58,536 [INFO]: There are 8000 embeddings of dim 49152
2025-03-13 11:55:58,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:55:58,537 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:58
2025-03-13 11:55:58,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:58,537 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:55:58,537 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:58,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:55:58,538 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:58
2025-03-13 11:55:58,538 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:58,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:55:58,539 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:58
2025-03-13 11:55:58,539 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:55:58,539 [INFO]: 	Creating the index 03/13/2025, 11:55:58
2025-03-13 11:55:58,539 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:58
2025-03-13 11:55:58,542 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:55:58,542 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:58
2025-03-13 11:55:58,542 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:55:58,543 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.79it/s] 15%|█▌        | 5/33 [00:00<00:01, 25.26it/s] 30%|███       | 10/33 [00:00<00:00, 33.36it/s] 45%|████▌     | 15/33 [00:00<00:00, 37.05it/s] 61%|██████    | 20/33 [00:00<00:00, 39.05it/s] 73%|███████▎  | 24/33 [00:05<00:03,  2.65it/s] 85%|████████▍ | 28/33 [00:05<00:01,  3.70it/s]100%|██████████| 33/33 [00:08<00:00,  2.52it/s]100%|██████████| 33/33 [00:08<00:00,  3.91it/s]
2025-03-13 11:56:06,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:06
2025-03-13 11:57:01,377 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3968 secs
2025-03-13 11:57:01,378 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:57:01,378 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-13 11:57:23,308 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9302 secs
2025-03-13 11:57:23,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.7674 secs
2025-03-13 11:57:23,310 [INFO]: {
2025-03-13 11:57:23,310 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:23,310 [INFO]: 	index_param: efSearch=256
2025-03-13 11:57:23,310 [INFO]: 	index_path: knn.index
2025-03-13 11:57:23,310 [INFO]: 	size in bytes: 1573952890
2025-03-13 11:57:23,310 [INFO]: 	avg_search_speed_ms: 11.102636613997813
2025-03-13 11:57:23,310 [INFO]: 	99p_search_speed_ms: 17.031390918418765
2025-03-13 11:57:23,310 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:23,310 [INFO]: 	nb vectors: 8000
2025-03-13 11:57:23,310 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:23,310 [INFO]: 	compression ratio: 0.9993081813268249
2025-03-13 11:57:23,310 [INFO]: }
2025-03-13 11:57:23,310 [INFO]: 	>>> Finished "Creating the index" in 84.7710 secs
2025-03-13 11:57:23,310 [INFO]: >>> Finished "Launching the whole pipeline" in 84.8026 secs
2025-03-13 11:57:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 76719 [episode count 11/20]
[retrieval_preprocessing] for episode 85431 [episode count 12/20], we have num_retrieval=np.int64(8053) num_query=np.int64(273)
2025-03-13 11:57:27,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:29,512 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:29
2025-03-13 11:57:29,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.69it/s]
2025-03-13 11:57:29,541 [INFO]: There are 8053 embeddings of dim 49152
2025-03-13 11:57:29,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:57:29,542 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:29
2025-03-13 11:57:29,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:29,542 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:57:29,542 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:29,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:29,542 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:29
2025-03-13 11:57:29,542 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:29,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:57:29,542 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:29
2025-03-13 11:57:29,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:29,542 [INFO]: 	Creating the index 03/13/2025, 11:57:29
2025-03-13 11:57:29,542 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:29
2025-03-13 11:57:29,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:57:29,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:29
2025-03-13 11:57:29,544 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:57:29,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.05it/s] 15%|█▌        | 5/33 [00:00<00:01, 23.59it/s] 30%|███       | 10/33 [00:00<00:00, 31.82it/s] 45%|████▌     | 15/33 [00:00<00:00, 35.73it/s] 61%|██████    | 20/33 [00:00<00:00, 37.71it/s] 73%|███████▎  | 24/33 [00:04<00:03,  3.00it/s] 88%|████████▊ | 29/33 [00:04<00:00,  4.49it/s]100%|██████████| 33/33 [00:07<00:00,  2.73it/s]100%|██████████| 33/33 [00:07<00:00,  4.33it/s]
2025-03-13 11:57:37,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:37
2025-03-13 11:58:30,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8055 secs
2025-03-13 11:58:30,973 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:58:30,973 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 11:58:55,591 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6185 secs
2025-03-13 11:58:55,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.0499 secs
2025-03-13 11:58:55,594 [INFO]: {
2025-03-13 11:58:55,594 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:55,594 [INFO]: 	index_param: efSearch=184
2025-03-13 11:58:55,594 [INFO]: 	index_path: knn.index
2025-03-13 11:58:55,594 [INFO]: 	size in bytes: 1584380290
2025-03-13 11:58:55,594 [INFO]: 	avg_search_speed_ms: 8.332350260293504
2025-03-13 11:58:55,594 [INFO]: 	99p_search_speed_ms: 13.325476087629795
2025-03-13 11:58:55,594 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:55,594 [INFO]: 	nb vectors: 8053
2025-03-13 11:58:55,594 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:55,594 [INFO]: 	compression ratio: 0.9993082052289353
2025-03-13 11:58:55,594 [INFO]: }
2025-03-13 11:58:55,594 [INFO]: 	>>> Finished "Creating the index" in 86.0516 secs
2025-03-13 11:58:55,594 [INFO]: >>> Finished "Launching the whole pipeline" in 86.0814 secs
2025-03-13 11:58:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 85431 [episode count 12/20]
[retrieval_preprocessing] for episode 39112 [episode count 13/20], we have num_retrieval=np.int64(7941) num_query=np.int64(385)
2025-03-13 11:58:58,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:59,312 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:59
2025-03-13 11:58:59,312 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2460.00it/s]
2025-03-13 11:58:59,334 [INFO]: There are 7941 embeddings of dim 49152
2025-03-13 11:58:59,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-13 11:58:59,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:59
2025-03-13 11:58:59,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:59,335 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 11:58:59,335 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:59,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:59,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:59
2025-03-13 11:58:59,335 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:59,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:59,335 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:59
2025-03-13 11:58:59,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:59,335 [INFO]: 	Creating the index 03/13/2025, 11:58:59
2025-03-13 11:58:59,335 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:59
2025-03-13 11:58:59,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:58:59,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:59
2025-03-13 11:58:59,336 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 11:58:59,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.34it/s] 18%|█▊        | 6/33 [00:00<00:00, 30.10it/s] 33%|███▎      | 11/33 [00:00<00:00, 38.37it/s] 48%|████▊     | 16/33 [00:00<00:00, 42.52it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.15it/s] 76%|███████▌  | 25/33 [00:04<00:01,  4.38it/s] 91%|█████████ | 30/33 [00:04<00:00,  6.40it/s]100%|██████████| 33/33 [00:07<00:00,  4.26it/s]
2025-03-13 11:59:07,093 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:07
2025-03-13 12:00:02,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7615 secs
2025-03-13 12:00:02,855 [INFO]: The best hyperparameters are: efSearch=284
2025-03-13 12:00:02,855 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 12:00:32,396 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5410 secs
2025-03-13 12:00:32,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0618 secs
2025-03-13 12:00:32,398 [INFO]: {
2025-03-13 12:00:32,398 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:32,398 [INFO]: 	index_param: efSearch=284
2025-03-13 12:00:32,398 [INFO]: 	index_path: knn.index
2025-03-13 12:00:32,398 [INFO]: 	size in bytes: 1562344930
2025-03-13 12:00:32,398 [INFO]: 	avg_search_speed_ms: 12.863423598386769
2025-03-13 12:00:32,398 [INFO]: 	99p_search_speed_ms: 18.914222710300237
2025-03-13 12:00:32,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:32,398 [INFO]: 	nb vectors: 7941
2025-03-13 12:00:32,398 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:32,398 [INFO]: 	compression ratio: 0.9993082180642402
2025-03-13 12:00:32,398 [INFO]: }
2025-03-13 12:00:32,399 [INFO]: 	>>> Finished "Creating the index" in 93.0640 secs
2025-03-13 12:00:32,399 [INFO]: >>> Finished "Launching the whole pipeline" in 93.0870 secs
2025-03-13 12:00:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 39112 [episode count 13/20]
[retrieval_preprocessing] for episode 42953 [episode count 14/20], we have num_retrieval=np.int64(7982) num_query=np.int64(344)
2025-03-13 12:00:36,872 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:38,045 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:38
2025-03-13 12:00:38,045 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1886.78it/s]
2025-03-13 12:00:38,070 [INFO]: There are 7982 embeddings of dim 49152
2025-03-13 12:00:38,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 12:00:38,070 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:38
2025-03-13 12:00:38,070 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:38,070 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 12:00:38,070 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:38,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:00:38,070 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:38
2025-03-13 12:00:38,070 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:38,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:00:38,070 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:38
2025-03-13 12:00:38,070 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:38,070 [INFO]: 	Creating the index 03/13/2025, 12:00:38
2025-03-13 12:00:38,071 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:38
2025-03-13 12:00:38,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:00:38,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:38
2025-03-13 12:00:38,072 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:00:38,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.10it/s] 15%|█▌        | 5/33 [00:00<00:01, 21.62it/s] 30%|███       | 10/33 [00:00<00:00, 30.14it/s] 45%|████▌     | 15/33 [00:00<00:00, 34.13it/s] 58%|█████▊    | 19/33 [00:00<00:00, 35.42it/s] 70%|██████▉   | 23/33 [00:05<00:03,  2.56it/s] 85%|████████▍ | 28/33 [00:05<00:01,  3.94it/s]100%|██████████| 33/33 [00:07<00:00,  2.89it/s]100%|██████████| 33/33 [00:07<00:00,  4.23it/s]
2025-03-13 12:00:45,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:45
2025-03-13 12:01:42,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8363 secs
2025-03-13 12:01:42,722 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:01:42,722 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.26it/s]
2025-03-13 12:02:14,684 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9618 secs
2025-03-13 12:02:14,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.6149 secs
2025-03-13 12:02:14,687 [INFO]: {
2025-03-13 12:02:14,687 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:14,687 [INFO]: 	index_param: efSearch=258
2025-03-13 12:02:14,687 [INFO]: 	index_path: knn.index
2025-03-13 12:02:14,687 [INFO]: 	size in bytes: 1570411510
2025-03-13 12:02:14,687 [INFO]: 	avg_search_speed_ms: 11.93810620335173
2025-03-13 12:02:14,687 [INFO]: 	99p_search_speed_ms: 16.904664842877537
2025-03-13 12:02:14,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:14,687 [INFO]: 	nb vectors: 7982
2025-03-13 12:02:14,687 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:14,687 [INFO]: 	compression ratio: 0.9993081724165407
2025-03-13 12:02:14,687 [INFO]: }
2025-03-13 12:02:14,687 [INFO]: 	>>> Finished "Creating the index" in 96.6165 secs
2025-03-13 12:02:14,687 [INFO]: >>> Finished "Launching the whole pipeline" in 96.6415 secs
2025-03-13 12:02:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 42953 [episode count 14/20]
[retrieval_preprocessing] for episode 14798 [episode count 15/20], we have num_retrieval=np.int64(7847) num_query=np.int64(479)
2025-03-13 12:02:19,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:20,736 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:20
2025-03-13 12:02:20,736 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1014.83it/s]
2025-03-13 12:02:20,766 [INFO]: There are 7847 embeddings of dim 49152
2025-03-13 12:02:20,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:02:20,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:20
2025-03-13 12:02:20,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:20,768 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:02:20,768 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:20,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:02:20,768 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:20
2025-03-13 12:02:20,769 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:20,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:02:20,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:20
2025-03-13 12:02:20,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:20,769 [INFO]: 	Creating the index 03/13/2025, 12:02:20
2025-03-13 12:02:20,770 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:20
2025-03-13 12:02:20,773 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:02:20,773 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:20
2025-03-13 12:02:20,774 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:02:20,774 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.28it/s] 19%|█▉        | 6/32 [00:00<00:00, 28.02it/s] 34%|███▍      | 11/32 [00:00<00:00, 34.74it/s] 50%|█████     | 16/32 [00:00<00:00, 38.21it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.36it/s] 81%|████████▏ | 26/32 [00:04<00:01,  5.01it/s]100%|██████████| 32/32 [00:07<00:00,  3.16it/s]100%|██████████| 32/32 [00:07<00:00,  4.41it/s]
2025-03-13 12:02:28,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:28
2025-03-13 12:03:31,969 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.9262 secs
2025-03-13 12:03:31,969 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 12:03:31,970 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 12:04:04,765 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7950 secs
2025-03-13 12:04:04,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.9938 secs
2025-03-13 12:04:04,767 [INFO]: {
2025-03-13 12:04:04,767 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:04,767 [INFO]: 	index_param: efSearch=254
2025-03-13 12:04:04,768 [INFO]: 	index_path: knn.index
2025-03-13 12:04:04,768 [INFO]: 	size in bytes: 1543851190
2025-03-13 12:04:04,768 [INFO]: 	avg_search_speed_ms: 13.533649920751825
2025-03-13 12:04:04,768 [INFO]: 	99p_search_speed_ms: 21.334396391175687
2025-03-13 12:04:04,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:04,768 [INFO]: 	nb vectors: 7847
2025-03-13 12:04:04,768 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:04,768 [INFO]: 	compression ratio: 0.9993080848679464
2025-03-13 12:04:04,768 [INFO]: }
2025-03-13 12:04:04,768 [INFO]: 	>>> Finished "Creating the index" in 103.9983 secs
2025-03-13 12:04:04,768 [INFO]: >>> Finished "Launching the whole pipeline" in 104.0317 secs
2025-03-13 12:04:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 14798 [episode count 15/20]
[retrieval_preprocessing] for episode 41294 [episode count 16/20], we have num_retrieval=np.int64(7862) num_query=np.int64(464)
2025-03-13 12:04:11,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:12,786 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:12
2025-03-13 12:04:12,786 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1516.93it/s]
2025-03-13 12:04:12,811 [INFO]: There are 7862 embeddings of dim 49152
2025-03-13 12:04:12,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 12:04:12,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:12
2025-03-13 12:04:12,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:12,811 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:04:12,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:12,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:12,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:12
2025-03-13 12:04:12,811 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:12,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:04:12,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:12
2025-03-13 12:04:12,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:12,812 [INFO]: 	Creating the index 03/13/2025, 12:04:12
2025-03-13 12:04:12,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:12
2025-03-13 12:04:12,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:04:12,813 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:12
2025-03-13 12:04:12,813 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:04:12,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.69it/s] 19%|█▉        | 6/32 [00:00<00:00, 27.17it/s] 34%|███▍      | 11/32 [00:00<00:00, 36.08it/s] 50%|█████     | 16/32 [00:00<00:00, 40.76it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.30it/s] 81%|████████▏ | 26/32 [00:04<00:01,  4.91it/s] 97%|█████████▋| 31/32 [00:04<00:00,  7.00it/s]100%|██████████| 32/32 [00:06<00:00,  4.60it/s]
2025-03-13 12:04:19,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:19
2025-03-13 12:05:21,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7091 secs
2025-03-13 12:05:21,488 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 12:05:21,488 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 12:05:50,953 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4653 secs
2025-03-13 12:05:50,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.1427 secs
2025-03-13 12:05:50,956 [INFO]: {
2025-03-13 12:05:50,956 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:50,956 [INFO]: 	index_param: efSearch=191
2025-03-13 12:05:50,956 [INFO]: 	index_path: knn.index
2025-03-13 12:05:50,956 [INFO]: 	size in bytes: 1546802350
2025-03-13 12:05:50,956 [INFO]: 	avg_search_speed_ms: 8.953691073113864
2025-03-13 12:05:50,956 [INFO]: 	99p_search_speed_ms: 13.987159812822936
2025-03-13 12:05:50,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:50,956 [INFO]: 	nb vectors: 7862
2025-03-13 12:05:50,956 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:50,956 [INFO]: 	compression ratio: 0.9993080861300735
2025-03-13 12:05:50,956 [INFO]: }
2025-03-13 12:05:50,956 [INFO]: 	>>> Finished "Creating the index" in 98.1445 secs
2025-03-13 12:05:50,956 [INFO]: >>> Finished "Launching the whole pipeline" in 98.1704 secs
2025-03-13 12:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 41294 [episode count 16/20]
[retrieval_preprocessing] for episode 65273 [episode count 17/20], we have num_retrieval=np.int64(7871) num_query=np.int64(455)
2025-03-13 12:05:55,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:56,278 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:56
2025-03-13 12:05:56,278 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]
2025-03-13 12:05:56,304 [INFO]: There are 7871 embeddings of dim 49152
2025-03-13 12:05:56,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:05:56,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:56
2025-03-13 12:05:56,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:56,304 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:05:56,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:56,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:56,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:56
2025-03-13 12:05:56,305 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:56,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:05:56,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:56
2025-03-13 12:05:56,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:56,305 [INFO]: 	Creating the index 03/13/2025, 12:05:56
2025-03-13 12:05:56,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:56
2025-03-13 12:05:56,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:05:56,306 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:56
2025-03-13 12:05:56,306 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:05:56,306 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  6.91it/s] 19%|█▉        | 6/32 [00:00<00:01, 25.84it/s] 34%|███▍      | 11/32 [00:00<00:00, 34.08it/s] 50%|█████     | 16/32 [00:00<00:00, 38.46it/s] 66%|██████▌   | 21/32 [00:03<00:03,  3.51it/s] 81%|████████▏ | 26/32 [00:04<00:01,  5.21it/s] 97%|█████████▋| 31/32 [00:04<00:00,  7.44it/s]100%|██████████| 32/32 [00:06<00:00,  4.75it/s]
2025-03-13 12:06:03,041 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:03
2025-03-13 12:07:04,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7371 secs
2025-03-13 12:07:04,778 [INFO]: The best hyperparameters are: efSearch=79
2025-03-13 12:07:04,779 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 12:07:27,521 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7425 secs
2025-03-13 12:07:27,524 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2180 secs
2025-03-13 12:07:27,524 [INFO]: {
2025-03-13 12:07:27,524 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:27,524 [INFO]: 	index_param: efSearch=79
2025-03-13 12:07:27,524 [INFO]: 	index_path: knn.index
2025-03-13 12:07:27,524 [INFO]: 	size in bytes: 1548573010
2025-03-13 12:07:27,524 [INFO]: 	avg_search_speed_ms: 4.7138755089836195
2025-03-13 12:07:27,524 [INFO]: 	99p_search_speed_ms: 8.511269646696746
2025-03-13 12:07:27,524 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:27,524 [INFO]: 	nb vectors: 7871
2025-03-13 12:07:27,524 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:27,524 [INFO]: 	compression ratio: 0.9993081101161643
2025-03-13 12:07:27,524 [INFO]: }
2025-03-13 12:07:27,524 [INFO]: 	>>> Finished "Creating the index" in 91.2196 secs
2025-03-13 12:07:27,524 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2466 secs
2025-03-13 12:07:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 65273 [episode count 17/20]
[retrieval_preprocessing] for episode 71127 [episode count 18/20], we have num_retrieval=np.int64(7876) num_query=np.int64(450)
2025-03-13 12:07:30,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:31,769 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:31
2025-03-13 12:07:31,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2158.67it/s]
2025-03-13 12:07:31,793 [INFO]: There are 7876 embeddings of dim 49152
2025-03-13 12:07:31,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 12:07:31,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:31
2025-03-13 12:07:31,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:31,793 [INFO]: 		-> Add: 4.3 seconds
2025-03-13 12:07:31,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:31,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:07:31,793 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:31
2025-03-13 12:07:31,793 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:31,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:07:31,793 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:31
2025-03-13 12:07:31,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:31,793 [INFO]: 	Creating the index 03/13/2025, 12:07:31
2025-03-13 12:07:31,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:31
2025-03-13 12:07:31,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:07:31,795 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:31
2025-03-13 12:07:31,795 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 12:07:31,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.53it/s] 19%|█▉        | 6/32 [00:00<00:00, 26.96it/s] 34%|███▍      | 11/32 [00:00<00:00, 34.56it/s] 50%|█████     | 16/32 [00:00<00:00, 37.67it/s] 66%|██████▌   | 21/32 [00:04<00:03,  3.13it/s] 75%|███████▌  | 24/32 [00:04<00:02,  3.85it/s] 84%|████████▍ | 27/32 [00:04<00:01,  4.75it/s] 91%|█████████ | 29/32 [00:04<00:00,  5.46it/s]100%|██████████| 32/32 [00:07<00:00,  2.46it/s]100%|██████████| 32/32 [00:07<00:00,  4.11it/s]
2025-03-13 12:07:39,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:39
2025-03-13 12:08:39,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.8139 secs
2025-03-13 12:08:39,390 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:08:39,390 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 12:09:05,522 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1320 secs
2025-03-13 12:09:05,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.8272 secs
2025-03-13 12:09:05,622 [INFO]: {
2025-03-13 12:09:05,622 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:05,622 [INFO]: 	index_param: efSearch=218
2025-03-13 12:09:05,623 [INFO]: 	index_path: knn.index
2025-03-13 12:09:05,623 [INFO]: 	size in bytes: 1549556710
2025-03-13 12:09:05,623 [INFO]: 	avg_search_speed_ms: 10.96110361340575
2025-03-13 12:09:05,623 [INFO]: 	99p_search_speed_ms: 22.911114906892177
2025-03-13 12:09:05,623 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:05,623 [INFO]: 	nb vectors: 7876
2025-03-13 12:09:05,623 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:05,623 [INFO]: 	compression ratio: 0.9993081234180838
2025-03-13 12:09:05,623 [INFO]: }
2025-03-13 12:09:05,623 [INFO]: 	>>> Finished "Creating the index" in 93.8296 secs
2025-03-13 12:09:05,623 [INFO]: >>> Finished "Launching the whole pipeline" in 93.8538 secs
2025-03-13 12:09:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 71127 [episode count 18/20]
[retrieval_preprocessing] for episode 82905 [episode count 19/20], we have num_retrieval=np.int64(7930) num_query=np.int64(396)
2025-03-13 12:09:10,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:11,938 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:11
2025-03-13 12:09:11,938 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.46it/s]
2025-03-13 12:09:11,964 [INFO]: There are 7930 embeddings of dim 49152
2025-03-13 12:09:11,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:09:11,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,965 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:11,965 [INFO]: 		-> Add: 4.4 seconds
2025-03-13 12:09:11,965 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:11,965 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:09:11,965 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,965 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:11,965 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:09:11,965 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:11
2025-03-13 12:09:11,965 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:11,965 [INFO]: 	Creating the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,965 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:11
2025-03-13 12:09:11,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:09:11,966 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:11
2025-03-13 12:09:11,967 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-13 12:09:11,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:03,  8.48it/s] 18%|█▊        | 6/33 [00:00<00:00, 28.47it/s] 33%|███▎      | 11/33 [00:00<00:00, 35.59it/s] 48%|████▊     | 16/33 [00:00<00:00, 39.08it/s] 64%|██████▎   | 21/33 [00:04<00:03,  3.33it/s] 76%|███████▌  | 25/33 [00:04<00:01,  4.63it/s] 91%|█████████ | 30/33 [00:04<00:00,  6.77it/s]100%|██████████| 33/33 [00:07<00:00,  4.57it/s]
2025-03-13 12:09:19,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:19
2025-03-13 12:10:13,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0757 secs
2025-03-13 12:10:13,271 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 12:10:13,271 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-13 12:10:38,534 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2629 secs
2025-03-13 12:10:38,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.5704 secs
2025-03-13 12:10:38,537 [INFO]: {
2025-03-13 12:10:38,537 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:38,537 [INFO]: 	index_param: efSearch=187
2025-03-13 12:10:38,537 [INFO]: 	index_path: knn.index
2025-03-13 12:10:38,537 [INFO]: 	size in bytes: 1560180790
2025-03-13 12:10:38,537 [INFO]: 	avg_search_speed_ms: 11.263039098110738
2025-03-13 12:10:38,537 [INFO]: 	99p_search_speed_ms: 16.945338670630008
2025-03-13 12:10:38,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:38,537 [INFO]: 	nb vectors: 7930
2025-03-13 12:10:38,537 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:38,537 [INFO]: 	compression ratio: 0.9993081891490281
2025-03-13 12:10:38,537 [INFO]: }
2025-03-13 12:10:38,537 [INFO]: 	>>> Finished "Creating the index" in 86.5721 secs
2025-03-13 12:10:38,537 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5991 secs
2025-03-13 12:10:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 82905 [episode count 19/20]
2025-03-13 12:10:42: [retrieval_preprocessing] finished for 2515873443_wipe_counter_with_towel [chosen_id count 2/260]
2025-03-13 12:10:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2515873443_wipe_counter_with_cloth [chosen_id count 3/260]
2025-03-13 12:10:44: [retrieval_preprocessing] we have num_total=7270 embedding_dim=49152
[retrieval_preprocessing] for episode 59783 [episode count 0/20], we have num_retrieval=np.int64(6895) num_query=np.int64(375)
2025-03-13 12:10:45,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:45,918 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:45
2025-03-13 12:10:45,919 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2234.58it/s]
2025-03-13 12:10:46,176 [INFO]: There are 6895 embeddings of dim 49152
2025-03-13 12:10:46,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2573 secs
2025-03-13 12:10:46,176 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:46
2025-03-13 12:10:46,176 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:46,176 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:10:46,176 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:46,176 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:10:46,176 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:46
2025-03-13 12:10:46,176 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:46,176 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:10:46,176 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:46
2025-03-13 12:10:46,176 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:46,176 [INFO]: 	Creating the index 03/13/2025, 12:10:46
2025-03-13 12:10:46,176 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:46
2025-03-13 12:10:46,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:10:46,177 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:46
2025-03-13 12:10:46,177 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:10:46,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.08it/s] 21%|██        | 6/29 [00:00<00:00, 25.14it/s] 38%|███▊      | 11/29 [00:00<00:00, 33.54it/s] 55%|█████▌    | 16/29 [00:00<00:00, 38.02it/s] 72%|███████▏  | 21/29 [00:04<00:02,  3.00it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.48it/s]100%|██████████| 29/29 [00:06<00:00,  4.25it/s]
2025-03-13 12:10:52,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:52
2025-03-13 12:11:47,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8044 secs
2025-03-13 12:11:47,805 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 12:11:47,805 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.33it/s]
2025-03-13 12:12:08,994 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1890 secs
2025-03-13 12:12:08,996 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8182 secs
2025-03-13 12:12:08,996 [INFO]: {
2025-03-13 12:12:08,996 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:08,996 [INFO]: 	index_param: efSearch=264
2025-03-13 12:12:08,996 [INFO]: 	index_path: knn.index
2025-03-13 12:12:08,996 [INFO]: 	size in bytes: 1356550330
2025-03-13 12:12:08,996 [INFO]: 	avg_search_speed_ms: 11.3784695249178
2025-03-13 12:12:08,996 [INFO]: 	99p_search_speed_ms: 16.064789933152497
2025-03-13 12:12:08,996 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:08,996 [INFO]: 	nb vectors: 6895
2025-03-13 12:12:08,996 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:08,996 [INFO]: 	compression ratio: 0.9993084148967771
2025-03-13 12:12:08,996 [INFO]: }
2025-03-13 12:12:08,996 [INFO]: 	>>> Finished "Creating the index" in 82.8196 secs
2025-03-13 12:12:08,996 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0773 secs
2025-03-13 12:12:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 59783 [episode count 0/20]
[retrieval_preprocessing] for episode 62856 [episode count 1/20], we have num_retrieval=np.int64(6907) num_query=np.int64(363)
2025-03-13 12:12:13,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:14,466 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:14
2025-03-13 12:12:14,466 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 5440.08it/s]
2025-03-13 12:12:14,503 [INFO]: There are 6907 embeddings of dim 49152
2025-03-13 12:12:14,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 12:12:14,503 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:14
2025-03-13 12:12:14,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:14,504 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:12:14,504 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:14,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:12:14,504 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:14
2025-03-13 12:12:14,504 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:14,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:12:14,504 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:14
2025-03-13 12:12:14,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:14,504 [INFO]: 	Creating the index 03/13/2025, 12:12:14
2025-03-13 12:12:14,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:14
2025-03-13 12:12:14,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 12:12:14,507 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:14
2025-03-13 12:12:14,507 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:12:14,507 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.41it/s] 24%|██▍       | 7/29 [00:00<00:00, 32.69it/s] 41%|████▏     | 12/29 [00:00<00:00, 39.71it/s] 59%|█████▊    | 17/29 [00:00<00:00, 43.30it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.47it/s] 93%|█████████▎| 27/29 [00:04<00:00,  5.14it/s]100%|██████████| 29/29 [00:06<00:00,  4.77it/s]
2025-03-13 12:12:20,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:20
2025-03-13 12:13:18,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1073 secs
2025-03-13 12:13:18,701 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:13:18,701 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 12:13:40,197 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4961 secs
2025-03-13 12:13:40,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.6917 secs
2025-03-13 12:13:40,199 [INFO]: {
2025-03-13 12:13:40,199 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:40,199 [INFO]: 	index_param: efSearch=252
2025-03-13 12:13:40,199 [INFO]: 	index_path: knn.index
2025-03-13 12:13:40,199 [INFO]: 	size in bytes: 1358911270
2025-03-13 12:13:40,199 [INFO]: 	avg_search_speed_ms: 10.383464285024555
2025-03-13 12:13:40,199 [INFO]: 	99p_search_speed_ms: 16.837535304948688
2025-03-13 12:13:40,199 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:40,199 [INFO]: 	nb vectors: 6907
2025-03-13 12:13:40,199 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:40,199 [INFO]: 	compression ratio: 0.9993084066482133
2025-03-13 12:13:40,199 [INFO]: }
2025-03-13 12:13:40,199 [INFO]: 	>>> Finished "Creating the index" in 85.6946 secs
2025-03-13 12:13:40,199 [INFO]: >>> Finished "Launching the whole pipeline" in 85.7332 secs
2025-03-13 12:13:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 62856 [episode count 1/20]
[retrieval_preprocessing] for episode 69384 [episode count 2/20], we have num_retrieval=np.int64(6788) num_query=np.int64(482)
2025-03-13 12:13:44,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:45,118 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:45
2025-03-13 12:13:45,118 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.80it/s]
2025-03-13 12:13:45,143 [INFO]: There are 6788 embeddings of dim 49152
2025-03-13 12:13:45,143 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 12:13:45,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:45
2025-03-13 12:13:45,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:45,144 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:13:45,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:45,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:13:45,144 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:45
2025-03-13 12:13:45,144 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:45,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:13:45,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:45
2025-03-13 12:13:45,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:45,145 [INFO]: 	Creating the index 03/13/2025, 12:13:45
2025-03-13 12:13:45,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:45
2025-03-13 12:13:45,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:13:45,148 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:45
2025-03-13 12:13:45,148 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:13:45,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.24it/s] 21%|██▏       | 6/28 [00:00<00:00, 30.61it/s] 39%|███▉      | 11/28 [00:00<00:00, 37.38it/s] 57%|█████▋    | 16/28 [00:00<00:00, 40.50it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.35it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.99it/s]100%|██████████| 28/28 [00:06<00:00,  4.59it/s]
2025-03-13 12:13:51,248 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:51
2025-03-13 12:14:50,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2412 secs
2025-03-13 12:14:50,490 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 12:14:50,490 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-13 12:15:16,916 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4263 secs
2025-03-13 12:15:16,919 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.7703 secs
2025-03-13 12:15:16,919 [INFO]: {
2025-03-13 12:15:16,919 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:16,919 [INFO]: 	index_param: efSearch=294
2025-03-13 12:15:16,919 [INFO]: 	index_path: knn.index
2025-03-13 12:15:16,919 [INFO]: 	size in bytes: 1335498670
2025-03-13 12:15:16,919 [INFO]: 	avg_search_speed_ms: 15.454743263330396
2025-03-13 12:15:16,919 [INFO]: 	99p_search_speed_ms: 27.255798103287763
2025-03-13 12:15:16,919 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:16,919 [INFO]: 	nb vectors: 6788
2025-03-13 12:15:16,919 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:16,919 [INFO]: 	compression ratio: 0.9993084485812329
2025-03-13 12:15:16,919 [INFO]: }
2025-03-13 12:15:16,919 [INFO]: 	>>> Finished "Creating the index" in 91.7741 secs
2025-03-13 12:15:16,919 [INFO]: >>> Finished "Launching the whole pipeline" in 91.8012 secs
2025-03-13 12:15:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 69384 [episode count 2/20]
[retrieval_preprocessing] for episode 13 [episode count 3/20], we have num_retrieval=np.int64(6841) num_query=np.int64(429)
2025-03-13 12:15:23,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:24,614 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:24
2025-03-13 12:15:24,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-13 12:15:24,640 [INFO]: There are 6841 embeddings of dim 49152
2025-03-13 12:15:24,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 12:15:24,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:24
2025-03-13 12:15:24,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:24,641 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:15:24,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:24,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:24,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:24
2025-03-13 12:15:24,641 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:24,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:15:24,641 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:24
2025-03-13 12:15:24,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:24,641 [INFO]: 	Creating the index 03/13/2025, 12:15:24
2025-03-13 12:15:24,641 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:24
2025-03-13 12:15:24,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:15:24,642 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:24
2025-03-13 12:15:24,642 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:15:24,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.13it/s] 21%|██▏       | 6/28 [00:00<00:00, 27.86it/s] 43%|████▎     | 12/28 [00:00<00:00, 38.34it/s] 64%|██████▍   | 18/28 [00:00<00:00, 43.37it/s] 82%|████████▏ | 23/28 [00:04<00:01,  3.71it/s]100%|██████████| 28/28 [00:05<00:00,  3.33it/s]100%|██████████| 28/28 [00:05<00:00,  4.77it/s]
2025-03-13 12:15:30,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:30
2025-03-13 12:16:28,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8084 secs
2025-03-13 12:16:28,332 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:16:28,332 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 12:16:59,620 [INFO]: 	>>> Finished "Compute fast metrics" in 31.2873 secs
2025-03-13 12:16:59,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.9785 secs
2025-03-13 12:16:59,621 [INFO]: {
2025-03-13 12:16:59,621 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:59,621 [INFO]: 	index_param: efSearch=239
2025-03-13 12:16:59,621 [INFO]: 	index_path: knn.index
2025-03-13 12:16:59,621 [INFO]: 	size in bytes: 1345926130
2025-03-13 12:16:59,621 [INFO]: 	avg_search_speed_ms: 9.708568411065464
2025-03-13 12:16:59,621 [INFO]: 	99p_search_speed_ms: 15.864946730434895
2025-03-13 12:16:59,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:59,621 [INFO]: 	nb vectors: 6841
2025-03-13 12:16:59,621 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:59,621 [INFO]: 	compression ratio: 0.9993084300993547
2025-03-13 12:16:59,621 [INFO]: }
2025-03-13 12:16:59,621 [INFO]: 	>>> Finished "Creating the index" in 94.9801 secs
2025-03-13 12:16:59,621 [INFO]: >>> Finished "Launching the whole pipeline" in 95.0071 secs
2025-03-13 12:17:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 13 [episode count 3/20]
[retrieval_preprocessing] for episode 62747 [episode count 4/20], we have num_retrieval=np.int64(6821) num_query=np.int64(449)
2025-03-13 12:17:04,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:05,604 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:05
2025-03-13 12:17:05,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1729.61it/s]
2025-03-13 12:17:05,628 [INFO]: There are 6821 embeddings of dim 49152
2025-03-13 12:17:05,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:17:05,629 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:05
2025-03-13 12:17:05,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:05,629 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:17:05,629 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:05,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:17:05,629 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:05
2025-03-13 12:17:05,629 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:05,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:17:05,629 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:05
2025-03-13 12:17:05,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:05,629 [INFO]: 	Creating the index 03/13/2025, 12:17:05
2025-03-13 12:17:05,629 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:05
2025-03-13 12:17:05,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:17:05,630 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:05
2025-03-13 12:17:05,630 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:17:05,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.59it/s] 18%|█▊        | 5/28 [00:00<00:01, 22.15it/s] 36%|███▌      | 10/28 [00:00<00:00, 30.72it/s] 54%|█████▎    | 15/28 [00:00<00:00, 36.28it/s] 71%|███████▏  | 20/28 [00:00<00:00, 40.65it/s] 89%|████████▉ | 25/28 [00:04<00:00,  3.34it/s]100%|██████████| 28/28 [00:06<00:00,  2.70it/s]100%|██████████| 28/28 [00:06<00:00,  4.44it/s]
2025-03-13 12:17:11,939 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:11
2025-03-13 12:18:07,075 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1357 secs
2025-03-13 12:18:07,075 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 12:18:07,075 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 12:18:22,185 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1098 secs
2025-03-13 12:18:22,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5567 secs
2025-03-13 12:18:22,187 [INFO]: {
2025-03-13 12:18:22,187 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:22,187 [INFO]: 	index_param: efSearch=232
2025-03-13 12:18:22,187 [INFO]: 	index_path: knn.index
2025-03-13 12:18:22,187 [INFO]: 	size in bytes: 1341991210
2025-03-13 12:18:22,187 [INFO]: 	avg_search_speed_ms: 10.3986181205975
2025-03-13 12:18:22,187 [INFO]: 	99p_search_speed_ms: 16.112078113947064
2025-03-13 12:18:22,187 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:22,187 [INFO]: 	nb vectors: 6821
2025-03-13 12:18:22,187 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:22,187 [INFO]: 	compression ratio: 0.9993084589577901
2025-03-13 12:18:22,187 [INFO]: }
2025-03-13 12:18:22,187 [INFO]: 	>>> Finished "Creating the index" in 76.5580 secs
2025-03-13 12:18:22,187 [INFO]: >>> Finished "Launching the whole pipeline" in 76.5835 secs
2025-03-13 12:18:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 62747 [episode count 4/20]
[retrieval_preprocessing] for episode 11933 [episode count 5/20], we have num_retrieval=np.int64(6922) num_query=np.int64(348)
2025-03-13 12:18:27,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:28,717 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:28
2025-03-13 12:18:28,717 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1087.45it/s]
2025-03-13 12:18:28,745 [INFO]: There are 6922 embeddings of dim 49152
2025-03-13 12:18:28,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:18:28,746 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:28
2025-03-13 12:18:28,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:28,746 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:18:28,746 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:28,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:18:28,747 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:28
2025-03-13 12:18:28,747 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:28,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:18:28,747 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:28
2025-03-13 12:18:28,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:28,748 [INFO]: 	Creating the index 03/13/2025, 12:18:28
2025-03-13 12:18:28,748 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:28
2025-03-13 12:18:28,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:18:28,751 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:28
2025-03-13 12:18:28,751 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:18:28,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 17.28it/s] 24%|██▍       | 7/29 [00:00<00:00, 35.29it/s] 45%|████▍     | 13/29 [00:00<00:00, 42.60it/s] 62%|██████▏   | 18/29 [00:00<00:00, 45.22it/s] 79%|███████▉  | 23/29 [00:04<00:01,  3.27it/s] 97%|█████████▋| 28/29 [00:04<00:00,  4.80it/s]100%|██████████| 29/29 [00:06<00:00,  4.39it/s]
2025-03-13 12:18:35,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:35
2025-03-13 12:19:30,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3397 secs
2025-03-13 12:19:30,705 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 12:19:30,705 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-13 12:19:48,655 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9500 secs
2025-03-13 12:19:48,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.9055 secs
2025-03-13 12:19:48,657 [INFO]: {
2025-03-13 12:19:48,657 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:48,657 [INFO]: 	index_param: efSearch=241
2025-03-13 12:19:48,657 [INFO]: 	index_path: knn.index
2025-03-13 12:19:48,657 [INFO]: 	size in bytes: 1361862550
2025-03-13 12:19:48,657 [INFO]: 	avg_search_speed_ms: 10.116838821595115
2025-03-13 12:19:48,657 [INFO]: 	99p_search_speed_ms: 16.256614290177822
2025-03-13 12:19:48,657 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:48,657 [INFO]: 	nb vectors: 6922
2025-03-13 12:19:48,657 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:48,657 [INFO]: 	compression ratio: 0.9993083193307577
2025-03-13 12:19:48,657 [INFO]: }
2025-03-13 12:19:48,657 [INFO]: 	>>> Finished "Creating the index" in 79.9094 secs
2025-03-13 12:19:48,657 [INFO]: >>> Finished "Launching the whole pipeline" in 79.9404 secs
2025-03-13 12:19:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 11933 [episode count 5/20]
[retrieval_preprocessing] for episode 17054 [episode count 6/20], we have num_retrieval=np.int64(6942) num_query=np.int64(328)
2025-03-13 12:19:53,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:54,478 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:54
2025-03-13 12:19:54,478 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.94it/s]
2025-03-13 12:19:54,509 [INFO]: There are 6942 embeddings of dim 49152
2025-03-13 12:19:54,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:19:54,509 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:54
2025-03-13 12:19:54,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:54,509 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:19:54,509 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:54,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:19:54,509 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:54
2025-03-13 12:19:54,509 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:54,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:19:54,510 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:54
2025-03-13 12:19:54,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:54,510 [INFO]: 	Creating the index 03/13/2025, 12:19:54
2025-03-13 12:19:54,510 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:54
2025-03-13 12:19:54,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:19:54,512 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:54
2025-03-13 12:19:54,512 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:19:54,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.52it/s] 24%|██▍       | 7/29 [00:00<00:00, 33.49it/s] 41%|████▏     | 12/29 [00:00<00:00, 38.83it/s] 59%|█████▊    | 17/29 [00:00<00:00, 41.01it/s] 76%|███████▌  | 22/29 [00:04<00:02,  3.22it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.80it/s]100%|██████████| 29/29 [00:06<00:00,  4.57it/s]
2025-03-13 12:20:00,864 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:00
2025-03-13 12:21:03,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.4203 secs
2025-03-13 12:21:03,286 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:21:03,286 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 12:21:21,364 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0781 secs
2025-03-13 12:21:21,365 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.8537 secs
2025-03-13 12:21:21,366 [INFO]: {
2025-03-13 12:21:21,366 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:21,366 [INFO]: 	index_param: efSearch=208
2025-03-13 12:21:21,366 [INFO]: 	index_path: knn.index
2025-03-13 12:21:21,366 [INFO]: 	size in bytes: 1365797410
2025-03-13 12:21:21,366 [INFO]: 	avg_search_speed_ms: 8.833472201906725
2025-03-13 12:21:21,366 [INFO]: 	99p_search_speed_ms: 13.319513411261145
2025-03-13 12:21:21,366 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:21,366 [INFO]: 	nb vectors: 6942
2025-03-13 12:21:21,366 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:21,366 [INFO]: 	compression ratio: 0.999308335194456
2025-03-13 12:21:21,366 [INFO]: }
2025-03-13 12:21:21,366 [INFO]: 	>>> Finished "Creating the index" in 86.8560 secs
2025-03-13 12:21:21,366 [INFO]: >>> Finished "Launching the whole pipeline" in 86.8876 secs
2025-03-13 12:21:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 17054 [episode count 6/20]
[retrieval_preprocessing] for episode 57373 [episode count 7/20], we have num_retrieval=np.int64(6966) num_query=np.int64(304)
2025-03-13 12:21:24,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:25,385 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:25
2025-03-13 12:21:25,385 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-13 12:21:25,408 [INFO]: There are 6966 embeddings of dim 49152
2025-03-13 12:21:25,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 12:21:25,408 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:25,408 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:21:25,408 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:25,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:25,408 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,408 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:25,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:25,409 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:25
2025-03-13 12:21:25,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:25,409 [INFO]: 	Creating the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,409 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:25
2025-03-13 12:21:25,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:21:25,410 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:25
2025-03-13 12:21:25,410 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:21:25,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.75it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.86it/s] 34%|███▍      | 10/29 [00:00<00:00, 35.14it/s] 52%|█████▏    | 15/29 [00:00<00:00, 39.77it/s] 69%|██████▉   | 20/29 [00:00<00:00, 42.40it/s] 86%|████████▌ | 25/29 [00:04<00:01,  3.39it/s]100%|██████████| 29/29 [00:06<00:00,  2.98it/s]100%|██████████| 29/29 [00:06<00:00,  4.72it/s]
2025-03-13 12:21:31,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:31
2025-03-13 12:22:30,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5183 secs
2025-03-13 12:22:30,233 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 12:22:30,233 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 12:23:00,743 [INFO]: 	>>> Finished "Compute fast metrics" in 30.5093 secs
2025-03-13 12:23:00,744 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.3341 secs
2025-03-13 12:23:00,744 [INFO]: {
2025-03-13 12:23:00,744 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:00,744 [INFO]: 	index_param: efSearch=269
2025-03-13 12:23:00,744 [INFO]: 	index_path: knn.index
2025-03-13 12:23:00,744 [INFO]: 	size in bytes: 1370519290
2025-03-13 12:23:00,744 [INFO]: 	avg_search_speed_ms: 10.799304676970333
2025-03-13 12:23:00,744 [INFO]: 	99p_search_speed_ms: 25.453076523263007
2025-03-13 12:23:00,744 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:00,744 [INFO]: 	nb vectors: 6966
2025-03-13 12:23:00,744 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:00,744 [INFO]: 	compression ratio: 0.9993083191116559
2025-03-13 12:23:00,744 [INFO]: }
2025-03-13 12:23:00,744 [INFO]: 	>>> Finished "Creating the index" in 95.3355 secs
2025-03-13 12:23:00,744 [INFO]: >>> Finished "Launching the whole pipeline" in 95.3597 secs
2025-03-13 12:23:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 57373 [episode count 7/20]
[retrieval_preprocessing] for episode 7712 [episode count 8/20], we have num_retrieval=np.int64(6916) num_query=np.int64(354)
2025-03-13 12:23:05,306 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:06,492 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:06
2025-03-13 12:23:06,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.50it/s]
2025-03-13 12:23:06,525 [INFO]: There are 6916 embeddings of dim 49152
2025-03-13 12:23:06,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 12:23:06,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:06,526 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:23:06,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:06,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:23:06,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,527 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:06,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:23:06,528 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:06
2025-03-13 12:23:06,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:06,528 [INFO]: 	Creating the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,528 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:06
2025-03-13 12:23:06,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:23:06,531 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:06
2025-03-13 12:23:06,531 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:23:06,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:02,  9.77it/s] 21%|██        | 6/29 [00:00<00:00, 30.49it/s] 38%|███▊      | 11/29 [00:00<00:00, 36.27it/s] 55%|█████▌    | 16/29 [00:00<00:00, 39.67it/s] 72%|███████▏  | 21/29 [00:04<00:02,  2.91it/s] 90%|████████▉ | 26/29 [00:04<00:00,  4.34it/s]100%|██████████| 29/29 [00:07<00:00,  3.84it/s]
2025-03-13 12:23:14,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:14
2025-03-13 12:24:16,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.0975 secs
2025-03-13 12:24:16,197 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 12:24:16,197 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 12:24:34,078 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8808 secs
2025-03-13 12:24:34,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5485 secs
2025-03-13 12:24:34,080 [INFO]: {
2025-03-13 12:24:34,080 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:34,080 [INFO]: 	index_param: efSearch=242
2025-03-13 12:24:34,080 [INFO]: 	index_path: knn.index
2025-03-13 12:24:34,080 [INFO]: 	size in bytes: 1360682050
2025-03-13 12:24:34,080 [INFO]: 	avg_search_speed_ms: 11.595175739136003
2025-03-13 12:24:34,080 [INFO]: 	99p_search_speed_ms: 20.540049569681287
2025-03-13 12:24:34,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:34,080 [INFO]: 	nb vectors: 6916
2025-03-13 12:24:34,080 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:34,080 [INFO]: 	compression ratio: 0.9993083453992797
2025-03-13 12:24:34,080 [INFO]: }
2025-03-13 12:24:34,080 [INFO]: 	>>> Finished "Creating the index" in 87.5523 secs
2025-03-13 12:24:34,080 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5884 secs
2025-03-13 12:24:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 7712 [episode count 8/20]
[retrieval_preprocessing] for episode 18213 [episode count 9/20], we have num_retrieval=np.int64(6977) num_query=np.int64(293)
2025-03-13 12:24:38,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:39,855 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:39
2025-03-13 12:24:39,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.77it/s]
2025-03-13 12:24:39,880 [INFO]: There are 6977 embeddings of dim 49152
2025-03-13 12:24:39,880 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 12:24:39,880 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:39
2025-03-13 12:24:39,880 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:39,880 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:24:39,880 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:39,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:24:39,880 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:39
2025-03-13 12:24:39,880 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:39,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:24:39,880 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:39
2025-03-13 12:24:39,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:39,880 [INFO]: 	Creating the index 03/13/2025, 12:24:39
2025-03-13 12:24:39,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:39
2025-03-13 12:24:39,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:24:39,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:39
2025-03-13 12:24:39,882 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:24:39,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.59it/s] 24%|██▍       | 7/29 [00:00<00:00, 31.89it/s] 45%|████▍     | 13/29 [00:00<00:00, 40.69it/s] 66%|██████▌   | 19/29 [00:00<00:00, 45.04it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.86it/s]100%|██████████| 29/29 [00:05<00:00,  3.33it/s]100%|██████████| 29/29 [00:05<00:00,  4.89it/s]
2025-03-13 12:24:45,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:45
2025-03-13 12:25:48,126 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.3071 secs
2025-03-13 12:25:48,126 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 12:25:48,126 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 12:26:10,735 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6084 secs
2025-03-13 12:26:10,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8549 secs
2025-03-13 12:26:10,737 [INFO]: {
2025-03-13 12:26:10,737 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:10,737 [INFO]: 	index_param: efSearch=178
2025-03-13 12:26:10,737 [INFO]: 	index_path: knn.index
2025-03-13 12:26:10,737 [INFO]: 	size in bytes: 1372683430
2025-03-13 12:26:10,737 [INFO]: 	avg_search_speed_ms: 9.322994282097666
2025-03-13 12:26:10,737 [INFO]: 	99p_search_speed_ms: 15.170266125351189
2025-03-13 12:26:10,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:10,737 [INFO]: 	nb vectors: 6977
2025-03-13 12:26:10,737 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:10,737 [INFO]: 	compression ratio: 0.9993083518171411
2025-03-13 12:26:10,737 [INFO]: }
2025-03-13 12:26:10,737 [INFO]: 	>>> Finished "Creating the index" in 90.8566 secs
2025-03-13 12:26:10,737 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8817 secs
2025-03-13 12:26:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 18213 [episode count 9/20]
[retrieval_preprocessing] for episode 18469 [episode count 10/20], we have num_retrieval=np.int64(6651) num_query=np.int64(619)
2025-03-13 12:26:13,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:15,428 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:15
2025-03-13 12:26:15,428 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 945.73it/s]
2025-03-13 12:26:15,453 [INFO]: There are 6651 embeddings of dim 49152
2025-03-13 12:26:15,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 12:26:15,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:15
2025-03-13 12:26:15,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:15,454 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 12:26:15,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:15,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:15,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:15
2025-03-13 12:26:15,454 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:15,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:26:15,454 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:15
2025-03-13 12:26:15,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:15,454 [INFO]: 	Creating the index 03/13/2025, 12:26:15
2025-03-13 12:26:15,454 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:15
2025-03-13 12:26:15,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:26:15,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:15
2025-03-13 12:26:15,455 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 12:26:15,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.30it/s] 21%|██▏       | 6/28 [00:00<00:00, 24.22it/s] 39%|███▉      | 11/28 [00:00<00:00, 31.47it/s] 57%|█████▋    | 16/28 [00:00<00:00, 35.62it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.43it/s] 93%|█████████▎| 26/28 [00:04<00:00,  5.12it/s]100%|██████████| 28/28 [00:05<00:00,  4.90it/s]
2025-03-13 12:26:21,174 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:21
2025-03-13 12:27:18,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9302 secs
2025-03-13 12:27:18,105 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:27:18,105 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 12:27:48,711 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6060 secs
2025-03-13 12:27:49,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.7689 secs
2025-03-13 12:27:49,224 [INFO]: {
2025-03-13 12:27:49,225 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:49,225 [INFO]: 	index_param: efSearch=239
2025-03-13 12:27:49,225 [INFO]: 	index_path: knn.index
2025-03-13 12:27:49,225 [INFO]: 	size in bytes: 1308544870
2025-03-13 12:27:49,225 [INFO]: 	avg_search_speed_ms: 10.845657490508657
2025-03-13 12:27:49,225 [INFO]: 	99p_search_speed_ms: 19.937728969380256
2025-03-13 12:27:49,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:49,225 [INFO]: 	nb vectors: 6651
2025-03-13 12:27:49,225 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:49,225 [INFO]: 	compression ratio: 0.9993083446958911
2025-03-13 12:27:49,225 [INFO]: }
2025-03-13 12:27:49,225 [INFO]: 	>>> Finished "Creating the index" in 93.7712 secs
2025-03-13 12:27:49,225 [INFO]: >>> Finished "Launching the whole pipeline" in 93.7975 secs
2025-03-13 12:27:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 18469 [episode count 10/20]
[retrieval_preprocessing] for episode 34343 [episode count 11/20], we have num_retrieval=np.int64(6926) num_query=np.int64(344)
2025-03-13 12:27:55,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:56,326 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:56
2025-03-13 12:27:56,326 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1614.44it/s]
2025-03-13 12:27:56,350 [INFO]: There are 6926 embeddings of dim 49152
2025-03-13 12:27:56,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:27:56,350 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:56
2025-03-13 12:27:56,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:56,350 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:27:56,350 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:56,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:27:56,350 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:56
2025-03-13 12:27:56,350 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:56,350 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:27:56,350 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:56
2025-03-13 12:27:56,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:56,350 [INFO]: 	Creating the index 03/13/2025, 12:27:56
2025-03-13 12:27:56,351 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:56
2025-03-13 12:27:56,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:27:56,352 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:56
2025-03-13 12:27:56,352 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:27:56,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.23it/s] 24%|██▍       | 7/29 [00:00<00:00, 33.65it/s] 45%|████▍     | 13/29 [00:00<00:00, 42.75it/s] 66%|██████▌   | 19/29 [00:00<00:00, 47.20it/s] 83%|████████▎ | 24/29 [00:03<00:01,  4.00it/s]100%|██████████| 29/29 [00:05<00:00,  3.41it/s]100%|██████████| 29/29 [00:05<00:00,  5.02it/s]
2025-03-13 12:28:02,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:02
2025-03-13 12:29:00,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0603 secs
2025-03-13 12:29:00,190 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 12:29:00,190 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 12:29:34,222 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0313 secs
2025-03-13 12:29:34,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.8727 secs
2025-03-13 12:29:34,225 [INFO]: {
2025-03-13 12:29:34,225 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:34,225 [INFO]: 	index_param: efSearch=256
2025-03-13 12:29:34,225 [INFO]: 	index_path: knn.index
2025-03-13 12:29:34,225 [INFO]: 	size in bytes: 1362649510
2025-03-13 12:29:34,225 [INFO]: 	avg_search_speed_ms: 11.388328685881337
2025-03-13 12:29:34,225 [INFO]: 	99p_search_speed_ms: 17.657199702225626
2025-03-13 12:29:34,225 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:34,225 [INFO]: 	nb vectors: 6926
2025-03-13 12:29:34,225 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:34,225 [INFO]: 	compression ratio: 0.9993083313111087
2025-03-13 12:29:34,225 [INFO]: }
2025-03-13 12:29:34,225 [INFO]: 	>>> Finished "Creating the index" in 97.8743 secs
2025-03-13 12:29:34,225 [INFO]: >>> Finished "Launching the whole pipeline" in 97.8989 secs
2025-03-13 12:29:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 34343 [episode count 11/20]
[retrieval_preprocessing] for episode 1345 [episode count 12/20], we have num_retrieval=np.int64(6929) num_query=np.int64(341)
2025-03-13 12:29:39,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:40,171 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:40
2025-03-13 12:29:40,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-13 12:29:40,201 [INFO]: There are 6929 embeddings of dim 49152
2025-03-13 12:29:40,202 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 12:29:40,202 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:40
2025-03-13 12:29:40,202 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:40,203 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:29:40,203 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:40,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:29:40,203 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:40
2025-03-13 12:29:40,204 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:40,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:29:40,204 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:40
2025-03-13 12:29:40,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:40,204 [INFO]: 	Creating the index 03/13/2025, 12:29:40
2025-03-13 12:29:40,204 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:40
2025-03-13 12:29:40,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:29:40,207 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:40
2025-03-13 12:29:40,208 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:29:40,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:01, 16.89it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.54it/s] 41%|████▏     | 12/29 [00:00<00:00, 41.02it/s] 59%|█████▊    | 17/29 [00:00<00:00, 44.22it/s] 76%|███████▌  | 22/29 [00:03<00:01,  3.60it/s] 93%|█████████▎| 27/29 [00:03<00:00,  5.35it/s]100%|██████████| 29/29 [00:05<00:00,  5.00it/s]
2025-03-13 12:29:46,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:46
2025-03-13 12:30:50,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.1646 secs
2025-03-13 12:30:50,179 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:30:50,179 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.53it/s]
2025-03-13 12:31:09,526 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3472 secs
2025-03-13 12:31:09,528 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.3200 secs
2025-03-13 12:31:09,528 [INFO]: {
2025-03-13 12:31:09,528 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:09,528 [INFO]: 	index_param: efSearch=204
2025-03-13 12:31:09,528 [INFO]: 	index_path: knn.index
2025-03-13 12:31:09,528 [INFO]: 	size in bytes: 1363239730
2025-03-13 12:31:09,528 [INFO]: 	avg_search_speed_ms: 8.859809606845026
2025-03-13 12:31:09,528 [INFO]: 	99p_search_speed_ms: 15.452364832162859
2025-03-13 12:31:09,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:09,528 [INFO]: 	nb vectors: 6929
2025-03-13 12:31:09,528 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:09,528 [INFO]: 	compression ratio: 0.9993083402872949
2025-03-13 12:31:09,528 [INFO]: }
2025-03-13 12:31:09,528 [INFO]: 	>>> Finished "Creating the index" in 89.3236 secs
2025-03-13 12:31:09,528 [INFO]: >>> Finished "Launching the whole pipeline" in 89.3563 secs
2025-03-13 12:31:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 1345 [episode count 12/20]
[retrieval_preprocessing] for episode 16454 [episode count 13/20], we have num_retrieval=np.int64(7006) num_query=np.int64(264)
2025-03-13 12:31:12,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:14,162 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:14
2025-03-13 12:31:14,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 12:31:14,188 [INFO]: There are 7006 embeddings of dim 49152
2025-03-13 12:31:14,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 12:31:14,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:14,188 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:31:14,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:14,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:31:14,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,189 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:14,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:31:14,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:14
2025-03-13 12:31:14,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:14,189 [INFO]: 	Creating the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:14
2025-03-13 12:31:14,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:31:14,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:14
2025-03-13 12:31:14,190 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:31:14,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.80it/s] 17%|█▋        | 5/29 [00:00<00:00, 25.76it/s] 34%|███▍      | 10/29 [00:00<00:00, 35.59it/s] 52%|█████▏    | 15/29 [00:00<00:00, 40.39it/s] 69%|██████▉   | 20/29 [00:00<00:00, 43.09it/s] 86%|████████▌ | 25/29 [00:04<00:01,  3.40it/s]100%|██████████| 29/29 [00:06<00:00,  2.83it/s]100%|██████████| 29/29 [00:06<00:00,  4.55it/s]
2025-03-13 12:31:20,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:20
2025-03-13 12:32:13,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.8745 secs
2025-03-13 12:32:13,438 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 12:32:13,438 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-13 12:32:30,477 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0387 secs
2025-03-13 12:32:30,478 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2882 secs
2025-03-13 12:32:30,478 [INFO]: {
2025-03-13 12:32:30,478 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:30,478 [INFO]: 	index_param: efSearch=265
2025-03-13 12:32:30,478 [INFO]: 	index_path: knn.index
2025-03-13 12:32:30,478 [INFO]: 	size in bytes: 1378389130
2025-03-13 12:32:30,478 [INFO]: 	avg_search_speed_ms: 10.410607240039711
2025-03-13 12:32:30,478 [INFO]: 	99p_search_speed_ms: 17.06215771846473
2025-03-13 12:32:30,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:30,478 [INFO]: 	nb vectors: 7006
2025-03-13 12:32:30,478 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:30,478 [INFO]: 	compression ratio: 0.9993082635525427
2025-03-13 12:32:30,478 [INFO]: }
2025-03-13 12:32:30,478 [INFO]: 	>>> Finished "Creating the index" in 76.2896 secs
2025-03-13 12:32:30,478 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3160 secs
2025-03-13 12:32:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 16454 [episode count 13/20]
[retrieval_preprocessing] for episode 19922 [episode count 14/20], we have num_retrieval=np.int64(6998) num_query=np.int64(272)
2025-03-13 12:32:33,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:34,856 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:34
2025-03-13 12:32:34,856 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1857.53it/s]
2025-03-13 12:32:34,879 [INFO]: There are 6998 embeddings of dim 49152
2025-03-13 12:32:34,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 12:32:34,879 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:34
2025-03-13 12:32:34,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:34,879 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:32:34,879 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:34,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:34,879 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:34
2025-03-13 12:32:34,879 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:34,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:34,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:34
2025-03-13 12:32:34,880 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:34,880 [INFO]: 	Creating the index 03/13/2025, 12:32:34
2025-03-13 12:32:34,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:34
2025-03-13 12:32:34,881 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:32:34,881 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:34
2025-03-13 12:32:34,881 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:32:34,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.84it/s] 24%|██▍       | 7/29 [00:00<00:00, 32.19it/s] 45%|████▍     | 13/29 [00:00<00:00, 40.68it/s] 66%|██████▌   | 19/29 [00:00<00:00, 44.73it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.50it/s]100%|██████████| 29/29 [00:06<00:00,  3.12it/s]100%|██████████| 29/29 [00:06<00:00,  4.56it/s]
2025-03-13 12:32:41,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:41
2025-03-13 12:33:40,390 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1459 secs
2025-03-13 12:33:40,390 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:33:40,390 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 12:34:06,565 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1746 secs
2025-03-13 12:34:06,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6857 secs
2025-03-13 12:34:06,566 [INFO]: {
2025-03-13 12:34:06,566 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:06,566 [INFO]: 	index_param: efSearch=266
2025-03-13 12:34:06,566 [INFO]: 	index_path: knn.index
2025-03-13 12:34:06,566 [INFO]: 	size in bytes: 1376815150
2025-03-13 12:34:06,567 [INFO]: 	avg_search_speed_ms: 10.989924067641597
2025-03-13 12:34:06,567 [INFO]: 	99p_search_speed_ms: 16.84695535106584
2025-03-13 12:34:06,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:06,567 [INFO]: 	nb vectors: 6998
2025-03-13 12:34:06,567 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:06,567 [INFO]: 	compression ratio: 0.9993082833232915
2025-03-13 12:34:06,567 [INFO]: }
2025-03-13 12:34:06,567 [INFO]: 	>>> Finished "Creating the index" in 91.6870 secs
2025-03-13 12:34:06,567 [INFO]: >>> Finished "Launching the whole pipeline" in 91.7109 secs
2025-03-13 12:34:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 19922 [episode count 14/20]
[retrieval_preprocessing] for episode 92118 [episode count 15/20], we have num_retrieval=np.int64(6911) num_query=np.int64(359)
2025-03-13 12:34:10,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:11,412 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:11
2025-03-13 12:34:11,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.80it/s]
2025-03-13 12:34:11,440 [INFO]: There are 6911 embeddings of dim 49152
2025-03-13 12:34:11,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:34:11,441 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:11
2025-03-13 12:34:11,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:11,441 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:34:11,441 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:11,441 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:11,441 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:11
2025-03-13 12:34:11,441 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:11,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:34:11,441 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:11
2025-03-13 12:34:11,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:11,441 [INFO]: 	Creating the index 03/13/2025, 12:34:11
2025-03-13 12:34:11,441 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:11
2025-03-13 12:34:11,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:34:11,443 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:11
2025-03-13 12:34:11,443 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:34:11,443 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.28it/s] 24%|██▍       | 7/29 [00:00<00:00, 31.29it/s] 45%|████▍     | 13/29 [00:00<00:00, 40.22it/s] 62%|██████▏   | 18/29 [00:00<00:00, 43.30it/s] 79%|███████▉  | 23/29 [00:04<00:01,  3.15it/s] 93%|█████████▎| 27/29 [00:04<00:00,  4.32it/s]100%|██████████| 29/29 [00:06<00:00,  4.34it/s]
2025-03-13 12:34:18,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:18
2025-03-13 12:35:10,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2468 secs
2025-03-13 12:35:10,379 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:35:10,379 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-13 12:35:32,669 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2897 secs
2025-03-13 12:35:32,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2280 secs
2025-03-13 12:35:32,671 [INFO]: {
2025-03-13 12:35:32,671 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:32,671 [INFO]: 	index_param: efSearch=235
2025-03-13 12:35:32,671 [INFO]: 	index_path: knn.index
2025-03-13 12:35:32,671 [INFO]: 	size in bytes: 1359698230
2025-03-13 12:35:32,671 [INFO]: 	avg_search_speed_ms: 10.141452465775002
2025-03-13 12:35:32,671 [INFO]: 	99p_search_speed_ms: 19.600105832796544
2025-03-13 12:35:32,671 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:32,671 [INFO]: 	nb vectors: 6911
2025-03-13 12:35:32,671 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:32,671 [INFO]: 	compression ratio: 0.999308418604031
2025-03-13 12:35:32,671 [INFO]: }
2025-03-13 12:35:32,671 [INFO]: 	>>> Finished "Creating the index" in 81.2300 secs
2025-03-13 12:35:32,671 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2591 secs
2025-03-13 12:35:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 92118 [episode count 15/20]
[retrieval_preprocessing] for episode 59227 [episode count 16/20], we have num_retrieval=np.int64(6934) num_query=np.int64(336)
2025-03-13 12:35:38,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:39,208 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:39
2025-03-13 12:35:39,208 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.99it/s]
2025-03-13 12:35:39,236 [INFO]: There are 6934 embeddings of dim 49152
2025-03-13 12:35:39,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 12:35:39,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:39
2025-03-13 12:35:39,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:39,236 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:35:39,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:39,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:35:39,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:39
2025-03-13 12:35:39,236 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:39,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:35:39,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:39
2025-03-13 12:35:39,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:39,237 [INFO]: 	Creating the index 03/13/2025, 12:35:39
2025-03-13 12:35:39,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:39
2025-03-13 12:35:39,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:35:39,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:39
2025-03-13 12:35:39,238 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:35:39,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.37it/s] 24%|██▍       | 7/29 [00:00<00:00, 34.70it/s] 45%|████▍     | 13/29 [00:00<00:00, 44.01it/s] 66%|██████▌   | 19/29 [00:00<00:00, 48.53it/s] 83%|████████▎ | 24/29 [00:04<00:01,  3.80it/s]100%|██████████| 29/29 [00:05<00:00,  3.30it/s]100%|██████████| 29/29 [00:05<00:00,  4.86it/s]
2025-03-13 12:35:45,215 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:45
2025-03-13 12:36:40,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6806 secs
2025-03-13 12:36:40,896 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 12:36:40,896 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.01it/s]
2025-03-13 12:37:08,159 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2634 secs
2025-03-13 12:37:08,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.9230 secs
2025-03-13 12:37:08,161 [INFO]: {
2025-03-13 12:37:08,161 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:08,161 [INFO]: 	index_param: efSearch=237
2025-03-13 12:37:08,161 [INFO]: 	index_path: knn.index
2025-03-13 12:37:08,161 [INFO]: 	size in bytes: 1364223430
2025-03-13 12:37:08,161 [INFO]: 	avg_search_speed_ms: 9.756401989427282
2025-03-13 12:37:08,161 [INFO]: 	99p_search_speed_ms: 16.25460594892502
2025-03-13 12:37:08,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:08,161 [INFO]: 	nb vectors: 6934
2025-03-13 12:37:08,161 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:08,161 [INFO]: 	compression ratio: 0.9993083552303452
2025-03-13 12:37:08,161 [INFO]: }
2025-03-13 12:37:08,161 [INFO]: 	>>> Finished "Creating the index" in 88.9248 secs
2025-03-13 12:37:08,161 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9530 secs
2025-03-13 12:37:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 59227 [episode count 16/20]
[retrieval_preprocessing] for episode 32092 [episode count 17/20], we have num_retrieval=np.int64(6840) num_query=np.int64(430)
2025-03-13 12:37:12,149 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:13,083 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:13
2025-03-13 12:37:13,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1970.08it/s]
2025-03-13 12:37:13,107 [INFO]: There are 6840 embeddings of dim 49152
2025-03-13 12:37:13,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 12:37:13,107 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:13
2025-03-13 12:37:13,107 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:13,108 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:37:13,108 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:13,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:13,108 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:13
2025-03-13 12:37:13,108 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:13,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:37:13,108 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:13
2025-03-13 12:37:13,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:13,108 [INFO]: 	Creating the index 03/13/2025, 12:37:13
2025-03-13 12:37:13,108 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:13
2025-03-13 12:37:13,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:37:13,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:13
2025-03-13 12:37:13,109 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:37:13,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.71it/s] 21%|██▏       | 6/28 [00:00<00:00, 25.41it/s] 39%|███▉      | 11/28 [00:00<00:00, 32.26it/s] 57%|█████▋    | 16/28 [00:00<00:00, 35.05it/s] 71%|███████▏  | 20/28 [00:00<00:00, 35.70it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.60it/s]100%|██████████| 28/28 [00:07<00:00,  2.26it/s]100%|██████████| 28/28 [00:07<00:00,  3.78it/s]
2025-03-13 12:37:20,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:20
2025-03-13 12:38:14,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.4985 secs
2025-03-13 12:38:14,014 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:38:14,014 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-13 12:38:39,584 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5694 secs
2025-03-13 12:38:39,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.4761 secs
2025-03-13 12:38:39,585 [INFO]: {
2025-03-13 12:38:39,585 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:39,585 [INFO]: 	index_param: efSearch=207
2025-03-13 12:38:39,585 [INFO]: 	index_path: knn.index
2025-03-13 12:38:39,585 [INFO]: 	size in bytes: 1345729390
2025-03-13 12:38:39,586 [INFO]: 	avg_search_speed_ms: 8.966953365347518
2025-03-13 12:38:39,586 [INFO]: 	99p_search_speed_ms: 13.951549236662686
2025-03-13 12:38:39,586 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:39,586 [INFO]: 	nb vectors: 6840
2025-03-13 12:38:39,586 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:39,586 [INFO]: 	compression ratio: 0.999308427082803
2025-03-13 12:38:39,586 [INFO]: }
2025-03-13 12:38:39,586 [INFO]: 	>>> Finished "Creating the index" in 86.4777 secs
2025-03-13 12:38:39,586 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5021 secs
2025-03-13 12:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 32092 [episode count 17/20]
[retrieval_preprocessing] for episode 57185 [episode count 18/20], we have num_retrieval=np.int64(6977) num_query=np.int64(293)
2025-03-13 12:38:43,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:44,284 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:44
2025-03-13 12:38:44,284 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.03it/s]
2025-03-13 12:38:44,311 [INFO]: There are 6977 embeddings of dim 49152
2025-03-13 12:38:44,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 12:38:44,311 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:44
2025-03-13 12:38:44,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:44,311 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:38:44,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:44,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:38:44,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:44
2025-03-13 12:38:44,311 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:44,312 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:38:44,312 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:44
2025-03-13 12:38:44,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:44,312 [INFO]: 	Creating the index 03/13/2025, 12:38:44
2025-03-13 12:38:44,312 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:44
2025-03-13 12:38:44,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:38:44,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:44
2025-03-13 12:38:44,313 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:38:44,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.97it/s] 21%|██        | 6/29 [00:00<00:00, 27.65it/s] 38%|███▊      | 11/29 [00:00<00:00, 36.09it/s] 55%|█████▌    | 16/29 [00:00<00:00, 40.58it/s] 72%|███████▏  | 21/29 [00:03<00:02,  3.63it/s] 83%|████████▎ | 24/29 [00:04<00:01,  4.51it/s] 93%|█████████▎| 27/29 [00:04<00:00,  5.55it/s]100%|██████████| 29/29 [00:06<00:00,  4.47it/s]
2025-03-13 12:38:50,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:50
2025-03-13 12:39:56,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.0288 secs
2025-03-13 12:39:56,841 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 12:39:56,841 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.58it/s]
2025-03-13 12:40:35,992 [INFO]: 	>>> Finished "Compute fast metrics" in 39.1503 secs
2025-03-13 12:40:35,994 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.6812 secs
2025-03-13 12:40:35,995 [INFO]: {
2025-03-13 12:40:35,995 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:35,995 [INFO]: 	index_param: efSearch=206
2025-03-13 12:40:35,995 [INFO]: 	index_path: knn.index
2025-03-13 12:40:35,995 [INFO]: 	size in bytes: 1372683430
2025-03-13 12:40:35,995 [INFO]: 	avg_search_speed_ms: 10.174683066623121
2025-03-13 12:40:35,995 [INFO]: 	99p_search_speed_ms: 18.08810164686292
2025-03-13 12:40:35,995 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:35,995 [INFO]: 	nb vectors: 6977
2025-03-13 12:40:35,995 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:35,995 [INFO]: 	compression ratio: 0.9993083518171411
2025-03-13 12:40:35,995 [INFO]: }
2025-03-13 12:40:35,995 [INFO]: 	>>> Finished "Creating the index" in 111.6833 secs
2025-03-13 12:40:35,995 [INFO]: >>> Finished "Launching the whole pipeline" in 111.7110 secs
2025-03-13 12:40:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 57185 [episode count 18/20]
[retrieval_preprocessing] for episode 6117 [episode count 19/20], we have num_retrieval=np.int64(6983) num_query=np.int64(287)
2025-03-13 12:40:43,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:44,704 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:44
2025-03-13 12:40:44,704 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2475.98it/s]
2025-03-13 12:40:44,726 [INFO]: There are 6983 embeddings of dim 49152
2025-03-13 12:40:44,726 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-13 12:40:44,726 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,726 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:44,726 [INFO]: 		-> Add: 3.8 seconds
2025-03-13 12:40:44,726 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:44,726 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:40:44,727 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,727 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:44,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:40:44,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:44
2025-03-13 12:40:44,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:44,727 [INFO]: 	Creating the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:44
2025-03-13 12:40:44,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:40:44,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:44
2025-03-13 12:40:44,728 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-13 12:40:44,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  7.24it/s] 21%|██        | 6/29 [00:00<00:00, 26.96it/s] 38%|███▊      | 11/29 [00:00<00:00, 34.32it/s] 55%|█████▌    | 16/29 [00:00<00:00, 36.80it/s] 72%|███████▏  | 21/29 [00:06<00:04,  1.94it/s] 83%|████████▎ | 24/29 [00:07<00:01,  2.53it/s] 97%|█████████▋| 28/29 [00:07<00:00,  3.59it/s]100%|██████████| 29/29 [00:09<00:00,  3.08it/s]
2025-03-13 12:40:54,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:54
2025-03-13 12:41:58,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3312 secs
2025-03-13 12:41:58,472 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 12:41:58,472 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.29s/it] 50%|█████     | 2/4 [00:05<00:05,  2.90s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.45s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.63s/it]
2025-03-13 12:42:32,516 [INFO]: 	>>> Finished "Compute fast metrics" in 34.0435 secs
2025-03-13 12:42:32,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.7897 secs
2025-03-13 12:42:32,518 [INFO]: {
2025-03-13 12:42:32,518 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:32,518 [INFO]: 	index_param: efSearch=250
2025-03-13 12:42:32,518 [INFO]: 	index_path: knn.index
2025-03-13 12:42:32,518 [INFO]: 	size in bytes: 1373863930
2025-03-13 12:42:32,518 [INFO]: 	avg_search_speed_ms: 9.872930197951707
2025-03-13 12:42:32,518 [INFO]: 	99p_search_speed_ms: 14.442528104409575
2025-03-13 12:42:32,518 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:32,518 [INFO]: 	nb vectors: 6983
2025-03-13 12:42:32,518 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:32,518 [INFO]: 	compression ratio: 0.999308325970826
2025-03-13 12:42:32,518 [INFO]: }
2025-03-13 12:42:32,518 [INFO]: 	>>> Finished "Creating the index" in 107.7911 secs
2025-03-13 12:42:32,518 [INFO]: >>> Finished "Launching the whole pipeline" in 107.8135 secs
2025-03-13 12:42:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 6117 [episode count 19/20]
2025-03-13 12:42:36: [retrieval_preprocessing] finished for 2515873443_wipe_counter_with_cloth [chosen_id count 3/260]
2025-03-13 12:42:38: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2569763324_put_tennis_ball_in_container [chosen_id count 4/260]
2025-03-13 12:42:38: [retrieval_preprocessing] we have num_total=4379 embedding_dim=49152
[retrieval_preprocessing] for episode 8192 [episode count 0/20], we have num_retrieval=np.int64(4175) num_query=np.int64(204)
2025-03-13 12:42:38,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:39,556 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:39
2025-03-13 12:42:39,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.30it/s]
2025-03-13 12:42:39,590 [INFO]: There are 4175 embeddings of dim 49152
2025-03-13 12:42:39,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 12:42:39,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:39,591 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:42:39,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:39,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:42:39,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,591 [INFO]: 861.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:39,591 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:42:39,591 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:39
2025-03-13 12:42:39,591 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:39,591 [INFO]: 	Creating the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,591 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:39
2025-03-13 12:42:39,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:42:39,593 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,593 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:42:39,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.22it/s] 29%|██▉       | 5/17 [00:00<00:00, 22.86it/s] 53%|█████▎    | 9/17 [00:00<00:00, 28.73it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.51it/s]100%|██████████| 17/17 [00:04<00:00,  2.72it/s]100%|██████████| 17/17 [00:04<00:00,  4.17it/s]
2025-03-13 12:42:43,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:43
2025-03-13 12:43:36,533 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.8610 secs
2025-03-13 12:43:36,533 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:43:36,533 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 12:43:55,751 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2177 secs
2025-03-13 12:43:55,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1608 secs
2025-03-13 12:43:55,754 [INFO]: {
2025-03-13 12:43:55,754 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:55,754 [INFO]: 	index_param: efSearch=221
2025-03-13 12:43:55,754 [INFO]: 	index_path: knn.index
2025-03-13 12:43:55,754 [INFO]: 	size in bytes: 821406250
2025-03-13 12:43:55,754 [INFO]: 	avg_search_speed_ms: 10.708246633611875
2025-03-13 12:43:55,754 [INFO]: 	99p_search_speed_ms: 17.780506908893578
2025-03-13 12:43:55,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:55,754 [INFO]: 	nb vectors: 4175
2025-03-13 12:43:55,754 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:55,754 [INFO]: 	compression ratio: 0.9993086855621076
2025-03-13 12:43:55,754 [INFO]: }
2025-03-13 12:43:55,754 [INFO]: 	>>> Finished "Creating the index" in 76.1627 secs
2025-03-13 12:43:55,754 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1974 secs
2025-03-13 12:43:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 8192 [episode count 0/20]
[retrieval_preprocessing] for episode 67971 [episode count 1/20], we have num_retrieval=np.int64(4148) num_query=np.int64(231)
2025-03-13 12:43:58,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:58,874 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:58
2025-03-13 12:43:58,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.85it/s]
2025-03-13 12:43:58,905 [INFO]: There are 4148 embeddings of dim 49152
2025-03-13 12:43:58,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 12:43:58,905 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:58
2025-03-13 12:43:58,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:58,905 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:43:58,905 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:58,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:43:58,905 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:58
2025-03-13 12:43:58,905 [INFO]: 856.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:58,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:43:58,905 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:58
2025-03-13 12:43:58,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:58,905 [INFO]: 	Creating the index 03/13/2025, 12:43:58
2025-03-13 12:43:58,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:58
2025-03-13 12:43:58,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:43:58,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:58
2025-03-13 12:43:58,906 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:43:58,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.38it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.63it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.65it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.75it/s]100%|██████████| 17/17 [00:03<00:00,  4.60it/s]
2025-03-13 12:44:02,607 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:02
2025-03-13 12:44:40,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7335 secs
2025-03-13 12:44:40,342 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 12:44:40,342 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.98it/s]
2025-03-13 12:45:01,590 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2482 secs
2025-03-13 12:45:01,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6863 secs
2025-03-13 12:45:01,593 [INFO]: {
2025-03-13 12:45:01,593 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:01,593 [INFO]: 	index_param: efSearch=157
2025-03-13 12:45:01,593 [INFO]: 	index_path: knn.index
2025-03-13 12:45:01,593 [INFO]: 	size in bytes: 816094150
2025-03-13 12:45:01,593 [INFO]: 	avg_search_speed_ms: 8.238049640774395
2025-03-13 12:45:01,593 [INFO]: 	99p_search_speed_ms: 11.791507676243778
2025-03-13 12:45:01,593 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:01,593 [INFO]: 	nb vectors: 4148
2025-03-13 12:45:01,593 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:01,593 [INFO]: 	compression ratio: 0.9993086998601816
2025-03-13 12:45:01,593 [INFO]: }
2025-03-13 12:45:01,593 [INFO]: 	>>> Finished "Creating the index" in 62.6877 secs
2025-03-13 12:45:01,593 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7189 secs
2025-03-13 12:45:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 67971 [episode count 1/20]
[retrieval_preprocessing] for episode 23816 [episode count 2/20], we have num_retrieval=np.int64(4170) num_query=np.int64(209)
2025-03-13 12:45:03,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:04,130 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:04
2025-03-13 12:45:04,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.06it/s]
2025-03-13 12:45:04,156 [INFO]: There are 4170 embeddings of dim 49152
2025-03-13 12:45:04,156 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:45:04,156 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:04
2025-03-13 12:45:04,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:04,156 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:45:04,156 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:04,157 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:04,157 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:04
2025-03-13 12:45:04,157 [INFO]: 860.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:04,157 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:45:04,157 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:04
2025-03-13 12:45:04,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:04,157 [INFO]: 	Creating the index 03/13/2025, 12:45:04
2025-03-13 12:45:04,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:04
2025-03-13 12:45:04,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:45:04,158 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:04
2025-03-13 12:45:04,158 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:45:04,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.87it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.53it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.89it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.92it/s]100%|██████████| 17/17 [00:03<00:00,  5.07it/s]
2025-03-13 12:45:07,514 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:07
2025-03-13 12:45:47,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3809 secs
2025-03-13 12:45:47,896 [INFO]: The best hyperparameters are: efSearch=140
2025-03-13 12:45:47,896 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.59it/s]
2025-03-13 12:46:04,347 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4510 secs
2025-03-13 12:46:04,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1919 secs
2025-03-13 12:46:04,350 [INFO]: {
2025-03-13 12:46:04,350 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:04,350 [INFO]: 	index_param: efSearch=140
2025-03-13 12:46:04,350 [INFO]: 	index_path: knn.index
2025-03-13 12:46:04,350 [INFO]: 	size in bytes: 820422550
2025-03-13 12:46:04,350 [INFO]: 	avg_search_speed_ms: 7.166264436164317
2025-03-13 12:46:04,350 [INFO]: 	99p_search_speed_ms: 10.613543516956268
2025-03-13 12:46:04,350 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:04,350 [INFO]: 	nb vectors: 4170
2025-03-13 12:46:04,350 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:04,350 [INFO]: 	compression ratio: 0.9993086611283417
2025-03-13 12:46:04,350 [INFO]: }
2025-03-13 12:46:04,350 [INFO]: 	>>> Finished "Creating the index" in 60.1934 secs
2025-03-13 12:46:04,350 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2201 secs
2025-03-13 12:46:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 23816 [episode count 2/20]
[retrieval_preprocessing] for episode 54029 [episode count 3/20], we have num_retrieval=np.int64(4235) num_query=np.int64(144)
2025-03-13 12:46:05,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:06,602 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:06
2025-03-13 12:46:06,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.35it/s]
2025-03-13 12:46:06,633 [INFO]: There are 4235 embeddings of dim 49152
2025-03-13 12:46:06,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 12:46:06,633 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:06
2025-03-13 12:46:06,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:06,633 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:46:06,633 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:06,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:46:06,633 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:06
2025-03-13 12:46:06,634 [INFO]: 874.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:06,634 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:46:06,634 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:06
2025-03-13 12:46:06,634 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:06,634 [INFO]: 	Creating the index 03/13/2025, 12:46:06
2025-03-13 12:46:06,634 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:06
2025-03-13 12:46:06,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:46:06,635 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:06
2025-03-13 12:46:06,635 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:46:06,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.48it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.29it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.28it/s] 94%|█████████▍| 16/17 [00:00<00:00, 41.59it/s]100%|██████████| 17/17 [00:03<00:00,  4.65it/s]
2025-03-13 12:46:10,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:10
2025-03-13 12:46:48,992 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6970 secs
2025-03-13 12:46:48,992 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 12:46:48,992 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-13 12:47:06,433 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4413 secs
2025-03-13 12:47:06,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8009 secs
2025-03-13 12:47:06,436 [INFO]: {
2025-03-13 12:47:06,436 [INFO]: 	index_key: HNSW15
2025-03-13 12:47:06,436 [INFO]: 	index_param: efSearch=155
2025-03-13 12:47:06,436 [INFO]: 	index_path: knn.index
2025-03-13 12:47:06,436 [INFO]: 	size in bytes: 833210830
2025-03-13 12:47:06,436 [INFO]: 	avg_search_speed_ms: 8.432583076350115
2025-03-13 12:47:06,436 [INFO]: 	99p_search_speed_ms: 14.312880055513244
2025-03-13 12:47:06,436 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:06,436 [INFO]: 	nb vectors: 4235
2025-03-13 12:47:06,436 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:06,436 [INFO]: 	compression ratio: 0.9993087583847176
2025-03-13 12:47:06,436 [INFO]: }
2025-03-13 12:47:06,436 [INFO]: 	>>> Finished "Creating the index" in 59.8024 secs
2025-03-13 12:47:06,436 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8345 secs
2025-03-13 12:47:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 54029 [episode count 3/20]
[retrieval_preprocessing] for episode 6158 [episode count 4/20], we have num_retrieval=np.int64(4162) num_query=np.int64(217)
2025-03-13 12:47:07,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:47:08,075 [INFO]: Launching the whole pipeline 03/13/2025, 12:47:08
2025-03-13 12:47:08,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.42it/s]
2025-03-13 12:47:08,099 [INFO]: There are 4162 embeddings of dim 49152
2025-03-13 12:47:08,099 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 12:47:08,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:47:08
2025-03-13 12:47:08,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:47:08,100 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:47:08,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:47:08,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:47:08,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:47:08
2025-03-13 12:47:08,100 [INFO]: 858.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:47:08,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:47:08,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:47:08
2025-03-13 12:47:08,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:47:08,100 [INFO]: 	Creating the index 03/13/2025, 12:47:08
2025-03-13 12:47:08,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:47:08
2025-03-13 12:47:08,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:47:08,101 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:47:08
2025-03-13 12:47:08,101 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:47:08,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.29it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.02it/s] 82%|████████▏ | 14/17 [00:00<00:00, 47.88it/s]100%|██████████| 17/17 [00:03<00:00,  5.07it/s]
2025-03-13 12:47:11,454 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:11
2025-03-13 12:47:59,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0586 secs
2025-03-13 12:47:59,513 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 12:47:59,513 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:11,  3.79s/it] 50%|█████     | 2/4 [00:07<00:07,  3.81s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.06s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.55s/it]
2025-03-13 12:48:31,084 [INFO]: 	>>> Finished "Compute fast metrics" in 31.5704 secs
2025-03-13 12:48:31,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.9856 secs
2025-03-13 12:48:31,087 [INFO]: {
2025-03-13 12:48:31,087 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:31,087 [INFO]: 	index_param: efSearch=144
2025-03-13 12:48:31,087 [INFO]: 	index_path: knn.index
2025-03-13 12:48:31,087 [INFO]: 	size in bytes: 818848630
2025-03-13 12:48:31,087 [INFO]: 	avg_search_speed_ms: 8.065454999826127
2025-03-13 12:48:31,087 [INFO]: 	99p_search_speed_ms: 12.263972561340777
2025-03-13 12:48:31,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:31,087 [INFO]: 	nb vectors: 4162
2025-03-13 12:48:31,087 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:31,087 [INFO]: 	compression ratio: 0.9993086219122086
2025-03-13 12:48:31,087 [INFO]: }
2025-03-13 12:48:31,087 [INFO]: 	>>> Finished "Creating the index" in 82.9871 secs
2025-03-13 12:48:31,087 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0122 secs
2025-03-13 12:48:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 6158 [episode count 4/20]
[retrieval_preprocessing] for episode 75409 [episode count 5/20], we have num_retrieval=np.int64(4169) num_query=np.int64(210)
2025-03-13 12:48:32,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:33,866 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:33
2025-03-13 12:48:33,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.00it/s]
2025-03-13 12:48:33,901 [INFO]: There are 4169 embeddings of dim 49152
2025-03-13 12:48:33,901 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 12:48:33,901 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:33
2025-03-13 12:48:33,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:33,901 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:48:33,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:33,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:48:33,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:33
2025-03-13 12:48:33,902 [INFO]: 860.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:33,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:48:33,902 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:33
2025-03-13 12:48:33,902 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:33,902 [INFO]: 	Creating the index 03/13/2025, 12:48:33
2025-03-13 12:48:33,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:33
2025-03-13 12:48:33,903 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:48:33,903 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:33
2025-03-13 12:48:33,903 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:48:33,903 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.13it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.46it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.91it/s] 94%|█████████▍| 16/17 [00:00<00:00, 37.18it/s]100%|██████████| 17/17 [00:03<00:00,  4.32it/s]
2025-03-13 12:48:37,845 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:37
2025-03-13 12:49:26,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7003 secs
2025-03-13 12:49:26,546 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 12:49:26,546 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.76s/it] 50%|█████     | 2/4 [00:09<00:10,  5.09s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.27s/it] 75%|███████▌  | 3/4 [00:15<00:05,  5.10s/it]
2025-03-13 12:50:02,909 [INFO]: 	>>> Finished "Compute fast metrics" in 36.3624 secs
2025-03-13 12:50:03,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.1105 secs
2025-03-13 12:50:03,014 [INFO]: {
2025-03-13 12:50:03,014 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:03,014 [INFO]: 	index_param: efSearch=177
2025-03-13 12:50:03,014 [INFO]: 	index_path: knn.index
2025-03-13 12:50:03,014 [INFO]: 	size in bytes: 820225810
2025-03-13 12:50:03,014 [INFO]: 	avg_search_speed_ms: 7.86805467626606
2025-03-13 12:50:03,014 [INFO]: 	99p_search_speed_ms: 10.42675154749304
2025-03-13 12:50:03,015 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:03,015 [INFO]: 	nb vectors: 4169
2025-03-13 12:50:03,015 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:03,015 [INFO]: 	compression ratio: 0.9993086562345557
2025-03-13 12:50:03,015 [INFO]: }
2025-03-13 12:50:03,015 [INFO]: 	>>> Finished "Creating the index" in 89.1130 secs
2025-03-13 12:50:03,015 [INFO]: >>> Finished "Launching the whole pipeline" in 89.1484 secs
2025-03-13 12:50:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 75409 [episode count 5/20]
[retrieval_preprocessing] for episode 56219 [episode count 6/20], we have num_retrieval=np.int64(4150) num_query=np.int64(229)
2025-03-13 12:50:05,032 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:05,581 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:05
2025-03-13 12:50:05,581 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1703.62it/s]
2025-03-13 12:50:05,609 [INFO]: There are 4150 embeddings of dim 49152
2025-03-13 12:50:05,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:50:05,609 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:05,609 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:50:05,609 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:05,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:50:05,610 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,610 [INFO]: 856.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:05,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:50:05,610 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:05
2025-03-13 12:50:05,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:05,610 [INFO]: 	Creating the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,610 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:05
2025-03-13 12:50:05,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:50:05,612 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:05
2025-03-13 12:50:05,612 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:50:05,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.30it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.18it/s] 88%|████████▊ | 15/17 [00:00<00:00, 51.59it/s]100%|██████████| 17/17 [00:03<00:00,  4.86it/s]
2025-03-13 12:50:09,118 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:09
2025-03-13 12:50:44,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6968 secs
2025-03-13 12:50:44,816 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 12:50:44,816 [INFO]: 	Compute fast metrics 03/13/2025, 12:50:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.87it/s]
2025-03-13 12:51:04,318 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5017 secs
2025-03-13 12:51:04,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7096 secs
2025-03-13 12:51:04,322 [INFO]: {
2025-03-13 12:51:04,322 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:04,322 [INFO]: 	index_param: efSearch=145
2025-03-13 12:51:04,322 [INFO]: 	index_path: knn.index
2025-03-13 12:51:04,322 [INFO]: 	size in bytes: 816487630
2025-03-13 12:51:04,322 [INFO]: 	avg_search_speed_ms: 9.245827065241935
2025-03-13 12:51:04,322 [INFO]: 	99p_search_speed_ms: 14.293203048873695
2025-03-13 12:51:04,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:04,322 [INFO]: 	nb vectors: 4150
2025-03-13 12:51:04,322 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:04,322 [INFO]: 	compression ratio: 0.9993087096738992
2025-03-13 12:51:04,322 [INFO]: }
2025-03-13 12:51:04,322 [INFO]: 	>>> Finished "Creating the index" in 58.7120 secs
2025-03-13 12:51:04,322 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7413 secs
2025-03-13 12:51:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 56219 [episode count 6/20]
[retrieval_preprocessing] for episode 59295 [episode count 7/20], we have num_retrieval=np.int64(4078) num_query=np.int64(301)
2025-03-13 12:51:05,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:06,504 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:06
2025-03-13 12:51:06,504 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.14it/s]
2025-03-13 12:51:06,534 [INFO]: There are 4078 embeddings of dim 49152
2025-03-13 12:51:06,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 12:51:06,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:06
2025-03-13 12:51:06,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:06,534 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 12:51:06,534 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:06,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:06,534 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:06
2025-03-13 12:51:06,534 [INFO]: 841.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:06,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:51:06,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:06
2025-03-13 12:51:06,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:06,535 [INFO]: 	Creating the index 03/13/2025, 12:51:06
2025-03-13 12:51:06,535 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:06
2025-03-13 12:51:06,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:51:06,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:06
2025-03-13 12:51:06,536 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:51:06,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.90it/s] 41%|████      | 7/17 [00:00<00:00, 32.70it/s] 76%|███████▋  | 13/17 [00:00<00:00, 41.50it/s]100%|██████████| 17/17 [00:04<00:00,  4.06it/s]
2025-03-13 12:51:10,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:10
2025-03-13 12:51:49,560 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8332 secs
2025-03-13 12:51:49,561 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 12:51:49,561 [INFO]: 	Compute fast metrics 03/13/2025, 12:51:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 12:52:23,884 [INFO]: 	>>> Finished "Compute fast metrics" in 34.3231 secs
2025-03-13 12:52:23,887 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3511 secs
2025-03-13 12:52:23,887 [INFO]: {
2025-03-13 12:52:23,887 [INFO]: 	index_key: HNSW15
2025-03-13 12:52:23,887 [INFO]: 	index_param: efSearch=171
2025-03-13 12:52:23,887 [INFO]: 	index_path: knn.index
2025-03-13 12:52:23,887 [INFO]: 	size in bytes: 802322110
2025-03-13 12:52:23,887 [INFO]: 	avg_search_speed_ms: 8.807073185906772
2025-03-13 12:52:23,887 [INFO]: 	99p_search_speed_ms: 18.460172060877113
2025-03-13 12:52:23,887 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:52:23,887 [INFO]: 	nb vectors: 4078
2025-03-13 12:52:23,887 [INFO]: 	vectors dimension: 49152
2025-03-13 12:52:23,887 [INFO]: 	compression ratio: 0.9993086492406398
2025-03-13 12:52:23,887 [INFO]: }
2025-03-13 12:52:23,887 [INFO]: 	>>> Finished "Creating the index" in 77.3528 secs
2025-03-13 12:52:23,887 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3835 secs
2025-03-13 12:52:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:52:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 59295 [episode count 7/20]
[retrieval_preprocessing] for episode 68257 [episode count 8/20], we have num_retrieval=np.int64(4153) num_query=np.int64(226)
2025-03-13 12:52:26,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:52:26,865 [INFO]: Launching the whole pipeline 03/13/2025, 12:52:26
2025-03-13 12:52:26,865 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:52:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.65it/s]
2025-03-13 12:52:26,893 [INFO]: There are 4153 embeddings of dim 49152
2025-03-13 12:52:26,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:52:26,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:52:26
2025-03-13 12:52:26,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:52:26,894 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:52:26,894 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:52:26,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:52:26,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:52:26
2025-03-13 12:52:26,894 [INFO]: 857.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:52:26,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:52:26,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:52:26
2025-03-13 12:52:26,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:52:26,895 [INFO]: 	Creating the index 03/13/2025, 12:52:26
2025-03-13 12:52:26,895 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:52:26
2025-03-13 12:52:26,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 12:52:26,897 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:52:26
2025-03-13 12:52:26,897 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:52:26,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.89it/s] 47%|████▋     | 8/17 [00:00<00:00, 40.38it/s] 82%|████████▏ | 14/17 [00:00<00:00, 46.69it/s]100%|██████████| 17/17 [00:03<00:00,  5.02it/s]
2025-03-13 12:52:30,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:52:30
2025-03-13 12:53:26,585 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2912 secs
2025-03-13 12:53:26,585 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 12:53:26,585 [INFO]: 	Compute fast metrics 03/13/2025, 12:53:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.55it/s]
2025-03-13 12:53:55,818 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2335 secs
2025-03-13 12:53:55,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.9243 secs
2025-03-13 12:53:55,822 [INFO]: {
2025-03-13 12:53:55,822 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:55,822 [INFO]: 	index_param: efSearch=239
2025-03-13 12:53:55,822 [INFO]: 	index_path: knn.index
2025-03-13 12:53:55,822 [INFO]: 	size in bytes: 817077850
2025-03-13 12:53:55,822 [INFO]: 	avg_search_speed_ms: 16.353729192024474
2025-03-13 12:53:55,822 [INFO]: 	99p_search_speed_ms: 23.66631906945258
2025-03-13 12:53:55,822 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:55,822 [INFO]: 	nb vectors: 4153
2025-03-13 12:53:55,822 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:55,822 [INFO]: 	compression ratio: 0.9993087243767531
2025-03-13 12:53:55,822 [INFO]: }
2025-03-13 12:53:55,822 [INFO]: 	>>> Finished "Creating the index" in 88.9273 secs
2025-03-13 12:53:55,822 [INFO]: >>> Finished "Launching the whole pipeline" in 88.9572 secs
2025-03-13 12:53:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 68257 [episode count 8/20]
[retrieval_preprocessing] for episode 94001 [episode count 9/20], we have num_retrieval=np.int64(4143) num_query=np.int64(236)
2025-03-13 12:53:58,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:59,683 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:59
2025-03-13 12:53:59,683 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.35it/s]
2025-03-13 12:53:59,717 [INFO]: There are 4143 embeddings of dim 49152
2025-03-13 12:53:59,717 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-13 12:53:59,717 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:59
2025-03-13 12:53:59,718 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:59,718 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:53:59,718 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:53:59,718 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:53:59,718 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:59
2025-03-13 12:53:59,719 [INFO]: 855.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:59,719 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:53:59,719 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:59
2025-03-13 12:53:59,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:59,720 [INFO]: 	Creating the index 03/13/2025, 12:53:59
2025-03-13 12:53:59,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:59
2025-03-13 12:53:59,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 12:53:59,724 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:59
2025-03-13 12:53:59,724 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:53:59,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.32it/s] 29%|██▉       | 5/17 [00:00<00:00, 22.12it/s] 53%|█████▎    | 9/17 [00:00<00:00, 26.13it/s] 76%|███████▋  | 13/17 [00:00<00:00, 28.05it/s]100%|██████████| 17/17 [00:05<00:00,  2.05it/s]100%|██████████| 17/17 [00:05<00:00,  3.18it/s]
2025-03-13 12:54:05,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:54:05
2025-03-13 12:54:57,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6696 secs
2025-03-13 12:54:57,754 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 12:54:57,754 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.28s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.12s/it]
2025-03-13 12:55:20,710 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9554 secs
2025-03-13 12:55:20,712 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.9884 secs
2025-03-13 12:55:20,713 [INFO]: {
2025-03-13 12:55:20,713 [INFO]: 	index_key: HNSW15
2025-03-13 12:55:20,713 [INFO]: 	index_param: efSearch=229
2025-03-13 12:55:20,713 [INFO]: 	index_path: knn.index
2025-03-13 12:55:20,713 [INFO]: 	size in bytes: 815110450
2025-03-13 12:55:20,713 [INFO]: 	avg_search_speed_ms: 10.208593491863992
2025-03-13 12:55:20,713 [INFO]: 	99p_search_speed_ms: 14.00096423691139
2025-03-13 12:55:20,713 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:55:20,713 [INFO]: 	nb vectors: 4143
2025-03-13 12:55:20,713 [INFO]: 	vectors dimension: 49152
2025-03-13 12:55:20,713 [INFO]: 	compression ratio: 0.9993086752844353
2025-03-13 12:55:20,713 [INFO]: }
2025-03-13 12:55:20,713 [INFO]: 	>>> Finished "Creating the index" in 80.9928 secs
2025-03-13 12:55:20,713 [INFO]: >>> Finished "Launching the whole pipeline" in 81.0302 secs
2025-03-13 12:55:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 94001 [episode count 9/20]
[retrieval_preprocessing] for episode 57523 [episode count 10/20], we have num_retrieval=np.int64(4093) num_query=np.int64(286)
2025-03-13 12:55:23,378 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:23,896 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:23
2025-03-13 12:55:23,897 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1321.46it/s]
2025-03-13 12:55:23,922 [INFO]: There are 4093 embeddings of dim 49152
2025-03-13 12:55:23,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 12:55:23,923 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:23
2025-03-13 12:55:23,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:23,923 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 12:55:23,923 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:23,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:55:23,923 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:23
2025-03-13 12:55:23,923 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:23,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:55:23,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:23
2025-03-13 12:55:23,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:23,923 [INFO]: 	Creating the index 03/13/2025, 12:55:23
2025-03-13 12:55:23,923 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:23
2025-03-13 12:55:23,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:55:23,924 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:23
2025-03-13 12:55:23,924 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 12:55:23,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.98it/s] 41%|████      | 7/17 [00:00<00:00, 37.82it/s] 76%|███████▋  | 13/17 [00:00<00:00, 47.08it/s]100%|██████████| 17/17 [00:03<00:00,  5.11it/s]
2025-03-13 12:55:27,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:27
2025-03-13 12:56:04,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2504 secs
2025-03-13 12:56:04,508 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 12:56:04,508 [INFO]: 	Compute fast metrics 03/13/2025, 12:56:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.42it/s]
2025-03-13 12:56:27,242 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7340 secs
2025-03-13 12:56:27,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3205 secs
2025-03-13 12:56:27,245 [INFO]: {
2025-03-13 12:56:27,245 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:27,245 [INFO]: 	index_param: efSearch=182
2025-03-13 12:56:27,245 [INFO]: 	index_path: knn.index
2025-03-13 12:56:27,245 [INFO]: 	size in bytes: 805273270
2025-03-13 12:56:27,245 [INFO]: 	avg_search_speed_ms: 8.482224192032692
2025-03-13 12:56:27,245 [INFO]: 	99p_search_speed_ms: 11.852950528264046
2025-03-13 12:56:27,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:27,245 [INFO]: 	nb vectors: 4093
2025-03-13 12:56:27,245 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:27,245 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-13 12:56:27,245 [INFO]: }
2025-03-13 12:56:27,245 [INFO]: 	>>> Finished "Creating the index" in 63.3218 secs
2025-03-13 12:56:27,245 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3487 secs
2025-03-13 12:56:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 57523 [episode count 10/20]
[retrieval_preprocessing] for episode 24629 [episode count 11/20], we have num_retrieval=np.int64(4171) num_query=np.int64(208)
2025-03-13 12:56:29,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:30,553 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:30
2025-03-13 12:56:30,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.16it/s]
2025-03-13 12:56:30,586 [INFO]: There are 4171 embeddings of dim 49152
2025-03-13 12:56:30,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 12:56:30,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:30
2025-03-13 12:56:30,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:30,587 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:56:30,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:30,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:56:30,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:30
2025-03-13 12:56:30,587 [INFO]: 860.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:30,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:56:30,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:30
2025-03-13 12:56:30,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:30,587 [INFO]: 	Creating the index 03/13/2025, 12:56:30
2025-03-13 12:56:30,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:30
2025-03-13 12:56:30,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:56:30,588 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:30
2025-03-13 12:56:30,588 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:56:30,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.91it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.07it/s] 71%|███████   | 12/17 [00:00<00:00, 39.03it/s]100%|██████████| 17/17 [00:03<00:00,  3.45it/s]100%|██████████| 17/17 [00:03<00:00,  4.66it/s]
2025-03-13 12:56:34,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:34
2025-03-13 12:57:16,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2687 secs
2025-03-13 12:57:16,510 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 12:57:16,510 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 12:57:32,503 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9934 secs
2025-03-13 12:57:33,539 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9511 secs
2025-03-13 12:57:33,539 [INFO]: {
2025-03-13 12:57:33,540 [INFO]: 	index_key: HNSW15
2025-03-13 12:57:33,540 [INFO]: 	index_param: efSearch=225
2025-03-13 12:57:33,540 [INFO]: 	index_path: knn.index
2025-03-13 12:57:33,540 [INFO]: 	size in bytes: 820619290
2025-03-13 12:57:33,540 [INFO]: 	avg_search_speed_ms: 9.434368918904648
2025-03-13 12:57:33,540 [INFO]: 	99p_search_speed_ms: 12.277934788726288
2025-03-13 12:57:33,540 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:57:33,540 [INFO]: 	nb vectors: 4171
2025-03-13 12:57:33,540 [INFO]: 	vectors dimension: 49152
2025-03-13 12:57:33,540 [INFO]: 	compression ratio: 0.9993086660197812
2025-03-13 12:57:33,540 [INFO]: }
2025-03-13 12:57:33,540 [INFO]: 	>>> Finished "Creating the index" in 62.9531 secs
2025-03-13 12:57:33,540 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9871 secs
2025-03-13 12:57:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:57:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 24629 [episode count 11/20]
[retrieval_preprocessing] for episode 12347 [episode count 12/20], we have num_retrieval=np.int64(4145) num_query=np.int64(234)
2025-03-13 12:57:35,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:57:36,269 [INFO]: Launching the whole pipeline 03/13/2025, 12:57:36
2025-03-13 12:57:36,269 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:57:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1900.45it/s]
2025-03-13 12:57:36,296 [INFO]: There are 4145 embeddings of dim 49152
2025-03-13 12:57:36,296 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 12:57:36,296 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:57:36
2025-03-13 12:57:36,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:57:36,297 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:57:36,297 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:57:36,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:57:36,297 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:57:36
2025-03-13 12:57:36,297 [INFO]: 855.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:57:36,297 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:57:36,297 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:57:36
2025-03-13 12:57:36,297 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:57:36,297 [INFO]: 	Creating the index 03/13/2025, 12:57:36
2025-03-13 12:57:36,297 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:57:36
2025-03-13 12:57:36,298 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:57:36,298 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:57:36
2025-03-13 12:57:36,298 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:57:36,298 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.09it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.67it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.35it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.77it/s]100%|██████████| 17/17 [00:03<00:00,  5.13it/s]
2025-03-13 12:57:39,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:57:39
2025-03-13 12:58:12,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9245 secs
2025-03-13 12:58:12,543 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 12:58:12,543 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.48it/s]
2025-03-13 12:58:34,498 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9550 secs
2025-03-13 12:58:34,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2355 secs
2025-03-13 12:58:34,534 [INFO]: {
2025-03-13 12:58:34,534 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:34,534 [INFO]: 	index_param: efSearch=188
2025-03-13 12:58:34,534 [INFO]: 	index_path: knn.index
2025-03-13 12:58:34,534 [INFO]: 	size in bytes: 815503930
2025-03-13 12:58:34,534 [INFO]: 	avg_search_speed_ms: 10.787398009606212
2025-03-13 12:58:34,534 [INFO]: 	99p_search_speed_ms: 18.02342609502375
2025-03-13 12:58:34,534 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:34,534 [INFO]: 	nb vectors: 4145
2025-03-13 12:58:34,534 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:34,534 [INFO]: 	compression ratio: 0.9993086851218486
2025-03-13 12:58:34,534 [INFO]: }
2025-03-13 12:58:34,534 [INFO]: 	>>> Finished "Creating the index" in 58.2374 secs
2025-03-13 12:58:34,535 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2656 secs
2025-03-13 12:58:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 12347 [episode count 12/20]
[retrieval_preprocessing] for episode 70203 [episode count 13/20], we have num_retrieval=np.int64(4184) num_query=np.int64(195)
2025-03-13 12:58:36,688 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:37,234 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:37
2025-03-13 12:58:37,234 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2223.92it/s]
2025-03-13 12:58:37,263 [INFO]: There are 4184 embeddings of dim 49152
2025-03-13 12:58:37,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:58:37,263 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:37,264 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:58:37,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:37,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:37,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,264 [INFO]: 863.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:37,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:58:37,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:37
2025-03-13 12:58:37,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:37,264 [INFO]: 	Creating the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:37
2025-03-13 12:58:37,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:58:37,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:37
2025-03-13 12:58:37,265 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:58:37,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.24it/s] 41%|████      | 7/17 [00:00<00:00, 35.41it/s] 76%|███████▋  | 13/17 [00:00<00:00, 43.98it/s]100%|██████████| 17/17 [00:03<00:00,  4.38it/s]
2025-03-13 12:58:41,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:41
2025-03-13 12:59:24,573 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4201 secs
2025-03-13 12:59:24,573 [INFO]: The best hyperparameters are: efSearch=73
2025-03-13 12:59:24,573 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.31it/s]
2025-03-13 12:59:41,310 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7361 secs
2025-03-13 12:59:41,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0470 secs
2025-03-13 12:59:41,312 [INFO]: {
2025-03-13 12:59:41,312 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:41,312 [INFO]: 	index_param: efSearch=73
2025-03-13 12:59:41,312 [INFO]: 	index_path: knn.index
2025-03-13 12:59:41,312 [INFO]: 	size in bytes: 823176910
2025-03-13 12:59:41,312 [INFO]: 	avg_search_speed_ms: 4.159042547806166
2025-03-13 12:59:41,312 [INFO]: 	99p_search_speed_ms: 6.23871422605589
2025-03-13 12:59:41,312 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:41,312 [INFO]: 	nb vectors: 4184
2025-03-13 12:59:41,312 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:41,312 [INFO]: 	compression ratio: 0.9993087293957261
2025-03-13 12:59:41,312 [INFO]: }
2025-03-13 12:59:41,312 [INFO]: 	>>> Finished "Creating the index" in 64.0485 secs
2025-03-13 12:59:41,312 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0779 secs
2025-03-13 12:59:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 70203 [episode count 13/20]
[retrieval_preprocessing] for episode 49598 [episode count 14/20], we have num_retrieval=np.int64(4189) num_query=np.int64(190)
2025-03-13 12:59:42,689 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:43,540 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:43
2025-03-13 12:59:43,540 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.63it/s]
2025-03-13 12:59:43,568 [INFO]: There are 4189 embeddings of dim 49152
2025-03-13 12:59:43,568 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 12:59:43,568 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:43
2025-03-13 12:59:43,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:43,569 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 12:59:43,569 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:43,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:59:43,569 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:43
2025-03-13 12:59:43,569 [INFO]: 864.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:43,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:59:43,569 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:43
2025-03-13 12:59:43,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:43,569 [INFO]: 	Creating the index 03/13/2025, 12:59:43
2025-03-13 12:59:43,569 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:43
2025-03-13 12:59:43,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:59:43,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:43
2025-03-13 12:59:43,570 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 12:59:43,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.28it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.27it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.62it/s] 94%|█████████▍| 16/17 [00:00<00:00, 37.68it/s]100%|██████████| 17/17 [00:03<00:00,  4.93it/s]
2025-03-13 12:59:47,022 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:47
2025-03-13 13:00:26,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5210 secs
2025-03-13 13:00:26,543 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 13:00:26,543 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.95it/s]
2025-03-13 13:00:44,714 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1712 secs
2025-03-13 13:00:44,718 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1477 secs
2025-03-13 13:00:44,718 [INFO]: {
2025-03-13 13:00:44,718 [INFO]: 	index_key: HNSW15
2025-03-13 13:00:44,718 [INFO]: 	index_param: efSearch=185
2025-03-13 13:00:44,718 [INFO]: 	index_path: knn.index
2025-03-13 13:00:44,718 [INFO]: 	size in bytes: 824160610
2025-03-13 13:00:44,718 [INFO]: 	avg_search_speed_ms: 12.346991167668207
2025-03-13 13:00:44,718 [INFO]: 	99p_search_speed_ms: 20.737192458473142
2025-03-13 13:00:44,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:00:44,718 [INFO]: 	nb vectors: 4189
2025-03-13 13:00:44,718 [INFO]: 	vectors dimension: 49152
2025-03-13 13:00:44,718 [INFO]: 	compression ratio: 0.9993087536663515
2025-03-13 13:00:44,718 [INFO]: }
2025-03-13 13:00:44,718 [INFO]: 	>>> Finished "Creating the index" in 61.1493 secs
2025-03-13 13:00:44,718 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1779 secs
2025-03-13 13:00:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:00:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 49598 [episode count 14/20]
[retrieval_preprocessing] for episode 22597 [episode count 15/20], we have num_retrieval=np.int64(4167) num_query=np.int64(212)
2025-03-13 13:00:46,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:00:47,300 [INFO]: Launching the whole pipeline 03/13/2025, 13:00:47
2025-03-13 13:00:47,300 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:00:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1980.31it/s]
2025-03-13 13:00:47,334 [INFO]: There are 4167 embeddings of dim 49152
2025-03-13 13:00:47,334 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 13:00:47,334 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:00:47
2025-03-13 13:00:47,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:00:47,334 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 13:00:47,334 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:00:47,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:00:47,334 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:00:47
2025-03-13 13:00:47,334 [INFO]: 860.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:00:47,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:00:47,334 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:00:47
2025-03-13 13:00:47,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:00:47,334 [INFO]: 	Creating the index 03/13/2025, 13:00:47
2025-03-13 13:00:47,334 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:00:47
2025-03-13 13:00:47,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:00:47,336 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:00:47
2025-03-13 13:00:47,336 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:00:47,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.85it/s] 29%|██▉       | 5/17 [00:00<00:00, 23.08it/s] 53%|█████▎    | 9/17 [00:00<00:00, 29.91it/s] 76%|███████▋  | 13/17 [00:00<00:00, 33.52it/s]100%|██████████| 17/17 [00:03<00:00,  2.81it/s]100%|██████████| 17/17 [00:03<00:00,  4.30it/s]
2025-03-13 13:00:51,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:51
2025-03-13 13:01:27,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6619 secs
2025-03-13 13:01:27,953 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 13:01:27,953 [INFO]: 	Compute fast metrics 03/13/2025, 13:01:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.49it/s]
2025-03-13 13:02:04,198 [INFO]: 	>>> Finished "Compute fast metrics" in 36.2451 secs
2025-03-13 13:02:04,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8659 secs
2025-03-13 13:02:04,202 [INFO]: {
2025-03-13 13:02:04,202 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:04,202 [INFO]: 	index_param: efSearch=237
2025-03-13 13:02:04,202 [INFO]: 	index_path: knn.index
2025-03-13 13:02:04,202 [INFO]: 	size in bytes: 819832330
2025-03-13 13:02:04,202 [INFO]: 	avg_search_speed_ms: 11.325761619934207
2025-03-13 13:02:04,202 [INFO]: 	99p_search_speed_ms: 16.953934738412496
2025-03-13 13:02:04,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:04,202 [INFO]: 	nb vectors: 4167
2025-03-13 13:02:04,202 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:04,202 [INFO]: 	compression ratio: 0.9993086464399373
2025-03-13 13:02:04,202 [INFO]: }
2025-03-13 13:02:04,202 [INFO]: 	>>> Finished "Creating the index" in 76.8674 secs
2025-03-13 13:02:04,202 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9014 secs
2025-03-13 13:02:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 22597 [episode count 15/20]
[retrieval_preprocessing] for episode 70095 [episode count 16/20], we have num_retrieval=np.int64(4164) num_query=np.int64(215)
2025-03-13 13:02:07,296 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:08,539 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:08
2025-03-13 13:02:08,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.68it/s]
2025-03-13 13:02:08,570 [INFO]: There are 4164 embeddings of dim 49152
2025-03-13 13:02:08,571 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 13:02:08,571 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,571 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:08,571 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 13:02:08,571 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:08,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:08,571 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,571 [INFO]: 859.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:08,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:02:08,571 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:08
2025-03-13 13:02:08,571 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:08,571 [INFO]: 	Creating the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:08
2025-03-13 13:02:08,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 13:02:08,573 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:08
2025-03-13 13:02:08,573 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:02:08,573 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.49it/s] 29%|██▉       | 5/17 [00:00<00:00, 22.00it/s] 53%|█████▎    | 9/17 [00:00<00:00, 27.22it/s] 71%|███████   | 12/17 [00:03<00:02,  2.25it/s] 94%|█████████▍| 16/17 [00:03<00:00,  3.68it/s]100%|██████████| 17/17 [00:06<00:00,  2.51it/s]
2025-03-13 13:02:15,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:15
2025-03-13 13:02:49,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3109 secs
2025-03-13 13:02:49,672 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 13:02:49,672 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-13 13:03:09,264 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5922 secs
2025-03-13 13:03:09,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6943 secs
2025-03-13 13:03:09,268 [INFO]: {
2025-03-13 13:03:09,268 [INFO]: 	index_key: HNSW15
2025-03-13 13:03:09,268 [INFO]: 	index_param: efSearch=211
2025-03-13 13:03:09,268 [INFO]: 	index_path: knn.index
2025-03-13 13:03:09,268 [INFO]: 	size in bytes: 819242110
2025-03-13 13:03:09,268 [INFO]: 	avg_search_speed_ms: 13.691568308256352
2025-03-13 13:03:09,268 [INFO]: 	99p_search_speed_ms: 18.990292144007988
2025-03-13 13:03:09,268 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:03:09,268 [INFO]: 	nb vectors: 4164
2025-03-13 13:03:09,268 [INFO]: 	vectors dimension: 49152
2025-03-13 13:03:09,268 [INFO]: 	compression ratio: 0.9993086317303684
2025-03-13 13:03:09,268 [INFO]: }
2025-03-13 13:03:09,268 [INFO]: 	>>> Finished "Creating the index" in 60.6964 secs
2025-03-13 13:03:09,268 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7292 secs
2025-03-13 13:03:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:03:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 70095 [episode count 16/20]
[retrieval_preprocessing] for episode 66769 [episode count 17/20], we have num_retrieval=np.int64(4122) num_query=np.int64(257)
2025-03-13 13:03:12,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:03:13,516 [INFO]: Launching the whole pipeline 03/13/2025, 13:03:13
2025-03-13 13:03:13,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:03:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1765.28it/s]
2025-03-13 13:03:13,548 [INFO]: There are 4122 embeddings of dim 49152
2025-03-13 13:03:13,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 13:03:13,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:03:13
2025-03-13 13:03:13,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:03:13,548 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 13:03:13,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:03:13,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:03:13,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:03:13
2025-03-13 13:03:13,548 [INFO]: 850.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:03:13,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:03:13,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:03:13
2025-03-13 13:03:13,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:03:13,549 [INFO]: 	Creating the index 03/13/2025, 13:03:13
2025-03-13 13:03:13,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:03:13
2025-03-13 13:03:13,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:03:13,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:03:13
2025-03-13 13:03:13,550 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:03:13,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.00it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.39it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.23it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.07it/s]100%|██████████| 17/17 [00:04<00:00,  3.51it/s]
2025-03-13 13:03:18,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:03:18
2025-03-13 13:04:19,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1044 secs
2025-03-13 13:04:19,504 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 13:04:19,504 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.27it/s] 75%|███████▌  | 3/4 [00:04<00:01,  1.42s/it]
2025-03-13 13:04:47,018 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5134 secs
2025-03-13 13:04:47,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.4708 secs
2025-03-13 13:04:47,021 [INFO]: {
2025-03-13 13:04:47,021 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:47,021 [INFO]: 	index_param: efSearch=228
2025-03-13 13:04:47,021 [INFO]: 	index_path: knn.index
2025-03-13 13:04:47,021 [INFO]: 	size in bytes: 810978910
2025-03-13 13:04:47,021 [INFO]: 	avg_search_speed_ms: 10.808220660448734
2025-03-13 13:04:47,021 [INFO]: 	99p_search_speed_ms: 14.05780203640461
2025-03-13 13:04:47,021 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:47,021 [INFO]: 	nb vectors: 4122
2025-03-13 13:04:47,021 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:47,021 [INFO]: 	compression ratio: 0.9993085714152542
2025-03-13 13:04:47,021 [INFO]: }
2025-03-13 13:04:47,021 [INFO]: 	>>> Finished "Creating the index" in 93.4722 secs
2025-03-13 13:04:47,021 [INFO]: >>> Finished "Launching the whole pipeline" in 93.5044 secs
2025-03-13 13:04:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 66769 [episode count 17/20]
[retrieval_preprocessing] for episode 84817 [episode count 18/20], we have num_retrieval=np.int64(4190) num_query=np.int64(189)
2025-03-13 13:04:49,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:50,498 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:50
2025-03-13 13:04:50,498 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1050.94it/s]
2025-03-13 13:04:50,525 [INFO]: There are 4190 embeddings of dim 49152
2025-03-13 13:04:50,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 13:04:50,525 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:50,525 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 13:04:50,525 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:50,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:50,525 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,525 [INFO]: 864.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:50,525 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:04:50,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:50
2025-03-13 13:04:50,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:50,526 [INFO]: 	Creating the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,526 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:50
2025-03-13 13:04:50,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:04:50,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:50
2025-03-13 13:04:50,527 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:04:50,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.35it/s] 41%|████      | 7/17 [00:00<00:00, 36.32it/s] 71%|███████   | 12/17 [00:00<00:00, 41.54it/s]100%|██████████| 17/17 [00:04<00:00,  2.76it/s]100%|██████████| 17/17 [00:04<00:00,  3.84it/s]
2025-03-13 13:04:54,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:54
2025-03-13 13:05:40,682 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7228 secs
2025-03-13 13:05:40,682 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 13:05:40,682 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.16it/s]
2025-03-13 13:06:05,082 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3996 secs
2025-03-13 13:06:05,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.5575 secs
2025-03-13 13:06:05,085 [INFO]: {
2025-03-13 13:06:05,085 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:05,085 [INFO]: 	index_param: efSearch=184
2025-03-13 13:06:05,085 [INFO]: 	index_path: knn.index
2025-03-13 13:06:05,085 [INFO]: 	size in bytes: 824357350
2025-03-13 13:06:05,085 [INFO]: 	avg_search_speed_ms: 8.688170447068485
2025-03-13 13:06:05,085 [INFO]: 	99p_search_speed_ms: 11.659892043098807
2025-03-13 13:06:05,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:05,085 [INFO]: 	nb vectors: 4190
2025-03-13 13:06:05,085 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:05,085 [INFO]: 	compression ratio: 0.9993087585135257
2025-03-13 13:06:05,085 [INFO]: }
2025-03-13 13:06:05,085 [INFO]: 	>>> Finished "Creating the index" in 74.5591 secs
2025-03-13 13:06:05,085 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5866 secs
2025-03-13 13:06:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 84817 [episode count 18/20]
[retrieval_preprocessing] for episode 89041 [episode count 19/20], we have num_retrieval=np.int64(4193) num_query=np.int64(186)
2025-03-13 13:06:07,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:08,052 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:08
2025-03-13 13:06:08,052 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.83it/s]
2025-03-13 13:06:08,086 [INFO]: There are 4193 embeddings of dim 49152
2025-03-13 13:06:08,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 13:06:08,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:08
2025-03-13 13:06:08,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:08,087 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 13:06:08,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:08,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 13:06:08,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:08
2025-03-13 13:06:08,088 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:08,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:06:08,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:08
2025-03-13 13:06:08,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:08,088 [INFO]: 	Creating the index 03/13/2025, 13:06:08
2025-03-13 13:06:08,089 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:08
2025-03-13 13:06:08,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 13:06:08,091 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:08
2025-03-13 13:06:08,091 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 13:06:08,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.87it/s] 41%|████      | 7/17 [00:00<00:00, 33.55it/s] 71%|███████   | 12/17 [00:00<00:00, 38.63it/s]100%|██████████| 17/17 [00:03<00:00,  3.39it/s]100%|██████████| 17/17 [00:03<00:00,  4.73it/s]
2025-03-13 13:06:11,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:11
2025-03-13 13:06:49,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7446 secs
2025-03-13 13:06:49,439 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 13:06:49,439 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-13 13:07:11,675 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2361 secs
2025-03-13 13:07:11,677 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5857 secs
2025-03-13 13:07:11,677 [INFO]: {
2025-03-13 13:07:11,677 [INFO]: 	index_key: HNSW15
2025-03-13 13:07:11,677 [INFO]: 	index_param: efSearch=232
2025-03-13 13:07:11,677 [INFO]: 	index_path: knn.index
2025-03-13 13:07:11,677 [INFO]: 	size in bytes: 824947570
2025-03-13 13:07:11,677 [INFO]: 	avg_search_speed_ms: 12.001916593989405
2025-03-13 13:07:11,677 [INFO]: 	99p_search_speed_ms: 16.880896212533116
2025-03-13 13:07:11,677 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:11,677 [INFO]: 	nb vectors: 4193
2025-03-13 13:07:11,677 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:11,677 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-13 13:07:11,677 [INFO]: }
2025-03-13 13:07:11,677 [INFO]: 	>>> Finished "Creating the index" in 63.5889 secs
2025-03-13 13:07:11,677 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6255 secs
2025-03-13 13:07:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 89041 [episode count 19/20]
2025-03-13 13:07:13: [retrieval_preprocessing] finished for 2569763324_put_tennis_ball_in_container [chosen_id count 4/260]
2025-03-13 13:07:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2782099537_pour_cup_into_bowl [chosen_id count 5/260]
2025-03-13 13:07:14: [retrieval_preprocessing] we have num_total=3087 embedding_dim=49152
[retrieval_preprocessing] for episode 92673 [episode count 0/20], we have num_retrieval=np.int64(2860) num_query=np.int64(227)
2025-03-13 13:07:14,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:15,263 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:15
2025-03-13 13:07:15,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.53it/s]
2025-03-13 13:07:15,290 [INFO]: There are 2860 embeddings of dim 49152
2025-03-13 13:07:15,290 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 13:07:15,290 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:15
2025-03-13 13:07:15,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:15,290 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:07:15,290 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:07:15,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:07:15,291 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:15
2025-03-13 13:07:15,291 [INFO]: 590.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:15,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:07:15,291 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:15
2025-03-13 13:07:15,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:15,291 [INFO]: 	Creating the index 03/13/2025, 13:07:15
2025-03-13 13:07:15,291 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:07:15
2025-03-13 13:07:15,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:07:15,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:15
2025-03-13 13:07:15,292 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:07:15,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.66it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.75it/s] 92%|█████████▏| 11/12 [00:00<00:00, 33.79it/s]100%|██████████| 12/12 [00:02<00:00,  4.89it/s]
2025-03-13 13:07:17,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:17
2025-03-13 13:07:49,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7367 secs
2025-03-13 13:07:49,488 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 13:07:49,488 [INFO]: 	Compute fast metrics 03/13/2025, 13:07:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 13:08:04,403 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9145 secs
2025-03-13 13:08:04,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1121 secs
2025-03-13 13:08:04,405 [INFO]: {
2025-03-13 13:08:04,405 [INFO]: 	index_key: HNSW15
2025-03-13 13:08:04,405 [INFO]: 	index_param: efSearch=176
2025-03-13 13:08:04,405 [INFO]: 	index_path: knn.index
2025-03-13 13:08:04,405 [INFO]: 	size in bytes: 562687270
2025-03-13 13:08:04,405 [INFO]: 	avg_search_speed_ms: 7.943891909608145
2025-03-13 13:08:04,405 [INFO]: 	99p_search_speed_ms: 11.43447682261467
2025-03-13 13:08:04,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:08:04,405 [INFO]: 	nb vectors: 2860
2025-03-13 13:08:04,405 [INFO]: 	vectors dimension: 49152
2025-03-13 13:08:04,405 [INFO]: 	compression ratio: 0.9993097586870945
2025-03-13 13:08:04,405 [INFO]: }
2025-03-13 13:08:04,405 [INFO]: 	>>> Finished "Creating the index" in 49.1138 secs
2025-03-13 13:08:04,405 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1419 secs
2025-03-13 13:08:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:08:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 92673 [episode count 0/20]
[retrieval_preprocessing] for episode 10243 [episode count 1/20], we have num_retrieval=np.int64(2951) num_query=np.int64(136)
2025-03-13 13:08:06,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:08:06,453 [INFO]: Launching the whole pipeline 03/13/2025, 13:08:06
2025-03-13 13:08:06,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:08:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1742.54it/s]
2025-03-13 13:08:06,479 [INFO]: There are 2951 embeddings of dim 49152
2025-03-13 13:08:06,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 13:08:06,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:08:06
2025-03-13 13:08:06,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:08:06,480 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:08:06,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:08:06,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:08:06,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:08:06
2025-03-13 13:08:06,481 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:08:06,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:08:06,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:08:06
2025-03-13 13:08:06,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:08:06,481 [INFO]: 	Creating the index 03/13/2025, 13:08:06
2025-03-13 13:08:06,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:08:06
2025-03-13 13:08:06,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:08:06,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:08:06
2025-03-13 13:08:06,485 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:08:06,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 28.21it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.60it/s]100%|██████████| 12/12 [00:02<00:00,  5.73it/s]
2025-03-13 13:08:08,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:08
2025-03-13 13:08:45,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8201 secs
2025-03-13 13:08:45,407 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 13:08:45,407 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-13 13:09:03,265 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8578 secs
2025-03-13 13:09:03,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7818 secs
2025-03-13 13:09:03,267 [INFO]: {
2025-03-13 13:09:03,267 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:03,267 [INFO]: 	index_param: efSearch=228
2025-03-13 13:09:03,267 [INFO]: 	index_path: knn.index
2025-03-13 13:09:03,267 [INFO]: 	size in bytes: 580590910
2025-03-13 13:09:03,267 [INFO]: 	avg_search_speed_ms: 8.431951113517945
2025-03-13 13:09:03,267 [INFO]: 	99p_search_speed_ms: 11.2836183863692
2025-03-13 13:09:03,267 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:03,267 [INFO]: 	nb vectors: 2951
2025-03-13 13:09:03,267 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:03,267 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-13 13:09:03,267 [INFO]: }
2025-03-13 13:09:03,267 [INFO]: 	>>> Finished "Creating the index" in 56.7856 secs
2025-03-13 13:09:03,267 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8138 secs
2025-03-13 13:09:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 10243 [episode count 1/20]
[retrieval_preprocessing] for episode 27652 [episode count 2/20], we have num_retrieval=np.int64(2920) num_query=np.int64(167)
2025-03-13 13:09:04,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:05,068 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:05
2025-03-13 13:09:05,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.33it/s]
2025-03-13 13:09:05,097 [INFO]: There are 2920 embeddings of dim 49152
2025-03-13 13:09:05,098 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 13:09:05,099 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:05
2025-03-13 13:09:05,099 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:05,099 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:09:05,099 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:09:05,099 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:09:05,099 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:05
2025-03-13 13:09:05,100 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:05,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:09:05,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:05
2025-03-13 13:09:05,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:05,101 [INFO]: 	Creating the index 03/13/2025, 13:09:05
2025-03-13 13:09:05,101 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:09:05
2025-03-13 13:09:05,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:09:05,104 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:05
2025-03-13 13:09:05,104 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:09:05,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.95it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.14it/s]100%|██████████| 12/12 [00:02<00:00,  4.48it/s]100%|██████████| 12/12 [00:02<00:00,  5.44it/s]
2025-03-13 13:09:07,316 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:09:07
2025-03-13 13:09:39,760 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4439 secs
2025-03-13 13:09:39,760 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 13:09:39,760 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.49s/it] 50%|█████     | 2/4 [00:03<00:02,  1.45s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.09s/it]
2025-03-13 13:10:06,255 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4943 secs
2025-03-13 13:10:06,257 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1528 secs
2025-03-13 13:10:06,257 [INFO]: {
2025-03-13 13:10:06,257 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:06,257 [INFO]: 	index_param: efSearch=221
2025-03-13 13:10:06,257 [INFO]: 	index_path: knn.index
2025-03-13 13:10:06,257 [INFO]: 	size in bytes: 574491850
2025-03-13 13:10:06,257 [INFO]: 	avg_search_speed_ms: 8.321860089228673
2025-03-13 13:10:06,257 [INFO]: 	99p_search_speed_ms: 11.407275781966746
2025-03-13 13:10:06,257 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:06,257 [INFO]: 	nb vectors: 2920
2025-03-13 13:10:06,257 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:06,257 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-13 13:10:06,257 [INFO]: }
2025-03-13 13:10:06,257 [INFO]: 	>>> Finished "Creating the index" in 61.1567 secs
2025-03-13 13:10:06,257 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1896 secs
2025-03-13 13:10:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 27652 [episode count 2/20]
[retrieval_preprocessing] for episode 36377 [episode count 3/20], we have num_retrieval=np.int64(2941) num_query=np.int64(146)
2025-03-13 13:10:07,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:08,329 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:08
2025-03-13 13:10:08,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-13 13:10:08,356 [INFO]: There are 2941 embeddings of dim 49152
2025-03-13 13:10:08,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 13:10:08,356 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:08
2025-03-13 13:10:08,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:08,356 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:10:08,356 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:08,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:10:08,356 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:08
2025-03-13 13:10:08,356 [INFO]: 607.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:08,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:08,356 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:08
2025-03-13 13:10:08,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:08,356 [INFO]: 	Creating the index 03/13/2025, 13:10:08
2025-03-13 13:10:08,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:08
2025-03-13 13:10:08,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:10:08,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:08
2025-03-13 13:10:08,358 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:10:08,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.77it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.60it/s]100%|██████████| 12/12 [00:02<00:00,  4.66it/s]100%|██████████| 12/12 [00:02<00:00,  5.52it/s]
2025-03-13 13:10:10,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:10
2025-03-13 13:10:46,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5966 secs
2025-03-13 13:10:46,130 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 13:10:46,130 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.65it/s]
2025-03-13 13:11:01,291 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1604 secs
2025-03-13 13:11:01,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9357 secs
2025-03-13 13:11:01,294 [INFO]: {
2025-03-13 13:11:01,294 [INFO]: 	index_key: HNSW15
2025-03-13 13:11:01,294 [INFO]: 	index_param: efSearch=165
2025-03-13 13:11:01,294 [INFO]: 	index_path: knn.index
2025-03-13 13:11:01,294 [INFO]: 	size in bytes: 578623510
2025-03-13 13:11:01,294 [INFO]: 	avg_search_speed_ms: 8.285270712370023
2025-03-13 13:11:01,294 [INFO]: 	99p_search_speed_ms: 11.856919387355449
2025-03-13 13:11:01,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:11:01,294 [INFO]: 	nb vectors: 2941
2025-03-13 13:11:01,294 [INFO]: 	vectors dimension: 49152
2025-03-13 13:11:01,294 [INFO]: 	compression ratio: 0.9993097722558836
2025-03-13 13:11:01,294 [INFO]: }
2025-03-13 13:11:01,294 [INFO]: 	>>> Finished "Creating the index" in 52.9374 secs
2025-03-13 13:11:01,294 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9645 secs
2025-03-13 13:11:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:11:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 36377 [episode count 3/20]
[retrieval_preprocessing] for episode 68128 [episode count 4/20], we have num_retrieval=np.int64(2942) num_query=np.int64(145)
2025-03-13 13:11:02,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:11:03,665 [INFO]: Launching the whole pipeline 03/13/2025, 13:11:03
2025-03-13 13:11:03,665 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:11:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.28it/s]
2025-03-13 13:11:03,693 [INFO]: There are 2942 embeddings of dim 49152
2025-03-13 13:11:03,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 13:11:03,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:11:03
2025-03-13 13:11:03,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:11:03,693 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:11:03,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:11:03,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:11:03,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:11:03
2025-03-13 13:11:03,693 [INFO]: 607.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:11:03,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:11:03,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:11:03
2025-03-13 13:11:03,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:11:03,694 [INFO]: 	Creating the index 03/13/2025, 13:11:03
2025-03-13 13:11:03,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:11:03
2025-03-13 13:11:03,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:11:03,695 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:11:03
2025-03-13 13:11:03,695 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:11:03,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.70it/s] 50%|█████     | 6/12 [00:00<00:00, 31.26it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.73it/s]100%|██████████| 12/12 [00:02<00:00,  4.71it/s]
2025-03-13 13:11:06,250 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:11:06
2025-03-13 13:11:44,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1832 secs
2025-03-13 13:11:44,434 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 13:11:44,434 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.93it/s]
2025-03-13 13:12:03,139 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7056 secs
2025-03-13 13:12:03,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4463 secs
2025-03-13 13:12:03,142 [INFO]: {
2025-03-13 13:12:03,142 [INFO]: 	index_key: HNSW15
2025-03-13 13:12:03,142 [INFO]: 	index_param: efSearch=262
2025-03-13 13:12:03,142 [INFO]: 	index_path: knn.index
2025-03-13 13:12:03,142 [INFO]: 	size in bytes: 578820250
2025-03-13 13:12:03,142 [INFO]: 	avg_search_speed_ms: 10.862462398526334
2025-03-13 13:12:03,142 [INFO]: 	99p_search_speed_ms: 15.821489552035924
2025-03-13 13:12:03,142 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:03,142 [INFO]: 	nb vectors: 2942
2025-03-13 13:12:03,142 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:03,142 [INFO]: 	compression ratio: 0.9993097788130253
2025-03-13 13:12:03,142 [INFO]: }
2025-03-13 13:12:03,142 [INFO]: 	>>> Finished "Creating the index" in 59.4480 secs
2025-03-13 13:12:03,142 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4767 secs
2025-03-13 13:12:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:12:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 68128 [episode count 4/20]
[retrieval_preprocessing] for episode 1060 [episode count 5/20], we have num_retrieval=np.int64(2914) num_query=np.int64(173)
2025-03-13 13:12:04,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:12:05,108 [INFO]: Launching the whole pipeline 03/13/2025, 13:12:05
2025-03-13 13:12:05,108 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:12:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.81it/s]
2025-03-13 13:12:05,133 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 13:12:05,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 13:12:05,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:12:05
2025-03-13 13:12:05,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:12:05,134 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:12:05,134 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:12:05,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:12:05,134 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:12:05
2025-03-13 13:12:05,134 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:12:05,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:12:05,134 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:12:05
2025-03-13 13:12:05,134 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:12:05,134 [INFO]: 	Creating the index 03/13/2025, 13:12:05
2025-03-13 13:12:05,134 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:12:05
2025-03-13 13:12:05,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:12:05,135 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:12:05
2025-03-13 13:12:05,135 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:12:05,135 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.37it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.28it/s]100%|██████████| 12/12 [00:02<00:00,  4.25it/s]100%|██████████| 12/12 [00:02<00:00,  5.17it/s]
2025-03-13 13:12:07,460 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:07
2025-03-13 13:12:43,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4848 secs
2025-03-13 13:12:43,946 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 13:12:43,946 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-13 13:13:06,128 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1816 secs
2025-03-13 13:13:06,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9945 secs
2025-03-13 13:13:06,130 [INFO]: {
2025-03-13 13:13:06,130 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:06,130 [INFO]: 	index_param: efSearch=227
2025-03-13 13:13:06,130 [INFO]: 	index_path: knn.index
2025-03-13 13:13:06,130 [INFO]: 	size in bytes: 573311410
2025-03-13 13:13:06,130 [INFO]: 	avg_search_speed_ms: 8.55484282935693
2025-03-13 13:13:06,130 [INFO]: 	99p_search_speed_ms: 12.118618851527572
2025-03-13 13:13:06,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:06,130 [INFO]: 	nb vectors: 2914
2025-03-13 13:13:06,130 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:06,130 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 13:13:06,130 [INFO]: }
2025-03-13 13:13:06,130 [INFO]: 	>>> Finished "Creating the index" in 60.9962 secs
2025-03-13 13:13:06,130 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0226 secs
2025-03-13 13:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 1060 [episode count 5/20]
[retrieval_preprocessing] for episode 71206 [episode count 6/20], we have num_retrieval=np.int64(2958) num_query=np.int64(129)
2025-03-13 13:13:08,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:09,058 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:09
2025-03-13 13:13:09,058 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.95it/s]
2025-03-13 13:13:09,083 [INFO]: There are 2958 embeddings of dim 49152
2025-03-13 13:13:09,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 13:13:09,083 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:09
2025-03-13 13:13:09,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:09,083 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:13:09,083 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:09,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:09,083 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:09
2025-03-13 13:13:09,083 [INFO]: 610.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:09,083 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:13:09,083 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:09
2025-03-13 13:13:09,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:09,084 [INFO]: 	Creating the index 03/13/2025, 13:13:09
2025-03-13 13:13:09,084 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:09
2025-03-13 13:13:09,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:13:09,085 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:09
2025-03-13 13:13:09,085 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:13:09,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.03it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.98it/s]100%|██████████| 12/12 [00:02<00:00,  4.69it/s]100%|██████████| 12/12 [00:02<00:00,  5.69it/s]
2025-03-13 13:13:11,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:11
2025-03-13 13:13:45,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3203 secs
2025-03-13 13:13:45,519 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 13:13:45,519 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-13 13:14:00,582 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0638 secs
2025-03-13 13:14:00,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4996 secs
2025-03-13 13:14:00,584 [INFO]: {
2025-03-13 13:14:00,585 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:00,585 [INFO]: 	index_param: efSearch=208
2025-03-13 13:14:00,585 [INFO]: 	index_path: knn.index
2025-03-13 13:14:00,585 [INFO]: 	size in bytes: 581968210
2025-03-13 13:14:00,585 [INFO]: 	avg_search_speed_ms: 8.601256744713488
2025-03-13 13:14:00,585 [INFO]: 	99p_search_speed_ms: 12.496304246596987
2025-03-13 13:14:00,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:00,585 [INFO]: 	nb vectors: 2958
2025-03-13 13:14:00,585 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:00,585 [INFO]: 	compression ratio: 0.999309677069818
2025-03-13 13:14:00,585 [INFO]: }
2025-03-13 13:14:00,585 [INFO]: 	>>> Finished "Creating the index" in 51.5011 secs
2025-03-13 13:14:00,585 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5263 secs
2025-03-13 13:14:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 71206 [episode count 6/20]
[retrieval_preprocessing] for episode 45608 [episode count 7/20], we have num_retrieval=np.int64(2939) num_query=np.int64(148)
2025-03-13 13:14:01,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:14:02,227 [INFO]: Launching the whole pipeline 03/13/2025, 13:14:02
2025-03-13 13:14:02,227 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:14:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.87it/s]
2025-03-13 13:14:02,252 [INFO]: There are 2939 embeddings of dim 49152
2025-03-13 13:14:02,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 13:14:02,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:14:02
2025-03-13 13:14:02,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:14:02,253 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:14:02,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:14:02,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:14:02,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:14:02
2025-03-13 13:14:02,253 [INFO]: 606.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:14:02,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:14:02,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:14:02
2025-03-13 13:14:02,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:14:02,253 [INFO]: 	Creating the index 03/13/2025, 13:14:02
2025-03-13 13:14:02,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:14:02
2025-03-13 13:14:02,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:14:02,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:14:02
2025-03-13 13:14:02,254 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:14:02,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.31it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.71it/s]100%|██████████| 12/12 [00:01<00:00,  5.10it/s]100%|██████████| 12/12 [00:01<00:00,  6.01it/s]
2025-03-13 13:14:04,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:14:04
2025-03-13 13:14:39,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0677 secs
2025-03-13 13:14:39,323 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 13:14:39,323 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.95it/s]
2025-03-13 13:15:01,775 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4523 secs
2025-03-13 13:15:01,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5226 secs
2025-03-13 13:15:01,777 [INFO]: {
2025-03-13 13:15:01,777 [INFO]: 	index_key: HNSW15
2025-03-13 13:15:01,777 [INFO]: 	index_param: efSearch=249
2025-03-13 13:15:01,777 [INFO]: 	index_path: knn.index
2025-03-13 13:15:01,777 [INFO]: 	size in bytes: 578230030
2025-03-13 13:15:01,777 [INFO]: 	avg_search_speed_ms: 8.540568192490241
2025-03-13 13:15:01,777 [INFO]: 	99p_search_speed_ms: 12.653263122774655
2025-03-13 13:15:01,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:01,777 [INFO]: 	nb vectors: 2939
2025-03-13 13:15:01,777 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:01,777 [INFO]: 	compression ratio: 0.9993097591282141
2025-03-13 13:15:01,777 [INFO]: }
2025-03-13 13:15:01,777 [INFO]: 	>>> Finished "Creating the index" in 59.5240 secs
2025-03-13 13:15:01,777 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5499 secs
2025-03-13 13:15:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 45608 [episode count 7/20]
[retrieval_preprocessing] for episode 10287 [episode count 8/20], we have num_retrieval=np.int64(2869) num_query=np.int64(218)
2025-03-13 13:15:04,056 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:04,550 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:04
2025-03-13 13:15:04,550 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.81it/s]
2025-03-13 13:15:04,575 [INFO]: There are 2869 embeddings of dim 49152
2025-03-13 13:15:04,575 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 13:15:04,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:04
2025-03-13 13:15:04,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:04,576 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:15:04,576 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:04,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:04,576 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:04
2025-03-13 13:15:04,576 [INFO]: 592.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:04,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:15:04,576 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:04
2025-03-13 13:15:04,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:04,576 [INFO]: 	Creating the index 03/13/2025, 13:15:04
2025-03-13 13:15:04,576 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:04
2025-03-13 13:15:04,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:15:04,577 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:04
2025-03-13 13:15:04,577 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:15:04,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.16it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.25it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.28it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]
2025-03-13 13:15:07,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:07
2025-03-13 13:15:46,364 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8413 secs
2025-03-13 13:15:46,364 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 13:15:46,365 [INFO]: 	Compute fast metrics 03/13/2025, 13:15:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.50it/s]
2025-03-13 13:16:01,575 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2101 secs
2025-03-13 13:16:01,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9997 secs
2025-03-13 13:16:01,577 [INFO]: {
2025-03-13 13:16:01,577 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:01,577 [INFO]: 	index_param: efSearch=255
2025-03-13 13:16:01,577 [INFO]: 	index_path: knn.index
2025-03-13 13:16:01,577 [INFO]: 	size in bytes: 564457990
2025-03-13 13:16:01,577 [INFO]: 	avg_search_speed_ms: 10.927236211979812
2025-03-13 13:16:01,577 [INFO]: 	99p_search_speed_ms: 14.150689360685647
2025-03-13 13:16:01,577 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:01,577 [INFO]: 	nb vectors: 2869
2025-03-13 13:16:01,577 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:01,577 [INFO]: 	compression ratio: 0.9993097130222216
2025-03-13 13:16:01,577 [INFO]: }
2025-03-13 13:16:01,577 [INFO]: 	>>> Finished "Creating the index" in 57.0011 secs
2025-03-13 13:16:01,577 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0270 secs
2025-03-13 13:16:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 10287 [episode count 8/20]
[retrieval_preprocessing] for episode 53296 [episode count 9/20], we have num_retrieval=np.int64(2891) num_query=np.int64(196)
2025-03-13 13:16:04,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:04,440 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:04
2025-03-13 13:16:04,440 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2341.88it/s]
2025-03-13 13:16:04,469 [INFO]: There are 2891 embeddings of dim 49152
2025-03-13 13:16:04,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 13:16:04,469 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:04
2025-03-13 13:16:04,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:04,470 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:16:04,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:04,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:16:04,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:04
2025-03-13 13:16:04,471 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:04,471 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:16:04,471 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:04
2025-03-13 13:16:04,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:04,471 [INFO]: 	Creating the index 03/13/2025, 13:16:04
2025-03-13 13:16:04,472 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:04
2025-03-13 13:16:04,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 13:16:04,475 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:04
2025-03-13 13:16:04,475 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:16:04,475 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.22it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.83it/s]100%|██████████| 12/12 [00:02<00:00,  4.44it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-13 13:16:06,707 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:06
2025-03-13 13:16:44,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5126 secs
2025-03-13 13:16:44,221 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 13:16:44,221 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 13:16:58,352 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1314 secs
2025-03-13 13:16:58,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8790 secs
2025-03-13 13:16:58,354 [INFO]: {
2025-03-13 13:16:58,354 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:58,354 [INFO]: 	index_param: efSearch=240
2025-03-13 13:16:58,354 [INFO]: 	index_path: knn.index
2025-03-13 13:16:58,354 [INFO]: 	size in bytes: 568786330
2025-03-13 13:16:58,354 [INFO]: 	avg_search_speed_ms: 10.660166126131806
2025-03-13 13:16:58,354 [INFO]: 	99p_search_speed_ms: 19.849160539451983
2025-03-13 13:16:58,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:58,354 [INFO]: 	nb vectors: 2891
2025-03-13 13:16:58,354 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:58,354 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-13 13:16:58,354 [INFO]: }
2025-03-13 13:16:58,354 [INFO]: 	>>> Finished "Creating the index" in 53.8827 secs
2025-03-13 13:16:58,354 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9145 secs
2025-03-13 13:16:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 53296 [episode count 9/20]
[retrieval_preprocessing] for episode 54837 [episode count 10/20], we have num_retrieval=np.int64(2960) num_query=np.int64(127)
2025-03-13 13:17:00,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:00,612 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:00
2025-03-13 13:17:00,612 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.00it/s]
2025-03-13 13:17:00,635 [INFO]: There are 2960 embeddings of dim 49152
2025-03-13 13:17:00,636 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 13:17:00,636 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:00
2025-03-13 13:17:00,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:00,636 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:17:00,636 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:17:00,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:17:00,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:00
2025-03-13 13:17:00,636 [INFO]: 610.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:00,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:17:00,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:00
2025-03-13 13:17:00,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:00,636 [INFO]: 	Creating the index 03/13/2025, 13:17:00
2025-03-13 13:17:00,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:17:00
2025-03-13 13:17:00,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:17:00,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:00
2025-03-13 13:17:00,637 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:17:00,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.50it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.22it/s]100%|██████████| 12/12 [00:02<00:00,  4.07it/s]100%|██████████| 12/12 [00:02<00:00,  4.96it/s]
2025-03-13 13:17:03,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:03
2025-03-13 13:17:41,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9648 secs
2025-03-13 13:17:41,028 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 13:17:41,028 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 50%|█████     | 2/4 [00:04<00:05,  2.51s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.45s/it]
2025-03-13 13:17:59,752 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7244 secs
2025-03-13 13:18:00,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0425 secs
2025-03-13 13:18:00,680 [INFO]: {
2025-03-13 13:18:00,680 [INFO]: 	index_key: HNSW15
2025-03-13 13:18:00,680 [INFO]: 	index_param: efSearch=213
2025-03-13 13:18:00,680 [INFO]: 	index_path: knn.index
2025-03-13 13:18:00,680 [INFO]: 	size in bytes: 582361750
2025-03-13 13:18:00,680 [INFO]: 	avg_search_speed_ms: 8.680205758234175
2025-03-13 13:18:00,680 [INFO]: 	99p_search_speed_ms: 12.881597341038287
2025-03-13 13:18:00,681 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:00,681 [INFO]: 	nb vectors: 2960
2025-03-13 13:18:00,681 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:00,681 [INFO]: 	compression ratio: 0.9993095872110419
2025-03-13 13:18:00,681 [INFO]: }
2025-03-13 13:18:00,681 [INFO]: 	>>> Finished "Creating the index" in 60.0446 secs
2025-03-13 13:18:00,681 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0688 secs
2025-03-13 13:18:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 54837 [episode count 10/20]
[retrieval_preprocessing] for episode 70198 [episode count 11/20], we have num_retrieval=np.int64(2947) num_query=np.int64(140)
2025-03-13 13:18:01,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:02,229 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:02
2025-03-13 13:18:02,229 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.71it/s]
2025-03-13 13:18:02,256 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 13:18:02,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 13:18:02,257 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:02
2025-03-13 13:18:02,257 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:02,258 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:18:02,258 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:18:02,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:18:02,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:02
2025-03-13 13:18:02,258 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:02,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:18:02,258 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:02
2025-03-13 13:18:02,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:02,259 [INFO]: 	Creating the index 03/13/2025, 13:18:02
2025-03-13 13:18:02,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:18:02
2025-03-13 13:18:02,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 13:18:02,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:02
2025-03-13 13:18:02,263 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:18:02,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.02it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.31it/s]100%|██████████| 12/12 [00:02<00:00,  5.55it/s]
2025-03-13 13:18:04,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:18:04
2025-03-13 13:18:38,671 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2388 secs
2025-03-13 13:18:38,671 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 13:18:38,671 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-13 13:19:00,079 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4073 secs
2025-03-13 13:19:00,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8202 secs
2025-03-13 13:19:00,083 [INFO]: {
2025-03-13 13:19:00,083 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:00,083 [INFO]: 	index_param: efSearch=218
2025-03-13 13:19:00,083 [INFO]: 	index_path: knn.index
2025-03-13 13:19:00,083 [INFO]: 	size in bytes: 579803950
2025-03-13 13:19:00,083 [INFO]: 	avg_search_speed_ms: 11.337335777309717
2025-03-13 13:19:00,083 [INFO]: 	99p_search_speed_ms: 16.63477057125419
2025-03-13 13:19:00,083 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:00,083 [INFO]: 	nb vectors: 2947
2025-03-13 13:19:00,083 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:00,083 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 13:19:00,083 [INFO]: }
2025-03-13 13:19:00,084 [INFO]: 	>>> Finished "Creating the index" in 57.8244 secs
2025-03-13 13:19:00,084 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8545 secs
2025-03-13 13:19:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 70198 [episode count 11/20]
[retrieval_preprocessing] for episode 45632 [episode count 12/20], we have num_retrieval=np.int64(2914) num_query=np.int64(173)
2025-03-13 13:19:02,062 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:02,669 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:02
2025-03-13 13:19:02,669 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1039.74it/s]
2025-03-13 13:19:02,697 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 13:19:02,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 13:19:02,698 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:02
2025-03-13 13:19:02,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:02,698 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:19:02,698 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:02,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:02,698 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:02
2025-03-13 13:19:02,698 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:02,698 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:19:02,698 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:02
2025-03-13 13:19:02,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:02,698 [INFO]: 	Creating the index 03/13/2025, 13:19:02
2025-03-13 13:19:02,698 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:02
2025-03-13 13:19:02,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:19:02,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:02
2025-03-13 13:19:02,700 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:19:02,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.22it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.47it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.93it/s]100%|██████████| 12/12 [00:02<00:00,  4.36it/s]
2025-03-13 13:19:05,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:05
2025-03-13 13:19:45,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2871 secs
2025-03-13 13:19:45,741 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 13:19:45,741 [INFO]: 	Compute fast metrics 03/13/2025, 13:19:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.56it/s]
2025-03-13 13:20:00,840 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0992 secs
2025-03-13 13:20:00,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1424 secs
2025-03-13 13:20:00,842 [INFO]: {
2025-03-13 13:20:00,842 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:00,842 [INFO]: 	index_param: efSearch=226
2025-03-13 13:20:00,842 [INFO]: 	index_path: knn.index
2025-03-13 13:20:00,842 [INFO]: 	size in bytes: 573311410
2025-03-13 13:20:00,842 [INFO]: 	avg_search_speed_ms: 9.24357392049658
2025-03-13 13:20:00,842 [INFO]: 	99p_search_speed_ms: 16.4395359903574
2025-03-13 13:20:00,842 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:00,842 [INFO]: 	nb vectors: 2914
2025-03-13 13:20:00,842 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:00,842 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 13:20:00,842 [INFO]: }
2025-03-13 13:20:00,842 [INFO]: 	>>> Finished "Creating the index" in 58.1441 secs
2025-03-13 13:20:00,843 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1732 secs
2025-03-13 13:20:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 45632 [episode count 12/20]
[retrieval_preprocessing] for episode 67139 [episode count 13/20], we have num_retrieval=np.int64(2945) num_query=np.int64(142)
2025-03-13 13:20:02,363 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:03,072 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:03
2025-03-13 13:20:03,072 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.55it/s]
2025-03-13 13:20:03,100 [INFO]: There are 2945 embeddings of dim 49152
2025-03-13 13:20:03,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 13:20:03,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:03
2025-03-13 13:20:03,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:03,101 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:20:03,101 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:03,101 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 13:20:03,101 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:03
2025-03-13 13:20:03,102 [INFO]: 607.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:03,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 13:20:03,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:03
2025-03-13 13:20:03,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:03,103 [INFO]: 	Creating the index 03/13/2025, 13:20:03
2025-03-13 13:20:03,103 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:03
2025-03-13 13:20:03,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 13:20:03,106 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:03
2025-03-13 13:20:03,106 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:20:03,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.60it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.52it/s]100%|██████████| 12/12 [00:02<00:00,  5.49it/s]
2025-03-13 13:20:05,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:05
2025-03-13 13:20:42,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7359 secs
2025-03-13 13:20:42,034 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 13:20:42,034 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 13:20:55,367 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3321 secs
2025-03-13 13:20:55,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2627 secs
2025-03-13 13:20:55,369 [INFO]: {
2025-03-13 13:20:55,369 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:55,369 [INFO]: 	index_param: efSearch=246
2025-03-13 13:20:55,369 [INFO]: 	index_path: knn.index
2025-03-13 13:20:55,369 [INFO]: 	size in bytes: 579410470
2025-03-13 13:20:55,369 [INFO]: 	avg_search_speed_ms: 9.854066276262179
2025-03-13 13:20:55,369 [INFO]: 	99p_search_speed_ms: 17.084398171864464
2025-03-13 13:20:55,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:55,370 [INFO]: 	nb vectors: 2945
2025-03-13 13:20:55,370 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:55,370 [INFO]: 	compression ratio: 0.9993097984577324
2025-03-13 13:20:55,370 [INFO]: }
2025-03-13 13:20:55,370 [INFO]: 	>>> Finished "Creating the index" in 52.2672 secs
2025-03-13 13:20:55,370 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2983 secs
2025-03-13 13:20:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 67139 [episode count 13/20]
[retrieval_preprocessing] for episode 587 [episode count 14/20], we have num_retrieval=np.int64(2946) num_query=np.int64(141)
2025-03-13 13:20:57,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:57,850 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:57
2025-03-13 13:20:57,850 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-13 13:20:57,876 [INFO]: There are 2946 embeddings of dim 49152
2025-03-13 13:20:57,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 13:20:57,876 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:57
2025-03-13 13:20:57,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:57,876 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:20:57,876 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:57,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:20:57,877 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:57
2025-03-13 13:20:57,877 [INFO]: 608.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:57,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:20:57,877 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:57
2025-03-13 13:20:57,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:57,877 [INFO]: 	Creating the index 03/13/2025, 13:20:57
2025-03-13 13:20:57,877 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:57
2025-03-13 13:20:57,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:20:57,878 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:57
2025-03-13 13:20:57,878 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:20:57,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.73it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.76it/s]100%|██████████| 12/12 [00:02<00:00,  3.58it/s]100%|██████████| 12/12 [00:02<00:00,  4.38it/s]
2025-03-13 13:21:01,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:01
2025-03-13 13:21:37,231 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0321 secs
2025-03-13 13:21:37,231 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 13:21:37,231 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.95it/s]
2025-03-13 13:21:55,957 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7258 secs
2025-03-13 13:21:55,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0817 secs
2025-03-13 13:21:55,960 [INFO]: {
2025-03-13 13:21:55,960 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:55,960 [INFO]: 	index_param: efSearch=225
2025-03-13 13:21:55,960 [INFO]: 	index_path: knn.index
2025-03-13 13:21:55,960 [INFO]: 	size in bytes: 579607210
2025-03-13 13:21:55,960 [INFO]: 	avg_search_speed_ms: 11.23127936517274
2025-03-13 13:21:55,960 [INFO]: 	99p_search_speed_ms: 14.890633942559363
2025-03-13 13:21:55,960 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:55,960 [INFO]: 	nb vectors: 2946
2025-03-13 13:21:55,960 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:55,960 [INFO]: 	compression ratio: 0.9993098049970772
2025-03-13 13:21:55,960 [INFO]: }
2025-03-13 13:21:55,960 [INFO]: 	>>> Finished "Creating the index" in 58.0834 secs
2025-03-13 13:21:55,960 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1104 secs
2025-03-13 13:21:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 587 [episode count 14/20]
[retrieval_preprocessing] for episode 28235 [episode count 15/20], we have num_retrieval=np.int64(2959) num_query=np.int64(128)
2025-03-13 13:21:58,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:59,080 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:59
2025-03-13 13:21:59,080 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.08it/s]
2025-03-13 13:21:59,113 [INFO]: There are 2959 embeddings of dim 49152
2025-03-13 13:21:59,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 13:21:59,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:59,114 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:21:59,114 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:59,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:21:59,114 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,114 [INFO]: 610.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:59,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:21:59,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:59
2025-03-13 13:21:59,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:59,114 [INFO]: 	Creating the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:59
2025-03-13 13:21:59,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:21:59,115 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:59
2025-03-13 13:21:59,115 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:21:59,115 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.79it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.69it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.36it/s] 50%|█████     | 6/12 [00:00<00:00,  9.80it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.91it/s] 83%|████████▎ | 10/12 [00:01<00:00, 10.03it/s]100%|██████████| 12/12 [00:03<00:00,  1.89it/s]100%|██████████| 12/12 [00:03<00:00,  3.20it/s]
2025-03-13 13:22:02,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:22:02
2025-03-13 13:22:36,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7589 secs
2025-03-13 13:22:36,635 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 13:22:36,635 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 13:22:54,662 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0270 secs
2025-03-13 13:22:54,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5496 secs
2025-03-13 13:22:54,665 [INFO]: {
2025-03-13 13:22:54,665 [INFO]: 	index_key: HNSW15
2025-03-13 13:22:54,665 [INFO]: 	index_param: efSearch=264
2025-03-13 13:22:54,665 [INFO]: 	index_path: knn.index
2025-03-13 13:22:54,665 [INFO]: 	size in bytes: 582164950
2025-03-13 13:22:54,665 [INFO]: 	avg_search_speed_ms: 8.94976223734747
2025-03-13 13:22:54,665 [INFO]: 	99p_search_speed_ms: 13.224474592134346
2025-03-13 13:22:54,665 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:22:54,665 [INFO]: 	nb vectors: 2959
2025-03-13 13:22:54,665 [INFO]: 	vectors dimension: 49152
2025-03-13 13:22:54,665 [INFO]: 	compression ratio: 0.9993096836214547
2025-03-13 13:22:54,665 [INFO]: }
2025-03-13 13:22:54,665 [INFO]: 	>>> Finished "Creating the index" in 55.5513 secs
2025-03-13 13:22:54,665 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5849 secs
2025-03-13 13:22:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:22:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 28235 [episode count 15/20]
[retrieval_preprocessing] for episode 87635 [episode count 16/20], we have num_retrieval=np.int64(2947) num_query=np.int64(140)
2025-03-13 13:22:56,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:22:58,384 [INFO]: Launching the whole pipeline 03/13/2025, 13:22:58
2025-03-13 13:22:58,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:22:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1321.46it/s]
2025-03-13 13:22:58,413 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 13:22:58,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 13:22:58,413 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:22:58,413 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:22:58,413 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:22:58,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:22:58,413 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,413 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:22:58,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:22:58,414 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:22:58
2025-03-13 13:22:58,414 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:22:58,414 [INFO]: 	Creating the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,414 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:22:58
2025-03-13 13:22:58,415 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 13:22:58,415 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:22:58
2025-03-13 13:22:58,415 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:22:58,415 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.09it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.38it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.42it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.31it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.04it/s] 92%|█████████▏| 11/12 [00:00<00:00, 14.13it/s]100%|██████████| 12/12 [00:03<00:00,  3.23it/s]
2025-03-13 13:23:02,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:02
2025-03-13 13:23:33,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3307 secs
2025-03-13 13:23:33,472 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 13:23:33,472 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 13:23:49,273 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8006 secs
2025-03-13 13:23:49,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8603 secs
2025-03-13 13:23:49,276 [INFO]: {
2025-03-13 13:23:49,276 [INFO]: 	index_key: HNSW15
2025-03-13 13:23:49,276 [INFO]: 	index_param: efSearch=234
2025-03-13 13:23:49,276 [INFO]: 	index_path: knn.index
2025-03-13 13:23:49,276 [INFO]: 	size in bytes: 579803950
2025-03-13 13:23:49,276 [INFO]: 	avg_search_speed_ms: 9.382630970528242
2025-03-13 13:23:49,276 [INFO]: 	99p_search_speed_ms: 18.38848020415746
2025-03-13 13:23:49,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:23:49,276 [INFO]: 	nb vectors: 2947
2025-03-13 13:23:49,276 [INFO]: 	vectors dimension: 49152
2025-03-13 13:23:49,276 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 13:23:49,276 [INFO]: }
2025-03-13 13:23:49,276 [INFO]: 	>>> Finished "Creating the index" in 50.8622 secs
2025-03-13 13:23:49,276 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8916 secs
2025-03-13 13:23:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:23:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 87635 [episode count 16/20]
[retrieval_preprocessing] for episode 37974 [episode count 17/20], we have num_retrieval=np.int64(2980) num_query=np.int64(107)
2025-03-13 13:23:50,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:23:50,992 [INFO]: Launching the whole pipeline 03/13/2025, 13:23:50
2025-03-13 13:23:50,992 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:23:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 995.09it/s]
2025-03-13 13:23:51,021 [INFO]: There are 2980 embeddings of dim 49152
2025-03-13 13:23:51,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 13:23:51,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:23:51
2025-03-13 13:23:51,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:23:51,021 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:23:51,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:23:51,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:23:51,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:23:51
2025-03-13 13:23:51,021 [INFO]: 615.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:23:51,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:23:51,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:23:51
2025-03-13 13:23:51,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:23:51,022 [INFO]: 	Creating the index 03/13/2025, 13:23:51
2025-03-13 13:23:51,022 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:23:51
2025-03-13 13:23:51,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:23:51,023 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:23:51
2025-03-13 13:23:51,023 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:23:51,023 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.27it/s] 67%|██████▋   | 8/12 [00:00<00:00, 42.66it/s]100%|██████████| 12/12 [00:02<00:00,  5.82it/s]
2025-03-13 13:23:53,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:53
2025-03-13 13:24:32,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4454 secs
2025-03-13 13:24:32,535 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 13:24:32,535 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.83it/s]
2025-03-13 13:24:49,764 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2285 secs
2025-03-13 13:24:49,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.7441 secs
2025-03-13 13:24:49,767 [INFO]: {
2025-03-13 13:24:49,767 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:49,767 [INFO]: 	index_param: efSearch=182
2025-03-13 13:24:49,767 [INFO]: 	index_path: knn.index
2025-03-13 13:24:49,767 [INFO]: 	size in bytes: 586296610
2025-03-13 13:24:49,767 [INFO]: 	avg_search_speed_ms: 9.27304930594837
2025-03-13 13:24:49,767 [INFO]: 	99p_search_speed_ms: 13.912091623060407
2025-03-13 13:24:49,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:49,767 [INFO]: 	nb vectors: 2980
2025-03-13 13:24:49,767 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:49,767 [INFO]: 	compression ratio: 0.999309615656826
2025-03-13 13:24:49,767 [INFO]: }
2025-03-13 13:24:49,767 [INFO]: 	>>> Finished "Creating the index" in 58.7458 secs
2025-03-13 13:24:49,767 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7750 secs
2025-03-13 13:24:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 37974 [episode count 17/20]
[retrieval_preprocessing] for episode 5723 [episode count 18/20], we have num_retrieval=np.int64(2937) num_query=np.int64(150)
2025-03-13 13:24:51,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:51,600 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:51
2025-03-13 13:24:51,600 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.91it/s]
2025-03-13 13:24:52,095 [INFO]: There are 2937 embeddings of dim 49152
2025-03-13 13:24:52,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4959 secs
2025-03-13 13:24:52,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:52
2025-03-13 13:24:52,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:52,096 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:24:52,097 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:52,097 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 13:24:52,097 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:52
2025-03-13 13:24:52,097 [INFO]: 606.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:52,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:24:52,097 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:52
2025-03-13 13:24:52,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:52,098 [INFO]: 	Creating the index 03/13/2025, 13:24:52
2025-03-13 13:24:52,098 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:52
2025-03-13 13:24:52,100 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 13:24:52,100 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:52
2025-03-13 13:24:52,100 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:24:52,101 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.16it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.02it/s]100%|██████████| 12/12 [00:02<00:00,  4.89it/s]
2025-03-13 13:24:54,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:54
2025-03-13 13:25:35,645 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0863 secs
2025-03-13 13:25:35,646 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 13:25:35,646 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.32it/s]
2025-03-13 13:25:50,471 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8255 secs
2025-03-13 13:25:50,473 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3729 secs
2025-03-13 13:25:50,473 [INFO]: {
2025-03-13 13:25:50,473 [INFO]: 	index_key: HNSW15
2025-03-13 13:25:50,473 [INFO]: 	index_param: efSearch=196
2025-03-13 13:25:50,473 [INFO]: 	index_path: knn.index
2025-03-13 13:25:50,473 [INFO]: 	size in bytes: 577836550
2025-03-13 13:25:50,473 [INFO]: 	avg_search_speed_ms: 8.770271734408054
2025-03-13 13:25:50,473 [INFO]: 	99p_search_speed_ms: 13.129833990242332
2025-03-13 13:25:50,473 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:50,473 [INFO]: 	nb vectors: 2937
2025-03-13 13:25:50,473 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:50,473 [INFO]: 	compression ratio: 0.9993097459826659
2025-03-13 13:25:50,473 [INFO]: }
2025-03-13 13:25:50,473 [INFO]: 	>>> Finished "Creating the index" in 58.3759 secs
2025-03-13 13:25:50,473 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8736 secs
2025-03-13 13:25:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 5723 [episode count 18/20]
[retrieval_preprocessing] for episode 79448 [episode count 19/20], we have num_retrieval=np.int64(2933) num_query=np.int64(154)
2025-03-13 13:25:51,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:52,110 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:52
2025-03-13 13:25:52,110 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 13:25:52,136 [INFO]: There are 2933 embeddings of dim 49152
2025-03-13 13:25:52,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 13:25:52,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:52
2025-03-13 13:25:52,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:52,136 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 13:25:52,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:25:52,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:52,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:52
2025-03-13 13:25:52,136 [INFO]: 605.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:52,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:25:52,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:52
2025-03-13 13:25:52,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:52,137 [INFO]: 	Creating the index 03/13/2025, 13:25:52
2025-03-13 13:25:52,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:25:52
2025-03-13 13:25:52,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:25:52,138 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:52
2025-03-13 13:25:52,138 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 13:25:52,138 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.13it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.94it/s]100%|██████████| 12/12 [00:02<00:00,  5.00it/s]100%|██████████| 12/12 [00:02<00:00,  5.89it/s]
2025-03-13 13:25:54,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:54
2025-03-13 13:26:25,785 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6062 secs
2025-03-13 13:26:25,786 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 13:26:25,786 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-13 13:26:45,283 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4974 secs
2025-03-13 13:26:45,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1478 secs
2025-03-13 13:26:45,286 [INFO]: {
2025-03-13 13:26:45,286 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:45,286 [INFO]: 	index_param: efSearch=272
2025-03-13 13:26:45,286 [INFO]: 	index_path: knn.index
2025-03-13 13:26:45,286 [INFO]: 	size in bytes: 577049590
2025-03-13 13:26:45,286 [INFO]: 	avg_search_speed_ms: 10.069225158135351
2025-03-13 13:26:45,286 [INFO]: 	99p_search_speed_ms: 16.485426556319005
2025-03-13 13:26:45,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:45,286 [INFO]: 	nb vectors: 2933
2025-03-13 13:26:45,286 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:45,286 [INFO]: 	compression ratio: 0.9993097196377871
2025-03-13 13:26:45,286 [INFO]: }
2025-03-13 13:26:45,286 [INFO]: 	>>> Finished "Creating the index" in 53.1494 secs
2025-03-13 13:26:45,286 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1764 secs
2025-03-13 13:26:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 79448 [episode count 19/20]
2025-03-13 13:26:47: [retrieval_preprocessing] finished for 2782099537_pour_cup_into_bowl [chosen_id count 5/260]
2025-03-13 13:26:47: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2782099537_put_cup_in_sink [chosen_id count 6/260]
2025-03-13 13:26:47: [retrieval_preprocessing] we have num_total=3189 embedding_dim=49152
[retrieval_preprocessing] for episode 1537 [episode count 0/20], we have num_retrieval=np.int64(3065) num_query=np.int64(124)
2025-03-13 13:26:47,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:48,347 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:48
2025-03-13 13:26:48,347 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.43it/s]
2025-03-13 13:26:48,376 [INFO]: There are 3065 embeddings of dim 49152
2025-03-13 13:26:48,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 13:26:48,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:48
2025-03-13 13:26:48,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:48,376 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 13:26:48,376 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:26:48,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:26:48,377 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:48
2025-03-13 13:26:48,377 [INFO]: 632.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:48,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:26:48,377 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:48
2025-03-13 13:26:48,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:48,377 [INFO]: 	Creating the index 03/13/2025, 13:26:48
2025-03-13 13:26:48,377 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:26:48
2025-03-13 13:26:48,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:26:48,378 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:48
2025-03-13 13:26:48,378 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 13:26:48,378 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.32it/s]100%|██████████| 13/13 [00:02<00:00,  4.80it/s]100%|██████████| 13/13 [00:02<00:00,  5.60it/s]
2025-03-13 13:26:50,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:26:50
2025-03-13 13:27:26,098 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3924 secs
2025-03-13 13:27:26,098 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 13:27:26,098 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-13 13:27:45,454 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3563 secs
2025-03-13 13:27:45,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0781 secs
2025-03-13 13:27:45,456 [INFO]: {
2025-03-13 13:27:45,457 [INFO]: 	index_key: HNSW15
2025-03-13 13:27:45,457 [INFO]: 	index_param: efSearch=317
2025-03-13 13:27:45,457 [INFO]: 	index_path: knn.index
2025-03-13 13:27:45,457 [INFO]: 	size in bytes: 603019750
2025-03-13 13:27:45,457 [INFO]: 	avg_search_speed_ms: 11.873742120289647
2025-03-13 13:27:45,457 [INFO]: 	99p_search_speed_ms: 17.086752564646304
2025-03-13 13:27:45,457 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:27:45,457 [INFO]: 	nb vectors: 3065
2025-03-13 13:27:45,457 [INFO]: 	vectors dimension: 49152
2025-03-13 13:27:45,457 [INFO]: 	compression ratio: 0.9993097572674858
2025-03-13 13:27:45,457 [INFO]: }
2025-03-13 13:27:45,457 [INFO]: 	>>> Finished "Creating the index" in 57.0797 secs
2025-03-13 13:27:45,457 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1093 secs
2025-03-13 13:27:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 1537 [episode count 0/20]
[retrieval_preprocessing] for episode 24072 [episode count 1/20], we have num_retrieval=np.int64(3037) num_query=np.int64(152)
2025-03-13 13:27:47,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:47,458 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:47
2025-03-13 13:27:47,458 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2369.66it/s]
2025-03-13 13:27:47,483 [INFO]: There are 3037 embeddings of dim 49152
2025-03-13 13:27:47,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 13:27:47,483 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:47
2025-03-13 13:27:47,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:47,483 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 13:27:47,483 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:27:47,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:27:47,483 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:47
2025-03-13 13:27:47,483 [INFO]: 626.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:47,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:27:47,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:47
2025-03-13 13:27:47,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:47,484 [INFO]: 	Creating the index 03/13/2025, 13:27:47
2025-03-13 13:27:47,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:27:47
2025-03-13 13:27:47,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:27:47,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:47
2025-03-13 13:27:47,485 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 13:27:47,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.06it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.56it/s]100%|██████████| 12/12 [00:02<00:00,  5.40it/s]
2025-03-13 13:27:49,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:49
2025-03-13 13:28:28,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6987 secs
2025-03-13 13:28:28,410 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 13:28:28,410 [INFO]: 	Compute fast metrics 03/13/2025, 13:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.28it/s]
2025-03-13 13:28:43,740 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3299 secs
2025-03-13 13:28:43,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2572 secs
2025-03-13 13:28:43,742 [INFO]: {
2025-03-13 13:28:43,742 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:43,742 [INFO]: 	index_param: efSearch=230
2025-03-13 13:28:43,742 [INFO]: 	index_path: knn.index
2025-03-13 13:28:43,742 [INFO]: 	size in bytes: 597510850
2025-03-13 13:28:43,742 [INFO]: 	avg_search_speed_ms: 9.023635298734874
2025-03-13 13:28:43,742 [INFO]: 	99p_search_speed_ms: 14.820854132995024
2025-03-13 13:28:43,742 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:43,742 [INFO]: 	nb vectors: 3037
2025-03-13 13:28:43,742 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:43,742 [INFO]: 	compression ratio: 0.9993098803143072
2025-03-13 13:28:43,742 [INFO]: }
2025-03-13 13:28:43,742 [INFO]: 	>>> Finished "Creating the index" in 56.2586 secs
2025-03-13 13:28:43,742 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2842 secs
2025-03-13 13:28:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 24072 [episode count 1/20]
[retrieval_preprocessing] for episode 68617 [episode count 2/20], we have num_retrieval=np.int64(3063) num_query=np.int64(126)
2025-03-13 13:28:45,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:46,063 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:46
2025-03-13 13:28:46,063 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-13 13:28:46,086 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 13:28:46,087 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 13:28:46,087 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:46
2025-03-13 13:28:46,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:46,087 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 13:28:46,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:46,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:46,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:46
2025-03-13 13:28:46,087 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:46,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:28:46,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:46
2025-03-13 13:28:46,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:46,087 [INFO]: 	Creating the index 03/13/2025, 13:28:46
2025-03-13 13:28:46,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:46
2025-03-13 13:28:46,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:28:46,089 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:46
2025-03-13 13:28:46,089 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 13:28:46,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.40it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.47it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.31it/s]100%|██████████| 13/13 [00:02<00:00,  5.59it/s]
2025-03-13 13:28:48,417 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:48
2025-03-13 13:29:27,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4124 secs
2025-03-13 13:29:27,830 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 13:29:27,830 [INFO]: 	Compute fast metrics 03/13/2025, 13:29:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.21it/s]
