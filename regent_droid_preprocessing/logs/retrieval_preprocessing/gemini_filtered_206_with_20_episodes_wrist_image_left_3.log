2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2569763324_put_tennis_ball_in_container [chosen_id count 0/196]
2025-03-13 14:35:02: [retrieval_preprocessing] we have num_total=4379 embedding_dim=49152
[retrieval_preprocessing] for episode 8192 [episode count 0/20], we have num_retrieval=np.int64(4175) num_query=np.int64(204)
2025-03-13 14:35:02,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:03,026 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:03
2025-03-13 14:35:03,026 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 815.70it/s]
2025-03-13 14:35:03,071 [INFO]: There are 4175 embeddings of dim 49152
2025-03-13 14:35:03,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0457 secs
2025-03-13 14:35:03,072 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:03,072 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:35:03,072 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:35:03,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:03,072 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,073 [INFO]: 861.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:03,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:35:03,073 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:03
2025-03-13 14:35:03,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:03,073 [INFO]: 	Creating the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,073 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:35:03
2025-03-13 14:35:03,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:35:03,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:03
2025-03-13 14:35:03,074 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:35:03,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.32it/s] 47%|████▋     | 8/17 [00:00<00:00, 38.18it/s] 76%|███████▋  | 13/17 [00:00<00:00, 41.89it/s]100%|██████████| 17/17 [00:05<00:00,  3.15it/s]
2025-03-13 14:35:08,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:08
2025-03-13 14:36:09,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.9290 secs
2025-03-13 14:36:09,412 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:36:09,412 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 14:36:34,228 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8162 secs
2025-03-13 14:36:34,231 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1568 secs
2025-03-13 14:36:34,231 [INFO]: {
2025-03-13 14:36:34,231 [INFO]: 	index_key: HNSW15
2025-03-13 14:36:34,231 [INFO]: 	index_param: efSearch=156
2025-03-13 14:36:34,231 [INFO]: 	index_path: knn.index
2025-03-13 14:36:34,231 [INFO]: 	size in bytes: 821406250
2025-03-13 14:36:34,232 [INFO]: 	avg_search_speed_ms: 9.0613831870133
2025-03-13 14:36:34,232 [INFO]: 	99p_search_speed_ms: 11.655708397738636
2025-03-13 14:36:34,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:36:34,232 [INFO]: 	nb vectors: 4175
2025-03-13 14:36:34,232 [INFO]: 	vectors dimension: 49152
2025-03-13 14:36:34,232 [INFO]: 	compression ratio: 0.9993086855621076
2025-03-13 14:36:34,232 [INFO]: }
2025-03-13 14:36:34,232 [INFO]: 	>>> Finished "Creating the index" in 91.1587 secs
2025-03-13 14:36:34,232 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2058 secs
2025-03-13 14:36:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:36:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 8192 [episode count 0/20]
[retrieval_preprocessing] for episode 67971 [episode count 1/20], we have num_retrieval=np.int64(4148) num_query=np.int64(231)
2025-03-13 14:36:36,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:36:37,035 [INFO]: Launching the whole pipeline 03/13/2025, 14:36:37
2025-03-13 14:36:37,035 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:36:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1043.62it/s]
2025-03-13 14:36:37,066 [INFO]: There are 4148 embeddings of dim 49152
2025-03-13 14:36:37,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 14:36:37,067 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:36:37
2025-03-13 14:36:37,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:36:37,067 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:36:37,067 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:36:37,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:36:37,067 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:36:37
2025-03-13 14:36:37,067 [INFO]: 856.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:36:37,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:36:37,067 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:36:37
2025-03-13 14:36:37,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:36:37,067 [INFO]: 	Creating the index 03/13/2025, 14:36:37
2025-03-13 14:36:37,068 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:36:37
2025-03-13 14:36:37,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:36:37,069 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:36:37
2025-03-13 14:36:37,069 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:36:37,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.90it/s] 29%|██▉       | 5/17 [00:00<00:00, 19.79it/s] 53%|█████▎    | 9/17 [00:00<00:00, 25.82it/s] 76%|███████▋  | 13/17 [00:00<00:00, 28.51it/s]100%|██████████| 17/17 [00:04<00:00,  2.60it/s]100%|██████████| 17/17 [00:04<00:00,  3.95it/s]
2025-03-13 14:36:41,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:36:41
2025-03-13 14:37:27,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3556 secs
2025-03-13 14:37:27,729 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 14:37:27,729 [INFO]: 	Compute fast metrics 03/13/2025, 14:37:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.03it/s]
2025-03-13 14:37:43,435 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7062 secs
2025-03-13 14:37:43,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3709 secs
2025-03-13 14:37:43,440 [INFO]: {
2025-03-13 14:37:43,440 [INFO]: 	index_key: HNSW15
2025-03-13 14:37:43,440 [INFO]: 	index_param: efSearch=162
2025-03-13 14:37:43,440 [INFO]: 	index_path: knn.index
2025-03-13 14:37:43,440 [INFO]: 	size in bytes: 816094150
2025-03-13 14:37:43,440 [INFO]: 	avg_search_speed_ms: 13.003723101535392
2025-03-13 14:37:43,440 [INFO]: 	99p_search_speed_ms: 20.29035784304142
2025-03-13 14:37:43,440 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:43,440 [INFO]: 	nb vectors: 4148
2025-03-13 14:37:43,440 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:43,440 [INFO]: 	compression ratio: 0.9993086998601816
2025-03-13 14:37:43,440 [INFO]: }
2025-03-13 14:37:43,440 [INFO]: 	>>> Finished "Creating the index" in 66.3726 secs
2025-03-13 14:37:43,440 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4050 secs
2025-03-13 14:37:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 67971 [episode count 1/20]
[retrieval_preprocessing] for episode 23816 [episode count 2/20], we have num_retrieval=np.int64(4170) num_query=np.int64(209)
2025-03-13 14:37:47,132 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:47,967 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:47
2025-03-13 14:37:47,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.27it/s]
2025-03-13 14:37:48,003 [INFO]: There are 4170 embeddings of dim 49152
2025-03-13 14:37:48,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 14:37:48,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:48
2025-03-13 14:37:48,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:48,004 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:37:48,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:37:48,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:37:48,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:48
2025-03-13 14:37:48,004 [INFO]: 860.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:48,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:37:48,005 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:48
2025-03-13 14:37:48,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:48,005 [INFO]: 	Creating the index 03/13/2025, 14:37:48
2025-03-13 14:37:48,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:37:48
2025-03-13 14:37:48,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 14:37:48,009 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:48
2025-03-13 14:37:48,009 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:37:48,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.31it/s] 29%|██▉       | 5/17 [00:00<00:00, 26.06it/s] 59%|█████▉    | 10/17 [00:00<00:00, 34.35it/s] 88%|████████▊ | 15/17 [00:00<00:00, 37.96it/s]100%|██████████| 17/17 [00:04<00:00,  4.25it/s]
2025-03-13 14:37:52,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:52
2025-03-13 14:38:36,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3981 secs
2025-03-13 14:38:36,420 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:38:36,420 [INFO]: 	Compute fast metrics 03/13/2025, 14:38:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.28it/s]
2025-03-13 14:38:51,769 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3492 secs
2025-03-13 14:38:51,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7632 secs
2025-03-13 14:38:51,773 [INFO]: {
2025-03-13 14:38:51,773 [INFO]: 	index_key: HNSW15
2025-03-13 14:38:51,773 [INFO]: 	index_param: efSearch=156
2025-03-13 14:38:51,773 [INFO]: 	index_path: knn.index
2025-03-13 14:38:51,773 [INFO]: 	size in bytes: 820422550
2025-03-13 14:38:51,773 [INFO]: 	avg_search_speed_ms: 9.072907807553921
2025-03-13 14:38:51,773 [INFO]: 	99p_search_speed_ms: 15.011079222895205
2025-03-13 14:38:51,773 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:38:51,773 [INFO]: 	nb vectors: 4170
2025-03-13 14:38:51,773 [INFO]: 	vectors dimension: 49152
2025-03-13 14:38:51,773 [INFO]: 	compression ratio: 0.9993086611283417
2025-03-13 14:38:51,773 [INFO]: }
2025-03-13 14:38:51,773 [INFO]: 	>>> Finished "Creating the index" in 63.7675 secs
2025-03-13 14:38:51,773 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8057 secs
2025-03-13 14:38:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:38:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 23816 [episode count 2/20]
[retrieval_preprocessing] for episode 54029 [episode count 3/20], we have num_retrieval=np.int64(4235) num_query=np.int64(144)
2025-03-13 14:38:53,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:38:54,461 [INFO]: Launching the whole pipeline 03/13/2025, 14:38:54
2025-03-13 14:38:54,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:38:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 838.02it/s]
2025-03-13 14:38:54,503 [INFO]: There are 4235 embeddings of dim 49152
2025-03-13 14:38:54,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 14:38:54,504 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:38:54
2025-03-13 14:38:54,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:38:54,504 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:38:54,504 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:38:54,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:38:54,504 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:38:54
2025-03-13 14:38:54,505 [INFO]: 874.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:38:54,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:38:54,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:38:54
2025-03-13 14:38:54,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:38:54,505 [INFO]: 	Creating the index 03/13/2025, 14:38:54
2025-03-13 14:38:54,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:38:54
2025-03-13 14:38:54,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 14:38:54,508 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:38:54
2025-03-13 14:38:54,508 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:38:54,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.36it/s] 24%|██▎       | 4/17 [00:00<00:00, 15.03it/s] 47%|████▋     | 8/17 [00:00<00:00, 23.12it/s] 71%|███████   | 12/17 [00:00<00:00, 27.61it/s] 94%|█████████▍| 16/17 [00:00<00:00, 30.27it/s]100%|██████████| 17/17 [00:05<00:00,  2.88it/s]
2025-03-13 14:39:00,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:39:00
2025-03-13 14:39:48,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7937 secs
2025-03-13 14:39:48,210 [INFO]: The best hyperparameters are: efSearch=101
2025-03-13 14:39:48,210 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.76it/s] 50%|█████     | 2/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-13 14:40:11,340 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1297 secs
2025-03-13 14:40:11,345 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8374 secs
2025-03-13 14:40:11,345 [INFO]: {
2025-03-13 14:40:11,346 [INFO]: 	index_key: HNSW15
2025-03-13 14:40:11,346 [INFO]: 	index_param: efSearch=101
2025-03-13 14:40:11,346 [INFO]: 	index_path: knn.index
2025-03-13 14:40:11,346 [INFO]: 	size in bytes: 833210830
2025-03-13 14:40:11,346 [INFO]: 	avg_search_speed_ms: 10.111307566166225
2025-03-13 14:40:11,346 [INFO]: 	99p_search_speed_ms: 15.812025545164943
2025-03-13 14:40:11,346 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:40:11,346 [INFO]: 	nb vectors: 4235
2025-03-13 14:40:11,346 [INFO]: 	vectors dimension: 49152
2025-03-13 14:40:11,346 [INFO]: 	compression ratio: 0.9993087583847176
2025-03-13 14:40:11,346 [INFO]: }
2025-03-13 14:40:11,346 [INFO]: 	>>> Finished "Creating the index" in 76.8406 secs
2025-03-13 14:40:11,346 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8848 secs
2025-03-13 14:40:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:40:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 54029 [episode count 3/20]
[retrieval_preprocessing] for episode 6158 [episode count 4/20], we have num_retrieval=np.int64(4162) num_query=np.int64(217)
2025-03-13 14:40:14,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:40:14,841 [INFO]: Launching the whole pipeline 03/13/2025, 14:40:14
2025-03-13 14:40:14,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:40:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.64it/s]
2025-03-13 14:40:14,877 [INFO]: There are 4162 embeddings of dim 49152
2025-03-13 14:40:14,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-13 14:40:14,878 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:40:14,878 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:40:14,878 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:40:14,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:40:14,878 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,879 [INFO]: 858.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:40:14,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:40:14,879 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:40:14
2025-03-13 14:40:14,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:40:14,879 [INFO]: 	Creating the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,880 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:40:14
2025-03-13 14:40:14,883 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 14:40:14,883 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:40:14
2025-03-13 14:40:14,883 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:40:14,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.07it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.77it/s] 24%|██▎       | 4/17 [00:00<00:01,  9.53it/s] 35%|███▌      | 6/17 [00:00<00:01, 10.98it/s] 47%|████▋     | 8/17 [00:00<00:00, 11.82it/s] 59%|█████▉    | 10/17 [00:00<00:00, 12.81it/s] 71%|███████   | 12/17 [00:01<00:00, 13.50it/s] 82%|████████▏ | 14/17 [00:01<00:00, 13.61it/s] 94%|█████████▍| 16/17 [00:01<00:00, 13.96it/s]100%|██████████| 17/17 [00:05<00:00,  3.30it/s]
2025-03-13 14:40:20,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:20
2025-03-13 14:41:08,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8606 secs
2025-03-13 14:41:08,898 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:41:08,898 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:05<00:16,  5.39s/it] 50%|█████     | 2/4 [00:05<00:05,  2.56s/it] 75%|███████▌  | 3/4 [00:09<00:02,  2.92s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.19s/it]
2025-03-13 14:41:48,313 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4150 secs
2025-03-13 14:41:48,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.4338 secs
2025-03-13 14:41:48,317 [INFO]: {
2025-03-13 14:41:48,317 [INFO]: 	index_key: HNSW15
2025-03-13 14:41:48,317 [INFO]: 	index_param: efSearch=156
2025-03-13 14:41:48,317 [INFO]: 	index_path: knn.index
2025-03-13 14:41:48,317 [INFO]: 	size in bytes: 818848630
2025-03-13 14:41:48,317 [INFO]: 	avg_search_speed_ms: 10.073751173650871
2025-03-13 14:41:48,317 [INFO]: 	99p_search_speed_ms: 18.313693720847372
2025-03-13 14:41:48,317 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:41:48,317 [INFO]: 	nb vectors: 4162
2025-03-13 14:41:48,317 [INFO]: 	vectors dimension: 49152
2025-03-13 14:41:48,317 [INFO]: 	compression ratio: 0.9993086219122086
2025-03-13 14:41:48,317 [INFO]: }
2025-03-13 14:41:48,318 [INFO]: 	>>> Finished "Creating the index" in 93.4380 secs
2025-03-13 14:41:48,318 [INFO]: >>> Finished "Launching the whole pipeline" in 93.4759 secs
2025-03-13 14:41:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 6158 [episode count 4/20]
[retrieval_preprocessing] for episode 75409 [episode count 5/20], we have num_retrieval=np.int64(4169) num_query=np.int64(210)
2025-03-13 14:41:50,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:41:51,756 [INFO]: Launching the whole pipeline 03/13/2025, 14:41:51
2025-03-13 14:41:51,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:41:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 661.98it/s]
2025-03-13 14:41:51,947 [INFO]: There are 4169 embeddings of dim 49152
2025-03-13 14:41:51,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1911 secs
2025-03-13 14:41:51,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:41:51,948 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:41:51,948 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:41:51,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:41:51,949 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,949 [INFO]: 860.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:41:51,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:41:51,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:41:51
2025-03-13 14:41:51,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:41:51,949 [INFO]: 	Creating the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,949 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:41:51
2025-03-13 14:41:51,953 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 14:41:51,953 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:41:51
2025-03-13 14:41:51,954 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:41:51,954 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.94it/s] 29%|██▉       | 5/17 [00:00<00:00, 23.78it/s] 53%|█████▎    | 9/17 [00:00<00:00, 29.27it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.85it/s]100%|██████████| 17/17 [00:05<00:00,  2.17it/s]100%|██████████| 17/17 [00:05<00:00,  3.37it/s]
2025-03-13 14:41:57,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:41:57
2025-03-13 14:42:37,262 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2507 secs
2025-03-13 14:42:37,263 [INFO]: The best hyperparameters are: efSearch=161
2025-03-13 14:42:37,263 [INFO]: 	Compute fast metrics 03/13/2025, 14:42:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.66it/s]
2025-03-13 14:42:57,935 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6725 secs
2025-03-13 14:42:58,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1651 secs
2025-03-13 14:42:58,119 [INFO]: {
2025-03-13 14:42:58,119 [INFO]: 	index_key: HNSW15
2025-03-13 14:42:58,120 [INFO]: 	index_param: efSearch=161
2025-03-13 14:42:58,120 [INFO]: 	index_path: knn.index
2025-03-13 14:42:58,120 [INFO]: 	size in bytes: 820225810
2025-03-13 14:42:58,120 [INFO]: 	avg_search_speed_ms: 16.28762092373064
2025-03-13 14:42:58,120 [INFO]: 	99p_search_speed_ms: 23.26132549205795
2025-03-13 14:42:58,120 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:58,120 [INFO]: 	nb vectors: 4169
2025-03-13 14:42:58,120 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:58,120 [INFO]: 	compression ratio: 0.9993086562345557
2025-03-13 14:42:58,120 [INFO]: }
2025-03-13 14:42:58,120 [INFO]: 	>>> Finished "Creating the index" in 66.1708 secs
2025-03-13 14:42:58,120 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3635 secs
2025-03-13 14:42:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 75409 [episode count 5/20]
[retrieval_preprocessing] for episode 56219 [episode count 6/20], we have num_retrieval=np.int64(4150) num_query=np.int64(229)
2025-03-13 14:43:00,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:43:00,795 [INFO]: Launching the whole pipeline 03/13/2025, 14:43:00
2025-03-13 14:43:00,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:43:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.69it/s]
2025-03-13 14:43:00,830 [INFO]: There are 4150 embeddings of dim 49152
2025-03-13 14:43:00,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 14:43:00,831 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:43:00
2025-03-13 14:43:00,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:43:00,831 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:43:00,831 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:43:00,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:43:00,831 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:43:00
2025-03-13 14:43:00,831 [INFO]: 856.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:43:00,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:43:00,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:43:00
2025-03-13 14:43:00,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:43:00,832 [INFO]: 	Creating the index 03/13/2025, 14:43:00
2025-03-13 14:43:00,832 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:43:00
2025-03-13 14:43:00,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:43:00,833 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:43:00
2025-03-13 14:43:00,833 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:43:00,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.24it/s] 29%|██▉       | 5/17 [00:00<00:00, 20.14it/s] 53%|█████▎    | 9/17 [00:00<00:00, 25.71it/s] 76%|███████▋  | 13/17 [00:00<00:00, 29.01it/s]100%|██████████| 17/17 [00:04<00:00,  2.29it/s]100%|██████████| 17/17 [00:04<00:00,  3.53it/s]
2025-03-13 14:43:05,657 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:43:05
2025-03-13 14:43:52,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5871 secs
2025-03-13 14:43:52,245 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 14:43:52,245 [INFO]: 	Compute fast metrics 03/13/2025, 14:43:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 14:44:17,212 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9673 secs
2025-03-13 14:44:17,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3828 secs
2025-03-13 14:44:17,216 [INFO]: {
2025-03-13 14:44:17,216 [INFO]: 	index_key: HNSW15
2025-03-13 14:44:17,216 [INFO]: 	index_param: efSearch=175
2025-03-13 14:44:17,216 [INFO]: 	index_path: knn.index
2025-03-13 14:44:17,216 [INFO]: 	size in bytes: 816487630
2025-03-13 14:44:17,216 [INFO]: 	avg_search_speed_ms: 12.133582293084174
2025-03-13 14:44:17,216 [INFO]: 	99p_search_speed_ms: 18.067563986405727
2025-03-13 14:44:17,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:17,216 [INFO]: 	nb vectors: 4150
2025-03-13 14:44:17,216 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:17,216 [INFO]: 	compression ratio: 0.9993087096738992
2025-03-13 14:44:17,216 [INFO]: }
2025-03-13 14:44:17,216 [INFO]: 	>>> Finished "Creating the index" in 76.3846 secs
2025-03-13 14:44:17,216 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4211 secs
2025-03-13 14:44:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:44:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 56219 [episode count 6/20]
[retrieval_preprocessing] for episode 59295 [episode count 7/20], we have num_retrieval=np.int64(4078) num_query=np.int64(301)
2025-03-13 14:44:19,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:44:20,162 [INFO]: Launching the whole pipeline 03/13/2025, 14:44:20
2025-03-13 14:44:20,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:44:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.39it/s]
2025-03-13 14:44:20,196 [INFO]: There are 4078 embeddings of dim 49152
2025-03-13 14:44:20,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 14:44:20,196 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:44:20
2025-03-13 14:44:20,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:44:20,197 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 14:44:20,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:44:20,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:44:20,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:44:20
2025-03-13 14:44:20,197 [INFO]: 841.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:44:20,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:44:20,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:44:20
2025-03-13 14:44:20,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:44:20,197 [INFO]: 	Creating the index 03/13/2025, 14:44:20
2025-03-13 14:44:20,197 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:44:20
2025-03-13 14:44:20,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:44:20,198 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:44:20
2025-03-13 14:44:20,198 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:44:20,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.11it/s] 24%|██▎       | 4/17 [00:00<00:00, 17.49it/s] 47%|████▋     | 8/17 [00:00<00:00, 25.88it/s] 71%|███████   | 12/17 [00:00<00:00, 30.18it/s] 94%|█████████▍| 16/17 [00:00<00:00, 32.68it/s]100%|██████████| 17/17 [00:03<00:00,  4.50it/s]
2025-03-13 14:44:23,983 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:44:23
2025-03-13 14:45:17,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.9244 secs
2025-03-13 14:45:17,908 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 14:45:17,908 [INFO]: 	Compute fast metrics 03/13/2025, 14:45:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-13 14:45:42,631 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7231 secs
2025-03-13 14:45:42,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.4360 secs
2025-03-13 14:45:42,634 [INFO]: {
2025-03-13 14:45:42,634 [INFO]: 	index_key: HNSW15
2025-03-13 14:45:42,634 [INFO]: 	index_param: efSearch=125
2025-03-13 14:45:42,634 [INFO]: 	index_path: knn.index
2025-03-13 14:45:42,634 [INFO]: 	size in bytes: 802322110
2025-03-13 14:45:42,634 [INFO]: 	avg_search_speed_ms: 7.360939179932553
2025-03-13 14:45:42,634 [INFO]: 	99p_search_speed_ms: 9.63994842255488
2025-03-13 14:45:42,634 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:45:42,634 [INFO]: 	nb vectors: 4078
2025-03-13 14:45:42,634 [INFO]: 	vectors dimension: 49152
2025-03-13 14:45:42,634 [INFO]: 	compression ratio: 0.9993086492406398
2025-03-13 14:45:42,634 [INFO]: }
2025-03-13 14:45:42,634 [INFO]: 	>>> Finished "Creating the index" in 82.4374 secs
2025-03-13 14:45:42,634 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4724 secs
2025-03-13 14:45:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 59295 [episode count 7/20]
[retrieval_preprocessing] for episode 68257 [episode count 8/20], we have num_retrieval=np.int64(4153) num_query=np.int64(226)
2025-03-13 14:45:44,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:45,471 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:45
2025-03-13 14:45:45,471 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-13 14:45:45,504 [INFO]: There are 4153 embeddings of dim 49152
2025-03-13 14:45:45,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 14:45:45,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:45
2025-03-13 14:45:45,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:45,505 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:45:45,505 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:45:45,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:45:45,505 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:45
2025-03-13 14:45:45,505 [INFO]: 857.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:45,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:45:45,505 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:45
2025-03-13 14:45:45,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:45,505 [INFO]: 	Creating the index 03/13/2025, 14:45:45
2025-03-13 14:45:45,505 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:45:45
2025-03-13 14:45:45,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:45:45,506 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:45
2025-03-13 14:45:45,506 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:45:45,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.62it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.88it/s] 65%|██████▍   | 11/17 [00:00<00:00, 33.52it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.88it/s]100%|██████████| 17/17 [00:04<00:00,  4.19it/s]
2025-03-13 14:45:49,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:49
2025-03-13 14:46:41,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9941 secs
2025-03-13 14:46:41,561 [INFO]: The best hyperparameters are: efSearch=129
2025-03-13 14:46:41,561 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.38it/s]
2025-03-13 14:47:00,458 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8968 secs
2025-03-13 14:47:00,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9546 secs
2025-03-13 14:47:00,461 [INFO]: {
2025-03-13 14:47:00,461 [INFO]: 	index_key: HNSW15
2025-03-13 14:47:00,461 [INFO]: 	index_param: efSearch=129
2025-03-13 14:47:00,461 [INFO]: 	index_path: knn.index
2025-03-13 14:47:00,461 [INFO]: 	size in bytes: 817077850
2025-03-13 14:47:00,461 [INFO]: 	avg_search_speed_ms: 8.005744629793817
2025-03-13 14:47:00,461 [INFO]: 	99p_search_speed_ms: 12.854962777346373
2025-03-13 14:47:00,461 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:00,461 [INFO]: 	nb vectors: 4153
2025-03-13 14:47:00,461 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:00,461 [INFO]: 	compression ratio: 0.9993087243767531
2025-03-13 14:47:00,461 [INFO]: }
2025-03-13 14:47:00,461 [INFO]: 	>>> Finished "Creating the index" in 74.9561 secs
2025-03-13 14:47:00,461 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9898 secs
2025-03-13 14:47:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 68257 [episode count 8/20]
[retrieval_preprocessing] for episode 94001 [episode count 9/20], we have num_retrieval=np.int64(4143) num_query=np.int64(236)
2025-03-13 14:47:02,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:02,972 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:02
2025-03-13 14:47:02,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1056.50it/s]
2025-03-13 14:47:03,005 [INFO]: There are 4143 embeddings of dim 49152
2025-03-13 14:47:03,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 14:47:03,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:03
2025-03-13 14:47:03,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:03,007 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:47:03,007 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:47:03,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:47:03,007 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:03
2025-03-13 14:47:03,007 [INFO]: 855.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:03,008 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:47:03,008 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:03
2025-03-13 14:47:03,008 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:03,008 [INFO]: 	Creating the index 03/13/2025, 14:47:03
2025-03-13 14:47:03,008 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:47:03
2025-03-13 14:47:03,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 14:47:03,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:03
2025-03-13 14:47:03,012 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:47:03,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.48it/s] 41%|████      | 7/17 [00:00<00:00, 33.65it/s] 71%|███████   | 12/17 [00:00<00:00, 39.80it/s]100%|██████████| 17/17 [00:03<00:00,  3.66it/s]100%|██████████| 17/17 [00:03<00:00,  5.09it/s]
2025-03-13 14:47:06,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:06
2025-03-13 14:47:50,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5516 secs
2025-03-13 14:47:50,912 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 14:47:50,912 [INFO]: 	Compute fast metrics 03/13/2025, 14:47:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 14:48:14,898 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9856 secs
2025-03-13 14:48:14,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8893 secs
2025-03-13 14:48:14,901 [INFO]: {
2025-03-13 14:48:14,901 [INFO]: 	index_key: HNSW15
2025-03-13 14:48:14,901 [INFO]: 	index_param: efSearch=137
2025-03-13 14:48:14,901 [INFO]: 	index_path: knn.index
2025-03-13 14:48:14,901 [INFO]: 	size in bytes: 815110450
2025-03-13 14:48:14,901 [INFO]: 	avg_search_speed_ms: 8.770958259660881
2025-03-13 14:48:14,901 [INFO]: 	99p_search_speed_ms: 14.164709527976807
2025-03-13 14:48:14,901 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:48:14,901 [INFO]: 	nb vectors: 4143
2025-03-13 14:48:14,902 [INFO]: 	vectors dimension: 49152
2025-03-13 14:48:14,902 [INFO]: 	compression ratio: 0.9993086752844353
2025-03-13 14:48:14,902 [INFO]: }
2025-03-13 14:48:14,902 [INFO]: 	>>> Finished "Creating the index" in 71.8933 secs
2025-03-13 14:48:14,902 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9292 secs
2025-03-13 14:48:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:48:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 94001 [episode count 9/20]
[retrieval_preprocessing] for episode 57523 [episode count 10/20], we have num_retrieval=np.int64(4093) num_query=np.int64(286)
2025-03-13 14:48:17,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:48:18,239 [INFO]: Launching the whole pipeline 03/13/2025, 14:48:18
2025-03-13 14:48:18,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:48:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.97it/s]
2025-03-13 14:48:18,275 [INFO]: There are 4093 embeddings of dim 49152
2025-03-13 14:48:18,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0358 secs
2025-03-13 14:48:18,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:48:18
2025-03-13 14:48:18,276 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:48:18,276 [INFO]: 		-> Add: 2.2 seconds
2025-03-13 14:48:18,276 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:48:18,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:48:18,276 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:48:18
2025-03-13 14:48:18,276 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:48:18,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:48:18,276 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:48:18
2025-03-13 14:48:18,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:48:18,276 [INFO]: 	Creating the index 03/13/2025, 14:48:18
2025-03-13 14:48:18,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:48:18
2025-03-13 14:48:18,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 14:48:18,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:48:18
2025-03-13 14:48:18,277 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 14:48:18,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.48it/s] 29%|██▉       | 5/17 [00:00<00:00, 18.92it/s] 53%|█████▎    | 9/17 [00:00<00:00, 24.05it/s] 76%|███████▋  | 13/17 [00:00<00:00, 27.14it/s]100%|██████████| 17/17 [00:05<00:00,  1.87it/s]100%|██████████| 17/17 [00:05<00:00,  2.90it/s]
2025-03-13 14:48:24,147 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:48:24
2025-03-13 14:49:06,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6502 secs
2025-03-13 14:49:06,797 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 14:49:06,797 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.84it/s]
2025-03-13 14:49:41,417 [INFO]: 	>>> Finished "Compute fast metrics" in 34.6193 secs
2025-03-13 14:49:41,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1427 secs
2025-03-13 14:49:41,420 [INFO]: {
2025-03-13 14:49:41,420 [INFO]: 	index_key: HNSW15
2025-03-13 14:49:41,420 [INFO]: 	index_param: efSearch=241
2025-03-13 14:49:41,420 [INFO]: 	index_path: knn.index
2025-03-13 14:49:41,420 [INFO]: 	size in bytes: 805273270
2025-03-13 14:49:41,420 [INFO]: 	avg_search_speed_ms: 10.433695302854707
2025-03-13 14:49:41,420 [INFO]: 	99p_search_speed_ms: 13.287658654153347
2025-03-13 14:49:41,420 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:49:41,420 [INFO]: 	nb vectors: 4093
2025-03-13 14:49:41,421 [INFO]: 	vectors dimension: 49152
2025-03-13 14:49:41,421 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-13 14:49:41,421 [INFO]: }
2025-03-13 14:49:41,421 [INFO]: 	>>> Finished "Creating the index" in 83.1445 secs
2025-03-13 14:49:41,421 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1811 secs
2025-03-13 14:49:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:49:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 57523 [episode count 10/20]
[retrieval_preprocessing] for episode 24629 [episode count 11/20], we have num_retrieval=np.int64(4171) num_query=np.int64(208)
2025-03-13 14:49:44,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:49:45,158 [INFO]: Launching the whole pipeline 03/13/2025, 14:49:45
2025-03-13 14:49:45,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:49:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1062.12it/s]
2025-03-13 14:49:45,191 [INFO]: There are 4171 embeddings of dim 49152
2025-03-13 14:49:45,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 14:49:45,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:49:45
2025-03-13 14:49:45,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:49:45,192 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:49:45,193 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:49:45,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:49:45,193 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:49:45
2025-03-13 14:49:45,193 [INFO]: 860.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:49:45,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:49:45,193 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:49:45
2025-03-13 14:49:45,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:49:45,194 [INFO]: 	Creating the index 03/13/2025, 14:49:45
2025-03-13 14:49:45,194 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:49:45
2025-03-13 14:49:45,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:49:45,197 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:49:45
2025-03-13 14:49:45,197 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:49:45,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.08it/s] 41%|████      | 7/17 [00:00<00:00, 35.69it/s] 71%|███████   | 12/17 [00:00<00:00, 41.77it/s]100%|██████████| 17/17 [00:03<00:00,  3.62it/s]100%|██████████| 17/17 [00:03<00:00,  5.04it/s]
2025-03-13 14:49:48,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:49:48
2025-03-13 14:50:35,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9193 secs
2025-03-13 14:50:35,496 [INFO]: The best hyperparameters are: efSearch=127
2025-03-13 14:50:35,496 [INFO]: 	Compute fast metrics 03/13/2025, 14:50:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.79it/s]
2025-03-13 14:50:53,109 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6125 secs
2025-03-13 14:50:53,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9151 secs
2025-03-13 14:50:53,113 [INFO]: {
2025-03-13 14:50:53,113 [INFO]: 	index_key: HNSW15
2025-03-13 14:50:53,113 [INFO]: 	index_param: efSearch=127
2025-03-13 14:50:53,113 [INFO]: 	index_path: knn.index
2025-03-13 14:50:53,113 [INFO]: 	size in bytes: 820619290
2025-03-13 14:50:53,113 [INFO]: 	avg_search_speed_ms: 9.851373257023727
2025-03-13 14:50:53,113 [INFO]: 	99p_search_speed_ms: 16.720598018728197
2025-03-13 14:50:53,113 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:53,113 [INFO]: 	nb vectors: 4171
2025-03-13 14:50:53,113 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:53,113 [INFO]: 	compression ratio: 0.9993086660197812
2025-03-13 14:50:53,113 [INFO]: }
2025-03-13 14:50:53,113 [INFO]: 	>>> Finished "Creating the index" in 67.9193 secs
2025-03-13 14:50:53,113 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9550 secs
2025-03-13 14:50:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 24629 [episode count 11/20]
[retrieval_preprocessing] for episode 12347 [episode count 12/20], we have num_retrieval=np.int64(4145) num_query=np.int64(234)
2025-03-13 14:50:56,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:57,250 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:57
2025-03-13 14:50:57,250 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.52it/s]
2025-03-13 14:50:57,284 [INFO]: There are 4145 embeddings of dim 49152
2025-03-13 14:50:57,285 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 14:50:57,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:57
2025-03-13 14:50:57,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:57,286 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:50:57,286 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:50:57,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:50:57,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:57
2025-03-13 14:50:57,287 [INFO]: 855.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:57,287 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:50:57,287 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:57
2025-03-13 14:50:57,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:50:57,288 [INFO]: 	Creating the index 03/13/2025, 14:50:57
2025-03-13 14:50:57,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:50:57
2025-03-13 14:50:57,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 14:50:57,291 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:57
2025-03-13 14:50:57,291 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:50:57,291 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.50it/s] 41%|████      | 7/17 [00:00<00:00, 30.65it/s] 71%|███████   | 12/17 [00:00<00:00, 35.17it/s]100%|██████████| 17/17 [00:03<00:00,  3.23it/s]100%|██████████| 17/17 [00:03<00:00,  4.49it/s]
2025-03-13 14:51:01,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:51:01
2025-03-13 14:51:42,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1363 secs
2025-03-13 14:51:42,221 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 14:51:42,221 [INFO]: 	Compute fast metrics 03/13/2025, 14:51:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.86it/s]
2025-03-13 14:52:03,410 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1888 secs
2025-03-13 14:52:03,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1216 secs
2025-03-13 14:52:03,413 [INFO]: {
2025-03-13 14:52:03,413 [INFO]: 	index_key: HNSW15
2025-03-13 14:52:03,413 [INFO]: 	index_param: efSearch=157
2025-03-13 14:52:03,413 [INFO]: 	index_path: knn.index
2025-03-13 14:52:03,413 [INFO]: 	size in bytes: 815503930
2025-03-13 14:52:03,413 [INFO]: 	avg_search_speed_ms: 10.118731581756792
2025-03-13 14:52:03,413 [INFO]: 	99p_search_speed_ms: 17.00789803871885
2025-03-13 14:52:03,413 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:03,413 [INFO]: 	nb vectors: 4145
2025-03-13 14:52:03,413 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:03,413 [INFO]: 	compression ratio: 0.9993086851218486
2025-03-13 14:52:03,413 [INFO]: }
2025-03-13 14:52:03,413 [INFO]: 	>>> Finished "Creating the index" in 66.1248 secs
2025-03-13 14:52:03,413 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1627 secs
2025-03-13 14:52:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 12347 [episode count 12/20]
[retrieval_preprocessing] for episode 70203 [episode count 13/20], we have num_retrieval=np.int64(4184) num_query=np.int64(195)
2025-03-13 14:52:05,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:06,018 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:06
2025-03-13 14:52:06,018 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1051.99it/s]
2025-03-13 14:52:06,048 [INFO]: There are 4184 embeddings of dim 49152
2025-03-13 14:52:06,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 14:52:06,049 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:06
2025-03-13 14:52:06,049 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:06,049 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:52:06,049 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:52:06,049 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:52:06,049 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:06
2025-03-13 14:52:06,049 [INFO]: 863.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:06,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:52:06,049 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:06
2025-03-13 14:52:06,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:52:06,049 [INFO]: 	Creating the index 03/13/2025, 14:52:06
2025-03-13 14:52:06,049 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:52:06
2025-03-13 14:52:06,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 14:52:06,050 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:06
2025-03-13 14:52:06,050 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:52:06,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.54it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.16it/s] 65%|██████▍   | 11/17 [00:00<00:00, 39.27it/s] 94%|█████████▍| 16/17 [00:00<00:00, 43.19it/s]100%|██████████| 17/17 [00:03<00:00,  4.90it/s]
2025-03-13 14:52:09,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:52:09
2025-03-13 14:52:52,382 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8607 secs
2025-03-13 14:52:52,382 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 14:52:52,382 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 14:53:13,434 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0518 secs
2025-03-13 14:53:13,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3869 secs
2025-03-13 14:53:13,437 [INFO]: {
2025-03-13 14:53:13,437 [INFO]: 	index_key: HNSW15
2025-03-13 14:53:13,437 [INFO]: 	index_param: efSearch=89
2025-03-13 14:53:13,437 [INFO]: 	index_path: knn.index
2025-03-13 14:53:13,437 [INFO]: 	size in bytes: 823176910
2025-03-13 14:53:13,437 [INFO]: 	avg_search_speed_ms: 5.581691918352807
2025-03-13 14:53:13,437 [INFO]: 	99p_search_speed_ms: 8.305445965379477
2025-03-13 14:53:13,437 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:53:13,438 [INFO]: 	nb vectors: 4184
2025-03-13 14:53:13,438 [INFO]: 	vectors dimension: 49152
2025-03-13 14:53:13,438 [INFO]: 	compression ratio: 0.9993087293957261
2025-03-13 14:53:13,438 [INFO]: }
2025-03-13 14:53:13,438 [INFO]: 	>>> Finished "Creating the index" in 67.3884 secs
2025-03-13 14:53:13,438 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4196 secs
2025-03-13 14:53:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:53:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 70203 [episode count 13/20]
[retrieval_preprocessing] for episode 49598 [episode count 14/20], we have num_retrieval=np.int64(4189) num_query=np.int64(190)
2025-03-13 14:53:15,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:53:15,624 [INFO]: Launching the whole pipeline 03/13/2025, 14:53:15
2025-03-13 14:53:15,624 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:53:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-13 14:53:15,653 [INFO]: There are 4189 embeddings of dim 49152
2025-03-13 14:53:15,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 14:53:15,653 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:53:15,653 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:53:15,653 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:53:15,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:53:15,653 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,653 [INFO]: 864.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:53:15,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 14:53:15,653 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:53:15
2025-03-13 14:53:15,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:53:15,654 [INFO]: 	Creating the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,654 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:53:15
2025-03-13 14:53:15,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 14:53:15,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:53:15
2025-03-13 14:53:15,655 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:53:15,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.43it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.30it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.90it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.75it/s]100%|██████████| 17/17 [00:04<00:00,  4.00it/s]
2025-03-13 14:53:19,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:19
2025-03-13 14:54:07,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1203 secs
2025-03-13 14:54:07,033 [INFO]: The best hyperparameters are: efSearch=147
2025-03-13 14:54:07,033 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.38it/s]
2025-03-13 14:54:34,699 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6658 secs
2025-03-13 14:54:34,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.0484 secs
2025-03-13 14:54:34,703 [INFO]: {
2025-03-13 14:54:34,703 [INFO]: 	index_key: HNSW15
2025-03-13 14:54:34,703 [INFO]: 	index_param: efSearch=147
2025-03-13 14:54:34,703 [INFO]: 	index_path: knn.index
2025-03-13 14:54:34,703 [INFO]: 	size in bytes: 824160610
2025-03-13 14:54:34,703 [INFO]: 	avg_search_speed_ms: 10.919897580940244
2025-03-13 14:54:34,703 [INFO]: 	99p_search_speed_ms: 16.756462585180998
2025-03-13 14:54:34,703 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:54:34,703 [INFO]: 	nb vectors: 4189
2025-03-13 14:54:34,703 [INFO]: 	vectors dimension: 49152
2025-03-13 14:54:34,704 [INFO]: 	compression ratio: 0.9993087536663515
2025-03-13 14:54:34,704 [INFO]: }
2025-03-13 14:54:34,704 [INFO]: 	>>> Finished "Creating the index" in 79.0500 secs
2025-03-13 14:54:34,704 [INFO]: >>> Finished "Launching the whole pipeline" in 79.0794 secs
2025-03-13 14:54:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:54:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 49598 [episode count 14/20]
[retrieval_preprocessing] for episode 22597 [episode count 15/20], we have num_retrieval=np.int64(4167) num_query=np.int64(212)
2025-03-13 14:54:37,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:54:39,364 [INFO]: Launching the whole pipeline 03/13/2025, 14:54:39
2025-03-13 14:54:39,364 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:54:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1028.77it/s]
2025-03-13 14:54:39,400 [INFO]: There are 4167 embeddings of dim 49152
2025-03-13 14:54:39,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 14:54:39,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:54:39,401 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:54:39,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:54:39,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:54:39,402 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,402 [INFO]: 860.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:54:39,402 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:54:39,403 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:54:39
2025-03-13 14:54:39,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:54:39,403 [INFO]: 	Creating the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,403 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:54:39
2025-03-13 14:54:39,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 14:54:39,406 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:54:39
2025-03-13 14:54:39,407 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:54:39,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.75it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.45it/s] 53%|█████▎    | 9/17 [00:00<00:00, 28.50it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.48it/s]100%|██████████| 17/17 [00:05<00:00,  2.05it/s]100%|██████████| 17/17 [00:05<00:00,  3.20it/s]
2025-03-13 14:54:44,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:54:44
2025-03-13 14:55:36,006 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2719 secs
2025-03-13 14:55:36,006 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 14:55:36,007 [INFO]: 	Compute fast metrics 03/13/2025, 14:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:04<00:12,  4.04s/it] 50%|█████     | 2/4 [00:06<00:05,  2.85s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.96s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.29s/it]
2025-03-13 14:56:14,675 [INFO]: 	>>> Finished "Compute fast metrics" in 38.6681 secs
2025-03-13 14:56:14,678 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.2715 secs
2025-03-13 14:56:14,678 [INFO]: {
2025-03-13 14:56:14,678 [INFO]: 	index_key: HNSW15
2025-03-13 14:56:14,678 [INFO]: 	index_param: efSearch=175
2025-03-13 14:56:14,678 [INFO]: 	index_path: knn.index
2025-03-13 14:56:14,678 [INFO]: 	size in bytes: 819832330
2025-03-13 14:56:14,678 [INFO]: 	avg_search_speed_ms: 9.387242389589268
2025-03-13 14:56:14,679 [INFO]: 	99p_search_speed_ms: 13.286308981478212
2025-03-13 14:56:14,679 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:56:14,679 [INFO]: 	nb vectors: 4167
2025-03-13 14:56:14,679 [INFO]: 	vectors dimension: 49152
2025-03-13 14:56:14,679 [INFO]: 	compression ratio: 0.9993086464399373
2025-03-13 14:56:14,679 [INFO]: }
2025-03-13 14:56:14,679 [INFO]: 	>>> Finished "Creating the index" in 95.2756 secs
2025-03-13 14:56:14,679 [INFO]: >>> Finished "Launching the whole pipeline" in 95.3144 secs
2025-03-13 14:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:56:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 22597 [episode count 15/20]
[retrieval_preprocessing] for episode 70095 [episode count 16/20], we have num_retrieval=np.int64(4164) num_query=np.int64(215)
2025-03-13 14:56:17,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:56:18,750 [INFO]: Launching the whole pipeline 03/13/2025, 14:56:18
2025-03-13 14:56:18,751 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:56:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 875.09it/s]
2025-03-13 14:56:18,984 [INFO]: There are 4164 embeddings of dim 49152
2025-03-13 14:56:18,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2338 secs
2025-03-13 14:56:18,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:56:18
2025-03-13 14:56:18,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:56:18,985 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:56:18,985 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:56:18,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:56:18,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:56:18
2025-03-13 14:56:18,986 [INFO]: 859.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:56:18,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 14:56:18,986 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:56:18
2025-03-13 14:56:18,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:56:18,986 [INFO]: 	Creating the index 03/13/2025, 14:56:18
2025-03-13 14:56:18,986 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:56:18
2025-03-13 14:56:18,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 14:56:18,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:56:18
2025-03-13 14:56:18,990 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:56:18,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.88it/s] 29%|██▉       | 5/17 [00:00<00:00, 21.87it/s] 47%|████▋     | 8/17 [00:00<00:00, 25.10it/s] 71%|███████   | 12/17 [00:00<00:00, 27.91it/s] 94%|█████████▍| 16/17 [00:00<00:00, 29.39it/s]100%|██████████| 17/17 [00:05<00:00,  3.31it/s]
2025-03-13 14:56:24,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:24
2025-03-13 14:57:21,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8843 secs
2025-03-13 14:57:21,020 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 14:57:21,020 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.18it/s]
2025-03-13 14:57:54,801 [INFO]: 	>>> Finished "Compute fast metrics" in 33.7808 secs
2025-03-13 14:57:54,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8140 secs
2025-03-13 14:57:54,805 [INFO]: {
2025-03-13 14:57:54,805 [INFO]: 	index_key: HNSW15
2025-03-13 14:57:54,805 [INFO]: 	index_param: efSearch=156
2025-03-13 14:57:54,805 [INFO]: 	index_path: knn.index
2025-03-13 14:57:54,805 [INFO]: 	size in bytes: 819242110
2025-03-13 14:57:54,805 [INFO]: 	avg_search_speed_ms: 8.296872274486418
2025-03-13 14:57:54,805 [INFO]: 	99p_search_speed_ms: 15.623362502083184
2025-03-13 14:57:54,805 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:57:54,805 [INFO]: 	nb vectors: 4164
2025-03-13 14:57:54,805 [INFO]: 	vectors dimension: 49152
2025-03-13 14:57:54,805 [INFO]: 	compression ratio: 0.9993086317303684
2025-03-13 14:57:54,805 [INFO]: }
2025-03-13 14:57:54,805 [INFO]: 	>>> Finished "Creating the index" in 95.8187 secs
2025-03-13 14:57:54,805 [INFO]: >>> Finished "Launching the whole pipeline" in 96.0543 secs
2025-03-13 14:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:57:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 70095 [episode count 16/20]
[retrieval_preprocessing] for episode 66769 [episode count 17/20], we have num_retrieval=np.int64(4122) num_query=np.int64(257)
2025-03-13 14:57:56,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:57:57,601 [INFO]: Launching the whole pipeline 03/13/2025, 14:57:57
2025-03-13 14:57:57,601 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:57:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 14:57:57,633 [INFO]: There are 4122 embeddings of dim 49152
2025-03-13 14:57:57,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 14:57:57,633 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:57:57
2025-03-13 14:57:57,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:57:57,633 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:57:57,633 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:57:57,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:57:57,633 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:57:57
2025-03-13 14:57:57,633 [INFO]: 850.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:57:57,633 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:57:57,634 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:57:57
2025-03-13 14:57:57,634 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:57:57,634 [INFO]: 	Creating the index 03/13/2025, 14:57:57
2025-03-13 14:57:57,634 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:57:57
2025-03-13 14:57:57,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 14:57:57,635 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:57:57
2025-03-13 14:57:57,635 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:57:57,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.63it/s] 29%|██▉       | 5/17 [00:00<00:00, 22.01it/s] 53%|█████▎    | 9/17 [00:00<00:00, 28.30it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.36it/s]100%|██████████| 17/17 [00:04<00:00,  2.51it/s]100%|██████████| 17/17 [00:04<00:00,  3.85it/s]
2025-03-13 14:58:02,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:02
2025-03-13 14:58:57,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.5300 secs
2025-03-13 14:58:57,583 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 14:58:57,584 [INFO]: 	Compute fast metrics 03/13/2025, 14:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.60it/s]
2025-03-13 14:59:25,074 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4909 secs
2025-03-13 14:59:25,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4421 secs
2025-03-13 14:59:25,077 [INFO]: {
2025-03-13 14:59:25,077 [INFO]: 	index_key: HNSW15
2025-03-13 14:59:25,077 [INFO]: 	index_param: efSearch=106
2025-03-13 14:59:25,077 [INFO]: 	index_path: knn.index
2025-03-13 14:59:25,077 [INFO]: 	size in bytes: 810978910
2025-03-13 14:59:25,077 [INFO]: 	avg_search_speed_ms: 6.233166296213884
2025-03-13 14:59:25,077 [INFO]: 	99p_search_speed_ms: 9.046981006395074
2025-03-13 14:59:25,077 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:59:25,077 [INFO]: 	nb vectors: 4122
2025-03-13 14:59:25,077 [INFO]: 	vectors dimension: 49152
2025-03-13 14:59:25,077 [INFO]: 	compression ratio: 0.9993085714152542
2025-03-13 14:59:25,077 [INFO]: }
2025-03-13 14:59:25,077 [INFO]: 	>>> Finished "Creating the index" in 87.4438 secs
2025-03-13 14:59:25,077 [INFO]: >>> Finished "Launching the whole pipeline" in 87.4765 secs
2025-03-13 14:59:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:59:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 66769 [episode count 17/20]
[retrieval_preprocessing] for episode 84817 [episode count 18/20], we have num_retrieval=np.int64(4190) num_query=np.int64(189)
2025-03-13 14:59:26,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:59:28,223 [INFO]: Launching the whole pipeline 03/13/2025, 14:59:28
2025-03-13 14:59:28,223 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:59:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1039.74it/s]
2025-03-13 14:59:28,264 [INFO]: There are 4190 embeddings of dim 49152
2025-03-13 14:59:28,265 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0420 secs
2025-03-13 14:59:28,265 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:59:28
2025-03-13 14:59:28,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:59:28,265 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 14:59:28,266 [INFO]: 		Total: 16.7 minutes
2025-03-13 14:59:28,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:59:28,266 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:59:28
2025-03-13 14:59:28,266 [INFO]: 864.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:59:28,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:59:28,267 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:59:28
2025-03-13 14:59:28,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:59:28,267 [INFO]: 	Creating the index 03/13/2025, 14:59:28
2025-03-13 14:59:28,267 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 14:59:28
2025-03-13 14:59:28,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 14:59:28,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:59:28
2025-03-13 14:59:28,271 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 14:59:28,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.09it/s] 41%|████      | 7/17 [00:00<00:00, 32.02it/s] 71%|███████   | 12/17 [00:00<00:00, 36.85it/s]100%|██████████| 17/17 [00:03<00:00,  3.15it/s]100%|██████████| 17/17 [00:03<00:00,  4.40it/s]
2025-03-13 14:59:32,143 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:59:32
2025-03-13 15:00:21,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4230 secs
2025-03-13 15:00:21,566 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:00:21,566 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 15:00:46,446 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8792 secs
2025-03-13 15:00:46,448 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1774 secs
2025-03-13 15:00:46,449 [INFO]: {
2025-03-13 15:00:46,449 [INFO]: 	index_key: HNSW15
2025-03-13 15:00:46,449 [INFO]: 	index_param: efSearch=157
2025-03-13 15:00:46,449 [INFO]: 	index_path: knn.index
2025-03-13 15:00:46,449 [INFO]: 	size in bytes: 824357350
2025-03-13 15:00:46,449 [INFO]: 	avg_search_speed_ms: 9.566259401088411
2025-03-13 15:00:46,449 [INFO]: 	99p_search_speed_ms: 19.88781505264334
2025-03-13 15:00:46,449 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:00:46,449 [INFO]: 	nb vectors: 4190
2025-03-13 15:00:46,449 [INFO]: 	vectors dimension: 49152
2025-03-13 15:00:46,449 [INFO]: 	compression ratio: 0.9993087585135257
2025-03-13 15:00:46,449 [INFO]: }
2025-03-13 15:00:46,449 [INFO]: 	>>> Finished "Creating the index" in 78.1817 secs
2025-03-13 15:00:46,449 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2262 secs
2025-03-13 15:00:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:00:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 84817 [episode count 18/20]
[retrieval_preprocessing] for episode 89041 [episode count 19/20], we have num_retrieval=np.int64(4193) num_query=np.int64(186)
2025-03-13 15:00:48,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:00:49,848 [INFO]: Launching the whole pipeline 03/13/2025, 15:00:49
2025-03-13 15:00:49,848 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:00:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.18it/s]
2025-03-13 15:00:49,881 [INFO]: There are 4193 embeddings of dim 49152
2025-03-13 15:00:49,881 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:00:49,881 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:00:49
2025-03-13 15:00:49,881 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:00:49,881 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 15:00:49,881 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:00:49,881 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:00:49,882 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:00:49
2025-03-13 15:00:49,882 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:00:49,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:00:49,882 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:00:49
2025-03-13 15:00:49,882 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:00:49,882 [INFO]: 	Creating the index 03/13/2025, 15:00:49
2025-03-13 15:00:49,882 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:00:49
2025-03-13 15:00:49,883 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:00:49,883 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:00:49
2025-03-13 15:00:49,883 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 15:00:49,883 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.35it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.67it/s] 59%|█████▉    | 10/17 [00:00<00:00, 32.67it/s] 82%|████████▏ | 14/17 [00:00<00:00, 34.73it/s]100%|██████████| 17/17 [00:04<00:00,  4.11it/s]
2025-03-13 15:00:54,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:00:54
2025-03-13 15:01:41,493 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4716 secs
2025-03-13 15:01:41,493 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:01:41,493 [INFO]: 	Compute fast metrics 03/13/2025, 15:01:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.95it/s]
2025-03-13 15:02:19,922 [INFO]: 	>>> Finished "Compute fast metrics" in 38.4289 secs
2025-03-13 15:02:19,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.0422 secs
2025-03-13 15:02:19,926 [INFO]: {
2025-03-13 15:02:19,926 [INFO]: 	index_key: HNSW15
2025-03-13 15:02:19,926 [INFO]: 	index_param: efSearch=199
2025-03-13 15:02:19,926 [INFO]: 	index_path: knn.index
2025-03-13 15:02:19,926 [INFO]: 	size in bytes: 824947570
2025-03-13 15:02:19,926 [INFO]: 	avg_search_speed_ms: 10.908484862885777
2025-03-13 15:02:19,926 [INFO]: 	99p_search_speed_ms: 16.363997282460335
2025-03-13 15:02:19,926 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:02:19,926 [INFO]: 	nb vectors: 4193
2025-03-13 15:02:19,926 [INFO]: 	vectors dimension: 49152
2025-03-13 15:02:19,926 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-13 15:02:19,926 [INFO]: }
2025-03-13 15:02:19,926 [INFO]: 	>>> Finished "Creating the index" in 90.0440 secs
2025-03-13 15:02:19,926 [INFO]: >>> Finished "Launching the whole pipeline" in 90.0778 secs
2025-03-13 15:02:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:02:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 89041 [episode count 19/20]
2025-03-13 15:02:21: [retrieval_preprocessing] finished for 2569763324_put_tennis_ball_in_container [chosen_id count 0/196]
2025-03-13 15:02:22: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2782099537_pour_cup_into_bowl [chosen_id count 1/196]
2025-03-13 15:02:22: [retrieval_preprocessing] we have num_total=3087 embedding_dim=49152
[retrieval_preprocessing] for episode 92673 [episode count 0/20], we have num_retrieval=np.int64(2860) num_query=np.int64(227)
2025-03-13 15:02:22,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:02:22,912 [INFO]: Launching the whole pipeline 03/13/2025, 15:02:22
2025-03-13 15:02:22,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:02:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1073.26it/s]
2025-03-13 15:02:22,940 [INFO]: There are 2860 embeddings of dim 49152
2025-03-13 15:02:22,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 15:02:22,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:02:22
2025-03-13 15:02:22,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:02:22,941 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:02:22,941 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:02:22,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:02:22,941 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:02:22
2025-03-13 15:02:22,941 [INFO]: 590.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:02:22,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:02:22,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:02:22
2025-03-13 15:02:22,942 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:02:22,942 [INFO]: 	Creating the index 03/13/2025, 15:02:22
2025-03-13 15:02:22,942 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:02:22
2025-03-13 15:02:22,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 15:02:22,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:02:22
2025-03-13 15:02:22,944 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:02:22,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.62it/s] 50%|█████     | 6/12 [00:00<00:00, 30.57it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.53it/s]100%|██████████| 12/12 [00:02<00:00,  4.67it/s]
2025-03-13 15:02:25,518 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:02:25
2025-03-13 15:03:03,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8821 secs
2025-03-13 15:03:03,400 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 15:03:03,401 [INFO]: 	Compute fast metrics 03/13/2025, 15:03:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.98it/s]
2025-03-13 15:03:28,119 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7188 secs
2025-03-13 15:03:28,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1781 secs
2025-03-13 15:03:28,123 [INFO]: {
2025-03-13 15:03:28,123 [INFO]: 	index_key: HNSW15
2025-03-13 15:03:28,123 [INFO]: 	index_param: efSearch=149
2025-03-13 15:03:28,123 [INFO]: 	index_path: knn.index
2025-03-13 15:03:28,123 [INFO]: 	size in bytes: 562687270
2025-03-13 15:03:28,123 [INFO]: 	avg_search_speed_ms: 8.879398379134111
2025-03-13 15:03:28,123 [INFO]: 	99p_search_speed_ms: 14.247947954572737
2025-03-13 15:03:28,123 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:28,123 [INFO]: 	nb vectors: 2860
2025-03-13 15:03:28,123 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:28,123 [INFO]: 	compression ratio: 0.9993097586870945
2025-03-13 15:03:28,123 [INFO]: }
2025-03-13 15:03:28,123 [INFO]: 	>>> Finished "Creating the index" in 65.1808 secs
2025-03-13 15:03:28,123 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2106 secs
2025-03-13 15:03:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 92673 [episode count 0/20]
[retrieval_preprocessing] for episode 10243 [episode count 1/20], we have num_retrieval=np.int64(2951) num_query=np.int64(136)
2025-03-13 15:03:30,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:31,123 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:31
2025-03-13 15:03:31,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.90it/s]
2025-03-13 15:03:31,151 [INFO]: There are 2951 embeddings of dim 49152
2025-03-13 15:03:31,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 15:03:31,151 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:31
2025-03-13 15:03:31,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:31,151 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:03:31,151 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:03:31,151 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:03:31,151 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:31
2025-03-13 15:03:31,152 [INFO]: 609.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:31,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:03:31,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:31
2025-03-13 15:03:31,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:31,152 [INFO]: 	Creating the index 03/13/2025, 15:03:31
2025-03-13 15:03:31,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:03:31
2025-03-13 15:03:31,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:03:31,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:31
2025-03-13 15:03:31,153 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:03:31,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.93it/s] 50%|█████     | 6/12 [00:00<00:00, 29.31it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.82it/s]100%|██████████| 12/12 [00:02<00:00,  4.30it/s]
2025-03-13 15:03:33,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:03:33
2025-03-13 15:04:19,042 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0929 secs
2025-03-13 15:04:19,042 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 15:04:19,042 [INFO]: 	Compute fast metrics 03/13/2025, 15:04:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.22it/s]
2025-03-13 15:04:42,889 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8467 secs
2025-03-13 15:04:42,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7386 secs
2025-03-13 15:04:42,892 [INFO]: {
2025-03-13 15:04:42,892 [INFO]: 	index_key: HNSW15
2025-03-13 15:04:42,892 [INFO]: 	index_param: efSearch=187
2025-03-13 15:04:42,892 [INFO]: 	index_path: knn.index
2025-03-13 15:04:42,892 [INFO]: 	size in bytes: 580590910
2025-03-13 15:04:42,892 [INFO]: 	avg_search_speed_ms: 9.12138623594184
2025-03-13 15:04:42,892 [INFO]: 	99p_search_speed_ms: 13.592733850236979
2025-03-13 15:04:42,892 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:04:42,892 [INFO]: 	nb vectors: 2951
2025-03-13 15:04:42,892 [INFO]: 	vectors dimension: 49152
2025-03-13 15:04:42,892 [INFO]: 	compression ratio: 0.9993098376273235
2025-03-13 15:04:42,892 [INFO]: }
2025-03-13 15:04:42,892 [INFO]: 	>>> Finished "Creating the index" in 71.7400 secs
2025-03-13 15:04:42,892 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7690 secs
2025-03-13 15:04:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:04:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 10243 [episode count 1/20]
[retrieval_preprocessing] for episode 27652 [episode count 2/20], we have num_retrieval=np.int64(2920) num_query=np.int64(167)
2025-03-13 15:04:44,229 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:04:44,698 [INFO]: Launching the whole pipeline 03/13/2025, 15:04:44
2025-03-13 15:04:44,699 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:04:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1903.91it/s]
2025-03-13 15:04:44,723 [INFO]: There are 2920 embeddings of dim 49152
2025-03-13 15:04:44,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 15:04:44,724 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:04:44
2025-03-13 15:04:44,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:04:44,724 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:04:44,724 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:04:44,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:04:44,724 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:04:44
2025-03-13 15:04:44,724 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:04:44,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:04:44,724 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:04:44
2025-03-13 15:04:44,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:04:44,724 [INFO]: 	Creating the index 03/13/2025, 15:04:44
2025-03-13 15:04:44,724 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:04:44
2025-03-13 15:04:44,725 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:04:44,725 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:04:44
2025-03-13 15:04:44,725 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:04:44,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.76it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.07it/s]100%|██████████| 12/12 [00:02<00:00,  3.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.34it/s]
2025-03-13 15:04:47,492 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:47
2025-03-13 15:05:43,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0706 secs
2025-03-13 15:05:43,563 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 15:05:43,563 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 15:06:07,562 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9987 secs
2025-03-13 15:06:07,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8389 secs
2025-03-13 15:06:07,565 [INFO]: {
2025-03-13 15:06:07,565 [INFO]: 	index_key: HNSW15
2025-03-13 15:06:07,565 [INFO]: 	index_param: efSearch=130
2025-03-13 15:06:07,565 [INFO]: 	index_path: knn.index
2025-03-13 15:06:07,565 [INFO]: 	size in bytes: 574491850
2025-03-13 15:06:07,565 [INFO]: 	avg_search_speed_ms: 6.842425898320509
2025-03-13 15:06:07,565 [INFO]: 	99p_search_speed_ms: 10.231142351403834
2025-03-13 15:06:07,565 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:07,565 [INFO]: 	nb vectors: 2920
2025-03-13 15:06:07,565 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:07,565 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-13 15:06:07,565 [INFO]: }
2025-03-13 15:06:07,565 [INFO]: 	>>> Finished "Creating the index" in 82.8404 secs
2025-03-13 15:06:07,565 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8662 secs
2025-03-13 15:06:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 27652 [episode count 2/20]
[retrieval_preprocessing] for episode 36377 [episode count 3/20], we have num_retrieval=np.int64(2941) num_query=np.int64(146)
2025-03-13 15:06:08,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:09,916 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:09
2025-03-13 15:06:09,916 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2130.17it/s]
2025-03-13 15:06:09,942 [INFO]: There are 2941 embeddings of dim 49152
2025-03-13 15:06:09,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 15:06:09,943 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,943 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:09,943 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:06:09,943 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:06:09,943 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:09,943 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,943 [INFO]: 607.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:09,943 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:06:09,943 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:09
2025-03-13 15:06:09,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:09,943 [INFO]: 	Creating the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,943 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:06:09
2025-03-13 15:06:09,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:06:09,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:09
2025-03-13 15:06:09,944 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:06:09,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.68it/s] 50%|█████     | 6/12 [00:00<00:00, 26.47it/s] 92%|█████████▏| 11/12 [00:00<00:00, 32.83it/s]100%|██████████| 12/12 [00:02<00:00,  4.90it/s]
2025-03-13 15:06:12,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:12
2025-03-13 15:06:56,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6835 secs
2025-03-13 15:06:56,080 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 15:06:56,080 [INFO]: 	Compute fast metrics 03/13/2025, 15:06:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 15:07:21,177 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0970 secs
2025-03-13 15:07:21,180 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2356 secs
2025-03-13 15:07:21,180 [INFO]: {
2025-03-13 15:07:21,180 [INFO]: 	index_key: HNSW15
2025-03-13 15:07:21,180 [INFO]: 	index_param: efSearch=191
2025-03-13 15:07:21,180 [INFO]: 	index_path: knn.index
2025-03-13 15:07:21,180 [INFO]: 	size in bytes: 578623510
2025-03-13 15:07:21,180 [INFO]: 	avg_search_speed_ms: 10.474410962498704
2025-03-13 15:07:21,180 [INFO]: 	99p_search_speed_ms: 21.135979495011274
2025-03-13 15:07:21,180 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:07:21,180 [INFO]: 	nb vectors: 2941
2025-03-13 15:07:21,180 [INFO]: 	vectors dimension: 49152
2025-03-13 15:07:21,180 [INFO]: 	compression ratio: 0.9993097722558836
2025-03-13 15:07:21,180 [INFO]: }
2025-03-13 15:07:21,180 [INFO]: 	>>> Finished "Creating the index" in 71.2369 secs
2025-03-13 15:07:21,180 [INFO]: >>> Finished "Launching the whole pipeline" in 71.2644 secs
2025-03-13 15:07:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:07:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 36377 [episode count 3/20]
[retrieval_preprocessing] for episode 68128 [episode count 4/20], we have num_retrieval=np.int64(2942) num_query=np.int64(145)
2025-03-13 15:07:22,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:07:23,230 [INFO]: Launching the whole pipeline 03/13/2025, 15:07:23
2025-03-13 15:07:23,230 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:07:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.27it/s]
2025-03-13 15:07:23,258 [INFO]: There are 2942 embeddings of dim 49152
2025-03-13 15:07:23,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 15:07:23,259 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:07:23
2025-03-13 15:07:23,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:07:23,259 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:07:23,259 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:07:23,259 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:07:23,259 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:07:23
2025-03-13 15:07:23,259 [INFO]: 607.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:07:23,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:07:23,259 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:07:23
2025-03-13 15:07:23,259 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:07:23,259 [INFO]: 	Creating the index 03/13/2025, 15:07:23
2025-03-13 15:07:23,259 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:07:23
2025-03-13 15:07:23,260 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:07:23,260 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:07:23
2025-03-13 15:07:23,260 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:07:23,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.70it/s] 42%|████▏     | 5/12 [00:00<00:00, 21.88it/s] 75%|███████▌  | 9/12 [00:00<00:00, 28.14it/s]100%|██████████| 12/12 [00:03<00:00,  2.43it/s]100%|██████████| 12/12 [00:03<00:00,  3.40it/s]
2025-03-13 15:07:26,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:07:26
2025-03-13 15:08:11,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3876 secs
2025-03-13 15:08:11,181 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 15:08:11,181 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 15:08:34,350 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1688 secs
2025-03-13 15:08:34,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0919 secs
2025-03-13 15:08:34,353 [INFO]: {
2025-03-13 15:08:34,353 [INFO]: 	index_key: HNSW15
2025-03-13 15:08:34,353 [INFO]: 	index_param: efSearch=199
2025-03-13 15:08:34,353 [INFO]: 	index_path: knn.index
2025-03-13 15:08:34,353 [INFO]: 	size in bytes: 578820250
2025-03-13 15:08:34,353 [INFO]: 	avg_search_speed_ms: 10.121038125362247
2025-03-13 15:08:34,353 [INFO]: 	99p_search_speed_ms: 15.032293456606567
2025-03-13 15:08:34,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:34,353 [INFO]: 	nb vectors: 2942
2025-03-13 15:08:34,353 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:34,353 [INFO]: 	compression ratio: 0.9993097788130253
2025-03-13 15:08:34,353 [INFO]: }
2025-03-13 15:08:34,353 [INFO]: 	>>> Finished "Creating the index" in 71.0935 secs
2025-03-13 15:08:34,353 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1231 secs
2025-03-13 15:08:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:08:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 68128 [episode count 4/20]
[retrieval_preprocessing] for episode 1060 [episode count 5/20], we have num_retrieval=np.int64(2914) num_query=np.int64(173)
2025-03-13 15:08:35,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:08:36,536 [INFO]: Launching the whole pipeline 03/13/2025, 15:08:36
2025-03-13 15:08:36,537 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:08:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.09it/s]
2025-03-13 15:08:36,563 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 15:08:36,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:08:36,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:08:36,564 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:08:36,564 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:08:36,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:08:36,564 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,564 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:08:36,564 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:08:36,564 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:08:36
2025-03-13 15:08:36,564 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:08:36,564 [INFO]: 	Creating the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,564 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:08:36
2025-03-13 15:08:36,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:08:36,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:08:36
2025-03-13 15:08:36,565 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:08:36,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.82it/s] 50%|█████     | 6/12 [00:00<00:00, 29.30it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-13 15:08:39,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:08:39
2025-03-13 15:09:25,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6234 secs
2025-03-13 15:09:25,726 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 15:09:25,726 [INFO]: 	Compute fast metrics 03/13/2025, 15:09:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 15:09:48,203 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4775 secs
2025-03-13 15:09:48,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6400 secs
2025-03-13 15:09:48,206 [INFO]: {
2025-03-13 15:09:48,206 [INFO]: 	index_key: HNSW15
2025-03-13 15:09:48,206 [INFO]: 	index_param: efSearch=134
2025-03-13 15:09:48,206 [INFO]: 	index_path: knn.index
2025-03-13 15:09:48,206 [INFO]: 	size in bytes: 573311410
2025-03-13 15:09:48,206 [INFO]: 	avg_search_speed_ms: 7.233354258795798
2025-03-13 15:09:48,206 [INFO]: 	99p_search_speed_ms: 11.456703343428677
2025-03-13 15:09:48,206 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:09:48,206 [INFO]: 	nb vectors: 2914
2025-03-13 15:09:48,206 [INFO]: 	vectors dimension: 49152
2025-03-13 15:09:48,206 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 15:09:48,206 [INFO]: }
2025-03-13 15:09:48,206 [INFO]: 	>>> Finished "Creating the index" in 71.6415 secs
2025-03-13 15:09:48,206 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6692 secs
2025-03-13 15:09:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 1060 [episode count 5/20]
[retrieval_preprocessing] for episode 71206 [episode count 6/20], we have num_retrieval=np.int64(2958) num_query=np.int64(129)
2025-03-13 15:09:49,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:49,974 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:49
2025-03-13 15:09:49,974 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.50it/s]
2025-03-13 15:09:50,000 [INFO]: There are 2958 embeddings of dim 49152
2025-03-13 15:09:50,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 15:09:50,000 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:50,001 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:09:50,001 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:09:50,001 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:50,001 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,001 [INFO]: 610.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:50,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:09:50,001 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:50
2025-03-13 15:09:50,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:50,001 [INFO]: 	Creating the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,001 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:09:50
2025-03-13 15:09:50,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:09:50,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:50
2025-03-13 15:09:50,002 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:09:50,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.37it/s] 50%|█████     | 6/12 [00:00<00:00, 27.61it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.25it/s]100%|██████████| 12/12 [00:02<00:00,  4.71it/s]
2025-03-13 15:09:52,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:52
2025-03-13 15:10:34,516 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9609 secs
2025-03-13 15:10:34,517 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 15:10:34,517 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-13 15:10:54,730 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2131 secs
2025-03-13 15:10:54,733 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7305 secs
2025-03-13 15:10:54,733 [INFO]: {
2025-03-13 15:10:54,733 [INFO]: 	index_key: HNSW15
2025-03-13 15:10:54,733 [INFO]: 	index_param: efSearch=207
2025-03-13 15:10:54,733 [INFO]: 	index_path: knn.index
2025-03-13 15:10:54,733 [INFO]: 	size in bytes: 581968210
2025-03-13 15:10:54,733 [INFO]: 	avg_search_speed_ms: 10.201362294990721
2025-03-13 15:10:54,733 [INFO]: 	99p_search_speed_ms: 17.037571831606332
2025-03-13 15:10:54,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:10:54,733 [INFO]: 	nb vectors: 2958
2025-03-13 15:10:54,733 [INFO]: 	vectors dimension: 49152
2025-03-13 15:10:54,733 [INFO]: 	compression ratio: 0.999309677069818
2025-03-13 15:10:54,733 [INFO]: }
2025-03-13 15:10:54,733 [INFO]: 	>>> Finished "Creating the index" in 64.7321 secs
2025-03-13 15:10:54,733 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7592 secs
2025-03-13 15:10:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:10:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 71206 [episode count 6/20]
[retrieval_preprocessing] for episode 45608 [episode count 7/20], we have num_retrieval=np.int64(2939) num_query=np.int64(148)
2025-03-13 15:10:56,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:10:56,901 [INFO]: Launching the whole pipeline 03/13/2025, 15:10:56
2025-03-13 15:10:56,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:10:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1580.37it/s]
2025-03-13 15:10:56,929 [INFO]: There are 2939 embeddings of dim 49152
2025-03-13 15:10:56,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 15:10:56,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:10:56,930 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:10:56,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:10:56,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:10:56,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,930 [INFO]: 606.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:10:56,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:10:56,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:10:56
2025-03-13 15:10:56,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:10:56,930 [INFO]: 	Creating the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,930 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:10:56
2025-03-13 15:10:56,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:10:56,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:10:56
2025-03-13 15:10:56,932 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:10:56,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.13it/s] 33%|███▎      | 4/12 [00:00<00:00, 18.00it/s] 67%|██████▋   | 8/12 [00:00<00:00, 24.88it/s]100%|██████████| 12/12 [00:02<00:00,  3.06it/s]100%|██████████| 12/12 [00:02<00:00,  4.01it/s]
2025-03-13 15:10:59,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:10:59
2025-03-13 15:11:44,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9663 secs
2025-03-13 15:11:44,896 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:11:44,896 [INFO]: 	Compute fast metrics 03/13/2025, 15:11:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 15:12:05,569 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6728 secs
2025-03-13 15:12:05,573 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6409 secs
2025-03-13 15:12:05,573 [INFO]: {
2025-03-13 15:12:05,573 [INFO]: 	index_key: HNSW15
2025-03-13 15:12:05,573 [INFO]: 	index_param: efSearch=180
2025-03-13 15:12:05,573 [INFO]: 	index_path: knn.index
2025-03-13 15:12:05,573 [INFO]: 	size in bytes: 578230030
2025-03-13 15:12:05,573 [INFO]: 	avg_search_speed_ms: 11.73913690749066
2025-03-13 15:12:05,573 [INFO]: 	99p_search_speed_ms: 16.292311071883887
2025-03-13 15:12:05,573 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:12:05,573 [INFO]: 	nb vectors: 2939
2025-03-13 15:12:05,573 [INFO]: 	vectors dimension: 49152
2025-03-13 15:12:05,573 [INFO]: 	compression ratio: 0.9993097591282141
2025-03-13 15:12:05,573 [INFO]: }
2025-03-13 15:12:05,573 [INFO]: 	>>> Finished "Creating the index" in 68.6427 secs
2025-03-13 15:12:05,573 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6719 secs
2025-03-13 15:12:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:12:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 45608 [episode count 7/20]
[retrieval_preprocessing] for episode 10287 [episode count 8/20], we have num_retrieval=np.int64(2869) num_query=np.int64(218)
2025-03-13 15:12:07,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:12:08,306 [INFO]: Launching the whole pipeline 03/13/2025, 15:12:08
2025-03-13 15:12:08,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:12:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.52it/s]
2025-03-13 15:12:08,341 [INFO]: There are 2869 embeddings of dim 49152
2025-03-13 15:12:08,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 15:12:08,342 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:12:08,342 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:12:08,342 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:12:08,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:12:08,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,343 [INFO]: 592.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:12:08,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:12:08,343 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:12:08
2025-03-13 15:12:08,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:12:08,344 [INFO]: 	Creating the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:12:08
2025-03-13 15:12:08,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:12:08,347 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:12:08
2025-03-13 15:12:08,347 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:12:08,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.56it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.52it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.37it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.97it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.23it/s]100%|██████████| 12/12 [00:03<00:00,  2.56it/s]100%|██████████| 12/12 [00:03<00:00,  3.83it/s]
2025-03-13 15:12:11,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:11
2025-03-13 15:12:59,174 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6860 secs
2025-03-13 15:12:59,174 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 15:12:59,174 [INFO]: 	Compute fast metrics 03/13/2025, 15:12:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 15:13:19,350 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1758 secs
2025-03-13 15:13:19,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0053 secs
2025-03-13 15:13:19,353 [INFO]: {
2025-03-13 15:13:19,353 [INFO]: 	index_key: HNSW15
2025-03-13 15:13:19,353 [INFO]: 	index_param: efSearch=175
2025-03-13 15:13:19,353 [INFO]: 	index_path: knn.index
2025-03-13 15:13:19,353 [INFO]: 	size in bytes: 564457990
2025-03-13 15:13:19,353 [INFO]: 	avg_search_speed_ms: 8.94163375760367
2025-03-13 15:13:19,353 [INFO]: 	99p_search_speed_ms: 13.553935417439785
2025-03-13 15:13:19,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:13:19,353 [INFO]: 	nb vectors: 2869
2025-03-13 15:13:19,353 [INFO]: 	vectors dimension: 49152
2025-03-13 15:13:19,353 [INFO]: 	compression ratio: 0.9993097130222216
2025-03-13 15:13:19,353 [INFO]: }
2025-03-13 15:13:19,353 [INFO]: 	>>> Finished "Creating the index" in 71.0093 secs
2025-03-13 15:13:19,353 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0471 secs
2025-03-13 15:13:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:13:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 10287 [episode count 8/20]
[retrieval_preprocessing] for episode 53296 [episode count 9/20], we have num_retrieval=np.int64(2891) num_query=np.int64(196)
2025-03-13 15:13:22,172 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:13:22,611 [INFO]: Launching the whole pipeline 03/13/2025, 15:13:22
2025-03-13 15:13:22,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:13:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1937.32it/s]
2025-03-13 15:13:22,639 [INFO]: There are 2891 embeddings of dim 49152
2025-03-13 15:13:22,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:13:22,640 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:13:22
2025-03-13 15:13:22,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:13:22,641 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:13:22,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:13:22,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:13:22,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:13:22
2025-03-13 15:13:22,641 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:13:22,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:13:22,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:13:22
2025-03-13 15:13:22,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:13:22,642 [INFO]: 	Creating the index 03/13/2025, 15:13:22
2025-03-13 15:13:22,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:13:22
2025-03-13 15:13:22,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:13:22,645 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:13:22
2025-03-13 15:13:22,646 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:13:22,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.73it/s]100%|██████████| 12/12 [00:02<00:00,  3.72it/s]100%|██████████| 12/12 [00:02<00:00,  4.54it/s]
2025-03-13 15:13:25,296 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:13:25
2025-03-13 15:14:04,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3535 secs
2025-03-13 15:14:04,650 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 15:14:04,650 [INFO]: 	Compute fast metrics 03/13/2025, 15:14:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 15:14:33,258 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6072 secs
2025-03-13 15:14:33,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6155 secs
2025-03-13 15:14:33,261 [INFO]: {
2025-03-13 15:14:33,261 [INFO]: 	index_key: HNSW15
2025-03-13 15:14:33,261 [INFO]: 	index_param: efSearch=230
2025-03-13 15:14:33,261 [INFO]: 	index_path: knn.index
2025-03-13 15:14:33,261 [INFO]: 	size in bytes: 568786330
2025-03-13 15:14:33,261 [INFO]: 	avg_search_speed_ms: 9.777681846972754
2025-03-13 15:14:33,262 [INFO]: 	99p_search_speed_ms: 13.978967405855656
2025-03-13 15:14:33,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:33,262 [INFO]: 	nb vectors: 2891
2025-03-13 15:14:33,262 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:33,262 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-13 15:14:33,262 [INFO]: }
2025-03-13 15:14:33,262 [INFO]: 	>>> Finished "Creating the index" in 70.6197 secs
2025-03-13 15:14:33,262 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6507 secs
2025-03-13 15:14:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 53296 [episode count 9/20]
[retrieval_preprocessing] for episode 54837 [episode count 10/20], we have num_retrieval=np.int64(2960) num_query=np.int64(127)
2025-03-13 15:14:36,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:36,808 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:36
2025-03-13 15:14:36,808 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.22it/s]
2025-03-13 15:14:36,840 [INFO]: There are 2960 embeddings of dim 49152
2025-03-13 15:14:36,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 15:14:36,840 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:36
2025-03-13 15:14:36,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:36,841 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:14:36,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:14:36,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:14:36,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:36
2025-03-13 15:14:36,841 [INFO]: 610.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:36,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:14:36,842 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:36
2025-03-13 15:14:36,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:36,842 [INFO]: 	Creating the index 03/13/2025, 15:14:36
2025-03-13 15:14:36,843 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:14:36
2025-03-13 15:14:36,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:14:36,846 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:36
2025-03-13 15:14:36,847 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:14:36,847 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.84it/s] 42%|████▏     | 5/12 [00:00<00:00, 21.29it/s] 75%|███████▌  | 9/12 [00:00<00:00, 26.27it/s]100%|██████████| 12/12 [00:03<00:00,  2.35it/s]100%|██████████| 12/12 [00:03<00:00,  3.30it/s]
2025-03-13 15:14:40,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:40
2025-03-13 15:15:24,990 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5013 secs
2025-03-13 15:15:24,990 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 15:15:24,990 [INFO]: 	Compute fast metrics 03/13/2025, 15:15:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.81it/s]
2025-03-13 15:15:40,193 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2032 secs
2025-03-13 15:15:40,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3505 secs
2025-03-13 15:15:40,197 [INFO]: {
2025-03-13 15:15:40,197 [INFO]: 	index_key: HNSW15
2025-03-13 15:15:40,197 [INFO]: 	index_param: efSearch=183
2025-03-13 15:15:40,197 [INFO]: 	index_path: knn.index
2025-03-13 15:15:40,197 [INFO]: 	size in bytes: 582361750
2025-03-13 15:15:40,197 [INFO]: 	avg_search_speed_ms: 11.872529957558372
2025-03-13 15:15:40,197 [INFO]: 	99p_search_speed_ms: 20.126687553711278
2025-03-13 15:15:40,198 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:15:40,198 [INFO]: 	nb vectors: 2960
2025-03-13 15:15:40,198 [INFO]: 	vectors dimension: 49152
2025-03-13 15:15:40,198 [INFO]: 	compression ratio: 0.9993095872110419
2025-03-13 15:15:40,198 [INFO]: }
2025-03-13 15:15:40,198 [INFO]: 	>>> Finished "Creating the index" in 63.3550 secs
2025-03-13 15:15:40,198 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3896 secs
2025-03-13 15:15:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:15:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 54837 [episode count 10/20]
[retrieval_preprocessing] for episode 70198 [episode count 11/20], we have num_retrieval=np.int64(2947) num_query=np.int64(140)
2025-03-13 15:15:41,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:15:42,282 [INFO]: Launching the whole pipeline 03/13/2025, 15:15:42
2025-03-13 15:15:42,282 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:15:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.13it/s]
2025-03-13 15:15:42,311 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 15:15:42,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 15:15:42,311 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:15:42
2025-03-13 15:15:42,311 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:15:42,311 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:15:42,311 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:15:42,311 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:15:42,311 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:15:42
2025-03-13 15:15:42,311 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:15:42,311 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:15:42,311 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:15:42
2025-03-13 15:15:42,311 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:15:42,311 [INFO]: 	Creating the index 03/13/2025, 15:15:42
2025-03-13 15:15:42,311 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:15:42
2025-03-13 15:15:42,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:15:42,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:15:42
2025-03-13 15:15:42,313 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:15:42,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.71it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.14it/s] 75%|███████▌  | 9/12 [00:00<00:00, 28.23it/s]100%|██████████| 12/12 [00:02<00:00,  3.10it/s]100%|██████████| 12/12 [00:02<00:00,  4.30it/s]
2025-03-13 15:15:45,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:15:45
2025-03-13 15:16:33,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3345 secs
2025-03-13 15:16:33,441 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:16:33,441 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.53it/s]
2025-03-13 15:17:03,656 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2147 secs
2025-03-13 15:17:03,660 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.3475 secs
2025-03-13 15:17:03,660 [INFO]: {
2025-03-13 15:17:03,661 [INFO]: 	index_key: HNSW15
2025-03-13 15:17:03,661 [INFO]: 	index_param: efSearch=196
2025-03-13 15:17:03,661 [INFO]: 	index_path: knn.index
2025-03-13 15:17:03,661 [INFO]: 	size in bytes: 579803950
2025-03-13 15:17:03,661 [INFO]: 	avg_search_speed_ms: 9.942956151677736
2025-03-13 15:17:03,661 [INFO]: 	99p_search_speed_ms: 15.105112374294556
2025-03-13 15:17:03,661 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:03,661 [INFO]: 	nb vectors: 2947
2025-03-13 15:17:03,661 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:03,661 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 15:17:03,661 [INFO]: }
2025-03-13 15:17:03,661 [INFO]: 	>>> Finished "Creating the index" in 81.3494 secs
2025-03-13 15:17:03,661 [INFO]: >>> Finished "Launching the whole pipeline" in 81.3790 secs
2025-03-13 15:17:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 70198 [episode count 11/20]
[retrieval_preprocessing] for episode 45632 [episode count 12/20], we have num_retrieval=np.int64(2914) num_query=np.int64(173)
2025-03-13 15:17:05,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:05,987 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:05
2025-03-13 15:17:05,988 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.95it/s]
2025-03-13 15:17:06,020 [INFO]: There are 2914 embeddings of dim 49152
2025-03-13 15:17:06,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 15:17:06,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:06
2025-03-13 15:17:06,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:06,021 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:17:06,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:17:06,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:17:06,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:06
2025-03-13 15:17:06,022 [INFO]: 601.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:06,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:17:06,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:06
2025-03-13 15:17:06,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:17:06,023 [INFO]: 	Creating the index 03/13/2025, 15:17:06
2025-03-13 15:17:06,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:17:06
2025-03-13 15:17:06,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:17:06,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:06
2025-03-13 15:17:06,026 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:17:06,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.29it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.73it/s]100%|██████████| 12/12 [00:02<00:00,  3.70it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]
2025-03-13 15:17:08,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:08
2025-03-13 15:17:55,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5895 secs
2025-03-13 15:17:55,274 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 15:17:55,274 [INFO]: 	Compute fast metrics 03/13/2025, 15:17:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 15:18:22,839 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5646 secs
2025-03-13 15:18:22,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8149 secs
2025-03-13 15:18:22,841 [INFO]: {
2025-03-13 15:18:22,841 [INFO]: 	index_key: HNSW15
2025-03-13 15:18:22,841 [INFO]: 	index_param: efSearch=167
2025-03-13 15:18:22,841 [INFO]: 	index_path: knn.index
2025-03-13 15:18:22,841 [INFO]: 	size in bytes: 573311410
2025-03-13 15:18:22,841 [INFO]: 	avg_search_speed_ms: 8.335472560914544
2025-03-13 15:18:22,842 [INFO]: 	99p_search_speed_ms: 12.039984972216189
2025-03-13 15:18:22,842 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:18:22,842 [INFO]: 	nb vectors: 2914
2025-03-13 15:18:22,842 [INFO]: 	vectors dimension: 49152
2025-03-13 15:18:22,842 [INFO]: 	compression ratio: 0.9993098026777454
2025-03-13 15:18:22,842 [INFO]: }
2025-03-13 15:18:22,842 [INFO]: 	>>> Finished "Creating the index" in 76.8189 secs
2025-03-13 15:18:22,842 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8540 secs
2025-03-13 15:18:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:18:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 45632 [episode count 12/20]
[retrieval_preprocessing] for episode 67139 [episode count 13/20], we have num_retrieval=np.int64(2945) num_query=np.int64(142)
2025-03-13 15:18:24,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:18:24,854 [INFO]: Launching the whole pipeline 03/13/2025, 15:18:24
2025-03-13 15:18:24,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:18:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1394.38it/s]
2025-03-13 15:18:24,884 [INFO]: There are 2945 embeddings of dim 49152
2025-03-13 15:18:24,884 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 15:18:24,884 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:18:24
2025-03-13 15:18:24,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:18:24,885 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:18:24,885 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:18:24,885 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:18:24,885 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:18:24
2025-03-13 15:18:24,886 [INFO]: 607.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:18:24,886 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:18:24,886 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:18:24
2025-03-13 15:18:24,886 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:18:24,887 [INFO]: 	Creating the index 03/13/2025, 15:18:24
2025-03-13 15:18:24,887 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:18:24
2025-03-13 15:18:24,889 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:18:24,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:18:24
2025-03-13 15:18:24,890 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:18:24,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.14it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.61it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]100%|██████████| 12/12 [00:02<00:00,  5.19it/s]
2025-03-13 15:18:27,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:18:27
2025-03-13 15:19:04,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2768 secs
2025-03-13 15:19:04,484 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 15:19:04,484 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 15:19:28,720 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2358 secs
2025-03-13 15:19:28,722 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8323 secs
2025-03-13 15:19:28,722 [INFO]: {
2025-03-13 15:19:28,722 [INFO]: 	index_key: HNSW15
2025-03-13 15:19:28,722 [INFO]: 	index_param: efSearch=216
2025-03-13 15:19:28,723 [INFO]: 	index_path: knn.index
2025-03-13 15:19:28,723 [INFO]: 	size in bytes: 579410470
2025-03-13 15:19:28,723 [INFO]: 	avg_search_speed_ms: 9.461304424427514
2025-03-13 15:19:28,723 [INFO]: 	99p_search_speed_ms: 13.654039381071932
2025-03-13 15:19:28,723 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:19:28,723 [INFO]: 	nb vectors: 2945
2025-03-13 15:19:28,723 [INFO]: 	vectors dimension: 49152
2025-03-13 15:19:28,723 [INFO]: 	compression ratio: 0.9993097984577324
2025-03-13 15:19:28,723 [INFO]: }
2025-03-13 15:19:28,723 [INFO]: 	>>> Finished "Creating the index" in 63.8361 secs
2025-03-13 15:19:28,723 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8681 secs
2025-03-13 15:19:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:19:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 67139 [episode count 13/20]
[retrieval_preprocessing] for episode 587 [episode count 14/20], we have num_retrieval=np.int64(2946) num_query=np.int64(141)
2025-03-13 15:19:30,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:19:30,682 [INFO]: Launching the whole pipeline 03/13/2025, 15:19:30
2025-03-13 15:19:30,682 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:19:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1019.02it/s]
2025-03-13 15:19:30,710 [INFO]: There are 2946 embeddings of dim 49152
2025-03-13 15:19:30,710 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 15:19:30,710 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:19:30
2025-03-13 15:19:30,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:19:30,710 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:19:30,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:19:30,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:19:30,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:19:30
2025-03-13 15:19:30,711 [INFO]: 608.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:19:30,711 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:19:30,711 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:19:30
2025-03-13 15:19:30,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:19:30,711 [INFO]: 	Creating the index 03/13/2025, 15:19:30
2025-03-13 15:19:30,711 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:19:30
2025-03-13 15:19:30,712 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:19:30,712 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:19:30
2025-03-13 15:19:30,712 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:19:30,712 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.17it/s] 50%|█████     | 6/12 [00:00<00:00, 28.66it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.30it/s]100%|██████████| 12/12 [00:02<00:00,  4.87it/s]
2025-03-13 15:19:33,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:19:33
2025-03-13 15:20:17,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3078 secs
2025-03-13 15:20:17,488 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:20:17,489 [INFO]: 	Compute fast metrics 03/13/2025, 15:20:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.46it/s]
2025-03-13 15:20:36,219 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7305 secs
2025-03-13 15:20:36,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5097 secs
2025-03-13 15:20:36,222 [INFO]: {
2025-03-13 15:20:36,222 [INFO]: 	index_key: HNSW15
2025-03-13 15:20:36,222 [INFO]: 	index_param: efSearch=162
2025-03-13 15:20:36,222 [INFO]: 	index_path: knn.index
2025-03-13 15:20:36,222 [INFO]: 	size in bytes: 579607210
2025-03-13 15:20:36,222 [INFO]: 	avg_search_speed_ms: 10.65959179722297
2025-03-13 15:20:36,222 [INFO]: 	99p_search_speed_ms: 15.605371200945228
2025-03-13 15:20:36,222 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:36,222 [INFO]: 	nb vectors: 2946
2025-03-13 15:20:36,222 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:36,222 [INFO]: 	compression ratio: 0.9993098049970772
2025-03-13 15:20:36,222 [INFO]: }
2025-03-13 15:20:36,222 [INFO]: 	>>> Finished "Creating the index" in 65.5113 secs
2025-03-13 15:20:36,222 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5406 secs
2025-03-13 15:20:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 587 [episode count 14/20]
[retrieval_preprocessing] for episode 28235 [episode count 15/20], we have num_retrieval=np.int64(2959) num_query=np.int64(128)
2025-03-13 15:20:38,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:38,622 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:38
2025-03-13 15:20:38,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1101.45it/s]
2025-03-13 15:20:38,900 [INFO]: There are 2959 embeddings of dim 49152
2025-03-13 15:20:38,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2786 secs
2025-03-13 15:20:38,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:38,901 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:20:38,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:20:38,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:20:38,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,901 [INFO]: 610.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:38,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:20:38,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:38
2025-03-13 15:20:38,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:38,902 [INFO]: 	Creating the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,902 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:38
2025-03-13 15:20:38,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 15:20:38,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:38
2025-03-13 15:20:38,905 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:20:38,905 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.84it/s] 42%|████▏     | 5/12 [00:00<00:00, 26.03it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.89it/s]100%|██████████| 12/12 [00:02<00:00,  4.53it/s]
2025-03-13 15:20:41,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:41
2025-03-13 15:21:19,977 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4171 secs
2025-03-13 15:21:19,977 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:21:19,977 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 15:21:40,988 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0107 secs
2025-03-13 15:21:40,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0865 secs
2025-03-13 15:21:40,992 [INFO]: {
2025-03-13 15:21:40,992 [INFO]: 	index_key: HNSW15
2025-03-13 15:21:40,992 [INFO]: 	index_param: efSearch=185
2025-03-13 15:21:40,992 [INFO]: 	index_path: knn.index
2025-03-13 15:21:40,992 [INFO]: 	size in bytes: 582164950
2025-03-13 15:21:40,992 [INFO]: 	avg_search_speed_ms: 10.184294494132601
2025-03-13 15:21:40,992 [INFO]: 	99p_search_speed_ms: 16.530238015111525
2025-03-13 15:21:40,992 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:21:40,992 [INFO]: 	nb vectors: 2959
2025-03-13 15:21:40,992 [INFO]: 	vectors dimension: 49152
2025-03-13 15:21:40,992 [INFO]: 	compression ratio: 0.9993096836214547
2025-03-13 15:21:40,992 [INFO]: }
2025-03-13 15:21:40,992 [INFO]: 	>>> Finished "Creating the index" in 62.0899 secs
2025-03-13 15:21:40,992 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3701 secs
2025-03-13 15:21:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:21:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 28235 [episode count 15/20]
[retrieval_preprocessing] for episode 87635 [episode count 16/20], we have num_retrieval=np.int64(2947) num_query=np.int64(140)
2025-03-13 15:21:42,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:21:42,741 [INFO]: Launching the whole pipeline 03/13/2025, 15:21:42
2025-03-13 15:21:42,741 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:21:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.68it/s]
2025-03-13 15:21:42,766 [INFO]: There are 2947 embeddings of dim 49152
2025-03-13 15:21:42,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 15:21:42,767 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:21:42
2025-03-13 15:21:42,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:21:42,767 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:21:42,767 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:21:42,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:21:42,767 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:21:42
2025-03-13 15:21:42,767 [INFO]: 608.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:21:42,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:21:42,767 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:21:42
2025-03-13 15:21:42,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:21:42,767 [INFO]: 	Creating the index 03/13/2025, 15:21:42
2025-03-13 15:21:42,767 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:21:42
2025-03-13 15:21:42,768 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:21:42,768 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:21:42
2025-03-13 15:21:42,768 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:21:42,768 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.92it/s]100%|██████████| 12/12 [00:02<00:00,  3.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.60it/s]
2025-03-13 15:21:45,379 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:21:45
2025-03-13 15:22:25,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1489 secs
2025-03-13 15:22:25,529 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 15:22:25,529 [INFO]: 	Compute fast metrics 03/13/2025, 15:22:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.66it/s]
2025-03-13 15:22:46,089 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5596 secs
2025-03-13 15:22:46,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3226 secs
2025-03-13 15:22:46,091 [INFO]: {
2025-03-13 15:22:46,091 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:46,091 [INFO]: 	index_param: efSearch=205
2025-03-13 15:22:46,091 [INFO]: 	index_path: knn.index
2025-03-13 15:22:46,091 [INFO]: 	size in bytes: 579803950
2025-03-13 15:22:46,091 [INFO]: 	avg_search_speed_ms: 11.724174553299147
2025-03-13 15:22:46,091 [INFO]: 	99p_search_speed_ms: 19.197088181972514
2025-03-13 15:22:46,091 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:46,091 [INFO]: 	nb vectors: 2947
2025-03-13 15:22:46,091 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:46,091 [INFO]: 	compression ratio: 0.9993098115319842
2025-03-13 15:22:46,091 [INFO]: }
2025-03-13 15:22:46,091 [INFO]: 	>>> Finished "Creating the index" in 63.3240 secs
2025-03-13 15:22:46,092 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3502 secs
2025-03-13 15:22:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 87635 [episode count 16/20]
[retrieval_preprocessing] for episode 37974 [episode count 17/20], we have num_retrieval=np.int64(2980) num_query=np.int64(107)
2025-03-13 15:22:48,832 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:49,449 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:49
2025-03-13 15:22:49,449 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.78it/s]
2025-03-13 15:22:49,477 [INFO]: There are 2980 embeddings of dim 49152
2025-03-13 15:22:49,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:22:49,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:49
2025-03-13 15:22:49,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:49,478 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:22:49,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:22:49,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:49,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:49
2025-03-13 15:22:49,478 [INFO]: 615.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:49,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:22:49,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:49
2025-03-13 15:22:49,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:49,478 [INFO]: 	Creating the index 03/13/2025, 15:22:49
2025-03-13 15:22:49,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:22:49
2025-03-13 15:22:49,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:22:49,480 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:49
2025-03-13 15:22:49,480 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:22:49,480 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.58it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.70it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]100%|██████████| 12/12 [00:02<00:00,  5.18it/s]
2025-03-13 15:22:51,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:22:51
2025-03-13 15:23:39,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6386 secs
2025-03-13 15:23:39,439 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 15:23:39,439 [INFO]: 	Compute fast metrics 03/13/2025, 15:23:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 15:23:58,766 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3275 secs
2025-03-13 15:23:58,770 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2897 secs
2025-03-13 15:23:58,770 [INFO]: {
2025-03-13 15:23:58,770 [INFO]: 	index_key: HNSW15
2025-03-13 15:23:58,770 [INFO]: 	index_param: efSearch=184
2025-03-13 15:23:58,770 [INFO]: 	index_path: knn.index
2025-03-13 15:23:58,770 [INFO]: 	size in bytes: 586296610
2025-03-13 15:23:58,770 [INFO]: 	avg_search_speed_ms: 9.40182331806798
2025-03-13 15:23:58,770 [INFO]: 	99p_search_speed_ms: 15.356271499767828
2025-03-13 15:23:58,770 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:23:58,770 [INFO]: 	nb vectors: 2980
2025-03-13 15:23:58,770 [INFO]: 	vectors dimension: 49152
2025-03-13 15:23:58,770 [INFO]: 	compression ratio: 0.999309615656826
2025-03-13 15:23:58,770 [INFO]: }
2025-03-13 15:23:58,770 [INFO]: 	>>> Finished "Creating the index" in 69.2917 secs
2025-03-13 15:23:58,770 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3211 secs
2025-03-13 15:23:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:23:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 37974 [episode count 17/20]
[retrieval_preprocessing] for episode 5723 [episode count 18/20], we have num_retrieval=np.int64(2937) num_query=np.int64(150)
2025-03-13 15:24:00,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:24:00,626 [INFO]: Launching the whole pipeline 03/13/2025, 15:24:00
2025-03-13 15:24:00,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:24:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.80it/s]
2025-03-13 15:24:00,654 [INFO]: There are 2937 embeddings of dim 49152
2025-03-13 15:24:00,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:24:00,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:24:00
2025-03-13 15:24:00,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:24:00,654 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:24:00,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:24:00,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:24:00,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:24:00
2025-03-13 15:24:00,654 [INFO]: 606.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:24:00,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:24:00,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:24:00
2025-03-13 15:24:00,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:24:00,654 [INFO]: 	Creating the index 03/13/2025, 15:24:00
2025-03-13 15:24:00,655 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:24:00
2025-03-13 15:24:00,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:24:00,656 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:24:00
2025-03-13 15:24:00,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:24:00,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.94it/s] 50%|█████     | 6/12 [00:00<00:00, 28.39it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.64it/s]
2025-03-13 15:24:03,244 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:24:03
2025-03-13 15:24:45,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3068 secs
2025-03-13 15:24:45,551 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:24:45,551 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 15:25:08,312 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7609 secs
2025-03-13 15:25:08,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6593 secs
2025-03-13 15:25:08,315 [INFO]: {
2025-03-13 15:25:08,315 [INFO]: 	index_key: HNSW15
2025-03-13 15:25:08,315 [INFO]: 	index_param: efSearch=192
2025-03-13 15:25:08,315 [INFO]: 	index_path: knn.index
2025-03-13 15:25:08,315 [INFO]: 	size in bytes: 577836550
2025-03-13 15:25:08,315 [INFO]: 	avg_search_speed_ms: 9.398309970834761
2025-03-13 15:25:08,315 [INFO]: 	99p_search_speed_ms: 14.835813306271989
2025-03-13 15:25:08,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:08,315 [INFO]: 	nb vectors: 2937
2025-03-13 15:25:08,315 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:08,315 [INFO]: 	compression ratio: 0.9993097459826659
2025-03-13 15:25:08,315 [INFO]: }
2025-03-13 15:25:08,315 [INFO]: 	>>> Finished "Creating the index" in 67.6608 secs
2025-03-13 15:25:08,315 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6895 secs
2025-03-13 15:25:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 5723 [episode count 18/20]
[retrieval_preprocessing] for episode 79448 [episode count 19/20], we have num_retrieval=np.int64(2933) num_query=np.int64(154)
2025-03-13 15:25:09,957 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:10,445 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:10
2025-03-13 15:25:10,445 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1680.41it/s]
2025-03-13 15:25:10,470 [INFO]: There are 2933 embeddings of dim 49152
2025-03-13 15:25:10,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:25:10,471 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,471 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:10,471 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:25:10,471 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:25:10,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:10,471 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,471 [INFO]: 605.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:10,471 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:25:10,471 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:10
2025-03-13 15:25:10,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:10,471 [INFO]: 	Creating the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,471 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:25:10
2025-03-13 15:25:10,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:25:10,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:10
2025-03-13 15:25:10,472 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:25:10,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.39it/s] 50%|█████     | 6/12 [00:00<00:00, 26.39it/s] 83%|████████▎ | 10/12 [00:00<00:00, 31.51it/s]100%|██████████| 12/12 [00:03<00:00,  3.96it/s]
2025-03-13 15:25:13,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:13
2025-03-13 15:25:56,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3088 secs
2025-03-13 15:25:56,816 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 15:25:56,816 [INFO]: 	Compute fast metrics 03/13/2025, 15:25:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 15:26:23,024 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2080 secs
2025-03-13 15:26:23,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5546 secs
2025-03-13 15:26:23,027 [INFO]: {
2025-03-13 15:26:23,027 [INFO]: 	index_key: HNSW15
2025-03-13 15:26:23,027 [INFO]: 	index_param: efSearch=211
2025-03-13 15:26:23,027 [INFO]: 	index_path: knn.index
2025-03-13 15:26:23,027 [INFO]: 	size in bytes: 577049590
2025-03-13 15:26:23,027 [INFO]: 	avg_search_speed_ms: 9.879576677517237
2025-03-13 15:26:23,027 [INFO]: 	99p_search_speed_ms: 14.20329585438594
2025-03-13 15:26:23,027 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:26:23,027 [INFO]: 	nb vectors: 2933
2025-03-13 15:26:23,027 [INFO]: 	vectors dimension: 49152
2025-03-13 15:26:23,027 [INFO]: 	compression ratio: 0.9993097196377871
2025-03-13 15:26:23,027 [INFO]: }
2025-03-13 15:26:23,027 [INFO]: 	>>> Finished "Creating the index" in 72.5561 secs
2025-03-13 15:26:23,027 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5825 secs
2025-03-13 15:26:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:26:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 79448 [episode count 19/20]
2025-03-13 15:26:24: [retrieval_preprocessing] finished for 2782099537_pour_cup_into_bowl [chosen_id count 1/196]
2025-03-13 15:26:25: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2782099537_put_cup_in_sink [chosen_id count 2/196]
2025-03-13 15:26:25: [retrieval_preprocessing] we have num_total=3189 embedding_dim=49152
[retrieval_preprocessing] for episode 1537 [episode count 0/20], we have num_retrieval=np.int64(3065) num_query=np.int64(124)
2025-03-13 15:26:26,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:26:26,804 [INFO]: Launching the whole pipeline 03/13/2025, 15:26:26
2025-03-13 15:26:26,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:26:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.03it/s]
2025-03-13 15:26:26,838 [INFO]: There are 3065 embeddings of dim 49152
2025-03-13 15:26:26,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 15:26:26,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:26:26
2025-03-13 15:26:26,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:26:26,839 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:26:26,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:26:26,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:26:26,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:26:26
2025-03-13 15:26:26,840 [INFO]: 632.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:26:26,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:26:26,840 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:26:26
2025-03-13 15:26:26,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:26:26,840 [INFO]: 	Creating the index 03/13/2025, 15:26:26
2025-03-13 15:26:26,840 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:26:26
2025-03-13 15:26:26,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 15:26:26,843 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:26:26
2025-03-13 15:26:26,843 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:26:26,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.34it/s] 38%|███▊      | 5/13 [00:00<00:00, 21.68it/s] 69%|██████▉   | 9/13 [00:00<00:00, 26.87it/s]100%|██████████| 13/13 [00:03<00:00,  2.77it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
2025-03-13 15:26:30,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:26:30
2025-03-13 15:27:09,085 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7552 secs
2025-03-13 15:27:09,085 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 15:27:09,085 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 15:27:38,481 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3955 secs
2025-03-13 15:27:38,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6397 secs
2025-03-13 15:27:38,483 [INFO]: {
2025-03-13 15:27:38,483 [INFO]: 	index_key: HNSW15
2025-03-13 15:27:38,483 [INFO]: 	index_param: efSearch=232
2025-03-13 15:27:38,483 [INFO]: 	index_path: knn.index
2025-03-13 15:27:38,483 [INFO]: 	size in bytes: 603019750
2025-03-13 15:27:38,483 [INFO]: 	avg_search_speed_ms: 10.445125237941385
2025-03-13 15:27:38,483 [INFO]: 	99p_search_speed_ms: 16.95028023794293
2025-03-13 15:27:38,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:27:38,483 [INFO]: 	nb vectors: 3065
2025-03-13 15:27:38,483 [INFO]: 	vectors dimension: 49152
2025-03-13 15:27:38,483 [INFO]: 	compression ratio: 0.9993097572674858
2025-03-13 15:27:38,483 [INFO]: }
2025-03-13 15:27:38,483 [INFO]: 	>>> Finished "Creating the index" in 71.6432 secs
2025-03-13 15:27:38,483 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6788 secs
2025-03-13 15:27:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:27:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 1537 [episode count 0/20]
[retrieval_preprocessing] for episode 24072 [episode count 1/20], we have num_retrieval=np.int64(3037) num_query=np.int64(152)
2025-03-13 15:27:40,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:27:41,537 [INFO]: Launching the whole pipeline 03/13/2025, 15:27:41
2025-03-13 15:27:41,537 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.25it/s]
2025-03-13 15:27:41,562 [INFO]: There are 3037 embeddings of dim 49152
2025-03-13 15:27:41,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:27:41,562 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:27:41
2025-03-13 15:27:41,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:27:41,562 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:27:41,562 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:27:41,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:27:41,562 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:27:41
2025-03-13 15:27:41,563 [INFO]: 626.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:27:41,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:27:41,563 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:27:41
2025-03-13 15:27:41,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:27:41,563 [INFO]: 	Creating the index 03/13/2025, 15:27:41
2025-03-13 15:27:41,563 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:27:41
2025-03-13 15:27:41,564 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:27:41,564 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:27:41
2025-03-13 15:27:41,564 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:27:41,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.93it/s] 50%|█████     | 6/12 [00:00<00:00, 28.70it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.45it/s]100%|██████████| 12/12 [00:02<00:00,  4.26it/s]
2025-03-13 15:27:44,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:27:44
2025-03-13 15:28:25,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1814 secs
2025-03-13 15:28:25,565 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 15:28:25,565 [INFO]: 	Compute fast metrics 03/13/2025, 15:28:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.04it/s]
2025-03-13 15:28:51,899 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3337 secs
2025-03-13 15:28:51,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3367 secs
2025-03-13 15:28:51,901 [INFO]: {
2025-03-13 15:28:51,901 [INFO]: 	index_key: HNSW15
2025-03-13 15:28:51,901 [INFO]: 	index_param: efSearch=148
2025-03-13 15:28:51,901 [INFO]: 	index_path: knn.index
2025-03-13 15:28:51,901 [INFO]: 	size in bytes: 597510850
2025-03-13 15:28:51,901 [INFO]: 	avg_search_speed_ms: 9.051556698135883
2025-03-13 15:28:51,901 [INFO]: 	99p_search_speed_ms: 16.689930367283527
2025-03-13 15:28:51,901 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:51,901 [INFO]: 	nb vectors: 3037
2025-03-13 15:28:51,901 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:51,901 [INFO]: 	compression ratio: 0.9993098803143072
2025-03-13 15:28:51,901 [INFO]: }
2025-03-13 15:28:51,901 [INFO]: 	>>> Finished "Creating the index" in 70.3386 secs
2025-03-13 15:28:51,901 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3647 secs
2025-03-13 15:28:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 24072 [episode count 1/20]
[retrieval_preprocessing] for episode 68617 [episode count 2/20], we have num_retrieval=np.int64(3063) num_query=np.int64(126)
2025-03-13 15:28:54,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:54,761 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:54
2025-03-13 15:28:54,762 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1931.08it/s]
2025-03-13 15:28:54,788 [INFO]: There are 3063 embeddings of dim 49152
2025-03-13 15:28:54,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:28:54,788 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:54
2025-03-13 15:28:54,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:54,788 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:28:54,788 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:54,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:54,788 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:54
2025-03-13 15:28:54,789 [INFO]: 632.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:54,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:28:54,789 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:54
2025-03-13 15:28:54,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:54,789 [INFO]: 	Creating the index 03/13/2025, 15:28:54
2025-03-13 15:28:54,789 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:54
2025-03-13 15:28:54,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:28:54,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:54
2025-03-13 15:28:54,790 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:28:54,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.96it/s] 38%|███▊      | 5/13 [00:00<00:00, 24.38it/s] 69%|██████▉   | 9/13 [00:00<00:00, 30.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.13it/s]100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
2025-03-13 15:28:57,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:57
2025-03-13 15:29:55,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.6605 secs
2025-03-13 15:29:55,538 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:29:55,538 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 15:30:12,154 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6155 secs
2025-03-13 15:30:12,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3660 secs
2025-03-13 15:30:12,156 [INFO]: {
2025-03-13 15:30:12,156 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:12,157 [INFO]: 	index_param: efSearch=151
2025-03-13 15:30:12,157 [INFO]: 	index_path: knn.index
2025-03-13 15:30:12,157 [INFO]: 	size in bytes: 602626270
2025-03-13 15:30:12,157 [INFO]: 	avg_search_speed_ms: 10.163878541670709
2025-03-13 15:30:12,157 [INFO]: 	99p_search_speed_ms: 16.859232191927727
2025-03-13 15:30:12,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:12,157 [INFO]: 	nb vectors: 3063
2025-03-13 15:30:12,157 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:12,157 [INFO]: 	compression ratio: 0.9993097446614798
2025-03-13 15:30:12,157 [INFO]: }
2025-03-13 15:30:12,157 [INFO]: 	>>> Finished "Creating the index" in 77.3678 secs
2025-03-13 15:30:12,157 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3952 secs
2025-03-13 15:30:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 68617 [episode count 2/20]
[retrieval_preprocessing] for episode 15927 [episode count 3/20], we have num_retrieval=np.int64(3056) num_query=np.int64(133)
2025-03-13 15:30:13,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:14,092 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:14
2025-03-13 15:30:14,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1215.39it/s]
2025-03-13 15:30:14,124 [INFO]: There are 3056 embeddings of dim 49152
2025-03-13 15:30:14,124 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 15:30:14,124 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:14
2025-03-13 15:30:14,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:14,125 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:30:14,125 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:14,125 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:30:14,125 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:14
2025-03-13 15:30:14,125 [INFO]: 630.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:14,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:30:14,126 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:14
2025-03-13 15:30:14,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:14,126 [INFO]: 	Creating the index 03/13/2025, 15:30:14
2025-03-13 15:30:14,126 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:14
2025-03-13 15:30:14,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:30:14,130 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:14
2025-03-13 15:30:14,130 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:30:14,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.71it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.56it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.18it/s]100%|██████████| 13/13 [00:02<00:00,  4.64it/s]
2025-03-13 15:30:16,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:16
2025-03-13 15:31:03,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5269 secs
2025-03-13 15:31:03,465 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 15:31:03,466 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.09it/s]
2025-03-13 15:31:23,461 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9952 secs
2025-03-13 15:31:23,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3328 secs
2025-03-13 15:31:23,463 [INFO]: {
2025-03-13 15:31:23,463 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:23,463 [INFO]: 	index_param: efSearch=174
2025-03-13 15:31:23,463 [INFO]: 	index_path: knn.index
2025-03-13 15:31:23,463 [INFO]: 	size in bytes: 601248970
2025-03-13 15:31:23,463 [INFO]: 	avg_search_speed_ms: 9.213544345592899
2025-03-13 15:31:23,464 [INFO]: 	99p_search_speed_ms: 15.359004924539482
2025-03-13 15:31:23,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:23,464 [INFO]: 	nb vectors: 3056
2025-03-13 15:31:23,464 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:23,464 [INFO]: 	compression ratio: 0.999309899857292
2025-03-13 15:31:23,464 [INFO]: }
2025-03-13 15:31:23,464 [INFO]: 	>>> Finished "Creating the index" in 69.3374 secs
2025-03-13 15:31:23,464 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3718 secs
2025-03-13 15:31:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 15927 [episode count 3/20]
[retrieval_preprocessing] for episode 81464 [episode count 4/20], we have num_retrieval=np.int64(3000) num_query=np.int64(189)
2025-03-13 15:31:24,886 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:25,350 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:25
2025-03-13 15:31:25,350 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.78it/s]
2025-03-13 15:31:25,379 [INFO]: There are 3000 embeddings of dim 49152
2025-03-13 15:31:25,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 15:31:25,379 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:25,380 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:31:25,380 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:25,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:31:25,380 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,380 [INFO]: 619.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:25,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:31:25,380 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:25
2025-03-13 15:31:25,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:25,380 [INFO]: 	Creating the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,380 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:25
2025-03-13 15:31:25,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:31:25,383 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:25
2025-03-13 15:31:25,383 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:31:25,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.23it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.84it/s]100%|██████████| 12/12 [00:02<00:00,  3.35it/s]100%|██████████| 12/12 [00:02<00:00,  4.10it/s]
2025-03-13 15:31:28,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:28
2025-03-13 15:32:11,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5548 secs
2025-03-13 15:32:11,868 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 15:32:11,868 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.36it/s]
2025-03-13 15:32:29,795 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9271 secs
2025-03-13 15:32:30,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8781 secs
2025-03-13 15:32:30,261 [INFO]: {
2025-03-13 15:32:30,262 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:30,262 [INFO]: 	index_param: efSearch=192
2025-03-13 15:32:30,262 [INFO]: 	index_path: knn.index
2025-03-13 15:32:30,262 [INFO]: 	size in bytes: 590231410
2025-03-13 15:32:30,262 [INFO]: 	avg_search_speed_ms: 10.606935878690743
2025-03-13 15:32:30,262 [INFO]: 	99p_search_speed_ms: 15.435213190503411
2025-03-13 15:32:30,262 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:30,262 [INFO]: 	nb vectors: 3000
2025-03-13 15:32:30,262 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:30,262 [INFO]: 	compression ratio: 0.9993097453082004
2025-03-13 15:32:30,262 [INFO]: }
2025-03-13 15:32:30,262 [INFO]: 	>>> Finished "Creating the index" in 64.8818 secs
2025-03-13 15:32:30,262 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9119 secs
2025-03-13 15:32:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 81464 [episode count 4/20]
[retrieval_preprocessing] for episode 27195 [episode count 5/20], we have num_retrieval=np.int64(3010) num_query=np.int64(179)
2025-03-13 15:32:33,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:33,599 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:33
2025-03-13 15:32:33,599 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.49it/s]
2025-03-13 15:32:33,625 [INFO]: There are 3010 embeddings of dim 49152
2025-03-13 15:32:33,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 15:32:33,626 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:33
2025-03-13 15:32:33,626 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:33,626 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:32:33,626 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:33,626 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:33,626 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:33
2025-03-13 15:32:33,626 [INFO]: 621.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:33,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:33,626 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:33
2025-03-13 15:32:33,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:33,626 [INFO]: 	Creating the index 03/13/2025, 15:32:33
2025-03-13 15:32:33,626 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:33
2025-03-13 15:32:33,627 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:32:33,627 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:33
2025-03-13 15:32:33,627 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:32:33,628 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.92it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.81it/s] 75%|███████▌  | 9/12 [00:00<00:00, 31.28it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]
2025-03-13 15:32:36,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:32:36
2025-03-13 15:33:20,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1361 secs
2025-03-13 15:33:20,638 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 15:33:20,638 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 15:33:52,787 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1488 secs
2025-03-13 15:33:52,789 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.1610 secs
2025-03-13 15:33:52,789 [INFO]: {
2025-03-13 15:33:52,789 [INFO]: 	index_key: HNSW15
2025-03-13 15:33:52,789 [INFO]: 	index_param: efSearch=185
2025-03-13 15:33:52,789 [INFO]: 	index_path: knn.index
2025-03-13 15:33:52,789 [INFO]: 	size in bytes: 592198810
2025-03-13 15:33:52,789 [INFO]: 	avg_search_speed_ms: 7.412556671206767
2025-03-13 15:33:52,789 [INFO]: 	99p_search_speed_ms: 11.442416310310364
2025-03-13 15:33:52,789 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:33:52,789 [INFO]: 	nb vectors: 3010
2025-03-13 15:33:52,789 [INFO]: 	vectors dimension: 49152
2025-03-13 15:33:52,789 [INFO]: 	compression ratio: 0.9993098094877968
2025-03-13 15:33:52,789 [INFO]: }
2025-03-13 15:33:52,789 [INFO]: 	>>> Finished "Creating the index" in 79.1627 secs
2025-03-13 15:33:52,789 [INFO]: >>> Finished "Launching the whole pipeline" in 79.1895 secs
2025-03-13 15:33:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:33:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 27195 [episode count 5/20]
[retrieval_preprocessing] for episode 59492 [episode count 6/20], we have num_retrieval=np.int64(2959) num_query=np.int64(230)
2025-03-13 15:33:54,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:33:54,778 [INFO]: Launching the whole pipeline 03/13/2025, 15:33:54
2025-03-13 15:33:54,779 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:33:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1050.68it/s]
2025-03-13 15:33:54,805 [INFO]: There are 2959 embeddings of dim 49152
2025-03-13 15:33:54,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:33:54,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:33:54,806 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:33:54,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:33:54,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:33:54,807 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,807 [INFO]: 610.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:33:54,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:33:54,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:33:54
2025-03-13 15:33:54,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:33:54,808 [INFO]: 	Creating the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,808 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:33:54
2025-03-13 15:33:54,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 15:33:54,812 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:33:54
2025-03-13 15:33:54,812 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:33:54,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.69it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.78it/s]100%|██████████| 12/12 [00:02<00:00,  3.69it/s]100%|██████████| 12/12 [00:02<00:00,  4.52it/s]
2025-03-13 15:33:57,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:57
2025-03-13 15:34:44,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6811 secs
2025-03-13 15:34:44,156 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 15:34:44,157 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.41it/s]
2025-03-13 15:35:02,319 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1625 secs
2025-03-13 15:35:02,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5093 secs
2025-03-13 15:35:02,321 [INFO]: {
2025-03-13 15:35:02,321 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:02,321 [INFO]: 	index_param: efSearch=151
2025-03-13 15:35:02,321 [INFO]: 	index_path: knn.index
2025-03-13 15:35:02,321 [INFO]: 	size in bytes: 582164950
2025-03-13 15:35:02,321 [INFO]: 	avg_search_speed_ms: 10.16435040444007
2025-03-13 15:35:02,321 [INFO]: 	99p_search_speed_ms: 17.69688972504809
2025-03-13 15:35:02,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:02,321 [INFO]: 	nb vectors: 2959
2025-03-13 15:35:02,321 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:02,321 [INFO]: 	compression ratio: 0.9993096836214547
2025-03-13 15:35:02,322 [INFO]: }
2025-03-13 15:35:02,322 [INFO]: 	>>> Finished "Creating the index" in 67.5133 secs
2025-03-13 15:35:02,322 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5430 secs
2025-03-13 15:35:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 59492 [episode count 6/20]
[retrieval_preprocessing] for episode 24203 [episode count 7/20], we have num_retrieval=np.int64(3024) num_query=np.int64(165)
2025-03-13 15:35:04,216 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:04,794 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:04
2025-03-13 15:35:04,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1251.66it/s]
2025-03-13 15:35:04,820 [INFO]: There are 3024 embeddings of dim 49152
2025-03-13 15:35:04,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 15:35:04,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:04
2025-03-13 15:35:04,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:04,821 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:35:04,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:04,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:35:04,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:04
2025-03-13 15:35:04,821 [INFO]: 624.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:04,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:35:04,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:04
2025-03-13 15:35:04,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:04,821 [INFO]: 	Creating the index 03/13/2025, 15:35:04
2025-03-13 15:35:04,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:04
2025-03-13 15:35:04,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:35:04,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:04
2025-03-13 15:35:04,823 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:35:04,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.74it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.33it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]100%|██████████| 12/12 [00:02<00:00,  5.20it/s]
2025-03-13 15:35:07,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:07
2025-03-13 15:35:48,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7531 secs
2025-03-13 15:35:48,887 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 15:35:48,887 [INFO]: 	Compute fast metrics 03/13/2025, 15:35:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.95it/s]
2025-03-13 15:36:16,180 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2926 secs
2025-03-13 15:36:16,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3591 secs
2025-03-13 15:36:16,182 [INFO]: {
2025-03-13 15:36:16,182 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:16,182 [INFO]: 	index_param: efSearch=173
2025-03-13 15:36:16,182 [INFO]: 	index_path: knn.index
2025-03-13 15:36:16,182 [INFO]: 	size in bytes: 594953170
2025-03-13 15:36:16,182 [INFO]: 	avg_search_speed_ms: 9.164295589334703
2025-03-13 15:36:16,182 [INFO]: 	99p_search_speed_ms: 15.43007238069549
2025-03-13 15:36:16,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:16,182 [INFO]: 	nb vectors: 3024
2025-03-13 15:36:16,182 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:16,182 [INFO]: 	compression ratio: 0.999309898626139
2025-03-13 15:36:16,182 [INFO]: }
2025-03-13 15:36:16,182 [INFO]: 	>>> Finished "Creating the index" in 71.3605 secs
2025-03-13 15:36:16,182 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3874 secs
2025-03-13 15:36:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 24203 [episode count 7/20]
[retrieval_preprocessing] for episode 88727 [episode count 8/20], we have num_retrieval=np.int64(3065) num_query=np.int64(124)
2025-03-13 15:36:17,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:18,492 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:18
2025-03-13 15:36:18,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.84it/s]
2025-03-13 15:36:18,709 [INFO]: There are 3065 embeddings of dim 49152
2025-03-13 15:36:18,709 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2164 secs
2025-03-13 15:36:18,709 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:18
2025-03-13 15:36:18,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:18,710 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:36:18,710 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:18,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:36:18,710 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:18
2025-03-13 15:36:18,710 [INFO]: 632.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:18,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:36:18,711 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:18
2025-03-13 15:36:18,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:18,711 [INFO]: 	Creating the index 03/13/2025, 15:36:18
2025-03-13 15:36:18,711 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:18
2025-03-13 15:36:18,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 15:36:18,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:18
2025-03-13 15:36:18,714 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:36:18,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.59it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.75it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.48it/s]100%|██████████| 13/13 [00:02<00:00,  5.31it/s]
2025-03-13 15:36:21,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:21
2025-03-13 15:37:03,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8530 secs
2025-03-13 15:37:03,021 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 15:37:03,021 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 15:37:26,844 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8227 secs
2025-03-13 15:37:26,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1332 secs
2025-03-13 15:37:26,847 [INFO]: {
2025-03-13 15:37:26,847 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:26,847 [INFO]: 	index_param: efSearch=178
2025-03-13 15:37:26,847 [INFO]: 	index_path: knn.index
2025-03-13 15:37:26,847 [INFO]: 	size in bytes: 603019750
2025-03-13 15:37:26,847 [INFO]: 	avg_search_speed_ms: 12.873573032144261
2025-03-13 15:37:26,847 [INFO]: 	99p_search_speed_ms: 20.962498197332025
2025-03-13 15:37:26,847 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:26,847 [INFO]: 	nb vectors: 3065
2025-03-13 15:37:26,847 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:26,847 [INFO]: 	compression ratio: 0.9993097572674858
2025-03-13 15:37:26,847 [INFO]: }
2025-03-13 15:37:26,847 [INFO]: 	>>> Finished "Creating the index" in 68.1364 secs
2025-03-13 15:37:26,847 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3548 secs
2025-03-13 15:37:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 88727 [episode count 8/20]
[retrieval_preprocessing] for episode 24220 [episode count 9/20], we have num_retrieval=np.int64(3040) num_query=np.int64(149)
2025-03-13 15:37:28,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:29,094 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:29
2025-03-13 15:37:29,094 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 932.90it/s]
2025-03-13 15:37:29,127 [INFO]: There are 3040 embeddings of dim 49152
2025-03-13 15:37:29,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 15:37:29,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:29
2025-03-13 15:37:29,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:29,128 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:37:29,128 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:29,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:37:29,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:29
2025-03-13 15:37:29,129 [INFO]: 627.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:29,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:37:29,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:29
2025-03-13 15:37:29,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:29,130 [INFO]: 	Creating the index 03/13/2025, 15:37:29
2025-03-13 15:37:29,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:29
2025-03-13 15:37:29,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:37:29,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:29
2025-03-13 15:37:29,134 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:37:29,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.29it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.27it/s] 75%|███████▌  | 9/12 [00:00<00:00, 27.15it/s]100%|██████████| 12/12 [00:05<00:00,  1.62it/s]100%|██████████| 12/12 [00:05<00:00,  2.32it/s]
2025-03-13 15:37:34,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:34
2025-03-13 15:38:20,140 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8253 secs
2025-03-13 15:38:20,141 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 15:38:20,141 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.61s/it] 75%|███████▌  | 3/4 [00:01<00:00,  1.72it/s]
2025-03-13 15:38:43,402 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2608 secs
2025-03-13 15:38:43,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2712 secs
2025-03-13 15:38:43,405 [INFO]: {
2025-03-13 15:38:43,405 [INFO]: 	index_key: HNSW15
2025-03-13 15:38:43,405 [INFO]: 	index_param: efSearch=186
2025-03-13 15:38:43,405 [INFO]: 	index_path: knn.index
2025-03-13 15:38:43,405 [INFO]: 	size in bytes: 598101070
2025-03-13 15:38:43,405 [INFO]: 	avg_search_speed_ms: 8.724650319943605
2025-03-13 15:38:43,405 [INFO]: 	99p_search_speed_ms: 14.49174726149067
2025-03-13 15:38:43,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:38:43,405 [INFO]: 	nb vectors: 3040
2025-03-13 15:38:43,405 [INFO]: 	vectors dimension: 49152
2025-03-13 15:38:43,405 [INFO]: 	compression ratio: 0.9993098992449554
2025-03-13 15:38:43,405 [INFO]: }
2025-03-13 15:38:43,405 [INFO]: 	>>> Finished "Creating the index" in 74.2754 secs
2025-03-13 15:38:43,405 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3109 secs
2025-03-13 15:38:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:38:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 24220 [episode count 9/20]
[retrieval_preprocessing] for episode 793 [episode count 10/20], we have num_retrieval=np.int64(3003) num_query=np.int64(186)
2025-03-13 15:38:46,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:38:47,390 [INFO]: Launching the whole pipeline 03/13/2025, 15:38:47
2025-03-13 15:38:47,390 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:38:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.38it/s]
2025-03-13 15:38:47,416 [INFO]: There are 3003 embeddings of dim 49152
2025-03-13 15:38:47,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 15:38:47,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:38:47
2025-03-13 15:38:47,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:38:47,416 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:38:47,416 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:38:47,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:38:47,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:38:47
2025-03-13 15:38:47,416 [INFO]: 619.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:38:47,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:38:47,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:38:47
2025-03-13 15:38:47,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:38:47,416 [INFO]: 	Creating the index 03/13/2025, 15:38:47
2025-03-13 15:38:47,416 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:38:47
2025-03-13 15:38:47,417 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:38:47,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:38:47
2025-03-13 15:38:47,418 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:38:47,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.30it/s] 50%|█████     | 6/12 [00:00<00:00, 32.24it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.71it/s]100%|██████████| 12/12 [00:02<00:00,  4.88it/s]
2025-03-13 15:38:49,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:38:49
2025-03-13 15:39:36,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8697 secs
2025-03-13 15:39:36,751 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 15:39:36,751 [INFO]: 	Compute fast metrics 03/13/2025, 15:39:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.51it/s]
2025-03-13 15:40:03,494 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7424 secs
2025-03-13 15:40:03,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0781 secs
2025-03-13 15:40:03,496 [INFO]: {
2025-03-13 15:40:03,496 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:03,496 [INFO]: 	index_param: efSearch=150
2025-03-13 15:40:03,496 [INFO]: 	index_path: knn.index
2025-03-13 15:40:03,496 [INFO]: 	size in bytes: 590821630
2025-03-13 15:40:03,496 [INFO]: 	avg_search_speed_ms: 10.07361862665907
2025-03-13 15:40:03,496 [INFO]: 	99p_search_speed_ms: 17.3025402892381
2025-03-13 15:40:03,496 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:03,496 [INFO]: 	nb vectors: 3003
2025-03-13 15:40:03,496 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:03,496 [INFO]: 	compression ratio: 0.9993097646069593
2025-03-13 15:40:03,496 [INFO]: }
2025-03-13 15:40:03,496 [INFO]: 	>>> Finished "Creating the index" in 76.0796 secs
2025-03-13 15:40:03,496 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1058 secs
2025-03-13 15:40:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 793 [episode count 10/20]
[retrieval_preprocessing] for episode 44316 [episode count 11/20], we have num_retrieval=np.int64(3004) num_query=np.int64(185)
2025-03-13 15:40:04,958 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:05,409 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:05
2025-03-13 15:40:05,409 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]
2025-03-13 15:40:05,438 [INFO]: There are 3004 embeddings of dim 49152
2025-03-13 15:40:05,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:40:05,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:05,438 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:40:05,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:05,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:40:05,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,438 [INFO]: 620.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:05,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:40:05,439 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:05
2025-03-13 15:40:05,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:05,439 [INFO]: 	Creating the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,439 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:05
2025-03-13 15:40:05,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:40:05,440 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:05
2025-03-13 15:40:05,440 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:40:05,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.38it/s] 50%|█████     | 6/12 [00:00<00:00, 30.38it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.00it/s]100%|██████████| 12/12 [00:02<00:00,  4.32it/s]
2025-03-13 15:40:08,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:08
2025-03-13 15:40:48,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4145 secs
2025-03-13 15:40:48,639 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 15:40:48,639 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.75it/s]
2025-03-13 15:41:10,495 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8557 secs
2025-03-13 15:41:10,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0580 secs
2025-03-13 15:41:10,498 [INFO]: {
2025-03-13 15:41:10,498 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:10,498 [INFO]: 	index_param: efSearch=202
2025-03-13 15:41:10,498 [INFO]: 	index_path: knn.index
2025-03-13 15:41:10,498 [INFO]: 	size in bytes: 591018370
2025-03-13 15:41:10,498 [INFO]: 	avg_search_speed_ms: 10.381512247514815
2025-03-13 15:41:10,498 [INFO]: 	99p_search_speed_ms: 19.970682226121426
2025-03-13 15:41:10,498 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:10,498 [INFO]: 	nb vectors: 3004
2025-03-13 15:41:10,498 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:10,498 [INFO]: 	compression ratio: 0.9993097710313132
2025-03-13 15:41:10,498 [INFO]: }
2025-03-13 15:41:10,499 [INFO]: 	>>> Finished "Creating the index" in 65.0598 secs
2025-03-13 15:41:10,499 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0897 secs
2025-03-13 15:41:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:41:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 44316 [episode count 11/20]
[retrieval_preprocessing] for episode 22815 [episode count 12/20], we have num_retrieval=np.int64(3076) num_query=np.int64(113)
2025-03-13 15:41:12,606 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:41:13,209 [INFO]: Launching the whole pipeline 03/13/2025, 15:41:13
2025-03-13 15:41:13,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.41it/s]
2025-03-13 15:41:13,236 [INFO]: There are 3076 embeddings of dim 49152
2025-03-13 15:41:13,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 15:41:13,236 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:41:13
2025-03-13 15:41:13,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:41:13,236 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:41:13,236 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:41:13,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:41:13,236 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:41:13
2025-03-13 15:41:13,236 [INFO]: 634.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:41:13,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:41:13,237 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:41:13
2025-03-13 15:41:13,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:41:13,237 [INFO]: 	Creating the index 03/13/2025, 15:41:13
2025-03-13 15:41:13,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:41:13
2025-03-13 15:41:13,238 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:41:13,238 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:41:13
2025-03-13 15:41:13,238 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:41:13,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.88it/s] 54%|█████▍    | 7/13 [00:00<00:00, 31.83it/s] 92%|█████████▏| 12/13 [00:00<00:00, 36.13it/s]100%|██████████| 13/13 [00:03<00:00,  4.24it/s]
2025-03-13 15:41:16,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:41:16
2025-03-13 15:42:05,976 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4804 secs
2025-03-13 15:42:05,976 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:42:05,976 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.91it/s]
2025-03-13 15:42:24,047 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0707 secs
2025-03-13 15:42:24,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8113 secs
2025-03-13 15:42:24,049 [INFO]: {
2025-03-13 15:42:24,049 [INFO]: 	index_key: HNSW15
2025-03-13 15:42:24,049 [INFO]: 	index_param: efSearch=162
2025-03-13 15:42:24,049 [INFO]: 	index_path: knn.index
2025-03-13 15:42:24,049 [INFO]: 	size in bytes: 605183890
2025-03-13 15:42:24,049 [INFO]: 	avg_search_speed_ms: 11.571942897043536
2025-03-13 15:42:24,049 [INFO]: 	99p_search_speed_ms: 19.687550850212574
2025-03-13 15:42:24,050 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:42:24,050 [INFO]: 	nb vectors: 3076
2025-03-13 15:42:24,050 [INFO]: 	vectors dimension: 49152
2025-03-13 15:42:24,050 [INFO]: 	compression ratio: 0.9993098263075046
2025-03-13 15:42:24,050 [INFO]: }
2025-03-13 15:42:24,050 [INFO]: 	>>> Finished "Creating the index" in 70.8129 secs
2025-03-13 15:42:24,050 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8405 secs
2025-03-13 15:42:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 22815 [episode count 12/20]
[retrieval_preprocessing] for episode 6952 [episode count 13/20], we have num_retrieval=np.int64(3060) num_query=np.int64(129)
2025-03-13 15:42:25,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:26,029 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:26
2025-03-13 15:42:26,029 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1465.52it/s]
2025-03-13 15:42:26,068 [INFO]: There are 3060 embeddings of dim 49152
2025-03-13 15:42:26,069 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-13 15:42:26,069 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:26
2025-03-13 15:42:26,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:26,069 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:42:26,069 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:26,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:42:26,070 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:26
2025-03-13 15:42:26,070 [INFO]: 631.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:26,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:42:26,071 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:26
2025-03-13 15:42:26,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:26,071 [INFO]: 	Creating the index 03/13/2025, 15:42:26
2025-03-13 15:42:26,071 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:26
2025-03-13 15:42:26,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 15:42:26,074 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:26
2025-03-13 15:42:26,074 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:42:26,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.19it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.22it/s] 77%|███████▋  | 10/13 [00:00<00:00, 32.26it/s]100%|██████████| 13/13 [00:03<00:00,  4.11it/s]
2025-03-13 15:42:29,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:29
2025-03-13 15:43:13,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6368 secs
2025-03-13 15:43:13,878 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:43:13,878 [INFO]: 	Compute fast metrics 03/13/2025, 15:43:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.40it/s]
2025-03-13 15:43:39,321 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4432 secs
2025-03-13 15:43:39,324 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.2495 secs
2025-03-13 15:43:39,324 [INFO]: {
2025-03-13 15:43:39,324 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:39,324 [INFO]: 	index_param: efSearch=170
2025-03-13 15:43:39,324 [INFO]: 	index_path: knn.index
2025-03-13 15:43:39,324 [INFO]: 	size in bytes: 602035990
2025-03-13 15:43:39,324 [INFO]: 	avg_search_speed_ms: 9.189561731866835
2025-03-13 15:43:39,324 [INFO]: 	99p_search_speed_ms: 12.940917771775267
2025-03-13 15:43:39,324 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:39,324 [INFO]: 	nb vectors: 3060
2025-03-13 15:43:39,324 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:39,324 [INFO]: 	compression ratio: 0.9993098253145962
2025-03-13 15:43:39,324 [INFO]: }
2025-03-13 15:43:39,324 [INFO]: 	>>> Finished "Creating the index" in 73.2527 secs
2025-03-13 15:43:39,324 [INFO]: >>> Finished "Launching the whole pipeline" in 73.2951 secs
2025-03-13 15:43:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 6952 [episode count 13/20]
[retrieval_preprocessing] for episode 29648 [episode count 14/20], we have num_retrieval=np.int64(3085) num_query=np.int64(104)
2025-03-13 15:43:40,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:41,628 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:41
2025-03-13 15:43:41,628 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.54it/s]
2025-03-13 15:43:41,653 [INFO]: There are 3085 embeddings of dim 49152
2025-03-13 15:43:41,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 15:43:41,654 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:41,654 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:43:41,654 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:41,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:43:41,654 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,654 [INFO]: 636.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:41,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:43:41,654 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:41
2025-03-13 15:43:41,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:41,654 [INFO]: 	Creating the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,654 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:41
2025-03-13 15:43:41,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:43:41,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:41
2025-03-13 15:43:41,655 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:43:41,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.21it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.54it/s] 85%|████████▍ | 11/13 [00:00<00:00, 35.36it/s]100%|██████████| 13/13 [00:03<00:00,  4.28it/s]
2025-03-13 15:43:44,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:44
2025-03-13 15:44:30,047 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3539 secs
2025-03-13 15:44:30,048 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 15:44:30,048 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-13 15:44:59,726 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6786 secs
2025-03-13 15:44:59,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0736 secs
2025-03-13 15:44:59,729 [INFO]: {
2025-03-13 15:44:59,729 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:59,729 [INFO]: 	index_param: efSearch=168
2025-03-13 15:44:59,729 [INFO]: 	index_path: knn.index
2025-03-13 15:44:59,729 [INFO]: 	size in bytes: 606954610
2025-03-13 15:44:59,729 [INFO]: 	avg_search_speed_ms: 7.524258373732671
2025-03-13 15:44:59,729 [INFO]: 	99p_search_speed_ms: 16.63558652624488
2025-03-13 15:44:59,729 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:59,729 [INFO]: 	nb vectors: 3085
2025-03-13 15:44:59,729 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:59,729 [INFO]: 	compression ratio: 0.9993097836426351
2025-03-13 15:44:59,729 [INFO]: }
2025-03-13 15:44:59,729 [INFO]: 	>>> Finished "Creating the index" in 78.0752 secs
2025-03-13 15:44:59,729 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1010 secs
2025-03-13 15:45:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 29648 [episode count 14/20]
[retrieval_preprocessing] for episode 53105 [episode count 15/20], we have num_retrieval=np.int64(3009) num_query=np.int64(180)
2025-03-13 15:45:01,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:01,562 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:01
2025-03-13 15:45:01,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1275.25it/s]
2025-03-13 15:45:01,590 [INFO]: There are 3009 embeddings of dim 49152
2025-03-13 15:45:01,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 15:45:01,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:01
2025-03-13 15:45:01,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:01,591 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:45:01,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:01,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:45:01,592 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:01
2025-03-13 15:45:01,592 [INFO]: 621.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:01,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:45:01,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:01
2025-03-13 15:45:01,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:01,593 [INFO]: 	Creating the index 03/13/2025, 15:45:01
2025-03-13 15:45:01,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:01
2025-03-13 15:45:01,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:45:01,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:01
2025-03-13 15:45:01,596 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:45:01,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.61it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.23it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]100%|██████████| 12/12 [00:02<00:00,  5.09it/s]
2025-03-13 15:45:03,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:03
2025-03-13 15:45:37,025 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0620 secs
2025-03-13 15:45:37,026 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:45:37,026 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.31it/s]
2025-03-13 15:45:58,189 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1629 secs
2025-03-13 15:45:58,191 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5948 secs
2025-03-13 15:45:58,191 [INFO]: {
2025-03-13 15:45:58,191 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:58,191 [INFO]: 	index_param: efSearch=193
2025-03-13 15:45:58,191 [INFO]: 	index_path: knn.index
2025-03-13 15:45:58,191 [INFO]: 	size in bytes: 592002070
2025-03-13 15:45:58,191 [INFO]: 	avg_search_speed_ms: 12.061073534377144
2025-03-13 15:45:58,191 [INFO]: 	99p_search_speed_ms: 29.470000462606578
2025-03-13 15:45:58,191 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:58,191 [INFO]: 	nb vectors: 3009
2025-03-13 15:45:58,191 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:58,191 [INFO]: 	compression ratio: 0.9993098030890332
2025-03-13 15:45:58,191 [INFO]: }
2025-03-13 15:45:58,191 [INFO]: 	>>> Finished "Creating the index" in 56.5987 secs
2025-03-13 15:45:58,192 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6298 secs
2025-03-13 15:45:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 53105 [episode count 15/20]
[retrieval_preprocessing] for episode 41214 [episode count 16/20], we have num_retrieval=np.int64(3003) num_query=np.int64(186)
2025-03-13 15:46:00,483 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:01,139 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:01
2025-03-13 15:46:01,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2079.48it/s]
2025-03-13 15:46:01,164 [INFO]: There are 3003 embeddings of dim 49152
2025-03-13 15:46:01,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 15:46:01,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:01
2025-03-13 15:46:01,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:01,165 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:46:01,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:01,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 15:46:01,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:01
2025-03-13 15:46:01,166 [INFO]: 619.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:01,166 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:46:01,166 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:01
2025-03-13 15:46:01,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:01,166 [INFO]: 	Creating the index 03/13/2025, 15:46:01
2025-03-13 15:46:01,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:01
2025-03-13 15:46:01,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:46:01,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:01
2025-03-13 15:46:01,170 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:46:01,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.30it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.74it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.43it/s]100%|██████████| 12/12 [00:03<00:00,  2.25it/s]100%|██████████| 12/12 [00:03<00:00,  3.18it/s]
2025-03-13 15:46:04,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:04
2025-03-13 15:46:43,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8762 secs
2025-03-13 15:46:43,823 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:46:43,824 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.98it/s]
2025-03-13 15:47:06,881 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0570 secs
2025-03-13 15:47:06,883 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7127 secs
2025-03-13 15:47:06,883 [INFO]: {
2025-03-13 15:47:06,883 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:06,883 [INFO]: 	index_param: efSearch=190
2025-03-13 15:47:06,883 [INFO]: 	index_path: knn.index
2025-03-13 15:47:06,883 [INFO]: 	size in bytes: 590821630
2025-03-13 15:47:06,883 [INFO]: 	avg_search_speed_ms: 9.30662067108896
2025-03-13 15:47:06,883 [INFO]: 	99p_search_speed_ms: 16.75442649051546
2025-03-13 15:47:06,883 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:06,883 [INFO]: 	nb vectors: 3003
2025-03-13 15:47:06,883 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:06,883 [INFO]: 	compression ratio: 0.9993097646069593
2025-03-13 15:47:06,883 [INFO]: }
2025-03-13 15:47:06,883 [INFO]: 	>>> Finished "Creating the index" in 65.7168 secs
2025-03-13 15:47:06,883 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7444 secs
2025-03-13 15:47:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:47:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 41214 [episode count 16/20]
[retrieval_preprocessing] for episode 22349 [episode count 17/20], we have num_retrieval=np.int64(3040) num_query=np.int64(149)
2025-03-13 15:47:08,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:47:08,967 [INFO]: Launching the whole pipeline 03/13/2025, 15:47:08
2025-03-13 15:47:08,967 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1006.79it/s]
2025-03-13 15:47:08,992 [INFO]: There are 3040 embeddings of dim 49152
2025-03-13 15:47:08,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 15:47:08,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:47:08
2025-03-13 15:47:08,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:47:08,993 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:47:08,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:47:08,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:47:08,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:47:08
2025-03-13 15:47:08,993 [INFO]: 627.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:47:08,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:47:08,993 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:47:08
2025-03-13 15:47:08,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:47:08,993 [INFO]: 	Creating the index 03/13/2025, 15:47:08
2025-03-13 15:47:08,993 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:47:08
2025-03-13 15:47:08,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:47:08,994 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:47:08
2025-03-13 15:47:08,994 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:47:08,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.92it/s] 50%|█████     | 6/12 [00:00<00:00, 28.87it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.65it/s]100%|██████████| 12/12 [00:02<00:00,  4.82it/s]
2025-03-13 15:47:11,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:47:11
2025-03-13 15:48:08,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.3814 secs
2025-03-13 15:48:08,872 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 15:48:08,872 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.35it/s]
2025-03-13 15:48:35,542 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6705 secs
2025-03-13 15:48:35,545 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.5508 secs
2025-03-13 15:48:35,545 [INFO]: {
2025-03-13 15:48:35,545 [INFO]: 	index_key: HNSW15
2025-03-13 15:48:35,545 [INFO]: 	index_param: efSearch=170
2025-03-13 15:48:35,545 [INFO]: 	index_path: knn.index
2025-03-13 15:48:35,545 [INFO]: 	size in bytes: 598101070
2025-03-13 15:48:35,545 [INFO]: 	avg_search_speed_ms: 8.222360845186477
2025-03-13 15:48:35,545 [INFO]: 	99p_search_speed_ms: 12.506704882252956
2025-03-13 15:48:35,545 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:48:35,545 [INFO]: 	nb vectors: 3040
2025-03-13 15:48:35,545 [INFO]: 	vectors dimension: 49152
2025-03-13 15:48:35,545 [INFO]: 	compression ratio: 0.9993098992449554
2025-03-13 15:48:35,545 [INFO]: }
2025-03-13 15:48:35,545 [INFO]: 	>>> Finished "Creating the index" in 86.5524 secs
2025-03-13 15:48:35,545 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5780 secs
2025-03-13 15:48:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 22349 [episode count 17/20]
[retrieval_preprocessing] for episode 75086 [episode count 18/20], we have num_retrieval=np.int64(3008) num_query=np.int64(181)
2025-03-13 15:48:37,075 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:37,547 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:37
2025-03-13 15:48:37,548 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.61it/s]
2025-03-13 15:48:37,571 [INFO]: There are 3008 embeddings of dim 49152
2025-03-13 15:48:37,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 15:48:37,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:37
2025-03-13 15:48:37,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:37,572 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:48:37,572 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:37,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:37,572 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:37
2025-03-13 15:48:37,572 [INFO]: 620.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:37,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:48:37,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:37
2025-03-13 15:48:37,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:37,572 [INFO]: 	Creating the index 03/13/2025, 15:48:37
2025-03-13 15:48:37,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:37
2025-03-13 15:48:37,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:48:37,573 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:37
2025-03-13 15:48:37,573 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:48:37,573 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.73it/s] 50%|█████     | 6/12 [00:00<00:00, 30.47it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.49it/s]100%|██████████| 12/12 [00:02<00:00,  4.59it/s]
2025-03-13 15:48:40,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:40
2025-03-13 15:49:19,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4663 secs
2025-03-13 15:49:19,660 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 15:49:19,660 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.01it/s]
2025-03-13 15:49:49,605 [INFO]: 	>>> Finished "Compute fast metrics" in 29.9448 secs
2025-03-13 15:49:49,607 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0336 secs
2025-03-13 15:49:49,607 [INFO]: {
2025-03-13 15:49:49,607 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:49,607 [INFO]: 	index_param: efSearch=175
2025-03-13 15:49:49,607 [INFO]: 	index_path: knn.index
2025-03-13 15:49:49,607 [INFO]: 	size in bytes: 591805330
2025-03-13 15:49:49,607 [INFO]: 	avg_search_speed_ms: 7.847420499276589
2025-03-13 15:49:49,607 [INFO]: 	99p_search_speed_ms: 11.212254725396633
2025-03-13 15:49:49,607 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:49,607 [INFO]: 	nb vectors: 3008
2025-03-13 15:49:49,607 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:49,607 [INFO]: 	compression ratio: 0.9993097966860149
2025-03-13 15:49:49,607 [INFO]: }
2025-03-13 15:49:49,607 [INFO]: 	>>> Finished "Creating the index" in 72.0350 secs
2025-03-13 15:49:49,607 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0595 secs
2025-03-13 15:49:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 75086 [episode count 18/20]
[retrieval_preprocessing] for episode 30590 [episode count 19/20], we have num_retrieval=np.int64(2984) num_query=np.int64(205)
2025-03-13 15:49:51,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:51,662 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:51
2025-03-13 15:49:51,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.49it/s]
2025-03-13 15:49:51,687 [INFO]: There are 2984 embeddings of dim 49152
2025-03-13 15:49:51,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 15:49:51,688 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:51
2025-03-13 15:49:51,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:51,688 [INFO]: 		-> Add: 1.6 seconds
2025-03-13 15:49:51,688 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:51,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:49:51,688 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:51
2025-03-13 15:49:51,688 [INFO]: 615.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:51,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:49:51,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:51
2025-03-13 15:49:51,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:51,688 [INFO]: 	Creating the index 03/13/2025, 15:49:51
2025-03-13 15:49:51,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:51
2025-03-13 15:49:51,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:49:51,689 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:51
2025-03-13 15:49:51,689 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:49:51,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.47it/s] 50%|█████     | 6/12 [00:00<00:00, 30.38it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.87it/s]100%|██████████| 12/12 [00:02<00:00,  5.00it/s]
2025-03-13 15:49:54,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:54
2025-03-13 15:50:26,736 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6415 secs
2025-03-13 15:50:26,736 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 15:50:26,736 [INFO]: 	Compute fast metrics 03/13/2025, 15:50:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-13 15:50:46,636 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8995 secs
2025-03-13 15:50:46,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9495 secs
2025-03-13 15:50:46,639 [INFO]: {
2025-03-13 15:50:46,639 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:46,639 [INFO]: 	index_param: efSearch=130
2025-03-13 15:50:46,639 [INFO]: 	index_path: knn.index
2025-03-13 15:50:46,639 [INFO]: 	size in bytes: 587083570
2025-03-13 15:50:46,639 [INFO]: 	avg_search_speed_ms: 7.9462276903071425
2025-03-13 15:50:46,639 [INFO]: 	99p_search_speed_ms: 13.624162604101002
2025-03-13 15:50:46,639 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:46,639 [INFO]: 	nb vectors: 2984
2025-03-13 15:50:46,639 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:46,639 [INFO]: 	compression ratio: 0.9993096417261345
2025-03-13 15:50:46,639 [INFO]: }
2025-03-13 15:50:46,639 [INFO]: 	>>> Finished "Creating the index" in 54.9512 secs
2025-03-13 15:50:46,639 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9776 secs
2025-03-13 15:50:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 30590 [episode count 19/20]
2025-03-13 15:50:48: [retrieval_preprocessing] finished for 2782099537_put_cup_in_sink [chosen_id count 2/196]
2025-03-13 15:50:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2782099537_put_marker_in_bowl [chosen_id count 3/196]
2025-03-13 15:50:49: [retrieval_preprocessing] we have num_total=2543 embedding_dim=49152
[retrieval_preprocessing] for episode 28713 [episode count 0/20], we have num_retrieval=np.int64(2434) num_query=np.int64(109)
2025-03-13 15:50:49,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:50,863 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:50
2025-03-13 15:50:50,863 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.30it/s]
2025-03-13 15:50:50,888 [INFO]: There are 2434 embeddings of dim 49152
2025-03-13 15:50:50,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 15:50:50,889 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:50
2025-03-13 15:50:50,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:50,889 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:50:50,889 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:50,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:50:50,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:50
2025-03-13 15:50:50,889 [INFO]: 502.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:50,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:50:50,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:50
2025-03-13 15:50:50,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:50,889 [INFO]: 	Creating the index 03/13/2025, 15:50:50
2025-03-13 15:50:50,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:50
2025-03-13 15:50:50,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:50:50,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:50
2025-03-13 15:50:50,890 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:50:50,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.92it/s] 60%|██████    | 6/10 [00:00<00:00, 31.67it/s]100%|██████████| 10/10 [00:02<00:00,  3.53it/s]100%|██████████| 10/10 [00:02<00:00,  4.25it/s]
2025-03-13 15:50:53,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:53
2025-03-13 15:51:27,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8261 secs
2025-03-13 15:51:27,073 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 15:51:27,073 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
2025-03-13 15:51:50,829 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7553 secs
2025-03-13 15:51:51,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4628 secs
2025-03-13 15:51:51,353 [INFO]: {
2025-03-13 15:51:51,354 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:51,354 [INFO]: 	index_param: efSearch=235
2025-03-13 15:51:51,354 [INFO]: 	index_path: knn.index
2025-03-13 15:51:51,354 [INFO]: 	size in bytes: 478874350
2025-03-13 15:51:51,354 [INFO]: 	avg_search_speed_ms: 12.33373075245929
2025-03-13 15:51:51,354 [INFO]: 	99p_search_speed_ms: 19.54195068683475
2025-03-13 15:51:51,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:51,354 [INFO]: 	nb vectors: 2434
2025-03-13 15:51:51,354 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:51,354 [INFO]: 	compression ratio: 0.9993098857769267
2025-03-13 15:51:51,354 [INFO]: }
2025-03-13 15:51:51,354 [INFO]: 	>>> Finished "Creating the index" in 60.4650 secs
2025-03-13 15:51:51,354 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4915 secs
2025-03-13 15:51:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 28713 [episode count 0/20]
[retrieval_preprocessing] for episode 15921 [episode count 1/20], we have num_retrieval=np.int64(2442) num_query=np.int64(101)
2025-03-13 15:51:53,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:53,396 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:53
2025-03-13 15:51:53,396 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.97it/s]
2025-03-13 15:51:53,425 [INFO]: There are 2442 embeddings of dim 49152
2025-03-13 15:51:53,425 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 15:51:53,425 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:53
2025-03-13 15:51:53,426 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:53,426 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:51:53,426 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:53,426 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:51:53,426 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:53
2025-03-13 15:51:53,426 [INFO]: 504.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:53,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:51:53,427 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:53
2025-03-13 15:51:53,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:53,427 [INFO]: 	Creating the index 03/13/2025, 15:51:53
2025-03-13 15:51:53,428 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:53
2025-03-13 15:51:53,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:51:53,431 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:53
2025-03-13 15:51:53,431 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:51:53,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.88it/s] 70%|███████   | 7/10 [00:00<00:00, 33.52it/s]100%|██████████| 10/10 [00:01<00:00,  5.17it/s]
2025-03-13 15:51:55,369 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:55
2025-03-13 15:52:36,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8932 secs
2025-03-13 15:52:36,263 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 15:52:36,263 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-13 15:52:57,734 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4708 secs
2025-03-13 15:52:57,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3053 secs
2025-03-13 15:52:57,736 [INFO]: {
2025-03-13 15:52:57,736 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:57,736 [INFO]: 	index_param: efSearch=208
2025-03-13 15:52:57,737 [INFO]: 	index_path: knn.index
2025-03-13 15:52:57,737 [INFO]: 	size in bytes: 480448270
2025-03-13 15:52:57,737 [INFO]: 	avg_search_speed_ms: 11.825223197944762
2025-03-13 15:52:57,737 [INFO]: 	99p_search_speed_ms: 19.617687514983015
2025-03-13 15:52:57,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:57,737 [INFO]: 	nb vectors: 2442
2025-03-13 15:52:57,737 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:57,737 [INFO]: 	compression ratio: 0.9993099486027913
2025-03-13 15:52:57,737 [INFO]: }
2025-03-13 15:52:57,737 [INFO]: 	>>> Finished "Creating the index" in 64.3091 secs
2025-03-13 15:52:57,737 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3409 secs
2025-03-13 15:52:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 15921 [episode count 1/20]
[retrieval_preprocessing] for episode 39511 [episode count 2/20], we have num_retrieval=np.int64(2451) num_query=np.int64(92)
2025-03-13 15:52:58,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:59,512 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:59
2025-03-13 15:52:59,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 842.40it/s]
2025-03-13 15:52:59,544 [INFO]: There are 2451 embeddings of dim 49152
2025-03-13 15:52:59,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 15:52:59,545 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:59,545 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:52:59,545 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:59,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:52:59,546 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,546 [INFO]: 505.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:59,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:52:59,547 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:59
2025-03-13 15:52:59,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:59,547 [INFO]: 	Creating the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,547 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:59
2025-03-13 15:52:59,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 15:52:59,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,550 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:52:59,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.74it/s] 30%|███       | 3/10 [00:00<00:00, 11.99it/s] 50%|█████     | 5/10 [00:00<00:00, 15.04it/s] 80%|████████  | 8/10 [00:00<00:00, 19.41it/s]100%|██████████| 10/10 [00:05<00:00,  1.98it/s]
2025-03-13 15:53:04,603 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:04
2025-03-13 15:53:51,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1134 secs
2025-03-13 15:53:51,717 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 15:53:51,717 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 15:54:17,983 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2659 secs
2025-03-13 15:54:17,986 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4356 secs
2025-03-13 15:54:17,986 [INFO]: {
2025-03-13 15:54:17,986 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:17,986 [INFO]: 	index_param: efSearch=217
2025-03-13 15:54:17,986 [INFO]: 	index_path: knn.index
2025-03-13 15:54:17,986 [INFO]: 	size in bytes: 482218930
2025-03-13 15:54:17,986 [INFO]: 	avg_search_speed_ms: 10.08117506975278
2025-03-13 15:54:17,986 [INFO]: 	99p_search_speed_ms: 15.66709067439662
2025-03-13 15:54:17,986 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:17,986 [INFO]: 	nb vectors: 2451
2025-03-13 15:54:17,986 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:17,986 [INFO]: 	compression ratio: 0.999310018791672
2025-03-13 15:54:17,986 [INFO]: }
2025-03-13 15:54:17,986 [INFO]: 	>>> Finished "Creating the index" in 78.4389 secs
2025-03-13 15:54:17,986 [INFO]: >>> Finished "Launching the whole pipeline" in 78.4742 secs
2025-03-13 15:54:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 39511 [episode count 2/20]
[retrieval_preprocessing] for episode 46690 [episode count 3/20], we have num_retrieval=np.int64(2392) num_query=np.int64(151)
2025-03-13 15:54:21,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:21,797 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:21
2025-03-13 15:54:21,798 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-13 15:54:21,824 [INFO]: There are 2392 embeddings of dim 49152
2025-03-13 15:54:21,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 15:54:21,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:21
2025-03-13 15:54:21,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:21,824 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:54:21,825 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:21,825 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:21,825 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:21
2025-03-13 15:54:21,825 [INFO]: 493.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:21,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:54:21,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:21
2025-03-13 15:54:21,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:21,825 [INFO]: 	Creating the index 03/13/2025, 15:54:21
2025-03-13 15:54:21,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:21
2025-03-13 15:54:21,826 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:54:21,826 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:21
2025-03-13 15:54:21,826 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:54:21,826 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.35it/s] 60%|██████    | 6/10 [00:00<00:00, 30.39it/s]100%|██████████| 10/10 [00:01<00:00,  4.42it/s]100%|██████████| 10/10 [00:01<00:00,  5.27it/s]
2025-03-13 15:54:23,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:23
2025-03-13 15:55:02,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3959 secs
2025-03-13 15:55:02,122 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 15:55:02,122 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.66it/s]
2025-03-13 15:55:28,814 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6914 secs
2025-03-13 15:55:28,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9895 secs
2025-03-13 15:55:28,816 [INFO]: {
2025-03-13 15:55:28,816 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:28,816 [INFO]: 	index_param: efSearch=169
2025-03-13 15:55:28,816 [INFO]: 	index_path: knn.index
2025-03-13 15:55:28,816 [INFO]: 	size in bytes: 470611150
2025-03-13 15:55:28,816 [INFO]: 	avg_search_speed_ms: 9.820972937973462
2025-03-13 15:55:28,816 [INFO]: 	99p_search_speed_ms: 14.924270049668857
2025-03-13 15:55:28,816 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:28,816 [INFO]: 	nb vectors: 2392
2025-03-13 15:55:28,816 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:28,816 [INFO]: 	compression ratio: 0.9993098038582384
2025-03-13 15:55:28,816 [INFO]: }
2025-03-13 15:55:28,816 [INFO]: 	>>> Finished "Creating the index" in 66.9913 secs
2025-03-13 15:55:28,816 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0186 secs
2025-03-13 15:55:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 46690 [episode count 3/20]
[retrieval_preprocessing] for episode 33892 [episode count 4/20], we have num_retrieval=np.int64(2444) num_query=np.int64(99)
2025-03-13 15:55:30,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:30,569 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:30
2025-03-13 15:55:30,569 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.07it/s]
2025-03-13 15:55:30,601 [INFO]: There are 2444 embeddings of dim 49152
2025-03-13 15:55:30,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 15:55:30,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:30,602 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:55:30,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:30,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:30,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,602 [INFO]: 504.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:30,602 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:55:30,602 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:30
2025-03-13 15:55:30,602 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:30,602 [INFO]: 	Creating the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,602 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:30
2025-03-13 15:55:30,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:55:30,603 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,603 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:55:30,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.16it/s] 60%|██████    | 6/10 [00:00<00:00, 30.04it/s]100%|██████████| 10/10 [00:02<00:00,  3.30it/s]100%|██████████| 10/10 [00:02<00:00,  3.98it/s]
2025-03-13 15:55:33,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:33
2025-03-13 15:56:16,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1347 secs
2025-03-13 15:56:16,255 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:56:16,255 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.79it/s]
2025-03-13 15:56:35,281 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0258 secs
2025-03-13 15:56:35,283 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6797 secs
2025-03-13 15:56:35,284 [INFO]: {
2025-03-13 15:56:35,284 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:35,284 [INFO]: 	index_param: efSearch=200
2025-03-13 15:56:35,284 [INFO]: 	index_path: knn.index
2025-03-13 15:56:35,284 [INFO]: 	size in bytes: 480841750
2025-03-13 15:56:35,284 [INFO]: 	avg_search_speed_ms: 14.163641119573699
2025-03-13 15:56:35,284 [INFO]: 	99p_search_speed_ms: 19.70419358694926
2025-03-13 15:56:35,284 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:35,284 [INFO]: 	nb vectors: 2444
2025-03-13 15:56:35,284 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:35,284 [INFO]: 	compression ratio: 0.9993099642449933
2025-03-13 15:56:35,284 [INFO]: }
2025-03-13 15:56:35,284 [INFO]: 	>>> Finished "Creating the index" in 64.6820 secs
2025-03-13 15:56:35,284 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7148 secs
2025-03-13 15:56:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 33892 [episode count 4/20]
[retrieval_preprocessing] for episode 24688 [episode count 5/20], we have num_retrieval=np.int64(2431) num_query=np.int64(112)
2025-03-13 15:56:36,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:37,190 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:37
2025-03-13 15:56:37,190 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]
2025-03-13 15:56:37,220 [INFO]: There are 2431 embeddings of dim 49152
2025-03-13 15:56:37,220 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:56:37,220 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:37,221 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:56:37,221 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:37,221 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:56:37,221 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,221 [INFO]: 501.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:37,222 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:56:37,222 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:37
2025-03-13 15:56:37,222 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:37,222 [INFO]: 	Creating the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,222 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:37
2025-03-13 15:56:37,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 15:56:37,225 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,226 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:56:37,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.52it/s] 70%|███████   | 7/10 [00:00<00:00, 33.32it/s]100%|██████████| 10/10 [00:02<00:00,  3.87it/s]
2025-03-13 15:56:39,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:39
2025-03-13 15:57:22,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2896 secs
2025-03-13 15:57:22,107 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 15:57:22,107 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 15:57:38,823 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7156 secs
2025-03-13 15:57:38,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6000 secs
2025-03-13 15:57:38,826 [INFO]: {
2025-03-13 15:57:38,826 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:38,826 [INFO]: 	index_param: efSearch=177
2025-03-13 15:57:38,826 [INFO]: 	index_path: knn.index
2025-03-13 15:57:38,826 [INFO]: 	size in bytes: 478284130
2025-03-13 15:57:38,826 [INFO]: 	avg_search_speed_ms: 11.739602872113666
2025-03-13 15:57:38,826 [INFO]: 	99p_search_speed_ms: 18.28900338616222
2025-03-13 15:57:38,826 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:38,826 [INFO]: 	nb vectors: 2431
2025-03-13 15:57:38,826 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:38,826 [INFO]: 	compression ratio: 0.9993098621106244
2025-03-13 15:57:38,826 [INFO]: }
2025-03-13 15:57:38,826 [INFO]: 	>>> Finished "Creating the index" in 61.6038 secs
2025-03-13 15:57:38,826 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6362 secs
2025-03-13 15:57:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 24688 [episode count 5/20]
[retrieval_preprocessing] for episode 5234 [episode count 6/20], we have num_retrieval=np.int64(2381) num_query=np.int64(162)
2025-03-13 15:57:40,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:41,253 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:41
2025-03-13 15:57:41,254 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.71it/s]
2025-03-13 15:57:41,286 [INFO]: There are 2381 embeddings of dim 49152
2025-03-13 15:57:41,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 15:57:41,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:41
2025-03-13 15:57:41,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:41,287 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:57:41,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:41,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:57:41,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:41
2025-03-13 15:57:41,288 [INFO]: 491.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:41,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:57:41,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:41
2025-03-13 15:57:41,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:41,288 [INFO]: 	Creating the index 03/13/2025, 15:57:41
2025-03-13 15:57:41,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:41
2025-03-13 15:57:41,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 15:57:41,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:41
2025-03-13 15:57:41,292 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:57:41,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.43it/s] 70%|███████   | 7/10 [00:00<00:00, 35.88it/s]100%|██████████| 10/10 [00:02<00:00,  4.66it/s]
2025-03-13 15:57:43,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:43
2025-03-13 15:58:20,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6848 secs
2025-03-13 15:58:20,130 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 15:58:20,131 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.42it/s]
2025-03-13 15:58:47,704 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5731 secs
2025-03-13 15:58:47,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4143 secs
2025-03-13 15:58:47,706 [INFO]: {
2025-03-13 15:58:47,706 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:47,706 [INFO]: 	index_param: efSearch=229
2025-03-13 15:58:47,706 [INFO]: 	index_path: knn.index
2025-03-13 15:58:47,706 [INFO]: 	size in bytes: 468447010
2025-03-13 15:58:47,706 [INFO]: 	avg_search_speed_ms: 9.98120364419811
2025-03-13 15:58:47,706 [INFO]: 	99p_search_speed_ms: 13.842190394643694
2025-03-13 15:58:47,706 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:47,706 [INFO]: 	nb vectors: 2381
2025-03-13 15:58:47,706 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:47,706 [INFO]: 	compression ratio: 0.9993097148810919
2025-03-13 15:58:47,706 [INFO]: }
2025-03-13 15:58:47,706 [INFO]: 	>>> Finished "Creating the index" in 66.4181 secs
2025-03-13 15:58:47,706 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4529 secs
2025-03-13 15:58:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 5234 [episode count 6/20]
[retrieval_preprocessing] for episode 89209 [episode count 7/20], we have num_retrieval=np.int64(2438) num_query=np.int64(105)
2025-03-13 15:58:49,425 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:49,830 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:49
2025-03-13 15:58:49,830 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 15:58:49,856 [INFO]: There are 2438 embeddings of dim 49152
2025-03-13 15:58:49,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 15:58:49,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:49
2025-03-13 15:58:49,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:49,856 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:58:49,856 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:49,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:49,856 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:49
2025-03-13 15:58:49,856 [INFO]: 503.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:49,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:58:49,856 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:49
2025-03-13 15:58:49,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:49,857 [INFO]: 	Creating the index 03/13/2025, 15:58:49
2025-03-13 15:58:49,857 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:49
2025-03-13 15:58:49,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:58:49,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:49
2025-03-13 15:58:49,858 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:58:49,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.23it/s] 60%|██████    | 6/10 [00:00<00:00, 30.80it/s]100%|██████████| 10/10 [00:02<00:00,  3.66it/s]100%|██████████| 10/10 [00:02<00:00,  4.40it/s]
2025-03-13 15:58:52,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:52
2025-03-13 15:59:24,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7326 secs
2025-03-13 15:59:24,864 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:59:24,864 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.03it/s]
2025-03-13 15:59:46,470 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6056 secs
2025-03-13 15:59:46,473 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6148 secs
2025-03-13 15:59:46,473 [INFO]: {
2025-03-13 15:59:46,473 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:46,473 [INFO]: 	index_param: efSearch=162
2025-03-13 15:59:46,473 [INFO]: 	index_path: knn.index
2025-03-13 15:59:46,473 [INFO]: 	size in bytes: 479661310
2025-03-13 15:59:46,473 [INFO]: 	avg_search_speed_ms: 10.321949410874115
2025-03-13 15:59:46,473 [INFO]: 	99p_search_speed_ms: 18.527376623824217
2025-03-13 15:59:46,473 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:46,473 [INFO]: 	nb vectors: 2438
2025-03-13 15:59:46,473 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:46,473 [INFO]: 	compression ratio: 0.9993099172413968
2025-03-13 15:59:46,473 [INFO]: }
2025-03-13 15:59:46,473 [INFO]: 	>>> Finished "Creating the index" in 56.6165 secs
2025-03-13 15:59:46,473 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6434 secs
2025-03-13 15:59:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 89209 [episode count 7/20]
[retrieval_preprocessing] for episode 75388 [episode count 8/20], we have num_retrieval=np.int64(2397) num_query=np.int64(146)
2025-03-13 15:59:47,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:48,545 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:48
2025-03-13 15:59:48,546 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 656.80it/s]
2025-03-13 15:59:48,585 [INFO]: There are 2397 embeddings of dim 49152
2025-03-13 15:59:48,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 15:59:48,585 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:48
2025-03-13 15:59:48,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:48,586 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 15:59:48,586 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:48,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:59:48,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:48
2025-03-13 15:59:48,587 [INFO]: 494.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:48,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:59:48,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:48
2025-03-13 15:59:48,588 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:48,588 [INFO]: 	Creating the index 03/13/2025, 15:59:48
2025-03-13 15:59:48,588 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:48
2025-03-13 15:59:48,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 15:59:48,591 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:48
2025-03-13 15:59:48,592 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 15:59:48,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.18it/s] 20%|██        | 2/10 [00:00<00:01,  6.12it/s] 30%|███       | 3/10 [00:00<00:00,  7.11it/s] 40%|████      | 4/10 [00:00<00:00,  7.73it/s] 60%|██████    | 6/10 [00:00<00:00, 10.14it/s] 80%|████████  | 8/10 [00:00<00:00,  9.95it/s]100%|██████████| 10/10 [00:03<00:00,  1.98it/s]100%|██████████| 10/10 [00:03<00:00,  3.07it/s]
2025-03-13 15:59:51,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:51
2025-03-13 16:00:29,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5771 secs
2025-03-13 16:00:29,433 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 16:00:29,433 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-13 16:00:58,558 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1246 secs
2025-03-13 16:00:58,826 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2346 secs
2025-03-13 16:00:58,826 [INFO]: {
2025-03-13 16:00:58,827 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:58,827 [INFO]: 	index_param: efSearch=260
2025-03-13 16:00:58,827 [INFO]: 	index_path: knn.index
2025-03-13 16:00:58,827 [INFO]: 	size in bytes: 471594910
2025-03-13 16:00:58,827 [INFO]: 	avg_search_speed_ms: 10.354268655767106
2025-03-13 16:00:58,827 [INFO]: 	99p_search_speed_ms: 14.054442592896523
2025-03-13 16:00:58,827 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:58,827 [INFO]: 	nb vectors: 2397
2025-03-13 16:00:58,827 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:58,827 [INFO]: 	compression ratio: 0.9993097168924067
2025-03-13 16:00:58,827 [INFO]: }
2025-03-13 16:00:58,827 [INFO]: 	>>> Finished "Creating the index" in 70.2395 secs
2025-03-13 16:00:58,827 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2817 secs
2025-03-13 16:01:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 75388 [episode count 8/20]
[retrieval_preprocessing] for episode 25735 [episode count 9/20], we have num_retrieval=np.int64(2435) num_query=np.int64(108)
2025-03-13 16:01:01,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:02,083 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:02
2025-03-13 16:01:02,083 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.01it/s]
2025-03-13 16:01:02,109 [INFO]: There are 2435 embeddings of dim 49152
2025-03-13 16:01:02,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:01:02,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:02
2025-03-13 16:01:02,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:02,110 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:01:02,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:02,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:01:02,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:02
2025-03-13 16:01:02,110 [INFO]: 502.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:02,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:01:02,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:02
2025-03-13 16:01:02,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:02,111 [INFO]: 	Creating the index 03/13/2025, 16:01:02
2025-03-13 16:01:02,111 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:02
2025-03-13 16:01:02,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:01:02,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:02
2025-03-13 16:01:02,112 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:01:02,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.06it/s] 30%|███       | 3/10 [00:00<00:00,  8.30it/s] 50%|█████     | 5/10 [00:00<00:00,  9.72it/s] 70%|███████   | 7/10 [00:00<00:00, 10.26it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.73it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]
2025-03-13 16:01:04,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:04
2025-03-13 16:01:37,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9169 secs
2025-03-13 16:01:37,834 [INFO]: The best hyperparameters are: efSearch=300
2025-03-13 16:01:37,834 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.97it/s] 50%|█████     | 2/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 16:01:58,603 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7689 secs
2025-03-13 16:01:58,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4925 secs
2025-03-13 16:01:58,605 [INFO]: {
2025-03-13 16:01:58,605 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:58,605 [INFO]: 	index_param: efSearch=300
2025-03-13 16:01:58,605 [INFO]: 	index_path: knn.index
2025-03-13 16:01:58,605 [INFO]: 	size in bytes: 479071090
2025-03-13 16:01:58,605 [INFO]: 	avg_search_speed_ms: 12.226194537513432
2025-03-13 16:01:58,605 [INFO]: 	99p_search_speed_ms: 16.690916311927147
2025-03-13 16:01:58,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:58,605 [INFO]: 	nb vectors: 2435
2025-03-13 16:01:58,605 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:58,605 [INFO]: 	compression ratio: 0.9993098936527354
2025-03-13 16:01:58,605 [INFO]: }
2025-03-13 16:01:58,605 [INFO]: 	>>> Finished "Creating the index" in 56.4943 secs
2025-03-13 16:01:58,605 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5223 secs
2025-03-13 16:01:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 25735 [episode count 9/20]
[retrieval_preprocessing] for episode 3720 [episode count 10/20], we have num_retrieval=np.int64(2421) num_query=np.int64(122)
2025-03-13 16:02:01,016 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:01,553 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:01
2025-03-13 16:02:01,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1935.53it/s]
2025-03-13 16:02:01,579 [INFO]: There are 2421 embeddings of dim 49152
2025-03-13 16:02:01,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 16:02:01,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:01
2025-03-13 16:02:01,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:01,580 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:02:01,580 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:01,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:02:01,580 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:01
2025-03-13 16:02:01,580 [INFO]: 499.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:01,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:02:01,580 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:01
2025-03-13 16:02:01,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:01,580 [INFO]: 	Creating the index 03/13/2025, 16:02:01
2025-03-13 16:02:01,580 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:01
2025-03-13 16:02:01,582 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:02:01,582 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:01
2025-03-13 16:02:01,582 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:02:01,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.26it/s] 20%|██        | 2/10 [00:00<00:01,  6.74it/s] 30%|███       | 3/10 [00:00<00:00,  7.24it/s] 40%|████      | 4/10 [00:00<00:00,  7.47it/s] 50%|█████     | 5/10 [00:00<00:00,  7.70it/s] 60%|██████    | 6/10 [00:00<00:00,  7.55it/s] 70%|███████   | 7/10 [00:00<00:00,  7.35it/s] 80%|████████  | 8/10 [00:01<00:00,  7.15it/s] 90%|█████████ | 9/10 [00:01<00:00,  6.92it/s]100%|██████████| 10/10 [00:04<00:00,  1.17s/it]100%|██████████| 10/10 [00:04<00:00,  2.11it/s]
2025-03-13 16:02:06,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:06
2025-03-13 16:02:44,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3409 secs
2025-03-13 16:02:44,664 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 16:02:44,664 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.44it/s] 50%|█████     | 2/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.96it/s]
2025-03-13 16:03:07,277 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6131 secs
2025-03-13 16:03:07,420 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8386 secs
2025-03-13 16:03:07,421 [INFO]: {
2025-03-13 16:03:07,421 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:07,421 [INFO]: 	index_param: efSearch=247
2025-03-13 16:03:07,421 [INFO]: 	index_path: knn.index
2025-03-13 16:03:07,421 [INFO]: 	size in bytes: 476316730
2025-03-13 16:03:07,421 [INFO]: 	avg_search_speed_ms: 10.635374658592442
2025-03-13 16:03:07,421 [INFO]: 	99p_search_speed_ms: 19.276955265086148
2025-03-13 16:03:07,421 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:07,421 [INFO]: 	nb vectors: 2421
2025-03-13 16:03:07,421 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:07,421 [INFO]: 	compression ratio: 0.999309782799357
2025-03-13 16:03:07,421 [INFO]: }
2025-03-13 16:03:07,421 [INFO]: 	>>> Finished "Creating the index" in 65.8411 secs
2025-03-13 16:03:07,422 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8680 secs
2025-03-13 16:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 3720 [episode count 10/20]
[retrieval_preprocessing] for episode 66740 [episode count 11/20], we have num_retrieval=np.int64(2341) num_query=np.int64(202)
2025-03-13 16:03:09,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:10,140 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:10
2025-03-13 16:03:10,140 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1436.90it/s]
2025-03-13 16:03:10,165 [INFO]: There are 2341 embeddings of dim 49152
2025-03-13 16:03:10,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 16:03:10,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:10
2025-03-13 16:03:10,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:10,165 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:03:10,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:10,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:10,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:10
2025-03-13 16:03:10,166 [INFO]: 483.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:10,166 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:03:10,166 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:10
2025-03-13 16:03:10,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:10,166 [INFO]: 	Creating the index 03/13/2025, 16:03:10
2025-03-13 16:03:10,166 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:10
2025-03-13 16:03:10,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:03:10,167 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:10
2025-03-13 16:03:10,167 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:03:10,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.29it/s] 30%|███       | 3/10 [00:00<00:00,  8.03it/s] 40%|████      | 4/10 [00:00<00:00,  7.38it/s] 50%|█████     | 5/10 [00:00<00:00,  7.55it/s] 60%|██████    | 6/10 [00:00<00:00,  7.97it/s] 70%|███████   | 7/10 [00:00<00:00,  8.31it/s] 80%|████████  | 8/10 [00:00<00:00,  8.50it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.69it/s]100%|██████████| 10/10 [00:02<00:00,  1.63it/s]100%|██████████| 10/10 [00:02<00:00,  3.49it/s]
2025-03-13 16:03:13,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:13
2025-03-13 16:03:42,869 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8363 secs
2025-03-13 16:03:42,869 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 16:03:42,869 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-13 16:04:18,218 [INFO]: 	>>> Finished "Compute fast metrics" in 35.3494 secs
2025-03-13 16:04:18,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.0540 secs
2025-03-13 16:04:18,221 [INFO]: {
2025-03-13 16:04:18,221 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:18,221 [INFO]: 	index_param: efSearch=262
2025-03-13 16:04:18,221 [INFO]: 	index_path: knn.index
2025-03-13 16:04:18,221 [INFO]: 	size in bytes: 460577350
2025-03-13 16:04:18,221 [INFO]: 	avg_search_speed_ms: 11.357630674106732
2025-03-13 16:04:18,221 [INFO]: 	99p_search_speed_ms: 20.170525973662738
2025-03-13 16:04:18,221 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:18,221 [INFO]: 	nb vectors: 2341
2025-03-13 16:04:18,221 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:18,221 [INFO]: 	compression ratio: 0.9993095144604918
2025-03-13 16:04:18,221 [INFO]: }
2025-03-13 16:04:18,221 [INFO]: 	>>> Finished "Creating the index" in 68.0557 secs
2025-03-13 16:04:18,221 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0818 secs
2025-03-13 16:04:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 66740 [episode count 11/20]
[retrieval_preprocessing] for episode 68793 [episode count 12/20], we have num_retrieval=np.int64(2421) num_query=np.int64(122)
2025-03-13 16:04:21,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:22,533 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:22
2025-03-13 16:04:22,533 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.61it/s]
2025-03-13 16:04:22,563 [INFO]: There are 2421 embeddings of dim 49152
2025-03-13 16:04:22,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 16:04:22,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:22,564 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:04:22,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:22,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:04:22,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,565 [INFO]: 499.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:22,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:04:22,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:22
2025-03-13 16:04:22,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:22,566 [INFO]: 	Creating the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:22
2025-03-13 16:04:22,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:04:22,569 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:22
2025-03-13 16:04:22,569 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:04:22,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.21it/s] 20%|██        | 2/10 [00:00<00:01,  6.29it/s] 30%|███       | 3/10 [00:00<00:01,  6.94it/s] 40%|████      | 4/10 [00:00<00:00,  7.24it/s] 50%|█████     | 5/10 [00:00<00:00,  7.34it/s] 60%|██████    | 6/10 [00:00<00:00,  7.69it/s] 70%|███████   | 7/10 [00:00<00:00,  7.91it/s] 80%|████████  | 8/10 [00:01<00:00,  7.91it/s] 90%|█████████ | 9/10 [00:01<00:00,  7.86it/s]100%|██████████| 10/10 [00:03<00:00,  1.30it/s]100%|██████████| 10/10 [00:03<00:00,  2.93it/s]
2025-03-13 16:04:25,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:25
2025-03-13 16:05:06,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0962 secs
2025-03-13 16:05:06,081 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 16:05:06,081 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.63it/s]
2025-03-13 16:05:24,830 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7492 secs
2025-03-13 16:05:24,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2633 secs
2025-03-13 16:05:24,833 [INFO]: {
2025-03-13 16:05:24,833 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:24,833 [INFO]: 	index_param: efSearch=248
2025-03-13 16:05:24,833 [INFO]: 	index_path: knn.index
2025-03-13 16:05:24,833 [INFO]: 	size in bytes: 476316730
2025-03-13 16:05:24,833 [INFO]: 	avg_search_speed_ms: 11.480368785271432
2025-03-13 16:05:24,833 [INFO]: 	99p_search_speed_ms: 16.29265586379915
2025-03-13 16:05:24,833 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:24,833 [INFO]: 	nb vectors: 2421
2025-03-13 16:05:24,833 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:24,833 [INFO]: 	compression ratio: 0.999309782799357
2025-03-13 16:05:24,833 [INFO]: }
2025-03-13 16:05:24,833 [INFO]: 	>>> Finished "Creating the index" in 62.2668 secs
2025-03-13 16:05:24,833 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3000 secs
2025-03-13 16:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 68793 [episode count 12/20]
[retrieval_preprocessing] for episode 37975 [episode count 13/20], we have num_retrieval=np.int64(2456) num_query=np.int64(87)
2025-03-13 16:05:27,030 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:27,813 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:27
2025-03-13 16:05:27,814 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.77it/s]
2025-03-13 16:05:27,838 [INFO]: There are 2456 embeddings of dim 49152
2025-03-13 16:05:27,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:05:27,839 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:27
2025-03-13 16:05:27,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:27,839 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:05:27,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:27,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:05:27,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:27
2025-03-13 16:05:27,839 [INFO]: 506.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:27,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:05:27,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:27
2025-03-13 16:05:27,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:27,839 [INFO]: 	Creating the index 03/13/2025, 16:05:27
2025-03-13 16:05:27,839 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:27
2025-03-13 16:05:27,840 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:05:27,840 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:27
2025-03-13 16:05:27,840 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:05:27,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.48it/s] 20%|██        | 2/10 [00:00<00:01,  6.88it/s] 30%|███       | 3/10 [00:00<00:00,  7.91it/s] 40%|████      | 4/10 [00:00<00:00,  8.55it/s] 50%|█████     | 5/10 [00:00<00:00,  8.81it/s] 60%|██████    | 6/10 [00:00<00:00,  9.03it/s] 80%|████████  | 8/10 [00:00<00:00,  9.61it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.69it/s]100%|██████████| 10/10 [00:02<00:00,  1.69it/s]100%|██████████| 10/10 [00:02<00:00,  3.42it/s]
2025-03-13 16:05:30,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:30
2025-03-13 16:06:03,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0170 secs
2025-03-13 16:06:03,783 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:06:03,783 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.63it/s] 50%|█████     | 2/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 16:06:26,766 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9824 secs
2025-03-13 16:06:26,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9275 secs
2025-03-13 16:06:26,768 [INFO]: {
2025-03-13 16:06:26,768 [INFO]: 	index_key: HNSW15
2025-03-13 16:06:26,768 [INFO]: 	index_param: efSearch=225
2025-03-13 16:06:26,768 [INFO]: 	index_path: knn.index
2025-03-13 16:06:26,768 [INFO]: 	size in bytes: 483202690
2025-03-13 16:06:26,768 [INFO]: 	avg_search_speed_ms: 10.103567153911548
2025-03-13 16:06:26,768 [INFO]: 	99p_search_speed_ms: 16.288092229515318
2025-03-13 16:06:26,768 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:06:26,768 [INFO]: 	nb vectors: 2456
2025-03-13 16:06:26,768 [INFO]: 	vectors dimension: 49152
2025-03-13 16:06:26,768 [INFO]: 	compression ratio: 0.9993099334773985
2025-03-13 16:06:26,768 [INFO]: }
2025-03-13 16:06:26,768 [INFO]: 	>>> Finished "Creating the index" in 58.9290 secs
2025-03-13 16:06:26,768 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9548 secs
2025-03-13 16:06:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:06:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 37975 [episode count 13/20]
[retrieval_preprocessing] for episode 56484 [episode count 14/20], we have num_retrieval=np.int64(2429) num_query=np.int64(114)
2025-03-13 16:06:28,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:06:28,865 [INFO]: Launching the whole pipeline 03/13/2025, 16:06:28
2025-03-13 16:06:28,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:06:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1667.05it/s]
2025-03-13 16:06:28,900 [INFO]: There are 2429 embeddings of dim 49152
2025-03-13 16:06:28,901 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 16:06:28,901 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:06:28
2025-03-13 16:06:28,901 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:06:28,901 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:06:28,901 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:06:28,901 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:06:28,901 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:06:28
2025-03-13 16:06:28,901 [INFO]: 501.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:06:28,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:06:28,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:06:28
2025-03-13 16:06:28,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:06:28,901 [INFO]: 	Creating the index 03/13/2025, 16:06:28
2025-03-13 16:06:28,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:06:28
2025-03-13 16:06:28,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:06:28,903 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:06:28
2025-03-13 16:06:28,903 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:06:28,903 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.68it/s] 30%|███       | 3/10 [00:00<00:00, 10.82it/s] 50%|█████     | 5/10 [00:00<00:00, 11.94it/s] 70%|███████   | 7/10 [00:00<00:00, 10.58it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.60it/s]100%|██████████| 10/10 [00:02<00:00,  2.26it/s]100%|██████████| 10/10 [00:02<00:00,  3.83it/s]
2025-03-13 16:06:31,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:06:31
2025-03-13 16:07:06,578 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0631 secs
2025-03-13 16:07:06,579 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:07:06,579 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-13 16:07:29,125 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5459 secs
2025-03-13 16:07:29,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2248 secs
2025-03-13 16:07:29,128 [INFO]: {
2025-03-13 16:07:29,128 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:29,128 [INFO]: 	index_param: efSearch=238
2025-03-13 16:07:29,128 [INFO]: 	index_path: knn.index
2025-03-13 16:07:29,128 [INFO]: 	size in bytes: 477890650
2025-03-13 16:07:29,128 [INFO]: 	avg_search_speed_ms: 12.082687523699667
2025-03-13 16:07:29,128 [INFO]: 	99p_search_speed_ms: 16.161086023785174
2025-03-13 16:07:29,128 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:29,128 [INFO]: 	nb vectors: 2429
2025-03-13 16:07:29,128 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:29,128 [INFO]: 	compression ratio: 0.9993098463006129
2025-03-13 16:07:29,128 [INFO]: }
2025-03-13 16:07:29,128 [INFO]: 	>>> Finished "Creating the index" in 60.2269 secs
2025-03-13 16:07:29,128 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2627 secs
2025-03-13 16:07:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 56484 [episode count 14/20]
[retrieval_preprocessing] for episode 77581 [episode count 15/20], we have num_retrieval=np.int64(2398) num_query=np.int64(145)
2025-03-13 16:07:31,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:32,129 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:32
2025-03-13 16:07:32,130 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2132.34it/s]
2025-03-13 16:07:32,154 [INFO]: There are 2398 embeddings of dim 49152
2025-03-13 16:07:32,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 16:07:32,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:32
2025-03-13 16:07:32,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:32,155 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:07:32,155 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:32,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:07:32,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:32
2025-03-13 16:07:32,155 [INFO]: 494.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:32,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:07:32,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:32
2025-03-13 16:07:32,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:32,155 [INFO]: 	Creating the index 03/13/2025, 16:07:32
2025-03-13 16:07:32,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:32
2025-03-13 16:07:32,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:07:32,157 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:32
2025-03-13 16:07:32,157 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:07:32,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.33it/s] 20%|██        | 2/10 [00:00<00:01,  6.88it/s] 30%|███       | 3/10 [00:00<00:00,  7.54it/s] 40%|████      | 4/10 [00:00<00:00,  7.87it/s] 50%|█████     | 5/10 [00:00<00:00,  8.05it/s] 60%|██████    | 6/10 [00:00<00:00,  8.07it/s] 70%|███████   | 7/10 [00:00<00:00,  8.17it/s] 80%|████████  | 8/10 [00:01<00:00,  7.91it/s] 90%|█████████ | 9/10 [00:01<00:00,  6.63it/s]100%|██████████| 10/10 [00:03<00:00,  1.34it/s]100%|██████████| 10/10 [00:03<00:00,  3.02it/s]
2025-03-13 16:07:35,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:35
2025-03-13 16:08:03,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1677 secs
2025-03-13 16:08:03,642 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 16:08:03,642 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-13 16:08:21,312 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6700 secs
2025-03-13 16:08:21,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1578 secs
2025-03-13 16:08:21,314 [INFO]: {
2025-03-13 16:08:21,315 [INFO]: 	index_key: HNSW15
2025-03-13 16:08:21,315 [INFO]: 	index_param: efSearch=291
2025-03-13 16:08:21,315 [INFO]: 	index_path: knn.index
2025-03-13 16:08:21,315 [INFO]: 	size in bytes: 471791650
2025-03-13 16:08:21,315 [INFO]: 	avg_search_speed_ms: 13.49307999816722
2025-03-13 16:08:21,315 [INFO]: 	99p_search_speed_ms: 26.553539512678995
2025-03-13 16:08:21,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:08:21,315 [INFO]: 	nb vectors: 2398
2025-03-13 16:08:21,315 [INFO]: 	vectors dimension: 49152
2025-03-13 16:08:21,315 [INFO]: 	compression ratio: 0.9993097249601598
2025-03-13 16:08:21,315 [INFO]: }
2025-03-13 16:08:21,315 [INFO]: 	>>> Finished "Creating the index" in 49.1594 secs
2025-03-13 16:08:21,315 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1851 secs
2025-03-13 16:08:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:08:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 77581 [episode count 15/20]
[retrieval_preprocessing] for episode 14644 [episode count 16/20], we have num_retrieval=np.int64(2413) num_query=np.int64(130)
2025-03-13 16:08:24,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:24,965 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:24
2025-03-13 16:08:24,966 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.99it/s]
2025-03-13 16:08:24,992 [INFO]: There are 2413 embeddings of dim 49152
2025-03-13 16:08:24,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 16:08:24,993 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:24
2025-03-13 16:08:24,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:24,993 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:08:24,993 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:24,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:08:24,993 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:24
2025-03-13 16:08:24,994 [INFO]: 498.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:24,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:08:24,994 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:24
2025-03-13 16:08:24,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:24,994 [INFO]: 	Creating the index 03/13/2025, 16:08:24
2025-03-13 16:08:24,995 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:24
2025-03-13 16:08:24,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:08:24,998 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:24
2025-03-13 16:08:24,998 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:08:24,999 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.48it/s] 20%|██        | 2/10 [00:00<00:01,  7.46it/s] 30%|███       | 3/10 [00:00<00:00,  8.30it/s] 40%|████      | 4/10 [00:00<00:00,  8.83it/s] 60%|██████    | 6/10 [00:00<00:00,  9.62it/s] 80%|████████  | 8/10 [00:00<00:00, 10.22it/s]100%|██████████| 10/10 [00:02<00:00,  2.26it/s]100%|██████████| 10/10 [00:02<00:00,  3.49it/s]
2025-03-13 16:08:27,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:27
2025-03-13 16:09:00,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9761 secs
2025-03-13 16:09:00,846 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 16:09:00,846 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 16:09:43,305 [INFO]: 	>>> Finished "Compute fast metrics" in 42.4592 secs
2025-03-13 16:09:44,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5077 secs
2025-03-13 16:09:44,506 [INFO]: {
2025-03-13 16:09:44,506 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:44,507 [INFO]: 	index_param: efSearch=229
2025-03-13 16:09:44,507 [INFO]: 	index_path: knn.index
2025-03-13 16:09:44,507 [INFO]: 	size in bytes: 474742810
2025-03-13 16:09:44,507 [INFO]: 	avg_search_speed_ms: 9.1767999587085
2025-03-13 16:09:44,507 [INFO]: 	99p_search_speed_ms: 15.127840961795261
2025-03-13 16:09:44,507 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:44,507 [INFO]: 	nb vectors: 2413
2025-03-13 16:09:44,507 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:44,507 [INFO]: 	compression ratio: 0.9993097188770484
2025-03-13 16:09:44,507 [INFO]: }
2025-03-13 16:09:44,507 [INFO]: 	>>> Finished "Creating the index" in 79.5127 secs
2025-03-13 16:09:44,507 [INFO]: >>> Finished "Launching the whole pipeline" in 79.5416 secs
2025-03-13 16:09:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 14644 [episode count 16/20]
[retrieval_preprocessing] for episode 45378 [episode count 17/20], we have num_retrieval=np.int64(2348) num_query=np.int64(195)
2025-03-13 16:09:46,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:46,556 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:46
2025-03-13 16:09:46,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 892.79it/s]
2025-03-13 16:09:46,583 [INFO]: There are 2348 embeddings of dim 49152
2025-03-13 16:09:46,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 16:09:46,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:46
2025-03-13 16:09:46,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:46,583 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:09:46,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:46,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:09:46,583 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:46
2025-03-13 16:09:46,583 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:46,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:09:46,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:46
2025-03-13 16:09:46,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:46,584 [INFO]: 	Creating the index 03/13/2025, 16:09:46
2025-03-13 16:09:46,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:46
2025-03-13 16:09:46,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:09:46,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:46
2025-03-13 16:09:46,585 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:09:46,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.45it/s] 60%|██████    | 6/10 [00:00<00:00, 31.72it/s]100%|██████████| 10/10 [00:01<00:00,  4.28it/s]100%|██████████| 10/10 [00:01<00:00,  5.11it/s]
2025-03-13 16:09:48,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:48
2025-03-13 16:10:33,267 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7205 secs
2025-03-13 16:10:33,268 [INFO]: The best hyperparameters are: efSearch=116
2025-03-13 16:10:33,268 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s]
2025-03-13 16:10:52,827 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5590 secs
2025-03-13 16:10:52,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2451 secs
2025-03-13 16:10:52,830 [INFO]: {
2025-03-13 16:10:52,830 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:52,830 [INFO]: 	index_param: efSearch=116
2025-03-13 16:10:52,830 [INFO]: 	index_path: knn.index
2025-03-13 16:10:52,830 [INFO]: 	size in bytes: 461954530
2025-03-13 16:10:52,830 [INFO]: 	avg_search_speed_ms: 8.652243474184191
2025-03-13 16:10:52,830 [INFO]: 	99p_search_speed_ms: 12.707131390925497
2025-03-13 16:10:52,830 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:52,830 [INFO]: 	nb vectors: 2348
2025-03-13 16:10:52,830 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:52,830 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-13 16:10:52,830 [INFO]: }
2025-03-13 16:10:52,830 [INFO]: 	>>> Finished "Creating the index" in 66.2466 secs
2025-03-13 16:10:52,830 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2741 secs
2025-03-13 16:10:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 45378 [episode count 17/20]
[retrieval_preprocessing] for episode 17249 [episode count 18/20], we have num_retrieval=np.int64(2421) num_query=np.int64(122)
2025-03-13 16:10:54,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:55,069 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:55
2025-03-13 16:10:55,069 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.85it/s]
2025-03-13 16:10:55,106 [INFO]: There are 2421 embeddings of dim 49152
2025-03-13 16:10:55,106 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0373 secs
2025-03-13 16:10:55,106 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:55
2025-03-13 16:10:55,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:55,107 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:10:55,107 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:55,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:10:55,107 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:55
2025-03-13 16:10:55,107 [INFO]: 499.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:55,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:10:55,107 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:55
2025-03-13 16:10:55,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:55,108 [INFO]: 	Creating the index 03/13/2025, 16:10:55
2025-03-13 16:10:55,108 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:55
2025-03-13 16:10:55,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:10:55,109 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:55
2025-03-13 16:10:55,110 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:10:55,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.86it/s] 50%|█████     | 5/10 [00:00<00:00, 24.55it/s] 90%|█████████ | 9/10 [00:00<00:00, 31.11it/s]100%|██████████| 10/10 [00:02<00:00,  4.68it/s]
2025-03-13 16:10:57,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:57
2025-03-13 16:11:34,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0543 secs
2025-03-13 16:11:34,308 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 16:11:34,308 [INFO]: 	Compute fast metrics 03/13/2025, 16:11:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.72it/s]
2025-03-13 16:11:55,899 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5915 secs
2025-03-13 16:11:55,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7916 secs
2025-03-13 16:11:55,901 [INFO]: {
2025-03-13 16:11:55,901 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:55,901 [INFO]: 	index_param: efSearch=198
2025-03-13 16:11:55,901 [INFO]: 	index_path: knn.index
2025-03-13 16:11:55,901 [INFO]: 	size in bytes: 476316730
2025-03-13 16:11:55,901 [INFO]: 	avg_search_speed_ms: 9.621027535270393
2025-03-13 16:11:55,901 [INFO]: 	99p_search_speed_ms: 13.209591805934904
2025-03-13 16:11:55,901 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:55,901 [INFO]: 	nb vectors: 2421
2025-03-13 16:11:55,901 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:55,901 [INFO]: 	compression ratio: 0.999309782799357
2025-03-13 16:11:55,901 [INFO]: }
2025-03-13 16:11:55,902 [INFO]: 	>>> Finished "Creating the index" in 60.7940 secs
2025-03-13 16:11:55,902 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8329 secs
2025-03-13 16:11:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 17249 [episode count 18/20]
[retrieval_preprocessing] for episode 60259 [episode count 19/20], we have num_retrieval=np.int64(2424) num_query=np.int64(119)
2025-03-13 16:11:58,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:58,697 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:58
2025-03-13 16:11:58,697 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.02it/s]
2025-03-13 16:11:58,726 [INFO]: There are 2424 embeddings of dim 49152
2025-03-13 16:11:58,726 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:11:58,726 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:58
2025-03-13 16:11:58,726 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:58,726 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 16:11:58,726 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:58,726 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:11:58,726 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:58
2025-03-13 16:11:58,727 [INFO]: 500.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:58,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:11:58,727 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:58
2025-03-13 16:11:58,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:58,727 [INFO]: 	Creating the index 03/13/2025, 16:11:58
2025-03-13 16:11:58,727 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:58
2025-03-13 16:11:58,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:11:58,728 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:58
2025-03-13 16:11:58,728 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:11:58,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.04it/s] 70%|███████   | 7/10 [00:00<00:00, 34.13it/s]100%|██████████| 10/10 [00:01<00:00,  5.56it/s]
2025-03-13 16:12:00,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:00
2025-03-13 16:12:36,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8762 secs
2025-03-13 16:12:36,409 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 16:12:36,409 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.01it/s]
2025-03-13 16:12:56,751 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3427 secs
2025-03-13 16:12:56,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0255 secs
2025-03-13 16:12:56,754 [INFO]: {
2025-03-13 16:12:56,754 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:56,754 [INFO]: 	index_param: efSearch=237
2025-03-13 16:12:56,754 [INFO]: 	index_path: knn.index
2025-03-13 16:12:56,754 [INFO]: 	size in bytes: 476906950
2025-03-13 16:12:56,754 [INFO]: 	avg_search_speed_ms: 12.192427029083596
2025-03-13 16:12:56,754 [INFO]: 	99p_search_speed_ms: 18.539180764928457
2025-03-13 16:12:56,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:56,754 [INFO]: 	nb vectors: 2424
2025-03-13 16:12:56,754 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:56,754 [INFO]: 	compression ratio: 0.9993098066614462
2025-03-13 16:12:56,754 [INFO]: }
2025-03-13 16:12:56,754 [INFO]: 	>>> Finished "Creating the index" in 58.0273 secs
2025-03-13 16:12:56,754 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0571 secs
2025-03-13 16:12:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 60259 [episode count 19/20]
2025-03-13 16:12:58: [retrieval_preprocessing] finished for 2782099537_put_marker_in_bowl [chosen_id count 3/196]
2025-03-13 16:13:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2828277154_put_can_in_sink [chosen_id count 4/196]
2025-03-13 16:13:00: [retrieval_preprocessing] we have num_total=6667 embedding_dim=49152
[retrieval_preprocessing] for episode 17428 [episode count 0/20], we have num_retrieval=np.int64(6325) num_query=np.int64(342)
2025-03-13 16:13:01,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:13:02,023 [INFO]: Launching the whole pipeline 03/13/2025, 16:13:02
2025-03-13 16:13:02,023 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:13:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 16:13:02,049 [INFO]: There are 6325 embeddings of dim 49152
2025-03-13 16:13:02,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:13:02,050 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:13:02
2025-03-13 16:13:02,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:13:02,050 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:13:02,050 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:13:02,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:13:02,050 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:13:02
2025-03-13 16:13:02,050 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:13:02,050 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:13:02,050 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:13:02
2025-03-13 16:13:02,050 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:13:02,050 [INFO]: 	Creating the index 03/13/2025, 16:13:02
2025-03-13 16:13:02,050 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:13:02
2025-03-13 16:13:02,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:13:02,051 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:13:02
2025-03-13 16:13:02,051 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:13:02,051 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  8.72it/s] 19%|█▉        | 5/26 [00:00<00:00, 24.91it/s] 38%|███▊      | 10/26 [00:00<00:00, 32.96it/s] 58%|█████▊    | 15/26 [00:00<00:00, 36.63it/s] 77%|███████▋  | 20/26 [00:00<00:00, 38.28it/s] 88%|████████▊ | 23/26 [00:11<00:00, 38.28it/s] 92%|█████████▏| 24/26 [00:13<00:02,  1.04s/it]100%|██████████| 26/26 [00:16<00:00,  1.08s/it]100%|██████████| 26/26 [00:16<00:00,  1.61it/s]
2025-03-13 16:13:18,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:13:18
2025-03-13 16:14:06,312 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0684 secs
2025-03-13 16:14:06,312 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 16:14:06,312 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.42it/s] 50%|█████     | 2/4 [00:00<00:00,  4.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-13 16:14:54,148 [INFO]: 	>>> Finished "Compute fast metrics" in 47.8352 secs
2025-03-13 16:14:54,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.1062 secs
2025-03-13 16:14:54,158 [INFO]: {
2025-03-13 16:14:54,158 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:54,158 [INFO]: 	index_param: efSearch=106
2025-03-13 16:14:54,158 [INFO]: 	index_path: knn.index
2025-03-13 16:14:54,158 [INFO]: 	size in bytes: 1244406190
2025-03-13 16:14:54,158 [INFO]: 	avg_search_speed_ms: 5.485147422969391
2025-03-13 16:14:54,158 [INFO]: 	99p_search_speed_ms: 9.013459770940244
2025-03-13 16:14:54,158 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:54,158 [INFO]: 	nb vectors: 6325
2025-03-13 16:14:54,158 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:54,158 [INFO]: 	compression ratio: 0.999308433205399
2025-03-13 16:14:54,158 [INFO]: }
2025-03-13 16:14:54,158 [INFO]: 	>>> Finished "Creating the index" in 112.1078 secs
2025-03-13 16:14:54,158 [INFO]: >>> Finished "Launching the whole pipeline" in 112.1353 secs
2025-03-13 16:14:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 17428 [episode count 0/20]
[retrieval_preprocessing] for episode 49181 [episode count 1/20], we have num_retrieval=np.int64(6333) num_query=np.int64(334)
2025-03-13 16:14:57,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:58,209 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:58
2025-03-13 16:14:58,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.47it/s]
2025-03-13 16:14:58,238 [INFO]: There are 6333 embeddings of dim 49152
2025-03-13 16:14:58,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:14:58,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:58
2025-03-13 16:14:58,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:58,238 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:14:58,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:58,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:58,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:58
2025-03-13 16:14:58,238 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:58,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:58,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:58
2025-03-13 16:14:58,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:58,238 [INFO]: 	Creating the index 03/13/2025, 16:14:58
2025-03-13 16:14:58,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:58
2025-03-13 16:14:58,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:14:58,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:58
2025-03-13 16:14:58,240 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:14:58,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  7.75it/s] 23%|██▎       | 6/26 [00:00<00:00, 27.99it/s] 42%|████▏     | 11/26 [00:00<00:00, 35.25it/s] 62%|██████▏   | 16/26 [00:00<00:00, 38.27it/s] 81%|████████  | 21/26 [00:04<00:01,  3.04it/s] 96%|█████████▌| 25/26 [00:04<00:00,  4.21it/s]100%|██████████| 26/26 [00:07<00:00,  3.68it/s]
2025-03-13 16:15:05,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:05
2025-03-13 16:16:07,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.9507 secs
2025-03-13 16:16:07,263 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 16:16:07,263 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.17it/s]
2025-03-13 16:17:02,341 [INFO]: 	>>> Finished "Compute fast metrics" in 55.0776 secs
2025-03-13 16:17:02,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.1020 secs
2025-03-13 16:17:02,342 [INFO]: {
2025-03-13 16:17:02,342 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:02,342 [INFO]: 	index_param: efSearch=217
2025-03-13 16:17:02,342 [INFO]: 	index_path: knn.index
2025-03-13 16:17:02,342 [INFO]: 	size in bytes: 1245980230
2025-03-13 16:17:02,342 [INFO]: 	avg_search_speed_ms: 7.834355290293063
2025-03-13 16:17:02,342 [INFO]: 	99p_search_speed_ms: 10.85230999160558
2025-03-13 16:17:02,342 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:02,342 [INFO]: 	nb vectors: 6333
2025-03-13 16:17:02,342 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:02,342 [INFO]: 	compression ratio: 0.9993083630227424
2025-03-13 16:17:02,342 [INFO]: }
2025-03-13 16:17:02,342 [INFO]: 	>>> Finished "Creating the index" in 124.1039 secs
2025-03-13 16:17:02,342 [INFO]: >>> Finished "Launching the whole pipeline" in 124.1333 secs
2025-03-13 16:17:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 49181 [episode count 1/20]
[retrieval_preprocessing] for episode 52797 [episode count 2/20], we have num_retrieval=np.int64(6209) num_query=np.int64(458)
2025-03-13 16:17:05,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:06,704 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:06
2025-03-13 16:17:06,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.05it/s]
2025-03-13 16:17:06,731 [INFO]: There are 6209 embeddings of dim 49152
2025-03-13 16:17:06,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 16:17:06,732 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:06
2025-03-13 16:17:06,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:06,732 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:17:06,732 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:06,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:06,732 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:06
2025-03-13 16:17:06,732 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:06,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:17:06,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:06
2025-03-13 16:17:06,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:06,732 [INFO]: 	Creating the index 03/13/2025, 16:17:06
2025-03-13 16:17:06,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:06
2025-03-13 16:17:06,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:17:06,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:06
2025-03-13 16:17:06,733 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:17:06,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.60it/s] 27%|██▋       | 7/26 [00:00<00:00, 35.24it/s] 46%|████▌     | 12/26 [00:00<00:00, 41.07it/s] 65%|██████▌   | 17/26 [00:00<00:00, 43.94it/s] 85%|████████▍ | 22/26 [00:04<00:01,  3.12it/s]100%|██████████| 26/26 [00:06<00:00,  2.64it/s]100%|██████████| 26/26 [00:06<00:00,  3.98it/s]
2025-03-13 16:17:13,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:13
2025-03-13 16:18:20,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.8073 secs
2025-03-13 16:18:20,081 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:18:20,081 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-13 16:18:57,811 [INFO]: 	>>> Finished "Compute fast metrics" in 37.7298 secs
2025-03-13 16:18:57,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.0791 secs
2025-03-13 16:18:57,812 [INFO]: {
2025-03-13 16:18:57,813 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:57,813 [INFO]: 	index_param: efSearch=216
2025-03-13 16:18:57,813 [INFO]: 	index_path: knn.index
2025-03-13 16:18:57,813 [INFO]: 	size in bytes: 1221583990
2025-03-13 16:18:57,813 [INFO]: 	avg_search_speed_ms: 10.215877585038847
2025-03-13 16:18:57,813 [INFO]: 	99p_search_speed_ms: 20.539338309317834
2025-03-13 16:18:57,813 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:57,813 [INFO]: 	nb vectors: 6209
2025-03-13 16:18:57,813 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:57,813 [INFO]: 	compression ratio: 0.9993083422777995
2025-03-13 16:18:57,813 [INFO]: }
2025-03-13 16:18:57,813 [INFO]: 	>>> Finished "Creating the index" in 111.0805 secs
2025-03-13 16:18:57,813 [INFO]: >>> Finished "Launching the whole pipeline" in 111.1082 secs
2025-03-13 16:18:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 52797 [episode count 2/20]
[retrieval_preprocessing] for episode 84030 [episode count 3/20], we have num_retrieval=np.int64(6268) num_query=np.int64(399)
2025-03-13 16:19:01,610 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:02,652 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:02
2025-03-13 16:19:02,653 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1045.44it/s]
2025-03-13 16:19:02,680 [INFO]: There are 6268 embeddings of dim 49152
2025-03-13 16:19:02,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 16:19:02,680 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:02
2025-03-13 16:19:02,680 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:02,681 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:19:02,681 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:02,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:02,681 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:02
2025-03-13 16:19:02,681 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:02,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:19:02,681 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:02
2025-03-13 16:19:02,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:02,681 [INFO]: 	Creating the index 03/13/2025, 16:19:02
2025-03-13 16:19:02,681 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:02
2025-03-13 16:19:02,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:19:02,682 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:02
2025-03-13 16:19:02,682 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:19:02,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  6.91it/s] 23%|██▎       | 6/26 [00:00<00:00, 25.47it/s] 42%|████▏     | 11/26 [00:00<00:00, 32.38it/s] 58%|█████▊    | 15/26 [00:03<00:03,  3.56it/s] 69%|██████▉   | 18/26 [00:04<00:02,  3.10it/s] 77%|███████▋  | 20/26 [00:05<00:01,  3.07it/s] 85%|████████▍ | 22/26 [00:10<00:03,  1.15it/s]100%|██████████| 26/26 [00:12<00:00,  1.35it/s]100%|██████████| 26/26 [00:12<00:00,  2.09it/s]
2025-03-13 16:19:15,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:15
2025-03-13 16:20:21,741 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.6090 secs
2025-03-13 16:20:21,742 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 16:20:21,742 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 16:20:49,110 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3678 secs
2025-03-13 16:20:49,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.4300 secs
2025-03-13 16:20:49,112 [INFO]: {
2025-03-13 16:20:49,112 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:49,112 [INFO]: 	index_param: efSearch=203
2025-03-13 16:20:49,112 [INFO]: 	index_path: knn.index
2025-03-13 16:20:49,112 [INFO]: 	size in bytes: 1233191890
2025-03-13 16:20:49,112 [INFO]: 	avg_search_speed_ms: 12.006475713432712
2025-03-13 16:20:49,112 [INFO]: 	99p_search_speed_ms: 19.48903322219846
2025-03-13 16:20:49,112 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:49,112 [INFO]: 	nb vectors: 6268
2025-03-13 16:20:49,112 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:49,112 [INFO]: 	compression ratio: 0.999308342840302
2025-03-13 16:20:49,112 [INFO]: }
2025-03-13 16:20:49,112 [INFO]: 	>>> Finished "Creating the index" in 106.4316 secs
2025-03-13 16:20:49,112 [INFO]: >>> Finished "Launching the whole pipeline" in 106.4599 secs
2025-03-13 16:20:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 84030 [episode count 3/20]
[retrieval_preprocessing] for episode 36907 [episode count 4/20], we have num_retrieval=np.int64(6402) num_query=np.int64(265)
2025-03-13 16:20:53,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:54,334 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:54
2025-03-13 16:20:54,334 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.54it/s]
2025-03-13 16:20:54,363 [INFO]: There are 6402 embeddings of dim 49152
2025-03-13 16:20:54,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:20:54,363 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:54
2025-03-13 16:20:54,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:54,364 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:20:54,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:54,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:20:54,364 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:54
2025-03-13 16:20:54,364 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:54,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:20:54,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:54
2025-03-13 16:20:54,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:54,364 [INFO]: 	Creating the index 03/13/2025, 16:20:54
2025-03-13 16:20:54,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:54
2025-03-13 16:20:54,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:20:54,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:54
2025-03-13 16:20:54,365 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:20:54,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.59it/s] 11%|█         | 3/27 [00:00<00:02,  9.17it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.68it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.30it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.58it/s] 41%|████      | 11/27 [00:01<00:01, 11.58it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.26it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.06it/s] 63%|██████▎   | 17/27 [00:01<00:00, 12.15it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.90it/s] 81%|████████▏ | 22/27 [00:05<00:02,  2.14it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.79it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.55it/s]100%|██████████| 27/27 [00:08<00:00,  1.65it/s]100%|██████████| 27/27 [00:08<00:00,  3.28it/s]
2025-03-13 16:21:02,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:02
2025-03-13 16:21:57,914 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3067 secs
2025-03-13 16:21:57,914 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 16:21:57,914 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 16:22:40,424 [INFO]: 	>>> Finished "Compute fast metrics" in 42.5093 secs
2025-03-13 16:22:41,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.6366 secs
2025-03-13 16:22:41,002 [INFO]: {
2025-03-13 16:22:41,003 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:41,003 [INFO]: 	index_param: efSearch=211
2025-03-13 16:22:41,003 [INFO]: 	index_path: knn.index
2025-03-13 16:22:41,003 [INFO]: 	size in bytes: 1259555590
2025-03-13 16:22:41,003 [INFO]: 	avg_search_speed_ms: 7.7661254556389725
2025-03-13 16:22:41,003 [INFO]: 	99p_search_speed_ms: 11.566615533083677
2025-03-13 16:22:41,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:41,003 [INFO]: 	nb vectors: 6402
2025-03-13 16:22:41,003 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:41,003 [INFO]: 	compression ratio: 0.9993083481134802
2025-03-13 16:22:41,003 [INFO]: }
2025-03-13 16:22:41,003 [INFO]: 	>>> Finished "Creating the index" in 106.6392 secs
2025-03-13 16:22:41,003 [INFO]: >>> Finished "Launching the whole pipeline" in 106.6693 secs
2025-03-13 16:22:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 36907 [episode count 4/20]
[retrieval_preprocessing] for episode 18538 [episode count 5/20], we have num_retrieval=np.int64(6430) num_query=np.int64(237)
2025-03-13 16:22:44,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:45,990 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:45
2025-03-13 16:22:45,990 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1391.15it/s]
2025-03-13 16:22:46,020 [INFO]: There are 6430 embeddings of dim 49152
2025-03-13 16:22:46,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 16:22:46,021 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:46
2025-03-13 16:22:46,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:46,021 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:22:46,021 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:46,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:22:46,022 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:46
2025-03-13 16:22:46,022 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:46,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:22:46,022 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:46
2025-03-13 16:22:46,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 16:22:46,023 [INFO]: 	Creating the index 03/13/2025, 16:22:46
2025-03-13 16:22:46,023 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:46
2025-03-13 16:22:46,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:22:46,026 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:46
2025-03-13 16:22:46,026 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:22:46,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.52it/s] 11%|█         | 3/27 [00:00<00:02,  8.85it/s] 15%|█▍        | 4/27 [00:00<00:02,  8.98it/s] 19%|█▊        | 5/27 [00:00<00:02,  8.84it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.80it/s] 26%|██▌       | 7/27 [00:00<00:02,  8.62it/s] 30%|██▉       | 8/27 [00:00<00:02,  8.52it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.46it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.39it/s] 41%|████      | 11/27 [00:01<00:01,  8.37it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.43it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.39it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.33it/s] 59%|█████▉    | 16/27 [00:01<00:00, 11.16it/s] 78%|███████▊  | 21/27 [00:04<00:02,  2.32it/s] 81%|████████▏ | 22/27 [00:05<00:01,  2.61it/s] 89%|████████▉ | 24/27 [00:05<00:00,  3.39it/s] 96%|█████████▋| 26/27 [00:05<00:00,  4.30it/s]100%|██████████| 27/27 [00:07<00:00,  1.85it/s]100%|██████████| 27/27 [00:07<00:00,  3.64it/s]
2025-03-13 16:22:53,531 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:53
2025-03-13 16:23:42,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8651 secs
2025-03-13 16:23:42,397 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 16:23:42,397 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.00it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-13 16:24:24,401 [INFO]: 	>>> Finished "Compute fast metrics" in 42.0038 secs
2025-03-13 16:24:24,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.3760 secs
2025-03-13 16:24:24,402 [INFO]: {
2025-03-13 16:24:24,402 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:24,402 [INFO]: 	index_param: efSearch=217
2025-03-13 16:24:24,402 [INFO]: 	index_path: knn.index
2025-03-13 16:24:24,402 [INFO]: 	size in bytes: 1265064310
2025-03-13 16:24:24,402 [INFO]: 	avg_search_speed_ms: 11.890171673791162
2025-03-13 16:24:24,403 [INFO]: 	99p_search_speed_ms: 18.5282712802291
2025-03-13 16:24:24,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:24,403 [INFO]: 	nb vectors: 6430
2025-03-13 16:24:24,403 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:24,403 [INFO]: 	compression ratio: 0.9993084383196298
2025-03-13 16:24:24,403 [INFO]: }
2025-03-13 16:24:24,403 [INFO]: 	>>> Finished "Creating the index" in 98.3798 secs
2025-03-13 16:24:24,403 [INFO]: >>> Finished "Launching the whole pipeline" in 98.4125 secs
2025-03-13 16:24:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 18538 [episode count 5/20]
[retrieval_preprocessing] for episode 70815 [episode count 6/20], we have num_retrieval=np.int64(6392) num_query=np.int64(275)
2025-03-13 16:24:28,997 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:30,395 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:30
2025-03-13 16:24:30,395 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.28it/s]
2025-03-13 16:24:30,421 [INFO]: There are 6392 embeddings of dim 49152
2025-03-13 16:24:30,421 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 16:24:30,421 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:30
2025-03-13 16:24:30,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:30,421 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:24:30,421 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:30,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:24:30,422 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:30
2025-03-13 16:24:30,422 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:30,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:24:30,422 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:30
2025-03-13 16:24:30,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:30,422 [INFO]: 	Creating the index 03/13/2025, 16:24:30
2025-03-13 16:24:30,422 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:30
2025-03-13 16:24:30,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:24:30,423 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:30
2025-03-13 16:24:30,423 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:24:30,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.87it/s] 11%|█         | 3/27 [00:00<00:03,  7.94it/s] 15%|█▍        | 4/27 [00:00<00:02,  8.38it/s] 22%|██▏       | 6/27 [00:00<00:02,  9.29it/s] 26%|██▌       | 7/27 [00:00<00:02,  9.41it/s] 30%|██▉       | 8/27 [00:00<00:02,  9.20it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.32it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.27it/s] 41%|████      | 11/27 [00:01<00:02,  7.60it/s] 44%|████▍     | 12/27 [00:01<00:01,  7.90it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.23it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.46it/s] 56%|█████▌    | 15/27 [00:01<00:01,  8.55it/s] 59%|█████▉    | 16/27 [00:01<00:01,  8.64it/s] 63%|██████▎   | 17/27 [00:02<00:01,  8.58it/s] 67%|██████▋   | 18/27 [00:02<00:01,  8.50it/s] 70%|███████   | 19/27 [00:02<00:00,  8.36it/s] 74%|███████▍  | 20/27 [00:02<00:00,  8.66it/s] 78%|███████▊  | 21/27 [00:08<00:11,  1.85s/it] 81%|████████▏ | 22/27 [00:08<00:06,  1.33s/it] 89%|████████▉ | 24/27 [00:08<00:02,  1.32it/s] 96%|█████████▋| 26/27 [00:08<00:00,  2.03it/s]100%|██████████| 27/27 [00:11<00:00,  1.09it/s]100%|██████████| 27/27 [00:11<00:00,  2.42it/s]
2025-03-13 16:24:41,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:41
2025-03-13 16:25:42,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.4257 secs
2025-03-13 16:25:42,019 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 16:25:42,019 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s]
2025-03-13 16:26:34,248 [INFO]: 	>>> Finished "Compute fast metrics" in 52.2288 secs
2025-03-13 16:26:34,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.8268 secs
2025-03-13 16:26:34,250 [INFO]: {
2025-03-13 16:26:34,250 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:34,250 [INFO]: 	index_param: efSearch=225
2025-03-13 16:26:34,250 [INFO]: 	index_path: knn.index
2025-03-13 16:26:34,250 [INFO]: 	size in bytes: 1257588190
2025-03-13 16:26:34,250 [INFO]: 	avg_search_speed_ms: 9.205408465515129
2025-03-13 16:26:34,250 [INFO]: 	99p_search_speed_ms: 17.442883329931647
2025-03-13 16:26:34,250 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:34,250 [INFO]: 	nb vectors: 6392
2025-03-13 16:26:34,250 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:34,250 [INFO]: 	compression ratio: 0.9993083157054775
2025-03-13 16:26:34,250 [INFO]: }
2025-03-13 16:26:34,250 [INFO]: 	>>> Finished "Creating the index" in 123.8283 secs
2025-03-13 16:26:34,250 [INFO]: >>> Finished "Launching the whole pipeline" in 123.8548 secs
2025-03-13 16:26:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 70815 [episode count 6/20]
[retrieval_preprocessing] for episode 16544 [episode count 7/20], we have num_retrieval=np.int64(6389) num_query=np.int64(278)
2025-03-13 16:26:37,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:38,977 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:38
2025-03-13 16:26:38,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.37it/s]
2025-03-13 16:26:39,003 [INFO]: There are 6389 embeddings of dim 49152
2025-03-13 16:26:39,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 16:26:39,004 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:39
2025-03-13 16:26:39,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:39,004 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:26:39,004 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:39,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:26:39,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:39
2025-03-13 16:26:39,004 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:39,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:26:39,004 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:39
2025-03-13 16:26:39,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:39,004 [INFO]: 	Creating the index 03/13/2025, 16:26:39
2025-03-13 16:26:39,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:39
2025-03-13 16:26:39,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:26:39,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:39
2025-03-13 16:26:39,005 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:26:39,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.34it/s] 11%|█         | 3/27 [00:00<00:02,  9.06it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.45it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.04it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.36it/s] 41%|████      | 11/27 [00:01<00:01, 11.56it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.58it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.45it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.43it/s] 70%|███████   | 19/27 [00:01<00:00, 11.22it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.30it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.54it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.18it/s] 96%|█████████▋| 26/27 [00:06<00:00,  2.98it/s]100%|██████████| 27/27 [00:08<00:00,  3.07it/s]
2025-03-13 16:26:47,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:47
2025-03-13 16:27:48,144 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3316 secs
2025-03-13 16:27:48,144 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 16:27:48,144 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 16:28:35,018 [INFO]: 	>>> Finished "Compute fast metrics" in 46.8740 secs
2025-03-13 16:28:35,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.0143 secs
2025-03-13 16:28:35,020 [INFO]: {
2025-03-13 16:28:35,020 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:35,020 [INFO]: 	index_param: efSearch=268
2025-03-13 16:28:35,020 [INFO]: 	index_path: knn.index
2025-03-13 16:28:35,020 [INFO]: 	size in bytes: 1256997970
2025-03-13 16:28:35,020 [INFO]: 	avg_search_speed_ms: 10.843420300456955
2025-03-13 16:28:35,020 [INFO]: 	99p_search_speed_ms: 15.679852780885994
2025-03-13 16:28:35,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:35,020 [INFO]: 	nb vectors: 6389
2025-03-13 16:28:35,020 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:35,020 [INFO]: 	compression ratio: 0.9993083059632945
2025-03-13 16:28:35,020 [INFO]: }
2025-03-13 16:28:35,020 [INFO]: 	>>> Finished "Creating the index" in 116.0157 secs
2025-03-13 16:28:35,020 [INFO]: >>> Finished "Launching the whole pipeline" in 116.0427 secs
2025-03-13 16:28:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 16544 [episode count 7/20]
[retrieval_preprocessing] for episode 72990 [episode count 8/20], we have num_retrieval=np.int64(6405) num_query=np.int64(262)
2025-03-13 16:28:39,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:40,734 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:40
2025-03-13 16:28:40,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1185.17it/s]
2025-03-13 16:28:40,760 [INFO]: There are 6405 embeddings of dim 49152
2025-03-13 16:28:40,760 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:28:40,760 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:40
2025-03-13 16:28:40,760 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:40,760 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:28:40,760 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:40,760 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:28:40,761 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:40
2025-03-13 16:28:40,761 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:40,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:28:40,761 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:40
2025-03-13 16:28:40,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:40,761 [INFO]: 	Creating the index 03/13/2025, 16:28:40
2025-03-13 16:28:40,761 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:40
2025-03-13 16:28:40,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:28:40,762 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:40
2025-03-13 16:28:40,762 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:28:40,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:10,  2.58it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.23it/s] 19%|█▊        | 5/27 [00:00<00:03,  5.72it/s] 22%|██▏       | 6/27 [00:01<00:03,  5.47it/s] 26%|██▌       | 7/27 [00:01<00:04,  4.53it/s] 30%|██▉       | 8/27 [00:01<00:03,  4.86it/s] 37%|███▋      | 10/27 [00:01<00:02,  6.98it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.72it/s] 56%|█████▌    | 15/27 [00:02<00:01, 11.89it/s] 67%|██████▋   | 18/27 [00:02<00:00, 14.56it/s] 74%|███████▍  | 20/27 [00:02<00:00, 14.50it/s] 81%|████████▏ | 22/27 [00:05<00:02,  1.83it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.44it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.21it/s]100%|██████████| 27/27 [00:08<00:00,  3.34it/s]
2025-03-13 16:28:48,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:48
2025-03-13 16:29:45,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0109 secs
2025-03-13 16:29:45,873 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 16:29:45,873 [INFO]: 	Compute fast metrics 03/13/2025, 16:29:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-13 16:30:13,598 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7253 secs
2025-03-13 16:30:13,600 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.8374 secs
2025-03-13 16:30:13,600 [INFO]: {
2025-03-13 16:30:13,600 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:13,600 [INFO]: 	index_param: efSearch=154
2025-03-13 16:30:13,600 [INFO]: 	index_path: knn.index
2025-03-13 16:30:13,600 [INFO]: 	size in bytes: 1260145810
2025-03-13 16:30:13,600 [INFO]: 	avg_search_speed_ms: 7.657139139730558
2025-03-13 16:30:13,600 [INFO]: 	99p_search_speed_ms: 12.036018283106388
2025-03-13 16:30:13,600 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:13,600 [INFO]: 	nb vectors: 6405
2025-03-13 16:30:13,600 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:13,600 [INFO]: 	compression ratio: 0.9993083578161482
2025-03-13 16:30:13,600 [INFO]: }
2025-03-13 16:30:13,600 [INFO]: 	>>> Finished "Creating the index" in 92.8391 secs
2025-03-13 16:30:13,600 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8664 secs
2025-03-13 16:30:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 72990 [episode count 8/20]
[retrieval_preprocessing] for episode 18137 [episode count 9/20], we have num_retrieval=np.int64(6401) num_query=np.int64(266)
2025-03-13 16:30:18,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:19,403 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:19
2025-03-13 16:30:19,403 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-13 16:30:19,428 [INFO]: There are 6401 embeddings of dim 49152
2025-03-13 16:30:19,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:30:19,429 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:19
2025-03-13 16:30:19,429 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:19,429 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:30:19,429 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:19,429 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:30:19,429 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:19
2025-03-13 16:30:19,430 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:19,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:30:19,430 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:19
2025-03-13 16:30:19,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:19,430 [INFO]: 	Creating the index 03/13/2025, 16:30:19
2025-03-13 16:30:19,430 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:19
2025-03-13 16:30:19,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:30:19,432 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:19
2025-03-13 16:30:19,432 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:30:19,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.82it/s]  7%|▋         | 2/27 [00:00<00:03,  6.72it/s] 11%|█         | 3/27 [00:00<00:03,  7.42it/s] 15%|█▍        | 4/27 [00:00<00:02,  7.93it/s] 22%|██▏       | 6/27 [00:00<00:02,  9.38it/s] 30%|██▉       | 8/27 [00:00<00:01,  9.71it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.87it/s] 44%|████▍     | 12/27 [00:01<00:01,  9.94it/s] 48%|████▊     | 13/27 [00:01<00:01,  9.87it/s] 52%|█████▏    | 14/27 [00:01<00:01,  9.85it/s] 56%|█████▌    | 15/27 [00:01<00:01,  9.87it/s] 63%|██████▎   | 17/27 [00:01<00:00, 10.41it/s] 70%|███████   | 19/27 [00:01<00:00, 10.58it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.26it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.52it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.22it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.06it/s]100%|██████████| 27/27 [00:08<00:00,  3.10it/s]
2025-03-13 16:30:28,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:28
2025-03-13 16:31:20,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3897 secs
2025-03-13 16:31:20,539 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 16:31:20,539 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 16:31:56,284 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7450 secs
2025-03-13 16:31:56,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.8546 secs
2025-03-13 16:31:56,286 [INFO]: {
2025-03-13 16:31:56,286 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:56,286 [INFO]: 	index_param: efSearch=232
2025-03-13 16:31:56,287 [INFO]: 	index_path: knn.index
2025-03-13 16:31:56,287 [INFO]: 	size in bytes: 1259358850
2025-03-13 16:31:56,287 [INFO]: 	avg_search_speed_ms: 10.650526100662523
2025-03-13 16:31:56,287 [INFO]: 	99p_search_speed_ms: 19.44940775167197
2025-03-13 16:31:56,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:56,287 [INFO]: 	nb vectors: 6401
2025-03-13 16:31:56,287 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:56,287 [INFO]: 	compression ratio: 0.9993083448772365
2025-03-13 16:31:56,287 [INFO]: }
2025-03-13 16:31:56,287 [INFO]: 	>>> Finished "Creating the index" in 96.8563 secs
2025-03-13 16:31:56,287 [INFO]: >>> Finished "Launching the whole pipeline" in 96.8836 secs
2025-03-13 16:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 18137 [episode count 9/20]
[retrieval_preprocessing] for episode 2421 [episode count 10/20], we have num_retrieval=np.int64(6407) num_query=np.int64(260)
2025-03-13 16:32:01,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:02,353 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:02
2025-03-13 16:32:02,353 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-13 16:32:02,382 [INFO]: There are 6407 embeddings of dim 49152
2025-03-13 16:32:02,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 16:32:02,382 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:02
2025-03-13 16:32:02,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:02,383 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:32:02,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:02,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:32:02,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:02
2025-03-13 16:32:02,383 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:02,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:32:02,384 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:02
2025-03-13 16:32:02,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:02,384 [INFO]: 	Creating the index 03/13/2025, 16:32:02
2025-03-13 16:32:02,384 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:02
2025-03-13 16:32:02,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:32:02,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:02
2025-03-13 16:32:02,387 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:32:02,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.55it/s] 11%|█         | 3/27 [00:00<00:02,  9.12it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.14it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.72it/s] 33%|███▎      | 9/27 [00:00<00:01, 10.82it/s] 41%|████      | 11/27 [00:01<00:01, 10.75it/s] 48%|████▊     | 13/27 [00:01<00:01, 10.57it/s] 56%|█████▌    | 15/27 [00:01<00:01, 10.30it/s] 63%|██████▎   | 17/27 [00:01<00:00, 10.04it/s] 70%|███████   | 19/27 [00:01<00:00,  9.88it/s] 74%|███████▍  | 20/27 [00:01<00:00,  9.87it/s] 78%|███████▊  | 21/27 [00:05<00:04,  1.30it/s] 81%|████████▏ | 22/27 [00:05<00:03,  1.61it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.44it/s] 96%|█████████▋| 26/27 [00:05<00:00,  3.38it/s]100%|██████████| 27/27 [00:07<00:00,  1.62it/s]100%|██████████| 27/27 [00:07<00:00,  3.51it/s]
2025-03-13 16:32:10,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:10
2025-03-13 16:33:01,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0266 secs
2025-03-13 16:33:01,105 [INFO]: The best hyperparameters are: efSearch=347
2025-03-13 16:33:01,105 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.81it/s]
2025-03-13 16:33:46,671 [INFO]: 	>>> Finished "Compute fast metrics" in 45.5659 secs
2025-03-13 16:33:46,673 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.2854 secs
2025-03-13 16:33:46,673 [INFO]: {
2025-03-13 16:33:46,673 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:46,673 [INFO]: 	index_param: efSearch=347
2025-03-13 16:33:46,673 [INFO]: 	index_path: knn.index
2025-03-13 16:33:46,673 [INFO]: 	size in bytes: 1260539290
2025-03-13 16:33:46,673 [INFO]: 	avg_search_speed_ms: 16.082705932495653
2025-03-13 16:33:46,673 [INFO]: 	99p_search_speed_ms: 27.439484072383472
2025-03-13 16:33:46,673 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:46,673 [INFO]: 	nb vectors: 6407
2025-03-13 16:33:46,673 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:46,673 [INFO]: 	compression ratio: 0.9993083642795458
2025-03-13 16:33:46,673 [INFO]: }
2025-03-13 16:33:46,673 [INFO]: 	>>> Finished "Creating the index" in 104.2890 secs
2025-03-13 16:33:46,673 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3197 secs
2025-03-13 16:33:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 2421 [episode count 10/20]
[retrieval_preprocessing] for episode 17871 [episode count 11/20], we have num_retrieval=np.int64(6423) num_query=np.int64(244)
2025-03-13 16:33:54,191 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:55,304 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:55
2025-03-13 16:33:55,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.21it/s]
2025-03-13 16:33:55,335 [INFO]: There are 6423 embeddings of dim 49152
2025-03-13 16:33:55,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 16:33:55,336 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:55
2025-03-13 16:33:55,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:55,336 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:33:55,336 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:55,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:33:55,336 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:55
2025-03-13 16:33:55,337 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:55,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:33:55,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:55
2025-03-13 16:33:55,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:55,337 [INFO]: 	Creating the index 03/13/2025, 16:33:55
2025-03-13 16:33:55,338 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:55
2025-03-13 16:33:55,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:33:55,341 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:55
2025-03-13 16:33:55,342 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:33:55,342 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.96it/s]  7%|▋         | 2/27 [00:00<00:03,  6.79it/s] 11%|█         | 3/27 [00:00<00:03,  7.71it/s] 15%|█▍        | 4/27 [00:00<00:02,  8.24it/s] 19%|█▊        | 5/27 [00:00<00:02,  8.68it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.88it/s] 26%|██▌       | 7/27 [00:00<00:02,  9.02it/s] 30%|██▉       | 8/27 [00:00<00:02,  8.76it/s] 33%|███▎      | 9/27 [00:01<00:02,  7.81it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.04it/s] 41%|████      | 11/27 [00:01<00:01,  8.50it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.67it/s] 52%|█████▏    | 14/27 [00:01<00:01, 10.86it/s] 63%|██████▎   | 17/27 [00:01<00:00, 15.76it/s] 74%|███████▍  | 20/27 [00:01<00:00, 19.45it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.49it/s]100%|██████████| 27/27 [00:09<00:00,  1.53it/s]100%|██████████| 27/27 [00:09<00:00,  2.85it/s]
2025-03-13 16:34:04,814 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:04
2025-03-13 16:35:06,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6505 secs
2025-03-13 16:35:06,465 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 16:35:06,465 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-13 16:35:59,081 [INFO]: 	>>> Finished "Compute fast metrics" in 52.6154 secs
2025-03-13 16:36:00,079 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.7374 secs
2025-03-13 16:36:00,079 [INFO]: {
2025-03-13 16:36:00,079 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:00,079 [INFO]: 	index_param: efSearch=163
2025-03-13 16:36:00,079 [INFO]: 	index_path: knn.index
2025-03-13 16:36:00,080 [INFO]: 	size in bytes: 1263687130
2025-03-13 16:36:00,080 [INFO]: 	avg_search_speed_ms: 8.565105750219898
2025-03-13 16:36:00,080 [INFO]: 	99p_search_speed_ms: 14.156451192684468
2025-03-13 16:36:00,080 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:00,080 [INFO]: 	nb vectors: 6423
2025-03-13 16:36:00,080 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:00,080 [INFO]: 	compression ratio: 0.9993084158418232
2025-03-13 16:36:00,080 [INFO]: }
2025-03-13 16:36:00,080 [INFO]: 	>>> Finished "Creating the index" in 124.7424 secs
2025-03-13 16:36:00,080 [INFO]: >>> Finished "Launching the whole pipeline" in 124.7756 secs
2025-03-13 16:36:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 17871 [episode count 11/20]
[retrieval_preprocessing] for episode 42460 [episode count 12/20], we have num_retrieval=np.int64(6392) num_query=np.int64(275)
2025-03-13 16:36:03,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:05,159 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:05
2025-03-13 16:36:05,159 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.29it/s]
2025-03-13 16:36:05,188 [INFO]: There are 6392 embeddings of dim 49152
2025-03-13 16:36:05,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:36:05,188 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:05
2025-03-13 16:36:05,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:05,188 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:36:05,188 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:05,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:05,188 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:05
2025-03-13 16:36:05,188 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:05,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:36:05,189 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:05
2025-03-13 16:36:05,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:05,189 [INFO]: 	Creating the index 03/13/2025, 16:36:05
2025-03-13 16:36:05,189 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:05
2025-03-13 16:36:05,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:36:05,190 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:05
2025-03-13 16:36:05,190 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:36:05,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.29it/s] 11%|█         | 3/27 [00:00<00:02, 10.02it/s] 19%|█▊        | 5/27 [00:00<00:01, 12.19it/s] 26%|██▌       | 7/27 [00:00<00:01, 12.19it/s] 33%|███▎      | 9/27 [00:00<00:01, 12.22it/s] 41%|████      | 11/27 [00:00<00:01, 12.40it/s] 48%|████▊     | 13/27 [00:01<00:01, 12.19it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.96it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.72it/s] 70%|███████   | 19/27 [00:01<00:00, 11.54it/s] 78%|███████▊  | 21/27 [00:06<00:04,  1.36it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.60it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.26it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.08it/s]100%|██████████| 27/27 [00:08<00:00,  3.03it/s]
2025-03-13 16:36:14,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:14
2025-03-13 16:37:13,674 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5669 secs
2025-03-13 16:37:13,675 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:37:13,675 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-13 16:37:58,142 [INFO]: 	>>> Finished "Compute fast metrics" in 44.4671 secs
2025-03-13 16:37:58,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.9533 secs
2025-03-13 16:37:58,144 [INFO]: {
2025-03-13 16:37:58,144 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:58,144 [INFO]: 	index_param: efSearch=216
2025-03-13 16:37:58,144 [INFO]: 	index_path: knn.index
2025-03-13 16:37:58,144 [INFO]: 	size in bytes: 1257588190
2025-03-13 16:37:58,144 [INFO]: 	avg_search_speed_ms: 8.101280405815553
2025-03-13 16:37:58,144 [INFO]: 	99p_search_speed_ms: 13.8378757843748
2025-03-13 16:37:58,144 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:58,144 [INFO]: 	nb vectors: 6392
2025-03-13 16:37:58,144 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:58,144 [INFO]: 	compression ratio: 0.9993083157054775
2025-03-13 16:37:58,144 [INFO]: }
2025-03-13 16:37:58,144 [INFO]: 	>>> Finished "Creating the index" in 112.9553 secs
2025-03-13 16:37:58,144 [INFO]: >>> Finished "Launching the whole pipeline" in 112.9854 secs
2025-03-13 16:37:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 42460 [episode count 12/20]
[retrieval_preprocessing] for episode 49118 [episode count 13/20], we have num_retrieval=np.int64(6338) num_query=np.int64(329)
2025-03-13 16:38:03,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:04,615 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:04
2025-03-13 16:38:04,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.61it/s]
2025-03-13 16:38:04,641 [INFO]: There are 6338 embeddings of dim 49152
2025-03-13 16:38:04,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:38:04,641 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:04
2025-03-13 16:38:04,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:04,641 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:38:04,641 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:04,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:38:04,641 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:04
2025-03-13 16:38:04,641 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:04,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:38:04,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:04
2025-03-13 16:38:04,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:04,642 [INFO]: 	Creating the index 03/13/2025, 16:38:04
2025-03-13 16:38:04,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:04
2025-03-13 16:38:04,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:38:04,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:04
2025-03-13 16:38:04,643 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:38:04,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.64it/s] 12%|█▏        | 3/26 [00:00<00:02,  9.44it/s] 19%|█▉        | 5/26 [00:00<00:01, 11.21it/s] 27%|██▋       | 7/26 [00:00<00:01, 12.11it/s] 35%|███▍      | 9/26 [00:00<00:01, 11.89it/s] 42%|████▏     | 11/26 [00:00<00:01, 11.80it/s] 50%|█████     | 13/26 [00:01<00:01, 11.81it/s] 58%|█████▊    | 15/26 [00:01<00:00, 11.26it/s] 65%|██████▌   | 17/26 [00:01<00:00, 10.94it/s] 73%|███████▎  | 19/26 [00:01<00:00, 10.92it/s] 81%|████████  | 21/26 [00:05<00:03,  1.47it/s] 96%|█████████▌| 25/26 [00:05<00:00,  2.66it/s]100%|██████████| 26/26 [00:08<00:00,  3.04it/s]
2025-03-13 16:38:13,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:13
2025-03-13 16:39:37,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.7627 secs
2025-03-13 16:39:37,968 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 16:39:37,968 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 16:40:28,527 [INFO]: 	>>> Finished "Compute fast metrics" in 50.5587 secs
2025-03-13 16:40:28,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.8858 secs
2025-03-13 16:40:28,529 [INFO]: {
2025-03-13 16:40:28,529 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:28,529 [INFO]: 	index_param: efSearch=171
2025-03-13 16:40:28,529 [INFO]: 	index_path: knn.index
2025-03-13 16:40:28,529 [INFO]: 	size in bytes: 1246963930
2025-03-13 16:40:28,529 [INFO]: 	avg_search_speed_ms: 7.819705892338231
2025-03-13 16:40:28,529 [INFO]: 	99p_search_speed_ms: 12.288944255560638
2025-03-13 16:40:28,529 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:28,529 [INFO]: 	nb vectors: 6338
2025-03-13 16:40:28,529 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:28,529 [INFO]: 	compression ratio: 0.999308379353042
2025-03-13 16:40:28,529 [INFO]: }
2025-03-13 16:40:28,529 [INFO]: 	>>> Finished "Creating the index" in 143.8874 secs
2025-03-13 16:40:28,529 [INFO]: >>> Finished "Launching the whole pipeline" in 143.9138 secs
2025-03-13 16:40:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 49118 [episode count 13/20]
[retrieval_preprocessing] for episode 41452 [episode count 14/20], we have num_retrieval=np.int64(6236) num_query=np.int64(431)
2025-03-13 16:40:31,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:32,311 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:32
2025-03-13 16:40:32,312 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.95it/s]
2025-03-13 16:40:32,343 [INFO]: There are 6236 embeddings of dim 49152
2025-03-13 16:40:32,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:40:32,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:32,344 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:40:32,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:32,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:40:32,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,344 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:32,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:40:32,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:32
2025-03-13 16:40:32,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:32,344 [INFO]: 	Creating the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:32
2025-03-13 16:40:32,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:40:32,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,345 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:40:32,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.22it/s] 23%|██▎       | 6/26 [00:00<00:00, 31.19it/s] 42%|████▏     | 11/26 [00:00<00:00, 38.79it/s] 62%|██████▏   | 16/26 [00:00<00:00, 42.90it/s] 81%|████████  | 21/26 [00:04<00:01,  3.26it/s]100%|██████████| 26/26 [00:05<00:00,  3.17it/s]100%|██████████| 26/26 [00:05<00:00,  4.44it/s]
2025-03-13 16:40:38,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:38
2025-03-13 16:41:36,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9904 secs
2025-03-13 16:41:36,199 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:41:36,199 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.69it/s]
2025-03-13 16:42:10,663 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4641 secs
2025-03-13 16:42:10,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.3191 secs
2025-03-13 16:42:10,665 [INFO]: {
2025-03-13 16:42:10,665 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:10,665 [INFO]: 	index_param: efSearch=187
2025-03-13 16:42:10,665 [INFO]: 	index_path: knn.index
2025-03-13 16:42:10,665 [INFO]: 	size in bytes: 1226896090
2025-03-13 16:42:10,665 [INFO]: 	avg_search_speed_ms: 8.60271142317197
2025-03-13 16:42:10,665 [INFO]: 	99p_search_speed_ms: 15.039558087009944
2025-03-13 16:42:10,665 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:10,665 [INFO]: 	nb vectors: 6236
2025-03-13 16:42:10,665 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:10,665 [INFO]: 	compression ratio: 0.9993083342534738
2025-03-13 16:42:10,665 [INFO]: }
2025-03-13 16:42:10,665 [INFO]: 	>>> Finished "Creating the index" in 98.3210 secs
2025-03-13 16:42:10,665 [INFO]: >>> Finished "Launching the whole pipeline" in 98.3535 secs
2025-03-13 16:42:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 41452 [episode count 14/20]
[retrieval_preprocessing] for episode 56406 [episode count 15/20], we have num_retrieval=np.int64(6220) num_query=np.int64(447)
2025-03-13 16:42:13,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:14,903 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:14
2025-03-13 16:42:14,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.15it/s]
2025-03-13 16:42:14,935 [INFO]: There are 6220 embeddings of dim 49152
2025-03-13 16:42:14,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-13 16:42:14,935 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:14
2025-03-13 16:42:14,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:14,935 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:42:14,935 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:14,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:42:14,935 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:14
2025-03-13 16:42:14,935 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:14,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:42:14,935 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:14
2025-03-13 16:42:14,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:14,936 [INFO]: 	Creating the index 03/13/2025, 16:42:14
2025-03-13 16:42:14,936 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:14
2025-03-13 16:42:14,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:42:14,937 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:14
2025-03-13 16:42:14,937 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:42:14,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  7.28it/s] 19%|█▉        | 5/26 [00:00<00:00, 22.53it/s] 35%|███▍      | 9/26 [00:00<00:00, 29.54it/s] 54%|█████▍    | 14/26 [00:00<00:00, 34.26it/s] 69%|██████▉   | 18/26 [00:00<00:00, 35.85it/s] 85%|████████▍ | 22/26 [00:04<00:01,  2.78it/s]100%|██████████| 26/26 [00:06<00:00,  2.55it/s]100%|██████████| 26/26 [00:06<00:00,  4.04it/s]
2025-03-13 16:42:21,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:21
2025-03-13 16:43:20,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1501 secs
2025-03-13 16:43:20,530 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 16:43:20,530 [INFO]: 	Compute fast metrics 03/13/2025, 16:43:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.13it/s]
2025-03-13 16:44:00,279 [INFO]: 	>>> Finished "Compute fast metrics" in 39.7488 secs
2025-03-13 16:44:00,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.3430 secs
2025-03-13 16:44:00,280 [INFO]: {
2025-03-13 16:44:00,280 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:00,280 [INFO]: 	index_param: efSearch=223
2025-03-13 16:44:00,280 [INFO]: 	index_path: knn.index
2025-03-13 16:44:00,280 [INFO]: 	size in bytes: 1223748130
2025-03-13 16:44:00,280 [INFO]: 	avg_search_speed_ms: 9.556647089183558
2025-03-13 16:44:00,280 [INFO]: 	99p_search_speed_ms: 13.158633175771683
2025-03-13 16:44:00,280 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:00,280 [INFO]: 	nb vectors: 6220
2025-03-13 16:44:00,280 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:00,280 [INFO]: 	compression ratio: 0.9993083789227118
2025-03-13 16:44:00,280 [INFO]: }
2025-03-13 16:44:00,280 [INFO]: 	>>> Finished "Creating the index" in 105.3447 secs
2025-03-13 16:44:00,280 [INFO]: >>> Finished "Launching the whole pipeline" in 105.3771 secs
2025-03-13 16:44:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 56406 [episode count 15/20]
[retrieval_preprocessing] for episode 74222 [episode count 16/20], we have num_retrieval=np.int64(6136) num_query=np.int64(531)
2025-03-13 16:44:05,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:06,201 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:06
2025-03-13 16:44:06,201 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.13it/s]
2025-03-13 16:44:06,233 [INFO]: There are 6136 embeddings of dim 49152
2025-03-13 16:44:06,234 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 16:44:06,235 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:06
2025-03-13 16:44:06,235 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:06,235 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:44:06,235 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:06,235 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:44:06,235 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:06
2025-03-13 16:44:06,236 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:06,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:44:06,236 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:06
2025-03-13 16:44:06,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:06,236 [INFO]: 	Creating the index 03/13/2025, 16:44:06
2025-03-13 16:44:06,237 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:06
2025-03-13 16:44:06,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:44:06,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:06
2025-03-13 16:44:06,240 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:44:06,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  8.75it/s] 19%|█▉        | 5/26 [00:00<00:00, 25.08it/s] 35%|███▍      | 9/26 [00:00<00:00, 30.73it/s] 50%|█████     | 13/26 [00:00<00:00, 33.08it/s] 65%|██████▌   | 17/26 [00:00<00:00, 34.81it/s] 81%|████████  | 21/26 [00:05<00:02,  2.38it/s] 96%|█████████▌| 25/26 [00:05<00:00,  3.47it/s]100%|██████████| 26/26 [00:07<00:00,  3.61it/s]
2025-03-13 16:44:13,456 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:13
2025-03-13 16:45:12,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1301 secs
2025-03-13 16:45:12,587 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 16:45:12,587 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 16:46:00,622 [INFO]: 	>>> Finished "Compute fast metrics" in 48.0348 secs
2025-03-13 16:46:00,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.3832 secs
2025-03-13 16:46:00,623 [INFO]: {
2025-03-13 16:46:00,623 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:00,624 [INFO]: 	index_param: efSearch=258
2025-03-13 16:46:00,624 [INFO]: 	index_path: knn.index
2025-03-13 16:46:00,624 [INFO]: 	size in bytes: 1207221730
2025-03-13 16:46:00,624 [INFO]: 	avg_search_speed_ms: 14.314169392258846
2025-03-13 16:46:00,624 [INFO]: 	99p_search_speed_ms: 28.70032533071935
2025-03-13 16:46:00,624 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:00,624 [INFO]: 	nb vectors: 6136
2025-03-13 16:46:00,624 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:00,624 [INFO]: 	compression ratio: 0.9993082944257473
2025-03-13 16:46:00,624 [INFO]: }
2025-03-13 16:46:00,624 [INFO]: 	>>> Finished "Creating the index" in 114.3872 secs
2025-03-13 16:46:00,624 [INFO]: >>> Finished "Launching the whole pipeline" in 114.4229 secs
2025-03-13 16:46:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 74222 [episode count 16/20]
[retrieval_preprocessing] for episode 999 [episode count 17/20], we have num_retrieval=np.int64(6266) num_query=np.int64(401)
2025-03-13 16:46:08,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:10,081 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:10
2025-03-13 16:46:10,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.57it/s]
2025-03-13 16:46:10,113 [INFO]: There are 6266 embeddings of dim 49152
2025-03-13 16:46:10,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:46:10,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:10,113 [INFO]: 		-> Add: 3.4 seconds
2025-03-13 16:46:10,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:10,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:10,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,113 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:10,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:46:10,114 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:10
2025-03-13 16:46:10,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:10,114 [INFO]: 	Creating the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,114 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:10
2025-03-13 16:46:10,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:46:10,115 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:10
2025-03-13 16:46:10,115 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 16:46:10,115 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.23it/s] 19%|█▉        | 5/26 [00:00<00:00, 25.86it/s] 35%|███▍      | 9/26 [00:00<00:00, 29.38it/s] 50%|█████     | 13/26 [00:00<00:00, 32.31it/s] 65%|██████▌   | 17/26 [00:00<00:00, 34.30it/s] 81%|████████  | 21/26 [00:04<00:02,  2.42it/s] 96%|█████████▌| 25/26 [00:05<00:00,  3.53it/s]100%|██████████| 26/26 [00:07<00:00,  3.62it/s]
2025-03-13 16:46:17,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:17
2025-03-13 16:47:09,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6500 secs
2025-03-13 16:47:09,559 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:47:09,559 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.17it/s]
2025-03-13 16:48:00,138 [INFO]: 	>>> Finished "Compute fast metrics" in 50.5787 secs
2025-03-13 16:48:00,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.0239 secs
2025-03-13 16:48:00,139 [INFO]: {
2025-03-13 16:48:00,139 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:00,139 [INFO]: 	index_param: efSearch=212
2025-03-13 16:48:00,139 [INFO]: 	index_path: knn.index
2025-03-13 16:48:00,139 [INFO]: 	size in bytes: 1232798410
2025-03-13 16:48:00,139 [INFO]: 	avg_search_speed_ms: 10.755193262280876
2025-03-13 16:48:00,139 [INFO]: 	99p_search_speed_ms: 18.821601744275544
2025-03-13 16:48:00,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:00,139 [INFO]: 	nb vectors: 6266
2025-03-13 16:48:00,139 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:00,139 [INFO]: 	compression ratio: 0.9993083362266828
2025-03-13 16:48:00,139 [INFO]: }
2025-03-13 16:48:00,139 [INFO]: 	>>> Finished "Creating the index" in 110.0257 secs
2025-03-13 16:48:00,139 [INFO]: >>> Finished "Launching the whole pipeline" in 110.0584 secs
2025-03-13 16:48:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 999 [episode count 17/20]
[retrieval_preprocessing] for episode 42461 [episode count 18/20], we have num_retrieval=np.int64(6289) num_query=np.int64(378)
2025-03-13 16:48:04,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:05,722 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:05
2025-03-13 16:48:05,722 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1020.76it/s]
2025-03-13 16:48:05,756 [INFO]: There are 6289 embeddings of dim 49152
2025-03-13 16:48:05,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 16:48:05,756 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:05
2025-03-13 16:48:05,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:05,756 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:48:05,756 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:05,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:48:05,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:05
2025-03-13 16:48:05,756 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:05,757 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:48:05,757 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:05
2025-03-13 16:48:05,757 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:05,757 [INFO]: 	Creating the index 03/13/2025, 16:48:05
2025-03-13 16:48:05,757 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:05
2025-03-13 16:48:05,758 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:48:05,759 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:05
2025-03-13 16:48:05,759 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:48:05,759 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.09it/s] 15%|█▌        | 4/26 [00:00<00:01, 14.66it/s] 27%|██▋       | 7/26 [00:00<00:00, 19.86it/s] 42%|████▏     | 11/26 [00:00<00:00, 24.32it/s] 58%|█████▊    | 15/26 [00:00<00:00, 27.16it/s] 73%|███████▎  | 19/26 [00:00<00:00, 28.98it/s] 85%|████████▍ | 22/26 [00:06<00:02,  1.74it/s] 96%|█████████▌| 25/26 [00:06<00:00,  2.39it/s]100%|██████████| 26/26 [00:09<00:00,  2.69it/s]
2025-03-13 16:48:15,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:15
2025-03-13 16:49:17,153 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7270 secs
2025-03-13 16:49:17,153 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 16:49:17,153 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.49it/s]
2025-03-13 16:49:48,457 [INFO]: 	>>> Finished "Compute fast metrics" in 31.3038 secs
2025-03-13 16:49:48,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.6999 secs
2025-03-13 16:49:48,459 [INFO]: {
2025-03-13 16:49:48,459 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:48,459 [INFO]: 	index_param: efSearch=242
2025-03-13 16:49:48,459 [INFO]: 	index_path: knn.index
2025-03-13 16:49:48,459 [INFO]: 	size in bytes: 1237323430
2025-03-13 16:49:48,459 [INFO]: 	avg_search_speed_ms: 8.24701472727608
2025-03-13 16:49:48,459 [INFO]: 	99p_search_speed_ms: 12.48945144005118
2025-03-13 16:49:48,459 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:48,459 [INFO]: 	nb vectors: 6289
2025-03-13 16:49:48,459 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:48,459 [INFO]: 	compression ratio: 0.9993084120293431
2025-03-13 16:49:48,459 [INFO]: }
2025-03-13 16:49:48,459 [INFO]: 	>>> Finished "Creating the index" in 102.7018 secs
2025-03-13 16:49:48,459 [INFO]: >>> Finished "Launching the whole pipeline" in 102.7365 secs
2025-03-13 16:49:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 42461 [episode count 18/20]
[retrieval_preprocessing] for episode 95657 [episode count 19/20], we have num_retrieval=np.int64(6412) num_query=np.int64(255)
2025-03-13 16:49:51,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:52,792 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:52
2025-03-13 16:49:52,792 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1123.27it/s]
2025-03-13 16:49:52,818 [INFO]: There are 6412 embeddings of dim 49152
2025-03-13 16:49:52,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:49:52,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:52
2025-03-13 16:49:52,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:52,818 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 16:49:52,818 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:52,818 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:49:52,818 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:52
2025-03-13 16:49:52,818 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:52,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:49:52,818 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:52
2025-03-13 16:49:52,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:52,818 [INFO]: 	Creating the index 03/13/2025, 16:49:52
2025-03-13 16:49:52,818 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:52
2025-03-13 16:49:52,819 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:49:52,819 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:52
2025-03-13 16:49:52,820 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 16:49:52,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  8.30it/s] 26%|██▌       | 7/27 [00:00<00:00, 34.05it/s] 48%|████▊     | 13/27 [00:00<00:00, 43.07it/s] 70%|███████   | 19/27 [00:00<00:00, 47.40it/s] 89%|████████▉ | 24/27 [00:03<00:00,  4.25it/s]100%|██████████| 27/27 [00:05<00:00,  5.06it/s]
2025-03-13 16:49:58,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:58
2025-03-13 16:50:48,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6016 secs
2025-03-13 16:50:48,762 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:50:48,763 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.91it/s]
2025-03-13 16:51:28,289 [INFO]: 	>>> Finished "Compute fast metrics" in 39.5260 secs
2025-03-13 16:51:28,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.4709 secs
2025-03-13 16:51:28,291 [INFO]: {
2025-03-13 16:51:28,291 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:28,291 [INFO]: 	index_param: efSearch=201
2025-03-13 16:51:28,291 [INFO]: 	index_path: knn.index
2025-03-13 16:51:28,291 [INFO]: 	size in bytes: 1261522990
2025-03-13 16:51:28,291 [INFO]: 	avg_search_speed_ms: 9.396387756709359
2025-03-13 16:51:28,291 [INFO]: 	99p_search_speed_ms: 13.472167940344658
2025-03-13 16:51:28,291 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:28,291 [INFO]: 	nb vectors: 6412
2025-03-13 16:51:28,291 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:28,291 [INFO]: 	compression ratio: 0.9993083804203996
2025-03-13 16:51:28,291 [INFO]: }
2025-03-13 16:51:28,291 [INFO]: 	>>> Finished "Creating the index" in 95.4726 secs
2025-03-13 16:51:28,291 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4989 secs
2025-03-13 16:51:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 95657 [episode count 19/20]
2025-03-13 16:51:31: [retrieval_preprocessing] finished for 2828277154_put_can_in_sink [chosen_id count 4/196]
2025-03-13 16:51:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2828277154_remove_can_from_sink [chosen_id count 5/196]
2025-03-13 16:51:33: [retrieval_preprocessing] we have num_total=4444 embedding_dim=49152
[retrieval_preprocessing] for episode 51730 [episode count 0/20], we have num_retrieval=np.int64(4226) num_query=np.int64(218)
2025-03-13 16:51:33,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:34,358 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:34
2025-03-13 16:51:34,358 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.02it/s]
2025-03-13 16:51:34,385 [INFO]: There are 4226 embeddings of dim 49152
2025-03-13 16:51:34,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 16:51:34,385 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:34
2025-03-13 16:51:34,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:34,385 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:51:34,385 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:34,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:34,385 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:34
2025-03-13 16:51:34,385 [INFO]: 872.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:34,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:34,386 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:34
2025-03-13 16:51:34,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:34,386 [INFO]: 	Creating the index 03/13/2025, 16:51:34
2025-03-13 16:51:34,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:34
2025-03-13 16:51:34,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:51:34,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:34
2025-03-13 16:51:34,387 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:51:34,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.21it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.34it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.47it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.63it/s]100%|██████████| 17/17 [00:03<00:00,  4.50it/s]
2025-03-13 16:51:38,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:38
2025-03-13 16:52:27,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0379 secs
2025-03-13 16:52:27,207 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 16:52:27,207 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 16:52:59,301 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0943 secs
2025-03-13 16:52:59,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9170 secs
2025-03-13 16:52:59,304 [INFO]: {
2025-03-13 16:52:59,304 [INFO]: 	index_key: HNSW15
2025-03-13 16:52:59,304 [INFO]: 	index_param: efSearch=159
2025-03-13 16:52:59,304 [INFO]: 	index_path: knn.index
2025-03-13 16:52:59,304 [INFO]: 	size in bytes: 831440110
2025-03-13 16:52:59,304 [INFO]: 	avg_search_speed_ms: 7.216410974980014
2025-03-13 16:52:59,304 [INFO]: 	99p_search_speed_ms: 9.346937772352248
2025-03-13 16:52:59,304 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:52:59,304 [INFO]: 	nb vectors: 4226
2025-03-13 16:52:59,304 [INFO]: 	vectors dimension: 49152
2025-03-13 16:52:59,304 [INFO]: 	compression ratio: 0.9993087872558855
2025-03-13 16:52:59,304 [INFO]: }
2025-03-13 16:52:59,304 [INFO]: 	>>> Finished "Creating the index" in 84.9187 secs
2025-03-13 16:52:59,304 [INFO]: >>> Finished "Launching the whole pipeline" in 84.9466 secs
2025-03-13 16:52:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 51730 [episode count 0/20]
[retrieval_preprocessing] for episode 89619 [episode count 1/20], we have num_retrieval=np.int64(4227) num_query=np.int64(217)
2025-03-13 16:53:01,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:01,663 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:01
2025-03-13 16:53:01,664 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 822.41it/s]
2025-03-13 16:53:01,694 [INFO]: There are 4227 embeddings of dim 49152
2025-03-13 16:53:01,694 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:53:01,694 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,695 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:01,695 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:53:01,695 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:01,695 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:53:01,695 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,695 [INFO]: 872.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:01,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:53:01,696 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:01
2025-03-13 16:53:01,696 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:01,696 [INFO]: 	Creating the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,696 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:01
2025-03-13 16:53:01,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:53:01,699 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,700 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:53:01,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.55it/s] 41%|████      | 7/17 [00:00<00:00, 31.80it/s] 71%|███████   | 12/17 [00:00<00:00, 36.41it/s]100%|██████████| 17/17 [00:03<00:00,  3.48it/s]100%|██████████| 17/17 [00:03<00:00,  4.83it/s]
2025-03-13 16:53:05,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:05
2025-03-13 16:53:48,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8081 secs
2025-03-13 16:53:48,033 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 16:53:48,033 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.53it/s]
2025-03-13 16:54:17,593 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5600 secs
2025-03-13 16:54:17,596 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8965 secs
2025-03-13 16:54:17,596 [INFO]: {
2025-03-13 16:54:17,596 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:17,596 [INFO]: 	index_param: efSearch=244
2025-03-13 16:54:17,596 [INFO]: 	index_path: knn.index
2025-03-13 16:54:17,596 [INFO]: 	size in bytes: 831636850
2025-03-13 16:54:17,596 [INFO]: 	avg_search_speed_ms: 14.270260289029753
2025-03-13 16:54:17,596 [INFO]: 	99p_search_speed_ms: 21.798675879836082
2025-03-13 16:54:17,596 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:17,596 [INFO]: 	nb vectors: 4227
2025-03-13 16:54:17,596 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:17,596 [INFO]: 	compression ratio: 0.999308792052685
2025-03-13 16:54:17,596 [INFO]: }
2025-03-13 16:54:17,596 [INFO]: 	>>> Finished "Creating the index" in 75.9003 secs
2025-03-13 16:54:17,596 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9328 secs
2025-03-13 16:54:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 89619 [episode count 1/20]
[retrieval_preprocessing] for episode 2588 [episode count 2/20], we have num_retrieval=np.int64(4190) num_query=np.int64(254)
2025-03-13 16:54:20,400 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:21,051 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:21
2025-03-13 16:54:21,051 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-13 16:54:21,089 [INFO]: There are 4190 embeddings of dim 49152
2025-03-13 16:54:21,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0388 secs
2025-03-13 16:54:21,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:21
2025-03-13 16:54:21,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:21,090 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:54:21,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:21,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:54:21,091 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:21
2025-03-13 16:54:21,091 [INFO]: 864.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:21,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:54:21,091 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:21
2025-03-13 16:54:21,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:21,091 [INFO]: 	Creating the index 03/13/2025, 16:54:21
2025-03-13 16:54:21,092 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:21
2025-03-13 16:54:21,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 16:54:21,094 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:21
2025-03-13 16:54:21,094 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:54:21,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.65it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.12it/s] 59%|█████▉    | 10/17 [00:00<00:00, 31.49it/s] 82%|████████▏ | 14/17 [00:00<00:00, 33.86it/s]100%|██████████| 17/17 [00:04<00:00,  3.63it/s]
2025-03-13 16:54:25,783 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:25
2025-03-13 16:55:08,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5363 secs
2025-03-13 16:55:08,320 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:55:08,320 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 16:55:36,525 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2045 secs
2025-03-13 16:55:36,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4333 secs
2025-03-13 16:55:36,528 [INFO]: {
2025-03-13 16:55:36,528 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:36,528 [INFO]: 	index_param: efSearch=212
2025-03-13 16:55:36,528 [INFO]: 	index_path: knn.index
2025-03-13 16:55:36,528 [INFO]: 	size in bytes: 824357350
2025-03-13 16:55:36,528 [INFO]: 	avg_search_speed_ms: 8.538416313623053
2025-03-13 16:55:36,528 [INFO]: 	99p_search_speed_ms: 11.779657332226632
2025-03-13 16:55:36,528 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:36,528 [INFO]: 	nb vectors: 4190
2025-03-13 16:55:36,528 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:36,528 [INFO]: 	compression ratio: 0.9993087585135257
2025-03-13 16:55:36,528 [INFO]: }
2025-03-13 16:55:36,528 [INFO]: 	>>> Finished "Creating the index" in 75.4364 secs
2025-03-13 16:55:36,528 [INFO]: >>> Finished "Launching the whole pipeline" in 75.4771 secs
2025-03-13 16:55:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 2588 [episode count 2/20]
[retrieval_preprocessing] for episode 67068 [episode count 3/20], we have num_retrieval=np.int64(4203) num_query=np.int64(241)
2025-03-13 16:55:38,691 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:39,450 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:39
2025-03-13 16:55:39,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1636.48it/s]
2025-03-13 16:55:39,480 [INFO]: There are 4203 embeddings of dim 49152
2025-03-13 16:55:39,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:55:39,481 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:39
2025-03-13 16:55:39,481 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:39,481 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:55:39,482 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:39,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:55:39,482 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:39
2025-03-13 16:55:39,482 [INFO]: 867.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:39,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:55:39,483 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:39
2025-03-13 16:55:39,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:39,483 [INFO]: 	Creating the index 03/13/2025, 16:55:39
2025-03-13 16:55:39,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:39
2025-03-13 16:55:39,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:55:39,487 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:39
2025-03-13 16:55:39,487 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:55:39,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.48it/s] 41%|████      | 7/17 [00:00<00:00, 36.94it/s] 71%|███████   | 12/17 [00:00<00:00, 39.93it/s]100%|██████████| 17/17 [00:03<00:00,  3.83it/s]100%|██████████| 17/17 [00:03<00:00,  5.33it/s]
2025-03-13 16:55:42,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:42
2025-03-13 16:56:22,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6525 secs
2025-03-13 16:56:22,337 [INFO]: The best hyperparameters are: efSearch=360
2025-03-13 16:56:22,337 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.32it/s]
2025-03-13 16:57:07,753 [INFO]: 	>>> Finished "Compute fast metrics" in 45.4164 secs
2025-03-13 16:57:07,756 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.2693 secs
2025-03-13 16:57:07,756 [INFO]: {
2025-03-13 16:57:07,757 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:07,757 [INFO]: 	index_param: efSearch=360
2025-03-13 16:57:07,757 [INFO]: 	index_path: knn.index
2025-03-13 16:57:07,757 [INFO]: 	size in bytes: 826914970
2025-03-13 16:57:07,757 [INFO]: 	avg_search_speed_ms: 15.11894886591542
2025-03-13 16:57:07,757 [INFO]: 	99p_search_speed_ms: 19.802262410521507
2025-03-13 16:57:07,757 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:07,757 [INFO]: 	nb vectors: 4203
2025-03-13 16:57:07,757 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:07,757 [INFO]: 	compression ratio: 0.9993088213169004
2025-03-13 16:57:07,757 [INFO]: }
2025-03-13 16:57:07,757 [INFO]: 	>>> Finished "Creating the index" in 88.2731 secs
2025-03-13 16:57:07,757 [INFO]: >>> Finished "Launching the whole pipeline" in 88.3063 secs
2025-03-13 16:57:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 67068 [episode count 3/20]
[retrieval_preprocessing] for episode 69155 [episode count 4/20], we have num_retrieval=np.int64(4138) num_query=np.int64(306)
2025-03-13 16:57:13,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:14,128 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:14
2025-03-13 16:57:14,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-13 16:57:14,153 [INFO]: There are 4138 embeddings of dim 49152
2025-03-13 16:57:14,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 16:57:14,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:14
2025-03-13 16:57:14,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:14,153 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:57:14,153 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:14,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:14,153 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:14
2025-03-13 16:57:14,153 [INFO]: 854.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:14,153 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:57:14,153 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:14
2025-03-13 16:57:14,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:14,154 [INFO]: 	Creating the index 03/13/2025, 16:57:14
2025-03-13 16:57:14,154 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:14
2025-03-13 16:57:14,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:57:14,155 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:14
2025-03-13 16:57:14,155 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:57:14,155 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.10it/s] 24%|██▎       | 4/17 [00:00<00:00, 16.07it/s] 47%|████▋     | 8/17 [00:00<00:00, 24.53it/s] 71%|███████   | 12/17 [00:00<00:00, 28.88it/s] 94%|█████████▍| 16/17 [00:00<00:00, 31.33it/s]100%|██████████| 17/17 [00:04<00:00,  3.43it/s]
2025-03-13 16:57:19,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:19
2025-03-13 16:58:13,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7043 secs
2025-03-13 16:58:13,825 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 16:58:13,826 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.58it/s]
2025-03-13 16:58:35,602 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7758 secs
2025-03-13 16:58:35,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4498 secs
2025-03-13 16:58:35,605 [INFO]: {
2025-03-13 16:58:35,605 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:35,605 [INFO]: 	index_param: efSearch=243
2025-03-13 16:58:35,605 [INFO]: 	index_path: knn.index
2025-03-13 16:58:35,605 [INFO]: 	size in bytes: 814126750
2025-03-13 16:58:35,605 [INFO]: 	avg_search_speed_ms: 11.183172341965356
2025-03-13 16:58:35,605 [INFO]: 	99p_search_speed_ms: 18.08833434013649
2025-03-13 16:58:35,605 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:35,605 [INFO]: 	nb vectors: 4138
2025-03-13 16:58:35,605 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:35,605 [INFO]: 	compression ratio: 0.9993086506493
2025-03-13 16:58:35,605 [INFO]: }
2025-03-13 16:58:35,605 [INFO]: 	>>> Finished "Creating the index" in 81.4514 secs
2025-03-13 16:58:35,605 [INFO]: >>> Finished "Launching the whole pipeline" in 81.4767 secs
2025-03-13 16:58:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 69155 [episode count 4/20]
[retrieval_preprocessing] for episode 3682 [episode count 5/20], we have num_retrieval=np.int64(4251) num_query=np.int64(193)
2025-03-13 16:58:38,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:39,480 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:39
2025-03-13 16:58:39,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.24it/s]
2025-03-13 16:58:39,507 [INFO]: There are 4251 embeddings of dim 49152
2025-03-13 16:58:39,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 16:58:39,507 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:39,507 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:58:39,507 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:39,507 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:39,507 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,507 [INFO]: 877.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:39,507 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:39,507 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:39
2025-03-13 16:58:39,507 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:39,508 [INFO]: 	Creating the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:39
2025-03-13 16:58:39,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:58:39,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:39
2025-03-13 16:58:39,509 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:58:39,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.72it/s] 41%|████      | 7/17 [00:00<00:00, 35.44it/s] 71%|███████   | 12/17 [00:00<00:00, 40.44it/s]100%|██████████| 17/17 [00:04<00:00,  2.92it/s]100%|██████████| 17/17 [00:04<00:00,  4.11it/s]
2025-03-13 16:58:43,652 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:43
2025-03-13 16:59:24,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7033 secs
2025-03-13 16:59:24,356 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 16:59:24,356 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.06it/s]
2025-03-13 16:59:48,615 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2591 secs
2025-03-13 16:59:48,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1092 secs
2025-03-13 16:59:48,618 [INFO]: {
2025-03-13 16:59:48,618 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:48,618 [INFO]: 	index_param: efSearch=303
2025-03-13 16:59:48,618 [INFO]: 	index_path: knn.index
2025-03-13 16:59:48,618 [INFO]: 	size in bytes: 836358790
2025-03-13 16:59:48,619 [INFO]: 	avg_search_speed_ms: 12.86985667750834
2025-03-13 16:59:48,619 [INFO]: 	99p_search_speed_ms: 18.66672645322979
2025-03-13 16:59:48,619 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:48,619 [INFO]: 	nb vectors: 4251
2025-03-13 16:59:48,619 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:48,619 [INFO]: 	compression ratio: 0.99930869142895
2025-03-13 16:59:48,619 [INFO]: }
2025-03-13 16:59:48,619 [INFO]: 	>>> Finished "Creating the index" in 69.1111 secs
2025-03-13 16:59:48,619 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1387 secs
2025-03-13 16:59:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 3682 [episode count 5/20]
[retrieval_preprocessing] for episode 1637 [episode count 6/20], we have num_retrieval=np.int64(4134) num_query=np.int64(310)
2025-03-13 16:59:52,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:53,556 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:53
2025-03-13 16:59:53,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.77it/s]
2025-03-13 16:59:53,586 [INFO]: There are 4134 embeddings of dim 49152
2025-03-13 16:59:53,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:59:53,587 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:53
2025-03-13 16:59:53,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:53,587 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 16:59:53,587 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:53,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:53,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:53
2025-03-13 16:59:53,587 [INFO]: 853.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:53,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:53,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:53
2025-03-13 16:59:53,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:53,587 [INFO]: 	Creating the index 03/13/2025, 16:59:53
2025-03-13 16:59:53,587 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:53
2025-03-13 16:59:53,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:59:53,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:53
2025-03-13 16:59:53,589 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 16:59:53,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.31it/s] 41%|████      | 7/17 [00:00<00:00, 32.38it/s] 71%|███████   | 12/17 [00:00<00:00, 37.83it/s]100%|██████████| 17/17 [00:03<00:00,  3.50it/s]100%|██████████| 17/17 [00:03<00:00,  4.86it/s]
2025-03-13 16:59:57,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:57
2025-03-13 17:00:43,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9352 secs
2025-03-13 17:00:43,030 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 17:00:43,030 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 17:01:16,611 [INFO]: 	>>> Finished "Compute fast metrics" in 33.5810 secs
2025-03-13 17:01:16,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0249 secs
2025-03-13 17:01:16,614 [INFO]: {
2025-03-13 17:01:16,614 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:16,614 [INFO]: 	index_param: efSearch=280
2025-03-13 17:01:16,614 [INFO]: 	index_path: knn.index
2025-03-13 17:01:16,614 [INFO]: 	size in bytes: 813339790
2025-03-13 17:01:16,614 [INFO]: 	avg_search_speed_ms: 12.321353114090787
2025-03-13 17:01:16,614 [INFO]: 	99p_search_speed_ms: 18.476474850904193
2025-03-13 17:01:16,614 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:16,614 [INFO]: 	nb vectors: 4134
2025-03-13 17:01:16,614 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:16,614 [INFO]: 	compression ratio: 0.9993086308982867
2025-03-13 17:01:16,614 [INFO]: }
2025-03-13 17:01:16,614 [INFO]: 	>>> Finished "Creating the index" in 83.0267 secs
2025-03-13 17:01:16,614 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0581 secs
2025-03-13 17:01:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 1637 [episode count 6/20]
[retrieval_preprocessing] for episode 25222 [episode count 7/20], we have num_retrieval=np.int64(4249) num_query=np.int64(195)
2025-03-13 17:01:20,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:20,929 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:20
2025-03-13 17:01:20,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.83it/s]
2025-03-13 17:01:20,957 [INFO]: There are 4249 embeddings of dim 49152
2025-03-13 17:01:20,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:01:20,958 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:20
2025-03-13 17:01:20,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:20,958 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:01:20,958 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:20,958 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:01:20,958 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:20
2025-03-13 17:01:20,958 [INFO]: 876.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:20,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:01:20,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:20
2025-03-13 17:01:20,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:20,958 [INFO]: 	Creating the index 03/13/2025, 17:01:20
2025-03-13 17:01:20,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:20
2025-03-13 17:01:20,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:01:20,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:20
2025-03-13 17:01:20,959 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:01:20,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.27it/s] 29%|██▉       | 5/17 [00:00<00:00, 23.61it/s] 53%|█████▎    | 9/17 [00:00<00:00, 29.38it/s] 82%|████████▏ | 14/17 [00:00<00:00, 34.60it/s]100%|██████████| 17/17 [00:03<00:00,  4.58it/s]
2025-03-13 17:01:24,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:24
2025-03-13 17:02:09,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4702 secs
2025-03-13 17:02:09,146 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:02:09,146 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-13 17:02:32,242 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0957 secs
2025-03-13 17:02:32,246 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2866 secs
2025-03-13 17:02:32,247 [INFO]: {
2025-03-13 17:02:32,247 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:32,247 [INFO]: 	index_param: efSearch=195
2025-03-13 17:02:32,247 [INFO]: 	index_path: knn.index
2025-03-13 17:02:32,247 [INFO]: 	size in bytes: 835965310
2025-03-13 17:02:32,247 [INFO]: 	avg_search_speed_ms: 12.402182094531485
2025-03-13 17:02:32,247 [INFO]: 	99p_search_speed_ms: 23.587103413883586
2025-03-13 17:02:32,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:32,247 [INFO]: 	nb vectors: 4249
2025-03-13 17:02:32,247 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:32,247 [INFO]: 	compression ratio: 0.9993086818399199
2025-03-13 17:02:32,247 [INFO]: }
2025-03-13 17:02:32,247 [INFO]: 	>>> Finished "Creating the index" in 71.2890 secs
2025-03-13 17:02:32,247 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3177 secs
2025-03-13 17:02:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 25222 [episode count 7/20]
[retrieval_preprocessing] for episode 16585 [episode count 8/20], we have num_retrieval=np.int64(4240) num_query=np.int64(204)
2025-03-13 17:02:34,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:35,724 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:35
2025-03-13 17:02:35,724 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.90it/s]
2025-03-13 17:02:35,752 [INFO]: There are 4240 embeddings of dim 49152
2025-03-13 17:02:35,753 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 17:02:35,753 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:35
2025-03-13 17:02:35,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:35,754 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:02:35,754 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:35,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:02:35,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:35
2025-03-13 17:02:35,755 [INFO]: 875.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:35,755 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:02:35,755 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:35
2025-03-13 17:02:35,755 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:35,755 [INFO]: 	Creating the index 03/13/2025, 17:02:35
2025-03-13 17:02:35,756 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:35
2025-03-13 17:02:35,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:02:35,759 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:35
2025-03-13 17:02:35,759 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:02:35,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.35it/s] 41%|████      | 7/17 [00:00<00:00, 31.25it/s] 71%|███████   | 12/17 [00:00<00:00, 36.19it/s]100%|██████████| 17/17 [00:04<00:00,  2.76it/s]100%|██████████| 17/17 [00:04<00:00,  3.87it/s]
2025-03-13 17:02:40,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:40
2025-03-13 17:03:27,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7742 secs
2025-03-13 17:03:27,133 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 17:03:27,133 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-13 17:03:54,534 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4009 secs
2025-03-13 17:03:54,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7775 secs
2025-03-13 17:03:54,537 [INFO]: {
2025-03-13 17:03:54,537 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:54,537 [INFO]: 	index_param: efSearch=292
2025-03-13 17:03:54,537 [INFO]: 	index_path: knn.index
2025-03-13 17:03:54,537 [INFO]: 	size in bytes: 834194650
2025-03-13 17:03:54,537 [INFO]: 	avg_search_speed_ms: 11.022401817188094
2025-03-13 17:03:54,537 [INFO]: 	99p_search_speed_ms: 15.716333908494562
2025-03-13 17:03:54,537 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:54,537 [INFO]: 	nb vectors: 4240
2025-03-13 17:03:54,537 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:54,537 [INFO]: 	compression ratio: 0.9993086385773392
2025-03-13 17:03:54,537 [INFO]: }
2025-03-13 17:03:54,537 [INFO]: 	>>> Finished "Creating the index" in 78.7816 secs
2025-03-13 17:03:54,537 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8135 secs
2025-03-13 17:03:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 16585 [episode count 8/20]
[retrieval_preprocessing] for episode 45795 [episode count 9/20], we have num_retrieval=np.int64(4234) num_query=np.int64(210)
2025-03-13 17:03:57,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:57,986 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:57
2025-03-13 17:03:57,986 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.25it/s]
2025-03-13 17:03:58,014 [INFO]: There are 4234 embeddings of dim 49152
2025-03-13 17:03:58,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:03:58,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:58
2025-03-13 17:03:58,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:58,015 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:03:58,015 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:58,015 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:03:58,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:58
2025-03-13 17:03:58,016 [INFO]: 873.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:58,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:03:58,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:58
2025-03-13 17:03:58,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:58,017 [INFO]: 	Creating the index 03/13/2025, 17:03:58
2025-03-13 17:03:58,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:58
2025-03-13 17:03:58,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:03:58,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:58
2025-03-13 17:03:58,021 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:03:58,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.38it/s] 41%|████      | 7/17 [00:00<00:00, 35.95it/s] 71%|███████   | 12/17 [00:00<00:00, 41.16it/s]100%|██████████| 17/17 [00:03<00:00,  3.90it/s]100%|██████████| 17/17 [00:03<00:00,  5.42it/s]
2025-03-13 17:04:01,162 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:01
2025-03-13 17:04:48,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6716 secs
2025-03-13 17:04:48,835 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 17:04:48,835 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-13 17:05:31,476 [INFO]: 	>>> Finished "Compute fast metrics" in 42.6409 secs
2025-03-13 17:05:31,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.4583 secs
2025-03-13 17:05:31,479 [INFO]: {
2025-03-13 17:05:31,479 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:31,479 [INFO]: 	index_param: efSearch=253
2025-03-13 17:05:31,479 [INFO]: 	index_path: knn.index
2025-03-13 17:05:31,479 [INFO]: 	size in bytes: 833014090
2025-03-13 17:05:31,479 [INFO]: 	avg_search_speed_ms: 8.683102432163045
2025-03-13 17:05:31,479 [INFO]: 	99p_search_speed_ms: 11.768450040835887
2025-03-13 17:05:31,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:31,479 [INFO]: 	nb vectors: 4234
2025-03-13 17:05:31,479 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:31,479 [INFO]: 	compression ratio: 0.9993087535890299
2025-03-13 17:05:31,479 [INFO]: }
2025-03-13 17:05:31,479 [INFO]: 	>>> Finished "Creating the index" in 93.4624 secs
2025-03-13 17:05:31,479 [INFO]: >>> Finished "Launching the whole pipeline" in 93.4934 secs
2025-03-13 17:05:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 45795 [episode count 9/20]
[retrieval_preprocessing] for episode 31025 [episode count 10/20], we have num_retrieval=np.int64(4252) num_query=np.int64(192)
2025-03-13 17:05:33,919 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:34,864 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:34
2025-03-13 17:05:34,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1142.24it/s]
2025-03-13 17:05:34,892 [INFO]: There are 4252 embeddings of dim 49152
2025-03-13 17:05:34,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:05:34,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:34,893 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:05:34,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:34,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:05:34,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,893 [INFO]: 877.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:34,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:34,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:34
2025-03-13 17:05:34,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:34,893 [INFO]: 	Creating the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:34
2025-03-13 17:05:34,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:05:34,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:34
2025-03-13 17:05:34,895 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:05:34,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.98it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.24it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.53it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.10it/s]100%|██████████| 17/17 [00:04<00:00,  4.03it/s]
2025-03-13 17:05:39,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:39
2025-03-13 17:06:22,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0839 secs
2025-03-13 17:06:22,445 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 17:06:22,445 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.84it/s]
2025-03-13 17:06:45,996 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5510 secs
2025-03-13 17:06:45,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1042 secs
2025-03-13 17:06:46,000 [INFO]: {
2025-03-13 17:06:46,000 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:46,000 [INFO]: 	index_param: efSearch=158
2025-03-13 17:06:46,000 [INFO]: 	index_path: knn.index
2025-03-13 17:06:46,000 [INFO]: 	size in bytes: 836555530
2025-03-13 17:06:46,000 [INFO]: 	avg_search_speed_ms: 8.113518988867835
2025-03-13 17:06:46,000 [INFO]: 	99p_search_speed_ms: 11.501656302716587
2025-03-13 17:06:46,000 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:46,000 [INFO]: 	nb vectors: 4252
2025-03-13 17:06:46,000 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:46,000 [INFO]: 	compression ratio: 0.9993086962200823
2025-03-13 17:06:46,000 [INFO]: }
2025-03-13 17:06:46,000 [INFO]: 	>>> Finished "Creating the index" in 71.1064 secs
2025-03-13 17:06:46,000 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1359 secs
2025-03-13 17:06:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 31025 [episode count 10/20]
[retrieval_preprocessing] for episode 21424 [episode count 11/20], we have num_retrieval=np.int64(4228) num_query=np.int64(216)
2025-03-13 17:06:48,662 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:49,430 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:49
2025-03-13 17:06:49,430 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.84it/s]
2025-03-13 17:06:49,460 [INFO]: There are 4228 embeddings of dim 49152
2025-03-13 17:06:49,461 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:06:49,461 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,461 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:49,462 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:06:49,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:49,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:06:49,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,462 [INFO]: 872.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:49,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:06:49,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:49
2025-03-13 17:06:49,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:49,463 [INFO]: 	Creating the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,463 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:49
2025-03-13 17:06:49,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:06:49,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:49
2025-03-13 17:06:49,467 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:06:49,467 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.29it/s] 29%|██▉       | 5/17 [00:00<00:00, 25.76it/s] 53%|█████▎    | 9/17 [00:00<00:00, 31.07it/s] 76%|███████▋  | 13/17 [00:00<00:00, 33.42it/s]100%|██████████| 17/17 [00:04<00:00,  2.54it/s]100%|██████████| 17/17 [00:04<00:00,  3.94it/s]
2025-03-13 17:06:53,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:53
2025-03-13 17:07:37,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1282 secs
2025-03-13 17:07:37,921 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 17:07:37,921 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.37it/s]
2025-03-13 17:08:24,109 [INFO]: 	>>> Finished "Compute fast metrics" in 46.1878 secs
2025-03-13 17:08:24,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.2088 secs
2025-03-13 17:08:24,676 [INFO]: {
2025-03-13 17:08:24,676 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:24,676 [INFO]: 	index_param: efSearch=315
2025-03-13 17:08:24,676 [INFO]: 	index_path: knn.index
2025-03-13 17:08:24,676 [INFO]: 	size in bytes: 831833590
2025-03-13 17:08:24,676 [INFO]: 	avg_search_speed_ms: 13.699328656984518
2025-03-13 17:08:24,677 [INFO]: 	99p_search_speed_ms: 19.641263943631206
2025-03-13 17:08:24,677 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:24,677 [INFO]: 	nb vectors: 4228
2025-03-13 17:08:24,677 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:24,677 [INFO]: 	compression ratio: 0.9993087968472155
2025-03-13 17:08:24,677 [INFO]: }
2025-03-13 17:08:24,677 [INFO]: 	>>> Finished "Creating the index" in 95.2137 secs
2025-03-13 17:08:24,677 [INFO]: >>> Finished "Launching the whole pipeline" in 95.2467 secs
2025-03-13 17:08:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 21424 [episode count 11/20]
[retrieval_preprocessing] for episode 67524 [episode count 12/20], we have num_retrieval=np.int64(4208) num_query=np.int64(236)
2025-03-13 17:08:28,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:29,162 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:29
2025-03-13 17:08:29,162 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 950.87it/s]
2025-03-13 17:08:29,197 [INFO]: There are 4208 embeddings of dim 49152
2025-03-13 17:08:29,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-13 17:08:29,198 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:29,199 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:08:29,199 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:29,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:08:29,199 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,199 [INFO]: 868.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:29,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:08:29,200 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:29
2025-03-13 17:08:29,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:29,200 [INFO]: 	Creating the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,200 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:29
2025-03-13 17:08:29,204 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 17:08:29,204 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:29
2025-03-13 17:08:29,204 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:08:29,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.96it/s] 41%|████      | 7/17 [00:00<00:00, 32.18it/s] 71%|███████   | 12/17 [00:00<00:00, 37.28it/s]100%|██████████| 17/17 [00:05<00:00,  2.40it/s]100%|██████████| 17/17 [00:05<00:00,  3.38it/s]
2025-03-13 17:08:34,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:34
2025-03-13 17:09:18,827 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1086 secs
2025-03-13 17:09:18,828 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 17:09:18,828 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.20it/s]
2025-03-13 17:09:51,854 [INFO]: 	>>> Finished "Compute fast metrics" in 33.0259 secs
2025-03-13 17:09:51,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6523 secs
2025-03-13 17:09:51,857 [INFO]: {
2025-03-13 17:09:51,857 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:51,857 [INFO]: 	index_param: efSearch=202
2025-03-13 17:09:51,857 [INFO]: 	index_path: knn.index
2025-03-13 17:09:51,857 [INFO]: 	size in bytes: 827898730
2025-03-13 17:09:51,857 [INFO]: 	avg_search_speed_ms: 8.054049267552061
2025-03-13 17:09:51,857 [INFO]: 	99p_search_speed_ms: 11.14892006851732
2025-03-13 17:09:51,857 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:51,857 [INFO]: 	nb vectors: 4208
2025-03-13 17:09:51,857 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:51,857 [INFO]: 	compression ratio: 0.999308772946179
2025-03-13 17:09:51,857 [INFO]: }
2025-03-13 17:09:51,857 [INFO]: 	>>> Finished "Creating the index" in 82.6566 secs
2025-03-13 17:09:51,857 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6946 secs
2025-03-13 17:09:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 67524 [episode count 12/20]
[retrieval_preprocessing] for episode 2516 [episode count 13/20], we have num_retrieval=np.int64(4219) num_query=np.int64(225)
2025-03-13 17:09:53,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:54,530 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:54
2025-03-13 17:09:54,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.22it/s]
2025-03-13 17:09:54,555 [INFO]: There are 4219 embeddings of dim 49152
2025-03-13 17:09:54,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:09:54,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:54
2025-03-13 17:09:54,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:54,555 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:09:54,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:54,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:54,556 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:54
2025-03-13 17:09:54,556 [INFO]: 870.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:54,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:09:54,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:54
2025-03-13 17:09:54,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:54,556 [INFO]: 	Creating the index 03/13/2025, 17:09:54
2025-03-13 17:09:54,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:54
2025-03-13 17:09:54,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:09:54,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:54
2025-03-13 17:09:54,557 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:09:54,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.80it/s] 47%|████▋     | 8/17 [00:00<00:00, 36.70it/s] 82%|████████▏ | 14/17 [00:00<00:00, 43.56it/s]100%|██████████| 17/17 [00:03<00:00,  4.35it/s]
2025-03-13 17:09:58,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:58
2025-03-13 17:10:38,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2471 secs
2025-03-13 17:10:38,716 [INFO]: The best hyperparameters are: efSearch=325
2025-03-13 17:10:38,716 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 17:11:27,219 [INFO]: 	>>> Finished "Compute fast metrics" in 48.5031 secs
2025-03-13 17:11:27,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.6652 secs
2025-03-13 17:11:27,223 [INFO]: {
2025-03-13 17:11:27,223 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:27,223 [INFO]: 	index_param: efSearch=325
2025-03-13 17:11:27,223 [INFO]: 	index_path: knn.index
2025-03-13 17:11:27,223 [INFO]: 	size in bytes: 830062930
2025-03-13 17:11:27,223 [INFO]: 	avg_search_speed_ms: 14.047388892210078
2025-03-13 17:11:27,223 [INFO]: 	99p_search_speed_ms: 19.552772531751543
2025-03-13 17:11:27,223 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:27,223 [INFO]: 	nb vectors: 4219
2025-03-13 17:11:27,223 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:27,223 [INFO]: 	compression ratio: 0.9993087536146206
2025-03-13 17:11:27,223 [INFO]: }
2025-03-13 17:11:27,223 [INFO]: 	>>> Finished "Creating the index" in 92.6668 secs
2025-03-13 17:11:27,223 [INFO]: >>> Finished "Launching the whole pipeline" in 92.6931 secs
2025-03-13 17:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 2516 [episode count 13/20]
[retrieval_preprocessing] for episode 74494 [episode count 14/20], we have num_retrieval=np.int64(4212) num_query=np.int64(232)
2025-03-13 17:11:30,496 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:31,647 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:31
2025-03-13 17:11:31,647 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 17:11:31,675 [INFO]: There are 4212 embeddings of dim 49152
2025-03-13 17:11:31,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 17:11:31,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:31
2025-03-13 17:11:31,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:31,676 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:11:31,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:31,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:11:31,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:31
2025-03-13 17:11:31,676 [INFO]: 869.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:31,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:11:31,677 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:31
2025-03-13 17:11:31,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:31,677 [INFO]: 	Creating the index 03/13/2025, 17:11:31
2025-03-13 17:11:31,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:31
2025-03-13 17:11:31,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:11:31,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:31
2025-03-13 17:11:31,678 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:11:31,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.62it/s] 29%|██▉       | 5/17 [00:00<00:00, 21.78it/s] 53%|█████▎    | 9/17 [00:00<00:00, 26.89it/s] 76%|███████▋  | 13/17 [00:00<00:00, 29.47it/s]100%|██████████| 17/17 [00:04<00:00,  2.34it/s]100%|██████████| 17/17 [00:04<00:00,  3.61it/s]
2025-03-13 17:11:36,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:36
2025-03-13 17:12:29,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.8931 secs
2025-03-13 17:12:29,283 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:12:29,284 [INFO]: 	Compute fast metrics 03/13/2025, 17:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.72it/s]
2025-03-13 17:12:58,735 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4516 secs
2025-03-13 17:12:58,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0601 secs
2025-03-13 17:12:58,738 [INFO]: {
2025-03-13 17:12:58,738 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:58,738 [INFO]: 	index_param: efSearch=235
2025-03-13 17:12:58,738 [INFO]: 	index_path: knn.index
2025-03-13 17:12:58,738 [INFO]: 	size in bytes: 828685690
2025-03-13 17:12:58,738 [INFO]: 	avg_search_speed_ms: 10.12356348876815
2025-03-13 17:12:58,738 [INFO]: 	99p_search_speed_ms: 13.937106812372804
2025-03-13 17:12:58,738 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:58,738 [INFO]: 	nb vectors: 4212
2025-03-13 17:12:58,738 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:58,738 [INFO]: 	compression ratio: 0.999308792215297
2025-03-13 17:12:58,739 [INFO]: }
2025-03-13 17:12:58,739 [INFO]: 	>>> Finished "Creating the index" in 87.0619 secs
2025-03-13 17:12:58,739 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0918 secs
2025-03-13 17:13:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 74494 [episode count 14/20]
[retrieval_preprocessing] for episode 58339 [episode count 15/20], we have num_retrieval=np.int64(4220) num_query=np.int64(224)
2025-03-13 17:13:02,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:02,977 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:02
2025-03-13 17:13:02,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.53it/s]
2025-03-13 17:13:03,006 [INFO]: There are 4220 embeddings of dim 49152
2025-03-13 17:13:03,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:13:03,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:03
2025-03-13 17:13:03,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:03,006 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:13:03,006 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:03,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:03,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:03
2025-03-13 17:13:03,006 [INFO]: 870.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:03,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:13:03,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:03
2025-03-13 17:13:03,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:03,006 [INFO]: 	Creating the index 03/13/2025, 17:13:03
2025-03-13 17:13:03,007 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:03
2025-03-13 17:13:03,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:13:03,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:03
2025-03-13 17:13:03,008 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:13:03,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.29it/s] 35%|███▌      | 6/17 [00:00<00:00, 24.77it/s] 65%|██████▍   | 11/17 [00:00<00:00, 32.07it/s] 94%|█████████▍| 16/17 [00:00<00:00, 35.77it/s]100%|██████████| 17/17 [00:03<00:00,  4.58it/s]
2025-03-13 17:13:06,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:06
2025-03-13 17:13:51,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9979 secs
2025-03-13 17:13:51,723 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:13:51,723 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-13 17:14:20,540 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8164 secs
2025-03-13 17:14:20,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5350 secs
2025-03-13 17:14:20,543 [INFO]: {
2025-03-13 17:14:20,543 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:20,543 [INFO]: 	index_param: efSearch=234
2025-03-13 17:14:20,543 [INFO]: 	index_path: knn.index
2025-03-13 17:14:20,543 [INFO]: 	size in bytes: 830259670
2025-03-13 17:14:20,543 [INFO]: 	avg_search_speed_ms: 10.825978087067798
2025-03-13 17:14:20,543 [INFO]: 	99p_search_speed_ms: 15.274420268833635
2025-03-13 17:14:20,543 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:20,543 [INFO]: 	nb vectors: 4220
2025-03-13 17:14:20,543 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:20,543 [INFO]: 	compression ratio: 0.9993087584273485
2025-03-13 17:14:20,543 [INFO]: }
2025-03-13 17:14:20,543 [INFO]: 	>>> Finished "Creating the index" in 77.5366 secs
2025-03-13 17:14:20,543 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5657 secs
2025-03-13 17:14:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 58339 [episode count 15/20]
[retrieval_preprocessing] for episode 22290 [episode count 16/20], we have num_retrieval=np.int64(4277) num_query=np.int64(167)
2025-03-13 17:14:23,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:24,832 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:24
2025-03-13 17:14:24,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 848.36it/s]
2025-03-13 17:14:24,862 [INFO]: There are 4277 embeddings of dim 49152
2025-03-13 17:14:24,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 17:14:24,863 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:24
2025-03-13 17:14:24,863 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:24,863 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:14:24,863 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:24,863 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:14:24,864 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:24
2025-03-13 17:14:24,864 [INFO]: 882.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:24,864 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:14:24,864 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:24
2025-03-13 17:14:24,864 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:24,864 [INFO]: 	Creating the index 03/13/2025, 17:14:24
2025-03-13 17:14:24,864 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:24
2025-03-13 17:14:24,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 17:14:24,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:24
2025-03-13 17:14:24,866 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:14:24,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.18it/s] 41%|████      | 7/17 [00:00<00:00, 31.63it/s] 71%|███████   | 12/17 [00:00<00:00, 37.73it/s]100%|██████████| 17/17 [00:04<00:00,  2.68it/s]100%|██████████| 17/17 [00:04<00:00,  3.76it/s]
2025-03-13 17:14:29,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:29
2025-03-13 17:15:17,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6609 secs
2025-03-13 17:15:17,051 [INFO]: The best hyperparameters are: efSearch=349
2025-03-13 17:15:17,051 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 17:15:54,091 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0395 secs
2025-03-13 17:15:54,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.8879 secs
2025-03-13 17:15:54,755 [INFO]: {
2025-03-13 17:15:54,755 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:54,755 [INFO]: 	index_param: efSearch=349
2025-03-13 17:15:54,755 [INFO]: 	index_path: knn.index
2025-03-13 17:15:54,755 [INFO]: 	size in bytes: 841474090
2025-03-13 17:15:54,755 [INFO]: 	avg_search_speed_ms: 13.987097135009048
2025-03-13 17:15:54,755 [INFO]: 	99p_search_speed_ms: 18.74753100797534
2025-03-13 17:15:54,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:54,755 [INFO]: 	nb vectors: 4277
2025-03-13 17:15:54,755 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:54,755 [INFO]: 	compression ratio: 0.999308744016111
2025-03-13 17:15:54,755 [INFO]: }
2025-03-13 17:15:54,755 [INFO]: 	>>> Finished "Creating the index" in 89.8913 secs
2025-03-13 17:15:54,755 [INFO]: >>> Finished "Launching the whole pipeline" in 89.9238 secs
2025-03-13 17:15:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 22290 [episode count 16/20]
[retrieval_preprocessing] for episode 62233 [episode count 17/20], we have num_retrieval=np.int64(4229) num_query=np.int64(215)
2025-03-13 17:15:59,683 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:00,656 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:00
2025-03-13 17:16:00,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.90it/s]
2025-03-13 17:16:00,683 [INFO]: There are 4229 embeddings of dim 49152
2025-03-13 17:16:00,684 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 17:16:00,684 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:00
2025-03-13 17:16:00,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:00,684 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:16:00,684 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:00,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:00,684 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:00
2025-03-13 17:16:00,684 [INFO]: 872.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:00,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:16:00,684 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:00
2025-03-13 17:16:00,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:00,684 [INFO]: 	Creating the index 03/13/2025, 17:16:00
2025-03-13 17:16:00,684 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:00
2025-03-13 17:16:00,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:16:00,685 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:00
2025-03-13 17:16:00,685 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:16:00,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.48it/s] 29%|██▉       | 5/17 [00:00<00:00, 21.48it/s] 53%|█████▎    | 9/17 [00:00<00:00, 27.82it/s] 76%|███████▋  | 13/17 [00:00<00:00, 31.01it/s]100%|██████████| 17/17 [00:04<00:00,  2.50it/s]100%|██████████| 17/17 [00:04<00:00,  3.84it/s]
2025-03-13 17:16:05,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:05
2025-03-13 17:16:51,104 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9845 secs
2025-03-13 17:16:51,104 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 17:16:51,105 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 17:17:16,648 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5435 secs
2025-03-13 17:17:16,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9657 secs
2025-03-13 17:17:16,651 [INFO]: {
2025-03-13 17:17:16,651 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:16,651 [INFO]: 	index_param: efSearch=160
2025-03-13 17:17:16,651 [INFO]: 	index_path: knn.index
2025-03-13 17:17:16,651 [INFO]: 	size in bytes: 832030330
2025-03-13 17:17:16,651 [INFO]: 	avg_search_speed_ms: 8.528511727686086
2025-03-13 17:17:16,651 [INFO]: 	99p_search_speed_ms: 11.753445873036977
2025-03-13 17:17:16,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:16,651 [INFO]: 	nb vectors: 4229
2025-03-13 17:17:16,651 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:16,651 [INFO]: 	compression ratio: 0.9993088016394787
2025-03-13 17:17:16,651 [INFO]: }
2025-03-13 17:17:16,651 [INFO]: 	>>> Finished "Creating the index" in 75.9671 secs
2025-03-13 17:17:16,651 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9954 secs
2025-03-13 17:17:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 62233 [episode count 17/20]
[retrieval_preprocessing] for episode 48476 [episode count 18/20], we have num_retrieval=np.int64(4239) num_query=np.int64(205)
2025-03-13 17:17:18,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:19,054 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:19
2025-03-13 17:17:19,054 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2032.12it/s]
2025-03-13 17:17:19,081 [INFO]: There are 4239 embeddings of dim 49152
2025-03-13 17:17:19,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:17:19,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:19
2025-03-13 17:17:19,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:19,081 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:17:19,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:19,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:19,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:19
2025-03-13 17:17:19,081 [INFO]: 874.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:19,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:17:19,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:19
2025-03-13 17:17:19,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:19,082 [INFO]: 	Creating the index 03/13/2025, 17:17:19
2025-03-13 17:17:19,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:19
2025-03-13 17:17:19,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:17:19,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:19
2025-03-13 17:17:19,083 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:17:19,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.53it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.95it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.33it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.92it/s]100%|██████████| 17/17 [00:04<00:00,  3.77it/s]
2025-03-13 17:17:23,600 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:23
2025-03-13 17:18:03,430 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8299 secs
2025-03-13 17:18:03,431 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 17:18:03,431 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.16it/s]
2025-03-13 17:18:28,152 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7208 secs
2025-03-13 17:18:28,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.0714 secs
2025-03-13 17:18:28,154 [INFO]: {
2025-03-13 17:18:28,154 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:28,154 [INFO]: 	index_param: efSearch=243
2025-03-13 17:18:28,154 [INFO]: 	index_path: knn.index
2025-03-13 17:18:28,154 [INFO]: 	size in bytes: 833997910
2025-03-13 17:18:28,154 [INFO]: 	avg_search_speed_ms: 11.58678399502523
2025-03-13 17:18:28,154 [INFO]: 	99p_search_speed_ms: 17.476425217464566
2025-03-13 17:18:28,154 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:28,154 [INFO]: 	nb vectors: 4239
2025-03-13 17:18:28,155 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:28,155 [INFO]: 	compression ratio: 0.9993086337590462
2025-03-13 17:18:28,155 [INFO]: }
2025-03-13 17:18:28,155 [INFO]: 	>>> Finished "Creating the index" in 69.0729 secs
2025-03-13 17:18:28,155 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1002 secs
2025-03-13 17:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 48476 [episode count 18/20]
[retrieval_preprocessing] for episode 2398 [episode count 19/20], we have num_retrieval=np.int64(4260) num_query=np.int64(184)
2025-03-13 17:18:30,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:31,056 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:31
2025-03-13 17:18:31,056 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2142.14it/s]
2025-03-13 17:18:31,081 [INFO]: There are 4260 embeddings of dim 49152
2025-03-13 17:18:31,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:18:31,081 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,081 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:31,081 [INFO]: 		-> Add: 2.3 seconds
2025-03-13 17:18:31,081 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:31,081 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:18:31,081 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,082 [INFO]: 879.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:31,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:18:31,082 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:31
2025-03-13 17:18:31,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:31,082 [INFO]: 	Creating the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,082 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:31
2025-03-13 17:18:31,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:18:31,083 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:31
2025-03-13 17:18:31,083 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-13 17:18:31,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.76it/s] 41%|████      | 7/17 [00:00<00:00, 33.87it/s] 71%|███████   | 12/17 [00:00<00:00, 39.90it/s]100%|██████████| 17/17 [00:03<00:00,  3.72it/s]100%|██████████| 17/17 [00:03<00:00,  5.17it/s]
2025-03-13 17:18:34,376 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:34
2025-03-13 17:19:21,388 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0109 secs
2025-03-13 17:19:21,388 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 17:19:21,388 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.53it/s]
2025-03-13 17:19:56,790 [INFO]: 	>>> Finished "Compute fast metrics" in 35.4021 secs
2025-03-13 17:19:56,793 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7102 secs
2025-03-13 17:19:56,793 [INFO]: {
2025-03-13 17:19:56,793 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:56,793 [INFO]: 	index_param: efSearch=232
2025-03-13 17:19:56,793 [INFO]: 	index_path: knn.index
2025-03-13 17:19:56,793 [INFO]: 	size in bytes: 838129450
2025-03-13 17:19:56,793 [INFO]: 	avg_search_speed_ms: 10.199674450964206
2025-03-13 17:19:56,793 [INFO]: 	99p_search_speed_ms: 14.019052591174846
2025-03-13 17:19:56,793 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:56,793 [INFO]: 	nb vectors: 4260
2025-03-13 17:19:56,793 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:56,793 [INFO]: 	compression ratio: 0.999308734468166
2025-03-13 17:19:56,794 [INFO]: }
2025-03-13 17:19:56,794 [INFO]: 	>>> Finished "Creating the index" in 85.7118 secs
2025-03-13 17:19:56,794 [INFO]: >>> Finished "Launching the whole pipeline" in 85.7374 secs
2025-03-13 17:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 2398 [episode count 19/20]
2025-03-13 17:20:01: [retrieval_preprocessing] finished for 2828277154_remove_can_from_sink [chosen_id count 5/196]
2025-03-13 17:20:04: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2828277154_put_can_in_upper_cabinet [chosen_id count 6/196]
2025-03-13 17:20:04: [retrieval_preprocessing] we have num_total=7023 embedding_dim=49152
[retrieval_preprocessing] for episode 17427 [episode count 0/20], we have num_retrieval=np.int64(6657) num_query=np.int64(366)
2025-03-13 17:20:05,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:06,725 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:06
2025-03-13 17:20:06,725 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.73it/s]
2025-03-13 17:20:06,755 [INFO]: There are 6657 embeddings of dim 49152
2025-03-13 17:20:06,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:20:06,756 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:06
2025-03-13 17:20:06,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:06,756 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:20:06,756 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:06,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:06,756 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:06
2025-03-13 17:20:06,756 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:06,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:20:06,756 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:06
2025-03-13 17:20:06,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:06,756 [INFO]: 	Creating the index 03/13/2025, 17:20:06
2025-03-13 17:20:06,756 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:06
2025-03-13 17:20:06,758 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:20:06,758 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:06
2025-03-13 17:20:06,758 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:20:06,758 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  6.02it/s] 18%|█▊        | 5/28 [00:00<00:01, 20.79it/s] 32%|███▏      | 9/28 [00:00<00:00, 26.83it/s] 46%|████▋     | 13/28 [00:00<00:00, 30.84it/s] 61%|██████    | 17/28 [00:00<00:00, 33.41it/s] 75%|███████▌  | 21/28 [00:05<00:02,  2.41it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.51it/s]100%|██████████| 28/28 [00:07<00:00,  2.66it/s]100%|██████████| 28/28 [00:07<00:00,  3.96it/s]
2025-03-13 17:20:13,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:13
2025-03-13 17:21:12,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8515 secs
2025-03-13 17:21:12,676 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 17:21:12,676 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 17:21:37,036 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3599 secs
2025-03-13 17:21:37,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.2802 secs
2025-03-13 17:21:37,038 [INFO]: {
2025-03-13 17:21:37,038 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:37,038 [INFO]: 	index_param: efSearch=246
2025-03-13 17:21:37,038 [INFO]: 	index_path: knn.index
2025-03-13 17:21:37,038 [INFO]: 	size in bytes: 1309725310
2025-03-13 17:21:37,038 [INFO]: 	avg_search_speed_ms: 12.763811392966202
2025-03-13 17:21:37,038 [INFO]: 	99p_search_speed_ms: 18.834948956500735
2025-03-13 17:21:37,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:37,038 [INFO]: 	nb vectors: 6657
2025-03-13 17:21:37,038 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:37,038 [INFO]: 	compression ratio: 0.9993083633697206
2025-03-13 17:21:37,038 [INFO]: }
2025-03-13 17:21:37,038 [INFO]: 	>>> Finished "Creating the index" in 90.2820 secs
2025-03-13 17:21:37,038 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3129 secs
2025-03-13 17:21:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 17427 [episode count 0/20]
[retrieval_preprocessing] for episode 3120 [episode count 1/20], we have num_retrieval=np.int64(6632) num_query=np.int64(391)
2025-03-13 17:21:42,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:43,374 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:43
2025-03-13 17:21:43,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.34it/s]
2025-03-13 17:21:43,402 [INFO]: There are 6632 embeddings of dim 49152
2025-03-13 17:21:43,402 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 17:21:43,403 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:43
2025-03-13 17:21:43,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:43,403 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 17:21:43,403 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:43,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:21:43,404 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:43
2025-03-13 17:21:43,404 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:43,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:21:43,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:43
2025-03-13 17:21:43,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:43,405 [INFO]: 	Creating the index 03/13/2025, 17:21:43
2025-03-13 17:21:43,405 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:43
2025-03-13 17:21:43,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:21:43,408 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:43
2025-03-13 17:21:43,408 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:21:43,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 18.13it/s] 29%|██▊       | 8/28 [00:00<00:00, 37.88it/s] 50%|█████     | 14/28 [00:00<00:00, 44.22it/s] 71%|███████▏  | 20/28 [00:00<00:00, 46.94it/s] 89%|████████▉ | 25/28 [00:04<00:00,  3.73it/s]100%|██████████| 28/28 [00:06<00:00,  4.45it/s]
2025-03-13 17:21:49,704 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:49
2025-03-13 17:22:47,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9643 secs
2025-03-13 17:22:47,669 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 17:22:47,669 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 17:23:17,956 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2867 secs
2025-03-13 17:23:17,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5496 secs
2025-03-13 17:23:17,958 [INFO]: {
2025-03-13 17:23:17,958 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:17,958 [INFO]: 	index_param: efSearch=235
2025-03-13 17:23:17,958 [INFO]: 	index_path: knn.index
2025-03-13 17:23:17,958 [INFO]: 	size in bytes: 1304806690
2025-03-13 17:23:17,958 [INFO]: 	avg_search_speed_ms: 11.465526812945633
2025-03-13 17:23:17,958 [INFO]: 	99p_search_speed_ms: 17.221621191129085
2025-03-13 17:23:17,958 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:17,958 [INFO]: 	nb vectors: 6632
2025-03-13 17:23:17,958 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:17,958 [INFO]: 	compression ratio: 0.9993083772432222
2025-03-13 17:23:17,958 [INFO]: }
2025-03-13 17:23:17,958 [INFO]: 	>>> Finished "Creating the index" in 94.5534 secs
2025-03-13 17:23:17,958 [INFO]: >>> Finished "Launching the whole pipeline" in 94.5839 secs
2025-03-13 17:23:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:23:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 3120 [episode count 1/20]
[retrieval_preprocessing] for episode 19026 [episode count 2/20], we have num_retrieval=np.int64(6742) num_query=np.int64(281)
2025-03-13 17:23:23,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:23:24,469 [INFO]: Launching the whole pipeline 03/13/2025, 17:23:24
2025-03-13 17:23:24,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:23:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1332.79it/s]
2025-03-13 17:23:24,498 [INFO]: There are 6742 embeddings of dim 49152
2025-03-13 17:23:24,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 17:23:24,499 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,499 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:23:24,499 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:23:24,499 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:23:24,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:23:24,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,500 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:23:24,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:23:24,500 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:23:24
2025-03-13 17:23:24,501 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:23:24,501 [INFO]: 	Creating the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,501 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:23:24
2025-03-13 17:23:24,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:23:24,504 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:23:24
2025-03-13 17:23:24,504 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:23:24,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.80it/s] 18%|█▊        | 5/28 [00:00<00:00, 23.95it/s] 32%|███▏      | 9/28 [00:00<00:00, 29.26it/s] 46%|████▋     | 13/28 [00:00<00:00, 32.38it/s] 61%|██████    | 17/28 [00:00<00:00, 33.55it/s] 75%|███████▌  | 21/28 [00:05<00:03,  2.25it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.98it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.97it/s]100%|██████████| 28/28 [00:08<00:00,  3.31it/s]
2025-03-13 17:23:32,971 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:23:32
2025-03-13 17:24:28,561 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.5895 secs
2025-03-13 17:24:28,562 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:24:28,562 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.60it/s]
2025-03-13 17:25:10,201 [INFO]: 	>>> Finished "Compute fast metrics" in 41.6390 secs
2025-03-13 17:25:10,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.6978 secs
2025-03-13 17:25:10,202 [INFO]: {
2025-03-13 17:25:10,202 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:10,202 [INFO]: 	index_param: efSearch=230
2025-03-13 17:25:10,202 [INFO]: 	index_path: knn.index
2025-03-13 17:25:10,202 [INFO]: 	size in bytes: 1326448510
2025-03-13 17:25:10,202 [INFO]: 	avg_search_speed_ms: 11.021704639416877
2025-03-13 17:25:10,202 [INFO]: 	99p_search_speed_ms: 14.618992446921762
2025-03-13 17:25:10,202 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:10,202 [INFO]: 	nb vectors: 6742
2025-03-13 17:25:10,202 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:10,202 [INFO]: 	compression ratio: 0.999308398333532
2025-03-13 17:25:10,202 [INFO]: }
2025-03-13 17:25:10,202 [INFO]: 	>>> Finished "Creating the index" in 105.7015 secs
2025-03-13 17:25:10,202 [INFO]: >>> Finished "Launching the whole pipeline" in 105.7329 secs
2025-03-13 17:25:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 19026 [episode count 2/20]
[retrieval_preprocessing] for episode 66145 [episode count 3/20], we have num_retrieval=np.int64(6761) num_query=np.int64(262)
2025-03-13 17:25:14,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:15,897 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:15
2025-03-13 17:25:15,898 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-13 17:25:15,922 [INFO]: There are 6761 embeddings of dim 49152
2025-03-13 17:25:15,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 17:25:15,922 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:15,922 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:25:15,922 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:15,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:15,922 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,923 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:15,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:15,923 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:15
2025-03-13 17:25:15,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:15,923 [INFO]: 	Creating the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,924 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:15
2025-03-13 17:25:15,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:25:15,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:15
2025-03-13 17:25:15,927 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:25:15,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.19it/s] 25%|██▌       | 7/28 [00:00<00:00, 31.06it/s] 43%|████▎     | 12/28 [00:00<00:00, 35.07it/s] 57%|█████▋    | 16/28 [00:00<00:00, 35.54it/s] 71%|███████▏  | 20/28 [00:00<00:00, 35.62it/s] 86%|████████▌ | 24/28 [00:04<00:01,  2.62it/s]100%|██████████| 28/28 [00:07<00:00,  2.22it/s]100%|██████████| 28/28 [00:07<00:00,  3.82it/s]
2025-03-13 17:25:23,263 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:23
2025-03-13 17:26:29,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.6100 secs
2025-03-13 17:26:29,874 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 17:26:29,874 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-13 17:27:05,432 [INFO]: 	>>> Finished "Compute fast metrics" in 35.5578 secs
2025-03-13 17:27:05,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.5056 secs
2025-03-13 17:27:05,433 [INFO]: {
2025-03-13 17:27:05,433 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:05,433 [INFO]: 	index_param: efSearch=164
2025-03-13 17:27:05,433 [INFO]: 	index_path: knn.index
2025-03-13 17:27:05,433 [INFO]: 	size in bytes: 1330186570
2025-03-13 17:27:05,433 [INFO]: 	avg_search_speed_ms: 8.104366417128949
2025-03-13 17:27:05,433 [INFO]: 	99p_search_speed_ms: 12.222785367630422
2025-03-13 17:27:05,433 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:05,433 [INFO]: 	nb vectors: 6761
2025-03-13 17:27:05,433 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:05,433 [INFO]: 	compression ratio: 0.9993084564069836
2025-03-13 17:27:05,433 [INFO]: }
2025-03-13 17:27:05,433 [INFO]: 	>>> Finished "Creating the index" in 109.5098 secs
2025-03-13 17:27:05,433 [INFO]: >>> Finished "Launching the whole pipeline" in 109.5357 secs
2025-03-13 17:27:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 66145 [episode count 3/20]
[retrieval_preprocessing] for episode 88609 [episode count 4/20], we have num_retrieval=np.int64(6453) num_query=np.int64(570)
2025-03-13 17:27:07,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:08,604 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:08
2025-03-13 17:27:08,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.83it/s]
2025-03-13 17:27:08,630 [INFO]: There are 6453 embeddings of dim 49152
2025-03-13 17:27:08,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 17:27:08,631 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:08
2025-03-13 17:27:08,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:08,631 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 17:27:08,631 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:08,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:27:08,631 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:08
2025-03-13 17:27:08,631 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:08,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:27:08,631 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:08
2025-03-13 17:27:08,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:08,631 [INFO]: 	Creating the index 03/13/2025, 17:27:08
2025-03-13 17:27:08,631 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:08
2025-03-13 17:27:08,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:27:08,632 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:08
2025-03-13 17:27:08,632 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:27:08,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  8.60it/s] 26%|██▌       | 7/27 [00:00<00:00, 33.80it/s] 48%|████▊     | 13/27 [00:00<00:00, 43.57it/s] 70%|███████   | 19/27 [00:00<00:00, 48.01it/s] 89%|████████▉ | 24/27 [00:04<00:00,  3.72it/s]100%|██████████| 27/27 [00:06<00:00,  4.47it/s]
2025-03-13 17:27:14,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:14
2025-03-13 17:28:14,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3326 secs
2025-03-13 17:28:14,010 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 17:28:14,010 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.01it/s]
2025-03-13 17:29:00,961 [INFO]: 	>>> Finished "Compute fast metrics" in 46.9510 secs
2025-03-13 17:29:00,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.3304 secs
2025-03-13 17:29:00,963 [INFO]: {
2025-03-13 17:29:00,963 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:00,963 [INFO]: 	index_param: efSearch=230
2025-03-13 17:29:00,963 [INFO]: 	index_path: knn.index
2025-03-13 17:29:00,963 [INFO]: 	size in bytes: 1269589570
2025-03-13 17:29:00,963 [INFO]: 	avg_search_speed_ms: 10.137413021435597
2025-03-13 17:29:00,963 [INFO]: 	99p_search_speed_ms: 14.893223415128885
2025-03-13 17:29:00,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:00,963 [INFO]: 	nb vectors: 6453
2025-03-13 17:29:00,963 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:00,963 [INFO]: 	compression ratio: 0.9993083229251797
2025-03-13 17:29:00,963 [INFO]: }
2025-03-13 17:29:00,963 [INFO]: 	>>> Finished "Creating the index" in 112.3319 secs
2025-03-13 17:29:00,963 [INFO]: >>> Finished "Launching the whole pipeline" in 112.3593 secs
2025-03-13 17:29:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 88609 [episode count 4/20]
[retrieval_preprocessing] for episode 75947 [episode count 5/20], we have num_retrieval=np.int64(6799) num_query=np.int64(224)
2025-03-13 17:29:06,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:08,035 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:08
2025-03-13 17:29:08,036 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.58it/s]
2025-03-13 17:29:08,062 [INFO]: There are 6799 embeddings of dim 49152
2025-03-13 17:29:08,062 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 17:29:08,062 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:08
2025-03-13 17:29:08,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:08,062 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:29:08,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:08,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:29:08,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:08
2025-03-13 17:29:08,063 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:08,063 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:08,063 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:08
2025-03-13 17:29:08,063 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:08,063 [INFO]: 	Creating the index 03/13/2025, 17:29:08
2025-03-13 17:29:08,063 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:08
2025-03-13 17:29:08,064 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:29:08,064 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:08
2025-03-13 17:29:08,064 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:29:08,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.34it/s] 25%|██▌       | 7/28 [00:00<00:00, 32.82it/s] 43%|████▎     | 12/28 [00:00<00:00, 39.74it/s] 61%|██████    | 17/28 [00:00<00:00, 43.51it/s] 79%|███████▊  | 22/28 [00:05<00:02,  2.76it/s]100%|██████████| 28/28 [00:06<00:00,  2.95it/s]100%|██████████| 28/28 [00:06<00:00,  4.07it/s]
2025-03-13 17:29:14,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:14
2025-03-13 17:30:13,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8626 secs
2025-03-13 17:30:13,808 [INFO]: The best hyperparameters are: efSearch=144
2025-03-13 17:30:13,809 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.64it/s]
2025-03-13 17:30:56,857 [INFO]: 	>>> Finished "Compute fast metrics" in 43.0485 secs
2025-03-13 17:30:56,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.7948 secs
2025-03-13 17:30:56,859 [INFO]: {
2025-03-13 17:30:56,859 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:56,859 [INFO]: 	index_param: efSearch=144
2025-03-13 17:30:56,859 [INFO]: 	index_path: knn.index
2025-03-13 17:30:56,860 [INFO]: 	size in bytes: 1337662870
2025-03-13 17:30:56,860 [INFO]: 	avg_search_speed_ms: 8.760204799057371
2025-03-13 17:30:56,860 [INFO]: 	99p_search_speed_ms: 15.55604826891794
2025-03-13 17:30:56,860 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:56,860 [INFO]: 	nb vectors: 6799
2025-03-13 17:30:56,860 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:56,860 [INFO]: 	compression ratio: 0.9993084371101666
2025-03-13 17:30:56,860 [INFO]: }
2025-03-13 17:30:56,860 [INFO]: 	>>> Finished "Creating the index" in 108.7967 secs
2025-03-13 17:30:56,860 [INFO]: >>> Finished "Launching the whole pipeline" in 108.8241 secs
2025-03-13 17:30:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 75947 [episode count 5/20]
[retrieval_preprocessing] for episode 36531 [episode count 6/20], we have num_retrieval=np.int64(6690) num_query=np.int64(333)
2025-03-13 17:30:59,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:01,243 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:01
2025-03-13 17:31:01,243 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]
2025-03-13 17:31:01,270 [INFO]: There are 6690 embeddings of dim 49152
2025-03-13 17:31:01,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 17:31:01,270 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:01
2025-03-13 17:31:01,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:01,270 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:31:01,270 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:01,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:31:01,271 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:01
2025-03-13 17:31:01,271 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:01,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:31:01,271 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:01
2025-03-13 17:31:01,271 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:01,271 [INFO]: 	Creating the index 03/13/2025, 17:31:01
2025-03-13 17:31:01,271 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:01
2025-03-13 17:31:01,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:31:01,272 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:01
2025-03-13 17:31:01,272 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:31:01,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.30it/s] 21%|██▏       | 6/28 [00:00<00:00, 28.50it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.27it/s] 57%|█████▋    | 16/28 [00:00<00:00, 38.28it/s] 75%|███████▌  | 21/28 [00:03<00:01,  3.70it/s] 93%|█████████▎| 26/28 [00:03<00:00,  5.49it/s]100%|██████████| 28/28 [00:05<00:00,  4.84it/s]
2025-03-13 17:31:07,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:07
2025-03-13 17:32:03,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6590 secs
2025-03-13 17:32:03,716 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 17:32:03,716 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.02it/s]
2025-03-13 17:32:37,261 [INFO]: 	>>> Finished "Compute fast metrics" in 33.5444 secs
2025-03-13 17:32:37,262 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.9903 secs
2025-03-13 17:32:37,263 [INFO]: {
2025-03-13 17:32:37,263 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:37,263 [INFO]: 	index_param: efSearch=216
2025-03-13 17:32:37,263 [INFO]: 	index_path: knn.index
2025-03-13 17:32:37,263 [INFO]: 	size in bytes: 1316217850
2025-03-13 17:32:37,263 [INFO]: 	avg_search_speed_ms: 10.564742566832786
2025-03-13 17:32:37,263 [INFO]: 	99p_search_speed_ms: 15.737086278386414
2025-03-13 17:32:37,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:37,263 [INFO]: 	nb vectors: 6690
2025-03-13 17:32:37,263 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:37,263 [INFO]: 	compression ratio: 0.9993083743697899
2025-03-13 17:32:37,263 [INFO]: }
2025-03-13 17:32:37,263 [INFO]: 	>>> Finished "Creating the index" in 95.9918 secs
2025-03-13 17:32:37,263 [INFO]: >>> Finished "Launching the whole pipeline" in 96.0200 secs
2025-03-13 17:32:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 36531 [episode count 6/20]
[retrieval_preprocessing] for episode 27319 [episode count 7/20], we have num_retrieval=np.int64(6715) num_query=np.int64(308)
2025-03-13 17:32:41,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:42,412 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:42
2025-03-13 17:32:42,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-13 17:32:42,437 [INFO]: There are 6715 embeddings of dim 49152
2025-03-13 17:32:42,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:32:42,438 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:42,438 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:32:42,438 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:42,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:32:42,438 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,438 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:42,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:32:42,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:42
2025-03-13 17:32:42,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:42,438 [INFO]: 	Creating the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,438 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:42
2025-03-13 17:32:42,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:32:42,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:42
2025-03-13 17:32:42,439 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:32:42,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.26it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.23it/s] 39%|███▉      | 11/28 [00:00<00:00, 36.18it/s] 57%|█████▋    | 16/28 [00:00<00:00, 39.47it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.04it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.55it/s]100%|██████████| 28/28 [00:06<00:00,  4.28it/s]
2025-03-13 17:32:48,982 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:48
2025-03-13 17:33:47,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7340 secs
2025-03-13 17:33:47,717 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 17:33:47,717 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-13 17:34:38,935 [INFO]: 	>>> Finished "Compute fast metrics" in 51.2182 secs
2025-03-13 17:34:39,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.9132 secs
2025-03-13 17:34:39,353 [INFO]: {
2025-03-13 17:34:39,353 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:39,353 [INFO]: 	index_param: efSearch=229
2025-03-13 17:34:39,353 [INFO]: 	index_path: knn.index
2025-03-13 17:34:39,353 [INFO]: 	size in bytes: 1321136470
2025-03-13 17:34:39,353 [INFO]: 	avg_search_speed_ms: 12.307351047567208
2025-03-13 17:34:39,353 [INFO]: 	99p_search_speed_ms: 19.251212561503053
2025-03-13 17:34:39,353 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:39,353 [INFO]: 	nb vectors: 6715
2025-03-13 17:34:39,353 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:39,353 [INFO]: 	compression ratio: 0.999308360626817
2025-03-13 17:34:39,353 [INFO]: }
2025-03-13 17:34:39,353 [INFO]: 	>>> Finished "Creating the index" in 116.9154 secs
2025-03-13 17:34:39,353 [INFO]: >>> Finished "Launching the whole pipeline" in 116.9418 secs
2025-03-13 17:34:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27319 [episode count 7/20]
[retrieval_preprocessing] for episode 74936 [episode count 8/20], we have num_retrieval=np.int64(6720) num_query=np.int64(303)
2025-03-13 17:34:43,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:44,390 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:44
2025-03-13 17:34:44,390 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.19it/s]
2025-03-13 17:34:44,416 [INFO]: There are 6720 embeddings of dim 49152
2025-03-13 17:34:44,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:34:44,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:44
2025-03-13 17:34:44,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:44,417 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:34:44,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:44,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:44,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:44
2025-03-13 17:34:44,417 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:44,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:34:44,417 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:44
2025-03-13 17:34:44,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:44,417 [INFO]: 	Creating the index 03/13/2025, 17:34:44
2025-03-13 17:34:44,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:44
2025-03-13 17:34:44,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 17:34:44,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:44
2025-03-13 17:34:44,418 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:34:44,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.72it/s] 25%|██▌       | 7/28 [00:00<00:00, 33.09it/s] 43%|████▎     | 12/28 [00:00<00:00, 38.16it/s] 61%|██████    | 17/28 [00:00<00:00, 40.57it/s] 79%|███████▊  | 22/28 [00:04<00:01,  3.10it/s] 96%|█████████▋| 27/28 [00:04<00:00,  4.62it/s]100%|██████████| 28/28 [00:06<00:00,  4.56it/s]
2025-03-13 17:34:50,721 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:50
2025-03-13 17:35:49,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8553 secs
2025-03-13 17:35:49,577 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 17:35:49,577 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.85it/s]
2025-03-13 17:36:27,620 [INFO]: 	>>> Finished "Compute fast metrics" in 38.0428 secs
2025-03-13 17:36:27,621 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.2030 secs
2025-03-13 17:36:27,621 [INFO]: {
2025-03-13 17:36:27,621 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:27,621 [INFO]: 	index_param: efSearch=222
2025-03-13 17:36:27,621 [INFO]: 	index_path: knn.index
2025-03-13 17:36:27,621 [INFO]: 	size in bytes: 1322120170
2025-03-13 17:36:27,621 [INFO]: 	avg_search_speed_ms: 9.241006569506501
2025-03-13 17:36:27,621 [INFO]: 	99p_search_speed_ms: 12.708724730182452
2025-03-13 17:36:27,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:27,621 [INFO]: 	nb vectors: 6720
2025-03-13 17:36:27,621 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:27,621 [INFO]: 	compression ratio: 0.9993083760305994
2025-03-13 17:36:27,621 [INFO]: }
2025-03-13 17:36:27,621 [INFO]: 	>>> Finished "Creating the index" in 103.2043 secs
2025-03-13 17:36:27,622 [INFO]: >>> Finished "Launching the whole pipeline" in 103.2311 secs
2025-03-13 17:36:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 74936 [episode count 8/20]
[retrieval_preprocessing] for episode 58140 [episode count 9/20], we have num_retrieval=np.int64(6698) num_query=np.int64(325)
2025-03-13 17:36:30,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:36:31,421 [INFO]: Launching the whole pipeline 03/13/2025, 17:36:31
2025-03-13 17:36:31,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:36:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.14it/s]
2025-03-13 17:36:31,446 [INFO]: There are 6698 embeddings of dim 49152
2025-03-13 17:36:31,447 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 17:36:31,447 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:36:31
2025-03-13 17:36:31,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:36:31,447 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:36:31,447 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:36:31,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:36:31,447 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:36:31
2025-03-13 17:36:31,447 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:36:31,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:36:31,447 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:36:31
2025-03-13 17:36:31,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:36:31,447 [INFO]: 	Creating the index 03/13/2025, 17:36:31
2025-03-13 17:36:31,447 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:36:31
2025-03-13 17:36:31,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:36:31,448 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:36:31
2025-03-13 17:36:31,448 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:36:31,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.40it/s] 21%|██▏       | 6/28 [00:00<00:00, 27.56it/s] 39%|███▉      | 11/28 [00:00<00:00, 35.79it/s] 57%|█████▋    | 16/28 [00:00<00:00, 40.11it/s] 75%|███████▌  | 21/28 [00:03<00:01,  3.86it/s] 96%|█████████▋| 27/28 [00:03<00:00,  6.12it/s]100%|██████████| 28/28 [00:05<00:00,  5.46it/s]
2025-03-13 17:36:36,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:36:36
2025-03-13 17:37:35,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2046 secs
2025-03-13 17:37:35,783 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 17:37:35,783 [INFO]: 	Compute fast metrics 03/13/2025, 17:37:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 17:38:13,218 [INFO]: 	>>> Finished "Compute fast metrics" in 37.4350 secs
2025-03-13 17:38:13,219 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.7711 secs
2025-03-13 17:38:13,220 [INFO]: {
2025-03-13 17:38:13,220 [INFO]: 	index_key: HNSW15
2025-03-13 17:38:13,220 [INFO]: 	index_param: efSearch=199
2025-03-13 17:38:13,220 [INFO]: 	index_path: knn.index
2025-03-13 17:38:13,220 [INFO]: 	size in bytes: 1317791770
2025-03-13 17:38:13,220 [INFO]: 	avg_search_speed_ms: 9.59389523429628
2025-03-13 17:38:13,220 [INFO]: 	99p_search_speed_ms: 14.387309637386348
2025-03-13 17:38:13,220 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:38:13,220 [INFO]: 	nb vectors: 6698
2025-03-13 17:38:13,220 [INFO]: 	vectors dimension: 49152
2025-03-13 17:38:13,220 [INFO]: 	compression ratio: 0.9993083990803797
2025-03-13 17:38:13,220 [INFO]: }
2025-03-13 17:38:13,220 [INFO]: 	>>> Finished "Creating the index" in 101.7725 secs
2025-03-13 17:38:13,220 [INFO]: >>> Finished "Launching the whole pipeline" in 101.7981 secs
2025-03-13 17:38:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:38:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 58140 [episode count 9/20]
[retrieval_preprocessing] for episode 4382 [episode count 10/20], we have num_retrieval=np.int64(6763) num_query=np.int64(260)
2025-03-13 17:38:16,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:38:18,044 [INFO]: Launching the whole pipeline 03/13/2025, 17:38:18
2025-03-13 17:38:18,044 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:38:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.99it/s]
2025-03-13 17:38:18,070 [INFO]: There are 6763 embeddings of dim 49152
2025-03-13 17:38:18,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 17:38:18,071 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:38:18
2025-03-13 17:38:18,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:38:18,071 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:38:18,071 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:38:18,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:38:18,071 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:38:18
2025-03-13 17:38:18,071 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:38:18,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:38:18,071 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:38:18
2025-03-13 17:38:18,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:38:18,071 [INFO]: 	Creating the index 03/13/2025, 17:38:18
2025-03-13 17:38:18,071 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:38:18
2025-03-13 17:38:18,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:38:18,072 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:38:18
2025-03-13 17:38:18,072 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:38:18,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.64it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.35it/s] 39%|███▉      | 11/28 [00:00<00:00, 36.31it/s] 57%|█████▋    | 16/28 [00:00<00:00, 39.72it/s] 75%|███████▌  | 21/28 [00:03<00:02,  3.48it/s] 93%|█████████▎| 26/28 [00:04<00:00,  5.17it/s]100%|██████████| 28/28 [00:05<00:00,  4.89it/s]
2025-03-13 17:38:23,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:38:23
2025-03-13 17:39:14,961 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1609 secs
2025-03-13 17:39:14,962 [INFO]: The best hyperparameters are: efSearch=289
2025-03-13 17:39:14,962 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-13 17:39:46,636 [INFO]: 	>>> Finished "Compute fast metrics" in 31.6743 secs
2025-03-13 17:39:46,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5656 secs
2025-03-13 17:39:46,638 [INFO]: {
2025-03-13 17:39:46,638 [INFO]: 	index_key: HNSW15
2025-03-13 17:39:46,638 [INFO]: 	index_param: efSearch=289
2025-03-13 17:39:46,638 [INFO]: 	index_path: knn.index
2025-03-13 17:39:46,638 [INFO]: 	size in bytes: 1330580050
2025-03-13 17:39:46,638 [INFO]: 	avg_search_speed_ms: 12.827371878740497
2025-03-13 17:39:46,638 [INFO]: 	99p_search_speed_ms: 17.706010853871707
2025-03-13 17:39:46,638 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:39:46,638 [INFO]: 	nb vectors: 6763
2025-03-13 17:39:46,638 [INFO]: 	vectors dimension: 49152
2025-03-13 17:39:46,638 [INFO]: 	compression ratio: 0.9993084625009973
2025-03-13 17:39:46,638 [INFO]: }
2025-03-13 17:39:46,638 [INFO]: 	>>> Finished "Creating the index" in 88.5672 secs
2025-03-13 17:39:46,638 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5943 secs
2025-03-13 17:39:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:39:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 4382 [episode count 10/20]
[retrieval_preprocessing] for episode 65822 [episode count 11/20], we have num_retrieval=np.int64(6477) num_query=np.int64(546)
2025-03-13 17:39:49,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:39:50,698 [INFO]: Launching the whole pipeline 03/13/2025, 17:39:50
2025-03-13 17:39:50,698 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:39:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-13 17:39:50,727 [INFO]: There are 6477 embeddings of dim 49152
2025-03-13 17:39:50,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 17:39:50,728 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:39:50
2025-03-13 17:39:50,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:39:50,728 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 17:39:50,728 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:39:50,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:39:50,728 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:39:50
2025-03-13 17:39:50,729 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:39:50,729 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:39:50,729 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:39:50
2025-03-13 17:39:50,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:39:50,729 [INFO]: 	Creating the index 03/13/2025, 17:39:50
2025-03-13 17:39:50,730 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:39:50
2025-03-13 17:39:50,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:39:50,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:39:50
2025-03-13 17:39:50,733 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:39:50,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  7%|▋         | 2/27 [00:00<00:01, 18.40it/s] 30%|██▉       | 8/27 [00:00<00:00, 38.91it/s] 52%|█████▏    | 14/27 [00:00<00:00, 45.55it/s] 74%|███████▍  | 20/27 [00:00<00:00, 48.70it/s] 93%|█████████▎| 25/27 [00:03<00:00,  4.38it/s]100%|██████████| 27/27 [00:05<00:00,  4.99it/s]
2025-03-13 17:39:56,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:39:56
2025-03-13 17:40:46,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2035 secs
2025-03-13 17:40:46,352 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 17:40:46,352 [INFO]: 	Compute fast metrics 03/13/2025, 17:40:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s]
2025-03-13 17:41:19,414 [INFO]: 	>>> Finished "Compute fast metrics" in 33.0616 secs
2025-03-13 17:41:19,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.6826 secs
2025-03-13 17:41:19,416 [INFO]: {
2025-03-13 17:41:19,416 [INFO]: 	index_key: HNSW15
2025-03-13 17:41:19,416 [INFO]: 	index_param: efSearch=239
2025-03-13 17:41:19,416 [INFO]: 	index_path: knn.index
2025-03-13 17:41:19,416 [INFO]: 	size in bytes: 1274311330
2025-03-13 17:41:19,416 [INFO]: 	avg_search_speed_ms: 14.736408039938455
2025-03-13 17:41:19,416 [INFO]: 	99p_search_speed_ms: 21.310220058076094
2025-03-13 17:41:19,416 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:41:19,416 [INFO]: 	nb vectors: 6477
2025-03-13 17:41:19,416 [INFO]: 	vectors dimension: 49152
2025-03-13 17:41:19,416 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-13 17:41:19,416 [INFO]: }
2025-03-13 17:41:19,416 [INFO]: 	>>> Finished "Creating the index" in 88.6865 secs
2025-03-13 17:41:19,416 [INFO]: >>> Finished "Launching the whole pipeline" in 88.7183 secs
2025-03-13 17:41:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:41:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65822 [episode count 11/20]
[retrieval_preprocessing] for episode 58679 [episode count 12/20], we have num_retrieval=np.int64(6760) num_query=np.int64(263)
2025-03-13 17:41:24,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:26,197 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:26
2025-03-13 17:41:26,197 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 966.65it/s]
2025-03-13 17:41:26,224 [INFO]: There are 6760 embeddings of dim 49152
2025-03-13 17:41:26,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:41:26,225 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:26
2025-03-13 17:41:26,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:26,225 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:41:26,225 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:41:26,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:41:26,225 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:26
2025-03-13 17:41:26,225 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:26,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:26,225 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:26
2025-03-13 17:41:26,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:26,225 [INFO]: 	Creating the index 03/13/2025, 17:41:26
2025-03-13 17:41:26,225 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:41:26
2025-03-13 17:41:26,226 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:41:26,226 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:26
2025-03-13 17:41:26,226 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:41:26,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  5.92it/s] 18%|█▊        | 5/28 [00:00<00:01, 19.61it/s] 32%|███▏      | 9/28 [00:00<00:00, 26.59it/s] 46%|████▋     | 13/28 [00:00<00:00, 30.58it/s] 61%|██████    | 17/28 [00:00<00:00, 32.82it/s] 75%|███████▌  | 21/28 [00:05<00:03,  2.25it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.29it/s]100%|██████████| 28/28 [00:07<00:00,  2.47it/s]100%|██████████| 28/28 [00:07<00:00,  3.70it/s]
2025-03-13 17:41:33,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:33
2025-03-13 17:42:28,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5732 secs
2025-03-13 17:42:28,372 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 17:42:28,373 [INFO]: 	Compute fast metrics 03/13/2025, 17:42:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-13 17:43:11,675 [INFO]: 	>>> Finished "Compute fast metrics" in 43.3026 secs
2025-03-13 17:43:11,677 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.4504 secs
2025-03-13 17:43:11,677 [INFO]: {
2025-03-13 17:43:11,677 [INFO]: 	index_key: HNSW15
2025-03-13 17:43:11,677 [INFO]: 	index_param: efSearch=264
2025-03-13 17:43:11,677 [INFO]: 	index_path: knn.index
2025-03-13 17:43:11,677 [INFO]: 	size in bytes: 1329989830
2025-03-13 17:43:11,677 [INFO]: 	avg_search_speed_ms: 13.057345716530754
2025-03-13 17:43:11,677 [INFO]: 	99p_search_speed_ms: 17.527604429051284
2025-03-13 17:43:11,677 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:43:11,677 [INFO]: 	nb vectors: 6760
2025-03-13 17:43:11,677 [INFO]: 	vectors dimension: 49152
2025-03-13 17:43:11,677 [INFO]: 	compression ratio: 0.9993084533586245
2025-03-13 17:43:11,677 [INFO]: }
2025-03-13 17:43:11,677 [INFO]: 	>>> Finished "Creating the index" in 105.4519 secs
2025-03-13 17:43:11,677 [INFO]: >>> Finished "Launching the whole pipeline" in 105.4800 secs
2025-03-13 17:43:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:43:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 58679 [episode count 12/20]
[retrieval_preprocessing] for episode 61788 [episode count 13/20], we have num_retrieval=np.int64(6673) num_query=np.int64(350)
2025-03-13 17:43:15,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:43:16,384 [INFO]: Launching the whole pipeline 03/13/2025, 17:43:16
2025-03-13 17:43:16,384 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:43:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.05it/s]
2025-03-13 17:43:16,408 [INFO]: There are 6673 embeddings of dim 49152
2025-03-13 17:43:16,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 17:43:16,409 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:43:16,409 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:43:16,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:43:16,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:43:16,409 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,409 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:43:16,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:43:16,409 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:43:16
2025-03-13 17:43:16,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:43:16,409 [INFO]: 	Creating the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,409 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:43:16
2025-03-13 17:43:16,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:43:16,410 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:43:16
2025-03-13 17:43:16,410 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:43:16,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  8.28it/s] 21%|██▏       | 6/28 [00:00<00:00, 29.34it/s] 39%|███▉      | 11/28 [00:00<00:00, 36.75it/s] 57%|█████▋    | 16/28 [00:00<00:00, 39.91it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.08it/s] 93%|█████████▎| 26/28 [00:04<00:00,  4.62it/s]100%|██████████| 28/28 [00:06<00:00,  4.59it/s]
2025-03-13 17:43:22,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:43:22
2025-03-13 17:44:14,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9872 secs
2025-03-13 17:44:14,496 [INFO]: The best hyperparameters are: efSearch=324
2025-03-13 17:44:14,496 [INFO]: 	Compute fast metrics 03/13/2025, 17:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 17:44:52,300 [INFO]: 	>>> Finished "Compute fast metrics" in 37.8043 secs
2025-03-13 17:44:52,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8917 secs
2025-03-13 17:44:52,302 [INFO]: {
2025-03-13 17:44:52,302 [INFO]: 	index_key: HNSW15
2025-03-13 17:44:52,302 [INFO]: 	index_param: efSearch=324
2025-03-13 17:44:52,302 [INFO]: 	index_path: knn.index
2025-03-13 17:44:52,302 [INFO]: 	size in bytes: 1312873210
2025-03-13 17:44:52,302 [INFO]: 	avg_search_speed_ms: 15.078800215655152
2025-03-13 17:44:52,302 [INFO]: 	99p_search_speed_ms: 21.551991880405694
2025-03-13 17:44:52,302 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:52,302 [INFO]: 	nb vectors: 6673
2025-03-13 17:44:52,302 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:52,302 [INFO]: 	compression ratio: 0.999308367332745
2025-03-13 17:44:52,302 [INFO]: }
2025-03-13 17:44:52,302 [INFO]: 	>>> Finished "Creating the index" in 95.8932 secs
2025-03-13 17:44:52,302 [INFO]: >>> Finished "Launching the whole pipeline" in 95.9182 secs
2025-03-13 17:44:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 61788 [episode count 13/20]
[retrieval_preprocessing] for episode 72543 [episode count 14/20], we have num_retrieval=np.int64(6638) num_query=np.int64(385)
2025-03-13 17:44:57,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:58,270 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:58
2025-03-13 17:44:58,270 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1396.70it/s]
2025-03-13 17:44:58,298 [INFO]: There are 6638 embeddings of dim 49152
2025-03-13 17:44:58,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:44:58,298 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:58
2025-03-13 17:44:58,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:58,298 [INFO]: 		-> Add: 3.6 seconds
2025-03-13 17:44:58,298 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:44:58,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:44:58,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:58
2025-03-13 17:44:58,298 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:58,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:44:58,299 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:58
2025-03-13 17:44:58,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:44:58,299 [INFO]: 	Creating the index 03/13/2025, 17:44:58
2025-03-13 17:44:58,299 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:44:58
2025-03-13 17:44:58,300 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:44:58,300 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:58
2025-03-13 17:44:58,300 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:44:58,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  6.94it/s] 21%|██▏       | 6/28 [00:00<00:00, 26.30it/s] 39%|███▉      | 11/28 [00:00<00:00, 33.87it/s] 57%|█████▋    | 16/28 [00:00<00:00, 37.64it/s] 75%|███████▌  | 21/28 [00:04<00:02,  3.04it/s] 89%|████████▉ | 25/28 [00:04<00:00,  4.24it/s]100%|██████████| 28/28 [00:06<00:00,  2.80it/s]100%|██████████| 28/28 [00:06<00:00,  4.11it/s]
2025-03-13 17:45:05,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:05
2025-03-13 17:46:02,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0487 secs
2025-03-13 17:46:02,169 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:46:02,169 [INFO]: 	Compute fast metrics 03/13/2025, 17:46:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-13 17:46:26,286 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1173 secs
2025-03-13 17:46:26,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.9877 secs
2025-03-13 17:46:26,288 [INFO]: {
2025-03-13 17:46:26,288 [INFO]: 	index_key: HNSW15
2025-03-13 17:46:26,288 [INFO]: 	index_param: efSearch=206
2025-03-13 17:46:26,288 [INFO]: 	index_path: knn.index
2025-03-13 17:46:26,288 [INFO]: 	size in bytes: 1305987190
2025-03-13 17:46:26,288 [INFO]: 	avg_search_speed_ms: 10.711077680488215
2025-03-13 17:46:26,288 [INFO]: 	99p_search_speed_ms: 18.187097546178844
2025-03-13 17:46:26,288 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:46:26,288 [INFO]: 	nb vectors: 6638
2025-03-13 17:46:26,288 [INFO]: 	vectors dimension: 49152
2025-03-13 17:46:26,288 [INFO]: 	compression ratio: 0.9993083500306003
2025-03-13 17:46:26,288 [INFO]: }
2025-03-13 17:46:26,288 [INFO]: 	>>> Finished "Creating the index" in 87.9896 secs
2025-03-13 17:46:26,288 [INFO]: >>> Finished "Launching the whole pipeline" in 88.0181 secs
2025-03-13 17:46:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:46:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 72543 [episode count 14/20]
[retrieval_preprocessing] for episode 37736 [episode count 15/20], we have num_retrieval=np.int64(6374) num_query=np.int64(649)
2025-03-13 17:46:30,162 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:46:31,160 [INFO]: Launching the whole pipeline 03/13/2025, 17:46:31
2025-03-13 17:46:31,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:46:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 988.99it/s]
2025-03-13 17:46:31,196 [INFO]: There are 6374 embeddings of dim 49152
2025-03-13 17:46:31,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 17:46:31,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:46:31
2025-03-13 17:46:31,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:46:31,197 [INFO]: 		-> Add: 3.5 seconds
2025-03-13 17:46:31,197 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:46:31,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:46:31,197 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:46:31
2025-03-13 17:46:31,198 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:46:31,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:46:31,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:46:31
2025-03-13 17:46:31,198 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:46:31,198 [INFO]: 	Creating the index 03/13/2025, 17:46:31
2025-03-13 17:46:31,198 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:46:31
2025-03-13 17:46:31,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 17:46:31,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:46:31
2025-03-13 17:46:31,200 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:46:31,200 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:02,  9.47it/s] 22%|██▏       | 6/27 [00:00<00:00, 29.00it/s] 41%|████      | 11/27 [00:00<00:00, 35.05it/s] 59%|█████▉    | 16/27 [00:00<00:00, 37.88it/s] 78%|███████▊  | 21/27 [00:04<00:02,  2.88it/s] 93%|█████████▎| 25/27 [00:04<00:00,  4.01it/s]100%|██████████| 27/27 [00:07<00:00,  3.69it/s]
2025-03-13 17:46:38,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:46:38
2025-03-13 17:47:34,487 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.9650 secs
2025-03-13 17:47:34,488 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 17:47:34,488 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-13 17:48:27,780 [INFO]: 	>>> Finished "Compute fast metrics" in 53.2928 secs
2025-03-13 17:48:27,782 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.5814 secs
2025-03-13 17:48:27,782 [INFO]: {
2025-03-13 17:48:27,782 [INFO]: 	index_key: HNSW15
2025-03-13 17:48:27,782 [INFO]: 	index_param: efSearch=227
2025-03-13 17:48:27,782 [INFO]: 	index_path: knn.index
2025-03-13 17:48:27,782 [INFO]: 	size in bytes: 1254046690
2025-03-13 17:48:27,782 [INFO]: 	avg_search_speed_ms: 10.39648495189528
2025-03-13 17:48:27,782 [INFO]: 	99p_search_speed_ms: 17.73391244933009
2025-03-13 17:48:27,782 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:27,782 [INFO]: 	nb vectors: 6374
2025-03-13 17:48:27,782 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:27,782 [INFO]: 	compression ratio: 0.9993084005508599
2025-03-13 17:48:27,782 [INFO]: }
2025-03-13 17:48:27,782 [INFO]: 	>>> Finished "Creating the index" in 116.5840 secs
2025-03-13 17:48:27,782 [INFO]: >>> Finished "Launching the whole pipeline" in 116.6214 secs
2025-03-13 17:48:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 37736 [episode count 15/20]
[retrieval_preprocessing] for episode 9599 [episode count 16/20], we have num_retrieval=np.int64(6654) num_query=np.int64(369)
2025-03-13 17:48:33,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:34,435 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:34
2025-03-13 17:48:34,435 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-13 17:48:34,457 [INFO]: There are 6654 embeddings of dim 49152
2025-03-13 17:48:34,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 17:48:34,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:34,458 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:48:34,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:48:34,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:48:34,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,458 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:34,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:48:34,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:34
2025-03-13 17:48:34,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:48:34,458 [INFO]: 	Creating the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,458 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:48:34
2025-03-13 17:48:34,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:48:34,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:34
2025-03-13 17:48:34,459 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:48:34,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:02,  9.05it/s] 18%|█▊        | 5/28 [00:00<00:00, 25.75it/s] 36%|███▌      | 10/28 [00:00<00:00, 32.81it/s] 50%|█████     | 14/28 [00:00<00:00, 35.20it/s] 68%|██████▊   | 19/28 [00:00<00:00, 37.15it/s] 82%|████████▏ | 23/28 [00:05<00:01,  2.62it/s]100%|██████████| 28/28 [00:07<00:00,  2.59it/s]100%|██████████| 28/28 [00:07<00:00,  4.00it/s]
2025-03-13 17:48:41,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:48:41
2025-03-13 17:49:39,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8107 secs
2025-03-13 17:49:39,279 [INFO]: The best hyperparameters are: efSearch=254
2025-03-13 17:49:39,279 [INFO]: 	Compute fast metrics 03/13/2025, 17:49:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.53it/s]
2025-03-13 17:50:29,021 [INFO]: 	>>> Finished "Compute fast metrics" in 49.7423 secs
2025-03-13 17:50:29,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 114.5636 secs
2025-03-13 17:50:29,023 [INFO]: {
2025-03-13 17:50:29,023 [INFO]: 	index_key: HNSW15
2025-03-13 17:50:29,023 [INFO]: 	index_param: efSearch=254
2025-03-13 17:50:29,023 [INFO]: 	index_path: knn.index
2025-03-13 17:50:29,023 [INFO]: 	size in bytes: 1309135090
2025-03-13 17:50:29,023 [INFO]: 	avg_search_speed_ms: 10.749577755452595
2025-03-13 17:50:29,023 [INFO]: 	99p_search_speed_ms: 15.764357941225171
2025-03-13 17:50:29,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:50:29,023 [INFO]: 	nb vectors: 6654
2025-03-13 17:50:29,023 [INFO]: 	vectors dimension: 49152
2025-03-13 17:50:29,023 [INFO]: 	compression ratio: 0.9993083540370153
2025-03-13 17:50:29,023 [INFO]: }
2025-03-13 17:50:29,023 [INFO]: 	>>> Finished "Creating the index" in 114.5651 secs
2025-03-13 17:50:29,023 [INFO]: >>> Finished "Launching the whole pipeline" in 114.5881 secs
2025-03-13 17:50:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:50:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 9599 [episode count 16/20]
[retrieval_preprocessing] for episode 48513 [episode count 17/20], we have num_retrieval=np.int64(6679) num_query=np.int64(344)
2025-03-13 17:50:33,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:50:35,064 [INFO]: Launching the whole pipeline 03/13/2025, 17:50:35
2025-03-13 17:50:35,064 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:50:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-13 17:50:35,093 [INFO]: There are 6679 embeddings of dim 49152
2025-03-13 17:50:35,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 17:50:35,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:50:35
2025-03-13 17:50:35,094 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:50:35,094 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:50:35,094 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:50:35,094 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:50:35,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:50:35
2025-03-13 17:50:35,094 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:50:35,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:50:35,095 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:50:35
2025-03-13 17:50:35,095 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:50:35,095 [INFO]: 	Creating the index 03/13/2025, 17:50:35
2025-03-13 17:50:35,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:50:35
2025-03-13 17:50:35,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:50:35,099 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:50:35
2025-03-13 17:50:35,099 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:50:35,099 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  7%|▋         | 2/28 [00:00<00:01, 16.84it/s] 25%|██▌       | 7/28 [00:00<00:00, 34.21it/s] 43%|████▎     | 12/28 [00:00<00:00, 40.38it/s] 61%|██████    | 17/28 [00:00<00:00, 43.58it/s] 79%|███████▊  | 22/28 [00:04<00:01,  3.10it/s] 96%|█████████▋| 27/28 [00:04<00:00,  4.60it/s]100%|██████████| 28/28 [00:06<00:00,  4.23it/s]
2025-03-13 17:50:41,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:50:41
2025-03-13 17:51:37,482 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7644 secs
2025-03-13 17:51:37,483 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 17:51:37,483 [INFO]: 	Compute fast metrics 03/13/2025, 17:51:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-13 17:52:14,874 [INFO]: 	>>> Finished "Compute fast metrics" in 37.3908 secs
2025-03-13 17:52:15,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.0010 secs
2025-03-13 17:52:15,100 [INFO]: {
2025-03-13 17:52:15,100 [INFO]: 	index_key: HNSW15
2025-03-13 17:52:15,100 [INFO]: 	index_param: efSearch=248
2025-03-13 17:52:15,100 [INFO]: 	index_path: knn.index
2025-03-13 17:52:15,100 [INFO]: 	size in bytes: 1314053710
2025-03-13 17:52:15,100 [INFO]: 	avg_search_speed_ms: 11.970422150451316
2025-03-13 17:52:15,100 [INFO]: 	99p_search_speed_ms: 21.96753879543393
2025-03-13 17:52:15,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:52:15,101 [INFO]: 	nb vectors: 6679
2025-03-13 17:52:15,101 [INFO]: 	vectors dimension: 49152
2025-03-13 17:52:15,101 [INFO]: 	compression ratio: 0.9993083402960751
2025-03-13 17:52:15,101 [INFO]: }
2025-03-13 17:52:15,101 [INFO]: 	>>> Finished "Creating the index" in 100.0055 secs
2025-03-13 17:52:15,101 [INFO]: >>> Finished "Launching the whole pipeline" in 100.0372 secs
2025-03-13 17:52:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 48513 [episode count 17/20]
[retrieval_preprocessing] for episode 45448 [episode count 18/20], we have num_retrieval=np.int64(6799) num_query=np.int64(224)
2025-03-13 17:52:20,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:22,198 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:22
2025-03-13 17:52:22,198 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 790.93it/s]
2025-03-13 17:52:22,231 [INFO]: There are 6799 embeddings of dim 49152
2025-03-13 17:52:22,231 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 17:52:22,231 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:22,232 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:52:22,232 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:52:22,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:52:22,232 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,232 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:22,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 17:52:22,233 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:22
2025-03-13 17:52:22,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:22,233 [INFO]: 	Creating the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,233 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:52:22
2025-03-13 17:52:22,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:52:22,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:22
2025-03-13 17:52:22,237 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:52:22,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.12it/s] 14%|█▍        | 4/28 [00:00<00:01, 17.71it/s] 25%|██▌       | 7/28 [00:00<00:00, 22.23it/s] 36%|███▌      | 10/28 [00:00<00:00, 24.52it/s] 46%|████▋     | 13/28 [00:00<00:00, 25.46it/s] 57%|█████▋    | 16/28 [00:00<00:00, 26.25it/s] 68%|██████▊   | 19/28 [00:00<00:00, 26.12it/s] 79%|███████▊  | 22/28 [00:06<00:03,  1.67it/s] 96%|█████████▋| 27/28 [00:06<00:00,  2.88it/s]100%|██████████| 28/28 [00:08<00:00,  3.34it/s]
2025-03-13 17:52:30,624 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:30
2025-03-13 17:53:31,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2081 secs
2025-03-13 17:53:31,833 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 17:53:31,833 [INFO]: 	Compute fast metrics 03/13/2025, 17:53:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-13 17:54:12,797 [INFO]: 	>>> Finished "Compute fast metrics" in 40.9639 secs
2025-03-13 17:54:12,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.5625 secs
2025-03-13 17:54:12,800 [INFO]: {
2025-03-13 17:54:12,800 [INFO]: 	index_key: HNSW15
2025-03-13 17:54:12,800 [INFO]: 	index_param: efSearch=268
2025-03-13 17:54:12,800 [INFO]: 	index_path: knn.index
2025-03-13 17:54:12,800 [INFO]: 	size in bytes: 1337662870
2025-03-13 17:54:12,800 [INFO]: 	avg_search_speed_ms: 11.799438461993013
2025-03-13 17:54:12,800 [INFO]: 	99p_search_speed_ms: 19.71285949693992
2025-03-13 17:54:12,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:54:12,800 [INFO]: 	nb vectors: 6799
2025-03-13 17:54:12,800 [INFO]: 	vectors dimension: 49152
2025-03-13 17:54:12,800 [INFO]: 	compression ratio: 0.9993084371101666
2025-03-13 17:54:12,800 [INFO]: }
2025-03-13 17:54:12,800 [INFO]: 	>>> Finished "Creating the index" in 110.5669 secs
2025-03-13 17:54:12,800 [INFO]: >>> Finished "Launching the whole pipeline" in 110.6020 secs
2025-03-13 17:54:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:54:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 45448 [episode count 18/20]
[retrieval_preprocessing] for episode 60814 [episode count 19/20], we have num_retrieval=np.int64(6753) num_query=np.int64(270)
2025-03-13 17:54:17,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:54:19,170 [INFO]: Launching the whole pipeline 03/13/2025, 17:54:19
2025-03-13 17:54:19,171 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:54:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.99it/s]
2025-03-13 17:54:19,195 [INFO]: There are 6753 embeddings of dim 49152
2025-03-13 17:54:19,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 17:54:19,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:54:19
2025-03-13 17:54:19,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:54:19,196 [INFO]: 		-> Add: 3.7 seconds
2025-03-13 17:54:19,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:54:19,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:54:19,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:54:19
2025-03-13 17:54:19,196 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:54:19,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:54:19,196 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:54:19
2025-03-13 17:54:19,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:54:19,196 [INFO]: 	Creating the index 03/13/2025, 17:54:19
2025-03-13 17:54:19,196 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:54:19
2025-03-13 17:54:19,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:54:19,197 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:54:19
2025-03-13 17:54:19,197 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-13 17:54:19,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:03,  7.90it/s] 18%|█▊        | 5/28 [00:00<00:00, 23.72it/s] 36%|███▌      | 10/28 [00:00<00:00, 32.82it/s] 54%|█████▎    | 15/28 [00:00<00:00, 37.18it/s] 71%|███████▏  | 20/28 [00:00<00:00, 39.86it/s] 89%|████████▉ | 25/28 [00:03<00:00,  3.80it/s]100%|██████████| 28/28 [00:05<00:00,  2.92it/s]100%|██████████| 28/28 [00:05<00:00,  4.84it/s]
2025-03-13 17:54:24,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:54:24
2025-03-13 17:55:16,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.2649 secs
2025-03-13 17:55:16,253 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 17:55:16,253 [INFO]: 	Compute fast metrics 03/13/2025, 17:55:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.23it/s]
2025-03-13 17:55:55,021 [INFO]: 	>>> Finished "Compute fast metrics" in 38.7680 secs
2025-03-13 17:55:55,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.8259 secs
2025-03-13 17:55:55,023 [INFO]: {
2025-03-13 17:55:55,023 [INFO]: 	index_key: HNSW15
2025-03-13 17:55:55,023 [INFO]: 	index_param: efSearch=256
2025-03-13 17:55:55,023 [INFO]: 	index_path: knn.index
2025-03-13 17:55:55,023 [INFO]: 	size in bytes: 1328612650
2025-03-13 17:55:55,023 [INFO]: 	avg_search_speed_ms: 11.435784311699015
2025-03-13 17:55:55,023 [INFO]: 	99p_search_speed_ms: 17.197637064382434
2025-03-13 17:55:55,023 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:55,023 [INFO]: 	nb vectors: 6753
2025-03-13 17:55:55,023 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:55,023 [INFO]: 	compression ratio: 0.9993084319948331
2025-03-13 17:55:55,023 [INFO]: }
2025-03-13 17:55:55,023 [INFO]: 	>>> Finished "Creating the index" in 95.8273 secs
2025-03-13 17:55:55,023 [INFO]: >>> Finished "Launching the whole pipeline" in 95.8527 secs
2025-03-13 17:55:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 60814 [episode count 19/20]
2025-03-13 17:55:58: [retrieval_preprocessing] finished for 2828277154_put_can_in_upper_cabinet [chosen_id count 6/196]
2025-03-13 17:55:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2883696971_put_rubber_band_on_jar [chosen_id count 7/196]
2025-03-13 17:55:59: [retrieval_preprocessing] we have num_total=2841 embedding_dim=49152
[retrieval_preprocessing] for episode 14849 [episode count 0/20], we have num_retrieval=np.int64(2695) num_query=np.int64(146)
2025-03-13 17:56:00,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:56:00,630 [INFO]: Launching the whole pipeline 03/13/2025, 17:56:00
2025-03-13 17:56:00,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:56:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.47it/s]
2025-03-13 17:56:00,659 [INFO]: There are 2695 embeddings of dim 49152
2025-03-13 17:56:00,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 17:56:00,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:56:00
2025-03-13 17:56:00,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:56:00,659 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:56:00,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:56:00,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:56:00,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:56:00
2025-03-13 17:56:00,659 [INFO]: 556.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:56:00,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:56:00,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:56:00
2025-03-13 17:56:00,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:56:00,660 [INFO]: 	Creating the index 03/13/2025, 17:56:00
2025-03-13 17:56:00,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:56:00
2025-03-13 17:56:00,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:56:00,661 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:56:00
2025-03-13 17:56:00,661 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:56:00,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.08it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.63it/s]100%|██████████| 11/11 [00:02<00:00,  3.17it/s]100%|██████████| 11/11 [00:02<00:00,  3.75it/s]
2025-03-13 17:56:03,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:03
2025-03-13 17:56:42,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1347 secs
2025-03-13 17:56:42,730 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 17:56:42,730 [INFO]: 	Compute fast metrics 03/13/2025, 17:56:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.01it/s]
2025-03-13 17:57:11,330 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5991 secs
2025-03-13 17:57:11,331 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6704 secs
2025-03-13 17:57:11,332 [INFO]: {
2025-03-13 17:57:11,332 [INFO]: 	index_key: HNSW15
2025-03-13 17:57:11,332 [INFO]: 	index_param: efSearch=195
2025-03-13 17:57:11,332 [INFO]: 	index_path: knn.index
2025-03-13 17:57:11,332 [INFO]: 	size in bytes: 530224510
2025-03-13 17:57:11,332 [INFO]: 	avg_search_speed_ms: 7.494108584560063
2025-03-13 17:57:11,332 [INFO]: 	99p_search_speed_ms: 11.098749674856663
2025-03-13 17:57:11,332 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:57:11,332 [INFO]: 	nb vectors: 2695
2025-03-13 17:57:11,332 [INFO]: 	vectors dimension: 49152
2025-03-13 17:57:11,332 [INFO]: 	compression ratio: 0.9993098206644577
2025-03-13 17:57:11,332 [INFO]: }
2025-03-13 17:57:11,332 [INFO]: 	>>> Finished "Creating the index" in 70.6720 secs
2025-03-13 17:57:11,332 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7011 secs
2025-03-13 17:57:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:57:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 14849 [episode count 0/20]
[retrieval_preprocessing] for episode 25119 [episode count 1/20], we have num_retrieval=np.int64(2724) num_query=np.int64(117)
2025-03-13 17:57:12,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:57:13,106 [INFO]: Launching the whole pipeline 03/13/2025, 17:57:13
2025-03-13 17:57:13,106 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:57:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.87it/s]
2025-03-13 17:57:13,133 [INFO]: There are 2724 embeddings of dim 49152
2025-03-13 17:57:13,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:57:13,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:57:13
2025-03-13 17:57:13,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:57:13,134 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:57:13,134 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:57:13,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:57:13,134 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:57:13
2025-03-13 17:57:13,135 [INFO]: 562.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:57:13,135 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 17:57:13,135 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:57:13
2025-03-13 17:57:13,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:57:13,136 [INFO]: 	Creating the index 03/13/2025, 17:57:13
2025-03-13 17:57:13,136 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:57:13
2025-03-13 17:57:13,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:57:13,140 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:57:13
2025-03-13 17:57:13,140 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:57:13,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.10it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.21it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.83it/s]
2025-03-13 17:57:15,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:57:15
2025-03-13 17:57:47,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4394 secs
2025-03-13 17:57:47,861 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 17:57:47,861 [INFO]: 	Compute fast metrics 03/13/2025, 17:57:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
2025-03-13 17:58:05,957 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0958 secs
2025-03-13 17:58:05,959 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8193 secs
2025-03-13 17:58:05,959 [INFO]: {
2025-03-13 17:58:05,959 [INFO]: 	index_key: HNSW15
2025-03-13 17:58:05,959 [INFO]: 	index_param: efSearch=173
2025-03-13 17:58:05,959 [INFO]: 	index_path: knn.index
2025-03-13 17:58:05,959 [INFO]: 	size in bytes: 535930090
2025-03-13 17:58:05,959 [INFO]: 	avg_search_speed_ms: 10.757828601736135
2025-03-13 17:58:05,959 [INFO]: 	99p_search_speed_ms: 22.186551163904383
2025-03-13 17:58:05,959 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:58:05,959 [INFO]: 	nb vectors: 2724
2025-03-13 17:58:05,959 [INFO]: 	vectors dimension: 49152
2025-03-13 17:58:05,959 [INFO]: 	compression ratio: 0.9993098017691077
2025-03-13 17:58:05,959 [INFO]: }
2025-03-13 17:58:05,959 [INFO]: 	>>> Finished "Creating the index" in 52.8232 secs
2025-03-13 17:58:05,959 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8536 secs
2025-03-13 17:58:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 25119 [episode count 1/20]
[retrieval_preprocessing] for episode 30757 [episode count 2/20], we have num_retrieval=np.int64(2652) num_query=np.int64(189)
2025-03-13 17:58:07,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:58:07,610 [INFO]: Launching the whole pipeline 03/13/2025, 17:58:07
2025-03-13 17:58:07,610 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1342.18it/s]
2025-03-13 17:58:07,637 [INFO]: There are 2652 embeddings of dim 49152
2025-03-13 17:58:07,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 17:58:07,638 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,638 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:58:07,638 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:58:07,638 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:58:07,638 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:58:07,638 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,638 [INFO]: 547.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:58:07,638 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:58:07,638 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:58:07
2025-03-13 17:58:07,638 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:58:07,638 [INFO]: 	Creating the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:58:07
2025-03-13 17:58:07,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:58:07,640 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:58:07
2025-03-13 17:58:07,640 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:58:07,640 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.41it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.63it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.97it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]
2025-03-13 17:58:10,564 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:58:10
2025-03-13 17:58:46,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5256 secs
2025-03-13 17:58:46,091 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 17:58:46,091 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.13it/s]
2025-03-13 17:59:10,419 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3279 secs
2025-03-13 17:59:10,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7824 secs
2025-03-13 17:59:10,422 [INFO]: {
2025-03-13 17:59:10,422 [INFO]: 	index_key: HNSW15
2025-03-13 17:59:10,422 [INFO]: 	index_param: efSearch=174
2025-03-13 17:59:10,422 [INFO]: 	index_path: knn.index
2025-03-13 17:59:10,422 [INFO]: 	size in bytes: 521764690
2025-03-13 17:59:10,422 [INFO]: 	avg_search_speed_ms: 8.609427389025162
2025-03-13 17:59:10,422 [INFO]: 	99p_search_speed_ms: 12.413481702096767
2025-03-13 17:59:10,422 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:10,422 [INFO]: 	nb vectors: 2652
2025-03-13 17:59:10,422 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:10,422 [INFO]: 	compression ratio: 0.9993095086599286
2025-03-13 17:59:10,422 [INFO]: }
2025-03-13 17:59:10,422 [INFO]: 	>>> Finished "Creating the index" in 62.7841 secs
2025-03-13 17:59:10,423 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8123 secs
2025-03-13 17:59:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 30757 [episode count 2/20]
[retrieval_preprocessing] for episode 40002 [episode count 3/20], we have num_retrieval=np.int64(2735) num_query=np.int64(106)
2025-03-13 17:59:12,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:12,506 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:12
2025-03-13 17:59:12,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1071.89it/s]
2025-03-13 17:59:12,533 [INFO]: There are 2735 embeddings of dim 49152
2025-03-13 17:59:12,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 17:59:12,534 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:12,534 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:59:12,534 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:59:12,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:12,534 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,534 [INFO]: 564.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:12,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:12,534 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:12
2025-03-13 17:59:12,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:12,534 [INFO]: 	Creating the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,534 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:59:12
2025-03-13 17:59:12,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:59:12,536 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:12
2025-03-13 17:59:12,536 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:59:12,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.78it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.83it/s]100%|██████████| 11/11 [00:02<00:00,  3.70it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-13 17:59:15,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:15
2025-03-13 17:59:54,527 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4653 secs
2025-03-13 17:59:54,527 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 17:59:54,528 [INFO]: 	Compute fast metrics 03/13/2025, 17:59:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.41it/s]
2025-03-13 18:00:19,019 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4910 secs
2025-03-13 18:00:19,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4857 secs
2025-03-13 18:00:19,022 [INFO]: {
2025-03-13 18:00:19,022 [INFO]: 	index_key: HNSW15
2025-03-13 18:00:19,022 [INFO]: 	index_param: efSearch=201
2025-03-13 18:00:19,022 [INFO]: 	index_path: knn.index
2025-03-13 18:00:19,022 [INFO]: 	size in bytes: 538094230
2025-03-13 18:00:19,022 [INFO]: 	avg_search_speed_ms: 10.945247652577706
2025-03-13 18:00:19,022 [INFO]: 	99p_search_speed_ms: 16.300629291217774
2025-03-13 18:00:19,022 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:00:19,022 [INFO]: 	nb vectors: 2735
2025-03-13 18:00:19,022 [INFO]: 	vectors dimension: 49152
2025-03-13 18:00:19,022 [INFO]: 	compression ratio: 0.9993098792380658
2025-03-13 18:00:19,022 [INFO]: }
2025-03-13 18:00:19,022 [INFO]: 	>>> Finished "Creating the index" in 66.4876 secs
2025-03-13 18:00:19,022 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5163 secs
2025-03-13 18:00:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:00:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 40002 [episode count 3/20]
[retrieval_preprocessing] for episode 48208 [episode count 4/20], we have num_retrieval=np.int64(2706) num_query=np.int64(135)
2025-03-13 18:00:20,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:00:20,776 [INFO]: Launching the whole pipeline 03/13/2025, 18:00:20
2025-03-13 18:00:20,776 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:00:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 724.78it/s]
2025-03-13 18:00:20,807 [INFO]: There are 2706 embeddings of dim 49152
2025-03-13 18:00:20,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 18:00:20,807 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:00:20,808 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:00:20,808 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:00:20,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:00:20,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,809 [INFO]: 558.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:00:20,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-13 18:00:20,810 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:00:20
2025-03-13 18:00:20,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:00:20,810 [INFO]: 	Creating the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,810 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:00:20
2025-03-13 18:00:20,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:00:20,814 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:00:20
2025-03-13 18:00:20,814 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:00:20,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.35it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.26it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]100%|██████████| 11/11 [00:02<00:00,  5.17it/s]
2025-03-13 18:00:23,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:00:23
2025-03-13 18:00:59,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0567 secs
2025-03-13 18:00:59,592 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:00:59,592 [INFO]: 	Compute fast metrics 03/13/2025, 18:00:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 18:01:21,642 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0490 secs
2025-03-13 18:01:21,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8300 secs
2025-03-13 18:01:21,644 [INFO]: {
2025-03-13 18:01:21,644 [INFO]: 	index_key: HNSW15
2025-03-13 18:01:21,644 [INFO]: 	index_param: efSearch=213
2025-03-13 18:01:21,644 [INFO]: 	index_path: knn.index
2025-03-13 18:01:21,644 [INFO]: 	size in bytes: 532388770
2025-03-13 18:01:21,644 [INFO]: 	avg_search_speed_ms: 9.00881347930277
2025-03-13 18:01:21,644 [INFO]: 	99p_search_speed_ms: 12.20557839144022
2025-03-13 18:01:21,644 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:01:21,644 [INFO]: 	nb vectors: 2706
2025-03-13 18:01:21,644 [INFO]: 	vectors dimension: 49152
2025-03-13 18:01:21,644 [INFO]: 	compression ratio: 0.9993096736431912
2025-03-13 18:01:21,644 [INFO]: }
2025-03-13 18:01:21,644 [INFO]: 	>>> Finished "Creating the index" in 60.8338 secs
2025-03-13 18:01:21,644 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8685 secs
2025-03-13 18:01:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:01:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 48208 [episode count 4/20]
[retrieval_preprocessing] for episode 87710 [episode count 5/20], we have num_retrieval=np.int64(2627) num_query=np.int64(214)
2025-03-13 18:01:23,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:01:23,977 [INFO]: Launching the whole pipeline 03/13/2025, 18:01:23
2025-03-13 18:01:23,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:01:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1857.53it/s]
2025-03-13 18:01:24,003 [INFO]: There are 2627 embeddings of dim 49152
2025-03-13 18:01:24,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 18:01:24,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:01:24
2025-03-13 18:01:24,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:01:24,003 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:01:24,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:01:24,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:01:24,004 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:01:24
2025-03-13 18:01:24,004 [INFO]: 542.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:01:24,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:01:24,004 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:01:24
2025-03-13 18:01:24,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:01:24,004 [INFO]: 	Creating the index 03/13/2025, 18:01:24
2025-03-13 18:01:24,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:01:24
2025-03-13 18:01:24,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:01:24,005 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:01:24
2025-03-13 18:01:24,005 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:01:24,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.73it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.68it/s]100%|██████████| 11/11 [00:01<00:00,  5.82it/s]
2025-03-13 18:01:25,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:01:25
2025-03-13 18:02:01,905 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0076 secs
2025-03-13 18:02:01,906 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:02:01,906 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.94it/s]
2025-03-13 18:02:22,013 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1074 secs
2025-03-13 18:02:22,015 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0104 secs
2025-03-13 18:02:22,015 [INFO]: {
2025-03-13 18:02:22,015 [INFO]: 	index_key: HNSW15
2025-03-13 18:02:22,015 [INFO]: 	index_param: efSearch=203
2025-03-13 18:02:22,016 [INFO]: 	index_path: knn.index
2025-03-13 18:02:22,016 [INFO]: 	size in bytes: 516846130
2025-03-13 18:02:22,016 [INFO]: 	avg_search_speed_ms: 9.242546208832902
2025-03-13 18:02:22,016 [INFO]: 	99p_search_speed_ms: 15.282385738100867
2025-03-13 18:02:22,016 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:22,016 [INFO]: 	nb vectors: 2627
2025-03-13 18:02:22,016 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:22,016 [INFO]: 	compression ratio: 0.9993094385750746
2025-03-13 18:02:22,016 [INFO]: }
2025-03-13 18:02:22,016 [INFO]: 	>>> Finished "Creating the index" in 58.0119 secs
2025-03-13 18:02:22,016 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0383 secs
2025-03-13 18:02:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 87710 [episode count 5/20]
[retrieval_preprocessing] for episode 77516 [episode count 6/20], we have num_retrieval=np.int64(2724) num_query=np.int64(117)
2025-03-13 18:02:23,864 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:24,310 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:24
2025-03-13 18:02:24,310 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 18:02:24,336 [INFO]: There are 2724 embeddings of dim 49152
2025-03-13 18:02:24,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 18:02:24,336 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:24
2025-03-13 18:02:24,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:24,337 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:02:24,337 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:02:24,337 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:02:24,337 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:24
2025-03-13 18:02:24,337 [INFO]: 562.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:24,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:02:24,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:24
2025-03-13 18:02:24,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:02:24,337 [INFO]: 	Creating the index 03/13/2025, 18:02:24
2025-03-13 18:02:24,337 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:02:24
2025-03-13 18:02:24,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:02:24,338 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:24
2025-03-13 18:02:24,338 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:02:24,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.50it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.02it/s]100%|██████████| 11/11 [00:01<00:00,  5.51it/s]
2025-03-13 18:02:26,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:02:26
2025-03-13 18:02:59,258 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9207 secs
2025-03-13 18:02:59,258 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:02:59,258 [INFO]: 	Compute fast metrics 03/13/2025, 18:02:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.26it/s]
2025-03-13 18:03:14,538 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2798 secs
2025-03-13 18:03:15,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9383 secs
2025-03-13 18:03:15,277 [INFO]: {
2025-03-13 18:03:15,277 [INFO]: 	index_key: HNSW15
2025-03-13 18:03:15,277 [INFO]: 	index_param: efSearch=160
2025-03-13 18:03:15,277 [INFO]: 	index_path: knn.index
2025-03-13 18:03:15,277 [INFO]: 	size in bytes: 535930090
2025-03-13 18:03:15,277 [INFO]: 	avg_search_speed_ms: 9.32028377493748
2025-03-13 18:03:15,277 [INFO]: 	99p_search_speed_ms: 14.266727780923246
2025-03-13 18:03:15,277 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:03:15,277 [INFO]: 	nb vectors: 2724
2025-03-13 18:03:15,277 [INFO]: 	vectors dimension: 49152
2025-03-13 18:03:15,277 [INFO]: 	compression ratio: 0.9993098017691077
2025-03-13 18:03:15,277 [INFO]: }
2025-03-13 18:03:15,278 [INFO]: 	>>> Finished "Creating the index" in 50.9405 secs
2025-03-13 18:03:15,278 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9674 secs
2025-03-13 18:03:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:03:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 77516 [episode count 6/20]
[retrieval_preprocessing] for episode 61136 [episode count 7/20], we have num_retrieval=np.int64(2727) num_query=np.int64(114)
2025-03-13 18:03:16,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:03:17,552 [INFO]: Launching the whole pipeline 03/13/2025, 18:03:17
2025-03-13 18:03:17,552 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:03:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.76it/s]
2025-03-13 18:03:17,580 [INFO]: There are 2727 embeddings of dim 49152
2025-03-13 18:03:17,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 18:03:17,580 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:03:17
2025-03-13 18:03:17,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:03:17,581 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:03:17,581 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:03:17,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:03:17,581 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:03:17
2025-03-13 18:03:17,581 [INFO]: 562.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:03:17,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:03:17,581 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:03:17
2025-03-13 18:03:17,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:03:17,581 [INFO]: 	Creating the index 03/13/2025, 18:03:17
2025-03-13 18:03:17,581 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:03:17
2025-03-13 18:03:17,582 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:03:17,582 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:03:17
2025-03-13 18:03:17,582 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:03:17,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.99it/s] 36%|███▋      | 4/11 [00:00<00:00, 18.09it/s] 64%|██████▎   | 7/11 [00:00<00:00, 21.19it/s] 91%|█████████ | 10/11 [00:00<00:00, 22.74it/s]100%|██████████| 11/11 [00:03<00:00,  3.30it/s]
2025-03-13 18:03:20,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:20
2025-03-13 18:03:54,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9683 secs
2025-03-13 18:03:54,891 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 18:03:54,891 [INFO]: 	Compute fast metrics 03/13/2025, 18:03:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-13 18:04:17,616 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7250 secs
2025-03-13 18:04:17,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0360 secs
2025-03-13 18:04:17,618 [INFO]: {
2025-03-13 18:04:17,618 [INFO]: 	index_key: HNSW15
2025-03-13 18:04:17,618 [INFO]: 	index_param: efSearch=225
2025-03-13 18:04:17,618 [INFO]: 	index_path: knn.index
2025-03-13 18:04:17,618 [INFO]: 	size in bytes: 536520310
2025-03-13 18:04:17,618 [INFO]: 	avg_search_speed_ms: 10.992599067349847
2025-03-13 18:04:17,618 [INFO]: 	99p_search_speed_ms: 18.681014685425907
2025-03-13 18:04:17,618 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:04:17,618 [INFO]: 	nb vectors: 2727
2025-03-13 18:04:17,618 [INFO]: 	vectors dimension: 49152
2025-03-13 18:04:17,618 [INFO]: 	compression ratio: 0.9993098229589855
2025-03-13 18:04:17,619 [INFO]: }
2025-03-13 18:04:17,619 [INFO]: 	>>> Finished "Creating the index" in 60.0376 secs
2025-03-13 18:04:17,619 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0665 secs
2025-03-13 18:04:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:04:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 61136 [episode count 7/20]
[retrieval_preprocessing] for episode 49895 [episode count 8/20], we have num_retrieval=np.int64(2712) num_query=np.int64(129)
2025-03-13 18:04:20,091 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:04:20,542 [INFO]: Launching the whole pipeline 03/13/2025, 18:04:20
2025-03-13 18:04:20,542 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:04:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-13 18:04:20,564 [INFO]: There are 2712 embeddings of dim 49152
2025-03-13 18:04:20,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 18:04:20,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:04:20
2025-03-13 18:04:20,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:04:20,565 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:04:20,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:04:20,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:04:20,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:04:20
2025-03-13 18:04:20,565 [INFO]: 559.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:04:20,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:04:20,565 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:04:20
2025-03-13 18:04:20,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:04:20,565 [INFO]: 	Creating the index 03/13/2025, 18:04:20
2025-03-13 18:04:20,565 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:04:20
2025-03-13 18:04:20,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:04:20,566 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:04:20
2025-03-13 18:04:20,566 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:04:20,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.59it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.50it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]100%|██████████| 11/11 [00:02<00:00,  4.89it/s]
2025-03-13 18:04:22,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:04:22
2025-03-13 18:04:55,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8300 secs
2025-03-13 18:04:55,651 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:04:55,652 [INFO]: 	Compute fast metrics 03/13/2025, 18:04:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-13 18:05:21,574 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9221 secs
2025-03-13 18:05:21,576 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0093 secs
2025-03-13 18:05:21,576 [INFO]: {
2025-03-13 18:05:21,576 [INFO]: 	index_key: HNSW15
2025-03-13 18:05:21,576 [INFO]: 	index_param: efSearch=204
2025-03-13 18:05:21,576 [INFO]: 	index_path: knn.index
2025-03-13 18:05:21,576 [INFO]: 	size in bytes: 533569210
2025-03-13 18:05:21,576 [INFO]: 	avg_search_speed_ms: 8.890924640413788
2025-03-13 18:05:21,576 [INFO]: 	99p_search_speed_ms: 12.494148286059499
2025-03-13 18:05:21,576 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:05:21,576 [INFO]: 	nb vectors: 2712
2025-03-13 18:05:21,576 [INFO]: 	vectors dimension: 49152
2025-03-13 18:05:21,576 [INFO]: 	compression ratio: 0.9993097165408027
2025-03-13 18:05:21,576 [INFO]: }
2025-03-13 18:05:21,576 [INFO]: 	>>> Finished "Creating the index" in 61.0107 secs
2025-03-13 18:05:21,576 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0342 secs
2025-03-13 18:05:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:05:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 49895 [episode count 8/20]
[retrieval_preprocessing] for episode 52469 [episode count 9/20], we have num_retrieval=np.int64(2689) num_query=np.int64(152)
2025-03-13 18:05:23,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:05:23,530 [INFO]: Launching the whole pipeline 03/13/2025, 18:05:23
2025-03-13 18:05:23,530 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:05:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2101.35it/s]
2025-03-13 18:05:23,555 [INFO]: There are 2689 embeddings of dim 49152
2025-03-13 18:05:23,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:05:23,555 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:05:23
2025-03-13 18:05:23,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:05:23,555 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:05:23,555 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:05:23,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:05:23,556 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:05:23
2025-03-13 18:05:23,556 [INFO]: 554.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:05:23,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:05:23,556 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:05:23
2025-03-13 18:05:23,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:05:23,556 [INFO]: 	Creating the index 03/13/2025, 18:05:23
2025-03-13 18:05:23,556 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:05:23
2025-03-13 18:05:23,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:05:23,557 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:05:23
2025-03-13 18:05:23,557 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:05:23,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.57it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.24it/s]100%|██████████| 11/11 [00:02<00:00,  4.13it/s]100%|██████████| 11/11 [00:02<00:00,  5.12it/s]
2025-03-13 18:05:25,708 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:05:25
2025-03-13 18:05:58,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6622 secs
2025-03-13 18:05:58,370 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 18:05:58,370 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-13 18:06:31,804 [INFO]: 	>>> Finished "Compute fast metrics" in 33.4338 secs
2025-03-13 18:06:31,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2493 secs
2025-03-13 18:06:31,806 [INFO]: {
2025-03-13 18:06:31,806 [INFO]: 	index_key: HNSW15
2025-03-13 18:06:31,806 [INFO]: 	index_param: efSearch=199
2025-03-13 18:06:31,806 [INFO]: 	index_path: knn.index
2025-03-13 18:06:31,806 [INFO]: 	size in bytes: 529044070
2025-03-13 18:06:31,806 [INFO]: 	avg_search_speed_ms: 9.654597865829324
2025-03-13 18:06:31,806 [INFO]: 	99p_search_speed_ms: 17.002363607753114
2025-03-13 18:06:31,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:31,806 [INFO]: 	nb vectors: 2689
2025-03-13 18:06:31,806 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:31,806 [INFO]: 	compression ratio: 0.9993097777279689
2025-03-13 18:06:31,806 [INFO]: }
2025-03-13 18:06:31,806 [INFO]: 	>>> Finished "Creating the index" in 68.2506 secs
2025-03-13 18:06:31,806 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2765 secs
2025-03-13 18:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 52469 [episode count 9/20]
[retrieval_preprocessing] for episode 66297 [episode count 10/20], we have num_retrieval=np.int64(2703) num_query=np.int64(138)
2025-03-13 18:06:33,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:33,367 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:33
2025-03-13 18:06:33,368 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-13 18:06:33,395 [INFO]: There are 2703 embeddings of dim 49152
2025-03-13 18:06:33,395 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:06:33,395 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:33
2025-03-13 18:06:33,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:33,395 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:06:33,395 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:06:33,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:06:33,395 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:33
2025-03-13 18:06:33,395 [INFO]: 557.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:33,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:06:33,395 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:33
2025-03-13 18:06:33,395 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:06:33,395 [INFO]: 	Creating the index 03/13/2025, 18:06:33
2025-03-13 18:06:33,395 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:06:33
2025-03-13 18:06:33,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:06:33,396 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:33
2025-03-13 18:06:33,396 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:06:33,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.89it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.15it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-13 18:06:35,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:35
2025-03-13 18:07:18,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5314 secs
2025-03-13 18:07:18,451 [INFO]: The best hyperparameters are: efSearch=155
2025-03-13 18:07:18,451 [INFO]: 	Compute fast metrics 03/13/2025, 18:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-13 18:07:36,810 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3585 secs
2025-03-13 18:07:36,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4160 secs
2025-03-13 18:07:36,813 [INFO]: {
2025-03-13 18:07:36,813 [INFO]: 	index_key: HNSW15
2025-03-13 18:07:36,813 [INFO]: 	index_param: efSearch=155
2025-03-13 18:07:36,813 [INFO]: 	index_path: knn.index
2025-03-13 18:07:36,813 [INFO]: 	size in bytes: 531798550
2025-03-13 18:07:36,813 [INFO]: 	avg_search_speed_ms: 8.50497637649675
2025-03-13 18:07:36,813 [INFO]: 	99p_search_speed_ms: 13.663707708474249
2025-03-13 18:07:36,813 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:07:36,813 [INFO]: 	nb vectors: 2703
2025-03-13 18:07:36,813 [INFO]: 	vectors dimension: 49152
2025-03-13 18:07:36,813 [INFO]: 	compression ratio: 0.9993096521229703
2025-03-13 18:07:36,813 [INFO]: }
2025-03-13 18:07:36,813 [INFO]: 	>>> Finished "Creating the index" in 63.4176 secs
2025-03-13 18:07:36,813 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4453 secs
2025-03-13 18:07:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:07:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 66297 [episode count 10/20]
[retrieval_preprocessing] for episode 92931 [episode count 11/20], we have num_retrieval=np.int64(2700) num_query=np.int64(141)
2025-03-13 18:07:38,343 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:07:38,796 [INFO]: Launching the whole pipeline 03/13/2025, 18:07:38
2025-03-13 18:07:38,796 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:07:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2461.45it/s]
2025-03-13 18:07:38,823 [INFO]: There are 2700 embeddings of dim 49152
2025-03-13 18:07:38,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 18:07:38,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:07:38
2025-03-13 18:07:38,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:07:38,824 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:07:38,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:07:38,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:07:38,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:07:38
2025-03-13 18:07:38,824 [INFO]: 557.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:07:38,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:07:38,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:07:38
2025-03-13 18:07:38,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:07:38,824 [INFO]: 	Creating the index 03/13/2025, 18:07:38
2025-03-13 18:07:38,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:07:38
2025-03-13 18:07:38,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:07:38,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:07:38
2025-03-13 18:07:38,825 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:07:38,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.90it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.38it/s] 91%|█████████ | 10/11 [00:00<00:00, 30.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]
2025-03-13 18:07:41,306 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:07:41
2025-03-13 18:08:19,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6408 secs
2025-03-13 18:08:19,948 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 18:08:19,948 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 18:08:44,843 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8949 secs
2025-03-13 18:08:44,845 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0197 secs
2025-03-13 18:08:44,845 [INFO]: {
2025-03-13 18:08:44,845 [INFO]: 	index_key: HNSW15
2025-03-13 18:08:44,845 [INFO]: 	index_param: efSearch=168
2025-03-13 18:08:44,845 [INFO]: 	index_path: knn.index
2025-03-13 18:08:44,845 [INFO]: 	size in bytes: 531208270
2025-03-13 18:08:44,845 [INFO]: 	avg_search_speed_ms: 7.649394415793534
2025-03-13 18:08:44,845 [INFO]: 	99p_search_speed_ms: 10.926042376086116
2025-03-13 18:08:44,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:08:44,845 [INFO]: 	nb vectors: 2700
2025-03-13 18:08:44,845 [INFO]: 	vectors dimension: 49152
2025-03-13 18:08:44,845 [INFO]: 	compression ratio: 0.999309743426999
2025-03-13 18:08:44,845 [INFO]: }
2025-03-13 18:08:44,845 [INFO]: 	>>> Finished "Creating the index" in 66.0210 secs
2025-03-13 18:08:44,845 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0486 secs
2025-03-13 18:08:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:08:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 92931 [episode count 11/20]
[retrieval_preprocessing] for episode 90381 [episode count 12/20], we have num_retrieval=np.int64(2632) num_query=np.int64(209)
2025-03-13 18:08:45,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:08:46,351 [INFO]: Launching the whole pipeline 03/13/2025, 18:08:46
2025-03-13 18:08:46,352 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:08:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1823.61it/s]
2025-03-13 18:08:46,375 [INFO]: There are 2632 embeddings of dim 49152
2025-03-13 18:08:46,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 18:08:46,376 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:08:46
2025-03-13 18:08:46,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:08:46,376 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:08:46,376 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:08:46,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:08:46,376 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:08:46
2025-03-13 18:08:46,376 [INFO]: 543.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:08:46,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:08:46,376 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:08:46
2025-03-13 18:08:46,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:08:46,376 [INFO]: 	Creating the index 03/13/2025, 18:08:46
2025-03-13 18:08:46,376 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:08:46
2025-03-13 18:08:46,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:08:46,377 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:08:46
2025-03-13 18:08:46,377 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:08:46,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.37it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.00it/s]100%|██████████| 11/11 [00:02<00:00,  4.57it/s]100%|██████████| 11/11 [00:02<00:00,  5.35it/s]
2025-03-13 18:08:48,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:08:48
2025-03-13 18:09:18,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9586 secs
2025-03-13 18:09:18,395 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:09:18,395 [INFO]: 	Compute fast metrics 03/13/2025, 18:09:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-13 18:09:43,574 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1789 secs
2025-03-13 18:09:44,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8722 secs
2025-03-13 18:09:44,250 [INFO]: {
2025-03-13 18:09:44,250 [INFO]: 	index_key: HNSW15
2025-03-13 18:09:44,250 [INFO]: 	index_param: efSearch=216
2025-03-13 18:09:44,250 [INFO]: 	index_path: knn.index
2025-03-13 18:09:44,250 [INFO]: 	size in bytes: 517829890
2025-03-13 18:09:44,250 [INFO]: 	avg_search_speed_ms: 11.4854325235091
2025-03-13 18:09:44,250 [INFO]: 	99p_search_speed_ms: 17.375914473086596
2025-03-13 18:09:44,250 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:44,250 [INFO]: 	nb vectors: 2632
2025-03-13 18:09:44,250 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:44,250 [INFO]: 	compression ratio: 0.9993093600680332
2025-03-13 18:09:44,250 [INFO]: }
2025-03-13 18:09:44,250 [INFO]: 	>>> Finished "Creating the index" in 57.8744 secs
2025-03-13 18:09:44,251 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8989 secs
2025-03-13 18:09:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 90381 [episode count 12/20]
[retrieval_preprocessing] for episode 80192 [episode count 13/20], we have num_retrieval=np.int64(2705) num_query=np.int64(136)
2025-03-13 18:09:46,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:46,642 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:46
2025-03-13 18:09:46,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.46it/s]
2025-03-13 18:09:46,666 [INFO]: There are 2705 embeddings of dim 49152
2025-03-13 18:09:46,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 18:09:46,667 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:46
2025-03-13 18:09:46,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:46,667 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:09:46,667 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:09:46,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:09:46,667 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:46
2025-03-13 18:09:46,667 [INFO]: 558.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:46,667 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:09:46,667 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:46
2025-03-13 18:09:46,667 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:46,667 [INFO]: 	Creating the index 03/13/2025, 18:09:46
2025-03-13 18:09:46,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:09:46
2025-03-13 18:09:46,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:09:46,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:46
2025-03-13 18:09:46,669 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:09:46,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.29it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.70it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.15it/s]100%|██████████| 11/11 [00:02<00:00,  3.93it/s]
2025-03-13 18:09:49,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:09:49
2025-03-13 18:10:26,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0378 secs
2025-03-13 18:10:26,515 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 18:10:26,515 [INFO]: 	Compute fast metrics 03/13/2025, 18:10:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.83it/s]
2025-03-13 18:10:42,151 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6358 secs
2025-03-13 18:10:42,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4838 secs
2025-03-13 18:10:42,153 [INFO]: {
2025-03-13 18:10:42,153 [INFO]: 	index_key: HNSW15
2025-03-13 18:10:42,153 [INFO]: 	index_param: efSearch=169
2025-03-13 18:10:42,153 [INFO]: 	index_path: knn.index
2025-03-13 18:10:42,153 [INFO]: 	size in bytes: 532192030
2025-03-13 18:10:42,153 [INFO]: 	avg_search_speed_ms: 8.25799326854585
2025-03-13 18:10:42,153 [INFO]: 	99p_search_speed_ms: 11.211439035832882
2025-03-13 18:10:42,153 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:10:42,153 [INFO]: 	nb vectors: 2705
2025-03-13 18:10:42,153 [INFO]: 	vectors dimension: 49152
2025-03-13 18:10:42,153 [INFO]: 	compression ratio: 0.9993096664750879
2025-03-13 18:10:42,153 [INFO]: }
2025-03-13 18:10:42,153 [INFO]: 	>>> Finished "Creating the index" in 55.4857 secs
2025-03-13 18:10:42,153 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5116 secs
2025-03-13 18:10:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:10:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 80192 [episode count 13/20]
[retrieval_preprocessing] for episode 91979 [episode count 14/20], we have num_retrieval=np.int64(2676) num_query=np.int64(165)
2025-03-13 18:10:43,279 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:10:43,788 [INFO]: Launching the whole pipeline 03/13/2025, 18:10:43
2025-03-13 18:10:43,788 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:10:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2160.90it/s]
2025-03-13 18:10:43,816 [INFO]: There are 2676 embeddings of dim 49152
2025-03-13 18:10:43,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 18:10:43,817 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:10:43
2025-03-13 18:10:43,817 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:10:43,817 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:10:43,817 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:10:43,817 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:10:43,817 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:10:43
2025-03-13 18:10:43,818 [INFO]: 552.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:10:43,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:10:43,818 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:10:43
2025-03-13 18:10:43,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:10:43,818 [INFO]: 	Creating the index 03/13/2025, 18:10:43
2025-03-13 18:10:43,819 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:10:43
2025-03-13 18:10:43,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:10:43,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:10:43
2025-03-13 18:10:43,822 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:10:43,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.10it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.28it/s]100%|██████████| 11/11 [00:02<00:00,  4.24it/s]100%|██████████| 11/11 [00:02<00:00,  5.25it/s]
2025-03-13 18:10:45,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:45
2025-03-13 18:11:17,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8038 secs
2025-03-13 18:11:17,729 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 18:11:17,729 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 18:11:48,737 [INFO]: 	>>> Finished "Compute fast metrics" in 31.0077 secs
2025-03-13 18:11:48,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9163 secs
2025-03-13 18:11:48,739 [INFO]: {
2025-03-13 18:11:48,739 [INFO]: 	index_key: HNSW15
2025-03-13 18:11:48,739 [INFO]: 	index_param: efSearch=146
2025-03-13 18:11:48,739 [INFO]: 	index_path: knn.index
2025-03-13 18:11:48,739 [INFO]: 	size in bytes: 526486450
2025-03-13 18:11:48,739 [INFO]: 	avg_search_speed_ms: 7.11540573598068
2025-03-13 18:11:48,739 [INFO]: 	99p_search_speed_ms: 10.645176293328406
2025-03-13 18:11:48,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:11:48,739 [INFO]: 	nb vectors: 2676
2025-03-13 18:11:48,739 [INFO]: 	vectors dimension: 49152
2025-03-13 18:11:48,739 [INFO]: 	compression ratio: 0.9993096840384021
2025-03-13 18:11:48,739 [INFO]: }
2025-03-13 18:11:48,739 [INFO]: 	>>> Finished "Creating the index" in 64.9204 secs
2025-03-13 18:11:48,739 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9511 secs
2025-03-13 18:11:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 91979 [episode count 14/20]
[retrieval_preprocessing] for episode 70501 [episode count 15/20], we have num_retrieval=np.int64(2687) num_query=np.int64(154)
2025-03-13 18:11:49,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:11:50,878 [INFO]: Launching the whole pipeline 03/13/2025, 18:11:50
2025-03-13 18:11:50,878 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 949.58it/s]
2025-03-13 18:11:50,911 [INFO]: There are 2687 embeddings of dim 49152
2025-03-13 18:11:50,911 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 18:11:50,911 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:11:50
2025-03-13 18:11:50,912 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:11:50,912 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:11:50,912 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:11:50,912 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:11:50,912 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:11:50
2025-03-13 18:11:50,912 [INFO]: 554.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:11:50,912 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:11:50,912 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:11:50
2025-03-13 18:11:50,912 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:11:50,912 [INFO]: 	Creating the index 03/13/2025, 18:11:50
2025-03-13 18:11:50,912 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:11:50
2025-03-13 18:11:50,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 18:11:50,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:11:50
2025-03-13 18:11:50,914 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:11:50,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.51it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.50it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.10it/s]
2025-03-13 18:11:53,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:11:53
2025-03-13 18:12:29,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1676 secs
2025-03-13 18:12:29,245 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 18:12:29,245 [INFO]: 	Compute fast metrics 03/13/2025, 18:12:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 18:12:52,851 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6063 secs
2025-03-13 18:12:52,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9399 secs
2025-03-13 18:12:52,854 [INFO]: {
2025-03-13 18:12:52,854 [INFO]: 	index_key: HNSW15
2025-03-13 18:12:52,854 [INFO]: 	index_param: efSearch=160
2025-03-13 18:12:52,854 [INFO]: 	index_path: knn.index
2025-03-13 18:12:52,854 [INFO]: 	size in bytes: 528650590
2025-03-13 18:12:52,854 [INFO]: 	avg_search_speed_ms: 9.70152224717566
2025-03-13 18:12:52,854 [INFO]: 	99p_search_speed_ms: 14.954956364817917
2025-03-13 18:12:52,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:52,854 [INFO]: 	nb vectors: 2687
2025-03-13 18:12:52,854 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:52,854 [INFO]: 	compression ratio: 0.9993097633731951
2025-03-13 18:12:52,854 [INFO]: }
2025-03-13 18:12:52,854 [INFO]: 	>>> Finished "Creating the index" in 61.9423 secs
2025-03-13 18:12:52,854 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9764 secs
2025-03-13 18:12:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 70501 [episode count 15/20]
[retrieval_preprocessing] for episode 81254 [episode count 16/20], we have num_retrieval=np.int64(2720) num_query=np.int64(121)
2025-03-13 18:12:54,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:55,082 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:55
2025-03-13 18:12:55,082 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1480.52it/s]
2025-03-13 18:12:55,109 [INFO]: There are 2720 embeddings of dim 49152
2025-03-13 18:12:55,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 18:12:55,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:55,110 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:12:55,110 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:12:55,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:12:55,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,110 [INFO]: 561.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:55,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:12:55,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:55
2025-03-13 18:12:55,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:12:55,110 [INFO]: 	Creating the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,110 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:12:55
2025-03-13 18:12:55,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:12:55,111 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:55
2025-03-13 18:12:55,111 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:12:55,111 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 45%|████▌     | 5/11 [00:00<00:00, 20.73it/s] 82%|████████▏ | 9/11 [00:00<00:00, 27.44it/s]100%|██████████| 11/11 [00:03<00:00,  3.50it/s]
2025-03-13 18:12:58,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:12:58
2025-03-13 18:13:32,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0573 secs
2025-03-13 18:13:32,314 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 18:13:32,314 [INFO]: 	Compute fast metrics 03/13/2025, 18:13:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.71it/s]
2025-03-13 18:14:03,467 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1527 secs
2025-03-13 18:14:03,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3577 secs
2025-03-13 18:14:03,469 [INFO]: {
2025-03-13 18:14:03,469 [INFO]: 	index_key: HNSW15
2025-03-13 18:14:03,469 [INFO]: 	index_param: efSearch=195
2025-03-13 18:14:03,469 [INFO]: 	index_path: knn.index
2025-03-13 18:14:03,469 [INFO]: 	size in bytes: 535143130
2025-03-13 18:14:03,469 [INFO]: 	avg_search_speed_ms: 8.623906721738328
2025-03-13 18:14:03,469 [INFO]: 	99p_search_speed_ms: 13.333387735765431
2025-03-13 18:14:03,469 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:14:03,469 [INFO]: 	nb vectors: 2720
2025-03-13 18:14:03,469 [INFO]: 	vectors dimension: 49152
2025-03-13 18:14:03,469 [INFO]: 	compression ratio: 0.9993097734432281
2025-03-13 18:14:03,469 [INFO]: }
2025-03-13 18:14:03,469 [INFO]: 	>>> Finished "Creating the index" in 68.3594 secs
2025-03-13 18:14:03,469 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3873 secs
2025-03-13 18:14:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:14:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 81254 [episode count 16/20]
[retrieval_preprocessing] for episode 46972 [episode count 17/20], we have num_retrieval=np.int64(2733) num_query=np.int64(108)
2025-03-13 18:14:04,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:14:05,419 [INFO]: Launching the whole pipeline 03/13/2025, 18:14:05
2025-03-13 18:14:05,419 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:14:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.55it/s]
2025-03-13 18:14:05,450 [INFO]: There are 2733 embeddings of dim 49152
2025-03-13 18:14:05,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:14:05,450 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:14:05
2025-03-13 18:14:05,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:14:05,450 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:14:05,450 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:14:05,450 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:14:05,450 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:14:05
2025-03-13 18:14:05,450 [INFO]: 564.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:14:05,450 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:14:05,450 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:14:05
2025-03-13 18:14:05,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:14:05,451 [INFO]: 	Creating the index 03/13/2025, 18:14:05
2025-03-13 18:14:05,451 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:14:05
2025-03-13 18:14:05,452 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:14:05,452 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:14:05
2025-03-13 18:14:05,452 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:14:05,452 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.24it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.70it/s]100%|██████████| 11/11 [00:02<00:00,  3.45it/s]100%|██████████| 11/11 [00:02<00:00,  4.30it/s]
2025-03-13 18:14:08,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:14:08
2025-03-13 18:14:44,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2053 secs
2025-03-13 18:14:44,221 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 18:14:44,221 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 18:15:00,309 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0875 secs
2025-03-13 18:15:00,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8586 secs
2025-03-13 18:15:00,311 [INFO]: {
2025-03-13 18:15:00,311 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:00,311 [INFO]: 	index_param: efSearch=96
2025-03-13 18:15:00,311 [INFO]: 	index_path: knn.index
2025-03-13 18:15:00,311 [INFO]: 	size in bytes: 537700750
2025-03-13 18:15:00,311 [INFO]: 	avg_search_speed_ms: 5.182337130170302
2025-03-13 18:15:00,311 [INFO]: 	99p_search_speed_ms: 7.568058855831624
2025-03-13 18:15:00,311 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:00,311 [INFO]: 	nb vectors: 2733
2025-03-13 18:15:00,311 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:00,311 [INFO]: 	compression ratio: 0.9993098651991837
2025-03-13 18:15:00,311 [INFO]: }
2025-03-13 18:15:00,311 [INFO]: 	>>> Finished "Creating the index" in 54.8605 secs
2025-03-13 18:15:00,311 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8917 secs
2025-03-13 18:15:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 46972 [episode count 17/20]
[retrieval_preprocessing] for episode 20883 [episode count 18/20], we have num_retrieval=np.int64(2708) num_query=np.int64(133)
2025-03-13 18:15:05,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:05,672 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:05
2025-03-13 18:15:05,672 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.48it/s]
2025-03-13 18:15:05,698 [INFO]: There are 2708 embeddings of dim 49152
2025-03-13 18:15:05,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 18:15:05,698 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:05
2025-03-13 18:15:05,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:05,698 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:15:05,698 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:05,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:05,699 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:05
2025-03-13 18:15:05,699 [INFO]: 558.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:05,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:15:05,699 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:05
2025-03-13 18:15:05,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:05,699 [INFO]: 	Creating the index 03/13/2025, 18:15:05
2025-03-13 18:15:05,699 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:05
2025-03-13 18:15:05,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:15:05,700 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:05
2025-03-13 18:15:05,700 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:15:05,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.53it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.17it/s]100%|██████████| 11/11 [00:02<00:00,  4.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.94it/s]
2025-03-13 18:15:07,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:07
2025-03-13 18:15:35,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9673 secs
2025-03-13 18:15:35,899 [INFO]: The best hyperparameters are: efSearch=85
2025-03-13 18:15:35,899 [INFO]: 	Compute fast metrics 03/13/2025, 18:15:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.52it/s]
2025-03-13 18:15:53,741 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8424 secs
2025-03-13 18:15:53,743 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0429 secs
2025-03-13 18:15:53,743 [INFO]: {
2025-03-13 18:15:53,743 [INFO]: 	index_key: HNSW15
2025-03-13 18:15:53,743 [INFO]: 	index_param: efSearch=85
2025-03-13 18:15:53,743 [INFO]: 	index_path: knn.index
2025-03-13 18:15:53,743 [INFO]: 	size in bytes: 532782250
2025-03-13 18:15:53,743 [INFO]: 	avg_search_speed_ms: 5.386965053887629
2025-03-13 18:15:53,743 [INFO]: 	99p_search_speed_ms: 8.013749856036156
2025-03-13 18:15:53,743 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:53,743 [INFO]: 	nb vectors: 2708
2025-03-13 18:15:53,743 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:53,743 [INFO]: 	compression ratio: 0.999309687963516
2025-03-13 18:15:53,743 [INFO]: }
2025-03-13 18:15:53,743 [INFO]: 	>>> Finished "Creating the index" in 48.0445 secs
2025-03-13 18:15:53,743 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0717 secs
2025-03-13 18:15:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:15:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 20883 [episode count 18/20]
[retrieval_preprocessing] for episode 11181 [episode count 19/20], we have num_retrieval=np.int64(2724) num_query=np.int64(117)
2025-03-13 18:15:54,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:15:55,102 [INFO]: Launching the whole pipeline 03/13/2025, 18:15:55
2025-03-13 18:15:55,102 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:15:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.87it/s]
2025-03-13 18:15:55,126 [INFO]: There are 2724 embeddings of dim 49152
2025-03-13 18:15:55,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:15:55,126 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:15:55
2025-03-13 18:15:55,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:15:55,126 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:15:55,126 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:15:55,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:15:55,126 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:15:55
2025-03-13 18:15:55,126 [INFO]: 562.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:15:55,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:15:55,126 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:15:55
2025-03-13 18:15:55,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:15:55,126 [INFO]: 	Creating the index 03/13/2025, 18:15:55
2025-03-13 18:15:55,126 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:15:55
2025-03-13 18:15:55,127 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:15:55,128 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:15:55
2025-03-13 18:15:55,128 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:15:55,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.77it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.41it/s]100%|██████████| 11/11 [00:03<00:00,  2.85it/s]100%|██████████| 11/11 [00:03<00:00,  3.59it/s]
2025-03-13 18:15:58,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:15:58
2025-03-13 18:16:37,958 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7580 secs
2025-03-13 18:16:37,958 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:16:37,958 [INFO]: 	Compute fast metrics 03/13/2025, 18:16:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.87it/s]
2025-03-13 18:17:08,293 [INFO]: 	>>> Finished "Compute fast metrics" in 30.3349 secs
2025-03-13 18:17:08,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1677 secs
2025-03-13 18:17:08,296 [INFO]: {
2025-03-13 18:17:08,296 [INFO]: 	index_key: HNSW15
2025-03-13 18:17:08,296 [INFO]: 	index_param: efSearch=224
2025-03-13 18:17:08,296 [INFO]: 	index_path: knn.index
2025-03-13 18:17:08,296 [INFO]: 	size in bytes: 535930090
2025-03-13 18:17:08,296 [INFO]: 	avg_search_speed_ms: 9.751409953269476
2025-03-13 18:17:08,296 [INFO]: 	99p_search_speed_ms: 13.420702598523349
2025-03-13 18:17:08,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:17:08,296 [INFO]: 	nb vectors: 2724
2025-03-13 18:17:08,296 [INFO]: 	vectors dimension: 49152
2025-03-13 18:17:08,296 [INFO]: 	compression ratio: 0.9993098017691077
2025-03-13 18:17:08,296 [INFO]: }
2025-03-13 18:17:08,296 [INFO]: 	>>> Finished "Creating the index" in 73.1693 secs
2025-03-13 18:17:08,296 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1935 secs
2025-03-13 18:17:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:17:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 11181 [episode count 19/20]
2025-03-13 18:17:09: [retrieval_preprocessing] finished for 2883696971_put_rubber_band_on_jar [chosen_id count 7/196]
2025-03-13 18:17:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2883696971_put_rubber_band_on_cup [chosen_id count 8/196]
2025-03-13 18:17:10: [retrieval_preprocessing] we have num_total=2770 embedding_dim=49152
[retrieval_preprocessing] for episode 30724 [episode count 0/20], we have num_retrieval=np.int64(2611) num_query=np.int64(159)
2025-03-13 18:17:10,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:17:12,084 [INFO]: Launching the whole pipeline 03/13/2025, 18:17:12
2025-03-13 18:17:12,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:17:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1345.19it/s]
2025-03-13 18:17:12,127 [INFO]: There are 2611 embeddings of dim 49152
2025-03-13 18:17:12,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0433 secs
2025-03-13 18:17:12,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:17:12
2025-03-13 18:17:12,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:17:12,128 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:17:12,129 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:17:12,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:17:12,129 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:17:12
2025-03-13 18:17:12,129 [INFO]: 538.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:17:12,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:17:12,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:17:12
2025-03-13 18:17:12,130 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:17:12,130 [INFO]: 	Creating the index 03/13/2025, 18:17:12
2025-03-13 18:17:12,130 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:17:12
2025-03-13 18:17:12,133 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 18:17:12,133 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:17:12
2025-03-13 18:17:12,134 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:17:12,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.93it/s] 45%|████▌     | 5/11 [00:00<00:00, 26.95it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.65it/s]100%|██████████| 11/11 [00:02<00:00,  5.00it/s]
2025-03-13 18:17:14,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:17:14
2025-03-13 18:17:51,573 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2315 secs
2025-03-13 18:17:51,573 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:17:51,573 [INFO]: 	Compute fast metrics 03/13/2025, 18:17:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.30it/s]
2025-03-13 18:18:09,715 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1421 secs
2025-03-13 18:18:09,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5836 secs
2025-03-13 18:18:09,718 [INFO]: {
2025-03-13 18:18:09,718 [INFO]: 	index_key: HNSW15
2025-03-13 18:18:09,718 [INFO]: 	index_param: efSearch=220
2025-03-13 18:18:09,718 [INFO]: 	index_path: knn.index
2025-03-13 18:18:09,718 [INFO]: 	size in bytes: 513698170
2025-03-13 18:18:09,718 [INFO]: 	avg_search_speed_ms: 9.557319852837505
2025-03-13 18:18:09,718 [INFO]: 	99p_search_speed_ms: 15.23262779228389
2025-03-13 18:18:09,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:18:09,718 [INFO]: 	nb vectors: 2611
2025-03-13 18:18:09,718 [INFO]: 	vectors dimension: 49152
2025-03-13 18:18:09,718 [INFO]: 	compression ratio: 0.9993095517548758
2025-03-13 18:18:09,718 [INFO]: }
2025-03-13 18:18:09,718 [INFO]: 	>>> Finished "Creating the index" in 57.5881 secs
2025-03-13 18:18:09,718 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6337 secs
2025-03-13 18:18:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:18:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 30724 [episode count 0/20]
[retrieval_preprocessing] for episode 47184 [episode count 1/20], we have num_retrieval=np.int64(2611) num_query=np.int64(159)
2025-03-13 18:18:11,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:18:12,115 [INFO]: Launching the whole pipeline 03/13/2025, 18:18:12
2025-03-13 18:18:12,115 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:18:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1033.59it/s]
2025-03-13 18:18:12,507 [INFO]: There are 2611 embeddings of dim 49152
2025-03-13 18:18:12,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3916 secs
2025-03-13 18:18:12,507 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:18:12,507 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:18:12,508 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:18:12,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:18:12,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,508 [INFO]: 538.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:18:12,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:18:12,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:18:12
2025-03-13 18:18:12,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:18:12,508 [INFO]: 	Creating the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:18:12
2025-03-13 18:18:12,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:18:12,511 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:18:12
2025-03-13 18:18:12,511 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:18:12,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.41it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.14it/s]100%|██████████| 11/11 [00:02<00:00,  5.15it/s]
2025-03-13 18:18:14,652 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:18:14
2025-03-13 18:18:43,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8538 secs
2025-03-13 18:18:43,506 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 18:18:43,506 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-13 18:19:09,389 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8822 secs
2025-03-13 18:19:09,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8798 secs
2025-03-13 18:19:09,391 [INFO]: {
2025-03-13 18:19:09,391 [INFO]: 	index_key: HNSW15
2025-03-13 18:19:09,391 [INFO]: 	index_param: efSearch=203
2025-03-13 18:19:09,391 [INFO]: 	index_path: knn.index
2025-03-13 18:19:09,391 [INFO]: 	size in bytes: 513698170
2025-03-13 18:19:09,391 [INFO]: 	avg_search_speed_ms: 8.994765463075767
2025-03-13 18:19:09,391 [INFO]: 	99p_search_speed_ms: 12.982787541113797
2025-03-13 18:19:09,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:09,391 [INFO]: 	nb vectors: 2611
2025-03-13 18:19:09,391 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:09,391 [INFO]: 	compression ratio: 0.9993095517548758
2025-03-13 18:19:09,391 [INFO]: }
2025-03-13 18:19:09,391 [INFO]: 	>>> Finished "Creating the index" in 56.8827 secs
2025-03-13 18:19:09,391 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2758 secs
2025-03-13 18:19:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 47184 [episode count 1/20]
[retrieval_preprocessing] for episode 11869 [episode count 2/20], we have num_retrieval=np.int64(2623) num_query=np.int64(147)
2025-03-13 18:19:11,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:11,470 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:11
2025-03-13 18:19:11,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1350.82it/s]
2025-03-13 18:19:11,498 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 18:19:11,498 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:19:11,498 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:11
2025-03-13 18:19:11,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:11,498 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:19:11,498 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:19:11,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:19:11,498 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:11
2025-03-13 18:19:11,499 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:11,499 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:19:11,499 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:11
2025-03-13 18:19:11,499 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:19:11,499 [INFO]: 	Creating the index 03/13/2025, 18:19:11
2025-03-13 18:19:11,499 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:19:11
2025-03-13 18:19:11,500 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:19:11,500 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:11
2025-03-13 18:19:11,500 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:19:11,500 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.02it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.29it/s]100%|██████████| 11/11 [00:02<00:00,  5.01it/s]
2025-03-13 18:19:13,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:13
2025-03-13 18:19:50,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9784 secs
2025-03-13 18:19:50,678 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:19:50,678 [INFO]: 	Compute fast metrics 03/13/2025, 18:19:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-13 18:20:16,209 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5310 secs
2025-03-13 18:20:16,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7119 secs
2025-03-13 18:20:16,212 [INFO]: {
2025-03-13 18:20:16,212 [INFO]: 	index_key: HNSW15
2025-03-13 18:20:16,213 [INFO]: 	index_param: efSearch=206
2025-03-13 18:20:16,213 [INFO]: 	index_path: knn.index
2025-03-13 18:20:16,213 [INFO]: 	size in bytes: 516059170
2025-03-13 18:20:16,213 [INFO]: 	avg_search_speed_ms: 8.707838651370452
2025-03-13 18:20:16,213 [INFO]: 	99p_search_speed_ms: 13.81090511102229
2025-03-13 18:20:16,213 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:20:16,213 [INFO]: 	nb vectors: 2623
2025-03-13 18:20:16,213 [INFO]: 	vectors dimension: 49152
2025-03-13 18:20:16,213 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 18:20:16,213 [INFO]: }
2025-03-13 18:20:16,213 [INFO]: 	>>> Finished "Creating the index" in 64.7140 secs
2025-03-13 18:20:16,213 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7434 secs
2025-03-13 18:20:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:20:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 11869 [episode count 2/20]
[retrieval_preprocessing] for episode 37984 [episode count 3/20], we have num_retrieval=np.int64(2605) num_query=np.int64(165)
2025-03-13 18:20:17,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:20:18,434 [INFO]: Launching the whole pipeline 03/13/2025, 18:20:18
2025-03-13 18:20:18,434 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:20:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 18:20:18,465 [INFO]: There are 2605 embeddings of dim 49152
2025-03-13 18:20:18,465 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 18:20:18,465 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:20:18
2025-03-13 18:20:18,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:20:18,465 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:20:18,465 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:20:18,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:20:18,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:20:18
2025-03-13 18:20:18,466 [INFO]: 537.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:20:18,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:20:18,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:20:18
2025-03-13 18:20:18,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:20:18,466 [INFO]: 	Creating the index 03/13/2025, 18:20:18
2025-03-13 18:20:18,466 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:20:18
2025-03-13 18:20:18,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:20:18,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:20:18
2025-03-13 18:20:18,467 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:20:18,467 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.44it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.31it/s]100%|██████████| 11/11 [00:02<00:00,  4.48it/s]100%|██████████| 11/11 [00:02<00:00,  5.22it/s]
2025-03-13 18:20:20,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:20:20
2025-03-13 18:20:57,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8669 secs
2025-03-13 18:20:57,446 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 18:20:57,446 [INFO]: 	Compute fast metrics 03/13/2025, 18:20:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.04it/s]
2025-03-13 18:21:15,441 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9945 secs
2025-03-13 18:21:15,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9755 secs
2025-03-13 18:21:15,443 [INFO]: {
2025-03-13 18:21:15,443 [INFO]: 	index_key: HNSW15
2025-03-13 18:21:15,443 [INFO]: 	index_param: efSearch=220
2025-03-13 18:21:15,443 [INFO]: 	index_path: knn.index
2025-03-13 18:21:15,443 [INFO]: 	size in bytes: 512517730
2025-03-13 18:21:15,443 [INFO]: 	avg_search_speed_ms: 9.968225758779026
2025-03-13 18:21:15,443 [INFO]: 	99p_search_speed_ms: 16.243953639641408
2025-03-13 18:21:15,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:21:15,443 [INFO]: 	nb vectors: 2605
2025-03-13 18:21:15,443 [INFO]: 	vectors dimension: 49152
2025-03-13 18:21:15,443 [INFO]: 	compression ratio: 0.9993095068145252
2025-03-13 18:21:15,443 [INFO]: }
2025-03-13 18:21:15,443 [INFO]: 	>>> Finished "Creating the index" in 56.9771 secs
2025-03-13 18:21:15,443 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0087 secs
2025-03-13 18:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 37984 [episode count 3/20]
[retrieval_preprocessing] for episode 44132 [episode count 4/20], we have num_retrieval=np.int64(2624) num_query=np.int64(146)
2025-03-13 18:21:18,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:21:19,086 [INFO]: Launching the whole pipeline 03/13/2025, 18:21:19
2025-03-13 18:21:19,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:21:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.14it/s]
2025-03-13 18:21:19,112 [INFO]: There are 2624 embeddings of dim 49152
2025-03-13 18:21:19,112 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 18:21:19,112 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:21:19,113 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:21:19,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:21:19,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:21:19,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,113 [INFO]: 541.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:21:19,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:21:19,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:21:19
2025-03-13 18:21:19,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:21:19,113 [INFO]: 	Creating the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:21:19
2025-03-13 18:21:19,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:21:19,114 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:21:19
2025-03-13 18:21:19,114 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:21:19,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.65it/s] 73%|███████▎  | 8/11 [00:00<00:00, 41.64it/s]100%|██████████| 11/11 [00:02<00:00,  5.37it/s]
2025-03-13 18:21:21,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:21:21
2025-03-13 18:21:52,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9377 secs
2025-03-13 18:21:52,504 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 18:21:52,504 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.64it/s]
2025-03-13 18:22:21,127 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6226 secs
2025-03-13 18:22:21,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0145 secs
2025-03-13 18:22:21,129 [INFO]: {
2025-03-13 18:22:21,129 [INFO]: 	index_key: HNSW15
2025-03-13 18:22:21,129 [INFO]: 	index_param: efSearch=235
2025-03-13 18:22:21,129 [INFO]: 	index_path: knn.index
2025-03-13 18:22:21,129 [INFO]: 	size in bytes: 516255910
2025-03-13 18:22:21,129 [INFO]: 	avg_search_speed_ms: 10.516342185986092
2025-03-13 18:22:21,129 [INFO]: 	99p_search_speed_ms: 14.84045700635761
2025-03-13 18:22:21,129 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:21,129 [INFO]: 	nb vectors: 2624
2025-03-13 18:22:21,129 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:21,129 [INFO]: 	compression ratio: 0.9993094161382094
2025-03-13 18:22:21,129 [INFO]: }
2025-03-13 18:22:21,129 [INFO]: 	>>> Finished "Creating the index" in 62.0160 secs
2025-03-13 18:22:21,129 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0433 secs
2025-03-13 18:22:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 44132 [episode count 4/20]
[retrieval_preprocessing] for episode 27264 [episode count 5/20], we have num_retrieval=np.int64(2662) num_query=np.int64(108)
2025-03-13 18:22:22,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:22,978 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:22
2025-03-13 18:22:22,978 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 687.93it/s]
2025-03-13 18:22:23,014 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 18:22:23,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 18:22:23,015 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:23
2025-03-13 18:22:23,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:23,015 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:22:23,016 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:22:23,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:22:23,016 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:23
2025-03-13 18:22:23,016 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:23,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:22:23,016 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:23
2025-03-13 18:22:23,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:23,017 [INFO]: 	Creating the index 03/13/2025, 18:22:23
2025-03-13 18:22:23,017 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:22:23
2025-03-13 18:22:23,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 18:22:23,021 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:23
2025-03-13 18:22:23,021 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:22:23,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.85it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.12it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.57it/s]
2025-03-13 18:22:25,434 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:22:25
2025-03-13 18:23:04,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5206 secs
2025-03-13 18:23:04,956 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 18:23:04,956 [INFO]: 	Compute fast metrics 03/13/2025, 18:23:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.86it/s]
2025-03-13 18:23:23,545 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5889 secs
2025-03-13 18:23:23,547 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5258 secs
2025-03-13 18:23:23,547 [INFO]: {
2025-03-13 18:23:23,547 [INFO]: 	index_key: HNSW15
2025-03-13 18:23:23,547 [INFO]: 	index_param: efSearch=121
2025-03-13 18:23:23,547 [INFO]: 	index_path: knn.index
2025-03-13 18:23:23,547 [INFO]: 	size in bytes: 523732090
2025-03-13 18:23:23,547 [INFO]: 	avg_search_speed_ms: 7.6385547570255286
2025-03-13 18:23:23,547 [INFO]: 	99p_search_speed_ms: 13.52393038570882
2025-03-13 18:23:23,547 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:23:23,547 [INFO]: 	nb vectors: 2662
2025-03-13 18:23:23,547 [INFO]: 	vectors dimension: 49152
2025-03-13 18:23:23,547 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 18:23:23,547 [INFO]: }
2025-03-13 18:23:23,547 [INFO]: 	>>> Finished "Creating the index" in 60.5304 secs
2025-03-13 18:23:23,547 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5690 secs
2025-03-13 18:23:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:23:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 27264 [episode count 5/20]
[retrieval_preprocessing] for episode 67206 [episode count 6/20], we have num_retrieval=np.int64(2617) num_query=np.int64(153)
2025-03-13 18:23:24,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:23:24,832 [INFO]: Launching the whole pipeline 03/13/2025, 18:23:24
2025-03-13 18:23:24,832 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:23:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1114.91it/s]
2025-03-13 18:23:24,861 [INFO]: There are 2617 embeddings of dim 49152
2025-03-13 18:23:24,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 18:23:24,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:23:24
2025-03-13 18:23:24,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:23:24,861 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:23:24,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:23:24,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:23:24,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:23:24
2025-03-13 18:23:24,861 [INFO]: 540.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:23:24,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:23:24,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:23:24
2025-03-13 18:23:24,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:23:24,862 [INFO]: 	Creating the index 03/13/2025, 18:23:24
2025-03-13 18:23:24,862 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:23:24
2025-03-13 18:23:24,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:23:24,863 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:23:24
2025-03-13 18:23:24,863 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:23:24,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.85it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.46it/s]100%|██████████| 11/11 [00:02<00:00,  4.18it/s]100%|██████████| 11/11 [00:02<00:00,  5.19it/s]
2025-03-13 18:23:26,987 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:26
2025-03-13 18:24:00,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2196 secs
2025-03-13 18:24:00,207 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 18:24:00,208 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-13 18:24:24,269 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0613 secs
2025-03-13 18:24:24,272 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4087 secs
2025-03-13 18:24:24,272 [INFO]: {
2025-03-13 18:24:24,272 [INFO]: 	index_key: HNSW15
2025-03-13 18:24:24,272 [INFO]: 	index_param: efSearch=215
2025-03-13 18:24:24,272 [INFO]: 	index_path: knn.index
2025-03-13 18:24:24,272 [INFO]: 	size in bytes: 514878730
2025-03-13 18:24:24,272 [INFO]: 	avg_search_speed_ms: 9.182746680769847
2025-03-13 18:24:24,272 [INFO]: 	99p_search_speed_ms: 12.457524836063364
2025-03-13 18:24:24,272 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:24:24,272 [INFO]: 	nb vectors: 2617
2025-03-13 18:24:24,272 [INFO]: 	vectors dimension: 49152
2025-03-13 18:24:24,272 [INFO]: 	compression ratio: 0.9993093635854796
2025-03-13 18:24:24,272 [INFO]: }
2025-03-13 18:24:24,272 [INFO]: 	>>> Finished "Creating the index" in 59.4104 secs
2025-03-13 18:24:24,272 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4399 secs
2025-03-13 18:24:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:24:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67206 [episode count 6/20]
[retrieval_preprocessing] for episode 67743 [episode count 7/20], we have num_retrieval=np.int64(2669) num_query=np.int64(101)
2025-03-13 18:24:25,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:24:26,378 [INFO]: Launching the whole pipeline 03/13/2025, 18:24:26
2025-03-13 18:24:26,378 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:24:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 970.90it/s]
2025-03-13 18:24:26,416 [INFO]: There are 2669 embeddings of dim 49152
2025-03-13 18:24:26,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-13 18:24:26,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:24:26
2025-03-13 18:24:26,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:24:26,417 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:24:26,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:24:26,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:24:26,418 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:24:26
2025-03-13 18:24:26,418 [INFO]: 550.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:24:26,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:24:26,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:24:26
2025-03-13 18:24:26,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:24:26,419 [INFO]: 	Creating the index 03/13/2025, 18:24:26
2025-03-13 18:24:26,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:24:26
2025-03-13 18:24:26,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:24:26,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:24:26
2025-03-13 18:24:26,422 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:24:26,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.10it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.68it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.55it/s]100%|██████████| 11/11 [00:02<00:00,  4.62it/s]
2025-03-13 18:24:28,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:24:28
2025-03-13 18:25:05,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4457 secs
2025-03-13 18:25:05,255 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 18:25:05,255 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.87it/s]
2025-03-13 18:25:24,060 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8045 secs
2025-03-13 18:25:24,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6395 secs
2025-03-13 18:25:24,062 [INFO]: {
2025-03-13 18:25:24,062 [INFO]: 	index_key: HNSW15
2025-03-13 18:25:24,062 [INFO]: 	index_param: efSearch=194
2025-03-13 18:25:24,062 [INFO]: 	index_path: knn.index
2025-03-13 18:25:24,062 [INFO]: 	size in bytes: 525109270
2025-03-13 18:25:24,062 [INFO]: 	avg_search_speed_ms: 9.522741308125356
2025-03-13 18:25:24,062 [INFO]: 	99p_search_speed_ms: 14.588850119616836
2025-03-13 18:25:24,062 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:25:24,062 [INFO]: 	nb vectors: 2669
2025-03-13 18:25:24,062 [INFO]: 	vectors dimension: 49152
2025-03-13 18:25:24,062 [INFO]: 	compression ratio: 0.9993096332121503
2025-03-13 18:25:24,062 [INFO]: }
2025-03-13 18:25:24,062 [INFO]: 	>>> Finished "Creating the index" in 57.6433 secs
2025-03-13 18:25:24,062 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6840 secs
2025-03-13 18:25:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:25:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 67743 [episode count 7/20]
[retrieval_preprocessing] for episode 7331 [episode count 8/20], we have num_retrieval=np.int64(2658) num_query=np.int64(112)
2025-03-13 18:25:28,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:25:29,011 [INFO]: Launching the whole pipeline 03/13/2025, 18:25:29
2025-03-13 18:25:29,011 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:25:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.19it/s]
2025-03-13 18:25:29,038 [INFO]: There are 2658 embeddings of dim 49152
2025-03-13 18:25:29,039 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:25:29,039 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:25:29
2025-03-13 18:25:29,039 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:25:29,039 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:25:29,039 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:25:29,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:25:29,039 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:25:29
2025-03-13 18:25:29,039 [INFO]: 548.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:25:29,039 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:25:29,039 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:25:29
2025-03-13 18:25:29,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:25:29,039 [INFO]: 	Creating the index 03/13/2025, 18:25:29
2025-03-13 18:25:29,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:25:29
2025-03-13 18:25:29,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:25:29,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:25:29
2025-03-13 18:25:29,040 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:25:29,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.35it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.44it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]100%|██████████| 11/11 [00:02<00:00,  5.17it/s]
2025-03-13 18:25:31,171 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:25:31
2025-03-13 18:25:59,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8355 secs
2025-03-13 18:25:59,007 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 18:25:59,007 [INFO]: 	Compute fast metrics 03/13/2025, 18:25:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-13 18:26:31,291 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2838 secs
2025-03-13 18:26:31,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6411 secs
2025-03-13 18:26:31,682 [INFO]: {
2025-03-13 18:26:31,682 [INFO]: 	index_key: HNSW15
2025-03-13 18:26:31,682 [INFO]: 	index_param: efSearch=258
2025-03-13 18:26:31,682 [INFO]: 	index_path: knn.index
2025-03-13 18:26:31,682 [INFO]: 	size in bytes: 522945130
2025-03-13 18:26:31,682 [INFO]: 	avg_search_speed_ms: 11.31352901878046
2025-03-13 18:26:31,682 [INFO]: 	99p_search_speed_ms: 15.95459614181891
2025-03-13 18:26:31,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:31,682 [INFO]: 	nb vectors: 2658
2025-03-13 18:26:31,682 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:31,682 [INFO]: 	compression ratio: 0.9993095528014574
2025-03-13 18:26:31,683 [INFO]: }
2025-03-13 18:26:31,683 [INFO]: 	>>> Finished "Creating the index" in 62.6433 secs
2025-03-13 18:26:31,683 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6715 secs
2025-03-13 18:26:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 7331 [episode count 8/20]
[retrieval_preprocessing] for episode 18617 [episode count 9/20], we have num_retrieval=np.int64(2596) num_query=np.int64(174)
2025-03-13 18:26:33,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:34,321 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:34
2025-03-13 18:26:34,322 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.12it/s]
2025-03-13 18:26:34,948 [INFO]: There are 2596 embeddings of dim 49152
2025-03-13 18:26:34,948 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.6264 secs
2025-03-13 18:26:34,948 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,948 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:34,948 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:26:34,948 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:26:34,948 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:26:34,948 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,949 [INFO]: 535.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:34,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:26:34,949 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:34
2025-03-13 18:26:34,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:34,949 [INFO]: 	Creating the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,949 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:26:34
2025-03-13 18:26:34,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 18:26:34,952 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:34
2025-03-13 18:26:34,952 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:26:34,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.61it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 22.13it/s]100%|██████████| 11/11 [00:02<00:00,  2.93it/s]100%|██████████| 11/11 [00:02<00:00,  3.82it/s]
2025-03-13 18:26:37,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:37
2025-03-13 18:27:10,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5635 secs
2025-03-13 18:27:10,399 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 18:27:10,399 [INFO]: 	Compute fast metrics 03/13/2025, 18:27:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.01it/s]
2025-03-13 18:27:27,033 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6341 secs
2025-03-13 18:27:27,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0825 secs
2025-03-13 18:27:27,034 [INFO]: {
2025-03-13 18:27:27,034 [INFO]: 	index_key: HNSW15
2025-03-13 18:27:27,034 [INFO]: 	index_param: efSearch=213
2025-03-13 18:27:27,034 [INFO]: 	index_path: knn.index
2025-03-13 18:27:27,035 [INFO]: 	size in bytes: 510747070
2025-03-13 18:27:27,035 [INFO]: 	avg_search_speed_ms: 9.257135405938175
2025-03-13 18:27:27,035 [INFO]: 	99p_search_speed_ms: 14.608375711832197
2025-03-13 18:27:27,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:27:27,035 [INFO]: 	nb vectors: 2596
2025-03-13 18:27:27,035 [INFO]: 	vectors dimension: 49152
2025-03-13 18:27:27,035 [INFO]: 	compression ratio: 0.9993094390145009
2025-03-13 18:27:27,035 [INFO]: }
2025-03-13 18:27:27,035 [INFO]: 	>>> Finished "Creating the index" in 52.0855 secs
2025-03-13 18:27:27,035 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7131 secs
2025-03-13 18:27:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:27:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 18617 [episode count 9/20]
[retrieval_preprocessing] for episode 62674 [episode count 10/20], we have num_retrieval=np.int64(2640) num_query=np.int64(130)
2025-03-13 18:27:28,473 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:27:28,903 [INFO]: Launching the whole pipeline 03/13/2025, 18:27:28
2025-03-13 18:27:28,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:27:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2136.68it/s]
2025-03-13 18:27:28,927 [INFO]: There are 2640 embeddings of dim 49152
2025-03-13 18:27:28,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 18:27:28,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:27:28
2025-03-13 18:27:28,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:27:28,928 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:27:28,928 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:27:28,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:27:28,928 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:27:28
2025-03-13 18:27:28,928 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:27:28,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:27:28,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:27:28
2025-03-13 18:27:28,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:27:28,928 [INFO]: 	Creating the index 03/13/2025, 18:27:28
2025-03-13 18:27:28,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:27:28
2025-03-13 18:27:28,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:27:28,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:27:28
2025-03-13 18:27:28,929 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:27:28,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.64it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.89it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]100%|██████████| 11/11 [00:02<00:00,  5.20it/s]
2025-03-13 18:27:31,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:27:31
2025-03-13 18:28:00,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5273 secs
2025-03-13 18:28:00,576 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 18:28:00,576 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.81it/s]
2025-03-13 18:28:20,441 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8652 secs
2025-03-13 18:28:20,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5143 secs
2025-03-13 18:28:20,444 [INFO]: {
2025-03-13 18:28:20,444 [INFO]: 	index_key: HNSW15
2025-03-13 18:28:20,444 [INFO]: 	index_param: efSearch=239
2025-03-13 18:28:20,444 [INFO]: 	index_path: knn.index
2025-03-13 18:28:20,444 [INFO]: 	size in bytes: 519403810
2025-03-13 18:28:20,444 [INFO]: 	avg_search_speed_ms: 9.196834475069334
2025-03-13 18:28:20,444 [INFO]: 	99p_search_speed_ms: 12.817704291082933
2025-03-13 18:28:20,444 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:28:20,444 [INFO]: 	nb vectors: 2640
2025-03-13 18:28:20,444 [INFO]: 	vectors dimension: 49152
2025-03-13 18:28:20,444 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-13 18:28:20,444 [INFO]: }
2025-03-13 18:28:20,444 [INFO]: 	>>> Finished "Creating the index" in 51.5160 secs
2025-03-13 18:28:20,444 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5411 secs
2025-03-13 18:28:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:28:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 62674 [episode count 10/20]
[retrieval_preprocessing] for episode 61165 [episode count 11/20], we have num_retrieval=np.int64(2651) num_query=np.int64(119)
2025-03-13 18:28:22,296 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:28:22,745 [INFO]: Launching the whole pipeline 03/13/2025, 18:28:22
2025-03-13 18:28:22,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:28:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1081.01it/s]
2025-03-13 18:28:22,777 [INFO]: There are 2651 embeddings of dim 49152
2025-03-13 18:28:22,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-13 18:28:22,778 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:28:22
2025-03-13 18:28:22,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:28:22,779 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:28:22,779 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:28:22,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:28:22,779 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:28:22
2025-03-13 18:28:22,779 [INFO]: 547.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:28:22,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:28:22,780 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:28:22
2025-03-13 18:28:22,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:28:22,780 [INFO]: 	Creating the index 03/13/2025, 18:28:22
2025-03-13 18:28:22,780 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:28:22
2025-03-13 18:28:22,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:28:22,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:28:22
2025-03-13 18:28:22,783 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:28:22,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.56it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.36it/s]100%|██████████| 11/11 [00:01<00:00,  4.44it/s]100%|██████████| 11/11 [00:01<00:00,  5.50it/s]
2025-03-13 18:28:24,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:28:24
2025-03-13 18:28:49,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2828 secs
2025-03-13 18:28:49,073 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 18:28:49,073 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-13 18:29:13,838 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7654 secs
2025-03-13 18:29:13,840 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0564 secs
2025-03-13 18:29:13,840 [INFO]: {
2025-03-13 18:29:13,840 [INFO]: 	index_key: HNSW15
2025-03-13 18:29:13,840 [INFO]: 	index_param: efSearch=294
2025-03-13 18:29:13,840 [INFO]: 	index_path: knn.index
2025-03-13 18:29:13,840 [INFO]: 	size in bytes: 521567950
2025-03-13 18:29:13,840 [INFO]: 	avg_search_speed_ms: 10.329974681275612
2025-03-13 18:29:13,840 [INFO]: 	99p_search_speed_ms: 15.411569299176337
2025-03-13 18:29:13,840 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:13,840 [INFO]: 	nb vectors: 2651
2025-03-13 18:29:13,840 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:13,840 [INFO]: 	compression ratio: 0.9993095012835815
2025-03-13 18:29:13,840 [INFO]: }
2025-03-13 18:29:13,840 [INFO]: 	>>> Finished "Creating the index" in 51.0600 secs
2025-03-13 18:29:13,840 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0949 secs
2025-03-13 18:29:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 61165 [episode count 11/20]
[retrieval_preprocessing] for episode 81645 [episode count 12/20], we have num_retrieval=np.int64(2651) num_query=np.int64(119)
2025-03-13 18:29:15,659 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:29:15,984 [INFO]: Launching the whole pipeline 03/13/2025, 18:29:15
2025-03-13 18:29:15,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:29:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 18:29:16,010 [INFO]: There are 2651 embeddings of dim 49152
2025-03-13 18:29:16,011 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 18:29:16,011 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:29:16
2025-03-13 18:29:16,011 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:29:16,011 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:29:16,011 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:29:16,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:29:16,011 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:29:16
2025-03-13 18:29:16,011 [INFO]: 547.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:29:16,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:29:16,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:29:16
2025-03-13 18:29:16,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:29:16,011 [INFO]: 	Creating the index 03/13/2025, 18:29:16
2025-03-13 18:29:16,011 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:29:16
2025-03-13 18:29:16,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:29:16,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:29:16
2025-03-13 18:29:16,012 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:29:16,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.61it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.93it/s]100%|██████████| 11/11 [00:01<00:00,  4.95it/s]100%|██████████| 11/11 [00:01<00:00,  5.97it/s]
2025-03-13 18:29:17,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:29:17
2025-03-13 18:29:52,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9741 secs
2025-03-13 18:29:52,833 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 18:29:52,833 [INFO]: 	Compute fast metrics 03/13/2025, 18:29:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.04it/s]
2025-03-13 18:30:10,752 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9193 secs
2025-03-13 18:30:10,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7420 secs
2025-03-13 18:30:10,754 [INFO]: {
2025-03-13 18:30:10,755 [INFO]: 	index_key: HNSW15
2025-03-13 18:30:10,755 [INFO]: 	index_param: efSearch=186
2025-03-13 18:30:10,755 [INFO]: 	index_path: knn.index
2025-03-13 18:30:10,755 [INFO]: 	size in bytes: 521567950
2025-03-13 18:30:10,755 [INFO]: 	avg_search_speed_ms: 10.318981230084018
2025-03-13 18:30:10,755 [INFO]: 	99p_search_speed_ms: 18.785800756886594
2025-03-13 18:30:10,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:30:10,755 [INFO]: 	nb vectors: 2651
2025-03-13 18:30:10,755 [INFO]: 	vectors dimension: 49152
2025-03-13 18:30:10,755 [INFO]: 	compression ratio: 0.9993095012835815
2025-03-13 18:30:10,755 [INFO]: }
2025-03-13 18:30:10,755 [INFO]: 	>>> Finished "Creating the index" in 54.7435 secs
2025-03-13 18:30:10,755 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7708 secs
2025-03-13 18:30:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:30:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81645 [episode count 12/20]
[retrieval_preprocessing] for episode 32018 [episode count 13/20], we have num_retrieval=np.int64(2646) num_query=np.int64(124)
2025-03-13 18:30:12,184 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:13,461 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:13
2025-03-13 18:30:13,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1937.32it/s]
2025-03-13 18:30:13,487 [INFO]: There are 2646 embeddings of dim 49152
2025-03-13 18:30:13,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 18:30:13,487 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:13
2025-03-13 18:30:13,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:13,487 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:30:13,487 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:30:13,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:30:13,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:13
2025-03-13 18:30:13,488 [INFO]: 546.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:13,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:30:13,488 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:13
2025-03-13 18:30:13,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:30:13,488 [INFO]: 	Creating the index 03/13/2025, 18:30:13
2025-03-13 18:30:13,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:30:13
2025-03-13 18:30:13,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 18:30:13,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:13
2025-03-13 18:30:13,490 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:30:13,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.87it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 28.33it/s]100%|██████████| 11/11 [00:02<00:00,  4.42it/s]
2025-03-13 18:30:15,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:15
2025-03-13 18:30:47,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5168 secs
2025-03-13 18:30:47,502 [INFO]: The best hyperparameters are: efSearch=271
2025-03-13 18:30:47,502 [INFO]: 	Compute fast metrics 03/13/2025, 18:30:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.80it/s]
2025-03-13 18:31:12,293 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7909 secs
2025-03-13 18:31:12,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8049 secs
2025-03-13 18:31:12,295 [INFO]: {
2025-03-13 18:31:12,295 [INFO]: 	index_key: HNSW15
2025-03-13 18:31:12,295 [INFO]: 	index_param: efSearch=271
2025-03-13 18:31:12,295 [INFO]: 	index_path: knn.index
2025-03-13 18:31:12,295 [INFO]: 	size in bytes: 520584250
2025-03-13 18:31:12,295 [INFO]: 	avg_search_speed_ms: 10.665365258481964
2025-03-13 18:31:12,295 [INFO]: 	99p_search_speed_ms: 16.24548915307969
2025-03-13 18:31:12,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:31:12,295 [INFO]: 	nb vectors: 2646
2025-03-13 18:31:12,295 [INFO]: 	vectors dimension: 49152
2025-03-13 18:31:12,295 [INFO]: 	compression ratio: 0.9993094643182155
2025-03-13 18:31:12,295 [INFO]: }
2025-03-13 18:31:12,295 [INFO]: 	>>> Finished "Creating the index" in 58.8071 secs
2025-03-13 18:31:12,295 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8343 secs
2025-03-13 18:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:31:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 32018 [episode count 13/20]
[retrieval_preprocessing] for episode 76644 [episode count 14/20], we have num_retrieval=np.int64(2637) num_query=np.int64(133)
2025-03-13 18:31:13,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:31:14,732 [INFO]: Launching the whole pipeline 03/13/2025, 18:31:14
2025-03-13 18:31:14,732 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.86it/s]
2025-03-13 18:31:14,770 [INFO]: There are 2637 embeddings of dim 49152
2025-03-13 18:31:14,771 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 18:31:14,771 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,771 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:31:14,771 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:31:14,771 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:31:14,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:31:14,772 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,772 [INFO]: 544.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:31:14,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:31:14,772 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:31:14
2025-03-13 18:31:14,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:31:14,772 [INFO]: 	Creating the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,772 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:31:14
2025-03-13 18:31:14,774 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 18:31:14,774 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:31:14
2025-03-13 18:31:14,775 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:31:14,775 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.47it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.38it/s]100%|██████████| 11/11 [00:02<00:00,  3.70it/s]100%|██████████| 11/11 [00:02<00:00,  4.60it/s]
2025-03-13 18:31:17,173 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:31:17
2025-03-13 18:31:51,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4531 secs
2025-03-13 18:31:51,627 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 18:31:51,627 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.37it/s]
2025-03-13 18:32:13,875 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2473 secs
2025-03-13 18:32:13,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1019 secs
2025-03-13 18:32:13,877 [INFO]: {
2025-03-13 18:32:13,877 [INFO]: 	index_key: HNSW15
2025-03-13 18:32:13,877 [INFO]: 	index_param: efSearch=197
2025-03-13 18:32:13,877 [INFO]: 	index_path: knn.index
2025-03-13 18:32:13,877 [INFO]: 	size in bytes: 518813590
2025-03-13 18:32:13,877 [INFO]: 	avg_search_speed_ms: 8.441971533220528
2025-03-13 18:32:13,877 [INFO]: 	99p_search_speed_ms: 12.907169824466111
2025-03-13 18:32:13,877 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:13,877 [INFO]: 	nb vectors: 2637
2025-03-13 18:32:13,877 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:13,877 [INFO]: 	compression ratio: 0.9993093974273111
2025-03-13 18:32:13,877 [INFO]: }
2025-03-13 18:32:13,877 [INFO]: 	>>> Finished "Creating the index" in 59.1046 secs
2025-03-13 18:32:13,877 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1443 secs
2025-03-13 18:32:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 76644 [episode count 14/20]
[retrieval_preprocessing] for episode 22393 [episode count 15/20], we have num_retrieval=np.int64(2615) num_query=np.int64(155)
2025-03-13 18:32:17,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:17,465 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:17
2025-03-13 18:32:17,465 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.99it/s]
2025-03-13 18:32:17,495 [INFO]: There are 2615 embeddings of dim 49152
2025-03-13 18:32:17,496 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 18:32:17,496 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:17
2025-03-13 18:32:17,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:17,497 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:32:17,497 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:32:17,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:32:17,497 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:17
2025-03-13 18:32:17,497 [INFO]: 539.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:17,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:32:17,498 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:17
2025-03-13 18:32:17,498 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:32:17,498 [INFO]: 	Creating the index 03/13/2025, 18:32:17
2025-03-13 18:32:17,498 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:32:17
2025-03-13 18:32:17,501 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:32:17,501 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:17
2025-03-13 18:32:17,501 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:32:17,502 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.99it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.61it/s]100%|██████████| 11/11 [00:02<00:00,  3.51it/s]100%|██████████| 11/11 [00:02<00:00,  4.37it/s]
2025-03-13 18:32:20,022 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:32:20
2025-03-13 18:32:53,071 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0494 secs
2025-03-13 18:32:53,072 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 18:32:53,072 [INFO]: 	Compute fast metrics 03/13/2025, 18:32:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-13 18:33:08,848 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7761 secs
2025-03-13 18:33:08,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3489 secs
2025-03-13 18:33:08,850 [INFO]: {
2025-03-13 18:33:08,850 [INFO]: 	index_key: HNSW15
2025-03-13 18:33:08,850 [INFO]: 	index_param: efSearch=216
2025-03-13 18:33:08,850 [INFO]: 	index_path: knn.index
2025-03-13 18:33:08,850 [INFO]: 	size in bytes: 514485250
2025-03-13 18:33:08,850 [INFO]: 	avg_search_speed_ms: 11.41212486713002
2025-03-13 18:33:08,851 [INFO]: 	99p_search_speed_ms: 18.407231895253062
2025-03-13 18:33:08,851 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:33:08,851 [INFO]: 	nb vectors: 2615
2025-03-13 18:33:08,851 [INFO]: 	vectors dimension: 49152
2025-03-13 18:33:08,851 [INFO]: 	compression ratio: 0.9993093485187379
2025-03-13 18:33:08,851 [INFO]: }
2025-03-13 18:33:08,851 [INFO]: 	>>> Finished "Creating the index" in 51.3527 secs
2025-03-13 18:33:08,851 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3856 secs
2025-03-13 18:33:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:33:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 22393 [episode count 15/20]
[retrieval_preprocessing] for episode 81785 [episode count 16/20], we have num_retrieval=np.int64(2627) num_query=np.int64(143)
2025-03-13 18:33:10,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:33:10,461 [INFO]: Launching the whole pipeline 03/13/2025, 18:33:10
2025-03-13 18:33:10,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:33:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-13 18:33:10,488 [INFO]: There are 2627 embeddings of dim 49152
2025-03-13 18:33:10,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 18:33:10,488 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:33:10
2025-03-13 18:33:10,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:33:10,488 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:33:10,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:33:10,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:33:10,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:33:10
2025-03-13 18:33:10,488 [INFO]: 542.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:33:10,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:33:10,488 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:33:10
2025-03-13 18:33:10,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:33:10,488 [INFO]: 	Creating the index 03/13/2025, 18:33:10
2025-03-13 18:33:10,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:33:10
2025-03-13 18:33:10,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:33:10,489 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:33:10
2025-03-13 18:33:10,489 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:33:10,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.03it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.06it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 18:33:12,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:12
2025-03-13 18:33:42,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6037 secs
2025-03-13 18:33:42,201 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 18:33:42,201 [INFO]: 	Compute fast metrics 03/13/2025, 18:33:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.98it/s]
2025-03-13 18:34:04,952 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7511 secs
2025-03-13 18:34:04,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4645 secs
2025-03-13 18:34:04,954 [INFO]: {
2025-03-13 18:34:04,954 [INFO]: 	index_key: HNSW15
2025-03-13 18:34:04,954 [INFO]: 	index_param: efSearch=260
2025-03-13 18:34:04,954 [INFO]: 	index_path: knn.index
2025-03-13 18:34:04,954 [INFO]: 	size in bytes: 516846130
2025-03-13 18:34:04,954 [INFO]: 	avg_search_speed_ms: 9.78143584918147
2025-03-13 18:34:04,954 [INFO]: 	99p_search_speed_ms: 16.410202342085512
2025-03-13 18:34:04,954 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:34:04,954 [INFO]: 	nb vectors: 2627
2025-03-13 18:34:04,954 [INFO]: 	vectors dimension: 49152
2025-03-13 18:34:04,954 [INFO]: 	compression ratio: 0.9993094385750746
2025-03-13 18:34:04,954 [INFO]: }
2025-03-13 18:34:04,954 [INFO]: 	>>> Finished "Creating the index" in 54.4659 secs
2025-03-13 18:34:04,954 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4933 secs
2025-03-13 18:34:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:34:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 81785 [episode count 16/20]
[retrieval_preprocessing] for episode 19396 [episode count 17/20], we have num_retrieval=np.int64(2620) num_query=np.int64(150)
2025-03-13 18:34:06,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:34:07,634 [INFO]: Launching the whole pipeline 03/13/2025, 18:34:07
2025-03-13 18:34:07,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:34:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 18:34:07,663 [INFO]: There are 2620 embeddings of dim 49152
2025-03-13 18:34:07,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 18:34:07,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:34:07
2025-03-13 18:34:07,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:34:07,664 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:34:07,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:34:07,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:34:07,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:34:07
2025-03-13 18:34:07,664 [INFO]: 540.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:34:07,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:34:07,664 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:34:07
2025-03-13 18:34:07,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:34:07,664 [INFO]: 	Creating the index 03/13/2025, 18:34:07
2025-03-13 18:34:07,664 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:34:07
2025-03-13 18:34:07,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:34:07,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:34:07
2025-03-13 18:34:07,666 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:34:07,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.70it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.81it/s]
2025-03-13 18:34:09,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:34:09
2025-03-13 18:34:42,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9534 secs
2025-03-13 18:34:42,911 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:34:42,911 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 18:35:00,481 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5699 secs
2025-03-13 18:35:00,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8169 secs
2025-03-13 18:35:00,483 [INFO]: {
2025-03-13 18:35:00,483 [INFO]: 	index_key: HNSW15
2025-03-13 18:35:00,483 [INFO]: 	index_param: efSearch=226
2025-03-13 18:35:00,483 [INFO]: 	index_path: knn.index
2025-03-13 18:35:00,483 [INFO]: 	size in bytes: 515468950
2025-03-13 18:35:00,483 [INFO]: 	avg_search_speed_ms: 8.945212953129186
2025-03-13 18:35:00,483 [INFO]: 	99p_search_speed_ms: 16.741676405072212
2025-03-13 18:35:00,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:00,483 [INFO]: 	nb vectors: 2620
2025-03-13 18:35:00,483 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:00,483 [INFO]: 	compression ratio: 0.9993093861424631
2025-03-13 18:35:00,483 [INFO]: }
2025-03-13 18:35:00,483 [INFO]: 	>>> Finished "Creating the index" in 52.8187 secs
2025-03-13 18:35:00,483 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8487 secs
2025-03-13 18:35:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 19396 [episode count 17/20]
[retrieval_preprocessing] for episode 92629 [episode count 18/20], we have num_retrieval=np.int64(2661) num_query=np.int64(109)
2025-03-13 18:35:01,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:02,239 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:02
2025-03-13 18:35:02,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.21it/s]
2025-03-13 18:35:02,819 [INFO]: There are 2661 embeddings of dim 49152
2025-03-13 18:35:02,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.5805 secs
2025-03-13 18:35:02,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:02
2025-03-13 18:35:02,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:02,820 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 18:35:02,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:35:02,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:35:02,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:02
2025-03-13 18:35:02,821 [INFO]: 549.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:02,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:35:02,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:02
2025-03-13 18:35:02,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:02,821 [INFO]: 	Creating the index 03/13/2025, 18:35:02
2025-03-13 18:35:02,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:35:02
2025-03-13 18:35:02,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 18:35:02,824 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:02
2025-03-13 18:35:02,824 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:35:02,824 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.97it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.91it/s]100%|██████████| 11/11 [00:02<00:00,  4.42it/s]100%|██████████| 11/11 [00:02<00:00,  5.17it/s]
2025-03-13 18:35:04,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:35:04
2025-03-13 18:35:36,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5277 secs
2025-03-13 18:35:36,484 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 18:35:36,484 [INFO]: 	Compute fast metrics 03/13/2025, 18:35:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.73it/s]
2025-03-13 18:36:01,054 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5700 secs
2025-03-13 18:36:01,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2317 secs
2025-03-13 18:36:01,055 [INFO]: {
2025-03-13 18:36:01,055 [INFO]: 	index_key: HNSW15
2025-03-13 18:36:01,055 [INFO]: 	index_param: efSearch=246
2025-03-13 18:36:01,055 [INFO]: 	index_path: knn.index
2025-03-13 18:36:01,055 [INFO]: 	size in bytes: 523535350
2025-03-13 18:36:01,055 [INFO]: 	avg_search_speed_ms: 9.908991114940676
2025-03-13 18:36:01,056 [INFO]: 	99p_search_speed_ms: 14.772282354533669
2025-03-13 18:36:01,056 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:36:01,056 [INFO]: 	nb vectors: 2661
2025-03-13 18:36:01,056 [INFO]: 	vectors dimension: 49152
2025-03-13 18:36:01,056 [INFO]: 	compression ratio: 0.9993095747975758
2025-03-13 18:36:01,056 [INFO]: }
2025-03-13 18:36:01,056 [INFO]: 	>>> Finished "Creating the index" in 58.2346 secs
2025-03-13 18:36:01,056 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8165 secs
2025-03-13 18:36:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:36:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 92629 [episode count 18/20]
[retrieval_preprocessing] for episode 68064 [episode count 19/20], we have num_retrieval=np.int64(2606) num_query=np.int64(164)
2025-03-13 18:36:02,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:36:02,583 [INFO]: Launching the whole pipeline 03/13/2025, 18:36:02
2025-03-13 18:36:02,583 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:36:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.09it/s]
2025-03-13 18:36:02,613 [INFO]: There are 2606 embeddings of dim 49152
2025-03-13 18:36:02,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 18:36:02,614 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:36:02
2025-03-13 18:36:02,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:36:02,614 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 18:36:02,615 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:36:02,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:36:02,615 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:36:02
2025-03-13 18:36:02,615 [INFO]: 537.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:36:02,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:36:02,616 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:36:02
2025-03-13 18:36:02,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:36:02,616 [INFO]: 	Creating the index 03/13/2025, 18:36:02
2025-03-13 18:36:02,616 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:36:02
2025-03-13 18:36:02,619 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:36:02,620 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:36:02
2025-03-13 18:36:02,620 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 18:36:02,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.86it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.99it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]100%|██████████| 11/11 [00:02<00:00,  4.70it/s]
2025-03-13 18:36:04,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:04
2025-03-13 18:36:42,001 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0331 secs
2025-03-13 18:36:42,001 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 18:36:42,001 [INFO]: 	Compute fast metrics 03/13/2025, 18:36:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-13 18:37:03,124 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1222 secs
2025-03-13 18:37:03,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5057 secs
2025-03-13 18:37:03,126 [INFO]: {
2025-03-13 18:37:03,126 [INFO]: 	index_key: HNSW15
2025-03-13 18:37:03,126 [INFO]: 	index_param: efSearch=195
2025-03-13 18:37:03,126 [INFO]: 	index_path: knn.index
2025-03-13 18:37:03,126 [INFO]: 	size in bytes: 512714470
2025-03-13 18:37:03,126 [INFO]: 	avg_search_speed_ms: 8.660270597834092
2025-03-13 18:37:03,126 [INFO]: 	99p_search_speed_ms: 12.348444219678642
2025-03-13 18:37:03,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:37:03,126 [INFO]: 	nb vectors: 2606
2025-03-13 18:37:03,126 [INFO]: 	vectors dimension: 49152
2025-03-13 18:37:03,126 [INFO]: 	compression ratio: 0.9993095143189542
2025-03-13 18:37:03,126 [INFO]: }
2025-03-13 18:37:03,126 [INFO]: 	>>> Finished "Creating the index" in 60.5095 secs
2025-03-13 18:37:03,126 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5429 secs
2025-03-13 18:37:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:37:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 68064 [episode count 19/20]
2025-03-13 18:37:04: [retrieval_preprocessing] finished for 2883696971_put_rubber_band_on_cup [chosen_id count 8/196]
2025-03-13 18:37:07: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2927338332_stir_with_spatula [chosen_id count 9/196]
2025-03-13 18:37:07: [retrieval_preprocessing] we have num_total=9627 embedding_dim=49152
[retrieval_preprocessing] for episode 16896 [episode count 0/20], we have num_retrieval=np.int64(9191) num_query=np.int64(436)
2025-03-13 18:37:08,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:37:09,615 [INFO]: Launching the whole pipeline 03/13/2025, 18:37:09
2025-03-13 18:37:09,615 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:37:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1962.71it/s]
2025-03-13 18:37:09,644 [INFO]: There are 9191 embeddings of dim 49152
2025-03-13 18:37:09,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 18:37:09,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:37:09
2025-03-13 18:37:09,645 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:37:09,645 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:37:09,645 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:37:09,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:37:09,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:37:09
2025-03-13 18:37:09,645 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:37:09,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:37:09,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:37:09
2025-03-13 18:37:09,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:37:09,645 [INFO]: 	Creating the index 03/13/2025, 18:37:09
2025-03-13 18:37:09,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:37:09
2025-03-13 18:37:09,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:37:09,646 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:37:09
2025-03-13 18:37:09,646 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:37:09,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:06,  6.03it/s] 13%|█▎        | 5/38 [00:00<00:01, 19.94it/s] 26%|██▋       | 10/38 [00:00<00:00, 29.32it/s] 39%|███▉      | 15/38 [00:00<00:00, 35.65it/s] 53%|█████▎    | 20/38 [00:00<00:00, 39.45it/s] 66%|██████▌   | 25/38 [00:04<00:03,  3.73it/s] 79%|███████▉  | 30/38 [00:04<00:01,  5.45it/s] 92%|█████████▏| 35/38 [00:04<00:00,  7.67it/s]100%|██████████| 38/38 [00:07<00:00,  4.79it/s]
2025-03-13 18:37:17,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:37:17
2025-03-13 18:38:18,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.2031 secs
2025-03-13 18:38:18,789 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 18:38:18,789 [INFO]: 	Compute fast metrics 03/13/2025, 18:38:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-13 18:39:06,519 [INFO]: 	>>> Finished "Compute fast metrics" in 47.7298 secs
2025-03-13 18:39:06,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.8762 secs
2025-03-13 18:39:06,522 [INFO]: {
2025-03-13 18:39:06,522 [INFO]: 	index_key: HNSW15
2025-03-13 18:39:06,523 [INFO]: 	index_param: efSearch=268
2025-03-13 18:39:06,523 [INFO]: 	index_path: knn.index
2025-03-13 18:39:06,523 [INFO]: 	size in bytes: 1808274910
2025-03-13 18:39:06,523 [INFO]: 	avg_search_speed_ms: 10.202879018425865
2025-03-13 18:39:06,523 [INFO]: 	99p_search_speed_ms: 21.628996140789244
2025-03-13 18:39:06,523 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:39:06,523 [INFO]: 	nb vectors: 9191
2025-03-13 18:39:06,523 [INFO]: 	vectors dimension: 49152
2025-03-13 18:39:06,523 [INFO]: 	compression ratio: 0.9993083009706749
2025-03-13 18:39:06,523 [INFO]: }
2025-03-13 18:39:06,523 [INFO]: 	>>> Finished "Creating the index" in 116.8776 secs
2025-03-13 18:39:06,523 [INFO]: >>> Finished "Launching the whole pipeline" in 116.9077 secs
2025-03-13 18:39:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 16896 [episode count 0/20]
[retrieval_preprocessing] for episode 10244 [episode count 1/20], we have num_retrieval=np.int64(9026) num_query=np.int64(601)
2025-03-13 18:39:12,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:14,985 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:14
2025-03-13 18:39:14,985 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-13 18:39:15,020 [INFO]: There are 9026 embeddings of dim 49152
2025-03-13 18:39:15,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 18:39:15,020 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:15
2025-03-13 18:39:15,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:15,020 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:39:15,020 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:39:15,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:39:15,021 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:15
2025-03-13 18:39:15,021 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:15,021 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:39:15,021 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:15
2025-03-13 18:39:15,021 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:39:15,021 [INFO]: 	Creating the index 03/13/2025, 18:39:15
2025-03-13 18:39:15,021 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:39:15
2025-03-13 18:39:15,022 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:39:15,022 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:15
2025-03-13 18:39:15,022 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:39:15,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:05,  6.03it/s] 11%|█         | 4/37 [00:00<00:02, 16.29it/s] 22%|██▏       | 8/37 [00:00<00:01, 24.52it/s] 32%|███▏      | 12/37 [00:00<00:00, 28.39it/s] 43%|████▎     | 16/37 [00:00<00:00, 29.88it/s] 54%|█████▍    | 20/37 [00:00<00:00, 30.60it/s] 65%|██████▍   | 24/37 [00:05<00:05,  2.23it/s] 76%|███████▌  | 28/37 [00:05<00:02,  3.22it/s] 86%|████████▋ | 32/37 [00:05<00:01,  4.56it/s]100%|██████████| 37/37 [00:11<00:00,  1.89it/s]100%|██████████| 37/37 [00:11<00:00,  3.27it/s]
2025-03-13 18:39:26,342 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:26
2025-03-13 18:40:31,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.4211 secs
2025-03-13 18:40:31,764 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 18:40:31,764 [INFO]: 	Compute fast metrics 03/13/2025, 18:40:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.51it/s]
2025-03-13 18:41:14,869 [INFO]: 	>>> Finished "Compute fast metrics" in 43.1046 secs
2025-03-13 18:41:14,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.8492 secs
2025-03-13 18:41:14,872 [INFO]: {
2025-03-13 18:41:14,872 [INFO]: 	index_key: HNSW15
2025-03-13 18:41:14,872 [INFO]: 	index_param: efSearch=227
2025-03-13 18:41:14,872 [INFO]: 	index_path: knn.index
2025-03-13 18:41:14,872 [INFO]: 	size in bytes: 1775812090
2025-03-13 18:41:14,872 [INFO]: 	avg_search_speed_ms: 8.850289708151754
2025-03-13 18:41:14,872 [INFO]: 	99p_search_speed_ms: 17.93404308380561
2025-03-13 18:41:14,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:41:14,872 [INFO]: 	nb vectors: 9026
2025-03-13 18:41:14,872 [INFO]: 	vectors dimension: 49152
2025-03-13 18:41:14,872 [INFO]: 	compression ratio: 0.9993083265921452
2025-03-13 18:41:14,872 [INFO]: }
2025-03-13 18:41:14,872 [INFO]: 	>>> Finished "Creating the index" in 119.8510 secs
2025-03-13 18:41:14,872 [INFO]: >>> Finished "Launching the whole pipeline" in 119.8870 secs
2025-03-13 18:41:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:41:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 10244 [episode count 1/20]
[retrieval_preprocessing] for episode 35850 [episode count 2/20], we have num_retrieval=np.int64(9080) num_query=np.int64(547)
2025-03-13 18:41:21,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:41:23,008 [INFO]: Launching the whole pipeline 03/13/2025, 18:41:23
2025-03-13 18:41:23,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:41:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-13 18:41:23,038 [INFO]: There are 9080 embeddings of dim 49152
2025-03-13 18:41:23,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 18:41:23,038 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:41:23
2025-03-13 18:41:23,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:41:23,038 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:41:23,038 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:41:23,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:41:23,038 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:41:23
2025-03-13 18:41:23,038 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:41:23,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:41:23,038 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:41:23
2025-03-13 18:41:23,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:41:23,039 [INFO]: 	Creating the index 03/13/2025, 18:41:23
2025-03-13 18:41:23,039 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:41:23
2025-03-13 18:41:23,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:41:23,040 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:41:23
2025-03-13 18:41:23,040 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:41:23,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  8.62it/s] 16%|█▌        | 6/37 [00:00<00:00, 31.18it/s] 32%|███▏      | 12/37 [00:00<00:00, 42.01it/s] 49%|████▊     | 18/37 [00:00<00:00, 46.93it/s] 62%|██████▏   | 23/37 [00:03<00:03,  4.27it/s] 78%|███████▊  | 29/37 [00:03<00:01,  6.57it/s] 95%|█████████▍| 35/37 [00:03<00:00,  9.51it/s]100%|██████████| 37/37 [00:06<00:00,  5.41it/s]
2025-03-13 18:41:29,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:41:29
2025-03-13 18:42:37,760 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.8755 secs
2025-03-13 18:42:37,760 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:42:37,760 [INFO]: 	Compute fast metrics 03/13/2025, 18:42:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-13 18:43:08,590 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8296 secs
2025-03-13 18:43:08,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.5521 secs
2025-03-13 18:43:08,592 [INFO]: {
2025-03-13 18:43:08,592 [INFO]: 	index_key: HNSW15
2025-03-13 18:43:08,592 [INFO]: 	index_param: efSearch=212
2025-03-13 18:43:08,592 [INFO]: 	index_path: knn.index
2025-03-13 18:43:08,592 [INFO]: 	size in bytes: 1786436350
2025-03-13 18:43:08,592 [INFO]: 	avg_search_speed_ms: 7.558822661753707
2025-03-13 18:43:08,592 [INFO]: 	99p_search_speed_ms: 11.979951960965991
2025-03-13 18:43:08,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:43:08,592 [INFO]: 	nb vectors: 9080
2025-03-13 18:43:08,592 [INFO]: 	vectors dimension: 49152
2025-03-13 18:43:08,592 [INFO]: 	compression ratio: 0.9993082821002831
2025-03-13 18:43:08,592 [INFO]: }
2025-03-13 18:43:08,592 [INFO]: 	>>> Finished "Creating the index" in 105.5538 secs
2025-03-13 18:43:08,592 [INFO]: >>> Finished "Launching the whole pipeline" in 105.5839 secs
2025-03-13 18:43:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:43:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 35850 [episode count 2/20]
[retrieval_preprocessing] for episode 69158 [episode count 3/20], we have num_retrieval=np.int64(9110) num_query=np.int64(517)
2025-03-13 18:43:13,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:43:14,220 [INFO]: Launching the whole pipeline 03/13/2025, 18:43:14
2025-03-13 18:43:14,220 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:43:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.27it/s]
2025-03-13 18:43:14,252 [INFO]: There are 9110 embeddings of dim 49152
2025-03-13 18:43:14,253 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 18:43:14,253 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:43:14
2025-03-13 18:43:14,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:43:14,253 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:43:14,253 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:43:14,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:43:14,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:43:14
2025-03-13 18:43:14,253 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:43:14,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:43:14,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:43:14
2025-03-13 18:43:14,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:43:14,253 [INFO]: 	Creating the index 03/13/2025, 18:43:14
2025-03-13 18:43:14,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:43:14
2025-03-13 18:43:14,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:43:14,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:43:14
2025-03-13 18:43:14,254 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:43:14,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  7.42it/s] 16%|█▌        | 6/37 [00:00<00:01, 27.26it/s] 32%|███▏      | 12/37 [00:00<00:00, 37.72it/s] 46%|████▌     | 17/37 [00:00<00:00, 42.01it/s] 59%|█████▉    | 22/37 [00:03<00:03,  4.02it/s] 76%|███████▌  | 28/37 [00:03<00:01,  6.28it/s] 92%|█████████▏| 34/37 [00:03<00:00,  9.18it/s]100%|██████████| 37/37 [00:06<00:00,  5.61it/s]
2025-03-13 18:43:20,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:43:20
2025-03-13 18:44:19,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4673 secs
2025-03-13 18:44:19,322 [INFO]: The best hyperparameters are: efSearch=240
2025-03-13 18:44:19,322 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 18:45:10,517 [INFO]: 	>>> Finished "Compute fast metrics" in 51.1946 secs
2025-03-13 18:45:10,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 116.2649 secs
2025-03-13 18:45:10,519 [INFO]: {
2025-03-13 18:45:10,519 [INFO]: 	index_key: HNSW15
2025-03-13 18:45:10,519 [INFO]: 	index_param: efSearch=240
2025-03-13 18:45:10,519 [INFO]: 	index_path: knn.index
2025-03-13 18:45:10,519 [INFO]: 	size in bytes: 1792338670
2025-03-13 18:45:10,519 [INFO]: 	avg_search_speed_ms: 8.61217610339067
2025-03-13 18:45:10,519 [INFO]: 	99p_search_speed_ms: 12.702014110982436
2025-03-13 18:45:10,519 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:10,519 [INFO]: 	nb vectors: 9110
2025-03-13 18:45:10,519 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:10,519 [INFO]: 	compression ratio: 0.9993082836292317
2025-03-13 18:45:10,519 [INFO]: }
2025-03-13 18:45:10,519 [INFO]: 	>>> Finished "Creating the index" in 116.2663 secs
2025-03-13 18:45:10,519 [INFO]: >>> Finished "Launching the whole pipeline" in 116.2990 secs
2025-03-13 18:45:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 69158 [episode count 3/20]
[retrieval_preprocessing] for episode 68649 [episode count 4/20], we have num_retrieval=np.int64(9136) num_query=np.int64(491)
2025-03-13 18:45:16,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:17,402 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:17
2025-03-13 18:45:17,402 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1934.64it/s]
2025-03-13 18:45:17,433 [INFO]: There are 9136 embeddings of dim 49152
2025-03-13 18:45:17,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 18:45:17,434 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,434 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:17,434 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:45:17,434 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:45:17,434 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:45:17,434 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,435 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:17,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:45:17,435 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:17
2025-03-13 18:45:17,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:17,436 [INFO]: 	Creating the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,436 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:17
2025-03-13 18:45:17,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 18:45:17,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:17
2025-03-13 18:45:17,439 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:45:17,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:03,  9.82it/s] 19%|█▉        | 7/37 [00:00<00:00, 35.32it/s] 35%|███▌      | 13/37 [00:00<00:00, 43.26it/s] 49%|████▊     | 18/37 [00:00<00:00, 45.52it/s] 62%|██████▏   | 23/37 [00:04<00:04,  3.17it/s] 73%|███████▎  | 27/37 [00:04<00:02,  4.31it/s] 84%|████████▍ | 31/37 [00:04<00:01,  5.79it/s] 95%|█████████▍| 35/37 [00:04<00:00,  7.65it/s]100%|██████████| 37/37 [00:08<00:00,  4.48it/s]
2025-03-13 18:45:25,697 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:25
2025-03-13 18:46:27,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.1460 secs
2025-03-13 18:46:27,843 [INFO]: The best hyperparameters are: efSearch=276
2025-03-13 18:46:27,843 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.02it/s]
2025-03-13 18:47:16,312 [INFO]: 	>>> Finished "Compute fast metrics" in 48.4681 secs
2025-03-13 18:47:16,314 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.8750 secs
2025-03-13 18:47:16,314 [INFO]: {
2025-03-13 18:47:16,314 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:16,314 [INFO]: 	index_param: efSearch=276
2025-03-13 18:47:16,314 [INFO]: 	index_path: knn.index
2025-03-13 18:47:16,314 [INFO]: 	size in bytes: 1797454090
2025-03-13 18:47:16,314 [INFO]: 	avg_search_speed_ms: 9.771644997954354
2025-03-13 18:47:16,314 [INFO]: 	99p_search_speed_ms: 15.534254075028002
2025-03-13 18:47:16,314 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:16,314 [INFO]: 	nb vectors: 9136
2025-03-13 18:47:16,314 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:16,314 [INFO]: 	compression ratio: 0.9993082426934198
2025-03-13 18:47:16,315 [INFO]: }
2025-03-13 18:47:16,315 [INFO]: 	>>> Finished "Creating the index" in 118.8788 secs
2025-03-13 18:47:16,315 [INFO]: >>> Finished "Launching the whole pipeline" in 118.9129 secs
2025-03-13 18:47:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 68649 [episode count 4/20]
[retrieval_preprocessing] for episode 34341 [episode count 5/20], we have num_retrieval=np.int64(9276) num_query=np.int64(351)
2025-03-13 18:47:21,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:23,272 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:23
2025-03-13 18:47:23,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.31it/s]
2025-03-13 18:47:23,304 [INFO]: There are 9276 embeddings of dim 49152
2025-03-13 18:47:23,304 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-13 18:47:23,304 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,304 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:23,304 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 18:47:23,304 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:47:23,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:47:23,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,305 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:23,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:47:23,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:23
2025-03-13 18:47:23,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:23,305 [INFO]: 	Creating the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:23
2025-03-13 18:47:23,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:47:23,306 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:23
2025-03-13 18:47:23,306 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:47:23,306 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.81it/s] 11%|█         | 4/38 [00:00<00:02, 16.41it/s] 24%|██▎       | 9/38 [00:00<00:01, 27.00it/s] 37%|███▋      | 14/38 [00:00<00:00, 32.22it/s] 50%|█████     | 19/38 [00:00<00:00, 35.09it/s] 61%|██████    | 23/38 [00:04<00:04,  3.14it/s] 76%|███████▋  | 29/38 [00:04<00:01,  5.06it/s] 89%|████████▉ | 34/38 [00:04<00:00,  7.16it/s]100%|██████████| 38/38 [00:07<00:00,  3.17it/s]100%|██████████| 38/38 [00:07<00:00,  4.89it/s]
2025-03-13 18:47:31,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:31
2025-03-13 18:48:35,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.7009 secs
2025-03-13 18:48:35,781 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 18:48:35,781 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.82it/s]
2025-03-13 18:49:11,131 [INFO]: 	>>> Finished "Compute fast metrics" in 35.3496 secs
2025-03-13 18:49:11,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.8278 secs
2025-03-13 18:49:11,134 [INFO]: {
2025-03-13 18:49:11,134 [INFO]: 	index_key: HNSW15
2025-03-13 18:49:11,134 [INFO]: 	index_param: efSearch=253
2025-03-13 18:49:11,134 [INFO]: 	index_path: knn.index
2025-03-13 18:49:11,134 [INFO]: 	size in bytes: 1824998410
2025-03-13 18:49:11,134 [INFO]: 	avg_search_speed_ms: 10.802894745466599
2025-03-13 18:49:11,134 [INFO]: 	99p_search_speed_ms: 21.354396943934262
2025-03-13 18:49:11,134 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:49:11,134 [INFO]: 	nb vectors: 9276
2025-03-13 18:49:11,134 [INFO]: 	vectors dimension: 49152
2025-03-13 18:49:11,134 [INFO]: 	compression ratio: 0.9993081626849198
2025-03-13 18:49:11,134 [INFO]: }
2025-03-13 18:49:11,134 [INFO]: 	>>> Finished "Creating the index" in 107.8292 secs
2025-03-13 18:49:11,134 [INFO]: >>> Finished "Launching the whole pipeline" in 107.8623 secs
2025-03-13 18:49:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:49:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 34341 [episode count 5/20]
[retrieval_preprocessing] for episode 18055 [episode count 6/20], we have num_retrieval=np.int64(9143) num_query=np.int64(484)
2025-03-13 18:49:15,137 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:49:16,580 [INFO]: Launching the whole pipeline 03/13/2025, 18:49:16
2025-03-13 18:49:16,580 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:49:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.38it/s]
2025-03-13 18:49:16,612 [INFO]: There are 9143 embeddings of dim 49152
2025-03-13 18:49:16,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 18:49:16,613 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:49:16
2025-03-13 18:49:16,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:49:16,613 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:49:16,613 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:49:16,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:49:16,613 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:49:16
2025-03-13 18:49:16,613 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:49:16,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:49:16,613 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:49:16
2025-03-13 18:49:16,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:49:16,613 [INFO]: 	Creating the index 03/13/2025, 18:49:16
2025-03-13 18:49:16,613 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:49:16
2025-03-13 18:49:16,614 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 18:49:16,615 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:49:16
2025-03-13 18:49:16,615 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:49:16,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:03,  9.19it/s] 16%|█▌        | 6/37 [00:00<00:01, 29.73it/s] 30%|██▉       | 11/37 [00:00<00:00, 36.81it/s] 43%|████▎     | 16/37 [00:00<00:00, 41.19it/s] 57%|█████▋    | 21/37 [00:03<00:04,  3.79it/s] 70%|███████   | 26/37 [00:03<00:01,  5.63it/s] 84%|████████▍ | 31/37 [00:03<00:00,  8.01it/s] 97%|█████████▋| 36/37 [00:03<00:00, 10.98it/s]100%|██████████| 37/37 [00:07<00:00,  5.13it/s]
2025-03-13 18:49:23,835 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:49:23
2025-03-13 18:50:28,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.4992 secs
2025-03-13 18:50:28,335 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 18:50:28,335 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 18:51:00,636 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3007 secs
2025-03-13 18:51:00,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.0243 secs
2025-03-13 18:51:00,639 [INFO]: {
2025-03-13 18:51:00,639 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:00,639 [INFO]: 	index_param: efSearch=237
2025-03-13 18:51:00,639 [INFO]: 	index_path: knn.index
2025-03-13 18:51:00,639 [INFO]: 	size in bytes: 1798831270
2025-03-13 18:51:00,639 [INFO]: 	avg_search_speed_ms: 9.558101244320662
2025-03-13 18:51:00,639 [INFO]: 	99p_search_speed_ms: 17.61911587091161
2025-03-13 18:51:00,639 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:00,639 [INFO]: 	nb vectors: 9143
2025-03-13 18:51:00,639 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:00,639 [INFO]: 	compression ratio: 0.9993082586339518
2025-03-13 18:51:00,639 [INFO]: }
2025-03-13 18:51:00,639 [INFO]: 	>>> Finished "Creating the index" in 104.0261 secs
2025-03-13 18:51:00,639 [INFO]: >>> Finished "Launching the whole pipeline" in 104.0591 secs
2025-03-13 18:51:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 18055 [episode count 6/20]
[retrieval_preprocessing] for episode 53380 [episode count 7/20], we have num_retrieval=np.int64(9131) num_query=np.int64(496)
2025-03-13 18:51:06,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:07,488 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:07
2025-03-13 18:51:07,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.91it/s]
2025-03-13 18:51:07,519 [INFO]: There are 9131 embeddings of dim 49152
2025-03-13 18:51:07,519 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 18:51:07,520 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:07
2025-03-13 18:51:07,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:07,520 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:51:07,520 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:51:07,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:51:07,520 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:07
2025-03-13 18:51:07,520 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:07,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:51:07,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:07
2025-03-13 18:51:07,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:07,520 [INFO]: 	Creating the index 03/13/2025, 18:51:07
2025-03-13 18:51:07,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:07
2025-03-13 18:51:07,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:51:07,521 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:07
2025-03-13 18:51:07,521 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:51:07,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  7.69it/s] 16%|█▌        | 6/37 [00:00<00:01, 28.26it/s] 30%|██▉       | 11/37 [00:00<00:00, 36.76it/s] 43%|████▎     | 16/37 [00:00<00:00, 41.14it/s] 57%|█████▋    | 21/37 [00:04<00:04,  3.31it/s] 73%|███████▎  | 27/37 [00:04<00:01,  5.29it/s] 89%|████████▉ | 33/37 [00:04<00:00,  7.91it/s]100%|██████████| 37/37 [00:07<00:00,  4.85it/s]
2025-03-13 18:51:15,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:15
2025-03-13 18:52:13,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.3699 secs
2025-03-13 18:52:13,524 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 18:52:13,524 [INFO]: 	Compute fast metrics 03/13/2025, 18:52:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-13 18:52:57,159 [INFO]: 	>>> Finished "Compute fast metrics" in 43.6353 secs
2025-03-13 18:52:57,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 109.6407 secs
2025-03-13 18:52:57,162 [INFO]: {
2025-03-13 18:52:57,162 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:57,162 [INFO]: 	index_param: efSearch=212
2025-03-13 18:52:57,162 [INFO]: 	index_path: knn.index
2025-03-13 18:52:57,162 [INFO]: 	size in bytes: 1796470270
2025-03-13 18:52:57,162 [INFO]: 	avg_search_speed_ms: 8.096977426229339
2025-03-13 18:52:57,162 [INFO]: 	99p_search_speed_ms: 12.21179617568851
2025-03-13 18:52:57,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:57,162 [INFO]: 	nb vectors: 9131
2025-03-13 18:52:57,162 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:57,162 [INFO]: 	compression ratio: 0.9993082980438078
2025-03-13 18:52:57,162 [INFO]: }
2025-03-13 18:52:57,162 [INFO]: 	>>> Finished "Creating the index" in 109.6422 secs
2025-03-13 18:52:57,162 [INFO]: >>> Finished "Launching the whole pipeline" in 109.6741 secs
2025-03-13 18:52:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 53380 [episode count 7/20]
[retrieval_preprocessing] for episode 24369 [episode count 8/20], we have num_retrieval=np.int64(9096) num_query=np.int64(531)
2025-03-13 18:53:02,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:03,500 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:03
2025-03-13 18:53:03,500 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 902.19it/s]
2025-03-13 18:53:03,530 [INFO]: There are 9096 embeddings of dim 49152
2025-03-13 18:53:03,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 18:53:03,530 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:03
2025-03-13 18:53:03,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:03,530 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:53:03,530 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:03,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:53:03,530 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:03
2025-03-13 18:53:03,531 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:03,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:53:03,531 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:03
2025-03-13 18:53:03,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:03,531 [INFO]: 	Creating the index 03/13/2025, 18:53:03
2025-03-13 18:53:03,531 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:03
2025-03-13 18:53:03,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:53:03,532 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:03
2025-03-13 18:53:03,532 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:53:03,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  8.13it/s] 14%|█▎        | 5/37 [00:00<00:01, 24.94it/s] 30%|██▉       | 11/37 [00:00<00:00, 37.97it/s] 46%|████▌     | 17/37 [00:00<00:00, 44.16it/s] 59%|█████▉    | 22/37 [00:03<00:03,  4.26it/s] 76%|███████▌  | 28/37 [00:03<00:01,  6.56it/s] 89%|████████▉ | 33/37 [00:03<00:00,  9.01it/s]100%|██████████| 37/37 [00:06<00:00,  5.40it/s]
2025-03-13 18:53:10,394 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:10
2025-03-13 18:54:04,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.0851 secs
2025-03-13 18:54:04,480 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 18:54:04,480 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 18:54:44,291 [INFO]: 	>>> Finished "Compute fast metrics" in 39.8110 secs
2025-03-13 18:54:44,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.7617 secs
2025-03-13 18:54:44,294 [INFO]: {
2025-03-13 18:54:44,294 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:44,294 [INFO]: 	index_param: efSearch=246
2025-03-13 18:54:44,294 [INFO]: 	index_path: knn.index
2025-03-13 18:54:44,294 [INFO]: 	size in bytes: 1789584310
2025-03-13 18:54:44,294 [INFO]: 	avg_search_speed_ms: 8.910694142343699
2025-03-13 18:54:44,294 [INFO]: 	99p_search_speed_ms: 13.865683227777476
2025-03-13 18:54:44,294 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:44,294 [INFO]: 	nb vectors: 9096
2025-03-13 18:54:44,294 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:44,294 [INFO]: 	compression ratio: 0.9993082516464397
2025-03-13 18:54:44,294 [INFO]: }
2025-03-13 18:54:44,294 [INFO]: 	>>> Finished "Creating the index" in 100.7631 secs
2025-03-13 18:54:44,294 [INFO]: >>> Finished "Launching the whole pipeline" in 100.7936 secs
2025-03-13 18:54:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 24369 [episode count 8/20]
[retrieval_preprocessing] for episode 25278 [episode count 9/20], we have num_retrieval=np.int64(9220) num_query=np.int64(407)
2025-03-13 18:54:49,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:50,924 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:50
2025-03-13 18:54:50,924 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1034.61it/s]
2025-03-13 18:54:50,952 [INFO]: There are 9220 embeddings of dim 49152
2025-03-13 18:54:50,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 18:54:50,953 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:50
2025-03-13 18:54:50,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:50,953 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 18:54:50,953 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:54:50,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:54:50,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:50
2025-03-13 18:54:50,953 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:50,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:54:50,953 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:50
2025-03-13 18:54:50,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:50,953 [INFO]: 	Creating the index 03/13/2025, 18:54:50
2025-03-13 18:54:50,953 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:50
2025-03-13 18:54:50,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:54:50,954 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:50
2025-03-13 18:54:50,954 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:54:50,954 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  8.59it/s] 16%|█▌        | 6/38 [00:00<00:01, 28.87it/s] 32%|███▏      | 12/38 [00:00<00:00, 40.71it/s] 47%|████▋     | 18/38 [00:00<00:00, 46.71it/s] 61%|██████    | 23/38 [00:03<00:03,  4.10it/s] 76%|███████▋  | 29/38 [00:03<00:01,  6.30it/s] 92%|█████████▏| 35/38 [00:03<00:00,  9.10it/s]100%|██████████| 38/38 [00:07<00:00,  5.40it/s]
2025-03-13 18:54:57,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:57
2025-03-13 18:55:57,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.8975 secs
2025-03-13 18:55:57,895 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 18:55:57,895 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 18:56:35,054 [INFO]: 	>>> Finished "Compute fast metrics" in 37.1582 secs
2025-03-13 18:56:35,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1031 secs
2025-03-13 18:56:35,057 [INFO]: {
2025-03-13 18:56:35,057 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:35,058 [INFO]: 	index_param: efSearch=262
2025-03-13 18:56:35,058 [INFO]: 	index_path: knn.index
2025-03-13 18:56:35,058 [INFO]: 	size in bytes: 1813980670
2025-03-13 18:56:35,058 [INFO]: 	avg_search_speed_ms: 9.183188193093702
2025-03-13 18:56:35,058 [INFO]: 	99p_search_speed_ms: 18.9936153590679
2025-03-13 18:56:35,058 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:35,058 [INFO]: 	nb vectors: 9220
2025-03-13 18:56:35,058 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:35,058 [INFO]: 	compression ratio: 0.9993082010074562
2025-03-13 18:56:35,058 [INFO]: }
2025-03-13 18:56:35,058 [INFO]: 	>>> Finished "Creating the index" in 104.1046 secs
2025-03-13 18:56:35,058 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1338 secs
2025-03-13 18:56:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 25278 [episode count 9/20]
[retrieval_preprocessing] for episode 54991 [episode count 10/20], we have num_retrieval=np.int64(9094) num_query=np.int64(533)
2025-03-13 18:56:41,767 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:43,045 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:43
2025-03-13 18:56:43,045 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 986.66it/s]
2025-03-13 18:56:43,076 [INFO]: There are 9094 embeddings of dim 49152
2025-03-13 18:56:43,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 18:56:43,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:43
2025-03-13 18:56:43,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:43,077 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 18:56:43,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:43,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:43,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:43
2025-03-13 18:56:43,077 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:43,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:56:43,077 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:43
2025-03-13 18:56:43,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:43,077 [INFO]: 	Creating the index 03/13/2025, 18:56:43
2025-03-13 18:56:43,077 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:43
2025-03-13 18:56:43,078 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:56:43,078 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:43
2025-03-13 18:56:43,078 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 18:56:43,078 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:05,  6.48it/s] 16%|█▌        | 6/37 [00:00<00:01, 25.07it/s] 30%|██▉       | 11/37 [00:00<00:00, 32.66it/s] 43%|████▎     | 16/37 [00:00<00:00, 37.05it/s] 57%|█████▋    | 21/37 [00:04<00:04,  3.45it/s] 70%|███████   | 26/37 [00:04<00:02,  5.15it/s] 86%|████████▋ | 32/37 [00:04<00:00,  7.85it/s]100%|██████████| 37/37 [00:07<00:00,  3.40it/s]100%|██████████| 37/37 [00:07<00:00,  4.89it/s]
2025-03-13 18:56:50,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:50
2025-03-13 18:57:55,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.2979 secs
2025-03-13 18:57:55,944 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 18:57:55,944 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.84it/s]
2025-03-13 18:58:27,933 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9887 secs
2025-03-13 18:58:27,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.8574 secs
2025-03-13 18:58:27,936 [INFO]: {
2025-03-13 18:58:27,936 [INFO]: 	index_key: HNSW15
2025-03-13 18:58:27,936 [INFO]: 	index_param: efSearch=204
2025-03-13 18:58:27,936 [INFO]: 	index_path: knn.index
2025-03-13 18:58:27,936 [INFO]: 	size in bytes: 1789190830
2025-03-13 18:58:27,936 [INFO]: 	avg_search_speed_ms: 7.977524379280181
2025-03-13 18:58:27,936 [INFO]: 	99p_search_speed_ms: 12.282762126997113
2025-03-13 18:58:27,936 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:58:27,936 [INFO]: 	nb vectors: 9094
2025-03-13 18:58:27,936 [INFO]: 	vectors dimension: 49152
2025-03-13 18:58:27,936 [INFO]: 	compression ratio: 0.9993082470694308
2025-03-13 18:58:27,936 [INFO]: }
2025-03-13 18:58:27,936 [INFO]: 	>>> Finished "Creating the index" in 104.8588 secs
2025-03-13 18:58:27,936 [INFO]: >>> Finished "Launching the whole pipeline" in 104.8910 secs
2025-03-13 18:58:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:58:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 54991 [episode count 10/20]
[retrieval_preprocessing] for episode 39120 [episode count 11/20], we have num_retrieval=np.int64(8983) num_query=np.int64(644)
2025-03-13 18:58:32,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:58:34,289 [INFO]: Launching the whole pipeline 03/13/2025, 18:58:34
2025-03-13 18:58:34,289 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:58:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.30it/s]
2025-03-13 18:58:34,322 [INFO]: There are 8983 embeddings of dim 49152
2025-03-13 18:58:34,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 18:58:34,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:58:34
2025-03-13 18:58:34,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:58:34,322 [INFO]: 		-> Add: 4.9 seconds
2025-03-13 18:58:34,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:58:34,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:58:34,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:58:34
2025-03-13 18:58:34,322 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:58:34,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:58:34,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:58:34
2025-03-13 18:58:34,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:58:34,322 [INFO]: 	Creating the index 03/13/2025, 18:58:34
2025-03-13 18:58:34,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:58:34
2025-03-13 18:58:34,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:58:34,324 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:58:34
2025-03-13 18:58:34,324 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-13 18:58:34,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  7.52it/s] 16%|█▌        | 6/37 [00:00<00:01, 29.41it/s] 32%|███▏      | 12/37 [00:00<00:00, 40.29it/s] 49%|████▊     | 18/37 [00:00<00:00, 46.39it/s] 62%|██████▏   | 23/37 [00:03<00:03,  4.03it/s] 78%|███████▊  | 29/37 [00:03<00:01,  6.18it/s] 92%|█████████▏| 34/37 [00:03<00:00,  8.46it/s]100%|██████████| 37/37 [00:06<00:00,  5.56it/s]
2025-03-13 18:58:40,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:40
2025-03-13 18:59:40,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.8731 secs
2025-03-13 18:59:40,855 [INFO]: The best hyperparameters are: efSearch=263
2025-03-13 18:59:40,855 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 19:00:35,876 [INFO]: 	>>> Finished "Compute fast metrics" in 55.0208 secs
2025-03-13 19:00:35,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.5555 secs
2025-03-13 19:00:35,879 [INFO]: {
2025-03-13 19:00:35,879 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:35,879 [INFO]: 	index_param: efSearch=263
2025-03-13 19:00:35,879 [INFO]: 	index_path: knn.index
2025-03-13 19:00:35,879 [INFO]: 	size in bytes: 1767352150
2025-03-13 19:00:35,879 [INFO]: 	avg_search_speed_ms: 9.559271493205449
2025-03-13 19:00:35,880 [INFO]: 	99p_search_speed_ms: 13.168667443096632
2025-03-13 19:00:35,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:35,880 [INFO]: 	nb vectors: 8983
2025-03-13 19:00:35,880 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:35,880 [INFO]: 	compression ratio: 0.9993082951804483
2025-03-13 19:00:35,880 [INFO]: }
2025-03-13 19:00:35,880 [INFO]: 	>>> Finished "Creating the index" in 121.5572 secs
2025-03-13 19:00:35,880 [INFO]: >>> Finished "Launching the whole pipeline" in 121.5908 secs
2025-03-13 19:00:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 39120 [episode count 11/20]
[retrieval_preprocessing] for episode 46319 [episode count 12/20], we have num_retrieval=np.int64(9158) num_query=np.int64(469)
2025-03-13 19:00:44,234 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:45,965 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:45
2025-03-13 19:00:45,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.01it/s]
2025-03-13 19:00:45,998 [INFO]: There are 9158 embeddings of dim 49152
2025-03-13 19:00:45,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 19:00:45,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:45
2025-03-13 19:00:45,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:45,998 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:00:45,998 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:00:45,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:00:45,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:45
2025-03-13 19:00:45,998 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:45,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:00:45,998 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:45
2025-03-13 19:00:45,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:45,998 [INFO]: 	Creating the index 03/13/2025, 19:00:45
2025-03-13 19:00:45,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:45
2025-03-13 19:00:46,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:00:46,000 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:46
2025-03-13 19:00:46,000 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:00:46,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  7.69it/s] 13%|█▎        | 5/38 [00:00<00:01, 22.90it/s] 29%|██▉       | 11/38 [00:00<00:00, 35.23it/s] 42%|████▏     | 16/38 [00:00<00:00, 40.40it/s] 55%|█████▌    | 21/38 [00:03<00:04,  3.61it/s] 68%|██████▊   | 26/38 [00:03<00:02,  5.34it/s] 82%|████████▏ | 31/38 [00:04<00:00,  7.59it/s] 95%|█████████▍| 36/38 [00:04<00:00, 10.38it/s]100%|██████████| 38/38 [00:07<00:00,  4.84it/s]
2025-03-13 19:00:53,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:53
2025-03-13 19:01:53,447 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5919 secs
2025-03-13 19:01:53,447 [INFO]: The best hyperparameters are: efSearch=295
2025-03-13 19:01:53,447 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.79it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 19:02:41,618 [INFO]: 	>>> Finished "Compute fast metrics" in 48.1707 secs
2025-03-13 19:02:41,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 115.6221 secs
2025-03-13 19:02:41,622 [INFO]: {
2025-03-13 19:02:41,622 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:41,622 [INFO]: 	index_param: efSearch=295
2025-03-13 19:02:41,622 [INFO]: 	index_path: knn.index
2025-03-13 19:02:41,622 [INFO]: 	size in bytes: 1801782430
2025-03-13 19:02:41,622 [INFO]: 	avg_search_speed_ms: 17.075592841088465
2025-03-13 19:02:41,622 [INFO]: 	99p_search_speed_ms: 24.305784795433276
2025-03-13 19:02:41,622 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:41,622 [INFO]: 	nb vectors: 9158
2025-03-13 19:02:41,622 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:41,622 [INFO]: 	compression ratio: 0.9993082594328551
2025-03-13 19:02:41,622 [INFO]: }
2025-03-13 19:02:41,622 [INFO]: 	>>> Finished "Creating the index" in 115.6239 secs
2025-03-13 19:02:41,622 [INFO]: >>> Finished "Launching the whole pipeline" in 115.6578 secs
2025-03-13 19:02:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 46319 [episode count 12/20]
[retrieval_preprocessing] for episode 784 [episode count 13/20], we have num_retrieval=np.int64(9109) num_query=np.int64(518)
2025-03-13 19:02:47,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:49,237 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:49
2025-03-13 19:02:49,237 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.38it/s]
2025-03-13 19:02:49,271 [INFO]: There are 9109 embeddings of dim 49152
2025-03-13 19:02:49,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 19:02:49,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:49
2025-03-13 19:02:49,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:49,272 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:02:49,272 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:02:49,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:02:49,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:49
2025-03-13 19:02:49,273 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:49,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:02:49,273 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:49
2025-03-13 19:02:49,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:49,273 [INFO]: 	Creating the index 03/13/2025, 19:02:49
2025-03-13 19:02:49,273 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:49
2025-03-13 19:02:49,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:02:49,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:49
2025-03-13 19:02:49,277 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:02:49,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:00<00:04,  8.82it/s] 16%|█▌        | 6/37 [00:00<00:00, 31.46it/s] 32%|███▏      | 12/37 [00:00<00:00, 41.08it/s] 49%|████▊     | 18/37 [00:00<00:00, 45.16it/s] 62%|██████▏   | 23/37 [00:03<00:03,  4.35it/s] 78%|███████▊  | 29/37 [00:03<00:01,  6.64it/s] 95%|█████████▍| 35/37 [00:03<00:00,  9.55it/s]100%|██████████| 37/37 [00:06<00:00,  5.60it/s]
2025-03-13 19:02:55,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:55
2025-03-13 19:03:56,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0498 secs
2025-03-13 19:03:56,945 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 19:03:56,945 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.77it/s]
2025-03-13 19:04:28,785 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8390 secs
2025-03-13 19:04:28,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.5103 secs
2025-03-13 19:04:28,787 [INFO]: {
2025-03-13 19:04:28,787 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:28,787 [INFO]: 	index_param: efSearch=261
2025-03-13 19:04:28,787 [INFO]: 	index_path: knn.index
2025-03-13 19:04:28,787 [INFO]: 	size in bytes: 1792141930
2025-03-13 19:04:28,787 [INFO]: 	avg_search_speed_ms: 12.266658453922147
2025-03-13 19:04:28,787 [INFO]: 	99p_search_speed_ms: 22.58121938444674
2025-03-13 19:04:28,787 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:28,787 [INFO]: 	nb vectors: 9109
2025-03-13 19:04:28,787 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:28,787 [INFO]: 	compression ratio: 0.9993082813480069
2025-03-13 19:04:28,787 [INFO]: }
2025-03-13 19:04:28,788 [INFO]: 	>>> Finished "Creating the index" in 99.5143 secs
2025-03-13 19:04:28,788 [INFO]: >>> Finished "Launching the whole pipeline" in 99.5503 secs
2025-03-13 19:04:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 784 [episode count 13/20]
[retrieval_preprocessing] for episode 47910 [episode count 14/20], we have num_retrieval=np.int64(9155) num_query=np.int64(472)
2025-03-13 19:04:35,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:36,177 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:36
2025-03-13 19:04:36,178 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 967.32it/s]
2025-03-13 19:04:36,209 [INFO]: There are 9155 embeddings of dim 49152
2025-03-13 19:04:36,209 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 19:04:36,209 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:36
2025-03-13 19:04:36,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:36,209 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:04:36,210 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:04:36,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:04:36,210 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:36
2025-03-13 19:04:36,210 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:36,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:04:36,210 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:36
2025-03-13 19:04:36,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:36,210 [INFO]: 	Creating the index 03/13/2025, 19:04:36
2025-03-13 19:04:36,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:36
2025-03-13 19:04:36,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 19:04:36,214 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:36
2025-03-13 19:04:36,214 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:04:36,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  8.82it/s] 21%|██        | 8/38 [00:00<00:00, 39.34it/s] 39%|███▉      | 15/38 [00:00<00:00, 49.23it/s] 55%|█████▌    | 21/38 [00:03<00:03,  4.43it/s] 68%|██████▊   | 26/38 [00:03<00:01,  6.27it/s] 82%|████████▏ | 31/38 [00:03<00:00,  8.67it/s] 95%|█████████▍| 36/38 [00:03<00:00, 11.66it/s]100%|██████████| 38/38 [00:06<00:00,  5.53it/s]
2025-03-13 19:04:43,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:04:43
2025-03-13 19:05:41,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9244 secs
2025-03-13 19:05:41,016 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 19:05:41,016 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-13 19:06:27,797 [INFO]: 	>>> Finished "Compute fast metrics" in 46.7804 secs
2025-03-13 19:06:27,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.5859 secs
2025-03-13 19:06:27,800 [INFO]: {
2025-03-13 19:06:27,800 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:27,800 [INFO]: 	index_param: efSearch=266
2025-03-13 19:06:27,800 [INFO]: 	index_path: knn.index
2025-03-13 19:06:27,800 [INFO]: 	size in bytes: 1801192210
2025-03-13 19:06:27,800 [INFO]: 	avg_search_speed_ms: 9.416611872836176
2025-03-13 19:06:27,800 [INFO]: 	99p_search_speed_ms: 14.355216263793423
2025-03-13 19:06:27,800 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:27,800 [INFO]: 	nb vectors: 9155
2025-03-13 19:06:27,800 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:27,800 [INFO]: 	compression ratio: 0.9993082526156384
2025-03-13 19:06:27,800 [INFO]: }
2025-03-13 19:06:27,800 [INFO]: 	>>> Finished "Creating the index" in 111.5895 secs
2025-03-13 19:06:27,800 [INFO]: >>> Finished "Launching the whole pipeline" in 111.6226 secs
2025-03-13 19:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 47910 [episode count 14/20]
[retrieval_preprocessing] for episode 61347 [episode count 15/20], we have num_retrieval=np.int64(9209) num_query=np.int64(418)
2025-03-13 19:06:33,667 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:35,635 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:35
2025-03-13 19:06:35,635 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.85it/s]
2025-03-13 19:06:35,667 [INFO]: There are 9209 embeddings of dim 49152
2025-03-13 19:06:35,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 19:06:35,668 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:35
2025-03-13 19:06:35,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:35,668 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 19:06:35,668 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:06:35,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:35,668 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:35
2025-03-13 19:06:35,668 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:35,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:06:35,668 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:35
2025-03-13 19:06:35,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:35,668 [INFO]: 	Creating the index 03/13/2025, 19:06:35
2025-03-13 19:06:35,668 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:35
2025-03-13 19:06:35,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:06:35,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:35
2025-03-13 19:06:35,670 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:06:35,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  7.66it/s] 16%|█▌        | 6/38 [00:00<00:01, 29.16it/s] 32%|███▏      | 12/38 [00:00<00:00, 40.06it/s] 47%|████▋     | 18/38 [00:00<00:00, 45.08it/s] 61%|██████    | 23/38 [00:04<00:04,  3.22it/s] 74%|███████▎  | 28/38 [00:04<00:02,  4.67it/s] 87%|████████▋ | 33/38 [00:04<00:00,  6.60it/s]100%|██████████| 38/38 [00:08<00:00,  3.17it/s]100%|██████████| 38/38 [00:08<00:00,  4.63it/s]
2025-03-13 19:06:43,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:43
2025-03-13 19:07:41,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2400 secs
2025-03-13 19:07:41,120 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 19:07:41,120 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-13 19:08:33,479 [INFO]: 	>>> Finished "Compute fast metrics" in 52.3594 secs
2025-03-13 19:08:33,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 117.8130 secs
2025-03-13 19:08:33,483 [INFO]: {
2025-03-13 19:08:33,483 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:33,483 [INFO]: 	index_param: efSearch=272
2025-03-13 19:08:33,483 [INFO]: 	index_path: knn.index
2025-03-13 19:08:33,483 [INFO]: 	size in bytes: 1811816530
2025-03-13 19:08:33,483 [INFO]: 	avg_search_speed_ms: 11.917579404319302
2025-03-13 19:08:33,483 [INFO]: 	99p_search_speed_ms: 21.057090000249445
2025-03-13 19:08:33,483 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:33,483 [INFO]: 	nb vectors: 9209
2025-03-13 19:08:33,483 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:33,483 [INFO]: 	compression ratio: 0.9993081760877852
2025-03-13 19:08:33,483 [INFO]: }
2025-03-13 19:08:33,483 [INFO]: 	>>> Finished "Creating the index" in 117.8149 secs
2025-03-13 19:08:33,483 [INFO]: >>> Finished "Launching the whole pipeline" in 117.8476 secs
2025-03-13 19:08:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 61347 [episode count 15/20]
[retrieval_preprocessing] for episode 82007 [episode count 16/20], we have num_retrieval=np.int64(9248) num_query=np.int64(379)
2025-03-13 19:08:39,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:41,128 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:41
2025-03-13 19:08:41,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1044.92it/s]
2025-03-13 19:08:41,164 [INFO]: There are 9248 embeddings of dim 49152
2025-03-13 19:08:41,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-13 19:08:41,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:41
2025-03-13 19:08:41,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:41,165 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 19:08:41,165 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:08:41,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:41,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:41
2025-03-13 19:08:41,165 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:41,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:41,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:41
2025-03-13 19:08:41,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:41,165 [INFO]: 	Creating the index 03/13/2025, 19:08:41
2025-03-13 19:08:41,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:41
2025-03-13 19:08:41,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:08:41,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:41
2025-03-13 19:08:41,167 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:08:41,167 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:05,  6.93it/s] 11%|█         | 4/38 [00:00<00:01, 17.20it/s] 21%|██        | 8/38 [00:00<00:01, 26.21it/s] 32%|███▏      | 12/38 [00:00<00:00, 31.12it/s] 42%|████▏     | 16/38 [00:00<00:00, 33.66it/s] 53%|█████▎    | 20/38 [00:00<00:00, 35.19it/s] 63%|██████▎   | 24/38 [00:04<00:05,  2.65it/s] 71%|███████   | 27/38 [00:05<00:03,  3.35it/s] 79%|███████▉  | 30/38 [00:05<00:01,  4.21it/s] 84%|████████▍ | 32/38 [00:05<00:01,  4.91it/s] 89%|████████▉ | 34/38 [00:05<00:00,  5.72it/s] 95%|█████████▍| 36/38 [00:05<00:00,  6.64it/s]100%|██████████| 38/38 [00:09<00:00,  1.65it/s]100%|██████████| 38/38 [00:09<00:00,  3.95it/s]
2025-03-13 19:08:50,789 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:50
2025-03-13 19:09:55,952 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.1622 secs
2025-03-13 19:09:55,953 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 19:09:55,953 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.05it/s]
2025-03-13 19:10:34,803 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8504 secs
2025-03-13 19:10:34,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.6390 secs
2025-03-13 19:10:34,806 [INFO]: {
2025-03-13 19:10:34,806 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:34,806 [INFO]: 	index_param: efSearch=268
2025-03-13 19:10:34,806 [INFO]: 	index_path: knn.index
2025-03-13 19:10:34,806 [INFO]: 	size in bytes: 1819489510
2025-03-13 19:10:34,806 [INFO]: 	avg_search_speed_ms: 9.95000818934273
2025-03-13 19:10:34,806 [INFO]: 	99p_search_speed_ms: 19.358282620087266
2025-03-13 19:10:34,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:34,806 [INFO]: 	nb vectors: 9248
2025-03-13 19:10:34,806 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:34,806 [INFO]: 	compression ratio: 0.9993081982649078
2025-03-13 19:10:34,806 [INFO]: }
2025-03-13 19:10:34,806 [INFO]: 	>>> Finished "Creating the index" in 113.6406 secs
2025-03-13 19:10:34,806 [INFO]: >>> Finished "Launching the whole pipeline" in 113.6780 secs
2025-03-13 19:10:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 82007 [episode count 16/20]
[retrieval_preprocessing] for episode 51013 [episode count 17/20], we have num_retrieval=np.int64(9157) num_query=np.int64(470)
2025-03-13 19:10:40,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:10:42,238 [INFO]: Launching the whole pipeline 03/13/2025, 19:10:42
2025-03-13 19:10:42,238 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:10:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-13 19:10:42,268 [INFO]: There are 9157 embeddings of dim 49152
2025-03-13 19:10:42,269 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 19:10:42,269 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:10:42
2025-03-13 19:10:42,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:10:42,269 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:10:42,269 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:10:42,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:10:42,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:10:42
2025-03-13 19:10:42,269 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:10:42,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:10:42,269 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:10:42
2025-03-13 19:10:42,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:10:42,269 [INFO]: 	Creating the index 03/13/2025, 19:10:42
2025-03-13 19:10:42,269 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:10:42
2025-03-13 19:10:42,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 19:10:42,271 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:10:42
2025-03-13 19:10:42,271 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:10:42,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:07,  4.87it/s]  8%|▊         | 3/38 [00:00<00:04,  8.27it/s] 13%|█▎        | 5/38 [00:00<00:03,  9.52it/s] 18%|█▊        | 7/38 [00:00<00:02, 10.61it/s] 24%|██▎       | 9/38 [00:00<00:02, 11.02it/s] 29%|██▉       | 11/38 [00:01<00:02, 11.16it/s] 34%|███▍      | 13/38 [00:01<00:02, 10.98it/s] 39%|███▉      | 15/38 [00:01<00:02, 11.04it/s] 45%|████▍     | 17/38 [00:01<00:01, 11.74it/s] 50%|█████     | 19/38 [00:01<00:01, 11.48it/s] 55%|█████▌    | 21/38 [00:05<00:11,  1.42it/s] 61%|██████    | 23/38 [00:06<00:07,  1.95it/s] 66%|██████▌   | 25/38 [00:06<00:04,  2.69it/s] 71%|███████   | 27/38 [00:06<00:03,  3.55it/s] 76%|███████▋  | 29/38 [00:06<00:01,  4.60it/s] 82%|████████▏ | 31/38 [00:06<00:01,  5.81it/s] 89%|████████▉ | 34/38 [00:06<00:00,  7.95it/s] 95%|█████████▍| 36/38 [00:06<00:00,  9.11it/s]100%|██████████| 38/38 [00:10<00:00,  1.88it/s]100%|██████████| 38/38 [00:10<00:00,  3.74it/s]
2025-03-13 19:10:52,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:10:52
2025-03-13 19:11:56,191 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.7514 secs
2025-03-13 19:11:56,192 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 19:11:56,192 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.83it/s]
2025-03-13 19:12:28,368 [INFO]: 	>>> Finished "Compute fast metrics" in 32.1758 secs
2025-03-13 19:12:28,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.0993 secs
2025-03-13 19:12:28,371 [INFO]: {
2025-03-13 19:12:28,371 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:28,371 [INFO]: 	index_param: efSearch=247
2025-03-13 19:12:28,371 [INFO]: 	index_path: knn.index
2025-03-13 19:12:28,371 [INFO]: 	size in bytes: 1801585690
2025-03-13 19:12:28,371 [INFO]: 	avg_search_speed_ms: 9.269045666723311
2025-03-13 19:12:28,371 [INFO]: 	99p_search_speed_ms: 14.66510811354965
2025-03-13 19:12:28,371 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:28,371 [INFO]: 	nb vectors: 9157
2025-03-13 19:12:28,371 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:28,371 [INFO]: 	compression ratio: 0.9993082571609458
2025-03-13 19:12:28,371 [INFO]: }
2025-03-13 19:12:28,371 [INFO]: 	>>> Finished "Creating the index" in 106.1015 secs
2025-03-13 19:12:28,371 [INFO]: >>> Finished "Launching the whole pipeline" in 106.1330 secs
2025-03-13 19:12:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 51013 [episode count 17/20]
[retrieval_preprocessing] for episode 13205 [episode count 18/20], we have num_retrieval=np.int64(9198) num_query=np.int64(429)
2025-03-13 19:12:34,206 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:35,520 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:35
2025-03-13 19:12:35,521 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-13 19:12:35,552 [INFO]: There are 9198 embeddings of dim 49152
2025-03-13 19:12:35,552 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-13 19:12:35,552 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:35
2025-03-13 19:12:35,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:35,552 [INFO]: 		-> Add: 5.1 seconds
2025-03-13 19:12:35,552 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:12:35,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:12:35,552 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:35
2025-03-13 19:12:35,552 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:35,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:12:35,553 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:35
2025-03-13 19:12:35,553 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:35,553 [INFO]: 	Creating the index 03/13/2025, 19:12:35
2025-03-13 19:12:35,553 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:35
2025-03-13 19:12:35,553 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 19:12:35,554 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:35
2025-03-13 19:12:35,554 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:12:35,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  7.52it/s] 13%|█▎        | 5/38 [00:00<00:01, 22.63it/s] 26%|██▋       | 10/38 [00:00<00:00, 32.52it/s] 42%|████▏     | 16/38 [00:00<00:00, 39.94it/s] 55%|█████▌    | 21/38 [00:03<00:04,  4.01it/s] 68%|██████▊   | 26/38 [00:03<00:02,  5.91it/s] 84%|████████▍ | 32/38 [00:03<00:00,  8.89it/s]100%|██████████| 38/38 [00:06<00:00,  3.91it/s]100%|██████████| 38/38 [00:06<00:00,  5.48it/s]
2025-03-13 19:12:42,485 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:42
2025-03-13 19:13:41,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.4263 secs
2025-03-13 19:13:41,912 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 19:13:41,913 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 19:14:17,569 [INFO]: 	>>> Finished "Compute fast metrics" in 35.6559 secs
2025-03-13 19:14:17,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 102.3529 secs
2025-03-13 19:14:17,908 [INFO]: {
2025-03-13 19:14:17,908 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:17,908 [INFO]: 	index_param: efSearch=197
2025-03-13 19:14:17,908 [INFO]: 	index_path: knn.index
2025-03-13 19:14:17,908 [INFO]: 	size in bytes: 1809652210
2025-03-13 19:14:17,908 [INFO]: 	avg_search_speed_ms: 8.058131690640648
2025-03-13 19:14:17,908 [INFO]: 	99p_search_speed_ms: 12.692536180838932
2025-03-13 19:14:17,908 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:17,908 [INFO]: 	nb vectors: 9198
2025-03-13 19:14:17,908 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:17,908 [INFO]: 	compression ratio: 0.9993082505063224
2025-03-13 19:14:17,908 [INFO]: }
2025-03-13 19:14:17,908 [INFO]: 	>>> Finished "Creating the index" in 102.3558 secs
2025-03-13 19:14:17,908 [INFO]: >>> Finished "Launching the whole pipeline" in 102.3879 secs
2025-03-13 19:14:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 13205 [episode count 18/20]
[retrieval_preprocessing] for episode 34254 [episode count 19/20], we have num_retrieval=np.int64(9193) num_query=np.int64(434)
2025-03-13 19:14:22,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:24,239 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:24
2025-03-13 19:14:24,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.58it/s]
2025-03-13 19:14:24,271 [INFO]: There are 9193 embeddings of dim 49152
2025-03-13 19:14:24,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 19:14:24,272 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:24
2025-03-13 19:14:24,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:24,272 [INFO]: 		-> Add: 5.0 seconds
2025-03-13 19:14:24,272 [INFO]: 		Total: 16.8 minutes
2025-03-13 19:14:24,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:14:24,272 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:24
2025-03-13 19:14:24,272 [INFO]: 1.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:24,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:14:24,272 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:24
2025-03-13 19:14:24,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:14:24,272 [INFO]: 	Creating the index 03/13/2025, 19:14:24
2025-03-13 19:14:24,272 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:24
2025-03-13 19:14:24,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:14:24,273 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:24
2025-03-13 19:14:24,273 [INFO]: The memory available for adding the vectors is 48.3GB(total available - used by the index)
2025-03-13 19:14:24,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:00<00:04,  7.63it/s] 16%|█▌        | 6/38 [00:00<00:01, 27.53it/s] 29%|██▉       | 11/38 [00:00<00:00, 36.06it/s] 42%|████▏     | 16/38 [00:00<00:00, 40.49it/s] 55%|█████▌    | 21/38 [00:04<00:05,  3.37it/s] 68%|██████▊   | 26/38 [00:04<00:02,  5.03it/s] 84%|████████▍ | 32/38 [00:04<00:00,  7.65it/s]100%|██████████| 38/38 [00:07<00:00,  3.46it/s]100%|██████████| 38/38 [00:07<00:00,  4.87it/s]
2025-03-13 19:14:32,079 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:32
2025-03-13 19:15:35,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.6145 secs
2025-03-13 19:15:35,694 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 19:15:35,694 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-13 19:15:58,875 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1806 secs
2025-03-13 19:15:58,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.6042 secs
2025-03-13 19:15:58,878 [INFO]: {
2025-03-13 19:15:58,878 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:58,878 [INFO]: 	index_param: efSearch=178
2025-03-13 19:15:58,878 [INFO]: 	index_path: knn.index
2025-03-13 19:15:58,878 [INFO]: 	size in bytes: 1808668450
2025-03-13 19:15:58,878 [INFO]: 	avg_search_speed_ms: 7.837031419983069
2025-03-13 19:15:58,878 [INFO]: 	99p_search_speed_ms: 13.764023431576788
2025-03-13 19:15:58,878 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:58,878 [INFO]: 	nb vectors: 9193
2025-03-13 19:15:58,878 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:58,878 [INFO]: 	compression ratio: 0.9993082723370333
2025-03-13 19:15:58,878 [INFO]: }
2025-03-13 19:15:58,878 [INFO]: 	>>> Finished "Creating the index" in 94.6059 secs
2025-03-13 19:15:58,878 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6386 secs
2025-03-13 19:16:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 34254 [episode count 19/20]
2025-03-13 19:16:01: [retrieval_preprocessing] finished for 2927338332_stir_with_spatula [chosen_id count 9/196]
2025-03-13 19:16:01: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
