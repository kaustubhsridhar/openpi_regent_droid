nohup: ignoring input
2025-03-13 10:50:03: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:50:40: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_rubiks_cube_on_shelf [chosen_id count 0/260]
2025-03-13 10:50:40: [retrieval_preprocessing] we have num_total=2304 embedding_dim=49152
[retrieval_preprocessing] for episode 5634 [episode count 0/20], we have num_retrieval=np.int64(2159) num_query=np.int64(145)
2025-03-13 10:50:54,519 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:54,793 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:54
2025-03-13 10:50:54,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 477.06it/s]
2025-03-13 10:50:54,824 [INFO]: There are 2159 embeddings of dim 49152
2025-03-13 10:50:54,824 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 10:50:54,824 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:54
2025-03-13 10:50:54,824 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:54,824 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:50:54,824 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:54,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:50:54,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:54
2025-03-13 10:50:54,825 [INFO]: 445.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:54,825 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 10:50:54,825 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:54
2025-03-13 10:50:54,825 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:54,825 [INFO]: 	Creating the index 03/13/2025, 10:50:54
2025-03-13 10:50:54,825 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:54
2025-03-13 10:50:54,827 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 10:50:54,827 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:54
2025-03-13 10:50:54,827 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:50:54,827 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:05,  1.38it/s] 22%|██▏       | 2/9 [00:01<00:06,  1.07it/s] 33%|███▎      | 3/9 [00:06<00:16,  2.67s/it] 44%|████▍     | 4/9 [00:07<00:10,  2.04s/it] 56%|█████▌    | 5/9 [00:07<00:05,  1.35s/it] 67%|██████▋   | 6/9 [00:09<00:04,  1.39s/it] 78%|███████▊  | 7/9 [00:09<00:02,  1.16s/it]100%|██████████| 9/9 [00:11<00:00,  1.00it/s]100%|██████████| 9/9 [00:11<00:00,  1.28s/it]
2025-03-13 10:51:06,386 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:06
2025-03-13 10:51:38,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6854 secs
2025-03-13 10:51:38,073 [INFO]: The best hyperparameters are: efSearch=205
2025-03-13 10:51:38,073 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-13 10:51:50,184 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1117 secs
2025-03-13 10:51:50,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3593 secs
2025-03-13 10:51:50,187 [INFO]: {
2025-03-13 10:51:50,187 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:50,187 [INFO]: 	index_param: efSearch=205
2025-03-13 10:51:50,187 [INFO]: 	index_path: knn.index
2025-03-13 10:51:50,187 [INFO]: 	size in bytes: 424770130
2025-03-13 10:51:50,187 [INFO]: 	avg_search_speed_ms: 11.354790895421253
2025-03-13 10:51:50,187 [INFO]: 	99p_search_speed_ms: 17.033566939644505
2025-03-13 10:51:50,187 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:50,187 [INFO]: 	nb vectors: 2159
2025-03-13 10:51:50,187 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:50,187 [INFO]: 	compression ratio: 0.9993091369207152
2025-03-13 10:51:50,187 [INFO]: }
2025-03-13 10:51:50,187 [INFO]: 	>>> Finished "Creating the index" in 55.3615 secs
2025-03-13 10:51:50,187 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3941 secs
2025-03-13 10:51:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 5634 [episode count 0/20]
[retrieval_preprocessing] for episode 4642 [episode count 1/20], we have num_retrieval=np.int64(2183) num_query=np.int64(121)
2025-03-13 10:51:52,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:52,488 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:52
2025-03-13 10:51:52,489 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1105.80it/s]
2025-03-13 10:51:52,526 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 10:51:52,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-13 10:51:52,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:52,526 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:51:52,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:52,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:51:52,527 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,527 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:52,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:51:52,527 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:52
2025-03-13 10:51:52,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:52,527 [INFO]: 	Creating the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,527 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:52
2025-03-13 10:51:52,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:51:52,528 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:52
2025-03-13 10:51:52,529 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:51:52,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.77it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.92it/s] 67%|██████▋   | 6/9 [00:00<00:00, 20.65it/s]100%|██████████| 9/9 [00:02<00:00,  2.34it/s]100%|██████████| 9/9 [00:02<00:00,  3.09it/s]
2025-03-13 10:51:55,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:55
2025-03-13 10:52:31,208 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7614 secs
2025-03-13 10:52:31,209 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 10:52:31,209 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s]
2025-03-13 10:52:50,413 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2041 secs
2025-03-13 10:52:50,415 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8865 secs
2025-03-13 10:52:50,415 [INFO]: {
2025-03-13 10:52:50,415 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:50,415 [INFO]: 	index_param: efSearch=249
2025-03-13 10:52:50,415 [INFO]: 	index_path: knn.index
2025-03-13 10:52:50,415 [INFO]: 	size in bytes: 429492010
2025-03-13 10:52:50,415 [INFO]: 	avg_search_speed_ms: 10.803541377011776
2025-03-13 10:52:50,415 [INFO]: 	99p_search_speed_ms: 21.220252965576947
2025-03-13 10:52:50,415 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:50,415 [INFO]: 	nb vectors: 2183
2025-03-13 10:52:50,415 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:50,415 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 10:52:50,415 [INFO]: }
2025-03-13 10:52:50,415 [INFO]: 	>>> Finished "Creating the index" in 57.8883 secs
2025-03-13 10:52:50,415 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9268 secs
2025-03-13 10:52:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 4642 [episode count 1/20]
[retrieval_preprocessing] for episode 67628 [episode count 2/20], we have num_retrieval=np.int64(2215) num_query=np.int64(89)
2025-03-13 10:53:00,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:01,084 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:01
2025-03-13 10:53:01,085 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-13 10:53:01,112 [INFO]: There are 2215 embeddings of dim 49152
2025-03-13 10:53:01,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 10:53:01,113 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:01
2025-03-13 10:53:01,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:01,113 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:53:01,113 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:01,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:01,113 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:01
2025-03-13 10:53:01,113 [INFO]: 457.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:01,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:53:01,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:01
2025-03-13 10:53:01,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:01,113 [INFO]: 	Creating the index 03/13/2025, 10:53:01
2025-03-13 10:53:01,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:01
2025-03-13 10:53:01,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:53:01,115 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:01
2025-03-13 10:53:01,115 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:01,115 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.94it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.96it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.98it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.39it/s]100%|██████████| 9/9 [00:02<00:00,  2.37it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-13 10:53:03,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:03
2025-03-13 10:53:34,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8429 secs
2025-03-13 10:53:34,651 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 10:53:34,651 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 10:53:47,515 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8640 secs
2025-03-13 10:53:47,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4024 secs
2025-03-13 10:53:47,517 [INFO]: {
2025-03-13 10:53:47,517 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:47,517 [INFO]: 	index_param: efSearch=279
2025-03-13 10:53:47,517 [INFO]: 	index_path: knn.index
2025-03-13 10:53:47,517 [INFO]: 	size in bytes: 435787810
2025-03-13 10:53:47,517 [INFO]: 	avg_search_speed_ms: 10.288595640888138
2025-03-13 10:53:47,517 [INFO]: 	99p_search_speed_ms: 14.608085972722618
2025-03-13 10:53:47,517 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:47,517 [INFO]: 	nb vectors: 2215
2025-03-13 10:53:47,517 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:47,517 [INFO]: 	compression ratio: 0.9993090903575297
2025-03-13 10:53:47,517 [INFO]: }
2025-03-13 10:53:47,517 [INFO]: 	>>> Finished "Creating the index" in 46.4041 secs
2025-03-13 10:53:47,517 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4329 secs
2025-03-13 10:53:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 67628 [episode count 2/20]
[retrieval_preprocessing] for episode 68148 [episode count 3/20], we have num_retrieval=np.int64(2187) num_query=np.int64(117)
2025-03-13 10:53:49,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:49,554 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:49
2025-03-13 10:53:49,554 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2185.67it/s]
2025-03-13 10:53:49,576 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 10:53:49,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-13 10:53:49,576 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:49
2025-03-13 10:53:49,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:49,576 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:53:49,577 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:49,577 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:49,577 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:49
2025-03-13 10:53:49,577 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:49,577 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:49,577 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:49
2025-03-13 10:53:49,577 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:49,577 [INFO]: 	Creating the index 03/13/2025, 10:53:49
2025-03-13 10:53:49,577 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:49
2025-03-13 10:53:49,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:53:49,578 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:49
2025-03-13 10:53:49,578 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:53:49,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.09it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.24it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.06it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.45it/s]100%|██████████| 9/9 [00:02<00:00,  2.44it/s]100%|██████████| 9/9 [00:02<00:00,  3.51it/s]
2025-03-13 10:53:52,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:52
2025-03-13 10:54:18,516 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3669 secs
2025-03-13 10:54:18,517 [INFO]: The best hyperparameters are: efSearch=315
2025-03-13 10:54:18,517 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 10:54:31,553 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0365 secs
2025-03-13 10:54:31,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9780 secs
2025-03-13 10:54:31,556 [INFO]: {
2025-03-13 10:54:31,556 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:31,556 [INFO]: 	index_param: efSearch=315
2025-03-13 10:54:31,556 [INFO]: 	index_path: knn.index
2025-03-13 10:54:31,556 [INFO]: 	size in bytes: 430279030
2025-03-13 10:54:31,556 [INFO]: 	avg_search_speed_ms: 11.522462813361775
2025-03-13 10:54:31,556 [INFO]: 	99p_search_speed_ms: 19.338588952086866
2025-03-13 10:54:31,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:31,556 [INFO]: 	nb vectors: 2187
2025-03-13 10:54:31,556 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:31,556 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 10:54:31,556 [INFO]: }
2025-03-13 10:54:31,556 [INFO]: 	>>> Finished "Creating the index" in 41.9795 secs
2025-03-13 10:54:31,556 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0026 secs
2025-03-13 10:54:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 68148 [episode count 3/20]
[retrieval_preprocessing] for episode 53827 [episode count 4/20], we have num_retrieval=np.int64(2179) num_query=np.int64(125)
2025-03-13 10:54:33,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:34,161 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:34
2025-03-13 10:54:34,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.72it/s]
2025-03-13 10:54:34,184 [INFO]: There are 2179 embeddings of dim 49152
2025-03-13 10:54:34,184 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-13 10:54:34,185 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:34
2025-03-13 10:54:34,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:34,185 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:54:34,185 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:34,185 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:54:34,185 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:34
2025-03-13 10:54:34,185 [INFO]: 449.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:34,185 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:54:34,185 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:34
2025-03-13 10:54:34,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:34,185 [INFO]: 	Creating the index 03/13/2025, 10:54:34
2025-03-13 10:54:34,185 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:34
2025-03-13 10:54:34,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:54:34,186 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:34
2025-03-13 10:54:34,186 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:54:34,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.15it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.13it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.10it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.38it/s]100%|██████████| 9/9 [00:02<00:00,  2.95it/s]100%|██████████| 9/9 [00:02<00:00,  4.11it/s]
2025-03-13 10:54:36,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:36
2025-03-13 10:55:01,968 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5876 secs
2025-03-13 10:55:01,969 [INFO]: The best hyperparameters are: efSearch=335
2025-03-13 10:55:01,969 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s]
2025-03-13 10:55:16,099 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1306 secs
2025-03-13 10:55:16,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9156 secs
2025-03-13 10:55:16,102 [INFO]: {
2025-03-13 10:55:16,102 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:16,102 [INFO]: 	index_param: efSearch=335
2025-03-13 10:55:16,102 [INFO]: 	index_path: knn.index
2025-03-13 10:55:16,102 [INFO]: 	size in bytes: 428705050
2025-03-13 10:55:16,102 [INFO]: 	avg_search_speed_ms: 12.765530455258808
2025-03-13 10:55:16,102 [INFO]: 	99p_search_speed_ms: 21.90280687762423
2025-03-13 10:55:16,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:16,102 [INFO]: 	nb vectors: 2179
2025-03-13 10:55:16,102 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:16,102 [INFO]: 	compression ratio: 0.9993090400964486
2025-03-13 10:55:16,102 [INFO]: }
2025-03-13 10:55:16,102 [INFO]: 	>>> Finished "Creating the index" in 41.9174 secs
2025-03-13 10:55:16,102 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9413 secs
2025-03-13 10:55:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 53827 [episode count 4/20]
[retrieval_preprocessing] for episode 7793 [episode count 5/20], we have num_retrieval=np.int64(2191) num_query=np.int64(113)
2025-03-13 10:55:18,905 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:19,338 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:19
2025-03-13 10:55:19,338 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1130.54it/s]
2025-03-13 10:55:19,365 [INFO]: There are 2191 embeddings of dim 49152
2025-03-13 10:55:19,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 10:55:19,365 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:19
2025-03-13 10:55:19,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:19,365 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:55:19,365 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:19,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:55:19,365 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:19
2025-03-13 10:55:19,365 [INFO]: 452.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:19,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:55:19,365 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:19
2025-03-13 10:55:19,366 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:19,366 [INFO]: 	Creating the index 03/13/2025, 10:55:19
2025-03-13 10:55:19,366 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:19
2025-03-13 10:55:19,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 10:55:19,368 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:19
2025-03-13 10:55:19,368 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:55:19,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.77it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.45it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.11it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.27it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.25it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.21it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.18it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.18it/s]100%|██████████| 9/9 [00:03<00:00,  1.37it/s]100%|██████████| 9/9 [00:03<00:00,  2.93it/s]
2025-03-13 10:55:22,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:22
2025-03-13 10:55:59,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0085 secs
2025-03-13 10:55:59,457 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 10:55:59,458 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s]
2025-03-13 10:56:11,819 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3615 secs
2025-03-13 10:56:11,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4533 secs
2025-03-13 10:56:11,821 [INFO]: {
2025-03-13 10:56:11,821 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:11,821 [INFO]: 	index_param: efSearch=198
2025-03-13 10:56:11,821 [INFO]: 	index_path: knn.index
2025-03-13 10:56:11,821 [INFO]: 	size in bytes: 431066050
2025-03-13 10:56:11,821 [INFO]: 	avg_search_speed_ms: 10.558015747705106
2025-03-13 10:56:11,821 [INFO]: 	99p_search_speed_ms: 14.782483368180689
2025-03-13 10:56:11,821 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:11,821 [INFO]: 	nb vectors: 2191
2025-03-13 10:56:11,821 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:11,821 [INFO]: 	compression ratio: 0.9993088715754813
2025-03-13 10:56:11,821 [INFO]: }
2025-03-13 10:56:11,821 [INFO]: 	>>> Finished "Creating the index" in 52.4551 secs
2025-03-13 10:56:11,821 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4835 secs
2025-03-13 10:56:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 7793 [episode count 5/20]
[retrieval_preprocessing] for episode 51314 [episode count 6/20], we have num_retrieval=np.int64(2198) num_query=np.int64(106)
2025-03-13 10:56:13,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:13,833 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:13
2025-03-13 10:56:13,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.19it/s]
2025-03-13 10:56:13,856 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 10:56:13,856 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 10:56:13,856 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:13
2025-03-13 10:56:13,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:13,856 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:56:13,856 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:13,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:56:13,856 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:13
2025-03-13 10:56:13,857 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:13,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:56:13,857 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:13
2025-03-13 10:56:13,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:13,857 [INFO]: 	Creating the index 03/13/2025, 10:56:13
2025-03-13 10:56:13,857 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:13
2025-03-13 10:56:13,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:56:13,858 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:13
2025-03-13 10:56:13,858 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:56:13,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.23it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.79it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.57it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.92it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.22it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.27it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.31it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.39it/s]100%|██████████| 9/9 [00:02<00:00,  1.49it/s]100%|██████████| 9/9 [00:02<00:00,  3.11it/s]
2025-03-13 10:56:16,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:16
2025-03-13 10:56:45,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7194 secs
2025-03-13 10:56:45,483 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 10:56:45,483 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s]
2025-03-13 10:56:57,793 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3096 secs
2025-03-13 10:56:57,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9364 secs
2025-03-13 10:56:57,794 [INFO]: {
2025-03-13 10:56:57,794 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:57,794 [INFO]: 	index_param: efSearch=297
2025-03-13 10:56:57,795 [INFO]: 	index_path: knn.index
2025-03-13 10:56:57,795 [INFO]: 	size in bytes: 432443230
2025-03-13 10:56:57,795 [INFO]: 	avg_search_speed_ms: 11.260572264782732
2025-03-13 10:56:57,795 [INFO]: 	99p_search_speed_ms: 18.2685347343795
2025-03-13 10:56:57,795 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:57,795 [INFO]: 	nb vectors: 2198
2025-03-13 10:56:57,795 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:57,795 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 10:56:57,795 [INFO]: }
2025-03-13 10:56:57,795 [INFO]: 	>>> Finished "Creating the index" in 43.9379 secs
2025-03-13 10:56:57,795 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9620 secs
2025-03-13 10:56:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 51314 [episode count 6/20]
[retrieval_preprocessing] for episode 90261 [episode count 7/20], we have num_retrieval=np.int64(2136) num_query=np.int64(168)
2025-03-13 10:57:00,048 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:00,426 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:00
2025-03-13 10:57:00,426 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1965.47it/s]
2025-03-13 10:57:00,451 [INFO]: There are 2136 embeddings of dim 49152
2025-03-13 10:57:00,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 10:57:00,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:00
2025-03-13 10:57:00,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:00,452 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:57:00,452 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:00,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:00,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:00
2025-03-13 10:57:00,452 [INFO]: 440.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:00,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:57:00,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:00
2025-03-13 10:57:00,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:00,452 [INFO]: 	Creating the index 03/13/2025, 10:57:00
2025-03-13 10:57:00,452 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:00
2025-03-13 10:57:00,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 10:57:00,453 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:00
2025-03-13 10:57:00,453 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:00,453 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.41it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.99it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.01it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.08it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.03it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.98it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.99it/s]100%|██████████| 9/9 [00:02<00:00,  1.97it/s]100%|██████████| 9/9 [00:02<00:00,  3.77it/s]
2025-03-13 10:57:02,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:02
2025-03-13 10:57:30,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8393 secs
2025-03-13 10:57:30,684 [INFO]: The best hyperparameters are: efSearch=290
2025-03-13 10:57:30,684 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s]
2025-03-13 10:57:43,082 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3981 secs
2025-03-13 10:57:43,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6308 secs
2025-03-13 10:57:43,084 [INFO]: {
2025-03-13 10:57:43,084 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:43,084 [INFO]: 	index_param: efSearch=290
2025-03-13 10:57:43,084 [INFO]: 	index_path: knn.index
2025-03-13 10:57:43,084 [INFO]: 	size in bytes: 420244990
2025-03-13 10:57:43,084 [INFO]: 	avg_search_speed_ms: 10.27417562223343
2025-03-13 10:57:43,084 [INFO]: 	99p_search_speed_ms: 13.95242949016392
2025-03-13 10:57:43,084 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:43,084 [INFO]: 	nb vectors: 2136
2025-03-13 10:57:43,084 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:43,084 [INFO]: 	compression ratio: 0.9993092077076279
2025-03-13 10:57:43,084 [INFO]: }
2025-03-13 10:57:43,084 [INFO]: 	>>> Finished "Creating the index" in 42.6324 secs
2025-03-13 10:57:43,084 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6587 secs
2025-03-13 10:57:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 90261 [episode count 7/20]
[retrieval_preprocessing] for episode 94369 [episode count 8/20], we have num_retrieval=np.int64(2208) num_query=np.int64(96)
2025-03-13 10:57:45,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:45,633 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:45
2025-03-13 10:57:45,633 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1559.80it/s]
2025-03-13 10:57:45,655 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 10:57:45,655 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 10:57:45,655 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,655 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:45,655 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:57:45,655 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:45,655 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:57:45,655 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,656 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:45,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:57:45,656 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:45
2025-03-13 10:57:45,656 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:45,656 [INFO]: 	Creating the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,656 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:45
2025-03-13 10:57:45,657 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:57:45,657 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:45
2025-03-13 10:57:45,657 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:57:45,657 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.42it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.76it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.82it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.32it/s]100%|██████████| 9/9 [00:02<00:00,  2.87it/s]100%|██████████| 9/9 [00:02<00:00,  4.07it/s]
2025-03-13 10:57:47,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:47
2025-03-13 10:58:13,682 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8056 secs
2025-03-13 10:58:13,682 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 10:58:13,682 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 10:58:26,037 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3539 secs
2025-03-13 10:58:26,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.3815 secs
2025-03-13 10:58:26,038 [INFO]: {
2025-03-13 10:58:26,038 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:26,038 [INFO]: 	index_param: efSearch=259
2025-03-13 10:58:26,038 [INFO]: 	index_path: knn.index
2025-03-13 10:58:26,038 [INFO]: 	size in bytes: 434410630
2025-03-13 10:58:26,039 [INFO]: 	avg_search_speed_ms: 10.749009412823506
2025-03-13 10:58:26,039 [INFO]: 	99p_search_speed_ms: 15.216745834331967
2025-03-13 10:58:26,039 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:26,039 [INFO]: 	nb vectors: 2208
2025-03-13 10:58:26,039 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:26,039 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 10:58:26,039 [INFO]: }
2025-03-13 10:58:26,039 [INFO]: 	>>> Finished "Creating the index" in 40.3829 secs
2025-03-13 10:58:26,039 [INFO]: >>> Finished "Launching the whole pipeline" in 40.4056 secs
2025-03-13 10:58:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 94369 [episode count 8/20]
[retrieval_preprocessing] for episode 41645 [episode count 9/20], we have num_retrieval=np.int64(2204) num_query=np.int64(100)
2025-03-13 10:58:27,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:28,470 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:28
2025-03-13 10:58:28,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.43it/s]
2025-03-13 10:58:28,494 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 10:58:28,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 10:58:28,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:28
2025-03-13 10:58:28,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:28,494 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:58:28,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:28,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:28,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:28
2025-03-13 10:58:28,494 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:28,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:58:28,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:28
2025-03-13 10:58:28,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:28,494 [INFO]: 	Creating the index 03/13/2025, 10:58:28
2025-03-13 10:58:28,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:28
2025-03-13 10:58:28,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 10:58:28,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:28
2025-03-13 10:58:28,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:58:28,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.39it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.13it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.79it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.17it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.37it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.50it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.58it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.76it/s]100%|██████████| 9/9 [00:02<00:00,  1.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.56it/s]
2025-03-13 10:58:31,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:31
2025-03-13 10:58:56,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9029 secs
2025-03-13 10:58:56,932 [INFO]: The best hyperparameters are: efSearch=343
2025-03-13 10:58:56,932 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-13 10:59:09,796 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8641 secs
2025-03-13 10:59:09,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3024 secs
2025-03-13 10:59:09,798 [INFO]: {
2025-03-13 10:59:09,798 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:09,798 [INFO]: 	index_param: efSearch=343
2025-03-13 10:59:09,798 [INFO]: 	index_path: knn.index
2025-03-13 10:59:09,798 [INFO]: 	size in bytes: 433623670
2025-03-13 10:59:09,798 [INFO]: 	avg_search_speed_ms: 12.100966509314482
2025-03-13 10:59:09,798 [INFO]: 	99p_search_speed_ms: 17.574895950965583
2025-03-13 10:59:09,798 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:09,798 [INFO]: 	nb vectors: 2204
2025-03-13 10:59:09,798 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:09,798 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 10:59:09,798 [INFO]: }
2025-03-13 10:59:09,798 [INFO]: 	>>> Finished "Creating the index" in 41.3039 secs
2025-03-13 10:59:09,798 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3286 secs
2025-03-13 10:59:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 41645 [episode count 9/20]
[retrieval_preprocessing] for episode 30002 [episode count 10/20], we have num_retrieval=np.int64(2212) num_query=np.int64(92)
2025-03-13 10:59:12,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:12,464 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:12
2025-03-13 10:59:12,464 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-13 10:59:12,490 [INFO]: There are 2212 embeddings of dim 49152
2025-03-13 10:59:12,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 10:59:12,491 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:12
2025-03-13 10:59:12,491 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:12,491 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:59:12,491 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:12,491 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 10:59:12,491 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:12
2025-03-13 10:59:12,492 [INFO]: 456.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:12,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:59:12,492 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:12
2025-03-13 10:59:12,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:12,492 [INFO]: 	Creating the index 03/13/2025, 10:59:12
2025-03-13 10:59:12,492 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:12
2025-03-13 10:59:12,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 10:59:12,496 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:12
2025-03-13 10:59:12,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:59:12,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.17it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.40it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.86it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.94it/s]100%|██████████| 9/9 [00:02<00:00,  2.58it/s]100%|██████████| 9/9 [00:02<00:00,  3.75it/s]
2025-03-13 10:59:14,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:14
2025-03-13 10:59:45,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1630 secs
2025-03-13 10:59:45,068 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 10:59:45,068 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-13 10:59:57,493 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4247 secs
2025-03-13 10:59:57,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9992 secs
2025-03-13 10:59:57,495 [INFO]: {
2025-03-13 10:59:57,495 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:57,495 [INFO]: 	index_param: efSearch=283
2025-03-13 10:59:57,495 [INFO]: 	index_path: knn.index
2025-03-13 10:59:57,495 [INFO]: 	size in bytes: 435197590
2025-03-13 10:59:57,495 [INFO]: 	avg_search_speed_ms: 10.857168262739474
2025-03-13 10:59:57,495 [INFO]: 	99p_search_speed_ms: 16.012586141005155
2025-03-13 10:59:57,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:57,495 [INFO]: 	nb vectors: 2212
2025-03-13 10:59:57,495 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:57,495 [INFO]: 	compression ratio: 0.9993090632693991
2025-03-13 10:59:57,495 [INFO]: }
2025-03-13 10:59:57,495 [INFO]: 	>>> Finished "Creating the index" in 45.0030 secs
2025-03-13 10:59:57,495 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0315 secs
2025-03-13 10:59:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 30002 [episode count 10/20]
[retrieval_preprocessing] for episode 32564 [episode count 11/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 10:59:59,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:59,672 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:59
2025-03-13 10:59:59,673 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.31it/s]
2025-03-13 10:59:59,697 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 10:59:59,697 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 10:59:59,697 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:59
2025-03-13 10:59:59,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:59,697 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 10:59:59,697 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:59,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:59,697 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:59
2025-03-13 10:59:59,697 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:59,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:59:59,697 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:59
2025-03-13 10:59:59,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:59,697 [INFO]: 	Creating the index 03/13/2025, 10:59:59
2025-03-13 10:59:59,697 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:59
2025-03-13 10:59:59,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:59:59,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:59
2025-03-13 10:59:59,698 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 10:59:59,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.81it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.37it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.41it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.66it/s]100%|██████████| 9/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.80it/s]
2025-03-13 11:00:02,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:02
2025-03-13 11:00:30,006 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9342 secs
2025-03-13 11:00:30,006 [INFO]: The best hyperparameters are: efSearch=279
2025-03-13 11:00:30,006 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 11:00:42,300 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2944 secs
2025-03-13 11:00:42,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6041 secs
2025-03-13 11:00:42,302 [INFO]: {
2025-03-13 11:00:42,302 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:42,302 [INFO]: 	index_param: efSearch=279
2025-03-13 11:00:42,302 [INFO]: 	index_path: knn.index
2025-03-13 11:00:42,302 [INFO]: 	size in bytes: 432246490
2025-03-13 11:00:42,303 [INFO]: 	avg_search_speed_ms: 10.549331767895191
2025-03-13 11:00:42,303 [INFO]: 	99p_search_speed_ms: 14.836185032036152
2025-03-13 11:00:42,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:42,303 [INFO]: 	nb vectors: 2197
2025-03-13 11:00:42,303 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:42,303 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 11:00:42,303 [INFO]: }
2025-03-13 11:00:42,303 [INFO]: 	>>> Finished "Creating the index" in 42.6054 secs
2025-03-13 11:00:42,303 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6300 secs
2025-03-13 11:00:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 32564 [episode count 11/20]
[retrieval_preprocessing] for episode 89823 [episode count 12/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 11:00:44,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:44,300 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:44
2025-03-13 11:00:44,300 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1850.16it/s]
2025-03-13 11:00:44,325 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 11:00:44,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 11:00:44,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:44
2025-03-13 11:00:44,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:44,326 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:00:44,326 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:44,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:00:44,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:44
2025-03-13 11:00:44,327 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:44,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:00:44,327 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:44
2025-03-13 11:00:44,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:44,327 [INFO]: 	Creating the index 03/13/2025, 11:00:44
2025-03-13 11:00:44,328 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:44
2025-03-13 11:00:44,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:00:44,331 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:44
2025-03-13 11:00:44,331 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:00:44,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.67it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.55it/s] 33%|███▎      | 3/9 [00:00<00:01,  5.86it/s] 44%|████▍     | 4/9 [00:00<00:00,  6.67it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.35it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.91it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.25it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.44it/s]100%|██████████| 9/9 [00:02<00:00,  1.81it/s]100%|██████████| 9/9 [00:02<00:00,  3.50it/s]
2025-03-13 11:00:46,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:46
2025-03-13 11:01:11,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5174 secs
2025-03-13 11:01:11,425 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 11:01:11,425 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-13 11:01:23,674 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2487 secs
2025-03-13 11:01:23,676 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.3445 secs
2025-03-13 11:01:23,676 [INFO]: {
2025-03-13 11:01:23,676 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:23,676 [INFO]: 	index_param: efSearch=268
2025-03-13 11:01:23,676 [INFO]: 	index_path: knn.index
2025-03-13 11:01:23,676 [INFO]: 	size in bytes: 432246490
2025-03-13 11:01:23,676 [INFO]: 	avg_search_speed_ms: 9.93743319773517
2025-03-13 11:01:23,676 [INFO]: 	99p_search_speed_ms: 13.804129743948582
2025-03-13 11:01:23,676 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:23,676 [INFO]: 	nb vectors: 2197
2025-03-13 11:01:23,676 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:23,676 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 11:01:23,676 [INFO]: }
2025-03-13 11:01:23,676 [INFO]: 	>>> Finished "Creating the index" in 39.3484 secs
2025-03-13 11:01:23,676 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3763 secs
2025-03-13 11:01:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 89823 [episode count 12/20]
[retrieval_preprocessing] for episode 36694 [episode count 13/20], we have num_retrieval=np.int64(2205) num_query=np.int64(99)
2025-03-13 11:01:25,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:26,261 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:26
2025-03-13 11:01:26,261 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-13 11:01:26,297 [INFO]: There are 2205 embeddings of dim 49152
2025-03-13 11:01:26,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 11:01:26,298 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:26
2025-03-13 11:01:26,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:26,298 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:01:26,299 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:26,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:01:26,299 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:26
2025-03-13 11:01:26,299 [INFO]: 455.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:26,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:01:26,300 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:26
2025-03-13 11:01:26,300 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:26,300 [INFO]: 	Creating the index 03/13/2025, 11:01:26
2025-03-13 11:01:26,301 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:26
2025-03-13 11:01:26,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 11:01:26,305 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:26
2025-03-13 11:01:26,305 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:01:26,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.24it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.04it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.32it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.56it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.54it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.56it/s]100%|██████████| 9/9 [00:02<00:00,  1.82it/s]100%|██████████| 9/9 [00:02<00:00,  3.32it/s]
2025-03-13 11:01:29,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:29
2025-03-13 11:02:01,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0637 secs
2025-03-13 11:02:01,088 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:02:01,088 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.90it/s] 50%|█████     | 2/4 [00:00<00:00,  5.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.20it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.81it/s]
2025-03-13 11:02:14,193 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1046 secs
2025-03-13 11:02:14,195 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8896 secs
2025-03-13 11:02:14,195 [INFO]: {
2025-03-13 11:02:14,195 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:14,195 [INFO]: 	index_param: efSearch=239
2025-03-13 11:02:14,195 [INFO]: 	index_path: knn.index
2025-03-13 11:02:14,195 [INFO]: 	size in bytes: 433820410
2025-03-13 11:02:14,195 [INFO]: 	avg_search_speed_ms: 9.767908162302774
2025-03-13 11:02:14,195 [INFO]: 	99p_search_speed_ms: 13.918021209537983
2025-03-13 11:02:14,195 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:14,195 [INFO]: 	nb vectors: 2205
2025-03-13 11:02:14,195 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:14,195 [INFO]: 	compression ratio: 0.9993089997771197
2025-03-13 11:02:14,195 [INFO]: }
2025-03-13 11:02:14,195 [INFO]: 	>>> Finished "Creating the index" in 47.8943 secs
2025-03-13 11:02:14,195 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9335 secs
2025-03-13 11:02:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 36694 [episode count 13/20]
[retrieval_preprocessing] for episode 39770 [episode count 14/20], we have num_retrieval=np.int64(2188) num_query=np.int64(116)
2025-03-13 11:02:15,725 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:16,097 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:16
2025-03-13 11:02:16,097 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.81it/s]
2025-03-13 11:02:16,131 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 11:02:16,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-13 11:02:16,132 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:16
2025-03-13 11:02:16,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:16,132 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:02:16,132 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:16,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:02:16,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:16
2025-03-13 11:02:16,133 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:16,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:02:16,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:16
2025-03-13 11:02:16,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:16,133 [INFO]: 	Creating the index 03/13/2025, 11:02:16
2025-03-13 11:02:16,134 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:16
2025-03-13 11:02:16,136 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:02:16,137 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:16
2025-03-13 11:02:16,137 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:02:16,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.09it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.52it/s] 56%|█████▌    | 5/9 [00:00<00:00, 12.58it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.74it/s]100%|██████████| 9/9 [00:02<00:00,  2.40it/s]100%|██████████| 9/9 [00:02<00:00,  3.53it/s]
2025-03-13 11:02:18,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:18
2025-03-13 11:02:49,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5179 secs
2025-03-13 11:02:49,213 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 11:02:49,213 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.05it/s] 50%|█████     | 2/4 [00:00<00:00,  5.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.01it/s]
2025-03-13 11:03:02,638 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4252 secs
2025-03-13 11:03:02,640 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5032 secs
2025-03-13 11:03:02,640 [INFO]: {
2025-03-13 11:03:02,640 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:02,640 [INFO]: 	index_param: efSearch=246
2025-03-13 11:03:02,640 [INFO]: 	index_path: knn.index
2025-03-13 11:03:02,640 [INFO]: 	size in bytes: 430475830
2025-03-13 11:03:02,640 [INFO]: 	avg_search_speed_ms: 9.842047513889765
2025-03-13 11:03:02,640 [INFO]: 	99p_search_speed_ms: 14.326002518646419
2025-03-13 11:03:02,640 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:02,640 [INFO]: 	nb vectors: 2188
2025-03-13 11:03:02,640 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:02,640 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 11:03:02,640 [INFO]: }
2025-03-13 11:03:02,640 [INFO]: 	>>> Finished "Creating the index" in 46.5069 secs
2025-03-13 11:03:02,640 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5430 secs
2025-03-13 11:03:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 39770 [episode count 14/20]
[retrieval_preprocessing] for episode 93546 [episode count 15/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 11:03:04,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:04,772 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:04
2025-03-13 11:03:04,772 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 942.12it/s]
2025-03-13 11:03:04,798 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 11:03:04,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:03:04,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:04,799 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:03:04,799 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:04,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:03:04,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,800 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:04,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:03:04,800 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:04
2025-03-13 11:03:04,800 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:04,801 [INFO]: 	Creating the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:04
2025-03-13 11:03:04,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:03:04,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,804 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:04,805 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.74it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.55it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.44it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.67it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.31it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.83it/s]100%|██████████| 9/9 [00:02<00:00,  1.95it/s]100%|██████████| 9/9 [00:02<00:00,  3.30it/s]
2025-03-13 11:03:07,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:07
2025-03-13 11:03:33,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2150 secs
2025-03-13 11:03:33,750 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 11:03:33,750 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 11:03:46,415 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6650 secs
2025-03-13 11:03:46,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6132 secs
2025-03-13 11:03:46,418 [INFO]: {
2025-03-13 11:03:46,418 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:46,418 [INFO]: 	index_param: efSearch=250
2025-03-13 11:03:46,418 [INFO]: 	index_path: knn.index
2025-03-13 11:03:46,418 [INFO]: 	size in bytes: 432246490
2025-03-13 11:03:46,418 [INFO]: 	avg_search_speed_ms: 10.345952648663703
2025-03-13 11:03:46,418 [INFO]: 	99p_search_speed_ms: 16.1724425526336
2025-03-13 11:03:46,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:46,418 [INFO]: 	nb vectors: 2197
2025-03-13 11:03:46,418 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:46,418 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 11:03:46,418 [INFO]: }
2025-03-13 11:03:46,418 [INFO]: 	>>> Finished "Creating the index" in 41.6177 secs
2025-03-13 11:03:46,418 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6465 secs
2025-03-13 11:03:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 93546 [episode count 15/20]
[retrieval_preprocessing] for episode 47548 [episode count 16/20], we have num_retrieval=np.int64(2166) num_query=np.int64(138)
2025-03-13 11:03:48,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:48,631 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:48
2025-03-13 11:03:48,631 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 11:03:48,656 [INFO]: There are 2166 embeddings of dim 49152
2025-03-13 11:03:48,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:03:48,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:48
2025-03-13 11:03:48,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:48,656 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:03:48,656 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:48,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:03:48,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:48
2025-03-13 11:03:48,657 [INFO]: 447.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:48,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:03:48,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:48
2025-03-13 11:03:48,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:48,657 [INFO]: 	Creating the index 03/13/2025, 11:03:48
2025-03-13 11:03:48,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:48
2025-03-13 11:03:48,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:03:48,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:48
2025-03-13 11:03:48,658 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:03:48,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.81it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.50it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.41it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.72it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.39it/s]100%|██████████| 9/9 [00:02<00:00,  2.07it/s]100%|██████████| 9/9 [00:02<00:00,  3.61it/s]
2025-03-13 11:03:51,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:51
2025-03-13 11:04:24,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8755 secs
2025-03-13 11:04:24,032 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 11:04:24,032 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-13 11:04:37,639 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6075 secs
2025-03-13 11:04:37,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9830 secs
2025-03-13 11:04:37,641 [INFO]: {
2025-03-13 11:04:37,641 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:37,641 [INFO]: 	index_param: efSearch=273
2025-03-13 11:04:37,641 [INFO]: 	index_path: knn.index
2025-03-13 11:04:37,641 [INFO]: 	size in bytes: 426147310
2025-03-13 11:04:37,641 [INFO]: 	avg_search_speed_ms: 10.431708601945322
2025-03-13 11:04:37,641 [INFO]: 	99p_search_speed_ms: 14.041123553179203
2025-03-13 11:04:37,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:37,641 [INFO]: 	nb vectors: 2166
2025-03-13 11:04:37,641 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:37,641 [INFO]: 	compression ratio: 0.9993092013182014
2025-03-13 11:04:37,641 [INFO]: }
2025-03-13 11:04:37,641 [INFO]: 	>>> Finished "Creating the index" in 48.9844 secs
2025-03-13 11:04:37,641 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0103 secs
2025-03-13 11:04:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 47548 [episode count 16/20]
[retrieval_preprocessing] for episode 63919 [episode count 17/20], we have num_retrieval=np.int64(2182) num_query=np.int64(122)
2025-03-13 11:04:39,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:40,093 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:40
2025-03-13 11:04:40,093 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1150.07it/s]
2025-03-13 11:04:40,119 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:04:40,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 11:04:40,120 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,120 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:40,120 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:04:40,120 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:40,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:04:40,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,121 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:40,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:04:40,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:40
2025-03-13 11:04:40,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:40,122 [INFO]: 	Creating the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,122 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:40
2025-03-13 11:04:40,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:04:40,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:40
2025-03-13 11:04:40,125 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:04:40,126 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.35it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.86it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.63it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.93it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.89it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.41it/s]100%|██████████| 9/9 [00:02<00:00,  1.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.03it/s]
2025-03-13 11:04:43,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:43
2025-03-13 11:05:10,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2145 secs
2025-03-13 11:05:10,316 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 11:05:10,316 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.77it/s] 50%|█████     | 2/4 [00:01<00:01,  1.64it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.16it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.69it/s]
2025-03-13 11:05:24,351 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0353 secs
2025-03-13 11:05:24,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2283 secs
2025-03-13 11:05:24,354 [INFO]: {
2025-03-13 11:05:24,354 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:24,354 [INFO]: 	index_param: efSearch=291
2025-03-13 11:05:24,354 [INFO]: 	index_path: knn.index
2025-03-13 11:05:24,354 [INFO]: 	size in bytes: 429295270
2025-03-13 11:05:24,354 [INFO]: 	avg_search_speed_ms: 12.179607651099998
2025-03-13 11:05:24,354 [INFO]: 	99p_search_speed_ms: 22.48399988748132
2025-03-13 11:05:24,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:24,354 [INFO]: 	nb vectors: 2182
2025-03-13 11:05:24,354 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:24,354 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:05:24,354 [INFO]: }
2025-03-13 11:05:24,354 [INFO]: 	>>> Finished "Creating the index" in 44.2324 secs
2025-03-13 11:05:24,354 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2608 secs
2025-03-13 11:05:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 63919 [episode count 17/20]
[retrieval_preprocessing] for episode 52684 [episode count 18/20], we have num_retrieval=np.int64(2165) num_query=np.int64(139)
2025-03-13 11:05:26,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:26,684 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:26
2025-03-13 11:05:26,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.15it/s]
2025-03-13 11:05:26,719 [INFO]: There are 2165 embeddings of dim 49152
2025-03-13 11:05:26,720 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 11:05:26,720 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:26
2025-03-13 11:05:26,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:26,720 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:05:26,720 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:26,720 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:05:26,720 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:26
2025-03-13 11:05:26,720 [INFO]: 446.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:26,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:05:26,721 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:26
2025-03-13 11:05:26,721 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:26,721 [INFO]: 	Creating the index 03/13/2025, 11:05:26
2025-03-13 11:05:26,721 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:26
2025-03-13 11:05:26,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:05:26,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:26
2025-03-13 11:05:26,723 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:05:26,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.11it/s] 33%|███▎      | 3/9 [00:00<00:00, 12.56it/s] 56%|█████▌    | 5/9 [00:00<00:00, 14.44it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.12it/s]100%|██████████| 9/9 [00:02<00:00,  2.80it/s]100%|██████████| 9/9 [00:02<00:00,  4.12it/s]
2025-03-13 11:05:28,911 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:28
2025-03-13 11:06:00,617 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7051 secs
2025-03-13 11:06:00,617 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:06:00,617 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-13 11:06:13,022 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4053 secs
2025-03-13 11:06:13,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3011 secs
2025-03-13 11:06:13,024 [INFO]: {
2025-03-13 11:06:13,024 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:13,024 [INFO]: 	index_param: efSearch=262
2025-03-13 11:06:13,024 [INFO]: 	index_path: knn.index
2025-03-13 11:06:13,024 [INFO]: 	size in bytes: 425950570
2025-03-13 11:06:13,024 [INFO]: 	avg_search_speed_ms: 10.459821554345067
2025-03-13 11:06:13,024 [INFO]: 	99p_search_speed_ms: 15.09017860516906
2025-03-13 11:06:13,024 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:13,024 [INFO]: 	nb vectors: 2165
2025-03-13 11:06:13,024 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:13,024 [INFO]: 	compression ratio: 0.9993091921440556
2025-03-13 11:06:13,024 [INFO]: }
2025-03-13 11:06:13,024 [INFO]: 	>>> Finished "Creating the index" in 46.3038 secs
2025-03-13 11:06:13,025 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3408 secs
2025-03-13 11:06:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 52684 [episode count 18/20]
[retrieval_preprocessing] for episode 81876 [episode count 19/20], we have num_retrieval=np.int64(2207) num_query=np.int64(97)
2025-03-13 11:06:15,204 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:15,637 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:15
2025-03-13 11:06:15,638 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2141.04it/s]
2025-03-13 11:06:15,671 [INFO]: There are 2207 embeddings of dim 49152
2025-03-13 11:06:15,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 11:06:15,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:15
2025-03-13 11:06:15,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:15,672 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:06:15,672 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:15,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:15,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:15
2025-03-13 11:06:15,672 [INFO]: 455.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:15,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:06:15,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:15
2025-03-13 11:06:15,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:15,672 [INFO]: 	Creating the index 03/13/2025, 11:06:15
2025-03-13 11:06:15,672 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:15
2025-03-13 11:06:15,674 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:06:15,674 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:15
2025-03-13 11:06:15,674 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:06:15,674 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.61it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.84it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.37it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.68it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.86it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.02it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.05it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.07it/s]100%|██████████| 9/9 [00:02<00:00,  1.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.36it/s]
2025-03-13 11:06:18,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:18
2025-03-13 11:06:43,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6107 secs
2025-03-13 11:06:43,970 [INFO]: The best hyperparameters are: efSearch=259
2025-03-13 11:06:43,971 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-13 11:06:56,293 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3229 secs
2025-03-13 11:06:56,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6215 secs
2025-03-13 11:06:56,295 [INFO]: {
2025-03-13 11:06:56,295 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:56,295 [INFO]: 	index_param: efSearch=259
2025-03-13 11:06:56,296 [INFO]: 	index_path: knn.index
2025-03-13 11:06:56,296 [INFO]: 	size in bytes: 434213890
2025-03-13 11:06:56,296 [INFO]: 	avg_search_speed_ms: 10.218484047990563
2025-03-13 11:06:56,296 [INFO]: 	99p_search_speed_ms: 13.705954640172422
2025-03-13 11:06:56,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:56,296 [INFO]: 	nb vectors: 2207
2025-03-13 11:06:56,296 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:56,296 [INFO]: 	compression ratio: 0.9993090179588682
2025-03-13 11:06:56,296 [INFO]: }
2025-03-13 11:06:56,296 [INFO]: 	>>> Finished "Creating the index" in 40.6237 secs
2025-03-13 11:06:56,296 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6580 secs
2025-03-13 11:06:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 81876 [episode count 19/20]
2025-03-13 11:06:57: [retrieval_preprocessing] finished for 3163748394_put_rubiks_cube_on_shelf [chosen_id count 0/260]
2025-03-13 11:06:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_orange_object_in_blue_cup [chosen_id count 1/260]
2025-03-13 11:06:59: [retrieval_preprocessing] we have num_total=2263 embedding_dim=49152
[retrieval_preprocessing] for episode 26628 [episode count 0/20], we have num_retrieval=np.int64(2146) num_query=np.int64(117)
2025-03-13 11:07:00,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:00,695 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:00
2025-03-13 11:07:00,695 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.84it/s]
2025-03-13 11:07:00,720 [INFO]: There are 2146 embeddings of dim 49152
2025-03-13 11:07:00,720 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 11:07:00,720 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:00
2025-03-13 11:07:00,720 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:00,721 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:00,721 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:00,721 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:07:00,721 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:00
2025-03-13 11:07:00,721 [INFO]: 442.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:00,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:07:00,722 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:00
2025-03-13 11:07:00,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:00,722 [INFO]: 	Creating the index 03/13/2025, 11:07:00
2025-03-13 11:07:00,723 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:00
2025-03-13 11:07:00,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:07:00,726 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:00
2025-03-13 11:07:00,726 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:00,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.27it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.69it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.85it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.42it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.16it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.03it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.89it/s]100%|██████████| 9/9 [00:02<00:00,  1.84it/s]100%|██████████| 9/9 [00:02<00:00,  3.59it/s]
2025-03-13 11:07:03,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:03
2025-03-13 11:07:29,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6153 secs
2025-03-13 11:07:29,854 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 11:07:29,854 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-13 11:07:42,629 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7754 secs
2025-03-13 11:07:42,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9054 secs
2025-03-13 11:07:42,632 [INFO]: {
2025-03-13 11:07:42,632 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:42,632 [INFO]: 	index_param: efSearch=249
2025-03-13 11:07:42,632 [INFO]: 	index_path: knn.index
2025-03-13 11:07:42,632 [INFO]: 	size in bytes: 422212450
2025-03-13 11:07:42,632 [INFO]: 	avg_search_speed_ms: 11.405388121902009
2025-03-13 11:07:42,632 [INFO]: 	99p_search_speed_ms: 15.945242727175355
2025-03-13 11:07:42,632 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:42,632 [INFO]: 	nb vectors: 2146
2025-03-13 11:07:42,632 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:42,632 [INFO]: 	compression ratio: 0.9993091582211752
2025-03-13 11:07:42,632 [INFO]: }
2025-03-13 11:07:42,632 [INFO]: 	>>> Finished "Creating the index" in 41.9095 secs
2025-03-13 11:07:42,632 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9370 secs
2025-03-13 11:07:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 26628 [episode count 0/20]
[retrieval_preprocessing] for episode 25628 [episode count 1/20], we have num_retrieval=np.int64(2162) num_query=np.int64(101)
2025-03-13 11:07:44,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:45,073 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:45
2025-03-13 11:07:45,073 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1081.01it/s]
2025-03-13 11:07:45,100 [INFO]: There are 2162 embeddings of dim 49152
2025-03-13 11:07:45,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 11:07:45,100 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:45
2025-03-13 11:07:45,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:45,100 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:07:45,100 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:45,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:45,100 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:45
2025-03-13 11:07:45,100 [INFO]: 446.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:45,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:07:45,100 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:45
2025-03-13 11:07:45,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:45,100 [INFO]: 	Creating the index 03/13/2025, 11:07:45
2025-03-13 11:07:45,100 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:45
2025-03-13 11:07:45,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:07:45,102 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:45
2025-03-13 11:07:45,102 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:07:45,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.52it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.77it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.97it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.98it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.03it/s]100%|██████████| 9/9 [00:02<00:00,  3.73it/s]
2025-03-13 11:07:47,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:47
2025-03-13 11:08:11,476 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9570 secs
2025-03-13 11:08:11,476 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 11:08:11,476 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-13 11:08:24,388 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9119 secs
2025-03-13 11:08:24,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2879 secs
2025-03-13 11:08:24,390 [INFO]: {
2025-03-13 11:08:24,390 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:24,390 [INFO]: 	index_param: efSearch=233
2025-03-13 11:08:24,390 [INFO]: 	index_path: knn.index
2025-03-13 11:08:24,390 [INFO]: 	size in bytes: 425360350
2025-03-13 11:08:24,390 [INFO]: 	avg_search_speed_ms: 10.273451004215618
2025-03-13 11:08:24,390 [INFO]: 	99p_search_speed_ms: 12.714753691107035
2025-03-13 11:08:24,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:24,390 [INFO]: 	nb vectors: 2162
2025-03-13 11:08:24,390 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:24,390 [INFO]: 	compression ratio: 0.9993091645706987
2025-03-13 11:08:24,390 [INFO]: }
2025-03-13 11:08:24,390 [INFO]: 	>>> Finished "Creating the index" in 39.2895 secs
2025-03-13 11:08:24,390 [INFO]: >>> Finished "Launching the whole pipeline" in 39.3168 secs
2025-03-13 11:08:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 25628 [episode count 1/20]
[retrieval_preprocessing] for episode 12390 [episode count 2/20], we have num_retrieval=np.int64(2184) num_query=np.int64(79)
2025-03-13 11:08:26,121 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:26,456 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:26
2025-03-13 11:08:26,456 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-13 11:08:26,480 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 11:08:26,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 11:08:26,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:26
2025-03-13 11:08:26,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:26,480 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:08:26,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:26,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:26,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:26
2025-03-13 11:08:26,480 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:26,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:08:26,480 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:26
2025-03-13 11:08:26,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:26,480 [INFO]: 	Creating the index 03/13/2025, 11:08:26
2025-03-13 11:08:26,480 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:26
2025-03-13 11:08:26,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:08:26,481 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:26
2025-03-13 11:08:26,481 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:08:26,481 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.69it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.53it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.33it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.73it/s]100%|██████████| 9/9 [00:02<00:00,  2.25it/s]100%|██████████| 9/9 [00:02<00:00,  3.24it/s]
2025-03-13 11:08:29,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:29
2025-03-13 11:08:53,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2486 secs
2025-03-13 11:08:53,508 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 11:08:53,508 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-13 11:09:05,928 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4191 secs
2025-03-13 11:09:05,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.4478 secs
2025-03-13 11:09:05,929 [INFO]: {
2025-03-13 11:09:05,929 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:05,929 [INFO]: 	index_param: efSearch=171
2025-03-13 11:09:05,929 [INFO]: 	index_path: knn.index
2025-03-13 11:09:05,929 [INFO]: 	size in bytes: 429688750
2025-03-13 11:09:05,929 [INFO]: 	avg_search_speed_ms: 8.408241024471137
2025-03-13 11:09:05,929 [INFO]: 	99p_search_speed_ms: 12.199716372415416
2025-03-13 11:09:05,929 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:05,930 [INFO]: 	nb vectors: 2184
2025-03-13 11:09:05,930 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:05,930 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 11:09:05,930 [INFO]: }
2025-03-13 11:09:05,930 [INFO]: 	>>> Finished "Creating the index" in 39.4491 secs
2025-03-13 11:09:05,930 [INFO]: >>> Finished "Launching the whole pipeline" in 39.4739 secs
2025-03-13 11:09:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 12390 [episode count 2/20]
[retrieval_preprocessing] for episode 67170 [episode count 3/20], we have num_retrieval=np.int64(2169) num_query=np.int64(94)
2025-03-13 11:09:07,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:07,842 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:07
2025-03-13 11:09:07,842 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-13 11:09:07,866 [INFO]: There are 2169 embeddings of dim 49152
2025-03-13 11:09:07,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:09:07,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:07
2025-03-13 11:09:07,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:07,867 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:09:07,867 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:07,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:09:07,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:07
2025-03-13 11:09:07,867 [INFO]: 447.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:07,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:09:07,868 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:07
2025-03-13 11:09:07,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:07,868 [INFO]: 	Creating the index 03/13/2025, 11:09:07
2025-03-13 11:09:07,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:07
2025-03-13 11:09:07,871 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:09:07,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:07
2025-03-13 11:09:07,871 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:09:07,871 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.99it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.52it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.24it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.72it/s]100%|██████████| 9/9 [00:02<00:00,  2.58it/s]100%|██████████| 9/9 [00:02<00:00,  3.72it/s]
2025-03-13 11:09:10,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:10
2025-03-13 11:09:36,713 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4141 secs
2025-03-13 11:09:36,713 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:09:36,713 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-13 11:09:49,049 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3354 secs
2025-03-13 11:09:49,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1791 secs
2025-03-13 11:09:49,051 [INFO]: {
2025-03-13 11:09:49,051 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:49,051 [INFO]: 	index_param: efSearch=202
2025-03-13 11:09:49,051 [INFO]: 	index_path: knn.index
2025-03-13 11:09:49,051 [INFO]: 	size in bytes: 426737590
2025-03-13 11:09:49,051 [INFO]: 	avg_search_speed_ms: 9.53166688027995
2025-03-13 11:09:49,051 [INFO]: 	99p_search_speed_ms: 13.72535616159439
2025-03-13 11:09:49,051 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:49,051 [INFO]: 	nb vectors: 2169
2025-03-13 11:09:49,051 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:49,051 [INFO]: 	compression ratio: 0.9993090882853793
2025-03-13 11:09:49,051 [INFO]: }
2025-03-13 11:09:49,051 [INFO]: 	>>> Finished "Creating the index" in 41.1827 secs
2025-03-13 11:09:49,051 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2091 secs
2025-03-13 11:09:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 67170 [episode count 3/20]
[retrieval_preprocessing] for episode 5187 [episode count 4/20], we have num_retrieval=np.int64(2182) num_query=np.int64(81)
2025-03-13 11:09:50,426 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:50,755 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:50
2025-03-13 11:09:50,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.39it/s]
2025-03-13 11:09:50,789 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 11:09:50,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:09:50,789 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:50
2025-03-13 11:09:50,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:50,790 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:09:50,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:50,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:09:50,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:50
2025-03-13 11:09:50,790 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:50,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:09:50,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:50
2025-03-13 11:09:50,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:50,790 [INFO]: 	Creating the index 03/13/2025, 11:09:50
2025-03-13 11:09:50,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:50
2025-03-13 11:09:50,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 11:09:50,793 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:50
2025-03-13 11:09:50,793 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:09:50,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.31it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.01it/s] 67%|██████▋   | 6/9 [00:00<00:00, 18.03it/s]100%|██████████| 9/9 [00:02<00:00,  3.41it/s]100%|██████████| 9/9 [00:02<00:00,  4.16it/s]
2025-03-13 11:09:52,958 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:52
2025-03-13 11:10:26,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9714 secs
2025-03-13 11:10:26,930 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 11:10:26,931 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-13 11:10:39,066 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1354 secs
2025-03-13 11:10:39,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2756 secs
2025-03-13 11:10:39,069 [INFO]: {
2025-03-13 11:10:39,069 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:39,069 [INFO]: 	index_param: efSearch=169
2025-03-13 11:10:39,069 [INFO]: 	index_path: knn.index
2025-03-13 11:10:39,069 [INFO]: 	size in bytes: 429295270
2025-03-13 11:10:39,069 [INFO]: 	avg_search_speed_ms: 10.883752555334059
2025-03-13 11:10:39,069 [INFO]: 	99p_search_speed_ms: 15.42056917678564
2025-03-13 11:10:39,069 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:39,069 [INFO]: 	nb vectors: 2182
2025-03-13 11:10:39,069 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:39,069 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 11:10:39,069 [INFO]: }
2025-03-13 11:10:39,069 [INFO]: 	>>> Finished "Creating the index" in 48.2786 secs
2025-03-13 11:10:39,069 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3137 secs
2025-03-13 11:10:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 5187 [episode count 4/20]
[retrieval_preprocessing] for episode 59461 [episode count 5/20], we have num_retrieval=np.int64(2183) num_query=np.int64(80)
2025-03-13 11:10:40,224 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:40,626 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:40
2025-03-13 11:10:40,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.47it/s]
2025-03-13 11:10:40,661 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 11:10:40,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-13 11:10:40,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:40
2025-03-13 11:10:40,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:40,662 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:10:40,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:40,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:40,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:40
2025-03-13 11:10:40,662 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:40,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:10:40,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:40
2025-03-13 11:10:40,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:40,662 [INFO]: 	Creating the index 03/13/2025, 11:10:40
2025-03-13 11:10:40,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:40
2025-03-13 11:10:40,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:10:40,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:40
2025-03-13 11:10:40,664 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:10:40,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.44it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.40it/s]100%|██████████| 9/9 [00:02<00:00,  3.92it/s]
2025-03-13 11:10:42,961 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:42
2025-03-13 11:11:11,264 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3026 secs
2025-03-13 11:11:11,265 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 11:11:11,265 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.17it/s]
2025-03-13 11:11:23,662 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3970 secs
2025-03-13 11:11:23,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0003 secs
2025-03-13 11:11:23,664 [INFO]: {
2025-03-13 11:11:23,664 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:23,664 [INFO]: 	index_param: efSearch=153
2025-03-13 11:11:23,664 [INFO]: 	index_path: knn.index
2025-03-13 11:11:23,664 [INFO]: 	size in bytes: 429492010
2025-03-13 11:11:23,664 [INFO]: 	avg_search_speed_ms: 8.73734959458127
2025-03-13 11:11:23,664 [INFO]: 	99p_search_speed_ms: 14.523388491943475
2025-03-13 11:11:23,664 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:23,664 [INFO]: 	nb vectors: 2183
2025-03-13 11:11:23,665 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:23,665 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 11:11:23,665 [INFO]: }
2025-03-13 11:11:23,665 [INFO]: 	>>> Finished "Creating the index" in 43.0022 secs
2025-03-13 11:11:23,665 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0382 secs
2025-03-13 11:11:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 59461 [episode count 5/20]
[retrieval_preprocessing] for episode 53480 [episode count 6/20], we have num_retrieval=np.int64(2149) num_query=np.int64(114)
2025-03-13 11:11:25,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:25,629 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:25
2025-03-13 11:11:25,629 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-13 11:11:25,685 [INFO]: There are 2149 embeddings of dim 49152
2025-03-13 11:11:25,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0562 secs
2025-03-13 11:11:25,686 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,686 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:25,686 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:11:25,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:25,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:11:25,687 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,687 [INFO]: 443.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:25,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:11:25,688 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:25
2025-03-13 11:11:25,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:25,688 [INFO]: 	Creating the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,688 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:25
2025-03-13 11:11:25,691 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:11:25,691 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:25
2025-03-13 11:11:25,691 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:11:25,691 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.11it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.77it/s]100%|██████████| 9/9 [00:02<00:00,  4.48it/s]
2025-03-13 11:11:27,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:27
2025-03-13 11:12:01,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8605 secs
2025-03-13 11:12:01,567 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:12:01,567 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.05it/s]
2025-03-13 11:12:13,497 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9291 secs
2025-03-13 11:12:13,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8081 secs
2025-03-13 11:12:13,500 [INFO]: {
2025-03-13 11:12:13,500 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:13,500 [INFO]: 	index_param: efSearch=166
2025-03-13 11:12:13,500 [INFO]: 	index_path: knn.index
2025-03-13 11:12:13,500 [INFO]: 	size in bytes: 422802670
2025-03-13 11:12:13,500 [INFO]: 	avg_search_speed_ms: 10.02932582148645
2025-03-13 11:12:13,500 [INFO]: 	99p_search_speed_ms: 18.63340334035456
2025-03-13 11:12:13,500 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:13,500 [INFO]: 	nb vectors: 2149
2025-03-13 11:12:13,500 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:13,500 [INFO]: 	compression ratio: 0.9993091860086881
2025-03-13 11:12:13,500 [INFO]: }
2025-03-13 11:12:13,500 [INFO]: 	>>> Finished "Creating the index" in 47.8118 secs
2025-03-13 11:12:13,500 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8708 secs
2025-03-13 11:12:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 53480 [episode count 6/20]
[retrieval_preprocessing] for episode 67723 [episode count 7/20], we have num_retrieval=np.int64(2075) num_query=np.int64(188)
2025-03-13 11:12:14,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:15,207 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:15
2025-03-13 11:12:15,207 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.83it/s]
2025-03-13 11:12:15,237 [INFO]: There are 2075 embeddings of dim 49152
2025-03-13 11:12:15,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:12:15,237 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:15,237 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:12:15,237 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:15,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:15,237 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,237 [INFO]: 428.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:15,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:15,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:15
2025-03-13 11:12:15,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:15,238 [INFO]: 	Creating the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:15
2025-03-13 11:12:15,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:12:15,239 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:15
2025-03-13 11:12:15,239 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:15,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.01it/s] 67%|██████▋   | 6/9 [00:00<00:00, 31.98it/s]100%|██████████| 9/9 [00:01<00:00,  4.90it/s]
2025-03-13 11:12:17,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:17
2025-03-13 11:12:44,735 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6567 secs
2025-03-13 11:12:44,736 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 11:12:44,736 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-13 11:12:57,103 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3671 secs
2025-03-13 11:12:57,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8667 secs
2025-03-13 11:12:57,106 [INFO]: {
2025-03-13 11:12:57,106 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:57,106 [INFO]: 	index_param: efSearch=141
2025-03-13 11:12:57,106 [INFO]: 	index_path: knn.index
2025-03-13 11:12:57,106 [INFO]: 	size in bytes: 408243670
2025-03-13 11:12:57,106 [INFO]: 	avg_search_speed_ms: 9.46411390655807
2025-03-13 11:12:57,106 [INFO]: 	99p_search_speed_ms: 13.114586919546133
2025-03-13 11:12:57,106 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:57,106 [INFO]: 	nb vectors: 2075
2025-03-13 11:12:57,106 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:57,106 [INFO]: 	compression ratio: 0.9993090646083992
2025-03-13 11:12:57,106 [INFO]: }
2025-03-13 11:12:57,106 [INFO]: 	>>> Finished "Creating the index" in 41.8682 secs
2025-03-13 11:12:57,106 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8989 secs
2025-03-13 11:12:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 67723 [episode count 7/20]
[retrieval_preprocessing] for episode 27794 [episode count 8/20], we have num_retrieval=np.int64(2175) num_query=np.int64(88)
2025-03-13 11:12:59,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:59,426 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:59
2025-03-13 11:12:59,426 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.50it/s]
2025-03-13 11:12:59,454 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 11:12:59,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 11:12:59,454 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:59
2025-03-13 11:12:59,454 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:59,454 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:12:59,454 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:59,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:59,454 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:59
2025-03-13 11:12:59,454 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:59,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:12:59,455 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:59
2025-03-13 11:12:59,455 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:59,455 [INFO]: 	Creating the index 03/13/2025, 11:12:59
2025-03-13 11:12:59,455 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:59
2025-03-13 11:12:59,456 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:12:59,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:59
2025-03-13 11:12:59,456 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:12:59,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.74it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.02it/s] 44%|████▍     | 4/9 [00:00<00:00,  9.76it/s] 67%|██████▋   | 6/9 [00:00<00:00, 11.39it/s] 89%|████████▉ | 8/9 [00:00<00:00, 11.89it/s]100%|██████████| 9/9 [00:02<00:00,  3.60it/s]
2025-03-13 11:13:01,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:01
2025-03-13 11:13:29,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7113 secs
2025-03-13 11:13:29,669 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 11:13:29,669 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s]
2025-03-13 11:13:42,058 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3890 secs
2025-03-13 11:13:42,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6045 secs
2025-03-13 11:13:42,061 [INFO]: {
2025-03-13 11:13:42,061 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:42,061 [INFO]: 	index_param: efSearch=197
2025-03-13 11:13:42,061 [INFO]: 	index_path: knn.index
2025-03-13 11:13:42,061 [INFO]: 	size in bytes: 427918090
2025-03-13 11:13:42,061 [INFO]: 	avg_search_speed_ms: 9.848779976239491
2025-03-13 11:13:42,061 [INFO]: 	99p_search_speed_ms: 16.305680768564347
2025-03-13 11:13:42,061 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:42,061 [INFO]: 	nb vectors: 2175
2025-03-13 11:13:42,061 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:42,061 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 11:13:42,061 [INFO]: }
2025-03-13 11:13:42,061 [INFO]: 	>>> Finished "Creating the index" in 42.6061 secs
2025-03-13 11:13:42,061 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6349 secs
2025-03-13 11:13:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27794 [episode count 8/20]
[retrieval_preprocessing] for episode 85410 [episode count 9/20], we have num_retrieval=np.int64(2176) num_query=np.int64(87)
2025-03-13 11:13:43,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:43,774 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:43
2025-03-13 11:13:43,774 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.44it/s]
2025-03-13 11:13:43,800 [INFO]: There are 2176 embeddings of dim 49152
2025-03-13 11:13:43,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 11:13:43,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:43
2025-03-13 11:13:43,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:43,801 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:13:43,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:43,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:13:43,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:43
2025-03-13 11:13:43,801 [INFO]: 449.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:43,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:13:43,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:43
2025-03-13 11:13:43,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:43,801 [INFO]: 	Creating the index 03/13/2025, 11:13:43
2025-03-13 11:13:43,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:43
2025-03-13 11:13:43,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:13:43,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:43
2025-03-13 11:13:43,802 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:13:43,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.67it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.98it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.09it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.64it/s]100%|██████████| 9/9 [00:02<00:00,  2.76it/s]100%|██████████| 9/9 [00:02<00:00,  3.88it/s]
2025-03-13 11:13:46,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:46
2025-03-13 11:14:09,444 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3198 secs
2025-03-13 11:14:09,445 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 11:14:09,445 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s]
2025-03-13 11:14:21,757 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3123 secs
2025-03-13 11:14:21,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.9565 secs
2025-03-13 11:14:21,759 [INFO]: {
2025-03-13 11:14:21,759 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:21,759 [INFO]: 	index_param: efSearch=220
2025-03-13 11:14:21,759 [INFO]: 	index_path: knn.index
2025-03-13 11:14:21,759 [INFO]: 	size in bytes: 428114830
2025-03-13 11:14:21,759 [INFO]: 	avg_search_speed_ms: 9.55442911340413
2025-03-13 11:14:21,759 [INFO]: 	99p_search_speed_ms: 13.072148216888305
2025-03-13 11:14:21,759 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:21,759 [INFO]: 	nb vectors: 2176
2025-03-13 11:14:21,759 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:21,759 [INFO]: 	compression ratio: 0.9993090124908778
2025-03-13 11:14:21,759 [INFO]: }
2025-03-13 11:14:21,759 [INFO]: 	>>> Finished "Creating the index" in 37.9580 secs
2025-03-13 11:14:21,759 [INFO]: >>> Finished "Launching the whole pipeline" in 37.9853 secs
2025-03-13 11:14:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 85410 [episode count 9/20]
[retrieval_preprocessing] for episode 1183 [episode count 10/20], we have num_retrieval=np.int64(2152) num_query=np.int64(111)
2025-03-13 11:14:23,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:23,433 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:23
2025-03-13 11:14:23,433 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-13 11:14:23,456 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 11:14:23,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 11:14:23,456 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:23,456 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:14:23,456 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:23,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:23,456 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,456 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:23,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:23,456 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:23
2025-03-13 11:14:23,456 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:23,456 [INFO]: 	Creating the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,456 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:23
2025-03-13 11:14:23,457 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:14:23,457 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:23
2025-03-13 11:14:23,457 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:14:23,457 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.82it/s] 33%|███▎      | 3/9 [00:00<00:00, 10.06it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.27it/s] 89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s]100%|██████████| 9/9 [00:02<00:00,  3.97it/s]
2025-03-13 11:14:25,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:25
2025-03-13 11:14:50,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4806 secs
2025-03-13 11:14:50,206 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:14:50,206 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-13 11:15:02,639 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4324 secs
2025-03-13 11:15:02,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.1835 secs
2025-03-13 11:15:02,641 [INFO]: {
2025-03-13 11:15:02,641 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:02,641 [INFO]: 	index_param: efSearch=251
2025-03-13 11:15:02,641 [INFO]: 	index_path: knn.index
2025-03-13 11:15:02,641 [INFO]: 	size in bytes: 423392890
2025-03-13 11:15:02,641 [INFO]: 	avg_search_speed_ms: 10.89040576028871
2025-03-13 11:15:02,641 [INFO]: 	99p_search_speed_ms: 16.13756843842566
2025-03-13 11:15:02,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:02,641 [INFO]: 	nb vectors: 2152
2025-03-13 11:15:02,641 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:02,641 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 11:15:02,641 [INFO]: }
2025-03-13 11:15:02,641 [INFO]: 	>>> Finished "Creating the index" in 39.1849 secs
2025-03-13 11:15:02,641 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2079 secs
2025-03-13 11:15:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 1183 [episode count 10/20]
[retrieval_preprocessing] for episode 17208 [episode count 11/20], we have num_retrieval=np.int64(2152) num_query=np.int64(111)
2025-03-13 11:15:04,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:05,296 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:05
2025-03-13 11:15:05,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1289.36it/s]
2025-03-13 11:15:05,321 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 11:15:05,321 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 11:15:05,321 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:05
2025-03-13 11:15:05,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:05,322 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:15:05,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:05,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:05,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:05
2025-03-13 11:15:05,322 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:05,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:15:05,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:05
2025-03-13 11:15:05,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:05,322 [INFO]: 	Creating the index 03/13/2025, 11:15:05
2025-03-13 11:15:05,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:05
2025-03-13 11:15:05,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:15:05,323 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:05
2025-03-13 11:15:05,323 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:15:05,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.05it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.76it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.91it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.51it/s]100%|██████████| 9/9 [00:02<00:00,  2.97it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 11:15:07,478 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:07
2025-03-13 11:15:30,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9960 secs
2025-03-13 11:15:30,475 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 11:15:30,475 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 11:15:43,401 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9258 secs
2025-03-13 11:15:43,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0794 secs
2025-03-13 11:15:43,403 [INFO]: {
2025-03-13 11:15:43,403 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:43,403 [INFO]: 	index_param: efSearch=184
2025-03-13 11:15:43,403 [INFO]: 	index_path: knn.index
2025-03-13 11:15:43,403 [INFO]: 	size in bytes: 423392890
2025-03-13 11:15:43,403 [INFO]: 	avg_search_speed_ms: 8.959058053531386
2025-03-13 11:15:43,403 [INFO]: 	99p_search_speed_ms: 16.204538941383348
2025-03-13 11:15:43,403 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:43,403 [INFO]: 	nb vectors: 2152
2025-03-13 11:15:43,403 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:43,403 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 11:15:43,403 [INFO]: }
2025-03-13 11:15:43,403 [INFO]: 	>>> Finished "Creating the index" in 38.0812 secs
2025-03-13 11:15:43,403 [INFO]: >>> Finished "Launching the whole pipeline" in 38.1067 secs
2025-03-13 11:15:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 17208 [episode count 11/20]
[retrieval_preprocessing] for episode 38263 [episode count 12/20], we have num_retrieval=np.int64(1994) num_query=np.int64(269)
2025-03-13 11:15:44,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:45,183 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:45
2025-03-13 11:15:45,183 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.36it/s]
2025-03-13 11:15:45,222 [INFO]: There are 1994 embeddings of dim 49152
2025-03-13 11:15:45,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-13 11:15:45,223 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:45
2025-03-13 11:15:45,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:45,223 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 11:15:45,223 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:45,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:15:45,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:45
2025-03-13 11:15:45,223 [INFO]: 411.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:45,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:15:45,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:45
2025-03-13 11:15:45,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:45,223 [INFO]: 	Creating the index 03/13/2025, 11:15:45
2025-03-13 11:15:45,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:45
2025-03-13 11:15:45,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 11:15:45,225 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:45
2025-03-13 11:15:45,225 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:15:45,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:00<00:00,  9.51it/s] 75%|███████▌  | 6/8 [00:00<00:00, 29.91it/s]100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
2025-03-13 11:15:46,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:46
2025-03-13 11:16:16,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9570 secs
2025-03-13 11:16:16,925 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 11:16:16,925 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 11:16:30,039 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1141 secs
2025-03-13 11:16:30,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8160 secs
2025-03-13 11:16:30,041 [INFO]: {
2025-03-13 11:16:30,041 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:30,041 [INFO]: 	index_param: efSearch=178
2025-03-13 11:16:30,041 [INFO]: 	index_path: knn.index
2025-03-13 11:16:30,041 [INFO]: 	size in bytes: 392307490
2025-03-13 11:16:30,041 [INFO]: 	avg_search_speed_ms: 10.871630041029952
2025-03-13 11:16:30,041 [INFO]: 	99p_search_speed_ms: 14.26413269015029
2025-03-13 11:16:30,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:30,041 [INFO]: 	nb vectors: 1994
2025-03-13 11:16:30,041 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:30,041 [INFO]: 	compression ratio: 0.999308863565159
2025-03-13 11:16:30,041 [INFO]: }
2025-03-13 11:16:30,041 [INFO]: 	>>> Finished "Creating the index" in 44.8179 secs
2025-03-13 11:16:30,041 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8584 secs
2025-03-13 11:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 38263 [episode count 12/20]
[retrieval_preprocessing] for episode 81291 [episode count 13/20], we have num_retrieval=np.int64(2183) num_query=np.int64(80)
2025-03-13 11:16:32,911 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:33,291 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:33
2025-03-13 11:16:33,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.12it/s]
2025-03-13 11:16:33,326 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 11:16:33,327 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 11:16:33,327 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:33
2025-03-13 11:16:33,327 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:33,327 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:16:33,327 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:33,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:33,327 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:33
2025-03-13 11:16:33,327 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:33,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:16:33,327 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:33
2025-03-13 11:16:33,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:33,327 [INFO]: 	Creating the index 03/13/2025, 11:16:33
2025-03-13 11:16:33,327 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:33
2025-03-13 11:16:33,329 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:16:33,329 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:33
2025-03-13 11:16:33,329 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:16:33,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.29it/s] 89%|████████▉ | 8/9 [00:00<00:00, 37.08it/s]100%|██████████| 9/9 [00:01<00:00,  4.65it/s]
2025-03-13 11:16:35,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:35
2025-03-13 11:17:02,048 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7785 secs
2025-03-13 11:17:02,048 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 11:17:02,048 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 11:17:14,390 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3417 secs
2025-03-13 11:17:14,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0630 secs
2025-03-13 11:17:14,392 [INFO]: {
2025-03-13 11:17:14,392 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:14,392 [INFO]: 	index_param: efSearch=160
2025-03-13 11:17:14,392 [INFO]: 	index_path: knn.index
2025-03-13 11:17:14,392 [INFO]: 	size in bytes: 429492010
2025-03-13 11:17:14,392 [INFO]: 	avg_search_speed_ms: 10.495988608866632
2025-03-13 11:17:14,392 [INFO]: 	99p_search_speed_ms: 14.035430839285256
2025-03-13 11:17:14,392 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:14,392 [INFO]: 	nb vectors: 2183
2025-03-13 11:17:14,392 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:14,392 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 11:17:14,392 [INFO]: }
2025-03-13 11:17:14,392 [INFO]: 	>>> Finished "Creating the index" in 41.0652 secs
2025-03-13 11:17:14,392 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1011 secs
2025-03-13 11:17:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 81291 [episode count 13/20]
[retrieval_preprocessing] for episode 77258 [episode count 14/20], we have num_retrieval=np.int64(2161) num_query=np.int64(102)
2025-03-13 11:17:15,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:16,115 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:16
2025-03-13 11:17:16,115 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-13 11:17:16,144 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 11:17:16,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 11:17:16,144 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:16
2025-03-13 11:17:16,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:16,144 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:17:16,144 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:16,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:16,145 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:16
2025-03-13 11:17:16,145 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:16,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:17:16,145 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:16
2025-03-13 11:17:16,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:16,145 [INFO]: 	Creating the index 03/13/2025, 11:17:16
2025-03-13 11:17:16,145 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:16
2025-03-13 11:17:16,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:17:16,146 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:16
2025-03-13 11:17:16,146 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:17:16,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.08it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.43it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.98it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.25it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.27it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.23it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.22it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.33it/s]100%|██████████| 9/9 [00:02<00:00,  1.45it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]
2025-03-13 11:17:19,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:19
2025-03-13 11:17:47,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1491 secs
2025-03-13 11:17:47,240 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:17:47,240 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.47it/s]
2025-03-13 11:17:59,924 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6842 secs
2025-03-13 11:17:59,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7799 secs
2025-03-13 11:17:59,926 [INFO]: {
2025-03-13 11:17:59,926 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:59,926 [INFO]: 	index_param: efSearch=208
2025-03-13 11:17:59,926 [INFO]: 	index_path: knn.index
2025-03-13 11:17:59,926 [INFO]: 	size in bytes: 425163610
2025-03-13 11:17:59,927 [INFO]: 	avg_search_speed_ms: 11.34900526431877
2025-03-13 11:17:59,927 [INFO]: 	99p_search_speed_ms: 17.100143700372424
2025-03-13 11:17:59,927 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:59,927 [INFO]: 	nb vectors: 2161
2025-03-13 11:17:59,927 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:59,927 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 11:17:59,927 [INFO]: }
2025-03-13 11:17:59,927 [INFO]: 	>>> Finished "Creating the index" in 43.7817 secs
2025-03-13 11:17:59,927 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8120 secs
2025-03-13 11:18:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 77258 [episode count 14/20]
[retrieval_preprocessing] for episode 28990 [episode count 15/20], we have num_retrieval=np.int64(2173) num_query=np.int64(90)
2025-03-13 11:18:01,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:01,604 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:01
2025-03-13 11:18:01,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1136.67it/s]
2025-03-13 11:18:01,638 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 11:18:01,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 11:18:01,638 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,638 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:01,638 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:18:01,638 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:01,638 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:01,638 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,638 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:01,638 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:18:01,638 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:01
2025-03-13 11:18:01,639 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:01,639 [INFO]: 	Creating the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,639 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:01
2025-03-13 11:18:01,640 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:18:01,640 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:01
2025-03-13 11:18:01,640 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:18:01,640 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.12it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.40it/s]100%|██████████| 9/9 [00:01<00:00,  4.81it/s]
2025-03-13 11:18:03,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:03
2025-03-13 11:18:29,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2674 secs
2025-03-13 11:18:29,783 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 11:18:29,783 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.81it/s]
2025-03-13 11:18:42,928 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1447 secs
2025-03-13 11:18:42,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2896 secs
2025-03-13 11:18:42,930 [INFO]: {
2025-03-13 11:18:42,930 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:42,930 [INFO]: 	index_param: efSearch=163
2025-03-13 11:18:42,930 [INFO]: 	index_path: knn.index
2025-03-13 11:18:42,930 [INFO]: 	size in bytes: 427524550
2025-03-13 11:18:42,930 [INFO]: 	avg_search_speed_ms: 8.744171059403856
2025-03-13 11:18:42,930 [INFO]: 	99p_search_speed_ms: 14.035787999164313
2025-03-13 11:18:42,930 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:42,930 [INFO]: 	nb vectors: 2173
2025-03-13 11:18:42,930 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:42,930 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 11:18:42,930 [INFO]: }
2025-03-13 11:18:42,930 [INFO]: 	>>> Finished "Creating the index" in 41.2914 secs
2025-03-13 11:18:42,930 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3258 secs
2025-03-13 11:18:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 28990 [episode count 15/20]
[retrieval_preprocessing] for episode 72448 [episode count 16/20], we have num_retrieval=np.int64(2180) num_query=np.int64(83)
2025-03-13 11:18:43,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:44,291 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:44
2025-03-13 11:18:44,291 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.04it/s]
2025-03-13 11:18:44,336 [INFO]: There are 2180 embeddings of dim 49152
2025-03-13 11:18:44,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0452 secs
2025-03-13 11:18:44,337 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,337 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:44,337 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:18:44,337 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:44,337 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:18:44,337 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,337 [INFO]: 449.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:44,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:18:44,337 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:44
2025-03-13 11:18:44,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:44,337 [INFO]: 	Creating the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,337 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:44
2025-03-13 11:18:44,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:18:44,339 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:44
2025-03-13 11:18:44,339 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:18:44,339 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.14it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.72it/s]100%|██████████| 9/9 [00:02<00:00,  4.35it/s]
2025-03-13 11:18:46,411 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:46
2025-03-13 11:19:12,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7494 secs
2025-03-13 11:19:12,161 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 11:19:12,161 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.97it/s]
2025-03-13 11:19:25,219 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0576 secs
2025-03-13 11:19:25,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8814 secs
2025-03-13 11:19:25,221 [INFO]: {
2025-03-13 11:19:25,221 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:25,221 [INFO]: 	index_param: efSearch=159
2025-03-13 11:19:25,221 [INFO]: 	index_path: knn.index
2025-03-13 11:19:25,221 [INFO]: 	size in bytes: 428901790
2025-03-13 11:19:25,221 [INFO]: 	avg_search_speed_ms: 7.5029867242907144
2025-03-13 11:19:25,221 [INFO]: 	99p_search_speed_ms: 9.965034089982511
2025-03-13 11:19:25,221 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:25,221 [INFO]: 	nb vectors: 2180
2025-03-13 11:19:25,221 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:25,221 [INFO]: 	compression ratio: 0.9993090492814217
2025-03-13 11:19:25,221 [INFO]: }
2025-03-13 11:19:25,221 [INFO]: 	>>> Finished "Creating the index" in 40.8835 secs
2025-03-13 11:19:25,221 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9297 secs
2025-03-13 11:19:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 72448 [episode count 16/20]
[retrieval_preprocessing] for episode 95054 [episode count 17/20], we have num_retrieval=np.int64(2171) num_query=np.int64(92)
2025-03-13 11:19:25,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:26,274 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:26
2025-03-13 11:19:26,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2332.76it/s]
2025-03-13 11:19:26,300 [INFO]: There are 2171 embeddings of dim 49152
2025-03-13 11:19:26,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:19:26,300 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:26
2025-03-13 11:19:26,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:26,300 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:19:26,300 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:26,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:26,300 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:26
2025-03-13 11:19:26,300 [INFO]: 448.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:26,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:26,300 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:26
2025-03-13 11:19:26,300 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:26,300 [INFO]: 	Creating the index 03/13/2025, 11:19:26
2025-03-13 11:19:26,300 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:26
2025-03-13 11:19:26,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:26,301 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:26
2025-03-13 11:19:26,301 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:19:26,301 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.15it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.91it/s]100%|██████████| 9/9 [00:01<00:00,  5.25it/s]
2025-03-13 11:19:28,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:28
2025-03-13 11:19:54,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1774 secs
2025-03-13 11:19:54,198 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 11:19:54,198 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.53it/s]
2025-03-13 11:20:05,565 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3665 secs
2025-03-13 11:20:05,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2650 secs
2025-03-13 11:20:05,567 [INFO]: {
2025-03-13 11:20:05,567 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:05,567 [INFO]: 	index_param: efSearch=203
2025-03-13 11:20:05,567 [INFO]: 	index_path: knn.index
2025-03-13 11:20:05,567 [INFO]: 	size in bytes: 427131070
2025-03-13 11:20:05,567 [INFO]: 	avg_search_speed_ms: 9.732829626778264
2025-03-13 11:20:05,567 [INFO]: 	99p_search_speed_ms: 12.954202846158298
2025-03-13 11:20:05,567 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:05,567 [INFO]: 	nb vectors: 2171
2025-03-13 11:20:05,567 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:05,567 [INFO]: 	compression ratio: 0.9993091066870878
2025-03-13 11:20:05,567 [INFO]: }
2025-03-13 11:20:05,567 [INFO]: 	>>> Finished "Creating the index" in 39.2664 secs
2025-03-13 11:20:05,567 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2924 secs
2025-03-13 11:20:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 95054 [episode count 17/20]
[retrieval_preprocessing] for episode 69106 [episode count 18/20], we have num_retrieval=np.int64(2121) num_query=np.int64(142)
2025-03-13 11:20:06,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:06,754 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:06
2025-03-13 11:20:06,754 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2067.18it/s]
2025-03-13 11:20:06,787 [INFO]: There are 2121 embeddings of dim 49152
2025-03-13 11:20:06,787 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 11:20:06,787 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:06
2025-03-13 11:20:06,787 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:06,787 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:20:06,787 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:06,787 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:06,787 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:06
2025-03-13 11:20:06,787 [INFO]: 437.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:06,787 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:06,787 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:06
2025-03-13 11:20:06,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:06,788 [INFO]: 	Creating the index 03/13/2025, 11:20:06
2025-03-13 11:20:06,788 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:06
2025-03-13 11:20:06,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:20:06,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:06
2025-03-13 11:20:06,788 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:20:06,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.27it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.53it/s]100%|██████████| 9/9 [00:01<00:00,  5.06it/s]
2025-03-13 11:20:08,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:08
2025-03-13 11:20:33,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5510 secs
2025-03-13 11:20:33,122 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:20:33,122 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.11it/s]
2025-03-13 11:20:44,535 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4130 secs
2025-03-13 11:20:44,536 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.7478 secs
2025-03-13 11:20:44,536 [INFO]: {
2025-03-13 11:20:44,536 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:44,536 [INFO]: 	index_param: efSearch=215
2025-03-13 11:20:44,536 [INFO]: 	index_path: knn.index
2025-03-13 11:20:44,536 [INFO]: 	size in bytes: 417293830
2025-03-13 11:20:44,536 [INFO]: 	avg_search_speed_ms: 10.7315358240657
2025-03-13 11:20:44,536 [INFO]: 	99p_search_speed_ms: 18.33718253066741
2025-03-13 11:20:44,536 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:44,536 [INFO]: 	nb vectors: 2121
2025-03-13 11:20:44,536 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:44,536 [INFO]: 	compression ratio: 0.9993092109701215
2025-03-13 11:20:44,536 [INFO]: }
2025-03-13 11:20:44,537 [INFO]: 	>>> Finished "Creating the index" in 37.7490 secs
2025-03-13 11:20:44,537 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7826 secs
2025-03-13 11:20:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 69106 [episode count 18/20]
[retrieval_preprocessing] for episode 30482 [episode count 19/20], we have num_retrieval=np.int64(2109) num_query=np.int64(154)
2025-03-13 11:20:45,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:46,135 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:46
2025-03-13 11:20:46,135 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2013.59it/s]
2025-03-13 11:20:46,163 [INFO]: There are 2109 embeddings of dim 49152
2025-03-13 11:20:46,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:20:46,163 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:46
2025-03-13 11:20:46,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:46,163 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:20:46,163 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:46,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:20:46,163 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:46
2025-03-13 11:20:46,164 [INFO]: 435.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:46,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:20:46,164 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:46
2025-03-13 11:20:46,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:46,164 [INFO]: 	Creating the index 03/13/2025, 11:20:46
2025-03-13 11:20:46,164 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:46
2025-03-13 11:20:46,165 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:20:46,165 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:46
2025-03-13 11:20:46,165 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:20:46,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.84it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.50it/s]100%|██████████| 9/9 [00:01<00:00,  5.51it/s]
2025-03-13 11:20:47,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:47
2025-03-13 11:21:12,617 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8143 secs
2025-03-13 11:21:12,617 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:21:12,618 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 11:21:24,206 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5880 secs
2025-03-13 11:21:24,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0426 secs
2025-03-13 11:21:24,208 [INFO]: {
2025-03-13 11:21:24,208 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:24,208 [INFO]: 	index_param: efSearch=202
2025-03-13 11:21:24,208 [INFO]: 	index_path: knn.index
2025-03-13 11:21:24,208 [INFO]: 	size in bytes: 414932950
2025-03-13 11:21:24,208 [INFO]: 	avg_search_speed_ms: 9.928337911970713
2025-03-13 11:21:24,208 [INFO]: 	99p_search_speed_ms: 14.395569046027957
2025-03-13 11:21:24,208 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:24,208 [INFO]: 	nb vectors: 2109
2025-03-13 11:21:24,208 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:24,208 [INFO]: 	compression ratio: 0.9993090980121005
2025-03-13 11:21:24,208 [INFO]: }
2025-03-13 11:21:24,208 [INFO]: 	>>> Finished "Creating the index" in 38.0440 secs
2025-03-13 11:21:24,208 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0723 secs
2025-03-13 11:21:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 30482 [episode count 19/20]
2025-03-13 11:21:25: [retrieval_preprocessing] finished for 3163748394_put_orange_object_in_blue_cup [chosen_id count 1/260]
2025-03-13 11:21:27: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_objects_in_drawer_and_close [chosen_id count 2/260]
2025-03-13 11:21:27: [retrieval_preprocessing] we have num_total=7973 embedding_dim=49152
[retrieval_preprocessing] for episode 47659 [episode count 0/20], we have num_retrieval=np.int64(7591) num_query=np.int64(382)
2025-03-13 11:21:28,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:29,529 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:29
2025-03-13 11:21:29,529 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2121.55it/s]
2025-03-13 11:21:29,563 [INFO]: There are 7591 embeddings of dim 49152
2025-03-13 11:21:29,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 11:21:29,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:29
2025-03-13 11:21:29,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:29,564 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:21:29,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:29,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 11:21:29,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:29
2025-03-13 11:21:29,565 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:29,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:21:29,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:29
2025-03-13 11:21:29,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:29,566 [INFO]: 	Creating the index 03/13/2025, 11:21:29
2025-03-13 11:21:29,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:29
2025-03-13 11:21:29,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 11:21:29,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:29
2025-03-13 11:21:29,571 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:21:29,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.07it/s] 23%|██▎       | 7/31 [00:00<00:00, 34.29it/s] 42%|████▏     | 13/31 [00:00<00:00, 42.08it/s] 61%|██████▏   | 19/31 [00:00<00:00, 45.67it/s] 77%|███████▋  | 24/31 [00:04<00:02,  3.26it/s] 97%|█████████▋| 30/31 [00:04<00:00,  5.01it/s]100%|██████████| 31/31 [00:07<00:00,  4.09it/s]
2025-03-13 11:21:37,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:37
2025-03-13 11:22:46,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.2290 secs
2025-03-13 11:22:46,381 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 11:22:46,381 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.50it/s]
2025-03-13 11:22:59,930 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5484 secs
2025-03-13 11:22:59,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3612 secs
2025-03-13 11:22:59,932 [INFO]: {
2025-03-13 11:22:59,932 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:59,932 [INFO]: 	index_param: efSearch=156
2025-03-13 11:22:59,932 [INFO]: 	index_path: knn.index
2025-03-13 11:22:59,932 [INFO]: 	size in bytes: 1493484670
2025-03-13 11:22:59,932 [INFO]: 	avg_search_speed_ms: 9.574458188417426
2025-03-13 11:22:59,932 [INFO]: 	99p_search_speed_ms: 13.851242950186132
2025-03-13 11:22:59,932 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:59,932 [INFO]: 	nb vectors: 7591
2025-03-13 11:22:59,932 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:59,932 [INFO]: 	compression ratio: 0.9993081000289076
2025-03-13 11:22:59,932 [INFO]: }
2025-03-13 11:22:59,932 [INFO]: 	>>> Finished "Creating the index" in 90.3656 secs
2025-03-13 11:22:59,932 [INFO]: >>> Finished "Launching the whole pipeline" in 90.4027 secs
2025-03-13 11:23:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 47659 [episode count 0/20]
[retrieval_preprocessing] for episode 30804 [episode count 1/20], we have num_retrieval=np.int64(7631) num_query=np.int64(342)
2025-03-13 11:23:03,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:04,012 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:04
2025-03-13 11:23:04,012 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1307.45it/s]
2025-03-13 11:23:04,046 [INFO]: There are 7631 embeddings of dim 49152
2025-03-13 11:23:04,046 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 11:23:04,046 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:04
2025-03-13 11:23:04,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:04,046 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:23:04,046 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:04,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:04,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:04
2025-03-13 11:23:04,046 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:04,046 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:23:04,046 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:04
2025-03-13 11:23:04,046 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:04,046 [INFO]: 	Creating the index 03/13/2025, 11:23:04
2025-03-13 11:23:04,046 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:04
2025-03-13 11:23:04,047 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:23:04,047 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:04
2025-03-13 11:23:04,048 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:23:04,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.98it/s] 19%|█▉        | 6/32 [00:00<00:00, 32.76it/s] 34%|███▍      | 11/32 [00:00<00:00, 38.23it/s] 50%|█████     | 16/32 [00:00<00:00, 42.22it/s] 66%|██████▌   | 21/32 [00:05<00:04,  2.67it/s] 78%|███████▊  | 25/32 [00:05<00:01,  3.74it/s] 94%|█████████▍| 30/32 [00:05<00:00,  5.53it/s]100%|██████████| 32/32 [00:07<00:00,  4.07it/s]
2025-03-13 11:23:11,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:11
2025-03-13 11:24:16,765 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.8561 secs
2025-03-13 11:24:16,765 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 11:24:16,765 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-13 11:24:31,665 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8998 secs
2025-03-13 11:24:31,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.6190 secs
2025-03-13 11:24:31,667 [INFO]: {
2025-03-13 11:24:31,667 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:31,667 [INFO]: 	index_param: efSearch=145
2025-03-13 11:24:31,667 [INFO]: 	index_path: knn.index
2025-03-13 11:24:31,667 [INFO]: 	size in bytes: 1501354510
2025-03-13 11:24:31,667 [INFO]: 	avg_search_speed_ms: 9.664574265255084
2025-03-13 11:24:31,667 [INFO]: 	99p_search_speed_ms: 15.079163424670694
2025-03-13 11:24:31,667 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:31,667 [INFO]: 	nb vectors: 7631
2025-03-13 11:24:31,667 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:31,667 [INFO]: 	compression ratio: 0.9993080501686441
2025-03-13 11:24:31,667 [INFO]: }
2025-03-13 11:24:31,667 [INFO]: 	>>> Finished "Creating the index" in 87.6206 secs
2025-03-13 11:24:31,667 [INFO]: >>> Finished "Launching the whole pipeline" in 87.6549 secs
2025-03-13 11:24:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 30804 [episode count 1/20]
[retrieval_preprocessing] for episode 9328 [episode count 2/20], we have num_retrieval=np.int64(7696) num_query=np.int64(277)
2025-03-13 11:24:34,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:35,796 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:35
2025-03-13 11:24:35,796 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.87it/s]
2025-03-13 11:24:35,833 [INFO]: There are 7696 embeddings of dim 49152
2025-03-13 11:24:35,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-13 11:24:35,834 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:35
2025-03-13 11:24:35,834 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:35,834 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:24:35,834 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:35,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:24:35,834 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:35
2025-03-13 11:24:35,835 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:35,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:24:35,835 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:35
2025-03-13 11:24:35,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:35,835 [INFO]: 	Creating the index 03/13/2025, 11:24:35
2025-03-13 11:24:35,836 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:35
2025-03-13 11:24:35,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:24:35,839 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:35
2025-03-13 11:24:35,839 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:24:35,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  9.16it/s] 19%|█▉        | 6/32 [00:00<00:00, 31.16it/s] 34%|███▍      | 11/32 [00:00<00:00, 38.71it/s] 50%|█████     | 16/32 [00:00<00:00, 42.46it/s] 66%|██████▌   | 21/32 [00:04<00:03,  2.83it/s] 75%|███████▌  | 24/32 [00:05<00:02,  3.07it/s] 88%|████████▊ | 28/32 [00:05<00:00,  4.34it/s] 97%|█████████▋| 31/32 [00:05<00:00,  5.54it/s]100%|██████████| 32/32 [00:09<00:00,  3.54it/s]
2025-03-13 11:24:44,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:44
2025-03-13 11:25:43,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9964 secs
2025-03-13 11:25:43,879 [INFO]: The best hyperparameters are: efSearch=111
2025-03-13 11:25:43,879 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-13 11:25:58,910 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0312 secs
2025-03-13 11:25:58,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0739 secs
2025-03-13 11:25:58,913 [INFO]: {
2025-03-13 11:25:58,913 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:58,913 [INFO]: 	index_param: efSearch=111
2025-03-13 11:25:58,913 [INFO]: 	index_path: knn.index
2025-03-13 11:25:58,913 [INFO]: 	size in bytes: 1514142850
2025-03-13 11:25:58,913 [INFO]: 	avg_search_speed_ms: 8.490223761494564
2025-03-13 11:25:58,913 [INFO]: 	99p_search_speed_ms: 13.356154093053194
2025-03-13 11:25:58,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:58,913 [INFO]: 	nb vectors: 7696
2025-03-13 11:25:58,913 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:58,913 [INFO]: 	compression ratio: 0.9993080692485521
2025-03-13 11:25:58,913 [INFO]: }
2025-03-13 11:25:58,913 [INFO]: 	>>> Finished "Creating the index" in 83.0777 secs
2025-03-13 11:25:58,913 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1171 secs
2025-03-13 11:25:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 9328 [episode count 2/20]
[retrieval_preprocessing] for episode 38018 [episode count 3/20], we have num_retrieval=np.int64(7713) num_query=np.int64(260)
2025-03-13 11:26:01,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:02,158 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:02
2025-03-13 11:26:02,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2156.45it/s]
2025-03-13 11:26:02,194 [INFO]: There are 7713 embeddings of dim 49152
2025-03-13 11:26:02,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 11:26:02,195 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:02
2025-03-13 11:26:02,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:02,196 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:26:02,196 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:02,196 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:26:02,196 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:02
2025-03-13 11:26:02,196 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:02,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:26:02,197 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:02
2025-03-13 11:26:02,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:02,197 [INFO]: 	Creating the index 03/13/2025, 11:26:02
2025-03-13 11:26:02,197 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:02
2025-03-13 11:26:02,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:26:02,200 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:02
2025-03-13 11:26:02,200 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:26:02,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:00<00:01, 16.85it/s] 25%|██▌       | 8/32 [00:00<00:00, 37.34it/s] 44%|████▍     | 14/32 [00:00<00:00, 44.10it/s] 62%|██████▎   | 20/32 [00:00<00:00, 47.46it/s] 78%|███████▊  | 25/32 [00:04<00:02,  3.36it/s] 94%|█████████▍| 30/32 [00:04<00:00,  4.84it/s]100%|██████████| 32/32 [00:07<00:00,  4.25it/s]
2025-03-13 11:26:09,732 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:09
2025-03-13 11:27:07,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.1886 secs
2025-03-13 11:27:07,921 [INFO]: The best hyperparameters are: efSearch=171
2025-03-13 11:27:07,921 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.78it/s]
2025-03-13 11:27:25,335 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4141 secs
2025-03-13 11:27:25,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.1369 secs
2025-03-13 11:27:25,337 [INFO]: {
2025-03-13 11:27:25,337 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:25,337 [INFO]: 	index_param: efSearch=171
2025-03-13 11:27:25,337 [INFO]: 	index_path: knn.index
2025-03-13 11:27:25,337 [INFO]: 	size in bytes: 1517487550
2025-03-13 11:27:25,337 [INFO]: 	avg_search_speed_ms: 10.938969849867652
2025-03-13 11:27:25,338 [INFO]: 	99p_search_speed_ms: 16.530957252252847
2025-03-13 11:27:25,338 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:25,338 [INFO]: 	nb vectors: 7713
2025-03-13 11:27:25,338 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:25,338 [INFO]: 	compression ratio: 0.9993080364975647
2025-03-13 11:27:25,338 [INFO]: }
2025-03-13 11:27:25,338 [INFO]: 	>>> Finished "Creating the index" in 83.1407 secs
2025-03-13 11:27:25,338 [INFO]: >>> Finished "Launching the whole pipeline" in 83.1797 secs
2025-03-13 11:27:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 38018 [episode count 3/20]
[retrieval_preprocessing] for episode 53402 [episode count 4/20], we have num_retrieval=np.int64(7605) num_query=np.int64(368)
2025-03-13 11:27:28,558 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:29,887 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:29
2025-03-13 11:27:29,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1826.79it/s]
2025-03-13 11:27:29,925 [INFO]: There are 7605 embeddings of dim 49152
2025-03-13 11:27:29,925 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 11:27:29,925 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:29
2025-03-13 11:27:29,925 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:29,925 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:27:29,925 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:29,925 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:29,925 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:29
2025-03-13 11:27:29,926 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:29,926 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:27:29,926 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:29
2025-03-13 11:27:29,926 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:29,926 [INFO]: 	Creating the index 03/13/2025, 11:27:29
2025-03-13 11:27:29,926 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:29
2025-03-13 11:27:29,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:27:29,927 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:29
2025-03-13 11:27:29,927 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:27:29,927 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.51it/s] 19%|█▉        | 6/31 [00:00<00:00, 26.42it/s] 35%|███▌      | 11/31 [00:00<00:00, 34.69it/s] 52%|█████▏    | 16/31 [00:00<00:00, 39.06it/s] 68%|██████▊   | 21/31 [00:04<00:03,  2.79it/s] 81%|████████  | 25/31 [00:05<00:01,  3.90it/s] 97%|█████████▋| 30/31 [00:05<00:00,  5.75it/s]100%|██████████| 31/31 [00:07<00:00,  3.91it/s]
2025-03-13 11:27:37,851 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:37
2025-03-13 11:28:36,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7594 secs
2025-03-13 11:28:36,611 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 11:28:36,611 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.37it/s]
2025-03-13 11:28:51,651 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0401 secs
2025-03-13 11:28:51,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7261 secs
2025-03-13 11:28:51,653 [INFO]: {
2025-03-13 11:28:51,653 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:51,653 [INFO]: 	index_param: efSearch=166
2025-03-13 11:28:51,653 [INFO]: 	index_path: knn.index
2025-03-13 11:28:51,653 [INFO]: 	size in bytes: 1496239090
2025-03-13 11:28:51,653 [INFO]: 	avg_search_speed_ms: 9.834542605410547
2025-03-13 11:28:51,653 [INFO]: 	99p_search_speed_ms: 15.003206552937637
2025-03-13 11:28:51,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:51,653 [INFO]: 	nb vectors: 7605
2025-03-13 11:28:51,653 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:51,653 [INFO]: 	compression ratio: 0.9993080985472717
2025-03-13 11:28:51,653 [INFO]: }
2025-03-13 11:28:51,653 [INFO]: 	>>> Finished "Creating the index" in 81.7277 secs
2025-03-13 11:28:51,654 [INFO]: >>> Finished "Launching the whole pipeline" in 81.7667 secs
2025-03-13 11:28:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 53402 [episode count 4/20]
[retrieval_preprocessing] for episode 47755 [episode count 5/20], we have num_retrieval=np.int64(7486) num_query=np.int64(487)
2025-03-13 11:28:54,736 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:55,761 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:55
2025-03-13 11:28:55,761 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.54it/s]
2025-03-13 11:28:55,799 [INFO]: There are 7486 embeddings of dim 49152
2025-03-13 11:28:55,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 11:28:55,799 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:55
2025-03-13 11:28:55,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:55,800 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:28:55,800 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:55,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:28:55,800 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:55
2025-03-13 11:28:55,800 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:55,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:28:55,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:55
2025-03-13 11:28:55,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:55,801 [INFO]: 	Creating the index 03/13/2025, 11:28:55
2025-03-13 11:28:55,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:55
2025-03-13 11:28:55,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 11:28:55,804 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:55
2025-03-13 11:28:55,805 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:28:55,805 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  6%|▋         | 2/31 [00:00<00:01, 16.61it/s] 23%|██▎       | 7/31 [00:00<00:00, 33.47it/s] 39%|███▊      | 12/31 [00:00<00:00, 39.54it/s] 55%|█████▍    | 17/31 [00:00<00:00, 42.65it/s] 71%|███████   | 22/31 [00:04<00:03,  2.95it/s] 90%|█████████ | 28/31 [00:04<00:00,  4.70it/s]100%|██████████| 31/31 [00:07<00:00,  4.17it/s]
2025-03-13 11:29:03,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:03
2025-03-13 11:30:02,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5002 secs
2025-03-13 11:30:02,750 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 11:30:02,750 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.84it/s]
2025-03-13 11:30:17,583 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8330 secs
2025-03-13 11:30:17,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7801 secs
2025-03-13 11:30:17,585 [INFO]: {
2025-03-13 11:30:17,585 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:17,585 [INFO]: 	index_param: efSearch=164
2025-03-13 11:30:17,585 [INFO]: 	index_path: knn.index
2025-03-13 11:30:17,585 [INFO]: 	size in bytes: 1472826490
2025-03-13 11:30:17,585 [INFO]: 	avg_search_speed_ms: 10.186981338421509
2025-03-13 11:30:17,585 [INFO]: 	99p_search_speed_ms: 14.699576846323898
2025-03-13 11:30:17,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:17,585 [INFO]: 	nb vectors: 7486
2025-03-13 11:30:17,585 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:17,585 [INFO]: 	compression ratio: 0.9993081316727268
2025-03-13 11:30:17,585 [INFO]: }
2025-03-13 11:30:17,585 [INFO]: 	>>> Finished "Creating the index" in 81.7839 secs
2025-03-13 11:30:17,585 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8241 secs
2025-03-13 11:30:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 47755 [episode count 5/20]
[retrieval_preprocessing] for episode 86727 [episode count 6/20], we have num_retrieval=np.int64(7574) num_query=np.int64(399)
2025-03-13 11:30:21,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:22,656 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:22
2025-03-13 11:30:22,657 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.98it/s]
2025-03-13 11:30:22,695 [INFO]: There are 7574 embeddings of dim 49152
2025-03-13 11:30:22,695 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0389 secs
2025-03-13 11:30:22,696 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:22
2025-03-13 11:30:22,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:22,696 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:30:22,696 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:22,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:30:22,697 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:22
2025-03-13 11:30:22,697 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:22,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:30:22,697 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:22
2025-03-13 11:30:22,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:22,698 [INFO]: 	Creating the index 03/13/2025, 11:30:22
2025-03-13 11:30:22,698 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:22
2025-03-13 11:30:22,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:30:22,701 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:22
2025-03-13 11:30:22,702 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:30:22,702 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.61it/s] 23%|██▎       | 7/31 [00:00<00:00, 34.81it/s] 42%|████▏     | 13/31 [00:00<00:00, 43.00it/s] 58%|█████▊    | 18/31 [00:00<00:00, 45.37it/s] 74%|███████▍  | 23/31 [00:05<00:02,  2.79it/s] 94%|█████████▎| 29/31 [00:05<00:00,  4.40it/s]100%|██████████| 31/31 [00:08<00:00,  3.68it/s]
2025-03-13 11:30:31,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:31
2025-03-13 11:31:30,850 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5340 secs
2025-03-13 11:31:30,850 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 11:31:30,850 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-13 11:31:48,752 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9020 secs
2025-03-13 11:31:48,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.0529 secs
2025-03-13 11:31:48,755 [INFO]: {
2025-03-13 11:31:48,755 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:48,755 [INFO]: 	index_param: efSearch=163
2025-03-13 11:31:48,755 [INFO]: 	index_path: knn.index
2025-03-13 11:31:48,755 [INFO]: 	size in bytes: 1490140030
2025-03-13 11:31:48,755 [INFO]: 	avg_search_speed_ms: 10.704210984053956
2025-03-13 11:31:48,755 [INFO]: 	99p_search_speed_ms: 16.285169087350365
2025-03-13 11:31:48,755 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:48,755 [INFO]: 	nb vectors: 7574
2025-03-13 11:31:48,755 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:48,755 [INFO]: 	compression ratio: 0.9993080932132264
2025-03-13 11:31:48,755 [INFO]: }
2025-03-13 11:31:48,755 [INFO]: 	>>> Finished "Creating the index" in 86.0568 secs
2025-03-13 11:31:48,755 [INFO]: >>> Finished "Launching the whole pipeline" in 86.0982 secs
2025-03-13 11:31:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 86727 [episode count 6/20]
[retrieval_preprocessing] for episode 2785 [episode count 7/20], we have num_retrieval=np.int64(7545) num_query=np.int64(428)
2025-03-13 11:31:52,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:53,524 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:53
2025-03-13 11:31:53,524 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1324.80it/s]
2025-03-13 11:31:53,564 [INFO]: There are 7545 embeddings of dim 49152
2025-03-13 11:31:53,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-13 11:31:53,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:53
2025-03-13 11:31:53,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:53,565 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:31:53,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:53,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:31:53,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:53
2025-03-13 11:31:53,566 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:53,567 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:31:53,567 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:53
2025-03-13 11:31:53,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:53,567 [INFO]: 	Creating the index 03/13/2025, 11:31:53
2025-03-13 11:31:53,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:53
2025-03-13 11:31:53,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 11:31:53,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:53
2025-03-13 11:31:53,571 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:31:53,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.94it/s] 19%|█▉        | 6/31 [00:00<00:00, 31.70it/s] 35%|███▌      | 11/31 [00:00<00:00, 39.41it/s] 52%|█████▏    | 16/31 [00:00<00:00, 43.12it/s] 68%|██████▊   | 21/31 [00:05<00:03,  2.65it/s] 84%|████████▍ | 26/31 [00:05<00:01,  3.98it/s]100%|██████████| 31/31 [00:07<00:00,  2.84it/s]100%|██████████| 31/31 [00:07<00:00,  3.89it/s]
2025-03-13 11:32:01,555 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:01
2025-03-13 11:33:01,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6689 secs
2025-03-13 11:33:01,225 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 11:33:01,225 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.43it/s]
2025-03-13 11:33:20,292 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0675 secs
2025-03-13 11:33:20,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7233 secs
2025-03-13 11:33:20,295 [INFO]: {
2025-03-13 11:33:20,295 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:20,295 [INFO]: 	index_param: efSearch=188
2025-03-13 11:33:20,295 [INFO]: 	index_path: knn.index
2025-03-13 11:33:20,295 [INFO]: 	size in bytes: 1484434510
2025-03-13 11:33:20,295 [INFO]: 	avg_search_speed_ms: 11.429715779476933
2025-03-13 11:33:20,295 [INFO]: 	99p_search_speed_ms: 18.722323435358703
2025-03-13 11:33:20,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:20,295 [INFO]: 	nb vectors: 7545
2025-03-13 11:33:20,295 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:20,295 [INFO]: 	compression ratio: 0.9993080530039685
2025-03-13 11:33:20,295 [INFO]: }
2025-03-13 11:33:20,295 [INFO]: 	>>> Finished "Creating the index" in 86.7276 secs
2025-03-13 11:33:20,295 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7708 secs
2025-03-13 11:33:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 2785 [episode count 7/20]
[retrieval_preprocessing] for episode 1256 [episode count 8/20], we have num_retrieval=np.int64(7450) num_query=np.int64(523)
2025-03-13 11:33:24,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:25,449 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:25
2025-03-13 11:33:25,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1285.81it/s]
2025-03-13 11:33:25,483 [INFO]: There are 7450 embeddings of dim 49152
2025-03-13 11:33:25,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 11:33:25,484 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:25,484 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:33:25,484 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:25,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:25,484 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,484 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:25,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:33:25,484 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:25
2025-03-13 11:33:25,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:25,484 [INFO]: 	Creating the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,484 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:25
2025-03-13 11:33:25,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:33:25,485 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:25
2025-03-13 11:33:25,485 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:33:25,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.70it/s] 19%|█▉        | 6/31 [00:00<00:00, 31.51it/s] 39%|███▊      | 12/31 [00:00<00:00, 42.00it/s] 58%|█████▊    | 18/31 [00:00<00:00, 46.82it/s] 74%|███████▍  | 23/31 [00:05<00:02,  2.68it/s] 87%|████████▋ | 27/31 [00:05<00:01,  3.39it/s] 97%|█████████▋| 30/31 [00:06<00:00,  4.03it/s]100%|██████████| 31/31 [00:09<00:00,  3.35it/s]
2025-03-13 11:33:34,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:34
2025-03-13 11:34:42,679 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 67.9343 secs
2025-03-13 11:34:42,679 [INFO]: The best hyperparameters are: efSearch=130
2025-03-13 11:34:42,679 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.84it/s]
2025-03-13 11:34:59,187 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5078 secs
2025-03-13 11:34:59,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.7040 secs
2025-03-13 11:34:59,189 [INFO]: {
2025-03-13 11:34:59,189 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:59,189 [INFO]: 	index_param: efSearch=130
2025-03-13 11:34:59,189 [INFO]: 	index_path: knn.index
2025-03-13 11:34:59,189 [INFO]: 	size in bytes: 1465743790
2025-03-13 11:34:59,189 [INFO]: 	avg_search_speed_ms: 9.38890520264635
2025-03-13 11:34:59,189 [INFO]: 	99p_search_speed_ms: 14.094012482091781
2025-03-13 11:34:59,189 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:59,189 [INFO]: 	nb vectors: 7450
2025-03-13 11:34:59,189 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:59,189 [INFO]: 	compression ratio: 0.999308071433139
2025-03-13 11:34:59,189 [INFO]: }
2025-03-13 11:34:59,189 [INFO]: 	>>> Finished "Creating the index" in 93.7053 secs
2025-03-13 11:34:59,189 [INFO]: >>> Finished "Launching the whole pipeline" in 93.7397 secs
2025-03-13 11:35:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 1256 [episode count 8/20]
[retrieval_preprocessing] for episode 23362 [episode count 9/20], we have num_retrieval=np.int64(7632) num_query=np.int64(341)
2025-03-13 11:35:02,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:04,041 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:04
2025-03-13 11:35:04,041 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.82it/s]
2025-03-13 11:35:04,074 [INFO]: There are 7632 embeddings of dim 49152
2025-03-13 11:35:04,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-13 11:35:04,075 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:04
2025-03-13 11:35:04,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:04,075 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:35:04,075 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:04,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:04,075 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:04
2025-03-13 11:35:04,075 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:04,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 11:35:04,075 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:04
2025-03-13 11:35:04,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:04,075 [INFO]: 	Creating the index 03/13/2025, 11:35:04
2025-03-13 11:35:04,075 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:04
2025-03-13 11:35:04,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:35:04,076 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:04
2025-03-13 11:35:04,076 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:35:04,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:04,  7.19it/s] 22%|██▏       | 7/32 [00:00<00:00, 31.31it/s] 41%|████      | 13/32 [00:00<00:00, 41.29it/s] 59%|█████▉    | 19/32 [00:00<00:00, 46.59it/s] 75%|███████▌  | 24/32 [00:04<00:02,  3.21it/s] 91%|█████████ | 29/32 [00:04<00:00,  4.65it/s]100%|██████████| 32/32 [00:07<00:00,  4.16it/s]
2025-03-13 11:35:11,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:11
2025-03-13 11:36:13,803 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.0245 secs
2025-03-13 11:36:13,803 [INFO]: The best hyperparameters are: efSearch=134
2025-03-13 11:36:13,803 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-13 11:36:31,715 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9118 secs
2025-03-13 11:36:31,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.6407 secs
2025-03-13 11:36:31,717 [INFO]: {
2025-03-13 11:36:31,717 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:31,717 [INFO]: 	index_param: efSearch=134
2025-03-13 11:36:31,717 [INFO]: 	index_path: knn.index
2025-03-13 11:36:31,717 [INFO]: 	size in bytes: 1501551250
2025-03-13 11:36:31,717 [INFO]: 	avg_search_speed_ms: 8.984836936959292
2025-03-13 11:36:31,718 [INFO]: 	99p_search_speed_ms: 15.236304206773614
2025-03-13 11:36:31,718 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:31,718 [INFO]: 	nb vectors: 7632
2025-03-13 11:36:31,718 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:31,718 [INFO]: 	compression ratio: 0.9993080529219366
2025-03-13 11:36:31,718 [INFO]: }
2025-03-13 11:36:31,718 [INFO]: 	>>> Finished "Creating the index" in 87.6425 secs
2025-03-13 11:36:31,718 [INFO]: >>> Finished "Launching the whole pipeline" in 87.6763 secs
2025-03-13 11:36:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 23362 [episode count 9/20]
[retrieval_preprocessing] for episode 43878 [episode count 10/20], we have num_retrieval=np.int64(7601) num_query=np.int64(372)
2025-03-13 11:36:34,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:35,622 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:35
2025-03-13 11:36:35,623 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-13 11:36:35,656 [INFO]: There are 7601 embeddings of dim 49152
2025-03-13 11:36:35,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 11:36:35,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:35
2025-03-13 11:36:35,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:35,657 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:36:35,657 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:35,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:36:35,657 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:35
2025-03-13 11:36:35,657 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:35,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:36:35,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:35
2025-03-13 11:36:35,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:35,657 [INFO]: 	Creating the index 03/13/2025, 11:36:35
2025-03-13 11:36:35,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:35
2025-03-13 11:36:35,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:36:35,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:35
2025-03-13 11:36:35,658 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:36:35,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  7.97it/s] 23%|██▎       | 7/31 [00:00<00:00, 32.83it/s] 42%|████▏     | 13/31 [00:00<00:00, 41.82it/s] 61%|██████▏   | 19/31 [00:00<00:00, 46.18it/s] 77%|███████▋  | 24/31 [00:04<00:02,  3.23it/s] 90%|█████████ | 28/31 [00:04<00:00,  4.22it/s]100%|██████████| 31/31 [00:07<00:00,  2.69it/s]100%|██████████| 31/31 [00:07<00:00,  4.20it/s]
2025-03-13 11:36:43,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:43
2025-03-13 11:37:37,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7738 secs
2025-03-13 11:37:37,823 [INFO]: The best hyperparameters are: efSearch=125
2025-03-13 11:37:37,823 [INFO]: 	Compute fast metrics 03/13/2025, 11:37:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 11:37:53,619 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7952 secs
2025-03-13 11:37:53,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9624 secs
2025-03-13 11:37:53,621 [INFO]: {
2025-03-13 11:37:53,621 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:53,621 [INFO]: 	index_param: efSearch=125
2025-03-13 11:37:53,621 [INFO]: 	index_path: knn.index
2025-03-13 11:37:53,621 [INFO]: 	size in bytes: 1495452130
2025-03-13 11:37:53,621 [INFO]: 	avg_search_speed_ms: 8.558399768759735
2025-03-13 11:37:53,621 [INFO]: 	99p_search_speed_ms: 13.460638243705032
2025-03-13 11:37:53,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:53,621 [INFO]: 	nb vectors: 7601
2025-03-13 11:37:53,621 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:53,621 [INFO]: 	compression ratio: 0.9993080875146435
2025-03-13 11:37:53,621 [INFO]: }
2025-03-13 11:37:53,621 [INFO]: 	>>> Finished "Creating the index" in 77.9639 secs
2025-03-13 11:37:53,621 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9983 secs
2025-03-13 11:37:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 43878 [episode count 10/20]
[retrieval_preprocessing] for episode 392 [episode count 11/20], we have num_retrieval=np.int64(7437) num_query=np.int64(536)
2025-03-13 11:37:56,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:57,537 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:57
2025-03-13 11:37:57,538 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-13 11:37:57,571 [INFO]: There are 7437 embeddings of dim 49152
2025-03-13 11:37:57,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 11:37:57,572 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:57
2025-03-13 11:37:57,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:57,572 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:37:57,572 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:57,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:57,572 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:57
2025-03-13 11:37:57,572 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:57,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:57,572 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:57
2025-03-13 11:37:57,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:57,572 [INFO]: 	Creating the index 03/13/2025, 11:37:57
2025-03-13 11:37:57,572 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:57
2025-03-13 11:37:57,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:37:57,573 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:57
2025-03-13 11:37:57,573 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:37:57,573 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.74it/s] 19%|█▉        | 6/31 [00:00<00:00, 26.07it/s] 35%|███▌      | 11/31 [00:00<00:00, 34.89it/s] 52%|█████▏    | 16/31 [00:00<00:00, 39.58it/s] 68%|██████▊   | 21/31 [00:04<00:03,  2.89it/s] 84%|████████▍ | 26/31 [00:04<00:01,  4.34it/s]100%|██████████| 31/31 [00:07<00:00,  3.06it/s]100%|██████████| 31/31 [00:07<00:00,  4.17it/s]
2025-03-13 11:38:05,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:05
2025-03-13 11:39:03,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4601 secs
2025-03-13 11:39:03,469 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 11:39:03,469 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 11:39:21,214 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7450 secs
2025-03-13 11:39:21,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6423 secs
2025-03-13 11:39:21,216 [INFO]: {
2025-03-13 11:39:21,216 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:21,216 [INFO]: 	index_param: efSearch=158
2025-03-13 11:39:21,216 [INFO]: 	index_path: knn.index
2025-03-13 11:39:21,216 [INFO]: 	size in bytes: 1463186050
2025-03-13 11:39:21,216 [INFO]: 	avg_search_speed_ms: 9.877345852024288
2025-03-13 11:39:21,216 [INFO]: 	99p_search_speed_ms: 14.591597327962516
2025-03-13 11:39:21,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:21,216 [INFO]: 	nb vectors: 7437
2025-03-13 11:39:21,216 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:21,216 [INFO]: 	compression ratio: 0.999308116695071
2025-03-13 11:39:21,216 [INFO]: }
2025-03-13 11:39:21,216 [INFO]: 	>>> Finished "Creating the index" in 83.6437 secs
2025-03-13 11:39:21,216 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6783 secs
2025-03-13 11:39:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 392 [episode count 11/20]
[retrieval_preprocessing] for episode 56716 [episode count 12/20], we have num_retrieval=np.int64(7541) num_query=np.int64(432)
2025-03-13 11:39:25,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:26,667 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:26
2025-03-13 11:39:26,668 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1421.32it/s]
2025-03-13 11:39:26,703 [INFO]: There are 7541 embeddings of dim 49152
2025-03-13 11:39:26,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-13 11:39:26,704 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:26
2025-03-13 11:39:26,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:26,704 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:39:26,704 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:26,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:39:26,704 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:26
2025-03-13 11:39:26,704 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:26,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:39:26,704 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:26
2025-03-13 11:39:26,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:26,704 [INFO]: 	Creating the index 03/13/2025, 11:39:26
2025-03-13 11:39:26,704 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:26
2025-03-13 11:39:26,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:39:26,705 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:26
2025-03-13 11:39:26,705 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:39:26,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  7.04it/s] 19%|█▉        | 6/31 [00:00<00:00, 28.01it/s] 35%|███▌      | 11/31 [00:00<00:00, 36.93it/s] 52%|█████▏    | 16/31 [00:00<00:00, 40.06it/s] 68%|██████▊   | 21/31 [00:05<00:03,  2.70it/s] 84%|████████▍ | 26/31 [00:05<00:01,  4.07it/s]100%|██████████| 31/31 [00:07<00:00,  3.00it/s]100%|██████████| 31/31 [00:07<00:00,  4.04it/s]
2025-03-13 11:39:34,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:34
2025-03-13 11:40:33,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5126 secs
2025-03-13 11:40:33,895 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 11:40:33,895 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 11:40:57,287 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3924 secs
2025-03-13 11:40:57,289 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.5844 secs
2025-03-13 11:40:57,290 [INFO]: {
2025-03-13 11:40:57,290 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:57,290 [INFO]: 	index_param: efSearch=132
2025-03-13 11:40:57,290 [INFO]: 	index_path: knn.index
2025-03-13 11:40:57,290 [INFO]: 	size in bytes: 1483647430
2025-03-13 11:40:57,290 [INFO]: 	avg_search_speed_ms: 8.770909836605648
2025-03-13 11:40:57,290 [INFO]: 	99p_search_speed_ms: 12.886510638054459
2025-03-13 11:40:57,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:57,290 [INFO]: 	nb vectors: 7541
2025-03-13 11:40:57,290 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:57,290 [INFO]: 	compression ratio: 0.9993081226851854
2025-03-13 11:40:57,290 [INFO]: }
2025-03-13 11:40:57,290 [INFO]: 	>>> Finished "Creating the index" in 90.5858 secs
2025-03-13 11:40:57,290 [INFO]: >>> Finished "Launching the whole pipeline" in 90.6223 secs
2025-03-13 11:40:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 56716 [episode count 12/20]
[retrieval_preprocessing] for episode 83874 [episode count 13/20], we have num_retrieval=np.int64(7520) num_query=np.int64(453)
2025-03-13 11:41:01,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:02,316 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:02
2025-03-13 11:41:02,316 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.96it/s]
2025-03-13 11:41:02,353 [INFO]: There are 7520 embeddings of dim 49152
2025-03-13 11:41:02,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 11:41:02,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:02
2025-03-13 11:41:02,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:02,354 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:41:02,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:02,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:41:02,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:02
2025-03-13 11:41:02,354 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:02,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:41:02,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:02
2025-03-13 11:41:02,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:41:02,354 [INFO]: 	Creating the index 03/13/2025, 11:41:02
2025-03-13 11:41:02,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:02
2025-03-13 11:41:02,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:41:02,355 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:02
2025-03-13 11:41:02,355 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:41:02,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.60it/s] 19%|█▉        | 6/31 [00:00<00:00, 26.55it/s] 35%|███▌      | 11/31 [00:00<00:00, 35.22it/s] 52%|█████▏    | 16/31 [00:00<00:00, 39.73it/s] 68%|██████▊   | 21/31 [00:05<00:03,  2.57it/s] 81%|████████  | 25/31 [00:05<00:01,  3.60it/s] 97%|█████████▋| 30/31 [00:05<00:00,  5.34it/s]100%|██████████| 31/31 [00:07<00:00,  3.91it/s]
2025-03-13 11:41:10,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:10
2025-03-13 11:42:10,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0669 secs
2025-03-13 11:42:10,347 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 11:42:10,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.69it/s]
2025-03-13 11:42:29,891 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5446 secs
2025-03-13 11:42:29,893 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.5381 secs
2025-03-13 11:42:29,894 [INFO]: {
2025-03-13 11:42:29,894 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:29,894 [INFO]: 	index_param: efSearch=170
2025-03-13 11:42:29,894 [INFO]: 	index_path: knn.index
2025-03-13 11:42:29,894 [INFO]: 	size in bytes: 1479515770
2025-03-13 11:42:29,894 [INFO]: 	avg_search_speed_ms: 10.459391619410038
2025-03-13 11:42:29,894 [INFO]: 	99p_search_speed_ms: 14.980672125238927
2025-03-13 11:42:29,894 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:29,894 [INFO]: 	nb vectors: 7520
2025-03-13 11:42:29,894 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:29,894 [INFO]: 	compression ratio: 0.9993081452589045
2025-03-13 11:42:29,894 [INFO]: }
2025-03-13 11:42:29,894 [INFO]: 	>>> Finished "Creating the index" in 87.5397 secs
2025-03-13 11:42:29,894 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5777 secs
2025-03-13 11:42:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 83874 [episode count 13/20]
[retrieval_preprocessing] for episode 32167 [episode count 14/20], we have num_retrieval=np.int64(7535) num_query=np.int64(438)
2025-03-13 11:42:34,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:35,504 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:35
2025-03-13 11:42:35,504 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1280.70it/s]
2025-03-13 11:42:35,539 [INFO]: There are 7535 embeddings of dim 49152
2025-03-13 11:42:35,539 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-13 11:42:35,539 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:35
2025-03-13 11:42:35,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:35,539 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:42:35,539 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:35,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:35,539 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:35
2025-03-13 11:42:35,539 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:35,539 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:42:35,539 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:35
2025-03-13 11:42:35,539 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:35,540 [INFO]: 	Creating the index 03/13/2025, 11:42:35
2025-03-13 11:42:35,540 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:35
2025-03-13 11:42:35,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:42:35,541 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:35
2025-03-13 11:42:35,541 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:42:35,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.09it/s] 13%|█▎        | 4/31 [00:00<00:01, 20.87it/s] 32%|███▏      | 10/31 [00:00<00:00, 35.63it/s] 48%|████▊     | 15/31 [00:00<00:00, 40.65it/s] 65%|██████▍   | 20/31 [00:00<00:00, 43.58it/s] 81%|████████  | 25/31 [00:05<00:02,  2.90it/s] 97%|█████████▋| 30/31 [00:05<00:00,  4.24it/s]100%|██████████| 31/31 [00:08<00:00,  3.85it/s]
2025-03-13 11:42:43,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:43
2025-03-13 11:43:41,576 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9880 secs
2025-03-13 11:43:41,576 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 11:43:41,576 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.63it/s]
2025-03-13 11:43:58,554 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9774 secs
2025-03-13 11:43:58,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0147 secs
2025-03-13 11:43:58,556 [INFO]: {
2025-03-13 11:43:58,556 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:58,556 [INFO]: 	index_param: efSearch=151
2025-03-13 11:43:58,556 [INFO]: 	index_path: knn.index
2025-03-13 11:43:58,556 [INFO]: 	size in bytes: 1482466930
2025-03-13 11:43:58,556 [INFO]: 	avg_search_speed_ms: 9.440471217910407
2025-03-13 11:43:58,556 [INFO]: 	99p_search_speed_ms: 14.179587615653876
2025-03-13 11:43:58,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:58,556 [INFO]: 	nb vectors: 7535
2025-03-13 11:43:58,556 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:58,556 [INFO]: 	compression ratio: 0.999308146455584
2025-03-13 11:43:58,556 [INFO]: }
2025-03-13 11:43:58,556 [INFO]: 	>>> Finished "Creating the index" in 83.0162 secs
2025-03-13 11:43:58,556 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0516 secs
2025-03-13 11:44:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 32167 [episode count 14/20]
[retrieval_preprocessing] for episode 60881 [episode count 15/20], we have num_retrieval=np.int64(7623) num_query=np.int64(350)
2025-03-13 11:44:02,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:03,441 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:03
2025-03-13 11:44:03,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 803.66it/s]
2025-03-13 11:44:03,499 [INFO]: There are 7623 embeddings of dim 49152
2025-03-13 11:44:03,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0580 secs
2025-03-13 11:44:03,499 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:03
2025-03-13 11:44:03,500 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:03,500 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:44:03,500 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:03,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:44:03,500 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:03
2025-03-13 11:44:03,501 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:03,501 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:44:03,501 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:03
2025-03-13 11:44:03,501 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:03,501 [INFO]: 	Creating the index 03/13/2025, 11:44:03
2025-03-13 11:44:03,502 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:03
2025-03-13 11:44:03,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 11:44:03,506 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:03
2025-03-13 11:44:03,507 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:44:03,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  7.20it/s] 16%|█▌        | 5/31 [00:00<00:01, 23.76it/s] 32%|███▏      | 10/31 [00:00<00:00, 32.48it/s] 48%|████▊     | 15/31 [00:00<00:00, 36.45it/s] 65%|██████▍   | 20/31 [00:00<00:00, 33.20it/s] 77%|███████▋  | 24/31 [00:05<00:02,  2.71it/s] 94%|█████████▎| 29/31 [00:05<00:00,  4.10it/s]100%|██████████| 31/31 [00:08<00:00,  3.85it/s]
2025-03-13 11:44:11,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:11
2025-03-13 11:45:11,635 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.0595 secs
2025-03-13 11:45:11,636 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 11:45:11,636 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-13 11:45:30,973 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3370 secs
2025-03-13 11:45:30,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4680 secs
2025-03-13 11:45:30,975 [INFO]: {
2025-03-13 11:45:30,975 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:30,975 [INFO]: 	index_param: efSearch=167
2025-03-13 11:45:30,975 [INFO]: 	index_path: knn.index
2025-03-13 11:45:30,975 [INFO]: 	size in bytes: 1499780530
2025-03-13 11:45:30,975 [INFO]: 	avg_search_speed_ms: 14.271743403954934
2025-03-13 11:45:30,975 [INFO]: 	99p_search_speed_ms: 29.455637093633413
2025-03-13 11:45:30,975 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:30,975 [INFO]: 	nb vectors: 7623
2025-03-13 11:45:30,975 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:30,975 [INFO]: 	compression ratio: 0.9993080680944698
2025-03-13 11:45:30,975 [INFO]: }
2025-03-13 11:45:30,975 [INFO]: 	>>> Finished "Creating the index" in 87.4736 secs
2025-03-13 11:45:30,975 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5342 secs
2025-03-13 11:45:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 60881 [episode count 15/20]
[retrieval_preprocessing] for episode 37342 [episode count 16/20], we have num_retrieval=np.int64(7437) num_query=np.int64(536)
2025-03-13 11:45:34,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:35,217 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:35
2025-03-13 11:45:35,217 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.88it/s]
2025-03-13 11:45:35,252 [INFO]: There are 7437 embeddings of dim 49152
2025-03-13 11:45:35,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-13 11:45:35,252 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:35
2025-03-13 11:45:35,253 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:35,253 [INFO]: 		-> Add: 4.1 seconds
2025-03-13 11:45:35,253 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:35,253 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:35,253 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:35
2025-03-13 11:45:35,253 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:35,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:45:35,253 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:35
2025-03-13 11:45:35,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:35,253 [INFO]: 	Creating the index 03/13/2025, 11:45:35
2025-03-13 11:45:35,253 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:35
2025-03-13 11:45:35,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:45:35,254 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:35
2025-03-13 11:45:35,254 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:45:35,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.18it/s] 19%|█▉        | 6/31 [00:00<00:00, 25.66it/s] 35%|███▌      | 11/31 [00:00<00:00, 34.41it/s] 52%|█████▏    | 16/31 [00:00<00:00, 39.39it/s] 68%|██████▊   | 21/31 [00:04<00:03,  2.74it/s] 81%|████████  | 25/31 [00:05<00:01,  3.83it/s] 97%|█████████▋| 30/31 [00:05<00:00,  5.64it/s]100%|██████████| 31/31 [00:08<00:00,  3.68it/s]
2025-03-13 11:45:43,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:43
2025-03-13 11:46:42,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2741 secs
2025-03-13 11:46:42,949 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 11:46:42,949 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.13it/s]
2025-03-13 11:47:06,900 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9506 secs
2025-03-13 11:47:06,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.6477 secs
2025-03-13 11:47:06,902 [INFO]: {
2025-03-13 11:47:06,902 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:06,902 [INFO]: 	index_param: efSearch=165
2025-03-13 11:47:06,902 [INFO]: 	index_path: knn.index
2025-03-13 11:47:06,902 [INFO]: 	size in bytes: 1463186050
2025-03-13 11:47:06,902 [INFO]: 	avg_search_speed_ms: 11.130982717795419
2025-03-13 11:47:06,902 [INFO]: 	99p_search_speed_ms: 18.966083521954715
2025-03-13 11:47:06,902 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:06,902 [INFO]: 	nb vectors: 7437
2025-03-13 11:47:06,902 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:06,902 [INFO]: 	compression ratio: 0.999308116695071
2025-03-13 11:47:06,902 [INFO]: }
2025-03-13 11:47:06,902 [INFO]: 	>>> Finished "Creating the index" in 91.6491 secs
2025-03-13 11:47:06,902 [INFO]: >>> Finished "Launching the whole pipeline" in 91.6853 secs
2025-03-13 11:47:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 37342 [episode count 16/20]
[retrieval_preprocessing] for episode 92128 [episode count 17/20], we have num_retrieval=np.int64(7587) num_query=np.int64(386)
2025-03-13 11:47:10,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:11,982 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:11
2025-03-13 11:47:11,982 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 710.42it/s]
2025-03-13 11:47:12,024 [INFO]: There are 7587 embeddings of dim 49152
2025-03-13 11:47:12,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0425 secs
2025-03-13 11:47:12,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:12,025 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:47:12,026 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:12,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-13 11:47:12,026 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,026 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:12,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 11:47:12,027 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:12
2025-03-13 11:47:12,027 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:12,028 [INFO]: 	Creating the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,028 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:12
2025-03-13 11:47:12,032 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0038 secs
2025-03-13 11:47:12,033 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:12
2025-03-13 11:47:12,033 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:47:12,033 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  9.55it/s] 23%|██▎       | 7/31 [00:00<00:00, 35.83it/s] 42%|████▏     | 13/31 [00:00<00:00, 41.66it/s] 58%|█████▊    | 18/31 [00:00<00:00, 43.67it/s] 74%|███████▍  | 23/31 [00:05<00:03,  2.64it/s] 94%|█████████▎| 29/31 [00:05<00:00,  4.16it/s]100%|██████████| 31/31 [00:08<00:00,  3.51it/s]
2025-03-13 11:47:20,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:20
2025-03-13 11:48:23,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.8083 secs
2025-03-13 11:48:23,689 [INFO]: The best hyperparameters are: efSearch=164
2025-03-13 11:48:23,689 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s]
2025-03-13 11:48:52,103 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4134 secs
2025-03-13 11:48:52,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.0717 secs
2025-03-13 11:48:52,105 [INFO]: {
2025-03-13 11:48:52,105 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:52,105 [INFO]: 	index_param: efSearch=164
2025-03-13 11:48:52,105 [INFO]: 	index_path: knn.index
2025-03-13 11:48:52,105 [INFO]: 	size in bytes: 1492697710
2025-03-13 11:48:52,105 [INFO]: 	avg_search_speed_ms: 8.795024566237693
2025-03-13 11:48:52,105 [INFO]: 	99p_search_speed_ms: 12.615875340998176
2025-03-13 11:48:52,105 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:52,105 [INFO]: 	nb vectors: 7587
2025-03-13 11:48:52,105 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:52,105 [INFO]: 	compression ratio: 0.9993080889767024
2025-03-13 11:48:52,105 [INFO]: }
2025-03-13 11:48:52,105 [INFO]: 	>>> Finished "Creating the index" in 100.0768 secs
2025-03-13 11:48:52,105 [INFO]: >>> Finished "Launching the whole pipeline" in 100.1229 secs
2025-03-13 11:48:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 92128 [episode count 17/20]
[retrieval_preprocessing] for episode 39910 [episode count 18/20], we have num_retrieval=np.int64(7597) num_query=np.int64(376)
2025-03-13 11:48:55,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:57,086 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:57
2025-03-13 11:48:57,086 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2195.97it/s]
2025-03-13 11:48:57,122 [INFO]: There are 7597 embeddings of dim 49152
2025-03-13 11:48:57,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-13 11:48:57,123 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:57,123 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:48:57,123 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:57,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:57,123 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,123 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:57,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:48:57,123 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:57
2025-03-13 11:48:57,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:57,123 [INFO]: 	Creating the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,123 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:57
2025-03-13 11:48:57,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:48:57,125 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:57
2025-03-13 11:48:57,125 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:48:57,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.02it/s] 19%|█▉        | 6/31 [00:00<00:00, 29.37it/s] 39%|███▊      | 12/31 [00:00<00:00, 39.68it/s] 55%|█████▍    | 17/31 [00:00<00:00, 42.89it/s] 71%|███████   | 22/31 [00:05<00:03,  2.69it/s] 87%|████████▋ | 27/31 [00:05<00:00,  4.00it/s]100%|██████████| 31/31 [00:08<00:00,  2.48it/s]100%|██████████| 31/31 [00:08<00:00,  3.65it/s]
2025-03-13 11:49:05,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:05
2025-03-13 11:50:06,473 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.8462 secs
2025-03-13 11:50:06,473 [INFO]: The best hyperparameters are: efSearch=150
2025-03-13 11:50:06,474 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.16it/s]
2025-03-13 11:50:50,098 [INFO]: 	>>> Finished "Compute fast metrics" in 43.6246 secs
2025-03-13 11:50:50,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.9760 secs
2025-03-13 11:50:50,101 [INFO]: {
2025-03-13 11:50:50,101 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:50,101 [INFO]: 	index_param: efSearch=150
2025-03-13 11:50:50,101 [INFO]: 	index_path: knn.index
2025-03-13 11:50:50,101 [INFO]: 	size in bytes: 1494665170
2025-03-13 11:50:50,101 [INFO]: 	avg_search_speed_ms: 9.778992723553412
2025-03-13 11:50:50,101 [INFO]: 	99p_search_speed_ms: 13.85435259900987
2025-03-13 11:50:50,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:50,101 [INFO]: 	nb vectors: 7597
2025-03-13 11:50:50,101 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:50,101 [INFO]: 	compression ratio: 0.9993080764703978
2025-03-13 11:50:50,101 [INFO]: }
2025-03-13 11:50:50,101 [INFO]: 	>>> Finished "Creating the index" in 112.9777 secs
2025-03-13 11:50:50,101 [INFO]: >>> Finished "Launching the whole pipeline" in 113.0148 secs
2025-03-13 11:50:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 39910 [episode count 18/20]
[retrieval_preprocessing] for episode 1013 [episode count 19/20], we have num_retrieval=np.int64(7686) num_query=np.int64(287)
2025-03-13 11:50:53,796 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:54,928 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:54
2025-03-13 11:50:54,929 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1692.62it/s]
2025-03-13 11:50:54,960 [INFO]: There are 7686 embeddings of dim 49152
2025-03-13 11:50:54,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 11:50:54,960 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:54
2025-03-13 11:50:54,961 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:54,961 [INFO]: 		-> Add: 4.2 seconds
2025-03-13 11:50:54,961 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:54,961 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:50:54,961 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:54
2025-03-13 11:50:54,961 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:54,961 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:50:54,961 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:54
2025-03-13 11:50:54,961 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:54,961 [INFO]: 	Creating the index 03/13/2025, 11:50:54
2025-03-13 11:50:54,961 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:54
2025-03-13 11:50:54,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:50:54,962 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:54
2025-03-13 11:50:54,962 [INFO]: The memory available for adding the vectors is 48.6GB(total available - used by the index)
2025-03-13 11:50:54,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:00<00:03,  8.11it/s] 22%|██▏       | 7/32 [00:00<00:00, 34.10it/s] 41%|████      | 13/32 [00:00<00:00, 44.49it/s] 59%|█████▉    | 19/32 [00:00<00:00, 49.86it/s] 78%|███████▊  | 25/32 [00:04<00:01,  3.57it/s] 97%|█████████▋| 31/32 [00:04<00:00,  5.35it/s]100%|██████████| 32/32 [00:08<00:00,  3.94it/s]
2025-03-13 11:51:03,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:03
2025-03-13 11:52:01,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.0610 secs
2025-03-13 11:52:01,150 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 11:52:01,150 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.72it/s]
2025-03-13 11:52:30,388 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2377 secs
2025-03-13 11:52:30,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.4284 secs
2025-03-13 11:52:30,391 [INFO]: {
2025-03-13 11:52:30,391 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:30,391 [INFO]: 	index_param: efSearch=175
2025-03-13 11:52:30,391 [INFO]: 	index_path: knn.index
2025-03-13 11:52:30,391 [INFO]: 	size in bytes: 1512175390
2025-03-13 11:52:30,391 [INFO]: 	avg_search_speed_ms: 12.316437355550052
2025-03-13 11:52:30,391 [INFO]: 	99p_search_speed_ms: 17.786099398508664
2025-03-13 11:52:30,391 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:30,391 [INFO]: 	nb vectors: 7686
2025-03-13 11:52:30,391 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:30,391 [INFO]: 	compression ratio: 0.9993080815843723
2025-03-13 11:52:30,391 [INFO]: }
2025-03-13 11:52:30,391 [INFO]: 	>>> Finished "Creating the index" in 95.4299 secs
2025-03-13 11:52:30,391 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4623 secs
2025-03-13 11:52:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 1013 [episode count 19/20]
2025-03-13 11:52:33: [retrieval_preprocessing] finished for 3163748394_put_objects_in_drawer_and_close [chosen_id count 2/260]
2025-03-13 11:52:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_object_on_top_of_cabinet [chosen_id count 3/260]
2025-03-13 11:52:36: [retrieval_preprocessing] we have num_total=2588 embedding_dim=49152
[retrieval_preprocessing] for episode 8228 [episode count 0/20], we have num_retrieval=np.int64(2460) num_query=np.int64(128)
2025-03-13 11:52:36,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:37,107 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:37
2025-03-13 11:52:37,107 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-13 11:52:37,139 [INFO]: There are 2460 embeddings of dim 49152
2025-03-13 11:52:37,140 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:52:37,140 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,140 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:37,140 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:52:37,140 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:37,140 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:52:37,140 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,140 [INFO]: 507.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:37,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:52:37,140 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:37
2025-03-13 11:52:37,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:37,140 [INFO]: 	Creating the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,140 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:37
2025-03-13 11:52:37,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:52:37,142 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:37
2025-03-13 11:52:37,142 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:52:37,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.98it/s] 70%|███████   | 7/10 [00:00<00:00, 32.13it/s]100%|██████████| 10/10 [00:02<00:00,  4.61it/s]
2025-03-13 11:52:39,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:39
2025-03-13 11:53:14,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2985 secs
2025-03-13 11:53:14,613 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 11:53:14,614 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-13 11:53:30,603 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9895 secs
2025-03-13 11:53:31,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9060 secs
2025-03-13 11:53:31,048 [INFO]: {
2025-03-13 11:53:31,048 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:31,048 [INFO]: 	index_param: efSearch=186
2025-03-13 11:53:31,048 [INFO]: 	index_path: knn.index
2025-03-13 11:53:31,048 [INFO]: 	size in bytes: 483989650
2025-03-13 11:53:31,048 [INFO]: 	avg_search_speed_ms: 8.879148822110709
2025-03-13 11:53:31,049 [INFO]: 	99p_search_speed_ms: 12.916715466417372
2025-03-13 11:53:31,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:31,049 [INFO]: 	nb vectors: 2460
2025-03-13 11:53:31,049 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:31,049 [INFO]: 	compression ratio: 0.9993099645829203
2025-03-13 11:53:31,049 [INFO]: }
2025-03-13 11:53:31,049 [INFO]: 	>>> Finished "Creating the index" in 53.9085 secs
2025-03-13 11:53:31,049 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9421 secs
2025-03-13 11:53:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 8228 [episode count 0/20]
[retrieval_preprocessing] for episode 26637 [episode count 1/20], we have num_retrieval=np.int64(2448) num_query=np.int64(140)
2025-03-13 11:53:32,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:32,661 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:32
2025-03-13 11:53:32,662 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1480.52it/s]
2025-03-13 11:53:32,692 [INFO]: There are 2448 embeddings of dim 49152
2025-03-13 11:53:32,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 11:53:32,692 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:32,692 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:53:32,692 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:32,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:32,692 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,692 [INFO]: 505.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:32,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:53:32,692 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:32
2025-03-13 11:53:32,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:32,692 [INFO]: 	Creating the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,693 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:32
2025-03-13 11:53:32,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:53:32,693 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:32
2025-03-13 11:53:32,694 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:53:32,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.33it/s] 60%|██████    | 6/10 [00:00<00:00, 31.89it/s]100%|██████████| 10/10 [00:02<00:00,  3.50it/s]100%|██████████| 10/10 [00:02<00:00,  4.22it/s]
2025-03-13 11:53:35,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:35
2025-03-13 11:54:04,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9632 secs
2025-03-13 11:54:04,030 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 11:54:04,030 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 11:54:20,648 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6175 secs
2025-03-13 11:54:20,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9560 secs
2025-03-13 11:54:20,650 [INFO]: {
2025-03-13 11:54:20,650 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:20,650 [INFO]: 	index_param: efSearch=246
2025-03-13 11:54:20,650 [INFO]: 	index_path: knn.index
2025-03-13 11:54:20,650 [INFO]: 	size in bytes: 481628710
2025-03-13 11:54:20,650 [INFO]: 	avg_search_speed_ms: 11.84667928874828
2025-03-13 11:54:20,650 [INFO]: 	99p_search_speed_ms: 22.581041373778113
2025-03-13 11:54:20,650 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:20,650 [INFO]: 	nb vectors: 2448
2025-03-13 11:54:20,650 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:20,650 [INFO]: 	compression ratio: 0.9993099954527213
2025-03-13 11:54:20,650 [INFO]: }
2025-03-13 11:54:20,650 [INFO]: 	>>> Finished "Creating the index" in 47.9574 secs
2025-03-13 11:54:20,650 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9884 secs
2025-03-13 11:54:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 26637 [episode count 1/20]
[retrieval_preprocessing] for episode 82120 [episode count 2/20], we have num_retrieval=np.int64(2480) num_query=np.int64(108)
2025-03-13 11:54:23,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:23,528 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:23
2025-03-13 11:54:23,528 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.66it/s]
2025-03-13 11:54:23,561 [INFO]: There are 2480 embeddings of dim 49152
2025-03-13 11:54:23,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 11:54:23,561 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:23
2025-03-13 11:54:23,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:23,561 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:54:23,561 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:23,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:54:23,561 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:23
2025-03-13 11:54:23,561 [INFO]: 511.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:23,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:54:23,562 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:23
2025-03-13 11:54:23,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:23,562 [INFO]: 	Creating the index 03/13/2025, 11:54:23
2025-03-13 11:54:23,562 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:23
2025-03-13 11:54:23,563 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:54:23,563 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:23
2025-03-13 11:54:23,563 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:54:23,563 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.08it/s] 50%|█████     | 5/10 [00:00<00:00, 26.53it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-13 11:54:25,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:25
2025-03-13 11:54:59,205 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2303 secs
2025-03-13 11:54:59,205 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 11:54:59,205 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 11:55:13,785 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5804 secs
2025-03-13 11:55:14,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5207 secs
2025-03-13 11:55:14,084 [INFO]: {
2025-03-13 11:55:14,084 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:14,084 [INFO]: 	index_param: efSearch=216
2025-03-13 11:55:14,084 [INFO]: 	index_path: knn.index
2025-03-13 11:55:14,084 [INFO]: 	size in bytes: 487924450
2025-03-13 11:55:14,084 [INFO]: 	avg_search_speed_ms: 9.53968578882032
2025-03-13 11:55:14,085 [INFO]: 	99p_search_speed_ms: 13.071657833643258
2025-03-13 11:55:14,085 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:14,085 [INFO]: 	nb vectors: 2480
2025-03-13 11:55:14,085 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:14,085 [INFO]: 	compression ratio: 0.9993101186054522
2025-03-13 11:55:14,085 [INFO]: }
2025-03-13 11:55:14,085 [INFO]: 	>>> Finished "Creating the index" in 50.5232 secs
2025-03-13 11:55:14,085 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5567 secs
2025-03-13 11:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 82120 [episode count 2/20]
[retrieval_preprocessing] for episode 43281 [episode count 3/20], we have num_retrieval=np.int64(2473) num_query=np.int64(115)
2025-03-13 11:55:15,228 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:15,591 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:15
2025-03-13 11:55:15,592 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1780.26it/s]
2025-03-13 11:55:15,623 [INFO]: There are 2473 embeddings of dim 49152
2025-03-13 11:55:15,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 11:55:15,624 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:15
2025-03-13 11:55:15,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:15,624 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:55:15,624 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:15,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:55:15,624 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:15
2025-03-13 11:55:15,625 [INFO]: 510.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:15,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:55:15,625 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:15
2025-03-13 11:55:15,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:15,625 [INFO]: 	Creating the index 03/13/2025, 11:55:15
2025-03-13 11:55:15,625 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:15
2025-03-13 11:55:15,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:55:15,629 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:15
2025-03-13 11:55:15,629 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:55:15,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.47it/s] 70%|███████   | 7/10 [00:00<00:00, 33.90it/s]100%|██████████| 10/10 [00:02<00:00,  4.45it/s]
2025-03-13 11:55:17,881 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:17
2025-03-13 11:55:48,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8126 secs
2025-03-13 11:55:48,694 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 11:55:48,694 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-13 11:56:02,395 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7007 secs
2025-03-13 11:56:02,398 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7689 secs
2025-03-13 11:56:02,398 [INFO]: {
2025-03-13 11:56:02,398 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:02,398 [INFO]: 	index_param: efSearch=235
2025-03-13 11:56:02,398 [INFO]: 	index_path: knn.index
2025-03-13 11:56:02,398 [INFO]: 	size in bytes: 486547270
2025-03-13 11:56:02,398 [INFO]: 	avg_search_speed_ms: 11.835259462006874
2025-03-13 11:56:02,398 [INFO]: 	99p_search_speed_ms: 19.896504255011674
2025-03-13 11:56:02,398 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:02,398 [INFO]: 	nb vectors: 2473
2025-03-13 11:56:02,398 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:02,398 [INFO]: 	compression ratio: 0.9993100649809421
2025-03-13 11:56:02,398 [INFO]: }
2025-03-13 11:56:02,398 [INFO]: 	>>> Finished "Creating the index" in 46.7727 secs
2025-03-13 11:56:02,398 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8063 secs
2025-03-13 11:56:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 43281 [episode count 3/20]
[retrieval_preprocessing] for episode 45352 [episode count 4/20], we have num_retrieval=np.int64(2305) num_query=np.int64(283)
2025-03-13 11:56:04,062 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:04,493 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:04
2025-03-13 11:56:04,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.31it/s]
2025-03-13 11:56:04,525 [INFO]: There are 2305 embeddings of dim 49152
2025-03-13 11:56:04,526 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 11:56:04,526 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,526 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:04,526 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:56:04,526 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:04,526 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:04,526 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,526 [INFO]: 475.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:04,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:56:04,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:04
2025-03-13 11:56:04,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:04,526 [INFO]: 	Creating the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,526 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:04
2025-03-13 11:56:04,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:56:04,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,527 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:56:04,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.25it/s] 60%|██████    | 6/10 [00:00<00:00, 30.71it/s]100%|██████████| 10/10 [00:02<00:00,  2.98it/s]100%|██████████| 10/10 [00:02<00:00,  3.71it/s]
2025-03-13 11:56:07,229 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:07
2025-03-13 11:56:39,798 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5692 secs
2025-03-13 11:56:39,798 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 11:56:39,798 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 11:56:55,285 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4863 secs
2025-03-13 11:56:55,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7590 secs
2025-03-13 11:56:55,286 [INFO]: {
2025-03-13 11:56:55,286 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:55,286 [INFO]: 	index_param: efSearch=202
2025-03-13 11:56:55,286 [INFO]: 	index_path: knn.index
2025-03-13 11:56:55,286 [INFO]: 	size in bytes: 453494590
2025-03-13 11:56:55,286 [INFO]: 	avg_search_speed_ms: 9.574890469365785
2025-03-13 11:56:55,286 [INFO]: 	99p_search_speed_ms: 13.576540779322368
2025-03-13 11:56:55,286 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:55,286 [INFO]: 	nb vectors: 2305
2025-03-13 11:56:55,286 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:55,286 [INFO]: 	compression ratio: 0.9993094735705668
2025-03-13 11:56:55,286 [INFO]: }
2025-03-13 11:56:55,287 [INFO]: 	>>> Finished "Creating the index" in 50.7604 secs
2025-03-13 11:56:55,287 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7934 secs
2025-03-13 11:56:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 45352 [episode count 4/20]
[retrieval_preprocessing] for episode 3476 [episode count 5/20], we have num_retrieval=np.int64(2467) num_query=np.int64(121)
2025-03-13 11:56:57,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:58,235 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:58
2025-03-13 11:56:58,235 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2081.54it/s]
2025-03-13 11:56:58,263 [INFO]: There are 2467 embeddings of dim 49152
2025-03-13 11:56:58,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 11:56:58,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:58
2025-03-13 11:56:58,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:58,264 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:56:58,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:58,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:58,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:58
2025-03-13 11:56:58,264 [INFO]: 509.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:58,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:56:58,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:58
2025-03-13 11:56:58,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:58,264 [INFO]: 	Creating the index 03/13/2025, 11:56:58
2025-03-13 11:56:58,264 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:58
2025-03-13 11:56:58,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:56:58,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:58
2025-03-13 11:56:58,265 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:56:58,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.91it/s] 60%|██████    | 6/10 [00:00<00:00, 32.79it/s]100%|██████████| 10/10 [00:02<00:00,  4.00it/s]100%|██████████| 10/10 [00:02<00:00,  4.81it/s]
2025-03-13 11:57:00,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:00
2025-03-13 11:57:27,733 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3832 secs
2025-03-13 11:57:27,734 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:57:27,734 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 11:57:44,770 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0358 secs
2025-03-13 11:57:44,772 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5064 secs
2025-03-13 11:57:44,772 [INFO]: {
2025-03-13 11:57:44,772 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:44,772 [INFO]: 	index_param: efSearch=223
2025-03-13 11:57:44,772 [INFO]: 	index_path: knn.index
2025-03-13 11:57:44,772 [INFO]: 	size in bytes: 485366830
2025-03-13 11:57:44,772 [INFO]: 	avg_search_speed_ms: 10.95636761573889
2025-03-13 11:57:44,772 [INFO]: 	99p_search_speed_ms: 21.739859776571393
2025-03-13 11:57:44,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:44,772 [INFO]: 	nb vectors: 2467
2025-03-13 11:57:44,772 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:44,772 [INFO]: 	compression ratio: 0.9993100187748718
2025-03-13 11:57:44,772 [INFO]: }
2025-03-13 11:57:44,772 [INFO]: 	>>> Finished "Creating the index" in 46.5081 secs
2025-03-13 11:57:44,772 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5371 secs
2025-03-13 11:57:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 3476 [episode count 5/20]
[retrieval_preprocessing] for episode 38806 [episode count 6/20], we have num_retrieval=np.int64(2460) num_query=np.int64(128)
2025-03-13 11:57:45,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:46,387 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:46
2025-03-13 11:57:46,387 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.93it/s]
2025-03-13 11:57:46,419 [INFO]: There are 2460 embeddings of dim 49152
2025-03-13 11:57:46,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 11:57:46,419 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:46
2025-03-13 11:57:46,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:46,419 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:57:46,419 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:46,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:57:46,419 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:46
2025-03-13 11:57:46,419 [INFO]: 507.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:46,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:57:46,419 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:46
2025-03-13 11:57:46,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:46,420 [INFO]: 	Creating the index 03/13/2025, 11:57:46
2025-03-13 11:57:46,420 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:46
2025-03-13 11:57:46,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:57:46,421 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:46
2025-03-13 11:57:46,421 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:57:46,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.50it/s] 60%|██████    | 6/10 [00:00<00:00, 31.71it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]100%|██████████| 10/10 [00:02<00:00,  4.90it/s]
2025-03-13 11:57:48,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:48
2025-03-13 11:58:21,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2135 secs
2025-03-13 11:58:21,678 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 11:58:21,678 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-13 11:58:35,100 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4225 secs
2025-03-13 11:58:35,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6807 secs
2025-03-13 11:58:35,102 [INFO]: {
2025-03-13 11:58:35,102 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:35,102 [INFO]: 	index_param: efSearch=228
2025-03-13 11:58:35,102 [INFO]: 	index_path: knn.index
2025-03-13 11:58:35,102 [INFO]: 	size in bytes: 483989650
2025-03-13 11:58:35,102 [INFO]: 	avg_search_speed_ms: 10.91051472385486
2025-03-13 11:58:35,102 [INFO]: 	99p_search_speed_ms: 21.472740210592747
2025-03-13 11:58:35,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:35,102 [INFO]: 	nb vectors: 2460
2025-03-13 11:58:35,102 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:35,102 [INFO]: 	compression ratio: 0.9993099645829203
2025-03-13 11:58:35,102 [INFO]: }
2025-03-13 11:58:35,102 [INFO]: 	>>> Finished "Creating the index" in 48.6823 secs
2025-03-13 11:58:35,102 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7147 secs
2025-03-13 11:58:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 38806 [episode count 6/20]
[retrieval_preprocessing] for episode 46851 [episode count 7/20], we have num_retrieval=np.int64(2488) num_query=np.int64(100)
2025-03-13 11:58:36,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:36,766 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:36
2025-03-13 11:58:36,766 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1807.11it/s]
2025-03-13 11:58:36,794 [INFO]: There are 2488 embeddings of dim 49152
2025-03-13 11:58:36,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 11:58:36,794 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:36
2025-03-13 11:58:36,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:36,794 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:58:36,794 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:36,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:36,794 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:36
2025-03-13 11:58:36,795 [INFO]: 513.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:36,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:58:36,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:36
2025-03-13 11:58:36,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:36,795 [INFO]: 	Creating the index 03/13/2025, 11:58:36
2025-03-13 11:58:36,795 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:36
2025-03-13 11:58:36,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 11:58:36,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:36
2025-03-13 11:58:36,797 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:58:36,798 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.66it/s] 70%|███████   | 7/10 [00:00<00:00, 35.03it/s]100%|██████████| 10/10 [00:02<00:00,  4.87it/s]
2025-03-13 11:58:38,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:38
2025-03-13 11:59:08,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3048 secs
2025-03-13 11:59:08,164 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 11:59:08,164 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.29it/s]
2025-03-13 11:59:22,870 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7067 secs
2025-03-13 11:59:22,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0746 secs
2025-03-13 11:59:22,872 [INFO]: {
2025-03-13 11:59:22,872 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:22,872 [INFO]: 	index_param: efSearch=191
2025-03-13 11:59:22,872 [INFO]: 	index_path: knn.index
2025-03-13 11:59:22,872 [INFO]: 	size in bytes: 489498370
2025-03-13 11:59:22,872 [INFO]: 	avg_search_speed_ms: 8.788748504757645
2025-03-13 11:59:22,872 [INFO]: 	99p_search_speed_ms: 12.328197383321822
2025-03-13 11:59:22,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:22,872 [INFO]: 	nb vectors: 2488
2025-03-13 11:59:22,872 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:22,872 [INFO]: 	compression ratio: 0.999310179521129
2025-03-13 11:59:22,872 [INFO]: }
2025-03-13 11:59:22,872 [INFO]: 	>>> Finished "Creating the index" in 46.0773 secs
2025-03-13 11:59:22,872 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1060 secs
2025-03-13 11:59:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 46851 [episode count 7/20]
[retrieval_preprocessing] for episode 6409 [episode count 8/20], we have num_retrieval=np.int64(2481) num_query=np.int64(107)
2025-03-13 11:59:23,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:24,171 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:24
2025-03-13 11:59:24,171 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 7884.03it/s]
2025-03-13 11:59:24,211 [INFO]: There are 2481 embeddings of dim 49152
2025-03-13 11:59:24,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0402 secs
2025-03-13 11:59:24,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:24
2025-03-13 11:59:24,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:24,212 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:59:24,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:24,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:59:24,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:24
2025-03-13 11:59:24,212 [INFO]: 512.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:24,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:59:24,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:24
2025-03-13 11:59:24,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:24,213 [INFO]: 	Creating the index 03/13/2025, 11:59:24
2025-03-13 11:59:24,213 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:24
2025-03-13 11:59:24,215 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 11:59:24,215 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:24
2025-03-13 11:59:24,215 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:59:24,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.53it/s] 70%|███████   | 7/10 [00:00<00:00, 35.97it/s]100%|██████████| 10/10 [00:01<00:00,  5.21it/s]
2025-03-13 11:59:26,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:26
2025-03-13 11:59:59,536 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3973 secs
2025-03-13 11:59:59,536 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:59:59,536 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.05it/s]
2025-03-13 12:00:17,730 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1937 secs
2025-03-13 12:00:17,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5168 secs
2025-03-13 12:00:17,732 [INFO]: {
2025-03-13 12:00:17,732 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:17,732 [INFO]: 	index_param: efSearch=208
2025-03-13 12:00:17,732 [INFO]: 	index_path: knn.index
2025-03-13 12:00:17,732 [INFO]: 	size in bytes: 488121190
2025-03-13 12:00:17,732 [INFO]: 	avg_search_speed_ms: 8.243040195708481
2025-03-13 12:00:17,732 [INFO]: 	99p_search_speed_ms: 11.62352168932557
2025-03-13 12:00:17,732 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:17,732 [INFO]: 	nb vectors: 2481
2025-03-13 12:00:17,732 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:17,732 [INFO]: 	compression ratio: 0.9993101262413951
2025-03-13 12:00:17,732 [INFO]: }
2025-03-13 12:00:17,732 [INFO]: 	>>> Finished "Creating the index" in 53.5193 secs
2025-03-13 12:00:17,732 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5607 secs
2025-03-13 12:00:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 6409 [episode count 8/20]
[retrieval_preprocessing] for episode 54654 [episode count 9/20], we have num_retrieval=np.int64(2489) num_query=np.int64(99)
2025-03-13 12:00:18,805 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:19,203 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:19
2025-03-13 12:00:19,203 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.00it/s]
2025-03-13 12:00:19,392 [INFO]: There are 2489 embeddings of dim 49152
2025-03-13 12:00:19,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1887 secs
2025-03-13 12:00:19,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:19
2025-03-13 12:00:19,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:19,392 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:00:19,392 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:19,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:00:19,393 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:19
2025-03-13 12:00:19,393 [INFO]: 513.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:19,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:00:19,393 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:19
2025-03-13 12:00:19,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:19,393 [INFO]: 	Creating the index 03/13/2025, 12:00:19
2025-03-13 12:00:19,393 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:19
2025-03-13 12:00:19,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 12:00:19,395 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:19
2025-03-13 12:00:19,395 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:00:19,395 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.99it/s] 70%|███████   | 7/10 [00:00<00:00, 37.05it/s]100%|██████████| 10/10 [00:02<00:00,  4.74it/s]
2025-03-13 12:00:21,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:21
2025-03-13 12:00:56,366 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8539 secs
2025-03-13 12:00:56,367 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 12:00:56,367 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-13 12:01:16,747 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3802 secs
2025-03-13 12:01:16,749 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3536 secs
2025-03-13 12:01:16,749 [INFO]: {
2025-03-13 12:01:16,749 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:16,749 [INFO]: 	index_param: efSearch=196
2025-03-13 12:01:16,749 [INFO]: 	index_path: knn.index
2025-03-13 12:01:16,749 [INFO]: 	size in bytes: 489695170
2025-03-13 12:01:16,749 [INFO]: 	avg_search_speed_ms: 9.364075185678733
2025-03-13 12:01:16,749 [INFO]: 	99p_search_speed_ms: 13.085497897118326
2025-03-13 12:01:16,749 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:16,749 [INFO]: 	nb vectors: 2489
2025-03-13 12:01:16,749 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:16,749 [INFO]: 	compression ratio: 0.9993100646673726
2025-03-13 12:01:16,749 [INFO]: }
2025-03-13 12:01:16,749 [INFO]: 	>>> Finished "Creating the index" in 57.3560 secs
2025-03-13 12:01:16,749 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5458 secs
2025-03-13 12:01:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 54654 [episode count 9/20]
[retrieval_preprocessing] for episode 1331 [episode count 10/20], we have num_retrieval=np.int64(2479) num_query=np.int64(109)
2025-03-13 12:01:17,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:18,115 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:18
2025-03-13 12:01:18,116 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1885.93it/s]
2025-03-13 12:01:18,146 [INFO]: There are 2479 embeddings of dim 49152
2025-03-13 12:01:18,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 12:01:18,147 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:18,147 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:01:18,148 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:18,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:01:18,148 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,148 [INFO]: 511.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:18,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:01:18,148 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:18
2025-03-13 12:01:18,149 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:18,149 [INFO]: 	Creating the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,149 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:18
2025-03-13 12:01:18,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:01:18,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:18
2025-03-13 12:01:18,152 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:01:18,153 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.00it/s] 80%|████████  | 8/10 [00:00<00:00, 38.06it/s]100%|██████████| 10/10 [00:03<00:00,  3.10it/s]
2025-03-13 12:01:21,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:21
2025-03-13 12:01:48,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9693 secs
2025-03-13 12:01:48,358 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 12:01:48,358 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.60it/s]
2025-03-13 12:02:09,018 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6594 secs
2025-03-13 12:02:09,019 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8671 secs
2025-03-13 12:02:09,020 [INFO]: {
2025-03-13 12:02:09,020 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:09,020 [INFO]: 	index_param: efSearch=288
2025-03-13 12:02:09,020 [INFO]: 	index_path: knn.index
2025-03-13 12:02:09,020 [INFO]: 	size in bytes: 487727710
2025-03-13 12:02:09,020 [INFO]: 	avg_search_speed_ms: 11.780175755022025
2025-03-13 12:02:09,020 [INFO]: 	99p_search_speed_ms: 16.64406754076481
2025-03-13 12:02:09,020 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:09,020 [INFO]: 	nb vectors: 2479
2025-03-13 12:02:09,020 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:09,020 [INFO]: 	compression ratio: 0.9993101109633488
2025-03-13 12:02:09,020 [INFO]: }
2025-03-13 12:02:09,020 [INFO]: 	>>> Finished "Creating the index" in 50.8708 secs
2025-03-13 12:02:09,020 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9043 secs
2025-03-13 12:02:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 1331 [episode count 10/20]
[retrieval_preprocessing] for episode 20483 [episode count 11/20], we have num_retrieval=np.int64(2466) num_query=np.int64(122)
2025-03-13 12:02:10,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:11,240 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:11
2025-03-13 12:02:11,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.83it/s]
2025-03-13 12:02:11,274 [INFO]: There are 2466 embeddings of dim 49152
2025-03-13 12:02:11,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-13 12:02:11,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:11,275 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:02:11,275 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:11,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:02:11,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,275 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:11,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:02:11,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:11
2025-03-13 12:02:11,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:11,276 [INFO]: 	Creating the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:11
2025-03-13 12:02:11,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:02:11,277 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:11
2025-03-13 12:02:11,277 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:02:11,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.00it/s] 70%|███████   | 7/10 [00:00<00:00, 32.86it/s]100%|██████████| 10/10 [00:02<00:00,  4.87it/s]
2025-03-13 12:02:13,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:13
2025-03-13 12:02:52,588 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2554 secs
2025-03-13 12:02:52,589 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 12:02:52,589 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-13 12:03:07,975 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3867 secs
2025-03-13 12:03:07,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7003 secs
2025-03-13 12:03:07,977 [INFO]: {
2025-03-13 12:03:07,977 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:07,977 [INFO]: 	index_param: efSearch=184
2025-03-13 12:03:07,977 [INFO]: 	index_path: knn.index
2025-03-13 12:03:07,977 [INFO]: 	size in bytes: 485170090
2025-03-13 12:03:07,977 [INFO]: 	avg_search_speed_ms: 9.597802595029837
2025-03-13 12:03:07,977 [INFO]: 	99p_search_speed_ms: 15.888990510720754
2025-03-13 12:03:07,977 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:07,977 [INFO]: 	nb vectors: 2466
2025-03-13 12:03:07,977 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:07,977 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-13 12:03:07,978 [INFO]: }
2025-03-13 12:03:07,978 [INFO]: 	>>> Finished "Creating the index" in 56.7020 secs
2025-03-13 12:03:07,978 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7379 secs
2025-03-13 12:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 20483 [episode count 11/20]
[retrieval_preprocessing] for episode 64901 [episode count 12/20], we have num_retrieval=np.int64(2481) num_query=np.int64(107)
2025-03-13 12:03:09,119 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:09,479 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:09
2025-03-13 12:03:09,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.09it/s]
2025-03-13 12:03:09,508 [INFO]: There are 2481 embeddings of dim 49152
2025-03-13 12:03:09,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 12:03:09,509 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:09,509 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:03:09,509 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:09,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:03:09,509 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,509 [INFO]: 512.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:09,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:03:09,509 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:09
2025-03-13 12:03:09,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:09,509 [INFO]: 	Creating the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,509 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:09
2025-03-13 12:03:09,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:03:09,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:09
2025-03-13 12:03:09,510 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:03:09,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.64it/s] 60%|██████    | 6/10 [00:00<00:00, 32.10it/s]100%|██████████| 10/10 [00:02<00:00,  3.41it/s]100%|██████████| 10/10 [00:02<00:00,  4.12it/s]
2025-03-13 12:03:11,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:11
2025-03-13 12:03:41,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7709 secs
2025-03-13 12:03:41,715 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 12:03:41,715 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.38it/s]
2025-03-13 12:04:01,464 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7482 secs
2025-03-13 12:04:01,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9549 secs
2025-03-13 12:04:01,465 [INFO]: {
2025-03-13 12:04:01,465 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:01,465 [INFO]: 	index_param: efSearch=221
2025-03-13 12:04:01,465 [INFO]: 	index_path: knn.index
2025-03-13 12:04:01,465 [INFO]: 	size in bytes: 488121190
2025-03-13 12:04:01,465 [INFO]: 	avg_search_speed_ms: 10.939424039533105
2025-03-13 12:04:01,465 [INFO]: 	99p_search_speed_ms: 15.179788824170828
2025-03-13 12:04:01,465 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:01,466 [INFO]: 	nb vectors: 2481
2025-03-13 12:04:01,466 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:01,466 [INFO]: 	compression ratio: 0.9993101262413951
2025-03-13 12:04:01,466 [INFO]: }
2025-03-13 12:04:01,466 [INFO]: 	>>> Finished "Creating the index" in 51.9564 secs
2025-03-13 12:04:01,466 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9860 secs
2025-03-13 12:04:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 64901 [episode count 12/20]
[retrieval_preprocessing] for episode 51079 [episode count 13/20], we have num_retrieval=np.int64(2455) num_query=np.int64(133)
2025-03-13 12:04:02,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:03,126 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:03
2025-03-13 12:04:03,126 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.00it/s]
2025-03-13 12:04:03,154 [INFO]: There are 2455 embeddings of dim 49152
2025-03-13 12:04:03,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:04:03,154 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:03
2025-03-13 12:04:03,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:03,154 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:04:03,154 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:03,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:04:03,155 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:03
2025-03-13 12:04:03,155 [INFO]: 506.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:03,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:03,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:03
2025-03-13 12:04:03,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:03,155 [INFO]: 	Creating the index 03/13/2025, 12:04:03
2025-03-13 12:04:03,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:03
2025-03-13 12:04:03,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:04:03,156 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:03
2025-03-13 12:04:03,156 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:04:03,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.04it/s] 60%|██████    | 6/10 [00:00<00:00, 27.36it/s]100%|██████████| 10/10 [00:02<00:00,  3.50it/s]100%|██████████| 10/10 [00:02<00:00,  4.19it/s]
2025-03-13 12:04:05,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:05
2025-03-13 12:04:37,995 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4486 secs
2025-03-13 12:04:37,995 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 12:04:37,996 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-13 12:04:54,137 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1410 secs
2025-03-13 12:04:54,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9824 secs
2025-03-13 12:04:54,139 [INFO]: {
2025-03-13 12:04:54,139 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:54,139 [INFO]: 	index_param: efSearch=217
2025-03-13 12:04:54,139 [INFO]: 	index_path: knn.index
2025-03-13 12:04:54,139 [INFO]: 	size in bytes: 483005950
2025-03-13 12:04:54,139 [INFO]: 	avg_search_speed_ms: 10.070013512377997
2025-03-13 12:04:54,139 [INFO]: 	99p_search_speed_ms: 14.027200266718872
2025-03-13 12:04:54,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:54,139 [INFO]: 	nb vectors: 2455
2025-03-13 12:04:54,139 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:54,139 [INFO]: 	compression ratio: 0.9993099256851805
2025-03-13 12:04:54,139 [INFO]: }
2025-03-13 12:04:54,139 [INFO]: 	>>> Finished "Creating the index" in 50.9838 secs
2025-03-13 12:04:54,139 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0130 secs
2025-03-13 12:04:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 51079 [episode count 13/20]
[retrieval_preprocessing] for episode 29124 [episode count 14/20], we have num_retrieval=np.int64(2472) num_query=np.int64(116)
2025-03-13 12:04:55,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:56,028 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:56
2025-03-13 12:04:56,028 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2207.53it/s]
2025-03-13 12:04:56,057 [INFO]: There are 2472 embeddings of dim 49152
2025-03-13 12:04:56,057 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:04:56,057 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,057 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:56,057 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:04:56,057 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:56,057 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:56,057 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,057 [INFO]: 510.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:56,057 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:56,057 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:56
2025-03-13 12:04:56,057 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:56,057 [INFO]: 	Creating the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,058 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:56
2025-03-13 12:04:56,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:04:56,059 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:56
2025-03-13 12:04:56,059 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:04:56,059 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.15it/s] 60%|██████    | 6/10 [00:00<00:00, 30.96it/s]100%|██████████| 10/10 [00:02<00:00,  3.58it/s]100%|██████████| 10/10 [00:02<00:00,  4.30it/s]
2025-03-13 12:04:58,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:58
2025-03-13 12:05:29,936 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5463 secs
2025-03-13 12:05:29,936 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 12:05:29,936 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-13 12:05:49,115 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1790 secs
2025-03-13 12:05:49,117 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0582 secs
2025-03-13 12:05:49,117 [INFO]: {
2025-03-13 12:05:49,117 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:49,117 [INFO]: 	index_param: efSearch=212
2025-03-13 12:05:49,117 [INFO]: 	index_path: knn.index
2025-03-13 12:05:49,117 [INFO]: 	size in bytes: 486350530
2025-03-13 12:05:49,117 [INFO]: 	avg_search_speed_ms: 9.546274766068237
2025-03-13 12:05:49,117 [INFO]: 	99p_search_speed_ms: 14.388450270053
2025-03-13 12:05:49,117 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:49,117 [INFO]: 	nb vectors: 2472
2025-03-13 12:05:49,117 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:49,117 [INFO]: 	compression ratio: 0.9993100572955066
2025-03-13 12:05:49,117 [INFO]: }
2025-03-13 12:05:49,117 [INFO]: 	>>> Finished "Creating the index" in 53.0596 secs
2025-03-13 12:05:49,117 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0887 secs
2025-03-13 12:05:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 29124 [episode count 14/20]
[retrieval_preprocessing] for episode 90573 [episode count 15/20], we have num_retrieval=np.int64(2498) num_query=np.int64(90)
2025-03-13 12:05:50,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:50,558 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:50
2025-03-13 12:05:50,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2056.03it/s]
2025-03-13 12:05:50,589 [INFO]: There are 2498 embeddings of dim 49152
2025-03-13 12:05:50,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 12:05:50,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:50
2025-03-13 12:05:50,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:50,591 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:05:50,591 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:50,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:05:50,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:50
2025-03-13 12:05:50,591 [INFO]: 515.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:50,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:05:50,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:50
2025-03-13 12:05:50,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:50,592 [INFO]: 	Creating the index 03/13/2025, 12:05:50
2025-03-13 12:05:50,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:50
2025-03-13 12:05:50,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:05:50,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:50
2025-03-13 12:05:50,596 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:05:50,596 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.96it/s] 70%|███████   | 7/10 [00:00<00:00, 33.28it/s]100%|██████████| 10/10 [00:01<00:00,  5.03it/s]
2025-03-13 12:05:52,590 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:52
2025-03-13 12:06:27,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0826 secs
2025-03-13 12:06:27,674 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 12:06:27,674 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.36it/s]
2025-03-13 12:06:46,435 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7614 secs
2025-03-13 12:06:46,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8414 secs
2025-03-13 12:06:46,438 [INFO]: {
2025-03-13 12:06:46,438 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:46,438 [INFO]: 	index_param: efSearch=176
2025-03-13 12:06:46,438 [INFO]: 	index_path: knn.index
2025-03-13 12:06:46,438 [INFO]: 	size in bytes: 491465830
2025-03-13 12:06:46,438 [INFO]: 	avg_search_speed_ms: 10.294575378089883
2025-03-13 12:06:46,438 [INFO]: 	99p_search_speed_ms: 14.828752039466053
2025-03-13 12:06:46,438 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:46,438 [INFO]: 	nb vectors: 2498
2025-03-13 12:06:46,438 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:46,438 [INFO]: 	compression ratio: 0.9993101331174946
2025-03-13 12:06:46,438 [INFO]: }
2025-03-13 12:06:46,438 [INFO]: 	>>> Finished "Creating the index" in 55.8453 secs
2025-03-13 12:06:46,438 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8796 secs
2025-03-13 12:06:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 90573 [episode count 15/20]
[retrieval_preprocessing] for episode 65275 [episode count 16/20], we have num_retrieval=np.int64(2483) num_query=np.int64(105)
2025-03-13 12:06:47,496 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:47,918 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:47
2025-03-13 12:06:47,918 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1911.72it/s]
2025-03-13 12:06:47,952 [INFO]: There are 2483 embeddings of dim 49152
2025-03-13 12:06:47,952 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 12:06:47,952 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:47
2025-03-13 12:06:47,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:47,953 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:06:47,953 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:47,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:06:47,953 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:47
2025-03-13 12:06:47,953 [INFO]: 512.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:47,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:06:47,954 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:47
2025-03-13 12:06:47,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:47,954 [INFO]: 	Creating the index 03/13/2025, 12:06:47
2025-03-13 12:06:47,954 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:47
2025-03-13 12:06:47,957 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:06:47,958 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:47
2025-03-13 12:06:47,958 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:06:47,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 24.89it/s] 80%|████████  | 8/10 [00:00<00:00, 36.34it/s]100%|██████████| 10/10 [00:02<00:00,  3.93it/s]
2025-03-13 12:06:50,511 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:50
2025-03-13 12:07:25,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6008 secs
2025-03-13 12:07:25,112 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 12:07:25,112 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-13 12:07:39,000 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8880 secs
2025-03-13 12:07:39,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0446 secs
2025-03-13 12:07:39,003 [INFO]: {
2025-03-13 12:07:39,003 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:39,003 [INFO]: 	index_param: efSearch=218
2025-03-13 12:07:39,003 [INFO]: 	index_path: knn.index
2025-03-13 12:07:39,003 [INFO]: 	size in bytes: 488514670
2025-03-13 12:07:39,003 [INFO]: 	avg_search_speed_ms: 11.158366797774631
2025-03-13 12:07:39,003 [INFO]: 	99p_search_speed_ms: 16.870091995224357
2025-03-13 12:07:39,003 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:39,003 [INFO]: 	nb vectors: 2483
2025-03-13 12:07:39,003 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:39,003 [INFO]: 	compression ratio: 0.9993101414948297
2025-03-13 12:07:39,003 [INFO]: }
2025-03-13 12:07:39,003 [INFO]: 	>>> Finished "Creating the index" in 51.0485 secs
2025-03-13 12:07:39,003 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0847 secs
2025-03-13 12:07:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 65275 [episode count 16/20]
[retrieval_preprocessing] for episode 26830 [episode count 17/20], we have num_retrieval=np.int64(2457) num_query=np.int64(131)
2025-03-13 12:07:40,196 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:40,551 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:40
2025-03-13 12:07:40,551 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.56it/s]
2025-03-13 12:07:40,581 [INFO]: There are 2457 embeddings of dim 49152
2025-03-13 12:07:40,581 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 12:07:40,581 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:40
2025-03-13 12:07:40,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:40,582 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:07:40,582 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:40,582 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:07:40,582 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:40
2025-03-13 12:07:40,583 [INFO]: 507.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:40,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:07:40,583 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:40
2025-03-13 12:07:40,583 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:40,583 [INFO]: 	Creating the index 03/13/2025, 12:07:40
2025-03-13 12:07:40,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:40
2025-03-13 12:07:40,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:07:40,587 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:40
2025-03-13 12:07:40,587 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:07:40,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 26.25it/s] 80%|████████  | 8/10 [00:00<00:00, 39.42it/s]100%|██████████| 10/10 [00:02<00:00,  4.95it/s]
2025-03-13 12:07:42,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:42
2025-03-13 12:08:11,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5614 secs
2025-03-13 12:08:11,173 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 12:08:11,173 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 12:08:26,033 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8594 secs
2025-03-13 12:08:26,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4475 secs
2025-03-13 12:08:26,035 [INFO]: {
2025-03-13 12:08:26,035 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:26,035 [INFO]: 	index_param: efSearch=237
2025-03-13 12:08:26,035 [INFO]: 	index_path: knn.index
2025-03-13 12:08:26,035 [INFO]: 	size in bytes: 483399430
2025-03-13 12:08:26,035 [INFO]: 	avg_search_speed_ms: 11.23553951051128
2025-03-13 12:08:26,035 [INFO]: 	99p_search_speed_ms: 16.009511819574982
2025-03-13 12:08:26,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:26,035 [INFO]: 	nb vectors: 2457
2025-03-13 12:08:26,035 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:26,035 [INFO]: 	compression ratio: 0.9993099412632738
2025-03-13 12:08:26,035 [INFO]: }
2025-03-13 12:08:26,035 [INFO]: 	>>> Finished "Creating the index" in 45.4516 secs
2025-03-13 12:08:26,035 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4838 secs
2025-03-13 12:08:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 26830 [episode count 17/20]
[retrieval_preprocessing] for episode 7069 [episode count 18/20], we have num_retrieval=np.int64(2379) num_query=np.int64(209)
2025-03-13 12:08:27,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:27,892 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:27
2025-03-13 12:08:27,892 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.17it/s]
2025-03-13 12:08:27,928 [INFO]: There are 2379 embeddings of dim 49152
2025-03-13 12:08:27,929 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 12:08:27,929 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:27
2025-03-13 12:08:27,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:27,930 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:08:27,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:27,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:08:27,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:27
2025-03-13 12:08:27,931 [INFO]: 491.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:27,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:08:27,931 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:27
2025-03-13 12:08:27,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:27,932 [INFO]: 	Creating the index 03/13/2025, 12:08:27
2025-03-13 12:08:27,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:27
2025-03-13 12:08:27,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:08:27,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:27
2025-03-13 12:08:27,936 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:08:27,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.05it/s] 70%|███████   | 7/10 [00:00<00:00, 36.15it/s]100%|██████████| 10/10 [00:01<00:00,  5.47it/s]
2025-03-13 12:08:29,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:29
2025-03-13 12:09:01,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9178 secs
2025-03-13 12:09:01,686 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 12:09:01,687 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.17it/s]
2025-03-13 12:09:16,225 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5382 secs
2025-03-13 12:09:16,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2911 secs
2025-03-13 12:09:16,227 [INFO]: {
2025-03-13 12:09:16,227 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:16,227 [INFO]: 	index_param: efSearch=196
2025-03-13 12:09:16,227 [INFO]: 	index_path: knn.index
2025-03-13 12:09:16,227 [INFO]: 	size in bytes: 468053530
2025-03-13 12:09:16,227 [INFO]: 	avg_search_speed_ms: 10.296721653840333
2025-03-13 12:09:16,227 [INFO]: 	99p_search_speed_ms: 16.01009733742102
2025-03-13 12:09:16,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:16,227 [INFO]: 	nb vectors: 2379
2025-03-13 12:09:16,227 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:16,227 [INFO]: 	compression ratio: 0.999309698615028
2025-03-13 12:09:16,227 [INFO]: }
2025-03-13 12:09:16,227 [INFO]: 	>>> Finished "Creating the index" in 48.2953 secs
2025-03-13 12:09:16,227 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3350 secs
2025-03-13 12:09:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 7069 [episode count 18/20]
[retrieval_preprocessing] for episode 10981 [episode count 19/20], we have num_retrieval=np.int64(2451) num_query=np.int64(137)
2025-03-13 12:09:18,434 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:18,835 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:18
2025-03-13 12:09:18,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2279.51it/s]
2025-03-13 12:09:18,868 [INFO]: There are 2451 embeddings of dim 49152
2025-03-13 12:09:18,869 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 12:09:18,869 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:18
2025-03-13 12:09:18,869 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:18,869 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:09:18,870 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:18,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:09:18,870 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:18
2025-03-13 12:09:18,870 [INFO]: 505.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:18,870 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:09:18,871 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:18
2025-03-13 12:09:18,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:18,871 [INFO]: 	Creating the index 03/13/2025, 12:09:18
2025-03-13 12:09:18,871 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:18
2025-03-13 12:09:18,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:09:18,875 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:18
2025-03-13 12:09:18,875 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:09:18,875 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.15it/s] 70%|███████   | 7/10 [00:00<00:00, 34.02it/s]100%|██████████| 10/10 [00:01<00:00,  5.22it/s]
2025-03-13 12:09:20,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:20
2025-03-13 12:09:54,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5777 secs
2025-03-13 12:09:54,376 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 12:09:54,376 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.01it/s]
2025-03-13 12:10:11,079 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7030 secs
2025-03-13 12:10:11,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2065 secs
2025-03-13 12:10:11,082 [INFO]: {
2025-03-13 12:10:11,082 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:11,082 [INFO]: 	index_param: efSearch=209
2025-03-13 12:10:11,082 [INFO]: 	index_path: knn.index
2025-03-13 12:10:11,082 [INFO]: 	size in bytes: 482218930
2025-03-13 12:10:11,082 [INFO]: 	avg_search_speed_ms: 10.422959153705355
2025-03-13 12:10:11,082 [INFO]: 	99p_search_speed_ms: 15.52246612031012
2025-03-13 12:10:11,082 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:11,082 [INFO]: 	nb vectors: 2451
2025-03-13 12:10:11,082 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:11,082 [INFO]: 	compression ratio: 0.999310018791672
2025-03-13 12:10:11,082 [INFO]: }
2025-03-13 12:10:11,082 [INFO]: 	>>> Finished "Creating the index" in 52.2106 secs
2025-03-13 12:10:11,082 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2472 secs
2025-03-13 12:10:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 10981 [episode count 19/20]
2025-03-13 12:10:12: [retrieval_preprocessing] finished for 3163748394_put_object_on_top_of_cabinet [chosen_id count 3/260]
2025-03-13 12:10:13: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3246924425_corn_in_bowl [chosen_id count 4/260]
2025-03-13 12:10:13: [retrieval_preprocessing] we have num_total=2802 embedding_dim=49152
[retrieval_preprocessing] for episode 22912 [episode count 0/20], we have num_retrieval=np.int64(2670) num_query=np.int64(132)
2025-03-13 12:10:14,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:14,763 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:14
2025-03-13 12:10:14,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1049.63it/s]
2025-03-13 12:10:14,800 [INFO]: There are 2670 embeddings of dim 49152
2025-03-13 12:10:14,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 12:10:14,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:14,801 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:10:14,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:14,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:10:14,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,802 [INFO]: 551.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:14,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:10:14,802 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:14
2025-03-13 12:10:14,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:14,802 [INFO]: 	Creating the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,802 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:14
2025-03-13 12:10:14,805 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 12:10:14,805 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:14
2025-03-13 12:10:14,805 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:10:14,805 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.12it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.26it/s] 64%|██████▎   | 7/11 [00:00<00:00, 22.35it/s]100%|██████████| 11/11 [00:02<00:00,  2.82it/s]100%|██████████| 11/11 [00:03<00:00,  3.67it/s]
2025-03-13 12:10:17,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:17
2025-03-13 12:10:57,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2149 secs
2025-03-13 12:10:57,027 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 12:10:57,027 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.66it/s]
2025-03-13 12:11:12,801 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7739 secs
2025-03-13 12:11:12,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9978 secs
2025-03-13 12:11:12,803 [INFO]: {
2025-03-13 12:11:12,803 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:12,803 [INFO]: 	index_param: efSearch=186
2025-03-13 12:11:12,803 [INFO]: 	index_path: knn.index
2025-03-13 12:11:12,803 [INFO]: 	size in bytes: 525306010
2025-03-13 12:11:12,803 [INFO]: 	avg_search_speed_ms: 8.728795552408457
2025-03-13 12:11:12,803 [INFO]: 	99p_search_speed_ms: 12.316392979118973
2025-03-13 12:11:12,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:12,803 [INFO]: 	nb vectors: 2670
2025-03-13 12:11:12,803 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:12,803 [INFO]: 	compression ratio: 0.9993096404893597
2025-03-13 12:11:12,803 [INFO]: }
2025-03-13 12:11:12,803 [INFO]: 	>>> Finished "Creating the index" in 58.0008 secs
2025-03-13 12:11:12,803 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0403 secs
2025-03-13 12:11:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 22912 [episode count 0/20]
[retrieval_preprocessing] for episode 38407 [episode count 1/20], we have num_retrieval=np.int64(2663) num_query=np.int64(139)
2025-03-13 12:11:14,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:14,726 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:14
2025-03-13 12:11:14,726 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-13 12:11:14,754 [INFO]: There are 2663 embeddings of dim 49152
2025-03-13 12:11:14,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 12:11:14,754 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:14,754 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:11:14,754 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:14,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:11:14,754 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,754 [INFO]: 549.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:14,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:14,754 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:14
2025-03-13 12:11:14,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:14,754 [INFO]: 	Creating the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,754 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:14
2025-03-13 12:11:14,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:11:14,756 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:14
2025-03-13 12:11:14,756 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:11:14,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.71it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.49it/s]100%|██████████| 11/11 [00:02<00:00,  5.19it/s]
2025-03-13 12:11:16,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:16
2025-03-13 12:11:49,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3295 secs
2025-03-13 12:11:49,310 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:11:49,310 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-13 12:12:04,576 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2659 secs
2025-03-13 12:12:04,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8224 secs
2025-03-13 12:12:04,578 [INFO]: {
2025-03-13 12:12:04,578 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:04,578 [INFO]: 	index_param: efSearch=235
2025-03-13 12:12:04,578 [INFO]: 	index_path: knn.index
2025-03-13 12:12:04,578 [INFO]: 	size in bytes: 523928830
2025-03-13 12:12:04,578 [INFO]: 	avg_search_speed_ms: 10.61756271427011
2025-03-13 12:12:04,578 [INFO]: 	99p_search_speed_ms: 15.926652743946768
2025-03-13 12:12:04,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:04,578 [INFO]: 	nb vectors: 2663
2025-03-13 12:12:04,578 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:04,578 [INFO]: 	compression ratio: 0.9993095894341222
2025-03-13 12:12:04,578 [INFO]: }
2025-03-13 12:12:04,578 [INFO]: 	>>> Finished "Creating the index" in 49.8239 secs
2025-03-13 12:12:04,578 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8524 secs
2025-03-13 12:12:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 38407 [episode count 1/20]
[retrieval_preprocessing] for episode 14986 [episode count 2/20], we have num_retrieval=np.int64(2667) num_query=np.int64(135)
2025-03-13 12:12:06,069 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:06,428 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:06
2025-03-13 12:12:06,429 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1885.08it/s]
2025-03-13 12:12:06,459 [INFO]: There are 2667 embeddings of dim 49152
2025-03-13 12:12:06,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 12:12:06,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:06
2025-03-13 12:12:06,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:06,460 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:12:06,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:06,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:12:06,460 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:06
2025-03-13 12:12:06,460 [INFO]: 550.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:06,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:12:06,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:06
2025-03-13 12:12:06,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:06,460 [INFO]: 	Creating the index 03/13/2025, 12:12:06
2025-03-13 12:12:06,460 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:06
2025-03-13 12:12:06,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:12:06,461 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:06
2025-03-13 12:12:06,461 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:12:06,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.83it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]100%|██████████| 11/11 [00:02<00:00,  5.20it/s]
2025-03-13 12:12:08,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:08
2025-03-13 12:12:44,693 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1111 secs
2025-03-13 12:12:44,693 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 12:12:44,693 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 12:12:59,288 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5942 secs
2025-03-13 12:12:59,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8304 secs
2025-03-13 12:12:59,292 [INFO]: {
2025-03-13 12:12:59,292 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:59,292 [INFO]: 	index_param: efSearch=216
2025-03-13 12:12:59,292 [INFO]: 	index_path: knn.index
2025-03-13 12:12:59,292 [INFO]: 	size in bytes: 524715790
2025-03-13 12:12:59,293 [INFO]: 	avg_search_speed_ms: 10.002280778018758
2025-03-13 12:12:59,293 [INFO]: 	99p_search_speed_ms: 17.368785080034286
2025-03-13 12:12:59,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:59,293 [INFO]: 	nb vectors: 2667
2025-03-13 12:12:59,293 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:59,293 [INFO]: 	compression ratio: 0.9993096186413601
2025-03-13 12:12:59,293 [INFO]: }
2025-03-13 12:12:59,293 [INFO]: 	>>> Finished "Creating the index" in 52.8326 secs
2025-03-13 12:12:59,293 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8643 secs
2025-03-13 12:13:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 14986 [episode count 2/20]
[retrieval_preprocessing] for episode 10512 [episode count 3/20], we have num_retrieval=np.int64(2660) num_query=np.int64(142)
2025-03-13 12:13:01,086 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:01,589 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:01
2025-03-13 12:13:01,589 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2083.61it/s]
2025-03-13 12:13:01,620 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 12:13:01,621 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 12:13:01,621 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:01
2025-03-13 12:13:01,621 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:01,621 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:13:01,621 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:01,621 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:01,621 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:01
2025-03-13 12:13:01,621 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:01,621 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:13:01,621 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:01
2025-03-13 12:13:01,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:01,621 [INFO]: 	Creating the index 03/13/2025, 12:13:01
2025-03-13 12:13:01,621 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:01
2025-03-13 12:13:01,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:13:01,623 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:01
2025-03-13 12:13:01,623 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:13:01,623 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.98it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.26it/s]100%|██████████| 11/11 [00:02<00:00,  3.55it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]
2025-03-13 12:13:04,245 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:04
2025-03-13 12:13:35,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4612 secs
2025-03-13 12:13:35,707 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:13:35,707 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 12:13:53,803 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0955 secs
2025-03-13 12:13:53,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1818 secs
2025-03-13 12:13:53,805 [INFO]: {
2025-03-13 12:13:53,805 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:53,805 [INFO]: 	index_param: efSearch=204
2025-03-13 12:13:53,805 [INFO]: 	index_path: knn.index
2025-03-13 12:13:53,805 [INFO]: 	size in bytes: 523338610
2025-03-13 12:13:53,805 [INFO]: 	avg_search_speed_ms: 10.120014965238223
2025-03-13 12:13:53,805 [INFO]: 	99p_search_speed_ms: 15.585479710716754
2025-03-13 12:13:53,805 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:53,805 [INFO]: 	nb vectors: 2660
2025-03-13 12:13:53,805 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:53,805 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 12:13:53,805 [INFO]: }
2025-03-13 12:13:53,805 [INFO]: 	>>> Finished "Creating the index" in 52.1836 secs
2025-03-13 12:13:53,805 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2157 secs
2025-03-13 12:13:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 10512 [episode count 3/20]
[retrieval_preprocessing] for episode 75536 [episode count 4/20], we have num_retrieval=np.int64(2679) num_query=np.int64(123)
2025-03-13 12:13:55,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:55,506 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:55
2025-03-13 12:13:55,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2330.17it/s]
2025-03-13 12:13:55,530 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 12:13:55,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 12:13:55,530 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:55
2025-03-13 12:13:55,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:55,530 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:13:55,530 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:55,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:55,530 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:55
2025-03-13 12:13:55,530 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:55,530 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:55,530 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:55
2025-03-13 12:13:55,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:55,531 [INFO]: 	Creating the index 03/13/2025, 12:13:55
2025-03-13 12:13:55,531 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:55
2025-03-13 12:13:55,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:13:55,532 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:55
2025-03-13 12:13:55,532 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:13:55,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.11it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.74it/s]100%|██████████| 11/11 [00:02<00:00,  5.29it/s]
2025-03-13 12:13:57,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:57
2025-03-13 12:14:37,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4951 secs
2025-03-13 12:14:37,113 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 12:14:37,113 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-13 12:14:56,112 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9992 secs
2025-03-13 12:14:56,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5833 secs
2025-03-13 12:14:56,115 [INFO]: {
2025-03-13 12:14:56,115 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:56,115 [INFO]: 	index_param: efSearch=235
2025-03-13 12:14:56,115 [INFO]: 	index_path: knn.index
2025-03-13 12:14:56,115 [INFO]: 	size in bytes: 527076670
2025-03-13 12:14:56,115 [INFO]: 	avg_search_speed_ms: 9.264327137498185
2025-03-13 12:14:56,115 [INFO]: 	99p_search_speed_ms: 13.105373962316667
2025-03-13 12:14:56,115 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:56,115 [INFO]: 	nb vectors: 2679
2025-03-13 12:14:56,115 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:56,115 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 12:14:56,115 [INFO]: }
2025-03-13 12:14:56,115 [INFO]: 	>>> Finished "Creating the index" in 60.5849 secs
2025-03-13 12:14:56,115 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6096 secs
2025-03-13 12:14:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 75536 [episode count 4/20]
[retrieval_preprocessing] for episode 48026 [episode count 5/20], we have num_retrieval=np.int64(2677) num_query=np.int64(125)
2025-03-13 12:14:58,037 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:58,512 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:58
2025-03-13 12:14:58,512 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-13 12:14:58,544 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 12:14:58,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-13 12:14:58,545 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:58
2025-03-13 12:14:58,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:58,545 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:14:58,545 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:58,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:14:58,545 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:58
2025-03-13 12:14:58,545 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:58,545 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:14:58,545 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:58
2025-03-13 12:14:58,545 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:58,545 [INFO]: 	Creating the index 03/13/2025, 12:14:58
2025-03-13 12:14:58,545 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:58
2025-03-13 12:14:58,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:14:58,546 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:58
2025-03-13 12:14:58,547 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:14:58,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.80it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]100%|██████████| 11/11 [00:02<00:00,  5.21it/s]
2025-03-13 12:15:00,660 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:00
2025-03-13 12:15:39,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5187 secs
2025-03-13 12:15:39,180 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:15:39,180 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.52it/s]
2025-03-13 12:15:54,202 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0214 secs
2025-03-13 12:15:54,204 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6574 secs
2025-03-13 12:15:54,204 [INFO]: {
2025-03-13 12:15:54,204 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:54,204 [INFO]: 	index_param: efSearch=194
2025-03-13 12:15:54,204 [INFO]: 	index_path: knn.index
2025-03-13 12:15:54,204 [INFO]: 	size in bytes: 526683190
2025-03-13 12:15:54,204 [INFO]: 	avg_search_speed_ms: 8.581395706465635
2025-03-13 12:15:54,204 [INFO]: 	99p_search_speed_ms: 11.448623621836305
2025-03-13 12:15:54,204 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:54,204 [INFO]: 	nb vectors: 2677
2025-03-13 12:15:54,204 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:54,204 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 12:15:54,204 [INFO]: }
2025-03-13 12:15:54,204 [INFO]: 	>>> Finished "Creating the index" in 55.6592 secs
2025-03-13 12:15:54,204 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6920 secs
2025-03-13 12:15:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 48026 [episode count 5/20]
[retrieval_preprocessing] for episode 76699 [episode count 6/20], we have num_retrieval=np.int64(2662) num_query=np.int64(140)
2025-03-13 12:15:55,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:55,736 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:55
2025-03-13 12:15:55,736 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.41it/s]
2025-03-13 12:15:55,768 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 12:15:55,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:15:55,768 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:55
2025-03-13 12:15:55,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:55,768 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:15:55,768 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:55,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:55,769 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:55
2025-03-13 12:15:55,769 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:55,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:15:55,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:55
2025-03-13 12:15:55,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:55,769 [INFO]: 	Creating the index 03/13/2025, 12:15:55
2025-03-13 12:15:55,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:55
2025-03-13 12:15:55,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:15:55,770 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:55
2025-03-13 12:15:55,770 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:15:55,770 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.94it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.77it/s]100%|██████████| 11/11 [00:01<00:00,  4.79it/s]100%|██████████| 11/11 [00:01<00:00,  5.79it/s]
2025-03-13 12:15:57,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:57
2025-03-13 12:16:27,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3951 secs
2025-03-13 12:16:27,069 [INFO]: The best hyperparameters are: efSearch=199
2025-03-13 12:16:27,069 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 12:16:44,837 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7672 secs
2025-03-13 12:16:44,838 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0687 secs
2025-03-13 12:16:44,839 [INFO]: {
2025-03-13 12:16:44,839 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:44,839 [INFO]: 	index_param: efSearch=199
2025-03-13 12:16:44,839 [INFO]: 	index_path: knn.index
2025-03-13 12:16:44,839 [INFO]: 	size in bytes: 523732090
2025-03-13 12:16:44,839 [INFO]: 	avg_search_speed_ms: 7.54765303735182
2025-03-13 12:16:44,839 [INFO]: 	99p_search_speed_ms: 10.086342114955187
2025-03-13 12:16:44,839 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:44,839 [INFO]: 	nb vectors: 2662
2025-03-13 12:16:44,839 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:44,839 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 12:16:44,839 [INFO]: }
2025-03-13 12:16:44,839 [INFO]: 	>>> Finished "Creating the index" in 49.0700 secs
2025-03-13 12:16:44,839 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1032 secs
2025-03-13 12:16:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 76699 [episode count 6/20]
[retrieval_preprocessing] for episode 89115 [episode count 7/20], we have num_retrieval=np.int64(2633) num_query=np.int64(169)
2025-03-13 12:16:47,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:47,694 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:47
2025-03-13 12:16:47,694 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.15it/s]
2025-03-13 12:16:47,727 [INFO]: There are 2633 embeddings of dim 49152
2025-03-13 12:16:47,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 12:16:47,728 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:47
2025-03-13 12:16:47,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:47,728 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:16:47,728 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:47,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:16:47,728 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:47
2025-03-13 12:16:47,729 [INFO]: 543.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:47,729 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:16:47,729 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:47
2025-03-13 12:16:47,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:47,729 [INFO]: 	Creating the index 03/13/2025, 12:16:47
2025-03-13 12:16:47,730 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:47
2025-03-13 12:16:47,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:16:47,733 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:47
2025-03-13 12:16:47,733 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:16:47,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.80it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.29it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.90it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.23it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.41it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.70it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.74it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.73it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.68it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.73it/s]100%|██████████| 11/11 [00:03<00:00,  1.40it/s]100%|██████████| 11/11 [00:03<00:00,  3.37it/s]
2025-03-13 12:16:51,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:51
2025-03-13 12:17:26,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4002 secs
2025-03-13 12:17:26,406 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 12:17:26,406 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-13 12:17:43,737 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3310 secs
2025-03-13 12:17:43,739 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0056 secs
2025-03-13 12:17:43,739 [INFO]: {
2025-03-13 12:17:43,739 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:43,739 [INFO]: 	index_param: efSearch=186
2025-03-13 12:17:43,739 [INFO]: 	index_path: knn.index
2025-03-13 12:17:43,739 [INFO]: 	size in bytes: 518026630
2025-03-13 12:17:43,739 [INFO]: 	avg_search_speed_ms: 8.573219963863785
2025-03-13 12:17:43,739 [INFO]: 	99p_search_speed_ms: 10.738291370216754
2025-03-13 12:17:43,739 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:43,739 [INFO]: 	nb vectors: 2633
2025-03-13 12:17:43,739 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:43,739 [INFO]: 	compression ratio: 0.9993093675512396
2025-03-13 12:17:43,739 [INFO]: }
2025-03-13 12:17:43,739 [INFO]: 	>>> Finished "Creating the index" in 56.0095 secs
2025-03-13 12:17:43,739 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0453 secs
2025-03-13 12:17:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 89115 [episode count 7/20]
[retrieval_preprocessing] for episode 80416 [episode count 8/20], we have num_retrieval=np.int64(2695) num_query=np.int64(107)
2025-03-13 12:17:45,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:45,729 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:45
2025-03-13 12:17:45,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1885.08it/s]
2025-03-13 12:17:45,758 [INFO]: There are 2695 embeddings of dim 49152
2025-03-13 12:17:45,758 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 12:17:45,759 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:45
2025-03-13 12:17:45,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:45,759 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:17:45,759 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:45,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:17:45,759 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:45
2025-03-13 12:17:45,760 [INFO]: 556.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:45,760 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:17:45,760 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:45
2025-03-13 12:17:45,760 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:45,760 [INFO]: 	Creating the index 03/13/2025, 12:17:45
2025-03-13 12:17:45,760 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:45
2025-03-13 12:17:45,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:17:45,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:45
2025-03-13 12:17:45,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:17:45,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.94it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]100%|██████████| 11/11 [00:02<00:00,  5.47it/s]
2025-03-13 12:17:47,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:47
2025-03-13 12:18:22,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6355 secs
2025-03-13 12:18:22,418 [INFO]: The best hyperparameters are: efSearch=195
2025-03-13 12:18:22,418 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.35it/s]
2025-03-13 12:18:36,696 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2778 secs
2025-03-13 12:18:36,698 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9339 secs
2025-03-13 12:18:36,698 [INFO]: {
2025-03-13 12:18:36,698 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:36,698 [INFO]: 	index_param: efSearch=195
2025-03-13 12:18:36,698 [INFO]: 	index_path: knn.index
2025-03-13 12:18:36,698 [INFO]: 	size in bytes: 530224510
2025-03-13 12:18:36,698 [INFO]: 	avg_search_speed_ms: 11.23920916239574
2025-03-13 12:18:36,698 [INFO]: 	99p_search_speed_ms: 15.613619019277396
2025-03-13 12:18:36,698 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:36,698 [INFO]: 	nb vectors: 2695
2025-03-13 12:18:36,698 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:36,698 [INFO]: 	compression ratio: 0.9993098206644577
2025-03-13 12:18:36,698 [INFO]: }
2025-03-13 12:18:36,698 [INFO]: 	>>> Finished "Creating the index" in 50.9381 secs
2025-03-13 12:18:36,698 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9694 secs
2025-03-13 12:18:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 80416 [episode count 8/20]
[retrieval_preprocessing] for episode 79794 [episode count 9/20], we have num_retrieval=np.int64(2671) num_query=np.int64(131)
2025-03-13 12:18:37,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:38,246 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:38
2025-03-13 12:18:38,246 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.57it/s]
2025-03-13 12:18:38,278 [INFO]: There are 2671 embeddings of dim 49152
2025-03-13 12:18:38,278 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 12:18:38,278 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:38
2025-03-13 12:18:38,278 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:38,278 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:18:38,278 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:38,278 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:38,278 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:38
2025-03-13 12:18:38,279 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:38,279 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:18:38,279 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:38
2025-03-13 12:18:38,279 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:38,279 [INFO]: 	Creating the index 03/13/2025, 12:18:38
2025-03-13 12:18:38,279 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:38
2025-03-13 12:18:38,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:18:38,280 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:38
2025-03-13 12:18:38,280 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:18:38,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.42it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.37it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]100%|██████████| 11/11 [00:02<00:00,  5.46it/s]
2025-03-13 12:18:40,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:40
2025-03-13 12:19:10,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3866 secs
2025-03-13 12:19:10,687 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:19:10,687 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.63it/s]
2025-03-13 12:19:26,044 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3576 secs
2025-03-13 12:19:26,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2015 secs
2025-03-13 12:19:26,482 [INFO]: {
2025-03-13 12:19:26,482 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:26,482 [INFO]: 	index_param: efSearch=231
2025-03-13 12:19:26,482 [INFO]: 	index_path: knn.index
2025-03-13 12:19:26,482 [INFO]: 	size in bytes: 525502750
2025-03-13 12:19:26,482 [INFO]: 	avg_search_speed_ms: 12.32884386720873
2025-03-13 12:19:26,482 [INFO]: 	99p_search_speed_ms: 19.730360619723797
2025-03-13 12:19:26,482 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:26,482 [INFO]: 	nb vectors: 2671
2025-03-13 12:19:26,482 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:26,482 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-13 12:19:26,483 [INFO]: }
2025-03-13 12:19:26,483 [INFO]: 	>>> Finished "Creating the index" in 48.2038 secs
2025-03-13 12:19:26,483 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2364 secs
2025-03-13 12:19:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 79794 [episode count 9/20]
[retrieval_preprocessing] for episode 3894 [episode count 10/20], we have num_retrieval=np.int64(2665) num_query=np.int64(137)
2025-03-13 12:19:27,931 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:28,330 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:28
2025-03-13 12:19:28,331 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1034.10it/s]
2025-03-13 12:19:28,359 [INFO]: There are 2665 embeddings of dim 49152
2025-03-13 12:19:28,360 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 12:19:28,360 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:28
2025-03-13 12:19:28,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:28,360 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:19:28,360 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:28,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:28,360 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:28
2025-03-13 12:19:28,360 [INFO]: 550.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:28,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:19:28,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:28
2025-03-13 12:19:28,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:28,360 [INFO]: 	Creating the index 03/13/2025, 12:19:28
2025-03-13 12:19:28,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:28
2025-03-13 12:19:28,361 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:19:28,361 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:28
2025-03-13 12:19:28,361 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:19:28,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.98it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.18it/s]100%|██████████| 11/11 [00:01<00:00,  4.79it/s]100%|██████████| 11/11 [00:01<00:00,  5.90it/s]
2025-03-13 12:19:30,229 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:30
2025-03-13 12:19:59,349 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1196 secs
2025-03-13 12:19:59,349 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:19:59,350 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.12it/s]
2025-03-13 12:20:13,847 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4974 secs
2025-03-13 12:20:13,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4880 secs
2025-03-13 12:20:13,850 [INFO]: {
2025-03-13 12:20:13,850 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:13,850 [INFO]: 	index_param: efSearch=208
2025-03-13 12:20:13,850 [INFO]: 	index_path: knn.index
2025-03-13 12:20:13,850 [INFO]: 	size in bytes: 524322310
2025-03-13 12:20:13,850 [INFO]: 	avg_search_speed_ms: 8.72712180544224
2025-03-13 12:20:13,850 [INFO]: 	99p_search_speed_ms: 11.18208629777655
2025-03-13 12:20:13,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:13,850 [INFO]: 	nb vectors: 2665
2025-03-13 12:20:13,850 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:13,850 [INFO]: 	compression ratio: 0.9993096040487005
2025-03-13 12:20:13,850 [INFO]: }
2025-03-13 12:20:13,850 [INFO]: 	>>> Finished "Creating the index" in 45.4896 secs
2025-03-13 12:20:13,850 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5192 secs
2025-03-13 12:20:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 3894 [episode count 10/20]
[retrieval_preprocessing] for episode 20662 [episode count 11/20], we have num_retrieval=np.int64(2657) num_query=np.int64(145)
2025-03-13 12:20:15,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:15,945 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:15
2025-03-13 12:20:15,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.24it/s]
2025-03-13 12:20:15,987 [INFO]: There are 2657 embeddings of dim 49152
2025-03-13 12:20:15,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0417 secs
2025-03-13 12:20:15,988 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:15
2025-03-13 12:20:15,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:15,988 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:20:15,988 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:15,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:20:15,988 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:15
2025-03-13 12:20:15,988 [INFO]: 548.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:15,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:20:15,988 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:15
2025-03-13 12:20:15,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:15,988 [INFO]: 	Creating the index 03/13/2025, 12:20:15
2025-03-13 12:20:15,988 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:15
2025-03-13 12:20:15,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 12:20:15,991 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:15
2025-03-13 12:20:15,991 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:20:15,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.77it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]100%|██████████| 11/11 [00:02<00:00,  4.94it/s]
2025-03-13 12:20:18,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:18
2025-03-13 12:20:49,941 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7174 secs
2025-03-13 12:20:49,941 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 12:20:49,941 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.86it/s]
2025-03-13 12:21:04,245 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3035 secs
2025-03-13 12:21:04,246 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2558 secs
2025-03-13 12:21:04,247 [INFO]: {
2025-03-13 12:21:04,247 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:04,247 [INFO]: 	index_param: efSearch=225
2025-03-13 12:21:04,247 [INFO]: 	index_path: knn.index
2025-03-13 12:21:04,247 [INFO]: 	size in bytes: 522748390
2025-03-13 12:21:04,247 [INFO]: 	avg_search_speed_ms: 10.203747300203053
2025-03-13 12:21:04,247 [INFO]: 	99p_search_speed_ms: 13.984747831709686
2025-03-13 12:21:04,247 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:04,247 [INFO]: 	nb vectors: 2657
2025-03-13 12:21:04,247 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:04,247 [INFO]: 	compression ratio: 0.9993095454583801
2025-03-13 12:21:04,247 [INFO]: }
2025-03-13 12:21:04,247 [INFO]: 	>>> Finished "Creating the index" in 48.2583 secs
2025-03-13 12:21:04,247 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3012 secs
2025-03-13 12:21:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 20662 [episode count 11/20]
[retrieval_preprocessing] for episode 41539 [episode count 12/20], we have num_retrieval=np.int64(2644) num_query=np.int64(158)
2025-03-13 12:21:06,138 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:06,704 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:06
2025-03-13 12:21:06,704 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1680.41it/s]
2025-03-13 12:21:06,736 [INFO]: There are 2644 embeddings of dim 49152
2025-03-13 12:21:06,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 12:21:06,736 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:06
2025-03-13 12:21:06,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:06,737 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:21:06,737 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:06,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:06,737 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:06
2025-03-13 12:21:06,737 [INFO]: 545.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:06,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:21:06,737 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:06
2025-03-13 12:21:06,737 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:06,737 [INFO]: 	Creating the index 03/13/2025, 12:21:06
2025-03-13 12:21:06,737 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:06
2025-03-13 12:21:06,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:21:06,738 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:06
2025-03-13 12:21:06,738 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:21:06,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.90it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.99it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.97it/s]100%|██████████| 11/11 [00:03<00:00,  3.65it/s]
2025-03-13 12:21:09,755 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:09
2025-03-13 12:21:47,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6703 secs
2025-03-13 12:21:47,426 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 12:21:47,426 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.72it/s]
2025-03-13 12:22:00,974 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5481 secs
2025-03-13 12:22:01,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4748 secs
2025-03-13 12:22:01,214 [INFO]: {
2025-03-13 12:22:01,214 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:01,214 [INFO]: 	index_param: efSearch=192
2025-03-13 12:22:01,214 [INFO]: 	index_path: knn.index
2025-03-13 12:22:01,214 [INFO]: 	size in bytes: 520190770
2025-03-13 12:22:01,214 [INFO]: 	avg_search_speed_ms: 9.947607166305259
2025-03-13 12:22:01,214 [INFO]: 	99p_search_speed_ms: 15.480595072731376
2025-03-13 12:22:01,214 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:01,214 [INFO]: 	nb vectors: 2644
2025-03-13 12:22:01,214 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:01,214 [INFO]: 	compression ratio: 0.9993094494929236
2025-03-13 12:22:01,214 [INFO]: }
2025-03-13 12:22:01,214 [INFO]: 	>>> Finished "Creating the index" in 54.4773 secs
2025-03-13 12:22:01,214 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5100 secs
2025-03-13 12:22:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 41539 [episode count 12/20]
[retrieval_preprocessing] for episode 73053 [episode count 13/20], we have num_retrieval=np.int64(2681) num_query=np.int64(121)
2025-03-13 12:22:02,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:03,332 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:03
2025-03-13 12:22:03,332 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2020.38it/s]
2025-03-13 12:22:03,362 [INFO]: There are 2681 embeddings of dim 49152
2025-03-13 12:22:03,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 12:22:03,362 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:03,362 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:22:03,362 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:03,362 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:03,362 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,363 [INFO]: 553.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:03,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:22:03,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:03
2025-03-13 12:22:03,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:03,363 [INFO]: 	Creating the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:03
2025-03-13 12:22:03,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:22:03,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:03
2025-03-13 12:22:03,364 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:22:03,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.89it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.77it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.55it/s]
2025-03-13 12:22:05,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:05
2025-03-13 12:22:38,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4948 secs
2025-03-13 12:22:38,281 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 12:22:38,281 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.97it/s]
2025-03-13 12:22:59,583 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3021 secs
2025-03-13 12:22:59,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2206 secs
2025-03-13 12:22:59,585 [INFO]: {
2025-03-13 12:22:59,585 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:59,585 [INFO]: 	index_param: efSearch=272
2025-03-13 12:22:59,585 [INFO]: 	index_path: knn.index
2025-03-13 12:22:59,585 [INFO]: 	size in bytes: 527470150
2025-03-13 12:22:59,585 [INFO]: 	avg_search_speed_ms: 10.813840703434638
2025-03-13 12:22:59,585 [INFO]: 	99p_search_speed_ms: 17.489229971542954
2025-03-13 12:22:59,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:59,585 [INFO]: 	nb vectors: 2681
2025-03-13 12:22:59,585 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:59,585 [INFO]: 	compression ratio: 0.9993097201803742
2025-03-13 12:22:59,585 [INFO]: }
2025-03-13 12:22:59,585 [INFO]: 	>>> Finished "Creating the index" in 56.2222 secs
2025-03-13 12:22:59,585 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2529 secs
2025-03-13 12:23:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 73053 [episode count 13/20]
[retrieval_preprocessing] for episode 24032 [episode count 14/20], we have num_retrieval=np.int64(2658) num_query=np.int64(144)
2025-03-13 12:23:02,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:03,023 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:03
2025-03-13 12:23:03,023 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2115.13it/s]
2025-03-13 12:23:03,052 [INFO]: There are 2658 embeddings of dim 49152
2025-03-13 12:23:03,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 12:23:03,052 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:03
2025-03-13 12:23:03,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:03,052 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:23:03,052 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:03,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:03,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:03
2025-03-13 12:23:03,052 [INFO]: 548.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:03,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:23:03,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:03
2025-03-13 12:23:03,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:03,053 [INFO]: 	Creating the index 03/13/2025, 12:23:03
2025-03-13 12:23:03,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:03
2025-03-13 12:23:03,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:23:03,055 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:03
2025-03-13 12:23:03,055 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:23:03,055 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 24.96it/s] 73%|███████▎  | 8/11 [00:00<00:00, 36.75it/s]100%|██████████| 11/11 [00:02<00:00,  5.24it/s]
2025-03-13 12:23:05,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:05
2025-03-13 12:23:40,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7000 secs
2025-03-13 12:23:40,859 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 12:23:40,859 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-13 12:23:56,035 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1756 secs
2025-03-13 12:23:56,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9819 secs
2025-03-13 12:23:56,037 [INFO]: {
2025-03-13 12:23:56,037 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:56,037 [INFO]: 	index_param: efSearch=242
2025-03-13 12:23:56,037 [INFO]: 	index_path: knn.index
2025-03-13 12:23:56,037 [INFO]: 	size in bytes: 522945130
2025-03-13 12:23:56,037 [INFO]: 	avg_search_speed_ms: 9.965609846751677
2025-03-13 12:23:56,037 [INFO]: 	99p_search_speed_ms: 12.744976063258948
2025-03-13 12:23:56,037 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:56,037 [INFO]: 	nb vectors: 2658
2025-03-13 12:23:56,037 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:56,037 [INFO]: 	compression ratio: 0.9993095528014574
2025-03-13 12:23:56,037 [INFO]: }
2025-03-13 12:23:56,037 [INFO]: 	>>> Finished "Creating the index" in 52.9841 secs
2025-03-13 12:23:56,037 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0140 secs
2025-03-13 12:23:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 24032 [episode count 14/20]
[retrieval_preprocessing] for episode 11253 [episode count 15/20], we have num_retrieval=np.int64(2662) num_query=np.int64(140)
2025-03-13 12:23:57,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:58,333 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:58
2025-03-13 12:23:58,333 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1630.76it/s]
2025-03-13 12:23:58,362 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 12:23:58,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 12:23:58,363 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:58
2025-03-13 12:23:58,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:58,363 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:23:58,363 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:58,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:23:58,363 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:58
2025-03-13 12:23:58,363 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:58,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:23:58,363 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:58
2025-03-13 12:23:58,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:58,363 [INFO]: 	Creating the index 03/13/2025, 12:23:58
2025-03-13 12:23:58,363 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:58
2025-03-13 12:23:58,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:23:58,365 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:58
2025-03-13 12:23:58,365 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:23:58,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.83it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.32it/s]100%|██████████| 11/11 [00:02<00:00,  3.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]
2025-03-13 12:24:00,947 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:00
2025-03-13 12:24:36,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2067 secs
2025-03-13 12:24:36,154 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 12:24:36,154 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.99it/s]
2025-03-13 12:24:48,901 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7464 secs
2025-03-13 12:24:48,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5376 secs
2025-03-13 12:24:48,902 [INFO]: {
2025-03-13 12:24:48,902 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:48,902 [INFO]: 	index_param: efSearch=208
2025-03-13 12:24:48,902 [INFO]: 	index_path: knn.index
2025-03-13 12:24:48,902 [INFO]: 	size in bytes: 523732090
2025-03-13 12:24:48,902 [INFO]: 	avg_search_speed_ms: 9.239983374369976
2025-03-13 12:24:48,903 [INFO]: 	99p_search_speed_ms: 12.649953027721498
2025-03-13 12:24:48,903 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:48,903 [INFO]: 	nb vectors: 2662
2025-03-13 12:24:48,903 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:48,903 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 12:24:48,903 [INFO]: }
2025-03-13 12:24:48,903 [INFO]: 	>>> Finished "Creating the index" in 50.5393 secs
2025-03-13 12:24:48,903 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5696 secs
2025-03-13 12:24:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 11253 [episode count 15/20]
[retrieval_preprocessing] for episode 60403 [episode count 16/20], we have num_retrieval=np.int64(2647) num_query=np.int64(155)
2025-03-13 12:24:50,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:50,453 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:50
2025-03-13 12:24:50,453 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 12:24:50,480 [INFO]: There are 2647 embeddings of dim 49152
2025-03-13 12:24:50,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 12:24:50,480 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:50
2025-03-13 12:24:50,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:50,480 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:24:50,480 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:50,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:24:50,480 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:50
2025-03-13 12:24:50,480 [INFO]: 546.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:50,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:50,481 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:50
2025-03-13 12:24:50,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:50,481 [INFO]: 	Creating the index 03/13/2025, 12:24:50
2025-03-13 12:24:50,481 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:50
2025-03-13 12:24:50,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:24:50,482 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:50
2025-03-13 12:24:50,482 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:24:50,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.11it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.66it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.81it/s]100%|██████████| 11/11 [00:02<00:00,  5.34it/s]
2025-03-13 12:24:52,544 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:52
2025-03-13 12:25:26,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9186 secs
2025-03-13 12:25:26,463 [INFO]: The best hyperparameters are: efSearch=174
2025-03-13 12:25:26,464 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.31it/s]
2025-03-13 12:25:44,869 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4055 secs
2025-03-13 12:25:44,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3906 secs
2025-03-13 12:25:44,873 [INFO]: {
2025-03-13 12:25:44,873 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:44,873 [INFO]: 	index_param: efSearch=174
2025-03-13 12:25:44,873 [INFO]: 	index_path: knn.index
2025-03-13 12:25:44,873 [INFO]: 	size in bytes: 520780990
2025-03-13 12:25:44,873 [INFO]: 	avg_search_speed_ms: 10.301390903772658
2025-03-13 12:25:44,873 [INFO]: 	99p_search_speed_ms: 16.28006540704518
2025-03-13 12:25:44,873 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:44,873 [INFO]: 	nb vectors: 2647
2025-03-13 12:25:44,873 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:44,873 [INFO]: 	compression ratio: 0.9993094717224605
2025-03-13 12:25:44,873 [INFO]: }
2025-03-13 12:25:44,873 [INFO]: 	>>> Finished "Creating the index" in 54.3926 secs
2025-03-13 12:25:44,873 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4199 secs
2025-03-13 12:25:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 60403 [episode count 16/20]
[retrieval_preprocessing] for episode 82166 [episode count 17/20], we have num_retrieval=np.int64(2648) num_query=np.int64(154)
2025-03-13 12:25:46,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:47,052 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:47
2025-03-13 12:25:47,053 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2083.61it/s]
2025-03-13 12:25:47,086 [INFO]: There are 2648 embeddings of dim 49152
2025-03-13 12:25:47,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 12:25:47,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:47
2025-03-13 12:25:47,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:47,086 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:25:47,086 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:47,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:47,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:47
2025-03-13 12:25:47,087 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:47,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:25:47,087 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:47
2025-03-13 12:25:47,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:47,087 [INFO]: 	Creating the index 03/13/2025, 12:25:47
2025-03-13 12:25:47,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:47
2025-03-13 12:25:47,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:25:47,088 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:47
2025-03-13 12:25:47,088 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:25:47,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.19it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.61it/s]100%|██████████| 11/11 [00:01<00:00,  4.89it/s]100%|██████████| 11/11 [00:01<00:00,  5.70it/s]
2025-03-13 12:25:49,019 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:49
2025-03-13 12:26:20,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0708 secs
2025-03-13 12:26:20,091 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:26:20,091 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.37it/s]
2025-03-13 12:26:35,647 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5561 secs
2025-03-13 12:26:35,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5611 secs
2025-03-13 12:26:35,649 [INFO]: {
2025-03-13 12:26:35,649 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:35,649 [INFO]: 	index_param: efSearch=222
2025-03-13 12:26:35,649 [INFO]: 	index_path: knn.index
2025-03-13 12:26:35,649 [INFO]: 	size in bytes: 520977730
2025-03-13 12:26:35,649 [INFO]: 	avg_search_speed_ms: 9.605772704947078
2025-03-13 12:26:35,649 [INFO]: 	99p_search_speed_ms: 12.906389730051156
2025-03-13 12:26:35,649 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:35,649 [INFO]: 	nb vectors: 2648
2025-03-13 12:26:35,649 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:35,649 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-13 12:26:35,649 [INFO]: }
2025-03-13 12:26:35,650 [INFO]: 	>>> Finished "Creating the index" in 48.5626 secs
2025-03-13 12:26:35,650 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5970 secs
2025-03-13 12:26:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 82166 [episode count 17/20]
[retrieval_preprocessing] for episode 83958 [episode count 18/20], we have num_retrieval=np.int64(2678) num_query=np.int64(124)
2025-03-13 12:26:37,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:37,763 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:37
2025-03-13 12:26:37,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.75it/s]
2025-03-13 12:26:37,795 [INFO]: There are 2678 embeddings of dim 49152
2025-03-13 12:26:37,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 12:26:37,795 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:37
2025-03-13 12:26:37,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:37,795 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:26:37,795 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:37,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:26:37,795 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:37
2025-03-13 12:26:37,795 [INFO]: 552.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:37,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:26:37,795 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:37
2025-03-13 12:26:37,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:37,795 [INFO]: 	Creating the index 03/13/2025, 12:26:37
2025-03-13 12:26:37,796 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:37
2025-03-13 12:26:37,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:26:37,797 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:37
2025-03-13 12:26:37,797 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:26:37,797 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.42it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.82it/s] 82%|████████▏ | 9/11 [00:00<00:00, 30.66it/s]100%|██████████| 11/11 [00:02<00:00,  4.30it/s]
2025-03-13 12:26:40,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:40
2025-03-13 12:27:16,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5764 secs
2025-03-13 12:27:16,935 [INFO]: The best hyperparameters are: efSearch=203
2025-03-13 12:27:16,935 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.00it/s]
2025-03-13 12:27:35,792 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8570 secs
2025-03-13 12:27:35,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9971 secs
2025-03-13 12:27:35,794 [INFO]: {
2025-03-13 12:27:35,794 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:35,794 [INFO]: 	index_param: efSearch=203
2025-03-13 12:27:35,794 [INFO]: 	index_path: knn.index
2025-03-13 12:27:35,794 [INFO]: 	size in bytes: 526879930
2025-03-13 12:27:35,794 [INFO]: 	avg_search_speed_ms: 8.143244240681735
2025-03-13 12:27:35,794 [INFO]: 	99p_search_speed_ms: 10.364982103928925
2025-03-13 12:27:35,794 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:35,794 [INFO]: 	nb vectors: 2678
2025-03-13 12:27:35,794 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:35,794 [INFO]: 	compression ratio: 0.9993096985113857
2025-03-13 12:27:35,794 [INFO]: }
2025-03-13 12:27:35,794 [INFO]: 	>>> Finished "Creating the index" in 57.9987 secs
2025-03-13 12:27:35,794 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0309 secs
2025-03-13 12:27:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 83958 [episode count 18/20]
[retrieval_preprocessing] for episode 82553 [episode count 19/20], we have num_retrieval=np.int64(2621) num_query=np.int64(181)
2025-03-13 12:27:36,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:37,438 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:37
2025-03-13 12:27:37,438 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.82it/s]
2025-03-13 12:27:37,466 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 12:27:37,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 12:27:37,467 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:37
2025-03-13 12:27:37,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:37,467 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:27:37,467 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:37,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:27:37,467 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:37
2025-03-13 12:27:37,467 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:37,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:27:37,467 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:37
2025-03-13 12:27:37,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:37,467 [INFO]: 	Creating the index 03/13/2025, 12:27:37
2025-03-13 12:27:37,467 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:37
2025-03-13 12:27:37,468 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:27:37,468 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:37
2025-03-13 12:27:37,468 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:27:37,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.39it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.83it/s]100%|██████████| 11/11 [00:02<00:00,  3.97it/s]100%|██████████| 11/11 [00:02<00:00,  4.95it/s]
2025-03-13 12:27:40,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:40
2025-03-13 12:28:21,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4200 secs
2025-03-13 12:28:21,677 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 12:28:21,677 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 12:28:37,639 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9623 secs
2025-03-13 12:28:37,641 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1729 secs
2025-03-13 12:28:37,641 [INFO]: {
2025-03-13 12:28:37,641 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:37,641 [INFO]: 	index_param: efSearch=165
2025-03-13 12:28:37,641 [INFO]: 	index_path: knn.index
2025-03-13 12:28:37,641 [INFO]: 	size in bytes: 515665690
2025-03-13 12:28:37,641 [INFO]: 	avg_search_speed_ms: 7.7882833542038234
2025-03-13 12:28:37,641 [INFO]: 	99p_search_speed_ms: 10.415062201209366
2025-03-13 12:28:37,641 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:37,641 [INFO]: 	nb vectors: 2621
2025-03-13 12:28:37,642 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:37,642 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 12:28:37,642 [INFO]: }
2025-03-13 12:28:37,642 [INFO]: 	>>> Finished "Creating the index" in 60.1744 secs
2025-03-13 12:28:37,642 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2033 secs
2025-03-13 12:28:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 82553 [episode count 19/20]
2025-03-13 12:28:38: [retrieval_preprocessing] finished for 3246924425_corn_in_bowl [chosen_id count 4/260]
2025-03-13 12:28:40: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3246924425_yellow_object_in_bowl [chosen_id count 5/260]
2025-03-13 12:28:40: [retrieval_preprocessing] we have num_total=2800 embedding_dim=49152
[retrieval_preprocessing] for episode 38791 [episode count 0/20], we have num_retrieval=np.int64(2637) num_query=np.int64(163)
2025-03-13 12:28:40,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:40,821 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:40
2025-03-13 12:28:40,821 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.42it/s]
2025-03-13 12:28:40,852 [INFO]: There are 2637 embeddings of dim 49152
2025-03-13 12:28:40,852 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-13 12:28:40,852 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:40
2025-03-13 12:28:40,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:40,852 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:28:40,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:40,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:28:40,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:40
2025-03-13 12:28:40,853 [INFO]: 544.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:40,853 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:28:40,853 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:40
2025-03-13 12:28:40,853 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:40,853 [INFO]: 	Creating the index 03/13/2025, 12:28:40
2025-03-13 12:28:40,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:40
2025-03-13 12:28:40,854 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:28:40,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:40
2025-03-13 12:28:40,854 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:28:40,854 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.36it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.47it/s]100%|██████████| 11/11 [00:01<00:00,  5.59it/s]
2025-03-13 12:28:42,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:42
2025-03-13 12:29:13,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3859 secs
2025-03-13 12:29:13,213 [INFO]: The best hyperparameters are: efSearch=299
2025-03-13 12:29:13,213 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-13 12:29:32,489 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2758 secs
2025-03-13 12:29:32,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6369 secs
2025-03-13 12:29:32,491 [INFO]: {
2025-03-13 12:29:32,491 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:32,491 [INFO]: 	index_param: efSearch=299
2025-03-13 12:29:32,491 [INFO]: 	index_path: knn.index
2025-03-13 12:29:32,491 [INFO]: 	size in bytes: 518813590
2025-03-13 12:29:32,491 [INFO]: 	avg_search_speed_ms: 11.682596586146348
2025-03-13 12:29:32,491 [INFO]: 	99p_search_speed_ms: 18.936637113802227
2025-03-13 12:29:32,491 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:32,491 [INFO]: 	nb vectors: 2637
2025-03-13 12:29:32,491 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:32,491 [INFO]: 	compression ratio: 0.9993093974273111
2025-03-13 12:29:32,491 [INFO]: }
2025-03-13 12:29:32,491 [INFO]: 	>>> Finished "Creating the index" in 51.6383 secs
2025-03-13 12:29:32,491 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6700 secs
2025-03-13 12:29:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 38791 [episode count 0/20]
[retrieval_preprocessing] for episode 67980 [episode count 1/20], we have num_retrieval=np.int64(2679) num_query=np.int64(121)
2025-03-13 12:29:35,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:36,068 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:36
2025-03-13 12:29:36,068 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 836.69it/s]
2025-03-13 12:29:36,110 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 12:29:36,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 12:29:36,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:36
2025-03-13 12:29:36,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:36,111 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:29:36,111 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:36,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:29:36,112 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:36
2025-03-13 12:29:36,112 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:36,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:29:36,113 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:36
2025-03-13 12:29:36,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:36,113 [INFO]: 	Creating the index 03/13/2025, 12:29:36
2025-03-13 12:29:36,113 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:36
2025-03-13 12:29:36,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 12:29:36,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:36
2025-03-13 12:29:36,116 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:29:36,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.33it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.56it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]100%|██████████| 11/11 [00:02<00:00,  4.99it/s]
2025-03-13 12:29:38,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:38
2025-03-13 12:30:09,891 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5638 secs
2025-03-13 12:30:09,891 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 12:30:09,891 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-13 12:30:27,301 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4093 secs
2025-03-13 12:30:27,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1864 secs
2025-03-13 12:30:27,303 [INFO]: {
2025-03-13 12:30:27,303 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:27,303 [INFO]: 	index_param: efSearch=227
2025-03-13 12:30:27,303 [INFO]: 	index_path: knn.index
2025-03-13 12:30:27,303 [INFO]: 	size in bytes: 527076670
2025-03-13 12:30:27,303 [INFO]: 	avg_search_speed_ms: 9.554172207805067
2025-03-13 12:30:27,303 [INFO]: 	99p_search_speed_ms: 13.13192713074386
2025-03-13 12:30:27,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:27,303 [INFO]: 	nb vectors: 2679
2025-03-13 12:30:27,303 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:27,303 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 12:30:27,303 [INFO]: }
2025-03-13 12:30:27,303 [INFO]: 	>>> Finished "Creating the index" in 51.1901 secs
2025-03-13 12:30:27,303 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2354 secs
2025-03-13 12:30:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 67980 [episode count 1/20]
[retrieval_preprocessing] for episode 58127 [episode count 2/20], we have num_retrieval=np.int64(2694) num_query=np.int64(106)
2025-03-13 12:30:28,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:29,300 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:29
2025-03-13 12:30:29,301 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2154.24it/s]
2025-03-13 12:30:29,333 [INFO]: There are 2694 embeddings of dim 49152
2025-03-13 12:30:29,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 12:30:29,333 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:29
2025-03-13 12:30:29,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:29,333 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:30:29,333 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:29,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:29,333 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:29
2025-03-13 12:30:29,333 [INFO]: 556.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:29,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:30:29,333 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:29
2025-03-13 12:30:29,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:29,333 [INFO]: 	Creating the index 03/13/2025, 12:30:29
2025-03-13 12:30:29,333 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:29
2025-03-13 12:30:29,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:30:29,335 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:29
2025-03-13 12:30:29,335 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:30:29,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.45it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.09it/s]100%|██████████| 11/11 [00:02<00:00,  3.91it/s]100%|██████████| 11/11 [00:02<00:00,  4.85it/s]
2025-03-13 12:30:31,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:31
2025-03-13 12:31:05,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3941 secs
2025-03-13 12:31:05,999 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 12:31:05,999 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-13 12:31:20,850 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8502 secs
2025-03-13 12:31:20,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5168 secs
2025-03-13 12:31:20,852 [INFO]: {
2025-03-13 12:31:20,852 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:20,852 [INFO]: 	index_param: efSearch=228
2025-03-13 12:31:20,852 [INFO]: 	index_path: knn.index
2025-03-13 12:31:20,852 [INFO]: 	size in bytes: 530027770
2025-03-13 12:31:20,852 [INFO]: 	avg_search_speed_ms: 11.831745505332947
2025-03-13 12:31:20,852 [INFO]: 	99p_search_speed_ms: 18.479148764163256
2025-03-13 12:31:20,852 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:20,852 [INFO]: 	nb vectors: 2694
2025-03-13 12:31:20,852 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:20,852 [INFO]: 	compression ratio: 0.9993098135216576
2025-03-13 12:31:20,852 [INFO]: }
2025-03-13 12:31:20,852 [INFO]: 	>>> Finished "Creating the index" in 51.5183 secs
2025-03-13 12:31:20,852 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5512 secs
2025-03-13 12:31:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 58127 [episode count 2/20]
[retrieval_preprocessing] for episode 77220 [episode count 3/20], we have num_retrieval=np.int64(2664) num_query=np.int64(136)
2025-03-13 12:31:22,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:22,464 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:22
2025-03-13 12:31:22,464 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.08it/s]
2025-03-13 12:31:22,499 [INFO]: There are 2664 embeddings of dim 49152
2025-03-13 12:31:22,500 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0359 secs
2025-03-13 12:31:22,500 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:22
2025-03-13 12:31:22,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:22,501 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:31:22,501 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:22,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:31:22,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:22
2025-03-13 12:31:22,502 [INFO]: 549.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:22,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:31:22,502 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:22
2025-03-13 12:31:22,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:22,503 [INFO]: 	Creating the index 03/13/2025, 12:31:22
2025-03-13 12:31:22,503 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:22
2025-03-13 12:31:22,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-13 12:31:22,507 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:22
2025-03-13 12:31:22,507 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:31:22,507 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.05it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.30it/s]100%|██████████| 11/11 [00:02<00:00,  3.97it/s]100%|██████████| 11/11 [00:02<00:00,  4.95it/s]
2025-03-13 12:31:24,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:24
2025-03-13 12:31:55,388 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6528 secs
2025-03-13 12:31:55,388 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 12:31:55,388 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.25it/s]
2025-03-13 12:32:10,995 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6069 secs
2025-03-13 12:32:10,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4903 secs
2025-03-13 12:32:10,998 [INFO]: {
2025-03-13 12:32:10,998 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:10,998 [INFO]: 	index_param: efSearch=258
2025-03-13 12:32:10,998 [INFO]: 	index_path: knn.index
2025-03-13 12:32:10,998 [INFO]: 	size in bytes: 524125570
2025-03-13 12:32:10,998 [INFO]: 	avg_search_speed_ms: 10.670875910538506
2025-03-13 12:32:10,998 [INFO]: 	99p_search_speed_ms: 14.244937878102064
2025-03-13 12:32:10,998 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:10,998 [INFO]: 	nb vectors: 2664
2025-03-13 12:32:10,998 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:10,998 [INFO]: 	compression ratio: 0.9993095967441543
2025-03-13 12:32:10,998 [INFO]: }
2025-03-13 12:32:10,998 [INFO]: 	>>> Finished "Creating the index" in 48.4950 secs
2025-03-13 12:32:10,998 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5341 secs
2025-03-13 12:32:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 77220 [episode count 3/20]
[retrieval_preprocessing] for episode 59057 [episode count 4/20], we have num_retrieval=np.int64(2683) num_query=np.int64(117)
2025-03-13 12:32:12,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:13,343 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:13
2025-03-13 12:32:13,343 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1765.28it/s]
2025-03-13 12:32:13,384 [INFO]: There are 2683 embeddings of dim 49152
2025-03-13 12:32:13,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-13 12:32:13,385 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:13
2025-03-13 12:32:13,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:13,385 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:32:13,385 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:13,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:13,385 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:13
2025-03-13 12:32:13,385 [INFO]: 553.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:13,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:32:13,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:13
2025-03-13 12:32:13,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:13,385 [INFO]: 	Creating the index 03/13/2025, 12:32:13
2025-03-13 12:32:13,386 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:13
2025-03-13 12:32:13,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:32:13,387 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:13
2025-03-13 12:32:13,387 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:32:13,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.26it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.19it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.47it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]
2025-03-13 12:32:15,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:15
2025-03-13 12:32:48,368 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4810 secs
2025-03-13 12:32:48,369 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 12:32:48,369 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-13 12:33:06,562 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1932 secs
2025-03-13 12:33:06,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1772 secs
2025-03-13 12:33:06,564 [INFO]: {
2025-03-13 12:33:06,564 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:06,564 [INFO]: 	index_param: efSearch=256
2025-03-13 12:33:06,564 [INFO]: 	index_path: knn.index
2025-03-13 12:33:06,564 [INFO]: 	size in bytes: 527863630
2025-03-13 12:33:06,564 [INFO]: 	avg_search_speed_ms: 10.886076725036377
2025-03-13 12:33:06,564 [INFO]: 	99p_search_speed_ms: 17.239296096377064
2025-03-13 12:33:06,564 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:06,564 [INFO]: 	nb vectors: 2683
2025-03-13 12:33:06,564 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:06,565 [INFO]: 	compression ratio: 0.9993097345994457
2025-03-13 12:33:06,565 [INFO]: }
2025-03-13 12:33:06,565 [INFO]: 	>>> Finished "Creating the index" in 53.1791 secs
2025-03-13 12:33:06,565 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2213 secs
2025-03-13 12:33:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 59057 [episode count 4/20]
[retrieval_preprocessing] for episode 9266 [episode count 5/20], we have num_retrieval=np.int64(2623) num_query=np.int64(177)
2025-03-13 12:33:08,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:09,434 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:09
2025-03-13 12:33:09,434 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.13it/s]
2025-03-13 12:33:09,467 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 12:33:09,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 12:33:09,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:09,468 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:33:09,468 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:09,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:33:09,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,469 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:09,469 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:33:09,469 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:09
2025-03-13 12:33:09,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:09,470 [INFO]: 	Creating the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:09
2025-03-13 12:33:09,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:33:09,473 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:09
2025-03-13 12:33:09,473 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:33:09,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.25it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.78it/s]100%|██████████| 11/11 [00:01<00:00,  4.53it/s]100%|██████████| 11/11 [00:01<00:00,  5.61it/s]
2025-03-13 12:33:11,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:11
2025-03-13 12:33:40,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1644 secs
2025-03-13 12:33:40,603 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 12:33:40,603 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-13 12:34:00,360 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7568 secs
2025-03-13 12:34:00,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8884 secs
2025-03-13 12:34:00,361 [INFO]: {
2025-03-13 12:34:00,361 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:00,361 [INFO]: 	index_param: efSearch=206
2025-03-13 12:34:00,361 [INFO]: 	index_path: knn.index
2025-03-13 12:34:00,361 [INFO]: 	size in bytes: 516059170
2025-03-13 12:34:00,361 [INFO]: 	avg_search_speed_ms: 9.581908268962854
2025-03-13 12:34:00,361 [INFO]: 	99p_search_speed_ms: 15.52372283767908
2025-03-13 12:34:00,361 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:00,361 [INFO]: 	nb vectors: 2623
2025-03-13 12:34:00,361 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:00,361 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 12:34:00,361 [INFO]: }
2025-03-13 12:34:00,362 [INFO]: 	>>> Finished "Creating the index" in 50.8919 secs
2025-03-13 12:34:00,362 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9276 secs
2025-03-13 12:34:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 9266 [episode count 5/20]
[retrieval_preprocessing] for episode 35506 [episode count 6/20], we have num_retrieval=np.int64(2662) num_query=np.int64(138)
2025-03-13 12:34:01,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:02,259 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:02
2025-03-13 12:34:02,260 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1573.26it/s]
2025-03-13 12:34:02,560 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 12:34:02,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3006 secs
2025-03-13 12:34:02,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:02
2025-03-13 12:34:02,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:02,560 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:34:02,560 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:02,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:02,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:02
2025-03-13 12:34:02,560 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:02,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:34:02,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:02
2025-03-13 12:34:02,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:02,561 [INFO]: 	Creating the index 03/13/2025, 12:34:02
2025-03-13 12:34:02,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:02
2025-03-13 12:34:02,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:34:02,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:02
2025-03-13 12:34:02,562 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:34:02,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.10it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.81it/s]100%|██████████| 11/11 [00:02<00:00,  4.06it/s]100%|██████████| 11/11 [00:02<00:00,  4.76it/s]
2025-03-13 12:34:04,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:04
2025-03-13 12:34:38,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1749 secs
2025-03-13 12:34:38,050 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 12:34:38,050 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 12:34:55,625 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5753 secs
2025-03-13 12:34:55,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0653 secs
2025-03-13 12:34:55,627 [INFO]: {
2025-03-13 12:34:55,627 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:55,627 [INFO]: 	index_param: efSearch=201
2025-03-13 12:34:55,627 [INFO]: 	index_path: knn.index
2025-03-13 12:34:55,627 [INFO]: 	size in bytes: 523732090
2025-03-13 12:34:55,627 [INFO]: 	avg_search_speed_ms: 8.868197361849486
2025-03-13 12:34:55,627 [INFO]: 	99p_search_speed_ms: 13.210498208645731
2025-03-13 12:34:55,627 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:55,627 [INFO]: 	nb vectors: 2662
2025-03-13 12:34:55,627 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:55,627 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 12:34:55,627 [INFO]: }
2025-03-13 12:34:55,627 [INFO]: 	>>> Finished "Creating the index" in 53.0665 secs
2025-03-13 12:34:55,627 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3677 secs
2025-03-13 12:34:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 35506 [episode count 6/20]
[retrieval_preprocessing] for episode 68530 [episode count 7/20], we have num_retrieval=np.int64(2681) num_query=np.int64(119)
2025-03-13 12:34:56,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:57,105 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:57
2025-03-13 12:34:57,105 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2246.55it/s]
2025-03-13 12:34:57,133 [INFO]: There are 2681 embeddings of dim 49152
2025-03-13 12:34:57,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 12:34:57,133 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:57
2025-03-13 12:34:57,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:57,133 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:34:57,133 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:57,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:57,133 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:57
2025-03-13 12:34:57,133 [INFO]: 553.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:57,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:34:57,133 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:57
2025-03-13 12:34:57,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:57,133 [INFO]: 	Creating the index 03/13/2025, 12:34:57
2025-03-13 12:34:57,133 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:57
2025-03-13 12:34:57,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:34:57,134 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:57
2025-03-13 12:34:57,134 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:34:57,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.25it/s] 73%|███████▎  | 8/11 [00:00<00:00, 40.03it/s]100%|██████████| 11/11 [00:01<00:00,  5.73it/s]
2025-03-13 12:34:59,059 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:59
2025-03-13 12:35:34,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9571 secs
2025-03-13 12:35:34,016 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 12:35:34,016 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 50%|█████     | 2/4 [00:00<00:00,  5.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.51it/s]
2025-03-13 12:35:53,451 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4348 secs
2025-03-13 12:35:53,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3187 secs
2025-03-13 12:35:53,453 [INFO]: {
2025-03-13 12:35:53,453 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:53,453 [INFO]: 	index_param: efSearch=204
2025-03-13 12:35:53,453 [INFO]: 	index_path: knn.index
2025-03-13 12:35:53,453 [INFO]: 	size in bytes: 527470150
2025-03-13 12:35:53,453 [INFO]: 	avg_search_speed_ms: 11.025394113578288
2025-03-13 12:35:53,453 [INFO]: 	99p_search_speed_ms: 16.60077861044555
2025-03-13 12:35:53,453 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:53,453 [INFO]: 	nb vectors: 2681
2025-03-13 12:35:53,453 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:53,453 [INFO]: 	compression ratio: 0.9993097201803742
2025-03-13 12:35:53,453 [INFO]: }
2025-03-13 12:35:53,453 [INFO]: 	>>> Finished "Creating the index" in 56.3202 secs
2025-03-13 12:35:53,454 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3484 secs
2025-03-13 12:35:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 68530 [episode count 7/20]
[retrieval_preprocessing] for episode 46910 [episode count 8/20], we have num_retrieval=np.int64(2677) num_query=np.int64(123)
2025-03-13 12:35:54,493 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:54,858 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:54
2025-03-13 12:35:54,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.99it/s]
2025-03-13 12:35:54,890 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 12:35:54,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 12:35:54,890 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:54
2025-03-13 12:35:54,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:54,890 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:35:54,890 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:54,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:35:54,890 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:54
2025-03-13 12:35:54,890 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:54,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:35:54,890 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:54
2025-03-13 12:35:54,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:54,891 [INFO]: 	Creating the index 03/13/2025, 12:35:54
2025-03-13 12:35:54,891 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:54
2025-03-13 12:35:54,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:35:54,892 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:54
2025-03-13 12:35:54,892 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:35:54,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.53it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.04it/s]100%|██████████| 11/11 [00:02<00:00,  3.62it/s]100%|██████████| 11/11 [00:02<00:00,  4.51it/s]
2025-03-13 12:35:57,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:57
2025-03-13 12:36:25,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5333 secs
2025-03-13 12:36:25,871 [INFO]: The best hyperparameters are: efSearch=167
2025-03-13 12:36:25,871 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-13 12:36:45,530 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6585 secs
2025-03-13 12:36:45,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6408 secs
2025-03-13 12:36:45,533 [INFO]: {
2025-03-13 12:36:45,533 [INFO]: 	index_key: HNSW15
2025-03-13 12:36:45,533 [INFO]: 	index_param: efSearch=167
2025-03-13 12:36:45,533 [INFO]: 	index_path: knn.index
2025-03-13 12:36:45,533 [INFO]: 	size in bytes: 526683190
2025-03-13 12:36:45,533 [INFO]: 	avg_search_speed_ms: 8.003873720765114
2025-03-13 12:36:45,533 [INFO]: 	99p_search_speed_ms: 11.737592299468814
2025-03-13 12:36:45,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:36:45,533 [INFO]: 	nb vectors: 2677
2025-03-13 12:36:45,533 [INFO]: 	vectors dimension: 49152
2025-03-13 12:36:45,533 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 12:36:45,533 [INFO]: }
2025-03-13 12:36:45,533 [INFO]: 	>>> Finished "Creating the index" in 50.6425 secs
2025-03-13 12:36:45,533 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6749 secs
2025-03-13 12:36:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:36:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 46910 [episode count 8/20]
[retrieval_preprocessing] for episode 86466 [episode count 9/20], we have num_retrieval=np.int64(2640) num_query=np.int64(160)
2025-03-13 12:36:46,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:47,017 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:47
2025-03-13 12:36:47,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-13 12:36:47,047 [INFO]: There are 2640 embeddings of dim 49152
2025-03-13 12:36:47,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 12:36:47,048 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:47
2025-03-13 12:36:47,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:47,048 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:36:47,048 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:47,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:36:47,048 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:47
2025-03-13 12:36:47,048 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:47,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:36:47,048 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:47
2025-03-13 12:36:47,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:47,048 [INFO]: 	Creating the index 03/13/2025, 12:36:47
2025-03-13 12:36:47,048 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:47
2025-03-13 12:36:47,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:36:47,049 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:47
2025-03-13 12:36:47,049 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:36:47,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.69it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.70it/s]100%|██████████| 11/11 [00:01<00:00,  4.60it/s]100%|██████████| 11/11 [00:01<00:00,  5.56it/s]
2025-03-13 12:36:49,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:49
2025-03-13 12:37:18,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0486 secs
2025-03-13 12:37:18,080 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 12:37:18,080 [INFO]: 	Compute fast metrics 03/13/2025, 12:37:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 12:37:33,051 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9706 secs
2025-03-13 12:37:33,053 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0039 secs
2025-03-13 12:37:33,053 [INFO]: {
2025-03-13 12:37:33,053 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:33,053 [INFO]: 	index_param: efSearch=148
2025-03-13 12:37:33,053 [INFO]: 	index_path: knn.index
2025-03-13 12:37:33,053 [INFO]: 	size in bytes: 519403810
2025-03-13 12:37:33,053 [INFO]: 	avg_search_speed_ms: 6.928366268304069
2025-03-13 12:37:33,053 [INFO]: 	99p_search_speed_ms: 9.3960711825639
2025-03-13 12:37:33,053 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:33,053 [INFO]: 	nb vectors: 2640
2025-03-13 12:37:33,053 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:33,053 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-13 12:37:33,053 [INFO]: }
2025-03-13 12:37:33,053 [INFO]: 	>>> Finished "Creating the index" in 46.0055 secs
2025-03-13 12:37:33,053 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0361 secs
2025-03-13 12:37:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 86466 [episode count 9/20]
[retrieval_preprocessing] for episode 72907 [episode count 10/20], we have num_retrieval=np.int64(2627) num_query=np.int64(173)
2025-03-13 12:37:34,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:34,683 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:34
2025-03-13 12:37:34,684 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.04it/s]
2025-03-13 12:37:34,715 [INFO]: There are 2627 embeddings of dim 49152
2025-03-13 12:37:34,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 12:37:34,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:34
2025-03-13 12:37:34,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:34,715 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:37:34,715 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:34,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:37:34,715 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:34
2025-03-13 12:37:34,715 [INFO]: 542.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:34,715 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:37:34,715 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:34
2025-03-13 12:37:34,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:34,715 [INFO]: 	Creating the index 03/13/2025, 12:37:34
2025-03-13 12:37:34,715 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:34
2025-03-13 12:37:34,716 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:37:34,717 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:34
2025-03-13 12:37:34,717 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:37:34,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.13it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.85it/s]100%|██████████| 11/11 [00:02<00:00,  4.51it/s]100%|██████████| 11/11 [00:02<00:00,  5.28it/s]
2025-03-13 12:37:36,802 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:36
2025-03-13 12:38:14,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2110 secs
2025-03-13 12:38:14,014 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 12:38:14,014 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.11it/s]
2025-03-13 12:38:32,549 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5347 secs
2025-03-13 12:38:32,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8340 secs
2025-03-13 12:38:32,551 [INFO]: {
2025-03-13 12:38:32,551 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:32,551 [INFO]: 	index_param: efSearch=202
2025-03-13 12:38:32,551 [INFO]: 	index_path: knn.index
2025-03-13 12:38:32,551 [INFO]: 	size in bytes: 516846130
2025-03-13 12:38:32,551 [INFO]: 	avg_search_speed_ms: 8.308146840837038
2025-03-13 12:38:32,551 [INFO]: 	99p_search_speed_ms: 11.151351670268927
2025-03-13 12:38:32,551 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:32,551 [INFO]: 	nb vectors: 2627
2025-03-13 12:38:32,551 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:32,551 [INFO]: 	compression ratio: 0.9993094385750746
2025-03-13 12:38:32,551 [INFO]: }
2025-03-13 12:38:32,551 [INFO]: 	>>> Finished "Creating the index" in 57.8355 secs
2025-03-13 12:38:32,551 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8674 secs
2025-03-13 12:38:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 72907 [episode count 10/20]
[retrieval_preprocessing] for episode 53972 [episode count 11/20], we have num_retrieval=np.int64(2655) num_query=np.int64(145)
2025-03-13 12:38:34,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:38:34,418 [INFO]: Launching the whole pipeline 03/13/2025, 12:38:34
2025-03-13 12:38:34,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:38:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.74it/s]
2025-03-13 12:38:34,448 [INFO]: There are 2655 embeddings of dim 49152
2025-03-13 12:38:34,448 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 12:38:34,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:38:34
2025-03-13 12:38:34,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:38:34,448 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:38:34,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:38:34,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:38:34,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:38:34
2025-03-13 12:38:34,448 [INFO]: 547.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:38:34,448 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:38:34,448 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:38:34
2025-03-13 12:38:34,448 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:38:34,448 [INFO]: 	Creating the index 03/13/2025, 12:38:34
2025-03-13 12:38:34,448 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:38:34
2025-03-13 12:38:34,449 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:38:34,449 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:38:34
2025-03-13 12:38:34,449 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:38:34,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.58it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.11it/s] 91%|█████████ | 10/11 [00:00<00:00, 35.39it/s]100%|██████████| 11/11 [00:02<00:00,  5.03it/s]
2025-03-13 12:38:36,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:38:36
2025-03-13 12:39:07,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9691 secs
2025-03-13 12:39:07,611 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 12:39:07,611 [INFO]: 	Compute fast metrics 03/13/2025, 12:39:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.94it/s]
2025-03-13 12:39:25,606 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9953 secs
2025-03-13 12:39:25,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1589 secs
2025-03-13 12:39:25,608 [INFO]: {
2025-03-13 12:39:25,608 [INFO]: 	index_key: HNSW15
2025-03-13 12:39:25,608 [INFO]: 	index_param: efSearch=194
2025-03-13 12:39:25,609 [INFO]: 	index_path: knn.index
2025-03-13 12:39:25,609 [INFO]: 	size in bytes: 522354910
2025-03-13 12:39:25,609 [INFO]: 	avg_search_speed_ms: 8.825650341259703
2025-03-13 12:39:25,609 [INFO]: 	99p_search_speed_ms: 12.005735728889707
2025-03-13 12:39:25,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:39:25,609 [INFO]: 	nb vectors: 2655
2025-03-13 12:39:25,609 [INFO]: 	vectors dimension: 49152
2025-03-13 12:39:25,609 [INFO]: 	compression ratio: 0.9993095307556312
2025-03-13 12:39:25,609 [INFO]: }
2025-03-13 12:39:25,609 [INFO]: 	>>> Finished "Creating the index" in 51.1603 secs
2025-03-13 12:39:25,609 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1905 secs
2025-03-13 12:39:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 53972 [episode count 11/20]
[retrieval_preprocessing] for episode 10844 [episode count 12/20], we have num_retrieval=np.int64(2653) num_query=np.int64(147)
2025-03-13 12:39:26,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:27,409 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:27
2025-03-13 12:39:27,409 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.96it/s]
2025-03-13 12:39:27,443 [INFO]: There are 2653 embeddings of dim 49152
2025-03-13 12:39:27,444 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 12:39:27,444 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,444 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:27,444 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:39:27,444 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:27,444 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:39:27,444 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,444 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:27,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:39:27,444 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:27
2025-03-13 12:39:27,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:27,444 [INFO]: 	Creating the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,444 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:27
2025-03-13 12:39:27,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:39:27,446 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:27
2025-03-13 12:39:27,446 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:39:27,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.62it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.08it/s]100%|██████████| 11/11 [00:02<00:00,  3.68it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]
2025-03-13 12:39:29,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:29
2025-03-13 12:40:00,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6071 secs
2025-03-13 12:40:00,592 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 12:40:00,592 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.27it/s]
2025-03-13 12:40:24,742 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1505 secs
2025-03-13 12:40:24,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2983 secs
2025-03-13 12:40:24,745 [INFO]: {
2025-03-13 12:40:24,745 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:24,745 [INFO]: 	index_param: efSearch=226
2025-03-13 12:40:24,745 [INFO]: 	index_path: knn.index
2025-03-13 12:40:24,745 [INFO]: 	size in bytes: 521961430
2025-03-13 12:40:24,745 [INFO]: 	avg_search_speed_ms: 8.502545118328742
2025-03-13 12:40:24,745 [INFO]: 	99p_search_speed_ms: 12.160521291662008
2025-03-13 12:40:24,745 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:24,745 [INFO]: 	nb vectors: 2653
2025-03-13 12:40:24,745 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:24,745 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-13 12:40:24,745 [INFO]: }
2025-03-13 12:40:24,745 [INFO]: 	>>> Finished "Creating the index" in 57.3005 secs
2025-03-13 12:40:24,745 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3356 secs
2025-03-13 12:40:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 10844 [episode count 12/20]
[retrieval_preprocessing] for episode 78176 [episode count 13/20], we have num_retrieval=np.int64(2626) num_query=np.int64(174)
2025-03-13 12:40:26,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:27,329 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:27
2025-03-13 12:40:27,329 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1559.80it/s]
2025-03-13 12:40:27,357 [INFO]: There are 2626 embeddings of dim 49152
2025-03-13 12:40:27,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 12:40:27,357 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:27
2025-03-13 12:40:27,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:27,357 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:40:27,357 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:27,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:40:27,357 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:27
2025-03-13 12:40:27,357 [INFO]: 541.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:27,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:40:27,357 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:27
2025-03-13 12:40:27,357 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:27,357 [INFO]: 	Creating the index 03/13/2025, 12:40:27
2025-03-13 12:40:27,357 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:27
2025-03-13 12:40:27,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:40:27,358 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:27
2025-03-13 12:40:27,358 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:40:27,358 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.60it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.86it/s]
2025-03-13 12:40:29,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:29
2025-03-13 12:41:06,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3075 secs
2025-03-13 12:41:06,934 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 12:41:06,934 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-13 12:41:33,461 [INFO]: 	>>> Finished "Compute fast metrics" in 26.5264 secs
2025-03-13 12:41:33,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1040 secs
2025-03-13 12:41:33,463 [INFO]: {
2025-03-13 12:41:33,463 [INFO]: 	index_key: HNSW15
2025-03-13 12:41:33,463 [INFO]: 	index_param: efSearch=165
2025-03-13 12:41:33,463 [INFO]: 	index_path: knn.index
2025-03-13 12:41:33,463 [INFO]: 	size in bytes: 516649390
2025-03-13 12:41:33,463 [INFO]: 	avg_search_speed_ms: 8.1453264411463
2025-03-13 12:41:33,463 [INFO]: 	99p_search_speed_ms: 10.882455795072019
2025-03-13 12:41:33,463 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:41:33,463 [INFO]: 	nb vectors: 2626
2025-03-13 12:41:33,463 [INFO]: 	vectors dimension: 49152
2025-03-13 12:41:33,463 [INFO]: 	compression ratio: 0.9993094311018155
2025-03-13 12:41:33,463 [INFO]: }
2025-03-13 12:41:33,463 [INFO]: 	>>> Finished "Creating the index" in 66.1054 secs
2025-03-13 12:41:33,463 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1338 secs
2025-03-13 12:41:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:41:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 78176 [episode count 13/20]
[retrieval_preprocessing] for episode 27366 [episode count 14/20], we have num_retrieval=np.int64(2636) num_query=np.int64(164)
2025-03-13 12:41:34,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:41:35,354 [INFO]: Launching the whole pipeline 03/13/2025, 12:41:35
2025-03-13 12:41:35,354 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:41:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.27it/s]
2025-03-13 12:41:35,388 [INFO]: There are 2636 embeddings of dim 49152
2025-03-13 12:41:35,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-13 12:41:35,388 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:41:35
2025-03-13 12:41:35,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:41:35,388 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:41:35,388 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:41:35,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:41:35,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:41:35
2025-03-13 12:41:35,388 [INFO]: 544.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:41:35,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:41:35,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:41:35
2025-03-13 12:41:35,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:41:35,388 [INFO]: 	Creating the index 03/13/2025, 12:41:35
2025-03-13 12:41:35,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:41:35
2025-03-13 12:41:35,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:41:35,389 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:41:35
2025-03-13 12:41:35,389 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:41:35,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.16it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.55it/s] 73%|███████▎  | 8/11 [00:00<00:00, 24.43it/s]100%|██████████| 11/11 [00:02<00:00,  2.87it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]
2025-03-13 12:41:38,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:41:38
2025-03-13 12:42:25,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5572 secs
2025-03-13 12:42:25,789 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 12:42:25,789 [INFO]: 	Compute fast metrics 03/13/2025, 12:42:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-13 12:42:42,734 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9451 secs
2025-03-13 12:42:42,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3474 secs
2025-03-13 12:42:42,737 [INFO]: {
2025-03-13 12:42:42,737 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:42,737 [INFO]: 	index_param: efSearch=216
2025-03-13 12:42:42,737 [INFO]: 	index_path: knn.index
2025-03-13 12:42:42,737 [INFO]: 	size in bytes: 518616850
2025-03-13 12:42:42,737 [INFO]: 	avg_search_speed_ms: 12.697236332924195
2025-03-13 12:42:42,737 [INFO]: 	99p_search_speed_ms: 19.522561565972865
2025-03-13 12:42:42,737 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:42,737 [INFO]: 	nb vectors: 2636
2025-03-13 12:42:42,737 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:42,737 [INFO]: 	compression ratio: 0.9993093899667934
2025-03-13 12:42:42,737 [INFO]: }
2025-03-13 12:42:42,737 [INFO]: 	>>> Finished "Creating the index" in 67.3490 secs
2025-03-13 12:42:42,737 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3836 secs
2025-03-13 12:42:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 27366 [episode count 14/20]
[retrieval_preprocessing] for episode 4839 [episode count 15/20], we have num_retrieval=np.int64(2676) num_query=np.int64(124)
2025-03-13 12:42:44,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:44,613 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:44
2025-03-13 12:42:44,613 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1784.05it/s]
2025-03-13 12:42:44,646 [INFO]: There are 2676 embeddings of dim 49152
2025-03-13 12:42:44,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 12:42:44,646 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:44,647 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:42:44,647 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:44,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:42:44,647 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,647 [INFO]: 552.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:44,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:42:44,647 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:44
2025-03-13 12:42:44,647 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:44,647 [INFO]: 	Creating the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,647 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:44
2025-03-13 12:42:44,648 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:42:44,649 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:44
2025-03-13 12:42:44,649 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:42:44,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.85it/s] 55%|█████▍    | 6/11 [00:00<00:00, 33.29it/s]100%|██████████| 11/11 [00:02<00:00,  3.40it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]
2025-03-13 12:42:47,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:47
2025-03-13 12:43:27,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7268 secs
2025-03-13 12:43:27,108 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 12:43:27,108 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.32it/s]
2025-03-13 12:43:43,997 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8892 secs
2025-03-13 12:43:43,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3509 secs
2025-03-13 12:43:44,000 [INFO]: {
2025-03-13 12:43:44,000 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:44,000 [INFO]: 	index_param: efSearch=162
2025-03-13 12:43:44,000 [INFO]: 	index_path: knn.index
2025-03-13 12:43:44,000 [INFO]: 	size in bytes: 526486450
2025-03-13 12:43:44,000 [INFO]: 	avg_search_speed_ms: 7.4554720437216675
2025-03-13 12:43:44,000 [INFO]: 	99p_search_speed_ms: 11.0743363853544
2025-03-13 12:43:44,000 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:44,000 [INFO]: 	nb vectors: 2676
2025-03-13 12:43:44,000 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:44,000 [INFO]: 	compression ratio: 0.9993096840384021
2025-03-13 12:43:44,000 [INFO]: }
2025-03-13 12:43:44,000 [INFO]: 	>>> Finished "Creating the index" in 59.3528 secs
2025-03-13 12:43:44,000 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3869 secs
2025-03-13 12:43:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:43:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 4839 [episode count 15/20]
[retrieval_preprocessing] for episode 28647 [episode count 16/20], we have num_retrieval=np.int64(2677) num_query=np.int64(123)
2025-03-13 12:43:45,107 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:43:45,604 [INFO]: Launching the whole pipeline 03/13/2025, 12:43:45
2025-03-13 12:43:45,604 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:43:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.28it/s]
2025-03-13 12:43:45,644 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 12:43:45,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0398 secs
2025-03-13 12:43:45,644 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:43:45,644 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:43:45,644 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:43:45,645 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:43:45,645 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,645 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:43:45,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:43:45,645 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:43:45
2025-03-13 12:43:45,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:43:45,645 [INFO]: 	Creating the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,645 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:43:45
2025-03-13 12:43:45,647 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 12:43:45,647 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:43:45
2025-03-13 12:43:45,647 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:43:45,648 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.50it/s]100%|██████████| 11/11 [00:02<00:00,  4.15it/s]100%|██████████| 11/11 [00:02<00:00,  4.88it/s]
2025-03-13 12:43:47,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:43:47
2025-03-13 12:44:17,118 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2118 secs
2025-03-13 12:44:17,119 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 12:44:17,119 [INFO]: 	Compute fast metrics 03/13/2025, 12:44:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-13 12:44:34,399 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2801 secs
2025-03-13 12:44:34,401 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7533 secs
2025-03-13 12:44:34,401 [INFO]: {
2025-03-13 12:44:34,401 [INFO]: 	index_key: HNSW15
2025-03-13 12:44:34,401 [INFO]: 	index_param: efSearch=168
2025-03-13 12:44:34,401 [INFO]: 	index_path: knn.index
2025-03-13 12:44:34,401 [INFO]: 	size in bytes: 526683190
2025-03-13 12:44:34,401 [INFO]: 	avg_search_speed_ms: 7.921442806627749
2025-03-13 12:44:34,401 [INFO]: 	99p_search_speed_ms: 12.056959925685081
2025-03-13 12:44:34,401 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:44:34,401 [INFO]: 	nb vectors: 2677
2025-03-13 12:44:34,401 [INFO]: 	vectors dimension: 49152
2025-03-13 12:44:34,401 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 12:44:34,401 [INFO]: }
2025-03-13 12:44:34,401 [INFO]: 	>>> Finished "Creating the index" in 48.7559 secs
2025-03-13 12:44:34,401 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7968 secs
2025-03-13 12:44:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 28647 [episode count 16/20]
[retrieval_preprocessing] for episode 47593 [episode count 17/20], we have num_retrieval=np.int64(2686) num_query=np.int64(114)
2025-03-13 12:44:35,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:36,140 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:36
2025-03-13 12:44:36,140 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-13 12:44:36,172 [INFO]: There are 2686 embeddings of dim 49152
2025-03-13 12:44:36,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-13 12:44:36,173 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:36
2025-03-13 12:44:36,173 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:36,173 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:44:36,173 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:36,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:44:36,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:36
2025-03-13 12:44:36,173 [INFO]: 554.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:36,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:44:36,173 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:36
2025-03-13 12:44:36,173 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:36,174 [INFO]: 	Creating the index 03/13/2025, 12:44:36
2025-03-13 12:44:36,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:36
2025-03-13 12:44:36,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 12:44:36,176 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:36
2025-03-13 12:44:36,176 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:44:36,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.45it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.65it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.75it/s]
2025-03-13 12:44:38,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:38
2025-03-13 12:45:08,063 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5641 secs
2025-03-13 12:45:08,063 [INFO]: The best hyperparameters are: efSearch=163
2025-03-13 12:45:08,063 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.55it/s]
2025-03-13 12:45:27,799 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7358 secs
2025-03-13 12:45:27,801 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6245 secs
2025-03-13 12:45:27,801 [INFO]: {
2025-03-13 12:45:27,801 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:27,801 [INFO]: 	index_param: efSearch=163
2025-03-13 12:45:27,801 [INFO]: 	index_path: knn.index
2025-03-13 12:45:27,801 [INFO]: 	size in bytes: 528453850
2025-03-13 12:45:27,801 [INFO]: 	avg_search_speed_ms: 7.270437259227037
2025-03-13 12:45:27,801 [INFO]: 	99p_search_speed_ms: 11.206682808697224
2025-03-13 12:45:27,801 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:27,801 [INFO]: 	nb vectors: 2686
2025-03-13 12:45:27,801 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:27,801 [INFO]: 	compression ratio: 0.9993097561877919
2025-03-13 12:45:27,801 [INFO]: }
2025-03-13 12:45:27,801 [INFO]: 	>>> Finished "Creating the index" in 51.6274 secs
2025-03-13 12:45:27,801 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6612 secs
2025-03-13 12:45:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 47593 [episode count 17/20]
[retrieval_preprocessing] for episode 1265 [episode count 18/20], we have num_retrieval=np.int64(2685) num_query=np.int64(115)
2025-03-13 12:45:28,713 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:29,092 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:29
2025-03-13 12:45:29,092 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.85it/s]
2025-03-13 12:45:29,121 [INFO]: There are 2685 embeddings of dim 49152
2025-03-13 12:45:29,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 12:45:29,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:29
2025-03-13 12:45:29,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:29,121 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 12:45:29,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:29,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:45:29,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:29
2025-03-13 12:45:29,121 [INFO]: 554.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:29,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:45:29,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:29
2025-03-13 12:45:29,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:29,121 [INFO]: 	Creating the index 03/13/2025, 12:45:29
2025-03-13 12:45:29,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:29
2025-03-13 12:45:29,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:45:29,122 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:29
2025-03-13 12:45:29,122 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:45:29,122 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.89it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.48it/s]100%|██████████| 11/11 [00:02<00:00,  4.13it/s]100%|██████████| 11/11 [00:02<00:00,  4.85it/s]
2025-03-13 12:45:31,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:31
2025-03-13 12:46:10,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3805 secs
2025-03-13 12:46:10,774 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 12:46:10,774 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.22it/s]
2025-03-13 12:46:29,062 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2879 secs
2025-03-13 12:46:29,065 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9424 secs
2025-03-13 12:46:29,066 [INFO]: {
2025-03-13 12:46:29,066 [INFO]: 	index_key: HNSW15
2025-03-13 12:46:29,066 [INFO]: 	index_param: efSearch=189
2025-03-13 12:46:29,066 [INFO]: 	index_path: knn.index
2025-03-13 12:46:29,066 [INFO]: 	size in bytes: 528257110
2025-03-13 12:46:29,066 [INFO]: 	avg_search_speed_ms: 9.256435904753541
2025-03-13 12:46:29,066 [INFO]: 	99p_search_speed_ms: 13.590170070528986
2025-03-13 12:46:29,066 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:46:29,066 [INFO]: 	nb vectors: 2685
2025-03-13 12:46:29,066 [INFO]: 	vectors dimension: 49152
2025-03-13 12:46:29,066 [INFO]: 	compression ratio: 0.9993097489970367
2025-03-13 12:46:29,066 [INFO]: }
2025-03-13 12:46:29,066 [INFO]: 	>>> Finished "Creating the index" in 59.9447 secs
2025-03-13 12:46:29,066 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9742 secs
2025-03-13 12:46:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:46:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 1265 [episode count 18/20]
[retrieval_preprocessing] for episode 29299 [episode count 19/20], we have num_retrieval=np.int64(2639) num_query=np.int64(161)
2025-03-13 12:46:30,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:46:30,650 [INFO]: Launching the whole pipeline 03/13/2025, 12:46:30
2025-03-13 12:46:30,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:46:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.58it/s]
2025-03-13 12:46:30,680 [INFO]: There are 2639 embeddings of dim 49152
2025-03-13 12:46:30,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 12:46:30,681 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:46:30
2025-03-13 12:46:30,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:46:30,681 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:46:30,681 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:46:30,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:46:30,681 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:46:30
2025-03-13 12:46:30,681 [INFO]: 544.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:46:30,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:46:30,681 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:46:30
2025-03-13 12:46:30,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:46:30,681 [INFO]: 	Creating the index 03/13/2025, 12:46:30
2025-03-13 12:46:30,681 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:46:30
2025-03-13 12:46:30,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:46:30,682 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:46:30
2025-03-13 12:46:30,682 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:46:30,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.56it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.40it/s]100%|██████████| 11/11 [00:01<00:00,  4.70it/s]100%|██████████| 11/11 [00:02<00:00,  5.50it/s]
2025-03-13 12:46:32,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:46:32
2025-03-13 12:47:06,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9995 secs
2025-03-13 12:47:06,687 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:47:06,687 [INFO]: 	Compute fast metrics 03/13/2025, 12:47:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 12:47:23,041 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3542 secs
2025-03-13 12:47:23,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3603 secs
2025-03-13 12:47:23,043 [INFO]: {
2025-03-13 12:47:23,043 [INFO]: 	index_key: HNSW15
2025-03-13 12:47:23,043 [INFO]: 	index_param: efSearch=222
2025-03-13 12:47:23,043 [INFO]: 	index_path: knn.index
2025-03-13 12:47:23,043 [INFO]: 	size in bytes: 519207070
2025-03-13 12:47:23,043 [INFO]: 	avg_search_speed_ms: 9.09055912592025
2025-03-13 12:47:23,043 [INFO]: 	99p_search_speed_ms: 13.820543538313359
2025-03-13 12:47:23,043 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:23,043 [INFO]: 	nb vectors: 2639
2025-03-13 12:47:23,043 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:23,043 [INFO]: 	compression ratio: 0.9993094123313845
2025-03-13 12:47:23,043 [INFO]: }
2025-03-13 12:47:23,043 [INFO]: 	>>> Finished "Creating the index" in 52.3619 secs
2025-03-13 12:47:23,043 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3931 secs
2025-03-13 12:47:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 29299 [episode count 19/20]
2025-03-13 12:47:24: [retrieval_preprocessing] finished for 3246924425_yellow_object_in_bowl [chosen_id count 5/260]
2025-03-13 12:47:27: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3423129689_fold_towel [chosen_id count 6/260]
2025-03-13 12:47:27: [retrieval_preprocessing] we have num_total=15540 embedding_dim=49152
[retrieval_preprocessing] for episode 81041 [episode count 0/20], we have num_retrieval=np.int64(14632) num_query=np.int64(908)
2025-03-13 12:47:29,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:47:31,211 [INFO]: Launching the whole pipeline 03/13/2025, 12:47:31
2025-03-13 12:47:31,211 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:47:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2245.34it/s]
2025-03-13 12:47:31,244 [INFO]: There are 14632 embeddings of dim 49152
2025-03-13 12:47:31,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 12:47:31,245 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:47:31
2025-03-13 12:47:31,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:47:31,245 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 12:47:31,245 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:47:31,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:47:31,246 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:47:31
2025-03-13 12:47:31,246 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:47:31,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:47:31,246 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:47:31
2025-03-13 12:47:31,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:47:31,247 [INFO]: 	Creating the index 03/13/2025, 12:47:31
2025-03-13 12:47:31,247 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:47:31
2025-03-13 12:47:31,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 12:47:31,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:47:31
2025-03-13 12:47:31,251 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 12:47:31,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:04<03:59,  4.07s/it] 12%|█▏        | 7/60 [00:04<00:23,  2.26it/s] 22%|██▏       | 13/60 [00:04<00:09,  4.87it/s] 32%|███▏      | 19/60 [00:04<00:05,  8.19it/s] 40%|████      | 24/60 [00:20<00:42,  1.18s/it] 48%|████▊     | 29/60 [00:20<00:24,  1.25it/s] 58%|█████▊    | 35/60 [00:20<00:12,  1.93it/s] 67%|██████▋   | 40/60 [00:20<00:07,  2.72it/s] 75%|███████▌  | 45/60 [00:28<00:10,  1.37it/s] 82%|████████▏ | 49/60 [00:29<00:06,  1.69it/s] 92%|█████████▏| 55/60 [00:29<00:01,  2.57it/s]100%|██████████| 60/60 [00:37<00:00,  1.35it/s]100%|██████████| 60/60 [00:37<00:00,  1.61it/s]
2025-03-13 12:48:08,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:08
2025-03-13 12:49:53,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 105.3713 secs
2025-03-13 12:49:53,919 [INFO]: The best hyperparameters are: efSearch=110
2025-03-13 12:49:53,919 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.40it/s]
2025-03-13 12:50:40,506 [INFO]: 	>>> Finished "Compute fast metrics" in 46.5865 secs
2025-03-13 12:50:40,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 189.2596 secs
2025-03-13 12:50:40,511 [INFO]: {
2025-03-13 12:50:40,511 [INFO]: 	index_key: HNSW32
2025-03-13 12:50:40,511 [INFO]: 	index_param: efSearch=110
2025-03-13 12:50:40,511 [INFO]: 	index_path: knn.index
2025-03-13 12:50:40,511 [INFO]: 	size in bytes: 2880750402
2025-03-13 12:50:40,511 [INFO]: 	avg_search_speed_ms: 12.980660959962277
2025-03-13 12:50:40,511 [INFO]: 	99p_search_speed_ms: 23.948181117884793
2025-03-13 12:50:40,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:40,511 [INFO]: 	nb vectors: 14632
2025-03-13 12:50:40,511 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:40,511 [INFO]: 	compression ratio: 0.9986176705912336
2025-03-13 12:50:40,511 [INFO]: }
2025-03-13 12:50:40,511 [INFO]: 	>>> Finished "Creating the index" in 189.2639 secs
2025-03-13 12:50:40,511 [INFO]: >>> Finished "Launching the whole pipeline" in 189.2997 secs
2025-03-13 12:50:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 81041 [episode count 0/20]
[retrieval_preprocessing] for episode 16931 [episode count 1/20], we have num_retrieval=np.int64(14601) num_query=np.int64(939)
2025-03-13 12:50:48,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:50,940 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:50
2025-03-13 12:50:50,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1183.83it/s]
2025-03-13 12:50:50,979 [INFO]: There are 14601 embeddings of dim 49152
2025-03-13 12:50:50,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-13 12:50:50,979 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:50
2025-03-13 12:50:50,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:50,979 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 12:50:50,979 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:50:50,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:50:50,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:50
2025-03-13 12:50:50,979 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:50,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:50:50,980 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:50
2025-03-13 12:50:50,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:50,980 [INFO]: 	Creating the index 03/13/2025, 12:50:50
2025-03-13 12:50:50,980 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:50:50
2025-03-13 12:50:50,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:50:50,981 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:50
2025-03-13 12:50:50,981 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 12:50:50,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:09,  6.25it/s]  7%|▋         | 4/60 [00:00<00:03, 16.57it/s] 15%|█▌        | 9/60 [00:00<00:01, 27.10it/s] 23%|██▎       | 14/60 [00:00<00:01, 32.95it/s] 32%|███▏      | 19/60 [00:00<00:01, 36.64it/s] 38%|███▊      | 23/60 [00:06<00:17,  2.14it/s] 48%|████▊     | 29/60 [00:06<00:08,  3.51it/s] 58%|█████▊    | 35/60 [00:06<00:04,  5.33it/s] 68%|██████▊   | 41/60 [00:06<00:02,  7.71it/s] 77%|███████▋  | 46/60 [00:14<00:07,  1.84it/s] 83%|████████▎ | 50/60 [00:14<00:04,  2.33it/s] 88%|████████▊ | 53/60 [00:14<00:02,  2.80it/s] 97%|█████████▋| 58/60 [00:15<00:00,  4.07it/s]100%|██████████| 60/60 [00:22<00:00,  2.63it/s]
2025-03-13 12:51:13,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:13
2025-03-13 12:52:42,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 88.6073 secs
2025-03-13 12:52:42,432 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 12:52:42,432 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.28s/it] 50%|█████     | 2/4 [00:04<00:05,  2.70s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.90s/it] 75%|███████▌  | 3/4 [00:14<00:04,  4.88s/it]
2025-03-13 12:53:27,538 [INFO]: 	>>> Finished "Compute fast metrics" in 45.1058 secs
2025-03-13 12:53:27,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.7143 secs
2025-03-13 12:53:27,696 [INFO]: {
2025-03-13 12:53:27,696 [INFO]: 	index_key: HNSW32
2025-03-13 12:53:27,696 [INFO]: 	index_param: efSearch=95
2025-03-13 12:53:27,696 [INFO]: 	index_path: knn.index
2025-03-13 12:53:27,696 [INFO]: 	size in bytes: 2874647118
2025-03-13 12:53:27,696 [INFO]: 	avg_search_speed_ms: 8.94487549099735
2025-03-13 12:53:27,696 [INFO]: 	99p_search_speed_ms: 16.222235839813933
2025-03-13 12:53:27,696 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:27,696 [INFO]: 	nb vectors: 14601
2025-03-13 12:53:27,696 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:27,696 [INFO]: 	compression ratio: 0.9986176703306927
2025-03-13 12:53:27,696 [INFO]: }
2025-03-13 12:53:27,696 [INFO]: 	>>> Finished "Creating the index" in 156.7165 secs
2025-03-13 12:53:27,696 [INFO]: >>> Finished "Launching the whole pipeline" in 156.7561 secs
2025-03-13 12:53:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 16931 [episode count 1/20]
[retrieval_preprocessing] for episode 71472 [episode count 2/20], we have num_retrieval=np.int64(14624) num_query=np.int64(916)
2025-03-13 12:53:35,038 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:37,418 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:37
2025-03-13 12:53:37,418 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.09it/s]
2025-03-13 12:53:37,456 [INFO]: There are 14624 embeddings of dim 49152
2025-03-13 12:53:37,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-13 12:53:37,457 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:37
2025-03-13 12:53:37,457 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:37,458 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 12:53:37,458 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:53:37,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:53:37,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:37
2025-03-13 12:53:37,459 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:37,459 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:53:37,459 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:37
2025-03-13 12:53:37,459 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 12:53:37,460 [INFO]: 	Creating the index 03/13/2025, 12:53:37
2025-03-13 12:53:37,460 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:53:37
2025-03-13 12:53:37,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0033 secs
2025-03-13 12:53:37,464 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:37
2025-03-13 12:53:37,464 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 12:53:37,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:08,  6.97it/s]  8%|▊         | 5/60 [00:00<00:02, 21.68it/s] 17%|█▋        | 10/60 [00:00<00:01, 30.25it/s] 23%|██▎       | 14/60 [00:01<00:05,  8.72it/s] 32%|███▏      | 19/60 [00:01<00:03, 12.99it/s] 37%|███▋      | 22/60 [00:13<00:41,  1.10s/it] 38%|███▊      | 23/60 [00:15<00:47,  1.28s/it] 42%|████▏     | 25/60 [00:16<00:36,  1.05s/it] 48%|████▊     | 29/60 [00:17<00:22,  1.35it/s] 52%|█████▏    | 31/60 [00:18<00:18,  1.61it/s] 60%|██████    | 36/60 [00:18<00:08,  2.84it/s] 68%|██████▊   | 41/60 [00:18<00:04,  4.48it/s] 73%|███████▎  | 44/60 [00:28<00:15,  1.03it/s] 82%|████████▏ | 49/60 [00:28<00:06,  1.62it/s] 90%|█████████ | 54/60 [00:28<00:02,  2.44it/s] 98%|█████████▊| 59/60 [00:28<00:00,  3.54it/s]100%|██████████| 60/60 [00:36<00:00,  1.64it/s]
2025-03-13 12:54:14,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:54:14
2025-03-13 12:55:44,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.7344 secs
2025-03-13 12:55:44,869 [INFO]: The best hyperparameters are: efSearch=88
2025-03-13 12:55:44,869 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.18it/s]
2025-03-13 12:56:29,054 [INFO]: 	>>> Finished "Compute fast metrics" in 44.1854 secs
2025-03-13 12:56:29,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 171.5929 secs
2025-03-13 12:56:29,057 [INFO]: {
2025-03-13 12:56:29,057 [INFO]: 	index_key: HNSW32
2025-03-13 12:56:29,057 [INFO]: 	index_param: efSearch=88
2025-03-13 12:56:29,057 [INFO]: 	index_path: knn.index
2025-03-13 12:56:29,057 [INFO]: 	size in bytes: 2879175394
2025-03-13 12:56:29,057 [INFO]: 	avg_search_speed_ms: 9.652456107979072
2025-03-13 12:56:29,057 [INFO]: 	99p_search_speed_ms: 16.70007617212832
2025-03-13 12:56:29,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:29,057 [INFO]: 	nb vectors: 14624
2025-03-13 12:56:29,057 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:29,057 [INFO]: 	compression ratio: 0.9986176590671433
2025-03-13 12:56:29,057 [INFO]: }
2025-03-13 12:56:29,057 [INFO]: 	>>> Finished "Creating the index" in 171.5973 secs
2025-03-13 12:56:29,057 [INFO]: >>> Finished "Launching the whole pipeline" in 171.6391 secs
2025-03-13 12:56:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 71472 [episode count 2/20]
[retrieval_preprocessing] for episode 62898 [episode count 3/20], we have num_retrieval=np.int64(15158) num_query=np.int64(382)
2025-03-13 12:56:35,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:38,729 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:38
2025-03-13 12:56:38,729 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.02it/s]
2025-03-13 12:56:38,762 [INFO]: There are 15158 embeddings of dim 49152
2025-03-13 12:56:38,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-13 12:56:38,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:38,763 [INFO]: 		-> Add: 8.3 seconds
2025-03-13 12:56:38,763 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:56:38,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:56:38,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,763 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:38,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:56:38,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:38
2025-03-13 12:56:38,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:38,763 [INFO]: 	Creating the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,763 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:56:38
2025-03-13 12:56:38,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:56:38,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:38
2025-03-13 12:56:38,764 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 12:56:38,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:08,  7.29it/s]  8%|▊         | 5/62 [00:00<00:02, 22.04it/s] 16%|█▌        | 10/62 [00:00<00:01, 32.12it/s] 24%|██▍       | 15/62 [00:00<00:01, 37.62it/s] 32%|███▏      | 20/62 [00:00<00:01, 41.14it/s] 40%|████      | 25/62 [00:07<00:19,  1.90it/s] 50%|█████     | 31/62 [00:07<00:10,  3.02it/s] 60%|█████▉    | 37/62 [00:07<00:05,  4.53it/s] 68%|██████▊   | 42/62 [00:14<00:11,  1.76it/s] 76%|███████▌  | 47/62 [00:14<00:06,  2.47it/s] 85%|████████▌ | 53/62 [00:15<00:02,  3.64it/s] 95%|█████████▌| 59/62 [00:15<00:00,  5.23it/s]100%|██████████| 62/62 [00:23<00:00,  2.65it/s]
2025-03-13 12:57:02,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:57:02
2025-03-13 12:58:27,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.4627 secs
2025-03-13 12:58:27,653 [INFO]: The best hyperparameters are: efSearch=59
2025-03-13 12:58:27,654 [INFO]: 	Compute fast metrics 03/13/2025, 12:58:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-13 12:58:51,980 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3259 secs
2025-03-13 12:58:51,983 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2182 secs
2025-03-13 12:58:51,983 [INFO]: {
2025-03-13 12:58:51,983 [INFO]: 	index_key: HNSW32
2025-03-13 12:58:51,983 [INFO]: 	index_param: efSearch=59
2025-03-13 12:58:51,983 [INFO]: 	index_path: knn.index
2025-03-13 12:58:51,983 [INFO]: 	size in bytes: 2984309610
2025-03-13 12:58:51,983 [INFO]: 	avg_search_speed_ms: 7.606425013095707
2025-03-13 12:58:51,983 [INFO]: 	99p_search_speed_ms: 12.576400521211312
2025-03-13 12:58:51,983 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:51,983 [INFO]: 	nb vectors: 15158
2025-03-13 12:58:51,983 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:51,983 [INFO]: 	compression ratio: 0.9986175878045039
2025-03-13 12:58:51,983 [INFO]: }
2025-03-13 12:58:51,983 [INFO]: 	>>> Finished "Creating the index" in 133.2197 secs
2025-03-13 12:58:51,983 [INFO]: >>> Finished "Launching the whole pipeline" in 133.2543 secs
2025-03-13 12:58:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 62898 [episode count 3/20]
[retrieval_preprocessing] for episode 33460 [episode count 4/20], we have num_retrieval=np.int64(14498) num_query=np.int64(1042)
2025-03-13 12:58:56,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:58,991 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:58
2025-03-13 12:58:58,991 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.14it/s]
2025-03-13 12:58:59,025 [INFO]: There are 14498 embeddings of dim 49152
2025-03-13 12:58:59,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 12:58:59,025 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:59
2025-03-13 12:58:59,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:59,025 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 12:58:59,025 [INFO]: 		Total: 16.8 minutes
2025-03-13 12:58:59,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:59,025 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:59
2025-03-13 12:58:59,025 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:59,025 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:59,025 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:59
2025-03-13 12:58:59,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:59,026 [INFO]: 	Creating the index 03/13/2025, 12:58:59
2025-03-13 12:58:59,026 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 12:58:59
2025-03-13 12:58:59,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 12:58:59,027 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:59
2025-03-13 12:58:59,027 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 12:58:59,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:07,  7.44it/s]  8%|▊         | 5/60 [00:00<00:02, 22.72it/s] 17%|█▋        | 10/60 [00:00<00:01, 31.22it/s] 25%|██▌       | 15/60 [00:00<00:01, 37.23it/s] 33%|███▎      | 20/60 [00:00<00:00, 40.59it/s] 42%|████▏     | 25/60 [00:08<00:20,  1.73it/s] 48%|████▊     | 29/60 [00:08<00:12,  2.40it/s] 55%|█████▌    | 33/60 [00:08<00:08,  3.32it/s] 62%|██████▏   | 37/60 [00:08<00:05,  4.55it/s] 68%|██████▊   | 41/60 [00:08<00:03,  6.18it/s] 75%|███████▌  | 45/60 [00:18<00:12,  1.23it/s] 83%|████████▎ | 50/60 [00:18<00:05,  1.86it/s] 92%|█████████▏| 55/60 [00:18<00:01,  2.72it/s]100%|██████████| 60/60 [00:27<00:00,  1.19it/s]100%|██████████| 60/60 [00:27<00:00,  2.17it/s]
2025-03-13 12:59:26,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:59:26
2025-03-13 13:00:56,864 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.2375 secs
2025-03-13 13:00:56,864 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 13:00:56,865 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.84it/s]
2025-03-13 13:01:21,606 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7415 secs
2025-03-13 13:01:21,609 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.5820 secs
2025-03-13 13:01:21,609 [INFO]: {
2025-03-13 13:01:21,609 [INFO]: 	index_key: HNSW32
2025-03-13 13:01:21,609 [INFO]: 	index_param: efSearch=107
2025-03-13 13:01:21,609 [INFO]: 	index_path: knn.index
2025-03-13 13:01:21,609 [INFO]: 	size in bytes: 2854368506
2025-03-13 13:01:21,609 [INFO]: 	avg_search_speed_ms: 11.631442268573961
2025-03-13 13:01:21,609 [INFO]: 	99p_search_speed_ms: 20.59865481918677
2025-03-13 13:01:21,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:01:21,609 [INFO]: 	nb vectors: 14498
2025-03-13 13:01:21,609 [INFO]: 	vectors dimension: 49152
2025-03-13 13:01:21,609 [INFO]: 	compression ratio: 0.9986176550113604
2025-03-13 13:01:21,609 [INFO]: }
2025-03-13 13:01:21,609 [INFO]: 	>>> Finished "Creating the index" in 142.5835 secs
2025-03-13 13:01:21,609 [INFO]: >>> Finished "Launching the whole pipeline" in 142.6178 secs
2025-03-13 13:01:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:01:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 33460 [episode count 4/20]
[retrieval_preprocessing] for episode 60341 [episode count 5/20], we have num_retrieval=np.int64(14913) num_query=np.int64(627)
2025-03-13 13:01:28,388 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:01:30,959 [INFO]: Launching the whole pipeline 03/13/2025, 13:01:30
2025-03-13 13:01:30,959 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.20it/s]
2025-03-13 13:01:30,988 [INFO]: There are 14913 embeddings of dim 49152
2025-03-13 13:01:30,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 13:01:30,989 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:01:30
2025-03-13 13:01:30,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:01:30,989 [INFO]: 		-> Add: 8.2 seconds
2025-03-13 13:01:30,989 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:01:30,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:01:30,989 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:01:30
2025-03-13 13:01:30,989 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:01:30,989 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:01:30,989 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:01:30
2025-03-13 13:01:30,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:01:30,989 [INFO]: 	Creating the index 03/13/2025, 13:01:30
2025-03-13 13:01:30,989 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:01:30
2025-03-13 13:01:30,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0007 secs
2025-03-13 13:01:30,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:01:30
2025-03-13 13:01:30,990 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:01:30,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:00<00:07,  7.87it/s]  8%|▊         | 5/61 [00:00<00:02, 24.66it/s] 18%|█▊        | 11/61 [00:00<00:01, 38.49it/s] 30%|██▉       | 18/61 [00:00<00:00, 47.42it/s] 38%|███▊      | 23/61 [00:05<00:13,  2.77it/s] 49%|████▉     | 30/61 [00:05<00:06,  4.55it/s] 61%|██████    | 37/61 [00:05<00:03,  6.91it/s] 69%|██████▉   | 42/61 [00:12<00:09,  2.09it/s] 72%|███████▏  | 44/61 [00:24<00:08,  2.09it/s] 74%|███████▍  | 45/61 [00:26<00:20,  1.29s/it] 75%|███████▌  | 46/61 [00:29<00:20,  1.38s/it] 80%|████████  | 49/61 [00:32<00:16,  1.35s/it] 90%|█████████ | 55/61 [00:33<00:04,  1.28it/s]100%|██████████| 61/61 [00:41<00:00,  1.04s/it]100%|██████████| 61/61 [00:41<00:00,  1.46it/s]
2025-03-13 13:02:12,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:12
2025-03-13 13:04:14,369 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 121.5177 secs
2025-03-13 13:04:14,369 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 13:04:14,369 [INFO]: 	Compute fast metrics 03/13/2025, 13:04:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.59it/s] 50%|█████     | 2/4 [00:00<00:00,  2.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.23it/s]
2025-03-13 13:04:47,262 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8928 secs
2025-03-13 13:04:47,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 196.2888 secs
2025-03-13 13:04:47,279 [INFO]: {
2025-03-13 13:04:47,279 [INFO]: 	index_key: HNSW32
2025-03-13 13:04:47,279 [INFO]: 	index_param: efSearch=107
2025-03-13 13:04:47,279 [INFO]: 	index_path: knn.index
2025-03-13 13:04:47,279 [INFO]: 	size in bytes: 2936073710
2025-03-13 13:04:47,279 [INFO]: 	avg_search_speed_ms: 11.027894846893757
2025-03-13 13:04:47,279 [INFO]: 	99p_search_speed_ms: 19.696208541281514
2025-03-13 13:04:47,279 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:47,279 [INFO]: 	nb vectors: 14913
2025-03-13 13:04:47,279 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:47,279 [INFO]: 	compression ratio: 0.9986176757122355
2025-03-13 13:04:47,279 [INFO]: }
2025-03-13 13:04:47,279 [INFO]: 	>>> Finished "Creating the index" in 196.2902 secs
2025-03-13 13:04:47,279 [INFO]: >>> Finished "Launching the whole pipeline" in 196.3207 secs
2025-03-13 13:04:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 60341 [episode count 5/20]
[retrieval_preprocessing] for episode 76861 [episode count 6/20], we have num_retrieval=np.int64(14637) num_query=np.int64(903)
2025-03-13 13:04:54,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:56,629 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:56
2025-03-13 13:04:56,629 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.37it/s]
2025-03-13 13:04:56,664 [INFO]: There are 14637 embeddings of dim 49152
2025-03-13 13:04:56,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-13 13:04:56,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:56
2025-03-13 13:04:56,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:56,664 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 13:04:56,664 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:04:56,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:56,665 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:56
2025-03-13 13:04:56,665 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:56,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:04:56,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:56
2025-03-13 13:04:56,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:56,665 [INFO]: 	Creating the index 03/13/2025, 13:04:56
2025-03-13 13:04:56,665 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:04:56
2025-03-13 13:04:56,666 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:04:56,666 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:56
2025-03-13 13:04:56,666 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:04:56,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:07,  8.08it/s]  8%|▊         | 5/60 [00:00<00:02, 24.06it/s] 17%|█▋        | 10/60 [00:00<00:01, 33.80it/s] 25%|██▌       | 15/60 [00:00<00:01, 39.08it/s] 33%|███▎      | 20/60 [00:00<00:00, 42.23it/s] 42%|████▏     | 25/60 [00:07<00:17,  2.03it/s] 52%|█████▏    | 31/60 [00:07<00:09,  3.21it/s] 62%|██████▏   | 37/60 [00:07<00:04,  4.80it/s] 70%|███████   | 42/60 [00:14<00:10,  1.71it/s] 78%|███████▊  | 47/60 [00:14<00:05,  2.39it/s] 87%|████████▋ | 52/60 [00:15<00:02,  3.33it/s] 95%|█████████▌| 57/60 [00:15<00:00,  4.61it/s]100%|██████████| 60/60 [00:24<00:00,  2.50it/s]
2025-03-13 13:05:20,698 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:05:20
2025-03-13 13:06:46,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.8034 secs
2025-03-13 13:06:46,502 [INFO]: The best hyperparameters are: efSearch=78
2025-03-13 13:06:46,502 [INFO]: 	Compute fast metrics 03/13/2025, 13:06:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.70it/s]
2025-03-13 13:07:29,632 [INFO]: 	>>> Finished "Compute fast metrics" in 43.1294 secs
2025-03-13 13:07:29,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.9687 secs
2025-03-13 13:07:29,635 [INFO]: {
2025-03-13 13:07:29,635 [INFO]: 	index_key: HNSW32
2025-03-13 13:07:29,635 [INFO]: 	index_param: efSearch=78
2025-03-13 13:07:29,635 [INFO]: 	index_path: knn.index
2025-03-13 13:07:29,635 [INFO]: 	size in bytes: 2881734782
2025-03-13 13:07:29,635 [INFO]: 	avg_search_speed_ms: 10.894800319736072
2025-03-13 13:07:29,635 [INFO]: 	99p_search_speed_ms: 20.606167130172253
2025-03-13 13:07:29,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:29,635 [INFO]: 	nb vectors: 14637
2025-03-13 13:07:29,635 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:29,635 [INFO]: 	compression ratio: 0.9986176777873933
2025-03-13 13:07:29,635 [INFO]: }
2025-03-13 13:07:29,635 [INFO]: 	>>> Finished "Creating the index" in 152.9701 secs
2025-03-13 13:07:29,635 [INFO]: >>> Finished "Launching the whole pipeline" in 153.0057 secs
2025-03-13 13:07:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 76861 [episode count 6/20]
[retrieval_preprocessing] for episode 41662 [episode count 7/20], we have num_retrieval=np.int64(14671) num_query=np.int64(869)
2025-03-13 13:07:35,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:37,422 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:37
2025-03-13 13:07:37,422 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-13 13:07:37,457 [INFO]: There are 14671 embeddings of dim 49152
2025-03-13 13:07:37,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 13:07:37,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:37
2025-03-13 13:07:37,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:37,458 [INFO]: 		-> Add: 8.1 seconds
2025-03-13 13:07:37,458 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:07:37,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:07:37,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:37
2025-03-13 13:07:37,458 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:37,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:07:37,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:37
2025-03-13 13:07:37,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:37,458 [INFO]: 	Creating the index 03/13/2025, 13:07:37
2025-03-13 13:07:37,458 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:07:37
2025-03-13 13:07:37,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:07:37,459 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:37
2025-03-13 13:07:37,459 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:07:37,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:07,  7.59it/s]  8%|▊         | 5/60 [00:00<00:02, 23.19it/s] 17%|█▋        | 10/60 [00:00<00:01, 33.18it/s] 27%|██▋       | 16/60 [00:00<00:01, 40.80it/s] 35%|███▌      | 21/60 [00:07<00:20,  1.92it/s] 42%|████▏     | 25/60 [00:07<00:13,  2.69it/s] 50%|█████     | 30/60 [00:07<00:07,  3.99it/s] 58%|█████▊    | 35/60 [00:07<00:04,  5.71it/s] 67%|██████▋   | 40/60 [00:07<00:02,  7.93it/s] 73%|███████▎  | 44/60 [00:15<00:10,  1.55it/s] 83%|████████▎ | 50/60 [00:15<00:04,  2.41it/s] 93%|█████████▎| 56/60 [00:16<00:01,  3.58it/s]100%|██████████| 60/60 [00:23<00:00,  2.50it/s]
2025-03-13 13:08:01,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:08:01
2025-03-13 13:09:32,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 91.3786 secs
2025-03-13 13:09:32,816 [INFO]: The best hyperparameters are: efSearch=97
2025-03-13 13:09:32,816 [INFO]: 	Compute fast metrics 03/13/2025, 13:09:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.22s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.31it/s]
2025-03-13 13:10:12,300 [INFO]: 	>>> Finished "Compute fast metrics" in 39.4839 secs
2025-03-13 13:10:12,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.8430 secs
2025-03-13 13:10:12,302 [INFO]: {
2025-03-13 13:10:12,302 [INFO]: 	index_key: HNSW32
2025-03-13 13:10:12,302 [INFO]: 	index_param: efSearch=97
2025-03-13 13:10:12,302 [INFO]: 	index_path: knn.index
2025-03-13 13:10:12,302 [INFO]: 	size in bytes: 2888428694
2025-03-13 13:10:12,303 [INFO]: 	avg_search_speed_ms: 9.203868303165224
2025-03-13 13:10:12,303 [INFO]: 	99p_search_speed_ms: 15.90325854253024
2025-03-13 13:10:12,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:12,303 [INFO]: 	nb vectors: 14671
2025-03-13 13:10:12,303 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:12,303 [INFO]: 	compression ratio: 0.9986176823377035
2025-03-13 13:10:12,303 [INFO]: }
2025-03-13 13:10:12,303 [INFO]: 	>>> Finished "Creating the index" in 154.8445 secs
2025-03-13 13:10:12,303 [INFO]: >>> Finished "Launching the whole pipeline" in 154.8802 secs
2025-03-13 13:10:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 41662 [episode count 7/20]
[retrieval_preprocessing] for episode 62015 [episode count 8/20], we have num_retrieval=np.int64(15127) num_query=np.int64(413)
2025-03-13 13:10:18,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:20,150 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:20
2025-03-13 13:10:20,150 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.50it/s]
2025-03-13 13:10:20,186 [INFO]: There are 15127 embeddings of dim 49152
2025-03-13 13:10:20,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-13 13:10:20,186 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:20
2025-03-13 13:10:20,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:20,186 [INFO]: 		-> Add: 8.3 seconds
2025-03-13 13:10:20,186 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:10:20,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:10:20,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:20
2025-03-13 13:10:20,186 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:20,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:20,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:20
2025-03-13 13:10:20,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:20,187 [INFO]: 	Creating the index 03/13/2025, 13:10:20
2025-03-13 13:10:20,187 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:10:20
2025-03-13 13:10:20,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 13:10:20,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:20
2025-03-13 13:10:20,188 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 13:10:20,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:08,  7.53it/s] 10%|▉         | 6/62 [00:00<00:02, 27.89it/s] 18%|█▊        | 11/62 [00:00<00:01, 36.59it/s] 27%|██▋       | 17/62 [00:00<00:01, 42.35it/s] 35%|███▌      | 22/62 [00:06<00:17,  2.35it/s] 45%|████▌     | 28/62 [00:06<00:09,  3.73it/s] 55%|█████▍    | 34/62 [00:06<00:05,  5.58it/s] 65%|██████▍   | 40/62 [00:06<00:02,  8.00it/s] 73%|███████▎  | 45/62 [00:14<00:09,  1.88it/s] 82%|████████▏ | 51/62 [00:14<00:03,  2.76it/s] 92%|█████████▏| 57/62 [00:14<00:01,  3.95it/s]100%|██████████| 62/62 [00:23<00:00,  1.41it/s]100%|██████████| 62/62 [00:23<00:00,  2.60it/s]
2025-03-13 13:10:44,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:44
2025-03-13 13:12:31,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 107.1030 secs
2025-03-13 13:12:31,187 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 13:12:31,188 [INFO]: 	Compute fast metrics 03/13/2025, 13:12:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.19it/s]
2025-03-13 13:13:13,486 [INFO]: 	>>> Finished "Compute fast metrics" in 42.2986 secs
2025-03-13 13:13:13,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 173.3016 secs
2025-03-13 13:13:13,490 [INFO]: {
2025-03-13 13:13:13,490 [INFO]: 	index_key: HNSW32
2025-03-13 13:13:13,490 [INFO]: 	index_param: efSearch=92
2025-03-13 13:13:13,490 [INFO]: 	index_path: knn.index
2025-03-13 13:13:13,490 [INFO]: 	size in bytes: 2978206326
2025-03-13 13:13:13,490 [INFO]: 	avg_search_speed_ms: 11.097429996742955
2025-03-13 13:13:13,490 [INFO]: 	99p_search_speed_ms: 20.227982895448804
2025-03-13 13:13:13,490 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:13,490 [INFO]: 	nb vectors: 15127
2025-03-13 13:13:13,490 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:13,490 [INFO]: 	compression ratio: 0.9986175873833666
2025-03-13 13:13:13,490 [INFO]: }
2025-03-13 13:13:13,490 [INFO]: 	>>> Finished "Creating the index" in 173.3033 secs
2025-03-13 13:13:13,490 [INFO]: >>> Finished "Launching the whole pipeline" in 173.3402 secs
2025-03-13 13:13:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 62015 [episode count 8/20]
[retrieval_preprocessing] for episode 10184 [episode count 9/20], we have num_retrieval=np.int64(14762) num_query=np.int64(778)
2025-03-13 13:13:18,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:20,241 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:20
2025-03-13 13:13:20,241 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2172.09it/s]
2025-03-13 13:13:20,274 [INFO]: There are 14762 embeddings of dim 49152
2025-03-13 13:13:20,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 13:13:20,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:20
2025-03-13 13:13:20,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:20,275 [INFO]: 		-> Add: 8.1 seconds
2025-03-13 13:13:20,275 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:13:20,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:20,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:20
2025-03-13 13:13:20,275 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:20,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:13:20,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:20
2025-03-13 13:13:20,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:20,275 [INFO]: 	Creating the index 03/13/2025, 13:13:20
2025-03-13 13:13:20,275 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:13:20
2025-03-13 13:13:20,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0008 secs
2025-03-13 13:13:20,276 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:20
2025-03-13 13:13:20,276 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:13:20,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:00<00:07,  7.59it/s]  8%|▊         | 5/61 [00:00<00:02, 22.53it/s] 16%|█▋        | 10/61 [00:00<00:01, 33.16it/s] 25%|██▍       | 15/61 [00:00<00:01, 38.90it/s] 34%|███▍      | 21/61 [00:06<00:18,  2.17it/s] 43%|████▎     | 26/61 [00:06<00:10,  3.23it/s] 52%|█████▏    | 32/61 [00:06<00:05,  4.97it/s] 62%|██████▏   | 38/61 [00:06<00:03,  7.25it/s] 70%|███████   | 43/61 [00:14<00:09,  1.81it/s] 80%|████████  | 49/61 [00:14<00:04,  2.67it/s] 90%|█████████ | 55/61 [00:14<00:01,  3.85it/s]100%|██████████| 61/61 [00:22<00:00,  1.70it/s]100%|██████████| 61/61 [00:22<00:00,  2.69it/s]
2025-03-13 13:13:42,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:42
2025-03-13 13:15:10,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.2887 secs
2025-03-13 13:15:10,249 [INFO]: The best hyperparameters are: efSearch=75
2025-03-13 13:15:10,249 [INFO]: 	Compute fast metrics 03/13/2025, 13:15:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-13 13:15:42,127 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8775 secs
2025-03-13 13:15:42,130 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.8535 secs
2025-03-13 13:15:42,130 [INFO]: {
2025-03-13 13:15:42,130 [INFO]: 	index_key: HNSW32
2025-03-13 13:15:42,130 [INFO]: 	index_param: efSearch=75
2025-03-13 13:15:42,130 [INFO]: 	index_path: knn.index
2025-03-13 13:15:42,130 [INFO]: 	size in bytes: 2906344538
2025-03-13 13:15:42,130 [INFO]: 	avg_search_speed_ms: 9.842617195704586
2025-03-13 13:15:42,130 [INFO]: 	99p_search_speed_ms: 18.233646685257554
2025-03-13 13:15:42,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:15:42,130 [INFO]: 	nb vectors: 14762
2025-03-13 13:15:42,130 [INFO]: 	vectors dimension: 49152
2025-03-13 13:15:42,130 [INFO]: 	compression ratio: 0.998617768145698
2025-03-13 13:15:42,130 [INFO]: }
2025-03-13 13:15:42,130 [INFO]: 	>>> Finished "Creating the index" in 141.8549 secs
2025-03-13 13:15:42,130 [INFO]: >>> Finished "Launching the whole pipeline" in 141.8891 secs
2025-03-13 13:15:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:15:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 10184 [episode count 9/20]
[retrieval_preprocessing] for episode 28623 [episode count 10/20], we have num_retrieval=np.int64(14623) num_query=np.int64(917)
2025-03-13 13:15:48,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:50,769 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:50
2025-03-13 13:15:50,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.89it/s]
2025-03-13 13:15:50,807 [INFO]: There are 14623 embeddings of dim 49152
2025-03-13 13:15:50,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 13:15:50,808 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:50
2025-03-13 13:15:50,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:50,808 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 13:15:50,808 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:15:50,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:50,808 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:50
2025-03-13 13:15:50,808 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:50,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:15:50,808 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:50
2025-03-13 13:15:50,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:50,809 [INFO]: 	Creating the index 03/13/2025, 13:15:50
2025-03-13 13:15:50,809 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:15:50
2025-03-13 13:15:50,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 13:15:50,810 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:50
2025-03-13 13:15:50,810 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:15:50,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:07,  7.76it/s]  3%|▎         | 2/60 [00:00<00:06,  8.76it/s]  5%|▌         | 3/60 [00:00<00:07,  7.56it/s]  8%|▊         | 5/60 [00:00<00:05,  9.73it/s] 12%|█▏        | 7/60 [00:00<00:04, 10.75it/s] 15%|█▌        | 9/60 [00:00<00:04, 11.35it/s] 18%|█▊        | 11/60 [00:01<00:04, 11.82it/s] 22%|██▏       | 13/60 [00:01<00:03, 12.08it/s] 25%|██▌       | 15/60 [00:01<00:03, 12.20it/s] 28%|██▊       | 17/60 [00:01<00:03, 12.39it/s] 32%|███▏      | 19/60 [00:01<00:03, 12.45it/s] 35%|███▌      | 21/60 [00:07<00:39,  1.02s/it] 43%|████▎     | 26/60 [00:08<00:16,  2.01it/s] 53%|█████▎    | 32/60 [00:08<00:07,  3.70it/s] 63%|██████▎   | 38/60 [00:08<00:03,  5.92it/s] 70%|███████   | 42/60 [00:14<00:10,  1.72it/s] 77%|███████▋  | 46/60 [00:14<00:05,  2.36it/s] 85%|████████▌ | 51/60 [00:15<00:02,  3.46it/s] 93%|█████████▎| 56/60 [00:15<00:00,  4.92it/s]100%|██████████| 60/60 [00:22<00:00,  1.56it/s]100%|██████████| 60/60 [00:22<00:00,  2.67it/s]
2025-03-13 13:16:13,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:13
2025-03-13 13:17:49,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.5142 secs
2025-03-13 13:17:49,812 [INFO]: The best hyperparameters are: efSearch=79
2025-03-13 13:17:49,812 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.11it/s]
2025-03-13 13:18:42,367 [INFO]: 	>>> Finished "Compute fast metrics" in 52.5545 secs
2025-03-13 13:18:42,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 171.5590 secs
2025-03-13 13:18:42,369 [INFO]: {
2025-03-13 13:18:42,369 [INFO]: 	index_key: HNSW32
2025-03-13 13:18:42,369 [INFO]: 	index_param: efSearch=79
2025-03-13 13:18:42,369 [INFO]: 	index_path: knn.index
2025-03-13 13:18:42,369 [INFO]: 	size in bytes: 2878978518
2025-03-13 13:18:42,369 [INFO]: 	avg_search_speed_ms: 9.21525161730529
2025-03-13 13:18:42,369 [INFO]: 	99p_search_speed_ms: 19.70931400544942
2025-03-13 13:18:42,369 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:18:42,369 [INFO]: 	nb vectors: 14623
2025-03-13 13:18:42,369 [INFO]: 	vectors dimension: 49152
2025-03-13 13:18:42,369 [INFO]: 	compression ratio: 0.9986176576257454
2025-03-13 13:18:42,369 [INFO]: }
2025-03-13 13:18:42,369 [INFO]: 	>>> Finished "Creating the index" in 171.5609 secs
2025-03-13 13:18:42,369 [INFO]: >>> Finished "Launching the whole pipeline" in 171.6002 secs
2025-03-13 13:18:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:18:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 28623 [episode count 10/20]
[retrieval_preprocessing] for episode 91489 [episode count 11/20], we have num_retrieval=np.int64(14537) num_query=np.int64(1003)
2025-03-13 13:18:47,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:18:49,769 [INFO]: Launching the whole pipeline 03/13/2025, 13:18:49
2025-03-13 13:18:49,769 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:18:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2286.97it/s]
2025-03-13 13:18:49,800 [INFO]: There are 14537 embeddings of dim 49152
2025-03-13 13:18:49,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 13:18:49,801 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:18:49
2025-03-13 13:18:49,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:18:49,801 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 13:18:49,801 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:18:49,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:18:49,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:18:49
2025-03-13 13:18:49,801 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:18:49,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:18:49,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:18:49
2025-03-13 13:18:49,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:18:49,801 [INFO]: 	Creating the index 03/13/2025, 13:18:49
2025-03-13 13:18:49,801 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:18:49
2025-03-13 13:18:49,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:18:49,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:18:49
2025-03-13 13:18:49,802 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:18:49,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:09,  6.51it/s] 10%|█         | 6/60 [00:00<00:02, 25.15it/s] 18%|█▊        | 11/60 [00:00<00:01, 33.87it/s] 28%|██▊       | 17/60 [00:00<00:01, 40.27it/s] 37%|███▋      | 22/60 [00:07<00:19,  1.95it/s] 43%|████▎     | 26/60 [00:07<00:12,  2.71it/s] 50%|█████     | 30/60 [00:07<00:08,  3.74it/s] 57%|█████▋    | 34/60 [00:07<00:05,  5.10it/s] 63%|██████▎   | 38/60 [00:07<00:03,  6.84it/s] 70%|███████   | 42/60 [00:17<00:14,  1.25it/s] 78%|███████▊  | 47/60 [00:17<00:06,  1.89it/s] 87%|████████▋ | 52/60 [00:17<00:02,  2.77it/s] 95%|█████████▌| 57/60 [00:17<00:00,  3.97it/s]100%|██████████| 60/60 [00:25<00:00,  2.35it/s]
2025-03-13 13:19:15,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:15
2025-03-13 13:20:51,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.3469 secs
2025-03-13 13:20:51,676 [INFO]: The best hyperparameters are: efSearch=82
2025-03-13 13:20:51,676 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.74it/s]
2025-03-13 13:21:21,973 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2963 secs
2025-03-13 13:21:21,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.1748 secs
2025-03-13 13:21:21,977 [INFO]: {
2025-03-13 13:21:21,977 [INFO]: 	index_key: HNSW32
2025-03-13 13:21:21,977 [INFO]: 	index_param: efSearch=82
2025-03-13 13:21:21,977 [INFO]: 	index_path: knn.index
2025-03-13 13:21:21,977 [INFO]: 	size in bytes: 2862046798
2025-03-13 13:21:21,978 [INFO]: 	avg_search_speed_ms: 9.322933744394392
2025-03-13 13:21:21,978 [INFO]: 	99p_search_speed_ms: 15.627356069162476
2025-03-13 13:21:21,978 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:21,978 [INFO]: 	nb vectors: 14537
2025-03-13 13:21:21,978 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:21,978 [INFO]: 	compression ratio: 0.998617666907905
2025-03-13 13:21:21,978 [INFO]: }
2025-03-13 13:21:21,978 [INFO]: 	>>> Finished "Creating the index" in 152.1767 secs
2025-03-13 13:21:21,978 [INFO]: >>> Finished "Launching the whole pipeline" in 152.2087 secs
2025-03-13 13:21:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 91489 [episode count 11/20]
[retrieval_preprocessing] for episode 11496 [episode count 12/20], we have num_retrieval=np.int64(14236) num_query=np.int64(1304)
2025-03-13 13:21:28,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:30,482 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:30
2025-03-13 13:21:30,482 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1404.66it/s]
2025-03-13 13:21:30,517 [INFO]: There are 14236 embeddings of dim 49152
2025-03-13 13:21:30,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 13:21:30,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:30
2025-03-13 13:21:30,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:30,518 [INFO]: 		-> Add: 7.8 seconds
2025-03-13 13:21:30,518 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:21:30,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:21:30,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:30
2025-03-13 13:21:30,518 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:30,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:21:30,518 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:30
2025-03-13 13:21:30,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:30,518 [INFO]: 	Creating the index 03/13/2025, 13:21:30
2025-03-13 13:21:30,518 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:21:30
2025-03-13 13:21:30,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 13:21:30,519 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:30
2025-03-13 13:21:30,519 [INFO]: The memory available for adding the vectors is 47.4GB(total available - used by the index)
2025-03-13 13:21:30,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/58 [00:00<?, ?it/s]  2%|▏         | 1/58 [00:00<00:08,  7.02it/s] 10%|█         | 6/58 [00:00<00:01, 26.42it/s] 19%|█▉        | 11/58 [00:00<00:01, 35.25it/s] 29%|██▉       | 17/58 [00:00<00:00, 41.45it/s] 38%|███▊      | 22/58 [00:06<00:15,  2.26it/s] 48%|████▊     | 28/58 [00:06<00:08,  3.58it/s] 59%|█████▊    | 34/58 [00:06<00:04,  5.37it/s] 69%|██████▉   | 40/58 [00:06<00:02,  7.71it/s] 78%|███████▊  | 45/58 [00:14<00:07,  1.84it/s] 88%|████████▊ | 51/58 [00:14<00:02,  2.69it/s] 98%|█████████▊| 57/58 [00:14<00:00,  3.86it/s]100%|██████████| 58/58 [00:21<00:00,  2.66it/s]
2025-03-13 13:21:52,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:52
2025-03-13 13:23:23,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 91.5936 secs
2025-03-13 13:23:23,914 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 13:23:23,914 [INFO]: 	Compute fast metrics 03/13/2025, 13:23:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.75it/s]
2025-03-13 13:23:56,607 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6926 secs
2025-03-13 13:23:56,609 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.0897 secs
2025-03-13 13:23:56,609 [INFO]: {
2025-03-13 13:23:56,609 [INFO]: 	index_key: HNSW32
2025-03-13 13:23:56,609 [INFO]: 	index_param: efSearch=99
2025-03-13 13:23:56,609 [INFO]: 	index_path: knn.index
2025-03-13 13:23:56,609 [INFO]: 	size in bytes: 2802785714
2025-03-13 13:23:56,609 [INFO]: 	avg_search_speed_ms: 9.438212960079875
2025-03-13 13:23:56,609 [INFO]: 	99p_search_speed_ms: 15.419832095503812
2025-03-13 13:23:56,609 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:23:56,609 [INFO]: 	nb vectors: 14236
2025-03-13 13:23:56,609 [INFO]: 	vectors dimension: 49152
2025-03-13 13:23:56,609 [INFO]: 	compression ratio: 0.9986177230814871
2025-03-13 13:23:56,609 [INFO]: }
2025-03-13 13:23:56,609 [INFO]: 	>>> Finished "Creating the index" in 146.0914 secs
2025-03-13 13:23:56,609 [INFO]: >>> Finished "Launching the whole pipeline" in 146.1272 secs
2025-03-13 13:23:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 11496 [episode count 12/20]
[retrieval_preprocessing] for episode 26472 [episode count 13/20], we have num_retrieval=np.int64(15221) num_query=np.int64(319)
2025-03-13 13:24:05,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:07,485 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:07
2025-03-13 13:24:07,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1098.27it/s]
2025-03-13 13:24:07,518 [INFO]: There are 15221 embeddings of dim 49152
2025-03-13 13:24:07,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 13:24:07,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:07,519 [INFO]: 		-> Add: 8.4 seconds
2025-03-13 13:24:07,519 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:24:07,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:24:07,519 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,519 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:07,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:24:07,519 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:07
2025-03-13 13:24:07,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:07,519 [INFO]: 	Creating the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,519 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:24:07
2025-03-13 13:24:07,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 13:24:07,520 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:07
2025-03-13 13:24:07,520 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 13:24:07,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:10,  5.91it/s] 10%|▉         | 6/62 [00:00<00:02, 25.58it/s] 19%|█▉        | 12/62 [00:00<00:01, 37.71it/s] 29%|██▉       | 18/62 [00:00<00:00, 45.26it/s] 37%|███▋      | 23/62 [00:07<00:19,  1.98it/s] 47%|████▋     | 29/62 [00:07<00:10,  3.12it/s] 56%|█████▋    | 35/62 [00:07<00:05,  4.67it/s] 66%|██████▌   | 41/62 [00:07<00:03,  6.73it/s] 74%|███████▍  | 46/62 [00:14<00:08,  1.98it/s] 84%|████████▍ | 52/62 [00:14<00:03,  2.89it/s] 92%|█████████▏| 57/62 [00:14<00:01,  3.93it/s]100%|██████████| 62/62 [00:23<00:00,  1.46it/s]100%|██████████| 62/62 [00:23<00:00,  2.62it/s]
2025-03-13 13:24:31,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:31
2025-03-13 13:26:06,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.0780 secs
2025-03-13 13:26:06,302 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 13:26:06,302 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.92it/s]
2025-03-13 13:26:45,032 [INFO]: 	>>> Finished "Compute fast metrics" in 38.7294 secs
2025-03-13 13:26:45,037 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 157.5172 secs
2025-03-13 13:26:45,038 [INFO]: {
2025-03-13 13:26:45,038 [INFO]: 	index_key: HNSW32
2025-03-13 13:26:45,038 [INFO]: 	index_param: efSearch=106
2025-03-13 13:26:45,038 [INFO]: 	index_path: knn.index
2025-03-13 13:26:45,038 [INFO]: 	size in bytes: 2996713054
2025-03-13 13:26:45,038 [INFO]: 	avg_search_speed_ms: 10.915599595887514
2025-03-13 13:26:45,038 [INFO]: 	99p_search_speed_ms: 17.616823257412772
2025-03-13 13:26:45,038 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:45,038 [INFO]: 	nb vectors: 15221
2025-03-13 13:26:45,038 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:45,038 [INFO]: 	compression ratio: 0.9986175900310273
2025-03-13 13:26:45,038 [INFO]: }
2025-03-13 13:26:45,038 [INFO]: 	>>> Finished "Creating the index" in 157.5193 secs
2025-03-13 13:26:45,038 [INFO]: >>> Finished "Launching the whole pipeline" in 157.5532 secs
2025-03-13 13:26:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 26472 [episode count 13/20]
[retrieval_preprocessing] for episode 28267 [episode count 14/20], we have num_retrieval=np.int64(14471) num_query=np.int64(1069)
2025-03-13 13:26:48,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:26:50,853 [INFO]: Launching the whole pipeline 03/13/2025, 13:26:50
2025-03-13 13:26:50,853 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:26:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.48it/s]
2025-03-13 13:26:50,884 [INFO]: There are 14471 embeddings of dim 49152
2025-03-13 13:26:50,885 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 13:26:50,885 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:26:50
2025-03-13 13:26:50,885 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:26:50,885 [INFO]: 		-> Add: 7.9 seconds
2025-03-13 13:26:50,885 [INFO]: 		Total: 16.8 minutes
2025-03-13 13:26:50,885 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 13:26:50,885 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:26:50
2025-03-13 13:26:50,885 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:26:50,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 13:26:50,885 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:26:50
2025-03-13 13:26:50,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:26:50,885 [INFO]: 	Creating the index 03/13/2025, 13:26:50
2025-03-13 13:26:50,886 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 13:26:50
2025-03-13 13:26:50,887 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 13:26:50,887 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:26:50
2025-03-13 13:26:50,887 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 13:26:50,887 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/59 [00:00<?, ?it/s]  2%|▏         | 1/59 [00:00<00:15,  3.83it/s]  3%|▎         | 2/59 [00:00<00:10,  5.63it/s]  5%|▌         | 3/59 [00:00<00:08,  6.63it/s]  7%|▋         | 4/59 [00:00<00:07,  7.18it/s]  8%|▊         | 5/59 [00:00<00:07,  7.67it/s] 10%|█         | 6/59 [00:00<00:06,  7.91it/s] 12%|█▏        | 7/59 [00:00<00:06,  7.74it/s] 14%|█▎        | 8/59 [00:01<00:06,  8.14it/s] 17%|█▋        | 10/59 [00:01<00:05,  9.32it/s] 20%|██        | 12/59 [00:01<00:04,  9.41it/s] 22%|██▏       | 13/59 [00:01<00:05,  8.54it/s] 24%|██▎       | 14/59 [00:01<00:05,  8.53it/s] 27%|██▋       | 16/59 [00:01<00:04,  9.57it/s] 31%|███       | 18/59 [00:02<00:04,  9.98it/s] 34%|███▍      | 20/59 [00:02<00:03, 10.44it/s] 37%|███▋      | 22/59 [00:09<00:43,  1.19s/it] 41%|████      | 24/59 [00:09<00:29,  1.21it/s] 44%|████▍     | 26/59 [00:09<00:19,  1.70it/s] 47%|████▋     | 28/59 [00:09<00:13,  2.35it/s] 51%|█████     | 30/59 [00:09<00:09,  3.13it/s] 54%|█████▍    | 32/59 [00:09<00:06,  4.07it/s] 58%|█████▊    | 34/59 [00:09<00:04,  5.20it/s] 61%|██████    | 36/59 [00:10<00:03,  6.34it/s] 64%|██████▍   | 38/59 [00:10<00:02,  7.60it/s] 68%|██████▊   | 40/59 [00:10<00:02,  8.77it/s] 71%|███████   | 42/59 [00:18<00:22,  1.31s/it] 75%|███████▍  | 44/59 [00:18<00:14,  1.06it/s] 78%|███████▊  | 46/59 [00:18<00:08,  1.48it/s] 81%|████████▏ | 48/59 [00:18<00:05,  2.03it/s] 85%|████████▍ | 50/59 [00:19<00:03,  2.74it/s] 90%|████████▉ | 53/59 [00:19<00:01,  4.22it/s] 93%|█████████▎| 55/59 [00:19<00:00,  5.23it/s] 97%|█████████▋| 57/59 [00:19<00:00,  6.42it/s]100%|██████████| 59/59 [00:27<00:00,  1.22s/it]100%|██████████| 59/59 [00:27<00:00,  2.16it/s]
2025-03-13 13:27:18,156 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:18
