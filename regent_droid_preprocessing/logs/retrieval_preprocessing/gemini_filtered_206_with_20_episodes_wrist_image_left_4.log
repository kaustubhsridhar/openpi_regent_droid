2025-03-13 14:35:01: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 14:35:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2927338332_unfold_towel [chosen_id count 0/196]
2025-03-13 14:35:02: [retrieval_preprocessing] we have num_total=10850 embedding_dim=49152
[retrieval_preprocessing] for episode 14856 [episode count 0/20], we have num_retrieval=np.int64(10249) num_query=np.int64(601)
2025-03-13 14:35:03,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:35:06,239 [INFO]: Launching the whole pipeline 03/13/2025, 14:35:06
2025-03-13 14:35:06,239 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:35:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 381.44it/s]
2025-03-13 14:35:06,308 [INFO]: There are 10249 embeddings of dim 49152
2025-03-13 14:35:06,309 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0697 secs
2025-03-13 14:35:06,309 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:35:06
2025-03-13 14:35:06,309 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:35:06,309 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 14:35:06,309 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:35:06,309 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:35:06,309 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:35:06
2025-03-13 14:35:06,310 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:35:06,310 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0011 secs
2025-03-13 14:35:06,310 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:35:06
2025-03-13 14:35:06,310 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:35:06,310 [INFO]: 	Creating the index 03/13/2025, 14:35:06
2025-03-13 14:35:06,311 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:35:06
2025-03-13 14:35:06,312 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0019 secs
2025-03-13 14:35:06,313 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:35:06
2025-03-13 14:35:06,313 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:35:06,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  5.24it/s]  7%|▋         | 3/43 [00:00<00:03, 11.55it/s] 14%|█▍        | 6/43 [00:00<00:02, 18.44it/s] 21%|██        | 9/43 [00:00<00:01, 21.65it/s] 28%|██▊       | 12/43 [00:00<00:01, 23.87it/s] 35%|███▍      | 15/43 [00:00<00:01, 25.03it/s] 42%|████▏     | 18/43 [00:00<00:00, 25.96it/s] 49%|████▉     | 21/43 [00:08<00:18,  1.17it/s] 60%|██████    | 26/43 [00:08<00:08,  2.04it/s] 72%|███████▏  | 31/43 [00:08<00:03,  3.22it/s] 84%|████████▎ | 36/43 [00:08<00:01,  4.81it/s] 95%|█████████▌| 41/43 [00:08<00:00,  6.88it/s]100%|██████████| 43/43 [00:18<00:00,  2.26it/s]
2025-03-13 14:35:25,315 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:35:25
2025-03-13 14:36:49,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.5155 secs
2025-03-13 14:36:49,831 [INFO]: The best hyperparameters are: efSearch=108
2025-03-13 14:36:49,831 [INFO]: 	Compute fast metrics 03/13/2025, 14:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.21it/s]
2025-03-13 14:37:19,583 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7522 secs
2025-03-13 14:37:19,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 133.2710 secs
2025-03-13 14:37:19,584 [INFO]: {
2025-03-13 14:37:19,584 [INFO]: 	index_key: HNSW32
2025-03-13 14:37:19,584 [INFO]: 	index_param: efSearch=108
2025-03-13 14:37:19,584 [INFO]: 	index_path: knn.index
2025-03-13 14:37:19,584 [INFO]: 	size in bytes: 2017821006
2025-03-13 14:37:19,584 [INFO]: 	avg_search_speed_ms: 15.062973279848201
2025-03-13 14:37:19,584 [INFO]: 	99p_search_speed_ms: 27.78455990832299
2025-03-13 14:37:19,584 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:37:19,584 [INFO]: 	nb vectors: 10249
2025-03-13 14:37:19,584 [INFO]: 	vectors dimension: 49152
2025-03-13 14:37:19,584 [INFO]: 	compression ratio: 0.9986194940028293
2025-03-13 14:37:19,584 [INFO]: }
2025-03-13 14:37:19,584 [INFO]: 	>>> Finished "Creating the index" in 133.2736 secs
2025-03-13 14:37:19,584 [INFO]: >>> Finished "Launching the whole pipeline" in 133.3452 secs
2025-03-13 14:37:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:37:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 14856 [episode count 0/20]
[retrieval_preprocessing] for episode 26160 [episode count 1/20], we have num_retrieval=np.int64(10334) num_query=np.int64(516)
2025-03-13 14:37:25,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:37:27,641 [INFO]: Launching the whole pipeline 03/13/2025, 14:37:27
2025-03-13 14:37:27,642 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:37:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.98it/s]
2025-03-13 14:37:27,671 [INFO]: There are 10334 embeddings of dim 49152
2025-03-13 14:37:27,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 14:37:27,671 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:37:27
2025-03-13 14:37:27,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:37:27,672 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:37:27,672 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:37:27,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:37:27,672 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:37:27
2025-03-13 14:37:27,672 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:37:27,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:37:27,672 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:37:27
2025-03-13 14:37:27,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:37:27,672 [INFO]: 	Creating the index 03/13/2025, 14:37:27
2025-03-13 14:37:27,672 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:37:27
2025-03-13 14:37:27,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 14:37:27,673 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:37:27
2025-03-13 14:37:27,673 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:37:27,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:06,  6.72it/s]  7%|▋         | 3/43 [00:00<00:03, 13.05it/s] 16%|█▋        | 7/43 [00:00<00:01, 23.89it/s] 28%|██▊       | 12/43 [00:00<00:00, 31.68it/s] 40%|███▉      | 17/43 [00:00<00:00, 35.82it/s] 49%|████▉     | 21/43 [00:07<00:13,  1.60it/s] 56%|█████▌    | 24/43 [00:07<00:08,  2.13it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.37it/s] 79%|███████▉  | 34/43 [00:08<00:01,  5.00it/s] 91%|█████████ | 39/43 [00:08<00:00,  7.11it/s] 95%|█████████▌| 41/43 [00:18<00:00,  7.11it/s] 98%|█████████▊| 42/43 [00:19<00:00,  1.10it/s]100%|██████████| 43/43 [00:20<00:00,  1.03it/s]100%|██████████| 43/43 [00:20<00:00,  2.09it/s]
2025-03-13 14:37:48,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:37:48
2025-03-13 14:39:12,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.7542 secs
2025-03-13 14:39:12,970 [INFO]: The best hyperparameters are: efSearch=120
2025-03-13 14:39:12,971 [INFO]: 	Compute fast metrics 03/13/2025, 14:39:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 14:39:44,912 [INFO]: 	>>> Finished "Compute fast metrics" in 31.9411 secs
2025-03-13 14:39:44,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 137.2396 secs
2025-03-13 14:39:44,913 [INFO]: {
2025-03-13 14:39:44,913 [INFO]: 	index_key: HNSW32
2025-03-13 14:39:44,913 [INFO]: 	index_param: efSearch=120
2025-03-13 14:39:44,913 [INFO]: 	index_path: knn.index
2025-03-13 14:39:44,913 [INFO]: 	size in bytes: 2034555722
2025-03-13 14:39:44,913 [INFO]: 	avg_search_speed_ms: 12.828049349646347
2025-03-13 14:39:44,913 [INFO]: 	99p_search_speed_ms: 21.24355792999268
2025-03-13 14:39:44,913 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:39:44,913 [INFO]: 	nb vectors: 10334
2025-03-13 14:39:44,913 [INFO]: 	vectors dimension: 49152
2025-03-13 14:39:44,913 [INFO]: 	compression ratio: 0.998619526627052
2025-03-13 14:39:44,913 [INFO]: }
2025-03-13 14:39:44,913 [INFO]: 	>>> Finished "Creating the index" in 137.2410 secs
2025-03-13 14:39:44,913 [INFO]: >>> Finished "Launching the whole pipeline" in 137.2715 secs
2025-03-13 14:39:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:39:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 26160 [episode count 1/20]
[retrieval_preprocessing] for episode 93766 [episode count 2/20], we have num_retrieval=np.int64(10347) num_query=np.int64(503)
2025-03-13 14:39:50,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:39:52,033 [INFO]: Launching the whole pipeline 03/13/2025, 14:39:52
2025-03-13 14:39:52,033 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:39:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 712.59it/s]
2025-03-13 14:39:52,064 [INFO]: There are 10347 embeddings of dim 49152
2025-03-13 14:39:52,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-13 14:39:52,064 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:39:52
2025-03-13 14:39:52,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:39:52,065 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:39:52,065 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:39:52,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 14:39:52,065 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:39:52
2025-03-13 14:39:52,065 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:39:52,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-13 14:39:52,066 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:39:52
2025-03-13 14:39:52,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:39:52,066 [INFO]: 	Creating the index 03/13/2025, 14:39:52
2025-03-13 14:39:52,066 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:39:52
2025-03-13 14:39:52,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 14:39:52,070 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:39:52
2025-03-13 14:39:52,070 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:39:52,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  8.09it/s] 12%|█▏        | 5/43 [00:00<00:01, 22.89it/s] 21%|██        | 9/43 [00:00<00:01, 29.48it/s] 33%|███▎      | 14/43 [00:00<00:00, 35.28it/s] 44%|████▍     | 19/43 [00:00<00:00, 38.75it/s] 53%|█████▎    | 23/43 [00:07<00:12,  1.64it/s] 63%|██████▎   | 27/43 [00:08<00:06,  2.34it/s] 72%|███████▏  | 31/43 [00:08<00:03,  3.29it/s] 81%|████████▏ | 35/43 [00:08<00:01,  4.56it/s] 91%|█████████ | 39/43 [00:08<00:00,  6.19it/s]100%|██████████| 43/43 [00:19<00:00,  1.01it/s]100%|██████████| 43/43 [00:19<00:00,  2.15it/s]
2025-03-13 14:40:12,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:40:12
2025-03-13 14:41:58,397 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 106.3494 secs
2025-03-13 14:41:58,398 [INFO]: The best hyperparameters are: efSearch=124
2025-03-13 14:41:58,398 [INFO]: 	Compute fast metrics 03/13/2025, 14:41:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.31it/s]
2025-03-13 14:42:33,695 [INFO]: 	>>> Finished "Compute fast metrics" in 35.2970 secs
2025-03-13 14:42:33,696 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 161.6254 secs
2025-03-13 14:42:33,696 [INFO]: {
2025-03-13 14:42:33,696 [INFO]: 	index_key: HNSW32
2025-03-13 14:42:33,696 [INFO]: 	index_param: efSearch=124
2025-03-13 14:42:33,696 [INFO]: 	index_path: knn.index
2025-03-13 14:42:33,696 [INFO]: 	size in bytes: 2037115238
2025-03-13 14:42:33,696 [INFO]: 	avg_search_speed_ms: 14.464289051577492
2025-03-13 14:42:33,696 [INFO]: 	99p_search_speed_ms: 27.554265011567626
2025-03-13 14:42:33,696 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:42:33,696 [INFO]: 	nb vectors: 10347
2025-03-13 14:42:33,696 [INFO]: 	vectors dimension: 49152
2025-03-13 14:42:33,696 [INFO]: 	compression ratio: 0.9986194880154345
2025-03-13 14:42:33,696 [INFO]: }
2025-03-13 14:42:33,696 [INFO]: 	>>> Finished "Creating the index" in 161.6295 secs
2025-03-13 14:42:33,696 [INFO]: >>> Finished "Launching the whole pipeline" in 161.6629 secs
2025-03-13 14:42:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:42:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 93766 [episode count 2/20]
[retrieval_preprocessing] for episode 27741 [episode count 3/20], we have num_retrieval=np.int64(10219) num_query=np.int64(631)
2025-03-13 14:42:37,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:42:39,496 [INFO]: Launching the whole pipeline 03/13/2025, 14:42:39
2025-03-13 14:42:39,496 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:42:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1313.59it/s]
2025-03-13 14:42:39,523 [INFO]: There are 10219 embeddings of dim 49152
2025-03-13 14:42:39,524 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 14:42:39,524 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:42:39
2025-03-13 14:42:39,524 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:42:39,524 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 14:42:39,524 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:42:39,524 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:42:39,524 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:42:39
2025-03-13 14:42:39,524 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:42:39,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:42:39,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:42:39
2025-03-13 14:42:39,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:42:39,524 [INFO]: 	Creating the index 03/13/2025, 14:42:39
2025-03-13 14:42:39,524 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:42:39
2025-03-13 14:42:39,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 14:42:39,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:42:39
2025-03-13 14:42:39,525 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:42:39,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  8.20it/s] 14%|█▍        | 6/43 [00:00<00:01, 27.70it/s] 26%|██▌       | 11/43 [00:00<00:00, 36.12it/s] 37%|███▋      | 16/43 [00:00<00:00, 40.52it/s] 49%|████▉     | 21/43 [00:07<00:12,  1.78it/s] 60%|██████    | 26/43 [00:07<00:06,  2.71it/s] 72%|███████▏  | 31/43 [00:07<00:03,  3.97it/s] 81%|████████▏ | 35/43 [00:07<00:01,  5.28it/s] 93%|█████████▎| 40/43 [00:07<00:00,  7.47it/s]100%|██████████| 43/43 [00:20<00:00,  2.10it/s]
2025-03-13 14:42:59,982 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:42:59
2025-03-13 14:44:26,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.3810 secs
2025-03-13 14:44:26,364 [INFO]: The best hyperparameters are: efSearch=170
2025-03-13 14:44:26,364 [INFO]: 	Compute fast metrics 03/13/2025, 14:44:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.54it/s]
2025-03-13 14:44:57,768 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4038 secs
2025-03-13 14:44:57,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 138.2430 secs
2025-03-13 14:44:57,768 [INFO]: {
2025-03-13 14:44:57,768 [INFO]: 	index_key: HNSW32
2025-03-13 14:44:57,768 [INFO]: 	index_param: efSearch=170
2025-03-13 14:44:57,768 [INFO]: 	index_path: knn.index
2025-03-13 14:44:57,768 [INFO]: 	size in bytes: 2011914726
2025-03-13 14:44:57,769 [INFO]: 	avg_search_speed_ms: 19.029111467291223
2025-03-13 14:44:57,769 [INFO]: 	99p_search_speed_ms: 38.85713324416429
2025-03-13 14:44:57,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:44:57,769 [INFO]: 	nb vectors: 10219
2025-03-13 14:44:57,769 [INFO]: 	vectors dimension: 49152
2025-03-13 14:44:57,769 [INFO]: 	compression ratio: 0.9986194375118859
2025-03-13 14:44:57,769 [INFO]: }
2025-03-13 14:44:57,769 [INFO]: 	>>> Finished "Creating the index" in 138.2443 secs
2025-03-13 14:44:57,769 [INFO]: >>> Finished "Launching the whole pipeline" in 138.2728 secs
2025-03-13 14:45:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:45:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 27741 [episode count 3/20]
[retrieval_preprocessing] for episode 85117 [episode count 4/20], we have num_retrieval=np.int64(10383) num_query=np.int64(467)
2025-03-13 14:45:04,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:45:06,536 [INFO]: Launching the whole pipeline 03/13/2025, 14:45:06
2025-03-13 14:45:06,536 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:45:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 829.90it/s]
2025-03-13 14:45:06,565 [INFO]: There are 10383 embeddings of dim 49152
2025-03-13 14:45:06,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 14:45:06,565 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:45:06
2025-03-13 14:45:06,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:45:06,565 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:45:06,565 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:45:06,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 14:45:06,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:45:06
2025-03-13 14:45:06,566 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:45:06,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:45:06,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:45:06
2025-03-13 14:45:06,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:45:06,566 [INFO]: 	Creating the index 03/13/2025, 14:45:06
2025-03-13 14:45:06,566 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:45:06
2025-03-13 14:45:06,567 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 14:45:06,567 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:45:06
2025-03-13 14:45:06,567 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:45:06,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.80it/s]  9%|▉         | 4/43 [00:00<00:02, 15.15it/s] 19%|█▊        | 8/43 [00:00<00:01, 23.88it/s] 28%|██▊       | 12/43 [00:00<00:01, 28.81it/s] 37%|███▋      | 16/43 [00:00<00:00, 31.87it/s] 47%|████▋     | 20/43 [00:00<00:00, 33.60it/s] 56%|█████▌    | 24/43 [00:08<00:13,  1.38it/s] 65%|██████▌   | 28/43 [00:09<00:07,  2.01it/s] 74%|███████▍  | 32/43 [00:09<00:03,  2.87it/s] 84%|████████▎ | 36/43 [00:09<00:01,  4.01it/s] 93%|█████████▎| 40/43 [00:09<00:00,  5.50it/s] 98%|█████████▊| 42/43 [00:19<00:00,  5.50it/s]100%|██████████| 43/43 [00:19<00:00,  1.01s/it]100%|██████████| 43/43 [00:19<00:00,  2.15it/s]
2025-03-13 14:45:26,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:45:26
2025-03-13 14:46:52,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.2499 secs
2025-03-13 14:46:52,787 [INFO]: The best hyperparameters are: efSearch=106
2025-03-13 14:46:52,787 [INFO]: 	Compute fast metrics 03/13/2025, 14:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s]
2025-03-13 14:47:27,795 [INFO]: 	>>> Finished "Compute fast metrics" in 35.0076 secs
2025-03-13 14:47:27,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.2291 secs
2025-03-13 14:47:27,796 [INFO]: {
2025-03-13 14:47:27,796 [INFO]: 	index_key: HNSW32
2025-03-13 14:47:27,796 [INFO]: 	index_param: efSearch=106
2025-03-13 14:47:27,796 [INFO]: 	index_path: knn.index
2025-03-13 14:47:27,796 [INFO]: 	size in bytes: 2044203030
2025-03-13 14:47:27,796 [INFO]: 	avg_search_speed_ms: 11.754900040586515
2025-03-13 14:47:27,796 [INFO]: 	99p_search_speed_ms: 21.373051102273166
2025-03-13 14:47:27,796 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:47:27,796 [INFO]: 	nb vectors: 10383
2025-03-13 14:47:27,796 [INFO]: 	vectors dimension: 49152
2025-03-13 14:47:27,796 [INFO]: 	compression ratio: 0.9986194296952979
2025-03-13 14:47:27,796 [INFO]: }
2025-03-13 14:47:27,796 [INFO]: 	>>> Finished "Creating the index" in 141.2307 secs
2025-03-13 14:47:27,796 [INFO]: >>> Finished "Launching the whole pipeline" in 141.2600 secs
2025-03-13 14:47:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:47:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 85117 [episode count 4/20]
[retrieval_preprocessing] for episode 59540 [episode count 5/20], we have num_retrieval=np.int64(10432) num_query=np.int64(418)
2025-03-13 14:47:32,340 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:47:33,997 [INFO]: Launching the whole pipeline 03/13/2025, 14:47:33
2025-03-13 14:47:33,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:47:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-13 14:47:34,023 [INFO]: There are 10432 embeddings of dim 49152
2025-03-13 14:47:34,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 14:47:34,024 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:47:34
2025-03-13 14:47:34,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:47:34,024 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:47:34,024 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:47:34,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 14:47:34,024 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:47:34
2025-03-13 14:47:34,024 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:47:34,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 14:47:34,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:47:34
2025-03-13 14:47:34,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 14:47:34,024 [INFO]: 	Creating the index 03/13/2025, 14:47:34
2025-03-13 14:47:34,024 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:47:34
2025-03-13 14:47:34,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 14:47:34,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:47:34
2025-03-13 14:47:34,025 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:47:34,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:07,  5.92it/s] 11%|█▏        | 5/44 [00:00<00:01, 20.00it/s] 20%|██        | 9/44 [00:00<00:01, 27.32it/s] 32%|███▏      | 14/44 [00:00<00:00, 32.44it/s] 43%|████▎     | 19/44 [00:00<00:00, 35.39it/s] 52%|█████▏    | 23/44 [00:07<00:12,  1.67it/s] 64%|██████▎   | 28/44 [00:07<00:06,  2.56it/s] 75%|███████▌  | 33/44 [00:08<00:02,  3.78it/s] 86%|████████▋ | 38/44 [00:08<00:01,  5.38it/s] 95%|█████████▌| 42/44 [00:15<00:01,  1.52it/s]100%|██████████| 44/44 [00:17<00:00,  2.53it/s]
2025-03-13 14:47:51,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:47:51
2025-03-13 14:49:07,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.8561 secs
2025-03-13 14:49:07,285 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 14:49:07,285 [INFO]: 	Compute fast metrics 03/13/2025, 14:49:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.77it/s]
2025-03-13 14:50:06,011 [INFO]: 	>>> Finished "Compute fast metrics" in 58.7253 secs
2025-03-13 14:50:06,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.9865 secs
2025-03-13 14:50:06,012 [INFO]: {
2025-03-13 14:50:06,012 [INFO]: 	index_key: HNSW32
2025-03-13 14:50:06,012 [INFO]: 	index_param: efSearch=221
2025-03-13 14:50:06,012 [INFO]: 	index_path: knn.index
2025-03-13 14:50:06,012 [INFO]: 	size in bytes: 2053850466
2025-03-13 14:50:06,012 [INFO]: 	avg_search_speed_ms: 19.22003690183749
2025-03-13 14:50:06,012 [INFO]: 	99p_search_speed_ms: 31.340824160724875
2025-03-13 14:50:06,012 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:50:06,012 [INFO]: 	nb vectors: 10432
2025-03-13 14:50:06,012 [INFO]: 	vectors dimension: 49152
2025-03-13 14:50:06,012 [INFO]: 	compression ratio: 0.9986192714382353
2025-03-13 14:50:06,012 [INFO]: }
2025-03-13 14:50:06,012 [INFO]: 	>>> Finished "Creating the index" in 151.9879 secs
2025-03-13 14:50:06,012 [INFO]: >>> Finished "Launching the whole pipeline" in 152.0148 secs
2025-03-13 14:50:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:50:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 59540 [episode count 5/20]
[retrieval_preprocessing] for episode 82068 [episode count 6/20], we have num_retrieval=np.int64(10303) num_query=np.int64(547)
2025-03-13 14:50:11,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:50:13,860 [INFO]: Launching the whole pipeline 03/13/2025, 14:50:13
2025-03-13 14:50:13,860 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:50:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-13 14:50:13,891 [INFO]: There are 10303 embeddings of dim 49152
2025-03-13 14:50:13,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 14:50:13,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:50:13,893 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:50:13,893 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:50:13,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 14:50:13,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,893 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:50:13,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:50:13,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:50:13
2025-03-13 14:50:13,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:50:13,894 [INFO]: 	Creating the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,894 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:50:13
2025-03-13 14:50:13,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 14:50:13,898 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:50:13
2025-03-13 14:50:13,898 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:50:13,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.50it/s] 14%|█▍        | 6/43 [00:00<00:01, 26.21it/s] 26%|██▌       | 11/43 [00:00<00:00, 32.45it/s] 37%|███▋      | 16/43 [00:00<00:00, 35.31it/s] 47%|████▋     | 20/43 [00:00<00:00, 35.76it/s] 56%|█████▌    | 24/43 [00:08<00:12,  1.55it/s] 67%|██████▋   | 29/43 [00:08<00:05,  2.40it/s] 77%|███████▋  | 33/43 [00:08<00:03,  3.31it/s] 88%|████████▊ | 38/43 [00:08<00:01,  4.88it/s] 98%|█████████▊| 42/43 [00:17<00:00,  1.33it/s]100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
2025-03-13 14:50:32,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:50:32
2025-03-13 14:52:00,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.7349 secs
2025-03-13 14:52:00,371 [INFO]: The best hyperparameters are: efSearch=90
2025-03-13 14:52:00,371 [INFO]: 	Compute fast metrics 03/13/2025, 14:52:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.88it/s]
2025-03-13 14:52:35,215 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8437 secs
2025-03-13 14:52:35,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 141.3175 secs
2025-03-13 14:52:35,216 [INFO]: {
2025-03-13 14:52:35,216 [INFO]: 	index_key: HNSW32
2025-03-13 14:52:35,216 [INFO]: 	index_param: efSearch=90
2025-03-13 14:52:35,216 [INFO]: 	index_path: knn.index
2025-03-13 14:52:35,216 [INFO]: 	size in bytes: 2028452566
2025-03-13 14:52:35,216 [INFO]: 	avg_search_speed_ms: 12.033565307515712
2025-03-13 14:52:35,216 [INFO]: 	99p_search_speed_ms: 21.94818877615036
2025-03-13 14:52:35,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:52:35,216 [INFO]: 	nb vectors: 10303
2025-03-13 14:52:35,216 [INFO]: 	vectors dimension: 49152
2025-03-13 14:52:35,216 [INFO]: 	compression ratio: 0.9986194688271552
2025-03-13 14:52:35,216 [INFO]: }
2025-03-13 14:52:35,216 [INFO]: 	>>> Finished "Creating the index" in 141.3214 secs
2025-03-13 14:52:35,216 [INFO]: >>> Finished "Launching the whole pipeline" in 141.3559 secs
2025-03-13 14:52:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:52:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 82068 [episode count 6/20]
[retrieval_preprocessing] for episode 63138 [episode count 7/20], we have num_retrieval=np.int64(10444) num_query=np.int64(406)
2025-03-13 14:52:39,897 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:52:42,506 [INFO]: Launching the whole pipeline 03/13/2025, 14:52:42
2025-03-13 14:52:42,506 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:52:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1331.10it/s]
2025-03-13 14:52:42,538 [INFO]: There are 10444 embeddings of dim 49152
2025-03-13 14:52:42,539 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 14:52:42,539 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:52:42,540 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:52:42,540 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:52:42,540 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:52:42,540 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,540 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:52:42,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:52:42,541 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:52:42
2025-03-13 14:52:42,541 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:52:42,541 [INFO]: 	Creating the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,542 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:52:42
2025-03-13 14:52:42,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 14:52:42,545 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:52:42
2025-03-13 14:52:42,545 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:52:42,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:06,  7.02it/s] 14%|█▎        | 6/44 [00:00<00:01, 25.79it/s] 25%|██▌       | 11/44 [00:00<00:01, 32.76it/s] 36%|███▋      | 16/44 [00:00<00:00, 36.02it/s] 48%|████▊     | 21/44 [00:08<00:15,  1.50it/s] 55%|█████▍    | 24/44 [00:09<00:10,  1.88it/s] 59%|█████▉    | 26/44 [00:09<00:08,  2.20it/s] 64%|██████▎   | 28/44 [00:09<00:06,  2.62it/s] 68%|██████▊   | 30/44 [00:09<00:04,  3.13it/s] 73%|███████▎  | 32/44 [00:10<00:03,  3.76it/s] 77%|███████▋  | 34/44 [00:10<00:02,  4.42it/s] 82%|████████▏ | 36/44 [00:10<00:01,  5.14it/s] 84%|████████▍ | 37/44 [00:10<00:01,  5.53it/s] 91%|█████████ | 40/44 [00:10<00:00,  8.24it/s] 95%|█████████▌| 42/44 [00:18<00:02,  1.22s/it]100%|██████████| 44/44 [00:20<00:00,  1.06s/it]100%|██████████| 44/44 [00:20<00:00,  2.17it/s]
2025-03-13 14:53:02,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:53:02
2025-03-13 14:54:22,542 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.7128 secs
2025-03-13 14:54:22,542 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 14:54:22,542 [INFO]: 	Compute fast metrics 03/13/2025, 14:54:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:04<00:01,  1.39s/it]
2025-03-13 14:55:30,094 [INFO]: 	>>> Finished "Compute fast metrics" in 67.5519 secs
2025-03-13 14:55:30,095 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 167.5505 secs
2025-03-13 14:55:30,096 [INFO]: {
2025-03-13 14:55:30,096 [INFO]: 	index_key: HNSW32
2025-03-13 14:55:30,096 [INFO]: 	index_param: efSearch=153
2025-03-13 14:55:30,096 [INFO]: 	index_path: knn.index
2025-03-13 14:55:30,096 [INFO]: 	size in bytes: 2056213106
2025-03-13 14:55:30,096 [INFO]: 	avg_search_speed_ms: 14.175008880515337
2025-03-13 14:55:30,096 [INFO]: 	99p_search_speed_ms: 25.601001444738365
2025-03-13 14:55:30,096 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:55:30,096 [INFO]: 	nb vectors: 10444
2025-03-13 14:55:30,096 [INFO]: 	vectors dimension: 49152
2025-03-13 14:55:30,096 [INFO]: 	compression ratio: 0.9986192316391159
2025-03-13 14:55:30,096 [INFO]: }
2025-03-13 14:55:30,096 [INFO]: 	>>> Finished "Creating the index" in 167.5543 secs
2025-03-13 14:55:30,096 [INFO]: >>> Finished "Launching the whole pipeline" in 167.5895 secs
2025-03-13 14:55:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:55:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 63138 [episode count 7/20]
[retrieval_preprocessing] for episode 79806 [episode count 8/20], we have num_retrieval=np.int64(10448) num_query=np.int64(402)
2025-03-13 14:55:36,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:55:38,136 [INFO]: Launching the whole pipeline 03/13/2025, 14:55:38
2025-03-13 14:55:38,136 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:55:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-13 14:55:38,166 [INFO]: There are 10448 embeddings of dim 49152
2025-03-13 14:55:38,166 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 14:55:38,167 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:55:38
2025-03-13 14:55:38,167 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:55:38,167 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 14:55:38,168 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:55:38,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 14:55:38,168 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:55:38
2025-03-13 14:55:38,168 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:55:38,168 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 14:55:38,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:55:38
2025-03-13 14:55:38,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:55:38,169 [INFO]: 	Creating the index 03/13/2025, 14:55:38
2025-03-13 14:55:38,169 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:55:38
2025-03-13 14:55:38,173 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0031 secs
2025-03-13 14:55:38,173 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:55:38
2025-03-13 14:55:38,173 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:55:38,173 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:06,  6.76it/s] 11%|█▏        | 5/44 [00:00<00:01, 22.16it/s] 20%|██        | 9/44 [00:00<00:01, 28.90it/s] 30%|██▉       | 13/44 [00:00<00:00, 32.71it/s] 39%|███▊      | 17/44 [00:00<00:00, 34.26it/s] 48%|████▊     | 21/44 [00:08<00:17,  1.31it/s] 55%|█████▍    | 24/44 [00:19<00:30,  1.51s/it] 57%|█████▋    | 25/44 [00:22<00:32,  1.70s/it] 61%|██████▏   | 27/44 [00:28<00:34,  2.05s/it] 66%|██████▌   | 29/44 [00:29<00:25,  1.67s/it] 68%|██████▊   | 30/44 [00:32<00:26,  1.88s/it] 70%|███████   | 31/44 [00:34<00:23,  1.83s/it] 73%|███████▎  | 32/44 [00:36<00:21,  1.77s/it] 84%|████████▍ | 37/44 [00:36<00:05,  1.38it/s] 95%|█████████▌| 42/44 [00:46<00:02,  1.30s/it]100%|██████████| 44/44 [00:47<00:00,  1.22s/it]100%|██████████| 44/44 [00:47<00:00,  1.09s/it]
2025-03-13 14:56:26,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:56:26
2025-03-13 14:57:53,911 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.6721 secs
2025-03-13 14:57:53,911 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 14:57:53,911 [INFO]: 	Compute fast metrics 03/13/2025, 14:57:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.70it/s]
2025-03-13 14:58:24,015 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1034 secs
2025-03-13 14:58:24,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 165.8441 secs
2025-03-13 14:58:24,017 [INFO]: {
2025-03-13 14:58:24,017 [INFO]: 	index_key: HNSW32
2025-03-13 14:58:24,018 [INFO]: 	index_param: efSearch=207
2025-03-13 14:58:24,018 [INFO]: 	index_path: knn.index
2025-03-13 14:58:24,018 [INFO]: 	size in bytes: 2057000610
2025-03-13 14:58:24,018 [INFO]: 	avg_search_speed_ms: 23.780851869350588
2025-03-13 14:58:24,018 [INFO]: 	99p_search_speed_ms: 56.18418497033417
2025-03-13 14:58:24,018 [INFO]: 	reconstruction error %: 0.0
2025-03-13 14:58:24,018 [INFO]: 	nb vectors: 10448
2025-03-13 14:58:24,018 [INFO]: 	vectors dimension: 49152
2025-03-13 14:58:24,018 [INFO]: 	compression ratio: 0.9986192391065941
2025-03-13 14:58:24,018 [INFO]: }
2025-03-13 14:58:24,018 [INFO]: 	>>> Finished "Creating the index" in 165.8485 secs
2025-03-13 14:58:24,018 [INFO]: >>> Finished "Launching the whole pipeline" in 165.8816 secs
2025-03-13 14:58:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 14:58:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 79806 [episode count 8/20]
[retrieval_preprocessing] for episode 76654 [episode count 9/20], we have num_retrieval=np.int64(10190) num_query=np.int64(660)
2025-03-13 14:58:30,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 14:58:32,912 [INFO]: Launching the whole pipeline 03/13/2025, 14:58:32
2025-03-13 14:58:32,912 [INFO]: Reading total number of vectors and dimension 03/13/2025, 14:58:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1967.31it/s]
2025-03-13 14:58:32,940 [INFO]: There are 10190 embeddings of dim 49152
2025-03-13 14:58:32,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 14:58:32,941 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 14:58:32
2025-03-13 14:58:32,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 14:58:32,941 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 14:58:32,941 [INFO]: 		Total: 16.8 minutes
2025-03-13 14:58:32,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 14:58:32,942 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 14:58:32
2025-03-13 14:58:32,942 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 14:58:32,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 14:58:32,942 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 14:58:32
2025-03-13 14:58:32,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 14:58:32,943 [INFO]: 	Creating the index 03/13/2025, 14:58:32
2025-03-13 14:58:32,943 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 14:58:32
2025-03-13 14:58:32,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 14:58:32,946 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 14:58:32
2025-03-13 14:58:32,946 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 14:58:32,947 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:04,  8.60it/s] 12%|█▏        | 5/43 [00:00<00:01, 22.92it/s] 21%|██        | 9/43 [00:00<00:01, 29.62it/s] 30%|███       | 13/43 [00:00<00:00, 32.97it/s] 40%|███▉      | 17/43 [00:00<00:00, 35.04it/s] 49%|████▉     | 21/43 [00:08<00:15,  1.40it/s] 56%|█████▌    | 24/43 [00:08<00:10,  1.87it/s] 67%|██████▋   | 29/43 [00:08<00:04,  3.01it/s] 79%|███████▉  | 34/43 [00:08<00:01,  4.54it/s] 88%|████████▊ | 38/43 [00:08<00:00,  6.12it/s] 98%|█████████▊| 42/43 [00:19<00:00,  1.09it/s]100%|██████████| 43/43 [00:20<00:00,  1.06it/s]100%|██████████| 43/43 [00:20<00:00,  2.05it/s]
2025-03-13 14:58:53,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 14:58:53
2025-03-13 15:00:17,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.0020 secs
2025-03-13 15:00:17,945 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 15:00:17,945 [INFO]: 	Compute fast metrics 03/13/2025, 15:00:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.76it/s]
2025-03-13 15:01:03,145 [INFO]: 	>>> Finished "Compute fast metrics" in 45.1993 secs
2025-03-13 15:01:03,145 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.1988 secs
2025-03-13 15:01:03,145 [INFO]: {
2025-03-13 15:01:03,145 [INFO]: 	index_key: HNSW32
2025-03-13 15:01:03,145 [INFO]: 	index_param: efSearch=157
2025-03-13 15:01:03,145 [INFO]: 	index_path: knn.index
2025-03-13 15:01:03,145 [INFO]: 	size in bytes: 2006205194
2025-03-13 15:01:03,145 [INFO]: 	avg_search_speed_ms: 17.10978811765965
2025-03-13 15:01:03,145 [INFO]: 	99p_search_speed_ms: 32.854824867099516
2025-03-13 15:01:03,145 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:01:03,145 [INFO]: 	nb vectors: 10190
2025-03-13 15:01:03,145 [INFO]: 	vectors dimension: 49152
2025-03-13 15:01:03,145 [INFO]: 	compression ratio: 0.9986194463017625
2025-03-13 15:01:03,145 [INFO]: }
2025-03-13 15:01:03,145 [INFO]: 	>>> Finished "Creating the index" in 150.2024 secs
2025-03-13 15:01:03,145 [INFO]: >>> Finished "Launching the whole pipeline" in 150.2330 secs
2025-03-13 15:01:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:01:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 76654 [episode count 9/20]
[retrieval_preprocessing] for episode 43389 [episode count 10/20], we have num_retrieval=np.int64(10347) num_query=np.int64(503)
2025-03-13 15:01:16,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:01:18,271 [INFO]: Launching the whole pipeline 03/13/2025, 15:01:18
2025-03-13 15:01:18,272 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:01:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1291.75it/s]
2025-03-13 15:01:18,301 [INFO]: There are 10347 embeddings of dim 49152
2025-03-13 15:01:18,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 15:01:18,302 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:01:18
2025-03-13 15:01:18,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:01:18,303 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:01:18,303 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:01:18,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 15:01:18,303 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:01:18
2025-03-13 15:01:18,304 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:01:18,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:01:18,304 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:01:18
2025-03-13 15:01:18,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:01:18,304 [INFO]: 	Creating the index 03/13/2025, 15:01:18
2025-03-13 15:01:18,304 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:01:18
2025-03-13 15:01:18,307 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0020 secs
2025-03-13 15:01:18,307 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:01:18
2025-03-13 15:01:18,307 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:01:18,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:07,  5.92it/s] 14%|█▍        | 6/43 [00:00<00:01, 24.92it/s] 26%|██▌       | 11/43 [00:00<00:00, 33.73it/s] 37%|███▋      | 16/43 [00:00<00:00, 38.61it/s] 49%|████▉     | 21/43 [00:06<00:11,  1.93it/s] 60%|██████    | 26/43 [00:07<00:05,  2.93it/s] 74%|███████▍  | 32/43 [00:07<00:02,  4.56it/s] 88%|████████▊ | 38/43 [00:07<00:00,  6.70it/s]100%|██████████| 43/43 [00:15<00:00,  1.68it/s]100%|██████████| 43/43 [00:15<00:00,  2.75it/s]
2025-03-13 15:01:33,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:01:33
2025-03-13 15:02:49,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.8204 secs
2025-03-13 15:02:49,781 [INFO]: The best hyperparameters are: efSearch=93
2025-03-13 15:02:49,781 [INFO]: 	Compute fast metrics 03/13/2025, 15:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.11it/s]
2025-03-13 15:03:38,994 [INFO]: 	>>> Finished "Compute fast metrics" in 49.2123 secs
2025-03-13 15:03:38,994 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.6872 secs
2025-03-13 15:03:38,994 [INFO]: {
2025-03-13 15:03:38,994 [INFO]: 	index_key: HNSW32
2025-03-13 15:03:38,994 [INFO]: 	index_param: efSearch=93
2025-03-13 15:03:38,994 [INFO]: 	index_path: knn.index
2025-03-13 15:03:38,994 [INFO]: 	size in bytes: 2037115238
2025-03-13 15:03:38,994 [INFO]: 	avg_search_speed_ms: 13.81392969075462
2025-03-13 15:03:38,994 [INFO]: 	99p_search_speed_ms: 24.303074320778247
2025-03-13 15:03:38,994 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:03:38,994 [INFO]: 	nb vectors: 10347
2025-03-13 15:03:38,994 [INFO]: 	vectors dimension: 49152
2025-03-13 15:03:38,995 [INFO]: 	compression ratio: 0.9986194880154345
2025-03-13 15:03:38,995 [INFO]: }
2025-03-13 15:03:38,995 [INFO]: 	>>> Finished "Creating the index" in 140.6901 secs
2025-03-13 15:03:38,995 [INFO]: >>> Finished "Launching the whole pipeline" in 140.7230 secs
2025-03-13 15:03:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:03:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 43389 [episode count 10/20]
[retrieval_preprocessing] for episode 76688 [episode count 11/20], we have num_retrieval=np.int64(10362) num_query=np.int64(488)
2025-03-13 15:03:43,814 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:03:45,479 [INFO]: Launching the whole pipeline 03/13/2025, 15:03:45
2025-03-13 15:03:45,479 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:03:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1323.12it/s]
2025-03-13 15:03:45,510 [INFO]: There are 10362 embeddings of dim 49152
2025-03-13 15:03:45,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-13 15:03:45,510 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:03:45,511 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:03:45,511 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:03:45,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:03:45,511 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,511 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:03:45,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:03:45,511 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:03:45
2025-03-13 15:03:45,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:03:45,511 [INFO]: 	Creating the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,511 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:03:45
2025-03-13 15:03:45,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0015 secs
2025-03-13 15:03:45,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:03:45
2025-03-13 15:03:45,513 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:03:45,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.97it/s] 12%|█▏        | 5/43 [00:00<00:01, 22.66it/s] 23%|██▎       | 10/43 [00:00<00:01, 31.47it/s] 35%|███▍      | 15/43 [00:00<00:00, 35.48it/s] 44%|████▍     | 19/43 [00:00<00:00, 36.91it/s] 53%|█████▎    | 23/43 [00:08<00:13,  1.52it/s] 65%|██████▌   | 28/43 [00:08<00:06,  2.37it/s] 77%|███████▋  | 33/43 [00:08<00:02,  3.53it/s] 88%|████████▊ | 38/43 [00:08<00:00,  5.08it/s] 98%|█████████▊| 42/43 [00:17<00:00,  1.34it/s]100%|██████████| 43/43 [00:18<00:00,  2.27it/s]
2025-03-13 15:04:04,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:04:04
2025-03-13 15:05:43,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.1924 secs
2025-03-13 15:05:43,696 [INFO]: The best hyperparameters are: efSearch=146
2025-03-13 15:05:43,696 [INFO]: 	Compute fast metrics 03/13/2025, 15:05:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.86it/s]
2025-03-13 15:06:29,996 [INFO]: 	>>> Finished "Compute fast metrics" in 46.2995 secs
2025-03-13 15:06:29,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 164.4833 secs
2025-03-13 15:06:29,997 [INFO]: {
2025-03-13 15:06:29,997 [INFO]: 	index_key: HNSW32
2025-03-13 15:06:29,997 [INFO]: 	index_param: efSearch=146
2025-03-13 15:06:29,997 [INFO]: 	index_path: knn.index
2025-03-13 15:06:29,997 [INFO]: 	size in bytes: 2040068634
2025-03-13 15:06:29,997 [INFO]: 	avg_search_speed_ms: 17.480165756959305
2025-03-13 15:06:29,997 [INFO]: 	99p_search_speed_ms: 37.96942550688976
2025-03-13 15:06:29,997 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:06:29,997 [INFO]: 	nb vectors: 10362
2025-03-13 15:06:29,997 [INFO]: 	vectors dimension: 49152
2025-03-13 15:06:29,997 [INFO]: 	compression ratio: 0.9986193905670332
2025-03-13 15:06:29,997 [INFO]: }
2025-03-13 15:06:29,997 [INFO]: 	>>> Finished "Creating the index" in 164.4856 secs
2025-03-13 15:06:29,997 [INFO]: >>> Finished "Launching the whole pipeline" in 164.5180 secs
2025-03-13 15:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 76688 [episode count 11/20]
[retrieval_preprocessing] for episode 65425 [episode count 12/20], we have num_retrieval=np.int64(10321) num_query=np.int64(529)
2025-03-13 15:06:36,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:06:38,246 [INFO]: Launching the whole pipeline 03/13/2025, 15:06:38
2025-03-13 15:06:38,246 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:06:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-13 15:06:38,274 [INFO]: There are 10321 embeddings of dim 49152
2025-03-13 15:06:38,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:06:38,274 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:06:38
2025-03-13 15:06:38,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:06:38,274 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:06:38,274 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:06:38,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:06:38,274 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:06:38
2025-03-13 15:06:38,274 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:06:38,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:06:38,274 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:06:38
2025-03-13 15:06:38,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:06:38,274 [INFO]: 	Creating the index 03/13/2025, 15:06:38
2025-03-13 15:06:38,274 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:06:38
2025-03-13 15:06:38,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:06:38,275 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:06:38
2025-03-13 15:06:38,276 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:06:38,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  8.32it/s] 14%|█▍        | 6/43 [00:00<00:01, 29.35it/s] 28%|██▊       | 12/43 [00:00<00:00, 39.70it/s] 40%|███▉      | 17/43 [00:00<00:00, 42.75it/s] 51%|█████     | 22/43 [00:06<00:10,  2.04it/s] 63%|██████▎   | 27/43 [00:06<00:05,  3.06it/s] 74%|███████▍  | 32/43 [00:07<00:02,  4.44it/s] 86%|████████▌ | 37/43 [00:07<00:00,  6.28it/s] 98%|█████████▊| 42/43 [00:15<00:00,  1.64it/s]100%|██████████| 43/43 [00:16<00:00,  2.61it/s]
2025-03-13 15:06:54,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:06:54
2025-03-13 15:08:23,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.0046 secs
2025-03-13 15:08:23,748 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 15:08:23,748 [INFO]: 	Compute fast metrics 03/13/2025, 15:08:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.92it/s]
2025-03-13 15:08:58,483 [INFO]: 	>>> Finished "Compute fast metrics" in 34.7343 secs
2025-03-13 15:08:58,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 140.2080 secs
2025-03-13 15:08:58,484 [INFO]: {
2025-03-13 15:08:58,484 [INFO]: 	index_key: HNSW32
2025-03-13 15:08:58,484 [INFO]: 	index_param: efSearch=200
2025-03-13 15:08:58,484 [INFO]: 	index_path: knn.index
2025-03-13 15:08:58,484 [INFO]: 	size in bytes: 2031996334
2025-03-13 15:08:58,484 [INFO]: 	avg_search_speed_ms: 18.17912108645859
2025-03-13 15:08:58,484 [INFO]: 	99p_search_speed_ms: 35.71176232304424
2025-03-13 15:08:58,484 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:08:58,484 [INFO]: 	nb vectors: 10321
2025-03-13 15:08:58,484 [INFO]: 	vectors dimension: 49152
2025-03-13 15:08:58,484 [INFO]: 	compression ratio: 0.9986195024306574
2025-03-13 15:08:58,484 [INFO]: }
2025-03-13 15:08:58,484 [INFO]: 	>>> Finished "Creating the index" in 140.2095 secs
2025-03-13 15:08:58,484 [INFO]: >>> Finished "Launching the whole pipeline" in 140.2380 secs
2025-03-13 15:09:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:09:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 65425 [episode count 12/20]
[retrieval_preprocessing] for episode 25542 [episode count 13/20], we have num_retrieval=np.int64(10111) num_query=np.int64(739)
2025-03-13 15:09:05,199 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:09:06,948 [INFO]: Launching the whole pipeline 03/13/2025, 15:09:06
2025-03-13 15:09:06,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:09:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1347.35it/s]
2025-03-13 15:09:06,975 [INFO]: There are 10111 embeddings of dim 49152
2025-03-13 15:09:06,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 15:09:06,976 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:09:06
2025-03-13 15:09:06,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:09:06,976 [INFO]: 		-> Add: 5.6 seconds
2025-03-13 15:09:06,976 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:09:06,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:09:06,976 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:09:06
2025-03-13 15:09:06,976 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:09:06,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:09:06,976 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:09:06
2025-03-13 15:09:06,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:09:06,976 [INFO]: 	Creating the index 03/13/2025, 15:09:06
2025-03-13 15:09:06,976 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:09:06
2025-03-13 15:09:06,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:09:06,977 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:09:06
2025-03-13 15:09:06,977 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:09:06,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:05,  6.76it/s] 12%|█▏        | 5/41 [00:00<00:01, 22.06it/s] 24%|██▍       | 10/41 [00:00<00:00, 31.01it/s] 37%|███▋      | 15/41 [00:00<00:00, 35.51it/s] 49%|████▉     | 20/41 [00:00<00:00, 37.38it/s] 59%|█████▊    | 24/41 [00:07<00:10,  1.68it/s] 68%|██████▊   | 28/41 [00:08<00:05,  2.38it/s] 78%|███████▊  | 32/41 [00:08<00:02,  3.32it/s] 88%|████████▊ | 36/41 [00:08<00:01,  4.55it/s] 98%|█████████▊| 40/41 [00:08<00:00,  6.14it/s]100%|██████████| 41/41 [00:18<00:00,  2.24it/s]
2025-03-13 15:09:25,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:09:25
2025-03-13 15:10:51,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 86.6304 secs
2025-03-13 15:10:51,943 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 15:10:51,943 [INFO]: 	Compute fast metrics 03/13/2025, 15:10:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-13 15:11:36,794 [INFO]: 	>>> Finished "Compute fast metrics" in 44.8504 secs
2025-03-13 15:11:36,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.8203 secs
2025-03-13 15:11:36,798 [INFO]: {
2025-03-13 15:11:36,798 [INFO]: 	index_key: HNSW32
2025-03-13 15:11:36,798 [INFO]: 	index_param: efSearch=148
2025-03-13 15:11:36,798 [INFO]: 	index_path: knn.index
2025-03-13 15:11:36,798 [INFO]: 	size in bytes: 1990651606
2025-03-13 15:11:36,798 [INFO]: 	avg_search_speed_ms: 17.542609951056004
2025-03-13 15:11:36,798 [INFO]: 	99p_search_speed_ms: 51.94834363646805
2025-03-13 15:11:36,798 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:11:36,798 [INFO]: 	nb vectors: 10111
2025-03-13 15:11:36,798 [INFO]: 	vectors dimension: 49152
2025-03-13 15:11:36,798 [INFO]: 	compression ratio: 0.9986194882159606
2025-03-13 15:11:36,798 [INFO]: }
2025-03-13 15:11:36,798 [INFO]: 	>>> Finished "Creating the index" in 149.8218 secs
2025-03-13 15:11:36,798 [INFO]: >>> Finished "Launching the whole pipeline" in 149.8499 secs
2025-03-13 15:11:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:11:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 25542 [episode count 13/20]
[retrieval_preprocessing] for episode 32590 [episode count 14/20], we have num_retrieval=np.int64(10418) num_query=np.int64(432)
2025-03-13 15:11:46,868 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:11:48,858 [INFO]: Launching the whole pipeline 03/13/2025, 15:11:48
2025-03-13 15:11:48,858 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:11:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.29it/s]
2025-03-13 15:11:48,888 [INFO]: There are 10418 embeddings of dim 49152
2025-03-13 15:11:48,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 15:11:48,889 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:11:48
2025-03-13 15:11:48,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:11:48,889 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:11:48,889 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:11:48,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:11:48,889 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:11:48
2025-03-13 15:11:48,889 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:11:48,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:11:48,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:11:48
2025-03-13 15:11:48,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:11:48,890 [INFO]: 	Creating the index 03/13/2025, 15:11:48
2025-03-13 15:11:48,890 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:11:48
2025-03-13 15:11:48,891 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 15:11:48,891 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:11:48
2025-03-13 15:11:48,891 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:11:48,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:08,  4.84it/s]  9%|▉         | 4/43 [00:00<00:02, 14.39it/s] 19%|█▊        | 8/43 [00:00<00:01, 21.70it/s] 28%|██▊       | 12/43 [00:00<00:01, 25.67it/s] 37%|███▋      | 16/43 [00:00<00:00, 29.27it/s] 49%|████▉     | 21/43 [00:07<00:12,  1.75it/s] 58%|█████▊    | 25/43 [00:07<00:07,  2.53it/s] 70%|██████▉   | 30/43 [00:07<00:03,  3.86it/s] 81%|████████▏ | 35/43 [00:07<00:01,  5.62it/s] 93%|█████████▎| 40/43 [00:07<00:00,  7.87it/s]100%|██████████| 43/43 [00:17<00:00,  2.43it/s]
2025-03-13 15:12:06,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:12:06
2025-03-13 15:13:36,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.7580 secs
2025-03-13 15:13:36,324 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 15:13:36,324 [INFO]: 	Compute fast metrics 03/13/2025, 15:13:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-13 15:14:26,177 [INFO]: 	>>> Finished "Compute fast metrics" in 49.8525 secs
2025-03-13 15:14:26,464 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 157.5726 secs
2025-03-13 15:14:26,464 [INFO]: {
2025-03-13 15:14:26,464 [INFO]: 	index_key: HNSW32
2025-03-13 15:14:26,464 [INFO]: 	index_param: efSearch=180
2025-03-13 15:14:26,464 [INFO]: 	index_path: knn.index
2025-03-13 15:14:26,464 [INFO]: 	size in bytes: 2051094202
2025-03-13 15:14:26,464 [INFO]: 	avg_search_speed_ms: 15.07388104380288
2025-03-13 15:14:26,464 [INFO]: 	99p_search_speed_ms: 29.822477113921195
2025-03-13 15:14:26,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:14:26,464 [INFO]: 	nb vectors: 10418
2025-03-13 15:14:26,465 [INFO]: 	vectors dimension: 49152
2025-03-13 15:14:26,465 [INFO]: 	compression ratio: 0.9986192452802809
2025-03-13 15:14:26,465 [INFO]: }
2025-03-13 15:14:26,465 [INFO]: 	>>> Finished "Creating the index" in 157.5751 secs
2025-03-13 15:14:26,465 [INFO]: >>> Finished "Launching the whole pipeline" in 157.6066 secs
2025-03-13 15:14:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:14:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 32590 [episode count 14/20]
[retrieval_preprocessing] for episode 30168 [episode count 15/20], we have num_retrieval=np.int64(10440) num_query=np.int64(410)
2025-03-13 15:14:31,530 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:14:33,158 [INFO]: Launching the whole pipeline 03/13/2025, 15:14:33
2025-03-13 15:14:33,158 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:14:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 919.60it/s]
2025-03-13 15:14:33,186 [INFO]: There are 10440 embeddings of dim 49152
2025-03-13 15:14:33,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-13 15:14:33,186 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:14:33
2025-03-13 15:14:33,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:14:33,186 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:14:33,186 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:14:33,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:14:33,186 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:14:33
2025-03-13 15:14:33,186 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:14:33,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:14:33,186 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:14:33
2025-03-13 15:14:33,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:14:33,187 [INFO]: 	Creating the index 03/13/2025, 15:14:33
2025-03-13 15:14:33,187 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:14:33
2025-03-13 15:14:33,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:14:33,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:14:33
2025-03-13 15:14:33,188 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:14:33,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:06,  6.63it/s] 11%|█▏        | 5/44 [00:00<00:01, 20.58it/s] 23%|██▎       | 10/44 [00:00<00:01, 29.66it/s] 34%|███▍      | 15/44 [00:00<00:00, 34.50it/s] 45%|████▌     | 20/44 [00:00<00:00, 37.11it/s] 55%|█████▍    | 24/44 [00:08<00:12,  1.59it/s] 66%|██████▌   | 29/44 [00:08<00:06,  2.44it/s] 77%|███████▋  | 34/44 [00:08<00:02,  3.58it/s] 89%|████████▊ | 39/44 [00:08<00:00,  5.11it/s] 98%|█████████▊| 43/44 [00:17<00:00,  1.36it/s]100%|██████████| 44/44 [00:18<00:00,  2.32it/s]
2025-03-13 15:14:52,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:14:52
2025-03-13 15:16:26,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 94.0981 secs
2025-03-13 15:16:26,254 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 15:16:26,254 [INFO]: 	Compute fast metrics 03/13/2025, 15:16:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.22it/s]
2025-03-13 15:17:25,094 [INFO]: 	>>> Finished "Compute fast metrics" in 58.8396 secs
2025-03-13 15:17:25,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 172.1340 secs
2025-03-13 15:17:25,322 [INFO]: {
2025-03-13 15:17:25,322 [INFO]: 	index_key: HNSW32
2025-03-13 15:17:25,322 [INFO]: 	index_param: efSearch=194
2025-03-13 15:17:25,322 [INFO]: 	index_path: knn.index
2025-03-13 15:17:25,322 [INFO]: 	size in bytes: 2055425474
2025-03-13 15:17:25,323 [INFO]: 	avg_search_speed_ms: 20.365271954882562
2025-03-13 15:17:25,323 [INFO]: 	99p_search_speed_ms: 39.12288802675908
2025-03-13 15:17:25,323 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:17:25,323 [INFO]: 	nb vectors: 10440
2025-03-13 15:17:25,323 [INFO]: 	vectors dimension: 49152
2025-03-13 15:17:25,323 [INFO]: 	compression ratio: 0.99861928635414
2025-03-13 15:17:25,323 [INFO]: }
2025-03-13 15:17:25,323 [INFO]: 	>>> Finished "Creating the index" in 172.1364 secs
2025-03-13 15:17:25,323 [INFO]: >>> Finished "Launching the whole pipeline" in 172.1650 secs
2025-03-13 15:17:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:17:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 30168 [episode count 15/20]
[retrieval_preprocessing] for episode 46595 [episode count 16/20], we have num_retrieval=np.int64(10090) num_query=np.int64(760)
2025-03-13 15:17:30,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:17:32,743 [INFO]: Launching the whole pipeline 03/13/2025, 15:17:32
2025-03-13 15:17:32,743 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:17:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.96it/s]
2025-03-13 15:17:32,776 [INFO]: There are 10090 embeddings of dim 49152
2025-03-13 15:17:32,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-13 15:17:32,777 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:17:32
2025-03-13 15:17:32,777 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:17:32,777 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 15:17:32,777 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:17:32,777 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:17:32,778 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:17:32
2025-03-13 15:17:32,778 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:17:32,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 15:17:32,778 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:17:32
2025-03-13 15:17:32,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 15:17:32,779 [INFO]: 	Creating the index 03/13/2025, 15:17:32
2025-03-13 15:17:32,779 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:17:32
2025-03-13 15:17:32,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0034 secs
2025-03-13 15:17:32,783 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:17:32
2025-03-13 15:17:32,783 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:17:32,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  6.51it/s] 12%|█▏        | 5/41 [00:00<00:01, 20.75it/s] 22%|██▏       | 9/41 [00:00<00:01, 26.71it/s] 32%|███▏      | 13/41 [00:00<00:00, 29.97it/s] 41%|████▏     | 17/41 [00:00<00:00, 31.10it/s] 51%|█████     | 21/41 [00:12<00:21,  1.06s/it] 59%|█████▊    | 24/41 [00:12<00:13,  1.28it/s] 66%|██████▌   | 27/41 [00:12<00:07,  1.76it/s] 73%|███████▎  | 30/41 [00:12<00:04,  2.41it/s] 83%|████████▎ | 34/41 [00:12<00:01,  3.58it/s] 93%|█████████▎| 38/41 [00:12<00:00,  5.11it/s]100%|██████████| 41/41 [00:22<00:00,  1.81it/s]
2025-03-13 15:17:55,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:17:55
2025-03-13 15:19:17,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 82.3289 secs
2025-03-13 15:19:17,820 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 15:19:17,820 [INFO]: 	Compute fast metrics 03/13/2025, 15:19:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.43s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.08it/s]
2025-03-13 15:20:07,359 [INFO]: 	>>> Finished "Compute fast metrics" in 49.5392 secs
2025-03-13 15:20:07,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.5805 secs
2025-03-13 15:20:07,364 [INFO]: {
2025-03-13 15:20:07,364 [INFO]: 	index_key: HNSW32
2025-03-13 15:20:07,364 [INFO]: 	index_param: efSearch=196
2025-03-13 15:20:07,364 [INFO]: 	index_path: knn.index
2025-03-13 15:20:07,364 [INFO]: 	size in bytes: 1986517210
2025-03-13 15:20:07,364 [INFO]: 	avg_search_speed_ms: 20.026765294838697
2025-03-13 15:20:07,364 [INFO]: 	99p_search_speed_ms: 39.45741593372075
2025-03-13 15:20:07,364 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:20:07,364 [INFO]: 	nb vectors: 10090
2025-03-13 15:20:07,364 [INFO]: 	vectors dimension: 49152
2025-03-13 15:20:07,364 [INFO]: 	compression ratio: 0.9986194481546928
2025-03-13 15:20:07,364 [INFO]: }
2025-03-13 15:20:07,364 [INFO]: 	>>> Finished "Creating the index" in 154.5850 secs
2025-03-13 15:20:07,364 [INFO]: >>> Finished "Launching the whole pipeline" in 154.6210 secs
2025-03-13 15:20:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:20:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 46595 [episode count 16/20]
[retrieval_preprocessing] for episode 90062 [episode count 17/20], we have num_retrieval=np.int64(9983) num_query=np.int64(867)
2025-03-13 15:20:17,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:20:20,296 [INFO]: Launching the whole pipeline 03/13/2025, 15:20:20
2025-03-13 15:20:20,296 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.23it/s]
2025-03-13 15:20:20,325 [INFO]: There are 9983 embeddings of dim 49152
2025-03-13 15:20:20,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 15:20:20,326 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:20:20,326 [INFO]: 		-> Add: 5.5 seconds
2025-03-13 15:20:20,326 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:20:20,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:20:20,326 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,326 [INFO]: 2.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:20:20,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:20:20,326 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:20:20
2025-03-13 15:20:20,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:20:20,326 [INFO]: 	Creating the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,326 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:20:20
2025-03-13 15:20:20,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:20:20,327 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:20:20
2025-03-13 15:20:20,328 [INFO]: The memory available for adding the vectors is 48.2GB(total available - used by the index)
2025-03-13 15:20:20,328 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/41 [00:00<?, ?it/s]  2%|▏         | 1/41 [00:00<00:06,  5.80it/s] 12%|█▏        | 5/41 [00:00<00:01, 19.90it/s] 22%|██▏       | 9/41 [00:00<00:01, 27.35it/s] 32%|███▏      | 13/41 [00:00<00:00, 31.65it/s] 41%|████▏     | 17/41 [00:00<00:00, 34.33it/s] 51%|█████     | 21/41 [00:05<00:09,  2.13it/s] 59%|█████▊    | 24/41 [00:06<00:06,  2.67it/s] 63%|██████▎   | 26/41 [00:06<00:04,  3.10it/s] 68%|██████▊   | 28/41 [00:06<00:03,  3.59it/s] 73%|███████▎  | 30/41 [00:06<00:02,  4.16it/s] 78%|███████▊  | 32/41 [00:07<00:01,  4.76it/s] 83%|████████▎ | 34/41 [00:07<00:01,  5.48it/s] 88%|████████▊ | 36/41 [00:07<00:00,  6.47it/s] 93%|█████████▎| 38/41 [00:07<00:00,  7.30it/s] 98%|█████████▊| 40/41 [00:07<00:00,  8.26it/s]100%|██████████| 41/41 [00:13<00:00,  3.05it/s]
2025-03-13 15:20:33,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:20:33
2025-03-13 15:21:52,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.6221 secs
2025-03-13 15:21:52,377 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 15:21:52,377 [INFO]: 	Compute fast metrics 03/13/2025, 15:21:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-13 15:22:37,292 [INFO]: 	>>> Finished "Compute fast metrics" in 44.9151 secs
2025-03-13 15:22:37,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 136.9677 secs
2025-03-13 15:22:37,295 [INFO]: {
2025-03-13 15:22:37,295 [INFO]: 	index_key: HNSW15
2025-03-13 15:22:37,295 [INFO]: 	index_param: efSearch=238
2025-03-13 15:22:37,295 [INFO]: 	index_path: knn.index
2025-03-13 15:22:37,295 [INFO]: 	size in bytes: 1964096350
2025-03-13 15:22:37,295 [INFO]: 	avg_search_speed_ms: 15.418741775630687
2025-03-13 15:22:37,295 [INFO]: 	99p_search_speed_ms: 29.14698647335171
2025-03-13 15:22:37,296 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:22:37,296 [INFO]: 	nb vectors: 9983
2025-03-13 15:22:37,296 [INFO]: 	vectors dimension: 49152
2025-03-13 15:22:37,296 [INFO]: 	compression ratio: 0.9993082386207784
2025-03-13 15:22:37,296 [INFO]: }
2025-03-13 15:22:37,296 [INFO]: 	>>> Finished "Creating the index" in 136.9693 secs
2025-03-13 15:22:37,296 [INFO]: >>> Finished "Launching the whole pipeline" in 136.9995 secs
2025-03-13 15:22:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:22:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 90062 [episode count 17/20]
[retrieval_preprocessing] for episode 33047 [episode count 18/20], we have num_retrieval=np.int64(10395) num_query=np.int64(455)
2025-03-13 15:22:50,714 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:22:52,586 [INFO]: Launching the whole pipeline 03/13/2025, 15:22:52
2025-03-13 15:22:52,586 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:22:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1851.79it/s]
2025-03-13 15:22:52,612 [INFO]: There are 10395 embeddings of dim 49152
2025-03-13 15:22:52,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 15:22:52,613 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:22:52
2025-03-13 15:22:52,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:22:52,613 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:22:52,613 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:22:52,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:22:52,613 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:22:52
2025-03-13 15:22:52,613 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:22:52,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:22:52,613 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:22:52
2025-03-13 15:22:52,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:22:52,613 [INFO]: 	Creating the index 03/13/2025, 15:22:52
2025-03-13 15:22:52,613 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:22:52
2025-03-13 15:22:52,614 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 15:22:52,614 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:22:52
2025-03-13 15:22:52,615 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:22:52,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.52it/s]  9%|▉         | 4/43 [00:00<00:02, 18.60it/s] 21%|██        | 9/43 [00:00<00:01, 30.42it/s] 33%|███▎      | 14/43 [00:00<00:00, 36.01it/s] 44%|████▍     | 19/43 [00:00<00:00, 38.92it/s] 53%|█████▎    | 23/43 [00:06<00:10,  1.95it/s] 65%|██████▌   | 28/43 [00:06<00:05,  2.99it/s] 77%|███████▋  | 33/43 [00:07<00:02,  4.38it/s] 88%|████████▊ | 38/43 [00:07<00:00,  6.21it/s] 98%|█████████▊| 42/43 [00:15<00:00,  1.43it/s]100%|██████████| 43/43 [00:17<00:00,  2.46it/s]
2025-03-13 15:23:10,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:23:10
2025-03-13 15:24:41,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 91.4055 secs
2025-03-13 15:24:41,514 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 15:24:41,514 [INFO]: 	Compute fast metrics 03/13/2025, 15:24:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.72it/s]
2025-03-13 15:25:23,353 [INFO]: 	>>> Finished "Compute fast metrics" in 41.8389 secs
2025-03-13 15:25:23,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.1000 secs
2025-03-13 15:25:23,715 [INFO]: {
2025-03-13 15:25:23,715 [INFO]: 	index_key: HNSW32
2025-03-13 15:25:23,715 [INFO]: 	index_param: efSearch=156
2025-03-13 15:25:23,715 [INFO]: 	index_path: knn.index
2025-03-13 15:25:23,715 [INFO]: 	size in bytes: 2046565670
2025-03-13 15:25:23,715 [INFO]: 	avg_search_speed_ms: 20.840522716753185
2025-03-13 15:25:23,715 [INFO]: 	99p_search_speed_ms: 34.10305751953273
2025-03-13 15:25:23,715 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:25:23,715 [INFO]: 	nb vectors: 10395
2025-03-13 15:25:23,716 [INFO]: 	vectors dimension: 49152
2025-03-13 15:25:23,716 [INFO]: 	compression ratio: 0.9986193895258685
2025-03-13 15:25:23,716 [INFO]: }
2025-03-13 15:25:23,716 [INFO]: 	>>> Finished "Creating the index" in 151.1024 secs
2025-03-13 15:25:23,716 [INFO]: >>> Finished "Launching the whole pipeline" in 151.1299 secs
2025-03-13 15:25:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:25:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 33047 [episode count 18/20]
[retrieval_preprocessing] for episode 21910 [episode count 19/20], we have num_retrieval=np.int64(10334) num_query=np.int64(516)
2025-03-13 15:25:28,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:25:30,691 [INFO]: Launching the whole pipeline 03/13/2025, 15:25:30
2025-03-13 15:25:30,691 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:25:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]
2025-03-13 15:25:30,718 [INFO]: There are 10334 embeddings of dim 49152
2025-03-13 15:25:30,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:25:30,718 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:25:30
2025-03-13 15:25:30,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:25:30,719 [INFO]: 		-> Add: 5.7 seconds
2025-03-13 15:25:30,719 [INFO]: 		Total: 16.8 minutes
2025-03-13 15:25:30,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:25:30,719 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:25:30
2025-03-13 15:25:30,719 [INFO]: 2.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:25:30,719 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:25:30,719 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:25:30
2025-03-13 15:25:30,719 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:25:30,719 [INFO]: 	Creating the index 03/13/2025, 15:25:30
2025-03-13 15:25:30,719 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 15:25:30
2025-03-13 15:25:30,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 15:25:30,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:25:30
2025-03-13 15:25:30,720 [INFO]: The memory available for adding the vectors is 48.1GB(total available - used by the index)
2025-03-13 15:25:30,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:00<00:05,  7.97it/s] 12%|█▏        | 5/43 [00:00<00:01, 22.47it/s] 23%|██▎       | 10/43 [00:00<00:01, 32.69it/s] 35%|███▍      | 15/43 [00:00<00:00, 37.93it/s] 47%|████▋     | 20/43 [00:00<00:00, 40.92it/s] 58%|█████▊    | 25/43 [00:07<00:09,  1.97it/s] 70%|██████▉   | 30/43 [00:07<00:04,  2.93it/s] 81%|████████▏ | 35/43 [00:07<00:01,  4.22it/s] 93%|█████████▎| 40/43 [00:07<00:00,  5.94it/s]100%|██████████| 43/43 [00:16<00:00,  2.56it/s]
2025-03-13 15:25:47,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:25:47
2025-03-13 15:27:13,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 85.8304 secs
2025-03-13 15:27:13,351 [INFO]: The best hyperparameters are: efSearch=188
2025-03-13 15:27:13,351 [INFO]: 	Compute fast metrics 03/13/2025, 15:27:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.56it/s] 50%|█████     | 2/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-13 15:28:10,719 [INFO]: 	>>> Finished "Compute fast metrics" in 57.3676 secs
2025-03-13 15:28:10,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 159.9994 secs
2025-03-13 15:28:10,720 [INFO]: {
2025-03-13 15:28:10,720 [INFO]: 	index_key: HNSW32
2025-03-13 15:28:10,720 [INFO]: 	index_param: efSearch=188
2025-03-13 15:28:10,720 [INFO]: 	index_path: knn.index
2025-03-13 15:28:10,720 [INFO]: 	size in bytes: 2034555722
2025-03-13 15:28:10,720 [INFO]: 	avg_search_speed_ms: 22.968165796472256
2025-03-13 15:28:10,720 [INFO]: 	99p_search_speed_ms: 39.631799561902874
2025-03-13 15:28:10,720 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:28:10,720 [INFO]: 	nb vectors: 10334
2025-03-13 15:28:10,720 [INFO]: 	vectors dimension: 49152
2025-03-13 15:28:10,720 [INFO]: 	compression ratio: 0.998619526627052
2025-03-13 15:28:10,720 [INFO]: }
2025-03-13 15:28:10,720 [INFO]: 	>>> Finished "Creating the index" in 160.0009 secs
2025-03-13 15:28:10,720 [INFO]: >>> Finished "Launching the whole pipeline" in 160.0291 secs
2025-03-13 15:28:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:28:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 21910 [episode count 19/20]
2025-03-13 15:28:16: [retrieval_preprocessing] finished for 2927338332_unfold_towel [chosen_id count 0/196]
2025-03-13 15:28:18: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2939999281_open_tap [chosen_id count 1/196]
2025-03-13 15:28:18: [retrieval_preprocessing] we have num_total=3570 embedding_dim=49152
[retrieval_preprocessing] for episode 57350 [episode count 0/20], we have num_retrieval=np.int64(3423) num_query=np.int64(147)
2025-03-13 15:28:18,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:28:19,572 [INFO]: Launching the whole pipeline 03/13/2025, 15:28:19
2025-03-13 15:28:19,572 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:28:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.54it/s]
2025-03-13 15:28:19,606 [INFO]: There are 3423 embeddings of dim 49152
2025-03-13 15:28:19,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0341 secs
2025-03-13 15:28:19,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:28:19
2025-03-13 15:28:19,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:28:19,606 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:28:19,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:28:19,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:28:19,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:28:19
2025-03-13 15:28:19,607 [INFO]: 706.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:28:19,607 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:28:19,607 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:28:19
2025-03-13 15:28:19,607 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:28:19,607 [INFO]: 	Creating the index 03/13/2025, 15:28:19
2025-03-13 15:28:19,607 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:28:19
2025-03-13 15:28:19,608 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:28:19,609 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:28:19
2025-03-13 15:28:19,609 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:28:19,609 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.69it/s] 36%|███▌      | 5/14 [00:00<00:00, 24.93it/s] 64%|██████▍   | 9/14 [00:00<00:00, 30.18it/s] 93%|█████████▎| 13/14 [00:00<00:00, 31.31it/s]100%|██████████| 14/14 [00:04<00:00,  3.31it/s]
2025-03-13 15:28:23,843 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:28:23
2025-03-13 15:29:07,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9207 secs
2025-03-13 15:29:07,764 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 15:29:07,764 [INFO]: 	Compute fast metrics 03/13/2025, 15:29:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 15:29:31,499 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7347 secs
2025-03-13 15:29:31,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8929 secs
2025-03-13 15:29:31,502 [INFO]: {
2025-03-13 15:29:31,502 [INFO]: 	index_key: HNSW15
2025-03-13 15:29:31,502 [INFO]: 	index_param: efSearch=237
2025-03-13 15:29:31,502 [INFO]: 	index_path: knn.index
2025-03-13 15:29:31,502 [INFO]: 	size in bytes: 673454290
2025-03-13 15:29:31,502 [INFO]: 	avg_search_speed_ms: 16.84052196898896
2025-03-13 15:29:31,502 [INFO]: 	99p_search_speed_ms: 39.49170856270955
2025-03-13 15:29:31,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:29:31,502 [INFO]: 	nb vectors: 3423
2025-03-13 15:29:31,502 [INFO]: 	vectors dimension: 49152
2025-03-13 15:29:31,502 [INFO]: 	compression ratio: 0.9993093725782042
2025-03-13 15:29:31,502 [INFO]: }
2025-03-13 15:29:31,502 [INFO]: 	>>> Finished "Creating the index" in 71.8946 secs
2025-03-13 15:29:31,502 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9298 secs
2025-03-13 15:29:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:29:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 57350 [episode count 0/20]
[retrieval_preprocessing] for episode 38408 [episode count 1/20], we have num_retrieval=np.int64(3404) num_query=np.int64(166)
2025-03-13 15:29:33,422 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:29:33,998 [INFO]: Launching the whole pipeline 03/13/2025, 15:29:33
2025-03-13 15:29:33,998 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:29:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 957.82it/s]
2025-03-13 15:29:34,031 [INFO]: There are 3404 embeddings of dim 49152
2025-03-13 15:29:34,031 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 15:29:34,032 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:29:34
2025-03-13 15:29:34,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:29:34,032 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:29:34,032 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:29:34,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:29:34,033 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:29:34
2025-03-13 15:29:34,033 [INFO]: 702.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:29:34,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:29:34,033 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:29:34
2025-03-13 15:29:34,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:29:34,033 [INFO]: 	Creating the index 03/13/2025, 15:29:34
2025-03-13 15:29:34,034 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:29:34
2025-03-13 15:29:34,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:29:34,037 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:29:34
2025-03-13 15:29:34,037 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:29:34,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 25.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 40.48it/s]100%|██████████| 14/14 [00:02<00:00,  4.28it/s]100%|██████████| 14/14 [00:02<00:00,  5.40it/s]
2025-03-13 15:29:36,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:29:36
2025-03-13 15:30:18,430 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7944 secs
2025-03-13 15:30:18,430 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 15:30:18,430 [INFO]: 	Compute fast metrics 03/13/2025, 15:30:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.21it/s]
2025-03-13 15:30:39,049 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6190 secs
2025-03-13 15:30:39,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0142 secs
2025-03-13 15:30:39,052 [INFO]: {
2025-03-13 15:30:39,052 [INFO]: 	index_key: HNSW15
2025-03-13 15:30:39,052 [INFO]: 	index_param: efSearch=137
2025-03-13 15:30:39,052 [INFO]: 	index_path: knn.index
2025-03-13 15:30:39,052 [INFO]: 	size in bytes: 669716230
2025-03-13 15:30:39,052 [INFO]: 	avg_search_speed_ms: 8.047166703964193
2025-03-13 15:30:39,052 [INFO]: 	99p_search_speed_ms: 11.408669808879495
2025-03-13 15:30:39,052 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:30:39,052 [INFO]: 	nb vectors: 3404
2025-03-13 15:30:39,052 [INFO]: 	vectors dimension: 49152
2025-03-13 15:30:39,052 [INFO]: 	compression ratio: 0.999309262670848
2025-03-13 15:30:39,052 [INFO]: }
2025-03-13 15:30:39,052 [INFO]: 	>>> Finished "Creating the index" in 65.0181 secs
2025-03-13 15:30:39,052 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0539 secs
2025-03-13 15:30:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:30:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 38408 [episode count 1/20]
[retrieval_preprocessing] for episode 45121 [episode count 2/20], we have num_retrieval=np.int64(3138) num_query=np.int64(432)
2025-03-13 15:30:40,423 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:30:40,872 [INFO]: Launching the whole pipeline 03/13/2025, 15:30:40
2025-03-13 15:30:40,872 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:30:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-13 15:30:40,898 [INFO]: There are 3138 embeddings of dim 49152
2025-03-13 15:30:40,898 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:30:40,898 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:30:40
2025-03-13 15:30:40,898 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:30:40,898 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 15:30:40,898 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:30:40,898 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:30:40,898 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:30:40
2025-03-13 15:30:40,898 [INFO]: 647.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:30:40,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:30:40,898 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:30:40
2025-03-13 15:30:40,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:30:40,898 [INFO]: 	Creating the index 03/13/2025, 15:30:40
2025-03-13 15:30:40,898 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:30:40
2025-03-13 15:30:40,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:30:40,899 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:30:40
2025-03-13 15:30:40,900 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:30:40,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.07it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.44it/s] 69%|██████▉   | 9/13 [00:00<00:00, 30.02it/s]100%|██████████| 13/13 [00:03<00:00,  3.00it/s]100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
2025-03-13 15:30:44,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:30:44
2025-03-13 15:31:21,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7566 secs
2025-03-13 15:31:21,878 [INFO]: The best hyperparameters are: efSearch=162
2025-03-13 15:31:21,878 [INFO]: 	Compute fast metrics 03/13/2025, 15:31:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.24it/s]
2025-03-13 15:31:50,287 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4091 secs
2025-03-13 15:31:50,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3904 secs
2025-03-13 15:31:50,290 [INFO]: {
2025-03-13 15:31:50,290 [INFO]: 	index_key: HNSW15
2025-03-13 15:31:50,290 [INFO]: 	index_param: efSearch=162
2025-03-13 15:31:50,290 [INFO]: 	index_path: knn.index
2025-03-13 15:31:50,290 [INFO]: 	size in bytes: 617382130
2025-03-13 15:31:50,290 [INFO]: 	avg_search_speed_ms: 8.790189516935204
2025-03-13 15:31:50,290 [INFO]: 	99p_search_speed_ms: 14.286647592671203
2025-03-13 15:31:50,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:31:50,290 [INFO]: 	nb vectors: 3138
2025-03-13 15:31:50,290 [INFO]: 	vectors dimension: 49152
2025-03-13 15:31:50,290 [INFO]: 	compression ratio: 0.9993096236847672
2025-03-13 15:31:50,290 [INFO]: }
2025-03-13 15:31:50,290 [INFO]: 	>>> Finished "Creating the index" in 69.3919 secs
2025-03-13 15:31:50,290 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4182 secs
2025-03-13 15:31:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:31:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 45121 [episode count 2/20]
[retrieval_preprocessing] for episode 77893 [episode count 3/20], we have num_retrieval=np.int64(3452) num_query=np.int64(118)
2025-03-13 15:31:53,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:31:54,437 [INFO]: Launching the whole pipeline 03/13/2025, 15:31:54
2025-03-13 15:31:54,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:31:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-13 15:31:54,466 [INFO]: There are 3452 embeddings of dim 49152
2025-03-13 15:31:54,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 15:31:54,466 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:31:54
2025-03-13 15:31:54,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:31:54,466 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:31:54,466 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:31:54,466 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:31:54,466 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:31:54
2025-03-13 15:31:54,466 [INFO]: 712.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:31:54,466 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:31:54,466 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:31:54
2025-03-13 15:31:54,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:31:54,466 [INFO]: 	Creating the index 03/13/2025, 15:31:54
2025-03-13 15:31:54,466 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:31:54
2025-03-13 15:31:54,467 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:31:54,467 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:31:54
2025-03-13 15:31:54,468 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:31:54,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.46it/s] 36%|███▌      | 5/14 [00:00<00:00, 25.55it/s] 64%|██████▍   | 9/14 [00:00<00:00, 30.55it/s] 93%|█████████▎| 13/14 [00:00<00:00, 32.81it/s]100%|██████████| 14/14 [00:03<00:00,  4.37it/s]
2025-03-13 15:31:58,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:31:58
2025-03-13 15:32:37,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6626 secs
2025-03-13 15:32:37,812 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 15:32:37,812 [INFO]: 	Compute fast metrics 03/13/2025, 15:32:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-13 15:32:57,904 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0916 secs
2025-03-13 15:32:57,907 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4392 secs
2025-03-13 15:32:57,907 [INFO]: {
2025-03-13 15:32:57,907 [INFO]: 	index_key: HNSW15
2025-03-13 15:32:57,907 [INFO]: 	index_param: efSearch=128
2025-03-13 15:32:57,907 [INFO]: 	index_path: knn.index
2025-03-13 15:32:57,907 [INFO]: 	size in bytes: 679159870
2025-03-13 15:32:57,907 [INFO]: 	avg_search_speed_ms: 7.362878916370895
2025-03-13 15:32:57,907 [INFO]: 	99p_search_speed_ms: 10.253835537005223
2025-03-13 15:32:57,907 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:32:57,907 [INFO]: 	nb vectors: 3452
2025-03-13 15:32:57,907 [INFO]: 	vectors dimension: 49152
2025-03-13 15:32:57,907 [INFO]: 	compression ratio: 0.9993093614320882
2025-03-13 15:32:57,907 [INFO]: }
2025-03-13 15:32:57,907 [INFO]: 	>>> Finished "Creating the index" in 63.4407 secs
2025-03-13 15:32:57,907 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4697 secs
2025-03-13 15:32:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:32:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 77893 [episode count 3/20]
[retrieval_preprocessing] for episode 48202 [episode count 4/20], we have num_retrieval=np.int64(3471) num_query=np.int64(99)
2025-03-13 15:32:58,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:32:59,520 [INFO]: Launching the whole pipeline 03/13/2025, 15:32:59
2025-03-13 15:32:59,520 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:32:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.34it/s]
2025-03-13 15:32:59,547 [INFO]: There are 3471 embeddings of dim 49152
2025-03-13 15:32:59,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 15:32:59,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:32:59
2025-03-13 15:32:59,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:32:59,548 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:32:59,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:32:59,548 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:32:59,548 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:32:59
2025-03-13 15:32:59,548 [INFO]: 716.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:32:59,548 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:32:59,548 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:32:59
2025-03-13 15:32:59,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:32:59,548 [INFO]: 	Creating the index 03/13/2025, 15:32:59
2025-03-13 15:32:59,548 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:32:59
2025-03-13 15:32:59,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:32:59,549 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:32:59
2025-03-13 15:32:59,549 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:32:59,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.41it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.25it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.77it/s]100%|██████████| 14/14 [00:03<00:00,  4.44it/s]
2025-03-13 15:33:02,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:33:02
2025-03-13 15:33:42,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2979 secs
2025-03-13 15:33:42,003 [INFO]: The best hyperparameters are: efSearch=250
2025-03-13 15:33:42,003 [INFO]: 	Compute fast metrics 03/13/2025, 15:33:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.95it/s]
2025-03-13 15:34:11,750 [INFO]: 	>>> Finished "Compute fast metrics" in 29.7470 secs
2025-03-13 15:34:11,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.2037 secs
2025-03-13 15:34:11,753 [INFO]: {
2025-03-13 15:34:11,753 [INFO]: 	index_key: HNSW15
2025-03-13 15:34:11,753 [INFO]: 	index_param: efSearch=250
2025-03-13 15:34:11,753 [INFO]: 	index_path: knn.index
2025-03-13 15:34:11,753 [INFO]: 	size in bytes: 682897930
2025-03-13 15:34:11,753 [INFO]: 	avg_search_speed_ms: 13.905671094213929
2025-03-13 15:34:11,753 [INFO]: 	99p_search_speed_ms: 19.498079316690564
2025-03-13 15:34:11,753 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:34:11,753 [INFO]: 	nb vectors: 3471
2025-03-13 15:34:11,753 [INFO]: 	vectors dimension: 49152
2025-03-13 15:34:11,753 [INFO]: 	compression ratio: 0.9993094692789595
2025-03-13 15:34:11,753 [INFO]: }
2025-03-13 15:34:11,753 [INFO]: 	>>> Finished "Creating the index" in 72.2053 secs
2025-03-13 15:34:11,753 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2331 secs
2025-03-13 15:34:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:34:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 48202 [episode count 4/20]
[retrieval_preprocessing] for episode 15953 [episode count 5/20], we have num_retrieval=np.int64(3473) num_query=np.int64(97)
2025-03-13 15:34:13,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:34:13,869 [INFO]: Launching the whole pipeline 03/13/2025, 15:34:13
2025-03-13 15:34:13,869 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:34:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2023.30it/s]
2025-03-13 15:34:13,892 [INFO]: There are 3473 embeddings of dim 49152
2025-03-13 15:34:13,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 15:34:13,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:34:13
2025-03-13 15:34:13,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:34:13,893 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:34:13,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:34:13,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:34:13,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:34:13
2025-03-13 15:34:13,893 [INFO]: 716.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:34:13,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:34:13,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:34:13
2025-03-13 15:34:13,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:34:13,893 [INFO]: 	Creating the index 03/13/2025, 15:34:13
2025-03-13 15:34:13,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:34:13
2025-03-13 15:34:13,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:34:13,894 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:34:13
2025-03-13 15:34:13,894 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:34:13,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 16.69it/s] 50%|█████     | 7/14 [00:00<00:00, 31.32it/s] 79%|███████▊  | 11/14 [00:00<00:00, 34.85it/s]100%|██████████| 14/14 [00:02<00:00,  4.88it/s]
2025-03-13 15:34:16,765 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:34:16
2025-03-13 15:34:58,755 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9896 secs
2025-03-13 15:34:58,755 [INFO]: The best hyperparameters are: efSearch=105
2025-03-13 15:34:58,755 [INFO]: 	Compute fast metrics 03/13/2025, 15:34:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.09it/s]
2025-03-13 15:35:20,883 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1276 secs
2025-03-13 15:35:20,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9911 secs
2025-03-13 15:35:20,885 [INFO]: {
2025-03-13 15:35:20,885 [INFO]: 	index_key: HNSW15
2025-03-13 15:35:20,885 [INFO]: 	index_param: efSearch=105
2025-03-13 15:35:20,885 [INFO]: 	index_path: knn.index
2025-03-13 15:35:20,885 [INFO]: 	size in bytes: 683291470
2025-03-13 15:35:20,885 [INFO]: 	avg_search_speed_ms: 6.567803105261135
2025-03-13 15:35:20,886 [INFO]: 	99p_search_speed_ms: 8.674382655881343
2025-03-13 15:35:20,886 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:35:20,886 [INFO]: 	nb vectors: 3473
2025-03-13 15:35:20,886 [INFO]: 	vectors dimension: 49152
2025-03-13 15:35:20,886 [INFO]: 	compression ratio: 0.9993093928129968
2025-03-13 15:35:20,886 [INFO]: }
2025-03-13 15:35:20,886 [INFO]: 	>>> Finished "Creating the index" in 66.9925 secs
2025-03-13 15:35:20,886 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0169 secs
2025-03-13 15:35:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:35:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 15953 [episode count 5/20]
[retrieval_preprocessing] for episode 42079 [episode count 6/20], we have num_retrieval=np.int64(3473) num_query=np.int64(97)
2025-03-13 15:35:22,030 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:35:23,139 [INFO]: Launching the whole pipeline 03/13/2025, 15:35:23
2025-03-13 15:35:23,139 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:35:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-13 15:35:23,161 [INFO]: There are 3473 embeddings of dim 49152
2025-03-13 15:35:23,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-13 15:35:23,161 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:35:23
2025-03-13 15:35:23,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:35:23,162 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:35:23,162 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:35:23,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:35:23,162 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:35:23
2025-03-13 15:35:23,162 [INFO]: 716.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:35:23,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:35:23,162 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:35:23
2025-03-13 15:35:23,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:35:23,162 [INFO]: 	Creating the index 03/13/2025, 15:35:23
2025-03-13 15:35:23,162 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:35:23
2025-03-13 15:35:23,164 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:35:23,164 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:35:23
2025-03-13 15:35:23,164 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:35:23,164 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.93it/s] 36%|███▌      | 5/14 [00:00<00:00, 26.01it/s] 71%|███████▏  | 10/14 [00:00<00:00, 33.07it/s]100%|██████████| 14/14 [00:03<00:00,  3.28it/s]100%|██████████| 14/14 [00:03<00:00,  4.43it/s]
2025-03-13 15:35:26,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:35:26
2025-03-13 15:36:05,231 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9034 secs
2025-03-13 15:36:05,231 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 15:36:05,231 [INFO]: 	Compute fast metrics 03/13/2025, 15:36:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 15:36:33,582 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3508 secs
2025-03-13 15:36:34,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.8950 secs
2025-03-13 15:36:34,060 [INFO]: {
2025-03-13 15:36:34,060 [INFO]: 	index_key: HNSW15
2025-03-13 15:36:34,060 [INFO]: 	index_param: efSearch=179
2025-03-13 15:36:34,060 [INFO]: 	index_path: knn.index
2025-03-13 15:36:34,060 [INFO]: 	size in bytes: 683291470
2025-03-13 15:36:34,060 [INFO]: 	avg_search_speed_ms: 9.542670829633948
2025-03-13 15:36:34,060 [INFO]: 	99p_search_speed_ms: 15.642500920221206
2025-03-13 15:36:34,060 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:36:34,060 [INFO]: 	nb vectors: 3473
2025-03-13 15:36:34,060 [INFO]: 	vectors dimension: 49152
2025-03-13 15:36:34,060 [INFO]: 	compression ratio: 0.9993093928129968
2025-03-13 15:36:34,060 [INFO]: }
2025-03-13 15:36:34,060 [INFO]: 	>>> Finished "Creating the index" in 70.8982 secs
2025-03-13 15:36:34,060 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9215 secs
2025-03-13 15:36:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:36:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 42079 [episode count 6/20]
[retrieval_preprocessing] for episode 6279 [episode count 7/20], we have num_retrieval=np.int64(3356) num_query=np.int64(214)
2025-03-13 15:36:36,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:36:36,899 [INFO]: Launching the whole pipeline 03/13/2025, 15:36:36
2025-03-13 15:36:36,899 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:36:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1788.62it/s]
2025-03-13 15:36:36,928 [INFO]: There are 3356 embeddings of dim 49152
2025-03-13 15:36:36,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 15:36:36,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:36:36
2025-03-13 15:36:36,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:36:36,929 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:36:36,929 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:36:36,929 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:36:36,929 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:36:36
2025-03-13 15:36:36,929 [INFO]: 692.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:36:36,929 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:36:36,929 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:36:36
2025-03-13 15:36:36,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:36:36,930 [INFO]: 	Creating the index 03/13/2025, 15:36:36
2025-03-13 15:36:36,930 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:36:36
2025-03-13 15:36:36,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:36:36,933 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:36:36
2025-03-13 15:36:36,933 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:36:36,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.15it/s] 50%|█████     | 7/14 [00:00<00:00, 32.10it/s] 86%|████████▌ | 12/14 [00:00<00:00, 36.28it/s]100%|██████████| 14/14 [00:02<00:00,  4.77it/s]
2025-03-13 15:36:39,874 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:36:39
2025-03-13 15:37:25,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6649 secs
2025-03-13 15:37:25,540 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 15:37:25,540 [INFO]: 	Compute fast metrics 03/13/2025, 15:37:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.43it/s]
2025-03-13 15:37:44,439 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8994 secs
2025-03-13 15:37:44,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5096 secs
2025-03-13 15:37:44,443 [INFO]: {
2025-03-13 15:37:44,443 [INFO]: 	index_key: HNSW15
2025-03-13 15:37:44,443 [INFO]: 	index_param: efSearch=99
2025-03-13 15:37:44,443 [INFO]: 	index_path: knn.index
2025-03-13 15:37:44,443 [INFO]: 	size in bytes: 660272530
2025-03-13 15:37:44,443 [INFO]: 	avg_search_speed_ms: 10.049503597070524
2025-03-13 15:37:44,443 [INFO]: 	99p_search_speed_ms: 18.090735930018123
2025-03-13 15:37:44,443 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:37:44,443 [INFO]: 	nb vectors: 3356
2025-03-13 15:37:44,443 [INFO]: 	vectors dimension: 49152
2025-03-13 15:37:44,443 [INFO]: 	compression ratio: 0.9993092518933053
2025-03-13 15:37:44,443 [INFO]: }
2025-03-13 15:37:44,443 [INFO]: 	>>> Finished "Creating the index" in 67.5135 secs
2025-03-13 15:37:44,443 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5447 secs
2025-03-13 15:37:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:37:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 6279 [episode count 7/20]
[retrieval_preprocessing] for episode 70283 [episode count 8/20], we have num_retrieval=np.int64(3414) num_query=np.int64(156)
2025-03-13 15:37:46,112 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:37:46,695 [INFO]: Launching the whole pipeline 03/13/2025, 15:37:46
2025-03-13 15:37:46,695 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:37:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2000.14it/s]
2025-03-13 15:37:46,725 [INFO]: There are 3414 embeddings of dim 49152
2025-03-13 15:37:46,725 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-13 15:37:46,725 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:37:46
2025-03-13 15:37:46,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:37:46,725 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:37:46,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:37:46,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:37:46,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:37:46
2025-03-13 15:37:46,725 [INFO]: 704.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:37:46,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:37:46,725 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:37:46
2025-03-13 15:37:46,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:37:46,726 [INFO]: 	Creating the index 03/13/2025, 15:37:46
2025-03-13 15:37:46,726 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:37:46
2025-03-13 15:37:46,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 15:37:46,727 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:37:46
2025-03-13 15:37:46,727 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:37:46,727 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.60it/s] 50%|█████     | 7/14 [00:00<00:00, 33.99it/s] 86%|████████▌ | 12/14 [00:00<00:00, 38.97it/s]100%|██████████| 14/14 [00:03<00:00,  4.51it/s]
2025-03-13 15:37:49,834 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:37:49
2025-03-13 15:38:32,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0713 secs
2025-03-13 15:38:32,906 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 15:38:32,906 [INFO]: 	Compute fast metrics 03/13/2025, 15:38:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-13 15:39:05,167 [INFO]: 	>>> Finished "Compute fast metrics" in 32.2603 secs
2025-03-13 15:39:05,169 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4417 secs
2025-03-13 15:39:05,169 [INFO]: {
2025-03-13 15:39:05,169 [INFO]: 	index_key: HNSW15
2025-03-13 15:39:05,169 [INFO]: 	index_param: efSearch=189
2025-03-13 15:39:05,169 [INFO]: 	index_path: knn.index
2025-03-13 15:39:05,169 [INFO]: 	size in bytes: 671683630
2025-03-13 15:39:05,169 [INFO]: 	avg_search_speed_ms: 8.371287228531793
2025-03-13 15:39:05,169 [INFO]: 	99p_search_speed_ms: 11.006980859674512
2025-03-13 15:39:05,169 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:39:05,169 [INFO]: 	nb vectors: 3414
2025-03-13 15:39:05,169 [INFO]: 	vectors dimension: 49152
2025-03-13 15:39:05,169 [INFO]: 	compression ratio: 0.9993093206693157
2025-03-13 15:39:05,169 [INFO]: }
2025-03-13 15:39:05,169 [INFO]: 	>>> Finished "Creating the index" in 78.4436 secs
2025-03-13 15:39:05,169 [INFO]: >>> Finished "Launching the whole pipeline" in 78.4739 secs
2025-03-13 15:39:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:39:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 70283 [episode count 8/20]
[retrieval_preprocessing] for episode 30891 [episode count 9/20], we have num_retrieval=np.int64(3352) num_query=np.int64(218)
2025-03-13 15:39:23,204 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:39:23,797 [INFO]: Launching the whole pipeline 03/13/2025, 15:39:23
2025-03-13 15:39:23,798 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:39:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.60it/s]
2025-03-13 15:39:23,823 [INFO]: There are 3352 embeddings of dim 49152
2025-03-13 15:39:23,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:39:23,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:39:23
2025-03-13 15:39:23,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:39:23,823 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 15:39:23,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:39:23,824 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:39:23,824 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:39:23
2025-03-13 15:39:23,824 [INFO]: 691.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:39:23,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:39:23,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:39:23
2025-03-13 15:39:23,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:39:23,824 [INFO]: 	Creating the index 03/13/2025, 15:39:23
2025-03-13 15:39:23,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:39:23
2025-03-13 15:39:23,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:39:23,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:39:23
2025-03-13 15:39:23,825 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:39:23,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.68it/s] 29%|██▊       | 4/14 [00:00<00:00, 19.97it/s] 57%|█████▋    | 8/14 [00:00<00:00, 27.86it/s] 93%|█████████▎| 13/14 [00:00<00:00, 34.23it/s]100%|██████████| 14/14 [00:03<00:00,  4.14it/s]
2025-03-13 15:39:27,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:39:27
2025-03-13 15:40:09,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1527 secs
2025-03-13 15:40:09,365 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 15:40:09,365 [INFO]: 	Compute fast metrics 03/13/2025, 15:40:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.38it/s]
2025-03-13 15:40:38,709 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3435 secs
2025-03-13 15:40:38,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8858 secs
2025-03-13 15:40:38,711 [INFO]: {
2025-03-13 15:40:38,711 [INFO]: 	index_key: HNSW15
2025-03-13 15:40:38,711 [INFO]: 	index_param: efSearch=123
2025-03-13 15:40:38,711 [INFO]: 	index_path: knn.index
2025-03-13 15:40:38,711 [INFO]: 	size in bytes: 659485570
2025-03-13 15:40:38,711 [INFO]: 	avg_search_speed_ms: 7.0053511658146945
2025-03-13 15:40:38,711 [INFO]: 	99p_search_speed_ms: 10.211575157009067
2025-03-13 15:40:38,711 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:40:38,711 [INFO]: 	nb vectors: 3352
2025-03-13 15:40:38,711 [INFO]: 	vectors dimension: 49152
2025-03-13 15:40:38,711 [INFO]: 	compression ratio: 0.999309228251954
2025-03-13 15:40:38,711 [INFO]: }
2025-03-13 15:40:38,711 [INFO]: 	>>> Finished "Creating the index" in 74.8874 secs
2025-03-13 15:40:38,711 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9137 secs
2025-03-13 15:40:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:40:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 30891 [episode count 9/20]
[retrieval_preprocessing] for episode 22701 [episode count 10/20], we have num_retrieval=np.int64(3459) num_query=np.int64(111)
2025-03-13 15:40:40,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:40:41,266 [INFO]: Launching the whole pipeline 03/13/2025, 15:40:41
2025-03-13 15:40:41,266 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:40:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1326.89it/s]
2025-03-13 15:40:41,297 [INFO]: There are 3459 embeddings of dim 49152
2025-03-13 15:40:41,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 15:40:41,297 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:40:41
2025-03-13 15:40:41,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:40:41,298 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:40:41,298 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:40:41,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:40:41,298 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:40:41
2025-03-13 15:40:41,299 [INFO]: 713.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:40:41,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:40:41,299 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:40:41
2025-03-13 15:40:41,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:40:41,299 [INFO]: 	Creating the index 03/13/2025, 15:40:41
2025-03-13 15:40:41,300 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:40:41
2025-03-13 15:40:41,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 15:40:41,303 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:40:41
2025-03-13 15:40:41,303 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:40:41,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.68it/s] 50%|█████     | 7/14 [00:00<00:00, 32.19it/s] 86%|████████▌ | 12/14 [00:00<00:00, 36.56it/s]100%|██████████| 14/14 [00:02<00:00,  4.87it/s]
2025-03-13 15:40:44,185 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:40:44
2025-03-13 15:41:30,067 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8813 secs
2025-03-13 15:41:30,067 [INFO]: The best hyperparameters are: efSearch=141
2025-03-13 15:41:30,067 [INFO]: 	Compute fast metrics 03/13/2025, 15:41:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  5.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-13 15:41:59,175 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1078 secs
2025-03-13 15:41:59,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.8752 secs
2025-03-13 15:41:59,178 [INFO]: {
2025-03-13 15:41:59,178 [INFO]: 	index_key: HNSW15
2025-03-13 15:41:59,178 [INFO]: 	index_param: efSearch=141
2025-03-13 15:41:59,178 [INFO]: 	index_path: knn.index
2025-03-13 15:41:59,179 [INFO]: 	size in bytes: 680537050
2025-03-13 15:41:59,179 [INFO]: 	avg_search_speed_ms: 7.235599227361489
2025-03-13 15:41:59,179 [INFO]: 	99p_search_speed_ms: 9.610117196571082
2025-03-13 15:41:59,179 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:41:59,179 [INFO]: 	nb vectors: 3459
2025-03-13 15:41:59,179 [INFO]: 	vectors dimension: 49152
2025-03-13 15:41:59,179 [INFO]: 	compression ratio: 0.9993094013029856
2025-03-13 15:41:59,179 [INFO]: }
2025-03-13 15:41:59,179 [INFO]: 	>>> Finished "Creating the index" in 77.8791 secs
2025-03-13 15:41:59,179 [INFO]: >>> Finished "Launching the whole pipeline" in 77.9123 secs
2025-03-13 15:42:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:42:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 22701 [episode count 10/20]
[retrieval_preprocessing] for episode 57016 [episode count 11/20], we have num_retrieval=np.int64(3469) num_query=np.int64(101)
2025-03-13 15:42:00,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:42:01,698 [INFO]: Launching the whole pipeline 03/13/2025, 15:42:01
2025-03-13 15:42:01,698 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:42:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 746.85it/s]
2025-03-13 15:42:01,730 [INFO]: There are 3469 embeddings of dim 49152
2025-03-13 15:42:01,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 15:42:01,731 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:42:01
2025-03-13 15:42:01,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:42:01,731 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:42:01,731 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:42:01,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 15:42:01,731 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:42:01
2025-03-13 15:42:01,732 [INFO]: 715.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:42:01,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:42:01,732 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:42:01
2025-03-13 15:42:01,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:42:01,732 [INFO]: 	Creating the index 03/13/2025, 15:42:01
2025-03-13 15:42:01,732 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:42:01
2025-03-13 15:42:01,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 15:42:01,736 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:42:01
2025-03-13 15:42:01,736 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:42:01,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.20it/s] 29%|██▊       | 4/14 [00:00<00:00, 20.90it/s] 57%|█████▋    | 8/14 [00:00<00:00, 26.69it/s] 79%|███████▊  | 11/14 [00:00<00:00, 27.89it/s]100%|██████████| 14/14 [00:03<00:00,  2.33it/s]100%|██████████| 14/14 [00:03<00:00,  3.67it/s]
2025-03-13 15:42:05,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:42:05
2025-03-13 15:42:49,737 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1768 secs
2025-03-13 15:42:49,737 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 15:42:49,737 [INFO]: 	Compute fast metrics 03/13/2025, 15:42:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-13 15:43:16,810 [INFO]: 	>>> Finished "Compute fast metrics" in 27.0730 secs
2025-03-13 15:43:16,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0767 secs
2025-03-13 15:43:16,813 [INFO]: {
2025-03-13 15:43:16,813 [INFO]: 	index_key: HNSW15
2025-03-13 15:43:16,813 [INFO]: 	index_param: efSearch=231
2025-03-13 15:43:16,813 [INFO]: 	index_path: knn.index
2025-03-13 15:43:16,813 [INFO]: 	size in bytes: 682504450
2025-03-13 15:43:16,813 [INFO]: 	avg_search_speed_ms: 11.123475839836612
2025-03-13 15:43:16,813 [INFO]: 	99p_search_speed_ms: 17.267448385246098
2025-03-13 15:43:16,813 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:43:16,813 [INFO]: 	nb vectors: 3469
2025-03-13 15:43:16,813 [INFO]: 	vectors dimension: 49152
2025-03-13 15:43:16,813 [INFO]: 	compression ratio: 0.9993094579822887
2025-03-13 15:43:16,813 [INFO]: }
2025-03-13 15:43:16,813 [INFO]: 	>>> Finished "Creating the index" in 75.0805 secs
2025-03-13 15:43:16,813 [INFO]: >>> Finished "Launching the whole pipeline" in 75.1150 secs
2025-03-13 15:43:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:43:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 57016 [episode count 11/20]
[retrieval_preprocessing] for episode 79054 [episode count 12/20], we have num_retrieval=np.int64(3476) num_query=np.int64(94)
2025-03-13 15:43:18,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:43:18,975 [INFO]: Launching the whole pipeline 03/13/2025, 15:43:18
2025-03-13 15:43:18,975 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:43:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1775.74it/s]
2025-03-13 15:43:18,998 [INFO]: There are 3476 embeddings of dim 49152
2025-03-13 15:43:18,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 15:43:18,998 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:43:18
2025-03-13 15:43:18,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:43:18,999 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:43:18,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:43:18,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:43:18,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:43:18
2025-03-13 15:43:18,999 [INFO]: 717.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:43:18,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:43:18,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:43:18
2025-03-13 15:43:18,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:43:19,000 [INFO]: 	Creating the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:43:19
2025-03-13 15:43:19,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:43:19,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:43:19
2025-03-13 15:43:19,001 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:43:19,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.35it/s] 36%|███▌      | 5/14 [00:00<00:00, 26.67it/s] 71%|███████▏  | 10/14 [00:00<00:00, 33.72it/s]100%|██████████| 14/14 [00:03<00:00,  3.43it/s]100%|██████████| 14/14 [00:03<00:00,  4.63it/s]
2025-03-13 15:43:22,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:43:22
2025-03-13 15:44:01,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6507 secs
2025-03-13 15:44:01,679 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 15:44:01,679 [INFO]: 	Compute fast metrics 03/13/2025, 15:44:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 15:44:28,671 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9917 secs
2025-03-13 15:44:28,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6732 secs
2025-03-13 15:44:28,675 [INFO]: {
2025-03-13 15:44:28,675 [INFO]: 	index_key: HNSW15
2025-03-13 15:44:28,675 [INFO]: 	index_param: efSearch=212
2025-03-13 15:44:28,675 [INFO]: 	index_path: knn.index
2025-03-13 15:44:28,675 [INFO]: 	size in bytes: 683881690
2025-03-13 15:44:28,675 [INFO]: 	avg_search_speed_ms: 10.351176779306499
2025-03-13 15:44:28,675 [INFO]: 	99p_search_speed_ms: 15.21446477854625
2025-03-13 15:44:28,675 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:44:28,675 [INFO]: 	nb vectors: 3476
2025-03-13 15:44:28,675 [INFO]: 	vectors dimension: 49152
2025-03-13 15:44:28,675 [INFO]: 	compression ratio: 0.9993094097898717
2025-03-13 15:44:28,675 [INFO]: }
2025-03-13 15:44:28,675 [INFO]: 	>>> Finished "Creating the index" in 69.6751 secs
2025-03-13 15:44:28,675 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6999 secs
2025-03-13 15:44:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:44:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 79054 [episode count 12/20]
[retrieval_preprocessing] for episode 94935 [episode count 13/20], we have num_retrieval=np.int64(3436) num_query=np.int64(134)
2025-03-13 15:44:30,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:44:30,893 [INFO]: Launching the whole pipeline 03/13/2025, 15:44:30
2025-03-13 15:44:30,893 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:44:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 755.46it/s]
2025-03-13 15:44:30,919 [INFO]: There are 3436 embeddings of dim 49152
2025-03-13 15:44:30,920 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:44:30,920 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:44:30
2025-03-13 15:44:30,920 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:44:30,920 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:44:30,920 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:44:30,920 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:44:30,920 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:44:30
2025-03-13 15:44:30,920 [INFO]: 709.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:44:30,920 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:44:30,920 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:44:30
2025-03-13 15:44:30,920 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:44:30,920 [INFO]: 	Creating the index 03/13/2025, 15:44:30
2025-03-13 15:44:30,920 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:44:30
2025-03-13 15:44:30,921 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 15:44:30,922 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:44:30
2025-03-13 15:44:30,922 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:44:30,922 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.42it/s] 29%|██▊       | 4/14 [00:00<00:00, 18.73it/s] 57%|█████▋    | 8/14 [00:00<00:00, 27.11it/s] 93%|█████████▎| 13/14 [00:00<00:00, 32.72it/s]100%|██████████| 14/14 [00:03<00:00,  4.37it/s]
2025-03-13 15:44:34,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:44:34
2025-03-13 15:45:09,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1322 secs
2025-03-13 15:45:09,263 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 15:45:09,264 [INFO]: 	Compute fast metrics 03/13/2025, 15:45:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.42it/s]
2025-03-13 15:45:37,301 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0370 secs
2025-03-13 15:45:37,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3814 secs
2025-03-13 15:45:37,303 [INFO]: {
2025-03-13 15:45:37,303 [INFO]: 	index_key: HNSW15
2025-03-13 15:45:37,303 [INFO]: 	index_param: efSearch=242
2025-03-13 15:45:37,303 [INFO]: 	index_path: knn.index
2025-03-13 15:45:37,303 [INFO]: 	size in bytes: 676011910
2025-03-13 15:45:37,303 [INFO]: 	avg_search_speed_ms: 12.040158082304071
2025-03-13 15:45:37,303 [INFO]: 	99p_search_speed_ms: 17.417978495359428
2025-03-13 15:45:37,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:45:37,303 [INFO]: 	nb vectors: 3436
2025-03-13 15:45:37,303 [INFO]: 	vectors dimension: 49152
2025-03-13 15:45:37,303 [INFO]: 	compression ratio: 0.999309447077641
2025-03-13 15:45:37,303 [INFO]: }
2025-03-13 15:45:37,303 [INFO]: 	>>> Finished "Creating the index" in 66.3832 secs
2025-03-13 15:45:37,303 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4103 secs
2025-03-13 15:45:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:45:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 94935 [episode count 13/20]
[retrieval_preprocessing] for episode 77100 [episode count 14/20], we have num_retrieval=np.int64(3448) num_query=np.int64(122)
2025-03-13 15:45:39,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:45:39,620 [INFO]: Launching the whole pipeline 03/13/2025, 15:45:39
2025-03-13 15:45:39,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:45:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.12it/s]
2025-03-13 15:45:39,649 [INFO]: There are 3448 embeddings of dim 49152
2025-03-13 15:45:39,649 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 15:45:39,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:45:39,650 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:45:39,650 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:45:39,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 15:45:39,650 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,651 [INFO]: 711.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:45:39,651 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 15:45:39,651 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:45:39
2025-03-13 15:45:39,651 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:45:39,651 [INFO]: 	Creating the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:45:39
2025-03-13 15:45:39,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 15:45:39,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:45:39
2025-03-13 15:45:39,656 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:45:39,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.52it/s] 50%|█████     | 7/14 [00:00<00:00, 33.58it/s] 86%|████████▌ | 12/14 [00:00<00:00, 38.55it/s]100%|██████████| 14/14 [00:03<00:00,  3.88it/s]
2025-03-13 15:45:43,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:45:43
2025-03-13 15:46:27,124 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4689 secs
2025-03-13 15:46:27,125 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 15:46:27,125 [INFO]: 	Compute fast metrics 03/13/2025, 15:46:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.00it/s]
2025-03-13 15:46:48,390 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2645 secs
2025-03-13 15:46:48,392 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7368 secs
2025-03-13 15:46:48,393 [INFO]: {
2025-03-13 15:46:48,393 [INFO]: 	index_key: HNSW15
2025-03-13 15:46:48,393 [INFO]: 	index_param: efSearch=126
2025-03-13 15:46:48,393 [INFO]: 	index_path: knn.index
2025-03-13 15:46:48,393 [INFO]: 	size in bytes: 678372910
2025-03-13 15:46:48,393 [INFO]: 	avg_search_speed_ms: 7.739451089253989
2025-03-13 15:46:48,393 [INFO]: 	99p_search_speed_ms: 11.011668613646172
2025-03-13 15:46:48,393 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:46:48,393 [INFO]: 	nb vectors: 3448
2025-03-13 15:46:48,393 [INFO]: 	vectors dimension: 49152
2025-03-13 15:46:48,393 [INFO]: 	compression ratio: 0.9993093385760349
2025-03-13 15:46:48,393 [INFO]: }
2025-03-13 15:46:48,393 [INFO]: 	>>> Finished "Creating the index" in 68.7411 secs
2025-03-13 15:46:48,393 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7726 secs
2025-03-13 15:46:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:46:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 77100 [episode count 14/20]
[retrieval_preprocessing] for episode 50536 [episode count 15/20], we have num_retrieval=np.int64(2779) num_query=np.int64(791)
2025-03-13 15:46:49,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:46:50,183 [INFO]: Launching the whole pipeline 03/13/2025, 15:46:50
2025-03-13 15:46:50,183 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:46:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.46it/s]
2025-03-13 15:46:50,212 [INFO]: There are 2779 embeddings of dim 49152
2025-03-13 15:46:50,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 15:46:50,212 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:46:50
2025-03-13 15:46:50,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:46:50,212 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:46:50,212 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:46:50,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:46:50,212 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:46:50
2025-03-13 15:46:50,212 [INFO]: 573.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:46:50,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:46:50,212 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:46:50
2025-03-13 15:46:50,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:46:50,213 [INFO]: 	Creating the index 03/13/2025, 15:46:50
2025-03-13 15:46:50,213 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:46:50
2025-03-13 15:46:50,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:46:50,214 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:46:50
2025-03-13 15:46:50,214 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:46:50,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.57it/s] 73%|███████▎  | 8/11 [00:00<00:00, 36.22it/s]100%|██████████| 11/11 [00:02<00:00,  5.29it/s]
2025-03-13 15:46:52,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:46:52
2025-03-13 15:47:29,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8673 secs
2025-03-13 15:47:29,165 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 15:47:29,165 [INFO]: 	Compute fast metrics 03/13/2025, 15:47:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-13 15:47:55,136 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9713 secs
2025-03-13 15:47:55,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9248 secs
2025-03-13 15:47:55,139 [INFO]: {
2025-03-13 15:47:55,139 [INFO]: 	index_key: HNSW15
2025-03-13 15:47:55,139 [INFO]: 	index_param: efSearch=190
2025-03-13 15:47:55,139 [INFO]: 	index_path: knn.index
2025-03-13 15:47:55,139 [INFO]: 	size in bytes: 546750970
2025-03-13 15:47:55,139 [INFO]: 	avg_search_speed_ms: 10.955127720136566
2025-03-13 15:47:55,139 [INFO]: 	99p_search_speed_ms: 19.756329264491796
2025-03-13 15:47:55,139 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:47:55,139 [INFO]: 	nb vectors: 2779
2025-03-13 15:47:55,139 [INFO]: 	vectors dimension: 49152
2025-03-13 15:47:55,139 [INFO]: 	compression ratio: 0.9993098539907483
2025-03-13 15:47:55,139 [INFO]: }
2025-03-13 15:47:55,139 [INFO]: 	>>> Finished "Creating the index" in 64.9265 secs
2025-03-13 15:47:55,139 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9564 secs
2025-03-13 15:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:48:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 50536 [episode count 15/20]
[retrieval_preprocessing] for episode 9083 [episode count 16/20], we have num_retrieval=np.int64(3453) num_query=np.int64(117)
2025-03-13 15:48:03,016 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:48:03,532 [INFO]: Launching the whole pipeline 03/13/2025, 15:48:03
2025-03-13 15:48:03,533 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:48:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.99it/s]
2025-03-13 15:48:03,560 [INFO]: There are 3453 embeddings of dim 49152
2025-03-13 15:48:03,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 15:48:03,560 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:48:03
2025-03-13 15:48:03,560 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:48:03,560 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:48:03,560 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:48:03,560 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:48:03,560 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:48:03
2025-03-13 15:48:03,561 [INFO]: 712.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:48:03,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:48:03,561 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:48:03
2025-03-13 15:48:03,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:48:03,561 [INFO]: 	Creating the index 03/13/2025, 15:48:03
2025-03-13 15:48:03,561 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:48:03
2025-03-13 15:48:03,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:48:03,562 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:48:03
2025-03-13 15:48:03,562 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:48:03,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.75it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.99it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.84it/s]100%|██████████| 14/14 [00:02<00:00,  4.94it/s]
2025-03-13 15:48:06,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:48:06
2025-03-13 15:48:42,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1233 secs
2025-03-13 15:48:42,523 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 15:48:42,523 [INFO]: 	Compute fast metrics 03/13/2025, 15:48:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.31it/s]
2025-03-13 15:49:11,500 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9766 secs
2025-03-13 15:49:11,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9405 secs
2025-03-13 15:49:11,503 [INFO]: {
2025-03-13 15:49:11,503 [INFO]: 	index_key: HNSW15
2025-03-13 15:49:11,503 [INFO]: 	index_param: efSearch=159
2025-03-13 15:49:11,503 [INFO]: 	index_path: knn.index
2025-03-13 15:49:11,503 [INFO]: 	size in bytes: 679356610
2025-03-13 15:49:11,503 [INFO]: 	avg_search_speed_ms: 8.827327910912636
2025-03-13 15:49:11,503 [INFO]: 	99p_search_speed_ms: 11.341542769223452
2025-03-13 15:49:11,503 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:49:11,503 [INFO]: 	nb vectors: 3453
2025-03-13 15:49:11,503 [INFO]: 	vectors dimension: 49152
2025-03-13 15:49:11,503 [INFO]: 	compression ratio: 0.9993093671378277
2025-03-13 15:49:11,503 [INFO]: }
2025-03-13 15:49:11,503 [INFO]: 	>>> Finished "Creating the index" in 67.9422 secs
2025-03-13 15:49:11,503 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9705 secs
2025-03-13 15:49:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:49:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 9083 [episode count 16/20]
[retrieval_preprocessing] for episode 29564 [episode count 17/20], we have num_retrieval=np.int64(3454) num_query=np.int64(116)
2025-03-13 15:49:12,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:49:13,690 [INFO]: Launching the whole pipeline 03/13/2025, 15:49:13
2025-03-13 15:49:13,690 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2100.30it/s]
2025-03-13 15:49:13,711 [INFO]: There are 3454 embeddings of dim 49152
2025-03-13 15:49:13,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0209 secs
2025-03-13 15:49:13,711 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:49:13,712 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:49:13,712 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:49:13,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:49:13,712 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,712 [INFO]: 712.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:49:13,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:49:13,712 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:49:13
2025-03-13 15:49:13,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:49:13,712 [INFO]: 	Creating the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,713 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:49:13
2025-03-13 15:49:13,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 15:49:13,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:49:13
2025-03-13 15:49:13,714 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:49:13,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.72it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.24it/s] 71%|███████▏  | 10/14 [00:00<00:00, 32.57it/s]100%|██████████| 14/14 [00:04<00:00,  2.17it/s]100%|██████████| 14/14 [00:04<00:00,  3.10it/s]
2025-03-13 15:49:18,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:49:18
2025-03-13 15:49:55,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2551 secs
2025-03-13 15:49:55,497 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 15:49:55,497 [INFO]: 	Compute fast metrics 03/13/2025, 15:49:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.13it/s]
2025-03-13 15:50:24,639 [INFO]: 	>>> Finished "Compute fast metrics" in 29.1415 secs
2025-03-13 15:50:24,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0612 secs
2025-03-13 15:50:24,776 [INFO]: {
2025-03-13 15:50:24,776 [INFO]: 	index_key: HNSW15
2025-03-13 15:50:24,776 [INFO]: 	index_param: efSearch=214
2025-03-13 15:50:24,776 [INFO]: 	index_path: knn.index
2025-03-13 15:50:24,776 [INFO]: 	size in bytes: 679553350
2025-03-13 15:50:24,776 [INFO]: 	avg_search_speed_ms: 11.4120173945249
2025-03-13 15:50:24,776 [INFO]: 	99p_search_speed_ms: 20.13205928960815
2025-03-13 15:50:24,777 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:50:24,777 [INFO]: 	nb vectors: 3454
2025-03-13 15:50:24,777 [INFO]: 	vectors dimension: 49152
2025-03-13 15:50:24,777 [INFO]: 	compression ratio: 0.9993093728402633
2025-03-13 15:50:24,777 [INFO]: }
2025-03-13 15:50:24,777 [INFO]: 	>>> Finished "Creating the index" in 71.0643 secs
2025-03-13 15:50:24,777 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0865 secs
2025-03-13 15:50:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:50:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 29564 [episode count 17/20]
[retrieval_preprocessing] for episode 72090 [episode count 18/20], we have num_retrieval=np.int64(3482) num_query=np.int64(88)
2025-03-13 15:50:26,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:50:27,377 [INFO]: Launching the whole pipeline 03/13/2025, 15:50:27
2025-03-13 15:50:27,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:50:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 15:50:27,403 [INFO]: There are 3482 embeddings of dim 49152
2025-03-13 15:50:27,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 15:50:27,404 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:50:27
2025-03-13 15:50:27,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:50:27,404 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:50:27,404 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:50:27,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:50:27,404 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:50:27
2025-03-13 15:50:27,404 [INFO]: 718.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:50:27,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:50:27,404 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:50:27
2025-03-13 15:50:27,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:50:27,404 [INFO]: 	Creating the index 03/13/2025, 15:50:27
2025-03-13 15:50:27,404 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:50:27
2025-03-13 15:50:27,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:50:27,405 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:50:27
2025-03-13 15:50:27,405 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:50:27,406 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.75it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.64it/s] 79%|███████▊  | 11/14 [00:00<00:00, 36.48it/s]100%|██████████| 14/14 [00:03<00:00,  4.06it/s]
2025-03-13 15:50:30,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:50:30
2025-03-13 15:51:12,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8337 secs
2025-03-13 15:51:12,692 [INFO]: The best hyperparameters are: efSearch=98
2025-03-13 15:51:12,692 [INFO]: 	Compute fast metrics 03/13/2025, 15:51:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.07it/s]
2025-03-13 15:51:43,516 [INFO]: 	>>> Finished "Compute fast metrics" in 30.8236 secs
2025-03-13 15:51:43,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1131 secs
2025-03-13 15:51:43,519 [INFO]: {
2025-03-13 15:51:43,519 [INFO]: 	index_key: HNSW15
2025-03-13 15:51:43,519 [INFO]: 	index_param: efSearch=98
2025-03-13 15:51:43,519 [INFO]: 	index_path: knn.index
2025-03-13 15:51:43,519 [INFO]: 	size in bytes: 685062130
2025-03-13 15:51:43,519 [INFO]: 	avg_search_speed_ms: 6.445242736463361
2025-03-13 15:51:43,519 [INFO]: 	99p_search_speed_ms: 11.124516022391617
2025-03-13 15:51:43,519 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:51:43,519 [INFO]: 	nb vectors: 3482
2025-03-13 15:51:43,519 [INFO]: 	vectors dimension: 49152
2025-03-13 15:51:43,519 [INFO]: 	compression ratio: 0.9993094436558623
2025-03-13 15:51:43,519 [INFO]: }
2025-03-13 15:51:43,519 [INFO]: 	>>> Finished "Creating the index" in 76.1146 secs
2025-03-13 15:51:43,519 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1423 secs
2025-03-13 15:51:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:51:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 72090 [episode count 18/20]
[retrieval_preprocessing] for episode 24492 [episode count 19/20], we have num_retrieval=np.int64(3418) num_query=np.int64(152)
2025-03-13 15:51:44,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:51:44,939 [INFO]: Launching the whole pipeline 03/13/2025, 15:51:44
2025-03-13 15:51:44,939 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:51:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.56it/s]
2025-03-13 15:51:44,966 [INFO]: There are 3418 embeddings of dim 49152
2025-03-13 15:51:44,967 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 15:51:44,967 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:51:44
2025-03-13 15:51:44,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:51:44,967 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 15:51:44,967 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:51:44,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:51:44,967 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:51:44
2025-03-13 15:51:44,967 [INFO]: 705.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:51:44,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:51:44,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:51:44
2025-03-13 15:51:44,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:51:44,967 [INFO]: 	Creating the index 03/13/2025, 15:51:44
2025-03-13 15:51:44,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:51:44
2025-03-13 15:51:44,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:51:44,969 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:51:44
2025-03-13 15:51:44,969 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 15:51:44,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.85it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.05it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.19it/s]100%|██████████| 14/14 [00:03<00:00,  4.15it/s]
2025-03-13 15:51:48,344 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:51:48
2025-03-13 15:52:29,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9856 secs
2025-03-13 15:52:29,330 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 15:52:29,330 [INFO]: 	Compute fast metrics 03/13/2025, 15:52:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.25it/s]
2025-03-13 15:52:55,236 [INFO]: 	>>> Finished "Compute fast metrics" in 25.9057 secs
2025-03-13 15:52:55,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2708 secs
2025-03-13 15:52:55,240 [INFO]: {
2025-03-13 15:52:55,240 [INFO]: 	index_key: HNSW15
2025-03-13 15:52:55,240 [INFO]: 	index_param: efSearch=193
2025-03-13 15:52:55,240 [INFO]: 	index_path: knn.index
2025-03-13 15:52:55,240 [INFO]: 	size in bytes: 672470590
2025-03-13 15:52:55,240 [INFO]: 	avg_search_speed_ms: 10.610193715352775
2025-03-13 15:52:55,240 [INFO]: 	99p_search_speed_ms: 14.267756803892555
2025-03-13 15:52:55,240 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:52:55,240 [INFO]: 	nb vectors: 3418
2025-03-13 15:52:55,240 [INFO]: 	vectors dimension: 49152
2025-03-13 15:52:55,240 [INFO]: 	compression ratio: 0.9993093437736809
2025-03-13 15:52:55,240 [INFO]: }
2025-03-13 15:52:55,240 [INFO]: 	>>> Finished "Creating the index" in 70.2725 secs
2025-03-13 15:52:55,240 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3010 secs
2025-03-13 15:52:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:52:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 24492 [episode count 19/20]
2025-03-13 15:52:56: [retrieval_preprocessing] finished for 2939999281_open_tap [chosen_id count 1/196]
2025-03-13 15:52:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 2939999281_close_tap [chosen_id count 2/196]
2025-03-13 15:52:58: [retrieval_preprocessing] we have num_total=2778 embedding_dim=49152
[retrieval_preprocessing] for episode 33288 [episode count 0/20], we have num_retrieval=np.int64(2660) num_query=np.int64(118)
2025-03-13 15:52:58,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:52:59,374 [INFO]: Launching the whole pipeline 03/13/2025, 15:52:59
2025-03-13 15:52:59,375 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:52:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 764.69it/s]
2025-03-13 15:52:59,400 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 15:52:59,400 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 15:52:59,401 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,401 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:52:59,401 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:52:59,401 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:52:59,401 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 15:52:59,401 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,401 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:52:59,401 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 15:52:59,401 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:52:59
2025-03-13 15:52:59,401 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:52:59,401 [INFO]: 	Creating the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,402 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:52:59
2025-03-13 15:52:59,403 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 15:52:59,404 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:52:59
2025-03-13 15:52:59,404 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:52:59,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.80it/s] 36%|███▋      | 4/11 [00:00<00:00, 15.02it/s] 55%|█████▍    | 6/11 [00:00<00:00, 16.81it/s] 91%|█████████ | 10/11 [00:00<00:00, 22.30it/s]100%|██████████| 11/11 [00:03<00:00,  3.66it/s]
2025-03-13 15:53:02,418 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:53:02
2025-03-13 15:53:51,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6179 secs
2025-03-13 15:53:51,037 [INFO]: The best hyperparameters are: efSearch=182
2025-03-13 15:53:51,037 [INFO]: 	Compute fast metrics 03/13/2025, 15:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.62it/s]
2025-03-13 15:54:15,703 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6665 secs
2025-03-13 15:54:15,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3015 secs
2025-03-13 15:54:15,706 [INFO]: {
2025-03-13 15:54:15,706 [INFO]: 	index_key: HNSW15
2025-03-13 15:54:15,706 [INFO]: 	index_param: efSearch=182
2025-03-13 15:54:15,706 [INFO]: 	index_path: knn.index
2025-03-13 15:54:15,706 [INFO]: 	size in bytes: 523338610
2025-03-13 15:54:15,706 [INFO]: 	avg_search_speed_ms: 10.568670135475774
2025-03-13 15:54:15,706 [INFO]: 	99p_search_speed_ms: 21.408833994064477
2025-03-13 15:54:15,706 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:54:15,706 [INFO]: 	nb vectors: 2660
2025-03-13 15:54:15,706 [INFO]: 	vectors dimension: 49152
2025-03-13 15:54:15,706 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 15:54:15,706 [INFO]: }
2025-03-13 15:54:15,706 [INFO]: 	>>> Finished "Creating the index" in 76.3042 secs
2025-03-13 15:54:15,706 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3310 secs
2025-03-13 15:54:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:54:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 33288 [episode count 0/20]
[retrieval_preprocessing] for episode 13838 [episode count 1/20], we have num_retrieval=np.int64(2646) num_query=np.int64(132)
2025-03-13 15:54:18,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:54:19,140 [INFO]: Launching the whole pipeline 03/13/2025, 15:54:19
2025-03-13 15:54:19,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:54:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-13 15:54:19,166 [INFO]: There are 2646 embeddings of dim 49152
2025-03-13 15:54:19,166 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 15:54:19,166 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:54:19
2025-03-13 15:54:19,166 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:54:19,166 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:54:19,166 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:54:19,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:54:19,166 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:54:19
2025-03-13 15:54:19,167 [INFO]: 546.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:54:19,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:54:19,167 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:54:19
2025-03-13 15:54:19,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:54:19,167 [INFO]: 	Creating the index 03/13/2025, 15:54:19
2025-03-13 15:54:19,167 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:54:19
2025-03-13 15:54:19,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 15:54:19,168 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:54:19
2025-03-13 15:54:19,168 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:54:19,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.96it/s] 55%|█████▍    | 6/11 [00:00<00:00, 24.57it/s] 91%|█████████ | 10/11 [00:00<00:00, 29.56it/s]100%|██████████| 11/11 [00:02<00:00,  4.75it/s]
2025-03-13 15:54:21,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:54:21
2025-03-13 15:55:02,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8646 secs
2025-03-13 15:55:02,689 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 15:55:02,689 [INFO]: 	Compute fast metrics 03/13/2025, 15:55:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.74it/s]
2025-03-13 15:55:28,829 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1398 secs
2025-03-13 15:55:28,832 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6640 secs
2025-03-13 15:55:28,832 [INFO]: {
2025-03-13 15:55:28,832 [INFO]: 	index_key: HNSW15
2025-03-13 15:55:28,832 [INFO]: 	index_param: efSearch=145
2025-03-13 15:55:28,832 [INFO]: 	index_path: knn.index
2025-03-13 15:55:28,832 [INFO]: 	size in bytes: 520584250
2025-03-13 15:55:28,832 [INFO]: 	avg_search_speed_ms: 8.51135455171003
2025-03-13 15:55:28,832 [INFO]: 	99p_search_speed_ms: 13.011373803019522
2025-03-13 15:55:28,832 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:55:28,832 [INFO]: 	nb vectors: 2646
2025-03-13 15:55:28,832 [INFO]: 	vectors dimension: 49152
2025-03-13 15:55:28,832 [INFO]: 	compression ratio: 0.9993094643182155
2025-03-13 15:55:28,832 [INFO]: }
2025-03-13 15:55:28,832 [INFO]: 	>>> Finished "Creating the index" in 69.6656 secs
2025-03-13 15:55:28,832 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6917 secs
2025-03-13 15:55:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:55:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 13838 [episode count 1/20]
[retrieval_preprocessing] for episode 34347 [episode count 2/20], we have num_retrieval=np.int64(2662) num_query=np.int64(116)
2025-03-13 15:55:30,073 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:55:30,488 [INFO]: Launching the whole pipeline 03/13/2025, 15:55:30
2025-03-13 15:55:30,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:55:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-13 15:55:30,516 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 15:55:30,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 15:55:30,516 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:55:30,516 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:55:30,516 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:55:30,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:55:30,516 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,516 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:55:30,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:55:30,516 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:55:30
2025-03-13 15:55:30,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:55:30,516 [INFO]: 	Creating the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,516 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:55:30
2025-03-13 15:55:30,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:55:30,517 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:55:30
2025-03-13 15:55:30,517 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:55:30,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.54it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.39it/s]100%|██████████| 11/11 [00:02<00:00,  3.36it/s]100%|██████████| 11/11 [00:02<00:00,  3.95it/s]
2025-03-13 15:55:33,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:55:33
2025-03-13 15:56:14,259 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9538 secs
2025-03-13 15:56:14,259 [INFO]: The best hyperparameters are: efSearch=114
2025-03-13 15:56:14,259 [INFO]: 	Compute fast metrics 03/13/2025, 15:56:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 15:56:35,337 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0776 secs
2025-03-13 15:56:35,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8222 secs
2025-03-13 15:56:35,340 [INFO]: {
2025-03-13 15:56:35,340 [INFO]: 	index_key: HNSW15
2025-03-13 15:56:35,340 [INFO]: 	index_param: efSearch=114
2025-03-13 15:56:35,340 [INFO]: 	index_path: knn.index
2025-03-13 15:56:35,340 [INFO]: 	size in bytes: 523732090
2025-03-13 15:56:35,340 [INFO]: 	avg_search_speed_ms: 9.634069444320966
2025-03-13 15:56:35,340 [INFO]: 	99p_search_speed_ms: 15.97592170583082
2025-03-13 15:56:35,340 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:56:35,340 [INFO]: 	nb vectors: 2662
2025-03-13 15:56:35,340 [INFO]: 	vectors dimension: 49152
2025-03-13 15:56:35,340 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 15:56:35,340 [INFO]: }
2025-03-13 15:56:35,340 [INFO]: 	>>> Finished "Creating the index" in 64.8242 secs
2025-03-13 15:56:35,341 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8528 secs
2025-03-13 15:56:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:56:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 34347 [episode count 2/20]
[retrieval_preprocessing] for episode 57933 [episode count 3/20], we have num_retrieval=np.int64(2651) num_query=np.int64(127)
2025-03-13 15:56:36,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:56:36,975 [INFO]: Launching the whole pipeline 03/13/2025, 15:56:36
2025-03-13 15:56:36,975 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:56:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.57it/s]
2025-03-13 15:56:37,001 [INFO]: There are 2651 embeddings of dim 49152
2025-03-13 15:56:37,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 15:56:37,002 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:56:37,002 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:56:37,002 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:56:37,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:56:37,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,002 [INFO]: 547.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:56:37,002 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:56:37,002 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:56:37
2025-03-13 15:56:37,002 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:56:37,002 [INFO]: 	Creating the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,002 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:56:37
2025-03-13 15:56:37,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 15:56:37,003 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:56:37
2025-03-13 15:56:37,003 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:56:37,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.59it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.65it/s]100%|██████████| 11/11 [00:02<00:00,  3.13it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]
2025-03-13 15:56:39,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:56:39
2025-03-13 15:57:19,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1062 secs
2025-03-13 15:57:19,922 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 15:57:19,922 [INFO]: 	Compute fast metrics 03/13/2025, 15:57:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.03it/s]
2025-03-13 15:57:36,847 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9246 secs
2025-03-13 15:57:36,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8459 secs
2025-03-13 15:57:36,849 [INFO]: {
2025-03-13 15:57:36,849 [INFO]: 	index_key: HNSW15
2025-03-13 15:57:36,849 [INFO]: 	index_param: efSearch=158
2025-03-13 15:57:36,849 [INFO]: 	index_path: knn.index
2025-03-13 15:57:36,849 [INFO]: 	size in bytes: 521567950
2025-03-13 15:57:36,849 [INFO]: 	avg_search_speed_ms: 9.924264672528286
2025-03-13 15:57:36,849 [INFO]: 	99p_search_speed_ms: 15.728227631188929
2025-03-13 15:57:36,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:57:36,849 [INFO]: 	nb vectors: 2651
2025-03-13 15:57:36,850 [INFO]: 	vectors dimension: 49152
2025-03-13 15:57:36,850 [INFO]: 	compression ratio: 0.9993095012835815
2025-03-13 15:57:36,850 [INFO]: }
2025-03-13 15:57:36,850 [INFO]: 	>>> Finished "Creating the index" in 59.8476 secs
2025-03-13 15:57:36,850 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8741 secs
2025-03-13 15:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:57:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 57933 [episode count 3/20]
[retrieval_preprocessing] for episode 48723 [episode count 4/20], we have num_retrieval=np.int64(2666) num_query=np.int64(112)
2025-03-13 15:57:38,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:57:38,579 [INFO]: Launching the whole pipeline 03/13/2025, 15:57:38
2025-03-13 15:57:38,579 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:57:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1317.31it/s]
2025-03-13 15:57:38,605 [INFO]: There are 2666 embeddings of dim 49152
2025-03-13 15:57:38,606 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 15:57:38,606 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:57:38
2025-03-13 15:57:38,606 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:57:38,606 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:57:38,606 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:57:38,606 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:57:38,606 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:57:38
2025-03-13 15:57:38,606 [INFO]: 550.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:57:38,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 15:57:38,606 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:57:38
2025-03-13 15:57:38,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:57:38,606 [INFO]: 	Creating the index 03/13/2025, 15:57:38
2025-03-13 15:57:38,606 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:57:38
2025-03-13 15:57:38,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 15:57:38,608 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:57:38
2025-03-13 15:57:38,608 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:57:38,608 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.42it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.02it/s] 91%|█████████ | 10/11 [00:00<00:00, 31.67it/s]100%|██████████| 11/11 [00:02<00:00,  4.58it/s]
2025-03-13 15:57:41,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:57:41
2025-03-13 15:58:11,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2689 secs
2025-03-13 15:58:11,283 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 15:58:11,283 [INFO]: 	Compute fast metrics 03/13/2025, 15:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-13 15:58:40,274 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9908 secs
2025-03-13 15:58:40,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6684 secs
2025-03-13 15:58:40,276 [INFO]: {
2025-03-13 15:58:40,276 [INFO]: 	index_key: HNSW15
2025-03-13 15:58:40,276 [INFO]: 	index_param: efSearch=210
2025-03-13 15:58:40,276 [INFO]: 	index_path: knn.index
2025-03-13 15:58:40,276 [INFO]: 	size in bytes: 524519050
2025-03-13 15:58:40,276 [INFO]: 	avg_search_speed_ms: 9.618049820598502
2025-03-13 15:58:40,276 [INFO]: 	99p_search_speed_ms: 13.562544183805562
2025-03-13 15:58:40,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:58:40,276 [INFO]: 	nb vectors: 2666
2025-03-13 15:58:40,276 [INFO]: 	vectors dimension: 49152
2025-03-13 15:58:40,276 [INFO]: 	compression ratio: 0.9993096113477671
2025-03-13 15:58:40,276 [INFO]: }
2025-03-13 15:58:40,276 [INFO]: 	>>> Finished "Creating the index" in 61.6701 secs
2025-03-13 15:58:40,276 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6971 secs
2025-03-13 15:58:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:58:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 48723 [episode count 4/20]
[retrieval_preprocessing] for episode 58460 [episode count 5/20], we have num_retrieval=np.int64(2664) num_query=np.int64(114)
2025-03-13 15:58:41,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:58:42,345 [INFO]: Launching the whole pipeline 03/13/2025, 15:58:42
2025-03-13 15:58:42,345 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:58:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-13 15:58:42,369 [INFO]: There are 2664 embeddings of dim 49152
2025-03-13 15:58:42,370 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 15:58:42,370 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:58:42
2025-03-13 15:58:42,370 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:58:42,370 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:58:42,370 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:58:42,370 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 15:58:42,370 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:58:42
2025-03-13 15:58:42,370 [INFO]: 549.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:58:42,370 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 15:58:42,370 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:58:42
2025-03-13 15:58:42,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:58:42,370 [INFO]: 	Creating the index 03/13/2025, 15:58:42
2025-03-13 15:58:42,370 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:58:42
2025-03-13 15:58:42,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 15:58:42,371 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:58:42
2025-03-13 15:58:42,371 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:58:42,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.67it/s]100%|██████████| 11/11 [00:01<00:00,  4.65it/s]100%|██████████| 11/11 [00:01<00:00,  5.74it/s]
2025-03-13 15:58:44,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:58:44
2025-03-13 15:59:17,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9726 secs
2025-03-13 15:59:17,261 [INFO]: The best hyperparameters are: efSearch=132
2025-03-13 15:59:17,261 [INFO]: 	Compute fast metrics 03/13/2025, 15:59:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-13 15:59:42,371 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1097 secs
2025-03-13 15:59:42,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0623 secs
2025-03-13 15:59:42,434 [INFO]: {
2025-03-13 15:59:42,434 [INFO]: 	index_key: HNSW15
2025-03-13 15:59:42,434 [INFO]: 	index_param: efSearch=132
2025-03-13 15:59:42,434 [INFO]: 	index_path: knn.index
2025-03-13 15:59:42,434 [INFO]: 	size in bytes: 524125570
2025-03-13 15:59:42,434 [INFO]: 	avg_search_speed_ms: 7.516091201590146
2025-03-13 15:59:42,434 [INFO]: 	99p_search_speed_ms: 12.549050827510657
2025-03-13 15:59:42,434 [INFO]: 	reconstruction error %: 0.0
2025-03-13 15:59:42,434 [INFO]: 	nb vectors: 2664
2025-03-13 15:59:42,434 [INFO]: 	vectors dimension: 49152
2025-03-13 15:59:42,434 [INFO]: 	compression ratio: 0.9993095967441543
2025-03-13 15:59:42,434 [INFO]: }
2025-03-13 15:59:42,435 [INFO]: 	>>> Finished "Creating the index" in 60.0644 secs
2025-03-13 15:59:42,435 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0893 secs
2025-03-13 15:59:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 15:59:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 58460 [episode count 5/20]
[retrieval_preprocessing] for episode 29288 [episode count 6/20], we have num_retrieval=np.int64(2679) num_query=np.int64(99)
2025-03-13 15:59:43,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 15:59:44,252 [INFO]: Launching the whole pipeline 03/13/2025, 15:59:44
2025-03-13 15:59:44,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 15:59:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 843.92it/s]
2025-03-13 15:59:44,283 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 15:59:44,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 15:59:44,284 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 15:59:44
2025-03-13 15:59:44,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 15:59:44,284 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 15:59:44,284 [INFO]: 		Total: 16.7 minutes
2025-03-13 15:59:44,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 15:59:44,284 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 15:59:44
2025-03-13 15:59:44,285 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 15:59:44,285 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 15:59:44,285 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 15:59:44
2025-03-13 15:59:44,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 15:59:44,285 [INFO]: 	Creating the index 03/13/2025, 15:59:44
2025-03-13 15:59:44,285 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 15:59:44
2025-03-13 15:59:44,289 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 15:59:44,289 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 15:59:44
2025-03-13 15:59:44,289 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 15:59:44,289 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.68it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.53it/s]100%|██████████| 11/11 [00:02<00:00,  3.53it/s]100%|██████████| 11/11 [00:02<00:00,  4.40it/s]
2025-03-13 15:59:46,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 15:59:46
2025-03-13 16:00:21,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7716 secs
2025-03-13 16:00:21,570 [INFO]: The best hyperparameters are: efSearch=107
2025-03-13 16:00:21,570 [INFO]: 	Compute fast metrics 03/13/2025, 16:00:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.11it/s]
2025-03-13 16:00:47,422 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8521 secs
2025-03-13 16:00:47,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1348 secs
2025-03-13 16:00:47,424 [INFO]: {
2025-03-13 16:00:47,424 [INFO]: 	index_key: HNSW15
2025-03-13 16:00:47,424 [INFO]: 	index_param: efSearch=107
2025-03-13 16:00:47,424 [INFO]: 	index_path: knn.index
2025-03-13 16:00:47,424 [INFO]: 	size in bytes: 527076670
2025-03-13 16:00:47,424 [INFO]: 	avg_search_speed_ms: 5.486393945870969
2025-03-13 16:00:47,424 [INFO]: 	99p_search_speed_ms: 7.873315289616585
2025-03-13 16:00:47,424 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:00:47,424 [INFO]: 	nb vectors: 2679
2025-03-13 16:00:47,424 [INFO]: 	vectors dimension: 49152
2025-03-13 16:00:47,424 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 16:00:47,424 [INFO]: }
2025-03-13 16:00:47,424 [INFO]: 	>>> Finished "Creating the index" in 63.1391 secs
2025-03-13 16:00:47,424 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1716 secs
2025-03-13 16:00:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:00:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 29288 [episode count 6/20]
[retrieval_preprocessing] for episode 88682 [episode count 7/20], we have num_retrieval=np.int64(2619) num_query=np.int64(159)
2025-03-13 16:00:50,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:00:50,947 [INFO]: Launching the whole pipeline 03/13/2025, 16:00:50
2025-03-13 16:00:50,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:00:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1628.86it/s]
2025-03-13 16:00:50,980 [INFO]: There are 2619 embeddings of dim 49152
2025-03-13 16:00:50,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 16:00:50,981 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,981 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:00:50,982 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:00:50,982 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:00:50,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:00:50,982 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,982 [INFO]: 540.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:00:50,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:00:50,983 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:00:50
2025-03-13 16:00:50,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:00:50,983 [INFO]: 	Creating the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,983 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:00:50
2025-03-13 16:00:50,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:00:50,986 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:00:50
2025-03-13 16:00:50,986 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:00:50,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.61it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.61it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.88it/s]100%|██████████| 11/11 [00:02<00:00,  5.01it/s]
2025-03-13 16:00:53,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:00:53
2025-03-13 16:01:22,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5593 secs
2025-03-13 16:01:22,747 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:01:22,747 [INFO]: 	Compute fast metrics 03/13/2025, 16:01:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
2025-03-13 16:01:51,558 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8109 secs
2025-03-13 16:01:51,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5735 secs
2025-03-13 16:01:51,560 [INFO]: {
2025-03-13 16:01:51,560 [INFO]: 	index_key: HNSW15
2025-03-13 16:01:51,560 [INFO]: 	index_param: efSearch=236
2025-03-13 16:01:51,560 [INFO]: 	index_path: knn.index
2025-03-13 16:01:51,560 [INFO]: 	size in bytes: 515272210
2025-03-13 16:01:51,560 [INFO]: 	avg_search_speed_ms: 12.54868999280157
2025-03-13 16:01:51,560 [INFO]: 	99p_search_speed_ms: 17.564391074702144
2025-03-13 16:01:51,560 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:01:51,560 [INFO]: 	nb vectors: 2619
2025-03-13 16:01:51,560 [INFO]: 	vectors dimension: 49152
2025-03-13 16:01:51,560 [INFO]: 	compression ratio: 0.9993093786292103
2025-03-13 16:01:51,560 [INFO]: }
2025-03-13 16:01:51,560 [INFO]: 	>>> Finished "Creating the index" in 60.5772 secs
2025-03-13 16:01:51,560 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6126 secs
2025-03-13 16:01:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:01:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 88682 [episode count 7/20]
[retrieval_preprocessing] for episode 76887 [episode count 8/20], we have num_retrieval=np.int64(2625) num_query=np.int64(153)
2025-03-13 16:01:53,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:01:54,281 [INFO]: Launching the whole pipeline 03/13/2025, 16:01:54
2025-03-13 16:01:54,281 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:01:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 798.76it/s]
2025-03-13 16:01:54,313 [INFO]: There are 2625 embeddings of dim 49152
2025-03-13 16:01:54,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 16:01:54,313 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:01:54
2025-03-13 16:01:54,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:01:54,313 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:01:54,313 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:01:54,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:01:54,313 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:01:54
2025-03-13 16:01:54,313 [INFO]: 541.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:01:54,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:01:54,314 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:01:54
2025-03-13 16:01:54,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:01:54,314 [INFO]: 	Creating the index 03/13/2025, 16:01:54
2025-03-13 16:01:54,314 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:01:54
2025-03-13 16:01:54,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 16:01:54,315 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:01:54
2025-03-13 16:01:54,316 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:01:54,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.04it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.30it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.01it/s]100%|██████████| 11/11 [00:02<00:00,  3.96it/s]
2025-03-13 16:01:57,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:01:57
2025-03-13 16:02:31,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4988 secs
2025-03-13 16:02:31,601 [INFO]: The best hyperparameters are: efSearch=173
2025-03-13 16:02:31,601 [INFO]: 	Compute fast metrics 03/13/2025, 16:02:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.96it/s]
2025-03-13 16:02:46,987 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3859 secs
2025-03-13 16:02:46,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6735 secs
2025-03-13 16:02:46,989 [INFO]: {
2025-03-13 16:02:46,989 [INFO]: 	index_key: HNSW15
2025-03-13 16:02:46,989 [INFO]: 	index_param: efSearch=173
2025-03-13 16:02:46,989 [INFO]: 	index_path: knn.index
2025-03-13 16:02:46,989 [INFO]: 	size in bytes: 516452650
2025-03-13 16:02:46,989 [INFO]: 	avg_search_speed_ms: 8.611558878178244
2025-03-13 16:02:46,989 [INFO]: 	99p_search_speed_ms: 16.271987045183906
2025-03-13 16:02:46,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:02:46,989 [INFO]: 	nb vectors: 2625
2025-03-13 16:02:46,989 [INFO]: 	vectors dimension: 49152
2025-03-13 16:02:46,989 [INFO]: 	compression ratio: 0.9993094236228626
2025-03-13 16:02:46,989 [INFO]: }
2025-03-13 16:02:46,989 [INFO]: 	>>> Finished "Creating the index" in 52.6756 secs
2025-03-13 16:02:46,989 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7087 secs
2025-03-13 16:02:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:02:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 76887 [episode count 8/20]
[retrieval_preprocessing] for episode 46717 [episode count 9/20], we have num_retrieval=np.int64(2684) num_query=np.int64(94)
2025-03-13 16:02:48,311 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:02:48,701 [INFO]: Launching the whole pipeline 03/13/2025, 16:02:48
2025-03-13 16:02:48,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:02:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.03it/s]
2025-03-13 16:02:48,728 [INFO]: There are 2684 embeddings of dim 49152
2025-03-13 16:02:48,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 16:02:48,728 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:02:48
2025-03-13 16:02:48,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:02:48,728 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:02:48,728 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:02:48,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:02:48,728 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:02:48
2025-03-13 16:02:48,728 [INFO]: 553.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:02:48,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:02:48,728 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:02:48
2025-03-13 16:02:48,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:02:48,728 [INFO]: 	Creating the index 03/13/2025, 16:02:48
2025-03-13 16:02:48,728 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:02:48
2025-03-13 16:02:48,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:02:48,729 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:02:48
2025-03-13 16:02:48,730 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:02:48,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.16it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.08it/s]100%|██████████| 11/11 [00:02<00:00,  4.58it/s]100%|██████████| 11/11 [00:02<00:00,  5.34it/s]
2025-03-13 16:02:50,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:02:50
2025-03-13 16:03:21,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4513 secs
2025-03-13 16:03:21,245 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 16:03:21,245 [INFO]: 	Compute fast metrics 03/13/2025, 16:03:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.94it/s]
2025-03-13 16:03:53,554 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3089 secs
2025-03-13 16:03:53,555 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8259 secs
2025-03-13 16:03:53,555 [INFO]: {
2025-03-13 16:03:53,556 [INFO]: 	index_key: HNSW15
2025-03-13 16:03:53,556 [INFO]: 	index_param: efSearch=226
2025-03-13 16:03:53,556 [INFO]: 	index_path: knn.index
2025-03-13 16:03:53,556 [INFO]: 	size in bytes: 528060370
2025-03-13 16:03:53,556 [INFO]: 	avg_search_speed_ms: 9.126114734213962
2025-03-13 16:03:53,556 [INFO]: 	99p_search_speed_ms: 13.490774936508378
2025-03-13 16:03:53,556 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:03:53,556 [INFO]: 	nb vectors: 2684
2025-03-13 16:03:53,556 [INFO]: 	vectors dimension: 49152
2025-03-13 16:03:53,556 [INFO]: 	compression ratio: 0.9993097418009232
2025-03-13 16:03:53,556 [INFO]: }
2025-03-13 16:03:53,556 [INFO]: 	>>> Finished "Creating the index" in 64.8273 secs
2025-03-13 16:03:53,556 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8549 secs
2025-03-13 16:03:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:03:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 46717 [episode count 9/20]
[retrieval_preprocessing] for episode 2757 [episode count 10/20], we have num_retrieval=np.int64(2623) num_query=np.int64(155)
2025-03-13 16:03:54,387 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:03:55,402 [INFO]: Launching the whole pipeline 03/13/2025, 16:03:55
2025-03-13 16:03:55,402 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:03:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-13 16:03:55,427 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 16:03:55,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 16:03:55,427 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:03:55,428 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:03:55,428 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:03:55,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:03:55,428 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,428 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:03:55,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:03:55,428 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:03:55
2025-03-13 16:03:55,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:03:55,428 [INFO]: 	Creating the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,428 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:03:55
2025-03-13 16:03:55,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:03:55,429 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:03:55
2025-03-13 16:03:55,429 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:03:55,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.03it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.43it/s]100%|██████████| 11/11 [00:01<00:00,  5.66it/s]
2025-03-13 16:03:57,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:03:57
2025-03-13 16:04:32,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9123 secs
2025-03-13 16:04:32,291 [INFO]: The best hyperparameters are: efSearch=98
2025-03-13 16:04:32,291 [INFO]: 	Compute fast metrics 03/13/2025, 16:04:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.12it/s]
2025-03-13 16:04:46,842 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5515 secs
2025-03-13 16:04:46,844 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4154 secs
2025-03-13 16:04:46,845 [INFO]: {
2025-03-13 16:04:46,845 [INFO]: 	index_key: HNSW15
2025-03-13 16:04:46,845 [INFO]: 	index_param: efSearch=98
2025-03-13 16:04:46,845 [INFO]: 	index_path: knn.index
2025-03-13 16:04:46,845 [INFO]: 	size in bytes: 516059170
2025-03-13 16:04:46,845 [INFO]: 	avg_search_speed_ms: 8.017549354735383
2025-03-13 16:04:46,845 [INFO]: 	99p_search_speed_ms: 14.536718241870394
2025-03-13 16:04:46,845 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:04:46,845 [INFO]: 	nb vectors: 2623
2025-03-13 16:04:46,845 [INFO]: 	vectors dimension: 49152
2025-03-13 16:04:46,845 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 16:04:46,845 [INFO]: }
2025-03-13 16:04:46,845 [INFO]: 	>>> Finished "Creating the index" in 51.4168 secs
2025-03-13 16:04:46,845 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4427 secs
2025-03-13 16:04:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:04:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 2757 [episode count 10/20]
[retrieval_preprocessing] for episode 29386 [episode count 11/20], we have num_retrieval=np.int64(2612) num_query=np.int64(166)
2025-03-13 16:04:48,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:04:48,901 [INFO]: Launching the whole pipeline 03/13/2025, 16:04:48
2025-03-13 16:04:48,901 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:04:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1995.39it/s]
2025-03-13 16:04:48,929 [INFO]: There are 2612 embeddings of dim 49152
2025-03-13 16:04:48,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:04:48,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:04:48
2025-03-13 16:04:48,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:04:48,930 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:04:48,931 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:04:48,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:04:48,931 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:04:48
2025-03-13 16:04:48,931 [INFO]: 539.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:04:48,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:04:48,932 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:04:48
2025-03-13 16:04:48,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:04:48,932 [INFO]: 	Creating the index 03/13/2025, 16:04:48
2025-03-13 16:04:48,932 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:04:48
2025-03-13 16:04:48,935 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:04:48,935 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:04:48
2025-03-13 16:04:48,936 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:04:48,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.99it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.36it/s] 91%|█████████ | 10/11 [00:00<00:00, 29.52it/s]100%|██████████| 11/11 [00:03<00:00,  3.28it/s]
2025-03-13 16:04:52,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:04:52
2025-03-13 16:05:25,785 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4903 secs
2025-03-13 16:05:25,786 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 16:05:25,786 [INFO]: 	Compute fast metrics 03/13/2025, 16:05:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.28it/s]
2025-03-13 16:05:51,657 [INFO]: 	>>> Finished "Compute fast metrics" in 25.8712 secs
2025-03-13 16:05:51,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7233 secs
2025-03-13 16:05:51,659 [INFO]: {
2025-03-13 16:05:51,659 [INFO]: 	index_key: HNSW15
2025-03-13 16:05:51,659 [INFO]: 	index_param: efSearch=137
2025-03-13 16:05:51,659 [INFO]: 	index_path: knn.index
2025-03-13 16:05:51,659 [INFO]: 	size in bytes: 513894910
2025-03-13 16:05:51,659 [INFO]: 	avg_search_speed_ms: 6.927606999507524
2025-03-13 16:05:51,659 [INFO]: 	99p_search_speed_ms: 9.666820014826948
2025-03-13 16:05:51,659 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:05:51,659 [INFO]: 	nb vectors: 2612
2025-03-13 16:05:51,659 [INFO]: 	vectors dimension: 49152
2025-03-13 16:05:51,659 [INFO]: 	compression ratio: 0.9993095592248618
2025-03-13 16:05:51,659 [INFO]: }
2025-03-13 16:05:51,659 [INFO]: 	>>> Finished "Creating the index" in 62.7269 secs
2025-03-13 16:05:51,659 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7584 secs
2025-03-13 16:05:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:05:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 29386 [episode count 11/20]
[retrieval_preprocessing] for episode 56020 [episode count 12/20], we have num_retrieval=np.int64(2669) num_query=np.int64(109)
2025-03-13 16:05:52,908 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:05:53,485 [INFO]: Launching the whole pipeline 03/13/2025, 16:05:53
2025-03-13 16:05:53,485 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:05:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.96it/s]
2025-03-13 16:05:53,511 [INFO]: There are 2669 embeddings of dim 49152
2025-03-13 16:05:53,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:05:53,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:05:53
2025-03-13 16:05:53,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:05:53,512 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:05:53,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:05:53,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:05:53,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:05:53
2025-03-13 16:05:53,512 [INFO]: 550.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:05:53,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:05:53,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:05:53
2025-03-13 16:05:53,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:05:53,512 [INFO]: 	Creating the index 03/13/2025, 16:05:53
2025-03-13 16:05:53,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:05:53
2025-03-13 16:05:53,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:05:53,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:05:53
2025-03-13 16:05:53,513 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:05:53,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.64it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.23it/s]100%|██████████| 11/11 [00:02<00:00,  5.23it/s]
2025-03-13 16:05:55,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:05:55
2025-03-13 16:06:30,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0064 secs
2025-03-13 16:06:30,626 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 16:06:30,627 [INFO]: 	Compute fast metrics 03/13/2025, 16:06:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-13 16:07:01,820 [INFO]: 	>>> Finished "Compute fast metrics" in 31.1936 secs
2025-03-13 16:07:01,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3089 secs
2025-03-13 16:07:01,822 [INFO]: {
2025-03-13 16:07:01,822 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:01,822 [INFO]: 	index_param: efSearch=185
2025-03-13 16:07:01,822 [INFO]: 	index_path: knn.index
2025-03-13 16:07:01,822 [INFO]: 	size in bytes: 525109270
2025-03-13 16:07:01,822 [INFO]: 	avg_search_speed_ms: 9.259625840975248
2025-03-13 16:07:01,822 [INFO]: 	99p_search_speed_ms: 12.756313483696433
2025-03-13 16:07:01,822 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:01,822 [INFO]: 	nb vectors: 2669
2025-03-13 16:07:01,822 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:01,822 [INFO]: 	compression ratio: 0.9993096332121503
2025-03-13 16:07:01,822 [INFO]: }
2025-03-13 16:07:01,823 [INFO]: 	>>> Finished "Creating the index" in 68.3104 secs
2025-03-13 16:07:01,823 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3373 secs
2025-03-13 16:07:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 56020 [episode count 12/20]
[retrieval_preprocessing] for episode 61688 [episode count 13/20], we have num_retrieval=np.int64(2513) num_query=np.int64(265)
2025-03-13 16:07:03,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:07:03,475 [INFO]: Launching the whole pipeline 03/13/2025, 16:07:03
2025-03-13 16:07:03,475 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:07:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 760.66it/s]
2025-03-13 16:07:03,818 [INFO]: There are 2513 embeddings of dim 49152
2025-03-13 16:07:03,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3430 secs
2025-03-13 16:07:03,818 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:07:03
2025-03-13 16:07:03,819 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:07:03,819 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:07:03,819 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:07:03,819 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:07:03,819 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:07:03
2025-03-13 16:07:03,819 [INFO]: 518.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:07:03,819 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:07:03,819 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:07:03
2025-03-13 16:07:03,819 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:07:03,819 [INFO]: 	Creating the index 03/13/2025, 16:07:03
2025-03-13 16:07:03,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:07:03
2025-03-13 16:07:03,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:07:03,821 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:07:03
2025-03-13 16:07:03,822 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:07:03,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.87it/s] 60%|██████    | 6/10 [00:00<00:00, 19.36it/s]100%|██████████| 10/10 [00:02<00:00,  2.96it/s]100%|██████████| 10/10 [00:02<00:00,  3.49it/s]
2025-03-13 16:07:06,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:07:06
2025-03-13 16:07:38,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2707 secs
2025-03-13 16:07:38,967 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:07:38,967 [INFO]: 	Compute fast metrics 03/13/2025, 16:07:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.47it/s] 50%|█████     | 2/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-13 16:07:57,879 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9117 secs
2025-03-13 16:07:57,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0594 secs
2025-03-13 16:07:57,881 [INFO]: {
2025-03-13 16:07:57,881 [INFO]: 	index_key: HNSW15
2025-03-13 16:07:57,881 [INFO]: 	index_param: efSearch=177
2025-03-13 16:07:57,881 [INFO]: 	index_path: knn.index
2025-03-13 16:07:57,881 [INFO]: 	size in bytes: 494417110
2025-03-13 16:07:57,881 [INFO]: 	avg_search_speed_ms: 11.377409150859975
2025-03-13 16:07:57,881 [INFO]: 	99p_search_speed_ms: 21.859040907584145
2025-03-13 16:07:57,881 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:07:57,881 [INFO]: 	nb vectors: 2513
2025-03-13 16:07:57,881 [INFO]: 	vectors dimension: 49152
2025-03-13 16:07:57,881 [INFO]: 	compression ratio: 0.9993098822975605
2025-03-13 16:07:57,881 [INFO]: }
2025-03-13 16:07:57,881 [INFO]: 	>>> Finished "Creating the index" in 54.0618 secs
2025-03-13 16:07:57,881 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4063 secs
2025-03-13 16:07:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:07:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 61688 [episode count 13/20]
[retrieval_preprocessing] for episode 85244 [episode count 14/20], we have num_retrieval=np.int64(2517) num_query=np.int64(261)
2025-03-13 16:08:00,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:08:00,461 [INFO]: Launching the whole pipeline 03/13/2025, 16:08:00
2025-03-13 16:08:00,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:08:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-13 16:08:00,488 [INFO]: There are 2517 embeddings of dim 49152
2025-03-13 16:08:00,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:08:00,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:08:00
2025-03-13 16:08:00,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:08:00,489 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 16:08:00,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:08:00,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:08:00,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:08:00
2025-03-13 16:08:00,489 [INFO]: 519.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:08:00,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:08:00,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:08:00
2025-03-13 16:08:00,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:08:00,489 [INFO]: 	Creating the index 03/13/2025, 16:08:00
2025-03-13 16:08:00,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:08:00
2025-03-13 16:08:00,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:08:00,490 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:08:00
2025-03-13 16:08:00,490 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:08:00,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.01it/s] 50%|█████     | 5/10 [00:00<00:00, 23.76it/s]100%|██████████| 10/10 [00:02<00:00,  3.95it/s]100%|██████████| 10/10 [00:02<00:00,  4.56it/s]
2025-03-13 16:08:02,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:08:02
2025-03-13 16:08:37,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9973 secs
2025-03-13 16:08:37,689 [INFO]: The best hyperparameters are: efSearch=177
2025-03-13 16:08:37,689 [INFO]: 	Compute fast metrics 03/13/2025, 16:08:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-13 16:09:02,100 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4115 secs
2025-03-13 16:09:02,102 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6119 secs
2025-03-13 16:09:02,102 [INFO]: {
2025-03-13 16:09:02,102 [INFO]: 	index_key: HNSW15
2025-03-13 16:09:02,102 [INFO]: 	index_param: efSearch=177
2025-03-13 16:09:02,102 [INFO]: 	index_path: knn.index
2025-03-13 16:09:02,102 [INFO]: 	size in bytes: 495204070
2025-03-13 16:09:02,102 [INFO]: 	avg_search_speed_ms: 8.559768271399065
2025-03-13 16:09:02,102 [INFO]: 	99p_search_speed_ms: 12.135985018685458
2025-03-13 16:09:02,102 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:09:02,102 [INFO]: 	nb vectors: 2517
2025-03-13 16:09:02,103 [INFO]: 	vectors dimension: 49152
2025-03-13 16:09:02,103 [INFO]: 	compression ratio: 0.9993099127799979
2025-03-13 16:09:02,103 [INFO]: }
2025-03-13 16:09:02,103 [INFO]: 	>>> Finished "Creating the index" in 61.6134 secs
2025-03-13 16:09:02,103 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6416 secs
2025-03-13 16:09:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:09:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 85244 [episode count 14/20]
[retrieval_preprocessing] for episode 31486 [episode count 15/20], we have num_retrieval=np.int64(2671) num_query=np.int64(107)
2025-03-13 16:09:04,616 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:09:05,021 [INFO]: Launching the whole pipeline 03/13/2025, 16:09:05
2025-03-13 16:09:05,021 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:09:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.98it/s]
2025-03-13 16:09:05,050 [INFO]: There are 2671 embeddings of dim 49152
2025-03-13 16:09:05,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 16:09:05,051 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:09:05
2025-03-13 16:09:05,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:09:05,052 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:09:05,052 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:09:05,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:09:05,052 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:09:05
2025-03-13 16:09:05,052 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:09:05,053 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:09:05,053 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:09:05
2025-03-13 16:09:05,053 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:09:05,053 [INFO]: 	Creating the index 03/13/2025, 16:09:05
2025-03-13 16:09:05,053 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:09:05
2025-03-13 16:09:05,056 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:09:05,057 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:09:05
2025-03-13 16:09:05,057 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:09:05,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.89it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.09it/s]100%|██████████| 11/11 [00:02<00:00,  4.37it/s]100%|██████████| 11/11 [00:02<00:00,  5.40it/s]
2025-03-13 16:09:07,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:09:07
2025-03-13 16:09:34,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9368 secs
2025-03-13 16:09:34,035 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 16:09:34,035 [INFO]: 	Compute fast metrics 03/13/2025, 16:09:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 16:10:16,174 [INFO]: 	>>> Finished "Compute fast metrics" in 42.1385 secs
2025-03-13 16:10:16,177 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1205 secs
2025-03-13 16:10:16,177 [INFO]: {
2025-03-13 16:10:16,178 [INFO]: 	index_key: HNSW15
2025-03-13 16:10:16,178 [INFO]: 	index_param: efSearch=264
2025-03-13 16:10:16,178 [INFO]: 	index_path: knn.index
2025-03-13 16:10:16,178 [INFO]: 	size in bytes: 525502750
2025-03-13 16:10:16,178 [INFO]: 	avg_search_speed_ms: 13.683534832798689
2025-03-13 16:10:16,178 [INFO]: 	99p_search_speed_ms: 22.32341023627669
2025-03-13 16:10:16,178 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:10:16,178 [INFO]: 	nb vectors: 2671
2025-03-13 16:10:16,178 [INFO]: 	vectors dimension: 49152
2025-03-13 16:10:16,178 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-13 16:10:16,178 [INFO]: }
2025-03-13 16:10:16,178 [INFO]: 	>>> Finished "Creating the index" in 71.1244 secs
2025-03-13 16:10:16,178 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1571 secs
2025-03-13 16:10:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:10:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 31486 [episode count 15/20]
[retrieval_preprocessing] for episode 67877 [episode count 16/20], we have num_retrieval=np.int64(2678) num_query=np.int64(100)
2025-03-13 16:10:18,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:10:19,317 [INFO]: Launching the whole pipeline 03/13/2025, 16:10:19
2025-03-13 16:10:19,317 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:10:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.29it/s]
2025-03-13 16:10:19,350 [INFO]: There are 2678 embeddings of dim 49152
2025-03-13 16:10:19,351 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 16:10:19,351 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:10:19
2025-03-13 16:10:19,351 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:10:19,351 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:10:19,351 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:10:19,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:10:19,352 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:10:19
2025-03-13 16:10:19,352 [INFO]: 552.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:10:19,352 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:10:19,352 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:10:19
2025-03-13 16:10:19,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:10:19,353 [INFO]: 	Creating the index 03/13/2025, 16:10:19
2025-03-13 16:10:19,353 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:10:19
2025-03-13 16:10:19,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 16:10:19,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:10:19
2025-03-13 16:10:19,357 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:10:19,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.90it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.22it/s] 91%|█████████ | 10/11 [00:00<00:00, 31.89it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-13 16:10:22,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:10:22
2025-03-13 16:10:58,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0096 secs
2025-03-13 16:10:58,398 [INFO]: The best hyperparameters are: efSearch=145
2025-03-13 16:10:58,398 [INFO]: 	Compute fast metrics 03/13/2025, 16:10:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.24it/s]
2025-03-13 16:11:21,180 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7819 secs
2025-03-13 16:11:21,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8267 secs
2025-03-13 16:11:21,183 [INFO]: {
2025-03-13 16:11:21,183 [INFO]: 	index_key: HNSW15
2025-03-13 16:11:21,183 [INFO]: 	index_param: efSearch=145
2025-03-13 16:11:21,183 [INFO]: 	index_path: knn.index
2025-03-13 16:11:21,183 [INFO]: 	size in bytes: 526879930
2025-03-13 16:11:21,183 [INFO]: 	avg_search_speed_ms: 9.333025730334903
2025-03-13 16:11:21,183 [INFO]: 	99p_search_speed_ms: 16.170031949877735
2025-03-13 16:11:21,184 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:11:21,184 [INFO]: 	nb vectors: 2678
2025-03-13 16:11:21,184 [INFO]: 	vectors dimension: 49152
2025-03-13 16:11:21,184 [INFO]: 	compression ratio: 0.9993096985113857
2025-03-13 16:11:21,184 [INFO]: }
2025-03-13 16:11:21,184 [INFO]: 	>>> Finished "Creating the index" in 61.8307 secs
2025-03-13 16:11:21,184 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8665 secs
2025-03-13 16:11:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:11:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 67877 [episode count 16/20]
[retrieval_preprocessing] for episode 64824 [episode count 17/20], we have num_retrieval=np.int64(2640) num_query=np.int64(138)
2025-03-13 16:11:22,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:11:22,621 [INFO]: Launching the whole pipeline 03/13/2025, 16:11:22
2025-03-13 16:11:22,622 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:11:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1596.01it/s]
2025-03-13 16:11:22,654 [INFO]: There are 2640 embeddings of dim 49152
2025-03-13 16:11:22,655 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 16:11:22,655 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:11:22
2025-03-13 16:11:22,655 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:11:22,655 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:11:22,656 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:11:22,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 16:11:22,656 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:11:22
2025-03-13 16:11:22,656 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:11:22,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:11:22,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:11:22
2025-03-13 16:11:22,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:11:22,657 [INFO]: 	Creating the index 03/13/2025, 16:11:22
2025-03-13 16:11:22,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:11:22
2025-03-13 16:11:22,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:11:22,660 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:11:22
2025-03-13 16:11:22,660 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:11:22,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.06it/s] 45%|████▌     | 5/11 [00:00<00:00, 22.64it/s] 73%|███████▎  | 8/11 [00:00<00:00, 25.50it/s]100%|██████████| 11/11 [00:02<00:00,  3.03it/s]100%|██████████| 11/11 [00:02<00:00,  4.21it/s]
2025-03-13 16:11:25,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:11:25
2025-03-13 16:12:01,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4955 secs
2025-03-13 16:12:01,778 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 16:12:01,778 [INFO]: 	Compute fast metrics 03/13/2025, 16:12:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.47it/s]
2025-03-13 16:12:26,008 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2302 secs
2025-03-13 16:12:26,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3499 secs
2025-03-13 16:12:26,010 [INFO]: {
2025-03-13 16:12:26,010 [INFO]: 	index_key: HNSW15
2025-03-13 16:12:26,011 [INFO]: 	index_param: efSearch=204
2025-03-13 16:12:26,011 [INFO]: 	index_path: knn.index
2025-03-13 16:12:26,011 [INFO]: 	size in bytes: 519403810
2025-03-13 16:12:26,011 [INFO]: 	avg_search_speed_ms: 10.17974120529704
2025-03-13 16:12:26,011 [INFO]: 	99p_search_speed_ms: 16.76590699236839
2025-03-13 16:12:26,011 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:12:26,011 [INFO]: 	nb vectors: 2640
2025-03-13 16:12:26,011 [INFO]: 	vectors dimension: 49152
2025-03-13 16:12:26,011 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-13 16:12:26,011 [INFO]: }
2025-03-13 16:12:26,011 [INFO]: 	>>> Finished "Creating the index" in 63.3539 secs
2025-03-13 16:12:26,011 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3893 secs
2025-03-13 16:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:12:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 64824 [episode count 17/20]
[retrieval_preprocessing] for episode 19850 [episode count 18/20], we have num_retrieval=np.int64(2658) num_query=np.int64(120)
2025-03-13 16:12:29,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:12:30,201 [INFO]: Launching the whole pipeline 03/13/2025, 16:12:30
2025-03-13 16:12:30,201 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:12:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-13 16:12:30,232 [INFO]: There are 2658 embeddings of dim 49152
2025-03-13 16:12:30,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 16:12:30,232 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:12:30
2025-03-13 16:12:30,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:12:30,233 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:12:30,233 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:12:30,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:12:30,233 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:12:30
2025-03-13 16:12:30,233 [INFO]: 548.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:12:30,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:12:30,234 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:12:30
2025-03-13 16:12:30,234 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:12:30,234 [INFO]: 	Creating the index 03/13/2025, 16:12:30
2025-03-13 16:12:30,234 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:12:30
2025-03-13 16:12:30,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:12:30,237 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:12:30
2025-03-13 16:12:30,237 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:12:30,238 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.62it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.55it/s]100%|██████████| 11/11 [00:02<00:00,  3.14it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]
2025-03-13 16:12:33,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:12:33
2025-03-13 16:13:22,465 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4296 secs
2025-03-13 16:13:22,465 [INFO]: The best hyperparameters are: efSearch=179
2025-03-13 16:13:22,465 [INFO]: 	Compute fast metrics 03/13/2025, 16:13:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.56s/it] 50%|█████     | 2/4 [00:06<00:06,  3.42s/it] 75%|███████▌  | 3/4 [00:09<00:03,  3.24s/it] 75%|███████▌  | 3/4 [00:11<00:03,  3.85s/it]
2025-03-13 16:14:03,031 [INFO]: 	>>> Finished "Compute fast metrics" in 40.5654 secs
2025-03-13 16:14:03,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.7958 secs
2025-03-13 16:14:03,033 [INFO]: {
2025-03-13 16:14:03,033 [INFO]: 	index_key: HNSW15
2025-03-13 16:14:03,033 [INFO]: 	index_param: efSearch=179
2025-03-13 16:14:03,033 [INFO]: 	index_path: knn.index
2025-03-13 16:14:03,033 [INFO]: 	size in bytes: 522945130
2025-03-13 16:14:03,033 [INFO]: 	avg_search_speed_ms: 7.679064372753275
2025-03-13 16:14:03,033 [INFO]: 	99p_search_speed_ms: 11.202276272233576
2025-03-13 16:14:03,033 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:14:03,033 [INFO]: 	nb vectors: 2658
2025-03-13 16:14:03,033 [INFO]: 	vectors dimension: 49152
2025-03-13 16:14:03,033 [INFO]: 	compression ratio: 0.9993095528014574
2025-03-13 16:14:03,033 [INFO]: }
2025-03-13 16:14:03,033 [INFO]: 	>>> Finished "Creating the index" in 92.7996 secs
2025-03-13 16:14:03,033 [INFO]: >>> Finished "Launching the whole pipeline" in 92.8325 secs
2025-03-13 16:14:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:14:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 19850 [episode count 18/20]
[retrieval_preprocessing] for episode 58252 [episode count 19/20], we have num_retrieval=np.int64(2645) num_query=np.int64(133)
2025-03-13 16:14:06,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:14:06,757 [INFO]: Launching the whole pipeline 03/13/2025, 16:14:06
2025-03-13 16:14:06,757 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:14:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 872.36it/s]
2025-03-13 16:14:06,783 [INFO]: There are 2645 embeddings of dim 49152
2025-03-13 16:14:06,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 16:14:06,783 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:14:06
2025-03-13 16:14:06,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:14:06,783 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:14:06,783 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:14:06,783 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:14:06,783 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:14:06
2025-03-13 16:14:06,783 [INFO]: 545.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:14:06,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:14:06,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:14:06
2025-03-13 16:14:06,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:14:06,784 [INFO]: 	Creating the index 03/13/2025, 16:14:06
2025-03-13 16:14:06,784 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:14:06
2025-03-13 16:14:06,785 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:14:06,785 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:14:06
2025-03-13 16:14:06,785 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:14:06,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.73it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.30it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.72it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]
2025-03-13 16:14:09,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:14:09
2025-03-13 16:14:43,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7863 secs
2025-03-13 16:14:43,410 [INFO]: The best hyperparameters are: efSearch=192
2025-03-13 16:14:43,410 [INFO]: 	Compute fast metrics 03/13/2025, 16:14:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.82it/s]
2025-03-13 16:15:05,409 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9980 secs
2025-03-13 16:15:05,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6267 secs
2025-03-13 16:15:05,412 [INFO]: {
2025-03-13 16:15:05,412 [INFO]: 	index_key: HNSW15
2025-03-13 16:15:05,412 [INFO]: 	index_param: efSearch=192
2025-03-13 16:15:05,412 [INFO]: 	index_path: knn.index
2025-03-13 16:15:05,412 [INFO]: 	size in bytes: 520387510
2025-03-13 16:15:05,412 [INFO]: 	avg_search_speed_ms: 11.342322082436155
2025-03-13 16:15:05,412 [INFO]: 	99p_search_speed_ms: 24.148995454888762
2025-03-13 16:15:05,412 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:15:05,412 [INFO]: 	nb vectors: 2645
2025-03-13 16:15:05,412 [INFO]: 	vectors dimension: 49152
2025-03-13 16:15:05,412 [INFO]: 	compression ratio: 0.999309456908372
2025-03-13 16:15:05,412 [INFO]: }
2025-03-13 16:15:05,412 [INFO]: 	>>> Finished "Creating the index" in 58.6284 secs
2025-03-13 16:15:05,412 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6553 secs
2025-03-13 16:15:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:15:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 58252 [episode count 19/20]
2025-03-13 16:15:06: [retrieval_preprocessing] finished for 2939999281_close_tap [chosen_id count 2/196]
2025-03-13 16:15:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_rubiks_cube_on_shelf [chosen_id count 3/196]
2025-03-13 16:15:08: [retrieval_preprocessing] we have num_total=2304 embedding_dim=49152
[retrieval_preprocessing] for episode 5634 [episode count 0/20], we have num_retrieval=np.int64(2159) num_query=np.int64(145)
2025-03-13 16:15:08,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:15:08,675 [INFO]: Launching the whole pipeline 03/13/2025, 16:15:08
2025-03-13 16:15:08,676 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:15:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.56it/s]
2025-03-13 16:15:08,705 [INFO]: There are 2159 embeddings of dim 49152
2025-03-13 16:15:08,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 16:15:08,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:15:08
2025-03-13 16:15:08,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:15:08,705 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:15:08,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:15:08,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:15:08,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:15:08
2025-03-13 16:15:08,705 [INFO]: 445.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:15:08,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:15:08,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:15:08
2025-03-13 16:15:08,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:15:08,706 [INFO]: 	Creating the index 03/13/2025, 16:15:08
2025-03-13 16:15:08,706 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:15:08
2025-03-13 16:15:08,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 16:15:08,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:15:08
2025-03-13 16:15:08,707 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:15:08,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.47it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.75it/s]100%|██████████| 9/9 [00:01<00:00,  4.01it/s]100%|██████████| 9/9 [00:01<00:00,  4.91it/s]
2025-03-13 16:15:10,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:15:10
2025-03-13 16:15:53,502 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9562 secs
2025-03-13 16:15:53,503 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 16:15:53,503 [INFO]: 	Compute fast metrics 03/13/2025, 16:15:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.00it/s] 50%|█████     | 2/4 [00:01<00:01,  1.41it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.45it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.34it/s]
2025-03-13 16:16:16,592 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0886 secs
2025-03-13 16:16:16,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8862 secs
2025-03-13 16:16:16,593 [INFO]: {
2025-03-13 16:16:16,593 [INFO]: 	index_key: HNSW15
2025-03-13 16:16:16,594 [INFO]: 	index_param: efSearch=212
2025-03-13 16:16:16,594 [INFO]: 	index_path: knn.index
2025-03-13 16:16:16,594 [INFO]: 	size in bytes: 424770130
2025-03-13 16:16:16,594 [INFO]: 	avg_search_speed_ms: 9.864479280628
2025-03-13 16:16:16,594 [INFO]: 	99p_search_speed_ms: 15.01647820696235
2025-03-13 16:16:16,594 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:16:16,594 [INFO]: 	nb vectors: 2159
2025-03-13 16:16:16,594 [INFO]: 	vectors dimension: 49152
2025-03-13 16:16:16,594 [INFO]: 	compression ratio: 0.9993091369207152
2025-03-13 16:16:16,594 [INFO]: }
2025-03-13 16:16:16,594 [INFO]: 	>>> Finished "Creating the index" in 67.8880 secs
2025-03-13 16:16:16,594 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9182 secs
2025-03-13 16:16:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:16:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 5634 [episode count 0/20]
[retrieval_preprocessing] for episode 4642 [episode count 1/20], we have num_retrieval=np.int64(2183) num_query=np.int64(121)
2025-03-13 16:16:17,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:16:18,655 [INFO]: Launching the whole pipeline 03/13/2025, 16:16:18
2025-03-13 16:16:18,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:16:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1063.19it/s]
2025-03-13 16:16:18,692 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 16:16:18,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 16:16:18,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:16:18
2025-03-13 16:16:18,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:16:18,693 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:16:18,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:16:18,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:16:18,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:16:18
2025-03-13 16:16:18,694 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:16:18,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:16:18,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:16:18
2025-03-13 16:16:18,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:16:18,695 [INFO]: 	Creating the index 03/13/2025, 16:16:18
2025-03-13 16:16:18,695 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:16:18
2025-03-13 16:16:18,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 16:16:18,697 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:16:18
2025-03-13 16:16:18,698 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:16:18,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.62it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.35it/s]
2025-03-13 16:16:20,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:16:20
2025-03-13 16:16:47,072 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6846 secs
2025-03-13 16:16:47,072 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 16:16:47,072 [INFO]: 	Compute fast metrics 03/13/2025, 16:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.28it/s]
2025-03-13 16:17:21,499 [INFO]: 	>>> Finished "Compute fast metrics" in 34.4269 secs
2025-03-13 16:17:21,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8041 secs
2025-03-13 16:17:21,502 [INFO]: {
2025-03-13 16:17:21,502 [INFO]: 	index_key: HNSW15
2025-03-13 16:17:21,502 [INFO]: 	index_param: efSearch=296
2025-03-13 16:17:21,502 [INFO]: 	index_path: knn.index
2025-03-13 16:17:21,502 [INFO]: 	size in bytes: 429492010
2025-03-13 16:17:21,502 [INFO]: 	avg_search_speed_ms: 13.591307356166553
2025-03-13 16:17:21,502 [INFO]: 	99p_search_speed_ms: 20.20835983566939
2025-03-13 16:17:21,502 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:17:21,502 [INFO]: 	nb vectors: 2183
2025-03-13 16:17:21,502 [INFO]: 	vectors dimension: 49152
2025-03-13 16:17:21,502 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 16:17:21,502 [INFO]: }
2025-03-13 16:17:21,502 [INFO]: 	>>> Finished "Creating the index" in 62.8075 secs
2025-03-13 16:17:21,502 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8469 secs
2025-03-13 16:17:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:17:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 4642 [episode count 1/20]
[retrieval_preprocessing] for episode 67628 [episode count 2/20], we have num_retrieval=np.int64(2215) num_query=np.int64(89)
2025-03-13 16:17:23,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:17:23,944 [INFO]: Launching the whole pipeline 03/13/2025, 16:17:23
2025-03-13 16:17:23,944 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:17:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 901.23it/s]
2025-03-13 16:17:23,973 [INFO]: There are 2215 embeddings of dim 49152
2025-03-13 16:17:23,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 16:17:23,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:17:23
2025-03-13 16:17:23,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:17:23,973 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:17:23,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:17:23,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:17:23,973 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:17:23
2025-03-13 16:17:23,974 [INFO]: 457.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:17:23,974 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:17:23,974 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:17:23
2025-03-13 16:17:23,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:17:23,974 [INFO]: 	Creating the index 03/13/2025, 16:17:23
2025-03-13 16:17:23,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:17:23
2025-03-13 16:17:23,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:17:23,975 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:17:23
2025-03-13 16:17:23,975 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:17:23,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.19it/s] 44%|████▍     | 4/9 [00:00<00:00, 15.23it/s] 78%|███████▊  | 7/9 [00:00<00:00, 20.50it/s]100%|██████████| 9/9 [00:03<00:00,  2.62it/s]
2025-03-13 16:17:27,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:17:27
2025-03-13 16:18:06,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4969 secs
2025-03-13 16:18:06,906 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 16:18:06,906 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.60it/s]
2025-03-13 16:18:24,204 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2973 secs
2025-03-13 16:18:24,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4770 secs
2025-03-13 16:18:24,452 [INFO]: {
2025-03-13 16:18:24,453 [INFO]: 	index_key: HNSW15
2025-03-13 16:18:24,453 [INFO]: 	index_param: efSearch=186
2025-03-13 16:18:24,453 [INFO]: 	index_path: knn.index
2025-03-13 16:18:24,453 [INFO]: 	size in bytes: 435787810
2025-03-13 16:18:24,453 [INFO]: 	avg_search_speed_ms: 9.717649537879897
2025-03-13 16:18:24,453 [INFO]: 	99p_search_speed_ms: 13.244145028293133
2025-03-13 16:18:24,453 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:18:24,453 [INFO]: 	nb vectors: 2215
2025-03-13 16:18:24,453 [INFO]: 	vectors dimension: 49152
2025-03-13 16:18:24,453 [INFO]: 	compression ratio: 0.9993090903575297
2025-03-13 16:18:24,453 [INFO]: }
2025-03-13 16:18:24,453 [INFO]: 	>>> Finished "Creating the index" in 60.4793 secs
2025-03-13 16:18:24,453 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5092 secs
2025-03-13 16:18:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:18:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67628 [episode count 2/20]
[retrieval_preprocessing] for episode 68148 [episode count 3/20], we have num_retrieval=np.int64(2187) num_query=np.int64(117)
2025-03-13 16:18:25,541 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:18:25,922 [INFO]: Launching the whole pipeline 03/13/2025, 16:18:25
2025-03-13 16:18:25,922 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:18:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1956.30it/s]
2025-03-13 16:18:25,947 [INFO]: There are 2187 embeddings of dim 49152
2025-03-13 16:18:25,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 16:18:25,947 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:18:25
2025-03-13 16:18:25,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:18:25,947 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:18:25,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:18:25,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:18:25,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:18:25
2025-03-13 16:18:25,947 [INFO]: 451.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:18:25,948 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:18:25,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:18:25
2025-03-13 16:18:25,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:18:25,948 [INFO]: 	Creating the index 03/13/2025, 16:18:25
2025-03-13 16:18:25,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:18:25
2025-03-13 16:18:25,949 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:18:25,949 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:18:25
2025-03-13 16:18:25,949 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:18:25,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.70it/s] 56%|█████▌    | 5/9 [00:00<00:00, 24.12it/s]100%|██████████| 9/9 [00:02<00:00,  3.39it/s]100%|██████████| 9/9 [00:02<00:00,  4.00it/s]
2025-03-13 16:18:28,200 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:18:28
2025-03-13 16:18:59,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6769 secs
2025-03-13 16:18:59,878 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 16:18:59,878 [INFO]: 	Compute fast metrics 03/13/2025, 16:18:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.33s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.24it/s]
2025-03-13 16:19:23,593 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7152 secs
2025-03-13 16:19:23,596 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6473 secs
2025-03-13 16:19:23,596 [INFO]: {
2025-03-13 16:19:23,596 [INFO]: 	index_key: HNSW15
2025-03-13 16:19:23,596 [INFO]: 	index_param: efSearch=245
2025-03-13 16:19:23,596 [INFO]: 	index_path: knn.index
2025-03-13 16:19:23,596 [INFO]: 	size in bytes: 430279030
2025-03-13 16:19:23,597 [INFO]: 	avg_search_speed_ms: 15.170807496178895
2025-03-13 16:19:23,597 [INFO]: 	99p_search_speed_ms: 27.564752174075675
2025-03-13 16:19:23,597 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:19:23,597 [INFO]: 	nb vectors: 2187
2025-03-13 16:19:23,597 [INFO]: 	vectors dimension: 49152
2025-03-13 16:19:23,597 [INFO]: 	compression ratio: 0.9993089739929925
2025-03-13 16:19:23,597 [INFO]: }
2025-03-13 16:19:23,597 [INFO]: 	>>> Finished "Creating the index" in 57.6490 secs
2025-03-13 16:19:23,597 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6746 secs
2025-03-13 16:19:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:19:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 68148 [episode count 3/20]
[retrieval_preprocessing] for episode 53827 [episode count 4/20], we have num_retrieval=np.int64(2179) num_query=np.int64(125)
2025-03-13 16:19:25,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:19:26,286 [INFO]: Launching the whole pipeline 03/13/2025, 16:19:26
2025-03-13 16:19:26,286 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:19:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 927.33it/s]
2025-03-13 16:19:26,315 [INFO]: There are 2179 embeddings of dim 49152
2025-03-13 16:19:26,315 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 16:19:26,315 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:19:26
2025-03-13 16:19:26,315 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:19:26,315 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:19:26,315 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:19:26,315 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:19:26,315 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:19:26
2025-03-13 16:19:26,315 [INFO]: 449.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:19:26,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:19:26,315 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:19:26
2025-03-13 16:19:26,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:19:26,315 [INFO]: 	Creating the index 03/13/2025, 16:19:26
2025-03-13 16:19:26,315 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:19:26
2025-03-13 16:19:26,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:19:26,317 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:19:26
2025-03-13 16:19:26,317 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:19:26,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.41it/s] 56%|█████▌    | 5/9 [00:00<00:00, 24.91it/s]100%|██████████| 9/9 [00:02<00:00,  2.98it/s]100%|██████████| 9/9 [00:02<00:00,  3.54it/s]
2025-03-13 16:19:28,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:19:28
2025-03-13 16:20:06,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0953 secs
2025-03-13 16:20:06,956 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 16:20:06,957 [INFO]: 	Compute fast metrics 03/13/2025, 16:20:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.82it/s]
2025-03-13 16:20:25,576 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6197 secs
2025-03-13 16:20:25,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2611 secs
2025-03-13 16:20:25,578 [INFO]: {
2025-03-13 16:20:25,578 [INFO]: 	index_key: HNSW15
2025-03-13 16:20:25,578 [INFO]: 	index_param: efSearch=223
2025-03-13 16:20:25,578 [INFO]: 	index_path: knn.index
2025-03-13 16:20:25,578 [INFO]: 	size in bytes: 428705050
2025-03-13 16:20:25,578 [INFO]: 	avg_search_speed_ms: 12.166504680752356
2025-03-13 16:20:25,578 [INFO]: 	99p_search_speed_ms: 18.74043851625173
2025-03-13 16:20:25,578 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:20:25,578 [INFO]: 	nb vectors: 2179
2025-03-13 16:20:25,578 [INFO]: 	vectors dimension: 49152
2025-03-13 16:20:25,578 [INFO]: 	compression ratio: 0.9993090400964486
2025-03-13 16:20:25,578 [INFO]: }
2025-03-13 16:20:25,578 [INFO]: 	>>> Finished "Creating the index" in 59.2628 secs
2025-03-13 16:20:25,578 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2926 secs
2025-03-13 16:20:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:20:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 53827 [episode count 4/20]
[retrieval_preprocessing] for episode 7793 [episode count 5/20], we have num_retrieval=np.int64(2191) num_query=np.int64(113)
2025-03-13 16:20:27,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:20:27,822 [INFO]: Launching the whole pipeline 03/13/2025, 16:20:27
2025-03-13 16:20:27,822 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:20:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.35it/s]
2025-03-13 16:20:27,851 [INFO]: There are 2191 embeddings of dim 49152
2025-03-13 16:20:27,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 16:20:27,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:20:27
2025-03-13 16:20:27,852 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:20:27,852 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:20:27,852 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:20:27,852 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:20:27,852 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:20:27
2025-03-13 16:20:27,852 [INFO]: 452.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:20:27,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 16:20:27,852 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:20:27
2025-03-13 16:20:27,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:20:27,852 [INFO]: 	Creating the index 03/13/2025, 16:20:27
2025-03-13 16:20:27,853 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:20:27
2025-03-13 16:20:27,854 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 16:20:27,854 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:20:27
2025-03-13 16:20:27,855 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:20:27,855 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.77it/s] 44%|████▍     | 4/9 [00:00<00:00, 15.55it/s] 78%|███████▊  | 7/9 [00:00<00:00, 18.60it/s]100%|██████████| 9/9 [00:04<00:00,  1.37it/s]100%|██████████| 9/9 [00:04<00:00,  1.99it/s]
2025-03-13 16:20:32,386 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:20:32
2025-03-13 16:21:05,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8143 secs
2025-03-13 16:21:05,201 [INFO]: The best hyperparameters are: efSearch=258
2025-03-13 16:21:05,201 [INFO]: 	Compute fast metrics 03/13/2025, 16:21:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-13 16:21:29,372 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1715 secs
2025-03-13 16:21:29,374 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5195 secs
2025-03-13 16:21:29,374 [INFO]: {
2025-03-13 16:21:29,374 [INFO]: 	index_key: HNSW15
2025-03-13 16:21:29,374 [INFO]: 	index_param: efSearch=258
2025-03-13 16:21:29,374 [INFO]: 	index_path: knn.index
2025-03-13 16:21:29,374 [INFO]: 	size in bytes: 431066050
2025-03-13 16:21:29,374 [INFO]: 	avg_search_speed_ms: 12.54161309192942
2025-03-13 16:21:29,374 [INFO]: 	99p_search_speed_ms: 25.888610417023287
2025-03-13 16:21:29,374 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:21:29,374 [INFO]: 	nb vectors: 2191
2025-03-13 16:21:29,374 [INFO]: 	vectors dimension: 49152
2025-03-13 16:21:29,374 [INFO]: 	compression ratio: 0.9993088715754813
2025-03-13 16:21:29,374 [INFO]: }
2025-03-13 16:21:29,374 [INFO]: 	>>> Finished "Creating the index" in 61.5219 secs
2025-03-13 16:21:29,374 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5524 secs
2025-03-13 16:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 7793 [episode count 5/20]
[retrieval_preprocessing] for episode 51314 [episode count 6/20], we have num_retrieval=np.int64(2198) num_query=np.int64(106)
2025-03-13 16:21:31,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:21:31,553 [INFO]: Launching the whole pipeline 03/13/2025, 16:21:31
2025-03-13 16:21:31,553 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:21:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.69it/s]
2025-03-13 16:21:31,583 [INFO]: There are 2198 embeddings of dim 49152
2025-03-13 16:21:31,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:21:31,583 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:21:31
2025-03-13 16:21:31,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:21:31,583 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:21:31,583 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:21:31,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:21:31,583 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:21:31
2025-03-13 16:21:31,583 [INFO]: 453.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:21:31,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:21:31,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:21:31
2025-03-13 16:21:31,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:21:31,584 [INFO]: 	Creating the index 03/13/2025, 16:21:31
2025-03-13 16:21:31,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:21:31
2025-03-13 16:21:31,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:21:31,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:21:31
2025-03-13 16:21:31,585 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:21:31,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.62it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.14it/s]100%|██████████| 9/9 [00:03<00:00,  2.50it/s]100%|██████████| 9/9 [00:03<00:00,  2.99it/s]
2025-03-13 16:21:34,602 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:21:34
2025-03-13 16:22:11,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6369 secs
2025-03-13 16:22:11,240 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 16:22:11,240 [INFO]: 	Compute fast metrics 03/13/2025, 16:22:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.33it/s]
2025-03-13 16:22:35,640 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4005 secs
2025-03-13 16:22:35,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2220 secs
2025-03-13 16:22:35,807 [INFO]: {
2025-03-13 16:22:35,808 [INFO]: 	index_key: HNSW15
2025-03-13 16:22:35,808 [INFO]: 	index_param: efSearch=238
2025-03-13 16:22:35,808 [INFO]: 	index_path: knn.index
2025-03-13 16:22:35,808 [INFO]: 	size in bytes: 432443230
2025-03-13 16:22:35,808 [INFO]: 	avg_search_speed_ms: 11.79107736504004
2025-03-13 16:22:35,808 [INFO]: 	99p_search_speed_ms: 17.57101599825546
2025-03-13 16:22:35,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:22:35,808 [INFO]: 	nb vectors: 2198
2025-03-13 16:22:35,808 [INFO]: 	vectors dimension: 49152
2025-03-13 16:22:35,808 [INFO]: 	compression ratio: 0.9993089358804391
2025-03-13 16:22:35,808 [INFO]: }
2025-03-13 16:22:35,808 [INFO]: 	>>> Finished "Creating the index" in 64.2245 secs
2025-03-13 16:22:35,808 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2556 secs
2025-03-13 16:22:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:22:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 51314 [episode count 6/20]
[retrieval_preprocessing] for episode 90261 [episode count 7/20], we have num_retrieval=np.int64(2136) num_query=np.int64(168)
2025-03-13 16:22:36,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:22:37,233 [INFO]: Launching the whole pipeline 03/13/2025, 16:22:37
2025-03-13 16:22:37,233 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:22:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.77it/s]
2025-03-13 16:22:37,261 [INFO]: There are 2136 embeddings of dim 49152
2025-03-13 16:22:37,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 16:22:37,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:22:37
2025-03-13 16:22:37,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:22:37,262 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:22:37,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:22:37,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:22:37,262 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:22:37
2025-03-13 16:22:37,262 [INFO]: 440.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:22:37,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:22:37,262 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:22:37
2025-03-13 16:22:37,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:22:37,262 [INFO]: 	Creating the index 03/13/2025, 16:22:37
2025-03-13 16:22:37,262 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:22:37
2025-03-13 16:22:37,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:22:37,263 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:22:37
2025-03-13 16:22:37,263 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:22:37,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.31it/s] 89%|████████▉ | 8/9 [00:00<00:00, 39.26it/s]100%|██████████| 9/9 [00:01<00:00,  5.11it/s]
2025-03-13 16:22:39,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:22:39
2025-03-13 16:23:10,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4574 secs
2025-03-13 16:23:10,485 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 16:23:10,485 [INFO]: 	Compute fast metrics 03/13/2025, 16:23:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.91it/s]
2025-03-13 16:23:33,513 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0283 secs
2025-03-13 16:23:33,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2520 secs
2025-03-13 16:23:33,516 [INFO]: {
2025-03-13 16:23:33,516 [INFO]: 	index_key: HNSW15
2025-03-13 16:23:33,516 [INFO]: 	index_param: efSearch=241
2025-03-13 16:23:33,516 [INFO]: 	index_path: knn.index
2025-03-13 16:23:33,516 [INFO]: 	size in bytes: 420244990
2025-03-13 16:23:33,516 [INFO]: 	avg_search_speed_ms: 12.282425296579829
2025-03-13 16:23:33,516 [INFO]: 	99p_search_speed_ms: 22.584040050860498
2025-03-13 16:23:33,516 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:23:33,516 [INFO]: 	nb vectors: 2136
2025-03-13 16:23:33,516 [INFO]: 	vectors dimension: 49152
2025-03-13 16:23:33,516 [INFO]: 	compression ratio: 0.9993092077076279
2025-03-13 16:23:33,516 [INFO]: }
2025-03-13 16:23:33,516 [INFO]: 	>>> Finished "Creating the index" in 56.2538 secs
2025-03-13 16:23:33,516 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2825 secs
2025-03-13 16:23:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:23:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 90261 [episode count 7/20]
[retrieval_preprocessing] for episode 94369 [episode count 8/20], we have num_retrieval=np.int64(2208) num_query=np.int64(96)
2025-03-13 16:23:35,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:23:36,341 [INFO]: Launching the whole pipeline 03/13/2025, 16:23:36
2025-03-13 16:23:36,341 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:23:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-13 16:23:36,368 [INFO]: There are 2208 embeddings of dim 49152
2025-03-13 16:23:36,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 16:23:36,368 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:23:36
2025-03-13 16:23:36,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:23:36,369 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:23:36,369 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:23:36,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:23:36,369 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:23:36
2025-03-13 16:23:36,369 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:23:36,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:23:36,369 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:23:36
2025-03-13 16:23:36,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:23:36,369 [INFO]: 	Creating the index 03/13/2025, 16:23:36
2025-03-13 16:23:36,369 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:23:36
2025-03-13 16:23:36,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:23:36,370 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:23:36
2025-03-13 16:23:36,371 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:23:36,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.21it/s] 56%|█████▌    | 5/9 [00:00<00:00, 22.05it/s]100%|██████████| 9/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]
2025-03-13 16:23:39,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:23:39
2025-03-13 16:24:15,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7732 secs
2025-03-13 16:24:15,982 [INFO]: The best hyperparameters are: efSearch=189
2025-03-13 16:24:15,982 [INFO]: 	Compute fast metrics 03/13/2025, 16:24:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.67it/s]
2025-03-13 16:24:34,295 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3135 secs
2025-03-13 16:24:34,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9278 secs
2025-03-13 16:24:34,299 [INFO]: {
2025-03-13 16:24:34,299 [INFO]: 	index_key: HNSW15
2025-03-13 16:24:34,300 [INFO]: 	index_param: efSearch=189
2025-03-13 16:24:34,300 [INFO]: 	index_path: knn.index
2025-03-13 16:24:34,300 [INFO]: 	size in bytes: 434410630
2025-03-13 16:24:34,300 [INFO]: 	avg_search_speed_ms: 11.275103502343025
2025-03-13 16:24:34,300 [INFO]: 	99p_search_speed_ms: 16.641156719997525
2025-03-13 16:24:34,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:24:34,300 [INFO]: 	nb vectors: 2208
2025-03-13 16:24:34,300 [INFO]: 	vectors dimension: 49152
2025-03-13 16:24:34,300 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-13 16:24:34,300 [INFO]: }
2025-03-13 16:24:34,300 [INFO]: 	>>> Finished "Creating the index" in 57.9308 secs
2025-03-13 16:24:34,300 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9588 secs
2025-03-13 16:24:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:24:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 94369 [episode count 8/20]
[retrieval_preprocessing] for episode 41645 [episode count 9/20], we have num_retrieval=np.int64(2204) num_query=np.int64(100)
2025-03-13 16:24:35,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:24:36,377 [INFO]: Launching the whole pipeline 03/13/2025, 16:24:36
2025-03-13 16:24:36,377 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:24:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1223.90it/s]
2025-03-13 16:24:36,419 [INFO]: There are 2204 embeddings of dim 49152
2025-03-13 16:24:36,420 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0423 secs
2025-03-13 16:24:36,420 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:24:36
2025-03-13 16:24:36,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:24:36,420 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:24:36,420 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:24:36,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:24:36,420 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:24:36
2025-03-13 16:24:36,420 [INFO]: 454.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:24:36,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:24:36,421 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:24:36
2025-03-13 16:24:36,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:24:36,421 [INFO]: 	Creating the index 03/13/2025, 16:24:36
2025-03-13 16:24:36,421 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:24:36
2025-03-13 16:24:36,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 16:24:36,423 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:24:36
2025-03-13 16:24:36,423 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:24:36,423 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.60it/s] 44%|████▍     | 4/9 [00:00<00:00, 15.23it/s] 78%|███████▊  | 7/9 [00:00<00:00, 19.53it/s]100%|██████████| 9/9 [00:02<00:00,  3.30it/s]
2025-03-13 16:24:39,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:24:39
2025-03-13 16:25:16,238 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0795 secs
2025-03-13 16:25:16,238 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 16:25:16,238 [INFO]: 	Compute fast metrics 03/13/2025, 16:25:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 16:25:37,607 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3686 secs
2025-03-13 16:25:38,275 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8519 secs
2025-03-13 16:25:38,275 [INFO]: {
2025-03-13 16:25:38,275 [INFO]: 	index_key: HNSW15
2025-03-13 16:25:38,275 [INFO]: 	index_param: efSearch=211
2025-03-13 16:25:38,275 [INFO]: 	index_path: knn.index
2025-03-13 16:25:38,275 [INFO]: 	size in bytes: 433623670
2025-03-13 16:25:38,275 [INFO]: 	avg_search_speed_ms: 10.519396280380187
2025-03-13 16:25:38,275 [INFO]: 	99p_search_speed_ms: 20.7340600900352
2025-03-13 16:25:38,276 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:25:38,276 [INFO]: 	nb vectors: 2204
2025-03-13 16:25:38,276 [INFO]: 	vectors dimension: 49152
2025-03-13 16:25:38,276 [INFO]: 	compression ratio: 0.9993089906738717
2025-03-13 16:25:38,276 [INFO]: }
2025-03-13 16:25:38,276 [INFO]: 	>>> Finished "Creating the index" in 61.8549 secs
2025-03-13 16:25:38,276 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8984 secs
2025-03-13 16:25:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:25:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 41645 [episode count 9/20]
[retrieval_preprocessing] for episode 30002 [episode count 10/20], we have num_retrieval=np.int64(2212) num_query=np.int64(92)
2025-03-13 16:25:39,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:25:39,875 [INFO]: Launching the whole pipeline 03/13/2025, 16:25:39
2025-03-13 16:25:39,875 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:25:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.15it/s]
2025-03-13 16:25:39,903 [INFO]: There are 2212 embeddings of dim 49152
2025-03-13 16:25:39,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 16:25:39,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:25:39
2025-03-13 16:25:39,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:25:39,904 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:25:39,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:25:39,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:25:39,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:25:39
2025-03-13 16:25:39,904 [INFO]: 456.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:25:39,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:25:39,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:25:39
2025-03-13 16:25:39,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:25:39,904 [INFO]: 	Creating the index 03/13/2025, 16:25:39
2025-03-13 16:25:39,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:25:39
2025-03-13 16:25:39,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:25:39,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:25:39
2025-03-13 16:25:39,906 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:25:39,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.36it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.92it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]100%|██████████| 9/9 [00:02<00:00,  4.24it/s]
2025-03-13 16:25:42,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:25:42
2025-03-13 16:26:13,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9047 secs
2025-03-13 16:26:13,937 [INFO]: The best hyperparameters are: efSearch=302
2025-03-13 16:26:13,937 [INFO]: 	Compute fast metrics 03/13/2025, 16:26:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.10it/s]
2025-03-13 16:26:46,240 [INFO]: 	>>> Finished "Compute fast metrics" in 32.3029 secs
2025-03-13 16:26:46,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3357 secs
2025-03-13 16:26:46,241 [INFO]: {
2025-03-13 16:26:46,241 [INFO]: 	index_key: HNSW15
2025-03-13 16:26:46,241 [INFO]: 	index_param: efSearch=302
2025-03-13 16:26:46,241 [INFO]: 	index_path: knn.index
2025-03-13 16:26:46,242 [INFO]: 	size in bytes: 435197590
2025-03-13 16:26:46,242 [INFO]: 	avg_search_speed_ms: 13.543982392413913
2025-03-13 16:26:46,242 [INFO]: 	99p_search_speed_ms: 23.3392132865265
2025-03-13 16:26:46,242 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:26:46,242 [INFO]: 	nb vectors: 2212
2025-03-13 16:26:46,242 [INFO]: 	vectors dimension: 49152
2025-03-13 16:26:46,242 [INFO]: 	compression ratio: 0.9993090632693991
2025-03-13 16:26:46,242 [INFO]: }
2025-03-13 16:26:46,242 [INFO]: 	>>> Finished "Creating the index" in 66.3374 secs
2025-03-13 16:26:46,242 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3668 secs
2025-03-13 16:26:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 30002 [episode count 10/20]
[retrieval_preprocessing] for episode 32564 [episode count 11/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 16:26:47,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:26:48,236 [INFO]: Launching the whole pipeline 03/13/2025, 16:26:48
2025-03-13 16:26:48,236 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1946.31it/s]
2025-03-13 16:26:48,263 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 16:26:48,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:26:48,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:26:48
2025-03-13 16:26:48,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:26:48,264 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:26:48,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:26:48,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:26:48,265 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:26:48
2025-03-13 16:26:48,265 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:26:48,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:26:48,265 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:26:48
2025-03-13 16:26:48,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:26:48,265 [INFO]: 	Creating the index 03/13/2025, 16:26:48
2025-03-13 16:26:48,266 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:26:48
2025-03-13 16:26:48,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:26:48,269 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:26:48
2025-03-13 16:26:48,269 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:26:48,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.70it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.01it/s]100%|██████████| 9/9 [00:01<00:00,  5.12it/s]
2025-03-13 16:26:50,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:26:50
2025-03-13 16:27:31,122 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0895 secs
2025-03-13 16:27:31,123 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 16:27:31,123 [INFO]: 	Compute fast metrics 03/13/2025, 16:27:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.71it/s]
2025-03-13 16:27:49,301 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1782 secs
2025-03-13 16:27:49,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0334 secs
2025-03-13 16:27:49,303 [INFO]: {
2025-03-13 16:27:49,303 [INFO]: 	index_key: HNSW15
2025-03-13 16:27:49,303 [INFO]: 	index_param: efSearch=216
2025-03-13 16:27:49,303 [INFO]: 	index_path: knn.index
2025-03-13 16:27:49,303 [INFO]: 	size in bytes: 432246490
2025-03-13 16:27:49,303 [INFO]: 	avg_search_speed_ms: 10.761976096452292
2025-03-13 16:27:49,303 [INFO]: 	99p_search_speed_ms: 16.36941652745009
2025-03-13 16:27:49,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:27:49,303 [INFO]: 	nb vectors: 2197
2025-03-13 16:27:49,303 [INFO]: 	vectors dimension: 49152
2025-03-13 16:27:49,303 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 16:27:49,303 [INFO]: }
2025-03-13 16:27:49,303 [INFO]: 	>>> Finished "Creating the index" in 61.0375 secs
2025-03-13 16:27:49,303 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0666 secs
2025-03-13 16:27:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:27:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 32564 [episode count 11/20]
[retrieval_preprocessing] for episode 89823 [episode count 12/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 16:27:50,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:27:50,661 [INFO]: Launching the whole pipeline 03/13/2025, 16:27:50
2025-03-13 16:27:50,661 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:27:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2473.06it/s]
2025-03-13 16:27:50,685 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 16:27:50,685 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 16:27:50,685 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:27:50
2025-03-13 16:27:50,685 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:27:50,685 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:27:50,686 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:27:50,686 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:27:50,686 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:27:50
2025-03-13 16:27:50,686 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:27:50,686 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:27:50,686 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:27:50
2025-03-13 16:27:50,686 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:27:50,686 [INFO]: 	Creating the index 03/13/2025, 16:27:50
2025-03-13 16:27:50,686 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:27:50
2025-03-13 16:27:50,687 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:27:50,687 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:27:50
2025-03-13 16:27:50,687 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:27:50,687 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.55it/s] 67%|██████▋   | 6/9 [00:00<00:00, 32.24it/s]100%|██████████| 9/9 [00:01<00:00,  5.25it/s]
2025-03-13 16:27:52,407 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:27:52
2025-03-13 16:28:21,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1417 secs
2025-03-13 16:28:21,550 [INFO]: The best hyperparameters are: efSearch=268
2025-03-13 16:28:21,550 [INFO]: 	Compute fast metrics 03/13/2025, 16:28:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.45it/s]
2025-03-13 16:28:42,141 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5911 secs
2025-03-13 16:28:42,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4551 secs
2025-03-13 16:28:42,143 [INFO]: {
2025-03-13 16:28:42,143 [INFO]: 	index_key: HNSW15
2025-03-13 16:28:42,143 [INFO]: 	index_param: efSearch=268
2025-03-13 16:28:42,143 [INFO]: 	index_path: knn.index
2025-03-13 16:28:42,143 [INFO]: 	size in bytes: 432246490
2025-03-13 16:28:42,143 [INFO]: 	avg_search_speed_ms: 9.817819149663874
2025-03-13 16:28:42,143 [INFO]: 	99p_search_speed_ms: 13.45084083266556
2025-03-13 16:28:42,143 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:28:42,143 [INFO]: 	nb vectors: 2197
2025-03-13 16:28:42,143 [INFO]: 	vectors dimension: 49152
2025-03-13 16:28:42,143 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 16:28:42,143 [INFO]: }
2025-03-13 16:28:42,143 [INFO]: 	>>> Finished "Creating the index" in 51.4568 secs
2025-03-13 16:28:42,143 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4819 secs
2025-03-13 16:28:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:28:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 89823 [episode count 12/20]
[retrieval_preprocessing] for episode 36694 [episode count 13/20], we have num_retrieval=np.int64(2205) num_query=np.int64(99)
2025-03-13 16:28:43,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:28:43,973 [INFO]: Launching the whole pipeline 03/13/2025, 16:28:43
2025-03-13 16:28:43,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:28:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-13 16:28:43,997 [INFO]: There are 2205 embeddings of dim 49152
2025-03-13 16:28:43,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 16:28:43,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:28:43
2025-03-13 16:28:43,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:28:43,997 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:28:43,997 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:28:43,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:28:43,997 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:28:43
2025-03-13 16:28:43,997 [INFO]: 455.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:28:43,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:28:43,997 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:28:43
2025-03-13 16:28:43,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:28:43,997 [INFO]: 	Creating the index 03/13/2025, 16:28:43
2025-03-13 16:28:43,997 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:28:43
2025-03-13 16:28:43,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:28:43,998 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:28:43
2025-03-13 16:28:43,998 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:28:43,998 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.31it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.90it/s]100%|██████████| 9/9 [00:01<00:00,  4.71it/s]
2025-03-13 16:28:45,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:28:45
2025-03-13 16:29:18,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9597 secs
2025-03-13 16:29:18,873 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 16:29:18,873 [INFO]: 	Compute fast metrics 03/13/2025, 16:29:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.86it/s]
2025-03-13 16:29:39,979 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1056 secs
2025-03-13 16:29:39,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9824 secs
2025-03-13 16:29:39,981 [INFO]: {
2025-03-13 16:29:39,981 [INFO]: 	index_key: HNSW15
2025-03-13 16:29:39,981 [INFO]: 	index_param: efSearch=220
2025-03-13 16:29:39,981 [INFO]: 	index_path: knn.index
2025-03-13 16:29:39,981 [INFO]: 	size in bytes: 433820410
2025-03-13 16:29:39,981 [INFO]: 	avg_search_speed_ms: 11.715656966494453
2025-03-13 16:29:39,981 [INFO]: 	99p_search_speed_ms: 17.760855520609766
2025-03-13 16:29:39,981 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:29:39,981 [INFO]: 	nb vectors: 2205
2025-03-13 16:29:39,981 [INFO]: 	vectors dimension: 49152
2025-03-13 16:29:39,981 [INFO]: 	compression ratio: 0.9993089997771197
2025-03-13 16:29:39,981 [INFO]: }
2025-03-13 16:29:39,981 [INFO]: 	>>> Finished "Creating the index" in 55.9839 secs
2025-03-13 16:29:39,981 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0081 secs
2025-03-13 16:29:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:29:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 36694 [episode count 13/20]
[retrieval_preprocessing] for episode 39770 [episode count 14/20], we have num_retrieval=np.int64(2188) num_query=np.int64(116)
2025-03-13 16:29:41,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:29:41,814 [INFO]: Launching the whole pipeline 03/13/2025, 16:29:41
2025-03-13 16:29:41,814 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:29:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2371.00it/s]
2025-03-13 16:29:41,836 [INFO]: There are 2188 embeddings of dim 49152
2025-03-13 16:29:41,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-13 16:29:41,836 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:29:41
2025-03-13 16:29:41,836 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:29:41,836 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:29:41,836 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:29:41,836 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:29:41,836 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:29:41
2025-03-13 16:29:41,837 [INFO]: 451.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:29:41,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:29:41,837 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:29:41
2025-03-13 16:29:41,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:29:41,837 [INFO]: 	Creating the index 03/13/2025, 16:29:41
2025-03-13 16:29:41,837 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:29:41
2025-03-13 16:29:41,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:29:41,838 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:29:41
2025-03-13 16:29:41,838 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:29:41,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.41it/s] 56%|█████▌    | 5/9 [00:00<00:00, 22.73it/s] 89%|████████▉ | 8/9 [00:00<00:00, 25.11it/s]100%|██████████| 9/9 [00:02<00:00,  3.18it/s]
2025-03-13 16:29:44,668 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:29:44
2025-03-13 16:30:15,958 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2902 secs
2025-03-13 16:30:15,959 [INFO]: The best hyperparameters are: efSearch=158
2025-03-13 16:30:15,959 [INFO]: 	Compute fast metrics 03/13/2025, 16:30:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.74it/s]
2025-03-13 16:30:31,623 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6640 secs
2025-03-13 16:30:31,625 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7869 secs
2025-03-13 16:30:31,625 [INFO]: {
2025-03-13 16:30:31,625 [INFO]: 	index_key: HNSW15
2025-03-13 16:30:31,625 [INFO]: 	index_param: efSearch=158
2025-03-13 16:30:31,625 [INFO]: 	index_path: knn.index
2025-03-13 16:30:31,625 [INFO]: 	size in bytes: 430475830
2025-03-13 16:30:31,625 [INFO]: 	avg_search_speed_ms: 7.8665028750474395
2025-03-13 16:30:31,625 [INFO]: 	99p_search_speed_ms: 10.747643304057416
2025-03-13 16:30:31,625 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:30:31,625 [INFO]: 	nb vectors: 2188
2025-03-13 16:30:31,625 [INFO]: 	vectors dimension: 49152
2025-03-13 16:30:31,625 [INFO]: 	compression ratio: 0.9993088438902598
2025-03-13 16:30:31,625 [INFO]: }
2025-03-13 16:30:31,625 [INFO]: 	>>> Finished "Creating the index" in 49.7883 secs
2025-03-13 16:30:31,625 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8112 secs
2025-03-13 16:30:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:30:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 39770 [episode count 14/20]
[retrieval_preprocessing] for episode 93546 [episode count 15/20], we have num_retrieval=np.int64(2197) num_query=np.int64(107)
2025-03-13 16:30:32,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:30:33,855 [INFO]: Launching the whole pipeline 03/13/2025, 16:30:33
2025-03-13 16:30:33,855 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:30:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1766.77it/s]
2025-03-13 16:30:34,077 [INFO]: There are 2197 embeddings of dim 49152
2025-03-13 16:30:34,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2221 secs
2025-03-13 16:30:34,077 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:30:34
2025-03-13 16:30:34,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:30:34,077 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:30:34,077 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:30:34,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:30:34,077 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:30:34
2025-03-13 16:30:34,078 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:30:34,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:30:34,078 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:30:34
2025-03-13 16:30:34,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:30:34,078 [INFO]: 	Creating the index 03/13/2025, 16:30:34
2025-03-13 16:30:34,078 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:30:34
2025-03-13 16:30:34,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 16:30:34,079 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:30:34
2025-03-13 16:30:34,079 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:30:34,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.34it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.74it/s]100%|██████████| 9/9 [00:01<00:00,  4.96it/s]
2025-03-13 16:30:35,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:30:35
2025-03-13 16:31:09,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1774 secs
2025-03-13 16:31:09,076 [INFO]: The best hyperparameters are: efSearch=213
2025-03-13 16:31:09,076 [INFO]: 	Compute fast metrics 03/13/2025, 16:31:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-13 16:31:33,265 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1884 secs
2025-03-13 16:31:33,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1877 secs
2025-03-13 16:31:33,267 [INFO]: {
2025-03-13 16:31:33,267 [INFO]: 	index_key: HNSW15
2025-03-13 16:31:33,267 [INFO]: 	index_param: efSearch=213
2025-03-13 16:31:33,267 [INFO]: 	index_path: knn.index
2025-03-13 16:31:33,267 [INFO]: 	size in bytes: 432246490
2025-03-13 16:31:33,267 [INFO]: 	avg_search_speed_ms: 10.3530329722028
2025-03-13 16:31:33,267 [INFO]: 	99p_search_speed_ms: 14.283766679000115
2025-03-13 16:31:33,267 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:31:33,267 [INFO]: 	nb vectors: 2197
2025-03-13 16:31:33,267 [INFO]: 	vectors dimension: 49152
2025-03-13 16:31:33,267 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-13 16:31:33,267 [INFO]: }
2025-03-13 16:31:33,267 [INFO]: 	>>> Finished "Creating the index" in 59.1890 secs
2025-03-13 16:31:33,267 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4117 secs
2025-03-13 16:31:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:31:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 93546 [episode count 15/20]
[retrieval_preprocessing] for episode 47548 [episode count 16/20], we have num_retrieval=np.int64(2166) num_query=np.int64(138)
2025-03-13 16:31:34,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:31:35,144 [INFO]: Launching the whole pipeline 03/13/2025, 16:31:35
2025-03-13 16:31:35,144 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:31:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 16:31:35,168 [INFO]: There are 2166 embeddings of dim 49152
2025-03-13 16:31:35,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 16:31:35,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:31:35
2025-03-13 16:31:35,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:31:35,169 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:31:35,169 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:31:35,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:31:35,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:31:35
2025-03-13 16:31:35,169 [INFO]: 447.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:31:35,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:31:35,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:31:35
2025-03-13 16:31:35,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:31:35,169 [INFO]: 	Creating the index 03/13/2025, 16:31:35
2025-03-13 16:31:35,169 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:31:35
2025-03-13 16:31:35,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:31:35,170 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:31:35
2025-03-13 16:31:35,170 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:31:35,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.64it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.20it/s]100%|██████████| 9/9 [00:02<00:00,  3.36it/s]100%|██████████| 9/9 [00:02<00:00,  4.13it/s]
2025-03-13 16:31:37,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:31:37
2025-03-13 16:32:06,250 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8959 secs
2025-03-13 16:32:06,251 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 16:32:06,251 [INFO]: 	Compute fast metrics 03/13/2025, 16:32:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 16:32:31,664 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4128 secs
2025-03-13 16:32:31,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4953 secs
2025-03-13 16:32:31,665 [INFO]: {
2025-03-13 16:32:31,665 [INFO]: 	index_key: HNSW15
2025-03-13 16:32:31,665 [INFO]: 	index_param: efSearch=273
2025-03-13 16:32:31,665 [INFO]: 	index_path: knn.index
2025-03-13 16:32:31,665 [INFO]: 	size in bytes: 426147310
2025-03-13 16:32:31,665 [INFO]: 	avg_search_speed_ms: 11.446879610037794
2025-03-13 16:32:31,665 [INFO]: 	99p_search_speed_ms: 15.248362452257425
2025-03-13 16:32:31,665 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:32:31,665 [INFO]: 	nb vectors: 2166
2025-03-13 16:32:31,665 [INFO]: 	vectors dimension: 49152
2025-03-13 16:32:31,666 [INFO]: 	compression ratio: 0.9993092013182014
2025-03-13 16:32:31,666 [INFO]: }
2025-03-13 16:32:31,666 [INFO]: 	>>> Finished "Creating the index" in 56.4967 secs
2025-03-13 16:32:31,666 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5212 secs
2025-03-13 16:32:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:32:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 47548 [episode count 16/20]
[retrieval_preprocessing] for episode 63919 [episode count 17/20], we have num_retrieval=np.int64(2182) num_query=np.int64(122)
2025-03-13 16:32:33,573 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:32:33,911 [INFO]: Launching the whole pipeline 03/13/2025, 16:32:33
2025-03-13 16:32:33,911 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:32:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1627.59it/s]
2025-03-13 16:32:33,937 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 16:32:33,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 16:32:33,938 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:32:33
2025-03-13 16:32:33,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:32:33,939 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:32:33,939 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:32:33,939 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:32:33,939 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:32:33
2025-03-13 16:32:33,939 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:32:33,940 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:32:33,940 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:32:33
2025-03-13 16:32:33,940 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:32:33,940 [INFO]: 	Creating the index 03/13/2025, 16:32:33
2025-03-13 16:32:33,940 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:32:33
2025-03-13 16:32:33,943 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:32:33,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:32:33
2025-03-13 16:32:33,944 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:32:33,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.34it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.51it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 16:32:36,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:32:36
2025-03-13 16:33:10,427 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3087 secs
2025-03-13 16:33:10,427 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 16:33:10,427 [INFO]: 	Compute fast metrics 03/13/2025, 16:33:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.30it/s]
2025-03-13 16:33:38,936 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5089 secs
2025-03-13 16:33:38,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9941 secs
2025-03-13 16:33:38,938 [INFO]: {
2025-03-13 16:33:38,938 [INFO]: 	index_key: HNSW15
2025-03-13 16:33:38,938 [INFO]: 	index_param: efSearch=218
2025-03-13 16:33:38,938 [INFO]: 	index_path: knn.index
2025-03-13 16:33:38,938 [INFO]: 	size in bytes: 429295270
2025-03-13 16:33:38,938 [INFO]: 	avg_search_speed_ms: 10.67849323889012
2025-03-13 16:33:38,938 [INFO]: 	99p_search_speed_ms: 16.76605853252113
2025-03-13 16:33:38,938 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:33:38,938 [INFO]: 	nb vectors: 2182
2025-03-13 16:33:38,938 [INFO]: 	vectors dimension: 49152
2025-03-13 16:33:38,938 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 16:33:38,938 [INFO]: }
2025-03-13 16:33:38,938 [INFO]: 	>>> Finished "Creating the index" in 64.9982 secs
2025-03-13 16:33:38,938 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0273 secs
2025-03-13 16:33:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:33:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 63919 [episode count 17/20]
[retrieval_preprocessing] for episode 52684 [episode count 18/20], we have num_retrieval=np.int64(2165) num_query=np.int64(139)
2025-03-13 16:33:40,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:33:40,451 [INFO]: Launching the whole pipeline 03/13/2025, 16:33:40
2025-03-13 16:33:40,451 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:33:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 947.44it/s]
2025-03-13 16:33:40,477 [INFO]: There are 2165 embeddings of dim 49152
2025-03-13 16:33:40,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 16:33:40,478 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:33:40
2025-03-13 16:33:40,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:33:40,478 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:33:40,478 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:33:40,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:33:40,478 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:33:40
2025-03-13 16:33:40,478 [INFO]: 446.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:33:40,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:33:40,478 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:33:40
2025-03-13 16:33:40,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:33:40,478 [INFO]: 	Creating the index 03/13/2025, 16:33:40
2025-03-13 16:33:40,478 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:33:40
2025-03-13 16:33:40,479 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:33:40,479 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:33:40
2025-03-13 16:33:40,479 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:33:40,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.97it/s] 67%|██████▋   | 6/9 [00:00<00:00, 27.34it/s]100%|██████████| 9/9 [00:01<00:00,  3.78it/s]100%|██████████| 9/9 [00:01<00:00,  4.61it/s]
2025-03-13 16:33:42,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:33:42
2025-03-13 16:34:21,297 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8592 secs
2025-03-13 16:34:21,297 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 16:34:21,297 [INFO]: 	Compute fast metrics 03/13/2025, 16:34:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.20it/s]
2025-03-13 16:34:41,214 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9163 secs
2025-03-13 16:34:41,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7362 secs
2025-03-13 16:34:41,216 [INFO]: {
2025-03-13 16:34:41,216 [INFO]: 	index_key: HNSW15
2025-03-13 16:34:41,216 [INFO]: 	index_param: efSearch=187
2025-03-13 16:34:41,216 [INFO]: 	index_path: knn.index
2025-03-13 16:34:41,216 [INFO]: 	size in bytes: 425950570
2025-03-13 16:34:41,216 [INFO]: 	avg_search_speed_ms: 9.23080069298179
2025-03-13 16:34:41,216 [INFO]: 	99p_search_speed_ms: 12.654256732203075
2025-03-13 16:34:41,216 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:34:41,216 [INFO]: 	nb vectors: 2165
2025-03-13 16:34:41,216 [INFO]: 	vectors dimension: 49152
2025-03-13 16:34:41,216 [INFO]: 	compression ratio: 0.9993091921440556
2025-03-13 16:34:41,216 [INFO]: }
2025-03-13 16:34:41,216 [INFO]: 	>>> Finished "Creating the index" in 60.7377 secs
2025-03-13 16:34:41,216 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7651 secs
2025-03-13 16:34:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:34:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 52684 [episode count 18/20]
[retrieval_preprocessing] for episode 81876 [episode count 19/20], we have num_retrieval=np.int64(2207) num_query=np.int64(97)
2025-03-13 16:34:44,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:34:45,149 [INFO]: Launching the whole pipeline 03/13/2025, 16:34:45
2025-03-13 16:34:45,149 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:34:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 883.76it/s]
2025-03-13 16:34:45,178 [INFO]: There are 2207 embeddings of dim 49152
2025-03-13 16:34:45,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-13 16:34:45,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:34:45
2025-03-13 16:34:45,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:34:45,179 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:34:45,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:34:45,180 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:34:45,180 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:34:45
2025-03-13 16:34:45,180 [INFO]: 455.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:34:45,180 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:34:45,180 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:34:45
2025-03-13 16:34:45,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:34:45,181 [INFO]: 	Creating the index 03/13/2025, 16:34:45
2025-03-13 16:34:45,181 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:34:45
2025-03-13 16:34:45,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 16:34:45,184 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:34:45
2025-03-13 16:34:45,185 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:34:45,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.38it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.40it/s]100%|██████████| 9/9 [00:02<00:00,  3.26it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-13 16:34:47,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:34:47
2025-03-13 16:35:19,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1149 secs
2025-03-13 16:35:19,475 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 16:35:19,475 [INFO]: 	Compute fast metrics 03/13/2025, 16:35:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.80it/s]
2025-03-13 16:35:44,349 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8737 secs
2025-03-13 16:35:44,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1660 secs
2025-03-13 16:35:44,351 [INFO]: {
2025-03-13 16:35:44,351 [INFO]: 	index_key: HNSW15
2025-03-13 16:35:44,351 [INFO]: 	index_param: efSearch=236
2025-03-13 16:35:44,351 [INFO]: 	index_path: knn.index
2025-03-13 16:35:44,351 [INFO]: 	size in bytes: 434213890
2025-03-13 16:35:44,351 [INFO]: 	avg_search_speed_ms: 10.12500485585369
2025-03-13 16:35:44,351 [INFO]: 	99p_search_speed_ms: 15.77941364375874
2025-03-13 16:35:44,351 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:35:44,351 [INFO]: 	nb vectors: 2207
2025-03-13 16:35:44,351 [INFO]: 	vectors dimension: 49152
2025-03-13 16:35:44,351 [INFO]: 	compression ratio: 0.9993090179588682
2025-03-13 16:35:44,351 [INFO]: }
2025-03-13 16:35:44,351 [INFO]: 	>>> Finished "Creating the index" in 59.1700 secs
2025-03-13 16:35:44,351 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2020 secs
2025-03-13 16:35:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:35:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 81876 [episode count 19/20]
2025-03-13 16:35:45: [retrieval_preprocessing] finished for 3163748394_put_rubiks_cube_on_shelf [chosen_id count 3/196]
2025-03-13 16:35:46: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3163748394_put_orange_object_in_blue_cup [chosen_id count 4/196]
2025-03-13 16:35:46: [retrieval_preprocessing] we have num_total=2263 embedding_dim=49152
[retrieval_preprocessing] for episode 26628 [episode count 0/20], we have num_retrieval=np.int64(2146) num_query=np.int64(117)
2025-03-13 16:35:47,096 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:35:47,460 [INFO]: Launching the whole pipeline 03/13/2025, 16:35:47
2025-03-13 16:35:47,460 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:35:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.29it/s]
2025-03-13 16:35:47,488 [INFO]: There are 2146 embeddings of dim 49152
2025-03-13 16:35:47,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:35:47,489 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:35:47
2025-03-13 16:35:47,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:35:47,489 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:35:47,489 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:35:47,489 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:35:47,489 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:35:47
2025-03-13 16:35:47,489 [INFO]: 442.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:35:47,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:35:47,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:35:47
2025-03-13 16:35:47,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:35:47,489 [INFO]: 	Creating the index 03/13/2025, 16:35:47
2025-03-13 16:35:47,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:35:47
2025-03-13 16:35:47,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:35:47,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:35:47
2025-03-13 16:35:47,491 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:35:47,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.23it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.71it/s]100%|██████████| 9/9 [00:01<00:00,  5.41it/s]
2025-03-13 16:35:49,160 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:35:49
2025-03-13 16:36:23,002 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8417 secs
2025-03-13 16:36:23,003 [INFO]: The best hyperparameters are: efSearch=201
2025-03-13 16:36:23,003 [INFO]: 	Compute fast metrics 03/13/2025, 16:36:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 16:36:45,119 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1161 secs
2025-03-13 16:36:45,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1553 secs
2025-03-13 16:36:45,647 [INFO]: {
2025-03-13 16:36:45,647 [INFO]: 	index_key: HNSW15
2025-03-13 16:36:45,647 [INFO]: 	index_param: efSearch=201
2025-03-13 16:36:45,647 [INFO]: 	index_path: knn.index
2025-03-13 16:36:45,647 [INFO]: 	size in bytes: 422212450
2025-03-13 16:36:45,647 [INFO]: 	avg_search_speed_ms: 11.74861432127567
2025-03-13 16:36:45,647 [INFO]: 	99p_search_speed_ms: 16.2385645089671
2025-03-13 16:36:45,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:36:45,647 [INFO]: 	nb vectors: 2146
2025-03-13 16:36:45,647 [INFO]: 	vectors dimension: 49152
2025-03-13 16:36:45,647 [INFO]: 	compression ratio: 0.9993091582211752
2025-03-13 16:36:45,647 [INFO]: }
2025-03-13 16:36:45,647 [INFO]: 	>>> Finished "Creating the index" in 58.1580 secs
2025-03-13 16:36:45,647 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1870 secs
2025-03-13 16:36:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:36:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 26628 [episode count 0/20]
[retrieval_preprocessing] for episode 25628 [episode count 1/20], we have num_retrieval=np.int64(2162) num_query=np.int64(101)
2025-03-13 16:36:47,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:36:47,854 [INFO]: Launching the whole pipeline 03/13/2025, 16:36:47
2025-03-13 16:36:47,854 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:36:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1897.02it/s]
2025-03-13 16:36:47,880 [INFO]: There are 2162 embeddings of dim 49152
2025-03-13 16:36:47,880 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 16:36:47,880 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,880 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:36:47,880 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:36:47,880 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:36:47,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:36:47,881 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,881 [INFO]: 446.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:36:47,881 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:36:47,881 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:36:47
2025-03-13 16:36:47,881 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:36:47,881 [INFO]: 	Creating the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,881 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:36:47
2025-03-13 16:36:47,882 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:36:47,882 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:36:47
2025-03-13 16:36:47,882 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:36:47,882 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.27it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.19it/s]100%|██████████| 9/9 [00:02<00:00,  3.03it/s]100%|██████████| 9/9 [00:02<00:00,  3.60it/s]
2025-03-13 16:36:50,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:36:50
2025-03-13 16:37:21,729 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3445 secs
2025-03-13 16:37:21,729 [INFO]: The best hyperparameters are: efSearch=156
2025-03-13 16:37:21,729 [INFO]: 	Compute fast metrics 03/13/2025, 16:37:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.86it/s]
2025-03-13 16:37:40,687 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9578 secs
2025-03-13 16:37:40,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8063 secs
2025-03-13 16:37:40,689 [INFO]: {
2025-03-13 16:37:40,689 [INFO]: 	index_key: HNSW15
2025-03-13 16:37:40,689 [INFO]: 	index_param: efSearch=156
2025-03-13 16:37:40,689 [INFO]: 	index_path: knn.index
2025-03-13 16:37:40,689 [INFO]: 	size in bytes: 425360350
2025-03-13 16:37:40,689 [INFO]: 	avg_search_speed_ms: 7.938362253157215
2025-03-13 16:37:40,689 [INFO]: 	99p_search_speed_ms: 10.273544630035763
2025-03-13 16:37:40,689 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:37:40,689 [INFO]: 	nb vectors: 2162
2025-03-13 16:37:40,689 [INFO]: 	vectors dimension: 49152
2025-03-13 16:37:40,689 [INFO]: 	compression ratio: 0.9993091645706987
2025-03-13 16:37:40,689 [INFO]: }
2025-03-13 16:37:40,689 [INFO]: 	>>> Finished "Creating the index" in 52.8080 secs
2025-03-13 16:37:40,689 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8349 secs
2025-03-13 16:37:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:37:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 25628 [episode count 1/20]
[retrieval_preprocessing] for episode 12390 [episode count 2/20], we have num_retrieval=np.int64(2184) num_query=np.int64(79)
2025-03-13 16:37:41,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:37:42,695 [INFO]: Launching the whole pipeline 03/13/2025, 16:37:42
2025-03-13 16:37:42,695 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:37:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2149.82it/s]
2025-03-13 16:37:42,721 [INFO]: There are 2184 embeddings of dim 49152
2025-03-13 16:37:42,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:37:42,721 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:37:42
2025-03-13 16:37:42,721 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:37:42,721 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:37:42,721 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:37:42,721 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:37:42,721 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:37:42
2025-03-13 16:37:42,721 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:37:42,721 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:37:42,721 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:37:42
2025-03-13 16:37:42,721 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:37:42,721 [INFO]: 	Creating the index 03/13/2025, 16:37:42
2025-03-13 16:37:42,721 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:37:42
2025-03-13 16:37:42,722 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:37:42,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:37:42
2025-03-13 16:37:42,723 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:37:42,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.34it/s] 67%|██████▋   | 6/9 [00:00<00:00, 32.12it/s]100%|██████████| 9/9 [00:01<00:00,  5.36it/s]
2025-03-13 16:37:44,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:37:44
2025-03-13 16:38:17,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8992 secs
2025-03-13 16:38:17,305 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 16:38:17,305 [INFO]: 	Compute fast metrics 03/13/2025, 16:38:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s]
2025-03-13 16:38:40,145 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8400 secs
2025-03-13 16:38:40,149 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4259 secs
2025-03-13 16:38:40,149 [INFO]: {
2025-03-13 16:38:40,149 [INFO]: 	index_key: HNSW15
2025-03-13 16:38:40,149 [INFO]: 	index_param: efSearch=139
2025-03-13 16:38:40,149 [INFO]: 	index_path: knn.index
2025-03-13 16:38:40,149 [INFO]: 	size in bytes: 429688750
2025-03-13 16:38:40,149 [INFO]: 	avg_search_speed_ms: 16.800700774134583
2025-03-13 16:38:40,149 [INFO]: 	99p_search_speed_ms: 42.39123695529992
2025-03-13 16:38:40,149 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:38:40,149 [INFO]: 	nb vectors: 2184
2025-03-13 16:38:40,149 [INFO]: 	vectors dimension: 49152
2025-03-13 16:38:40,149 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-13 16:38:40,149 [INFO]: }
2025-03-13 16:38:40,149 [INFO]: 	>>> Finished "Creating the index" in 57.4276 secs
2025-03-13 16:38:40,149 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4538 secs
2025-03-13 16:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:38:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 12390 [episode count 2/20]
[retrieval_preprocessing] for episode 67170 [episode count 3/20], we have num_retrieval=np.int64(2169) num_query=np.int64(94)
2025-03-13 16:38:41,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:38:42,396 [INFO]: Launching the whole pipeline 03/13/2025, 16:38:42
2025-03-13 16:38:42,396 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:38:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1302.17it/s]
2025-03-13 16:38:42,424 [INFO]: There are 2169 embeddings of dim 49152
2025-03-13 16:38:42,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 16:38:42,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:38:42
2025-03-13 16:38:42,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:38:42,425 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:38:42,425 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:38:42,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:38:42,425 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:38:42
2025-03-13 16:38:42,425 [INFO]: 447.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:38:42,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:38:42,426 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:38:42
2025-03-13 16:38:42,426 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:38:42,426 [INFO]: 	Creating the index 03/13/2025, 16:38:42
2025-03-13 16:38:42,426 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:38:42
2025-03-13 16:38:42,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:38:42,429 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:38:42
2025-03-13 16:38:42,429 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:38:42,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.80it/s] 56%|█████▌    | 5/9 [00:00<00:00, 24.12it/s]100%|██████████| 9/9 [00:02<00:00,  2.92it/s]100%|██████████| 9/9 [00:02<00:00,  3.47it/s]
2025-03-13 16:38:45,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:38:45
2025-03-13 16:39:19,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9753 secs
2025-03-13 16:39:19,003 [INFO]: The best hyperparameters are: efSearch=118
2025-03-13 16:39:19,003 [INFO]: 	Compute fast metrics 03/13/2025, 16:39:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-13 16:39:34,003 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9996 secs
2025-03-13 16:39:34,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5752 secs
2025-03-13 16:39:34,005 [INFO]: {
2025-03-13 16:39:34,005 [INFO]: 	index_key: HNSW15
2025-03-13 16:39:34,005 [INFO]: 	index_param: efSearch=118
2025-03-13 16:39:34,005 [INFO]: 	index_path: knn.index
2025-03-13 16:39:34,005 [INFO]: 	size in bytes: 426737590
2025-03-13 16:39:34,005 [INFO]: 	avg_search_speed_ms: 7.718773058940438
2025-03-13 16:39:34,005 [INFO]: 	99p_search_speed_ms: 10.76866426737979
2025-03-13 16:39:34,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:39:34,005 [INFO]: 	nb vectors: 2169
2025-03-13 16:39:34,005 [INFO]: 	vectors dimension: 49152
2025-03-13 16:39:34,005 [INFO]: 	compression ratio: 0.9993090882853793
2025-03-13 16:39:34,005 [INFO]: }
2025-03-13 16:39:34,005 [INFO]: 	>>> Finished "Creating the index" in 51.5789 secs
2025-03-13 16:39:34,005 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6090 secs
2025-03-13 16:39:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:39:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 67170 [episode count 3/20]
[retrieval_preprocessing] for episode 5187 [episode count 4/20], we have num_retrieval=np.int64(2182) num_query=np.int64(81)
2025-03-13 16:39:34,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:39:35,140 [INFO]: Launching the whole pipeline 03/13/2025, 16:39:35
2025-03-13 16:39:35,140 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:39:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1839.61it/s]
2025-03-13 16:39:35,164 [INFO]: There are 2182 embeddings of dim 49152
2025-03-13 16:39:35,165 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 16:39:35,165 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:39:35
2025-03-13 16:39:35,165 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:39:35,165 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:39:35,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:39:35,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:39:35,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:39:35
2025-03-13 16:39:35,165 [INFO]: 450.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:39:35,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:39:35,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:39:35
2025-03-13 16:39:35,165 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:39:35,165 [INFO]: 	Creating the index 03/13/2025, 16:39:35
2025-03-13 16:39:35,165 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:39:35
2025-03-13 16:39:35,166 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 16:39:35,166 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:39:35
2025-03-13 16:39:35,166 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:39:35,166 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.12it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.42it/s]100%|██████████| 9/9 [00:01<00:00,  3.69it/s]100%|██████████| 9/9 [00:01<00:00,  4.53it/s]
2025-03-13 16:39:37,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:39:37
2025-03-13 16:40:04,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9136 secs
2025-03-13 16:40:04,068 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 16:40:04,068 [INFO]: 	Compute fast metrics 03/13/2025, 16:40:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.21it/s]
2025-03-13 16:40:31,770 [INFO]: 	>>> Finished "Compute fast metrics" in 27.7014 secs
2025-03-13 16:40:31,771 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6052 secs
2025-03-13 16:40:31,771 [INFO]: {
2025-03-13 16:40:31,771 [INFO]: 	index_key: HNSW15
2025-03-13 16:40:31,772 [INFO]: 	index_param: efSearch=215
2025-03-13 16:40:31,772 [INFO]: 	index_path: knn.index
2025-03-13 16:40:31,772 [INFO]: 	size in bytes: 429295270
2025-03-13 16:40:31,772 [INFO]: 	avg_search_speed_ms: 10.43305660736853
2025-03-13 16:40:31,772 [INFO]: 	99p_search_speed_ms: 15.442132106982147
2025-03-13 16:40:31,772 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:40:31,772 [INFO]: 	nb vectors: 2182
2025-03-13 16:40:31,772 [INFO]: 	vectors dimension: 49152
2025-03-13 16:40:31,772 [INFO]: 	compression ratio: 0.9993090676261119
2025-03-13 16:40:31,772 [INFO]: }
2025-03-13 16:40:31,772 [INFO]: 	>>> Finished "Creating the index" in 56.6066 secs
2025-03-13 16:40:31,772 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6318 secs
2025-03-13 16:40:32: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:40:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 5187 [episode count 4/20]
[retrieval_preprocessing] for episode 59461 [episode count 5/20], we have num_retrieval=np.int64(2183) num_query=np.int64(80)
2025-03-13 16:40:32,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:40:32,940 [INFO]: Launching the whole pipeline 03/13/2025, 16:40:32
2025-03-13 16:40:32,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:40:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2146.52it/s]
2025-03-13 16:40:32,965 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 16:40:32,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:40:32,966 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:40:32,966 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:40:32,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:40:32,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:40:32,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,967 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:40:32,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:40:32,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:40:32
2025-03-13 16:40:32,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:40:32,967 [INFO]: 	Creating the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,968 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:40:32
2025-03-13 16:40:32,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:40:32,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:40:32
2025-03-13 16:40:32,971 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:40:32,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.27it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.59it/s]100%|██████████| 9/9 [00:02<00:00,  4.30it/s]
2025-03-13 16:40:35,070 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:40:35
2025-03-13 16:41:02,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8517 secs
2025-03-13 16:41:02,922 [INFO]: The best hyperparameters are: efSearch=166
2025-03-13 16:41:02,922 [INFO]: 	Compute fast metrics 03/13/2025, 16:41:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s]
2025-03-13 16:41:27,500 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5778 secs
2025-03-13 16:41:27,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6484 secs
2025-03-13 16:41:27,620 [INFO]: {
2025-03-13 16:41:27,620 [INFO]: 	index_key: HNSW15
2025-03-13 16:41:27,620 [INFO]: 	index_param: efSearch=166
2025-03-13 16:41:27,620 [INFO]: 	index_path: knn.index
2025-03-13 16:41:27,620 [INFO]: 	size in bytes: 429492010
2025-03-13 16:41:27,620 [INFO]: 	avg_search_speed_ms: 13.502830762652412
2025-03-13 16:41:27,620 [INFO]: 	99p_search_speed_ms: 32.64608466997743
2025-03-13 16:41:27,621 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:41:27,621 [INFO]: 	nb vectors: 2183
2025-03-13 16:41:27,621 [INFO]: 	vectors dimension: 49152
2025-03-13 16:41:27,621 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 16:41:27,621 [INFO]: }
2025-03-13 16:41:27,621 [INFO]: 	>>> Finished "Creating the index" in 54.6533 secs
2025-03-13 16:41:27,621 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6812 secs
2025-03-13 16:41:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:41:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 59461 [episode count 5/20]
[retrieval_preprocessing] for episode 53480 [episode count 6/20], we have num_retrieval=np.int64(2149) num_query=np.int64(114)
2025-03-13 16:41:28,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:41:29,308 [INFO]: Launching the whole pipeline 03/13/2025, 16:41:29
2025-03-13 16:41:29,308 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:41:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.07it/s]
2025-03-13 16:41:29,338 [INFO]: There are 2149 embeddings of dim 49152
2025-03-13 16:41:29,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:41:29,339 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:41:29
2025-03-13 16:41:29,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:41:29,339 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:41:29,339 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:41:29,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:41:29,339 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:41:29
2025-03-13 16:41:29,340 [INFO]: 443.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:41:29,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:41:29,340 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:41:29
2025-03-13 16:41:29,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:41:29,340 [INFO]: 	Creating the index 03/13/2025, 16:41:29
2025-03-13 16:41:29,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:41:29
2025-03-13 16:41:29,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:41:29,344 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:41:29
2025-03-13 16:41:29,344 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:41:29,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 15.50it/s] 67%|██████▋   | 6/9 [00:00<00:00, 27.04it/s]100%|██████████| 9/9 [00:02<00:00,  2.94it/s]100%|██████████| 9/9 [00:02<00:00,  3.74it/s]
2025-03-13 16:41:31,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:41:31
2025-03-13 16:42:01,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2021 secs
2025-03-13 16:42:01,960 [INFO]: The best hyperparameters are: efSearch=112
2025-03-13 16:42:01,960 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-13 16:42:21,898 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9372 secs
2025-03-13 16:42:21,900 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5555 secs
2025-03-13 16:42:21,900 [INFO]: {
2025-03-13 16:42:21,900 [INFO]: 	index_key: HNSW15
2025-03-13 16:42:21,900 [INFO]: 	index_param: efSearch=112
2025-03-13 16:42:21,900 [INFO]: 	index_path: knn.index
2025-03-13 16:42:21,900 [INFO]: 	size in bytes: 422802670
2025-03-13 16:42:21,900 [INFO]: 	avg_search_speed_ms: 8.416192808740393
2025-03-13 16:42:21,900 [INFO]: 	99p_search_speed_ms: 15.393384555354661
2025-03-13 16:42:21,900 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:42:21,900 [INFO]: 	nb vectors: 2149
2025-03-13 16:42:21,900 [INFO]: 	vectors dimension: 49152
2025-03-13 16:42:21,900 [INFO]: 	compression ratio: 0.9993091860086881
2025-03-13 16:42:21,900 [INFO]: }
2025-03-13 16:42:21,900 [INFO]: 	>>> Finished "Creating the index" in 52.5596 secs
2025-03-13 16:42:21,900 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5921 secs
2025-03-13 16:42:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:42:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 53480 [episode count 6/20]
[retrieval_preprocessing] for episode 67723 [episode count 7/20], we have num_retrieval=np.int64(2075) num_query=np.int64(188)
2025-03-13 16:42:22,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:42:23,423 [INFO]: Launching the whole pipeline 03/13/2025, 16:42:23
2025-03-13 16:42:23,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:42:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.78it/s]
2025-03-13 16:42:23,459 [INFO]: There are 2075 embeddings of dim 49152
2025-03-13 16:42:23,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-13 16:42:23,460 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:42:23
2025-03-13 16:42:23,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:42:23,460 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:42:23,460 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:42:23,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:42:23,460 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:42:23
2025-03-13 16:42:23,460 [INFO]: 428.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:42:23,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:42:23,460 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:42:23
2025-03-13 16:42:23,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:42:23,461 [INFO]: 	Creating the index 03/13/2025, 16:42:23
2025-03-13 16:42:23,461 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:42:23
2025-03-13 16:42:23,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-13 16:42:23,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:42:23
2025-03-13 16:42:23,463 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:42:23,463 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.22it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.88it/s]100%|██████████| 9/9 [00:01<00:00,  5.32it/s]
2025-03-13 16:42:25,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:42:25
2025-03-13 16:42:59,603 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8036 secs
2025-03-13 16:42:59,604 [INFO]: The best hyperparameters are: efSearch=148
2025-03-13 16:42:59,604 [INFO]: 	Compute fast metrics 03/13/2025, 16:42:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 16:43:31,379 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7745 secs
2025-03-13 16:43:32,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8621 secs
2025-03-13 16:43:32,325 [INFO]: {
2025-03-13 16:43:32,325 [INFO]: 	index_key: HNSW15
2025-03-13 16:43:32,325 [INFO]: 	index_param: efSearch=148
2025-03-13 16:43:32,325 [INFO]: 	index_path: knn.index
2025-03-13 16:43:32,326 [INFO]: 	size in bytes: 408243670
2025-03-13 16:43:32,326 [INFO]: 	avg_search_speed_ms: 10.350167312163775
2025-03-13 16:43:32,326 [INFO]: 	99p_search_speed_ms: 17.18651627888904
2025-03-13 16:43:32,326 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:43:32,326 [INFO]: 	nb vectors: 2075
2025-03-13 16:43:32,326 [INFO]: 	vectors dimension: 49152
2025-03-13 16:43:32,326 [INFO]: 	compression ratio: 0.9993090646083992
2025-03-13 16:43:32,326 [INFO]: }
2025-03-13 16:43:32,326 [INFO]: 	>>> Finished "Creating the index" in 68.8654 secs
2025-03-13 16:43:32,326 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9032 secs
2025-03-13 16:43:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:43:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 67723 [episode count 7/20]
[retrieval_preprocessing] for episode 27794 [episode count 8/20], we have num_retrieval=np.int64(2175) num_query=np.int64(88)
2025-03-13 16:43:33,999 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:43:34,410 [INFO]: Launching the whole pipeline 03/13/2025, 16:43:34
2025-03-13 16:43:34,410 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:43:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.74it/s]
2025-03-13 16:43:34,447 [INFO]: There are 2175 embeddings of dim 49152
2025-03-13 16:43:34,447 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 16:43:34,448 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:43:34
2025-03-13 16:43:34,448 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:43:34,448 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:43:34,448 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:43:34,448 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:43:34,448 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:43:34
2025-03-13 16:43:34,449 [INFO]: 448.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:43:34,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:43:34,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:43:34
2025-03-13 16:43:34,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:43:34,450 [INFO]: 	Creating the index 03/13/2025, 16:43:34
2025-03-13 16:43:34,450 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:43:34
2025-03-13 16:43:34,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:43:34,454 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:43:34
2025-03-13 16:43:34,454 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:43:34,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.19it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.44it/s]100%|██████████| 9/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.24it/s]
2025-03-13 16:43:37,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:43:37
2025-03-13 16:44:14,508 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2661 secs
2025-03-13 16:44:14,509 [INFO]: The best hyperparameters are: efSearch=128
2025-03-13 16:44:14,509 [INFO]: 	Compute fast metrics 03/13/2025, 16:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.38it/s]
2025-03-13 16:44:29,352 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8424 secs
2025-03-13 16:44:29,354 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9000 secs
2025-03-13 16:44:29,354 [INFO]: {
2025-03-13 16:44:29,354 [INFO]: 	index_key: HNSW15
2025-03-13 16:44:29,354 [INFO]: 	index_param: efSearch=128
2025-03-13 16:44:29,354 [INFO]: 	index_path: knn.index
2025-03-13 16:44:29,354 [INFO]: 	size in bytes: 427918090
2025-03-13 16:44:29,354 [INFO]: 	avg_search_speed_ms: 8.35168329180345
2025-03-13 16:44:29,354 [INFO]: 	99p_search_speed_ms: 18.500144416466345
2025-03-13 16:44:29,354 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:44:29,354 [INFO]: 	nb vectors: 2175
2025-03-13 16:44:29,354 [INFO]: 	vectors dimension: 49152
2025-03-13 16:44:29,354 [INFO]: 	compression ratio: 0.9993090032720982
2025-03-13 16:44:29,354 [INFO]: }
2025-03-13 16:44:29,354 [INFO]: 	>>> Finished "Creating the index" in 54.9043 secs
2025-03-13 16:44:29,354 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9440 secs
2025-03-13 16:44:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:44:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 27794 [episode count 8/20]
[retrieval_preprocessing] for episode 85410 [episode count 9/20], we have num_retrieval=np.int64(2176) num_query=np.int64(87)
2025-03-13 16:44:30,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:44:30,934 [INFO]: Launching the whole pipeline 03/13/2025, 16:44:30
2025-03-13 16:44:30,934 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:44:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 899.10it/s]
2025-03-13 16:44:30,964 [INFO]: There are 2176 embeddings of dim 49152
2025-03-13 16:44:30,965 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 16:44:30,965 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:44:30
2025-03-13 16:44:30,965 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:44:30,965 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:44:30,966 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:44:30,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 16:44:30,966 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:44:30
2025-03-13 16:44:30,966 [INFO]: 449.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:44:30,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:44:30,967 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:44:30
2025-03-13 16:44:30,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:44:30,967 [INFO]: 	Creating the index 03/13/2025, 16:44:30
2025-03-13 16:44:30,967 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:44:30
2025-03-13 16:44:30,971 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 16:44:30,971 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:44:30
2025-03-13 16:44:30,972 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:44:30,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.38it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.31it/s]100%|██████████| 9/9 [00:02<00:00,  2.56it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]
2025-03-13 16:44:33,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:44:33
2025-03-13 16:45:03,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8472 secs
2025-03-13 16:45:03,766 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 16:45:03,766 [INFO]: 	Compute fast metrics 03/13/2025, 16:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 16:45:30,660 [INFO]: 	>>> Finished "Compute fast metrics" in 26.8938 secs
2025-03-13 16:45:30,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6903 secs
2025-03-13 16:45:30,662 [INFO]: {
2025-03-13 16:45:30,662 [INFO]: 	index_key: HNSW15
2025-03-13 16:45:30,662 [INFO]: 	index_param: efSearch=178
2025-03-13 16:45:30,662 [INFO]: 	index_path: knn.index
2025-03-13 16:45:30,662 [INFO]: 	size in bytes: 428114830
2025-03-13 16:45:30,662 [INFO]: 	avg_search_speed_ms: 8.804507991159662
2025-03-13 16:45:30,662 [INFO]: 	99p_search_speed_ms: 16.77455644821769
2025-03-13 16:45:30,662 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:45:30,662 [INFO]: 	nb vectors: 2176
2025-03-13 16:45:30,662 [INFO]: 	vectors dimension: 49152
2025-03-13 16:45:30,662 [INFO]: 	compression ratio: 0.9993090124908778
2025-03-13 16:45:30,662 [INFO]: }
2025-03-13 16:45:30,662 [INFO]: 	>>> Finished "Creating the index" in 59.6949 secs
2025-03-13 16:45:30,662 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7282 secs
2025-03-13 16:45:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 85410 [episode count 9/20]
[retrieval_preprocessing] for episode 1183 [episode count 10/20], we have num_retrieval=np.int64(2152) num_query=np.int64(111)
2025-03-13 16:45:31,517 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:45:31,795 [INFO]: Launching the whole pipeline 03/13/2025, 16:45:31
2025-03-13 16:45:31,795 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:45:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-13 16:45:31,823 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 16:45:31,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:45:31,823 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:45:31
2025-03-13 16:45:31,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:45:31,823 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:45:31,823 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:45:31,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:45:31,823 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:45:31
2025-03-13 16:45:31,823 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:45:31,824 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:45:31,824 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:45:31
2025-03-13 16:45:31,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:45:31,824 [INFO]: 	Creating the index 03/13/2025, 16:45:31
2025-03-13 16:45:31,824 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:45:31
2025-03-13 16:45:31,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:45:31,825 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:45:31
2025-03-13 16:45:31,825 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:45:31,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.78it/s] 78%|███████▊  | 7/9 [00:00<00:00, 34.81it/s]100%|██████████| 9/9 [00:01<00:00,  5.37it/s]
2025-03-13 16:45:33,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:45:33
2025-03-13 16:46:01,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0156 secs
2025-03-13 16:46:01,522 [INFO]: The best hyperparameters are: efSearch=139
2025-03-13 16:46:01,522 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.72it/s]
2025-03-13 16:46:22,271 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7491 secs
2025-03-13 16:46:22,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4479 secs
2025-03-13 16:46:22,273 [INFO]: {
2025-03-13 16:46:22,273 [INFO]: 	index_key: HNSW15
2025-03-13 16:46:22,273 [INFO]: 	index_param: efSearch=139
2025-03-13 16:46:22,273 [INFO]: 	index_path: knn.index
2025-03-13 16:46:22,273 [INFO]: 	size in bytes: 423392890
2025-03-13 16:46:22,273 [INFO]: 	avg_search_speed_ms: 9.680001264607528
2025-03-13 16:46:22,273 [INFO]: 	99p_search_speed_ms: 16.285074455663562
2025-03-13 16:46:22,273 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:46:22,273 [INFO]: 	nb vectors: 2152
2025-03-13 16:46:22,273 [INFO]: 	vectors dimension: 49152
2025-03-13 16:46:22,273 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 16:46:22,273 [INFO]: }
2025-03-13 16:46:22,273 [INFO]: 	>>> Finished "Creating the index" in 50.4494 secs
2025-03-13 16:46:22,273 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4780 secs
2025-03-13 16:46:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:46:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 1183 [episode count 10/20]
[retrieval_preprocessing] for episode 17208 [episode count 11/20], we have num_retrieval=np.int64(2152) num_query=np.int64(111)
2025-03-13 16:46:23,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:46:23,644 [INFO]: Launching the whole pipeline 03/13/2025, 16:46:23
2025-03-13 16:46:23,644 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:46:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.28it/s]
2025-03-13 16:46:23,673 [INFO]: There are 2152 embeddings of dim 49152
2025-03-13 16:46:23,673 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 16:46:23,673 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:46:23
2025-03-13 16:46:23,673 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:46:23,673 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:46:23,673 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:46:23,673 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:46:23,673 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:46:23
2025-03-13 16:46:23,673 [INFO]: 444.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:46:23,673 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:46:23,674 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:46:23
2025-03-13 16:46:23,674 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:46:23,674 [INFO]: 	Creating the index 03/13/2025, 16:46:23
2025-03-13 16:46:23,674 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:46:23
2025-03-13 16:46:23,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:46:23,675 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:46:23
2025-03-13 16:46:23,675 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:46:23,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.43it/s] 56%|█████▌    | 5/9 [00:00<00:00, 23.96it/s]100%|██████████| 9/9 [00:02<00:00,  2.69it/s]100%|██████████| 9/9 [00:02<00:00,  3.21it/s]
2025-03-13 16:46:26,486 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:46:26
2025-03-13 16:46:52,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7985 secs
2025-03-13 16:46:52,285 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 16:46:52,285 [INFO]: 	Compute fast metrics 03/13/2025, 16:46:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 16:47:15,350 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0649 secs
2025-03-13 16:47:15,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3095 secs
2025-03-13 16:47:15,985 [INFO]: {
2025-03-13 16:47:15,985 [INFO]: 	index_key: HNSW15
2025-03-13 16:47:15,985 [INFO]: 	index_param: efSearch=183
2025-03-13 16:47:15,985 [INFO]: 	index_path: knn.index
2025-03-13 16:47:15,985 [INFO]: 	size in bytes: 423392890
2025-03-13 16:47:15,985 [INFO]: 	avg_search_speed_ms: 10.119092099506197
2025-03-13 16:47:15,985 [INFO]: 	99p_search_speed_ms: 14.115188410505652
2025-03-13 16:47:15,985 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:47:15,985 [INFO]: 	nb vectors: 2152
2025-03-13 16:47:15,985 [INFO]: 	vectors dimension: 49152
2025-03-13 16:47:15,985 [INFO]: 	compression ratio: 0.9993092137187283
2025-03-13 16:47:15,985 [INFO]: }
2025-03-13 16:47:15,986 [INFO]: 	>>> Finished "Creating the index" in 52.3118 secs
2025-03-13 16:47:15,986 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3419 secs
2025-03-13 16:47:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:47:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 17208 [episode count 11/20]
[retrieval_preprocessing] for episode 38263 [episode count 12/20], we have num_retrieval=np.int64(1994) num_query=np.int64(269)
2025-03-13 16:47:17,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:47:17,480 [INFO]: Launching the whole pipeline 03/13/2025, 16:47:17
2025-03-13 16:47:17,480 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:47:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2201.73it/s]
2025-03-13 16:47:17,505 [INFO]: There are 1994 embeddings of dim 49152
2025-03-13 16:47:17,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 16:47:17,505 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:47:17,505 [INFO]: 		-> Add: 1.1 seconds
2025-03-13 16:47:17,505 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:47:17,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:47:17,506 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,506 [INFO]: 411.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:47:17,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 16:47:17,506 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:47:17
2025-03-13 16:47:17,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:47:17,506 [INFO]: 	Creating the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,506 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:47:17
2025-03-13 16:47:17,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-13 16:47:17,509 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:47:17
2025-03-13 16:47:17,509 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:47:17,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.23it/s]100%|██████████| 8/8 [00:01<00:00,  4.62it/s]100%|██████████| 8/8 [00:01<00:00,  5.09it/s]
2025-03-13 16:47:19,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:47:19
2025-03-13 16:47:47,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3311 secs
2025-03-13 16:47:47,418 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 16:47:47,418 [INFO]: 	Compute fast metrics 03/13/2025, 16:47:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.87it/s]
2025-03-13 16:48:12,160 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7417 secs
2025-03-13 16:48:12,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6529 secs
2025-03-13 16:48:12,162 [INFO]: {
2025-03-13 16:48:12,162 [INFO]: 	index_key: HNSW15
2025-03-13 16:48:12,162 [INFO]: 	index_param: efSearch=151
2025-03-13 16:48:12,162 [INFO]: 	index_path: knn.index
2025-03-13 16:48:12,162 [INFO]: 	size in bytes: 392307490
2025-03-13 16:48:12,162 [INFO]: 	avg_search_speed_ms: 14.188497536980831
2025-03-13 16:48:12,162 [INFO]: 	99p_search_speed_ms: 23.59279877506197
2025-03-13 16:48:12,162 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:48:12,162 [INFO]: 	nb vectors: 1994
2025-03-13 16:48:12,162 [INFO]: 	vectors dimension: 49152
2025-03-13 16:48:12,162 [INFO]: 	compression ratio: 0.999308863565159
2025-03-13 16:48:12,162 [INFO]: }
2025-03-13 16:48:12,162 [INFO]: 	>>> Finished "Creating the index" in 54.6561 secs
2025-03-13 16:48:12,163 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6828 secs
2025-03-13 16:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:48:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 38263 [episode count 12/20]
[retrieval_preprocessing] for episode 81291 [episode count 13/20], we have num_retrieval=np.int64(2183) num_query=np.int64(80)
2025-03-13 16:48:16,095 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:48:16,516 [INFO]: Launching the whole pipeline 03/13/2025, 16:48:16
2025-03-13 16:48:16,516 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:48:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.63it/s]
2025-03-13 16:48:16,548 [INFO]: There are 2183 embeddings of dim 49152
2025-03-13 16:48:16,548 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-13 16:48:16,548 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:48:16
2025-03-13 16:48:16,548 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:48:16,548 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:48:16,548 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:48:16,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:48:16,549 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:48:16
2025-03-13 16:48:16,549 [INFO]: 450.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:48:16,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:48:16,549 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:48:16
2025-03-13 16:48:16,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:48:16,549 [INFO]: 	Creating the index 03/13/2025, 16:48:16
2025-03-13 16:48:16,549 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:48:16
2025-03-13 16:48:16,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 16:48:16,550 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:48:16
2025-03-13 16:48:16,551 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:48:16,551 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.32it/s] 44%|████▍     | 4/9 [00:00<00:00, 14.89it/s] 89%|████████▉ | 8/9 [00:00<00:00, 21.92it/s]100%|██████████| 9/9 [00:02<00:00,  3.32it/s]
2025-03-13 16:48:19,264 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:48:19
2025-03-13 16:48:54,383 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1181 secs
2025-03-13 16:48:54,383 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 16:48:54,383 [INFO]: 	Compute fast metrics 03/13/2025, 16:48:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.72it/s]
2025-03-13 16:49:10,672 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2886 secs
2025-03-13 16:49:10,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1235 secs
2025-03-13 16:49:10,674 [INFO]: {
2025-03-13 16:49:10,674 [INFO]: 	index_key: HNSW15
2025-03-13 16:49:10,674 [INFO]: 	index_param: efSearch=149
2025-03-13 16:49:10,674 [INFO]: 	index_path: knn.index
2025-03-13 16:49:10,674 [INFO]: 	size in bytes: 429492010
2025-03-13 16:49:10,674 [INFO]: 	avg_search_speed_ms: 10.83362729915237
2025-03-13 16:49:10,674 [INFO]: 	99p_search_speed_ms: 19.635473946109414
2025-03-13 16:49:10,674 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:49:10,674 [INFO]: 	nb vectors: 2183
2025-03-13 16:49:10,674 [INFO]: 	vectors dimension: 49152
2025-03-13 16:49:10,674 [INFO]: 	compression ratio: 0.9993090767858522
2025-03-13 16:49:10,674 [INFO]: }
2025-03-13 16:49:10,674 [INFO]: 	>>> Finished "Creating the index" in 54.1253 secs
2025-03-13 16:49:10,674 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1584 secs
2025-03-13 16:49:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:49:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81291 [episode count 13/20]
[retrieval_preprocessing] for episode 77258 [episode count 14/20], we have num_retrieval=np.int64(2161) num_query=np.int64(102)
2025-03-13 16:49:11,530 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:49:11,858 [INFO]: Launching the whole pipeline 03/13/2025, 16:49:11
2025-03-13 16:49:11,859 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.78it/s]
2025-03-13 16:49:11,886 [INFO]: There are 2161 embeddings of dim 49152
2025-03-13 16:49:11,886 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 16:49:11,886 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,886 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:49:11,886 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:49:11,887 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:49:11,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 16:49:11,887 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,887 [INFO]: 446.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:49:11,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:49:11,887 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:49:11
2025-03-13 16:49:11,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:49:11,887 [INFO]: 	Creating the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,887 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:49:11
2025-03-13 16:49:11,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:49:11,888 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:49:11
2025-03-13 16:49:11,888 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:49:11,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.15it/s] 56%|█████▌    | 5/9 [00:00<00:00, 25.80it/s]100%|██████████| 9/9 [00:01<00:00,  3.85it/s]100%|██████████| 9/9 [00:01<00:00,  4.53it/s]
2025-03-13 16:49:13,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:49:13
2025-03-13 16:49:41,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7706 secs
2025-03-13 16:49:41,649 [INFO]: The best hyperparameters are: efSearch=186
2025-03-13 16:49:41,649 [INFO]: 	Compute fast metrics 03/13/2025, 16:49:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.45it/s]
2025-03-13 16:50:09,703 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0540 secs
2025-03-13 16:50:09,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8165 secs
2025-03-13 16:50:09,705 [INFO]: {
2025-03-13 16:50:09,705 [INFO]: 	index_key: HNSW15
2025-03-13 16:50:09,705 [INFO]: 	index_param: efSearch=186
2025-03-13 16:50:09,705 [INFO]: 	index_path: knn.index
2025-03-13 16:50:09,705 [INFO]: 	size in bytes: 425163610
2025-03-13 16:50:09,705 [INFO]: 	avg_search_speed_ms: 8.380387971967721
2025-03-13 16:50:09,705 [INFO]: 	99p_search_speed_ms: 10.785044813528655
2025-03-13 16:50:09,705 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:50:09,705 [INFO]: 	nb vectors: 2161
2025-03-13 16:50:09,705 [INFO]: 	vectors dimension: 49152
2025-03-13 16:50:09,705 [INFO]: 	compression ratio: 0.9993091553625674
2025-03-13 16:50:09,705 [INFO]: }
2025-03-13 16:50:09,705 [INFO]: 	>>> Finished "Creating the index" in 57.8179 secs
2025-03-13 16:50:09,705 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8464 secs
2025-03-13 16:50:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:50:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 77258 [episode count 14/20]
[retrieval_preprocessing] for episode 28990 [episode count 15/20], we have num_retrieval=np.int64(2173) num_query=np.int64(90)
2025-03-13 16:50:10,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:50:10,911 [INFO]: Launching the whole pipeline 03/13/2025, 16:50:10
2025-03-13 16:50:10,911 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:50:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.96it/s]
2025-03-13 16:50:10,943 [INFO]: There are 2173 embeddings of dim 49152
2025-03-13 16:50:10,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-13 16:50:10,944 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:50:10
2025-03-13 16:50:10,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:50:10,944 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:50:10,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:50:10,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 16:50:10,944 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:50:10
2025-03-13 16:50:10,945 [INFO]: 448.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:50:10,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 16:50:10,945 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:50:10
2025-03-13 16:50:10,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:50:10,945 [INFO]: 	Creating the index 03/13/2025, 16:50:10
2025-03-13 16:50:10,946 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:50:10
2025-03-13 16:50:10,949 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 16:50:10,949 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:50:10
2025-03-13 16:50:10,949 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:50:10,950 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.17it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.07it/s]100%|██████████| 9/9 [00:01<00:00,  5.09it/s]
2025-03-13 16:50:12,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:50:12
2025-03-13 16:50:37,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0865 secs
2025-03-13 16:50:37,809 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 16:50:37,809 [INFO]: 	Compute fast metrics 03/13/2025, 16:50:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-13 16:51:02,568 [INFO]: 	>>> Finished "Compute fast metrics" in 24.7588 secs
2025-03-13 16:51:02,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6209 secs
2025-03-13 16:51:02,571 [INFO]: {
2025-03-13 16:51:02,571 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:02,571 [INFO]: 	index_param: efSearch=154
2025-03-13 16:51:02,571 [INFO]: 	index_path: knn.index
2025-03-13 16:51:02,571 [INFO]: 	size in bytes: 427524550
2025-03-13 16:51:02,571 [INFO]: 	avg_search_speed_ms: 11.27302192814077
2025-03-13 16:51:02,571 [INFO]: 	99p_search_speed_ms: 16.834494182839986
2025-03-13 16:51:02,571 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:02,571 [INFO]: 	nb vectors: 2173
2025-03-13 16:51:02,571 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:02,571 [INFO]: 	compression ratio: 0.9993091250549238
2025-03-13 16:51:02,571 [INFO]: }
2025-03-13 16:51:02,571 [INFO]: 	>>> Finished "Creating the index" in 51.6253 secs
2025-03-13 16:51:02,571 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6595 secs
2025-03-13 16:51:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 28990 [episode count 15/20]
[retrieval_preprocessing] for episode 72448 [episode count 16/20], we have num_retrieval=np.int64(2180) num_query=np.int64(83)
2025-03-13 16:51:03,737 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:04,160 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:04
2025-03-13 16:51:04,161 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 953.25it/s]
2025-03-13 16:51:04,189 [INFO]: There are 2180 embeddings of dim 49152
2025-03-13 16:51:04,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 16:51:04,189 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:04
2025-03-13 16:51:04,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:04,189 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:51:04,190 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:04,190 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:51:04,190 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:04
2025-03-13 16:51:04,190 [INFO]: 449.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:04,190 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:51:04,190 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:04
2025-03-13 16:51:04,190 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:04,190 [INFO]: 	Creating the index 03/13/2025, 16:51:04
2025-03-13 16:51:04,190 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:04
2025-03-13 16:51:04,191 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:51:04,191 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:04
2025-03-13 16:51:04,191 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:51:04,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.86it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.11it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
2025-03-13 16:51:07,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:07
2025-03-13 16:51:38,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8281 secs
2025-03-13 16:51:38,398 [INFO]: The best hyperparameters are: efSearch=149
2025-03-13 16:51:38,398 [INFO]: 	Compute fast metrics 03/13/2025, 16:51:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-13 16:51:56,259 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8600 secs
2025-03-13 16:51:56,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0694 secs
2025-03-13 16:51:56,261 [INFO]: {
2025-03-13 16:51:56,261 [INFO]: 	index_key: HNSW15
2025-03-13 16:51:56,261 [INFO]: 	index_param: efSearch=149
2025-03-13 16:51:56,261 [INFO]: 	index_path: knn.index
2025-03-13 16:51:56,261 [INFO]: 	size in bytes: 428901790
2025-03-13 16:51:56,261 [INFO]: 	avg_search_speed_ms: 9.382612247537214
2025-03-13 16:51:56,261 [INFO]: 	99p_search_speed_ms: 12.95628463849424
2025-03-13 16:51:56,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:51:56,261 [INFO]: 	nb vectors: 2180
2025-03-13 16:51:56,261 [INFO]: 	vectors dimension: 49152
2025-03-13 16:51:56,261 [INFO]: 	compression ratio: 0.9993090492814217
2025-03-13 16:51:56,261 [INFO]: }
2025-03-13 16:51:56,261 [INFO]: 	>>> Finished "Creating the index" in 52.0711 secs
2025-03-13 16:51:56,261 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1005 secs
2025-03-13 16:51:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:51:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 72448 [episode count 16/20]
[retrieval_preprocessing] for episode 95054 [episode count 17/20], we have num_retrieval=np.int64(2171) num_query=np.int64(92)
2025-03-13 16:51:57,150 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:51:57,533 [INFO]: Launching the whole pipeline 03/13/2025, 16:51:57
2025-03-13 16:51:57,533 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:51:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 816.01it/s]
2025-03-13 16:51:57,563 [INFO]: There are 2171 embeddings of dim 49152
2025-03-13 16:51:57,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 16:51:57,564 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:51:57
2025-03-13 16:51:57,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:51:57,565 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:51:57,565 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:51:57,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 16:51:57,565 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:51:57
2025-03-13 16:51:57,565 [INFO]: 448.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:51:57,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:51:57,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:51:57
2025-03-13 16:51:57,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:51:57,566 [INFO]: 	Creating the index 03/13/2025, 16:51:57
2025-03-13 16:51:57,566 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:51:57
2025-03-13 16:51:57,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 16:51:57,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:51:57
2025-03-13 16:51:57,570 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:51:57,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 16.74it/s] 78%|███████▊  | 7/9 [00:00<00:00, 31.57it/s]100%|██████████| 9/9 [00:02<00:00,  4.01it/s]
2025-03-13 16:51:59,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:51:59
2025-03-13 16:52:36,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7390 secs
2025-03-13 16:52:36,558 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 16:52:36,559 [INFO]: 	Compute fast metrics 03/13/2025, 16:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.58it/s]
2025-03-13 16:53:00,085 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5264 secs
2025-03-13 16:53:00,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5166 secs
2025-03-13 16:53:00,087 [INFO]: {
2025-03-13 16:53:00,087 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:00,087 [INFO]: 	index_param: efSearch=123
2025-03-13 16:53:00,087 [INFO]: 	index_path: knn.index
2025-03-13 16:53:00,087 [INFO]: 	size in bytes: 427131070
2025-03-13 16:53:00,087 [INFO]: 	avg_search_speed_ms: 6.816530165477734
2025-03-13 16:53:00,087 [INFO]: 	99p_search_speed_ms: 9.274946996010838
2025-03-13 16:53:00,087 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:00,087 [INFO]: 	nb vectors: 2171
2025-03-13 16:53:00,087 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:00,087 [INFO]: 	compression ratio: 0.9993091066870878
2025-03-13 16:53:00,087 [INFO]: }
2025-03-13 16:53:00,087 [INFO]: 	>>> Finished "Creating the index" in 62.5208 secs
2025-03-13 16:53:00,087 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5534 secs
2025-03-13 16:53:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 95054 [episode count 17/20]
[retrieval_preprocessing] for episode 69106 [episode count 18/20], we have num_retrieval=np.int64(2121) num_query=np.int64(142)
2025-03-13 16:53:00,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:01,141 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:01
2025-03-13 16:53:01,141 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.92it/s]
2025-03-13 16:53:01,170 [INFO]: There are 2121 embeddings of dim 49152
2025-03-13 16:53:01,170 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-13 16:53:01,170 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,171 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:01,171 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:53:01,171 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:01,171 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 16:53:01,171 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,171 [INFO]: 437.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:01,172 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 16:53:01,172 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:01
2025-03-13 16:53:01,172 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:01,172 [INFO]: 	Creating the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,172 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:01
2025-03-13 16:53:01,175 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 16:53:01,175 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:01
2025-03-13 16:53:01,176 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:53:01,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.56it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.67it/s]100%|██████████| 9/9 [00:01<00:00,  4.89it/s]
2025-03-13 16:53:03,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:03
2025-03-13 16:53:32,809 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7854 secs
2025-03-13 16:53:32,810 [INFO]: The best hyperparameters are: efSearch=165
2025-03-13 16:53:32,810 [INFO]: 	Compute fast metrics 03/13/2025, 16:53:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 16:53:54,953 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1432 secs
2025-03-13 16:53:54,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7793 secs
2025-03-13 16:53:54,955 [INFO]: {
2025-03-13 16:53:54,955 [INFO]: 	index_key: HNSW15
2025-03-13 16:53:54,955 [INFO]: 	index_param: efSearch=165
2025-03-13 16:53:54,955 [INFO]: 	index_path: knn.index
2025-03-13 16:53:54,955 [INFO]: 	size in bytes: 417293830
2025-03-13 16:53:54,955 [INFO]: 	avg_search_speed_ms: 9.240041109698854
2025-03-13 16:53:54,955 [INFO]: 	99p_search_speed_ms: 12.622867485042663
2025-03-13 16:53:54,955 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:53:54,955 [INFO]: 	nb vectors: 2121
2025-03-13 16:53:54,955 [INFO]: 	vectors dimension: 49152
2025-03-13 16:53:54,955 [INFO]: 	compression ratio: 0.9993092109701215
2025-03-13 16:53:54,955 [INFO]: }
2025-03-13 16:53:54,955 [INFO]: 	>>> Finished "Creating the index" in 53.7832 secs
2025-03-13 16:53:54,955 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8146 secs
2025-03-13 16:53:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:53:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 69106 [episode count 18/20]
[retrieval_preprocessing] for episode 30482 [episode count 19/20], we have num_retrieval=np.int64(2109) num_query=np.int64(154)
2025-03-13 16:53:56,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:53:56,488 [INFO]: Launching the whole pipeline 03/13/2025, 16:53:56
2025-03-13 16:53:56,488 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:53:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.93it/s]
2025-03-13 16:53:56,514 [INFO]: There are 2109 embeddings of dim 49152
2025-03-13 16:53:56,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 16:53:56,514 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:53:56,514 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 16:53:56,514 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:53:56,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:53:56,514 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,514 [INFO]: 435.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:53:56,515 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:53:56,515 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:53:56
2025-03-13 16:53:56,515 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:53:56,515 [INFO]: 	Creating the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,515 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:53:56
2025-03-13 16:53:56,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:53:56,516 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:53:56
2025-03-13 16:53:56,516 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 16:53:56,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.76it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.80it/s]100%|██████████| 9/9 [00:01<00:00,  3.74it/s]100%|██████████| 9/9 [00:01<00:00,  4.60it/s]
2025-03-13 16:53:58,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:53:58
2025-03-13 16:54:31,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0891 secs
2025-03-13 16:54:31,566 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:54:31,566 [INFO]: 	Compute fast metrics 03/13/2025, 16:54:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.34it/s]
2025-03-13 16:54:49,848 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2824 secs
2025-03-13 16:54:49,850 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3342 secs
2025-03-13 16:54:49,850 [INFO]: {
2025-03-13 16:54:49,850 [INFO]: 	index_key: HNSW15
2025-03-13 16:54:49,850 [INFO]: 	index_param: efSearch=168
2025-03-13 16:54:49,850 [INFO]: 	index_path: knn.index
2025-03-13 16:54:49,850 [INFO]: 	size in bytes: 414932950
2025-03-13 16:54:49,850 [INFO]: 	avg_search_speed_ms: 9.560453934981407
2025-03-13 16:54:49,850 [INFO]: 	99p_search_speed_ms: 13.646021264139556
2025-03-13 16:54:49,850 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:54:49,850 [INFO]: 	nb vectors: 2109
2025-03-13 16:54:49,850 [INFO]: 	vectors dimension: 49152
2025-03-13 16:54:49,850 [INFO]: 	compression ratio: 0.9993090980121005
2025-03-13 16:54:49,850 [INFO]: }
2025-03-13 16:54:49,850 [INFO]: 	>>> Finished "Creating the index" in 53.3358 secs
2025-03-13 16:54:49,850 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3622 secs
2025-03-13 16:54:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:54:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 30482 [episode count 19/20]
2025-03-13 16:54:50: [retrieval_preprocessing] finished for 3163748394_put_orange_object_in_blue_cup [chosen_id count 4/196]
2025-03-13 16:54:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3246924425_corn_in_bowl [chosen_id count 5/196]
2025-03-13 16:54:52: [retrieval_preprocessing] we have num_total=2802 embedding_dim=49152
[retrieval_preprocessing] for episode 22912 [episode count 0/20], we have num_retrieval=np.int64(2670) num_query=np.int64(132)
2025-03-13 16:54:52,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:54:53,164 [INFO]: Launching the whole pipeline 03/13/2025, 16:54:53
2025-03-13 16:54:53,164 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:54:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1945.41it/s]
2025-03-13 16:54:53,191 [INFO]: There are 2670 embeddings of dim 49152
2025-03-13 16:54:53,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 16:54:53,192 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:54:53,192 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:54:53,192 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:54:53,192 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:54:53,192 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,192 [INFO]: 551.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:54:53,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:54:53,192 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:54:53
2025-03-13 16:54:53,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:54:53,192 [INFO]: 	Creating the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,192 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:54:53
2025-03-13 16:54:53,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:54:53,194 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:54:53
2025-03-13 16:54:53,194 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:54:53,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.87it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.02it/s]100%|██████████| 11/11 [00:02<00:00,  4.32it/s]100%|██████████| 11/11 [00:02<00:00,  5.05it/s]
2025-03-13 16:54:55,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:54:55
2025-03-13 16:55:31,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6817 secs
2025-03-13 16:55:31,056 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 16:55:31,056 [INFO]: 	Compute fast metrics 03/13/2025, 16:55:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-13 16:55:56,279 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2228 secs
2025-03-13 16:55:56,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0872 secs
2025-03-13 16:55:56,281 [INFO]: {
2025-03-13 16:55:56,281 [INFO]: 	index_key: HNSW15
2025-03-13 16:55:56,281 [INFO]: 	index_param: efSearch=224
2025-03-13 16:55:56,281 [INFO]: 	index_path: knn.index
2025-03-13 16:55:56,281 [INFO]: 	size in bytes: 525306010
2025-03-13 16:55:56,281 [INFO]: 	avg_search_speed_ms: 9.376612870500972
2025-03-13 16:55:56,281 [INFO]: 	99p_search_speed_ms: 13.749170429073272
2025-03-13 16:55:56,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:55:56,281 [INFO]: 	nb vectors: 2670
2025-03-13 16:55:56,281 [INFO]: 	vectors dimension: 49152
2025-03-13 16:55:56,281 [INFO]: 	compression ratio: 0.9993096404893597
2025-03-13 16:55:56,281 [INFO]: }
2025-03-13 16:55:56,281 [INFO]: 	>>> Finished "Creating the index" in 63.0888 secs
2025-03-13 16:55:56,281 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1174 secs
2025-03-13 16:55:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:55:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 22912 [episode count 0/20]
[retrieval_preprocessing] for episode 38407 [episode count 1/20], we have num_retrieval=np.int64(2663) num_query=np.int64(139)
2025-03-13 16:55:57,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:55:57,864 [INFO]: Launching the whole pipeline 03/13/2025, 16:55:57
2025-03-13 16:55:57,864 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:55:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1021.51it/s]
2025-03-13 16:55:57,893 [INFO]: There are 2663 embeddings of dim 49152
2025-03-13 16:55:57,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 16:55:57,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:55:57
2025-03-13 16:55:57,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:55:57,893 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:55:57,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:55:57,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:55:57,894 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:55:57
2025-03-13 16:55:57,894 [INFO]: 549.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:55:57,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:55:57,894 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:55:57
2025-03-13 16:55:57,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:55:57,894 [INFO]: 	Creating the index 03/13/2025, 16:55:57
2025-03-13 16:55:57,894 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:55:57
2025-03-13 16:55:57,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 16:55:57,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:55:57
2025-03-13 16:55:57,895 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:55:57,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.91it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.34it/s]100%|██████████| 11/11 [00:01<00:00,  4.87it/s]100%|██████████| 11/11 [00:01<00:00,  5.69it/s]
2025-03-13 16:55:59,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:55:59
2025-03-13 16:56:30,591 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7597 secs
2025-03-13 16:56:30,591 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 16:56:30,591 [INFO]: 	Compute fast metrics 03/13/2025, 16:56:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.34it/s]
2025-03-13 16:57:02,679 [INFO]: 	>>> Finished "Compute fast metrics" in 32.0882 secs
2025-03-13 16:57:02,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7863 secs
2025-03-13 16:57:02,682 [INFO]: {
2025-03-13 16:57:02,682 [INFO]: 	index_key: HNSW15
2025-03-13 16:57:02,682 [INFO]: 	index_param: efSearch=294
2025-03-13 16:57:02,682 [INFO]: 	index_path: knn.index
2025-03-13 16:57:02,682 [INFO]: 	size in bytes: 523928830
2025-03-13 16:57:02,682 [INFO]: 	avg_search_speed_ms: 13.196995224137753
2025-03-13 16:57:02,682 [INFO]: 	99p_search_speed_ms: 18.491331438999623
2025-03-13 16:57:02,682 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:57:02,682 [INFO]: 	nb vectors: 2663
2025-03-13 16:57:02,682 [INFO]: 	vectors dimension: 49152
2025-03-13 16:57:02,682 [INFO]: 	compression ratio: 0.9993095894341222
2025-03-13 16:57:02,682 [INFO]: }
2025-03-13 16:57:02,682 [INFO]: 	>>> Finished "Creating the index" in 64.7881 secs
2025-03-13 16:57:02,682 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8178 secs
2025-03-13 16:57:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:57:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 38407 [episode count 1/20]
[retrieval_preprocessing] for episode 14986 [episode count 2/20], we have num_retrieval=np.int64(2667) num_query=np.int64(135)
2025-03-13 16:57:04,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:57:05,224 [INFO]: Launching the whole pipeline 03/13/2025, 16:57:05
2025-03-13 16:57:05,224 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:57:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1737.49it/s]
2025-03-13 16:57:05,249 [INFO]: There are 2667 embeddings of dim 49152
2025-03-13 16:57:05,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 16:57:05,249 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:57:05
2025-03-13 16:57:05,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:57:05,250 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:57:05,250 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:57:05,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:57:05,250 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:57:05
2025-03-13 16:57:05,250 [INFO]: 550.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:57:05,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 16:57:05,250 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:57:05
2025-03-13 16:57:05,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:57:05,250 [INFO]: 	Creating the index 03/13/2025, 16:57:05
2025-03-13 16:57:05,250 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:57:05
2025-03-13 16:57:05,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:57:05,251 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:57:05
2025-03-13 16:57:05,251 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:57:05,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.67it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.15it/s]100%|██████████| 11/11 [00:02<00:00,  3.66it/s]100%|██████████| 11/11 [00:02<00:00,  4.56it/s]
2025-03-13 16:57:07,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:57:07
2025-03-13 16:57:50,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3028 secs
2025-03-13 16:57:50,971 [INFO]: The best hyperparameters are: efSearch=123
2025-03-13 16:57:50,971 [INFO]: 	Compute fast metrics 03/13/2025, 16:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.65it/s]
2025-03-13 16:58:09,269 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2983 secs
2025-03-13 16:58:09,271 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0199 secs
2025-03-13 16:58:09,271 [INFO]: {
2025-03-13 16:58:09,271 [INFO]: 	index_key: HNSW15
2025-03-13 16:58:09,271 [INFO]: 	index_param: efSearch=123
2025-03-13 16:58:09,271 [INFO]: 	index_path: knn.index
2025-03-13 16:58:09,271 [INFO]: 	size in bytes: 524715790
2025-03-13 16:58:09,271 [INFO]: 	avg_search_speed_ms: 7.196979772211022
2025-03-13 16:58:09,271 [INFO]: 	99p_search_speed_ms: 12.590067693963613
2025-03-13 16:58:09,271 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:58:09,271 [INFO]: 	nb vectors: 2667
2025-03-13 16:58:09,271 [INFO]: 	vectors dimension: 49152
2025-03-13 16:58:09,271 [INFO]: 	compression ratio: 0.9993096186413601
2025-03-13 16:58:09,271 [INFO]: }
2025-03-13 16:58:09,271 [INFO]: 	>>> Finished "Creating the index" in 64.0215 secs
2025-03-13 16:58:09,271 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0477 secs
2025-03-13 16:58:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:58:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 14986 [episode count 2/20]
[retrieval_preprocessing] for episode 10512 [episode count 3/20], we have num_retrieval=np.int64(2660) num_query=np.int64(142)
2025-03-13 16:58:10,395 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:58:10,793 [INFO]: Launching the whole pipeline 03/13/2025, 16:58:10
2025-03-13 16:58:10,793 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:58:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1570.31it/s]
2025-03-13 16:58:10,820 [INFO]: There are 2660 embeddings of dim 49152
2025-03-13 16:58:10,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 16:58:10,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:58:10
2025-03-13 16:58:10,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:58:10,820 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:58:10,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:58:10,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:58:10,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:58:10
2025-03-13 16:58:10,821 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:58:10,821 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:58:10,821 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:58:10
2025-03-13 16:58:10,821 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:58:10,821 [INFO]: 	Creating the index 03/13/2025, 16:58:10
2025-03-13 16:58:10,821 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:58:10
2025-03-13 16:58:10,822 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:58:10,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:58:10
2025-03-13 16:58:10,822 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:58:10,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.97it/s] 45%|████▌     | 5/11 [00:00<00:00, 26.06it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.90it/s]100%|██████████| 11/11 [00:02<00:00,  5.15it/s]
2025-03-13 16:58:12,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:58:12
2025-03-13 16:58:44,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8918 secs
2025-03-13 16:58:44,855 [INFO]: The best hyperparameters are: efSearch=176
2025-03-13 16:58:44,855 [INFO]: 	Compute fast metrics 03/13/2025, 16:58:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s]
2025-03-13 16:59:07,461 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6061 secs
2025-03-13 16:59:07,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6415 secs
2025-03-13 16:59:07,464 [INFO]: {
2025-03-13 16:59:07,464 [INFO]: 	index_key: HNSW15
2025-03-13 16:59:07,464 [INFO]: 	index_param: efSearch=176
2025-03-13 16:59:07,464 [INFO]: 	index_path: knn.index
2025-03-13 16:59:07,464 [INFO]: 	size in bytes: 523338610
2025-03-13 16:59:07,464 [INFO]: 	avg_search_speed_ms: 8.621787721218926
2025-03-13 16:59:07,464 [INFO]: 	99p_search_speed_ms: 11.568473251536489
2025-03-13 16:59:07,464 [INFO]: 	reconstruction error %: 0.0
2025-03-13 16:59:07,464 [INFO]: 	nb vectors: 2660
2025-03-13 16:59:07,464 [INFO]: 	vectors dimension: 49152
2025-03-13 16:59:07,464 [INFO]: 	compression ratio: 0.999309567471049
2025-03-13 16:59:07,464 [INFO]: }
2025-03-13 16:59:07,464 [INFO]: 	>>> Finished "Creating the index" in 56.6430 secs
2025-03-13 16:59:07,464 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6703 secs
2025-03-13 16:59:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 16:59:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 10512 [episode count 3/20]
[retrieval_preprocessing] for episode 75536 [episode count 4/20], we have num_retrieval=np.int64(2679) num_query=np.int64(123)
2025-03-13 16:59:08,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 16:59:09,929 [INFO]: Launching the whole pipeline 03/13/2025, 16:59:09
2025-03-13 16:59:09,930 [INFO]: Reading total number of vectors and dimension 03/13/2025, 16:59:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.65it/s]
2025-03-13 16:59:09,959 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 16:59:09,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 16:59:09,960 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 16:59:09
2025-03-13 16:59:09,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 16:59:09,960 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 16:59:09,960 [INFO]: 		Total: 16.7 minutes
2025-03-13 16:59:09,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 16:59:09,960 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 16:59:09
2025-03-13 16:59:09,960 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 16:59:09,960 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 16:59:09,960 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 16:59:09
2025-03-13 16:59:09,960 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 16:59:09,960 [INFO]: 	Creating the index 03/13/2025, 16:59:09
2025-03-13 16:59:09,960 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 16:59:09
2025-03-13 16:59:09,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 16:59:09,961 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 16:59:09
2025-03-13 16:59:09,962 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 16:59:09,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.84it/s] 55%|█████▍    | 6/11 [00:00<00:00, 26.95it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.52it/s]
2025-03-13 16:59:12,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 16:59:12
2025-03-13 16:59:40,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1474 secs
2025-03-13 16:59:40,547 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 16:59:40,547 [INFO]: 	Compute fast metrics 03/13/2025, 16:59:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.07it/s]
2025-03-13 17:00:01,515 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9685 secs
2025-03-13 17:00:01,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5557 secs
2025-03-13 17:00:01,517 [INFO]: {
2025-03-13 17:00:01,517 [INFO]: 	index_key: HNSW15
2025-03-13 17:00:01,517 [INFO]: 	index_param: efSearch=168
2025-03-13 17:00:01,517 [INFO]: 	index_path: knn.index
2025-03-13 17:00:01,517 [INFO]: 	size in bytes: 527076670
2025-03-13 17:00:01,517 [INFO]: 	avg_search_speed_ms: 8.640545812219909
2025-03-13 17:00:01,518 [INFO]: 	99p_search_speed_ms: 11.631067683920266
2025-03-13 17:00:01,518 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:00:01,518 [INFO]: 	nb vectors: 2679
2025-03-13 17:00:01,518 [INFO]: 	vectors dimension: 49152
2025-03-13 17:00:01,518 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 17:00:01,518 [INFO]: }
2025-03-13 17:00:01,518 [INFO]: 	>>> Finished "Creating the index" in 51.5573 secs
2025-03-13 17:00:01,518 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5880 secs
2025-03-13 17:00:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:00:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 75536 [episode count 4/20]
[retrieval_preprocessing] for episode 48026 [episode count 5/20], we have num_retrieval=np.int64(2677) num_query=np.int64(125)
2025-03-13 17:00:02,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:00:03,293 [INFO]: Launching the whole pipeline 03/13/2025, 17:00:03
2025-03-13 17:00:03,293 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:00:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2185.67it/s]
2025-03-13 17:00:03,319 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 17:00:03,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-13 17:00:03,320 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:00:03
2025-03-13 17:00:03,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:00:03,320 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:00:03,320 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:00:03,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:00:03,320 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:00:03
2025-03-13 17:00:03,320 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:00:03,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:00:03,320 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:00:03
2025-03-13 17:00:03,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:00:03,320 [INFO]: 	Creating the index 03/13/2025, 17:00:03
2025-03-13 17:00:03,320 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:00:03
2025-03-13 17:00:03,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:00:03,321 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:00:03
2025-03-13 17:00:03,321 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:00:03,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.59it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.74it/s]100%|██████████| 11/11 [00:02<00:00,  3.81it/s]100%|██████████| 11/11 [00:02<00:00,  4.74it/s]
2025-03-13 17:00:05,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:00:05
2025-03-13 17:00:42,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6813 secs
2025-03-13 17:00:42,329 [INFO]: The best hyperparameters are: efSearch=204
2025-03-13 17:00:42,329 [INFO]: 	Compute fast metrics 03/13/2025, 17:00:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-13 17:01:08,522 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1925 secs
2025-03-13 17:01:08,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6415 secs
2025-03-13 17:01:08,963 [INFO]: {
2025-03-13 17:01:08,963 [INFO]: 	index_key: HNSW15
2025-03-13 17:01:08,963 [INFO]: 	index_param: efSearch=204
2025-03-13 17:01:08,963 [INFO]: 	index_path: knn.index
2025-03-13 17:01:08,963 [INFO]: 	size in bytes: 526683190
2025-03-13 17:01:08,964 [INFO]: 	avg_search_speed_ms: 9.194996283066061
2025-03-13 17:01:08,964 [INFO]: 	99p_search_speed_ms: 12.126304579433052
2025-03-13 17:01:08,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:01:08,964 [INFO]: 	nb vectors: 2677
2025-03-13 17:01:08,964 [INFO]: 	vectors dimension: 49152
2025-03-13 17:01:08,964 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 17:01:08,964 [INFO]: }
2025-03-13 17:01:08,964 [INFO]: 	>>> Finished "Creating the index" in 65.6437 secs
2025-03-13 17:01:08,964 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6711 secs
2025-03-13 17:01:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:01:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 48026 [episode count 5/20]
[retrieval_preprocessing] for episode 76699 [episode count 6/20], we have num_retrieval=np.int64(2662) num_query=np.int64(140)
2025-03-13 17:01:11,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:01:11,616 [INFO]: Launching the whole pipeline 03/13/2025, 17:01:11
2025-03-13 17:01:11,617 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:01:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 860.19it/s]
2025-03-13 17:01:11,659 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 17:01:11,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0428 secs
2025-03-13 17:01:11,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:01:11
2025-03-13 17:01:11,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:01:11,660 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:01:11,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:01:11,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:01:11,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:01:11
2025-03-13 17:01:11,660 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:01:11,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:01:11,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:01:11
2025-03-13 17:01:11,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:01:11,661 [INFO]: 	Creating the index 03/13/2025, 17:01:11
2025-03-13 17:01:11,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:01:11
2025-03-13 17:01:11,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-13 17:01:11,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:01:11
2025-03-13 17:01:11,664 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:01:11,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.75it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.64it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.95it/s]100%|██████████| 11/11 [00:02<00:00,  5.03it/s]
2025-03-13 17:01:13,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:01:13
2025-03-13 17:01:43,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1412 secs
2025-03-13 17:01:43,997 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 17:01:43,997 [INFO]: 	Compute fast metrics 03/13/2025, 17:01:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-13 17:02:12,778 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7810 secs
2025-03-13 17:02:12,782 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1184 secs
2025-03-13 17:02:12,782 [INFO]: {
2025-03-13 17:02:12,782 [INFO]: 	index_key: HNSW15
2025-03-13 17:02:12,782 [INFO]: 	index_param: efSearch=261
2025-03-13 17:02:12,782 [INFO]: 	index_path: knn.index
2025-03-13 17:02:12,782 [INFO]: 	size in bytes: 523732090
2025-03-13 17:02:12,782 [INFO]: 	avg_search_speed_ms: 14.052177591346142
2025-03-13 17:02:12,782 [INFO]: 	99p_search_speed_ms: 20.74348903493955
2025-03-13 17:02:12,782 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:02:12,782 [INFO]: 	nb vectors: 2662
2025-03-13 17:02:12,782 [INFO]: 	vectors dimension: 49152
2025-03-13 17:02:12,782 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 17:02:12,782 [INFO]: }
2025-03-13 17:02:12,782 [INFO]: 	>>> Finished "Creating the index" in 61.1217 secs
2025-03-13 17:02:12,782 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1660 secs
2025-03-13 17:02:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:02:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 76699 [episode count 6/20]
[retrieval_preprocessing] for episode 89115 [episode count 7/20], we have num_retrieval=np.int64(2633) num_query=np.int64(169)
2025-03-13 17:02:15,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:02:16,157 [INFO]: Launching the whole pipeline 03/13/2025, 17:02:16
2025-03-13 17:02:16,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:02:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 924.47it/s]
2025-03-13 17:02:16,186 [INFO]: There are 2633 embeddings of dim 49152
2025-03-13 17:02:16,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 17:02:16,187 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:02:16
2025-03-13 17:02:16,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:02:16,187 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:02:16,187 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:02:16,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:02:16,187 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:02:16
2025-03-13 17:02:16,187 [INFO]: 543.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:02:16,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:02:16,187 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:02:16
2025-03-13 17:02:16,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:02:16,187 [INFO]: 	Creating the index 03/13/2025, 17:02:16
2025-03-13 17:02:16,187 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:02:16
2025-03-13 17:02:16,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:02:16,188 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:02:16
2025-03-13 17:02:16,188 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:02:16,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.33it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.47it/s]100%|██████████| 11/11 [00:02<00:00,  3.78it/s]100%|██████████| 11/11 [00:02<00:00,  4.44it/s]
2025-03-13 17:02:18,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:02:18
2025-03-13 17:02:56,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0281 secs
2025-03-13 17:02:56,700 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 17:02:56,700 [INFO]: 	Compute fast metrics 03/13/2025, 17:02:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.89it/s]
2025-03-13 17:03:13,033 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3328 secs
2025-03-13 17:03:13,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8468 secs
2025-03-13 17:03:13,035 [INFO]: {
2025-03-13 17:03:13,035 [INFO]: 	index_key: HNSW15
2025-03-13 17:03:13,035 [INFO]: 	index_param: efSearch=185
2025-03-13 17:03:13,035 [INFO]: 	index_path: knn.index
2025-03-13 17:03:13,035 [INFO]: 	size in bytes: 518026630
2025-03-13 17:03:13,035 [INFO]: 	avg_search_speed_ms: 8.562872909513391
2025-03-13 17:03:13,035 [INFO]: 	99p_search_speed_ms: 12.539804175030438
2025-03-13 17:03:13,035 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:03:13,035 [INFO]: 	nb vectors: 2633
2025-03-13 17:03:13,035 [INFO]: 	vectors dimension: 49152
2025-03-13 17:03:13,035 [INFO]: 	compression ratio: 0.9993093675512396
2025-03-13 17:03:13,035 [INFO]: }
2025-03-13 17:03:13,035 [INFO]: 	>>> Finished "Creating the index" in 56.8484 secs
2025-03-13 17:03:13,035 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8787 secs
2025-03-13 17:03:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 89115 [episode count 7/20]
[retrieval_preprocessing] for episode 80416 [episode count 8/20], we have num_retrieval=np.int64(2695) num_query=np.int64(107)
2025-03-13 17:03:14,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:03:14,874 [INFO]: Launching the whole pipeline 03/13/2025, 17:03:14
2025-03-13 17:03:14,874 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:03:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.49it/s]
2025-03-13 17:03:14,903 [INFO]: There are 2695 embeddings of dim 49152
2025-03-13 17:03:14,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-13 17:03:14,903 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,903 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:03:14,903 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:03:14,903 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:03:14,903 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:03:14,903 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,903 [INFO]: 556.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:03:14,903 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:03:14,903 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:03:14
2025-03-13 17:03:14,903 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:03:14,903 [INFO]: 	Creating the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,904 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:03:14
2025-03-13 17:03:14,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:03:14,905 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:03:14
2025-03-13 17:03:14,905 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:03:14,905 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.21it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.49it/s]100%|██████████| 11/11 [00:01<00:00,  4.82it/s]100%|██████████| 11/11 [00:01<00:00,  5.62it/s]
2025-03-13 17:03:16,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:03:16
2025-03-13 17:03:51,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0276 secs
2025-03-13 17:03:51,895 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 17:03:51,895 [INFO]: 	Compute fast metrics 03/13/2025, 17:03:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
2025-03-13 17:04:14,920 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0251 secs
2025-03-13 17:04:14,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0177 secs
2025-03-13 17:04:14,922 [INFO]: {
2025-03-13 17:04:14,922 [INFO]: 	index_key: HNSW15
2025-03-13 17:04:14,922 [INFO]: 	index_param: efSearch=217
2025-03-13 17:04:14,922 [INFO]: 	index_path: knn.index
2025-03-13 17:04:14,922 [INFO]: 	size in bytes: 530224510
2025-03-13 17:04:14,922 [INFO]: 	avg_search_speed_ms: 10.610357842191833
2025-03-13 17:04:14,922 [INFO]: 	99p_search_speed_ms: 14.593623895198107
2025-03-13 17:04:14,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:04:14,922 [INFO]: 	nb vectors: 2695
2025-03-13 17:04:14,923 [INFO]: 	vectors dimension: 49152
2025-03-13 17:04:14,923 [INFO]: 	compression ratio: 0.9993098206644577
2025-03-13 17:04:14,923 [INFO]: }
2025-03-13 17:04:14,923 [INFO]: 	>>> Finished "Creating the index" in 60.0191 secs
2025-03-13 17:04:14,923 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0482 secs
2025-03-13 17:04:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:04:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 80416 [episode count 8/20]
[retrieval_preprocessing] for episode 79794 [episode count 9/20], we have num_retrieval=np.int64(2671) num_query=np.int64(131)
2025-03-13 17:04:16,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:04:16,618 [INFO]: Launching the whole pipeline 03/13/2025, 17:04:16
2025-03-13 17:04:16,618 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:04:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 17:04:16,649 [INFO]: There are 2671 embeddings of dim 49152
2025-03-13 17:04:16,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 17:04:16,650 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:04:16
2025-03-13 17:04:16,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:04:16,650 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:04:16,650 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:04:16,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:04:16,651 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:04:16
2025-03-13 17:04:16,651 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:04:16,651 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:04:16,651 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:04:16
2025-03-13 17:04:16,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:04:16,652 [INFO]: 	Creating the index 03/13/2025, 17:04:16
2025-03-13 17:04:16,652 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:04:16
2025-03-13 17:04:16,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 17:04:16,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:04:16
2025-03-13 17:04:16,655 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:04:16,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.14it/s] 73%|███████▎  | 8/11 [00:00<00:00, 36.84it/s]100%|██████████| 11/11 [00:01<00:00,  5.53it/s]
2025-03-13 17:04:18,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:04:18
2025-03-13 17:04:52,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7871 secs
2025-03-13 17:04:52,438 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 17:04:52,438 [INFO]: 	Compute fast metrics 03/13/2025, 17:04:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.52it/s]
2025-03-13 17:05:13,961 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5230 secs
2025-03-13 17:05:13,963 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3076 secs
2025-03-13 17:05:13,963 [INFO]: {
2025-03-13 17:05:13,963 [INFO]: 	index_key: HNSW15
2025-03-13 17:05:13,963 [INFO]: 	index_param: efSearch=226
2025-03-13 17:05:13,963 [INFO]: 	index_path: knn.index
2025-03-13 17:05:13,963 [INFO]: 	size in bytes: 525502750
2025-03-13 17:05:13,963 [INFO]: 	avg_search_speed_ms: 8.15615092395071
2025-03-13 17:05:13,963 [INFO]: 	99p_search_speed_ms: 12.69502064678818
2025-03-13 17:05:13,963 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:05:13,963 [INFO]: 	nb vectors: 2671
2025-03-13 17:05:13,963 [INFO]: 	vectors dimension: 49152
2025-03-13 17:05:13,963 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-13 17:05:13,963 [INFO]: }
2025-03-13 17:05:13,963 [INFO]: 	>>> Finished "Creating the index" in 57.3113 secs
2025-03-13 17:05:13,963 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3448 secs
2025-03-13 17:05:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:05:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 79794 [episode count 9/20]
[retrieval_preprocessing] for episode 3894 [episode count 10/20], we have num_retrieval=np.int64(2665) num_query=np.int64(137)
2025-03-13 17:05:15,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:05:15,386 [INFO]: Launching the whole pipeline 03/13/2025, 17:05:15
2025-03-13 17:05:15,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:05:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2245.34it/s]
2025-03-13 17:05:15,410 [INFO]: There are 2665 embeddings of dim 49152
2025-03-13 17:05:15,411 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-13 17:05:15,411 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:05:15
2025-03-13 17:05:15,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:05:15,411 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:05:15,411 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:05:15,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:05:15,411 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:05:15
2025-03-13 17:05:15,411 [INFO]: 550.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:05:15,411 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:05:15,411 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:05:15
2025-03-13 17:05:15,411 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:05:15,411 [INFO]: 	Creating the index 03/13/2025, 17:05:15
2025-03-13 17:05:15,411 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:05:15
2025-03-13 17:05:15,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:05:15,412 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:05:15
2025-03-13 17:05:15,412 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:05:15,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 28.01it/s] 91%|█████████ | 10/11 [00:00<00:00, 51.18it/s]100%|██████████| 11/11 [00:01<00:00,  6.79it/s]
2025-03-13 17:05:17,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:05:17
2025-03-13 17:05:47,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0521 secs
2025-03-13 17:05:47,089 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:05:47,089 [INFO]: 	Compute fast metrics 03/13/2025, 17:05:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-13 17:06:08,191 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1018 secs
2025-03-13 17:06:08,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7807 secs
2025-03-13 17:06:08,194 [INFO]: {
2025-03-13 17:06:08,194 [INFO]: 	index_key: HNSW15
2025-03-13 17:06:08,194 [INFO]: 	index_param: efSearch=157
2025-03-13 17:06:08,194 [INFO]: 	index_path: knn.index
2025-03-13 17:06:08,194 [INFO]: 	size in bytes: 524322310
2025-03-13 17:06:08,194 [INFO]: 	avg_search_speed_ms: 8.538924432005718
2025-03-13 17:06:08,194 [INFO]: 	99p_search_speed_ms: 12.335127242840823
2025-03-13 17:06:08,194 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:06:08,194 [INFO]: 	nb vectors: 2665
2025-03-13 17:06:08,194 [INFO]: 	vectors dimension: 49152
2025-03-13 17:06:08,194 [INFO]: 	compression ratio: 0.9993096040487005
2025-03-13 17:06:08,194 [INFO]: }
2025-03-13 17:06:08,194 [INFO]: 	>>> Finished "Creating the index" in 52.7827 secs
2025-03-13 17:06:08,194 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8076 secs
2025-03-13 17:06:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:06:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 3894 [episode count 10/20]
[retrieval_preprocessing] for episode 20662 [episode count 11/20], we have num_retrieval=np.int64(2657) num_query=np.int64(145)
2025-03-13 17:06:09,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:06:09,845 [INFO]: Launching the whole pipeline 03/13/2025, 17:06:09
2025-03-13 17:06:09,845 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:06:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.26it/s]
2025-03-13 17:06:09,873 [INFO]: There are 2657 embeddings of dim 49152
2025-03-13 17:06:09,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:06:09,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:06:09
2025-03-13 17:06:09,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:06:09,874 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:06:09,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:06:09,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:06:09,874 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:06:09
2025-03-13 17:06:09,874 [INFO]: 548.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:06:09,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:06:09,874 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:06:09
2025-03-13 17:06:09,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:06:09,874 [INFO]: 	Creating the index 03/13/2025, 17:06:09
2025-03-13 17:06:09,874 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:06:09
2025-03-13 17:06:09,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:06:09,876 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:06:09
2025-03-13 17:06:09,876 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:06:09,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.99it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.96it/s]100%|██████████| 11/11 [00:02<00:00,  4.04it/s]100%|██████████| 11/11 [00:02<00:00,  5.01it/s]
2025-03-13 17:06:12,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:06:12
2025-03-13 17:06:43,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6218 secs
2025-03-13 17:06:43,699 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 17:06:43,699 [INFO]: 	Compute fast metrics 03/13/2025, 17:06:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.76it/s] 50%|█████     | 2/4 [00:00<00:00,  4.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.71it/s]
2025-03-13 17:07:03,073 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3740 secs
2025-03-13 17:07:03,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2017 secs
2025-03-13 17:07:03,078 [INFO]: {
2025-03-13 17:07:03,078 [INFO]: 	index_key: HNSW15
2025-03-13 17:07:03,078 [INFO]: 	index_param: efSearch=193
2025-03-13 17:07:03,078 [INFO]: 	index_path: knn.index
2025-03-13 17:07:03,078 [INFO]: 	size in bytes: 522748390
2025-03-13 17:07:03,078 [INFO]: 	avg_search_speed_ms: 12.121043809774248
2025-03-13 17:07:03,078 [INFO]: 	99p_search_speed_ms: 21.65509142912924
2025-03-13 17:07:03,078 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:07:03,078 [INFO]: 	nb vectors: 2657
2025-03-13 17:07:03,078 [INFO]: 	vectors dimension: 49152
2025-03-13 17:07:03,078 [INFO]: 	compression ratio: 0.9993095454583801
2025-03-13 17:07:03,078 [INFO]: }
2025-03-13 17:07:03,078 [INFO]: 	>>> Finished "Creating the index" in 53.2037 secs
2025-03-13 17:07:03,078 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2329 secs
2025-03-13 17:07:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:07:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 20662 [episode count 11/20]
[retrieval_preprocessing] for episode 41539 [episode count 12/20], we have num_retrieval=np.int64(2644) num_query=np.int64(158)
2025-03-13 17:07:05,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:07:06,025 [INFO]: Launching the whole pipeline 03/13/2025, 17:07:06
2025-03-13 17:07:06,025 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:07:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 613.47it/s]
2025-03-13 17:07:06,062 [INFO]: There are 2644 embeddings of dim 49152
2025-03-13 17:07:06,063 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-13 17:07:06,063 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:07:06
2025-03-13 17:07:06,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:07:06,064 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:07:06,064 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:07:06,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:07:06,064 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:07:06
2025-03-13 17:07:06,064 [INFO]: 545.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:07:06,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:07:06,065 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:07:06
2025-03-13 17:07:06,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:07:06,065 [INFO]: 	Creating the index 03/13/2025, 17:07:06
2025-03-13 17:07:06,065 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:07:06
2025-03-13 17:07:06,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-13 17:07:06,069 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:07:06
2025-03-13 17:07:06,070 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:07:06,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.00it/s] 36%|███▋      | 4/11 [00:00<00:00, 16.65it/s] 64%|██████▎   | 7/11 [00:00<00:00, 21.32it/s]100%|██████████| 11/11 [00:03<00:00,  2.13it/s]100%|██████████| 11/11 [00:03<00:00,  2.81it/s]
2025-03-13 17:07:09,994 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:07:09
2025-03-13 17:07:40,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1868 secs
2025-03-13 17:07:40,182 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 17:07:40,182 [INFO]: 	Compute fast metrics 03/13/2025, 17:07:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.93it/s]
2025-03-13 17:08:08,427 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2446 secs
2025-03-13 17:08:08,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3597 secs
2025-03-13 17:08:08,429 [INFO]: {
2025-03-13 17:08:08,430 [INFO]: 	index_key: HNSW15
2025-03-13 17:08:08,430 [INFO]: 	index_param: efSearch=283
2025-03-13 17:08:08,430 [INFO]: 	index_path: knn.index
2025-03-13 17:08:08,430 [INFO]: 	size in bytes: 520190770
2025-03-13 17:08:08,430 [INFO]: 	avg_search_speed_ms: 11.336491755942898
2025-03-13 17:08:08,430 [INFO]: 	99p_search_speed_ms: 16.6638444783166
2025-03-13 17:08:08,430 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:08:08,430 [INFO]: 	nb vectors: 2644
2025-03-13 17:08:08,430 [INFO]: 	vectors dimension: 49152
2025-03-13 17:08:08,430 [INFO]: 	compression ratio: 0.9993094494929236
2025-03-13 17:08:08,430 [INFO]: }
2025-03-13 17:08:08,430 [INFO]: 	>>> Finished "Creating the index" in 62.3644 secs
2025-03-13 17:08:08,430 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4044 secs
2025-03-13 17:08:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:08:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 41539 [episode count 12/20]
[retrieval_preprocessing] for episode 73053 [episode count 13/20], we have num_retrieval=np.int64(2681) num_query=np.int64(121)
2025-03-13 17:08:10,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:08:11,103 [INFO]: Launching the whole pipeline 03/13/2025, 17:08:11
2025-03-13 17:08:11,103 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:08:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1871.62it/s]
2025-03-13 17:08:11,134 [INFO]: There are 2681 embeddings of dim 49152
2025-03-13 17:08:11,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-13 17:08:11,136 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:08:11
2025-03-13 17:08:11,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:08:11,136 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:08:11,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:08:11,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:08:11,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:08:11
2025-03-13 17:08:11,137 [INFO]: 553.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:08:11,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:08:11,137 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:08:11
2025-03-13 17:08:11,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:08:11,138 [INFO]: 	Creating the index 03/13/2025, 17:08:11
2025-03-13 17:08:11,138 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:08:11
2025-03-13 17:08:11,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 17:08:11,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:08:11
2025-03-13 17:08:11,141 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:08:11,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.02it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.48it/s]100%|██████████| 11/11 [00:01<00:00,  5.82it/s]
2025-03-13 17:08:13,038 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:08:13
2025-03-13 17:08:47,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2505 secs
2025-03-13 17:08:47,290 [INFO]: The best hyperparameters are: efSearch=157
2025-03-13 17:08:47,290 [INFO]: 	Compute fast metrics 03/13/2025, 17:08:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.34it/s]
2025-03-13 17:09:02,107 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8163 secs
2025-03-13 17:09:02,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9675 secs
2025-03-13 17:09:02,109 [INFO]: {
2025-03-13 17:09:02,109 [INFO]: 	index_key: HNSW15
2025-03-13 17:09:02,109 [INFO]: 	index_param: efSearch=157
2025-03-13 17:09:02,109 [INFO]: 	index_path: knn.index
2025-03-13 17:09:02,109 [INFO]: 	size in bytes: 527470150
2025-03-13 17:09:02,109 [INFO]: 	avg_search_speed_ms: 9.143770597466494
2025-03-13 17:09:02,109 [INFO]: 	99p_search_speed_ms: 13.1351848808117
2025-03-13 17:09:02,109 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:09:02,109 [INFO]: 	nb vectors: 2681
2025-03-13 17:09:02,109 [INFO]: 	vectors dimension: 49152
2025-03-13 17:09:02,109 [INFO]: 	compression ratio: 0.9993097201803742
2025-03-13 17:09:02,109 [INFO]: }
2025-03-13 17:09:02,109 [INFO]: 	>>> Finished "Creating the index" in 50.9715 secs
2025-03-13 17:09:02,109 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0058 secs
2025-03-13 17:09:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:09:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 73053 [episode count 13/20]
[retrieval_preprocessing] for episode 24032 [episode count 14/20], we have num_retrieval=np.int64(2658) num_query=np.int64(144)
2025-03-13 17:09:03,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:09:03,789 [INFO]: Launching the whole pipeline 03/13/2025, 17:09:03
2025-03-13 17:09:03,789 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:09:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1236.53it/s]
2025-03-13 17:09:03,819 [INFO]: There are 2658 embeddings of dim 49152
2025-03-13 17:09:03,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-13 17:09:03,820 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:09:03,820 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:09:03,820 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:09:03,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:09:03,820 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,820 [INFO]: 548.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:09:03,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:09:03,820 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:09:03
2025-03-13 17:09:03,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:09:03,820 [INFO]: 	Creating the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,820 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:09:03
2025-03-13 17:09:03,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:09:03,822 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:09:03
2025-03-13 17:09:03,822 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:09:03,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.51it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.58it/s]100%|██████████| 11/11 [00:02<00:00,  3.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.29it/s]
2025-03-13 17:09:06,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:09:06
2025-03-13 17:09:39,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4843 secs
2025-03-13 17:09:39,872 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 17:09:39,872 [INFO]: 	Compute fast metrics 03/13/2025, 17:09:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 17:10:00,301 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4290 secs
2025-03-13 17:10:00,303 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4815 secs
2025-03-13 17:10:00,303 [INFO]: {
2025-03-13 17:10:00,303 [INFO]: 	index_key: HNSW15
2025-03-13 17:10:00,303 [INFO]: 	index_param: efSearch=249
2025-03-13 17:10:00,303 [INFO]: 	index_path: knn.index
2025-03-13 17:10:00,303 [INFO]: 	size in bytes: 522945130
2025-03-13 17:10:00,303 [INFO]: 	avg_search_speed_ms: 11.411140231891379
2025-03-13 17:10:00,303 [INFO]: 	99p_search_speed_ms: 17.450064923614264
2025-03-13 17:10:00,303 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:10:00,303 [INFO]: 	nb vectors: 2658
2025-03-13 17:10:00,303 [INFO]: 	vectors dimension: 49152
2025-03-13 17:10:00,303 [INFO]: 	compression ratio: 0.9993095528014574
2025-03-13 17:10:00,303 [INFO]: }
2025-03-13 17:10:00,303 [INFO]: 	>>> Finished "Creating the index" in 56.4832 secs
2025-03-13 17:10:00,303 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5148 secs
2025-03-13 17:10:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:10:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 24032 [episode count 14/20]
[retrieval_preprocessing] for episode 11253 [episode count 15/20], we have num_retrieval=np.int64(2662) num_query=np.int64(140)
2025-03-13 17:10:01,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:10:02,361 [INFO]: Launching the whole pipeline 03/13/2025, 17:10:02
2025-03-13 17:10:02,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:10:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2922.86it/s]
2025-03-13 17:10:02,386 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 17:10:02,386 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:10:02,387 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:10:02
2025-03-13 17:10:02,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:10:02,387 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:10:02,387 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:10:02,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 17:10:02,388 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:10:02
2025-03-13 17:10:02,388 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:10:02,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:10:02,388 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:10:02
2025-03-13 17:10:02,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:10:02,388 [INFO]: 	Creating the index 03/13/2025, 17:10:02
2025-03-13 17:10:02,388 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:10:02
2025-03-13 17:10:02,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 17:10:02,392 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:10:02
2025-03-13 17:10:02,392 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:10:02,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.33it/s] 64%|██████▎   | 7/11 [00:00<00:00, 37.12it/s]100%|██████████| 11/11 [00:01<00:00,  4.74it/s]100%|██████████| 11/11 [00:01<00:00,  5.87it/s]
2025-03-13 17:10:04,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:10:04
2025-03-13 17:10:38,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6856 secs
2025-03-13 17:10:38,959 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 17:10:38,959 [INFO]: 	Compute fast metrics 03/13/2025, 17:10:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-13 17:11:14,381 [INFO]: 	>>> Finished "Compute fast metrics" in 35.4219 secs
2025-03-13 17:11:14,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9912 secs
2025-03-13 17:11:14,383 [INFO]: {
2025-03-13 17:11:14,383 [INFO]: 	index_key: HNSW15
2025-03-13 17:11:14,383 [INFO]: 	index_param: efSearch=238
2025-03-13 17:11:14,383 [INFO]: 	index_path: knn.index
2025-03-13 17:11:14,383 [INFO]: 	size in bytes: 523732090
2025-03-13 17:11:14,383 [INFO]: 	avg_search_speed_ms: 9.684264610971379
2025-03-13 17:11:14,383 [INFO]: 	99p_search_speed_ms: 12.246365416795015
2025-03-13 17:11:14,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:11:14,383 [INFO]: 	nb vectors: 2662
2025-03-13 17:11:14,383 [INFO]: 	vectors dimension: 49152
2025-03-13 17:11:14,383 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 17:11:14,383 [INFO]: }
2025-03-13 17:11:14,383 [INFO]: 	>>> Finished "Creating the index" in 71.9949 secs
2025-03-13 17:11:14,383 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0222 secs
2025-03-13 17:11:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:11:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 11253 [episode count 15/20]
[retrieval_preprocessing] for episode 60403 [episode count 16/20], we have num_retrieval=np.int64(2647) num_query=np.int64(155)
2025-03-13 17:11:16,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:11:16,442 [INFO]: Launching the whole pipeline 03/13/2025, 17:11:16
2025-03-13 17:11:16,442 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:11:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1957.21it/s]
2025-03-13 17:11:16,470 [INFO]: There are 2647 embeddings of dim 49152
2025-03-13 17:11:16,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 17:11:16,470 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:11:16
2025-03-13 17:11:16,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:11:16,470 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:11:16,470 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:11:16,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:11:16,470 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:11:16
2025-03-13 17:11:16,470 [INFO]: 546.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:11:16,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:11:16,470 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:11:16
2025-03-13 17:11:16,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:11:16,470 [INFO]: 	Creating the index 03/13/2025, 17:11:16
2025-03-13 17:11:16,470 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:11:16
2025-03-13 17:11:16,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:11:16,472 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:11:16
2025-03-13 17:11:16,472 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:11:16,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.02it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.77it/s]100%|██████████| 11/11 [00:02<00:00,  4.10it/s]100%|██████████| 11/11 [00:02<00:00,  4.82it/s]
2025-03-13 17:11:18,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:11:18
2025-03-13 17:11:57,231 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4737 secs
2025-03-13 17:11:57,232 [INFO]: The best hyperparameters are: efSearch=90
2025-03-13 17:11:57,232 [INFO]: 	Compute fast metrics 03/13/2025, 17:11:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.45it/s]
2025-03-13 17:12:18,292 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0604 secs
2025-03-13 17:12:18,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8244 secs
2025-03-13 17:12:18,297 [INFO]: {
2025-03-13 17:12:18,297 [INFO]: 	index_key: HNSW15
2025-03-13 17:12:18,297 [INFO]: 	index_param: efSearch=90
2025-03-13 17:12:18,297 [INFO]: 	index_path: knn.index
2025-03-13 17:12:18,297 [INFO]: 	size in bytes: 520780990
2025-03-13 17:12:18,297 [INFO]: 	avg_search_speed_ms: 7.30717254919
2025-03-13 17:12:18,297 [INFO]: 	99p_search_speed_ms: 12.008901045192033
2025-03-13 17:12:18,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:12:18,297 [INFO]: 	nb vectors: 2647
2025-03-13 17:12:18,297 [INFO]: 	vectors dimension: 49152
2025-03-13 17:12:18,297 [INFO]: 	compression ratio: 0.9993094717224605
2025-03-13 17:12:18,297 [INFO]: }
2025-03-13 17:12:18,297 [INFO]: 	>>> Finished "Creating the index" in 61.8264 secs
2025-03-13 17:12:18,297 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8545 secs
2025-03-13 17:12:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:12:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 60403 [episode count 16/20]
[retrieval_preprocessing] for episode 82166 [episode count 17/20], we have num_retrieval=np.int64(2648) num_query=np.int64(154)
2025-03-13 17:12:19,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:12:20,371 [INFO]: Launching the whole pipeline 03/13/2025, 17:12:20
2025-03-13 17:12:20,372 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:12:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1218.57it/s]
2025-03-13 17:12:20,406 [INFO]: There are 2648 embeddings of dim 49152
2025-03-13 17:12:20,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 17:12:20,406 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:12:20
2025-03-13 17:12:20,406 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:12:20,406 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:12:20,406 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:12:20,406 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:12:20,406 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:12:20
2025-03-13 17:12:20,406 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:12:20,406 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:12:20,406 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:12:20
2025-03-13 17:12:20,406 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:12:20,406 [INFO]: 	Creating the index 03/13/2025, 17:12:20
2025-03-13 17:12:20,407 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:12:20
2025-03-13 17:12:20,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:12:20,408 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:12:20
2025-03-13 17:12:20,408 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:12:20,408 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.41it/s] 36%|███▋      | 4/11 [00:00<00:00, 12.58it/s] 64%|██████▎   | 7/11 [00:00<00:00, 16.27it/s] 91%|█████████ | 10/11 [00:00<00:00, 18.36it/s]100%|██████████| 11/11 [00:04<00:00,  2.58it/s]
2025-03-13 17:12:24,674 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:12:24
2025-03-13 17:13:03,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1581 secs
2025-03-13 17:13:03,833 [INFO]: The best hyperparameters are: efSearch=180
2025-03-13 17:13:03,833 [INFO]: 	Compute fast metrics 03/13/2025, 17:13:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.29it/s]
2025-03-13 17:13:25,464 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6309 secs
2025-03-13 17:13:25,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0587 secs
2025-03-13 17:13:25,467 [INFO]: {
2025-03-13 17:13:25,467 [INFO]: 	index_key: HNSW15
2025-03-13 17:13:25,467 [INFO]: 	index_param: efSearch=180
2025-03-13 17:13:25,467 [INFO]: 	index_path: knn.index
2025-03-13 17:13:25,467 [INFO]: 	size in bytes: 520977730
2025-03-13 17:13:25,467 [INFO]: 	avg_search_speed_ms: 8.0179336808401
2025-03-13 17:13:25,467 [INFO]: 	99p_search_speed_ms: 14.147393922321491
2025-03-13 17:13:25,467 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:13:25,467 [INFO]: 	nb vectors: 2648
2025-03-13 17:13:25,467 [INFO]: 	vectors dimension: 49152
2025-03-13 17:13:25,467 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-13 17:13:25,467 [INFO]: }
2025-03-13 17:13:25,467 [INFO]: 	>>> Finished "Creating the index" in 65.0606 secs
2025-03-13 17:13:25,467 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0956 secs
2025-03-13 17:13:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:13:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 82166 [episode count 17/20]
[retrieval_preprocessing] for episode 83958 [episode count 18/20], we have num_retrieval=np.int64(2678) num_query=np.int64(124)
2025-03-13 17:13:27,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:13:27,728 [INFO]: Launching the whole pipeline 03/13/2025, 17:13:27
2025-03-13 17:13:27,728 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:13:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 981.35it/s]
2025-03-13 17:13:27,757 [INFO]: There are 2678 embeddings of dim 49152
2025-03-13 17:13:27,758 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 17:13:27,758 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:13:27
2025-03-13 17:13:27,758 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:13:27,758 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:13:27,758 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:13:27,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:13:27,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:13:27
2025-03-13 17:13:27,758 [INFO]: 552.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:13:27,758 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:13:27,758 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:13:27
2025-03-13 17:13:27,758 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:13:27,758 [INFO]: 	Creating the index 03/13/2025, 17:13:27
2025-03-13 17:13:27,758 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:13:27
2025-03-13 17:13:27,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:13:27,760 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:13:27
2025-03-13 17:13:27,760 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:13:27,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.58it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.83it/s]100%|██████████| 11/11 [00:02<00:00,  3.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.53it/s]
2025-03-13 17:13:30,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:13:30
2025-03-13 17:14:04,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0601 secs
2025-03-13 17:14:04,049 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 17:14:04,049 [INFO]: 	Compute fast metrics 03/13/2025, 17:14:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.09it/s]
2025-03-13 17:14:24,103 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0542 secs
2025-03-13 17:14:24,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5605 secs
2025-03-13 17:14:24,321 [INFO]: {
2025-03-13 17:14:24,321 [INFO]: 	index_key: HNSW15
2025-03-13 17:14:24,321 [INFO]: 	index_param: efSearch=234
2025-03-13 17:14:24,321 [INFO]: 	index_path: knn.index
2025-03-13 17:14:24,321 [INFO]: 	size in bytes: 526879930
2025-03-13 17:14:24,321 [INFO]: 	avg_search_speed_ms: 11.645740936743367
2025-03-13 17:14:24,321 [INFO]: 	99p_search_speed_ms: 15.441821054555469
2025-03-13 17:14:24,321 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:14:24,321 [INFO]: 	nb vectors: 2678
2025-03-13 17:14:24,321 [INFO]: 	vectors dimension: 49152
2025-03-13 17:14:24,321 [INFO]: 	compression ratio: 0.9993096985113857
2025-03-13 17:14:24,321 [INFO]: }
2025-03-13 17:14:24,321 [INFO]: 	>>> Finished "Creating the index" in 56.5632 secs
2025-03-13 17:14:24,322 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5933 secs
2025-03-13 17:14:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:14:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 83958 [episode count 18/20]
[retrieval_preprocessing] for episode 82553 [episode count 19/20], we have num_retrieval=np.int64(2621) num_query=np.int64(181)
2025-03-13 17:14:25,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:14:26,328 [INFO]: Launching the whole pipeline 03/13/2025, 17:14:26
2025-03-13 17:14:26,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:14:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 925.49it/s]
2025-03-13 17:14:26,358 [INFO]: There are 2621 embeddings of dim 49152
2025-03-13 17:14:26,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 17:14:26,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:14:26,358 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:14:26,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:14:26,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:14:26,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,359 [INFO]: 540.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:14:26,359 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:14:26,359 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:14:26
2025-03-13 17:14:26,359 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:14:26,359 [INFO]: 	Creating the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,359 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:14:26
2025-03-13 17:14:26,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:14:26,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:14:26
2025-03-13 17:14:26,360 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:14:26,360 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.77it/s] 45%|████▌     | 5/11 [00:00<00:00, 24.91it/s] 82%|████████▏ | 9/11 [00:00<00:00, 30.35it/s]100%|██████████| 11/11 [00:03<00:00,  3.53it/s]
2025-03-13 17:14:29,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:14:29
2025-03-13 17:15:07,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6844 secs
2025-03-13 17:15:07,166 [INFO]: The best hyperparameters are: efSearch=198
2025-03-13 17:15:07,166 [INFO]: 	Compute fast metrics 03/13/2025, 17:15:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.76it/s]
2025-03-13 17:15:41,705 [INFO]: 	>>> Finished "Compute fast metrics" in 34.5381 secs
2025-03-13 17:15:41,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.3460 secs
2025-03-13 17:15:41,706 [INFO]: {
2025-03-13 17:15:41,706 [INFO]: 	index_key: HNSW15
2025-03-13 17:15:41,706 [INFO]: 	index_param: efSearch=198
2025-03-13 17:15:41,706 [INFO]: 	index_path: knn.index
2025-03-13 17:15:41,706 [INFO]: 	size in bytes: 515665690
2025-03-13 17:15:41,706 [INFO]: 	avg_search_speed_ms: 8.384959978712699
2025-03-13 17:15:41,706 [INFO]: 	99p_search_speed_ms: 10.736437682062386
2025-03-13 17:15:41,706 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:15:41,706 [INFO]: 	nb vectors: 2621
2025-03-13 17:15:41,706 [INFO]: 	vectors dimension: 49152
2025-03-13 17:15:41,706 [INFO]: 	compression ratio: 0.9993093936499828
2025-03-13 17:15:41,706 [INFO]: }
2025-03-13 17:15:41,707 [INFO]: 	>>> Finished "Creating the index" in 75.3475 secs
2025-03-13 17:15:41,707 [INFO]: >>> Finished "Launching the whole pipeline" in 75.3783 secs
2025-03-13 17:15:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:15:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 82553 [episode count 19/20]
2025-03-13 17:15:42: [retrieval_preprocessing] finished for 3246924425_corn_in_bowl [chosen_id count 5/196]
2025-03-13 17:15:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3246924425_yellow_object_in_bowl [chosen_id count 6/196]
2025-03-13 17:15:44: [retrieval_preprocessing] we have num_total=2800 embedding_dim=49152
[retrieval_preprocessing] for episode 38791 [episode count 0/20], we have num_retrieval=np.int64(2637) num_query=np.int64(163)
2025-03-13 17:15:44,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:15:45,263 [INFO]: Launching the whole pipeline 03/13/2025, 17:15:45
2025-03-13 17:15:45,263 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-13 17:15:45,289 [INFO]: There are 2637 embeddings of dim 49152
2025-03-13 17:15:45,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 17:15:45,289 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:15:45,289 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:15:45,289 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:15:45,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:15:45,289 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,289 [INFO]: 544.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:15:45,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:15:45,289 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:15:45
2025-03-13 17:15:45,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:15:45,289 [INFO]: 	Creating the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,289 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:15:45
2025-03-13 17:15:45,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:15:45,290 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:15:45
2025-03-13 17:15:45,290 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:15:45,291 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.85it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.71it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.10it/s]
2025-03-13 17:15:47,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:15:47
2025-03-13 17:16:21,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6385 secs
2025-03-13 17:16:21,089 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:16:21,089 [INFO]: 	Compute fast metrics 03/13/2025, 17:16:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-13 17:16:43,442 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3533 secs
2025-03-13 17:16:43,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1545 secs
2025-03-13 17:16:43,445 [INFO]: {
2025-03-13 17:16:43,445 [INFO]: 	index_key: HNSW15
2025-03-13 17:16:43,445 [INFO]: 	index_param: efSearch=207
2025-03-13 17:16:43,445 [INFO]: 	index_path: knn.index
2025-03-13 17:16:43,445 [INFO]: 	size in bytes: 518813590
2025-03-13 17:16:43,445 [INFO]: 	avg_search_speed_ms: 12.385335684889965
2025-03-13 17:16:43,445 [INFO]: 	99p_search_speed_ms: 19.941079542040807
2025-03-13 17:16:43,445 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:16:43,445 [INFO]: 	nb vectors: 2637
2025-03-13 17:16:43,445 [INFO]: 	vectors dimension: 49152
2025-03-13 17:16:43,445 [INFO]: 	compression ratio: 0.9993093974273111
2025-03-13 17:16:43,445 [INFO]: }
2025-03-13 17:16:43,445 [INFO]: 	>>> Finished "Creating the index" in 58.1559 secs
2025-03-13 17:16:43,445 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1823 secs
2025-03-13 17:16:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:16:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 38791 [episode count 0/20]
[retrieval_preprocessing] for episode 67980 [episode count 1/20], we have num_retrieval=np.int64(2679) num_query=np.int64(121)
2025-03-13 17:16:46,471 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:16:47,042 [INFO]: Launching the whole pipeline 03/13/2025, 17:16:47
2025-03-13 17:16:47,043 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:16:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 813.64it/s]
2025-03-13 17:16:47,071 [INFO]: There are 2679 embeddings of dim 49152
2025-03-13 17:16:47,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:16:47,071 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:16:47
2025-03-13 17:16:47,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:16:47,071 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:16:47,071 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:16:47,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:16:47,071 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:16:47
2025-03-13 17:16:47,072 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:16:47,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:16:47,072 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:16:47
2025-03-13 17:16:47,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:16:47,072 [INFO]: 	Creating the index 03/13/2025, 17:16:47
2025-03-13 17:16:47,072 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:16:47
2025-03-13 17:16:47,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:16:47,073 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:16:47
2025-03-13 17:16:47,073 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:16:47,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.54it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.28it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.42it/s]100%|██████████| 11/11 [00:03<00:00,  3.41it/s]
2025-03-13 17:16:50,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:16:50
2025-03-13 17:17:24,620 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3207 secs
2025-03-13 17:17:24,621 [INFO]: The best hyperparameters are: efSearch=121
2025-03-13 17:17:24,621 [INFO]: 	Compute fast metrics 03/13/2025, 17:17:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 17:17:50,764 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1436 secs
2025-03-13 17:17:50,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6935 secs
2025-03-13 17:17:50,767 [INFO]: {
2025-03-13 17:17:50,767 [INFO]: 	index_key: HNSW15
2025-03-13 17:17:50,767 [INFO]: 	index_param: efSearch=121
2025-03-13 17:17:50,767 [INFO]: 	index_path: knn.index
2025-03-13 17:17:50,767 [INFO]: 	size in bytes: 527076670
2025-03-13 17:17:50,767 [INFO]: 	avg_search_speed_ms: 6.104990750834373
2025-03-13 17:17:50,767 [INFO]: 	99p_search_speed_ms: 8.882221470121292
2025-03-13 17:17:50,767 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:17:50,767 [INFO]: 	nb vectors: 2679
2025-03-13 17:17:50,767 [INFO]: 	vectors dimension: 49152
2025-03-13 17:17:50,767 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-13 17:17:50,767 [INFO]: }
2025-03-13 17:17:50,767 [INFO]: 	>>> Finished "Creating the index" in 63.6953 secs
2025-03-13 17:17:50,767 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7245 secs
2025-03-13 17:17:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:17:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 67980 [episode count 1/20]
[retrieval_preprocessing] for episode 58127 [episode count 2/20], we have num_retrieval=np.int64(2694) num_query=np.int64(106)
2025-03-13 17:17:51,759 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:17:52,636 [INFO]: Launching the whole pipeline 03/13/2025, 17:17:52
2025-03-13 17:17:52,636 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:17:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1588.75it/s]
2025-03-13 17:17:52,662 [INFO]: There are 2694 embeddings of dim 49152
2025-03-13 17:17:52,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:17:52,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:17:52
2025-03-13 17:17:52,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:17:52,663 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:17:52,663 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:17:52,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:17:52,663 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:17:52
2025-03-13 17:17:52,663 [INFO]: 556.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:17:52,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:17:52,663 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:17:52
2025-03-13 17:17:52,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:17:52,663 [INFO]: 	Creating the index 03/13/2025, 17:17:52
2025-03-13 17:17:52,663 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:17:52
2025-03-13 17:17:52,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:17:52,664 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:17:52
2025-03-13 17:17:52,664 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:17:52,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.91it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.85it/s]100%|██████████| 11/11 [00:02<00:00,  4.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.79it/s]
2025-03-13 17:17:54,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:17:54
2025-03-13 17:18:30,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2231 secs
2025-03-13 17:18:30,187 [INFO]: The best hyperparameters are: efSearch=193
2025-03-13 17:18:30,187 [INFO]: 	Compute fast metrics 03/13/2025, 17:18:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.76it/s]
2025-03-13 17:18:53,090 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9030 secs
2025-03-13 17:18:53,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9634 secs
2025-03-13 17:18:53,628 [INFO]: {
2025-03-13 17:18:53,628 [INFO]: 	index_key: HNSW15
2025-03-13 17:18:53,628 [INFO]: 	index_param: efSearch=193
2025-03-13 17:18:53,628 [INFO]: 	index_path: knn.index
2025-03-13 17:18:53,628 [INFO]: 	size in bytes: 530027770
2025-03-13 17:18:53,628 [INFO]: 	avg_search_speed_ms: 9.396812820396093
2025-03-13 17:18:53,628 [INFO]: 	99p_search_speed_ms: 12.681127479299898
2025-03-13 17:18:53,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:18:53,629 [INFO]: 	nb vectors: 2694
2025-03-13 17:18:53,629 [INFO]: 	vectors dimension: 49152
2025-03-13 17:18:53,629 [INFO]: 	compression ratio: 0.9993098135216576
2025-03-13 17:18:53,629 [INFO]: }
2025-03-13 17:18:53,629 [INFO]: 	>>> Finished "Creating the index" in 60.9657 secs
2025-03-13 17:18:53,629 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9923 secs
2025-03-13 17:18:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:18:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 58127 [episode count 2/20]
[retrieval_preprocessing] for episode 77220 [episode count 3/20], we have num_retrieval=np.int64(2664) num_query=np.int64(136)
2025-03-13 17:18:54,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:18:55,336 [INFO]: Launching the whole pipeline 03/13/2025, 17:18:55
2025-03-13 17:18:55,336 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1868.29it/s]
2025-03-13 17:18:55,358 [INFO]: There are 2664 embeddings of dim 49152
2025-03-13 17:18:55,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 17:18:55,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:18:55
2025-03-13 17:18:55,358 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:18:55,358 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:18:55,358 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:18:55,358 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:18:55,358 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:18:55
2025-03-13 17:18:55,359 [INFO]: 549.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:18:55,359 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:18:55,359 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:18:55
2025-03-13 17:18:55,359 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:18:55,359 [INFO]: 	Creating the index 03/13/2025, 17:18:55
2025-03-13 17:18:55,359 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:18:55
2025-03-13 17:18:55,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:18:55,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:18:55
2025-03-13 17:18:55,360 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:18:55,360 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.03it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.26it/s] 82%|████████▏ | 9/11 [00:00<00:00, 30.32it/s]100%|██████████| 11/11 [00:02<00:00,  5.15it/s]
2025-03-13 17:18:57,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:18:57
2025-03-13 17:19:30,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6013 secs
2025-03-13 17:19:30,103 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:19:30,103 [INFO]: 	Compute fast metrics 03/13/2025, 17:19:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.31it/s]
2025-03-13 17:19:54,962 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8585 secs
2025-03-13 17:19:54,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6036 secs
2025-03-13 17:19:54,964 [INFO]: {
2025-03-13 17:19:54,964 [INFO]: 	index_key: HNSW15
2025-03-13 17:19:54,964 [INFO]: 	index_param: efSearch=207
2025-03-13 17:19:54,964 [INFO]: 	index_path: knn.index
2025-03-13 17:19:54,964 [INFO]: 	size in bytes: 524125570
2025-03-13 17:19:54,964 [INFO]: 	avg_search_speed_ms: 9.69876536433734
2025-03-13 17:19:54,964 [INFO]: 	99p_search_speed_ms: 13.229545438662173
2025-03-13 17:19:54,964 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:19:54,964 [INFO]: 	nb vectors: 2664
2025-03-13 17:19:54,964 [INFO]: 	vectors dimension: 49152
2025-03-13 17:19:54,964 [INFO]: 	compression ratio: 0.9993095967441543
2025-03-13 17:19:54,964 [INFO]: }
2025-03-13 17:19:54,964 [INFO]: 	>>> Finished "Creating the index" in 59.6052 secs
2025-03-13 17:19:54,964 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6281 secs
2025-03-13 17:19:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:19:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 77220 [episode count 3/20]
[retrieval_preprocessing] for episode 59057 [episode count 4/20], we have num_retrieval=np.int64(2683) num_query=np.int64(117)
2025-03-13 17:19:56,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:19:56,565 [INFO]: Launching the whole pipeline 03/13/2025, 17:19:56
2025-03-13 17:19:56,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:19:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.04it/s]
2025-03-13 17:19:56,591 [INFO]: There are 2683 embeddings of dim 49152
2025-03-13 17:19:56,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 17:19:56,591 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:19:56
2025-03-13 17:19:56,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:19:56,592 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:19:56,592 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:19:56,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 17:19:56,592 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:19:56
2025-03-13 17:19:56,592 [INFO]: 553.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:19:56,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:19:56,593 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:19:56
2025-03-13 17:19:56,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:19:56,593 [INFO]: 	Creating the index 03/13/2025, 17:19:56
2025-03-13 17:19:56,593 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:19:56
2025-03-13 17:19:56,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 17:19:56,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:19:56
2025-03-13 17:19:56,596 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:19:56,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.50it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.08it/s]100%|██████████| 11/11 [00:02<00:00,  5.07it/s]
2025-03-13 17:19:58,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:19:58
2025-03-13 17:20:31,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1013 secs
2025-03-13 17:20:31,872 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:20:31,872 [INFO]: 	Compute fast metrics 03/13/2025, 17:20:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-13 17:20:52,728 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8558 secs
2025-03-13 17:20:52,731 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1349 secs
2025-03-13 17:20:52,731 [INFO]: {
2025-03-13 17:20:52,731 [INFO]: 	index_key: HNSW15
2025-03-13 17:20:52,731 [INFO]: 	index_param: efSearch=191
2025-03-13 17:20:52,731 [INFO]: 	index_path: knn.index
2025-03-13 17:20:52,731 [INFO]: 	size in bytes: 527863630
2025-03-13 17:20:52,731 [INFO]: 	avg_search_speed_ms: 10.829989527235234
2025-03-13 17:20:52,731 [INFO]: 	99p_search_speed_ms: 15.650318874977527
2025-03-13 17:20:52,731 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:20:52,732 [INFO]: 	nb vectors: 2683
2025-03-13 17:20:52,732 [INFO]: 	vectors dimension: 49152
2025-03-13 17:20:52,732 [INFO]: 	compression ratio: 0.9993097345994457
2025-03-13 17:20:52,732 [INFO]: }
2025-03-13 17:20:52,732 [INFO]: 	>>> Finished "Creating the index" in 56.1386 secs
2025-03-13 17:20:52,732 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1661 secs
2025-03-13 17:20:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:20:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 59057 [episode count 4/20]
[retrieval_preprocessing] for episode 9266 [episode count 5/20], we have num_retrieval=np.int64(2623) num_query=np.int64(177)
2025-03-13 17:20:54,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:20:54,726 [INFO]: Launching the whole pipeline 03/13/2025, 17:20:54
2025-03-13 17:20:54,727 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:20:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1664.41it/s]
2025-03-13 17:20:54,749 [INFO]: There are 2623 embeddings of dim 49152
2025-03-13 17:20:54,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 17:20:54,749 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:20:54,749 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:20:54,749 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:20:54,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:20:54,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,750 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:20:54,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:20:54,750 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:20:54
2025-03-13 17:20:54,750 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:20:54,750 [INFO]: 	Creating the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,750 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:20:54
2025-03-13 17:20:54,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:20:54,751 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:20:54
2025-03-13 17:20:54,751 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:20:54,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.15it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.20it/s] 82%|████████▏ | 9/11 [00:00<00:00, 29.60it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]
2025-03-13 17:20:57,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:20:57
2025-03-13 17:21:31,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5569 secs
2025-03-13 17:21:31,055 [INFO]: The best hyperparameters are: efSearch=143
2025-03-13 17:21:31,055 [INFO]: 	Compute fast metrics 03/13/2025, 17:21:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.62it/s]
2025-03-13 17:21:53,632 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5768 secs
2025-03-13 17:21:53,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8832 secs
2025-03-13 17:21:53,635 [INFO]: {
2025-03-13 17:21:53,635 [INFO]: 	index_key: HNSW15
2025-03-13 17:21:53,635 [INFO]: 	index_param: efSearch=143
2025-03-13 17:21:53,635 [INFO]: 	index_path: knn.index
2025-03-13 17:21:53,635 [INFO]: 	size in bytes: 516059170
2025-03-13 17:21:53,635 [INFO]: 	avg_search_speed_ms: 9.09005949548869
2025-03-13 17:21:53,635 [INFO]: 	99p_search_speed_ms: 14.55910271732136
2025-03-13 17:21:53,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:21:53,635 [INFO]: 	nb vectors: 2623
2025-03-13 17:21:53,635 [INFO]: 	vectors dimension: 49152
2025-03-13 17:21:53,635 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-13 17:21:53,635 [INFO]: }
2025-03-13 17:21:53,635 [INFO]: 	>>> Finished "Creating the index" in 58.8850 secs
2025-03-13 17:21:53,635 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9084 secs
2025-03-13 17:21:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:21:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 9266 [episode count 5/20]
[retrieval_preprocessing] for episode 35506 [episode count 6/20], we have num_retrieval=np.int64(2662) num_query=np.int64(138)
2025-03-13 17:21:55,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:21:55,755 [INFO]: Launching the whole pipeline 03/13/2025, 17:21:55
2025-03-13 17:21:55,755 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:21:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.31it/s]
2025-03-13 17:21:55,785 [INFO]: There are 2662 embeddings of dim 49152
2025-03-13 17:21:55,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 17:21:55,786 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:21:55,786 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:21:55,786 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:21:55,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:21:55,786 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,786 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:21:55,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:21:55,786 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:21:55
2025-03-13 17:21:55,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:21:55,786 [INFO]: 	Creating the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,786 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:21:55
2025-03-13 17:21:55,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:21:55,788 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:21:55
2025-03-13 17:21:55,788 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:21:55,788 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.40it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]100%|██████████| 11/11 [00:02<00:00,  4.89it/s]
2025-03-13 17:21:58,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:21:58
2025-03-13 17:22:32,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5143 secs
2025-03-13 17:22:32,554 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 17:22:32,554 [INFO]: 	Compute fast metrics 03/13/2025, 17:22:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.80it/s]
2025-03-13 17:22:51,963 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4090 secs
2025-03-13 17:22:51,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1783 secs
2025-03-13 17:22:51,966 [INFO]: {
2025-03-13 17:22:51,966 [INFO]: 	index_key: HNSW15
2025-03-13 17:22:51,966 [INFO]: 	index_param: efSearch=194
2025-03-13 17:22:51,966 [INFO]: 	index_path: knn.index
2025-03-13 17:22:51,966 [INFO]: 	size in bytes: 523732090
2025-03-13 17:22:51,966 [INFO]: 	avg_search_speed_ms: 10.151662454150882
2025-03-13 17:22:51,966 [INFO]: 	99p_search_speed_ms: 14.603628423064947
2025-03-13 17:22:51,966 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:22:51,966 [INFO]: 	nb vectors: 2662
2025-03-13 17:22:51,966 [INFO]: 	vectors dimension: 49152
2025-03-13 17:22:51,967 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-13 17:22:51,967 [INFO]: }
2025-03-13 17:22:51,967 [INFO]: 	>>> Finished "Creating the index" in 56.1802 secs
2025-03-13 17:22:51,967 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2112 secs
2025-03-13 17:22:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:22:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 35506 [episode count 6/20]
[retrieval_preprocessing] for episode 68530 [episode count 7/20], we have num_retrieval=np.int64(2681) num_query=np.int64(119)
2025-03-13 17:22:53,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:22:53,973 [INFO]: Launching the whole pipeline 03/13/2025, 17:22:53
2025-03-13 17:22:53,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:22:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.15it/s]
2025-03-13 17:22:53,999 [INFO]: There are 2681 embeddings of dim 49152
2025-03-13 17:22:53,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:22:53,999 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:22:53
2025-03-13 17:22:53,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:22:53,999 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:22:53,999 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:22:53,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:22:53,999 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:22:53
2025-03-13 17:22:53,999 [INFO]: 553.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:22:53,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:22:54,000 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:22:54
2025-03-13 17:22:54,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:22:54,000 [INFO]: 	Creating the index 03/13/2025, 17:22:54
2025-03-13 17:22:54,000 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:22:54
2025-03-13 17:22:54,001 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:22:54,001 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:22:54
2025-03-13 17:22:54,001 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:22:54,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.97it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.25it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.57it/s]
2025-03-13 17:22:56,409 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:22:56
2025-03-13 17:23:30,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7735 secs
2025-03-13 17:23:30,184 [INFO]: The best hyperparameters are: efSearch=126
2025-03-13 17:23:30,184 [INFO]: 	Compute fast metrics 03/13/2025, 17:23:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-13 17:23:59,580 [INFO]: 	>>> Finished "Compute fast metrics" in 29.3960 secs
2025-03-13 17:23:59,582 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5812 secs
2025-03-13 17:23:59,582 [INFO]: {
2025-03-13 17:23:59,582 [INFO]: 	index_key: HNSW15
2025-03-13 17:23:59,582 [INFO]: 	index_param: efSearch=126
2025-03-13 17:23:59,582 [INFO]: 	index_path: knn.index
2025-03-13 17:23:59,582 [INFO]: 	size in bytes: 527470150
2025-03-13 17:23:59,582 [INFO]: 	avg_search_speed_ms: 6.97373380417568
2025-03-13 17:23:59,582 [INFO]: 	99p_search_speed_ms: 10.159276465419683
2025-03-13 17:23:59,582 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:23:59,582 [INFO]: 	nb vectors: 2681
2025-03-13 17:23:59,582 [INFO]: 	vectors dimension: 49152
2025-03-13 17:23:59,582 [INFO]: 	compression ratio: 0.9993097201803742
2025-03-13 17:23:59,582 [INFO]: }
2025-03-13 17:23:59,582 [INFO]: 	>>> Finished "Creating the index" in 65.5828 secs
2025-03-13 17:23:59,582 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6092 secs
2025-03-13 17:23:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:24:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 68530 [episode count 7/20]
[retrieval_preprocessing] for episode 46910 [episode count 8/20], we have num_retrieval=np.int64(2677) num_query=np.int64(123)
2025-03-13 17:24:00,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:24:00,997 [INFO]: Launching the whole pipeline 03/13/2025, 17:24:00
2025-03-13 17:24:00,997 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:24:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.92it/s]
2025-03-13 17:24:01,023 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 17:24:01,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 17:24:01,023 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:24:01
2025-03-13 17:24:01,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:24:01,023 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:24:01,023 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:24:01,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:24:01,023 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:24:01
2025-03-13 17:24:01,024 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:24:01,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:24:01,024 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:24:01
2025-03-13 17:24:01,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:24:01,024 [INFO]: 	Creating the index 03/13/2025, 17:24:01
2025-03-13 17:24:01,024 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:24:01
2025-03-13 17:24:01,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:24:01,025 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:24:01
2025-03-13 17:24:01,025 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:24:01,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.93it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.87it/s]100%|██████████| 11/11 [00:02<00:00,  3.99it/s]100%|██████████| 11/11 [00:02<00:00,  4.69it/s]
2025-03-13 17:24:03,375 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:24:03
2025-03-13 17:24:38,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9719 secs
2025-03-13 17:24:38,347 [INFO]: The best hyperparameters are: efSearch=209
2025-03-13 17:24:38,347 [INFO]: 	Compute fast metrics 03/13/2025, 17:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.16it/s]
2025-03-13 17:25:08,168 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8209 secs
2025-03-13 17:25:08,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1458 secs
2025-03-13 17:25:08,171 [INFO]: {
2025-03-13 17:25:08,171 [INFO]: 	index_key: HNSW15
2025-03-13 17:25:08,171 [INFO]: 	index_param: efSearch=209
2025-03-13 17:25:08,171 [INFO]: 	index_path: knn.index
2025-03-13 17:25:08,171 [INFO]: 	size in bytes: 526683190
2025-03-13 17:25:08,171 [INFO]: 	avg_search_speed_ms: 10.129880432750246
2025-03-13 17:25:08,171 [INFO]: 	99p_search_speed_ms: 15.545329777523875
2025-03-13 17:25:08,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:25:08,171 [INFO]: 	nb vectors: 2677
2025-03-13 17:25:08,171 [INFO]: 	vectors dimension: 49152
2025-03-13 17:25:08,171 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 17:25:08,171 [INFO]: }
2025-03-13 17:25:08,171 [INFO]: 	>>> Finished "Creating the index" in 67.1474 secs
2025-03-13 17:25:08,171 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1743 secs
2025-03-13 17:25:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:25:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 46910 [episode count 8/20]
[retrieval_preprocessing] for episode 86466 [episode count 9/20], we have num_retrieval=np.int64(2640) num_query=np.int64(160)
2025-03-13 17:25:09,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:25:09,903 [INFO]: Launching the whole pipeline 03/13/2025, 17:25:09
2025-03-13 17:25:09,903 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:25:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.08it/s]
2025-03-13 17:25:09,930 [INFO]: There are 2640 embeddings of dim 49152
2025-03-13 17:25:09,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 17:25:09,930 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:25:09
2025-03-13 17:25:09,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:25:09,930 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:25:09,930 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:25:09,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:25:09,930 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:25:09
2025-03-13 17:25:09,930 [INFO]: 544.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:25:09,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:25:09,930 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:25:09
2025-03-13 17:25:09,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:25:09,931 [INFO]: 	Creating the index 03/13/2025, 17:25:09
2025-03-13 17:25:09,931 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:25:09
2025-03-13 17:25:09,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:25:09,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:25:09
2025-03-13 17:25:09,932 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:25:09,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.85it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.94it/s]100%|██████████| 11/11 [00:02<00:00,  3.90it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]
2025-03-13 17:25:12,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:25:12
2025-03-13 17:25:45,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6454 secs
2025-03-13 17:25:45,979 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 17:25:45,979 [INFO]: 	Compute fast metrics 03/13/2025, 17:25:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.70it/s]
2025-03-13 17:26:06,476 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4970 secs
2025-03-13 17:26:06,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5467 secs
2025-03-13 17:26:06,479 [INFO]: {
2025-03-13 17:26:06,479 [INFO]: 	index_key: HNSW15
2025-03-13 17:26:06,479 [INFO]: 	index_param: efSearch=200
2025-03-13 17:26:06,479 [INFO]: 	index_path: knn.index
2025-03-13 17:26:06,479 [INFO]: 	size in bytes: 519403810
2025-03-13 17:26:06,479 [INFO]: 	avg_search_speed_ms: 11.67364677962007
2025-03-13 17:26:06,479 [INFO]: 	99p_search_speed_ms: 15.26683871634304
2025-03-13 17:26:06,479 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:26:06,479 [INFO]: 	nb vectors: 2640
2025-03-13 17:26:06,479 [INFO]: 	vectors dimension: 49152
2025-03-13 17:26:06,479 [INFO]: 	compression ratio: 0.9993094197749531
2025-03-13 17:26:06,479 [INFO]: }
2025-03-13 17:26:06,479 [INFO]: 	>>> Finished "Creating the index" in 56.5485 secs
2025-03-13 17:26:06,479 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5763 secs
2025-03-13 17:26:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:26:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 86466 [episode count 9/20]
[retrieval_preprocessing] for episode 72907 [episode count 10/20], we have num_retrieval=np.int64(2627) num_query=np.int64(173)
2025-03-13 17:26:08,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:26:09,121 [INFO]: Launching the whole pipeline 03/13/2025, 17:26:09
2025-03-13 17:26:09,121 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:26:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.17it/s]
2025-03-13 17:26:09,151 [INFO]: There are 2627 embeddings of dim 49152
2025-03-13 17:26:09,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 17:26:09,152 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:26:09
2025-03-13 17:26:09,152 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:26:09,152 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:26:09,152 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:26:09,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:26:09,152 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:26:09
2025-03-13 17:26:09,152 [INFO]: 542.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:26:09,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:26:09,152 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:26:09
2025-03-13 17:26:09,152 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:26:09,152 [INFO]: 	Creating the index 03/13/2025, 17:26:09
2025-03-13 17:26:09,152 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:26:09
2025-03-13 17:26:09,153 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:26:09,153 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:26:09
2025-03-13 17:26:09,154 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:26:09,154 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.56it/s] 45%|████▌     | 5/11 [00:00<00:00, 20.93it/s] 82%|████████▏ | 9/11 [00:00<00:00, 27.32it/s]100%|██████████| 11/11 [00:02<00:00,  3.93it/s]
2025-03-13 17:26:11,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:26:11
2025-03-13 17:26:56,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6857 secs
2025-03-13 17:26:56,642 [INFO]: The best hyperparameters are: efSearch=191
2025-03-13 17:26:56,642 [INFO]: 	Compute fast metrics 03/13/2025, 17:26:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-13 17:27:26,087 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4441 secs
2025-03-13 17:27:26,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.9354 secs
2025-03-13 17:27:26,089 [INFO]: {
2025-03-13 17:27:26,089 [INFO]: 	index_key: HNSW15
2025-03-13 17:27:26,089 [INFO]: 	index_param: efSearch=191
2025-03-13 17:27:26,089 [INFO]: 	index_path: knn.index
2025-03-13 17:27:26,089 [INFO]: 	size in bytes: 516846130
2025-03-13 17:27:26,089 [INFO]: 	avg_search_speed_ms: 9.274125309571264
2025-03-13 17:27:26,089 [INFO]: 	99p_search_speed_ms: 14.687277567572893
2025-03-13 17:27:26,089 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:27:26,089 [INFO]: 	nb vectors: 2627
2025-03-13 17:27:26,089 [INFO]: 	vectors dimension: 49152
2025-03-13 17:27:26,089 [INFO]: 	compression ratio: 0.9993094385750746
2025-03-13 17:27:26,089 [INFO]: }
2025-03-13 17:27:26,089 [INFO]: 	>>> Finished "Creating the index" in 76.9372 secs
2025-03-13 17:27:26,089 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9683 secs
2025-03-13 17:27:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:27:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 72907 [episode count 10/20]
[retrieval_preprocessing] for episode 53972 [episode count 11/20], we have num_retrieval=np.int64(2655) num_query=np.int64(145)
2025-03-13 17:27:27,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:27:28,016 [INFO]: Launching the whole pipeline 03/13/2025, 17:27:28
2025-03-13 17:27:28,017 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:27:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1109.02it/s]
2025-03-13 17:27:28,043 [INFO]: There are 2655 embeddings of dim 49152
2025-03-13 17:27:28,044 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 17:27:28,044 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,044 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:27:28,044 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:27:28,044 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:27:28,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:27:28,044 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,044 [INFO]: 547.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:27:28,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:27:28,044 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:27:28
2025-03-13 17:27:28,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:27:28,044 [INFO]: 	Creating the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,044 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:27:28
2025-03-13 17:27:28,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:27:28,045 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:27:28
2025-03-13 17:27:28,045 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:27:28,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.05it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.96it/s]100%|██████████| 11/11 [00:02<00:00,  3.29it/s]100%|██████████| 11/11 [00:02<00:00,  3.89it/s]
2025-03-13 17:27:30,877 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:27:30
2025-03-13 17:28:06,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3672 secs
2025-03-13 17:28:06,245 [INFO]: The best hyperparameters are: efSearch=178
2025-03-13 17:28:06,245 [INFO]: 	Compute fast metrics 03/13/2025, 17:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.28it/s]
2025-03-13 17:28:27,305 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0599 secs
2025-03-13 17:28:27,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2610 secs
2025-03-13 17:28:27,306 [INFO]: {
2025-03-13 17:28:27,306 [INFO]: 	index_key: HNSW15
2025-03-13 17:28:27,306 [INFO]: 	index_param: efSearch=178
2025-03-13 17:28:27,306 [INFO]: 	index_path: knn.index
2025-03-13 17:28:27,307 [INFO]: 	size in bytes: 522354910
2025-03-13 17:28:27,307 [INFO]: 	avg_search_speed_ms: 7.58266943708836
2025-03-13 17:28:27,307 [INFO]: 	99p_search_speed_ms: 10.295044030062854
2025-03-13 17:28:27,307 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:28:27,307 [INFO]: 	nb vectors: 2655
2025-03-13 17:28:27,307 [INFO]: 	vectors dimension: 49152
2025-03-13 17:28:27,307 [INFO]: 	compression ratio: 0.9993095307556312
2025-03-13 17:28:27,307 [INFO]: }
2025-03-13 17:28:27,307 [INFO]: 	>>> Finished "Creating the index" in 59.2624 secs
2025-03-13 17:28:27,307 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2900 secs
2025-03-13 17:28:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:28:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 53972 [episode count 11/20]
[retrieval_preprocessing] for episode 10844 [episode count 12/20], we have num_retrieval=np.int64(2653) num_query=np.int64(147)
2025-03-13 17:28:28,473 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:28:28,836 [INFO]: Launching the whole pipeline 03/13/2025, 17:28:28
2025-03-13 17:28:28,836 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:28:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2172.09it/s]
2025-03-13 17:28:28,860 [INFO]: There are 2653 embeddings of dim 49152
2025-03-13 17:28:28,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 17:28:28,860 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:28:28
2025-03-13 17:28:28,860 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:28:28,860 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:28:28,860 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:28:28,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:28:28,860 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:28:28
2025-03-13 17:28:28,860 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:28:28,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:28:28,861 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:28:28
2025-03-13 17:28:28,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:28:28,861 [INFO]: 	Creating the index 03/13/2025, 17:28:28
2025-03-13 17:28:28,861 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:28:28
2025-03-13 17:28:28,862 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:28:28,862 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:28:28
2025-03-13 17:28:28,862 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:28:28,862 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.16it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.21it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]100%|██████████| 11/11 [00:02<00:00,  5.40it/s]
2025-03-13 17:28:30,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:28:30
2025-03-13 17:29:02,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2428 secs
2025-03-13 17:29:02,147 [INFO]: The best hyperparameters are: efSearch=218
2025-03-13 17:29:02,147 [INFO]: 	Compute fast metrics 03/13/2025, 17:29:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.38it/s]
2025-03-13 17:29:27,878 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7310 secs
2025-03-13 17:29:27,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0189 secs
2025-03-13 17:29:27,881 [INFO]: {
2025-03-13 17:29:27,881 [INFO]: 	index_key: HNSW15
2025-03-13 17:29:27,881 [INFO]: 	index_param: efSearch=218
2025-03-13 17:29:27,881 [INFO]: 	index_path: knn.index
2025-03-13 17:29:27,881 [INFO]: 	size in bytes: 521961430
2025-03-13 17:29:27,881 [INFO]: 	avg_search_speed_ms: 10.556805187269825
2025-03-13 17:29:27,881 [INFO]: 	99p_search_speed_ms: 14.018082977272568
2025-03-13 17:29:27,881 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:29:27,881 [INFO]: 	nb vectors: 2653
2025-03-13 17:29:27,881 [INFO]: 	vectors dimension: 49152
2025-03-13 17:29:27,881 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-13 17:29:27,881 [INFO]: }
2025-03-13 17:29:27,881 [INFO]: 	>>> Finished "Creating the index" in 59.0206 secs
2025-03-13 17:29:27,881 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0449 secs
2025-03-13 17:29:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:29:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 10844 [episode count 12/20]
[retrieval_preprocessing] for episode 78176 [episode count 13/20], we have num_retrieval=np.int64(2626) num_query=np.int64(174)
2025-03-13 17:29:29,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:29:30,181 [INFO]: Launching the whole pipeline 03/13/2025, 17:29:30
2025-03-13 17:29:30,181 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:29:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 856.33it/s]
2025-03-13 17:29:30,207 [INFO]: There are 2626 embeddings of dim 49152
2025-03-13 17:29:30,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-13 17:29:30,207 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:29:30
2025-03-13 17:29:30,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:29:30,207 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:29:30,207 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:29:30,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:29:30,207 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:29:30
2025-03-13 17:29:30,207 [INFO]: 541.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:29:30,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:29:30,208 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:29:30
2025-03-13 17:29:30,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:29:30,208 [INFO]: 	Creating the index 03/13/2025, 17:29:30
2025-03-13 17:29:30,208 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:29:30
2025-03-13 17:29:30,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 17:29:30,209 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:29:30
2025-03-13 17:29:30,209 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:29:30,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.38it/s] 45%|████▌     | 5/11 [00:00<00:00, 25.28it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.16it/s]100%|██████████| 11/11 [00:03<00:00,  3.17it/s]
2025-03-13 17:29:33,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:29:33
2025-03-13 17:30:14,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8331 secs
2025-03-13 17:30:14,516 [INFO]: The best hyperparameters are: efSearch=154
2025-03-13 17:30:14,516 [INFO]: 	Compute fast metrics 03/13/2025, 17:30:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.10it/s]
2025-03-13 17:30:40,258 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7422 secs
2025-03-13 17:30:40,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0516 secs
2025-03-13 17:30:40,261 [INFO]: {
2025-03-13 17:30:40,261 [INFO]: 	index_key: HNSW15
2025-03-13 17:30:40,261 [INFO]: 	index_param: efSearch=154
2025-03-13 17:30:40,261 [INFO]: 	index_path: knn.index
2025-03-13 17:30:40,261 [INFO]: 	size in bytes: 516649390
2025-03-13 17:30:40,261 [INFO]: 	avg_search_speed_ms: 8.851685936859422
2025-03-13 17:30:40,261 [INFO]: 	99p_search_speed_ms: 13.83602214045823
2025-03-13 17:30:40,261 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:30:40,261 [INFO]: 	nb vectors: 2626
2025-03-13 17:30:40,261 [INFO]: 	vectors dimension: 49152
2025-03-13 17:30:40,261 [INFO]: 	compression ratio: 0.9993094311018155
2025-03-13 17:30:40,261 [INFO]: }
2025-03-13 17:30:40,261 [INFO]: 	>>> Finished "Creating the index" in 70.0532 secs
2025-03-13 17:30:40,261 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0795 secs
2025-03-13 17:30:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:30:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 78176 [episode count 13/20]
[retrieval_preprocessing] for episode 27366 [episode count 14/20], we have num_retrieval=np.int64(2636) num_query=np.int64(164)
2025-03-13 17:30:41,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:30:42,427 [INFO]: Launching the whole pipeline 03/13/2025, 17:30:42
2025-03-13 17:30:42,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:30:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-13 17:30:42,457 [INFO]: There are 2636 embeddings of dim 49152
2025-03-13 17:30:42,458 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 17:30:42,458 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:30:42
2025-03-13 17:30:42,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:30:42,458 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:30:42,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:30:42,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:30:42,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:30:42
2025-03-13 17:30:42,458 [INFO]: 544.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:30:42,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:30:42,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:30:42
2025-03-13 17:30:42,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:30:42,458 [INFO]: 	Creating the index 03/13/2025, 17:30:42
2025-03-13 17:30:42,459 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:30:42
2025-03-13 17:30:42,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 17:30:42,460 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:30:42
2025-03-13 17:30:42,460 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:30:42,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.30it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.80it/s]100%|██████████| 11/11 [00:02<00:00,  4.70it/s]100%|██████████| 11/11 [00:02<00:00,  5.49it/s]
2025-03-13 17:30:44,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:30:44
2025-03-13 17:31:25,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5491 secs
2025-03-13 17:31:25,019 [INFO]: The best hyperparameters are: efSearch=169
2025-03-13 17:31:25,019 [INFO]: 	Compute fast metrics 03/13/2025, 17:31:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 17:31:43,284 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2650 secs
2025-03-13 17:31:43,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8266 secs
2025-03-13 17:31:43,287 [INFO]: {
2025-03-13 17:31:43,287 [INFO]: 	index_key: HNSW15
2025-03-13 17:31:43,287 [INFO]: 	index_param: efSearch=169
2025-03-13 17:31:43,287 [INFO]: 	index_path: knn.index
2025-03-13 17:31:43,287 [INFO]: 	size in bytes: 518616850
2025-03-13 17:31:43,287 [INFO]: 	avg_search_speed_ms: 8.18832161535801
2025-03-13 17:31:43,287 [INFO]: 	99p_search_speed_ms: 11.414011660963297
2025-03-13 17:31:43,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:31:43,287 [INFO]: 	nb vectors: 2636
2025-03-13 17:31:43,287 [INFO]: 	vectors dimension: 49152
2025-03-13 17:31:43,287 [INFO]: 	compression ratio: 0.9993093899667934
2025-03-13 17:31:43,287 [INFO]: }
2025-03-13 17:31:43,287 [INFO]: 	>>> Finished "Creating the index" in 60.8285 secs
2025-03-13 17:31:43,287 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8598 secs
2025-03-13 17:31:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:31:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 27366 [episode count 14/20]
[retrieval_preprocessing] for episode 4839 [episode count 15/20], we have num_retrieval=np.int64(2676) num_query=np.int64(124)
2025-03-13 17:31:46,785 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:31:47,213 [INFO]: Launching the whole pipeline 03/13/2025, 17:31:47
2025-03-13 17:31:47,213 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:31:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.44it/s]
2025-03-13 17:31:47,242 [INFO]: There are 2676 embeddings of dim 49152
2025-03-13 17:31:47,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 17:31:47,243 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:31:47
2025-03-13 17:31:47,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:31:47,243 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:31:47,244 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:31:47,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:31:47,244 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:31:47
2025-03-13 17:31:47,244 [INFO]: 552.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:31:47,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:31:47,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:31:47
2025-03-13 17:31:47,245 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:31:47,245 [INFO]: 	Creating the index 03/13/2025, 17:31:47
2025-03-13 17:31:47,245 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:31:47
2025-03-13 17:31:47,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 17:31:47,247 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:31:47
2025-03-13 17:31:47,247 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:31:47,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.73it/s] 64%|██████▎   | 7/11 [00:00<00:00, 31.30it/s]100%|██████████| 11/11 [00:02<00:00,  3.52it/s]100%|██████████| 11/11 [00:02<00:00,  4.38it/s]
2025-03-13 17:31:49,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:31:49
2025-03-13 17:32:24,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7125 secs
2025-03-13 17:32:24,475 [INFO]: The best hyperparameters are: efSearch=187
2025-03-13 17:32:24,475 [INFO]: 	Compute fast metrics 03/13/2025, 17:32:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.02it/s]
2025-03-13 17:32:44,877 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4015 secs
2025-03-13 17:32:44,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6323 secs
2025-03-13 17:32:44,880 [INFO]: {
2025-03-13 17:32:44,880 [INFO]: 	index_key: HNSW15
2025-03-13 17:32:44,880 [INFO]: 	index_param: efSearch=187
2025-03-13 17:32:44,880 [INFO]: 	index_path: knn.index
2025-03-13 17:32:44,880 [INFO]: 	size in bytes: 526486450
2025-03-13 17:32:44,880 [INFO]: 	avg_search_speed_ms: 10.533369682288091
2025-03-13 17:32:44,880 [INFO]: 	99p_search_speed_ms: 14.452572474256156
2025-03-13 17:32:44,880 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:32:44,880 [INFO]: 	nb vectors: 2676
2025-03-13 17:32:44,880 [INFO]: 	vectors dimension: 49152
2025-03-13 17:32:44,880 [INFO]: 	compression ratio: 0.9993096840384021
2025-03-13 17:32:44,880 [INFO]: }
2025-03-13 17:32:44,880 [INFO]: 	>>> Finished "Creating the index" in 57.6352 secs
2025-03-13 17:32:44,880 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6675 secs
2025-03-13 17:32:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:32:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 4839 [episode count 15/20]
[retrieval_preprocessing] for episode 28647 [episode count 16/20], we have num_retrieval=np.int64(2677) num_query=np.int64(123)
2025-03-13 17:32:46,513 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:32:47,066 [INFO]: Launching the whole pipeline 03/13/2025, 17:32:47
2025-03-13 17:32:47,066 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:32:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2201.73it/s]
2025-03-13 17:32:47,092 [INFO]: There are 2677 embeddings of dim 49152
2025-03-13 17:32:47,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 17:32:47,093 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:32:47
2025-03-13 17:32:47,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:32:47,093 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:32:47,093 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:32:47,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 17:32:47,094 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:32:47
2025-03-13 17:32:47,094 [INFO]: 552.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:32:47,094 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:32:47,094 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:32:47
2025-03-13 17:32:47,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:32:47,095 [INFO]: 	Creating the index 03/13/2025, 17:32:47
2025-03-13 17:32:47,095 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:32:47
2025-03-13 17:32:47,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 17:32:47,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:32:47
2025-03-13 17:32:47,099 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:32:47,099 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.73it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.93it/s]100%|██████████| 11/11 [00:02<00:00,  3.47it/s]100%|██████████| 11/11 [00:02<00:00,  4.35it/s]
2025-03-13 17:32:49,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:32:49
2025-03-13 17:33:24,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5205 secs
2025-03-13 17:33:24,154 [INFO]: The best hyperparameters are: efSearch=153
2025-03-13 17:33:24,154 [INFO]: 	Compute fast metrics 03/13/2025, 17:33:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.84it/s]
2025-03-13 17:33:42,968 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8140 secs
2025-03-13 17:33:42,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8718 secs
2025-03-13 17:33:42,971 [INFO]: {
2025-03-13 17:33:42,971 [INFO]: 	index_key: HNSW15
2025-03-13 17:33:42,971 [INFO]: 	index_param: efSearch=153
2025-03-13 17:33:42,971 [INFO]: 	index_path: knn.index
2025-03-13 17:33:42,971 [INFO]: 	size in bytes: 526683190
2025-03-13 17:33:42,971 [INFO]: 	avg_search_speed_ms: 7.581994362200883
2025-03-13 17:33:42,971 [INFO]: 	99p_search_speed_ms: 10.09095262736082
2025-03-13 17:33:42,971 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:33:42,971 [INFO]: 	nb vectors: 2677
2025-03-13 17:33:42,971 [INFO]: 	vectors dimension: 49152
2025-03-13 17:33:42,971 [INFO]: 	compression ratio: 0.9993096912775971
2025-03-13 17:33:42,971 [INFO]: }
2025-03-13 17:33:42,971 [INFO]: 	>>> Finished "Creating the index" in 55.8759 secs
2025-03-13 17:33:42,971 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9044 secs
2025-03-13 17:33:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:33:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 28647 [episode count 16/20]
[retrieval_preprocessing] for episode 47593 [episode count 17/20], we have num_retrieval=np.int64(2686) num_query=np.int64(114)
2025-03-13 17:33:44,069 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:33:44,493 [INFO]: Launching the whole pipeline 03/13/2025, 17:33:44
2025-03-13 17:33:44,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:33:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-13 17:33:44,520 [INFO]: There are 2686 embeddings of dim 49152
2025-03-13 17:33:44,520 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 17:33:44,521 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,521 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:33:44,521 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:33:44,521 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:33:44,521 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:33:44,521 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,521 [INFO]: 554.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:33:44,521 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 17:33:44,521 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:33:44
2025-03-13 17:33:44,521 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:33:44,521 [INFO]: 	Creating the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,521 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:33:44
2025-03-13 17:33:44,522 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 17:33:44,522 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:33:44
2025-03-13 17:33:44,522 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:33:44,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.54it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.46it/s]100%|██████████| 11/11 [00:02<00:00,  4.14it/s]100%|██████████| 11/11 [00:02<00:00,  4.87it/s]
2025-03-13 17:33:46,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:33:46
2025-03-13 17:34:20,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4698 secs
2025-03-13 17:34:20,254 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 17:34:20,254 [INFO]: 	Compute fast metrics 03/13/2025, 17:34:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.83it/s]
2025-03-13 17:34:41,704 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4491 secs
2025-03-13 17:34:41,707 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1848 secs
2025-03-13 17:34:41,707 [INFO]: {
2025-03-13 17:34:41,707 [INFO]: 	index_key: HNSW15
2025-03-13 17:34:41,707 [INFO]: 	index_param: efSearch=206
2025-03-13 17:34:41,707 [INFO]: 	index_path: knn.index
2025-03-13 17:34:41,707 [INFO]: 	size in bytes: 528453850
2025-03-13 17:34:41,707 [INFO]: 	avg_search_speed_ms: 13.308936355083171
2025-03-13 17:34:41,707 [INFO]: 	99p_search_speed_ms: 20.403697132132947
2025-03-13 17:34:41,707 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:34:41,707 [INFO]: 	nb vectors: 2686
2025-03-13 17:34:41,707 [INFO]: 	vectors dimension: 49152
2025-03-13 17:34:41,707 [INFO]: 	compression ratio: 0.9993097561877919
2025-03-13 17:34:41,707 [INFO]: }
2025-03-13 17:34:41,707 [INFO]: 	>>> Finished "Creating the index" in 57.1864 secs
2025-03-13 17:34:41,707 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2147 secs
2025-03-13 17:34:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:34:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 47593 [episode count 17/20]
[retrieval_preprocessing] for episode 1265 [episode count 18/20], we have num_retrieval=np.int64(2685) num_query=np.int64(115)
2025-03-13 17:34:43,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:34:45,016 [INFO]: Launching the whole pipeline 03/13/2025, 17:34:45
2025-03-13 17:34:45,016 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:34:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.12it/s]
2025-03-13 17:34:45,045 [INFO]: There are 2685 embeddings of dim 49152
2025-03-13 17:34:45,046 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 17:34:45,046 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:34:45
2025-03-13 17:34:45,046 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:34:45,046 [INFO]: 		-> Add: 1.5 seconds
2025-03-13 17:34:45,046 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:34:45,046 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:34:45,046 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:34:45
2025-03-13 17:34:45,046 [INFO]: 554.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:34:45,046 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:34:45,046 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:34:45
2025-03-13 17:34:45,046 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:34:45,046 [INFO]: 	Creating the index 03/13/2025, 17:34:45
2025-03-13 17:34:45,046 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:34:45
2025-03-13 17:34:45,047 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 17:34:45,047 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:34:45
2025-03-13 17:34:45,048 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:34:45,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.68it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.00it/s] 64%|██████▎   | 7/11 [00:00<00:00, 17.41it/s]100%|██████████| 11/11 [00:03<00:00,  2.70it/s]100%|██████████| 11/11 [00:03<00:00,  3.38it/s]
2025-03-13 17:34:48,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:34:48
2025-03-13 17:35:29,293 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9836 secs
2025-03-13 17:35:29,293 [INFO]: The best hyperparameters are: efSearch=181
2025-03-13 17:35:29,293 [INFO]: 	Compute fast metrics 03/13/2025, 17:35:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 17:35:53,486 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1929 secs
2025-03-13 17:35:53,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7713 secs
2025-03-13 17:35:53,819 [INFO]: {
2025-03-13 17:35:53,819 [INFO]: 	index_key: HNSW15
2025-03-13 17:35:53,819 [INFO]: 	index_param: efSearch=181
2025-03-13 17:35:53,819 [INFO]: 	index_path: knn.index
2025-03-13 17:35:53,819 [INFO]: 	size in bytes: 528257110
2025-03-13 17:35:53,820 [INFO]: 	avg_search_speed_ms: 9.790440254646786
2025-03-13 17:35:53,820 [INFO]: 	99p_search_speed_ms: 23.85395620949563
2025-03-13 17:35:53,820 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:35:53,820 [INFO]: 	nb vectors: 2685
2025-03-13 17:35:53,820 [INFO]: 	vectors dimension: 49152
2025-03-13 17:35:53,820 [INFO]: 	compression ratio: 0.9993097489970367
2025-03-13 17:35:53,820 [INFO]: }
2025-03-13 17:35:53,820 [INFO]: 	>>> Finished "Creating the index" in 68.7737 secs
2025-03-13 17:35:53,820 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8043 secs
2025-03-13 17:35:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:35:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 1265 [episode count 18/20]
[retrieval_preprocessing] for episode 29299 [episode count 19/20], we have num_retrieval=np.int64(2639) num_query=np.int64(161)
2025-03-13 17:35:55,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:35:55,909 [INFO]: Launching the whole pipeline 03/13/2025, 17:35:55
2025-03-13 17:35:55,909 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:35:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2185.67it/s]
2025-03-13 17:35:55,937 [INFO]: There are 2639 embeddings of dim 49152
2025-03-13 17:35:55,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 17:35:55,938 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:35:55
2025-03-13 17:35:55,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:35:55,938 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 17:35:55,938 [INFO]: 		Total: 16.7 minutes
2025-03-13 17:35:55,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 17:35:55,938 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:35:55
2025-03-13 17:35:55,939 [INFO]: 544.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:35:55,939 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 17:35:55,939 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:35:55
2025-03-13 17:35:55,939 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:35:55,940 [INFO]: 	Creating the index 03/13/2025, 17:35:55
2025-03-13 17:35:55,940 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 17:35:55
2025-03-13 17:35:55,943 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 17:35:55,944 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:35:55
2025-03-13 17:35:55,944 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 17:35:55,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.28it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.42it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.30it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.66it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.83it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.38it/s]100%|██████████| 11/11 [00:03<00:00,  1.31it/s]100%|██████████| 11/11 [00:03<00:00,  2.94it/s]
2025-03-13 17:35:59,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:35:59
2025-03-13 17:36:31,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2926 secs
2025-03-13 17:36:31,990 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 17:36:31,990 [INFO]: 	Compute fast metrics 03/13/2025, 17:36:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 17:36:52,801 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8111 secs
2025-03-13 17:36:52,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8603 secs
2025-03-13 17:36:52,805 [INFO]: {
2025-03-13 17:36:52,805 [INFO]: 	index_key: HNSW15
2025-03-13 17:36:52,805 [INFO]: 	index_param: efSearch=207
2025-03-13 17:36:52,805 [INFO]: 	index_path: knn.index
2025-03-13 17:36:52,805 [INFO]: 	size in bytes: 519207070
2025-03-13 17:36:52,805 [INFO]: 	avg_search_speed_ms: 12.480989267140366
2025-03-13 17:36:52,805 [INFO]: 	99p_search_speed_ms: 27.837050147354603
2025-03-13 17:36:52,805 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:36:52,805 [INFO]: 	nb vectors: 2639
2025-03-13 17:36:52,805 [INFO]: 	vectors dimension: 49152
2025-03-13 17:36:52,805 [INFO]: 	compression ratio: 0.9993094123313845
2025-03-13 17:36:52,805 [INFO]: }
2025-03-13 17:36:52,805 [INFO]: 	>>> Finished "Creating the index" in 56.8654 secs
2025-03-13 17:36:52,805 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8965 secs
2025-03-13 17:36:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:36:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 29299 [episode count 19/20]
2025-03-13 17:36:54: [retrieval_preprocessing] finished for 3246924425_yellow_object_in_bowl [chosen_id count 6/196]
2025-03-13 17:37:07: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3423129689_fold_towel [chosen_id count 7/196]
2025-03-13 17:37:07: [retrieval_preprocessing] we have num_total=15540 embedding_dim=49152
[retrieval_preprocessing] for episode 81041 [episode count 0/20], we have num_retrieval=np.int64(14632) num_query=np.int64(908)
2025-03-13 17:37:13,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:37:15,515 [INFO]: Launching the whole pipeline 03/13/2025, 17:37:15
2025-03-13 17:37:15,515 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:37:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 945.94it/s]
2025-03-13 17:37:15,542 [INFO]: There are 14632 embeddings of dim 49152
2025-03-13 17:37:15,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-13 17:37:15,543 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:37:15,543 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 17:37:15,543 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:37:15,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:37:15,543 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,543 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:37:15,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:37:15,543 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:37:15
2025-03-13 17:37:15,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:37:15,543 [INFO]: 	Creating the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,543 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:37:15
2025-03-13 17:37:15,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:37:15,544 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:37:15
2025-03-13 17:37:15,545 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:37:15,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:09,  5.93it/s]  8%|▊         | 5/60 [00:00<00:02, 19.54it/s] 15%|█▌        | 9/60 [00:00<00:02, 24.52it/s] 22%|██▏       | 13/60 [00:00<00:01, 27.11it/s] 28%|██▊       | 17/60 [00:00<00:01, 29.26it/s] 35%|███▌      | 21/60 [00:08<00:27,  1.42it/s] 42%|████▏     | 25/60 [00:08<00:16,  2.10it/s] 48%|████▊     | 29/60 [00:08<00:10,  3.03it/s] 55%|█████▌    | 33/60 [00:08<00:06,  4.27it/s] 62%|██████▏   | 37/60 [00:08<00:03,  5.91it/s] 68%|██████▊   | 41/60 [00:08<00:02,  7.98it/s] 75%|███████▌  | 45/60 [00:17<00:11,  1.29it/s] 80%|████████  | 48/60 [00:17<00:07,  1.69it/s] 87%|████████▋ | 52/60 [00:18<00:03,  2.41it/s] 92%|█████████▏| 55/60 [00:18<00:01,  3.15it/s] 97%|█████████▋| 58/60 [00:18<00:00,  4.09it/s]100%|██████████| 60/60 [00:26<00:00,  2.25it/s]
2025-03-13 17:37:42,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:37:42
2025-03-13 17:39:30,278 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 108.0084 secs
2025-03-13 17:39:30,278 [INFO]: The best hyperparameters are: efSearch=103
2025-03-13 17:39:30,279 [INFO]: 	Compute fast metrics 03/13/2025, 17:39:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-13 17:40:51,167 [INFO]: 	>>> Finished "Compute fast metrics" in 80.8886 secs
2025-03-13 17:40:51,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 215.6258 secs
2025-03-13 17:40:51,171 [INFO]: {
2025-03-13 17:40:51,171 [INFO]: 	index_key: HNSW32
2025-03-13 17:40:51,171 [INFO]: 	index_param: efSearch=103
2025-03-13 17:40:51,171 [INFO]: 	index_path: knn.index
2025-03-13 17:40:51,171 [INFO]: 	size in bytes: 2880750402
2025-03-13 17:40:51,171 [INFO]: 	avg_search_speed_ms: 14.058798026709471
2025-03-13 17:40:51,171 [INFO]: 	99p_search_speed_ms: 27.23951785592362
2025-03-13 17:40:51,171 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:40:51,171 [INFO]: 	nb vectors: 14632
2025-03-13 17:40:51,171 [INFO]: 	vectors dimension: 49152
2025-03-13 17:40:51,171 [INFO]: 	compression ratio: 0.9986176705912336
2025-03-13 17:40:51,171 [INFO]: }
2025-03-13 17:40:51,171 [INFO]: 	>>> Finished "Creating the index" in 215.6276 secs
2025-03-13 17:40:51,171 [INFO]: >>> Finished "Launching the whole pipeline" in 215.6558 secs
2025-03-13 17:40:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:40:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 81041 [episode count 0/20]
[retrieval_preprocessing] for episode 16931 [episode count 1/20], we have num_retrieval=np.int64(14601) num_query=np.int64(939)
2025-03-13 17:41:00,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:41:03,083 [INFO]: Launching the whole pipeline 03/13/2025, 17:41:03
2025-03-13 17:41:03,084 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:41:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.63it/s]
2025-03-13 17:41:03,110 [INFO]: There are 14601 embeddings of dim 49152
2025-03-13 17:41:03,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-13 17:41:03,110 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:41:03
2025-03-13 17:41:03,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:41:03,110 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 17:41:03,110 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:41:03,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:41:03,110 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:41:03
2025-03-13 17:41:03,110 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:41:03,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:41:03,110 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:41:03
2025-03-13 17:41:03,111 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:41:03,111 [INFO]: 	Creating the index 03/13/2025, 17:41:03
2025-03-13 17:41:03,111 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:41:03
2025-03-13 17:41:03,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-13 17:41:03,112 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:41:03
2025-03-13 17:41:03,112 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:41:03,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:09,  6.01it/s]  8%|▊         | 5/60 [00:00<00:02, 19.41it/s] 17%|█▋        | 10/60 [00:00<00:01, 28.30it/s] 25%|██▌       | 15/60 [00:00<00:01, 33.87it/s] 32%|███▏      | 19/60 [00:00<00:01, 35.61it/s] 38%|███▊      | 23/60 [00:08<00:23,  1.58it/s] 47%|████▋     | 28/60 [00:08<00:13,  2.46it/s] 53%|█████▎    | 32/60 [00:08<00:08,  3.41it/s] 62%|██████▏   | 37/60 [00:08<00:04,  5.00it/s] 70%|███████   | 42/60 [00:17<00:13,  1.32it/s] 75%|███████▌  | 45/60 [00:18<00:09,  1.63it/s] 80%|████████  | 48/60 [00:18<00:05,  2.05it/s] 83%|████████▎ | 50/60 [00:18<00:04,  2.41it/s] 87%|████████▋ | 52/60 [00:18<00:02,  2.88it/s] 90%|█████████ | 54/60 [00:18<00:01,  3.47it/s] 93%|█████████▎| 56/60 [00:19<00:00,  4.18it/s] 97%|█████████▋| 58/60 [00:19<00:00,  5.00it/s]100%|██████████| 60/60 [00:29<00:00,  1.56s/it]100%|██████████| 60/60 [00:29<00:00,  2.02it/s]
2025-03-13 17:41:32,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:41:32
2025-03-13 17:43:11,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.0226 secs
2025-03-13 17:43:11,879 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 17:43:11,879 [INFO]: 	Compute fast metrics 03/13/2025, 17:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.27it/s]
2025-03-13 17:44:40,464 [INFO]: 	>>> Finished "Compute fast metrics" in 88.5845 secs
2025-03-13 17:44:40,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 217.3647 secs
2025-03-13 17:44:40,477 [INFO]: {
2025-03-13 17:44:40,477 [INFO]: 	index_key: HNSW32
2025-03-13 17:44:40,477 [INFO]: 	index_param: efSearch=95
2025-03-13 17:44:40,477 [INFO]: 	index_path: knn.index
2025-03-13 17:44:40,477 [INFO]: 	size in bytes: 2874647118
2025-03-13 17:44:40,477 [INFO]: 	avg_search_speed_ms: 10.068981957735357
2025-03-13 17:44:40,477 [INFO]: 	99p_search_speed_ms: 17.98238757066429
2025-03-13 17:44:40,477 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:44:40,477 [INFO]: 	nb vectors: 14601
2025-03-13 17:44:40,477 [INFO]: 	vectors dimension: 49152
2025-03-13 17:44:40,477 [INFO]: 	compression ratio: 0.9986176703306927
2025-03-13 17:44:40,477 [INFO]: }
2025-03-13 17:44:40,477 [INFO]: 	>>> Finished "Creating the index" in 217.3666 secs
2025-03-13 17:44:40,477 [INFO]: >>> Finished "Launching the whole pipeline" in 217.3936 secs
2025-03-13 17:44:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:44:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 16931 [episode count 1/20]
[retrieval_preprocessing] for episode 71472 [episode count 2/20], we have num_retrieval=np.int64(14624) num_query=np.int64(916)
2025-03-13 17:44:54,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:44:56,956 [INFO]: Launching the whole pipeline 03/13/2025, 17:44:56
2025-03-13 17:44:56,956 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:44:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.27it/s]
2025-03-13 17:44:56,984 [INFO]: There are 14624 embeddings of dim 49152
2025-03-13 17:44:56,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 17:44:56,985 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:44:56
2025-03-13 17:44:56,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:44:56,985 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 17:44:56,985 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:44:56,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:44:56,985 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:44:56
2025-03-13 17:44:56,986 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:44:56,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 17:44:56,986 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:44:56
2025-03-13 17:44:56,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:44:56,987 [INFO]: 	Creating the index 03/13/2025, 17:44:56
2025-03-13 17:44:56,987 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:44:56
2025-03-13 17:44:56,990 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-13 17:44:56,990 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:44:56
2025-03-13 17:44:56,990 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:44:56,990 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:17,  3.29it/s]  3%|▎         | 2/60 [00:00<00:12,  4.61it/s]  5%|▌         | 3/60 [00:00<00:10,  5.66it/s]  7%|▋         | 4/60 [00:00<00:08,  6.30it/s]  8%|▊         | 5/60 [00:00<00:08,  6.66it/s] 10%|█         | 6/60 [00:00<00:07,  6.93it/s] 12%|█▏        | 7/60 [00:01<00:07,  7.29it/s] 13%|█▎        | 8/60 [00:01<00:06,  7.48it/s] 15%|█▌        | 9/60 [00:01<00:06,  7.48it/s] 17%|█▋        | 10/60 [00:01<00:06,  7.46it/s] 18%|█▊        | 11/60 [00:01<00:06,  7.56it/s] 20%|██        | 12/60 [00:01<00:06,  7.60it/s] 22%|██▏       | 13/60 [00:01<00:06,  7.69it/s] 23%|██▎       | 14/60 [00:02<00:05,  7.69it/s] 25%|██▌       | 15/60 [00:02<00:05,  7.70it/s] 27%|██▋       | 16/60 [00:02<00:05,  7.71it/s] 28%|██▊       | 17/60 [00:02<00:05,  7.81it/s] 30%|███       | 18/60 [00:02<00:05,  7.96it/s] 32%|███▏      | 19/60 [00:02<00:05,  8.01it/s] 33%|███▎      | 20/60 [00:02<00:04,  8.14it/s] 35%|███▌      | 21/60 [00:11<01:43,  2.65s/it] 37%|███▋      | 22/60 [00:11<01:11,  1.89s/it] 38%|███▊      | 23/60 [00:11<00:50,  1.36s/it] 40%|████      | 24/60 [00:11<00:35,  1.02it/s] 42%|████▏     | 25/60 [00:11<00:25,  1.39it/s] 43%|████▎     | 26/60 [00:11<00:18,  1.87it/s] 47%|████▋     | 28/60 [00:12<00:10,  3.02it/s] 50%|█████     | 30/60 [00:12<00:07,  4.28it/s] 53%|█████▎    | 32/60 [00:12<00:05,  5.52it/s] 57%|█████▋    | 34/60 [00:12<00:03,  6.68it/s] 60%|██████    | 36/60 [00:12<00:03,  7.74it/s] 63%|██████▎   | 38/60 [00:12<00:02,  8.68it/s] 67%|██████▋   | 40/60 [00:13<00:02,  9.51it/s] 70%|███████   | 42/60 [00:21<00:24,  1.36s/it] 73%|███████▎  | 44/60 [00:21<00:15,  1.03it/s] 77%|███████▋  | 46/60 [00:21<00:09,  1.43it/s] 80%|████████  | 48/60 [00:21<00:06,  1.96it/s] 83%|████████▎ | 50/60 [00:22<00:03,  2.63it/s] 87%|████████▋ | 52/60 [00:22<00:02,  3.38it/s] 90%|█████████ | 54/60 [00:22<00:01,  4.28it/s] 93%|█████████▎| 56/60 [00:22<00:00,  5.35it/s] 97%|█████████▋| 58/60 [00:22<00:00,  6.51it/s]100%|██████████| 60/60 [00:32<00:00,  1.59s/it]100%|██████████| 60/60 [00:32<00:00,  1.84it/s]
2025-03-13 17:45:29,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:45:29
2025-03-13 17:47:08,800 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.2045 secs
2025-03-13 17:47:08,800 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 17:47:08,800 [INFO]: 	Compute fast metrics 03/13/2025, 17:47:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.84it/s]
2025-03-13 17:48:31,391 [INFO]: 	>>> Finished "Compute fast metrics" in 82.5904 secs
2025-03-13 17:48:31,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 214.4041 secs
2025-03-13 17:48:31,395 [INFO]: {
2025-03-13 17:48:31,395 [INFO]: 	index_key: HNSW32
2025-03-13 17:48:31,395 [INFO]: 	index_param: efSearch=92
2025-03-13 17:48:31,395 [INFO]: 	index_path: knn.index
2025-03-13 17:48:31,395 [INFO]: 	size in bytes: 2879175394
2025-03-13 17:48:31,395 [INFO]: 	avg_search_speed_ms: 11.732784155013798
2025-03-13 17:48:31,395 [INFO]: 	99p_search_speed_ms: 21.30705679766834
2025-03-13 17:48:31,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:48:31,395 [INFO]: 	nb vectors: 14624
2025-03-13 17:48:31,395 [INFO]: 	vectors dimension: 49152
2025-03-13 17:48:31,395 [INFO]: 	compression ratio: 0.9986176590671433
2025-03-13 17:48:31,395 [INFO]: }
2025-03-13 17:48:31,395 [INFO]: 	>>> Finished "Creating the index" in 214.4077 secs
2025-03-13 17:48:31,395 [INFO]: >>> Finished "Launching the whole pipeline" in 214.4384 secs
2025-03-13 17:48:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:48:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 71472 [episode count 2/20]
[retrieval_preprocessing] for episode 62898 [episode count 3/20], we have num_retrieval=np.int64(15158) num_query=np.int64(382)
2025-03-13 17:48:44,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:48:46,520 [INFO]: Launching the whole pipeline 03/13/2025, 17:48:46
2025-03-13 17:48:46,520 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:48:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.64it/s]
2025-03-13 17:48:46,565 [INFO]: There are 15158 embeddings of dim 49152
2025-03-13 17:48:46,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0450 secs
2025-03-13 17:48:46,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:48:46
2025-03-13 17:48:46,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:48:46,566 [INFO]: 		-> Add: 8.3 seconds
2025-03-13 17:48:46,566 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:48:46,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 17:48:46,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:48:46
2025-03-13 17:48:46,567 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:48:46,567 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 17:48:46,567 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:48:46
2025-03-13 17:48:46,567 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 17:48:46,567 [INFO]: 	Creating the index 03/13/2025, 17:48:46
2025-03-13 17:48:46,568 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:48:46
2025-03-13 17:48:46,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0025 secs
2025-03-13 17:48:46,570 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:48:46
2025-03-13 17:48:46,571 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 17:48:46,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:09,  6.52it/s] 10%|▉         | 6/62 [00:00<00:02, 25.32it/s] 18%|█▊        | 11/62 [00:00<00:01, 33.66it/s] 26%|██▌       | 16/62 [00:00<00:01, 38.39it/s] 34%|███▍      | 21/62 [00:07<00:22,  1.79it/s] 42%|████▏     | 26/62 [00:07<00:13,  2.72it/s] 50%|█████     | 31/62 [00:07<00:07,  3.98it/s] 58%|█████▊    | 36/62 [00:07<00:04,  5.64it/s] 66%|██████▌   | 41/62 [00:07<00:02,  7.79it/s] 73%|███████▎  | 45/62 [00:17<00:11,  1.42it/s] 77%|███████▋  | 48/62 [00:17<00:08,  1.73it/s] 82%|████████▏ | 51/62 [00:17<00:05,  2.13it/s] 85%|████████▌ | 53/62 [00:18<00:03,  2.46it/s] 89%|████████▊ | 55/62 [00:18<00:02,  2.87it/s] 92%|█████████▏| 57/62 [00:18<00:01,  3.35it/s] 95%|█████████▌| 59/62 [00:18<00:00,  3.96it/s] 98%|█████████▊| 61/62 [00:19<00:00,  4.60it/s]100%|██████████| 62/62 [00:30<00:00,  1.99s/it]100%|██████████| 62/62 [00:30<00:00,  2.02it/s]
2025-03-13 17:49:17,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:49:17
2025-03-13 17:50:54,972 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.7759 secs
2025-03-13 17:50:54,972 [INFO]: The best hyperparameters are: efSearch=70
2025-03-13 17:50:54,972 [INFO]: 	Compute fast metrics 03/13/2025, 17:50:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-13 17:51:56,934 [INFO]: 	>>> Finished "Compute fast metrics" in 61.9616 secs
2025-03-13 17:51:56,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 190.3673 secs
2025-03-13 17:51:56,938 [INFO]: {
2025-03-13 17:51:56,938 [INFO]: 	index_key: HNSW32
2025-03-13 17:51:56,938 [INFO]: 	index_param: efSearch=70
2025-03-13 17:51:56,938 [INFO]: 	index_path: knn.index
2025-03-13 17:51:56,938 [INFO]: 	size in bytes: 2984309610
2025-03-13 17:51:56,938 [INFO]: 	avg_search_speed_ms: 8.941880251689614
2025-03-13 17:51:56,938 [INFO]: 	99p_search_speed_ms: 15.93504759483038
2025-03-13 17:51:56,938 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:51:56,938 [INFO]: 	nb vectors: 15158
2025-03-13 17:51:56,938 [INFO]: 	vectors dimension: 49152
2025-03-13 17:51:56,938 [INFO]: 	compression ratio: 0.9986175878045039
2025-03-13 17:51:56,938 [INFO]: }
2025-03-13 17:51:56,938 [INFO]: 	>>> Finished "Creating the index" in 190.3706 secs
2025-03-13 17:51:56,938 [INFO]: >>> Finished "Launching the whole pipeline" in 190.4179 secs
2025-03-13 17:51:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:52:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 62898 [episode count 3/20]
[retrieval_preprocessing] for episode 33460 [episode count 4/20], we have num_retrieval=np.int64(14498) num_query=np.int64(1042)
2025-03-13 17:52:06,110 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:52:08,441 [INFO]: Launching the whole pipeline 03/13/2025, 17:52:08
2025-03-13 17:52:08,441 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:52:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1084.64it/s]
2025-03-13 17:52:08,468 [INFO]: There are 14498 embeddings of dim 49152
2025-03-13 17:52:08,468 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 17:52:08,468 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:52:08
2025-03-13 17:52:08,468 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:52:08,468 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 17:52:08,468 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:52:08,468 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:52:08,468 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:52:08
2025-03-13 17:52:08,468 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:52:08,469 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:52:08,469 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:52:08
2025-03-13 17:52:08,469 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:52:08,469 [INFO]: 	Creating the index 03/13/2025, 17:52:08
2025-03-13 17:52:08,469 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:52:08
2025-03-13 17:52:08,470 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:52:08,470 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:52:08
2025-03-13 17:52:08,470 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:52:08,470 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:10,  5.73it/s]  8%|▊         | 5/60 [00:00<00:02, 19.73it/s] 15%|█▌        | 9/60 [00:00<00:01, 25.59it/s] 22%|██▏       | 13/60 [00:00<00:01, 28.73it/s] 28%|██▊       | 17/60 [00:00<00:01, 30.34it/s] 35%|███▌      | 21/60 [00:08<00:27,  1.39it/s] 42%|████▏     | 25/60 [00:08<00:17,  2.06it/s] 48%|████▊     | 29/60 [00:08<00:10,  2.97it/s] 55%|█████▌    | 33/60 [00:08<00:06,  4.19it/s] 62%|██████▏   | 37/60 [00:08<00:03,  5.78it/s] 68%|██████▊   | 41/60 [00:09<00:02,  7.80it/s] 75%|███████▌  | 45/60 [00:19<00:13,  1.09it/s] 78%|███████▊  | 47/60 [00:20<00:10,  1.30it/s] 83%|████████▎ | 50/60 [00:20<00:05,  1.72it/s] 88%|████████▊ | 53/60 [00:20<00:03,  2.27it/s] 92%|█████████▏| 55/60 [00:20<00:01,  2.74it/s] 95%|█████████▌| 57/60 [00:20<00:00,  3.33it/s] 98%|█████████▊| 59/60 [00:21<00:00,  4.04it/s]100%|██████████| 60/60 [00:30<00:00,  1.96it/s]
2025-03-13 17:52:39,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:52:39
2025-03-13 17:54:16,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.7224 secs
2025-03-13 17:54:16,818 [INFO]: The best hyperparameters are: efSearch=78
2025-03-13 17:54:16,818 [INFO]: 	Compute fast metrics 03/13/2025, 17:54:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s]
2025-03-13 17:55:30,612 [INFO]: 	>>> Finished "Compute fast metrics" in 73.7939 secs
2025-03-13 17:55:30,615 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 202.1455 secs
2025-03-13 17:55:30,615 [INFO]: {
2025-03-13 17:55:30,615 [INFO]: 	index_key: HNSW32
2025-03-13 17:55:30,615 [INFO]: 	index_param: efSearch=78
2025-03-13 17:55:30,615 [INFO]: 	index_path: knn.index
2025-03-13 17:55:30,615 [INFO]: 	size in bytes: 2854368506
2025-03-13 17:55:30,616 [INFO]: 	avg_search_speed_ms: 9.283963465041023
2025-03-13 17:55:30,616 [INFO]: 	99p_search_speed_ms: 16.95726447738707
2025-03-13 17:55:30,616 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:55:30,616 [INFO]: 	nb vectors: 14498
2025-03-13 17:55:30,616 [INFO]: 	vectors dimension: 49152
2025-03-13 17:55:30,616 [INFO]: 	compression ratio: 0.9986176550113604
2025-03-13 17:55:30,616 [INFO]: }
2025-03-13 17:55:30,616 [INFO]: 	>>> Finished "Creating the index" in 202.1469 secs
2025-03-13 17:55:30,616 [INFO]: >>> Finished "Launching the whole pipeline" in 202.1745 secs
2025-03-13 17:55:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:55:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 33460 [episode count 4/20]
[retrieval_preprocessing] for episode 60341 [episode count 5/20], we have num_retrieval=np.int64(14913) num_query=np.int64(627)
2025-03-13 17:55:44,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:55:47,216 [INFO]: Launching the whole pipeline 03/13/2025, 17:55:47
2025-03-13 17:55:47,216 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:55:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.22it/s]
2025-03-13 17:55:47,244 [INFO]: There are 14913 embeddings of dim 49152
2025-03-13 17:55:47,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 17:55:47,245 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:55:47
2025-03-13 17:55:47,245 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:55:47,245 [INFO]: 		-> Add: 8.2 seconds
2025-03-13 17:55:47,245 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:55:47,245 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 17:55:47,245 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:55:47
2025-03-13 17:55:47,245 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:55:47,245 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 17:55:47,245 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:55:47
2025-03-13 17:55:47,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:55:47,246 [INFO]: 	Creating the index 03/13/2025, 17:55:47
2025-03-13 17:55:47,246 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:55:47
2025-03-13 17:55:47,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0013 secs
2025-03-13 17:55:47,247 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:55:47
2025-03-13 17:55:47,247 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:55:47,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:00<00:14,  4.16it/s]  5%|▍         | 3/61 [00:00<00:07,  7.70it/s]  8%|▊         | 5/61 [00:00<00:06,  8.94it/s] 11%|█▏        | 7/61 [00:00<00:05,  9.60it/s] 13%|█▎        | 8/61 [00:00<00:05,  9.47it/s] 16%|█▋        | 10/61 [00:01<00:05,  9.82it/s] 20%|█▉        | 12/61 [00:01<00:04, 10.05it/s] 23%|██▎       | 14/61 [00:01<00:04, 10.51it/s] 26%|██▌       | 16/61 [00:01<00:04, 10.71it/s] 30%|██▉       | 18/61 [00:01<00:03, 11.05it/s] 33%|███▎      | 20/61 [00:01<00:03, 11.18it/s] 36%|███▌      | 22/61 [00:07<00:34,  1.13it/s] 39%|███▉      | 24/61 [00:07<00:23,  1.56it/s] 43%|████▎     | 26/61 [00:07<00:16,  2.13it/s] 46%|████▌     | 28/61 [00:07<00:11,  2.83it/s] 49%|████▉     | 30/61 [00:08<00:08,  3.66it/s] 52%|█████▏    | 32/61 [00:08<00:06,  4.64it/s] 56%|█████▌    | 34/61 [00:08<00:04,  5.60it/s] 59%|█████▉    | 36/61 [00:08<00:03,  6.57it/s] 62%|██████▏   | 38/61 [00:08<00:03,  7.62it/s] 66%|██████▌   | 40/61 [00:08<00:02,  8.51it/s] 69%|██████▉   | 42/61 [00:17<00:25,  1.34s/it] 70%|███████   | 43/61 [00:17<00:20,  1.12s/it] 74%|███████▍  | 45/61 [00:17<00:12,  1.29it/s] 77%|███████▋  | 47/61 [00:17<00:07,  1.81it/s] 80%|████████  | 49/61 [00:17<00:04,  2.47it/s] 84%|████████▎ | 51/61 [00:18<00:03,  3.29it/s] 87%|████████▋ | 53/61 [00:18<00:01,  4.23it/s] 90%|█████████ | 55/61 [00:18<00:01,  5.29it/s] 93%|█████████▎| 57/61 [00:18<00:00,  6.38it/s] 97%|█████████▋| 59/61 [00:18<00:00,  7.62it/s]100%|██████████| 61/61 [00:28<00:00,  1.51s/it]100%|██████████| 61/61 [00:28<00:00,  2.17it/s]
2025-03-13 17:56:15,332 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:56:15
2025-03-13 17:58:00,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 105.2198 secs
2025-03-13 17:58:00,552 [INFO]: The best hyperparameters are: efSearch=73
2025-03-13 17:58:00,552 [INFO]: 	Compute fast metrics 03/13/2025, 17:58:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-13 17:59:06,952 [INFO]: 	>>> Finished "Compute fast metrics" in 66.4001 secs
2025-03-13 17:59:06,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 199.7087 secs
2025-03-13 17:59:06,956 [INFO]: {
2025-03-13 17:59:06,956 [INFO]: 	index_key: HNSW32
2025-03-13 17:59:06,956 [INFO]: 	index_param: efSearch=73
2025-03-13 17:59:06,956 [INFO]: 	index_path: knn.index
2025-03-13 17:59:06,956 [INFO]: 	size in bytes: 2936073710
2025-03-13 17:59:06,956 [INFO]: 	avg_search_speed_ms: 9.765079728140336
2025-03-13 17:59:06,956 [INFO]: 	99p_search_speed_ms: 17.090424788184464
2025-03-13 17:59:06,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 17:59:06,956 [INFO]: 	nb vectors: 14913
2025-03-13 17:59:06,956 [INFO]: 	vectors dimension: 49152
2025-03-13 17:59:06,956 [INFO]: 	compression ratio: 0.9986176757122355
2025-03-13 17:59:06,956 [INFO]: }
2025-03-13 17:59:06,956 [INFO]: 	>>> Finished "Creating the index" in 199.7106 secs
2025-03-13 17:59:06,956 [INFO]: >>> Finished "Launching the whole pipeline" in 199.7402 secs
2025-03-13 17:59:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 17:59:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 60341 [episode count 5/20]
[retrieval_preprocessing] for episode 76861 [episode count 6/20], we have num_retrieval=np.int64(14637) num_query=np.int64(903)
2025-03-13 17:59:18,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 17:59:20,367 [INFO]: Launching the whole pipeline 03/13/2025, 17:59:20
2025-03-13 17:59:20,367 [INFO]: Reading total number of vectors and dimension 03/13/2025, 17:59:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.96it/s]
2025-03-13 17:59:20,392 [INFO]: There are 14637 embeddings of dim 49152
2025-03-13 17:59:20,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 17:59:20,392 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 17:59:20
2025-03-13 17:59:20,392 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 17:59:20,392 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 17:59:20,392 [INFO]: 		Total: 16.8 minutes
2025-03-13 17:59:20,392 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 17:59:20,393 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 17:59:20
2025-03-13 17:59:20,393 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 17:59:20,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 17:59:20,393 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 17:59:20
2025-03-13 17:59:20,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 17:59:20,393 [INFO]: 	Creating the index 03/13/2025, 17:59:20
2025-03-13 17:59:20,393 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 17:59:20
2025-03-13 17:59:20,394 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-13 17:59:20,394 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 17:59:20
2025-03-13 17:59:20,394 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 17:59:20,394 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:15,  3.87it/s]  5%|▌         | 3/60 [00:00<00:07,  7.27it/s]  7%|▋         | 4/60 [00:00<00:07,  7.99it/s] 10%|█         | 6/60 [00:00<00:06,  8.85it/s] 13%|█▎        | 8/60 [00:00<00:05,  9.26it/s] 15%|█▌        | 9/60 [00:01<00:05,  9.33it/s] 17%|█▋        | 10/60 [00:01<00:05,  9.37it/s] 18%|█▊        | 11/60 [00:01<00:05,  9.35it/s] 22%|██▏       | 13/60 [00:01<00:04,  9.76it/s] 25%|██▌       | 15/60 [00:01<00:04, 10.29it/s] 28%|██▊       | 17/60 [00:01<00:03, 10.86it/s] 32%|███▏      | 19/60 [00:01<00:03, 11.31it/s] 35%|███▌      | 21/60 [00:08<00:43,  1.11s/it] 37%|███▋      | 22/60 [00:08<00:34,  1.09it/s] 40%|████      | 24/60 [00:08<00:22,  1.59it/s] 43%|████▎     | 26/60 [00:08<00:15,  2.24it/s] 47%|████▋     | 28/60 [00:09<00:10,  3.02it/s] 50%|█████     | 30/60 [00:09<00:07,  3.95it/s] 53%|█████▎    | 32/60 [00:09<00:05,  4.95it/s] 57%|█████▋    | 34/60 [00:09<00:04,  6.03it/s] 60%|██████    | 36/60 [00:09<00:03,  7.13it/s] 63%|██████▎   | 38/60 [00:09<00:02,  8.06it/s] 67%|██████▋   | 40/60 [00:10<00:02,  8.83it/s] 70%|███████   | 42/60 [00:18<00:24,  1.34s/it] 72%|███████▏  | 43/60 [00:18<00:19,  1.12s/it] 75%|███████▌  | 45/60 [00:18<00:11,  1.30it/s] 78%|███████▊  | 47/60 [00:18<00:07,  1.82it/s] 82%|████████▏ | 49/60 [00:19<00:04,  2.49it/s] 85%|████████▌ | 51/60 [00:19<00:02,  3.32it/s] 88%|████████▊ | 53/60 [00:19<00:01,  4.28it/s] 92%|█████████▏| 55/60 [00:19<00:00,  5.37it/s] 95%|█████████▌| 57/60 [00:19<00:00,  6.45it/s] 98%|█████████▊| 59/60 [00:19<00:00,  7.49it/s]100%|██████████| 60/60 [00:28<00:00,  2.10it/s]
2025-03-13 17:59:48,906 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 17:59:48
2025-03-13 18:01:24,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.0060 secs
2025-03-13 18:01:24,913 [INFO]: The best hyperparameters are: efSearch=99
2025-03-13 18:01:24,914 [INFO]: 	Compute fast metrics 03/13/2025, 18:01:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 18:02:34,262 [INFO]: 	>>> Finished "Compute fast metrics" in 69.3483 secs
2025-03-13 18:02:34,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 193.8715 secs
2025-03-13 18:02:34,266 [INFO]: {
2025-03-13 18:02:34,266 [INFO]: 	index_key: HNSW32
2025-03-13 18:02:34,266 [INFO]: 	index_param: efSearch=99
2025-03-13 18:02:34,266 [INFO]: 	index_path: knn.index
2025-03-13 18:02:34,266 [INFO]: 	size in bytes: 2881734782
2025-03-13 18:02:34,266 [INFO]: 	avg_search_speed_ms: 10.308902744280616
2025-03-13 18:02:34,266 [INFO]: 	99p_search_speed_ms: 17.18865684000775
2025-03-13 18:02:34,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:02:34,266 [INFO]: 	nb vectors: 14637
2025-03-13 18:02:34,266 [INFO]: 	vectors dimension: 49152
2025-03-13 18:02:34,266 [INFO]: 	compression ratio: 0.9986176777873933
2025-03-13 18:02:34,266 [INFO]: }
2025-03-13 18:02:34,266 [INFO]: 	>>> Finished "Creating the index" in 193.8730 secs
2025-03-13 18:02:34,266 [INFO]: >>> Finished "Launching the whole pipeline" in 193.8990 secs
2025-03-13 18:02:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:02:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 76861 [episode count 6/20]
[retrieval_preprocessing] for episode 41662 [episode count 7/20], we have num_retrieval=np.int64(14671) num_query=np.int64(869)
2025-03-13 18:02:46,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:02:49,009 [INFO]: Launching the whole pipeline 03/13/2025, 18:02:49
2025-03-13 18:02:49,009 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:02:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1272.54it/s]
2025-03-13 18:02:49,334 [INFO]: There are 14671 embeddings of dim 49152
2025-03-13 18:02:49,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3257 secs
2025-03-13 18:02:49,335 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:02:49
2025-03-13 18:02:49,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:02:49,335 [INFO]: 		-> Add: 8.1 seconds
2025-03-13 18:02:49,335 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:02:49,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:02:49,335 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:02:49
2025-03-13 18:02:49,336 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:02:49,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:02:49,336 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:02:49
2025-03-13 18:02:49,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:02:49,336 [INFO]: 	Creating the index 03/13/2025, 18:02:49
2025-03-13 18:02:49,336 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:02:49
2025-03-13 18:02:49,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0021 secs
2025-03-13 18:02:49,339 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:02:49
2025-03-13 18:02:49,339 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:02:49,339 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:10,  5.52it/s]  3%|▎         | 2/60 [00:00<00:08,  6.76it/s]  5%|▌         | 3/60 [00:00<00:07,  7.76it/s]  7%|▋         | 4/60 [00:00<00:06,  8.39it/s]  8%|▊         | 5/60 [00:00<00:06,  8.88it/s] 10%|█         | 6/60 [00:00<00:05,  9.01it/s] 13%|█▎        | 8/60 [00:00<00:04, 10.60it/s] 17%|█▋        | 10/60 [00:01<00:04, 11.33it/s] 20%|██        | 12/60 [00:01<00:03, 12.30it/s] 27%|██▋       | 16/60 [00:01<00:02, 18.56it/s] 33%|███▎      | 20/60 [00:01<00:01, 23.38it/s] 38%|███▊      | 23/60 [00:08<00:29,  1.23it/s] 47%|████▋     | 28/60 [00:09<00:15,  2.11it/s] 55%|█████▌    | 33/60 [00:09<00:08,  3.28it/s] 60%|██████    | 36/60 [00:09<00:05,  4.00it/s] 65%|██████▌   | 39/60 [00:09<00:04,  4.85it/s] 70%|███████   | 42/60 [00:18<00:17,  1.02it/s] 75%|███████▌  | 45/60 [00:18<00:10,  1.39it/s] 80%|████████  | 48/60 [00:19<00:06,  1.91it/s] 85%|████████▌ | 51/60 [00:19<00:03,  2.61it/s] 90%|█████████ | 54/60 [00:19<00:01,  3.55it/s] 95%|█████████▌| 57/60 [00:19<00:00,  4.77it/s]100%|██████████| 60/60 [00:30<00:00,  1.21s/it]100%|██████████| 60/60 [00:30<00:00,  1.99it/s]
2025-03-13 18:03:19,586 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:03:19
2025-03-13 18:05:11,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 111.9283 secs
2025-03-13 18:05:11,516 [INFO]: The best hyperparameters are: efSearch=96
2025-03-13 18:05:11,516 [INFO]: 	Compute fast metrics 03/13/2025, 18:05:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.84it/s]
2025-03-13 18:06:01,294 [INFO]: 	>>> Finished "Compute fast metrics" in 49.7780 secs
2025-03-13 18:06:01,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 191.9582 secs
2025-03-13 18:06:01,297 [INFO]: {
2025-03-13 18:06:01,297 [INFO]: 	index_key: HNSW32
2025-03-13 18:06:01,297 [INFO]: 	index_param: efSearch=96
2025-03-13 18:06:01,297 [INFO]: 	index_path: knn.index
2025-03-13 18:06:01,297 [INFO]: 	size in bytes: 2888428694
2025-03-13 18:06:01,297 [INFO]: 	avg_search_speed_ms: 11.204237406989945
2025-03-13 18:06:01,297 [INFO]: 	99p_search_speed_ms: 19.720027800649415
2025-03-13 18:06:01,297 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:06:01,297 [INFO]: 	nb vectors: 14671
2025-03-13 18:06:01,297 [INFO]: 	vectors dimension: 49152
2025-03-13 18:06:01,297 [INFO]: 	compression ratio: 0.9986176823377035
2025-03-13 18:06:01,297 [INFO]: }
2025-03-13 18:06:01,297 [INFO]: 	>>> Finished "Creating the index" in 191.9611 secs
2025-03-13 18:06:01,297 [INFO]: >>> Finished "Launching the whole pipeline" in 192.2885 secs
2025-03-13 18:06:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:06:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 41662 [episode count 7/20]
[retrieval_preprocessing] for episode 62015 [episode count 8/20], we have num_retrieval=np.int64(15127) num_query=np.int64(413)
2025-03-13 18:06:13,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:06:15,423 [INFO]: Launching the whole pipeline 03/13/2025, 18:06:15
2025-03-13 18:06:15,423 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:06:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.26it/s]
2025-03-13 18:06:15,461 [INFO]: There are 15127 embeddings of dim 49152
2025-03-13 18:06:15,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 18:06:15,462 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:06:15,462 [INFO]: 		-> Add: 8.3 seconds
2025-03-13 18:06:15,462 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:06:15,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:06:15,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,463 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:06:15,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:06:15,463 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:06:15
2025-03-13 18:06:15,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:06:15,463 [INFO]: 	Creating the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,463 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:06:15
2025-03-13 18:06:15,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0025 secs
2025-03-13 18:06:15,466 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:06:15
2025-03-13 18:06:15,466 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 18:06:15,467 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:07,  8.14it/s] 10%|▉         | 6/62 [00:00<00:01, 28.76it/s] 18%|█▊        | 11/62 [00:00<00:01, 35.87it/s] 26%|██▌       | 16/62 [00:00<00:01, 39.87it/s] 34%|███▍      | 21/62 [00:07<00:22,  1.82it/s] 39%|███▊      | 24/62 [00:07<00:16,  2.27it/s] 44%|████▎     | 27/62 [00:07<00:12,  2.84it/s] 47%|████▋     | 29/62 [00:08<00:09,  3.33it/s] 50%|█████     | 31/62 [00:08<00:07,  3.93it/s] 53%|█████▎    | 33/62 [00:08<00:05,  4.85it/s] 61%|██████▏   | 38/62 [00:08<00:02,  8.31it/s] 68%|██████▊   | 42/62 [00:16<00:15,  1.31it/s] 76%|███████▌  | 47/62 [00:16<00:07,  2.08it/s] 84%|████████▍ | 52/62 [00:16<00:03,  3.14it/s] 92%|█████████▏| 57/62 [00:16<00:01,  4.56it/s]100%|██████████| 62/62 [00:26<00:00,  1.32it/s]100%|██████████| 62/62 [00:26<00:00,  2.36it/s]
2025-03-13 18:06:41,694 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:06:41
2025-03-13 18:08:22,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.0679 secs
2025-03-13 18:08:22,763 [INFO]: The best hyperparameters are: efSearch=91
2025-03-13 18:08:22,763 [INFO]: 	Compute fast metrics 03/13/2025, 18:08:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-13 18:09:34,775 [INFO]: 	>>> Finished "Compute fast metrics" in 72.0120 secs
2025-03-13 18:09:34,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 199.3124 secs
2025-03-13 18:09:34,779 [INFO]: {
2025-03-13 18:09:34,779 [INFO]: 	index_key: HNSW32
2025-03-13 18:09:34,779 [INFO]: 	index_param: efSearch=91
2025-03-13 18:09:34,779 [INFO]: 	index_path: knn.index
2025-03-13 18:09:34,779 [INFO]: 	size in bytes: 2978206326
2025-03-13 18:09:34,779 [INFO]: 	avg_search_speed_ms: 10.989847615780821
2025-03-13 18:09:34,779 [INFO]: 	99p_search_speed_ms: 18.05553731974214
2025-03-13 18:09:34,779 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:09:34,779 [INFO]: 	nb vectors: 15127
2025-03-13 18:09:34,779 [INFO]: 	vectors dimension: 49152
2025-03-13 18:09:34,779 [INFO]: 	compression ratio: 0.9986175873833666
2025-03-13 18:09:34,779 [INFO]: }
2025-03-13 18:09:34,779 [INFO]: 	>>> Finished "Creating the index" in 199.3159 secs
2025-03-13 18:09:34,779 [INFO]: >>> Finished "Launching the whole pipeline" in 199.3563 secs
2025-03-13 18:09:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:09:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 62015 [episode count 8/20]
[retrieval_preprocessing] for episode 10184 [episode count 9/20], we have num_retrieval=np.int64(14762) num_query=np.int64(778)
2025-03-13 18:09:42,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:09:45,556 [INFO]: Launching the whole pipeline 03/13/2025, 18:09:45
2025-03-13 18:09:45,556 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:09:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1017.05it/s]
2025-03-13 18:09:45,586 [INFO]: There are 14762 embeddings of dim 49152
2025-03-13 18:09:45,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 18:09:45,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:09:45,587 [INFO]: 		-> Add: 8.1 seconds
2025-03-13 18:09:45,587 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:09:45,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:09:45,587 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,587 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:09:45,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:09:45,587 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:09:45
2025-03-13 18:09:45,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:09:45,587 [INFO]: 	Creating the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,587 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:09:45
2025-03-13 18:09:45,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0014 secs
2025-03-13 18:09:45,589 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:09:45
2025-03-13 18:09:45,589 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:09:45,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:00<00:09,  6.19it/s] 10%|▉         | 6/61 [00:00<00:02, 26.32it/s] 20%|█▉        | 12/61 [00:00<00:01, 36.94it/s] 30%|██▉       | 18/61 [00:00<00:01, 42.86it/s] 38%|███▊      | 23/61 [00:06<00:17,  2.17it/s] 46%|████▌     | 28/61 [00:06<00:10,  3.20it/s] 54%|█████▍    | 33/61 [00:06<00:06,  4.58it/s] 62%|██████▏   | 38/61 [00:07<00:03,  6.43it/s] 70%|███████   | 43/61 [00:15<00:11,  1.56it/s] 79%|███████▊  | 48/61 [00:15<00:05,  2.21it/s] 87%|████████▋ | 53/61 [00:15<00:02,  3.12it/s] 95%|█████████▌| 58/61 [00:16<00:00,  4.34it/s]100%|██████████| 61/61 [00:24<00:00,  2.48it/s]
2025-03-13 18:10:10,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:10:10
2025-03-13 18:11:47,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.9774 secs
2025-03-13 18:11:47,127 [INFO]: The best hyperparameters are: efSearch=102
2025-03-13 18:11:47,127 [INFO]: 	Compute fast metrics 03/13/2025, 18:11:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.30it/s]
2025-03-13 18:12:32,506 [INFO]: 	>>> Finished "Compute fast metrics" in 45.3785 secs
2025-03-13 18:12:32,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 166.9195 secs
2025-03-13 18:12:32,509 [INFO]: {
2025-03-13 18:12:32,509 [INFO]: 	index_key: HNSW32
2025-03-13 18:12:32,509 [INFO]: 	index_param: efSearch=102
2025-03-13 18:12:32,509 [INFO]: 	index_path: knn.index
2025-03-13 18:12:32,509 [INFO]: 	size in bytes: 2906344538
2025-03-13 18:12:32,509 [INFO]: 	avg_search_speed_ms: 12.618435082856148
2025-03-13 18:12:32,509 [INFO]: 	99p_search_speed_ms: 23.70471986010671
2025-03-13 18:12:32,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:12:32,509 [INFO]: 	nb vectors: 14762
2025-03-13 18:12:32,509 [INFO]: 	vectors dimension: 49152
2025-03-13 18:12:32,509 [INFO]: 	compression ratio: 0.998617768145698
2025-03-13 18:12:32,509 [INFO]: }
2025-03-13 18:12:32,509 [INFO]: 	>>> Finished "Creating the index" in 166.9215 secs
2025-03-13 18:12:32,509 [INFO]: >>> Finished "Launching the whole pipeline" in 166.9528 secs
2025-03-13 18:12:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:12:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 10184 [episode count 9/20]
[retrieval_preprocessing] for episode 28623 [episode count 10/20], we have num_retrieval=np.int64(14623) num_query=np.int64(917)
2025-03-13 18:12:39,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:12:41,558 [INFO]: Launching the whole pipeline 03/13/2025, 18:12:41
2025-03-13 18:12:41,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:12:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 876.92it/s]
2025-03-13 18:12:41,589 [INFO]: There are 14623 embeddings of dim 49152
2025-03-13 18:12:41,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-13 18:12:41,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:12:41,591 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 18:12:41,591 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:12:41,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:12:41,591 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,591 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:12:41,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:12:41,592 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:12:41
2025-03-13 18:12:41,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:12:41,592 [INFO]: 	Creating the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,593 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:12:41
2025-03-13 18:12:41,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0031 secs
2025-03-13 18:12:41,596 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:12:41
2025-03-13 18:12:41,596 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:12:41,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:09,  6.24it/s]  8%|▊         | 5/60 [00:00<00:02, 21.53it/s] 15%|█▌        | 9/60 [00:00<00:01, 28.47it/s] 23%|██▎       | 14/60 [00:00<00:01, 33.32it/s] 32%|███▏      | 19/60 [00:00<00:01, 37.23it/s] 38%|███▊      | 23/60 [00:07<00:21,  1.75it/s] 47%|████▋     | 28/60 [00:07<00:11,  2.69it/s] 55%|█████▌    | 33/60 [00:07<00:06,  3.96it/s] 62%|██████▏   | 37/60 [00:07<00:04,  5.30it/s] 70%|███████   | 42/60 [00:16<00:12,  1.40it/s] 77%|███████▋  | 46/60 [00:16<00:07,  1.91it/s] 85%|████████▌ | 51/60 [00:16<00:03,  2.79it/s] 93%|█████████▎| 56/60 [00:16<00:01,  3.98it/s]100%|██████████| 60/60 [00:26<00:00,  1.23it/s]100%|██████████| 60/60 [00:26<00:00,  2.28it/s]
2025-03-13 18:13:07,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:13:07
2025-03-13 18:14:45,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.0502 secs
2025-03-13 18:14:45,020 [INFO]: The best hyperparameters are: efSearch=30
2025-03-13 18:14:45,020 [INFO]: 	Compute fast metrics 03/13/2025, 18:14:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.21it/s]
2025-03-13 18:15:56,323 [INFO]: 	>>> Finished "Compute fast metrics" in 71.3035 secs
2025-03-13 18:15:56,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 194.7319 secs
2025-03-13 18:15:56,328 [INFO]: {
2025-03-13 18:15:56,329 [INFO]: 	index_key: HNSW32
2025-03-13 18:15:56,329 [INFO]: 	index_param: efSearch=30
2025-03-13 18:15:56,329 [INFO]: 	index_path: knn.index
2025-03-13 18:15:56,329 [INFO]: 	size in bytes: 2878978518
2025-03-13 18:15:56,329 [INFO]: 	avg_search_speed_ms: 6.518106526486342
2025-03-13 18:15:56,329 [INFO]: 	99p_search_speed_ms: 10.798219980206344
2025-03-13 18:15:56,329 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:15:56,329 [INFO]: 	nb vectors: 14623
2025-03-13 18:15:56,329 [INFO]: 	vectors dimension: 49152
2025-03-13 18:15:56,329 [INFO]: 	compression ratio: 0.9986176576257454
2025-03-13 18:15:56,329 [INFO]: }
2025-03-13 18:15:56,329 [INFO]: 	>>> Finished "Creating the index" in 194.7362 secs
2025-03-13 18:15:56,329 [INFO]: >>> Finished "Launching the whole pipeline" in 194.7707 secs
2025-03-13 18:15:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:16:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 28623 [episode count 10/20]
[retrieval_preprocessing] for episode 91489 [episode count 11/20], we have num_retrieval=np.int64(14537) num_query=np.int64(1003)
2025-03-13 18:16:03,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:16:05,745 [INFO]: Launching the whole pipeline 03/13/2025, 18:16:05
2025-03-13 18:16:05,745 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:16:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.07it/s]
2025-03-13 18:16:05,774 [INFO]: There are 14537 embeddings of dim 49152
2025-03-13 18:16:05,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 18:16:05,775 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:16:05
2025-03-13 18:16:05,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:16:05,775 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 18:16:05,775 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:16:05,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:16:05,775 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:16:05
2025-03-13 18:16:05,776 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:16:05,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:16:05,776 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:16:05
2025-03-13 18:16:05,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:16:05,777 [INFO]: 	Creating the index 03/13/2025, 18:16:05
2025-03-13 18:16:05,777 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:16:05
2025-03-13 18:16:05,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 18:16:05,780 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:16:05
2025-03-13 18:16:05,780 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:16:05,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:08,  6.87it/s] 10%|█         | 6/60 [00:00<00:02, 25.07it/s] 17%|█▋        | 10/60 [00:00<00:01, 30.63it/s] 25%|██▌       | 15/60 [00:00<00:01, 35.02it/s] 33%|███▎      | 20/60 [00:00<00:01, 37.55it/s] 40%|████      | 24/60 [00:07<00:19,  1.82it/s] 48%|████▊     | 29/60 [00:07<00:11,  2.78it/s] 57%|█████▋    | 34/60 [00:07<00:06,  4.08it/s] 65%|██████▌   | 39/60 [00:07<00:03,  5.81it/s] 72%|███████▏  | 43/60 [00:15<00:11,  1.54it/s] 80%|████████  | 48/60 [00:15<00:05,  2.25it/s] 88%|████████▊ | 53/60 [00:15<00:02,  3.21it/s] 97%|█████████▋| 58/60 [00:15<00:00,  4.53it/s]100%|██████████| 60/60 [00:23<00:00,  2.58it/s]
2025-03-13 18:16:29,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:16:29
2025-03-13 18:18:05,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.5600 secs
2025-03-13 18:18:05,635 [INFO]: The best hyperparameters are: efSearch=67
2025-03-13 18:18:05,635 [INFO]: 	Compute fast metrics 03/13/2025, 18:18:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-13 18:19:16,940 [INFO]: 	>>> Finished "Compute fast metrics" in 71.3050 secs
2025-03-13 18:19:16,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 191.1632 secs
2025-03-13 18:19:16,943 [INFO]: {
2025-03-13 18:19:16,943 [INFO]: 	index_key: HNSW32
2025-03-13 18:19:16,943 [INFO]: 	index_param: efSearch=67
2025-03-13 18:19:16,943 [INFO]: 	index_path: knn.index
2025-03-13 18:19:16,943 [INFO]: 	size in bytes: 2862046798
2025-03-13 18:19:16,943 [INFO]: 	avg_search_speed_ms: 9.65783596699554
2025-03-13 18:19:16,944 [INFO]: 	99p_search_speed_ms: 17.83380605047569
2025-03-13 18:19:16,944 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:19:16,944 [INFO]: 	nb vectors: 14537
2025-03-13 18:19:16,944 [INFO]: 	vectors dimension: 49152
2025-03-13 18:19:16,944 [INFO]: 	compression ratio: 0.998617666907905
2025-03-13 18:19:16,944 [INFO]: }
2025-03-13 18:19:16,944 [INFO]: 	>>> Finished "Creating the index" in 191.1670 secs
2025-03-13 18:19:16,944 [INFO]: >>> Finished "Launching the whole pipeline" in 191.1990 secs
2025-03-13 18:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:19:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 91489 [episode count 11/20]
[retrieval_preprocessing] for episode 11496 [episode count 12/20], we have num_retrieval=np.int64(14236) num_query=np.int64(1304)
2025-03-13 18:19:26,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:19:28,200 [INFO]: Launching the whole pipeline 03/13/2025, 18:19:28
2025-03-13 18:19:28,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:19:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1347.35it/s]
2025-03-13 18:19:28,229 [INFO]: There are 14236 embeddings of dim 49152
2025-03-13 18:19:28,230 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-13 18:19:28,230 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:19:28
2025-03-13 18:19:28,230 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:19:28,231 [INFO]: 		-> Add: 7.8 seconds
2025-03-13 18:19:28,231 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:19:28,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 18:19:28,231 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:19:28
2025-03-13 18:19:28,232 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:19:28,232 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:19:28,232 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:19:28
2025-03-13 18:19:28,232 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:19:28,232 [INFO]: 	Creating the index 03/13/2025, 18:19:28
2025-03-13 18:19:28,233 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:19:28
2025-03-13 18:19:28,236 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-13 18:19:28,236 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:19:28
2025-03-13 18:19:28,236 [INFO]: The memory available for adding the vectors is 47.4GB(total available - used by the index)
2025-03-13 18:19:28,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/58 [00:00<?, ?it/s]  2%|▏         | 1/58 [00:00<00:07,  7.64it/s] 10%|█         | 6/58 [00:00<00:01, 28.88it/s] 19%|█▉        | 11/58 [00:00<00:01, 37.48it/s] 29%|██▉       | 17/58 [00:00<00:00, 43.08it/s] 38%|███▊      | 22/58 [00:06<00:16,  2.17it/s] 48%|████▊     | 28/58 [00:06<00:08,  3.45it/s] 59%|█████▊    | 34/58 [00:06<00:04,  5.17it/s] 69%|██████▉   | 40/58 [00:06<00:02,  7.44it/s] 78%|███████▊  | 45/58 [00:14<00:06,  1.88it/s] 88%|████████▊ | 51/58 [00:14<00:02,  2.76it/s] 98%|█████████▊| 57/58 [00:14<00:00,  3.96it/s]100%|██████████| 58/58 [00:21<00:00,  2.70it/s]
2025-03-13 18:19:50,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:19:50
2025-03-13 18:21:23,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 93.3773 secs
2025-03-13 18:21:23,532 [INFO]: The best hyperparameters are: efSearch=89
2025-03-13 18:21:23,532 [INFO]: 	Compute fast metrics 03/13/2025, 18:21:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.46it/s]
2025-03-13 18:22:38,794 [INFO]: 	>>> Finished "Compute fast metrics" in 75.2619 secs
2025-03-13 18:22:38,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 190.5602 secs
2025-03-13 18:22:38,797 [INFO]: {
2025-03-13 18:22:38,797 [INFO]: 	index_key: HNSW32
2025-03-13 18:22:38,797 [INFO]: 	index_param: efSearch=89
2025-03-13 18:22:38,797 [INFO]: 	index_path: knn.index
2025-03-13 18:22:38,797 [INFO]: 	size in bytes: 2802785714
2025-03-13 18:22:38,797 [INFO]: 	avg_search_speed_ms: 11.23477258337557
2025-03-13 18:22:38,797 [INFO]: 	99p_search_speed_ms: 19.900181889533997
2025-03-13 18:22:38,797 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:22:38,797 [INFO]: 	nb vectors: 14236
2025-03-13 18:22:38,797 [INFO]: 	vectors dimension: 49152
2025-03-13 18:22:38,797 [INFO]: 	compression ratio: 0.9986177230814871
2025-03-13 18:22:38,797 [INFO]: }
2025-03-13 18:22:38,797 [INFO]: 	>>> Finished "Creating the index" in 190.5643 secs
2025-03-13 18:22:38,797 [INFO]: >>> Finished "Launching the whole pipeline" in 190.5968 secs
2025-03-13 18:22:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:22:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 11496 [episode count 12/20]
[retrieval_preprocessing] for episode 26472 [episode count 13/20], we have num_retrieval=np.int64(15221) num_query=np.int64(319)
2025-03-13 18:22:47,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:22:50,098 [INFO]: Launching the whole pipeline 03/13/2025, 18:22:50
2025-03-13 18:22:50,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:22:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1324.80it/s]
2025-03-13 18:22:50,128 [INFO]: There are 15221 embeddings of dim 49152
2025-03-13 18:22:50,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 18:22:50,128 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:22:50
2025-03-13 18:22:50,128 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:22:50,128 [INFO]: 		-> Add: 8.4 seconds
2025-03-13 18:22:50,128 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:22:50,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:22:50,128 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:22:50
2025-03-13 18:22:50,129 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:22:50,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:22:50,129 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:22:50
2025-03-13 18:22:50,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:22:50,129 [INFO]: 	Creating the index 03/13/2025, 18:22:50
2025-03-13 18:22:50,129 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:22:50
2025-03-13 18:22:50,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 18:22:50,130 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:22:50
2025-03-13 18:22:50,130 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 18:22:50,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:00<00:08,  7.35it/s]  5%|▍         | 3/62 [00:00<00:04, 13.78it/s] 13%|█▎        | 8/62 [00:00<00:01, 27.31it/s] 21%|██        | 13/62 [00:00<00:01, 33.68it/s] 29%|██▉       | 18/62 [00:00<00:01, 37.93it/s] 35%|███▌      | 22/62 [00:07<00:23,  1.69it/s] 42%|████▏     | 26/62 [00:07<00:14,  2.42it/s] 48%|████▊     | 30/62 [00:07<00:09,  3.42it/s] 55%|█████▍    | 34/62 [00:07<00:05,  4.75it/s] 61%|██████▏   | 38/62 [00:08<00:03,  6.47it/s] 68%|██████▊   | 42/62 [00:16<00:15,  1.29it/s] 76%|███████▌  | 47/62 [00:16<00:07,  1.96it/s] 84%|████████▍ | 52/62 [00:17<00:03,  2.88it/s] 92%|█████████▏| 57/62 [00:17<00:01,  4.14it/s]100%|██████████| 62/62 [00:27<00:00,  1.24it/s]100%|██████████| 62/62 [00:27<00:00,  2.27it/s]
2025-03-13 18:23:17,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:23:17
2025-03-13 18:24:57,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 100.1523 secs
2025-03-13 18:24:57,601 [INFO]: The best hyperparameters are: efSearch=80
2025-03-13 18:24:57,601 [INFO]: 	Compute fast metrics 03/13/2025, 18:24:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-13 18:26:25,189 [INFO]: 	>>> Finished "Compute fast metrics" in 87.5879 secs
2025-03-13 18:26:25,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 215.0624 secs
2025-03-13 18:26:25,193 [INFO]: {
2025-03-13 18:26:25,193 [INFO]: 	index_key: HNSW32
2025-03-13 18:26:25,193 [INFO]: 	index_param: efSearch=80
2025-03-13 18:26:25,193 [INFO]: 	index_path: knn.index
2025-03-13 18:26:25,193 [INFO]: 	size in bytes: 2996713054
2025-03-13 18:26:25,193 [INFO]: 	avg_search_speed_ms: 9.587244971138304
2025-03-13 18:26:25,193 [INFO]: 	99p_search_speed_ms: 15.600176304578758
2025-03-13 18:26:25,193 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:26:25,193 [INFO]: 	nb vectors: 15221
2025-03-13 18:26:25,193 [INFO]: 	vectors dimension: 49152
2025-03-13 18:26:25,193 [INFO]: 	compression ratio: 0.9986175900310273
2025-03-13 18:26:25,193 [INFO]: }
2025-03-13 18:26:25,193 [INFO]: 	>>> Finished "Creating the index" in 215.0643 secs
2025-03-13 18:26:25,193 [INFO]: >>> Finished "Launching the whole pipeline" in 215.0953 secs
2025-03-13 18:26:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:26:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 26472 [episode count 13/20]
[retrieval_preprocessing] for episode 28267 [episode count 14/20], we have num_retrieval=np.int64(14471) num_query=np.int64(1069)
2025-03-13 18:26:28,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:26:31,709 [INFO]: Launching the whole pipeline 03/13/2025, 18:26:31
2025-03-13 18:26:31,709 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:26:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1010.19it/s]
2025-03-13 18:26:31,743 [INFO]: There are 14471 embeddings of dim 49152
2025-03-13 18:26:31,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-13 18:26:31,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:26:31
2025-03-13 18:26:31,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:26:31,744 [INFO]: 		-> Add: 7.9 seconds
2025-03-13 18:26:31,744 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:26:31,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:26:31,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:26:31
2025-03-13 18:26:31,744 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:26:31,744 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:26:31,744 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:26:31
2025-03-13 18:26:31,744 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:26:31,744 [INFO]: 	Creating the index 03/13/2025, 18:26:31
2025-03-13 18:26:31,744 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:26:31
2025-03-13 18:26:31,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-13 18:26:31,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:26:31
2025-03-13 18:26:31,746 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:26:31,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/59 [00:00<?, ?it/s]  2%|▏         | 1/59 [00:00<00:10,  5.49it/s]  8%|▊         | 5/59 [00:00<00:02, 19.65it/s] 17%|█▋        | 10/59 [00:00<00:01, 28.28it/s] 24%|██▎       | 14/59 [00:00<00:01, 31.84it/s] 31%|███       | 18/59 [00:00<00:01, 34.19it/s] 37%|███▋      | 22/59 [00:07<00:23,  1.57it/s] 46%|████▌     | 27/59 [00:07<00:12,  2.49it/s] 54%|█████▍    | 32/59 [00:08<00:07,  3.72it/s] 63%|██████▎   | 37/59 [00:08<00:04,  5.34it/s] 69%|██████▉   | 41/59 [00:08<00:02,  7.02it/s] 76%|███████▋  | 45/59 [00:16<00:09,  1.41it/s] 83%|████████▎ | 49/59 [00:16<00:05,  1.96it/s] 92%|█████████▏| 54/59 [00:17<00:01,  2.89it/s]100%|██████████| 59/59 [00:26<00:00,  1.22it/s]100%|██████████| 59/59 [00:26<00:00,  2.27it/s]
2025-03-13 18:26:57,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:26:57
2025-03-13 18:28:25,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.9888 secs
2025-03-13 18:28:25,783 [INFO]: The best hyperparameters are: efSearch=64
2025-03-13 18:28:25,783 [INFO]: 	Compute fast metrics 03/13/2025, 18:28:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.13it/s]
2025-03-13 18:29:47,817 [INFO]: 	>>> Finished "Compute fast metrics" in 82.0334 secs
2025-03-13 18:29:48,168 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 196.4219 secs
2025-03-13 18:29:48,168 [INFO]: {
2025-03-13 18:29:48,168 [INFO]: 	index_key: HNSW32
2025-03-13 18:29:48,168 [INFO]: 	index_param: efSearch=64
2025-03-13 18:29:48,168 [INFO]: 	index_path: knn.index
2025-03-13 18:29:48,168 [INFO]: 	size in bytes: 2849052854
2025-03-13 18:29:48,169 [INFO]: 	avg_search_speed_ms: 8.656556317703677
2025-03-13 18:29:48,169 [INFO]: 	99p_search_speed_ms: 15.66947425249965
2025-03-13 18:29:48,169 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:29:48,169 [INFO]: 	nb vectors: 14471
2025-03-13 18:29:48,169 [INFO]: 	vectors dimension: 49152
2025-03-13 18:29:48,169 [INFO]: 	compression ratio: 0.9986176156772696
2025-03-13 18:29:48,169 [INFO]: }
2025-03-13 18:29:48,169 [INFO]: 	>>> Finished "Creating the index" in 196.4246 secs
2025-03-13 18:29:48,169 [INFO]: >>> Finished "Launching the whole pipeline" in 196.4602 secs
2025-03-13 18:29:51: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:29:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 28267 [episode count 14/20]
[retrieval_preprocessing] for episode 26868 [episode count 15/20], we have num_retrieval=np.int64(14805) num_query=np.int64(735)
2025-03-13 18:29:58,202 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:30:01,124 [INFO]: Launching the whole pipeline 03/13/2025, 18:30:01
2025-03-13 18:30:01,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:30:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1082.96it/s]
2025-03-13 18:30:01,168 [INFO]: There are 14805 embeddings of dim 49152
2025-03-13 18:30:01,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0434 secs
2025-03-13 18:30:01,168 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:30:01,169 [INFO]: 		-> Add: 8.1 seconds
2025-03-13 18:30:01,169 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:30:01,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:30:01,169 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,169 [INFO]: 3.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:30:01,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:30:01,169 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:30:01
2025-03-13 18:30:01,170 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:30:01,170 [INFO]: 	Creating the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,170 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:30:01
2025-03-13 18:30:01,172 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0020 secs
2025-03-13 18:30:01,172 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:30:01
2025-03-13 18:30:01,172 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:30:01,172 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:00<00:11,  5.42it/s]  8%|▊         | 5/61 [00:00<00:02, 20.14it/s] 16%|█▋        | 10/61 [00:00<00:01, 28.80it/s] 25%|██▍       | 15/61 [00:00<00:01, 34.09it/s] 33%|███▎      | 20/61 [00:00<00:01, 38.76it/s] 41%|████      | 25/61 [00:07<00:18,  1.99it/s] 49%|████▉     | 30/61 [00:07<00:10,  2.95it/s] 57%|█████▋    | 35/61 [00:07<00:06,  4.26it/s] 66%|██████▌   | 40/61 [00:07<00:03,  6.02it/s] 74%|███████▍  | 45/61 [00:15<00:09,  1.70it/s] 82%|████████▏ | 50/61 [00:15<00:04,  2.43it/s] 92%|█████████▏| 56/61 [00:15<00:01,  3.62it/s]100%|██████████| 61/61 [00:22<00:00,  1.59it/s]100%|██████████| 61/61 [00:22<00:00,  2.67it/s]
2025-03-13 18:30:24,038 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:30:24
2025-03-13 18:31:53,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.0750 secs
2025-03-13 18:31:53,114 [INFO]: The best hyperparameters are: efSearch=83
2025-03-13 18:31:53,114 [INFO]: 	Compute fast metrics 03/13/2025, 18:31:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.30it/s]
2025-03-13 18:32:46,241 [INFO]: 	>>> Finished "Compute fast metrics" in 53.1272 secs
2025-03-13 18:32:46,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 165.0716 secs
2025-03-13 18:32:46,244 [INFO]: {
2025-03-13 18:32:46,244 [INFO]: 	index_key: HNSW32
2025-03-13 18:32:46,244 [INFO]: 	index_param: efSearch=83
2025-03-13 18:32:46,244 [INFO]: 	index_path: knn.index
2025-03-13 18:32:46,244 [INFO]: 	size in bytes: 2914810462
2025-03-13 18:32:46,244 [INFO]: 	avg_search_speed_ms: 8.72468930485465
2025-03-13 18:32:46,244 [INFO]: 	99p_search_speed_ms: 13.541458803229023
2025-03-13 18:32:46,244 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:32:46,244 [INFO]: 	nb vectors: 14805
2025-03-13 18:32:46,244 [INFO]: 	vectors dimension: 49152
2025-03-13 18:32:46,244 [INFO]: 	compression ratio: 0.9986177413411521
2025-03-13 18:32:46,244 [INFO]: }
2025-03-13 18:32:46,244 [INFO]: 	>>> Finished "Creating the index" in 165.0744 secs
2025-03-13 18:32:46,244 [INFO]: >>> Finished "Launching the whole pipeline" in 165.1194 secs
2025-03-13 18:32:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:32:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 26868 [episode count 15/20]
[retrieval_preprocessing] for episode 76022 [episode count 16/20], we have num_retrieval=np.int64(15307) num_query=np.int64(233)
2025-03-13 18:32:51,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:32:54,679 [INFO]: Launching the whole pipeline 03/13/2025, 18:32:54
2025-03-13 18:32:54,679 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:32:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 764.13it/s]
2025-03-13 18:32:54,715 [INFO]: There are 15307 embeddings of dim 49152
2025-03-13 18:32:54,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 18:32:54,715 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:32:54
2025-03-13 18:32:54,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:32:54,716 [INFO]: 		-> Add: 8.4 seconds
2025-03-13 18:32:54,716 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:32:54,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:32:54,716 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:32:54
2025-03-13 18:32:54,717 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:32:54,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:32:54,717 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:32:54
2025-03-13 18:32:54,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:32:54,718 [INFO]: 	Creating the index 03/13/2025, 18:32:54
2025-03-13 18:32:54,718 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:32:54
2025-03-13 18:32:54,721 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-13 18:32:54,721 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:32:54
2025-03-13 18:32:54,721 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 18:32:54,722 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/64 [00:00<?, ?it/s]  2%|▏         | 1/64 [00:00<00:12,  5.00it/s]  8%|▊         | 5/64 [00:00<00:03, 18.48it/s] 14%|█▍        | 9/64 [00:00<00:02, 26.13it/s] 22%|██▏       | 14/64 [00:00<00:01, 32.31it/s] 30%|██▉       | 19/64 [00:00<00:01, 35.68it/s] 36%|███▌      | 23/64 [00:07<00:22,  1.82it/s] 45%|████▌     | 29/64 [00:07<00:11,  2.99it/s] 55%|█████▍    | 35/64 [00:07<00:06,  4.58it/s] 64%|██████▍   | 41/64 [00:07<00:03,  6.68it/s] 72%|███████▏  | 46/64 [00:14<00:09,  1.96it/s] 81%|████████▏ | 52/64 [00:14<00:04,  2.89it/s] 91%|█████████ | 58/64 [00:14<00:01,  4.16it/s] 98%|█████████▊| 63/64 [00:22<00:00,  1.59it/s]100%|██████████| 64/64 [00:23<00:00,  2.72it/s]
2025-03-13 18:33:18,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:33:18
2025-03-13 18:34:50,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.6802 secs
2025-03-13 18:34:50,908 [INFO]: The best hyperparameters are: efSearch=79
2025-03-13 18:34:50,908 [INFO]: 	Compute fast metrics 03/13/2025, 18:34:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-13 18:35:41,805 [INFO]: 	>>> Finished "Compute fast metrics" in 50.8965 secs
2025-03-13 18:35:41,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 167.0844 secs
2025-03-13 18:35:41,806 [INFO]: {
2025-03-13 18:35:41,806 [INFO]: 	index_key: HNSW32
2025-03-13 18:35:41,806 [INFO]: 	index_param: efSearch=79
2025-03-13 18:35:41,806 [INFO]: 	index_path: knn.index
2025-03-13 18:35:41,806 [INFO]: 	size in bytes: 3013644902
2025-03-13 18:35:41,806 [INFO]: 	avg_search_speed_ms: 9.806338066974764
2025-03-13 18:35:41,806 [INFO]: 	99p_search_speed_ms: 17.497975889127673
2025-03-13 18:35:41,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:35:41,806 [INFO]: 	nb vectors: 15307
2025-03-13 18:35:41,806 [INFO]: 	vectors dimension: 49152
2025-03-13 18:35:41,806 [INFO]: 	compression ratio: 0.998617539180799
2025-03-13 18:35:41,806 [INFO]: }
2025-03-13 18:35:41,806 [INFO]: 	>>> Finished "Creating the index" in 167.0882 secs
2025-03-13 18:35:41,806 [INFO]: >>> Finished "Launching the whole pipeline" in 167.1265 secs
2025-03-13 18:35:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:35:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 76022 [episode count 16/20]
[retrieval_preprocessing] for episode 77433 [episode count 17/20], we have num_retrieval=np.int64(14561) num_query=np.int64(979)
2025-03-13 18:35:44,250 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:35:46,123 [INFO]: Launching the whole pipeline 03/13/2025, 18:35:46
2025-03-13 18:35:46,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:35:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.62it/s]
2025-03-13 18:35:46,149 [INFO]: There are 14561 embeddings of dim 49152
2025-03-13 18:35:46,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 18:35:46,149 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:35:46
2025-03-13 18:35:46,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:35:46,149 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 18:35:46,149 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:35:46,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:35:46,149 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:35:46
2025-03-13 18:35:46,149 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:35:46,149 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:35:46,149 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:35:46
2025-03-13 18:35:46,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:35:46,150 [INFO]: 	Creating the index 03/13/2025, 18:35:46
2025-03-13 18:35:46,150 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:35:46
2025-03-13 18:35:46,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:35:46,151 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:35:46
2025-03-13 18:35:46,151 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:35:46,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:07,  7.76it/s]  7%|▋         | 4/60 [00:00<00:03, 18.30it/s] 15%|█▌        | 9/60 [00:00<00:01, 30.61it/s] 25%|██▌       | 15/60 [00:00<00:01, 38.64it/s] 35%|███▌      | 21/60 [00:06<00:16,  2.30it/s] 40%|████      | 24/60 [00:06<00:12,  2.83it/s] 45%|████▌     | 27/60 [00:06<00:09,  3.47it/s] 48%|████▊     | 29/60 [00:07<00:07,  3.98it/s] 52%|█████▏    | 31/60 [00:07<00:06,  4.60it/s] 55%|█████▌    | 33/60 [00:07<00:05,  5.28it/s] 58%|█████▊    | 35/60 [00:07<00:04,  6.12it/s] 62%|██████▏   | 37/60 [00:07<00:03,  6.98it/s] 67%|██████▋   | 40/60 [00:07<00:02,  9.50it/s] 70%|███████   | 42/60 [00:14<00:16,  1.09it/s] 80%|████████  | 48/60 [00:14<00:05,  2.24it/s] 90%|█████████ | 54/60 [00:14<00:01,  3.80it/s]100%|██████████| 60/60 [00:22<00:00,  1.58it/s]100%|██████████| 60/60 [00:22<00:00,  2.71it/s]
2025-03-13 18:36:08,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:36:08
2025-03-13 18:37:45,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 97.5947 secs
2025-03-13 18:37:45,878 [INFO]: The best hyperparameters are: efSearch=92
2025-03-13 18:37:45,878 [INFO]: 	Compute fast metrics 03/13/2025, 18:37:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-13 18:38:58,834 [INFO]: 	>>> Finished "Compute fast metrics" in 72.9559 secs
2025-03-13 18:38:58,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 192.6860 secs
2025-03-13 18:38:58,837 [INFO]: {
2025-03-13 18:38:58,837 [INFO]: 	index_key: HNSW32
2025-03-13 18:38:58,837 [INFO]: 	index_param: efSearch=92
2025-03-13 18:38:58,837 [INFO]: 	index_path: knn.index
2025-03-13 18:38:58,837 [INFO]: 	size in bytes: 2866771950
2025-03-13 18:38:58,837 [INFO]: 	avg_search_speed_ms: 11.76181353354717
2025-03-13 18:38:58,837 [INFO]: 	99p_search_speed_ms: 23.210982021410018
2025-03-13 18:38:58,837 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:38:58,837 [INFO]: 	nb vectors: 14561
2025-03-13 18:38:58,837 [INFO]: 	vectors dimension: 49152
2025-03-13 18:38:58,837 [INFO]: 	compression ratio: 0.9986176570480257
2025-03-13 18:38:58,837 [INFO]: }
2025-03-13 18:38:58,837 [INFO]: 	>>> Finished "Creating the index" in 192.6877 secs
2025-03-13 18:38:58,837 [INFO]: >>> Finished "Launching the whole pipeline" in 192.7139 secs
2025-03-13 18:39:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:39:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 77433 [episode count 17/20]
[retrieval_preprocessing] for episode 75514 [episode count 18/20], we have num_retrieval=np.int64(15288) num_query=np.int64(252)
2025-03-13 18:39:07,913 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:39:11,122 [INFO]: Launching the whole pipeline 03/13/2025, 18:39:11
2025-03-13 18:39:11,122 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:39:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1011.16it/s]
2025-03-13 18:39:11,152 [INFO]: There are 15288 embeddings of dim 49152
2025-03-13 18:39:11,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 18:39:11,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:39:11
2025-03-13 18:39:11,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:39:11,153 [INFO]: 		-> Add: 8.4 seconds
2025-03-13 18:39:11,154 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:39:11,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:39:11,154 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:39:11
2025-03-13 18:39:11,154 [INFO]: 3.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:39:11,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 18:39:11,155 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:39:11
2025-03-13 18:39:11,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:39:11,155 [INFO]: 	Creating the index 03/13/2025, 18:39:11
2025-03-13 18:39:11,156 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:39:11
2025-03-13 18:39:11,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-13 18:39:11,159 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:39:11
2025-03-13 18:39:11,159 [INFO]: The memory available for adding the vectors is 47.2GB(total available - used by the index)
2025-03-13 18:39:11,159 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/64 [00:00<?, ?it/s]  2%|▏         | 1/64 [00:00<00:09,  6.99it/s]  9%|▉         | 6/64 [00:00<00:02, 26.30it/s] 17%|█▋        | 11/64 [00:00<00:01, 33.70it/s] 25%|██▌       | 16/64 [00:00<00:01, 37.53it/s] 33%|███▎      | 21/64 [00:07<00:24,  1.76it/s] 38%|███▊      | 24/64 [00:07<00:17,  2.30it/s] 44%|████▍     | 28/64 [00:07<00:11,  3.27it/s] 50%|█████     | 32/64 [00:07<00:07,  4.55it/s] 55%|█████▍    | 35/64 [00:08<00:05,  5.75it/s] 59%|█████▉    | 38/64 [00:08<00:03,  7.27it/s] 64%|██████▍   | 41/64 [00:08<00:02,  9.09it/s] 69%|██████▉   | 44/64 [00:18<00:20,  1.02s/it] 77%|███████▋  | 49/64 [00:18<00:09,  1.61it/s] 84%|████████▍ | 54/64 [00:18<00:04,  2.49it/s] 92%|█████████▏| 59/64 [00:18<00:01,  3.67it/s] 98%|█████████▊| 63/64 [00:27<00:00,  1.23it/s]100%|██████████| 64/64 [00:27<00:00,  2.30it/s]
2025-03-13 18:39:38,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:39:38
2025-03-13 18:41:09,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.4468 secs
2025-03-13 18:41:09,421 [INFO]: The best hyperparameters are: efSearch=83
2025-03-13 18:41:09,421 [INFO]: 	Compute fast metrics 03/13/2025, 18:41:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.98it/s]
2025-03-13 18:42:14,885 [INFO]: 	>>> Finished "Compute fast metrics" in 65.4643 secs
2025-03-13 18:42:15,426 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 184.2668 secs
2025-03-13 18:42:15,426 [INFO]: {
2025-03-13 18:42:15,426 [INFO]: 	index_key: HNSW32
2025-03-13 18:42:15,426 [INFO]: 	index_param: efSearch=83
2025-03-13 18:42:15,426 [INFO]: 	index_path: knn.index
2025-03-13 18:42:15,426 [INFO]: 	size in bytes: 3009904258
2025-03-13 18:42:15,426 [INFO]: 	avg_search_speed_ms: 11.25142706324492
2025-03-13 18:42:15,427 [INFO]: 	99p_search_speed_ms: 19.620980340987444
2025-03-13 18:42:15,427 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:42:15,427 [INFO]: 	nb vectors: 15288
2025-03-13 18:42:15,427 [INFO]: 	vectors dimension: 49152
2025-03-13 18:42:15,427 [INFO]: 	compression ratio: 0.9986175128365162
2025-03-13 18:42:15,427 [INFO]: }
2025-03-13 18:42:15,427 [INFO]: 	>>> Finished "Creating the index" in 184.2713 secs
2025-03-13 18:42:15,427 [INFO]: >>> Finished "Launching the whole pipeline" in 184.3048 secs
2025-03-13 18:42:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:42:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 75514 [episode count 18/20]
[retrieval_preprocessing] for episode 13052 [episode count 19/20], we have num_retrieval=np.int64(14588) num_query=np.int64(952)
2025-03-13 18:42:18,992 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:42:21,924 [INFO]: Launching the whole pipeline 03/13/2025, 18:42:21
2025-03-13 18:42:21,924 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:42:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.22it/s]
2025-03-13 18:42:21,950 [INFO]: There are 14588 embeddings of dim 49152
2025-03-13 18:42:21,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 18:42:21,950 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:42:21,950 [INFO]: 		-> Add: 8.0 seconds
2025-03-13 18:42:21,950 [INFO]: 		Total: 16.8 minutes
2025-03-13 18:42:21,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:42:21,950 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,951 [INFO]: 2.9GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:42:21,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:42:21,951 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:42:21
2025-03-13 18:42:21,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:42:21,951 [INFO]: 	Creating the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,951 [INFO]: 		-> Instanciate the index HNSW32 03/13/2025, 18:42:21
2025-03-13 18:42:21,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-13 18:42:21,952 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:42:21
2025-03-13 18:42:21,952 [INFO]: The memory available for adding the vectors is 47.3GB(total available - used by the index)
2025-03-13 18:42:21,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:00<00:08,  6.96it/s]  8%|▊         | 5/60 [00:00<00:02, 22.40it/s] 17%|█▋        | 10/60 [00:00<00:01, 32.00it/s] 25%|██▌       | 15/60 [00:00<00:01, 37.29it/s] 33%|███▎      | 20/60 [00:00<00:00, 40.39it/s] 42%|████▏     | 25/60 [00:06<00:15,  2.19it/s] 50%|█████     | 30/60 [00:06<00:09,  3.25it/s] 58%|█████▊    | 35/60 [00:06<00:05,  4.67it/s] 67%|██████▋   | 40/60 [00:06<00:03,  6.55it/s] 75%|███████▌  | 45/60 [00:15<00:09,  1.64it/s] 83%|████████▎ | 50/60 [00:15<00:04,  2.34it/s] 92%|█████████▏| 55/60 [00:15<00:01,  3.30it/s]100%|██████████| 60/60 [00:22<00:00,  1.50it/s]100%|██████████| 60/60 [00:22<00:00,  2.64it/s]
2025-03-13 18:42:44,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:42:44
2025-03-13 18:44:14,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.6111 secs
2025-03-13 18:44:14,335 [INFO]: The best hyperparameters are: efSearch=95
2025-03-13 18:44:14,336 [INFO]: 	Compute fast metrics 03/13/2025, 18:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-13 18:45:17,763 [INFO]: 	>>> Finished "Compute fast metrics" in 63.4269 secs
2025-03-13 18:45:17,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 175.8133 secs
2025-03-13 18:45:17,766 [INFO]: {
2025-03-13 18:45:17,766 [INFO]: 	index_key: HNSW32
2025-03-13 18:45:17,766 [INFO]: 	index_param: efSearch=95
2025-03-13 18:45:17,766 [INFO]: 	index_path: knn.index
2025-03-13 18:45:17,766 [INFO]: 	size in bytes: 2872087602
2025-03-13 18:45:17,766 [INFO]: 	avg_search_speed_ms: 10.328629649434747
2025-03-13 18:45:17,766 [INFO]: 	99p_search_speed_ms: 17.375388320069764
2025-03-13 18:45:17,766 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:45:17,766 [INFO]: 	nb vectors: 14588
2025-03-13 18:45:17,766 [INFO]: 	vectors dimension: 49152
2025-03-13 18:45:17,766 [INFO]: 	compression ratio: 0.9986176960628793
2025-03-13 18:45:17,766 [INFO]: }
2025-03-13 18:45:17,766 [INFO]: 	>>> Finished "Creating the index" in 175.8151 secs
2025-03-13 18:45:17,766 [INFO]: >>> Finished "Launching the whole pipeline" in 175.8420 secs
2025-03-13 18:45:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:45:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 13052 [episode count 19/20]
2025-03-13 18:45:25: [retrieval_preprocessing] finished for 3423129689_fold_towel [chosen_id count 7/196]
2025-03-13 18:45:26: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3452853472_put_tape_in_drawer [chosen_id count 8/196]
2025-03-13 18:45:26: [retrieval_preprocessing] we have num_total=3943 embedding_dim=49152
[retrieval_preprocessing] for episode 93188 [episode count 0/20], we have num_retrieval=np.int64(3738) num_query=np.int64(205)
2025-03-13 18:45:27,082 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:45:27,578 [INFO]: Launching the whole pipeline 03/13/2025, 18:45:27
2025-03-13 18:45:27,578 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:45:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2064.13it/s]
2025-03-13 18:45:27,602 [INFO]: There are 3738 embeddings of dim 49152
2025-03-13 18:45:27,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 18:45:27,602 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:45:27
2025-03-13 18:45:27,602 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:45:27,602 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:45:27,602 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:45:27,602 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:45:27,602 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:45:27
2025-03-13 18:45:27,603 [INFO]: 771.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:45:27,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:45:27,603 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:45:27
2025-03-13 18:45:27,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:45:27,603 [INFO]: 	Creating the index 03/13/2025, 18:45:27
2025-03-13 18:45:27,603 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:45:27
2025-03-13 18:45:27,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:45:27,604 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:45:27
2025-03-13 18:45:27,604 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:45:27,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.42it/s] 40%|████      | 6/15 [00:00<00:00, 28.66it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.84it/s]100%|██████████| 15/15 [00:03<00:00,  3.62it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 18:45:30,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:45:30
2025-03-13 18:46:14,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6607 secs
2025-03-13 18:46:14,283 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 18:46:14,283 [INFO]: 	Compute fast metrics 03/13/2025, 18:46:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.02it/s]
2025-03-13 18:46:33,034 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7506 secs
2025-03-13 18:46:33,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4321 secs
2025-03-13 18:46:33,036 [INFO]: {
2025-03-13 18:46:33,036 [INFO]: 	index_key: HNSW15
2025-03-13 18:46:33,036 [INFO]: 	index_param: efSearch=225
2025-03-13 18:46:33,036 [INFO]: 	index_path: knn.index
2025-03-13 18:46:33,036 [INFO]: 	size in bytes: 735428770
2025-03-13 18:46:33,036 [INFO]: 	avg_search_speed_ms: 9.269225820243028
2025-03-13 18:46:33,036 [INFO]: 	99p_search_speed_ms: 13.066173992119731
2025-03-13 18:46:33,036 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:46:33,036 [INFO]: 	nb vectors: 3738
2025-03-13 18:46:33,036 [INFO]: 	vectors dimension: 49152
2025-03-13 18:46:33,036 [INFO]: 	compression ratio: 0.9993091567521896
2025-03-13 18:46:33,036 [INFO]: }
2025-03-13 18:46:33,036 [INFO]: 	>>> Finished "Creating the index" in 65.4336 secs
2025-03-13 18:46:33,036 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4583 secs
2025-03-13 18:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 93188 [episode count 0/20]
[retrieval_preprocessing] for episode 33799 [episode count 1/20], we have num_retrieval=np.int64(3737) num_query=np.int64(206)
2025-03-13 18:46:34,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:46:35,777 [INFO]: Launching the whole pipeline 03/13/2025, 18:46:35
2025-03-13 18:46:35,777 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:46:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2235.77it/s]
2025-03-13 18:46:35,800 [INFO]: There are 3737 embeddings of dim 49152
2025-03-13 18:46:35,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-13 18:46:35,800 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:46:35
2025-03-13 18:46:35,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:46:35,800 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:46:35,801 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:46:35,801 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:46:35,801 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:46:35
2025-03-13 18:46:35,801 [INFO]: 771.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:46:35,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:46:35,801 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:46:35
2025-03-13 18:46:35,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:46:35,801 [INFO]: 	Creating the index 03/13/2025, 18:46:35
2025-03-13 18:46:35,801 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:46:35
2025-03-13 18:46:35,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 18:46:35,802 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:46:35
2025-03-13 18:46:35,802 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:46:35,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.27it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.19it/s] 87%|████████▋ | 13/15 [00:00<00:00, 43.12it/s]100%|██████████| 15/15 [00:02<00:00,  5.16it/s]
2025-03-13 18:46:38,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:46:38
2025-03-13 18:47:15,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1451 secs
2025-03-13 18:47:15,860 [INFO]: The best hyperparameters are: efSearch=183
2025-03-13 18:47:15,860 [INFO]: 	Compute fast metrics 03/13/2025, 18:47:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-13 18:47:42,153 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2931 secs
2025-03-13 18:47:42,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3541 secs
2025-03-13 18:47:42,156 [INFO]: {
2025-03-13 18:47:42,156 [INFO]: 	index_key: HNSW15
2025-03-13 18:47:42,156 [INFO]: 	index_param: efSearch=183
2025-03-13 18:47:42,156 [INFO]: 	index_path: knn.index
2025-03-13 18:47:42,156 [INFO]: 	size in bytes: 735231970
2025-03-13 18:47:42,156 [INFO]: 	avg_search_speed_ms: 8.887483350311717
2025-03-13 18:47:42,156 [INFO]: 	99p_search_speed_ms: 12.037085797637701
2025-03-13 18:47:42,156 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:47:42,156 [INFO]: 	nb vectors: 3737
2025-03-13 18:47:42,156 [INFO]: 	vectors dimension: 49152
2025-03-13 18:47:42,156 [INFO]: 	compression ratio: 0.9993092329758185
2025-03-13 18:47:42,156 [INFO]: }
2025-03-13 18:47:42,156 [INFO]: 	>>> Finished "Creating the index" in 66.3554 secs
2025-03-13 18:47:42,156 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3796 secs
2025-03-13 18:47:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:47:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 33799 [episode count 1/20]
[retrieval_preprocessing] for episode 42504 [episode count 2/20], we have num_retrieval=np.int64(3760) num_query=np.int64(183)
2025-03-13 18:47:44,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:47:44,561 [INFO]: Launching the whole pipeline 03/13/2025, 18:47:44
2025-03-13 18:47:44,561 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:47:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1070.52it/s]
2025-03-13 18:47:44,589 [INFO]: There are 3760 embeddings of dim 49152
2025-03-13 18:47:44,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:47:44,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:47:44
2025-03-13 18:47:44,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:47:44,590 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:47:44,590 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:47:44,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 18:47:44,590 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:47:44
2025-03-13 18:47:44,590 [INFO]: 776.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:47:44,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:47:44,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:47:44
2025-03-13 18:47:44,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:47:44,590 [INFO]: 	Creating the index 03/13/2025, 18:47:44
2025-03-13 18:47:44,590 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:47:44
2025-03-13 18:47:44,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 18:47:44,592 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:47:44
2025-03-13 18:47:44,592 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:47:44,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.21it/s] 40%|████      | 6/15 [00:00<00:00, 31.37it/s] 73%|███████▎  | 11/15 [00:00<00:00, 39.32it/s]100%|██████████| 15/15 [00:03<00:00,  3.19it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 18:47:47,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:47:47
2025-03-13 18:48:27,364 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3867 secs
2025-03-13 18:48:27,365 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 18:48:27,365 [INFO]: 	Compute fast metrics 03/13/2025, 18:48:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-13 18:48:52,853 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4884 secs
2025-03-13 18:48:53,177 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5853 secs
2025-03-13 18:48:53,177 [INFO]: {
2025-03-13 18:48:53,178 [INFO]: 	index_key: HNSW15
2025-03-13 18:48:53,178 [INFO]: 	index_param: efSearch=184
2025-03-13 18:48:53,178 [INFO]: 	index_path: knn.index
2025-03-13 18:48:53,178 [INFO]: 	size in bytes: 739757170
2025-03-13 18:48:53,178 [INFO]: 	avg_search_speed_ms: 8.323675253197624
2025-03-13 18:48:53,178 [INFO]: 	99p_search_speed_ms: 10.941261413972825
2025-03-13 18:48:53,178 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:48:53,178 [INFO]: 	nb vectors: 3760
2025-03-13 18:48:53,178 [INFO]: 	vectors dimension: 49152
2025-03-13 18:48:53,178 [INFO]: 	compression ratio: 0.9993091111235867
2025-03-13 18:48:53,178 [INFO]: }
2025-03-13 18:48:53,178 [INFO]: 	>>> Finished "Creating the index" in 68.5877 secs
2025-03-13 18:48:53,178 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6170 secs
2025-03-13 18:48:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:48:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 42504 [episode count 2/20]
[retrieval_preprocessing] for episode 91148 [episode count 3/20], we have num_retrieval=np.int64(3742) num_query=np.int64(201)
2025-03-13 18:48:55,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:48:55,705 [INFO]: Launching the whole pipeline 03/13/2025, 18:48:55
2025-03-13 18:48:55,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:48:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1216.09it/s]
2025-03-13 18:48:55,733 [INFO]: There are 3742 embeddings of dim 49152
2025-03-13 18:48:55,734 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 18:48:55,734 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:48:55
2025-03-13 18:48:55,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:48:55,734 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:48:55,734 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:48:55,734 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:48:55,734 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:48:55
2025-03-13 18:48:55,734 [INFO]: 772.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:48:55,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:48:55,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:48:55
2025-03-13 18:48:55,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:48:55,734 [INFO]: 	Creating the index 03/13/2025, 18:48:55
2025-03-13 18:48:55,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:48:55
2025-03-13 18:48:55,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:48:55,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:48:55
2025-03-13 18:48:55,736 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:48:55,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.79it/s] 40%|████      | 6/15 [00:00<00:00, 29.62it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.74it/s]100%|██████████| 15/15 [00:03<00:00,  3.59it/s]100%|██████████| 15/15 [00:03<00:00,  4.94it/s]
2025-03-13 18:48:58,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:48:58
2025-03-13 18:49:33,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3901 secs
2025-03-13 18:49:33,169 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 18:49:33,169 [INFO]: 	Compute fast metrics 03/13/2025, 18:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.01it/s]
2025-03-13 18:50:02,437 [INFO]: 	>>> Finished "Compute fast metrics" in 29.2682 secs
2025-03-13 18:50:02,511 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7757 secs
2025-03-13 18:50:02,512 [INFO]: {
2025-03-13 18:50:02,512 [INFO]: 	index_key: HNSW15
2025-03-13 18:50:02,512 [INFO]: 	index_param: efSearch=233
2025-03-13 18:50:02,512 [INFO]: 	index_path: knn.index
2025-03-13 18:50:02,512 [INFO]: 	size in bytes: 736215730
2025-03-13 18:50:02,512 [INFO]: 	avg_search_speed_ms: 12.610441360336084
2025-03-13 18:50:02,512 [INFO]: 	99p_search_speed_ms: 17.782441508024935
2025-03-13 18:50:02,512 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:50:02,512 [INFO]: 	nb vectors: 3742
2025-03-13 18:50:02,512 [INFO]: 	vectors dimension: 49152
2025-03-13 18:50:02,512 [INFO]: 	compression ratio: 0.9993091780312817
2025-03-13 18:50:02,512 [INFO]: }
2025-03-13 18:50:02,512 [INFO]: 	>>> Finished "Creating the index" in 66.7782 secs
2025-03-13 18:50:02,512 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8073 secs
2025-03-13 18:50:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:50:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 91148 [episode count 3/20]
[retrieval_preprocessing] for episode 61972 [episode count 4/20], we have num_retrieval=np.int64(3755) num_query=np.int64(188)
2025-03-13 18:50:05,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:50:05,634 [INFO]: Launching the whole pipeline 03/13/2025, 18:50:05
2025-03-13 18:50:05,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:50:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 18:50:05,661 [INFO]: There are 3755 embeddings of dim 49152
2025-03-13 18:50:05,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 18:50:05,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:50:05
2025-03-13 18:50:05,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:50:05,662 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:50:05,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:50:05,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:50:05,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:50:05
2025-03-13 18:50:05,662 [INFO]: 774.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:50:05,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:50:05,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:50:05
2025-03-13 18:50:05,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:50:05,662 [INFO]: 	Creating the index 03/13/2025, 18:50:05
2025-03-13 18:50:05,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:50:05
2025-03-13 18:50:05,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:50:05,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:50:05
2025-03-13 18:50:05,663 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:50:05,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.55it/s] 40%|████      | 6/15 [00:00<00:00, 27.31it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.81it/s]100%|██████████| 15/15 [00:04<00:00,  2.39it/s]100%|██████████| 15/15 [00:04<00:00,  3.34it/s]
2025-03-13 18:50:10,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:50:10
2025-03-13 18:50:48,947 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7934 secs
2025-03-13 18:50:48,948 [INFO]: The best hyperparameters are: efSearch=206
2025-03-13 18:50:48,948 [INFO]: 	Compute fast metrics 03/13/2025, 18:50:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.83it/s]
2025-03-13 18:51:10,483 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5346 secs
2025-03-13 18:51:10,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8229 secs
2025-03-13 18:51:10,486 [INFO]: {
2025-03-13 18:51:10,486 [INFO]: 	index_key: HNSW15
2025-03-13 18:51:10,486 [INFO]: 	index_param: efSearch=206
2025-03-13 18:51:10,486 [INFO]: 	index_path: knn.index
2025-03-13 18:51:10,486 [INFO]: 	size in bytes: 738773470
2025-03-13 18:51:10,487 [INFO]: 	avg_search_speed_ms: 11.809675783301575
2025-03-13 18:51:10,487 [INFO]: 	99p_search_speed_ms: 23.45073843374846
2025-03-13 18:51:10,487 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:51:10,487 [INFO]: 	nb vectors: 3755
2025-03-13 18:51:10,487 [INFO]: 	vectors dimension: 49152
2025-03-13 18:51:10,487 [INFO]: 	compression ratio: 0.9993090845560548
2025-03-13 18:51:10,487 [INFO]: }
2025-03-13 18:51:10,487 [INFO]: 	>>> Finished "Creating the index" in 64.8244 secs
2025-03-13 18:51:10,487 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8527 secs
2025-03-13 18:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 61972 [episode count 4/20]
[retrieval_preprocessing] for episode 77338 [episode count 5/20], we have num_retrieval=np.int64(3784) num_query=np.int64(159)
2025-03-13 18:51:13,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:51:13,964 [INFO]: Launching the whole pipeline 03/13/2025, 18:51:13
2025-03-13 18:51:13,965 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:51:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.44it/s]100%|██████████| 1/1 [00:00<00:00,  1.44it/s]
2025-03-13 18:51:14,692 [INFO]: There are 3784 embeddings of dim 49152
2025-03-13 18:51:14,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7280 secs
2025-03-13 18:51:14,693 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:51:14
2025-03-13 18:51:14,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:51:14,693 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:51:14,693 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:51:14,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:51:14,693 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:51:14
2025-03-13 18:51:14,694 [INFO]: 780.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:51:14,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:51:14,694 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:51:14
2025-03-13 18:51:14,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:51:14,694 [INFO]: 	Creating the index 03/13/2025, 18:51:14
2025-03-13 18:51:14,694 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:51:14
2025-03-13 18:51:14,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:51:14,698 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:51:14
2025-03-13 18:51:14,698 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:51:14,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.64it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.06it/s] 20%|██        | 3/15 [00:00<00:01,  7.67it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.00it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.11it/s] 40%|████      | 6/15 [00:00<00:01,  8.11it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.11it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.18it/s] 60%|██████    | 9/15 [00:01<00:00,  8.06it/s] 67%|██████▋   | 10/15 [00:01<00:00,  6.58it/s] 73%|███████▎  | 11/15 [00:01<00:00,  6.88it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.40it/s]100%|██████████| 15/15 [00:04<00:00,  1.43it/s]100%|██████████| 15/15 [00:04<00:00,  3.12it/s]
2025-03-13 18:51:19,525 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:51:19
2025-03-13 18:51:58,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9826 secs
2025-03-13 18:51:58,509 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 18:51:58,509 [INFO]: 	Compute fast metrics 03/13/2025, 18:51:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-13 18:52:22,686 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1769 secs
2025-03-13 18:52:22,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9916 secs
2025-03-13 18:52:22,689 [INFO]: {
2025-03-13 18:52:22,689 [INFO]: 	index_key: HNSW15
2025-03-13 18:52:22,689 [INFO]: 	index_param: efSearch=226
2025-03-13 18:52:22,689 [INFO]: 	index_path: knn.index
2025-03-13 18:52:22,689 [INFO]: 	size in bytes: 744478930
2025-03-13 18:52:22,689 [INFO]: 	avg_search_speed_ms: 10.726533769275534
2025-03-13 18:52:22,690 [INFO]: 	99p_search_speed_ms: 17.017494942992922
2025-03-13 18:52:22,690 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:52:22,690 [INFO]: 	nb vectors: 3784
2025-03-13 18:52:22,690 [INFO]: 	vectors dimension: 49152
2025-03-13 18:52:22,690 [INFO]: 	compression ratio: 0.9993092376704334
2025-03-13 18:52:22,690 [INFO]: }
2025-03-13 18:52:22,690 [INFO]: 	>>> Finished "Creating the index" in 67.9953 secs
2025-03-13 18:52:22,690 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7250 secs
2025-03-13 18:52:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:52:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 77338 [episode count 5/20]
[retrieval_preprocessing] for episode 63009 [episode count 6/20], we have num_retrieval=np.int64(3749) num_query=np.int64(194)
2025-03-13 18:52:25,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:52:26,479 [INFO]: Launching the whole pipeline 03/13/2025, 18:52:26
2025-03-13 18:52:26,479 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:52:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.09it/s]
2025-03-13 18:52:26,507 [INFO]: There are 3749 embeddings of dim 49152
2025-03-13 18:52:26,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-13 18:52:26,507 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:52:26
2025-03-13 18:52:26,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:52:26,508 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:52:26,508 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:52:26,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:52:26,508 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:52:26
2025-03-13 18:52:26,508 [INFO]: 773.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:52:26,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 18:52:26,508 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:52:26
2025-03-13 18:52:26,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:52:26,508 [INFO]: 	Creating the index 03/13/2025, 18:52:26
2025-03-13 18:52:26,508 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:52:26
2025-03-13 18:52:26,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 18:52:26,510 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:52:26
2025-03-13 18:52:26,510 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:52:26,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.02it/s] 20%|██        | 3/15 [00:00<00:01,  8.71it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.61it/s] 40%|████      | 6/15 [00:00<00:00,  9.38it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.19it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.07it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.69it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.50it/s] 80%|████████  | 12/15 [00:01<00:00,  9.29it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.13it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.08it/s]100%|██████████| 15/15 [00:04<00:00,  1.12it/s]100%|██████████| 15/15 [00:04<00:00,  3.40it/s]
2025-03-13 18:52:30,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:52:30
2025-03-13 18:53:08,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0378 secs
2025-03-13 18:53:08,970 [INFO]: The best hyperparameters are: efSearch=200
2025-03-13 18:53:08,970 [INFO]: 	Compute fast metrics 03/13/2025, 18:53:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-13 18:53:27,127 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1564 secs
2025-03-13 18:53:27,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6194 secs
2025-03-13 18:53:27,130 [INFO]: {
2025-03-13 18:53:27,130 [INFO]: 	index_key: HNSW15
2025-03-13 18:53:27,130 [INFO]: 	index_param: efSearch=200
2025-03-13 18:53:27,130 [INFO]: 	index_path: knn.index
2025-03-13 18:53:27,130 [INFO]: 	size in bytes: 737592910
2025-03-13 18:53:27,130 [INFO]: 	avg_search_speed_ms: 9.512850596701512
2025-03-13 18:53:27,130 [INFO]: 	99p_search_speed_ms: 13.683420373126864
2025-03-13 18:53:27,130 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:53:27,130 [INFO]: 	nb vectors: 3749
2025-03-13 18:53:27,130 [INFO]: 	vectors dimension: 49152
2025-03-13 18:53:27,130 [INFO]: 	compression ratio: 0.9993092151604331
2025-03-13 18:53:27,130 [INFO]: }
2025-03-13 18:53:27,130 [INFO]: 	>>> Finished "Creating the index" in 60.6217 secs
2025-03-13 18:53:27,130 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6506 secs
2025-03-13 18:53:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:53:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 63009 [episode count 6/20]
[retrieval_preprocessing] for episode 24691 [episode count 7/20], we have num_retrieval=np.int64(3773) num_query=np.int64(170)
2025-03-13 18:53:29,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:53:30,127 [INFO]: Launching the whole pipeline 03/13/2025, 18:53:30
2025-03-13 18:53:30,128 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:53:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.98it/s]
2025-03-13 18:53:30,155 [INFO]: There are 3773 embeddings of dim 49152
2025-03-13 18:53:30,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 18:53:30,155 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:53:30
2025-03-13 18:53:30,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:53:30,156 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:53:30,156 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:53:30,156 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 18:53:30,156 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:53:30
2025-03-13 18:53:30,156 [INFO]: 778.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:53:30,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:53:30,157 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:53:30
2025-03-13 18:53:30,157 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:53:30,157 [INFO]: 	Creating the index 03/13/2025, 18:53:30
2025-03-13 18:53:30,157 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:53:30
2025-03-13 18:53:30,160 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 18:53:30,160 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:53:30
2025-03-13 18:53:30,160 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:53:30,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.16it/s] 20%|██        | 3/15 [00:00<00:01,  9.28it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.99it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.96it/s] 60%|██████    | 9/15 [00:00<00:00, 12.52it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.57it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.84it/s]100%|██████████| 15/15 [00:04<00:00,  1.90it/s]100%|██████████| 15/15 [00:04<00:00,  3.72it/s]
2025-03-13 18:53:34,194 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:53:34
2025-03-13 18:54:15,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4138 secs
2025-03-13 18:54:15,609 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:54:15,609 [INFO]: 	Compute fast metrics 03/13/2025, 18:54:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-13 18:54:40,261 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6526 secs
2025-03-13 18:54:40,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2900 secs
2025-03-13 18:54:40,451 [INFO]: {
2025-03-13 18:54:40,451 [INFO]: 	index_key: HNSW15
2025-03-13 18:54:40,451 [INFO]: 	index_param: efSearch=224
2025-03-13 18:54:40,451 [INFO]: 	index_path: knn.index
2025-03-13 18:54:40,451 [INFO]: 	size in bytes: 742314790
2025-03-13 18:54:40,451 [INFO]: 	avg_search_speed_ms: 10.611106442585825
2025-03-13 18:54:40,451 [INFO]: 	99p_search_speed_ms: 19.60909732151777
2025-03-13 18:54:40,451 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:54:40,451 [INFO]: 	nb vectors: 3773
2025-03-13 18:54:40,451 [INFO]: 	vectors dimension: 49152
2025-03-13 18:54:40,451 [INFO]: 	compression ratio: 0.9993091798696345
2025-03-13 18:54:40,451 [INFO]: }
2025-03-13 18:54:40,451 [INFO]: 	>>> Finished "Creating the index" in 70.2944 secs
2025-03-13 18:54:40,452 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3240 secs
2025-03-13 18:54:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:54:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 24691 [episode count 7/20]
[retrieval_preprocessing] for episode 1653 [episode count 8/20], we have num_retrieval=np.int64(3714) num_query=np.int64(229)
2025-03-13 18:54:43,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:54:43,973 [INFO]: Launching the whole pipeline 03/13/2025, 18:54:43
2025-03-13 18:54:43,973 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:54:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.75it/s]
2025-03-13 18:54:44,002 [INFO]: There are 3714 embeddings of dim 49152
2025-03-13 18:54:44,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 18:54:44,002 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:54:44
2025-03-13 18:54:44,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:54:44,003 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:54:44,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:54:44,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 18:54:44,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:54:44
2025-03-13 18:54:44,003 [INFO]: 766.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:54:44,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:54:44,004 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:54:44
2025-03-13 18:54:44,004 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:54:44,004 [INFO]: 	Creating the index 03/13/2025, 18:54:44
2025-03-13 18:54:44,004 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:54:44
2025-03-13 18:54:44,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:54:44,007 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:54:44
2025-03-13 18:54:44,007 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:54:44,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.64it/s] 20%|██        | 3/15 [00:00<00:01, 10.72it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.25it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.09it/s] 60%|██████    | 9/15 [00:00<00:00, 14.19it/s] 73%|███████▎  | 11/15 [00:00<00:00, 14.67it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.97it/s]100%|██████████| 15/15 [00:03<00:00,  2.04it/s]100%|██████████| 15/15 [00:03<00:00,  4.04it/s]
2025-03-13 18:54:47,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:54:47
2025-03-13 18:55:22,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9786 secs
2025-03-13 18:55:22,709 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 18:55:22,709 [INFO]: 	Compute fast metrics 03/13/2025, 18:55:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-13 18:55:41,356 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6467 secs
2025-03-13 18:55:41,359 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3511 secs
2025-03-13 18:55:41,359 [INFO]: {
2025-03-13 18:55:41,359 [INFO]: 	index_key: HNSW15
2025-03-13 18:55:41,359 [INFO]: 	index_param: efSearch=151
2025-03-13 18:55:41,359 [INFO]: 	index_path: knn.index
2025-03-13 18:55:41,359 [INFO]: 	size in bytes: 730706710
2025-03-13 18:55:41,359 [INFO]: 	avg_search_speed_ms: 7.134550323805502
2025-03-13 18:55:41,359 [INFO]: 	99p_search_speed_ms: 13.661294444464147
2025-03-13 18:55:41,359 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:55:41,359 [INFO]: 	nb vectors: 3714
2025-03-13 18:55:41,359 [INFO]: 	vectors dimension: 49152
2025-03-13 18:55:41,359 [INFO]: 	compression ratio: 0.9993094383928677
2025-03-13 18:55:41,359 [INFO]: }
2025-03-13 18:55:41,359 [INFO]: 	>>> Finished "Creating the index" in 57.3548 secs
2025-03-13 18:55:41,359 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3863 secs
2025-03-13 18:55:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:55:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 1653 [episode count 8/20]
[retrieval_preprocessing] for episode 90238 [episode count 9/20], we have num_retrieval=np.int64(3735) num_query=np.int64(208)
2025-03-13 18:55:44,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:55:44,727 [INFO]: Launching the whole pipeline 03/13/2025, 18:55:44
2025-03-13 18:55:44,727 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:55:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 844.94it/s]
2025-03-13 18:55:44,757 [INFO]: There are 3735 embeddings of dim 49152
2025-03-13 18:55:44,757 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-13 18:55:44,757 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:55:44
2025-03-13 18:55:44,758 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:55:44,758 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 18:55:44,758 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:55:44,758 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 18:55:44,758 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:55:44
2025-03-13 18:55:44,758 [INFO]: 770.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:55:44,759 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 18:55:44,759 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:55:44
2025-03-13 18:55:44,759 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:55:44,759 [INFO]: 	Creating the index 03/13/2025, 18:55:44
2025-03-13 18:55:44,759 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:55:44
2025-03-13 18:55:44,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 18:55:44,762 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:55:44
2025-03-13 18:55:44,763 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:55:44,763 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.53it/s] 20%|██        | 3/15 [00:00<00:01, 10.09it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.23it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.66it/s] 60%|██████    | 9/15 [00:00<00:00, 11.98it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.09it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.06it/s]100%|██████████| 15/15 [00:04<00:00,  1.81it/s]100%|██████████| 15/15 [00:04<00:00,  3.57it/s]
2025-03-13 18:55:48,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:55:48
2025-03-13 18:56:21,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9460 secs
2025-03-13 18:56:21,920 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 18:56:21,920 [INFO]: 	Compute fast metrics 03/13/2025, 18:56:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-13 18:56:46,408 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4870 secs
2025-03-13 18:56:46,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6480 secs
2025-03-13 18:56:46,411 [INFO]: {
2025-03-13 18:56:46,411 [INFO]: 	index_key: HNSW15
2025-03-13 18:56:46,411 [INFO]: 	index_param: efSearch=208
2025-03-13 18:56:46,411 [INFO]: 	index_path: knn.index
2025-03-13 18:56:46,411 [INFO]: 	size in bytes: 734838490
2025-03-13 18:56:46,411 [INFO]: 	avg_search_speed_ms: 9.58613921443495
2025-03-13 18:56:46,411 [INFO]: 	99p_search_speed_ms: 15.268832608126088
2025-03-13 18:56:46,411 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:56:46,411 [INFO]: 	nb vectors: 3735
2025-03-13 18:56:46,411 [INFO]: 	vectors dimension: 49152
2025-03-13 18:56:46,411 [INFO]: 	compression ratio: 0.9993092223571468
2025-03-13 18:56:46,411 [INFO]: }
2025-03-13 18:56:46,411 [INFO]: 	>>> Finished "Creating the index" in 61.6515 secs
2025-03-13 18:56:46,411 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6835 secs
2025-03-13 18:56:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:56:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 90238 [episode count 9/20]
[retrieval_preprocessing] for episode 49808 [episode count 10/20], we have num_retrieval=np.int64(3696) num_query=np.int64(247)
2025-03-13 18:56:49,502 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:56:50,125 [INFO]: Launching the whole pipeline 03/13/2025, 18:56:50
2025-03-13 18:56:50,125 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:56:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1370.24it/s]
2025-03-13 18:56:50,150 [INFO]: There are 3696 embeddings of dim 49152
2025-03-13 18:56:50,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 18:56:50,150 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:56:50
2025-03-13 18:56:50,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:56:50,150 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:56:50,150 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:56:50,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:56:50,150 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:56:50
2025-03-13 18:56:50,150 [INFO]: 762.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:56:50,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 18:56:50,150 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:56:50
2025-03-13 18:56:50,151 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:56:50,151 [INFO]: 	Creating the index 03/13/2025, 18:56:50
2025-03-13 18:56:50,151 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:56:50
2025-03-13 18:56:50,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 18:56:50,152 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:56:50
2025-03-13 18:56:50,152 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:56:50,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.74it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.45it/s] 20%|██        | 3/15 [00:00<00:01,  8.38it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.51it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.04it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.77it/s] 60%|██████    | 9/15 [00:00<00:00,  9.48it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.19it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.96it/s] 80%|████████  | 12/15 [00:01<00:00,  8.80it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.68it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.70it/s]100%|██████████| 15/15 [00:04<00:00,  1.14it/s]100%|██████████| 15/15 [00:04<00:00,  3.51it/s]
2025-03-13 18:56:54,426 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:56:54
2025-03-13 18:57:29,448 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0218 secs
2025-03-13 18:57:29,448 [INFO]: The best hyperparameters are: efSearch=228
2025-03-13 18:57:29,448 [INFO]: 	Compute fast metrics 03/13/2025, 18:57:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.17it/s] 50%|█████     | 2/4 [00:00<00:00,  5.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.94it/s]
2025-03-13 18:57:53,284 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8357 secs
2025-03-13 18:57:53,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1354 secs
2025-03-13 18:57:53,287 [INFO]: {
2025-03-13 18:57:53,287 [INFO]: 	index_key: HNSW15
2025-03-13 18:57:53,287 [INFO]: 	index_param: efSearch=228
2025-03-13 18:57:53,287 [INFO]: 	index_path: knn.index
2025-03-13 18:57:53,287 [INFO]: 	size in bytes: 727165330
2025-03-13 18:57:53,287 [INFO]: 	avg_search_speed_ms: 10.2698992597402
2025-03-13 18:57:53,287 [INFO]: 	99p_search_speed_ms: 14.713132686447349
2025-03-13 18:57:53,287 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:57:53,288 [INFO]: 	nb vectors: 3696
2025-03-13 18:57:53,288 [INFO]: 	vectors dimension: 49152
2025-03-13 18:57:53,288 [INFO]: 	compression ratio: 0.9993094252719666
2025-03-13 18:57:53,288 [INFO]: }
2025-03-13 18:57:53,288 [INFO]: 	>>> Finished "Creating the index" in 63.1370 secs
2025-03-13 18:57:53,288 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1627 secs
2025-03-13 18:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:57:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 49808 [episode count 10/20]
[retrieval_preprocessing] for episode 30944 [episode count 11/20], we have num_retrieval=np.int64(3719) num_query=np.int64(224)
2025-03-13 18:57:57,220 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:57:57,970 [INFO]: Launching the whole pipeline 03/13/2025, 18:57:57
2025-03-13 18:57:57,970 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:57:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2099.25it/s]
2025-03-13 18:57:57,997 [INFO]: There are 3719 embeddings of dim 49152
2025-03-13 18:57:57,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 18:57:57,997 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:57:57
2025-03-13 18:57:57,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:57:57,998 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:57:57,998 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:57:57,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 18:57:57,998 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:57:57
2025-03-13 18:57:57,998 [INFO]: 767.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:57:57,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 18:57:57,999 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:57:57
2025-03-13 18:57:57,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 18:57:57,999 [INFO]: 	Creating the index 03/13/2025, 18:57:57
2025-03-13 18:57:57,999 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:57:57
2025-03-13 18:57:58,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 18:57:58,002 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:57:58
2025-03-13 18:57:58,003 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:57:58,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.90it/s] 20%|██        | 3/15 [00:00<00:01,  9.33it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.44it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.15it/s] 60%|██████    | 9/15 [00:00<00:00, 11.50it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.82it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.09it/s]100%|██████████| 15/15 [00:03<00:00,  2.05it/s]100%|██████████| 15/15 [00:03<00:00,  3.92it/s]
2025-03-13 18:58:01,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:58:01
2025-03-13 18:58:35,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1169 secs
2025-03-13 18:58:35,954 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 18:58:35,954 [INFO]: 	Compute fast metrics 03/13/2025, 18:58:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-13 18:59:03,487 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5323 secs
2025-03-13 18:59:03,489 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4870 secs
2025-03-13 18:59:03,490 [INFO]: {
2025-03-13 18:59:03,490 [INFO]: 	index_key: HNSW15
2025-03-13 18:59:03,490 [INFO]: 	index_param: efSearch=224
2025-03-13 18:59:03,490 [INFO]: 	index_path: knn.index
2025-03-13 18:59:03,490 [INFO]: 	size in bytes: 731690410
2025-03-13 18:59:03,490 [INFO]: 	avg_search_speed_ms: 9.535971739097677
2025-03-13 18:59:03,490 [INFO]: 	99p_search_speed_ms: 12.99310297705233
2025-03-13 18:59:03,490 [INFO]: 	reconstruction error %: 0.0
2025-03-13 18:59:03,490 [INFO]: 	nb vectors: 3719
2025-03-13 18:59:03,490 [INFO]: 	vectors dimension: 49152
2025-03-13 18:59:03,490 [INFO]: 	compression ratio: 0.9993094647775963
2025-03-13 18:59:03,490 [INFO]: }
2025-03-13 18:59:03,490 [INFO]: 	>>> Finished "Creating the index" in 65.4905 secs
2025-03-13 18:59:03,490 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5194 secs
2025-03-13 18:59:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 18:59:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 30944 [episode count 11/20]
[retrieval_preprocessing] for episode 67297 [episode count 12/20], we have num_retrieval=np.int64(3679) num_query=np.int64(264)
2025-03-13 18:59:06,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 18:59:07,493 [INFO]: Launching the whole pipeline 03/13/2025, 18:59:07
2025-03-13 18:59:07,493 [INFO]: Reading total number of vectors and dimension 03/13/2025, 18:59:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.14it/s]
2025-03-13 18:59:07,517 [INFO]: There are 3679 embeddings of dim 49152
2025-03-13 18:59:07,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 18:59:07,518 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 18:59:07
2025-03-13 18:59:07,518 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 18:59:07,518 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 18:59:07,518 [INFO]: 		Total: 16.7 minutes
2025-03-13 18:59:07,518 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 18:59:07,518 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 18:59:07
2025-03-13 18:59:07,518 [INFO]: 759.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 18:59:07,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 18:59:07,519 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 18:59:07
2025-03-13 18:59:07,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 18:59:07,519 [INFO]: 	Creating the index 03/13/2025, 18:59:07
2025-03-13 18:59:07,519 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 18:59:07
2025-03-13 18:59:07,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 18:59:07,520 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 18:59:07
2025-03-13 18:59:07,520 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 18:59:07,520 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:04,  3.35it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.34it/s] 20%|██        | 3/15 [00:00<00:01,  6.61it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.48it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.09it/s] 40%|████      | 6/15 [00:00<00:01,  8.47it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.86it/s] 60%|██████    | 9/15 [00:01<00:00,  9.42it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.96it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.27it/s]100%|██████████| 15/15 [00:04<00:00,  1.88it/s]100%|██████████| 15/15 [00:04<00:00,  3.56it/s]
2025-03-13 18:59:11,740 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 18:59:11
2025-03-13 18:59:44,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7583 secs
2025-03-13 18:59:44,499 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 18:59:44,499 [INFO]: 	Compute fast metrics 03/13/2025, 18:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 19:00:23,854 [INFO]: 	>>> Finished "Compute fast metrics" in 39.3540 secs
2025-03-13 19:00:23,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3782 secs
2025-03-13 19:00:23,899 [INFO]: {
2025-03-13 19:00:23,899 [INFO]: 	index_key: HNSW15
2025-03-13 19:00:23,899 [INFO]: 	index_param: efSearch=239
2025-03-13 19:00:23,899 [INFO]: 	index_path: knn.index
2025-03-13 19:00:23,899 [INFO]: 	size in bytes: 723820750
2025-03-13 19:00:23,899 [INFO]: 	avg_search_speed_ms: 10.58074211524356
2025-03-13 19:00:23,899 [INFO]: 	99p_search_speed_ms: 17.2435896564275
2025-03-13 19:00:23,899 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:00:23,899 [INFO]: 	nb vectors: 3679
2025-03-13 19:00:23,899 [INFO]: 	vectors dimension: 49152
2025-03-13 19:00:23,899 [INFO]: 	compression ratio: 0.99930933452792
2025-03-13 19:00:23,899 [INFO]: }
2025-03-13 19:00:23,899 [INFO]: 	>>> Finished "Creating the index" in 76.3800 secs
2025-03-13 19:00:23,899 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4058 secs
2025-03-13 19:00:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:00:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 67297 [episode count 12/20]
[retrieval_preprocessing] for episode 79086 [episode count 13/20], we have num_retrieval=np.int64(3714) num_query=np.int64(229)
2025-03-13 19:00:27,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:00:28,182 [INFO]: Launching the whole pipeline 03/13/2025, 19:00:28
2025-03-13 19:00:28,182 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:00:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.91it/s]
2025-03-13 19:00:28,218 [INFO]: There are 3714 embeddings of dim 49152
2025-03-13 19:00:28,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-13 19:00:28,219 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:00:28
2025-03-13 19:00:28,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:00:28,219 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:00:28,219 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:00:28,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:00:28,219 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:00:28
2025-03-13 19:00:28,219 [INFO]: 766.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:00:28,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:00:28,219 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:00:28
2025-03-13 19:00:28,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:00:28,220 [INFO]: 	Creating the index 03/13/2025, 19:00:28
2025-03-13 19:00:28,220 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:00:28
2025-03-13 19:00:28,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-13 19:00:28,222 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:00:28
2025-03-13 19:00:28,222 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:00:28,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.16it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.66it/s] 20%|██        | 3/15 [00:00<00:01,  7.35it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.84it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.95it/s] 40%|████      | 6/15 [00:00<00:01,  8.01it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.21it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.20it/s] 60%|██████    | 9/15 [00:01<00:00,  8.30it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.36it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.41it/s] 80%|████████  | 12/15 [00:01<00:00,  8.40it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.34it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.38it/s]100%|██████████| 15/15 [00:04<00:00,  1.02it/s]100%|██████████| 15/15 [00:04<00:00,  3.17it/s]
2025-03-13 19:00:33,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:00:33
2025-03-13 19:01:09,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8766 secs
2025-03-13 19:01:09,213 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 19:01:09,213 [INFO]: 	Compute fast metrics 03/13/2025, 19:01:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s]
2025-03-13 19:01:30,392 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1790 secs
2025-03-13 19:01:30,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1732 secs
2025-03-13 19:01:30,395 [INFO]: {
2025-03-13 19:01:30,395 [INFO]: 	index_key: HNSW15
2025-03-13 19:01:30,395 [INFO]: 	index_param: efSearch=236
2025-03-13 19:01:30,395 [INFO]: 	index_path: knn.index
2025-03-13 19:01:30,395 [INFO]: 	size in bytes: 730706710
2025-03-13 19:01:30,395 [INFO]: 	avg_search_speed_ms: 10.52518257307575
2025-03-13 19:01:30,395 [INFO]: 	99p_search_speed_ms: 18.955196670722213
2025-03-13 19:01:30,395 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:01:30,395 [INFO]: 	nb vectors: 3714
2025-03-13 19:01:30,395 [INFO]: 	vectors dimension: 49152
2025-03-13 19:01:30,395 [INFO]: 	compression ratio: 0.9993094383928677
2025-03-13 19:01:30,395 [INFO]: }
2025-03-13 19:01:30,395 [INFO]: 	>>> Finished "Creating the index" in 62.1757 secs
2025-03-13 19:01:30,395 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2134 secs
2025-03-13 19:01:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:01:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 79086 [episode count 13/20]
[retrieval_preprocessing] for episode 12024 [episode count 14/20], we have num_retrieval=np.int64(3757) num_query=np.int64(186)
2025-03-13 19:01:34,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:01:34,656 [INFO]: Launching the whole pipeline 03/13/2025, 19:01:34
2025-03-13 19:01:34,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:01:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.99it/s]
2025-03-13 19:01:34,682 [INFO]: There are 3757 embeddings of dim 49152
2025-03-13 19:01:34,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-13 19:01:34,682 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:01:34
2025-03-13 19:01:34,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:01:34,683 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 19:01:34,683 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:01:34,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:01:34,683 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:01:34
2025-03-13 19:01:34,683 [INFO]: 775.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:01:34,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 19:01:34,683 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:01:34
2025-03-13 19:01:34,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:01:34,683 [INFO]: 	Creating the index 03/13/2025, 19:01:34
2025-03-13 19:01:34,683 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:01:34
2025-03-13 19:01:34,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:01:34,684 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:01:34
2025-03-13 19:01:34,684 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:01:34,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.07it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.69it/s] 20%|██        | 3/15 [00:00<00:01,  7.09it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.36it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.00it/s] 40%|████      | 6/15 [00:00<00:01,  8.32it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.64it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.74it/s] 60%|██████    | 9/15 [00:01<00:00,  8.83it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.88it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.00it/s] 80%|████████  | 12/15 [00:01<00:00,  8.99it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.95it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.02it/s]100%|██████████| 15/15 [00:04<00:00,  1.01it/s]100%|██████████| 15/15 [00:04<00:00,  3.20it/s]
2025-03-13 19:01:39,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:01:39
2025-03-13 19:02:13,629 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7319 secs
2025-03-13 19:02:13,629 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 19:02:13,629 [INFO]: 	Compute fast metrics 03/13/2025, 19:02:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.68it/s]
2025-03-13 19:02:39,837 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2078 secs
2025-03-13 19:02:39,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1569 secs
2025-03-13 19:02:39,841 [INFO]: {
2025-03-13 19:02:39,841 [INFO]: 	index_key: HNSW15
2025-03-13 19:02:39,841 [INFO]: 	index_param: efSearch=190
2025-03-13 19:02:39,841 [INFO]: 	index_path: knn.index
2025-03-13 19:02:39,841 [INFO]: 	size in bytes: 739166950
2025-03-13 19:02:39,841 [INFO]: 	avg_search_speed_ms: 9.372574076904883
2025-03-13 19:02:39,841 [INFO]: 	99p_search_speed_ms: 12.577133602462702
2025-03-13 19:02:39,841 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:02:39,841 [INFO]: 	nb vectors: 3757
2025-03-13 19:02:39,841 [INFO]: 	vectors dimension: 49152
2025-03-13 19:02:39,841 [INFO]: 	compression ratio: 0.9993090951915531
2025-03-13 19:02:39,841 [INFO]: }
2025-03-13 19:02:39,841 [INFO]: 	>>> Finished "Creating the index" in 65.1584 secs
2025-03-13 19:02:39,842 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1857 secs
2025-03-13 19:02:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:02:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 12024 [episode count 14/20]
[retrieval_preprocessing] for episode 81736 [episode count 15/20], we have num_retrieval=np.int64(3762) num_query=np.int64(181)
2025-03-13 19:02:42,560 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:02:43,226 [INFO]: Launching the whole pipeline 03/13/2025, 19:02:43
2025-03-13 19:02:43,226 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:02:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 760.11it/s]
2025-03-13 19:02:43,263 [INFO]: There are 3762 embeddings of dim 49152
2025-03-13 19:02:43,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-13 19:02:43,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:02:43
2025-03-13 19:02:43,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:02:43,264 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 19:02:43,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:02:43,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:02:43,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:02:43
2025-03-13 19:02:43,264 [INFO]: 776.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:02:43,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:02:43,264 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:02:43
2025-03-13 19:02:43,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:02:43,265 [INFO]: 	Creating the index 03/13/2025, 19:02:43
2025-03-13 19:02:43,265 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:02:43
2025-03-13 19:02:43,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 19:02:43,268 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:02:43
2025-03-13 19:02:43,268 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:02:43,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.51it/s] 20%|██        | 3/15 [00:00<00:01,  9.39it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.57it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.07it/s] 60%|██████    | 9/15 [00:00<00:00, 11.04it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.61it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.56it/s]100%|██████████| 15/15 [00:04<00:00,  1.79it/s]100%|██████████| 15/15 [00:04<00:00,  3.47it/s]
2025-03-13 19:02:47,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:02:47
2025-03-13 19:03:22,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9158 secs
2025-03-13 19:03:22,520 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 19:03:22,520 [INFO]: 	Compute fast metrics 03/13/2025, 19:03:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-13 19:03:45,260 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7402 secs
2025-03-13 19:03:45,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9956 secs
2025-03-13 19:03:45,263 [INFO]: {
2025-03-13 19:03:45,263 [INFO]: 	index_key: HNSW15
2025-03-13 19:03:45,263 [INFO]: 	index_param: efSearch=241
2025-03-13 19:03:45,263 [INFO]: 	index_path: knn.index
2025-03-13 19:03:45,263 [INFO]: 	size in bytes: 740150650
2025-03-13 19:03:45,263 [INFO]: 	avg_search_speed_ms: 10.877327222814854
2025-03-13 19:03:45,263 [INFO]: 	99p_search_speed_ms: 16.30083452910185
2025-03-13 19:03:45,263 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:03:45,263 [INFO]: 	nb vectors: 3762
2025-03-13 19:03:45,263 [INFO]: 	vectors dimension: 49152
2025-03-13 19:03:45,263 [INFO]: 	compression ratio: 0.999309121730826
2025-03-13 19:03:45,264 [INFO]: }
2025-03-13 19:03:45,264 [INFO]: 	>>> Finished "Creating the index" in 61.9987 secs
2025-03-13 19:03:45,264 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0372 secs
2025-03-13 19:03:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:03:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 81736 [episode count 15/20]
[retrieval_preprocessing] for episode 68436 [episode count 16/20], we have num_retrieval=np.int64(3754) num_query=np.int64(189)
2025-03-13 19:03:47,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:03:48,210 [INFO]: Launching the whole pipeline 03/13/2025, 19:03:48
2025-03-13 19:03:48,210 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:03:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.65it/s]
2025-03-13 19:03:48,238 [INFO]: There are 3754 embeddings of dim 49152
2025-03-13 19:03:48,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 19:03:48,238 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:03:48
2025-03-13 19:03:48,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:03:48,238 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 19:03:48,238 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:03:48,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:03:48,238 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:03:48
2025-03-13 19:03:48,238 [INFO]: 774.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:03:48,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:03:48,238 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:03:48
2025-03-13 19:03:48,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:03:48,238 [INFO]: 	Creating the index 03/13/2025, 19:03:48
2025-03-13 19:03:48,238 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:03:48
2025-03-13 19:03:48,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:03:48,240 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:03:48
2025-03-13 19:03:48,240 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:03:48,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.33it/s] 40%|████      | 6/15 [00:00<00:00, 29.80it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.94it/s]100%|██████████| 15/15 [00:03<00:00,  3.31it/s]100%|██████████| 15/15 [00:03<00:00,  4.58it/s]
2025-03-13 19:03:51,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:03:51
2025-03-13 19:04:32,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8308 secs
2025-03-13 19:04:32,351 [INFO]: The best hyperparameters are: efSearch=184
2025-03-13 19:04:32,351 [INFO]: 	Compute fast metrics 03/13/2025, 19:04:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-13 19:04:56,992 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6410 secs
2025-03-13 19:04:56,995 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7551 secs
2025-03-13 19:04:56,995 [INFO]: {
2025-03-13 19:04:56,995 [INFO]: 	index_key: HNSW15
2025-03-13 19:04:56,995 [INFO]: 	index_param: efSearch=184
2025-03-13 19:04:56,995 [INFO]: 	index_path: knn.index
2025-03-13 19:04:56,995 [INFO]: 	size in bytes: 738576670
2025-03-13 19:04:56,995 [INFO]: 	avg_search_speed_ms: 9.106759919839249
2025-03-13 19:04:56,995 [INFO]: 	99p_search_speed_ms: 13.113199835643172
2025-03-13 19:04:56,995 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:04:56,995 [INFO]: 	nb vectors: 3754
2025-03-13 19:04:56,995 [INFO]: 	vectors dimension: 49152
2025-03-13 19:04:56,995 [INFO]: 	compression ratio: 0.999309160415262
2025-03-13 19:04:56,995 [INFO]: }
2025-03-13 19:04:56,995 [INFO]: 	>>> Finished "Creating the index" in 68.7569 secs
2025-03-13 19:04:56,995 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7850 secs
2025-03-13 19:04:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:04:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 68436 [episode count 16/20]
[retrieval_preprocessing] for episode 30549 [episode count 17/20], we have num_retrieval=np.int64(3720) num_query=np.int64(223)
2025-03-13 19:04:58,805 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:04:59,303 [INFO]: Launching the whole pipeline 03/13/2025, 19:04:59
2025-03-13 19:04:59,304 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:04:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-13 19:04:59,333 [INFO]: There are 3720 embeddings of dim 49152
2025-03-13 19:04:59,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 19:04:59,333 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:04:59
2025-03-13 19:04:59,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:04:59,333 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 19:04:59,333 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:04:59,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:04:59,333 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:04:59
2025-03-13 19:04:59,333 [INFO]: 767.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:04:59,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:04:59,334 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:04:59
2025-03-13 19:04:59,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:04:59,334 [INFO]: 	Creating the index 03/13/2025, 19:04:59
2025-03-13 19:04:59,334 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:04:59
2025-03-13 19:04:59,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-13 19:04:59,335 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:04:59
2025-03-13 19:04:59,336 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:04:59,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.48it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.65it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.10it/s]100%|██████████| 15/15 [00:02<00:00,  5.17it/s]
2025-03-13 19:05:02,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:05:02
2025-03-13 19:05:38,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8059 secs
2025-03-13 19:05:38,046 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 19:05:38,046 [INFO]: 	Compute fast metrics 03/13/2025, 19:05:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.94it/s]
2025-03-13 19:06:05,044 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9978 secs
2025-03-13 19:06:05,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7109 secs
2025-03-13 19:06:05,047 [INFO]: {
2025-03-13 19:06:05,047 [INFO]: 	index_key: HNSW15
2025-03-13 19:06:05,047 [INFO]: 	index_param: efSearch=221
2025-03-13 19:06:05,047 [INFO]: 	index_path: knn.index
2025-03-13 19:06:05,047 [INFO]: 	size in bytes: 731887150
2025-03-13 19:06:05,047 [INFO]: 	avg_search_speed_ms: 8.344851896588152
2025-03-13 19:06:05,047 [INFO]: 	99p_search_speed_ms: 11.760425795800982
2025-03-13 19:06:05,047 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:06:05,047 [INFO]: 	nb vectors: 3720
2025-03-13 19:06:05,047 [INFO]: 	vectors dimension: 49152
2025-03-13 19:06:05,047 [INFO]: 	compression ratio: 0.999309470046031
2025-03-13 19:06:05,047 [INFO]: }
2025-03-13 19:06:05,047 [INFO]: 	>>> Finished "Creating the index" in 65.7130 secs
2025-03-13 19:06:05,047 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7432 secs
2025-03-13 19:06:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:06:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 30549 [episode count 17/20]
[retrieval_preprocessing] for episode 60765 [episode count 18/20], we have num_retrieval=np.int64(3805) num_query=np.int64(138)
2025-03-13 19:06:07,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:06:07,650 [INFO]: Launching the whole pipeline 03/13/2025, 19:06:07
2025-03-13 19:06:07,650 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:06:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.54it/s]
2025-03-13 19:06:07,676 [INFO]: There are 3805 embeddings of dim 49152
2025-03-13 19:06:07,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 19:06:07,676 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:06:07
2025-03-13 19:06:07,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:06:07,676 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 19:06:07,676 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:06:07,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:06:07,676 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:06:07
2025-03-13 19:06:07,676 [INFO]: 785.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:06:07,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:06:07,676 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:06:07
2025-03-13 19:06:07,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:06:07,677 [INFO]: 	Creating the index 03/13/2025, 19:06:07
2025-03-13 19:06:07,677 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:06:07
2025-03-13 19:06:07,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:06:07,678 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:06:07
2025-03-13 19:06:07,678 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:06:07,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.94it/s] 53%|█████▎    | 8/15 [00:00<00:00, 39.73it/s]100%|██████████| 15/15 [00:02<00:00,  4.89it/s]100%|██████████| 15/15 [00:02<00:00,  5.71it/s]
2025-03-13 19:06:10,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:06:10
2025-03-13 19:06:48,091 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7798 secs
2025-03-13 19:06:48,091 [INFO]: The best hyperparameters are: efSearch=237
2025-03-13 19:06:48,091 [INFO]: 	Compute fast metrics 03/13/2025, 19:06:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-13 19:07:06,201 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1096 secs
2025-03-13 19:07:06,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5253 secs
2025-03-13 19:07:06,204 [INFO]: {
2025-03-13 19:07:06,204 [INFO]: 	index_key: HNSW15
2025-03-13 19:07:06,204 [INFO]: 	index_param: efSearch=237
2025-03-13 19:07:06,204 [INFO]: 	index_path: knn.index
2025-03-13 19:07:06,204 [INFO]: 	size in bytes: 748610650
2025-03-13 19:07:06,204 [INFO]: 	avg_search_speed_ms: 10.650347266643763
2025-03-13 19:07:06,204 [INFO]: 	99p_search_speed_ms: 14.396712468005717
2025-03-13 19:07:06,204 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:07:06,204 [INFO]: 	nb vectors: 3805
2025-03-13 19:07:06,204 [INFO]: 	vectors dimension: 49152
2025-03-13 19:07:06,204 [INFO]: 	compression ratio: 0.9993091068100621
2025-03-13 19:07:06,204 [INFO]: }
2025-03-13 19:07:06,204 [INFO]: 	>>> Finished "Creating the index" in 58.5270 secs
2025-03-13 19:07:06,204 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5533 secs
2025-03-13 19:07:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:07:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 60765 [episode count 18/20]
[retrieval_preprocessing] for episode 93031 [episode count 19/20], we have num_retrieval=np.int64(3824) num_query=np.int64(119)
2025-03-13 19:07:08,296 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:07:08,946 [INFO]: Launching the whole pipeline 03/13/2025, 19:07:08
2025-03-13 19:07:08,946 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:07:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.54it/s]
2025-03-13 19:07:08,973 [INFO]: There are 3824 embeddings of dim 49152
2025-03-13 19:07:08,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 19:07:08,973 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:07:08
2025-03-13 19:07:08,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:07:08,973 [INFO]: 		-> Add: 2.1 seconds
2025-03-13 19:07:08,973 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:07:08,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:07:08,974 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:07:08
2025-03-13 19:07:08,974 [INFO]: 789.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:07:08,974 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:07:08,974 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:07:08
2025-03-13 19:07:08,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:07:08,974 [INFO]: 	Creating the index 03/13/2025, 19:07:08
2025-03-13 19:07:08,974 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:07:08
2025-03-13 19:07:08,976 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:07:08,976 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:07:08
2025-03-13 19:07:08,976 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 19:07:08,976 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.92it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.18it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.35it/s]100%|██████████| 16/16 [00:03<00:00,  3.66it/s]100%|██████████| 16/16 [00:03<00:00,  4.91it/s]
2025-03-13 19:07:12,275 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:07:12
2025-03-13 19:07:47,817 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5411 secs
2025-03-13 19:07:47,817 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 19:07:47,817 [INFO]: 	Compute fast metrics 03/13/2025, 19:07:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.46it/s]
2025-03-13 19:08:21,415 [INFO]: 	>>> Finished "Compute fast metrics" in 33.5973 secs
2025-03-13 19:08:21,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4420 secs
2025-03-13 19:08:21,418 [INFO]: {
2025-03-13 19:08:21,418 [INFO]: 	index_key: HNSW15
2025-03-13 19:08:21,418 [INFO]: 	index_param: efSearch=274
2025-03-13 19:08:21,418 [INFO]: 	index_path: knn.index
2025-03-13 19:08:21,418 [INFO]: 	size in bytes: 752348830
2025-03-13 19:08:21,418 [INFO]: 	avg_search_speed_ms: 11.114944403525442
2025-03-13 19:08:21,418 [INFO]: 	99p_search_speed_ms: 17.22884250571951
2025-03-13 19:08:21,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:08:21,418 [INFO]: 	nb vectors: 3824
2025-03-13 19:08:21,418 [INFO]: 	vectors dimension: 49152
2025-03-13 19:08:21,418 [INFO]: 	compression ratio: 0.999309046576174
2025-03-13 19:08:21,418 [INFO]: }
2025-03-13 19:08:21,418 [INFO]: 	>>> Finished "Creating the index" in 72.4438 secs
2025-03-13 19:08:21,418 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4719 secs
2025-03-13 19:08:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:08:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 93031 [episode count 19/20]
2025-03-13 19:08:23: [retrieval_preprocessing] finished for 3452853472_put_tape_in_drawer [chosen_id count 8/196]
2025-03-13 19:08:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3485794757_marker_from_cup_to_table [chosen_id count 9/196]
2025-03-13 19:08:24: [retrieval_preprocessing] we have num_total=5042 embedding_dim=49152
[retrieval_preprocessing] for episode 33280 [episode count 0/20], we have num_retrieval=np.int64(4818) num_query=np.int64(224)
2025-03-13 19:08:25,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:08:26,747 [INFO]: Launching the whole pipeline 03/13/2025, 19:08:26
2025-03-13 19:08:26,747 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:08:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-13 19:08:26,776 [INFO]: There are 4818 embeddings of dim 49152
2025-03-13 19:08:26,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 19:08:26,776 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:08:26
2025-03-13 19:08:26,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:08:26,777 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:08:26,777 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:08:26,777 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:08:26,777 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:08:26
2025-03-13 19:08:26,777 [INFO]: 994.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:08:26,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:08:26,777 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:08:26
2025-03-13 19:08:26,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:08:26,777 [INFO]: 	Creating the index 03/13/2025, 19:08:26
2025-03-13 19:08:26,777 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:08:26
2025-03-13 19:08:26,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:08:26,778 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:08:26
2025-03-13 19:08:26,778 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:08:26,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.75it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.93it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.64it/s] 84%|████████▍ | 16/19 [00:00<00:00, 42.04it/s]100%|██████████| 19/19 [00:04<00:00,  3.83it/s]
2025-03-13 19:08:31,741 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:08:31
2025-03-13 19:09:19,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3137 secs
2025-03-13 19:09:19,056 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 19:09:19,056 [INFO]: 	Compute fast metrics 03/13/2025, 19:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.56it/s]
2025-03-13 19:09:43,107 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0509 secs
2025-03-13 19:09:43,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3312 secs
2025-03-13 19:09:43,110 [INFO]: {
2025-03-13 19:09:43,110 [INFO]: 	index_key: HNSW15
2025-03-13 19:09:43,110 [INFO]: 	index_param: efSearch=214
2025-03-13 19:09:43,110 [INFO]: 	index_path: knn.index
2025-03-13 19:09:43,110 [INFO]: 	size in bytes: 947912770
2025-03-13 19:09:43,110 [INFO]: 	avg_search_speed_ms: 10.660718251734592
2025-03-13 19:09:43,110 [INFO]: 	99p_search_speed_ms: 17.702368625905365
2025-03-13 19:09:43,110 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:09:43,110 [INFO]: 	nb vectors: 4818
2025-03-13 19:09:43,110 [INFO]: 	vectors dimension: 49152
2025-03-13 19:09:43,110 [INFO]: 	compression ratio: 0.9993085587400621
2025-03-13 19:09:43,110 [INFO]: }
2025-03-13 19:09:43,110 [INFO]: 	>>> Finished "Creating the index" in 76.3330 secs
2025-03-13 19:09:43,110 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3625 secs
2025-03-13 19:09:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:09:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 33280 [episode count 0/20]
[retrieval_preprocessing] for episode 2570 [episode count 1/20], we have num_retrieval=np.int64(4838) num_query=np.int64(204)
2025-03-13 19:09:45,171 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:09:45,780 [INFO]: Launching the whole pipeline 03/13/2025, 19:09:45
2025-03-13 19:09:45,780 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:09:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-13 19:09:45,810 [INFO]: There are 4838 embeddings of dim 49152
2025-03-13 19:09:45,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 19:09:45,811 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:09:45
2025-03-13 19:09:45,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:09:45,811 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 19:09:45,811 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:09:45,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:09:45,811 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:09:45
2025-03-13 19:09:45,812 [INFO]: 998.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:09:45,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:09:45,812 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:09:45
2025-03-13 19:09:45,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:09:45,812 [INFO]: 	Creating the index 03/13/2025, 19:09:45
2025-03-13 19:09:45,812 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:09:45
2025-03-13 19:09:45,815 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 19:09:45,815 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:09:45
2025-03-13 19:09:45,815 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:09:45,815 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.04it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.67it/s] 55%|█████▌    | 11/20 [00:00<00:00, 34.99it/s] 80%|████████  | 16/20 [00:00<00:00, 39.57it/s]100%|██████████| 20/20 [00:04<00:00,  2.87it/s]100%|██████████| 20/20 [00:04<00:00,  4.64it/s]
2025-03-13 19:09:50,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:09:50
2025-03-13 19:10:33,868 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7384 secs
2025-03-13 19:10:33,868 [INFO]: The best hyperparameters are: efSearch=242
2025-03-13 19:10:33,868 [INFO]: 	Compute fast metrics 03/13/2025, 19:10:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.47it/s]
2025-03-13 19:10:56,830 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9618 secs
2025-03-13 19:10:56,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0187 secs
2025-03-13 19:10:56,834 [INFO]: {
2025-03-13 19:10:56,834 [INFO]: 	index_key: HNSW15
2025-03-13 19:10:56,834 [INFO]: 	index_param: efSearch=242
2025-03-13 19:10:56,834 [INFO]: 	index_path: knn.index
2025-03-13 19:10:56,834 [INFO]: 	size in bytes: 951847570
2025-03-13 19:10:56,834 [INFO]: 	avg_search_speed_ms: 13.596002651826458
2025-03-13 19:10:56,834 [INFO]: 	99p_search_speed_ms: 20.875711226835847
2025-03-13 19:10:56,834 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:10:56,834 [INFO]: 	nb vectors: 4838
2025-03-13 19:10:56,834 [INFO]: 	vectors dimension: 49152
2025-03-13 19:10:56,834 [INFO]: 	compression ratio: 0.9993086435047578
2025-03-13 19:10:56,834 [INFO]: }
2025-03-13 19:10:56,834 [INFO]: 	>>> Finished "Creating the index" in 71.0217 secs
2025-03-13 19:10:56,834 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0536 secs
2025-03-13 19:10:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:10:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 2570 [episode count 1/20]
[retrieval_preprocessing] for episode 14353 [episode count 2/20], we have num_retrieval=np.int64(4781) num_query=np.int64(261)
2025-03-13 19:11:00,026 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:11:00,698 [INFO]: Launching the whole pipeline 03/13/2025, 19:11:00
2025-03-13 19:11:00,698 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:11:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1505.49it/s]
2025-03-13 19:11:00,723 [INFO]: There are 4781 embeddings of dim 49152
2025-03-13 19:11:00,723 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-13 19:11:00,723 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,723 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:11:00,723 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:11:00,723 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:11:00,723 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:11:00,723 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,723 [INFO]: 986.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:11:00,723 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:11:00,723 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:11:00
2025-03-13 19:11:00,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:11:00,724 [INFO]: 	Creating the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,724 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:11:00
2025-03-13 19:11:00,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:11:00,725 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:11:00
2025-03-13 19:11:00,725 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:11:00,725 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.76it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.52it/s] 58%|█████▊    | 11/19 [00:00<00:00, 39.24it/s] 84%|████████▍ | 16/19 [00:00<00:00, 42.48it/s]100%|██████████| 19/19 [00:04<00:00,  4.47it/s]
2025-03-13 19:11:04,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:11:04
2025-03-13 19:11:50,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7212 secs
2025-03-13 19:11:50,698 [INFO]: The best hyperparameters are: efSearch=216
2025-03-13 19:11:50,699 [INFO]: 	Compute fast metrics 03/13/2025, 19:11:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-13 19:12:11,507 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8086 secs
2025-03-13 19:12:11,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7856 secs
2025-03-13 19:12:11,510 [INFO]: {
2025-03-13 19:12:11,510 [INFO]: 	index_key: HNSW15
2025-03-13 19:12:11,510 [INFO]: 	index_param: efSearch=216
2025-03-13 19:12:11,510 [INFO]: 	index_path: knn.index
2025-03-13 19:12:11,510 [INFO]: 	size in bytes: 940633150
2025-03-13 19:12:11,510 [INFO]: 	avg_search_speed_ms: 10.73544003871817
2025-03-13 19:12:11,511 [INFO]: 	99p_search_speed_ms: 18.918231746647475
2025-03-13 19:12:11,511 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:12:11,511 [INFO]: 	nb vectors: 4781
2025-03-13 19:12:11,511 [INFO]: 	vectors dimension: 49152
2025-03-13 19:12:11,511 [INFO]: 	compression ratio: 0.9993086550266701
2025-03-13 19:12:11,511 [INFO]: }
2025-03-13 19:12:11,511 [INFO]: 	>>> Finished "Creating the index" in 70.7871 secs
2025-03-13 19:12:11,511 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8123 secs
2025-03-13 19:12:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:12:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 14353 [episode count 2/20]
[retrieval_preprocessing] for episode 51738 [episode count 3/20], we have num_retrieval=np.int64(4790) num_query=np.int64(252)
2025-03-13 19:12:14,176 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:12:14,833 [INFO]: Launching the whole pipeline 03/13/2025, 19:12:14
2025-03-13 19:12:14,833 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:12:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-13 19:12:14,864 [INFO]: There are 4790 embeddings of dim 49152
2025-03-13 19:12:14,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-13 19:12:14,865 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:12:14
2025-03-13 19:12:14,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:12:14,866 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:12:14,866 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:12:14,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 19:12:14,866 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:12:14
2025-03-13 19:12:14,866 [INFO]: 988.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:12:14,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:12:14,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:12:14
2025-03-13 19:12:14,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:12:14,867 [INFO]: 	Creating the index 03/13/2025, 19:12:14
2025-03-13 19:12:14,867 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:12:14
2025-03-13 19:12:14,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:12:14,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:12:14
2025-03-13 19:12:14,871 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:12:14,871 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 25.82it/s] 47%|████▋     | 9/19 [00:00<00:00, 42.83it/s] 79%|███████▉  | 15/19 [00:00<00:00, 48.56it/s]100%|██████████| 19/19 [00:03<00:00,  5.34it/s]
2025-03-13 19:12:18,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:12:18
2025-03-13 19:13:01,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9340 secs
2025-03-13 19:13:01,370 [INFO]: The best hyperparameters are: efSearch=197
2025-03-13 19:13:01,370 [INFO]: 	Compute fast metrics 03/13/2025, 19:13:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.92it/s]
2025-03-13 19:13:25,640 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2693 secs
2025-03-13 19:13:25,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7720 secs
2025-03-13 19:13:25,643 [INFO]: {
2025-03-13 19:13:25,643 [INFO]: 	index_key: HNSW15
2025-03-13 19:13:25,643 [INFO]: 	index_param: efSearch=197
2025-03-13 19:13:25,643 [INFO]: 	index_path: knn.index
2025-03-13 19:13:25,643 [INFO]: 	size in bytes: 942403810
2025-03-13 19:13:25,643 [INFO]: 	avg_search_speed_ms: 11.243187775573787
2025-03-13 19:13:25,643 [INFO]: 	99p_search_speed_ms: 18.649888280779123
2025-03-13 19:13:25,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:13:25,643 [INFO]: 	nb vectors: 4790
2025-03-13 19:13:25,643 [INFO]: 	vectors dimension: 49152
2025-03-13 19:13:25,643 [INFO]: 	compression ratio: 0.9993086933721119
2025-03-13 19:13:25,643 [INFO]: }
2025-03-13 19:13:25,643 [INFO]: 	>>> Finished "Creating the index" in 70.7759 secs
2025-03-13 19:13:25,643 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8098 secs
2025-03-13 19:13:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:13:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 51738 [episode count 3/20]
[retrieval_preprocessing] for episode 28198 [episode count 4/20], we have num_retrieval=np.int64(4837) num_query=np.int64(205)
2025-03-13 19:13:27,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:13:28,542 [INFO]: Launching the whole pipeline 03/13/2025, 19:13:28
2025-03-13 19:13:28,542 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:13:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.54it/s]
2025-03-13 19:13:28,569 [INFO]: There are 4837 embeddings of dim 49152
2025-03-13 19:13:28,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 19:13:28,569 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:13:28
2025-03-13 19:13:28,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:13:28,570 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 19:13:28,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:13:28,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:13:28,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:13:28
2025-03-13 19:13:28,570 [INFO]: 998.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:13:28,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:13:28,570 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:13:28
2025-03-13 19:13:28,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:13:28,570 [INFO]: 	Creating the index 03/13/2025, 19:13:28
2025-03-13 19:13:28,570 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:13:28
2025-03-13 19:13:28,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 19:13:28,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:13:28
2025-03-13 19:13:28,571 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:13:28,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.38it/s] 30%|███       | 6/20 [00:00<00:00, 32.54it/s] 55%|█████▌    | 11/20 [00:00<00:00, 40.22it/s] 80%|████████  | 16/20 [00:00<00:00, 43.78it/s]100%|██████████| 20/20 [00:03<00:00,  5.28it/s]
2025-03-13 19:13:32,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:13:32
2025-03-13 19:14:15,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9339 secs
2025-03-13 19:14:15,297 [INFO]: The best hyperparameters are: efSearch=221
2025-03-13 19:14:15,297 [INFO]: 	Compute fast metrics 03/13/2025, 19:14:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-13 19:14:33,861 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5645 secs
2025-03-13 19:14:33,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2935 secs
2025-03-13 19:14:33,865 [INFO]: {
2025-03-13 19:14:33,865 [INFO]: 	index_key: HNSW15
2025-03-13 19:14:33,865 [INFO]: 	index_param: efSearch=221
2025-03-13 19:14:33,865 [INFO]: 	index_path: knn.index
2025-03-13 19:14:33,865 [INFO]: 	size in bytes: 951650830
2025-03-13 19:14:33,865 [INFO]: 	avg_search_speed_ms: 11.842142532651241
2025-03-13 19:14:33,865 [INFO]: 	99p_search_speed_ms: 17.080883979797353
2025-03-13 19:14:33,865 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:14:33,865 [INFO]: 	nb vectors: 4837
2025-03-13 19:14:33,865 [INFO]: 	vectors dimension: 49152
2025-03-13 19:14:33,865 [INFO]: 	compression ratio: 0.9993086392831707
2025-03-13 19:14:33,865 [INFO]: }
2025-03-13 19:14:33,865 [INFO]: 	>>> Finished "Creating the index" in 65.2951 secs
2025-03-13 19:14:33,865 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3226 secs
2025-03-13 19:14:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:14:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 28198 [episode count 4/20]
[retrieval_preprocessing] for episode 39980 [episode count 5/20], we have num_retrieval=np.int64(4791) num_query=np.int64(251)
2025-03-13 19:14:35,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:14:36,596 [INFO]: Launching the whole pipeline 03/13/2025, 19:14:36
2025-03-13 19:14:36,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:14:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2157.56it/s]
2025-03-13 19:14:36,624 [INFO]: There are 4791 embeddings of dim 49152
2025-03-13 19:14:36,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 19:14:36,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:14:36
2025-03-13 19:14:36,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:14:36,626 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:14:36,626 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:14:36,626 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:14:36,626 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:14:36
2025-03-13 19:14:36,626 [INFO]: 988.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:14:36,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:14:36,627 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:14:36
2025-03-13 19:14:36,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 19:14:36,627 [INFO]: 	Creating the index 03/13/2025, 19:14:36
2025-03-13 19:14:36,627 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:14:36
2025-03-13 19:14:36,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 19:14:36,631 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:14:36
2025-03-13 19:14:36,631 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:14:36,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 25.66it/s] 47%|████▋     | 9/19 [00:00<00:00, 41.91it/s] 79%|███████▉  | 15/19 [00:00<00:00, 47.22it/s]100%|██████████| 19/19 [00:03<00:00,  4.84it/s]
2025-03-13 19:14:40,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:14:40
2025-03-13 19:15:20,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1608 secs
2025-03-13 19:15:20,722 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 19:15:20,722 [INFO]: 	Compute fast metrics 03/13/2025, 19:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.35it/s]
2025-03-13 19:15:42,473 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7504 secs
2025-03-13 19:15:42,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8462 secs
2025-03-13 19:15:42,477 [INFO]: {
2025-03-13 19:15:42,477 [INFO]: 	index_key: HNSW15
2025-03-13 19:15:42,478 [INFO]: 	index_param: efSearch=196
2025-03-13 19:15:42,478 [INFO]: 	index_path: knn.index
2025-03-13 19:15:42,478 [INFO]: 	size in bytes: 942600550
2025-03-13 19:15:42,478 [INFO]: 	avg_search_speed_ms: 12.864639640816877
2025-03-13 19:15:42,478 [INFO]: 	99p_search_speed_ms: 22.18666957225651
2025-03-13 19:15:42,478 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:15:42,478 [INFO]: 	nb vectors: 4791
2025-03-13 19:15:42,478 [INFO]: 	vectors dimension: 49152
2025-03-13 19:15:42,478 [INFO]: 	compression ratio: 0.9993086976238238
2025-03-13 19:15:42,478 [INFO]: }
2025-03-13 19:15:42,478 [INFO]: 	>>> Finished "Creating the index" in 65.8504 secs
2025-03-13 19:15:42,478 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8817 secs
2025-03-13 19:15:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:15:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 39980 [episode count 5/20]
[retrieval_preprocessing] for episode 76381 [episode count 6/20], we have num_retrieval=np.int64(4803) num_query=np.int64(239)
2025-03-13 19:15:45,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:15:45,987 [INFO]: Launching the whole pipeline 03/13/2025, 19:15:45
2025-03-13 19:15:45,987 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1351.69it/s]
2025-03-13 19:15:46,017 [INFO]: There are 4803 embeddings of dim 49152
2025-03-13 19:15:46,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-13 19:15:46,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:15:46
2025-03-13 19:15:46,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:15:46,018 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:15:46,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:15:46,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:15:46,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:15:46
2025-03-13 19:15:46,018 [INFO]: 991.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:15:46,018 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:15:46,018 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:15:46
2025-03-13 19:15:46,018 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:15:46,018 [INFO]: 	Creating the index 03/13/2025, 19:15:46
2025-03-13 19:15:46,018 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:15:46
2025-03-13 19:15:46,019 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:15:46,019 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:15:46
2025-03-13 19:15:46,019 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:15:46,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.16it/s] 21%|██        | 4/19 [00:00<00:00, 18.56it/s] 47%|████▋     | 9/19 [00:00<00:00, 29.65it/s] 74%|███████▎  | 14/19 [00:00<00:00, 35.16it/s]100%|██████████| 19/19 [00:04<00:00,  2.89it/s]100%|██████████| 19/19 [00:04<00:00,  4.22it/s]
2025-03-13 19:15:50,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:15:50
2025-03-13 19:16:30,131 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6102 secs
2025-03-13 19:16:30,132 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 19:16:30,132 [INFO]: 	Compute fast metrics 03/13/2025, 19:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.26it/s]
2025-03-13 19:16:52,789 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6572 secs
2025-03-13 19:16:52,793 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7733 secs
2025-03-13 19:16:52,793 [INFO]: {
2025-03-13 19:16:52,793 [INFO]: 	index_key: HNSW15
2025-03-13 19:16:52,793 [INFO]: 	index_param: efSearch=244
2025-03-13 19:16:52,793 [INFO]: 	index_path: knn.index
2025-03-13 19:16:52,793 [INFO]: 	size in bytes: 944961550
2025-03-13 19:16:52,793 [INFO]: 	avg_search_speed_ms: 11.150645431901516
2025-03-13 19:16:52,793 [INFO]: 	99p_search_speed_ms: 22.12030722759664
2025-03-13 19:16:52,793 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:16:52,793 [INFO]: 	nb vectors: 4803
2025-03-13 19:16:52,793 [INFO]: 	vectors dimension: 49152
2025-03-13 19:16:52,793 [INFO]: 	compression ratio: 0.9993086216047626
2025-03-13 19:16:52,793 [INFO]: }
2025-03-13 19:16:52,793 [INFO]: 	>>> Finished "Creating the index" in 66.7751 secs
2025-03-13 19:16:52,793 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8061 secs
2025-03-13 19:16:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:16:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 76381 [episode count 6/20]
[retrieval_preprocessing] for episode 85087 [episode count 7/20], we have num_retrieval=np.int64(4830) num_query=np.int64(212)
2025-03-13 19:16:56,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:16:57,032 [INFO]: Launching the whole pipeline 03/13/2025, 19:16:57
2025-03-13 19:16:57,032 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:16:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1635.21it/s]
2025-03-13 19:16:57,061 [INFO]: There are 4830 embeddings of dim 49152
2025-03-13 19:16:57,061 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 19:16:57,061 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:16:57
2025-03-13 19:16:57,062 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:16:57,062 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 19:16:57,062 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:16:57,062 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:16:57,062 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:16:57
2025-03-13 19:16:57,062 [INFO]: 996.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:16:57,062 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:16:57,062 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:16:57
2025-03-13 19:16:57,062 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:16:57,062 [INFO]: 	Creating the index 03/13/2025, 19:16:57
2025-03-13 19:16:57,062 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:16:57
2025-03-13 19:16:57,063 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:16:57,063 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:16:57
2025-03-13 19:16:57,063 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:16:57,064 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.04it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.56it/s] 65%|██████▌   | 13/20 [00:00<00:00, 41.84it/s] 95%|█████████▌| 19/20 [00:00<00:00, 45.15it/s]100%|██████████| 20/20 [00:04<00:00,  4.77it/s]
2025-03-13 19:17:01,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:17:01
2025-03-13 19:17:46,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9518 secs
2025-03-13 19:17:46,210 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 19:17:46,210 [INFO]: 	Compute fast metrics 03/13/2025, 19:17:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.32it/s]
2025-03-13 19:18:06,187 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9773 secs
2025-03-13 19:18:06,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1266 secs
2025-03-13 19:18:06,190 [INFO]: {
2025-03-13 19:18:06,190 [INFO]: 	index_key: HNSW15
2025-03-13 19:18:06,190 [INFO]: 	index_param: efSearch=256
2025-03-13 19:18:06,190 [INFO]: 	index_path: knn.index
2025-03-13 19:18:06,190 [INFO]: 	size in bytes: 950273650
2025-03-13 19:18:06,190 [INFO]: 	avg_search_speed_ms: 13.373706687458437
2025-03-13 19:18:06,190 [INFO]: 	99p_search_speed_ms: 19.063929892145097
2025-03-13 19:18:06,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:18:06,190 [INFO]: 	nb vectors: 4830
2025-03-13 19:18:06,190 [INFO]: 	vectors dimension: 49152
2025-03-13 19:18:06,190 [INFO]: 	compression ratio: 0.999308609683116
2025-03-13 19:18:06,190 [INFO]: }
2025-03-13 19:18:06,190 [INFO]: 	>>> Finished "Creating the index" in 69.1283 secs
2025-03-13 19:18:06,190 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1583 secs
2025-03-13 19:18:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:18:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 85087 [episode count 7/20]
[retrieval_preprocessing] for episode 13431 [episode count 8/20], we have num_retrieval=np.int64(4860) num_query=np.int64(182)
2025-03-13 19:18:08,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:18:09,075 [INFO]: Launching the whole pipeline 03/13/2025, 19:18:09
2025-03-13 19:18:09,075 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:18:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-13 19:18:09,101 [INFO]: There are 4860 embeddings of dim 49152
2025-03-13 19:18:09,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 19:18:09,101 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:18:09
2025-03-13 19:18:09,101 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:18:09,101 [INFO]: 		-> Add: 2.7 seconds
2025-03-13 19:18:09,102 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:18:09,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:18:09,102 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:18:09
2025-03-13 19:18:09,102 [INFO]: 1003.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:18:09,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:18:09,102 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:18:09
2025-03-13 19:18:09,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:18:09,102 [INFO]: 	Creating the index 03/13/2025, 19:18:09
2025-03-13 19:18:09,102 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:18:09
2025-03-13 19:18:09,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 19:18:09,103 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:18:09
2025-03-13 19:18:09,103 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:18:09,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.17it/s] 35%|███▌      | 7/20 [00:00<00:00, 32.66it/s] 65%|██████▌   | 13/20 [00:00<00:00, 40.88it/s] 95%|█████████▌| 19/20 [00:00<00:00, 44.82it/s]100%|██████████| 20/20 [00:03<00:00,  5.37it/s]
2025-03-13 19:18:12,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:18:12
2025-03-13 19:18:53,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5116 secs
2025-03-13 19:18:53,341 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 19:18:53,341 [INFO]: 	Compute fast metrics 03/13/2025, 19:18:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-13 19:19:14,402 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0610 secs
2025-03-13 19:19:14,405 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3013 secs
2025-03-13 19:19:14,405 [INFO]: {
2025-03-13 19:19:14,405 [INFO]: 	index_key: HNSW15
2025-03-13 19:19:14,405 [INFO]: 	index_param: efSearch=226
2025-03-13 19:19:14,405 [INFO]: 	index_path: knn.index
2025-03-13 19:19:14,405 [INFO]: 	size in bytes: 956175910
2025-03-13 19:19:14,405 [INFO]: 	avg_search_speed_ms: 11.645334519606356
2025-03-13 19:19:14,405 [INFO]: 	99p_search_speed_ms: 15.862780376337467
2025-03-13 19:19:14,405 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:19:14,405 [INFO]: 	nb vectors: 4860
2025-03-13 19:19:14,405 [INFO]: 	vectors dimension: 49152
2025-03-13 19:19:14,405 [INFO]: 	compression ratio: 0.9993086732335685
2025-03-13 19:19:14,405 [INFO]: }
2025-03-13 19:19:14,405 [INFO]: 	>>> Finished "Creating the index" in 65.3033 secs
2025-03-13 19:19:14,405 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3303 secs
2025-03-13 19:19:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:19:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 13431 [episode count 8/20]
[retrieval_preprocessing] for episode 91790 [episode count 9/20], we have num_retrieval=np.int64(4781) num_query=np.int64(261)
2025-03-13 19:19:16,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:19:16,905 [INFO]: Launching the whole pipeline 03/13/2025, 19:19:16
2025-03-13 19:19:16,905 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:19:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1558.06it/s]
2025-03-13 19:19:16,932 [INFO]: There are 4781 embeddings of dim 49152
2025-03-13 19:19:16,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:19:16,933 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:19:16
2025-03-13 19:19:16,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:19:16,933 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:19:16,933 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:19:16,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:19:16,933 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:19:16
2025-03-13 19:19:16,933 [INFO]: 986.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:19:16,933 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:19:16,933 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:19:16
2025-03-13 19:19:16,933 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:19:16,933 [INFO]: 	Creating the index 03/13/2025, 19:19:16
2025-03-13 19:19:16,933 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:19:16
2025-03-13 19:19:16,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:19:16,934 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:19:16
2025-03-13 19:19:16,934 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:19:16,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:01, 16.76it/s] 42%|████▏     | 8/19 [00:00<00:00, 37.64it/s] 74%|███████▎  | 14/19 [00:00<00:00, 44.05it/s]100%|██████████| 19/19 [00:03<00:00,  3.56it/s]100%|██████████| 19/19 [00:03<00:00,  5.04it/s]
2025-03-13 19:19:20,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:19:20
2025-03-13 19:20:06,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3218 secs
2025-03-13 19:20:06,032 [INFO]: The best hyperparameters are: efSearch=159
2025-03-13 19:20:06,032 [INFO]: 	Compute fast metrics 03/13/2025, 19:20:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s]
2025-03-13 19:20:25,141 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1089 secs
2025-03-13 19:20:25,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2100 secs
2025-03-13 19:20:25,145 [INFO]: {
2025-03-13 19:20:25,145 [INFO]: 	index_key: HNSW15
2025-03-13 19:20:25,145 [INFO]: 	index_param: efSearch=159
2025-03-13 19:20:25,145 [INFO]: 	index_path: knn.index
2025-03-13 19:20:25,145 [INFO]: 	size in bytes: 940633150
2025-03-13 19:20:25,145 [INFO]: 	avg_search_speed_ms: 8.334172565567618
2025-03-13 19:20:25,145 [INFO]: 	99p_search_speed_ms: 14.539045144338159
2025-03-13 19:20:25,145 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:20:25,145 [INFO]: 	nb vectors: 4781
2025-03-13 19:20:25,145 [INFO]: 	vectors dimension: 49152
2025-03-13 19:20:25,145 [INFO]: 	compression ratio: 0.9993086550266701
2025-03-13 19:20:25,145 [INFO]: }
2025-03-13 19:20:25,145 [INFO]: 	>>> Finished "Creating the index" in 68.2118 secs
2025-03-13 19:20:25,145 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2397 secs
2025-03-13 19:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:20:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 91790 [episode count 9/20]
[retrieval_preprocessing] for episode 30874 [episode count 10/20], we have num_retrieval=np.int64(4793) num_query=np.int64(249)
2025-03-13 19:20:27,303 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:20:28,111 [INFO]: Launching the whole pipeline 03/13/2025, 19:20:28
2025-03-13 19:20:28,111 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:20:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.45it/s]
2025-03-13 19:20:28,261 [INFO]: There are 4793 embeddings of dim 49152
2025-03-13 19:20:28,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1505 secs
2025-03-13 19:20:28,262 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:20:28
2025-03-13 19:20:28,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:20:28,262 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:20:28,262 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:20:28,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:20:28,262 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:20:28
2025-03-13 19:20:28,262 [INFO]: 989.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:20:28,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:20:28,262 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:20:28
2025-03-13 19:20:28,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:20:28,263 [INFO]: 	Creating the index 03/13/2025, 19:20:28
2025-03-13 19:20:28,263 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:20:28
2025-03-13 19:20:28,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 19:20:28,265 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:20:28
2025-03-13 19:20:28,265 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:20:28,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 25.38it/s] 47%|████▋     | 9/19 [00:00<00:00, 42.20it/s] 79%|███████▉  | 15/19 [00:00<00:00, 48.05it/s]100%|██████████| 19/19 [00:03<00:00,  4.99it/s]
2025-03-13 19:20:32,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:20:32
2025-03-13 19:21:13,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6216 secs
2025-03-13 19:21:13,700 [INFO]: The best hyperparameters are: efSearch=241
2025-03-13 19:21:13,700 [INFO]: 	Compute fast metrics 03/13/2025, 19:21:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.68it/s]
2025-03-13 19:21:41,198 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4981 secs
2025-03-13 19:21:41,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.9354 secs
2025-03-13 19:21:41,200 [INFO]: {
2025-03-13 19:21:41,201 [INFO]: 	index_key: HNSW15
2025-03-13 19:21:41,201 [INFO]: 	index_param: efSearch=241
2025-03-13 19:21:41,201 [INFO]: 	index_path: knn.index
2025-03-13 19:21:41,201 [INFO]: 	size in bytes: 942994030
2025-03-13 19:21:41,201 [INFO]: 	avg_search_speed_ms: 9.308685797693302
2025-03-13 19:21:41,201 [INFO]: 	99p_search_speed_ms: 13.58419315656647
2025-03-13 19:21:41,201 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:21:41,201 [INFO]: 	nb vectors: 4793
2025-03-13 19:21:41,201 [INFO]: 	vectors dimension: 49152
2025-03-13 19:21:41,201 [INFO]: 	compression ratio: 0.9993087061219252
2025-03-13 19:21:41,201 [INFO]: }
2025-03-13 19:21:41,201 [INFO]: 	>>> Finished "Creating the index" in 72.9381 secs
2025-03-13 19:21:41,201 [INFO]: >>> Finished "Launching the whole pipeline" in 73.0898 secs
2025-03-13 19:21:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:21:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 30874 [episode count 10/20]
[retrieval_preprocessing] for episode 8365 [episode count 11/20], we have num_retrieval=np.int64(4751) num_query=np.int64(291)
2025-03-13 19:21:43,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:21:44,427 [INFO]: Launching the whole pipeline 03/13/2025, 19:21:44
2025-03-13 19:21:44,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:21:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2313.46it/s]
2025-03-13 19:21:44,452 [INFO]: There are 4751 embeddings of dim 49152
2025-03-13 19:21:44,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 19:21:44,453 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:21:44
2025-03-13 19:21:44,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:21:44,453 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:21:44,453 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:21:44,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:21:44,453 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:21:44
2025-03-13 19:21:44,453 [INFO]: 980.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:21:44,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:21:44,453 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:21:44
2025-03-13 19:21:44,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:21:44,453 [INFO]: 	Creating the index 03/13/2025, 19:21:44
2025-03-13 19:21:44,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:21:44
2025-03-13 19:21:44,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 19:21:44,455 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:21:44
2025-03-13 19:21:44,455 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:21:44,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 16%|█▌        | 3/19 [00:00<00:00, 25.84it/s] 47%|████▋     | 9/19 [00:00<00:00, 42.65it/s] 79%|███████▉  | 15/19 [00:00<00:00, 47.05it/s]100%|██████████| 19/19 [00:03<00:00,  5.53it/s]
2025-03-13 19:21:47,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:21:47
2025-03-13 19:22:31,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2989 secs
2025-03-13 19:22:31,194 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 19:22:31,194 [INFO]: 	Compute fast metrics 03/13/2025, 19:22:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.39it/s]
2025-03-13 19:22:51,339 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1453 secs
2025-03-13 19:22:51,869 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4139 secs
2025-03-13 19:22:51,869 [INFO]: {
2025-03-13 19:22:51,870 [INFO]: 	index_key: HNSW15
2025-03-13 19:22:51,870 [INFO]: 	index_param: efSearch=224
2025-03-13 19:22:51,870 [INFO]: 	index_path: knn.index
2025-03-13 19:22:51,870 [INFO]: 	size in bytes: 934730770
2025-03-13 19:22:51,870 [INFO]: 	avg_search_speed_ms: 9.409194360973414
2025-03-13 19:22:51,870 [INFO]: 	99p_search_speed_ms: 12.449488802812992
2025-03-13 19:22:51,870 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:22:51,870 [INFO]: 	nb vectors: 4751
2025-03-13 19:22:51,870 [INFO]: 	vectors dimension: 49152
2025-03-13 19:22:51,870 [INFO]: 	compression ratio: 0.999308718594981
2025-03-13 19:22:51,870 [INFO]: }
2025-03-13 19:22:51,870 [INFO]: 	>>> Finished "Creating the index" in 67.4169 secs
2025-03-13 19:22:51,870 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4435 secs
2025-03-13 19:22:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:22:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 8365 [episode count 11/20]
[retrieval_preprocessing] for episode 22193 [episode count 12/20], we have num_retrieval=np.int64(4754) num_query=np.int64(288)
2025-03-13 19:22:54,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:22:55,258 [INFO]: Launching the whole pipeline 03/13/2025, 19:22:55
2025-03-13 19:22:55,258 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:22:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2148.72it/s]
2025-03-13 19:22:55,286 [INFO]: There are 4754 embeddings of dim 49152
2025-03-13 19:22:55,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 19:22:55,287 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:22:55
2025-03-13 19:22:55,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:22:55,287 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:22:55,287 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:22:55,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 19:22:55,287 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:22:55
2025-03-13 19:22:55,288 [INFO]: 981.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:22:55,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 19:22:55,288 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:22:55
2025-03-13 19:22:55,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:22:55,288 [INFO]: 	Creating the index 03/13/2025, 19:22:55
2025-03-13 19:22:55,288 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:22:55
2025-03-13 19:22:55,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 19:22:55,292 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:22:55
2025-03-13 19:22:55,292 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:22:55,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.46it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.41it/s] 74%|███████▎  | 14/19 [00:00<00:00, 47.19it/s]100%|██████████| 19/19 [00:03<00:00,  3.68it/s]100%|██████████| 19/19 [00:03<00:00,  5.20it/s]
2025-03-13 19:22:58,950 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:22:58
2025-03-13 19:23:38,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1042 secs
2025-03-13 19:23:38,055 [INFO]: The best hyperparameters are: efSearch=232
2025-03-13 19:23:38,055 [INFO]: 	Compute fast metrics 03/13/2025, 19:23:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.22it/s]
2025-03-13 19:24:02,338 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2827 secs
2025-03-13 19:24:02,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0487 secs
2025-03-13 19:24:02,341 [INFO]: {
2025-03-13 19:24:02,341 [INFO]: 	index_key: HNSW15
2025-03-13 19:24:02,341 [INFO]: 	index_param: efSearch=232
2025-03-13 19:24:02,341 [INFO]: 	index_path: knn.index
2025-03-13 19:24:02,341 [INFO]: 	size in bytes: 935320990
2025-03-13 19:24:02,341 [INFO]: 	avg_search_speed_ms: 9.82559325350979
2025-03-13 19:24:02,341 [INFO]: 	99p_search_speed_ms: 13.117340896278622
2025-03-13 19:24:02,341 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:24:02,341 [INFO]: 	nb vectors: 4754
2025-03-13 19:24:02,341 [INFO]: 	vectors dimension: 49152
2025-03-13 19:24:02,341 [INFO]: 	compression ratio: 0.9993087314334729
2025-03-13 19:24:02,341 [INFO]: }
2025-03-13 19:24:02,341 [INFO]: 	>>> Finished "Creating the index" in 67.0524 secs
2025-03-13 19:24:02,341 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0826 secs
2025-03-13 19:24:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:24:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 22193 [episode count 12/20]
[retrieval_preprocessing] for episode 80594 [episode count 13/20], we have num_retrieval=np.int64(4815) num_query=np.int64(227)
2025-03-13 19:24:06,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:24:07,254 [INFO]: Launching the whole pipeline 03/13/2025, 19:24:07
2025-03-13 19:24:07,254 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:24:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.56it/s]
2025-03-13 19:24:07,286 [INFO]: There are 4815 embeddings of dim 49152
2025-03-13 19:24:07,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 19:24:07,286 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:24:07
2025-03-13 19:24:07,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:24:07,286 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:24:07,286 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:24:07,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:24:07,286 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:24:07
2025-03-13 19:24:07,286 [INFO]: 993.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:24:07,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:24:07,286 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:24:07
2025-03-13 19:24:07,287 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:24:07,287 [INFO]: 	Creating the index 03/13/2025, 19:24:07
2025-03-13 19:24:07,287 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:24:07
2025-03-13 19:24:07,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:24:07,288 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:24:07
2025-03-13 19:24:07,288 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:24:07,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.60it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.76it/s] 63%|██████▎   | 12/19 [00:00<00:00, 38.92it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.72it/s]100%|██████████| 19/19 [00:04<00:00,  4.59it/s]
2025-03-13 19:24:11,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:24:11
2025-03-13 19:24:52,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8559 secs
2025-03-13 19:24:52,292 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 19:24:52,292 [INFO]: 	Compute fast metrics 03/13/2025, 19:24:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-13 19:25:21,105 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8128 secs
2025-03-13 19:25:21,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8192 secs
2025-03-13 19:25:21,108 [INFO]: {
2025-03-13 19:25:21,108 [INFO]: 	index_key: HNSW15
2025-03-13 19:25:21,108 [INFO]: 	index_param: efSearch=239
2025-03-13 19:25:21,108 [INFO]: 	index_path: knn.index
2025-03-13 19:25:21,108 [INFO]: 	size in bytes: 947322490
2025-03-13 19:25:21,108 [INFO]: 	avg_search_speed_ms: 10.315616179699289
2025-03-13 19:25:21,108 [INFO]: 	99p_search_speed_ms: 13.956897209864097
2025-03-13 19:25:21,108 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:25:21,108 [INFO]: 	nb vectors: 4815
2025-03-13 19:25:21,108 [INFO]: 	vectors dimension: 49152
2025-03-13 19:25:21,108 [INFO]: 	compression ratio: 0.9993086092572341
2025-03-13 19:25:21,108 [INFO]: }
2025-03-13 19:25:21,108 [INFO]: 	>>> Finished "Creating the index" in 73.8211 secs
2025-03-13 19:25:21,108 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8537 secs
2025-03-13 19:25:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:25:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 80594 [episode count 13/20]
[retrieval_preprocessing] for episode 9428 [episode count 14/20], we have num_retrieval=np.int64(4733) num_query=np.int64(309)
2025-03-13 19:25:23,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:25:24,709 [INFO]: Launching the whole pipeline 03/13/2025, 19:25:24
2025-03-13 19:25:24,709 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:25:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1315.65it/s]
2025-03-13 19:25:24,733 [INFO]: There are 4733 embeddings of dim 49152
2025-03-13 19:25:24,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 19:25:24,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:25:24,733 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:25:24,733 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:25:24,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:25:24,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,733 [INFO]: 976.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:25:24,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:25:24,734 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:25:24
2025-03-13 19:25:24,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:25:24,734 [INFO]: 	Creating the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,734 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:25:24
2025-03-13 19:25:24,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:25:24,735 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:25:24
2025-03-13 19:25:24,735 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:25:24,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.87it/s] 37%|███▋      | 7/19 [00:00<00:00, 32.90it/s] 68%|██████▊   | 13/19 [00:00<00:00, 41.76it/s]100%|██████████| 19/19 [00:04<00:00,  3.13it/s]100%|██████████| 19/19 [00:04<00:00,  4.23it/s]
2025-03-13 19:25:29,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:25:29
2025-03-13 19:26:11,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7982 secs
2025-03-13 19:26:11,030 [INFO]: The best hyperparameters are: efSearch=275
2025-03-13 19:26:11,030 [INFO]: 	Compute fast metrics 03/13/2025, 19:26:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-13 19:26:39,379 [INFO]: 	>>> Finished "Compute fast metrics" in 28.3486 secs
2025-03-13 19:26:39,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6463 secs
2025-03-13 19:26:39,381 [INFO]: {
2025-03-13 19:26:39,381 [INFO]: 	index_key: HNSW15
2025-03-13 19:26:39,381 [INFO]: 	index_param: efSearch=275
2025-03-13 19:26:39,381 [INFO]: 	index_path: knn.index
2025-03-13 19:26:39,381 [INFO]: 	size in bytes: 931189390
2025-03-13 19:26:39,381 [INFO]: 	avg_search_speed_ms: 11.516831699497269
2025-03-13 19:26:39,382 [INFO]: 	99p_search_speed_ms: 15.82975250668823
2025-03-13 19:26:39,382 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:26:39,382 [INFO]: 	nb vectors: 4733
2025-03-13 19:26:39,382 [INFO]: 	vectors dimension: 49152
2025-03-13 19:26:39,382 [INFO]: 	compression ratio: 0.9993087056114331
2025-03-13 19:26:39,382 [INFO]: }
2025-03-13 19:26:39,382 [INFO]: 	>>> Finished "Creating the index" in 74.6479 secs
2025-03-13 19:26:39,382 [INFO]: >>> Finished "Launching the whole pipeline" in 74.6722 secs
2025-03-13 19:26:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:26:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 9428 [episode count 14/20]
[retrieval_preprocessing] for episode 11506 [episode count 15/20], we have num_retrieval=np.int64(4793) num_query=np.int64(249)
2025-03-13 19:26:43,166 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:26:43,972 [INFO]: Launching the whole pipeline 03/13/2025, 19:26:43
2025-03-13 19:26:43,972 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:26:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 934.35it/s]
2025-03-13 19:26:44,002 [INFO]: There are 4793 embeddings of dim 49152
2025-03-13 19:26:44,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 19:26:44,003 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:26:44,003 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:26:44,003 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:26:44,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 19:26:44,003 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,003 [INFO]: 989.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:26:44,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:26:44,003 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:26:44
2025-03-13 19:26:44,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:26:44,003 [INFO]: 	Creating the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,003 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:26:44
2025-03-13 19:26:44,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:26:44,004 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:26:44
2025-03-13 19:26:44,004 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:26:44,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.82it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.72it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.21it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.58it/s]100%|██████████| 19/19 [00:04<00:00,  4.69it/s]
2025-03-13 19:26:48,056 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:26:48
2025-03-13 19:27:31,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1294 secs
2025-03-13 19:27:31,186 [INFO]: The best hyperparameters are: efSearch=243
2025-03-13 19:27:31,186 [INFO]: 	Compute fast metrics 03/13/2025, 19:27:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 19:27:51,584 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3978 secs
2025-03-13 19:27:51,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5827 secs
2025-03-13 19:27:51,587 [INFO]: {
2025-03-13 19:27:51,587 [INFO]: 	index_key: HNSW15
2025-03-13 19:27:51,587 [INFO]: 	index_param: efSearch=243
2025-03-13 19:27:51,587 [INFO]: 	index_path: knn.index
2025-03-13 19:27:51,587 [INFO]: 	size in bytes: 942994030
2025-03-13 19:27:51,588 [INFO]: 	avg_search_speed_ms: 12.175923594332543
2025-03-13 19:27:51,588 [INFO]: 	99p_search_speed_ms: 22.446667943149798
2025-03-13 19:27:51,588 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:27:51,588 [INFO]: 	nb vectors: 4793
2025-03-13 19:27:51,588 [INFO]: 	vectors dimension: 49152
2025-03-13 19:27:51,588 [INFO]: 	compression ratio: 0.9993087061219252
2025-03-13 19:27:51,588 [INFO]: }
2025-03-13 19:27:51,588 [INFO]: 	>>> Finished "Creating the index" in 67.5844 secs
2025-03-13 19:27:51,588 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6155 secs
2025-03-13 19:27:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:27:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 11506 [episode count 15/20]
[retrieval_preprocessing] for episode 88847 [episode count 16/20], we have num_retrieval=np.int64(4787) num_query=np.int64(255)
2025-03-13 19:27:54,591 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:27:55,510 [INFO]: Launching the whole pipeline 03/13/2025, 19:27:55
2025-03-13 19:27:55,510 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:27:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.08it/s]
2025-03-13 19:27:55,540 [INFO]: There are 4787 embeddings of dim 49152
2025-03-13 19:27:55,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-13 19:27:55,541 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,541 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:27:55,541 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:27:55,541 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:27:55,541 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:27:55,541 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,541 [INFO]: 987.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:27:55,541 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 19:27:55,541 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:27:55
2025-03-13 19:27:55,541 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:27:55,541 [INFO]: 	Creating the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,541 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:27:55
2025-03-13 19:27:55,542 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 19:27:55,542 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:27:55
2025-03-13 19:27:55,542 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:27:55,542 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.65it/s] 32%|███▏      | 6/19 [00:00<00:00, 32.63it/s] 58%|█████▊    | 11/19 [00:00<00:00, 40.14it/s] 84%|████████▍ | 16/19 [00:00<00:00, 43.77it/s]100%|██████████| 19/19 [00:04<00:00,  4.72it/s]
2025-03-13 19:27:59,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:27:59
2025-03-13 19:28:40,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4939 secs
2025-03-13 19:28:40,069 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 19:28:40,069 [INFO]: 	Compute fast metrics 03/13/2025, 19:28:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-13 19:29:01,488 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4188 secs
2025-03-13 19:29:01,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9487 secs
2025-03-13 19:29:01,491 [INFO]: {
2025-03-13 19:29:01,491 [INFO]: 	index_key: HNSW15
2025-03-13 19:29:01,491 [INFO]: 	index_param: efSearch=224
2025-03-13 19:29:01,491 [INFO]: 	index_path: knn.index
2025-03-13 19:29:01,491 [INFO]: 	size in bytes: 941813590
2025-03-13 19:29:01,491 [INFO]: 	avg_search_speed_ms: 12.770156241063681
2025-03-13 19:29:01,491 [INFO]: 	99p_search_speed_ms: 20.194919472560287
2025-03-13 19:29:01,491 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:29:01,491 [INFO]: 	nb vectors: 4787
2025-03-13 19:29:01,491 [INFO]: 	vectors dimension: 49152
2025-03-13 19:29:01,491 [INFO]: 	compression ratio: 0.9993086806063183
2025-03-13 19:29:01,491 [INFO]: }
2025-03-13 19:29:01,491 [INFO]: 	>>> Finished "Creating the index" in 65.9503 secs
2025-03-13 19:29:01,491 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9816 secs
2025-03-13 19:29:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:29:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 88847 [episode count 16/20]
[retrieval_preprocessing] for episode 56074 [episode count 17/20], we have num_retrieval=np.int64(4806) num_query=np.int64(236)
2025-03-13 19:29:03,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:29:04,327 [INFO]: Launching the whole pipeline 03/13/2025, 19:29:04
2025-03-13 19:29:04,327 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:29:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.28it/s]
2025-03-13 19:29:04,355 [INFO]: There are 4806 embeddings of dim 49152
2025-03-13 19:29:04,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 19:29:04,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:29:04
2025-03-13 19:29:04,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:29:04,355 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:29:04,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:29:04,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:29:04,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:29:04
2025-03-13 19:29:04,355 [INFO]: 991.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:29:04,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:29:04,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:29:04
2025-03-13 19:29:04,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:29:04,355 [INFO]: 	Creating the index 03/13/2025, 19:29:04
2025-03-13 19:29:04,355 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:29:04
2025-03-13 19:29:04,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 19:29:04,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:29:04
2025-03-13 19:29:04,356 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:29:04,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.81it/s] 37%|███▋      | 7/19 [00:00<00:00, 34.49it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.36it/s]100%|██████████| 19/19 [00:03<00:00,  3.65it/s]100%|██████████| 19/19 [00:03<00:00,  4.91it/s]
2025-03-13 19:29:08,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:29:08
2025-03-13 19:29:46,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3181 secs
2025-03-13 19:29:46,546 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 19:29:46,546 [INFO]: 	Compute fast metrics 03/13/2025, 19:29:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-13 19:30:05,023 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4773 secs
2025-03-13 19:30:05,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6698 secs
2025-03-13 19:30:05,026 [INFO]: {
2025-03-13 19:30:05,026 [INFO]: 	index_key: HNSW15
2025-03-13 19:30:05,026 [INFO]: 	index_param: efSearch=261
2025-03-13 19:30:05,026 [INFO]: 	index_path: knn.index
2025-03-13 19:30:05,027 [INFO]: 	size in bytes: 945551770
2025-03-13 19:30:05,027 [INFO]: 	avg_search_speed_ms: 11.872514403477082
2025-03-13 19:30:05,027 [INFO]: 	99p_search_speed_ms: 16.727102766744792
2025-03-13 19:30:05,027 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:30:05,027 [INFO]: 	nb vectors: 4806
2025-03-13 19:30:05,027 [INFO]: 	vectors dimension: 49152
2025-03-13 19:30:05,027 [INFO]: 	compression ratio: 0.9993086343648852
2025-03-13 19:30:05,027 [INFO]: }
2025-03-13 19:30:05,027 [INFO]: 	>>> Finished "Creating the index" in 60.6714 secs
2025-03-13 19:30:05,027 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6997 secs
2025-03-13 19:30:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:30:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 56074 [episode count 17/20]
[retrieval_preprocessing] for episode 78160 [episode count 18/20], we have num_retrieval=np.int64(4702) num_query=np.int64(340)
2025-03-13 19:30:08,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:30:08,705 [INFO]: Launching the whole pipeline 03/13/2025, 19:30:08
2025-03-13 19:30:08,705 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:30:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.38it/s]
2025-03-13 19:30:08,732 [INFO]: There are 4702 embeddings of dim 49152
2025-03-13 19:30:08,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 19:30:08,733 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:30:08
2025-03-13 19:30:08,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:30:08,733 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:30:08,733 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:30:08,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 19:30:08,733 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:30:08
2025-03-13 19:30:08,733 [INFO]: 970.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:30:08,733 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 19:30:08,733 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:30:08
2025-03-13 19:30:08,733 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:30:08,733 [INFO]: 	Creating the index 03/13/2025, 19:30:08
2025-03-13 19:30:08,733 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:30:08
2025-03-13 19:30:08,734 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 19:30:08,734 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:30:08
2025-03-13 19:30:08,735 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:30:08,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.40it/s] 37%|███▋      | 7/19 [00:00<00:00, 35.60it/s] 68%|██████▊   | 13/19 [00:00<00:00, 45.40it/s]100%|██████████| 19/19 [00:03<00:00,  4.01it/s]100%|██████████| 19/19 [00:03<00:00,  5.38it/s]
2025-03-13 19:30:12,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:30:12
2025-03-13 19:30:48,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9095 secs
2025-03-13 19:30:48,178 [INFO]: The best hyperparameters are: efSearch=210
2025-03-13 19:30:48,179 [INFO]: 	Compute fast metrics 03/13/2025, 19:30:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-13 19:31:04,539 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3601 secs
2025-03-13 19:31:04,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8074 secs
2025-03-13 19:31:04,542 [INFO]: {
2025-03-13 19:31:04,542 [INFO]: 	index_key: HNSW15
2025-03-13 19:31:04,542 [INFO]: 	index_param: efSearch=210
2025-03-13 19:31:04,542 [INFO]: 	index_path: knn.index
2025-03-13 19:31:04,542 [INFO]: 	size in bytes: 925090330
2025-03-13 19:31:04,542 [INFO]: 	avg_search_speed_ms: 11.349006157968866
2025-03-13 19:31:04,542 [INFO]: 	99p_search_speed_ms: 19.105830322951093
2025-03-13 19:31:04,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:31:04,542 [INFO]: 	nb vectors: 4702
2025-03-13 19:31:04,542 [INFO]: 	vectors dimension: 49152
2025-03-13 19:31:04,542 [INFO]: 	compression ratio: 0.9993087010216614
2025-03-13 19:31:04,542 [INFO]: }
2025-03-13 19:31:04,542 [INFO]: 	>>> Finished "Creating the index" in 55.8092 secs
2025-03-13 19:31:04,542 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8372 secs
2025-03-13 19:31:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:31:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 78160 [episode count 18/20]
[retrieval_preprocessing] for episode 75099 [episode count 19/20], we have num_retrieval=np.int64(4735) num_query=np.int64(307)
2025-03-13 19:31:08,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 19:31:09,061 [INFO]: Launching the whole pipeline 03/13/2025, 19:31:09
2025-03-13 19:31:09,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 19:31:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 771.01it/s]
2025-03-13 19:31:09,093 [INFO]: There are 4735 embeddings of dim 49152
2025-03-13 19:31:09,094 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-13 19:31:09,094 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 19:31:09
2025-03-13 19:31:09,094 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 19:31:09,095 [INFO]: 		-> Add: 2.6 seconds
2025-03-13 19:31:09,095 [INFO]: 		Total: 16.7 minutes
2025-03-13 19:31:09,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 19:31:09,095 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 19:31:09
2025-03-13 19:31:09,095 [INFO]: 977.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 19:31:09,095 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 19:31:09,096 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 19:31:09
2025-03-13 19:31:09,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 19:31:09,096 [INFO]: 	Creating the index 03/13/2025, 19:31:09
2025-03-13 19:31:09,096 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 19:31:09
2025-03-13 19:31:09,099 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 19:31:09,099 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 19:31:09
2025-03-13 19:31:09,099 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-13 19:31:09,100 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 19.29it/s] 42%|████▏     | 8/19 [00:00<00:00, 39.07it/s] 74%|███████▎  | 14/19 [00:00<00:00, 44.87it/s]100%|██████████| 19/19 [00:03<00:00,  3.84it/s]100%|██████████| 19/19 [00:03<00:00,  5.42it/s]
2025-03-13 19:31:12,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 19:31:12
2025-03-13 19:31:51,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9900 secs
2025-03-13 19:31:51,604 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 19:31:51,604 [INFO]: 	Compute fast metrics 03/13/2025, 19:31:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.17it/s]
2025-03-13 19:32:15,747 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1434 secs
2025-03-13 19:32:15,750 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6509 secs
2025-03-13 19:32:15,750 [INFO]: {
2025-03-13 19:32:15,750 [INFO]: 	index_key: HNSW15
2025-03-13 19:32:15,750 [INFO]: 	index_param: efSearch=245
2025-03-13 19:32:15,750 [INFO]: 	index_path: knn.index
2025-03-13 19:32:15,750 [INFO]: 	size in bytes: 931582870
2025-03-13 19:32:15,750 [INFO]: 	avg_search_speed_ms: 10.060154027830233
2025-03-13 19:32:15,750 [INFO]: 	99p_search_speed_ms: 13.34071804769337
2025-03-13 19:32:15,750 [INFO]: 	reconstruction error %: 0.0
2025-03-13 19:32:15,750 [INFO]: 	nb vectors: 4735
2025-03-13 19:32:15,750 [INFO]: 	vectors dimension: 49152
2025-03-13 19:32:15,750 [INFO]: 	compression ratio: 0.9993087142102559
2025-03-13 19:32:15,750 [INFO]: }
2025-03-13 19:32:15,751 [INFO]: 	>>> Finished "Creating the index" in 66.6547 secs
2025-03-13 19:32:15,751 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6891 secs
2025-03-13 19:32:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 19:32:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 75099 [episode count 19/20]
2025-03-13 19:32:19: [retrieval_preprocessing] finished for 3485794757_marker_from_cup_to_table [chosen_id count 9/196]
2025-03-13 19:32:19: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
