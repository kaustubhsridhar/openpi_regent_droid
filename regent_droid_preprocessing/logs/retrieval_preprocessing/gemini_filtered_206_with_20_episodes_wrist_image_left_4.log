nohup: ignoring input
2025-03-13 10:50:14: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-13 10:50:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3816161570_close_drawer [chosen_id count 0/260]
2025-03-13 10:50:33: [retrieval_preprocessing] we have num_total=2659 embedding_dim=49152
[retrieval_preprocessing] for episode 15381 [episode count 0/20], we have num_retrieval=np.int64(2466) num_query=np.int64(193)
2025-03-13 10:50:34,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:50:35,123 [INFO]: Launching the whole pipeline 03/13/2025, 10:50:35
2025-03-13 10:50:35,123 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:50:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 581.57it/s]
2025-03-13 10:50:35,173 [INFO]: There are 2466 embeddings of dim 49152
2025-03-13 10:50:35,173 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0503 secs
2025-03-13 10:50:35,173 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,173 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:50:35,173 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:50:35,173 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:50:35,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 10:50:35,173 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,174 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:50:35,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-13 10:50:35,174 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:50:35
2025-03-13 10:50:35,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:50:35,174 [INFO]: 	Creating the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,174 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:50:35
2025-03-13 10:50:35,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 10:50:35,176 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:50:35
2025-03-13 10:50:35,176 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:50:35,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.51it/s] 70%|███████   | 7/10 [00:00<00:00,  9.87it/s] 80%|████████  | 8/10 [00:01<00:00,  5.33it/s] 90%|█████████ | 9/10 [00:05<00:00,  1.03it/s]100%|██████████| 10/10 [00:07<00:00,  1.12s/it]100%|██████████| 10/10 [00:07<00:00,  1.41it/s]
2025-03-13 10:50:42,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:50:42
2025-03-13 10:51:08,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8644 secs
2025-03-13 10:51:08,155 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 10:51:08,155 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.08it/s]
2025-03-13 10:51:20,248 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0930 secs
2025-03-13 10:51:20,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0746 secs
2025-03-13 10:51:20,251 [INFO]: {
2025-03-13 10:51:20,251 [INFO]: 	index_key: HNSW15
2025-03-13 10:51:20,251 [INFO]: 	index_param: efSearch=194
2025-03-13 10:51:20,251 [INFO]: 	index_path: knn.index
2025-03-13 10:51:20,251 [INFO]: 	size in bytes: 485170090
2025-03-13 10:51:20,251 [INFO]: 	avg_search_speed_ms: 7.362267486984253
2025-03-13 10:51:20,251 [INFO]: 	99p_search_speed_ms: 9.882217652630061
2025-03-13 10:51:20,251 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:51:20,251 [INFO]: 	nb vectors: 2466
2025-03-13 10:51:20,251 [INFO]: 	vectors dimension: 49152
2025-03-13 10:51:20,251 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-13 10:51:20,251 [INFO]: }
2025-03-13 10:51:20,252 [INFO]: 	>>> Finished "Creating the index" in 45.0771 secs
2025-03-13 10:51:20,252 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1288 secs
2025-03-13 10:51:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:51:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 15381 [episode count 0/20]
[retrieval_preprocessing] for episode 20512 [episode count 1/20], we have num_retrieval=np.int64(2539) num_query=np.int64(120)
2025-03-13 10:51:22,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:51:22,977 [INFO]: Launching the whole pipeline 03/13/2025, 10:51:22
2025-03-13 10:51:22,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:51:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.04it/s]
2025-03-13 10:51:23,018 [INFO]: There are 2539 embeddings of dim 49152
2025-03-13 10:51:23,018 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-13 10:51:23,018 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,018 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:51:23,018 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:51:23,018 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:51:23,018 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:51:23,018 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,019 [INFO]: 524.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:51:23,019 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:51:23,019 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:51:23
2025-03-13 10:51:23,019 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:51:23,019 [INFO]: 	Creating the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,019 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:51:23
2025-03-13 10:51:23,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 10:51:23,020 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:51:23
2025-03-13 10:51:23,020 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:51:23,020 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.77it/s] 60%|██████    | 6/10 [00:00<00:00, 31.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.79it/s]100%|██████████| 10/10 [00:02<00:00,  4.55it/s]
2025-03-13 10:51:25,221 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:51:25
2025-03-13 10:51:57,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6678 secs
2025-03-13 10:51:57,890 [INFO]: The best hyperparameters are: efSearch=249
2025-03-13 10:51:57,890 [INFO]: 	Compute fast metrics 03/13/2025, 10:51:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.92it/s]
2025-03-13 10:52:10,065 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1747 secs
2025-03-13 10:52:10,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0797 secs
2025-03-13 10:52:10,100 [INFO]: {
2025-03-13 10:52:10,100 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:10,101 [INFO]: 	index_param: efSearch=249
2025-03-13 10:52:10,101 [INFO]: 	index_path: knn.index
2025-03-13 10:52:10,101 [INFO]: 	size in bytes: 499532530
2025-03-13 10:52:10,101 [INFO]: 	avg_search_speed_ms: 9.654937590459815
2025-03-13 10:52:10,101 [INFO]: 	99p_search_speed_ms: 13.591489056125296
2025-03-13 10:52:10,101 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:10,101 [INFO]: 	nb vectors: 2539
2025-03-13 10:52:10,101 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:10,101 [INFO]: 	compression ratio: 0.9993097186283344
2025-03-13 10:52:10,101 [INFO]: }
2025-03-13 10:52:10,101 [INFO]: 	>>> Finished "Creating the index" in 47.0821 secs
2025-03-13 10:52:10,101 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1238 secs
2025-03-13 10:52:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 20512 [episode count 1/20]
[retrieval_preprocessing] for episode 48680 [episode count 2/20], we have num_retrieval=np.int64(2559) num_query=np.int64(100)
2025-03-13 10:52:11,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:12,219 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:12
2025-03-13 10:52:12,219 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.87it/s]
2025-03-13 10:52:12,257 [INFO]: There are 2559 embeddings of dim 49152
2025-03-13 10:52:12,257 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-13 10:52:12,258 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:12
2025-03-13 10:52:12,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:12,258 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:52:12,258 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:12,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:52:12,258 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:12
2025-03-13 10:52:12,259 [INFO]: 528.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:12,259 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 10:52:12,259 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:12
2025-03-13 10:52:12,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:12,260 [INFO]: 	Creating the index 03/13/2025, 10:52:12
2025-03-13 10:52:12,260 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:12
2025-03-13 10:52:12,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 10:52:12,264 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:12
2025-03-13 10:52:12,264 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:52:12,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.62it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.41it/s]100%|██████████| 11/11 [00:01<00:00,  4.46it/s]100%|██████████| 11/11 [00:01<00:00,  5.53it/s]
2025-03-13 10:52:14,260 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:14
2025-03-13 10:52:43,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6784 secs
2025-03-13 10:52:43,939 [INFO]: The best hyperparameters are: efSearch=342
2025-03-13 10:52:43,939 [INFO]: 	Compute fast metrics 03/13/2025, 10:52:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-13 10:52:55,472 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5325 secs
2025-03-13 10:52:55,474 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2100 secs
2025-03-13 10:52:55,474 [INFO]: {
2025-03-13 10:52:55,474 [INFO]: 	index_key: HNSW15
2025-03-13 10:52:55,474 [INFO]: 	index_param: efSearch=342
2025-03-13 10:52:55,474 [INFO]: 	index_path: knn.index
2025-03-13 10:52:55,474 [INFO]: 	size in bytes: 503467450
2025-03-13 10:52:55,474 [INFO]: 	avg_search_speed_ms: 9.900547734849008
2025-03-13 10:52:55,474 [INFO]: 	99p_search_speed_ms: 16.585062658414245
2025-03-13 10:52:55,474 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:52:55,474 [INFO]: 	nb vectors: 2559
2025-03-13 10:52:55,474 [INFO]: 	vectors dimension: 49152
2025-03-13 10:52:55,474 [INFO]: 	compression ratio: 0.9993096316355705
2025-03-13 10:52:55,474 [INFO]: }
2025-03-13 10:52:55,474 [INFO]: 	>>> Finished "Creating the index" in 43.2141 secs
2025-03-13 10:52:55,474 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2553 secs
2025-03-13 10:52:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:52:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 48680 [episode count 2/20]
[retrieval_preprocessing] for episode 64577 [episode count 3/20], we have num_retrieval=np.int64(2545) num_query=np.int64(114)
2025-03-13 10:52:57,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:52:57,619 [INFO]: Launching the whole pipeline 03/13/2025, 10:52:57
2025-03-13 10:52:57,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:52:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.17it/s]
2025-03-13 10:52:57,658 [INFO]: There are 2545 embeddings of dim 49152
2025-03-13 10:52:57,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0393 secs
2025-03-13 10:52:57,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:52:57
2025-03-13 10:52:57,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:52:57,660 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:52:57,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:52:57,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 10:52:57,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:52:57
2025-03-13 10:52:57,661 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:52:57,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:52:57,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:52:57
2025-03-13 10:52:57,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:52:57,661 [INFO]: 	Creating the index 03/13/2025, 10:52:57
2025-03-13 10:52:57,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:52:57
2025-03-13 10:52:57,665 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 10:52:57,665 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:52:57
2025-03-13 10:52:57,665 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:52:57,666 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.39it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.04it/s]100%|██████████| 11/11 [00:01<00:00,  4.96it/s]100%|██████████| 11/11 [00:01<00:00,  6.12it/s]
2025-03-13 10:52:59,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:52:59
2025-03-13 10:53:28,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9282 secs
2025-03-13 10:53:28,396 [INFO]: The best hyperparameters are: efSearch=357
2025-03-13 10:53:28,396 [INFO]: 	Compute fast metrics 03/13/2025, 10:53:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-13 10:53:39,902 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5055 secs
2025-03-13 10:53:39,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2381 secs
2025-03-13 10:53:39,903 [INFO]: {
2025-03-13 10:53:39,903 [INFO]: 	index_key: HNSW15
2025-03-13 10:53:39,904 [INFO]: 	index_param: efSearch=357
2025-03-13 10:53:39,904 [INFO]: 	index_path: knn.index
2025-03-13 10:53:39,904 [INFO]: 	size in bytes: 500713090
2025-03-13 10:53:39,904 [INFO]: 	avg_search_speed_ms: 11.432910906683121
2025-03-13 10:53:39,904 [INFO]: 	99p_search_speed_ms: 17.22302837762981
2025-03-13 10:53:39,904 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:53:39,904 [INFO]: 	nb vectors: 2545
2025-03-13 10:53:39,904 [INFO]: 	vectors dimension: 49152
2025-03-13 10:53:39,904 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-13 10:53:39,904 [INFO]: }
2025-03-13 10:53:39,904 [INFO]: 	>>> Finished "Creating the index" in 42.2423 secs
2025-03-13 10:53:39,904 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2842 secs
2025-03-13 10:53:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:53:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 64577 [episode count 3/20]
[retrieval_preprocessing] for episode 17487 [episode count 4/20], we have num_retrieval=np.int64(2496) num_query=np.int64(163)
2025-03-13 10:53:41,889 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:53:42,253 [INFO]: Launching the whole pipeline 03/13/2025, 10:53:42
2025-03-13 10:53:42,253 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:53:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-13 10:53:42,281 [INFO]: There are 2496 embeddings of dim 49152
2025-03-13 10:53:42,281 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-13 10:53:42,281 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:53:42
2025-03-13 10:53:42,282 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:53:42,282 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:53:42,282 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:53:42,282 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:53:42,282 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:53:42
2025-03-13 10:53:42,282 [INFO]: 515.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:53:42,282 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 10:53:42,282 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:53:42
2025-03-13 10:53:42,282 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:53:42,282 [INFO]: 	Creating the index 03/13/2025, 10:53:42
2025-03-13 10:53:42,282 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:53:42
2025-03-13 10:53:42,283 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:53:42,283 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:53:42
2025-03-13 10:53:42,283 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:53:42,283 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.70it/s] 70%|███████   | 7/10 [00:00<00:00, 35.03it/s]100%|██████████| 10/10 [00:01<00:00,  5.94it/s]
2025-03-13 10:53:43,969 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:53:43
2025-03-13 10:54:11,749 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7800 secs
2025-03-13 10:54:11,750 [INFO]: The best hyperparameters are: efSearch=326
2025-03-13 10:54:11,750 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-13 10:54:24,225 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4751 secs
2025-03-13 10:54:24,227 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9439 secs
2025-03-13 10:54:24,227 [INFO]: {
2025-03-13 10:54:24,227 [INFO]: 	index_key: HNSW15
2025-03-13 10:54:24,227 [INFO]: 	index_param: efSearch=326
2025-03-13 10:54:24,227 [INFO]: 	index_path: knn.index
2025-03-13 10:54:24,227 [INFO]: 	size in bytes: 491072350
2025-03-13 10:54:24,227 [INFO]: 	avg_search_speed_ms: 12.309425264461765
2025-03-13 10:54:24,227 [INFO]: 	99p_search_speed_ms: 17.060620402917266
2025-03-13 10:54:24,227 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:54:24,227 [INFO]: 	nb vectors: 2496
2025-03-13 10:54:24,227 [INFO]: 	vectors dimension: 49152
2025-03-13 10:54:24,227 [INFO]: 	compression ratio: 0.999310117949015
2025-03-13 10:54:24,227 [INFO]: }
2025-03-13 10:54:24,227 [INFO]: 	>>> Finished "Creating the index" in 41.9454 secs
2025-03-13 10:54:24,227 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9746 secs
2025-03-13 10:54:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:54:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 17487 [episode count 4/20]
[retrieval_preprocessing] for episode 83555 [episode count 5/20], we have num_retrieval=np.int64(2545) num_query=np.int64(114)
2025-03-13 10:54:26,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:54:26,888 [INFO]: Launching the whole pipeline 03/13/2025, 10:54:26
2025-03-13 10:54:26,888 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:54:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.46it/s]
2025-03-13 10:54:26,928 [INFO]: There are 2545 embeddings of dim 49152
2025-03-13 10:54:26,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-13 10:54:26,928 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:54:26,929 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:54:26,929 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:54:26,929 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:54:26,929 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,929 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:54:26,929 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:54:26,929 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:54:26
2025-03-13 10:54:26,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:54:26,930 [INFO]: 	Creating the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,930 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:54:26
2025-03-13 10:54:26,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 10:54:26,932 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:54:26
2025-03-13 10:54:26,933 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:54:26,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.32it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.69it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.69it/s]
2025-03-13 10:54:29,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:54:29
2025-03-13 10:54:59,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4652 secs
2025-03-13 10:54:59,747 [INFO]: The best hyperparameters are: efSearch=341
2025-03-13 10:54:59,748 [INFO]: 	Compute fast metrics 03/13/2025, 10:54:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.34it/s]
2025-03-13 10:55:12,380 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6329 secs
2025-03-13 10:55:12,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4499 secs
2025-03-13 10:55:12,383 [INFO]: {
2025-03-13 10:55:12,383 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:12,383 [INFO]: 	index_param: efSearch=341
2025-03-13 10:55:12,383 [INFO]: 	index_path: knn.index
2025-03-13 10:55:12,383 [INFO]: 	size in bytes: 500713090
2025-03-13 10:55:12,383 [INFO]: 	avg_search_speed_ms: 10.702613735681071
2025-03-13 10:55:12,383 [INFO]: 	99p_search_speed_ms: 13.842335194349287
2025-03-13 10:55:12,383 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:12,383 [INFO]: 	nb vectors: 2545
2025-03-13 10:55:12,383 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:12,383 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-13 10:55:12,383 [INFO]: }
2025-03-13 10:55:12,383 [INFO]: 	>>> Finished "Creating the index" in 45.4531 secs
2025-03-13 10:55:12,383 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4945 secs
2025-03-13 10:55:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 83555 [episode count 5/20]
[retrieval_preprocessing] for episode 81016 [episode count 6/20], we have num_retrieval=np.int64(2542) num_query=np.int64(117)
2025-03-13 10:55:14,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:55:14,874 [INFO]: Launching the whole pipeline 03/13/2025, 10:55:14
2025-03-13 10:55:14,875 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:55:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.38it/s]
2025-03-13 10:55:14,907 [INFO]: There are 2542 embeddings of dim 49152
2025-03-13 10:55:14,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-13 10:55:14,908 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:55:14
2025-03-13 10:55:14,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:55:14,908 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:55:14,908 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:55:14,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:55:14,908 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:55:14
2025-03-13 10:55:14,909 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:55:14,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:55:14,909 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:55:14
2025-03-13 10:55:14,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:55:14,910 [INFO]: 	Creating the index 03/13/2025, 10:55:14
2025-03-13 10:55:14,910 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:55:14
2025-03-13 10:55:14,913 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-13 10:55:14,914 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:55:14
2025-03-13 10:55:14,914 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:55:14,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.89it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.23it/s]100%|██████████| 11/11 [00:01<00:00,  5.66it/s]
2025-03-13 10:55:16,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:55:16
2025-03-13 10:55:46,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9474 secs
2025-03-13 10:55:46,810 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 10:55:46,810 [INFO]: 	Compute fast metrics 03/13/2025, 10:55:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.89it/s]
2025-03-13 10:55:58,415 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6050 secs
2025-03-13 10:55:58,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5031 secs
2025-03-13 10:55:58,418 [INFO]: {
2025-03-13 10:55:58,418 [INFO]: 	index_key: HNSW15
2025-03-13 10:55:58,418 [INFO]: 	index_param: efSearch=245
2025-03-13 10:55:58,418 [INFO]: 	index_path: knn.index
2025-03-13 10:55:58,418 [INFO]: 	size in bytes: 500122750
2025-03-13 10:55:58,418 [INFO]: 	avg_search_speed_ms: 8.975174540948103
2025-03-13 10:55:58,418 [INFO]: 	99p_search_speed_ms: 11.476415814831851
2025-03-13 10:55:58,418 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:55:58,418 [INFO]: 	nb vectors: 2542
2025-03-13 10:55:58,418 [INFO]: 	vectors dimension: 49152
2025-03-13 10:55:58,418 [INFO]: 	compression ratio: 0.999309741458472
2025-03-13 10:55:58,418 [INFO]: }
2025-03-13 10:55:58,418 [INFO]: 	>>> Finished "Creating the index" in 43.5080 secs
2025-03-13 10:55:58,418 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5432 secs
2025-03-13 10:55:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:55:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 81016 [episode count 6/20]
[retrieval_preprocessing] for episode 59518 [episode count 7/20], we have num_retrieval=np.int64(2571) num_query=np.int64(88)
2025-03-13 10:55:59,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:00,127 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:00
2025-03-13 10:56:00,127 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2031.14it/s]
2025-03-13 10:56:00,164 [INFO]: There are 2571 embeddings of dim 49152
2025-03-13 10:56:00,164 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 10:56:00,164 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:00
2025-03-13 10:56:00,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:00,165 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:56:00,165 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:00,165 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 10:56:00,165 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:00
2025-03-13 10:56:00,165 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:00,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 10:56:00,165 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:00
2025-03-13 10:56:00,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:00,166 [INFO]: 	Creating the index 03/13/2025, 10:56:00
2025-03-13 10:56:00,166 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:00
2025-03-13 10:56:00,169 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 10:56:00,169 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:00
2025-03-13 10:56:00,169 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:56:00,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.50it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.19it/s]100%|██████████| 11/11 [00:02<00:00,  4.40it/s]100%|██████████| 11/11 [00:02<00:00,  5.46it/s]
2025-03-13 10:56:02,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:02
2025-03-13 10:56:33,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1470 secs
2025-03-13 10:56:33,339 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 10:56:33,339 [INFO]: 	Compute fast metrics 03/13/2025, 10:56:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.34it/s]
2025-03-13 10:56:44,847 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5086 secs
2025-03-13 10:56:44,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6799 secs
2025-03-13 10:56:44,849 [INFO]: {
2025-03-13 10:56:44,849 [INFO]: 	index_key: HNSW15
2025-03-13 10:56:44,849 [INFO]: 	index_param: efSearch=344
2025-03-13 10:56:44,849 [INFO]: 	index_path: knn.index
2025-03-13 10:56:44,849 [INFO]: 	size in bytes: 505828330
2025-03-13 10:56:44,849 [INFO]: 	avg_search_speed_ms: 11.30531985986199
2025-03-13 10:56:44,849 [INFO]: 	99p_search_speed_ms: 18.95198607817292
2025-03-13 10:56:44,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:56:44,849 [INFO]: 	nb vectors: 2571
2025-03-13 10:56:44,849 [INFO]: 	vectors dimension: 49152
2025-03-13 10:56:44,849 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-13 10:56:44,849 [INFO]: }
2025-03-13 10:56:44,849 [INFO]: 	>>> Finished "Creating the index" in 44.6835 secs
2025-03-13 10:56:44,849 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7220 secs
2025-03-13 10:56:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 59518 [episode count 7/20]
[retrieval_preprocessing] for episode 27788 [episode count 8/20], we have num_retrieval=np.int64(2520) num_query=np.int64(139)
2025-03-13 10:56:46,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:56:46,734 [INFO]: Launching the whole pipeline 03/13/2025, 10:56:46
2025-03-13 10:56:46,734 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:56:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1803.23it/s]
2025-03-13 10:56:46,762 [INFO]: There are 2520 embeddings of dim 49152
2025-03-13 10:56:46,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 10:56:46,763 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:56:46
2025-03-13 10:56:46,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:56:46,763 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:56:46,763 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:56:46,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:56:46,763 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:56:46
2025-03-13 10:56:46,763 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:56:46,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:56:46,763 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:56:46
2025-03-13 10:56:46,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:56:46,763 [INFO]: 	Creating the index 03/13/2025, 10:56:46
2025-03-13 10:56:46,763 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:56:46
2025-03-13 10:56:46,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:56:46,764 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:56:46
2025-03-13 10:56:46,764 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:56:46,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.24it/s] 60%|██████    | 6/10 [00:00<00:00, 30.97it/s]100%|██████████| 10/10 [00:01<00:00,  4.68it/s]100%|██████████| 10/10 [00:01<00:00,  5.57it/s]
2025-03-13 10:56:48,564 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:56:48
2025-03-13 10:57:17,236 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6717 secs
2025-03-13 10:57:17,236 [INFO]: The best hyperparameters are: efSearch=338
2025-03-13 10:57:17,236 [INFO]: 	Compute fast metrics 03/13/2025, 10:57:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.15it/s]
2025-03-13 10:57:29,188 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9515 secs
2025-03-13 10:57:29,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4254 secs
2025-03-13 10:57:29,190 [INFO]: {
2025-03-13 10:57:29,190 [INFO]: 	index_key: HNSW15
2025-03-13 10:57:29,190 [INFO]: 	index_param: efSearch=338
2025-03-13 10:57:29,190 [INFO]: 	index_path: knn.index
2025-03-13 10:57:29,190 [INFO]: 	size in bytes: 495794350
2025-03-13 10:57:29,190 [INFO]: 	avg_search_speed_ms: 11.21480382076828
2025-03-13 10:57:29,190 [INFO]: 	99p_search_speed_ms: 15.483065282460315
2025-03-13 10:57:29,190 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:57:29,190 [INFO]: 	nb vectors: 2520
2025-03-13 10:57:29,190 [INFO]: 	vectors dimension: 49152
2025-03-13 10:57:29,190 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-13 10:57:29,190 [INFO]: }
2025-03-13 10:57:29,190 [INFO]: 	>>> Finished "Creating the index" in 42.4270 secs
2025-03-13 10:57:29,190 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4561 secs
2025-03-13 10:57:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:57:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 27788 [episode count 8/20]
[retrieval_preprocessing] for episode 69793 [episode count 9/20], we have num_retrieval=np.int64(2525) num_query=np.int64(134)
2025-03-13 10:57:30,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:57:31,101 [INFO]: Launching the whole pipeline 03/13/2025, 10:57:31
2025-03-13 10:57:31,101 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:57:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1192.58it/s]
2025-03-13 10:57:31,134 [INFO]: There are 2525 embeddings of dim 49152
2025-03-13 10:57:31,135 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 10:57:31,135 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:57:31
2025-03-13 10:57:31,135 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:57:31,135 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:57:31,136 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:57:31,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 10:57:31,136 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:57:31
2025-03-13 10:57:31,136 [INFO]: 521.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:57:31,136 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 10:57:31,136 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:57:31
2025-03-13 10:57:31,136 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:57:31,137 [INFO]: 	Creating the index 03/13/2025, 10:57:31
2025-03-13 10:57:31,137 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:57:31
2025-03-13 10:57:31,140 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 10:57:31,141 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:57:31
2025-03-13 10:57:31,141 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:57:31,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.06it/s] 90%|█████████ | 9/10 [00:00<00:00, 41.21it/s]100%|██████████| 10/10 [00:02<00:00,  4.95it/s]
2025-03-13 10:57:33,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:57:33
2025-03-13 10:58:03,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7197 secs
2025-03-13 10:58:03,890 [INFO]: The best hyperparameters are: efSearch=324
2025-03-13 10:58:03,890 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.88it/s]
2025-03-13 10:58:16,278 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3887 secs
2025-03-13 10:58:16,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1392 secs
2025-03-13 10:58:16,280 [INFO]: {
2025-03-13 10:58:16,280 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:16,280 [INFO]: 	index_param: efSearch=324
2025-03-13 10:58:16,280 [INFO]: 	index_path: knn.index
2025-03-13 10:58:16,280 [INFO]: 	size in bytes: 496778050
2025-03-13 10:58:16,280 [INFO]: 	avg_search_speed_ms: 10.314871439921488
2025-03-13 10:58:16,280 [INFO]: 	99p_search_speed_ms: 13.089086438994853
2025-03-13 10:58:16,280 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:16,280 [INFO]: 	nb vectors: 2525
2025-03-13 10:58:16,280 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:16,280 [INFO]: 	compression ratio: 0.9993098527602015
2025-03-13 10:58:16,280 [INFO]: }
2025-03-13 10:58:16,280 [INFO]: 	>>> Finished "Creating the index" in 45.1434 secs
2025-03-13 10:58:16,280 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1793 secs
2025-03-13 10:58:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 69793 [episode count 9/20]
[retrieval_preprocessing] for episode 21164 [episode count 10/20], we have num_retrieval=np.int64(2497) num_query=np.int64(162)
2025-03-13 10:58:17,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:18,081 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:18
2025-03-13 10:58:18,081 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.55it/s]
2025-03-13 10:58:18,114 [INFO]: There are 2497 embeddings of dim 49152
2025-03-13 10:58:18,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-13 10:58:18,115 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:18,115 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:58:18,115 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:18,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:18,115 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,115 [INFO]: 515.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:18,115 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:18,115 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:18
2025-03-13 10:58:18,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:18,115 [INFO]: 	Creating the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,115 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:18
2025-03-13 10:58:18,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:58:18,116 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:18
2025-03-13 10:58:18,116 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:58:18,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.73it/s] 60%|██████    | 6/10 [00:00<00:00, 29.10it/s]100%|██████████| 10/10 [00:02<00:00,  4.13it/s]100%|██████████| 10/10 [00:02<00:00,  4.93it/s]
2025-03-13 10:58:20,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:58:20
2025-03-13 10:58:45,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6653 secs
2025-03-13 10:58:45,815 [INFO]: The best hyperparameters are: efSearch=293
2025-03-13 10:58:45,815 [INFO]: 	Compute fast metrics 03/13/2025, 10:58:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.30it/s]
2025-03-13 10:58:57,365 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5503 secs
2025-03-13 10:58:57,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2504 secs
2025-03-13 10:58:57,367 [INFO]: {
2025-03-13 10:58:57,367 [INFO]: 	index_key: HNSW15
2025-03-13 10:58:57,367 [INFO]: 	index_param: efSearch=293
2025-03-13 10:58:57,367 [INFO]: 	index_path: knn.index
2025-03-13 10:58:57,367 [INFO]: 	size in bytes: 491269090
2025-03-13 10:58:57,367 [INFO]: 	avg_search_speed_ms: 9.988840564026624
2025-03-13 10:58:57,367 [INFO]: 	99p_search_speed_ms: 13.545961119234562
2025-03-13 10:58:57,367 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:58:57,367 [INFO]: 	nb vectors: 2497
2025-03-13 10:58:57,367 [INFO]: 	vectors dimension: 49152
2025-03-13 10:58:57,367 [INFO]: 	compression ratio: 0.9993101255362922
2025-03-13 10:58:57,367 [INFO]: }
2025-03-13 10:58:57,367 [INFO]: 	>>> Finished "Creating the index" in 39.2518 secs
2025-03-13 10:58:57,367 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2864 secs
2025-03-13 10:58:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:58:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 21164 [episode count 10/20]
[retrieval_preprocessing] for episode 6832 [episode count 11/20], we have num_retrieval=np.int64(2504) num_query=np.int64(155)
2025-03-13 10:58:59,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:58:59,420 [INFO]: Launching the whole pipeline 03/13/2025, 10:58:59
2025-03-13 10:58:59,420 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:58:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2194.82it/s]
2025-03-13 10:58:59,448 [INFO]: There are 2504 embeddings of dim 49152
2025-03-13 10:58:59,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 10:58:59,449 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:58:59
2025-03-13 10:58:59,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:58:59,449 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:58:59,449 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:58:59,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:58:59,449 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:58:59
2025-03-13 10:58:59,449 [INFO]: 516.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:58:59,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:58:59,449 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:58:59
2025-03-13 10:58:59,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:58:59,449 [INFO]: 	Creating the index 03/13/2025, 10:58:59
2025-03-13 10:58:59,449 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:58:59
2025-03-13 10:58:59,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 10:58:59,450 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:58:59
2025-03-13 10:58:59,450 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:58:59,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.10it/s] 70%|███████   | 7/10 [00:00<00:00, 34.39it/s]100%|██████████| 10/10 [00:01<00:00,  5.35it/s]
2025-03-13 10:59:01,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:01
2025-03-13 10:59:32,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6668 secs
2025-03-13 10:59:32,990 [INFO]: The best hyperparameters are: efSearch=329
2025-03-13 10:59:32,990 [INFO]: 	Compute fast metrics 03/13/2025, 10:59:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 10:59:46,016 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0264 secs
2025-03-13 10:59:46,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5682 secs
2025-03-13 10:59:46,019 [INFO]: {
2025-03-13 10:59:46,019 [INFO]: 	index_key: HNSW15
2025-03-13 10:59:46,019 [INFO]: 	index_param: efSearch=329
2025-03-13 10:59:46,019 [INFO]: 	index_path: knn.index
2025-03-13 10:59:46,019 [INFO]: 	size in bytes: 492646330
2025-03-13 10:59:46,019 [INFO]: 	avg_search_speed_ms: 12.244127648614684
2025-03-13 10:59:46,019 [INFO]: 	99p_search_speed_ms: 18.60751992091537
2025-03-13 10:59:46,019 [INFO]: 	reconstruction error %: 0.0
2025-03-13 10:59:46,019 [INFO]: 	nb vectors: 2504
2025-03-13 10:59:46,019 [INFO]: 	vectors dimension: 49152
2025-03-13 10:59:46,019 [INFO]: 	compression ratio: 0.9993100567703407
2025-03-13 10:59:46,019 [INFO]: }
2025-03-13 10:59:46,019 [INFO]: 	>>> Finished "Creating the index" in 46.5696 secs
2025-03-13 10:59:46,019 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5992 secs
2025-03-13 10:59:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 10:59:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 6832 [episode count 11/20]
[retrieval_preprocessing] for episode 44732 [episode count 12/20], we have num_retrieval=np.int64(2521) num_query=np.int64(138)
2025-03-13 10:59:48,117 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 10:59:48,598 [INFO]: Launching the whole pipeline 03/13/2025, 10:59:48
2025-03-13 10:59:48,598 [INFO]: Reading total number of vectors and dimension 03/13/2025, 10:59:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1236.16it/s]
2025-03-13 10:59:48,636 [INFO]: There are 2521 embeddings of dim 49152
2025-03-13 10:59:48,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-13 10:59:48,637 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 10:59:48
2025-03-13 10:59:48,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 10:59:48,637 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 10:59:48,637 [INFO]: 		Total: 16.7 minutes
2025-03-13 10:59:48,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 10:59:48,637 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 10:59:48
2025-03-13 10:59:48,637 [INFO]: 520.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 10:59:48,637 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 10:59:48,637 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 10:59:48
2025-03-13 10:59:48,637 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 10:59:48,637 [INFO]: 	Creating the index 03/13/2025, 10:59:48
2025-03-13 10:59:48,638 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 10:59:48
2025-03-13 10:59:48,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 10:59:48,639 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 10:59:48
2025-03-13 10:59:48,639 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 10:59:48,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.01it/s] 50%|█████     | 5/10 [00:00<00:00, 22.87it/s] 90%|█████████ | 9/10 [00:00<00:00, 28.02it/s]100%|██████████| 10/10 [00:02<00:00,  4.72it/s]
2025-03-13 10:59:50,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 10:59:50
2025-03-13 11:00:16,706 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9444 secs
2025-03-13 11:00:16,706 [INFO]: The best hyperparameters are: efSearch=376
2025-03-13 11:00:16,706 [INFO]: 	Compute fast metrics 03/13/2025, 11:00:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.45it/s]
2025-03-13 11:00:28,872 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1659 secs
2025-03-13 11:00:28,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.2347 secs
2025-03-13 11:00:28,874 [INFO]: {
2025-03-13 11:00:28,874 [INFO]: 	index_key: HNSW15
2025-03-13 11:00:28,874 [INFO]: 	index_param: efSearch=376
2025-03-13 11:00:28,874 [INFO]: 	index_path: knn.index
2025-03-13 11:00:28,874 [INFO]: 	size in bytes: 495991090
2025-03-13 11:00:28,874 [INFO]: 	avg_search_speed_ms: 11.127746928414874
2025-03-13 11:00:28,874 [INFO]: 	99p_search_speed_ms: 16.1477659875527
2025-03-13 11:00:28,874 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:00:28,874 [INFO]: 	nb vectors: 2521
2025-03-13 11:00:28,874 [INFO]: 	vectors dimension: 49152
2025-03-13 11:00:28,874 [INFO]: 	compression ratio: 0.9993098222792671
2025-03-13 11:00:28,874 [INFO]: }
2025-03-13 11:00:28,874 [INFO]: 	>>> Finished "Creating the index" in 40.2362 secs
2025-03-13 11:00:28,874 [INFO]: >>> Finished "Launching the whole pipeline" in 40.2754 secs
2025-03-13 11:00:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:00:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 44732 [episode count 12/20]
[retrieval_preprocessing] for episode 24268 [episode count 13/20], we have num_retrieval=np.int64(2500) num_query=np.int64(159)
2025-03-13 11:00:31,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:00:31,647 [INFO]: Launching the whole pipeline 03/13/2025, 11:00:31
2025-03-13 11:00:31,647 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:00:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2050.00it/s]
2025-03-13 11:00:31,674 [INFO]: There are 2500 embeddings of dim 49152
2025-03-13 11:00:31,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:00:31,674 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:00:31
2025-03-13 11:00:31,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:00:31,674 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:00:31,675 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:00:31,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:00:31,675 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:00:31
2025-03-13 11:00:31,675 [INFO]: 515.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:00:31,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:00:31,675 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:00:31
2025-03-13 11:00:31,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:00:31,675 [INFO]: 	Creating the index 03/13/2025, 11:00:31
2025-03-13 11:00:31,675 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:00:31
2025-03-13 11:00:31,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:00:31,676 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:00:31
2025-03-13 11:00:31,676 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:00:31,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.34it/s] 70%|███████   | 7/10 [00:00<00:00, 35.03it/s]100%|██████████| 10/10 [00:01<00:00,  5.48it/s]
2025-03-13 11:00:33,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:00:33
2025-03-13 11:01:08,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1491 secs
2025-03-13 11:01:08,654 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 11:01:08,654 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-13 11:01:21,124 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4700 secs
2025-03-13 11:01:21,127 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4505 secs
2025-03-13 11:01:21,127 [INFO]: {
2025-03-13 11:01:21,127 [INFO]: 	index_key: HNSW15
2025-03-13 11:01:21,127 [INFO]: 	index_param: efSearch=287
2025-03-13 11:01:21,127 [INFO]: 	index_path: knn.index
2025-03-13 11:01:21,127 [INFO]: 	size in bytes: 491859370
2025-03-13 11:01:21,127 [INFO]: 	avg_search_speed_ms: 9.160344988481233
2025-03-13 11:01:21,127 [INFO]: 	99p_search_speed_ms: 11.744866042863576
2025-03-13 11:01:21,127 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:01:21,127 [INFO]: 	nb vectors: 2500
2025-03-13 11:01:21,127 [INFO]: 	vectors dimension: 49152
2025-03-13 11:01:21,127 [INFO]: 	compression ratio: 0.9993100263597703
2025-03-13 11:01:21,127 [INFO]: }
2025-03-13 11:01:21,127 [INFO]: 	>>> Finished "Creating the index" in 49.4521 secs
2025-03-13 11:01:21,127 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4797 secs
2025-03-13 11:01:22: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:01:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 24268 [episode count 13/20]
[retrieval_preprocessing] for episode 60913 [episode count 14/20], we have num_retrieval=np.int64(2500) num_query=np.int64(159)
2025-03-13 11:01:24,034 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:01:24,611 [INFO]: Launching the whole pipeline 03/13/2025, 11:01:24
2025-03-13 11:01:24,611 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:01:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 847.85it/s]
2025-03-13 11:01:24,651 [INFO]: There are 2500 embeddings of dim 49152
2025-03-13 11:01:24,651 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0398 secs
2025-03-13 11:01:24,651 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:01:24
2025-03-13 11:01:24,652 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:01:24,652 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:01:24,652 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:01:24,652 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:01:24,652 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:01:24
2025-03-13 11:01:24,652 [INFO]: 515.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:01:24,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:01:24,652 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:01:24
2025-03-13 11:01:24,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:01:24,652 [INFO]: 	Creating the index 03/13/2025, 11:01:24
2025-03-13 11:01:24,653 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:01:24
2025-03-13 11:01:24,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 11:01:24,655 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:01:24
2025-03-13 11:01:24,655 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:01:24,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.08it/s] 20%|██        | 2/10 [00:00<00:01,  6.95it/s] 30%|███       | 3/10 [00:00<00:00,  7.97it/s] 50%|█████     | 5/10 [00:00<00:00,  9.06it/s] 70%|███████   | 7/10 [00:00<00:00,  9.47it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.05it/s]100%|██████████| 10/10 [00:02<00:00,  3.41it/s]
2025-03-13 11:01:27,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:01:27
2025-03-13 11:01:59,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7977 secs
2025-03-13 11:01:59,394 [INFO]: The best hyperparameters are: efSearch=341
2025-03-13 11:01:59,394 [INFO]: 	Compute fast metrics 03/13/2025, 11:01:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.40it/s]
2025-03-13 11:02:12,097 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7034 secs
2025-03-13 11:02:12,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4441 secs
2025-03-13 11:02:12,100 [INFO]: {
2025-03-13 11:02:12,100 [INFO]: 	index_key: HNSW15
2025-03-13 11:02:12,100 [INFO]: 	index_param: efSearch=341
2025-03-13 11:02:12,100 [INFO]: 	index_path: knn.index
2025-03-13 11:02:12,100 [INFO]: 	size in bytes: 491859370
2025-03-13 11:02:12,100 [INFO]: 	avg_search_speed_ms: 10.085054298894736
2025-03-13 11:02:12,100 [INFO]: 	99p_search_speed_ms: 13.438682628329843
2025-03-13 11:02:12,100 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:02:12,100 [INFO]: 	nb vectors: 2500
2025-03-13 11:02:12,100 [INFO]: 	vectors dimension: 49152
2025-03-13 11:02:12,100 [INFO]: 	compression ratio: 0.9993100263597703
2025-03-13 11:02:12,100 [INFO]: }
2025-03-13 11:02:12,100 [INFO]: 	>>> Finished "Creating the index" in 47.4473 secs
2025-03-13 11:02:12,100 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4885 secs
2025-03-13 11:02:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:02:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 60913 [episode count 14/20]
[retrieval_preprocessing] for episode 60917 [episode count 15/20], we have num_retrieval=np.int64(2578) num_query=np.int64(81)
2025-03-13 11:02:15,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:02:15,713 [INFO]: Launching the whole pipeline 03/13/2025, 11:02:15
2025-03-13 11:02:15,713 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:02:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 990.39it/s]
2025-03-13 11:02:15,741 [INFO]: There are 2578 embeddings of dim 49152
2025-03-13 11:02:15,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-13 11:02:15,742 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:02:15
2025-03-13 11:02:15,742 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:02:15,742 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:02:15,742 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:02:15,742 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:02:15,742 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:02:15
2025-03-13 11:02:15,743 [INFO]: 532.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:02:15,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:02:15,743 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:02:15
2025-03-13 11:02:15,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:02:15,743 [INFO]: 	Creating the index 03/13/2025, 11:02:15
2025-03-13 11:02:15,743 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:02:15
2025-03-13 11:02:15,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-13 11:02:15,746 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:02:15
2025-03-13 11:02:15,746 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:02:15,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.56it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.04it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.60it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.33it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.55it/s]100%|██████████| 11/11 [00:02<00:00,  2.47it/s]100%|██████████| 11/11 [00:02<00:00,  3.96it/s]
2025-03-13 11:02:18,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:02:18
2025-03-13 11:02:49,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6254 secs
2025-03-13 11:02:49,155 [INFO]: The best hyperparameters are: efSearch=355
2025-03-13 11:02:49,155 [INFO]: 	Compute fast metrics 03/13/2025, 11:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-13 11:03:02,330 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1749 secs
2025-03-13 11:03:02,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5868 secs
2025-03-13 11:03:02,333 [INFO]: {
2025-03-13 11:03:02,333 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:02,333 [INFO]: 	index_param: efSearch=355
2025-03-13 11:03:02,333 [INFO]: 	index_path: knn.index
2025-03-13 11:03:02,333 [INFO]: 	size in bytes: 507205690
2025-03-13 11:03:02,333 [INFO]: 	avg_search_speed_ms: 11.140755764291702
2025-03-13 11:03:02,333 [INFO]: 	99p_search_speed_ms: 19.402655977755764
2025-03-13 11:03:02,333 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:02,333 [INFO]: 	nb vectors: 2578
2025-03-13 11:03:02,333 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:02,333 [INFO]: 	compression ratio: 0.9993094202078057
2025-03-13 11:03:02,333 [INFO]: }
2025-03-13 11:03:02,333 [INFO]: 	>>> Finished "Creating the index" in 46.5896 secs
2025-03-13 11:03:02,333 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6200 secs
2025-03-13 11:03:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 60917 [episode count 15/20]
[retrieval_preprocessing] for episode 8188 [episode count 16/20], we have num_retrieval=np.int64(2558) num_query=np.int64(101)
2025-03-13 11:03:04,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:04,805 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:04
2025-03-13 11:03:04,805 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1671.04it/s]
2025-03-13 11:03:04,838 [INFO]: There are 2558 embeddings of dim 49152
2025-03-13 11:03:04,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-13 11:03:04,839 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:04,839 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:03:04,840 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:04,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:03:04,840 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,840 [INFO]: 527.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:04,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:03:04,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:04
2025-03-13 11:03:04,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:04,841 [INFO]: 	Creating the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,841 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:04
2025-03-13 11:03:04,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 11:03:04,845 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:04
2025-03-13 11:03:04,845 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:04,845 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.79it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.81it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.65it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.70it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.52it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.23it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.96it/s]100%|██████████| 11/11 [00:03<00:00,  1.79it/s]100%|██████████| 11/11 [00:03<00:00,  3.48it/s]
2025-03-13 11:03:08,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:08
2025-03-13 11:03:39,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3361 secs
2025-03-13 11:03:39,350 [INFO]: The best hyperparameters are: efSearch=356
2025-03-13 11:03:39,350 [INFO]: 	Compute fast metrics 03/13/2025, 11:03:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 11:03:53,540 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1896 secs
2025-03-13 11:03:53,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6971 secs
2025-03-13 11:03:53,542 [INFO]: {
2025-03-13 11:03:53,542 [INFO]: 	index_key: HNSW15
2025-03-13 11:03:53,542 [INFO]: 	index_param: efSearch=356
2025-03-13 11:03:53,542 [INFO]: 	index_path: knn.index
2025-03-13 11:03:53,542 [INFO]: 	size in bytes: 503270710
2025-03-13 11:03:53,542 [INFO]: 	avg_search_speed_ms: 11.71036101566885
2025-03-13 11:03:53,542 [INFO]: 	99p_search_speed_ms: 26.33917395258324
2025-03-13 11:03:53,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:03:53,542 [INFO]: 	nb vectors: 2558
2025-03-13 11:03:53,542 [INFO]: 	vectors dimension: 49152
2025-03-13 11:03:53,542 [INFO]: 	compression ratio: 0.999309624039118
2025-03-13 11:03:53,542 [INFO]: }
2025-03-13 11:03:53,542 [INFO]: 	>>> Finished "Creating the index" in 48.7010 secs
2025-03-13 11:03:53,542 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7373 secs
2025-03-13 11:03:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:03:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 8188 [episode count 16/20]
[retrieval_preprocessing] for episode 87769 [episode count 17/20], we have num_retrieval=np.int64(2508) num_query=np.int64(151)
2025-03-13 11:03:56,657 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:03:57,057 [INFO]: Launching the whole pipeline 03/13/2025, 11:03:57
2025-03-13 11:03:57,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:03:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1003.66it/s]
2025-03-13 11:03:57,085 [INFO]: There are 2508 embeddings of dim 49152
2025-03-13 11:03:57,086 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 11:03:57,086 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:03:57
2025-03-13 11:03:57,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:03:57,087 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:03:57,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:03:57,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:03:57,087 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:03:57
2025-03-13 11:03:57,087 [INFO]: 517.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:03:57,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:03:57,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:03:57
2025-03-13 11:03:57,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:03:57,088 [INFO]: 	Creating the index 03/13/2025, 11:03:57
2025-03-13 11:03:57,089 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:03:57
2025-03-13 11:03:57,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0039 secs
2025-03-13 11:03:57,093 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:03:57
2025-03-13 11:03:57,093 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:03:57,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.92it/s] 30%|███       | 3/10 [00:00<00:00,  9.11it/s] 50%|█████     | 5/10 [00:00<00:00, 10.33it/s] 70%|███████   | 7/10 [00:00<00:00, 11.57it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.32it/s]100%|██████████| 10/10 [00:02<00:00,  3.98it/s]
2025-03-13 11:03:59,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:03:59
2025-03-13 11:04:30,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1900 secs
2025-03-13 11:04:30,804 [INFO]: The best hyperparameters are: efSearch=363
2025-03-13 11:04:30,804 [INFO]: 	Compute fast metrics 03/13/2025, 11:04:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-13 11:04:44,439 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6353 secs
2025-03-13 11:04:44,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3484 secs
2025-03-13 11:04:44,442 [INFO]: {
2025-03-13 11:04:44,442 [INFO]: 	index_key: HNSW15
2025-03-13 11:04:44,442 [INFO]: 	index_param: efSearch=363
2025-03-13 11:04:44,442 [INFO]: 	index_path: knn.index
2025-03-13 11:04:44,442 [INFO]: 	size in bytes: 493433350
2025-03-13 11:04:44,442 [INFO]: 	avg_search_speed_ms: 11.066626808121883
2025-03-13 11:04:44,442 [INFO]: 	99p_search_speed_ms: 16.421659076586366
2025-03-13 11:04:44,442 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:04:44,442 [INFO]: 	nb vectors: 2508
2025-03-13 11:04:44,442 [INFO]: 	vectors dimension: 49152
2025-03-13 11:04:44,442 [INFO]: 	compression ratio: 0.9993099655708314
2025-03-13 11:04:44,442 [INFO]: }
2025-03-13 11:04:44,442 [INFO]: 	>>> Finished "Creating the index" in 47.3533 secs
2025-03-13 11:04:44,442 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3845 secs
2025-03-13 11:04:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:04:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 87769 [episode count 17/20]
[retrieval_preprocessing] for episode 90342 [episode count 18/20], we have num_retrieval=np.int64(2520) num_query=np.int64(139)
2025-03-13 11:04:47,669 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:04:48,057 [INFO]: Launching the whole pipeline 03/13/2025, 11:04:48
2025-03-13 11:04:48,057 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:04:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 11:04:48,084 [INFO]: There are 2520 embeddings of dim 49152
2025-03-13 11:04:48,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-13 11:04:48,085 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:04:48
2025-03-13 11:04:48,085 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:04:48,085 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:04:48,085 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:04:48,085 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:04:48,086 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:04:48
2025-03-13 11:04:48,086 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:04:48,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:04:48,086 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:04:48
2025-03-13 11:04:48,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:04:48,086 [INFO]: 	Creating the index 03/13/2025, 11:04:48
2025-03-13 11:04:48,087 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:04:48
2025-03-13 11:04:48,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:04:48,090 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:04:48
2025-03-13 11:04:48,090 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:04:48,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.21it/s] 30%|███       | 3/10 [00:00<00:00, 10.52it/s] 50%|█████     | 5/10 [00:00<00:00, 11.33it/s] 70%|███████   | 7/10 [00:00<00:00, 11.59it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.58it/s]100%|██████████| 10/10 [00:02<00:00,  3.75it/s]
2025-03-13 11:04:50,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:04:50
2025-03-13 11:05:25,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6059 secs
2025-03-13 11:05:25,376 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 11:05:25,376 [INFO]: 	Compute fast metrics 03/13/2025, 11:05:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s]
2025-03-13 11:05:38,178 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8025 secs
2025-03-13 11:05:38,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0904 secs
2025-03-13 11:05:38,181 [INFO]: {
2025-03-13 11:05:38,181 [INFO]: 	index_key: HNSW15
2025-03-13 11:05:38,181 [INFO]: 	index_param: efSearch=305
2025-03-13 11:05:38,181 [INFO]: 	index_path: knn.index
2025-03-13 11:05:38,181 [INFO]: 	size in bytes: 495794350
2025-03-13 11:05:38,181 [INFO]: 	avg_search_speed_ms: 9.661131765207518
2025-03-13 11:05:38,181 [INFO]: 	99p_search_speed_ms: 13.60350181814283
2025-03-13 11:05:38,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:05:38,181 [INFO]: 	nb vectors: 2520
2025-03-13 11:05:38,181 [INFO]: 	vectors dimension: 49152
2025-03-13 11:05:38,181 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-13 11:05:38,181 [INFO]: }
2025-03-13 11:05:38,181 [INFO]: 	>>> Finished "Creating the index" in 50.0944 secs
2025-03-13 11:05:38,181 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1237 secs
2025-03-13 11:05:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:05:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 90342 [episode count 18/20]
[retrieval_preprocessing] for episode 14070 [episode count 19/20], we have num_retrieval=np.int64(2527) num_query=np.int64(132)
2025-03-13 11:05:40,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:05:40,598 [INFO]: Launching the whole pipeline 03/13/2025, 11:05:40
2025-03-13 11:05:40,598 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:05:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1704.31it/s]
2025-03-13 11:05:40,622 [INFO]: There are 2527 embeddings of dim 49152
2025-03-13 11:05:40,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:05:40,622 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:05:40
2025-03-13 11:05:40,622 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:05:40,622 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 11:05:40,622 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:05:40,622 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:05:40,623 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:05:40
2025-03-13 11:05:40,623 [INFO]: 521.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:05:40,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:05:40,623 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:05:40
2025-03-13 11:05:40,623 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:05:40,623 [INFO]: 	Creating the index 03/13/2025, 11:05:40
2025-03-13 11:05:40,623 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:05:40
2025-03-13 11:05:40,624 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:05:40,624 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:05:40
2025-03-13 11:05:40,624 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 11:05:40,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.22it/s] 30%|███       | 3/10 [00:00<00:00, 10.09it/s] 50%|█████     | 5/10 [00:00<00:00, 10.90it/s] 70%|███████   | 7/10 [00:00<00:00, 11.35it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.51it/s]100%|██████████| 10/10 [00:02<00:00,  4.13it/s]
2025-03-13 11:05:43,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:05:43
2025-03-13 11:06:13,073 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0210 secs
2025-03-13 11:06:13,073 [INFO]: The best hyperparameters are: efSearch=376
2025-03-13 11:06:13,073 [INFO]: 	Compute fast metrics 03/13/2025, 11:06:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-13 11:06:25,826 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7531 secs
2025-03-13 11:06:25,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.2050 secs
2025-03-13 11:06:25,829 [INFO]: {
2025-03-13 11:06:25,829 [INFO]: 	index_key: HNSW15
2025-03-13 11:06:25,829 [INFO]: 	index_param: efSearch=376
2025-03-13 11:06:25,829 [INFO]: 	index_path: knn.index
2025-03-13 11:06:25,829 [INFO]: 	size in bytes: 497171530
2025-03-13 11:06:25,829 [INFO]: 	avg_search_speed_ms: 10.988352112318543
2025-03-13 11:06:25,829 [INFO]: 	99p_search_speed_ms: 16.392793974373472
2025-03-13 11:06:25,829 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:06:25,829 [INFO]: 	nb vectors: 2527
2025-03-13 11:06:25,829 [INFO]: 	vectors dimension: 49152
2025-03-13 11:06:25,829 [INFO]: 	compression ratio: 0.999309867964483
2025-03-13 11:06:25,829 [INFO]: }
2025-03-13 11:06:25,829 [INFO]: 	>>> Finished "Creating the index" in 45.2064 secs
2025-03-13 11:06:25,829 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2311 secs
2025-03-13 11:06:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:06:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 14070 [episode count 19/20]
2025-03-13 11:06:28: [retrieval_preprocessing] finished for 3816161570_close_drawer [chosen_id count 0/260]
2025-03-13 11:06:31: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3816161570_pull_box_out [chosen_id count 1/260]
2025-03-13 11:06:31: [retrieval_preprocessing] we have num_total=3734 embedding_dim=49152
[retrieval_preprocessing] for episode 50188 [episode count 0/20], we have num_retrieval=np.int64(3543) num_query=np.int64(191)
2025-03-13 11:06:32,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:06:33,359 [INFO]: Launching the whole pipeline 03/13/2025, 11:06:33
2025-03-13 11:06:33,359 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2202.89it/s]
2025-03-13 11:06:33,383 [INFO]: There are 3543 embeddings of dim 49152
2025-03-13 11:06:33,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 11:06:33,383 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:06:33
2025-03-13 11:06:33,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:06:33,383 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:06:33,383 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:06:33,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:06:33,383 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:06:33
2025-03-13 11:06:33,383 [INFO]: 731.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:06:33,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:06:33,383 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:06:33
2025-03-13 11:06:33,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:06:33,383 [INFO]: 	Creating the index 03/13/2025, 11:06:33
2025-03-13 11:06:33,383 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:06:33
2025-03-13 11:06:33,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:06:33,385 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:06:33
2025-03-13 11:06:33,385 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:06:33,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.99it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.13it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.03it/s] 50%|█████     | 7/14 [00:00<00:00, 10.51it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.63it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.40it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.00it/s]100%|██████████| 14/14 [00:03<00:00,  3.80it/s]
2025-03-13 11:06:37,080 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:06:37
2025-03-13 11:07:10,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4568 secs
2025-03-13 11:07:10,538 [INFO]: The best hyperparameters are: efSearch=354
2025-03-13 11:07:10,538 [INFO]: 	Compute fast metrics 03/13/2025, 11:07:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s]
2025-03-13 11:07:23,855 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3169 secs
2025-03-13 11:07:23,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4723 secs
2025-03-13 11:07:23,858 [INFO]: {
2025-03-13 11:07:23,858 [INFO]: 	index_key: HNSW15
2025-03-13 11:07:23,858 [INFO]: 	index_param: efSearch=354
2025-03-13 11:07:23,858 [INFO]: 	index_path: knn.index
2025-03-13 11:07:23,858 [INFO]: 	size in bytes: 697063390
2025-03-13 11:07:23,858 [INFO]: 	avg_search_speed_ms: 11.034418151366461
2025-03-13 11:07:23,858 [INFO]: 	99p_search_speed_ms: 14.255379803944384
2025-03-13 11:07:23,858 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:07:23,858 [INFO]: 	nb vectors: 3543
2025-03-13 11:07:23,858 [INFO]: 	vectors dimension: 49152
2025-03-13 11:07:23,858 [INFO]: 	compression ratio: 0.9993096094173013
2025-03-13 11:07:23,858 [INFO]: }
2025-03-13 11:07:23,858 [INFO]: 	>>> Finished "Creating the index" in 50.4744 secs
2025-03-13 11:07:23,858 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4989 secs
2025-03-13 11:07:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:07:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 50188 [episode count 0/20]
[retrieval_preprocessing] for episode 61965 [episode count 1/20], we have num_retrieval=np.int64(3530) num_query=np.int64(204)
2025-03-13 11:07:28,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:07:28,880 [INFO]: Launching the whole pipeline 03/13/2025, 11:07:28
2025-03-13 11:07:28,881 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:07:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1709.17it/s]
2025-03-13 11:07:28,904 [INFO]: There are 3530 embeddings of dim 49152
2025-03-13 11:07:28,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 11:07:28,904 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:07:28
2025-03-13 11:07:28,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:07:28,904 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:07:28,904 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:07:28,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:07:28,904 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:07:28
2025-03-13 11:07:28,904 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:07:28,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:07:28,904 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:07:28
2025-03-13 11:07:28,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:07:28,905 [INFO]: 	Creating the index 03/13/2025, 11:07:28
2025-03-13 11:07:28,905 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:07:28
2025-03-13 11:07:28,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:07:28,906 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:07:28
2025-03-13 11:07:28,906 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:07:28,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.88it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.45it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.29it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.76it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.99it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.58it/s] 50%|█████     | 7/14 [00:00<00:00,  7.75it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.91it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.07it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.69it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.77it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.00it/s]100%|██████████| 14/14 [00:04<00:00,  1.23it/s]100%|██████████| 14/14 [00:04<00:00,  3.27it/s]
2025-03-13 11:07:33,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:07:33
2025-03-13 11:08:09,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9969 secs
2025-03-13 11:08:09,196 [INFO]: The best hyperparameters are: efSearch=305
2025-03-13 11:08:09,197 [INFO]: 	Compute fast metrics 03/13/2025, 11:08:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
2025-03-13 11:08:22,496 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2996 secs
2025-03-13 11:08:22,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5929 secs
2025-03-13 11:08:22,499 [INFO]: {
2025-03-13 11:08:22,499 [INFO]: 	index_key: HNSW15
2025-03-13 11:08:22,499 [INFO]: 	index_param: efSearch=305
2025-03-13 11:08:22,499 [INFO]: 	index_path: knn.index
2025-03-13 11:08:22,499 [INFO]: 	size in bytes: 694505770
2025-03-13 11:08:22,499 [INFO]: 	avg_search_speed_ms: 9.79290250529162
2025-03-13 11:08:22,499 [INFO]: 	99p_search_speed_ms: 12.511602649465203
2025-03-13 11:08:22,499 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:08:22,499 [INFO]: 	nb vectors: 3530
2025-03-13 11:08:22,499 [INFO]: 	vectors dimension: 49152
2025-03-13 11:08:22,499 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-13 11:08:22,499 [INFO]: }
2025-03-13 11:08:22,499 [INFO]: 	>>> Finished "Creating the index" in 53.5943 secs
2025-03-13 11:08:22,499 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6185 secs
2025-03-13 11:08:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:08:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 61965 [episode count 1/20]
[retrieval_preprocessing] for episode 55325 [episode count 2/20], we have num_retrieval=np.int64(3503) num_query=np.int64(231)
2025-03-13 11:08:24,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:08:25,406 [INFO]: Launching the whole pipeline 03/13/2025, 11:08:25
2025-03-13 11:08:25,407 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:08:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.83it/s]
2025-03-13 11:08:25,436 [INFO]: There are 3503 embeddings of dim 49152
2025-03-13 11:08:25,436 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 11:08:25,436 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:08:25
2025-03-13 11:08:25,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:08:25,436 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:08:25,436 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:08:25,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:08:25,436 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:08:25
2025-03-13 11:08:25,436 [INFO]: 722.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:08:25,436 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:08:25,436 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:08:25
2025-03-13 11:08:25,437 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:08:25,437 [INFO]: 	Creating the index 03/13/2025, 11:08:25
2025-03-13 11:08:25,437 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:08:25
2025-03-13 11:08:25,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:08:25,438 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:08:25
2025-03-13 11:08:25,438 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:08:25,438 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.45it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.56it/s] 79%|███████▊  | 11/14 [00:00<00:00, 37.46it/s]100%|██████████| 14/14 [00:03<00:00,  4.59it/s]
2025-03-13 11:08:28,492 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:08:28
2025-03-13 11:09:11,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2230 secs
2025-03-13 11:09:11,716 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 11:09:11,716 [INFO]: 	Compute fast metrics 03/13/2025, 11:09:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.93it/s]
2025-03-13 11:09:25,645 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9284 secs
2025-03-13 11:09:25,648 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2100 secs
2025-03-13 11:09:25,648 [INFO]: {
2025-03-13 11:09:25,648 [INFO]: 	index_key: HNSW15
2025-03-13 11:09:25,648 [INFO]: 	index_param: efSearch=281
2025-03-13 11:09:25,648 [INFO]: 	index_path: knn.index
2025-03-13 11:09:25,648 [INFO]: 	size in bytes: 689193730
2025-03-13 11:09:25,648 [INFO]: 	avg_search_speed_ms: 11.089353213507987
2025-03-13 11:09:25,648 [INFO]: 	99p_search_speed_ms: 16.786807337775837
2025-03-13 11:09:25,648 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:09:25,648 [INFO]: 	nb vectors: 3503
2025-03-13 11:09:25,648 [INFO]: 	vectors dimension: 49152
2025-03-13 11:09:25,648 [INFO]: 	compression ratio: 0.999309474275107
2025-03-13 11:09:25,648 [INFO]: }
2025-03-13 11:09:25,648 [INFO]: 	>>> Finished "Creating the index" in 60.2116 secs
2025-03-13 11:09:25,648 [INFO]: >>> Finished "Launching the whole pipeline" in 60.2416 secs
2025-03-13 11:09:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:09:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 55325 [episode count 2/20]
[retrieval_preprocessing] for episode 77066 [episode count 3/20], we have num_retrieval=np.int64(3507) num_query=np.int64(227)
2025-03-13 11:09:28,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:09:28,494 [INFO]: Launching the whole pipeline 03/13/2025, 11:09:28
2025-03-13 11:09:28,494 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:09:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.33it/s]
2025-03-13 11:09:28,523 [INFO]: There are 3507 embeddings of dim 49152
2025-03-13 11:09:28,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:09:28,523 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:09:28
2025-03-13 11:09:28,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:09:28,523 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:09:28,523 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:09:28,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:09:28,524 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:09:28
2025-03-13 11:09:28,524 [INFO]: 723.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:09:28,524 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:09:28,524 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:09:28
2025-03-13 11:09:28,524 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:09:28,524 [INFO]: 	Creating the index 03/13/2025, 11:09:28
2025-03-13 11:09:28,524 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:09:28
2025-03-13 11:09:28,525 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:09:28,525 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:09:28
2025-03-13 11:09:28,525 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:09:28,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.61it/s] 57%|█████▋    | 8/14 [00:00<00:00, 38.85it/s]100%|██████████| 14/14 [00:02<00:00,  4.07it/s]100%|██████████| 14/14 [00:02<00:00,  4.93it/s]
2025-03-13 11:09:31,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:09:31
2025-03-13 11:10:07,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9192 secs
2025-03-13 11:10:07,509 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 11:10:07,509 [INFO]: 	Compute fast metrics 03/13/2025, 11:10:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 11:10:19,627 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1180 secs
2025-03-13 11:10:19,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1045 secs
2025-03-13 11:10:19,630 [INFO]: {
2025-03-13 11:10:19,630 [INFO]: 	index_key: HNSW15
2025-03-13 11:10:19,630 [INFO]: 	index_param: efSearch=264
2025-03-13 11:10:19,630 [INFO]: 	index_path: knn.index
2025-03-13 11:10:19,630 [INFO]: 	size in bytes: 689980690
2025-03-13 11:10:19,630 [INFO]: 	avg_search_speed_ms: 9.569718139736276
2025-03-13 11:10:19,630 [INFO]: 	99p_search_speed_ms: 13.987870439887047
2025-03-13 11:10:19,630 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:10:19,630 [INFO]: 	nb vectors: 3507
2025-03-13 11:10:19,630 [INFO]: 	vectors dimension: 49152
2025-03-13 11:10:19,630 [INFO]: 	compression ratio: 0.9993094966179416
2025-03-13 11:10:19,630 [INFO]: }
2025-03-13 11:10:19,630 [INFO]: 	>>> Finished "Creating the index" in 51.1062 secs
2025-03-13 11:10:19,630 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1357 secs
2025-03-13 11:10:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:10:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 77066 [episode count 3/20]
[retrieval_preprocessing] for episode 3318 [episode count 4/20], we have num_retrieval=np.int64(3576) num_query=np.int64(158)
2025-03-13 11:10:22,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:10:22,535 [INFO]: Launching the whole pipeline 03/13/2025, 11:10:22
2025-03-13 11:10:22,535 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:10:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-13 11:10:22,566 [INFO]: There are 3576 embeddings of dim 49152
2025-03-13 11:10:22,566 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-13 11:10:22,566 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:10:22
2025-03-13 11:10:22,566 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:10:22,566 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:10:22,566 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:10:22,566 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:10:22,566 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:10:22
2025-03-13 11:10:22,566 [INFO]: 738.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:10:22,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:10:22,566 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:10:22
2025-03-13 11:10:22,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:10:22,566 [INFO]: 	Creating the index 03/13/2025, 11:10:22
2025-03-13 11:10:22,567 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:10:22
2025-03-13 11:10:22,567 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:10:22,568 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:10:22
2025-03-13 11:10:22,568 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:10:22,568 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.31it/s] 40%|████      | 6/15 [00:00<00:00, 30.92it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.67it/s]100%|██████████| 15/15 [00:03<00:00,  3.61it/s]100%|██████████| 15/15 [00:03<00:00,  4.98it/s]
2025-03-13 11:10:25,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:10:25
2025-03-13 11:11:02,327 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7446 secs
2025-03-13 11:11:02,327 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 11:11:02,327 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.13it/s]
2025-03-13 11:11:14,278 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9511 secs
2025-03-13 11:11:14,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7129 secs
2025-03-13 11:11:14,281 [INFO]: {
2025-03-13 11:11:14,281 [INFO]: 	index_key: HNSW15
2025-03-13 11:11:14,281 [INFO]: 	index_param: efSearch=255
2025-03-13 11:11:14,281 [INFO]: 	index_path: knn.index
2025-03-13 11:11:14,281 [INFO]: 	size in bytes: 703555930
2025-03-13 11:11:14,281 [INFO]: 	avg_search_speed_ms: 9.331347465118977
2025-03-13 11:11:14,281 [INFO]: 	99p_search_speed_ms: 15.480513626243916
2025-03-13 11:11:14,281 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:11:14,281 [INFO]: 	nb vectors: 3576
2025-03-13 11:11:14,281 [INFO]: 	vectors dimension: 49152
2025-03-13 11:11:14,281 [INFO]: 	compression ratio: 0.9993096184975656
2025-03-13 11:11:14,281 [INFO]: }
2025-03-13 11:11:14,281 [INFO]: 	>>> Finished "Creating the index" in 51.7144 secs
2025-03-13 11:11:14,281 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7457 secs
2025-03-13 11:11:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:11:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 3318 [episode count 4/20]
[retrieval_preprocessing] for episode 29034 [episode count 5/20], we have num_retrieval=np.int64(3520) num_query=np.int64(214)
2025-03-13 11:11:16,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:11:16,714 [INFO]: Launching the whole pipeline 03/13/2025, 11:11:16
2025-03-13 11:11:16,714 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:11:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1173.23it/s]
2025-03-13 11:11:16,743 [INFO]: There are 3520 embeddings of dim 49152
2025-03-13 11:11:16,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 11:11:16,744 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:11:16,744 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:11:16,744 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:11:16,744 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 11:11:16,744 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,744 [INFO]: 726.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:11:16,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:11:16,745 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:11:16
2025-03-13 11:11:16,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:11:16,745 [INFO]: 	Creating the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,745 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:11:16
2025-03-13 11:11:16,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:11:16,749 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:11:16
2025-03-13 11:11:16,749 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:11:16,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.67it/s] 50%|█████     | 7/14 [00:00<00:00, 35.46it/s] 86%|████████▌ | 12/14 [00:00<00:00, 40.81it/s]100%|██████████| 14/14 [00:02<00:00,  4.83it/s]
2025-03-13 11:11:19,651 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:11:19
2025-03-13 11:11:53,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0149 secs
2025-03-13 11:11:53,667 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 11:11:53,667 [INFO]: 	Compute fast metrics 03/13/2025, 11:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-13 11:12:06,217 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5502 secs
2025-03-13 11:12:06,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4717 secs
2025-03-13 11:12:06,221 [INFO]: {
2025-03-13 11:12:06,221 [INFO]: 	index_key: HNSW15
2025-03-13 11:12:06,221 [INFO]: 	index_param: efSearch=288
2025-03-13 11:12:06,221 [INFO]: 	index_path: knn.index
2025-03-13 11:12:06,221 [INFO]: 	size in bytes: 692538310
2025-03-13 11:12:06,221 [INFO]: 	avg_search_speed_ms: 11.053616919597944
2025-03-13 11:12:06,221 [INFO]: 	99p_search_speed_ms: 16.932272084523
2025-03-13 11:12:06,221 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:12:06,221 [INFO]: 	nb vectors: 3520
2025-03-13 11:12:06,221 [INFO]: 	vectors dimension: 49152
2025-03-13 11:12:06,221 [INFO]: 	compression ratio: 0.9993095688814674
2025-03-13 11:12:06,221 [INFO]: }
2025-03-13 11:12:06,221 [INFO]: 	>>> Finished "Creating the index" in 49.4759 secs
2025-03-13 11:12:06,221 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5068 secs
2025-03-13 11:12:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:12:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 29034 [episode count 5/20]
[retrieval_preprocessing] for episode 59364 [episode count 6/20], we have num_retrieval=np.int64(3532) num_query=np.int64(202)
2025-03-13 11:12:10,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:12:11,373 [INFO]: Launching the whole pipeline 03/13/2025, 11:12:11
2025-03-13 11:12:11,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:12:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1676.38it/s]
2025-03-13 11:12:11,398 [INFO]: There are 3532 embeddings of dim 49152
2025-03-13 11:12:11,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:12:11,399 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:12:11,399 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:12:11,399 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:12:11,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:12:11,399 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,399 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:12:11,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:12:11,399 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:12:11
2025-03-13 11:12:11,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:12:11,399 [INFO]: 	Creating the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,399 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:12:11
2025-03-13 11:12:11,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:12:11,400 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:12:11
2025-03-13 11:12:11,400 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:12:11,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.30it/s] 43%|████▎     | 6/14 [00:00<00:00, 26.70it/s] 79%|███████▊  | 11/14 [00:00<00:00, 34.23it/s]100%|██████████| 14/14 [00:03<00:00,  3.92it/s]
2025-03-13 11:12:14,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:12:14
2025-03-13 11:12:49,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5172 secs
2025-03-13 11:12:49,498 [INFO]: The best hyperparameters are: efSearch=286
2025-03-13 11:12:49,498 [INFO]: 	Compute fast metrics 03/13/2025, 11:12:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-13 11:13:03,953 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4549 secs
2025-03-13 11:13:03,955 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5552 secs
2025-03-13 11:13:03,956 [INFO]: {
2025-03-13 11:13:03,956 [INFO]: 	index_key: HNSW15
2025-03-13 11:13:03,956 [INFO]: 	index_param: efSearch=286
2025-03-13 11:13:03,956 [INFO]: 	index_path: knn.index
2025-03-13 11:13:03,956 [INFO]: 	size in bytes: 694899250
2025-03-13 11:13:03,956 [INFO]: 	avg_search_speed_ms: 11.171667267002963
2025-03-13 11:13:03,956 [INFO]: 	99p_search_speed_ms: 21.526850282680243
2025-03-13 11:13:03,956 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:13:03,956 [INFO]: 	nb vectors: 3532
2025-03-13 11:13:03,956 [INFO]: 	vectors dimension: 49152
2025-03-13 11:13:03,956 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-13 11:13:03,956 [INFO]: }
2025-03-13 11:13:03,956 [INFO]: 	>>> Finished "Creating the index" in 52.5569 secs
2025-03-13 11:13:03,956 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5824 secs
2025-03-13 11:13:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:13:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 59364 [episode count 6/20]
[retrieval_preprocessing] for episode 36273 [episode count 7/20], we have num_retrieval=np.int64(3527) num_query=np.int64(207)
2025-03-13 11:13:06,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:13:06,915 [INFO]: Launching the whole pipeline 03/13/2025, 11:13:06
2025-03-13 11:13:06,915 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:13:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1782.53it/s]
2025-03-13 11:13:06,946 [INFO]: There are 3527 embeddings of dim 49152
2025-03-13 11:13:06,946 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 11:13:06,946 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:13:06
2025-03-13 11:13:06,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:13:06,947 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:13:06,947 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:13:06,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:13:06,947 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:13:06
2025-03-13 11:13:06,947 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:13:06,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:13:06,948 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:13:06
2025-03-13 11:13:06,948 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:13:06,948 [INFO]: 	Creating the index 03/13/2025, 11:13:06
2025-03-13 11:13:06,948 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:13:06
2025-03-13 11:13:06,950 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:13:06,950 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:13:06
2025-03-13 11:13:06,950 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:13:06,950 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.75it/s] 43%|████▎     | 6/14 [00:00<00:00, 26.46it/s] 71%|███████▏  | 10/14 [00:00<00:00, 31.63it/s]100%|██████████| 14/14 [00:03<00:00,  2.94it/s]100%|██████████| 14/14 [00:03<00:00,  4.06it/s]
2025-03-13 11:13:10,402 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:13:10
2025-03-13 11:13:46,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3199 secs
2025-03-13 11:13:46,723 [INFO]: The best hyperparameters are: efSearch=251
2025-03-13 11:13:46,723 [INFO]: 	Compute fast metrics 03/13/2025, 11:13:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-13 11:14:00,088 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3654 secs
2025-03-13 11:14:00,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1405 secs
2025-03-13 11:14:00,091 [INFO]: {
2025-03-13 11:14:00,091 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:00,091 [INFO]: 	index_param: efSearch=251
2025-03-13 11:14:00,091 [INFO]: 	index_path: knn.index
2025-03-13 11:14:00,091 [INFO]: 	size in bytes: 693915550
2025-03-13 11:14:00,091 [INFO]: 	avg_search_speed_ms: 9.252635847818482
2025-03-13 11:14:00,091 [INFO]: 	99p_search_speed_ms: 13.20653734728694
2025-03-13 11:14:00,091 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:00,092 [INFO]: 	nb vectors: 3527
2025-03-13 11:14:00,092 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:00,092 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-13 11:14:00,092 [INFO]: }
2025-03-13 11:14:00,092 [INFO]: 	>>> Finished "Creating the index" in 53.1438 secs
2025-03-13 11:14:00,092 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1764 secs
2025-03-13 11:14:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 36273 [episode count 7/20]
[retrieval_preprocessing] for episode 7240 [episode count 8/20], we have num_retrieval=np.int64(3543) num_query=np.int64(191)
2025-03-13 11:14:02,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:02,813 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:02
2025-03-13 11:14:02,813 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1759.36it/s]
2025-03-13 11:14:02,840 [INFO]: There are 3543 embeddings of dim 49152
2025-03-13 11:14:02,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:14:02,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:02
2025-03-13 11:14:02,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:02,841 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:14:02,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:02,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:02,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:02
2025-03-13 11:14:02,841 [INFO]: 731.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:02,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:02,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:02
2025-03-13 11:14:02,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:02,841 [INFO]: 	Creating the index 03/13/2025, 11:14:02
2025-03-13 11:14:02,841 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:02
2025-03-13 11:14:02,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:14:02,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:02
2025-03-13 11:14:02,842 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:14:02,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.33it/s] 57%|█████▋    | 8/14 [00:00<00:00, 37.79it/s]100%|██████████| 14/14 [00:02<00:00,  4.24it/s]100%|██████████| 14/14 [00:02<00:00,  5.12it/s]
2025-03-13 11:14:05,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:05
2025-03-13 11:14:39,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9999 secs
2025-03-13 11:14:39,579 [INFO]: The best hyperparameters are: efSearch=190
2025-03-13 11:14:39,579 [INFO]: 	Compute fast metrics 03/13/2025, 11:14:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.92it/s]
2025-03-13 11:14:53,210 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6306 secs
2025-03-13 11:14:53,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3698 secs
2025-03-13 11:14:53,212 [INFO]: {
2025-03-13 11:14:53,212 [INFO]: 	index_key: HNSW15
2025-03-13 11:14:53,212 [INFO]: 	index_param: efSearch=190
2025-03-13 11:14:53,212 [INFO]: 	index_path: knn.index
2025-03-13 11:14:53,212 [INFO]: 	size in bytes: 697063390
2025-03-13 11:14:53,212 [INFO]: 	avg_search_speed_ms: 7.631769883339755
2025-03-13 11:14:53,212 [INFO]: 	99p_search_speed_ms: 11.899204039946241
2025-03-13 11:14:53,212 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:14:53,212 [INFO]: 	nb vectors: 3543
2025-03-13 11:14:53,212 [INFO]: 	vectors dimension: 49152
2025-03-13 11:14:53,212 [INFO]: 	compression ratio: 0.9993096094173013
2025-03-13 11:14:53,212 [INFO]: }
2025-03-13 11:14:53,212 [INFO]: 	>>> Finished "Creating the index" in 50.3710 secs
2025-03-13 11:14:53,212 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3985 secs
2025-03-13 11:14:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:14:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 7240 [episode count 8/20]
[retrieval_preprocessing] for episode 8351 [episode count 9/20], we have num_retrieval=np.int64(3580) num_query=np.int64(154)
2025-03-13 11:14:54,770 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:14:55,256 [INFO]: Launching the whole pipeline 03/13/2025, 11:14:55
2025-03-13 11:14:55,256 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:14:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1725.34it/s]
2025-03-13 11:14:55,280 [INFO]: There are 3580 embeddings of dim 49152
2025-03-13 11:14:55,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:14:55,280 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:14:55
2025-03-13 11:14:55,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:14:55,280 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:14:55,280 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:14:55,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:14:55,280 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:14:55
2025-03-13 11:14:55,280 [INFO]: 738.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:14:55,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:14:55,281 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:14:55
2025-03-13 11:14:55,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:14:55,281 [INFO]: 	Creating the index 03/13/2025, 11:14:55
2025-03-13 11:14:55,281 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:14:55
2025-03-13 11:14:55,281 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:14:55,281 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:14:55
2025-03-13 11:14:55,282 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:14:55,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.50it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.09it/s] 80%|████████  | 12/15 [00:00<00:00, 40.60it/s]100%|██████████| 15/15 [00:02<00:00,  5.58it/s]
2025-03-13 11:14:58,081 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:14:58
2025-03-13 11:15:33,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9195 secs
2025-03-13 11:15:33,001 [INFO]: The best hyperparameters are: efSearch=333
2025-03-13 11:15:33,001 [INFO]: 	Compute fast metrics 03/13/2025, 11:15:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-13 11:15:45,668 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6670 secs
2025-03-13 11:15:45,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3884 secs
2025-03-13 11:15:45,670 [INFO]: {
2025-03-13 11:15:45,670 [INFO]: 	index_key: HNSW15
2025-03-13 11:15:45,670 [INFO]: 	index_param: efSearch=333
2025-03-13 11:15:45,670 [INFO]: 	index_path: knn.index
2025-03-13 11:15:45,670 [INFO]: 	size in bytes: 704342890
2025-03-13 11:15:45,670 [INFO]: 	avg_search_speed_ms: 10.748350949783907
2025-03-13 11:15:45,670 [INFO]: 	99p_search_speed_ms: 14.36153375543654
2025-03-13 11:15:45,670 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:15:45,670 [INFO]: 	nb vectors: 3580
2025-03-13 11:15:45,670 [INFO]: 	vectors dimension: 49152
2025-03-13 11:15:45,670 [INFO]: 	compression ratio: 0.9993096402236701
2025-03-13 11:15:45,670 [INFO]: }
2025-03-13 11:15:45,670 [INFO]: 	>>> Finished "Creating the index" in 50.3897 secs
2025-03-13 11:15:45,670 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4146 secs
2025-03-13 11:15:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:15:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 8351 [episode count 9/20]
[retrieval_preprocessing] for episode 66309 [episode count 10/20], we have num_retrieval=np.int64(3601) num_query=np.int64(133)
2025-03-13 11:15:47,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:15:48,688 [INFO]: Launching the whole pipeline 03/13/2025, 11:15:48
2025-03-13 11:15:48,688 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:15:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2202.89it/s]
2025-03-13 11:15:48,718 [INFO]: There are 3601 embeddings of dim 49152
2025-03-13 11:15:48,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-13 11:15:48,719 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:15:48,719 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:15:48,719 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:15:48,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:15:48,719 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,719 [INFO]: 743.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:15:48,719 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:15:48,719 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:15:48
2025-03-13 11:15:48,719 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:15:48,719 [INFO]: 	Creating the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,719 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:15:48
2025-03-13 11:15:48,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:15:48,720 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:15:48
2025-03-13 11:15:48,720 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:15:48,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.85it/s] 40%|████      | 6/15 [00:00<00:00, 29.39it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.07it/s]100%|██████████| 15/15 [00:03<00:00,  3.21it/s]100%|██████████| 15/15 [00:03<00:00,  4.44it/s]
2025-03-13 11:15:52,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:15:52
2025-03-13 11:16:28,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9261 secs
2025-03-13 11:16:28,026 [INFO]: The best hyperparameters are: efSearch=310
2025-03-13 11:16:28,026 [INFO]: 	Compute fast metrics 03/13/2025, 11:16:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.47it/s]
2025-03-13 11:16:40,766 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7404 secs
2025-03-13 11:16:40,768 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0484 secs
2025-03-13 11:16:40,768 [INFO]: {
2025-03-13 11:16:40,769 [INFO]: 	index_key: HNSW15
2025-03-13 11:16:40,769 [INFO]: 	index_param: efSearch=310
2025-03-13 11:16:40,769 [INFO]: 	index_path: knn.index
2025-03-13 11:16:40,769 [INFO]: 	size in bytes: 708474490
2025-03-13 11:16:40,769 [INFO]: 	avg_search_speed_ms: 10.860012526938391
2025-03-13 11:16:40,769 [INFO]: 	99p_search_speed_ms: 13.394293421879402
2025-03-13 11:16:40,769 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:16:40,769 [INFO]: 	nb vectors: 3601
2025-03-13 11:16:40,769 [INFO]: 	vectors dimension: 49152
2025-03-13 11:16:40,769 [INFO]: 	compression ratio: 0.9993096688633065
2025-03-13 11:16:40,769 [INFO]: }
2025-03-13 11:16:40,769 [INFO]: 	>>> Finished "Creating the index" in 52.0496 secs
2025-03-13 11:16:40,769 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0808 secs
2025-03-13 11:16:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:16:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 66309 [episode count 10/20]
[retrieval_preprocessing] for episode 78375 [episode count 11/20], we have num_retrieval=np.int64(3562) num_query=np.int64(172)
2025-03-13 11:16:42,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:16:43,097 [INFO]: Launching the whole pipeline 03/13/2025, 11:16:43
2025-03-13 11:16:43,098 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:16:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2529.74it/s]
2025-03-13 11:16:43,120 [INFO]: There are 3562 embeddings of dim 49152
2025-03-13 11:16:43,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 11:16:43,121 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:16:43,121 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:16:43,121 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:16:43,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:16:43,121 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,121 [INFO]: 735.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:16:43,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:16:43,121 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:16:43
2025-03-13 11:16:43,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:16:43,121 [INFO]: 	Creating the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,121 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:16:43
2025-03-13 11:16:43,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 11:16:43,123 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:16:43
2025-03-13 11:16:43,123 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:16:43,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.62it/s] 40%|████      | 6/15 [00:00<00:00, 30.40it/s] 73%|███████▎  | 11/15 [00:00<00:00, 37.44it/s]100%|██████████| 15/15 [00:03<00:00,  3.51it/s]100%|██████████| 15/15 [00:03<00:00,  4.85it/s]
2025-03-13 11:16:46,222 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:16:46
2025-03-13 11:17:20,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3038 secs
2025-03-13 11:17:20,526 [INFO]: The best hyperparameters are: efSearch=296
2025-03-13 11:17:20,526 [INFO]: 	Compute fast metrics 03/13/2025, 11:17:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.92it/s]
2025-03-13 11:17:32,902 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3764 secs
2025-03-13 11:17:32,905 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7821 secs
2025-03-13 11:17:32,905 [INFO]: {
2025-03-13 11:17:32,905 [INFO]: 	index_key: HNSW15
2025-03-13 11:17:32,905 [INFO]: 	index_param: efSearch=296
2025-03-13 11:17:32,905 [INFO]: 	index_path: knn.index
2025-03-13 11:17:32,905 [INFO]: 	size in bytes: 700801570
2025-03-13 11:17:32,905 [INFO]: 	avg_search_speed_ms: 11.242149045345572
2025-03-13 11:17:32,905 [INFO]: 	99p_search_speed_ms: 16.870908266864717
2025-03-13 11:17:32,905 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:17:32,905 [INFO]: 	nb vectors: 3562
2025-03-13 11:17:32,905 [INFO]: 	vectors dimension: 49152
2025-03-13 11:17:32,905 [INFO]: 	compression ratio: 0.9993095420719449
2025-03-13 11:17:32,905 [INFO]: }
2025-03-13 11:17:32,906 [INFO]: 	>>> Finished "Creating the index" in 49.7844 secs
2025-03-13 11:17:32,906 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8079 secs
2025-03-13 11:17:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:17:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 78375 [episode count 11/20]
[retrieval_preprocessing] for episode 95414 [episode count 12/20], we have num_retrieval=np.int64(3533) num_query=np.int64(201)
2025-03-13 11:17:35,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:17:35,887 [INFO]: Launching the whole pipeline 03/13/2025, 11:17:35
2025-03-13 11:17:35,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:17:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2153.13it/s]
2025-03-13 11:17:35,913 [INFO]: There are 3533 embeddings of dim 49152
2025-03-13 11:17:35,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:17:35,914 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:17:35
2025-03-13 11:17:35,914 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:17:35,914 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:17:35,914 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:17:35,914 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:17:35,914 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:17:35
2025-03-13 11:17:35,914 [INFO]: 729.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:17:35,914 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:17:35,914 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:17:35
2025-03-13 11:17:35,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:17:35,914 [INFO]: 	Creating the index 03/13/2025, 11:17:35
2025-03-13 11:17:35,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:17:35
2025-03-13 11:17:35,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:17:35,915 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:17:35
2025-03-13 11:17:35,915 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:17:35,916 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.93it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.81it/s] 79%|███████▊  | 11/14 [00:00<00:00, 38.28it/s]100%|██████████| 14/14 [00:02<00:00,  5.07it/s]
2025-03-13 11:17:38,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:17:38
2025-03-13 11:18:15,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6511 secs
2025-03-13 11:18:15,331 [INFO]: The best hyperparameters are: efSearch=317
2025-03-13 11:18:15,331 [INFO]: 	Compute fast metrics 03/13/2025, 11:18:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.64it/s]
2025-03-13 11:18:27,503 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1719 secs
2025-03-13 11:18:27,505 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5896 secs
2025-03-13 11:18:27,505 [INFO]: {
2025-03-13 11:18:27,505 [INFO]: 	index_key: HNSW15
2025-03-13 11:18:27,505 [INFO]: 	index_param: efSearch=317
2025-03-13 11:18:27,505 [INFO]: 	index_path: knn.index
2025-03-13 11:18:27,505 [INFO]: 	size in bytes: 695095990
2025-03-13 11:18:27,505 [INFO]: 	avg_search_speed_ms: 11.509584007898326
2025-03-13 11:18:27,505 [INFO]: 	99p_search_speed_ms: 16.99696508236229
2025-03-13 11:18:27,505 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:18:27,505 [INFO]: 	nb vectors: 3533
2025-03-13 11:18:27,505 [INFO]: 	vectors dimension: 49152
2025-03-13 11:18:27,505 [INFO]: 	compression ratio: 0.9993095543537807
2025-03-13 11:18:27,505 [INFO]: }
2025-03-13 11:18:27,505 [INFO]: 	>>> Finished "Creating the index" in 51.5914 secs
2025-03-13 11:18:27,505 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6185 secs
2025-03-13 11:18:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:18:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 95414 [episode count 12/20]
[retrieval_preprocessing] for episode 35220 [episode count 13/20], we have num_retrieval=np.int64(3605) num_query=np.int64(129)
2025-03-13 11:18:29,933 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:18:30,469 [INFO]: Launching the whole pipeline 03/13/2025, 11:18:30
2025-03-13 11:18:30,470 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:18:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1633.93it/s]
2025-03-13 11:18:30,493 [INFO]: There are 3605 embeddings of dim 49152
2025-03-13 11:18:30,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 11:18:30,494 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:18:30,494 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:18:30,494 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:18:30,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:18:30,494 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,494 [INFO]: 744.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:18:30,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:18:30,494 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:18:30
2025-03-13 11:18:30,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:18:30,494 [INFO]: 	Creating the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:18:30
2025-03-13 11:18:30,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:18:30,495 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:18:30
2025-03-13 11:18:30,495 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:18:30,495 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 17.77it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.50it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.64it/s]100%|██████████| 15/15 [00:02<00:00,  5.58it/s]
2025-03-13 11:18:33,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:18:33
2025-03-13 11:19:12,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6347 secs
2025-03-13 11:19:12,823 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 11:19:12,823 [INFO]: 	Compute fast metrics 03/13/2025, 11:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.29it/s]
2025-03-13 11:19:28,170 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3467 secs
2025-03-13 11:19:28,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6767 secs
2025-03-13 11:19:28,172 [INFO]: {
2025-03-13 11:19:28,172 [INFO]: 	index_key: HNSW15
2025-03-13 11:19:28,172 [INFO]: 	index_param: efSearch=270
2025-03-13 11:19:28,172 [INFO]: 	index_path: knn.index
2025-03-13 11:19:28,172 [INFO]: 	size in bytes: 709261510
2025-03-13 11:19:28,172 [INFO]: 	avg_search_speed_ms: 9.465564325383125
2025-03-13 11:19:28,172 [INFO]: 	99p_search_speed_ms: 12.432135129347444
2025-03-13 11:19:28,172 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:19:28,172 [INFO]: 	nb vectors: 3605
2025-03-13 11:19:28,172 [INFO]: 	vectors dimension: 49152
2025-03-13 11:19:28,172 [INFO]: 	compression ratio: 0.9993096058462273
2025-03-13 11:19:28,172 [INFO]: }
2025-03-13 11:19:28,172 [INFO]: 	>>> Finished "Creating the index" in 57.6780 secs
2025-03-13 11:19:28,172 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7024 secs
2025-03-13 11:19:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:19:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 35220 [episode count 13/20]
[retrieval_preprocessing] for episode 80650 [episode count 14/20], we have num_retrieval=np.int64(3542) num_query=np.int64(192)
2025-03-13 11:19:29,814 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:19:30,315 [INFO]: Launching the whole pipeline 03/13/2025, 11:19:30
2025-03-13 11:19:30,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:19:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.74it/s]
2025-03-13 11:19:30,341 [INFO]: There are 3542 embeddings of dim 49152
2025-03-13 11:19:30,341 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:19:30,341 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:19:30
2025-03-13 11:19:30,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:19:30,341 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:19:30,341 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:19:30,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:19:30,341 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:19:30
2025-03-13 11:19:30,341 [INFO]: 731.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:19:30,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:19:30,341 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:19:30
2025-03-13 11:19:30,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:19:30,341 [INFO]: 	Creating the index 03/13/2025, 11:19:30
2025-03-13 11:19:30,341 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:19:30
2025-03-13 11:19:30,342 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:19:30,342 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:19:30
2025-03-13 11:19:30,342 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:19:30,342 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.68it/s] 50%|█████     | 7/14 [00:00<00:00, 31.95it/s] 93%|█████████▎| 13/14 [00:00<00:00, 40.80it/s]100%|██████████| 14/14 [00:02<00:00,  5.28it/s]
2025-03-13 11:19:32,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:19:32
2025-03-13 11:20:09,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5472 secs
2025-03-13 11:20:09,546 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 11:20:09,546 [INFO]: 	Compute fast metrics 03/13/2025, 11:20:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-13 11:20:24,288 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7416 secs
2025-03-13 11:20:24,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9476 secs
2025-03-13 11:20:24,290 [INFO]: {
2025-03-13 11:20:24,290 [INFO]: 	index_key: HNSW15
2025-03-13 11:20:24,290 [INFO]: 	index_param: efSearch=294
2025-03-13 11:20:24,290 [INFO]: 	index_path: knn.index
2025-03-13 11:20:24,290 [INFO]: 	size in bytes: 696866650
2025-03-13 11:20:24,290 [INFO]: 	avg_search_speed_ms: 10.255428274185993
2025-03-13 11:20:24,290 [INFO]: 	99p_search_speed_ms: 13.977693105116487
2025-03-13 11:20:24,290 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:20:24,290 [INFO]: 	nb vectors: 3542
2025-03-13 11:20:24,290 [INFO]: 	vectors dimension: 49152
2025-03-13 11:20:24,290 [INFO]: 	compression ratio: 0.9993096039249403
2025-03-13 11:20:24,290 [INFO]: }
2025-03-13 11:20:24,290 [INFO]: 	>>> Finished "Creating the index" in 53.9490 secs
2025-03-13 11:20:24,290 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9751 secs
2025-03-13 11:20:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:20:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 80650 [episode count 14/20]
[retrieval_preprocessing] for episode 61238 [episode count 15/20], we have num_retrieval=np.int64(3523) num_query=np.int64(211)
2025-03-13 11:20:26,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:20:26,818 [INFO]: Launching the whole pipeline 03/13/2025, 11:20:26
2025-03-13 11:20:26,818 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:20:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.05it/s]
2025-03-13 11:20:26,846 [INFO]: There are 3523 embeddings of dim 49152
2025-03-13 11:20:26,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:20:26,847 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:20:26
2025-03-13 11:20:26,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:20:26,848 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:20:26,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:20:26,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:20:26,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:20:26
2025-03-13 11:20:26,848 [INFO]: 727.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:20:26,848 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:20:26,848 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:20:26
2025-03-13 11:20:26,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:20:26,849 [INFO]: 	Creating the index 03/13/2025, 11:20:26
2025-03-13 11:20:26,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:20:26
2025-03-13 11:20:26,852 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:20:26,852 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:20:26
2025-03-13 11:20:26,852 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:20:26,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.12it/s] 50%|█████     | 7/14 [00:00<00:00, 33.16it/s] 86%|████████▌ | 12/14 [00:00<00:00, 37.78it/s]100%|██████████| 14/14 [00:02<00:00,  4.97it/s]
2025-03-13 11:20:29,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:20:29
2025-03-13 11:21:05,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2928 secs
2025-03-13 11:21:05,971 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 11:21:05,971 [INFO]: 	Compute fast metrics 03/13/2025, 11:21:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-13 11:21:19,038 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0672 secs
2025-03-13 11:21:19,040 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1887 secs
2025-03-13 11:21:19,041 [INFO]: {
2025-03-13 11:21:19,041 [INFO]: 	index_key: HNSW15
2025-03-13 11:21:19,041 [INFO]: 	index_param: efSearch=292
2025-03-13 11:21:19,041 [INFO]: 	index_path: knn.index
2025-03-13 11:21:19,041 [INFO]: 	size in bytes: 693128530
2025-03-13 11:21:19,041 [INFO]: 	avg_search_speed_ms: 10.208226534376415
2025-03-13 11:21:19,041 [INFO]: 	99p_search_speed_ms: 14.732089182361962
2025-03-13 11:21:19,041 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:21:19,041 [INFO]: 	nb vectors: 3523
2025-03-13 11:21:19,041 [INFO]: 	vectors dimension: 49152
2025-03-13 11:21:19,041 [INFO]: 	compression ratio: 0.9993095854819307
2025-03-13 11:21:19,041 [INFO]: }
2025-03-13 11:21:19,041 [INFO]: 	>>> Finished "Creating the index" in 52.1921 secs
2025-03-13 11:21:19,041 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2229 secs
2025-03-13 11:21:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:21:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 61238 [episode count 15/20]
[retrieval_preprocessing] for episode 90107 [episode count 16/20], we have num_retrieval=np.int64(3562) num_query=np.int64(172)
2025-03-13 11:21:21,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:21:22,427 [INFO]: Launching the whole pipeline 03/13/2025, 11:21:22
2025-03-13 11:21:22,427 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:21:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.78it/s]
2025-03-13 11:21:22,457 [INFO]: There are 3562 embeddings of dim 49152
2025-03-13 11:21:22,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-13 11:21:22,457 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:21:22
2025-03-13 11:21:22,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:21:22,458 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:21:22,458 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:21:22,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:21:22,458 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:21:22
2025-03-13 11:21:22,458 [INFO]: 735.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:21:22,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:21:22,458 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:21:22
2025-03-13 11:21:22,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:21:22,458 [INFO]: 	Creating the index 03/13/2025, 11:21:22
2025-03-13 11:21:22,459 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:21:22
2025-03-13 11:21:22,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:21:22,460 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:21:22
2025-03-13 11:21:22,460 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:21:22,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.63it/s] 40%|████      | 6/15 [00:00<00:00, 30.75it/s] 73%|███████▎  | 11/15 [00:00<00:00, 36.58it/s]100%|██████████| 15/15 [00:02<00:00,  3.93it/s]100%|██████████| 15/15 [00:02<00:00,  5.40it/s]
2025-03-13 11:21:25,244 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:21:25
2025-03-13 11:22:04,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0007 secs
2025-03-13 11:22:04,245 [INFO]: The best hyperparameters are: efSearch=301
2025-03-13 11:22:04,245 [INFO]: 	Compute fast metrics 03/13/2025, 11:22:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-13 11:22:17,313 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0672 secs
2025-03-13 11:22:17,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8547 secs
2025-03-13 11:22:17,315 [INFO]: {
2025-03-13 11:22:17,315 [INFO]: 	index_key: HNSW15
2025-03-13 11:22:17,315 [INFO]: 	index_param: efSearch=301
2025-03-13 11:22:17,315 [INFO]: 	index_path: knn.index
2025-03-13 11:22:17,315 [INFO]: 	size in bytes: 700801570
2025-03-13 11:22:17,315 [INFO]: 	avg_search_speed_ms: 10.77936218317863
2025-03-13 11:22:17,315 [INFO]: 	99p_search_speed_ms: 14.875271371565761
2025-03-13 11:22:17,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:22:17,315 [INFO]: 	nb vectors: 3562
2025-03-13 11:22:17,315 [INFO]: 	vectors dimension: 49152
2025-03-13 11:22:17,315 [INFO]: 	compression ratio: 0.9993095420719449
2025-03-13 11:22:17,315 [INFO]: }
2025-03-13 11:22:17,315 [INFO]: 	>>> Finished "Creating the index" in 54.8565 secs
2025-03-13 11:22:17,315 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8880 secs
2025-03-13 11:22:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:22:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 90107 [episode count 16/20]
[retrieval_preprocessing] for episode 44232 [episode count 17/20], we have num_retrieval=np.int64(3567) num_query=np.int64(167)
2025-03-13 11:22:19,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:22:19,644 [INFO]: Launching the whole pipeline 03/13/2025, 11:22:19
2025-03-13 11:22:19,645 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:22:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-13 11:22:19,670 [INFO]: There are 3567 embeddings of dim 49152
2025-03-13 11:22:19,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:22:19,670 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:22:19
2025-03-13 11:22:19,670 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:22:19,670 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:22:19,670 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:22:19,670 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:22:19,670 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:22:19
2025-03-13 11:22:19,670 [INFO]: 736.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:22:19,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:22:19,671 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:22:19
2025-03-13 11:22:19,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:22:19,671 [INFO]: 	Creating the index 03/13/2025, 11:22:19
2025-03-13 11:22:19,671 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:22:19
2025-03-13 11:22:19,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:22:19,672 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:22:19
2025-03-13 11:22:19,672 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:22:19,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.13it/s] 40%|████      | 6/15 [00:00<00:00, 30.35it/s] 80%|████████  | 12/15 [00:00<00:00, 39.89it/s]100%|██████████| 15/15 [00:02<00:00,  5.38it/s]
2025-03-13 11:22:22,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:22:22
2025-03-13 11:23:00,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8821 secs
2025-03-13 11:23:00,347 [INFO]: The best hyperparameters are: efSearch=313
2025-03-13 11:23:00,347 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-13 11:23:14,919 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5716 secs
2025-03-13 11:23:14,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2494 secs
2025-03-13 11:23:14,921 [INFO]: {
2025-03-13 11:23:14,921 [INFO]: 	index_key: HNSW15
2025-03-13 11:23:14,921 [INFO]: 	index_param: efSearch=313
2025-03-13 11:23:14,921 [INFO]: 	index_path: knn.index
2025-03-13 11:23:14,922 [INFO]: 	size in bytes: 701785270
2025-03-13 11:23:14,922 [INFO]: 	avg_search_speed_ms: 11.329712993006558
2025-03-13 11:23:14,922 [INFO]: 	99p_search_speed_ms: 17.486814889125526
2025-03-13 11:23:14,922 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:23:14,922 [INFO]: 	nb vectors: 3567
2025-03-13 11:23:14,922 [INFO]: 	vectors dimension: 49152
2025-03-13 11:23:14,922 [INFO]: 	compression ratio: 0.9993095694356765
2025-03-13 11:23:14,922 [INFO]: }
2025-03-13 11:23:14,922 [INFO]: 	>>> Finished "Creating the index" in 55.2509 secs
2025-03-13 11:23:14,922 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2770 secs
2025-03-13 11:23:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:23:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 44232 [episode count 17/20]
[retrieval_preprocessing] for episode 46898 [episode count 18/20], we have num_retrieval=np.int64(3527) num_query=np.int64(207)
2025-03-13 11:23:16,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:23:17,412 [INFO]: Launching the whole pipeline 03/13/2025, 11:23:17
2025-03-13 11:23:17,412 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:23:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-13 11:23:17,437 [INFO]: There are 3527 embeddings of dim 49152
2025-03-13 11:23:17,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 11:23:17,437 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:23:17
2025-03-13 11:23:17,437 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:23:17,437 [INFO]: 		-> Add: 1.9 seconds
2025-03-13 11:23:17,437 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:23:17,437 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:23:17,437 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:23:17
2025-03-13 11:23:17,438 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:23:17,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:23:17,438 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:23:17
2025-03-13 11:23:17,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:23:17,438 [INFO]: 	Creating the index 03/13/2025, 11:23:17
2025-03-13 11:23:17,438 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:23:17
2025-03-13 11:23:17,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:23:17,439 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:23:17
2025-03-13 11:23:17,439 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:23:17,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.18it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.90it/s] 79%|███████▊  | 11/14 [00:00<00:00, 35.90it/s]100%|██████████| 14/14 [00:02<00:00,  5.05it/s]
2025-03-13 11:23:20,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:23:20
2025-03-13 11:23:56,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5315 secs
2025-03-13 11:23:56,748 [INFO]: The best hyperparameters are: efSearch=280
2025-03-13 11:23:56,748 [INFO]: 	Compute fast metrics 03/13/2025, 11:23:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-13 11:24:10,388 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6394 secs
2025-03-13 11:24:10,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9506 secs
2025-03-13 11:24:10,390 [INFO]: {
2025-03-13 11:24:10,390 [INFO]: 	index_key: HNSW15
2025-03-13 11:24:10,390 [INFO]: 	index_param: efSearch=280
2025-03-13 11:24:10,390 [INFO]: 	index_path: knn.index
2025-03-13 11:24:10,390 [INFO]: 	size in bytes: 693915550
2025-03-13 11:24:10,390 [INFO]: 	avg_search_speed_ms: 10.213084473722711
2025-03-13 11:24:10,390 [INFO]: 	99p_search_speed_ms: 13.952923058532178
2025-03-13 11:24:10,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:24:10,390 [INFO]: 	nb vectors: 3527
2025-03-13 11:24:10,390 [INFO]: 	vectors dimension: 49152
2025-03-13 11:24:10,390 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-13 11:24:10,390 [INFO]: }
2025-03-13 11:24:10,390 [INFO]: 	>>> Finished "Creating the index" in 52.9520 secs
2025-03-13 11:24:10,390 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9782 secs
2025-03-13 11:24:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:24:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 46898 [episode count 18/20]
[retrieval_preprocessing] for episode 33755 [episode count 19/20], we have num_retrieval=np.int64(3563) num_query=np.int64(171)
2025-03-13 11:24:12,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:24:13,324 [INFO]: Launching the whole pipeline 03/13/2025, 11:24:13
2025-03-13 11:24:13,324 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:24:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.00it/s]
2025-03-13 11:24:13,353 [INFO]: There are 3563 embeddings of dim 49152
2025-03-13 11:24:13,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 11:24:13,354 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:24:13
2025-03-13 11:24:13,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:24:13,354 [INFO]: 		-> Add: 2.0 seconds
2025-03-13 11:24:13,354 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:24:13,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:24:13,354 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:24:13
2025-03-13 11:24:13,354 [INFO]: 735.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:24:13,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:24:13,354 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:24:13
2025-03-13 11:24:13,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:24:13,354 [INFO]: 	Creating the index 03/13/2025, 11:24:13
2025-03-13 11:24:13,354 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:24:13
2025-03-13 11:24:13,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:24:13,356 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:24:13
2025-03-13 11:24:13,356 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-13 11:24:13,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.15it/s] 40%|████      | 6/15 [00:00<00:00, 29.87it/s] 73%|███████▎  | 11/15 [00:00<00:00, 38.02it/s]100%|██████████| 15/15 [00:02<00:00,  3.94it/s]100%|██████████| 15/15 [00:02<00:00,  5.39it/s]
2025-03-13 11:24:16,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:24:16
2025-03-13 11:24:51,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1859 secs
2025-03-13 11:24:51,327 [INFO]: The best hyperparameters are: efSearch=291
2025-03-13 11:24:51,327 [INFO]: 	Compute fast metrics 03/13/2025, 11:24:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.36it/s]
2025-03-13 11:25:06,039 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7123 secs
2025-03-13 11:25:06,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6857 secs
2025-03-13 11:25:06,041 [INFO]: {
2025-03-13 11:25:06,041 [INFO]: 	index_key: HNSW15
2025-03-13 11:25:06,041 [INFO]: 	index_param: efSearch=291
2025-03-13 11:25:06,041 [INFO]: 	index_path: knn.index
2025-03-13 11:25:06,042 [INFO]: 	size in bytes: 700998310
2025-03-13 11:25:06,042 [INFO]: 	avg_search_speed_ms: 10.563344540027263
2025-03-13 11:25:06,042 [INFO]: 	99p_search_speed_ms: 13.877227860502897
2025-03-13 11:25:06,042 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:25:06,042 [INFO]: 	nb vectors: 3563
2025-03-13 11:25:06,042 [INFO]: 	vectors dimension: 49152
2025-03-13 11:25:06,042 [INFO]: 	compression ratio: 0.999309547550835
2025-03-13 11:25:06,042 [INFO]: }
2025-03-13 11:25:06,042 [INFO]: 	>>> Finished "Creating the index" in 52.6874 secs
2025-03-13 11:25:06,042 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7179 secs
2025-03-13 11:25:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:25:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 33755 [episode count 19/20]
2025-03-13 11:25:08: [retrieval_preprocessing] finished for 3816161570_pull_box_out [chosen_id count 1/260]
2025-03-13 11:25:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3854327802_move_right [chosen_id count 2/260]
2025-03-13 11:25:09: [retrieval_preprocessing] we have num_total=3360 embedding_dim=49152
[retrieval_preprocessing] for episode 54799 [episode count 0/20], we have num_retrieval=np.int64(3212) num_query=np.int64(148)
2025-03-13 11:25:09,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:25:10,421 [INFO]: Launching the whole pipeline 03/13/2025, 11:25:10
2025-03-13 11:25:10,421 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:25:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.66it/s]
2025-03-13 11:25:10,450 [INFO]: There are 3212 embeddings of dim 49152
2025-03-13 11:25:10,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-13 11:25:10,451 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:25:10
2025-03-13 11:25:10,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:25:10,451 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:25:10,451 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:25:10,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:25:10,452 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:25:10
2025-03-13 11:25:10,452 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:25:10,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:25:10,452 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:25:10
2025-03-13 11:25:10,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:25:10,453 [INFO]: 	Creating the index 03/13/2025, 11:25:10
2025-03-13 11:25:10,453 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:25:10
2025-03-13 11:25:10,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:25:10,456 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:25:10
2025-03-13 11:25:10,456 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:25:10,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.15it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.66it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.44it/s]100%|██████████| 13/13 [00:02<00:00,  4.94it/s]
2025-03-13 11:25:13,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:25:13
2025-03-13 11:25:53,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5684 secs
2025-03-13 11:25:53,664 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 11:25:53,664 [INFO]: 	Compute fast metrics 03/13/2025, 11:25:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-13 11:26:06,094 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4300 secs
2025-03-13 11:26:06,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6409 secs
2025-03-13 11:26:06,097 [INFO]: {
2025-03-13 11:26:06,097 [INFO]: 	index_key: HNSW15
2025-03-13 11:26:06,097 [INFO]: 	index_param: efSearch=252
2025-03-13 11:26:06,097 [INFO]: 	index_path: knn.index
2025-03-13 11:26:06,097 [INFO]: 	size in bytes: 631941070
2025-03-13 11:26:06,097 [INFO]: 	avg_search_speed_ms: 12.048899592264643
2025-03-13 11:26:06,097 [INFO]: 	99p_search_speed_ms: 21.300947922281924
2025-03-13 11:26:06,097 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:26:06,097 [INFO]: 	nb vectors: 3212
2025-03-13 11:26:06,097 [INFO]: 	vectors dimension: 49152
2025-03-13 11:26:06,097 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-13 11:26:06,097 [INFO]: }
2025-03-13 11:26:06,097 [INFO]: 	>>> Finished "Creating the index" in 55.6446 secs
2025-03-13 11:26:06,097 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6760 secs
2025-03-13 11:26:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:26:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 54799 [episode count 0/20]
[retrieval_preprocessing] for episode 32315 [episode count 1/20], we have num_retrieval=np.int64(3170) num_query=np.int64(190)
2025-03-13 11:26:08,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:26:08,626 [INFO]: Launching the whole pipeline 03/13/2025, 11:26:08
2025-03-13 11:26:08,626 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:26:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-13 11:26:08,661 [INFO]: There are 3170 embeddings of dim 49152
2025-03-13 11:26:08,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-13 11:26:08,662 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:26:08
2025-03-13 11:26:08,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:26:08,662 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:26:08,662 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:26:08,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:26:08,662 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:26:08
2025-03-13 11:26:08,662 [INFO]: 654.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:26:08,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:26:08,662 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:26:08
2025-03-13 11:26:08,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:26:08,662 [INFO]: 	Creating the index 03/13/2025, 11:26:08
2025-03-13 11:26:08,662 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:26:08
2025-03-13 11:26:08,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:26:08,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:26:08
2025-03-13 11:26:08,663 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:26:08,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.89it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.09it/s] 85%|████████▍ | 11/13 [00:00<00:00, 33.71it/s]100%|██████████| 13/13 [00:02<00:00,  4.42it/s]
2025-03-13 11:26:11,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:26:11
2025-03-13 11:26:52,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8033 secs
2025-03-13 11:26:52,412 [INFO]: The best hyperparameters are: efSearch=214
2025-03-13 11:26:52,412 [INFO]: 	Compute fast metrics 03/13/2025, 11:26:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.45it/s]
2025-03-13 11:27:05,158 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7456 secs
2025-03-13 11:27:05,160 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4971 secs
2025-03-13 11:27:05,160 [INFO]: {
2025-03-13 11:27:05,160 [INFO]: 	index_key: HNSW15
2025-03-13 11:27:05,160 [INFO]: 	index_param: efSearch=214
2025-03-13 11:27:05,161 [INFO]: 	index_path: knn.index
2025-03-13 11:27:05,161 [INFO]: 	size in bytes: 623677870
2025-03-13 11:27:05,161 [INFO]: 	avg_search_speed_ms: 11.499907287779724
2025-03-13 11:27:05,161 [INFO]: 	99p_search_speed_ms: 17.08927607163786
2025-03-13 11:27:05,161 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:27:05,161 [INFO]: 	nb vectors: 3170
2025-03-13 11:27:05,161 [INFO]: 	vectors dimension: 49152
2025-03-13 11:27:05,161 [INFO]: 	compression ratio: 0.9993097237841708
2025-03-13 11:27:05,161 [INFO]: }
2025-03-13 11:27:05,161 [INFO]: 	>>> Finished "Creating the index" in 56.4986 secs
2025-03-13 11:27:05,161 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5342 secs
2025-03-13 11:27:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:27:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 32315 [episode count 1/20]
[retrieval_preprocessing] for episode 93249 [episode count 2/20], we have num_retrieval=np.int64(3196) num_query=np.int64(164)
2025-03-13 11:27:07,961 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:27:08,484 [INFO]: Launching the whole pipeline 03/13/2025, 11:27:08
2025-03-13 11:27:08,484 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-13 11:27:08,511 [INFO]: There are 3196 embeddings of dim 49152
2025-03-13 11:27:08,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-13 11:27:08,512 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:27:08,512 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:27:08,512 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:27:08,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:27:08,512 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,512 [INFO]: 659.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:27:08,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:27:08,512 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:27:08
2025-03-13 11:27:08,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:27:08,512 [INFO]: 	Creating the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,512 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:27:08
2025-03-13 11:27:08,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:27:08,513 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:27:08
2025-03-13 11:27:08,513 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:27:08,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.54it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.13it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.61it/s] 31%|███       | 4/13 [00:00<00:01,  8.03it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.31it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.46it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.84it/s] 77%|███████▋  | 10/13 [00:01<00:00, 10.67it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.36it/s]100%|██████████| 13/13 [00:04<00:00,  1.41it/s]100%|██████████| 13/13 [00:04<00:00,  2.98it/s]
2025-03-13 11:27:12,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:27:12
2025-03-13 11:27:56,443 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5675 secs
2025-03-13 11:27:56,444 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:27:56,444 [INFO]: 	Compute fast metrics 03/13/2025, 11:27:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-13 11:28:09,572 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1282 secs
2025-03-13 11:28:09,575 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0614 secs
2025-03-13 11:28:09,575 [INFO]: {
2025-03-13 11:28:09,575 [INFO]: 	index_key: HNSW15
2025-03-13 11:28:09,575 [INFO]: 	index_param: efSearch=223
2025-03-13 11:28:09,575 [INFO]: 	index_path: knn.index
2025-03-13 11:28:09,575 [INFO]: 	size in bytes: 628793170
2025-03-13 11:28:09,575 [INFO]: 	avg_search_speed_ms: 8.975651109326945
2025-03-13 11:28:09,575 [INFO]: 	99p_search_speed_ms: 13.59364709816872
2025-03-13 11:28:09,575 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:28:09,575 [INFO]: 	nb vectors: 3196
2025-03-13 11:28:09,575 [INFO]: 	vectors dimension: 49152
2025-03-13 11:28:09,575 [INFO]: 	compression ratio: 0.9993097857599185
2025-03-13 11:28:09,575 [INFO]: }
2025-03-13 11:28:09,575 [INFO]: 	>>> Finished "Creating the index" in 61.0629 secs
2025-03-13 11:28:09,575 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0910 secs
2025-03-13 11:28:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:28:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 93249 [episode count 2/20]
[retrieval_preprocessing] for episode 79426 [episode count 3/20], we have num_retrieval=np.int64(3189) num_query=np.int64(171)
2025-03-13 11:28:11,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:28:12,249 [INFO]: Launching the whole pipeline 03/13/2025, 11:28:12
2025-03-13 11:28:12,249 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:28:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-13 11:28:12,275 [INFO]: There are 3189 embeddings of dim 49152
2025-03-13 11:28:12,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-13 11:28:12,275 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:28:12
2025-03-13 11:28:12,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:28:12,275 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:28:12,275 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:28:12,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:28:12,275 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:28:12
2025-03-13 11:28:12,275 [INFO]: 658.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:28:12,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:28:12,275 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:28:12
2025-03-13 11:28:12,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:28:12,276 [INFO]: 	Creating the index 03/13/2025, 11:28:12
2025-03-13 11:28:12,276 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:28:12
2025-03-13 11:28:12,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-13 11:28:12,278 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:28:12
2025-03-13 11:28:12,278 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:28:12,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.21it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.14it/s] 31%|███       | 4/13 [00:00<00:00,  9.80it/s] 46%|████▌     | 6/13 [00:00<00:00, 11.04it/s] 62%|██████▏   | 8/13 [00:00<00:00, 11.66it/s] 77%|███████▋  | 10/13 [00:00<00:00, 12.05it/s] 92%|█████████▏| 12/13 [00:01<00:00, 12.38it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-13 11:28:15,411 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:28:15
2025-03-13 11:28:46,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2253 secs
2025-03-13 11:28:46,638 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 11:28:46,638 [INFO]: 	Compute fast metrics 03/13/2025, 11:28:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.61it/s]
2025-03-13 11:29:03,761 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1229 secs
2025-03-13 11:29:03,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5712 secs
2025-03-13 11:29:03,849 [INFO]: {
2025-03-13 11:29:03,849 [INFO]: 	index_key: HNSW15
2025-03-13 11:29:03,849 [INFO]: 	index_param: efSearch=207
2025-03-13 11:29:03,849 [INFO]: 	index_path: knn.index
2025-03-13 11:29:03,849 [INFO]: 	size in bytes: 627415990
2025-03-13 11:29:03,849 [INFO]: 	avg_search_speed_ms: 10.88314647284682
2025-03-13 11:29:03,849 [INFO]: 	99p_search_speed_ms: 17.506542210467146
2025-03-13 11:29:03,849 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:29:03,849 [INFO]: 	nb vectors: 3189
2025-03-13 11:29:03,849 [INFO]: 	vectors dimension: 49152
2025-03-13 11:29:03,849 [INFO]: 	compression ratio: 0.999309743444696
2025-03-13 11:29:03,849 [INFO]: }
2025-03-13 11:29:03,850 [INFO]: 	>>> Finished "Creating the index" in 51.5739 secs
2025-03-13 11:29:03,850 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6008 secs
2025-03-13 11:29:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:29:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 79426 [episode count 3/20]
[retrieval_preprocessing] for episode 44084 [episode count 4/20], we have num_retrieval=np.int64(3185) num_query=np.int64(175)
2025-03-13 11:29:06,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:29:07,386 [INFO]: Launching the whole pipeline 03/13/2025, 11:29:07
2025-03-13 11:29:07,386 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:29:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 931.45it/s]
2025-03-13 11:29:07,416 [INFO]: There are 3185 embeddings of dim 49152
2025-03-13 11:29:07,417 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-13 11:29:07,417 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:29:07
2025-03-13 11:29:07,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:29:07,417 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:29:07,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:29:07,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:29:07,418 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:29:07
2025-03-13 11:29:07,418 [INFO]: 657.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:29:07,418 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:29:07,418 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:29:07
2025-03-13 11:29:07,418 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:29:07,419 [INFO]: 	Creating the index 03/13/2025, 11:29:07
2025-03-13 11:29:07,419 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:29:07
2025-03-13 11:29:07,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:29:07,422 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:29:07
2025-03-13 11:29:07,422 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:29:07,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.30it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.05it/s] 31%|███       | 4/13 [00:00<00:01,  8.03it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.03it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.04it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.12it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.25it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.24it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.27it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.26it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.22it/s]100%|██████████| 13/13 [00:03<00:00,  1.28it/s]100%|██████████| 13/13 [00:03<00:00,  3.43it/s]
2025-03-13 11:29:11,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:29:11
2025-03-13 11:29:54,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9953 secs
2025-03-13 11:29:54,213 [INFO]: The best hyperparameters are: efSearch=211
2025-03-13 11:29:54,213 [INFO]: 	Compute fast metrics 03/13/2025, 11:29:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-13 11:30:07,334 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1211 secs
2025-03-13 11:30:07,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9145 secs
2025-03-13 11:30:07,337 [INFO]: {
2025-03-13 11:30:07,337 [INFO]: 	index_key: HNSW15
2025-03-13 11:30:07,337 [INFO]: 	index_param: efSearch=211
2025-03-13 11:30:07,337 [INFO]: 	index_path: knn.index
2025-03-13 11:30:07,337 [INFO]: 	size in bytes: 626629030
2025-03-13 11:30:07,337 [INFO]: 	avg_search_speed_ms: 9.359523779119641
2025-03-13 11:30:07,337 [INFO]: 	99p_search_speed_ms: 13.51419407641515
2025-03-13 11:30:07,337 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:30:07,337 [INFO]: 	nb vectors: 3185
2025-03-13 11:30:07,337 [INFO]: 	vectors dimension: 49152
2025-03-13 11:30:07,337 [INFO]: 	compression ratio: 0.9993097191810599
2025-03-13 11:30:07,337 [INFO]: }
2025-03-13 11:30:07,337 [INFO]: 	>>> Finished "Creating the index" in 59.9181 secs
2025-03-13 11:30:07,337 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9505 secs
2025-03-13 11:30:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:30:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 44084 [episode count 4/20]
[retrieval_preprocessing] for episode 78917 [episode count 5/20], we have num_retrieval=np.int64(3188) num_query=np.int64(172)
2025-03-13 11:30:09,689 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:30:10,150 [INFO]: Launching the whole pipeline 03/13/2025, 11:30:10
2025-03-13 11:30:10,151 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:30:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1601.49it/s]
2025-03-13 11:30:10,178 [INFO]: There are 3188 embeddings of dim 49152
2025-03-13 11:30:10,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 11:30:10,179 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:30:10
2025-03-13 11:30:10,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:30:10,179 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:30:10,179 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:30:10,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:30:10,179 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:30:10
2025-03-13 11:30:10,179 [INFO]: 657.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:30:10,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:30:10,179 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:30:10
2025-03-13 11:30:10,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:30:10,179 [INFO]: 	Creating the index 03/13/2025, 11:30:10
2025-03-13 11:30:10,179 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:30:10
2025-03-13 11:30:10,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:30:10,180 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:30:10
2025-03-13 11:30:10,180 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:30:10,180 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.14it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.06it/s] 38%|███▊      | 5/13 [00:00<00:00, 14.17it/s] 54%|█████▍    | 7/13 [00:00<00:00, 13.93it/s] 69%|██████▉   | 9/13 [00:00<00:00, 14.08it/s] 85%|████████▍ | 11/13 [00:00<00:00, 13.87it/s]100%|██████████| 13/13 [00:02<00:00,  2.52it/s]100%|██████████| 13/13 [00:02<00:00,  4.46it/s]
2025-03-13 11:30:13,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:30:13
2025-03-13 11:30:51,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4249 secs
2025-03-13 11:30:51,524 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 11:30:51,524 [INFO]: 	Compute fast metrics 03/13/2025, 11:30:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s]
2025-03-13 11:31:06,354 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8291 secs
2025-03-13 11:31:06,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1761 secs
2025-03-13 11:31:06,357 [INFO]: {
2025-03-13 11:31:06,357 [INFO]: 	index_key: HNSW15
2025-03-13 11:31:06,357 [INFO]: 	index_param: efSearch=235
2025-03-13 11:31:06,357 [INFO]: 	index_path: knn.index
2025-03-13 11:31:06,357 [INFO]: 	size in bytes: 627219250
2025-03-13 11:31:06,357 [INFO]: 	avg_search_speed_ms: 10.132199185622031
2025-03-13 11:31:06,357 [INFO]: 	99p_search_speed_ms: 14.294353560544549
2025-03-13 11:31:06,357 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:31:06,357 [INFO]: 	nb vectors: 3188
2025-03-13 11:31:06,357 [INFO]: 	vectors dimension: 49152
2025-03-13 11:31:06,357 [INFO]: 	compression ratio: 0.9993097373844951
2025-03-13 11:31:06,357 [INFO]: }
2025-03-13 11:31:06,357 [INFO]: 	>>> Finished "Creating the index" in 56.1776 secs
2025-03-13 11:31:06,357 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2062 secs
2025-03-13 11:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:31:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 78917 [episode count 5/20]
[retrieval_preprocessing] for episode 78428 [episode count 6/20], we have num_retrieval=np.int64(3216) num_query=np.int64(144)
2025-03-13 11:31:09,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:31:09,562 [INFO]: Launching the whole pipeline 03/13/2025, 11:31:09
2025-03-13 11:31:09,562 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:31:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-13 11:31:09,586 [INFO]: There are 3216 embeddings of dim 49152
2025-03-13 11:31:09,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 11:31:09,586 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:31:09
2025-03-13 11:31:09,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:31:09,586 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:31:09,586 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:31:09,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:31:09,586 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:31:09
2025-03-13 11:31:09,586 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:31:09,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:31:09,586 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:31:09
2025-03-13 11:31:09,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:31:09,586 [INFO]: 	Creating the index 03/13/2025, 11:31:09
2025-03-13 11:31:09,586 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:31:09
2025-03-13 11:31:09,587 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:31:09,587 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:31:09
2025-03-13 11:31:09,587 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:31:09,587 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.04it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.83it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.73it/s] 31%|███       | 4/13 [00:00<00:01,  8.13it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.55it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.64it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.71it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.70it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.70it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.70it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.82it/s]100%|██████████| 13/13 [00:03<00:00,  1.38it/s]100%|██████████| 13/13 [00:03<00:00,  3.64it/s]
2025-03-13 11:31:13,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:31:13
2025-03-13 11:31:49,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7790 secs
2025-03-13 11:31:49,944 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 11:31:49,944 [INFO]: 	Compute fast metrics 03/13/2025, 11:31:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-13 11:32:04,179 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2349 secs
2025-03-13 11:32:04,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5940 secs
2025-03-13 11:32:04,181 [INFO]: {
2025-03-13 11:32:04,182 [INFO]: 	index_key: HNSW15
2025-03-13 11:32:04,182 [INFO]: 	index_param: efSearch=234
2025-03-13 11:32:04,182 [INFO]: 	index_path: knn.index
2025-03-13 11:32:04,182 [INFO]: 	size in bytes: 632728030
2025-03-13 11:32:04,182 [INFO]: 	avg_search_speed_ms: 10.036307409239434
2025-03-13 11:32:04,182 [INFO]: 	99p_search_speed_ms: 13.363875523209563
2025-03-13 11:32:04,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:32:04,182 [INFO]: 	nb vectors: 3216
2025-03-13 11:32:04,182 [INFO]: 	vectors dimension: 49152
2025-03-13 11:32:04,182 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-13 11:32:04,182 [INFO]: }
2025-03-13 11:32:04,182 [INFO]: 	>>> Finished "Creating the index" in 54.5954 secs
2025-03-13 11:32:04,182 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6192 secs
2025-03-13 11:32:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:32:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 78428 [episode count 6/20]
[retrieval_preprocessing] for episode 11381 [episode count 7/20], we have num_retrieval=np.int64(3237) num_query=np.int64(123)
2025-03-13 11:32:06,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:32:07,189 [INFO]: Launching the whole pipeline 03/13/2025, 11:32:07
2025-03-13 11:32:07,189 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:32:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.79it/s]
2025-03-13 11:32:07,210 [INFO]: There are 3237 embeddings of dim 49152
2025-03-13 11:32:07,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0208 secs
2025-03-13 11:32:07,210 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:32:07
2025-03-13 11:32:07,210 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:32:07,210 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:32:07,210 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:32:07,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:32:07,210 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:32:07
2025-03-13 11:32:07,210 [INFO]: 668.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:32:07,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:32:07,211 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:32:07
2025-03-13 11:32:07,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:32:07,211 [INFO]: 	Creating the index 03/13/2025, 11:32:07
2025-03-13 11:32:07,211 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:32:07
2025-03-13 11:32:07,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:32:07,212 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:32:07
2025-03-13 11:32:07,212 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:32:07,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.89it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.56it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.08it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.48it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.75it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.87it/s]100%|██████████| 13/13 [00:03<00:00,  2.02it/s]100%|██████████| 13/13 [00:03<00:00,  3.61it/s]
2025-03-13 11:32:10,820 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:32:10
2025-03-13 11:32:50,003 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1825 secs
2025-03-13 11:32:50,004 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 11:32:50,004 [INFO]: 	Compute fast metrics 03/13/2025, 11:32:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 11:33:03,292 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2879 secs
2025-03-13 11:33:03,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0829 secs
2025-03-13 11:33:03,295 [INFO]: {
2025-03-13 11:33:03,295 [INFO]: 	index_key: HNSW15
2025-03-13 11:33:03,295 [INFO]: 	index_param: efSearch=238
2025-03-13 11:33:03,295 [INFO]: 	index_path: knn.index
2025-03-13 11:33:03,295 [INFO]: 	size in bytes: 636860050
2025-03-13 11:33:03,295 [INFO]: 	avg_search_speed_ms: 10.214597587278673
2025-03-13 11:33:03,295 [INFO]: 	99p_search_speed_ms: 14.548476622439923
2025-03-13 11:33:03,295 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:33:03,295 [INFO]: 	nb vectors: 3237
2025-03-13 11:33:03,295 [INFO]: 	vectors dimension: 49152
2025-03-13 11:33:03,295 [INFO]: 	compression ratio: 0.9993091826061314
2025-03-13 11:33:03,295 [INFO]: }
2025-03-13 11:33:03,295 [INFO]: 	>>> Finished "Creating the index" in 56.0843 secs
2025-03-13 11:33:03,295 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1056 secs
2025-03-13 11:33:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:33:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 11381 [episode count 7/20]
[retrieval_preprocessing] for episode 95377 [episode count 8/20], we have num_retrieval=np.int64(3181) num_query=np.int64(179)
2025-03-13 11:33:05,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:33:06,558 [INFO]: Launching the whole pipeline 03/13/2025, 11:33:06
2025-03-13 11:33:06,558 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:33:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1183.83it/s]
2025-03-13 11:33:06,583 [INFO]: There are 3181 embeddings of dim 49152
2025-03-13 11:33:06,584 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 11:33:06,584 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:33:06
2025-03-13 11:33:06,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:33:06,584 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:33:06,584 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:33:06,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:33:06,584 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:33:06
2025-03-13 11:33:06,584 [INFO]: 656.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:33:06,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:33:06,584 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:33:06
2025-03-13 11:33:06,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:33:06,584 [INFO]: 	Creating the index 03/13/2025, 11:33:06
2025-03-13 11:33:06,584 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:33:06
2025-03-13 11:33:06,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:33:06,585 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:33:06
2025-03-13 11:33:06,585 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:33:06,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.87it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.34it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.59it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.13it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.44it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.72it/s]100%|██████████| 13/13 [00:03<00:00,  2.19it/s]100%|██████████| 13/13 [00:03<00:00,  3.82it/s]
2025-03-13 11:33:10,484 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:33:10
2025-03-13 11:33:49,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0201 secs
2025-03-13 11:33:49,505 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 11:33:49,505 [INFO]: 	Compute fast metrics 03/13/2025, 11:33:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 11:34:05,179 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6736 secs
2025-03-13 11:34:05,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5959 secs
2025-03-13 11:34:05,182 [INFO]: {
2025-03-13 11:34:05,182 [INFO]: 	index_key: HNSW15
2025-03-13 11:34:05,182 [INFO]: 	index_param: efSearch=248
2025-03-13 11:34:05,182 [INFO]: 	index_path: knn.index
2025-03-13 11:34:05,182 [INFO]: 	size in bytes: 625842070
2025-03-13 11:34:05,182 [INFO]: 	avg_search_speed_ms: 13.28030297381786
2025-03-13 11:34:05,182 [INFO]: 	99p_search_speed_ms: 17.94917185790837
2025-03-13 11:34:05,182 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:34:05,182 [INFO]: 	nb vectors: 3181
2025-03-13 11:34:05,182 [INFO]: 	vectors dimension: 49152
2025-03-13 11:34:05,182 [INFO]: 	compression ratio: 0.9993096948564036
2025-03-13 11:34:05,182 [INFO]: }
2025-03-13 11:34:05,182 [INFO]: 	>>> Finished "Creating the index" in 58.5975 secs
2025-03-13 11:34:05,182 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6235 secs
2025-03-13 11:34:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:34:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 95377 [episode count 8/20]
[retrieval_preprocessing] for episode 55939 [episode count 9/20], we have num_retrieval=np.int64(3149) num_query=np.int64(211)
2025-03-13 11:34:07,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:34:08,391 [INFO]: Launching the whole pipeline 03/13/2025, 11:34:08
2025-03-13 11:34:08,391 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:34:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1164.76it/s]
2025-03-13 11:34:08,422 [INFO]: There are 3149 embeddings of dim 49152
2025-03-13 11:34:08,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-13 11:34:08,423 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:34:08
2025-03-13 11:34:08,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:34:08,424 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:34:08,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:34:08,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:34:08,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:34:08
2025-03-13 11:34:08,424 [INFO]: 649.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:34:08,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:34:08,425 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:34:08
2025-03-13 11:34:08,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:34:08,425 [INFO]: 	Creating the index 03/13/2025, 11:34:08
2025-03-13 11:34:08,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:34:08
2025-03-13 11:34:08,428 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:34:08,428 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:34:08
2025-03-13 11:34:08,428 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:34:08,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.39it/s] 15%|█▌        | 2/13 [00:00<00:01,  5.62it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.56it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.35it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.51it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.29it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.04it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.77it/s]100%|██████████| 13/13 [00:04<00:00,  1.21it/s]100%|██████████| 13/13 [00:04<00:00,  3.10it/s]
2025-03-13 11:34:12,634 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:34:12
2025-03-13 11:34:55,013 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3787 secs
2025-03-13 11:34:55,014 [INFO]: The best hyperparameters are: efSearch=235
2025-03-13 11:34:55,015 [INFO]: 	Compute fast metrics 03/13/2025, 11:34:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s]
2025-03-13 11:35:08,946 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9316 secs
2025-03-13 11:35:08,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5205 secs
2025-03-13 11:35:08,949 [INFO]: {
2025-03-13 11:35:08,949 [INFO]: 	index_key: HNSW15
2025-03-13 11:35:08,949 [INFO]: 	index_param: efSearch=235
2025-03-13 11:35:08,949 [INFO]: 	index_path: knn.index
2025-03-13 11:35:08,949 [INFO]: 	size in bytes: 619546270
2025-03-13 11:35:08,949 [INFO]: 	avg_search_speed_ms: 9.688706023757556
2025-03-13 11:35:08,949 [INFO]: 	99p_search_speed_ms: 14.36870277626439
2025-03-13 11:35:08,949 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:35:08,949 [INFO]: 	nb vectors: 3149
2025-03-13 11:35:08,949 [INFO]: 	vectors dimension: 49152
2025-03-13 11:35:08,949 [INFO]: 	compression ratio: 0.9993096915909122
2025-03-13 11:35:08,949 [INFO]: }
2025-03-13 11:35:08,949 [INFO]: 	>>> Finished "Creating the index" in 60.5242 secs
2025-03-13 11:35:08,949 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5577 secs
2025-03-13 11:35:10: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:35:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 55939 [episode count 9/20]
[retrieval_preprocessing] for episode 89237 [episode count 10/20], we have num_retrieval=np.int64(3113) num_query=np.int64(247)
2025-03-13 11:35:12,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:35:12,933 [INFO]: Launching the whole pipeline 03/13/2025, 11:35:12
2025-03-13 11:35:12,933 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:35:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 11:35:12,957 [INFO]: There are 3113 embeddings of dim 49152
2025-03-13 11:35:12,957 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-13 11:35:12,957 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:35:12
2025-03-13 11:35:12,957 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:35:12,957 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:35:12,957 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:35:12,957 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:35:12,957 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:35:12
2025-03-13 11:35:12,957 [INFO]: 642.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:35:12,958 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:35:12,958 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:35:12
2025-03-13 11:35:12,958 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:35:12,958 [INFO]: 	Creating the index 03/13/2025, 11:35:12
2025-03-13 11:35:12,958 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:35:12
2025-03-13 11:35:12,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:35:12,959 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:35:12
2025-03-13 11:35:12,959 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:35:12,959 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.31it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.41it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.26it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.49it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.01it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.88it/s]100%|██████████| 13/13 [00:03<00:00,  2.54it/s]100%|██████████| 13/13 [00:03<00:00,  4.29it/s]
2025-03-13 11:35:15,994 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:35:15
2025-03-13 11:35:51,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2146 secs
2025-03-13 11:35:51,209 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 11:35:51,209 [INFO]: 	Compute fast metrics 03/13/2025, 11:35:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-13 11:36:07,230 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0201 secs
2025-03-13 11:36:07,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2729 secs
2025-03-13 11:36:07,232 [INFO]: {
2025-03-13 11:36:07,232 [INFO]: 	index_key: HNSW15
2025-03-13 11:36:07,232 [INFO]: 	index_param: efSearch=262
2025-03-13 11:36:07,232 [INFO]: 	index_path: knn.index
2025-03-13 11:36:07,232 [INFO]: 	size in bytes: 612463450
2025-03-13 11:36:07,232 [INFO]: 	avg_search_speed_ms: 10.460773595924408
2025-03-13 11:36:07,232 [INFO]: 	99p_search_speed_ms: 13.971321168355646
2025-03-13 11:36:07,232 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:36:07,232 [INFO]: 	nb vectors: 3113
2025-03-13 11:36:07,232 [INFO]: 	vectors dimension: 49152
2025-03-13 11:36:07,232 [INFO]: 	compression ratio: 0.9993097612600392
2025-03-13 11:36:07,232 [INFO]: }
2025-03-13 11:36:07,232 [INFO]: 	>>> Finished "Creating the index" in 54.2746 secs
2025-03-13 11:36:07,232 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2992 secs
2025-03-13 11:36:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:36:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 89237 [episode count 10/20]
[retrieval_preprocessing] for episode 80041 [episode count 11/20], we have num_retrieval=np.int64(3156) num_query=np.int64(204)
2025-03-13 11:36:12,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:36:12,940 [INFO]: Launching the whole pipeline 03/13/2025, 11:36:12
2025-03-13 11:36:12,940 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:36:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1519.68it/s]
2025-03-13 11:36:12,968 [INFO]: There are 3156 embeddings of dim 49152
2025-03-13 11:36:12,969 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-13 11:36:12,969 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:36:12
2025-03-13 11:36:12,969 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:36:12,969 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:36:12,969 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:36:12,969 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:36:12,970 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:36:12
2025-03-13 11:36:12,970 [INFO]: 651.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:36:12,970 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:36:12,970 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:36:12
2025-03-13 11:36:12,970 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:36:12,970 [INFO]: 	Creating the index 03/13/2025, 11:36:12
2025-03-13 11:36:12,971 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:36:12
2025-03-13 11:36:12,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 11:36:12,974 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:36:12
2025-03-13 11:36:12,974 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:36:12,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.30it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.88it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.46it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.09it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.84it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.65it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.60it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.47it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.37it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.28it/s]100%|██████████| 13/13 [00:03<00:00,  1.21it/s]100%|██████████| 13/13 [00:03<00:00,  3.33it/s]
2025-03-13 11:36:16,880 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:36:16
2025-03-13 11:36:59,542 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6617 secs
2025-03-13 11:36:59,542 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 11:36:59,543 [INFO]: 	Compute fast metrics 03/13/2025, 11:36:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 11:37:14,808 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2655 secs
2025-03-13 11:37:14,811 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8368 secs
2025-03-13 11:37:14,811 [INFO]: {
2025-03-13 11:37:14,811 [INFO]: 	index_key: HNSW15
2025-03-13 11:37:14,811 [INFO]: 	index_param: efSearch=215
2025-03-13 11:37:14,811 [INFO]: 	index_path: knn.index
2025-03-13 11:37:14,811 [INFO]: 	size in bytes: 620923510
2025-03-13 11:37:14,811 [INFO]: 	avg_search_speed_ms: 9.010472079646682
2025-03-13 11:37:14,811 [INFO]: 	99p_search_speed_ms: 15.73035851586611
2025-03-13 11:37:14,811 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:37:14,811 [INFO]: 	nb vectors: 3156
2025-03-13 11:37:14,811 [INFO]: 	vectors dimension: 49152
2025-03-13 11:37:14,811 [INFO]: 	compression ratio: 0.9993096379938972
2025-03-13 11:37:14,811 [INFO]: }
2025-03-13 11:37:14,811 [INFO]: 	>>> Finished "Creating the index" in 61.8405 secs
2025-03-13 11:37:14,811 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8713 secs
2025-03-13 11:37:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:37:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 80041 [episode count 11/20]
[retrieval_preprocessing] for episode 86730 [episode count 12/20], we have num_retrieval=np.int64(3208) num_query=np.int64(152)
2025-03-13 11:37:19,062 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:37:19,566 [INFO]: Launching the whole pipeline 03/13/2025, 11:37:19
2025-03-13 11:37:19,566 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:37:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2240.55it/s]
2025-03-13 11:37:19,589 [INFO]: There are 3208 embeddings of dim 49152
2025-03-13 11:37:19,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-13 11:37:19,590 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:37:19
2025-03-13 11:37:19,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:37:19,590 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:37:19,590 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:37:19,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:37:19,590 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:37:19
2025-03-13 11:37:19,590 [INFO]: 662.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:37:19,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:37:19,590 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:37:19
2025-03-13 11:37:19,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:37:19,590 [INFO]: 	Creating the index 03/13/2025, 11:37:19
2025-03-13 11:37:19,590 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:37:19
2025-03-13 11:37:19,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:37:19,591 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:37:19
2025-03-13 11:37:19,591 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:37:19,591 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.64it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.05it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.96it/s] 54%|█████▍    | 7/13 [00:03<00:03,  1.68it/s] 62%|██████▏   | 8/13 [00:03<00:02,  1.90it/s] 69%|██████▉   | 9/13 [00:03<00:01,  2.22it/s] 77%|███████▋  | 10/13 [00:04<00:01,  2.00it/s] 85%|████████▍ | 11/13 [00:04<00:01,  1.76it/s] 92%|█████████▏| 12/13 [00:05<00:00,  1.43it/s]100%|██████████| 13/13 [00:10<00:00,  1.86s/it]100%|██████████| 13/13 [00:10<00:00,  1.21it/s]
2025-03-13 11:37:30,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:37:30
2025-03-13 11:38:12,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5285 secs
2025-03-13 11:38:12,878 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 11:38:12,878 [INFO]: 	Compute fast metrics 03/13/2025, 11:38:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-13 11:38:28,577 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6988 secs
2025-03-13 11:38:28,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9884 secs
2025-03-13 11:38:28,580 [INFO]: {
2025-03-13 11:38:28,580 [INFO]: 	index_key: HNSW15
2025-03-13 11:38:28,580 [INFO]: 	index_param: efSearch=223
2025-03-13 11:38:28,580 [INFO]: 	index_path: knn.index
2025-03-13 11:38:28,580 [INFO]: 	size in bytes: 631154110
2025-03-13 11:38:28,580 [INFO]: 	avg_search_speed_ms: 9.618857735991837
2025-03-13 11:38:28,580 [INFO]: 	99p_search_speed_ms: 16.16622196510425
2025-03-13 11:38:28,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:38:28,580 [INFO]: 	nb vectors: 3208
2025-03-13 11:38:28,580 [INFO]: 	vectors dimension: 49152
2025-03-13 11:38:28,580 [INFO]: 	compression ratio: 0.9993097628723355
2025-03-13 11:38:28,580 [INFO]: }
2025-03-13 11:38:28,580 [INFO]: 	>>> Finished "Creating the index" in 68.9900 secs
2025-03-13 11:38:28,580 [INFO]: >>> Finished "Launching the whole pipeline" in 69.0137 secs
2025-03-13 11:38:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:38:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 86730 [episode count 12/20]
[retrieval_preprocessing] for episode 95460 [episode count 13/20], we have num_retrieval=np.int64(3182) num_query=np.int64(178)
2025-03-13 11:38:30,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:38:31,238 [INFO]: Launching the whole pipeline 03/13/2025, 11:38:31
2025-03-13 11:38:31,238 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:38:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.98it/s]
2025-03-13 11:38:31,264 [INFO]: There are 3182 embeddings of dim 49152
2025-03-13 11:38:31,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 11:38:31,264 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:38:31
2025-03-13 11:38:31,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:38:31,264 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:38:31,264 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:38:31,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:38:31,264 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:38:31
2025-03-13 11:38:31,265 [INFO]: 656.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:38:31,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:38:31,265 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:38:31
2025-03-13 11:38:31,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:38:31,265 [INFO]: 	Creating the index 03/13/2025, 11:38:31
2025-03-13 11:38:31,265 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:38:31
2025-03-13 11:38:31,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:38:31,266 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:38:31
2025-03-13 11:38:31,266 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:38:31,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.48it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.10it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.68it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.26it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.74it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.97it/s]100%|██████████| 13/13 [00:03<00:00,  2.37it/s]100%|██████████| 13/13 [00:03<00:00,  3.96it/s]
2025-03-13 11:38:34,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:38:34
2025-03-13 11:39:10,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2174 secs
2025-03-13 11:39:10,770 [INFO]: The best hyperparameters are: efSearch=208
2025-03-13 11:39:10,770 [INFO]: 	Compute fast metrics 03/13/2025, 11:39:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-13 11:39:24,804 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0344 secs
2025-03-13 11:39:24,807 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5410 secs
2025-03-13 11:39:24,808 [INFO]: {
2025-03-13 11:39:24,808 [INFO]: 	index_key: HNSW15
2025-03-13 11:39:24,808 [INFO]: 	index_param: efSearch=208
2025-03-13 11:39:24,808 [INFO]: 	index_path: knn.index
2025-03-13 11:39:24,808 [INFO]: 	size in bytes: 626038810
2025-03-13 11:39:24,808 [INFO]: 	avg_search_speed_ms: 8.678056149518751
2025-03-13 11:39:24,808 [INFO]: 	99p_search_speed_ms: 11.572979795746507
2025-03-13 11:39:24,808 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:39:24,808 [INFO]: 	nb vectors: 3182
2025-03-13 11:39:24,808 [INFO]: 	vectors dimension: 49152
2025-03-13 11:39:24,808 [INFO]: 	compression ratio: 0.999309700943301
2025-03-13 11:39:24,808 [INFO]: }
2025-03-13 11:39:24,808 [INFO]: 	>>> Finished "Creating the index" in 53.5430 secs
2025-03-13 11:39:24,808 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5702 secs
2025-03-13 11:39:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:39:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 95460 [episode count 13/20]
[retrieval_preprocessing] for episode 71398 [episode count 14/20], we have num_retrieval=np.int64(3179) num_query=np.int64(181)
2025-03-13 11:39:27,508 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:39:27,947 [INFO]: Launching the whole pipeline 03/13/2025, 11:39:27
2025-03-13 11:39:27,947 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.63it/s]
2025-03-13 11:39:27,971 [INFO]: There are 3179 embeddings of dim 49152
2025-03-13 11:39:27,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 11:39:27,971 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:39:27
2025-03-13 11:39:27,971 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:39:27,971 [INFO]: 		-> Add: 1.7 seconds
2025-03-13 11:39:27,971 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:39:27,971 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:39:27,971 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:39:27
2025-03-13 11:39:27,972 [INFO]: 656.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:39:27,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:39:27,972 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:39:27
2025-03-13 11:39:27,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:39:27,972 [INFO]: 	Creating the index 03/13/2025, 11:39:27
2025-03-13 11:39:27,972 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:39:27
2025-03-13 11:39:27,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:39:27,973 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:39:27
2025-03-13 11:39:27,973 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:39:27,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.71it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.04it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.10it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.70it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.98it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.04it/s]100%|██████████| 13/13 [00:03<00:00,  2.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
2025-03-13 11:39:31,306 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:39:31
2025-03-13 11:40:08,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8061 secs
2025-03-13 11:40:08,113 [INFO]: The best hyperparameters are: efSearch=256
2025-03-13 11:40:08,113 [INFO]: 	Compute fast metrics 03/13/2025, 11:40:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-13 11:40:23,780 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6669 secs
2025-03-13 11:40:23,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9612 secs
2025-03-13 11:40:23,934 [INFO]: {
2025-03-13 11:40:23,934 [INFO]: 	index_key: HNSW15
2025-03-13 11:40:23,935 [INFO]: 	index_param: efSearch=256
2025-03-13 11:40:23,935 [INFO]: 	index_path: knn.index
2025-03-13 11:40:23,935 [INFO]: 	size in bytes: 625448590
2025-03-13 11:40:23,935 [INFO]: 	avg_search_speed_ms: 10.659777180307598
2025-03-13 11:40:23,935 [INFO]: 	99p_search_speed_ms: 15.427330436650664
2025-03-13 11:40:23,935 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:40:23,935 [INFO]: 	nb vectors: 3179
2025-03-13 11:40:23,935 [INFO]: 	vectors dimension: 49152
2025-03-13 11:40:23,935 [INFO]: 	compression ratio: 0.9993096826711209
2025-03-13 11:40:23,935 [INFO]: }
2025-03-13 11:40:23,935 [INFO]: 	>>> Finished "Creating the index" in 55.9634 secs
2025-03-13 11:40:23,935 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9884 secs
2025-03-13 11:40:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:40:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 71398 [episode count 14/20]
[retrieval_preprocessing] for episode 61175 [episode count 15/20], we have num_retrieval=np.int64(3259) num_query=np.int64(101)
2025-03-13 11:40:26,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:40:27,503 [INFO]: Launching the whole pipeline 03/13/2025, 11:40:27
2025-03-13 11:40:27,503 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:40:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1003.42it/s]
2025-03-13 11:40:27,530 [INFO]: There are 3259 embeddings of dim 49152
2025-03-13 11:40:27,531 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 11:40:27,531 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:40:27
2025-03-13 11:40:27,531 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:40:27,531 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:40:27,531 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:40:27,531 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 11:40:27,531 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:40:27
2025-03-13 11:40:27,531 [INFO]: 672.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:40:27,531 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:40:27,531 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:40:27
2025-03-13 11:40:27,531 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:40:27,531 [INFO]: 	Creating the index 03/13/2025, 11:40:27
2025-03-13 11:40:27,531 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:40:27
2025-03-13 11:40:27,532 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:40:27,532 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:40:27
2025-03-13 11:40:27,532 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:40:27,532 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.87it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.57it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.21it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.66it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.08it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.32it/s]100%|██████████| 13/13 [00:03<00:00,  2.28it/s]100%|██████████| 13/13 [00:03<00:00,  3.98it/s]
2025-03-13 11:40:30,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:40:30
2025-03-13 11:41:09,015 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2034 secs
2025-03-13 11:41:09,015 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 11:41:09,015 [INFO]: 	Compute fast metrics 03/13/2025, 11:41:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s]
2025-03-13 11:41:25,134 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1192 secs
2025-03-13 11:41:25,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6046 secs
2025-03-13 11:41:25,137 [INFO]: {
2025-03-13 11:41:25,137 [INFO]: 	index_key: HNSW15
2025-03-13 11:41:25,137 [INFO]: 	index_param: efSearch=257
2025-03-13 11:41:25,137 [INFO]: 	index_path: knn.index
2025-03-13 11:41:25,137 [INFO]: 	size in bytes: 641188450
2025-03-13 11:41:25,137 [INFO]: 	avg_search_speed_ms: 9.863192935408087
2025-03-13 11:41:25,137 [INFO]: 	99p_search_speed_ms: 13.248437205329537
2025-03-13 11:41:25,137 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:41:25,137 [INFO]: 	nb vectors: 3259
2025-03-13 11:41:25,137 [INFO]: 	vectors dimension: 49152
2025-03-13 11:41:25,137 [INFO]: 	compression ratio: 0.999309129788598
2025-03-13 11:41:25,137 [INFO]: }
2025-03-13 11:41:25,137 [INFO]: 	>>> Finished "Creating the index" in 57.6061 secs
2025-03-13 11:41:25,137 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6347 secs
2025-03-13 11:41:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:41:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 61175 [episode count 15/20]
[retrieval_preprocessing] for episode 34046 [episode count 16/20], we have num_retrieval=np.int64(3201) num_query=np.int64(159)
2025-03-13 11:41:27,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:41:27,835 [INFO]: Launching the whole pipeline 03/13/2025, 11:41:27
2025-03-13 11:41:27,835 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:41:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2142.14it/s]
2025-03-13 11:41:27,860 [INFO]: There are 3201 embeddings of dim 49152
2025-03-13 11:41:27,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:41:27,861 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:41:27
2025-03-13 11:41:27,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:41:27,861 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:41:27,861 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:41:27,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:41:27,861 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:41:27
2025-03-13 11:41:27,862 [INFO]: 660.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:41:27,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:41:27,862 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:41:27
2025-03-13 11:41:27,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-13 11:41:27,863 [INFO]: 	Creating the index 03/13/2025, 11:41:27
2025-03-13 11:41:27,863 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:41:27
2025-03-13 11:41:27,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:41:27,866 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:41:27
2025-03-13 11:41:27,866 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:41:27,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.78it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.26it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.49it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.00it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.28it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.49it/s]100%|██████████| 13/13 [00:03<00:00,  2.21it/s]100%|██████████| 13/13 [00:03<00:00,  3.84it/s]
2025-03-13 11:41:31,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:41:31
2025-03-13 11:42:08,810 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5536 secs
2025-03-13 11:42:08,810 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 11:42:08,810 [INFO]: 	Compute fast metrics 03/13/2025, 11:42:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-13 11:42:23,147 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3367 secs
2025-03-13 11:42:23,149 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2830 secs
2025-03-13 11:42:23,149 [INFO]: {
2025-03-13 11:42:23,149 [INFO]: 	index_key: HNSW15
2025-03-13 11:42:23,149 [INFO]: 	index_param: efSearch=261
2025-03-13 11:42:23,149 [INFO]: 	index_path: knn.index
2025-03-13 11:42:23,149 [INFO]: 	size in bytes: 629776870
2025-03-13 11:42:23,149 [INFO]: 	avg_search_speed_ms: 10.42496339647183
2025-03-13 11:42:23,149 [INFO]: 	99p_search_speed_ms: 17.600461724214217
2025-03-13 11:42:23,149 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:42:23,149 [INFO]: 	nb vectors: 3201
2025-03-13 11:42:23,149 [INFO]: 	vectors dimension: 49152
2025-03-13 11:42:23,149 [INFO]: 	compression ratio: 0.9993098158717706
2025-03-13 11:42:23,150 [INFO]: }
2025-03-13 11:42:23,150 [INFO]: 	>>> Finished "Creating the index" in 55.2869 secs
2025-03-13 11:42:23,150 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3149 secs
2025-03-13 11:42:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:42:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 34046 [episode count 16/20]
[retrieval_preprocessing] for episode 74526 [episode count 17/20], we have num_retrieval=np.int64(3187) num_query=np.int64(173)
2025-03-13 11:42:26,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:42:26,824 [INFO]: Launching the whole pipeline 03/13/2025, 11:42:26
2025-03-13 11:42:26,824 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.34it/s]
2025-03-13 11:42:26,851 [INFO]: There are 3187 embeddings of dim 49152
2025-03-13 11:42:26,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-13 11:42:26,851 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:42:26
2025-03-13 11:42:26,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:42:26,851 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:42:26,851 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:42:26,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:42:26,851 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:42:26
2025-03-13 11:42:26,851 [INFO]: 657.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:42:26,851 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:42:26,851 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:42:26
2025-03-13 11:42:26,851 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:42:26,851 [INFO]: 	Creating the index 03/13/2025, 11:42:26
2025-03-13 11:42:26,852 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:42:26
2025-03-13 11:42:26,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 11:42:26,853 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:42:26
2025-03-13 11:42:26,853 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:42:26,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.31it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.01it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.74it/s] 31%|███       | 4/13 [00:00<00:01,  8.07it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.29it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.43it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.63it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.65it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.69it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.70it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.71it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.83it/s]100%|██████████| 13/13 [00:03<00:00,  1.34it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]
2025-03-13 11:42:30,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:42:30
2025-03-13 11:43:05,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7360 secs
2025-03-13 11:43:05,233 [INFO]: The best hyperparameters are: efSearch=225
2025-03-13 11:43:05,233 [INFO]: 	Compute fast metrics 03/13/2025, 11:43:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-13 11:43:25,801 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5682 secs
2025-03-13 11:43:25,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9510 secs
2025-03-13 11:43:25,804 [INFO]: {
2025-03-13 11:43:25,804 [INFO]: 	index_key: HNSW15
2025-03-13 11:43:25,804 [INFO]: 	index_param: efSearch=225
2025-03-13 11:43:25,804 [INFO]: 	index_path: knn.index
2025-03-13 11:43:25,804 [INFO]: 	size in bytes: 627022510
2025-03-13 11:43:25,804 [INFO]: 	avg_search_speed_ms: 10.106621103859835
2025-03-13 11:43:25,804 [INFO]: 	99p_search_speed_ms: 17.367238434962953
2025-03-13 11:43:25,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:43:25,804 [INFO]: 	nb vectors: 3187
2025-03-13 11:43:25,804 [INFO]: 	vectors dimension: 49152
2025-03-13 11:43:25,804 [INFO]: 	compression ratio: 0.9993097313204912
2025-03-13 11:43:25,804 [INFO]: }
2025-03-13 11:43:25,804 [INFO]: 	>>> Finished "Creating the index" in 58.9526 secs
2025-03-13 11:43:25,804 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9800 secs
2025-03-13 11:43:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:43:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 74526 [episode count 17/20]
[retrieval_preprocessing] for episode 52159 [episode count 18/20], we have num_retrieval=np.int64(3219) num_query=np.int64(141)
2025-03-13 11:43:28,156 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:43:28,617 [INFO]: Launching the whole pipeline 03/13/2025, 11:43:28
2025-03-13 11:43:28,617 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:43:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1163.79it/s]
2025-03-13 11:43:28,642 [INFO]: There are 3219 embeddings of dim 49152
2025-03-13 11:43:28,642 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-13 11:43:28,642 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:43:28
2025-03-13 11:43:28,642 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:43:28,642 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:43:28,642 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:43:28,642 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:43:28,642 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:43:28
2025-03-13 11:43:28,642 [INFO]: 664.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:43:28,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:43:28,643 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:43:28
2025-03-13 11:43:28,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:43:28,643 [INFO]: 	Creating the index 03/13/2025, 11:43:28
2025-03-13 11:43:28,643 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:43:28
2025-03-13 11:43:28,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:43:28,644 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:43:28
2025-03-13 11:43:28,644 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:43:28,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.27it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.86it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.50it/s] 31%|███       | 4/13 [00:00<00:01,  7.87it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.17it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.39it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.50it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.46it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.35it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.33it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.42it/s]100%|██████████| 13/13 [00:03<00:00,  1.32it/s]100%|██████████| 13/13 [00:03<00:00,  3.51it/s]
2025-03-13 11:43:32,356 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:43:32
2025-03-13 11:44:09,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7322 secs
2025-03-13 11:44:09,089 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 11:44:09,089 [INFO]: 	Compute fast metrics 03/13/2025, 11:44:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-13 11:44:30,627 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5381 secs
2025-03-13 11:44:30,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9867 secs
2025-03-13 11:44:30,631 [INFO]: {
2025-03-13 11:44:30,631 [INFO]: 	index_key: HNSW15
2025-03-13 11:44:30,631 [INFO]: 	index_param: efSearch=246
2025-03-13 11:44:30,631 [INFO]: 	index_path: knn.index
2025-03-13 11:44:30,631 [INFO]: 	size in bytes: 633318310
2025-03-13 11:44:30,631 [INFO]: 	avg_search_speed_ms: 10.31463894796241
2025-03-13 11:44:30,631 [INFO]: 	99p_search_speed_ms: 14.119104442652313
2025-03-13 11:44:30,631 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:44:30,631 [INFO]: 	nb vectors: 3219
2025-03-13 11:44:30,631 [INFO]: 	vectors dimension: 49152
2025-03-13 11:44:30,631 [INFO]: 	compression ratio: 0.9993097341524833
2025-03-13 11:44:30,631 [INFO]: }
2025-03-13 11:44:30,631 [INFO]: 	>>> Finished "Creating the index" in 61.9882 secs
2025-03-13 11:44:30,631 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0135 secs
2025-03-13 11:44:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:44:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 52159 [episode count 18/20]
[retrieval_preprocessing] for episode 79223 [episode count 19/20], we have num_retrieval=np.int64(3213) num_query=np.int64(147)
2025-03-13 11:44:33,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:44:33,783 [INFO]: Launching the whole pipeline 03/13/2025, 11:44:33
2025-03-13 11:44:33,783 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:44:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2165.36it/s]
2025-03-13 11:44:33,806 [INFO]: There are 3213 embeddings of dim 49152
2025-03-13 11:44:33,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-13 11:44:33,806 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,806 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:44:33,806 [INFO]: 		-> Add: 1.8 seconds
2025-03-13 11:44:33,806 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:44:33,806 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:44:33,806 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,806 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:44:33,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:44:33,807 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:44:33
2025-03-13 11:44:33,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:44:33,807 [INFO]: 	Creating the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,807 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:44:33
2025-03-13 11:44:33,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:44:33,808 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:44:33
2025-03-13 11:44:33,808 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-13 11:44:33,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.35it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.12it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.68it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.15it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.81it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.88it/s]100%|██████████| 13/13 [00:03<00:00,  1.69it/s]100%|██████████| 13/13 [00:03<00:00,  3.58it/s]
2025-03-13 11:44:37,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:44:37
2025-03-13 11:45:14,074 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6339 secs
2025-03-13 11:45:14,074 [INFO]: The best hyperparameters are: efSearch=236
2025-03-13 11:45:14,074 [INFO]: 	Compute fast metrics 03/13/2025, 11:45:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-13 11:45:30,013 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9392 secs
2025-03-13 11:45:30,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2083 secs
2025-03-13 11:45:30,016 [INFO]: {
2025-03-13 11:45:30,016 [INFO]: 	index_key: HNSW15
2025-03-13 11:45:30,016 [INFO]: 	index_param: efSearch=236
2025-03-13 11:45:30,016 [INFO]: 	index_path: knn.index
2025-03-13 11:45:30,016 [INFO]: 	size in bytes: 632137810
2025-03-13 11:45:30,016 [INFO]: 	avg_search_speed_ms: 11.329989091916135
2025-03-13 11:45:30,016 [INFO]: 	99p_search_speed_ms: 16.57279118429869
2025-03-13 11:45:30,017 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:45:30,017 [INFO]: 	nb vectors: 3213
2025-03-13 11:45:30,017 [INFO]: 	vectors dimension: 49152
2025-03-13 11:45:30,017 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-13 11:45:30,017 [INFO]: }
2025-03-13 11:45:30,017 [INFO]: 	>>> Finished "Creating the index" in 56.2097 secs
2025-03-13 11:45:30,017 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2333 secs
2025-03-13 11:45:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:45:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 79223 [episode count 19/20]
2025-03-13 11:45:31: [retrieval_preprocessing] finished for 3854327802_move_right [chosen_id count 2/260]
2025-03-13 11:45:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3895077471_press_button_on_coffee_maker [chosen_id count 3/260]
2025-03-13 11:45:33: [retrieval_preprocessing] we have num_total=2396 embedding_dim=49152
[retrieval_preprocessing] for episode 27655 [episode count 0/20], we have num_retrieval=np.int64(2300) num_query=np.int64(96)
2025-03-13 11:45:34,004 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:45:34,454 [INFO]: Launching the whole pipeline 03/13/2025, 11:45:34
2025-03-13 11:45:34,454 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:45:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.97it/s]
2025-03-13 11:45:34,481 [INFO]: There are 2300 embeddings of dim 49152
2025-03-13 11:45:34,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 11:45:34,481 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:45:34
2025-03-13 11:45:34,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:45:34,482 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:45:34,482 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:45:34,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:45:34,482 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:45:34
2025-03-13 11:45:34,482 [INFO]: 474.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:45:34,482 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:45:34,482 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:45:34
2025-03-13 11:45:34,482 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:45:34,482 [INFO]: 	Creating the index 03/13/2025, 11:45:34
2025-03-13 11:45:34,482 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:45:34
2025-03-13 11:45:34,483 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:45:34,483 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:45:34
2025-03-13 11:45:34,483 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:45:34,483 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.63it/s] 30%|███       | 3/10 [00:00<00:00, 10.44it/s] 50%|█████     | 5/10 [00:00<00:00, 11.53it/s] 70%|███████   | 7/10 [00:00<00:00, 11.79it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.85it/s]100%|██████████| 10/10 [00:02<00:00,  4.78it/s]
2025-03-13 11:45:36,581 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:45:36
2025-03-13 11:46:06,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6542 secs
2025-03-13 11:46:06,235 [INFO]: The best hyperparameters are: efSearch=282
2025-03-13 11:46:06,235 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-13 11:46:20,526 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2909 secs
2025-03-13 11:46:20,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0455 secs
2025-03-13 11:46:20,529 [INFO]: {
2025-03-13 11:46:20,529 [INFO]: 	index_key: HNSW15
2025-03-13 11:46:20,529 [INFO]: 	index_param: efSearch=282
2025-03-13 11:46:20,529 [INFO]: 	index_path: knn.index
2025-03-13 11:46:20,529 [INFO]: 	size in bytes: 452510890
2025-03-13 11:46:20,529 [INFO]: 	avg_search_speed_ms: 9.476672882275983
2025-03-13 11:46:20,529 [INFO]: 	99p_search_speed_ms: 12.702107541263105
2025-03-13 11:46:20,529 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:46:20,529 [INFO]: 	nb vectors: 2300
2025-03-13 11:46:20,529 [INFO]: 	vectors dimension: 49152
2025-03-13 11:46:20,529 [INFO]: 	compression ratio: 0.9993094309840809
2025-03-13 11:46:20,529 [INFO]: }
2025-03-13 11:46:20,529 [INFO]: 	>>> Finished "Creating the index" in 46.0471 secs
2025-03-13 11:46:20,529 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0748 secs
2025-03-13 11:46:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:46:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 27655 [episode count 0/20]
[retrieval_preprocessing] for episode 1045 [episode count 1/20], we have num_retrieval=np.int64(2259) num_query=np.int64(137)
2025-03-13 11:46:22,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:46:22,752 [INFO]: Launching the whole pipeline 03/13/2025, 11:46:22
2025-03-13 11:46:22,752 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:46:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.97it/s]
2025-03-13 11:46:22,781 [INFO]: There are 2259 embeddings of dim 49152
2025-03-13 11:46:22,781 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 11:46:22,781 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:46:22
2025-03-13 11:46:22,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:46:22,782 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:46:22,782 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:46:22,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:46:22,782 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:46:22
2025-03-13 11:46:22,783 [INFO]: 466.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:46:22,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:46:22,783 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:46:22
2025-03-13 11:46:22,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:46:22,784 [INFO]: 	Creating the index 03/13/2025, 11:46:22
2025-03-13 11:46:22,784 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:46:22
2025-03-13 11:46:22,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-13 11:46:22,787 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:46:22
2025-03-13 11:46:22,787 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:46:22,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.49it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.80it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.02it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.04it/s]100%|██████████| 9/9 [00:02<00:00,  3.02it/s]100%|██████████| 9/9 [00:02<00:00,  4.18it/s]
2025-03-13 11:46:24,948 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:46:24
2025-03-13 11:46:50,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5260 secs
2025-03-13 11:46:50,474 [INFO]: The best hyperparameters are: efSearch=357
2025-03-13 11:46:50,474 [INFO]: 	Compute fast metrics 03/13/2025, 11:46:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s]
2025-03-13 11:47:08,256 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7823 secs
2025-03-13 11:47:08,258 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4712 secs
2025-03-13 11:47:08,258 [INFO]: {
2025-03-13 11:47:08,258 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:08,258 [INFO]: 	index_param: efSearch=357
2025-03-13 11:47:08,258 [INFO]: 	index_path: knn.index
2025-03-13 11:47:08,258 [INFO]: 	size in bytes: 444444370
2025-03-13 11:47:08,258 [INFO]: 	avg_search_speed_ms: 10.556956615698265
2025-03-13 11:47:08,258 [INFO]: 	99p_search_speed_ms: 13.337743277661502
2025-03-13 11:47:08,258 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:08,258 [INFO]: 	nb vectors: 2259
2025-03-13 11:47:08,258 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:08,258 [INFO]: 	compression ratio: 0.9993094793843378
2025-03-13 11:47:08,258 [INFO]: }
2025-03-13 11:47:08,258 [INFO]: 	>>> Finished "Creating the index" in 45.4747 secs
2025-03-13 11:47:08,258 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5066 secs
2025-03-13 11:47:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 1045 [episode count 1/20]
[retrieval_preprocessing] for episode 52758 [episode count 2/20], we have num_retrieval=np.int64(2294) num_query=np.int64(102)
2025-03-13 11:47:10,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:47:11,335 [INFO]: Launching the whole pipeline 03/13/2025, 11:47:11
2025-03-13 11:47:11,335 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:47:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1960.87it/s]
2025-03-13 11:47:11,359 [INFO]: There are 2294 embeddings of dim 49152
2025-03-13 11:47:11,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-13 11:47:11,359 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:47:11,359 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:47:11,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:47:11,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:47:11,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,359 [INFO]: 473.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:47:11,359 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:47:11,359 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:47:11
2025-03-13 11:47:11,359 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:47:11,359 [INFO]: 	Creating the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,359 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:47:11
2025-03-13 11:47:11,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:47:11,360 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:47:11
2025-03-13 11:47:11,360 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:47:11,360 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.18it/s] 20%|██        | 2/10 [00:00<00:01,  6.84it/s] 30%|███       | 3/10 [00:00<00:00,  7.61it/s] 40%|████      | 4/10 [00:00<00:00,  8.16it/s] 60%|██████    | 6/10 [00:00<00:00,  9.35it/s] 70%|███████   | 7/10 [00:00<00:00,  9.46it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.83it/s]100%|██████████| 10/10 [00:02<00:00,  2.28it/s]100%|██████████| 10/10 [00:02<00:00,  3.96it/s]
2025-03-13 11:47:13,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:47:13
2025-03-13 11:47:41,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6754 secs
2025-03-13 11:47:41,566 [INFO]: The best hyperparameters are: efSearch=344
2025-03-13 11:47:41,566 [INFO]: 	Compute fast metrics 03/13/2025, 11:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-13 11:47:57,797 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2311 secs
2025-03-13 11:47:57,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4386 secs
2025-03-13 11:47:57,799 [INFO]: {
2025-03-13 11:47:57,799 [INFO]: 	index_key: HNSW15
2025-03-13 11:47:57,799 [INFO]: 	index_param: efSearch=344
2025-03-13 11:47:57,799 [INFO]: 	index_path: knn.index
2025-03-13 11:47:57,799 [INFO]: 	size in bytes: 451330450
2025-03-13 11:47:57,799 [INFO]: 	avg_search_speed_ms: 10.415795730659738
2025-03-13 11:47:57,799 [INFO]: 	99p_search_speed_ms: 19.330402060877514
2025-03-13 11:47:57,799 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:47:57,799 [INFO]: 	nb vectors: 2294
2025-03-13 11:47:57,799 [INFO]: 	vectors dimension: 49152
2025-03-13 11:47:57,799 [INFO]: 	compression ratio: 0.9993093796352539
2025-03-13 11:47:57,799 [INFO]: }
2025-03-13 11:47:57,799 [INFO]: 	>>> Finished "Creating the index" in 46.4399 secs
2025-03-13 11:47:57,799 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4638 secs
2025-03-13 11:47:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:47:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 52758 [episode count 2/20]
[retrieval_preprocessing] for episode 94758 [episode count 3/20], we have num_retrieval=np.int64(2263) num_query=np.int64(133)
2025-03-13 11:47:59,993 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:00,306 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:00
2025-03-13 11:48:00,306 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1153.55it/s]
2025-03-13 11:48:00,332 [INFO]: There are 2263 embeddings of dim 49152
2025-03-13 11:48:00,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:48:00,332 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:00
2025-03-13 11:48:00,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:00,332 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:48:00,332 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:00,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:00,332 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:00
2025-03-13 11:48:00,332 [INFO]: 467.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:00,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:48:00,332 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:00
2025-03-13 11:48:00,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:00,332 [INFO]: 	Creating the index 03/13/2025, 11:48:00
2025-03-13 11:48:00,332 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:00
2025-03-13 11:48:00,333 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:48:00,334 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:00
2025-03-13 11:48:00,334 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:48:00,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.10it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.42it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.36it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.30it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.35it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.31it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.32it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.98it/s]100%|██████████| 9/9 [00:02<00:00,  1.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.05it/s]
2025-03-13 11:48:03,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:03
2025-03-13 11:48:29,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3991 secs
2025-03-13 11:48:29,689 [INFO]: The best hyperparameters are: efSearch=342
2025-03-13 11:48:29,689 [INFO]: 	Compute fast metrics 03/13/2025, 11:48:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-13 11:48:48,012 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3227 secs
2025-03-13 11:48:48,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6800 secs
2025-03-13 11:48:48,014 [INFO]: {
2025-03-13 11:48:48,014 [INFO]: 	index_key: HNSW15
2025-03-13 11:48:48,014 [INFO]: 	index_param: efSearch=342
2025-03-13 11:48:48,014 [INFO]: 	index_path: knn.index
2025-03-13 11:48:48,014 [INFO]: 	size in bytes: 445231390
2025-03-13 11:48:48,014 [INFO]: 	avg_search_speed_ms: 9.722666824652848
2025-03-13 11:48:48,014 [INFO]: 	99p_search_speed_ms: 13.352197222411636
2025-03-13 11:48:48,014 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:48:48,014 [INFO]: 	nb vectors: 2263
2025-03-13 11:48:48,014 [INFO]: 	vectors dimension: 49152
2025-03-13 11:48:48,014 [INFO]: 	compression ratio: 0.999309379331947
2025-03-13 11:48:48,014 [INFO]: }
2025-03-13 11:48:48,014 [INFO]: 	>>> Finished "Creating the index" in 47.6815 secs
2025-03-13 11:48:48,014 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7079 secs
2025-03-13 11:48:49: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:48:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 94758 [episode count 3/20]
[retrieval_preprocessing] for episode 93224 [episode count 4/20], we have num_retrieval=np.int64(2298) num_query=np.int64(98)
2025-03-13 11:48:50,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:48:50,815 [INFO]: Launching the whole pipeline 03/13/2025, 11:48:50
2025-03-13 11:48:50,815 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:48:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-13 11:48:50,838 [INFO]: There are 2298 embeddings of dim 49152
2025-03-13 11:48:50,838 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-13 11:48:50,838 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:48:50
2025-03-13 11:48:50,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:48:50,839 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:48:50,839 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:48:50,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:48:50,839 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:48:50
2025-03-13 11:48:50,839 [INFO]: 474.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:48:50,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:48:50,839 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:48:50
2025-03-13 11:48:50,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:48:50,839 [INFO]: 	Creating the index 03/13/2025, 11:48:50
2025-03-13 11:48:50,839 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:48:50
2025-03-13 11:48:50,840 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:48:50,840 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:48:50
2025-03-13 11:48:50,840 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:48:50,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.13it/s] 30%|███       | 3/10 [00:00<00:00, 10.21it/s] 50%|█████     | 5/10 [00:00<00:00, 12.11it/s] 70%|███████   | 7/10 [00:00<00:00, 12.97it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.51it/s]100%|██████████| 10/10 [00:02<00:00,  4.83it/s]
2025-03-13 11:48:52,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:48:52
2025-03-13 11:49:24,245 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3312 secs
2025-03-13 11:49:24,245 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 11:49:24,245 [INFO]: 	Compute fast metrics 03/13/2025, 11:49:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.64it/s]
2025-03-13 11:49:38,123 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8776 secs
2025-03-13 11:49:38,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2849 secs
2025-03-13 11:49:38,126 [INFO]: {
2025-03-13 11:49:38,126 [INFO]: 	index_key: HNSW15
2025-03-13 11:49:38,126 [INFO]: 	index_param: efSearch=287
2025-03-13 11:49:38,126 [INFO]: 	index_path: knn.index
2025-03-13 11:49:38,126 [INFO]: 	size in bytes: 452117410
2025-03-13 11:49:38,126 [INFO]: 	avg_search_speed_ms: 8.677653661935539
2025-03-13 11:49:38,126 [INFO]: 	99p_search_speed_ms: 11.795375884976238
2025-03-13 11:49:38,126 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:49:38,126 [INFO]: 	nb vectors: 2298
2025-03-13 11:49:38,126 [INFO]: 	vectors dimension: 49152
2025-03-13 11:49:38,126 [INFO]: 	compression ratio: 0.999309413897598
2025-03-13 11:49:38,126 [INFO]: }
2025-03-13 11:49:38,126 [INFO]: 	>>> Finished "Creating the index" in 47.2868 secs
2025-03-13 11:49:38,126 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3110 secs
2025-03-13 11:49:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:49:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 93224 [episode count 4/20]
[retrieval_preprocessing] for episode 65577 [episode count 5/20], we have num_retrieval=np.int64(2296) num_query=np.int64(100)
2025-03-13 11:49:39,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:49:40,172 [INFO]: Launching the whole pipeline 03/13/2025, 11:49:40
2025-03-13 11:49:40,172 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:49:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-13 11:49:40,197 [INFO]: There are 2296 embeddings of dim 49152
2025-03-13 11:49:40,197 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-13 11:49:40,197 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:49:40
2025-03-13 11:49:40,197 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:49:40,198 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:49:40,198 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:49:40,198 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:49:40,198 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:49:40
2025-03-13 11:49:40,198 [INFO]: 473.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:49:40,198 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:49:40,198 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:49:40
2025-03-13 11:49:40,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:49:40,199 [INFO]: 	Creating the index 03/13/2025, 11:49:40
2025-03-13 11:49:40,199 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:49:40
2025-03-13 11:49:40,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:49:40,202 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:49:40
2025-03-13 11:49:40,202 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:49:40,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.88it/s] 30%|███       | 3/10 [00:00<00:00,  9.18it/s] 50%|█████     | 5/10 [00:00<00:00, 10.37it/s] 70%|███████   | 7/10 [00:00<00:00, 10.87it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.14it/s]100%|██████████| 10/10 [00:02<00:00,  4.29it/s]
2025-03-13 11:49:42,537 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:49:42
2025-03-13 11:50:07,443 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9049 secs
2025-03-13 11:50:07,443 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 11:50:07,443 [INFO]: 	Compute fast metrics 03/13/2025, 11:50:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s]
2025-03-13 11:50:30,058 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6150 secs
2025-03-13 11:50:30,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8572 secs
2025-03-13 11:50:30,060 [INFO]: {
2025-03-13 11:50:30,060 [INFO]: 	index_key: HNSW15
2025-03-13 11:50:30,060 [INFO]: 	index_param: efSearch=265
2025-03-13 11:50:30,060 [INFO]: 	index_path: knn.index
2025-03-13 11:50:30,060 [INFO]: 	size in bytes: 451723930
2025-03-13 11:50:30,060 [INFO]: 	avg_search_speed_ms: 8.09711458195408
2025-03-13 11:50:30,060 [INFO]: 	99p_search_speed_ms: 10.750305294059219
2025-03-13 11:50:30,060 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:50:30,060 [INFO]: 	nb vectors: 2296
2025-03-13 11:50:30,060 [INFO]: 	vectors dimension: 49152
2025-03-13 11:50:30,060 [INFO]: 	compression ratio: 0.9993093967813483
2025-03-13 11:50:30,060 [INFO]: }
2025-03-13 11:50:30,060 [INFO]: 	>>> Finished "Creating the index" in 49.8611 secs
2025-03-13 11:50:30,060 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8879 secs
2025-03-13 11:50:30: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:50:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 65577 [episode count 5/20]
[retrieval_preprocessing] for episode 8276 [episode count 6/20], we have num_retrieval=np.int64(2281) num_query=np.int64(115)
2025-03-13 11:50:31,767 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:50:32,071 [INFO]: Launching the whole pipeline 03/13/2025, 11:50:32
2025-03-13 11:50:32,071 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:50:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1558.64it/s]
2025-03-13 11:50:32,096 [INFO]: There are 2281 embeddings of dim 49152
2025-03-13 11:50:32,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-13 11:50:32,096 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:50:32
2025-03-13 11:50:32,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:50:32,096 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:50:32,096 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:50:32,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:50:32,096 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:50:32
2025-03-13 11:50:32,096 [INFO]: 470.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:50:32,096 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:50:32,096 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:50:32
2025-03-13 11:50:32,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:50:32,096 [INFO]: 	Creating the index 03/13/2025, 11:50:32
2025-03-13 11:50:32,097 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:50:32
2025-03-13 11:50:32,098 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:50:32,098 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:50:32
2025-03-13 11:50:32,098 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:50:32,098 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.60it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.46it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.44it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.75it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.39it/s]100%|██████████| 9/9 [00:02<00:00,  3.02it/s]100%|██████████| 9/9 [00:02<00:00,  4.21it/s]
2025-03-13 11:50:34,247 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:50:34
2025-03-13 11:51:04,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8484 secs
2025-03-13 11:51:04,096 [INFO]: The best hyperparameters are: efSearch=307
2025-03-13 11:51:04,096 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-13 11:51:18,055 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9594 secs
2025-03-13 11:51:18,057 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9595 secs
2025-03-13 11:51:18,057 [INFO]: {
2025-03-13 11:51:18,057 [INFO]: 	index_key: HNSW15
2025-03-13 11:51:18,057 [INFO]: 	index_param: efSearch=307
2025-03-13 11:51:18,057 [INFO]: 	index_path: knn.index
2025-03-13 11:51:18,057 [INFO]: 	size in bytes: 448772710
2025-03-13 11:51:18,057 [INFO]: 	avg_search_speed_ms: 10.681034496121713
2025-03-13 11:51:18,057 [INFO]: 	99p_search_speed_ms: 19.707599154207845
2025-03-13 11:51:18,057 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:51:18,057 [INFO]: 	nb vectors: 2281
2025-03-13 11:51:18,057 [INFO]: 	vectors dimension: 49152
2025-03-13 11:51:18,057 [INFO]: 	compression ratio: 0.9993095346639951
2025-03-13 11:51:18,057 [INFO]: }
2025-03-13 11:51:18,058 [INFO]: 	>>> Finished "Creating the index" in 45.9610 secs
2025-03-13 11:51:18,058 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9865 secs
2025-03-13 11:51:18: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 8276 [episode count 6/20]
[retrieval_preprocessing] for episode 91224 [episode count 7/20], we have num_retrieval=np.int64(2245) num_query=np.int64(151)
2025-03-13 11:51:20,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:51:20,721 [INFO]: Launching the whole pipeline 03/13/2025, 11:51:20
2025-03-13 11:51:20,722 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:51:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.74it/s]
2025-03-13 11:51:20,749 [INFO]: There are 2245 embeddings of dim 49152
2025-03-13 11:51:20,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 11:51:20,750 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:51:20
2025-03-13 11:51:20,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:51:20,750 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:51:20,750 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:51:20,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:51:20,750 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:51:20
2025-03-13 11:51:20,750 [INFO]: 463.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:51:20,751 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:51:20,751 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:51:20
2025-03-13 11:51:20,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:51:20,751 [INFO]: 	Creating the index 03/13/2025, 11:51:20
2025-03-13 11:51:20,752 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:51:20
2025-03-13 11:51:20,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:51:20,754 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:51:20
2025-03-13 11:51:20,755 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:51:20,755 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.75it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.23it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.26it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.53it/s]100%|██████████| 9/9 [00:02<00:00,  2.79it/s]100%|██████████| 9/9 [00:02<00:00,  3.93it/s]
2025-03-13 11:51:23,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:51:23
2025-03-13 11:51:49,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9821 secs
2025-03-13 11:51:49,037 [INFO]: The best hyperparameters are: efSearch=362
2025-03-13 11:51:49,037 [INFO]: 	Compute fast metrics 03/13/2025, 11:51:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s]
2025-03-13 11:52:04,641 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6038 secs
2025-03-13 11:52:04,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8883 secs
2025-03-13 11:52:04,643 [INFO]: {
2025-03-13 11:52:04,643 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:04,643 [INFO]: 	index_param: efSearch=362
2025-03-13 11:52:04,643 [INFO]: 	index_path: knn.index
2025-03-13 11:52:04,643 [INFO]: 	size in bytes: 441690010
2025-03-13 11:52:04,643 [INFO]: 	avg_search_speed_ms: 10.539349045376788
2025-03-13 11:52:04,643 [INFO]: 	99p_search_speed_ms: 13.81649604998529
2025-03-13 11:52:04,643 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:04,643 [INFO]: 	nb vectors: 2245
2025-03-13 11:52:04,643 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:04,643 [INFO]: 	compression ratio: 0.9993093572571405
2025-03-13 11:52:04,643 [INFO]: }
2025-03-13 11:52:04,643 [INFO]: 	>>> Finished "Creating the index" in 43.8917 secs
2025-03-13 11:52:04,643 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9216 secs
2025-03-13 11:52:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 91224 [episode count 7/20]
[retrieval_preprocessing] for episode 53861 [episode count 8/20], we have num_retrieval=np.int64(2262) num_query=np.int64(134)
2025-03-13 11:52:07,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:07,900 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:07
2025-03-13 11:52:07,900 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1855.07it/s]
2025-03-13 11:52:08,246 [INFO]: There are 2262 embeddings of dim 49152
2025-03-13 11:52:08,246 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3460 secs
2025-03-13 11:52:08,247 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:08,247 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:52:08,247 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:08,248 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 11:52:08,248 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,248 [INFO]: 466.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:08,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 11:52:08,249 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:08
2025-03-13 11:52:08,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:08,249 [INFO]: 	Creating the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,250 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:08
2025-03-13 11:52:08,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0045 secs
2025-03-13 11:52:08,255 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:08
2025-03-13 11:52:08,255 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:52:08,255 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.43it/s]100%|██████████| 9/9 [00:01<00:00,  4.97it/s]100%|██████████| 9/9 [00:01<00:00,  5.41it/s]
2025-03-13 11:52:09,926 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:09
2025-03-13 11:52:37,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0438 secs
2025-03-13 11:52:37,971 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 11:52:37,971 [INFO]: 	Compute fast metrics 03/13/2025, 11:52:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.75it/s]
2025-03-13 11:52:53,219 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2475 secs
2025-03-13 11:52:53,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9659 secs
2025-03-13 11:52:53,221 [INFO]: {
2025-03-13 11:52:53,221 [INFO]: 	index_key: HNSW15
2025-03-13 11:52:53,221 [INFO]: 	index_param: efSearch=260
2025-03-13 11:52:53,221 [INFO]: 	index_path: knn.index
2025-03-13 11:52:53,221 [INFO]: 	size in bytes: 445034650
2025-03-13 11:52:53,221 [INFO]: 	avg_search_speed_ms: 10.865693541658718
2025-03-13 11:52:53,221 [INFO]: 	99p_search_speed_ms: 17.241926463320848
2025-03-13 11:52:53,221 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:52:53,221 [INFO]: 	nb vectors: 2262
2025-03-13 11:52:53,221 [INFO]: 	vectors dimension: 49152
2025-03-13 11:52:53,221 [INFO]: 	compression ratio: 0.9993093706299049
2025-03-13 11:52:53,221 [INFO]: }
2025-03-13 11:52:53,221 [INFO]: 	>>> Finished "Creating the index" in 44.9717 secs
2025-03-13 11:52:53,221 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3211 secs
2025-03-13 11:52:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:52:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 53861 [episode count 8/20]
[retrieval_preprocessing] for episode 73828 [episode count 9/20], we have num_retrieval=np.int64(2298) num_query=np.int64(98)
2025-03-13 11:52:55,138 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:52:55,634 [INFO]: Launching the whole pipeline 03/13/2025, 11:52:55
2025-03-13 11:52:55,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:52:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-13 11:52:55,663 [INFO]: There are 2298 embeddings of dim 49152
2025-03-13 11:52:55,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 11:52:55,664 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:52:55
2025-03-13 11:52:55,664 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:52:55,664 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:52:55,664 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:52:55,664 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 11:52:55,664 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:52:55
2025-03-13 11:52:55,665 [INFO]: 474.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:52:55,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:52:55,665 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:52:55
2025-03-13 11:52:55,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:52:55,665 [INFO]: 	Creating the index 03/13/2025, 11:52:55
2025-03-13 11:52:55,666 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:52:55
2025-03-13 11:52:55,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:52:55,669 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:52:55
2025-03-13 11:52:55,669 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:52:55,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.79it/s] 30%|███       | 3/10 [00:00<00:00,  9.51it/s] 50%|█████     | 5/10 [00:00<00:00, 11.28it/s]100%|██████████| 10/10 [00:01<00:00,  4.45it/s]100%|██████████| 10/10 [00:01<00:00,  5.07it/s]
2025-03-13 11:52:57,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:52:57
2025-03-13 11:53:28,541 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8922 secs
2025-03-13 11:53:28,541 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 11:53:28,542 [INFO]: 	Compute fast metrics 03/13/2025, 11:53:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-13 11:53:41,987 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4457 secs
2025-03-13 11:53:41,989 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3201 secs
2025-03-13 11:53:41,989 [INFO]: {
2025-03-13 11:53:41,989 [INFO]: 	index_key: HNSW15
2025-03-13 11:53:41,989 [INFO]: 	index_param: efSearch=287
2025-03-13 11:53:41,989 [INFO]: 	index_path: knn.index
2025-03-13 11:53:41,989 [INFO]: 	size in bytes: 452117410
2025-03-13 11:53:41,989 [INFO]: 	avg_search_speed_ms: 11.758256473246913
2025-03-13 11:53:41,989 [INFO]: 	99p_search_speed_ms: 18.23921559844166
2025-03-13 11:53:41,989 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:53:41,989 [INFO]: 	nb vectors: 2298
2025-03-13 11:53:41,989 [INFO]: 	vectors dimension: 49152
2025-03-13 11:53:41,989 [INFO]: 	compression ratio: 0.999309413897598
2025-03-13 11:53:41,989 [INFO]: }
2025-03-13 11:53:41,989 [INFO]: 	>>> Finished "Creating the index" in 46.3241 secs
2025-03-13 11:53:41,990 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3552 secs
2025-03-13 11:53:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:53:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 73828 [episode count 9/20]
[retrieval_preprocessing] for episode 4227 [episode count 10/20], we have num_retrieval=np.int64(2233) num_query=np.int64(163)
2025-03-13 11:53:43,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:53:44,277 [INFO]: Launching the whole pipeline 03/13/2025, 11:53:44
2025-03-13 11:53:44,277 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:53:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-13 11:53:44,304 [INFO]: There are 2233 embeddings of dim 49152
2025-03-13 11:53:44,305 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-13 11:53:44,305 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:53:44
2025-03-13 11:53:44,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:53:44,305 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:53:44,305 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:53:44,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:53:44,305 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:53:44
2025-03-13 11:53:44,305 [INFO]: 460.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:53:44,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 11:53:44,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:53:44
2025-03-13 11:53:44,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:53:44,305 [INFO]: 	Creating the index 03/13/2025, 11:53:44
2025-03-13 11:53:44,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:53:44
2025-03-13 11:53:44,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 11:53:44,306 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:53:44
2025-03-13 11:53:44,307 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:53:44,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.43it/s]100%|██████████| 9/9 [00:01<00:00,  5.54it/s]100%|██████████| 9/9 [00:01<00:00,  6.01it/s]
2025-03-13 11:53:45,808 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:53:45
2025-03-13 11:54:15,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6442 secs
2025-03-13 11:54:15,453 [INFO]: The best hyperparameters are: efSearch=239
2025-03-13 11:54:15,453 [INFO]: 	Compute fast metrics 03/13/2025, 11:54:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.03it/s]
2025-03-13 11:54:30,083 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6298 secs
2025-03-13 11:54:30,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1437 secs
2025-03-13 11:54:30,451 [INFO]: {
2025-03-13 11:54:30,451 [INFO]: 	index_key: HNSW15
2025-03-13 11:54:30,451 [INFO]: 	index_param: efSearch=239
2025-03-13 11:54:30,451 [INFO]: 	index_path: knn.index
2025-03-13 11:54:30,451 [INFO]: 	size in bytes: 439329130
2025-03-13 11:54:30,451 [INFO]: 	avg_search_speed_ms: 9.929056562596143
2025-03-13 11:54:30,451 [INFO]: 	99p_search_speed_ms: 16.760997609235343
2025-03-13 11:54:30,451 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:54:30,451 [INFO]: 	nb vectors: 2233
2025-03-13 11:54:30,451 [INFO]: 	vectors dimension: 49152
2025-03-13 11:54:30,451 [INFO]: 	compression ratio: 0.9993092513578601
2025-03-13 11:54:30,451 [INFO]: }
2025-03-13 11:54:30,451 [INFO]: 	>>> Finished "Creating the index" in 46.1461 secs
2025-03-13 11:54:30,451 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1744 secs
2025-03-13 11:54:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:54:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 4227 [episode count 10/20]
[retrieval_preprocessing] for episode 34438 [episode count 11/20], we have num_retrieval=np.int64(2241) num_query=np.int64(155)
2025-03-13 11:54:32,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:54:32,379 [INFO]: Launching the whole pipeline 03/13/2025, 11:54:32
2025-03-13 11:54:32,379 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:54:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.65it/s]
2025-03-13 11:54:32,414 [INFO]: There are 2241 embeddings of dim 49152
2025-03-13 11:54:32,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-13 11:54:32,415 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:54:32
2025-03-13 11:54:32,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:54:32,415 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:54:32,415 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:54:32,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 11:54:32,416 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:54:32
2025-03-13 11:54:32,416 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:54:32,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:54:32,416 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:54:32
2025-03-13 11:54:32,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:54:32,417 [INFO]: 	Creating the index 03/13/2025, 11:54:32
2025-03-13 11:54:32,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:54:32
2025-03-13 11:54:32,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 11:54:32,420 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:54:32
2025-03-13 11:54:32,421 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:54:32,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.99it/s] 78%|███████▊  | 7/9 [00:00<00:00, 36.30it/s]100%|██████████| 9/9 [00:01<00:00,  5.65it/s]
2025-03-13 11:54:34,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:54:34
2025-03-13 11:55:05,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3585 secs
2025-03-13 11:55:05,380 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 11:55:05,380 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s]
2025-03-13 11:55:19,051 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6703 secs
2025-03-13 11:55:19,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2322 secs
2025-03-13 11:55:19,653 [INFO]: {
2025-03-13 11:55:19,653 [INFO]: 	index_key: HNSW15
2025-03-13 11:55:19,653 [INFO]: 	index_param: efSearch=227
2025-03-13 11:55:19,653 [INFO]: 	index_path: knn.index
2025-03-13 11:55:19,653 [INFO]: 	size in bytes: 440903050
2025-03-13 11:55:19,653 [INFO]: 	avg_search_speed_ms: 9.833029501328763
2025-03-13 11:55:19,653 [INFO]: 	99p_search_speed_ms: 14.675912661477927
2025-03-13 11:55:19,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:55:19,654 [INFO]: 	nb vectors: 2241
2025-03-13 11:55:19,654 [INFO]: 	vectors dimension: 49152
2025-03-13 11:55:19,654 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-13 11:55:19,654 [INFO]: }
2025-03-13 11:55:19,654 [INFO]: 	>>> Finished "Creating the index" in 47.2370 secs
2025-03-13 11:55:19,654 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2750 secs
2025-03-13 11:55:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:55:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 34438 [episode count 11/20]
[retrieval_preprocessing] for episode 81050 [episode count 12/20], we have num_retrieval=np.int64(2291) num_query=np.int64(105)
2025-03-13 11:55:21,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:55:21,461 [INFO]: Launching the whole pipeline 03/13/2025, 11:55:21
2025-03-13 11:55:21,461 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:55:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-13 11:55:21,487 [INFO]: There are 2291 embeddings of dim 49152
2025-03-13 11:55:21,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 11:55:21,487 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:55:21
2025-03-13 11:55:21,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:55:21,487 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:55:21,487 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:55:21,487 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:55:21,487 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:55:21
2025-03-13 11:55:21,487 [INFO]: 472.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:55:21,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:55:21,487 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:55:21
2025-03-13 11:55:21,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:55:21,488 [INFO]: 	Creating the index 03/13/2025, 11:55:21
2025-03-13 11:55:21,488 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:55:21
2025-03-13 11:55:21,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:55:21,489 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:55:21
2025-03-13 11:55:21,489 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:55:21,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.85it/s] 70%|███████   | 7/10 [00:00<00:00, 34.24it/s]100%|██████████| 10/10 [00:01<00:00,  6.56it/s]
2025-03-13 11:55:23,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:55:23
2025-03-13 11:55:47,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3826 secs
2025-03-13 11:55:47,400 [INFO]: The best hyperparameters are: efSearch=267
2025-03-13 11:55:47,400 [INFO]: 	Compute fast metrics 03/13/2025, 11:55:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-13 11:56:02,112 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7123 secs
2025-03-13 11:56:02,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6259 secs
2025-03-13 11:56:02,115 [INFO]: {
2025-03-13 11:56:02,115 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:02,115 [INFO]: 	index_param: efSearch=267
2025-03-13 11:56:02,115 [INFO]: 	index_path: knn.index
2025-03-13 11:56:02,115 [INFO]: 	size in bytes: 450740230
2025-03-13 11:56:02,115 [INFO]: 	avg_search_speed_ms: 10.467023039762726
2025-03-13 11:56:02,115 [INFO]: 	99p_search_speed_ms: 22.996079013682905
2025-03-13 11:56:02,115 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:02,115 [INFO]: 	nb vectors: 2291
2025-03-13 11:56:02,115 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:02,115 [INFO]: 	compression ratio: 0.9993093538599828
2025-03-13 11:56:02,115 [INFO]: }
2025-03-13 11:56:02,115 [INFO]: 	>>> Finished "Creating the index" in 40.6274 secs
2025-03-13 11:56:02,115 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6544 secs
2025-03-13 11:56:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 81050 [episode count 12/20]
[retrieval_preprocessing] for episode 7836 [episode count 13/20], we have num_retrieval=np.int64(2270) num_query=np.int64(126)
2025-03-13 11:56:03,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:04,089 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:04
2025-03-13 11:56:04,089 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.46it/s]
2025-03-13 11:56:04,116 [INFO]: There are 2270 embeddings of dim 49152
2025-03-13 11:56:04,116 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 11:56:04,116 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:04,116 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:56:04,116 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:04,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:04,116 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,116 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:04,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:56:04,116 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:04
2025-03-13 11:56:04,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:04,116 [INFO]: 	Creating the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,116 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:04
2025-03-13 11:56:04,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 11:56:04,117 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:04
2025-03-13 11:56:04,118 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:56:04,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.49it/s] 67%|██████▋   | 6/9 [00:00<00:00, 28.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]100%|██████████| 9/9 [00:02<00:00,  4.11it/s]
2025-03-13 11:56:06,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:06
2025-03-13 11:56:34,158 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8458 secs
2025-03-13 11:56:34,158 [INFO]: The best hyperparameters are: efSearch=311
2025-03-13 11:56:34,158 [INFO]: 	Compute fast metrics 03/13/2025, 11:56:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.60it/s]
2025-03-13 11:56:48,106 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9472 secs
2025-03-13 11:56:48,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9897 secs
2025-03-13 11:56:48,107 [INFO]: {
2025-03-13 11:56:48,107 [INFO]: 	index_key: HNSW15
2025-03-13 11:56:48,107 [INFO]: 	index_param: efSearch=311
2025-03-13 11:56:48,107 [INFO]: 	index_path: knn.index
2025-03-13 11:56:48,107 [INFO]: 	size in bytes: 446608570
2025-03-13 11:56:48,107 [INFO]: 	avg_search_speed_ms: 9.641576493464289
2025-03-13 11:56:48,107 [INFO]: 	99p_search_speed_ms: 14.624872235581288
2025-03-13 11:56:48,107 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:56:48,107 [INFO]: 	nb vectors: 2270
2025-03-13 11:56:48,107 [INFO]: 	vectors dimension: 49152
2025-03-13 11:56:48,107 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-13 11:56:48,107 [INFO]: }
2025-03-13 11:56:48,108 [INFO]: 	>>> Finished "Creating the index" in 43.9911 secs
2025-03-13 11:56:48,108 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0187 secs
2025-03-13 11:56:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:56:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 7836 [episode count 13/20]
[retrieval_preprocessing] for episode 38558 [episode count 14/20], we have num_retrieval=np.int64(2277) num_query=np.int64(119)
2025-03-13 11:56:49,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:56:49,764 [INFO]: Launching the whole pipeline 03/13/2025, 11:56:49
2025-03-13 11:56:49,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:56:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.94it/s]
2025-03-13 11:56:49,789 [INFO]: There are 2277 embeddings of dim 49152
2025-03-13 11:56:49,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-13 11:56:49,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:56:49
2025-03-13 11:56:49,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:56:49,790 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:56:49,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:56:49,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:56:49,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:56:49
2025-03-13 11:56:49,790 [INFO]: 469.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:56:49,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:56:49,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:56:49
2025-03-13 11:56:49,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:56:49,790 [INFO]: 	Creating the index 03/13/2025, 11:56:49
2025-03-13 11:56:49,790 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:56:49
2025-03-13 11:56:49,791 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 11:56:49,791 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:56:49
2025-03-13 11:56:49,791 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:56:49,791 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.13it/s] 67%|██████▋   | 6/9 [00:00<00:00, 29.81it/s]100%|██████████| 9/9 [00:01<00:00,  5.74it/s]
2025-03-13 11:56:51,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:56:51
2025-03-13 11:57:19,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2610 secs
2025-03-13 11:57:19,626 [INFO]: The best hyperparameters are: efSearch=314
2025-03-13 11:57:19,626 [INFO]: 	Compute fast metrics 03/13/2025, 11:57:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.97it/s]
2025-03-13 11:57:32,663 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0370 secs
2025-03-13 11:57:32,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9408 secs
2025-03-13 11:57:32,732 [INFO]: {
2025-03-13 11:57:32,733 [INFO]: 	index_key: HNSW15
2025-03-13 11:57:32,733 [INFO]: 	index_param: efSearch=314
2025-03-13 11:57:32,733 [INFO]: 	index_path: knn.index
2025-03-13 11:57:32,733 [INFO]: 	size in bytes: 447985750
2025-03-13 11:57:32,733 [INFO]: 	avg_search_speed_ms: 11.238637454075258
2025-03-13 11:57:32,733 [INFO]: 	99p_search_speed_ms: 18.716732864268124
2025-03-13 11:57:32,733 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:57:32,733 [INFO]: 	nb vectors: 2277
2025-03-13 11:57:32,733 [INFO]: 	vectors dimension: 49152
2025-03-13 11:57:32,733 [INFO]: 	compression ratio: 0.9993095003579913
2025-03-13 11:57:32,733 [INFO]: }
2025-03-13 11:57:32,733 [INFO]: 	>>> Finished "Creating the index" in 42.9431 secs
2025-03-13 11:57:32,733 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9696 secs
2025-03-13 11:57:33: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:57:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 38558 [episode count 14/20]
[retrieval_preprocessing] for episode 59040 [episode count 15/20], we have num_retrieval=np.int64(2285) num_query=np.int64(111)
2025-03-13 11:57:34,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:57:34,844 [INFO]: Launching the whole pipeline 03/13/2025, 11:57:34
2025-03-13 11:57:34,844 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:57:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2272.10it/s]
2025-03-13 11:57:34,867 [INFO]: There are 2285 embeddings of dim 49152
2025-03-13 11:57:34,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-13 11:57:34,868 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:57:34
2025-03-13 11:57:34,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:57:34,868 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:57:34,868 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:57:34,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:57:34,868 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:57:34
2025-03-13 11:57:34,869 [INFO]: 471.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:57:34,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 11:57:34,869 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:57:34
2025-03-13 11:57:34,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:57:34,869 [INFO]: 	Creating the index 03/13/2025, 11:57:34
2025-03-13 11:57:34,870 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:57:34
2025-03-13 11:57:34,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 11:57:34,873 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:57:34
2025-03-13 11:57:34,873 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:57:34,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.19it/s] 67%|██████▋   | 6/9 [00:00<00:00, 30.50it/s]100%|██████████| 9/9 [00:01<00:00,  4.77it/s]
2025-03-13 11:57:36,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:57:36
2025-03-13 11:58:07,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7898 secs
2025-03-13 11:58:07,751 [INFO]: The best hyperparameters are: efSearch=269
2025-03-13 11:58:07,751 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.85it/s]
2025-03-13 11:58:23,626 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8752 secs
2025-03-13 11:58:24,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7067 secs
2025-03-13 11:58:24,580 [INFO]: {
2025-03-13 11:58:24,580 [INFO]: 	index_key: HNSW15
2025-03-13 11:58:24,580 [INFO]: 	index_param: efSearch=269
2025-03-13 11:58:24,581 [INFO]: 	index_path: knn.index
2025-03-13 11:58:24,581 [INFO]: 	size in bytes: 449559670
2025-03-13 11:58:24,581 [INFO]: 	avg_search_speed_ms: 9.059463289146231
2025-03-13 11:58:24,581 [INFO]: 	99p_search_speed_ms: 11.852927596773952
2025-03-13 11:58:24,581 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:58:24,581 [INFO]: 	nb vectors: 2285
2025-03-13 11:58:24,581 [INFO]: 	vectors dimension: 49152
2025-03-13 11:58:24,581 [INFO]: 	compression ratio: 0.9993095688498926
2025-03-13 11:58:24,581 [INFO]: }
2025-03-13 11:58:24,581 [INFO]: 	>>> Finished "Creating the index" in 49.7114 secs
2025-03-13 11:58:24,581 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7373 secs
2025-03-13 11:58:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:58:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 59040 [episode count 15/20]
[retrieval_preprocessing] for episode 86688 [episode count 16/20], we have num_retrieval=np.int64(2268) num_query=np.int64(128)
2025-03-13 11:58:25,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:58:26,463 [INFO]: Launching the whole pipeline 03/13/2025, 11:58:26
2025-03-13 11:58:26,463 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:58:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.12it/s]
2025-03-13 11:58:26,492 [INFO]: There are 2268 embeddings of dim 49152
2025-03-13 11:58:26,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-13 11:58:26,493 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,493 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:58:26,493 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:58:26,493 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:58:26,493 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:58:26,493 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,493 [INFO]: 468.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:58:26,493 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:58:26,493 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:58:26
2025-03-13 11:58:26,493 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:58:26,493 [INFO]: 	Creating the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,494 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:58:26
2025-03-13 11:58:26,494 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:58:26,495 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:58:26
2025-03-13 11:58:26,495 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:58:26,495 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.39it/s] 78%|███████▊  | 7/9 [00:00<00:00, 33.57it/s]100%|██████████| 9/9 [00:01<00:00,  4.92it/s]
2025-03-13 11:58:28,326 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:58:28
2025-03-13 11:58:57,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6326 secs
2025-03-13 11:58:57,960 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 11:58:57,960 [INFO]: 	Compute fast metrics 03/13/2025, 11:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.91it/s]
2025-03-13 11:59:13,996 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0365 secs
2025-03-13 11:59:13,998 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5032 secs
2025-03-13 11:59:13,998 [INFO]: {
2025-03-13 11:59:13,998 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:13,998 [INFO]: 	index_param: efSearch=283
2025-03-13 11:59:13,998 [INFO]: 	index_path: knn.index
2025-03-13 11:59:13,998 [INFO]: 	size in bytes: 446215090
2025-03-13 11:59:13,998 [INFO]: 	avg_search_speed_ms: 9.429387399763515
2025-03-13 11:59:13,998 [INFO]: 	99p_search_speed_ms: 17.33251484110957
2025-03-13 11:59:13,998 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:13,998 [INFO]: 	nb vectors: 2268
2025-03-13 11:59:13,998 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:13,998 [INFO]: 	compression ratio: 0.999309422727053
2025-03-13 11:59:13,998 [INFO]: }
2025-03-13 11:59:13,998 [INFO]: 	>>> Finished "Creating the index" in 47.5047 secs
2025-03-13 11:59:13,998 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5352 secs
2025-03-13 11:59:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 86688 [episode count 16/20]
[retrieval_preprocessing] for episode 8889 [episode count 17/20], we have num_retrieval=np.int64(2296) num_query=np.int64(100)
2025-03-13 11:59:15,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:15,692 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:15
2025-03-13 11:59:15,692 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2189.09it/s]
2025-03-13 11:59:15,717 [INFO]: There are 2296 embeddings of dim 49152
2025-03-13 11:59:15,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-13 11:59:15,718 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:15
2025-03-13 11:59:15,718 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:15,718 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 11:59:15,719 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:15,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 11:59:15,719 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:15
2025-03-13 11:59:15,719 [INFO]: 473.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:15,720 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 11:59:15,720 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:15
2025-03-13 11:59:15,720 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:15,720 [INFO]: 	Creating the index 03/13/2025, 11:59:15
2025-03-13 11:59:15,720 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:15
2025-03-13 11:59:15,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 11:59:15,723 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:15
2025-03-13 11:59:15,723 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:59:15,723 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.21it/s] 80%|████████  | 8/10 [00:00<00:00, 38.42it/s]100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
2025-03-13 11:59:17,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 11:59:17
2025-03-13 11:59:44,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4898 secs
2025-03-13 11:59:44,681 [INFO]: The best hyperparameters are: efSearch=322
2025-03-13 11:59:44,681 [INFO]: 	Compute fast metrics 03/13/2025, 11:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.77it/s]
2025-03-13 11:59:58,408 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7267 secs
2025-03-13 11:59:58,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6860 secs
2025-03-13 11:59:58,409 [INFO]: {
2025-03-13 11:59:58,409 [INFO]: 	index_key: HNSW15
2025-03-13 11:59:58,409 [INFO]: 	index_param: efSearch=322
2025-03-13 11:59:58,409 [INFO]: 	index_path: knn.index
2025-03-13 11:59:58,409 [INFO]: 	size in bytes: 451723930
2025-03-13 11:59:58,409 [INFO]: 	avg_search_speed_ms: 10.074766774822217
2025-03-13 11:59:58,409 [INFO]: 	99p_search_speed_ms: 13.71568273752928
2025-03-13 11:59:58,409 [INFO]: 	reconstruction error %: 0.0
2025-03-13 11:59:58,409 [INFO]: 	nb vectors: 2296
2025-03-13 11:59:58,409 [INFO]: 	vectors dimension: 49152
2025-03-13 11:59:58,409 [INFO]: 	compression ratio: 0.9993093967813483
2025-03-13 11:59:58,409 [INFO]: }
2025-03-13 11:59:58,409 [INFO]: 	>>> Finished "Creating the index" in 42.6895 secs
2025-03-13 11:59:58,409 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7175 secs
2025-03-13 11:59:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 11:59:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 8889 [episode count 17/20]
[retrieval_preprocessing] for episode 58557 [episode count 18/20], we have num_retrieval=np.int64(2273) num_query=np.int64(123)
2025-03-13 11:59:59,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 11:59:59,878 [INFO]: Launching the whole pipeline 03/13/2025, 11:59:59
2025-03-13 11:59:59,878 [INFO]: Reading total number of vectors and dimension 03/13/2025, 11:59:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-13 11:59:59,900 [INFO]: There are 2273 embeddings of dim 49152
2025-03-13 11:59:59,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-13 11:59:59,900 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 11:59:59
2025-03-13 11:59:59,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 11:59:59,900 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 11:59:59,900 [INFO]: 		Total: 16.7 minutes
2025-03-13 11:59:59,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 11:59:59,900 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 11:59:59
2025-03-13 11:59:59,901 [INFO]: 469.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 11:59:59,901 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 11:59:59,901 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 11:59:59
2025-03-13 11:59:59,901 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 11:59:59,901 [INFO]: 	Creating the index 03/13/2025, 11:59:59
2025-03-13 11:59:59,901 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 11:59:59
2025-03-13 11:59:59,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 11:59:59,902 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 11:59:59
2025-03-13 11:59:59,902 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 11:59:59,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.82it/s] 78%|███████▊  | 7/9 [00:00<00:00, 35.13it/s]100%|██████████| 9/9 [00:01<00:00,  5.59it/s]
2025-03-13 12:00:01,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:01
2025-03-13 12:00:23,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.0617 secs
2025-03-13 12:00:23,579 [INFO]: The best hyperparameters are: efSearch=278
2025-03-13 12:00:23,579 [INFO]: 	Compute fast metrics 03/13/2025, 12:00:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-13 12:00:36,579 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9995 secs
2025-03-13 12:00:36,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.6782 secs
2025-03-13 12:00:36,580 [INFO]: {
2025-03-13 12:00:36,580 [INFO]: 	index_key: HNSW15
2025-03-13 12:00:36,580 [INFO]: 	index_param: efSearch=278
2025-03-13 12:00:36,580 [INFO]: 	index_path: knn.index
2025-03-13 12:00:36,580 [INFO]: 	size in bytes: 447198790
2025-03-13 12:00:36,580 [INFO]: 	avg_search_speed_ms: 9.31148512095553
2025-03-13 12:00:36,580 [INFO]: 	99p_search_speed_ms: 13.069325652904809
2025-03-13 12:00:36,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:00:36,580 [INFO]: 	nb vectors: 2273
2025-03-13 12:00:36,580 [INFO]: 	vectors dimension: 49152
2025-03-13 12:00:36,580 [INFO]: 	compression ratio: 0.9993094659312473
2025-03-13 12:00:36,580 [INFO]: }
2025-03-13 12:00:36,580 [INFO]: 	>>> Finished "Creating the index" in 36.6795 secs
2025-03-13 12:00:36,580 [INFO]: >>> Finished "Launching the whole pipeline" in 36.7024 secs
2025-03-13 12:00:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:00:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 58557 [episode count 18/20]
[retrieval_preprocessing] for episode 86720 [episode count 19/20], we have num_retrieval=np.int64(2294) num_query=np.int64(102)
2025-03-13 12:00:39,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:00:40,156 [INFO]: Launching the whole pipeline 03/13/2025, 12:00:40
2025-03-13 12:00:40,157 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:00:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.19it/s]
2025-03-13 12:00:40,183 [INFO]: There are 2294 embeddings of dim 49152
2025-03-13 12:00:40,184 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 12:00:40,184 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:00:40
2025-03-13 12:00:40,184 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:00:40,184 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:00:40,184 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:00:40,184 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:00:40,184 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:00:40
2025-03-13 12:00:40,184 [INFO]: 473.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:00:40,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:00:40,184 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:00:40
2025-03-13 12:00:40,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:00:40,184 [INFO]: 	Creating the index 03/13/2025, 12:00:40
2025-03-13 12:00:40,184 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:00:40
2025-03-13 12:00:40,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:00:40,186 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:00:40
2025-03-13 12:00:40,186 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:00:40,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.06it/s] 50%|█████     | 5/10 [00:00<00:00, 21.74it/s] 90%|█████████ | 9/10 [00:00<00:00, 26.67it/s]100%|██████████| 10/10 [00:02<00:00,  4.23it/s]
2025-03-13 12:00:42,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:00:42
2025-03-13 12:01:16,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0009 secs
2025-03-13 12:01:16,555 [INFO]: The best hyperparameters are: efSearch=311
2025-03-13 12:01:16,555 [INFO]: 	Compute fast metrics 03/13/2025, 12:01:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.42it/s]
2025-03-13 12:01:30,583 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0279 secs
2025-03-13 12:01:30,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3986 secs
2025-03-13 12:01:30,585 [INFO]: {
2025-03-13 12:01:30,585 [INFO]: 	index_key: HNSW15
2025-03-13 12:01:30,585 [INFO]: 	index_param: efSearch=311
2025-03-13 12:01:30,585 [INFO]: 	index_path: knn.index
2025-03-13 12:01:30,585 [INFO]: 	size in bytes: 451330450
2025-03-13 12:01:30,585 [INFO]: 	avg_search_speed_ms: 10.36465138949724
2025-03-13 12:01:30,585 [INFO]: 	99p_search_speed_ms: 25.04482035525144
2025-03-13 12:01:30,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:01:30,585 [INFO]: 	nb vectors: 2294
2025-03-13 12:01:30,585 [INFO]: 	vectors dimension: 49152
2025-03-13 12:01:30,585 [INFO]: 	compression ratio: 0.9993093796352539
2025-03-13 12:01:30,585 [INFO]: }
2025-03-13 12:01:30,585 [INFO]: 	>>> Finished "Creating the index" in 50.4009 secs
2025-03-13 12:01:30,585 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4287 secs
2025-03-13 12:01:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:01:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 86720 [episode count 19/20]
2025-03-13 12:01:31: [retrieval_preprocessing] finished for 3895077471_press_button_on_coffee_maker [chosen_id count 3/260]
2025-03-13 12:01:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_blue_cup_in_orange_cup [chosen_id count 4/260]
2025-03-13 12:01:32: [retrieval_preprocessing] we have num_total=2677 embedding_dim=49152
[retrieval_preprocessing] for episode 38936 [episode count 0/20], we have num_retrieval=np.int64(2554) num_query=np.int64(123)
2025-03-13 12:01:32,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:01:33,209 [INFO]: Launching the whole pipeline 03/13/2025, 12:01:33
2025-03-13 12:01:33,209 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:01:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1834.78it/s]
2025-03-13 12:01:33,242 [INFO]: There are 2554 embeddings of dim 49152
2025-03-13 12:01:33,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-13 12:01:33,242 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:01:33
2025-03-13 12:01:33,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:01:33,242 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:01:33,242 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:01:33,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:01:33,242 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:01:33
2025-03-13 12:01:33,242 [INFO]: 527.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:01:33,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:01:33,242 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:01:33
2025-03-13 12:01:33,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:01:33,242 [INFO]: 	Creating the index 03/13/2025, 12:01:33
2025-03-13 12:01:33,242 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:01:33
2025-03-13 12:01:33,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:01:33,243 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:01:33
2025-03-13 12:01:33,244 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:01:33,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.49it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.42it/s]100%|██████████| 11/11 [00:02<00:00,  4.60it/s]100%|██████████| 11/11 [00:02<00:00,  5.39it/s]
2025-03-13 12:01:35,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:01:35
2025-03-13 12:02:09,110 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8233 secs
2025-03-13 12:02:09,110 [INFO]: The best hyperparameters are: efSearch=257
2025-03-13 12:02:09,110 [INFO]: 	Compute fast metrics 03/13/2025, 12:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-13 12:02:26,178 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0676 secs
2025-03-13 12:02:26,181 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9371 secs
2025-03-13 12:02:26,181 [INFO]: {
2025-03-13 12:02:26,181 [INFO]: 	index_key: HNSW15
2025-03-13 12:02:26,181 [INFO]: 	index_param: efSearch=257
2025-03-13 12:02:26,181 [INFO]: 	index_path: knn.index
2025-03-13 12:02:26,181 [INFO]: 	size in bytes: 502483750
2025-03-13 12:02:26,181 [INFO]: 	avg_search_speed_ms: 12.709769116196275
2025-03-13 12:02:26,181 [INFO]: 	99p_search_speed_ms: 19.967520288191732
2025-03-13 12:02:26,181 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:02:26,181 [INFO]: 	nb vectors: 2554
2025-03-13 12:02:26,181 [INFO]: 	vectors dimension: 49152
2025-03-13 12:02:26,181 [INFO]: 	compression ratio: 0.9993095935938227
2025-03-13 12:02:26,181 [INFO]: }
2025-03-13 12:02:26,181 [INFO]: 	>>> Finished "Creating the index" in 52.9390 secs
2025-03-13 12:02:26,181 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9726 secs
2025-03-13 12:02:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:02:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 38936 [episode count 0/20]
[retrieval_preprocessing] for episode 83484 [episode count 1/20], we have num_retrieval=np.int64(2556) num_query=np.int64(121)
2025-03-13 12:02:28,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:02:28,947 [INFO]: Launching the whole pipeline 03/13/2025, 12:02:28
2025-03-13 12:02:28,948 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:02:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1691.25it/s]
2025-03-13 12:02:28,976 [INFO]: There are 2556 embeddings of dim 49152
2025-03-13 12:02:28,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:02:28,976 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:02:28,976 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:02:28,976 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:02:28,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:02:28,976 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,976 [INFO]: 527.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:02:28,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:02:28,977 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:02:28
2025-03-13 12:02:28,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:02:28,977 [INFO]: 	Creating the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,977 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:02:28
2025-03-13 12:02:28,978 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:02:28,978 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:02:28
2025-03-13 12:02:28,978 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:02:28,978 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.52it/s] 45%|████▌     | 5/11 [00:00<00:00, 26.63it/s] 82%|████████▏ | 9/11 [00:00<00:00, 31.95it/s]100%|██████████| 11/11 [00:02<00:00,  4.35it/s]
2025-03-13 12:02:31,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:02:31
2025-03-13 12:03:02,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2015 secs
2025-03-13 12:03:02,709 [INFO]: The best hyperparameters are: efSearch=137
2025-03-13 12:03:02,709 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-13 12:03:16,942 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2325 secs
2025-03-13 12:03:16,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9655 secs
2025-03-13 12:03:16,944 [INFO]: {
2025-03-13 12:03:16,944 [INFO]: 	index_key: HNSW15
2025-03-13 12:03:16,944 [INFO]: 	index_param: efSearch=137
2025-03-13 12:03:16,944 [INFO]: 	index_path: knn.index
2025-03-13 12:03:16,944 [INFO]: 	size in bytes: 502877230
2025-03-13 12:03:16,944 [INFO]: 	avg_search_speed_ms: 7.020141070171029
2025-03-13 12:03:16,944 [INFO]: 	99p_search_speed_ms: 11.668811358977107
2025-03-13 12:03:16,944 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:03:16,944 [INFO]: 	nb vectors: 2556
2025-03-13 12:03:16,944 [INFO]: 	vectors dimension: 49152
2025-03-13 12:03:16,944 [INFO]: 	compression ratio: 0.9993096088283814
2025-03-13 12:03:16,944 [INFO]: }
2025-03-13 12:03:16,944 [INFO]: 	>>> Finished "Creating the index" in 47.9673 secs
2025-03-13 12:03:16,944 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9964 secs
2025-03-13 12:03:17: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:03:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 83484 [episode count 1/20]
[retrieval_preprocessing] for episode 11299 [episode count 2/20], we have num_retrieval=np.int64(2527) num_query=np.int64(150)
2025-03-13 12:03:18,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:03:18,450 [INFO]: Launching the whole pipeline 03/13/2025, 12:03:18
2025-03-13 12:03:18,450 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:03:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.90it/s]
2025-03-13 12:03:18,486 [INFO]: There are 2527 embeddings of dim 49152
2025-03-13 12:03:18,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-13 12:03:18,487 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:03:18
2025-03-13 12:03:18,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:03:18,487 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:03:18,488 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:03:18,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 12:03:18,488 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:03:18
2025-03-13 12:03:18,488 [INFO]: 521.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:03:18,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:03:18,489 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:03:18
2025-03-13 12:03:18,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:03:18,489 [INFO]: 	Creating the index 03/13/2025, 12:03:18
2025-03-13 12:03:18,489 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:03:18
2025-03-13 12:03:18,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-13 12:03:18,491 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:03:18
2025-03-13 12:03:18,491 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:03:18,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.68it/s] 50%|█████     | 5/10 [00:00<00:00, 22.97it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]100%|██████████| 10/10 [00:02<00:00,  4.76it/s]
2025-03-13 12:03:20,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:03:20
2025-03-13 12:03:46,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1985 secs
2025-03-13 12:03:46,794 [INFO]: The best hyperparameters are: efSearch=260
2025-03-13 12:03:46,794 [INFO]: 	Compute fast metrics 03/13/2025, 12:03:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.14it/s]
2025-03-13 12:04:05,215 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4207 secs
2025-03-13 12:04:05,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7258 secs
2025-03-13 12:04:05,217 [INFO]: {
2025-03-13 12:04:05,217 [INFO]: 	index_key: HNSW15
2025-03-13 12:04:05,217 [INFO]: 	index_param: efSearch=260
2025-03-13 12:04:05,217 [INFO]: 	index_path: knn.index
2025-03-13 12:04:05,217 [INFO]: 	size in bytes: 497171530
2025-03-13 12:04:05,217 [INFO]: 	avg_search_speed_ms: 12.53233079064432
2025-03-13 12:04:05,217 [INFO]: 	99p_search_speed_ms: 20.421715928241564
2025-03-13 12:04:05,217 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:04:05,217 [INFO]: 	nb vectors: 2527
2025-03-13 12:04:05,217 [INFO]: 	vectors dimension: 49152
2025-03-13 12:04:05,217 [INFO]: 	compression ratio: 0.999309867964483
2025-03-13 12:04:05,217 [INFO]: }
2025-03-13 12:04:05,217 [INFO]: 	>>> Finished "Creating the index" in 46.7283 secs
2025-03-13 12:04:05,217 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7678 secs
2025-03-13 12:04:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:04:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 11299 [episode count 2/20]
[retrieval_preprocessing] for episode 13879 [episode count 3/20], we have num_retrieval=np.int64(2568) num_query=np.int64(109)
2025-03-13 12:04:07,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:04:07,807 [INFO]: Launching the whole pipeline 03/13/2025, 12:04:07
2025-03-13 12:04:07,807 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:04:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2335.36it/s]
2025-03-13 12:04:07,830 [INFO]: There are 2568 embeddings of dim 49152
2025-03-13 12:04:07,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-13 12:04:07,830 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:04:07
2025-03-13 12:04:07,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:04:07,830 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:04:07,830 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:04:07,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:04:07,830 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:04:07
2025-03-13 12:04:07,831 [INFO]: 530.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:04:07,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:04:07,831 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:04:07
2025-03-13 12:04:07,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:04:07,831 [INFO]: 	Creating the index 03/13/2025, 12:04:07
2025-03-13 12:04:07,831 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:04:07
2025-03-13 12:04:07,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:04:07,832 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:04:07
2025-03-13 12:04:07,832 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:04:07,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.37it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.69it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]100%|██████████| 11/11 [00:02<00:00,  4.95it/s]
2025-03-13 12:04:10,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:04:10
2025-03-13 12:04:43,493 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4376 secs
2025-03-13 12:04:43,494 [INFO]: The best hyperparameters are: efSearch=185
2025-03-13 12:04:43,494 [INFO]: 	Compute fast metrics 03/13/2025, 12:04:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-13 12:05:02,735 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2407 secs
2025-03-13 12:05:02,738 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9060 secs
2025-03-13 12:05:02,738 [INFO]: {
2025-03-13 12:05:02,738 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:02,738 [INFO]: 	index_param: efSearch=185
2025-03-13 12:05:02,738 [INFO]: 	index_path: knn.index
2025-03-13 12:05:02,738 [INFO]: 	size in bytes: 505238110
2025-03-13 12:05:02,738 [INFO]: 	avg_search_speed_ms: 10.827546107967775
2025-03-13 12:05:02,738 [INFO]: 	99p_search_speed_ms: 16.523630884476006
2025-03-13 12:05:02,738 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:02,738 [INFO]: 	nb vectors: 2568
2025-03-13 12:05:02,738 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:02,738 [INFO]: 	compression ratio: 0.9993096997374169
2025-03-13 12:05:02,738 [INFO]: }
2025-03-13 12:05:02,738 [INFO]: 	>>> Finished "Creating the index" in 54.9075 secs
2025-03-13 12:05:02,738 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9312 secs
2025-03-13 12:05:03: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 13879 [episode count 3/20]
[retrieval_preprocessing] for episode 93755 [episode count 4/20], we have num_retrieval=np.int64(2562) num_query=np.int64(115)
2025-03-13 12:05:04,336 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:04,770 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:04
2025-03-13 12:05:04,770 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.49it/s]
2025-03-13 12:05:04,798 [INFO]: There are 2562 embeddings of dim 49152
2025-03-13 12:05:04,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 12:05:04,798 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:04
2025-03-13 12:05:04,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:04,798 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:05:04,798 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:04,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:04,798 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:04
2025-03-13 12:05:04,798 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:04,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:05:04,799 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:04
2025-03-13 12:05:04,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:04,799 [INFO]: 	Creating the index 03/13/2025, 12:05:04
2025-03-13 12:05:04,799 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:04
2025-03-13 12:05:04,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:05:04,800 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:04
2025-03-13 12:05:04,800 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:05:04,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.00it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.52it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.82it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.15it/s] 55%|█████▍    | 6/11 [00:05<00:08,  1.63s/it] 64%|██████▎   | 7/11 [00:05<00:04,  1.16s/it] 82%|████████▏ | 9/11 [00:05<00:01,  1.55it/s]100%|██████████| 11/11 [00:07<00:00,  1.24it/s]100%|██████████| 11/11 [00:07<00:00,  1.41it/s]
2025-03-13 12:05:12,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:05:12
2025-03-13 12:05:37,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3078 secs
2025-03-13 12:05:37,896 [INFO]: The best hyperparameters are: efSearch=288
2025-03-13 12:05:37,896 [INFO]: 	Compute fast metrics 03/13/2025, 12:05:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-13 12:05:54,485 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5884 secs
2025-03-13 12:05:54,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6900 secs
2025-03-13 12:05:54,491 [INFO]: {
2025-03-13 12:05:54,491 [INFO]: 	index_key: HNSW15
2025-03-13 12:05:54,491 [INFO]: 	index_param: efSearch=288
2025-03-13 12:05:54,491 [INFO]: 	index_path: knn.index
2025-03-13 12:05:54,491 [INFO]: 	size in bytes: 504057670
2025-03-13 12:05:54,491 [INFO]: 	avg_search_speed_ms: 10.386505884216056
2025-03-13 12:05:54,491 [INFO]: 	99p_search_speed_ms: 14.03904841747135
2025-03-13 12:05:54,491 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:05:54,491 [INFO]: 	nb vectors: 2562
2025-03-13 12:05:54,491 [INFO]: 	vectors dimension: 49152
2025-03-13 12:05:54,491 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-13 12:05:54,491 [INFO]: }
2025-03-13 12:05:54,491 [INFO]: 	>>> Finished "Creating the index" in 49.6923 secs
2025-03-13 12:05:54,491 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7207 secs
2025-03-13 12:05:55: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:05:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 93755 [episode count 4/20]
[retrieval_preprocessing] for episode 43580 [episode count 5/20], we have num_retrieval=np.int64(2540) num_query=np.int64(137)
2025-03-13 12:05:57,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:05:57,859 [INFO]: Launching the whole pipeline 03/13/2025, 12:05:57
2025-03-13 12:05:57,859 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:05:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.65it/s]
2025-03-13 12:05:57,888 [INFO]: There are 2540 embeddings of dim 49152
2025-03-13 12:05:57,888 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 12:05:57,888 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:05:57
2025-03-13 12:05:57,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:05:57,888 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:05:57,888 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:05:57,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:05:57,888 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:05:57
2025-03-13 12:05:57,889 [INFO]: 524.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:05:57,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:05:57,889 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:05:57
2025-03-13 12:05:57,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:05:57,889 [INFO]: 	Creating the index 03/13/2025, 12:05:57
2025-03-13 12:05:57,889 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:05:57
2025-03-13 12:05:57,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:05:57,890 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:05:57
2025-03-13 12:05:57,890 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:05:57,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.50it/s] 20%|██        | 2/10 [00:00<00:01,  6.94it/s] 30%|███       | 3/10 [00:00<00:00,  7.56it/s] 40%|████      | 4/10 [00:00<00:00,  7.90it/s] 50%|█████     | 5/10 [00:00<00:00,  8.20it/s] 60%|██████    | 6/10 [00:00<00:00,  8.35it/s] 70%|███████   | 7/10 [00:00<00:00,  8.45it/s] 80%|████████  | 8/10 [00:00<00:00,  8.47it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.41it/s]100%|██████████| 10/10 [00:03<00:00,  1.31it/s]100%|██████████| 10/10 [00:03<00:00,  3.00it/s]
2025-03-13 12:06:01,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:01
2025-03-13 12:06:27,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7927 secs
2025-03-13 12:06:27,029 [INFO]: The best hyperparameters are: efSearch=212
2025-03-13 12:06:27,030 [INFO]: 	Compute fast metrics 03/13/2025, 12:06:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 50%|█████     | 2/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-13 12:06:47,529 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4989 secs
2025-03-13 12:06:47,541 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6510 secs
2025-03-13 12:06:47,541 [INFO]: {
2025-03-13 12:06:47,542 [INFO]: 	index_key: HNSW15
2025-03-13 12:06:47,542 [INFO]: 	index_param: efSearch=212
2025-03-13 12:06:47,542 [INFO]: 	index_path: knn.index
2025-03-13 12:06:47,542 [INFO]: 	size in bytes: 499729270
2025-03-13 12:06:47,542 [INFO]: 	avg_search_speed_ms: 9.559447229590559
2025-03-13 12:06:47,542 [INFO]: 	99p_search_speed_ms: 14.466840878594653
2025-03-13 12:06:47,542 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:06:47,542 [INFO]: 	nb vectors: 2540
2025-03-13 12:06:47,542 [INFO]: 	vectors dimension: 49152
2025-03-13 12:06:47,542 [INFO]: 	compression ratio: 0.9993097262443723
2025-03-13 12:06:47,542 [INFO]: }
2025-03-13 12:06:47,542 [INFO]: 	>>> Finished "Creating the index" in 49.6529 secs
2025-03-13 12:06:47,542 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6829 secs
2025-03-13 12:06:48: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:06:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 43580 [episode count 5/20]
[retrieval_preprocessing] for episode 91708 [episode count 6/20], we have num_retrieval=np.int64(2534) num_query=np.int64(143)
2025-03-13 12:06:49,425 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:06:49,866 [INFO]: Launching the whole pipeline 03/13/2025, 12:06:49
2025-03-13 12:06:49,866 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:06:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.94it/s]
2025-03-13 12:06:49,891 [INFO]: There are 2534 embeddings of dim 49152
2025-03-13 12:06:49,891 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 12:06:49,892 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:06:49
2025-03-13 12:06:49,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:06:49,892 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:06:49,892 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:06:49,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:06:49,892 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:06:49
2025-03-13 12:06:49,892 [INFO]: 523.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:06:49,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:06:49,892 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:06:49
2025-03-13 12:06:49,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:06:49,892 [INFO]: 	Creating the index 03/13/2025, 12:06:49
2025-03-13 12:06:49,892 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:06:49
2025-03-13 12:06:49,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:06:49,893 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:06:49
2025-03-13 12:06:49,893 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:06:49,893 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.19it/s] 20%|██        | 2/10 [00:00<00:01,  7.17it/s] 40%|████      | 4/10 [00:00<00:00,  9.20it/s] 60%|██████    | 6/10 [00:00<00:00, 10.04it/s] 80%|████████  | 8/10 [00:00<00:00, 10.73it/s]100%|██████████| 10/10 [00:02<00:00,  2.32it/s]100%|██████████| 10/10 [00:02<00:00,  3.50it/s]
2025-03-13 12:06:52,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:06:52
2025-03-13 12:07:18,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2796 secs
2025-03-13 12:07:18,040 [INFO]: The best hyperparameters are: efSearch=233
2025-03-13 12:07:18,040 [INFO]: 	Compute fast metrics 03/13/2025, 12:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s]
2025-03-13 12:07:34,685 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6443 secs
2025-03-13 12:07:34,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7942 secs
2025-03-13 12:07:34,687 [INFO]: {
2025-03-13 12:07:34,687 [INFO]: 	index_key: HNSW15
2025-03-13 12:07:34,687 [INFO]: 	index_param: efSearch=233
2025-03-13 12:07:34,687 [INFO]: 	index_path: knn.index
2025-03-13 12:07:34,687 [INFO]: 	size in bytes: 498548830
2025-03-13 12:07:34,687 [INFO]: 	avg_search_speed_ms: 8.972918241045686
2025-03-13 12:07:34,687 [INFO]: 	99p_search_speed_ms: 12.117068965453655
2025-03-13 12:07:34,687 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:07:34,687 [INFO]: 	nb vectors: 2534
2025-03-13 12:07:34,688 [INFO]: 	vectors dimension: 49152
2025-03-13 12:07:34,688 [INFO]: 	compression ratio: 0.9993096804579804
2025-03-13 12:07:34,688 [INFO]: }
2025-03-13 12:07:34,688 [INFO]: 	>>> Finished "Creating the index" in 44.7956 secs
2025-03-13 12:07:34,688 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8216 secs
2025-03-13 12:07:35: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:07:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 91708 [episode count 6/20]
[retrieval_preprocessing] for episode 11334 [episode count 7/20], we have num_retrieval=np.int64(2526) num_query=np.int64(151)
2025-03-13 12:07:37,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:07:37,374 [INFO]: Launching the whole pipeline 03/13/2025, 12:07:37
2025-03-13 12:07:37,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:07:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1990.65it/s]
2025-03-13 12:07:37,396 [INFO]: There are 2526 embeddings of dim 49152
2025-03-13 12:07:37,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-13 12:07:37,396 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,396 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:07:37,396 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:07:37,396 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:07:37,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:07:37,396 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,396 [INFO]: 521.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:07:37,396 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:07:37,396 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:07:37
2025-03-13 12:07:37,396 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:07:37,396 [INFO]: 	Creating the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,396 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:07:37
2025-03-13 12:07:37,397 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:07:37,397 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:07:37
2025-03-13 12:07:37,397 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:07:37,397 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.00it/s] 30%|███       | 3/10 [00:00<00:00,  8.65it/s] 40%|████      | 4/10 [00:00<00:00,  8.83it/s] 50%|█████     | 5/10 [00:00<00:00,  8.75it/s] 60%|██████    | 6/10 [00:00<00:00,  8.65it/s] 70%|███████   | 7/10 [00:00<00:00,  8.60it/s] 80%|████████  | 8/10 [00:00<00:00,  8.37it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.20it/s]100%|██████████| 10/10 [00:03<00:00,  1.26it/s]100%|██████████| 10/10 [00:03<00:00,  2.93it/s]
2025-03-13 12:07:40,817 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:07:40
2025-03-13 12:08:06,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6186 secs
2025-03-13 12:08:06,436 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 12:08:06,436 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-13 12:08:22,755 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3184 secs
2025-03-13 12:08:22,757 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3597 secs
2025-03-13 12:08:22,757 [INFO]: {
2025-03-13 12:08:22,757 [INFO]: 	index_key: HNSW15
2025-03-13 12:08:22,757 [INFO]: 	index_param: efSearch=247
2025-03-13 12:08:22,757 [INFO]: 	index_path: knn.index
2025-03-13 12:08:22,757 [INFO]: 	size in bytes: 496974790
2025-03-13 12:08:22,757 [INFO]: 	avg_search_speed_ms: 9.878697782329729
2025-03-13 12:08:22,757 [INFO]: 	99p_search_speed_ms: 15.42365854140371
2025-03-13 12:08:22,757 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:08:22,757 [INFO]: 	nb vectors: 2526
2025-03-13 12:08:22,757 [INFO]: 	vectors dimension: 49152
2025-03-13 12:08:22,757 [INFO]: 	compression ratio: 0.9993098603653517
2025-03-13 12:08:22,757 [INFO]: }
2025-03-13 12:08:22,757 [INFO]: 	>>> Finished "Creating the index" in 45.3611 secs
2025-03-13 12:08:22,757 [INFO]: >>> Finished "Launching the whole pipeline" in 45.3835 secs
2025-03-13 12:08:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:08:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 11334 [episode count 7/20]
[retrieval_preprocessing] for episode 43127 [episode count 8/20], we have num_retrieval=np.int64(2550) num_query=np.int64(127)
2025-03-13 12:08:25,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:08:25,395 [INFO]: Launching the whole pipeline 03/13/2025, 12:08:25
2025-03-13 12:08:25,396 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:08:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-13 12:08:25,416 [INFO]: There are 2550 embeddings of dim 49152
2025-03-13 12:08:25,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0208 secs
2025-03-13 12:08:25,416 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:08:25,417 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:08:25,417 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:08:25,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:08:25,417 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,417 [INFO]: 526.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:08:25,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:08:25,417 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:08:25
2025-03-13 12:08:25,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:08:25,417 [INFO]: 	Creating the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,417 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:08:25
2025-03-13 12:08:25,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:08:25,418 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:08:25
2025-03-13 12:08:25,418 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:08:25,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.79it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.61it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.45it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.71it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.49it/s] 82%|████████▏ | 9/11 [00:00<00:00,  9.22it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.99it/s]100%|██████████| 11/11 [00:02<00:00,  1.75it/s]100%|██████████| 11/11 [00:02<00:00,  3.79it/s]
2025-03-13 12:08:28,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:08:28
2025-03-13 12:08:52,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1869 secs
2025-03-13 12:08:52,511 [INFO]: The best hyperparameters are: efSearch=248
2025-03-13 12:08:52,511 [INFO]: 	Compute fast metrics 03/13/2025, 12:08:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.74it/s] 50%|█████     | 2/4 [00:01<00:01,  1.14it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.15it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.17it/s]
2025-03-13 12:09:12,002 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4912 secs
2025-03-13 12:09:12,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5868 secs
2025-03-13 12:09:12,005 [INFO]: {
2025-03-13 12:09:12,005 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:12,005 [INFO]: 	index_param: efSearch=248
2025-03-13 12:09:12,005 [INFO]: 	index_path: knn.index
2025-03-13 12:09:12,005 [INFO]: 	size in bytes: 501696790
2025-03-13 12:09:12,005 [INFO]: 	avg_search_speed_ms: 9.07930605968699
2025-03-13 12:09:12,005 [INFO]: 	99p_search_speed_ms: 12.792483903467655
2025-03-13 12:09:12,005 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:12,005 [INFO]: 	nb vectors: 2550
2025-03-13 12:09:12,005 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:12,005 [INFO]: 	compression ratio: 0.9993095630530145
2025-03-13 12:09:12,005 [INFO]: }
2025-03-13 12:09:12,005 [INFO]: 	>>> Finished "Creating the index" in 46.5881 secs
2025-03-13 12:09:12,005 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6094 secs
2025-03-13 12:09:12: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 43127 [episode count 8/20]
[retrieval_preprocessing] for episode 87165 [episode count 9/20], we have num_retrieval=np.int64(2531) num_query=np.int64(146)
2025-03-13 12:09:13,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:09:14,317 [INFO]: Launching the whole pipeline 03/13/2025, 12:09:14
2025-03-13 12:09:14,317 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:09:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.01it/s]
2025-03-13 12:09:14,343 [INFO]: There are 2531 embeddings of dim 49152
2025-03-13 12:09:14,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 12:09:14,344 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:09:14
2025-03-13 12:09:14,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:09:14,344 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:09:14,344 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:09:14,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:09:14,344 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:09:14
2025-03-13 12:09:14,344 [INFO]: 522.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:09:14,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:09:14,345 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:09:14
2025-03-13 12:09:14,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:09:14,345 [INFO]: 	Creating the index 03/13/2025, 12:09:14
2025-03-13 12:09:14,345 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:09:14
2025-03-13 12:09:14,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:09:14,348 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:09:14
2025-03-13 12:09:14,348 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:09:14,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.10it/s] 30%|███       | 3/10 [00:00<00:00,  8.77it/s] 50%|█████     | 5/10 [00:00<00:00,  9.41it/s] 60%|██████    | 6/10 [00:00<00:00,  9.46it/s] 70%|███████   | 7/10 [00:00<00:00,  9.53it/s] 80%|████████  | 8/10 [00:00<00:00,  9.65it/s]100%|██████████| 10/10 [00:03<00:00,  1.68it/s]100%|██████████| 10/10 [00:03<00:00,  3.06it/s]
2025-03-13 12:09:17,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:09:17
2025-03-13 12:09:41,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2749 secs
2025-03-13 12:09:41,906 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 12:09:41,906 [INFO]: 	Compute fast metrics 03/13/2025, 12:09:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 12:09:58,190 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2837 secs
2025-03-13 12:09:58,192 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8438 secs
2025-03-13 12:09:58,192 [INFO]: {
2025-03-13 12:09:58,192 [INFO]: 	index_key: HNSW15
2025-03-13 12:09:58,192 [INFO]: 	index_param: efSearch=270
2025-03-13 12:09:58,192 [INFO]: 	index_path: knn.index
2025-03-13 12:09:58,192 [INFO]: 	size in bytes: 497958610
2025-03-13 12:09:58,192 [INFO]: 	avg_search_speed_ms: 9.376819502351056
2025-03-13 12:09:58,192 [INFO]: 	99p_search_speed_ms: 12.02165043912828
2025-03-13 12:09:58,192 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:09:58,192 [INFO]: 	nb vectors: 2531
2025-03-13 12:09:58,192 [INFO]: 	vectors dimension: 49152
2025-03-13 12:09:58,192 [INFO]: 	compression ratio: 0.99930965748338
2025-03-13 12:09:58,192 [INFO]: }
2025-03-13 12:09:58,192 [INFO]: 	>>> Finished "Creating the index" in 43.8475 secs
2025-03-13 12:09:58,192 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8751 secs
2025-03-13 12:09:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:09:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 87165 [episode count 9/20]
[retrieval_preprocessing] for episode 71299 [episode count 10/20], we have num_retrieval=np.int64(2548) num_query=np.int64(129)
2025-03-13 12:10:00,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:00,764 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:00
2025-03-13 12:10:00,764 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1586.35it/s]
2025-03-13 12:10:01,157 [INFO]: There are 2548 embeddings of dim 49152
2025-03-13 12:10:01,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3926 secs
2025-03-13 12:10:01,157 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:01
2025-03-13 12:10:01,157 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:01,157 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:10:01,158 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:01,158 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:10:01,158 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:01
2025-03-13 12:10:01,158 [INFO]: 525.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:01,158 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:10:01,158 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:01
2025-03-13 12:10:01,158 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:01,159 [INFO]: 	Creating the index 03/13/2025, 12:10:01
2025-03-13 12:10:01,159 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:01
2025-03-13 12:10:01,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-13 12:10:01,162 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:01
2025-03-13 12:10:01,162 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:10:01,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.90it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.88it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.27it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.62it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.85it/s]100%|██████████| 11/11 [00:02<00:00,  4.47it/s]
2025-03-13 12:10:03,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:03
2025-03-13 12:10:29,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0115 secs
2025-03-13 12:10:29,639 [INFO]: The best hyperparameters are: efSearch=262
2025-03-13 12:10:29,639 [INFO]: 	Compute fast metrics 03/13/2025, 12:10:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-13 12:10:46,046 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4069 secs
2025-03-13 12:10:46,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8866 secs
2025-03-13 12:10:46,049 [INFO]: {
2025-03-13 12:10:46,049 [INFO]: 	index_key: HNSW15
2025-03-13 12:10:46,049 [INFO]: 	index_param: efSearch=262
2025-03-13 12:10:46,049 [INFO]: 	index_path: knn.index
2025-03-13 12:10:46,049 [INFO]: 	size in bytes: 501303310
2025-03-13 12:10:46,049 [INFO]: 	avg_search_speed_ms: 10.54619130697121
2025-03-13 12:10:46,049 [INFO]: 	99p_search_speed_ms: 15.02209805883467
2025-03-13 12:10:46,049 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:10:46,049 [INFO]: 	nb vectors: 2548
2025-03-13 12:10:46,049 [INFO]: 	vectors dimension: 49152
2025-03-13 12:10:46,049 [INFO]: 	compression ratio: 0.9993095477466526
2025-03-13 12:10:46,049 [INFO]: }
2025-03-13 12:10:46,049 [INFO]: 	>>> Finished "Creating the index" in 44.8904 secs
2025-03-13 12:10:46,049 [INFO]: >>> Finished "Launching the whole pipeline" in 45.2849 secs
2025-03-13 12:10:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:10:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 71299 [episode count 10/20]
[retrieval_preprocessing] for episode 77967 [episode count 11/20], we have num_retrieval=np.int64(2555) num_query=np.int64(122)
2025-03-13 12:10:48,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:10:48,837 [INFO]: Launching the whole pipeline 03/13/2025, 12:10:48
2025-03-13 12:10:48,837 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:10:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1103.76it/s]
2025-03-13 12:10:48,865 [INFO]: There are 2555 embeddings of dim 49152
2025-03-13 12:10:48,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:10:48,866 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:10:48
2025-03-13 12:10:48,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:10:48,866 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:10:48,866 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:10:48,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:10:48,867 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:10:48
2025-03-13 12:10:48,867 [INFO]: 527.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:10:48,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:10:48,867 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:10:48
2025-03-13 12:10:48,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:10:48,868 [INFO]: 	Creating the index 03/13/2025, 12:10:48
2025-03-13 12:10:48,868 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:10:48
2025-03-13 12:10:48,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-13 12:10:48,871 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:10:48
2025-03-13 12:10:48,871 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:10:48,871 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.81it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.70it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.86it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.33it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.60it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.78it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.92it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.11it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.14it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.13it/s]100%|██████████| 11/11 [00:03<00:00,  1.48it/s]100%|██████████| 11/11 [00:03<00:00,  3.37it/s]
2025-03-13 12:10:52,567 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:10:52
2025-03-13 12:11:18,630 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0625 secs
2025-03-13 12:11:18,630 [INFO]: The best hyperparameters are: efSearch=220
2025-03-13 12:11:18,631 [INFO]: 	Compute fast metrics 03/13/2025, 12:11:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-13 12:11:34,948 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3174 secs
2025-03-13 12:11:34,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0794 secs
2025-03-13 12:11:34,951 [INFO]: {
2025-03-13 12:11:34,951 [INFO]: 	index_key: HNSW15
2025-03-13 12:11:34,951 [INFO]: 	index_param: efSearch=220
2025-03-13 12:11:34,951 [INFO]: 	index_path: knn.index
2025-03-13 12:11:34,951 [INFO]: 	size in bytes: 502680490
2025-03-13 12:11:34,951 [INFO]: 	avg_search_speed_ms: 8.949723694391796
2025-03-13 12:11:34,951 [INFO]: 	99p_search_speed_ms: 14.563445169478648
2025-03-13 12:11:34,951 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:11:34,951 [INFO]: 	nb vectors: 2555
2025-03-13 12:11:34,951 [INFO]: 	vectors dimension: 49152
2025-03-13 12:11:34,951 [INFO]: 	compression ratio: 0.9993096012140833
2025-03-13 12:11:34,951 [INFO]: }
2025-03-13 12:11:34,951 [INFO]: 	>>> Finished "Creating the index" in 46.0831 secs
2025-03-13 12:11:34,951 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1136 secs
2025-03-13 12:11:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:11:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 77967 [episode count 11/20]
[retrieval_preprocessing] for episode 31896 [episode count 12/20], we have num_retrieval=np.int64(2539) num_query=np.int64(138)
2025-03-13 12:11:37,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:11:37,868 [INFO]: Launching the whole pipeline 03/13/2025, 12:11:37
2025-03-13 12:11:37,868 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:11:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1086.89it/s]
2025-03-13 12:11:37,893 [INFO]: There are 2539 embeddings of dim 49152
2025-03-13 12:11:37,893 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 12:11:37,893 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:11:37
2025-03-13 12:11:37,893 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:11:37,893 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:11:37,893 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:11:37,893 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:11:37,893 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:11:37
2025-03-13 12:11:37,893 [INFO]: 524.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:11:37,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:11:37,893 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:11:37
2025-03-13 12:11:37,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:11:37,893 [INFO]: 	Creating the index 03/13/2025, 12:11:37
2025-03-13 12:11:37,893 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:11:37
2025-03-13 12:11:37,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:11:37,895 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:11:37
2025-03-13 12:11:37,895 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:11:37,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.92it/s] 30%|███       | 3/10 [00:00<00:00, 10.80it/s] 50%|█████     | 5/10 [00:00<00:00, 12.26it/s] 70%|███████   | 7/10 [00:00<00:00, 12.19it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.28it/s]100%|██████████| 10/10 [00:02<00:00,  4.11it/s]
2025-03-13 12:11:40,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:11:40
2025-03-13 12:12:05,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8548 secs
2025-03-13 12:12:05,190 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 12:12:05,190 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.94it/s]
2025-03-13 12:12:23,632 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4422 secs
2025-03-13 12:12:23,634 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7397 secs
2025-03-13 12:12:23,635 [INFO]: {
2025-03-13 12:12:23,635 [INFO]: 	index_key: HNSW15
2025-03-13 12:12:23,635 [INFO]: 	index_param: efSearch=247
2025-03-13 12:12:23,635 [INFO]: 	index_path: knn.index
2025-03-13 12:12:23,635 [INFO]: 	size in bytes: 499532530
2025-03-13 12:12:23,635 [INFO]: 	avg_search_speed_ms: 10.23205769264512
2025-03-13 12:12:23,635 [INFO]: 	99p_search_speed_ms: 18.34045621566475
2025-03-13 12:12:23,635 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:12:23,635 [INFO]: 	nb vectors: 2539
2025-03-13 12:12:23,635 [INFO]: 	vectors dimension: 49152
2025-03-13 12:12:23,635 [INFO]: 	compression ratio: 0.9993097186283344
2025-03-13 12:12:23,635 [INFO]: }
2025-03-13 12:12:23,635 [INFO]: 	>>> Finished "Creating the index" in 45.7413 secs
2025-03-13 12:12:23,635 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7664 secs
2025-03-13 12:12:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 31896 [episode count 12/20]
[retrieval_preprocessing] for episode 4776 [episode count 13/20], we have num_retrieval=np.int64(2547) num_query=np.int64(130)
2025-03-13 12:12:25,870 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:12:26,240 [INFO]: Launching the whole pipeline 03/13/2025, 12:12:26
2025-03-13 12:12:26,240 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:12:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.60it/s]
2025-03-13 12:12:26,268 [INFO]: There are 2547 embeddings of dim 49152
2025-03-13 12:12:26,268 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:12:26,268 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:12:26
2025-03-13 12:12:26,269 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:12:26,269 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:12:26,269 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:12:26,269 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:12:26,269 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:12:26
2025-03-13 12:12:26,269 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:12:26,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:12:26,270 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:12:26
2025-03-13 12:12:26,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:12:26,270 [INFO]: 	Creating the index 03/13/2025, 12:12:26
2025-03-13 12:12:26,270 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:12:26
2025-03-13 12:12:26,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:12:26,274 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:12:26
2025-03-13 12:12:26,274 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:12:26,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.92it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.08it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.91it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.37it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.66it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.87it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.13it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.28it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.39it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.52it/s]100%|██████████| 11/11 [00:03<00:00,  1.49it/s]100%|██████████| 11/11 [00:03<00:00,  3.43it/s]
2025-03-13 12:12:29,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:12:29
2025-03-13 12:12:55,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1093 secs
2025-03-13 12:12:55,599 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 12:12:55,599 [INFO]: 	Compute fast metrics 03/13/2025, 12:12:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-13 12:13:12,300 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7008 secs
2025-03-13 12:13:12,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5285 secs
2025-03-13 12:13:12,802 [INFO]: {
2025-03-13 12:13:12,803 [INFO]: 	index_key: HNSW15
2025-03-13 12:13:12,803 [INFO]: 	index_param: efSearch=265
2025-03-13 12:13:12,803 [INFO]: 	index_path: knn.index
2025-03-13 12:13:12,803 [INFO]: 	size in bytes: 501106570
2025-03-13 12:13:12,803 [INFO]: 	avg_search_speed_ms: 10.90247689765617
2025-03-13 12:13:12,803 [INFO]: 	99p_search_speed_ms: 14.199691712856295
2025-03-13 12:13:12,803 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:13:12,803 [INFO]: 	nb vectors: 2547
2025-03-13 12:13:12,803 [INFO]: 	vectors dimension: 49152
2025-03-13 12:13:12,803 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-13 12:13:12,803 [INFO]: }
2025-03-13 12:13:12,803 [INFO]: 	>>> Finished "Creating the index" in 46.5329 secs
2025-03-13 12:13:12,803 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5632 secs
2025-03-13 12:13:13: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:13:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 4776 [episode count 13/20]
[retrieval_preprocessing] for episode 23243 [episode count 14/20], we have num_retrieval=np.int64(2538) num_query=np.int64(139)
2025-03-13 12:13:15,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:13:15,519 [INFO]: Launching the whole pipeline 03/13/2025, 12:13:15
2025-03-13 12:13:15,519 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:13:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-13 12:13:15,543 [INFO]: There are 2538 embeddings of dim 49152
2025-03-13 12:13:15,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 12:13:15,543 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:13:15
2025-03-13 12:13:15,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:13:15,544 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:13:15,544 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:13:15,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:13:15,544 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:13:15
2025-03-13 12:13:15,544 [INFO]: 523.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:13:15,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:13:15,544 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:13:15
2025-03-13 12:13:15,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:13:15,544 [INFO]: 	Creating the index 03/13/2025, 12:13:15
2025-03-13 12:13:15,544 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:13:15
2025-03-13 12:13:15,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:13:15,545 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:13:15
2025-03-13 12:13:15,545 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:13:15,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.13it/s] 30%|███       | 3/10 [00:00<00:00, 11.29it/s] 50%|█████     | 5/10 [00:00<00:00, 12.60it/s] 70%|███████   | 7/10 [00:00<00:00, 13.29it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.61it/s]100%|██████████| 10/10 [00:02<00:00,  3.94it/s]
2025-03-13 12:13:18,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:13:18
2025-03-13 12:13:43,617 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5227 secs
2025-03-13 12:13:43,617 [INFO]: The best hyperparameters are: efSearch=294
2025-03-13 12:13:43,617 [INFO]: 	Compute fast metrics 03/13/2025, 12:13:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-13 12:14:00,429 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8112 secs
2025-03-13 12:14:00,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8859 secs
2025-03-13 12:14:00,431 [INFO]: {
2025-03-13 12:14:00,431 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:00,431 [INFO]: 	index_param: efSearch=294
2025-03-13 12:14:00,431 [INFO]: 	index_path: knn.index
2025-03-13 12:14:00,431 [INFO]: 	size in bytes: 499335790
2025-03-13 12:14:00,431 [INFO]: 	avg_search_speed_ms: 10.909270003108935
2025-03-13 12:14:00,431 [INFO]: 	99p_search_speed_ms: 19.257568251341596
2025-03-13 12:14:00,431 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:00,431 [INFO]: 	nb vectors: 2538
2025-03-13 12:14:00,431 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:00,431 [INFO]: 	compression ratio: 0.999309711006295
2025-03-13 12:14:00,431 [INFO]: }
2025-03-13 12:14:00,431 [INFO]: 	>>> Finished "Creating the index" in 44.8873 secs
2025-03-13 12:14:00,431 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9117 secs
2025-03-13 12:14:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 23243 [episode count 14/20]
[retrieval_preprocessing] for episode 9935 [episode count 15/20], we have num_retrieval=np.int64(2561) num_query=np.int64(116)
2025-03-13 12:14:03,117 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:04,061 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:04
2025-03-13 12:14:04,061 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1297.34it/s]
2025-03-13 12:14:04,089 [INFO]: There are 2561 embeddings of dim 49152
2025-03-13 12:14:04,089 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:14:04,090 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:04
2025-03-13 12:14:04,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:04,090 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:14:04,090 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:04,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:14:04,090 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:04
2025-03-13 12:14:04,090 [INFO]: 528.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:04,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:14:04,090 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:04
2025-03-13 12:14:04,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:04,090 [INFO]: 	Creating the index 03/13/2025, 12:14:04
2025-03-13 12:14:04,090 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:04
2025-03-13 12:14:04,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:14:04,091 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:04
2025-03-13 12:14:04,092 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:14:04,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.79it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.14it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.74it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.09it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.38it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.44it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.54it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.61it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.76it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.98it/s]100%|██████████| 11/11 [00:03<00:00,  1.55it/s]100%|██████████| 11/11 [00:03<00:00,  3.46it/s]
2025-03-13 12:14:07,271 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:14:07
2025-03-13 12:14:36,121 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8495 secs
2025-03-13 12:14:36,121 [INFO]: The best hyperparameters are: efSearch=231
2025-03-13 12:14:36,121 [INFO]: 	Compute fast metrics 03/13/2025, 12:14:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-13 12:14:56,752 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6300 secs
2025-03-13 12:14:56,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6618 secs
2025-03-13 12:14:56,753 [INFO]: {
2025-03-13 12:14:56,754 [INFO]: 	index_key: HNSW15
2025-03-13 12:14:56,754 [INFO]: 	index_param: efSearch=231
2025-03-13 12:14:56,754 [INFO]: 	index_path: knn.index
2025-03-13 12:14:56,754 [INFO]: 	size in bytes: 503860930
2025-03-13 12:14:56,754 [INFO]: 	avg_search_speed_ms: 8.544140219545135
2025-03-13 12:14:56,754 [INFO]: 	99p_search_speed_ms: 14.229855691082774
2025-03-13 12:14:56,754 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:14:56,754 [INFO]: 	nb vectors: 2561
2025-03-13 12:14:56,754 [INFO]: 	vectors dimension: 49152
2025-03-13 12:14:56,754 [INFO]: 	compression ratio: 0.9993096468106785
2025-03-13 12:14:56,754 [INFO]: }
2025-03-13 12:14:56,754 [INFO]: 	>>> Finished "Creating the index" in 52.6636 secs
2025-03-13 12:14:56,754 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6925 secs
2025-03-13 12:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:14:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 9935 [episode count 15/20]
[retrieval_preprocessing] for episode 20691 [episode count 16/20], we have num_retrieval=np.int64(2513) num_query=np.int64(164)
2025-03-13 12:14:58,626 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:14:58,980 [INFO]: Launching the whole pipeline 03/13/2025, 12:14:58
2025-03-13 12:14:58,980 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.19it/s]
2025-03-13 12:14:59,009 [INFO]: There are 2513 embeddings of dim 49152
2025-03-13 12:14:59,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-13 12:14:59,009 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:14:59
2025-03-13 12:14:59,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:14:59,009 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:14:59,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:14:59,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:14:59,010 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:14:59
2025-03-13 12:14:59,010 [INFO]: 518.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:14:59,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:14:59,010 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:14:59
2025-03-13 12:14:59,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:14:59,010 [INFO]: 	Creating the index 03/13/2025, 12:14:59
2025-03-13 12:14:59,010 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:14:59
2025-03-13 12:14:59,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:14:59,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:14:59
2025-03-13 12:14:59,012 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:14:59,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.89it/s] 20%|██        | 2/10 [00:00<00:01,  6.19it/s] 30%|███       | 3/10 [00:00<00:00,  7.14it/s] 40%|████      | 4/10 [00:00<00:00,  7.60it/s] 50%|█████     | 5/10 [00:00<00:00,  7.87it/s] 60%|██████    | 6/10 [00:00<00:00,  8.06it/s] 70%|███████   | 7/10 [00:00<00:00,  8.10it/s] 80%|████████  | 8/10 [00:01<00:00,  8.33it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.41it/s]100%|██████████| 10/10 [00:02<00:00,  1.70it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]
2025-03-13 12:15:01,822 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:01
2025-03-13 12:15:27,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5065 secs
2025-03-13 12:15:27,329 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 12:15:27,329 [INFO]: 	Compute fast metrics 03/13/2025, 12:15:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-13 12:15:42,313 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9841 secs
2025-03-13 12:15:42,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.3035 secs
2025-03-13 12:15:42,315 [INFO]: {
2025-03-13 12:15:42,315 [INFO]: 	index_key: HNSW15
2025-03-13 12:15:42,315 [INFO]: 	index_param: efSearch=207
2025-03-13 12:15:42,315 [INFO]: 	index_path: knn.index
2025-03-13 12:15:42,315 [INFO]: 	size in bytes: 494417110
2025-03-13 12:15:42,315 [INFO]: 	avg_search_speed_ms: 8.388202521214012
2025-03-13 12:15:42,315 [INFO]: 	99p_search_speed_ms: 11.916497121565042
2025-03-13 12:15:42,315 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:15:42,315 [INFO]: 	nb vectors: 2513
2025-03-13 12:15:42,315 [INFO]: 	vectors dimension: 49152
2025-03-13 12:15:42,315 [INFO]: 	compression ratio: 0.9993098822975605
2025-03-13 12:15:42,316 [INFO]: }
2025-03-13 12:15:42,316 [INFO]: 	>>> Finished "Creating the index" in 43.3056 secs
2025-03-13 12:15:42,316 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3351 secs
2025-03-13 12:15:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:15:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 20691 [episode count 16/20]
[retrieval_preprocessing] for episode 23777 [episode count 17/20], we have num_retrieval=np.int64(2492) num_query=np.int64(185)
2025-03-13 12:15:44,402 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:15:44,763 [INFO]: Launching the whole pipeline 03/13/2025, 12:15:44
2025-03-13 12:15:44,763 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:15:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.12it/s]
2025-03-13 12:15:44,789 [INFO]: There are 2492 embeddings of dim 49152
2025-03-13 12:15:44,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-13 12:15:44,790 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:15:44
2025-03-13 12:15:44,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:15:44,790 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:15:44,790 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:15:44,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:15:44,790 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:15:44
2025-03-13 12:15:44,790 [INFO]: 514.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:15:44,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:15:44,790 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:15:44
2025-03-13 12:15:44,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:15:44,791 [INFO]: 	Creating the index 03/13/2025, 12:15:44
2025-03-13 12:15:44,791 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:15:44
2025-03-13 12:15:44,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:15:44,792 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:15:44
2025-03-13 12:15:44,792 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:15:44,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.49it/s] 20%|██        | 2/10 [00:00<00:01,  7.13it/s] 30%|███       | 3/10 [00:00<00:00,  7.70it/s] 40%|████      | 4/10 [00:00<00:00,  7.99it/s] 50%|█████     | 5/10 [00:00<00:00,  8.19it/s] 60%|██████    | 6/10 [00:00<00:00,  8.29it/s] 70%|███████   | 7/10 [00:00<00:00,  8.36it/s] 80%|████████  | 8/10 [00:00<00:00,  8.49it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.49it/s]100%|██████████| 10/10 [00:02<00:00,  1.65it/s]100%|██████████| 10/10 [00:02<00:00,  3.56it/s]
2025-03-13 12:15:47,611 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:15:47
2025-03-13 12:16:11,401 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.7897 secs
2025-03-13 12:16:11,402 [INFO]: The best hyperparameters are: efSearch=252
2025-03-13 12:16:11,402 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-13 12:16:26,815 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4134 secs
2025-03-13 12:16:26,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0249 secs
2025-03-13 12:16:26,817 [INFO]: {
2025-03-13 12:16:26,817 [INFO]: 	index_key: HNSW15
2025-03-13 12:16:26,817 [INFO]: 	index_param: efSearch=252
2025-03-13 12:16:26,817 [INFO]: 	index_path: knn.index
2025-03-13 12:16:26,817 [INFO]: 	size in bytes: 490285390
2025-03-13 12:16:26,817 [INFO]: 	avg_search_speed_ms: 9.411743199645505
2025-03-13 12:16:26,817 [INFO]: 	99p_search_speed_ms: 13.086516950279474
2025-03-13 12:16:26,817 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:16:26,817 [INFO]: 	nb vectors: 2492
2025-03-13 12:16:26,817 [INFO]: 	vectors dimension: 49152
2025-03-13 12:16:26,817 [INFO]: 	compression ratio: 0.9993100875390147
2025-03-13 12:16:26,817 [INFO]: }
2025-03-13 12:16:26,817 [INFO]: 	>>> Finished "Creating the index" in 42.0267 secs
2025-03-13 12:16:26,817 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0547 secs
2025-03-13 12:16:27: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:16:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 23777 [episode count 17/20]
[retrieval_preprocessing] for episode 60650 [episode count 18/20], we have num_retrieval=np.int64(2575) num_query=np.int64(102)
2025-03-13 12:16:29,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:16:29,656 [INFO]: Launching the whole pipeline 03/13/2025, 12:16:29
2025-03-13 12:16:29,656 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:16:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1914.33it/s]
2025-03-13 12:16:29,678 [INFO]: There are 2575 embeddings of dim 49152
2025-03-13 12:16:29,678 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-13 12:16:29,678 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:16:29
2025-03-13 12:16:29,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:16:29,679 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:16:29,679 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:16:29,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:16:29,679 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:16:29
2025-03-13 12:16:29,679 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:16:29,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:16:29,679 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:16:29
2025-03-13 12:16:29,679 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:16:29,679 [INFO]: 	Creating the index 03/13/2025, 12:16:29
2025-03-13 12:16:29,679 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:16:29
2025-03-13 12:16:29,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:16:29,680 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:16:29
2025-03-13 12:16:29,680 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:16:29,680 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.39it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.82it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.15it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.70it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.06it/s]100%|██████████| 11/11 [00:02<00:00,  2.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.39it/s]
2025-03-13 12:16:32,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:16:32
2025-03-13 12:16:56,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6396 secs
2025-03-13 12:16:56,829 [INFO]: The best hyperparameters are: efSearch=151
2025-03-13 12:16:56,829 [INFO]: 	Compute fast metrics 03/13/2025, 12:16:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-13 12:17:16,683 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8534 secs
2025-03-13 12:17:16,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0050 secs
2025-03-13 12:17:16,685 [INFO]: {
2025-03-13 12:17:16,685 [INFO]: 	index_key: HNSW15
2025-03-13 12:17:16,685 [INFO]: 	index_param: efSearch=151
2025-03-13 12:17:16,685 [INFO]: 	index_path: knn.index
2025-03-13 12:17:16,685 [INFO]: 	size in bytes: 506615410
2025-03-13 12:17:16,685 [INFO]: 	avg_search_speed_ms: 6.803730318393784
2025-03-13 12:17:16,685 [INFO]: 	99p_search_speed_ms: 11.090857218950978
2025-03-13 12:17:16,685 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:17:16,685 [INFO]: 	nb vectors: 2575
2025-03-13 12:17:16,685 [INFO]: 	vectors dimension: 49152
2025-03-13 12:17:16,685 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-13 12:17:16,685 [INFO]: }
2025-03-13 12:17:16,685 [INFO]: 	>>> Finished "Creating the index" in 47.0063 secs
2025-03-13 12:17:16,685 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0290 secs
2025-03-13 12:17:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:17:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 60650 [episode count 18/20]
[retrieval_preprocessing] for episode 22763 [episode count 19/20], we have num_retrieval=np.int64(2547) num_query=np.int64(130)
2025-03-13 12:17:18,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:17:18,701 [INFO]: Launching the whole pipeline 03/13/2025, 12:17:18
2025-03-13 12:17:18,701 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:17:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1498.50it/s]
2025-03-13 12:17:18,725 [INFO]: There are 2547 embeddings of dim 49152
2025-03-13 12:17:18,725 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-13 12:17:18,725 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:17:18
2025-03-13 12:17:18,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:17:18,725 [INFO]: 		-> Add: 1.4 seconds
2025-03-13 12:17:18,725 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:17:18,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:17:18,725 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:17:18
2025-03-13 12:17:18,726 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:17:18,726 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:17:18,726 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:17:18
2025-03-13 12:17:18,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:17:18,726 [INFO]: 	Creating the index 03/13/2025, 12:17:18
2025-03-13 12:17:18,726 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:17:18
2025-03-13 12:17:18,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:17:18,727 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:17:18
2025-03-13 12:17:18,727 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-13 12:17:18,727 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.60it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.50it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.06it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.03it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.70it/s]100%|██████████| 11/11 [00:02<00:00,  2.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.08it/s]
2025-03-13 12:17:21,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:17:21
2025-03-13 12:17:47,969 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5418 secs
2025-03-13 12:17:47,969 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:17:47,970 [INFO]: 	Compute fast metrics 03/13/2025, 12:17:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-13 12:18:03,417 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4465 secs
2025-03-13 12:18:03,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6920 secs
2025-03-13 12:18:03,419 [INFO]: {
2025-03-13 12:18:03,419 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:03,419 [INFO]: 	index_param: efSearch=222
2025-03-13 12:18:03,419 [INFO]: 	index_path: knn.index
2025-03-13 12:18:03,419 [INFO]: 	size in bytes: 501106570
2025-03-13 12:18:03,419 [INFO]: 	avg_search_speed_ms: 9.283734615650046
2025-03-13 12:18:03,419 [INFO]: 	99p_search_speed_ms: 14.799447776749732
2025-03-13 12:18:03,419 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:03,419 [INFO]: 	nb vectors: 2547
2025-03-13 12:18:03,419 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:03,419 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-13 12:18:03,419 [INFO]: }
2025-03-13 12:18:03,419 [INFO]: 	>>> Finished "Creating the index" in 44.6935 secs
2025-03-13 12:18:03,419 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7181 secs
2025-03-13 12:18:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 22763 [episode count 19/20]
2025-03-13 12:18:04: [retrieval_preprocessing] finished for 3951366978_put_blue_cup_in_orange_cup [chosen_id count 4/260]
2025-03-13 12:18:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_remove_blue_ring_from_wooden_stand [chosen_id count 5/260]
2025-03-13 12:18:06: [retrieval_preprocessing] we have num_total=2461 embedding_dim=49152
[retrieval_preprocessing] for episode 91147 [episode count 0/20], we have num_retrieval=np.int64(2349) num_query=np.int64(112)
2025-03-13 12:18:07,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:07,804 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:07
2025-03-13 12:18:07,804 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.26it/s]
2025-03-13 12:18:08,001 [INFO]: There are 2349 embeddings of dim 49152
2025-03-13 12:18:08,001 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1973 secs
2025-03-13 12:18:08,001 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:08
2025-03-13 12:18:08,001 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:08,001 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:18:08,001 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:08,001 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:08,002 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:08
2025-03-13 12:18:08,002 [INFO]: 484.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:08,002 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:18:08,002 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:08
2025-03-13 12:18:08,002 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:08,002 [INFO]: 	Creating the index 03/13/2025, 12:18:08
2025-03-13 12:18:08,002 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:08
2025-03-13 12:18:08,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:18:08,004 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:08
2025-03-13 12:18:08,004 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:18:08,004 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.83it/s] 20%|██        | 2/10 [00:00<00:01,  6.25it/s] 40%|████      | 4/10 [00:00<00:00,  8.59it/s] 60%|██████    | 6/10 [00:00<00:00, 10.15it/s] 80%|████████  | 8/10 [00:00<00:00, 10.93it/s]100%|██████████| 10/10 [00:02<00:00,  2.40it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]
2025-03-13 12:18:10,806 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:10
2025-03-13 12:18:37,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3426 secs
2025-03-13 12:18:37,150 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 12:18:37,150 [INFO]: 	Compute fast metrics 03/13/2025, 12:18:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 12:18:53,529 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3795 secs
2025-03-13 12:18:53,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5268 secs
2025-03-13 12:18:53,531 [INFO]: {
2025-03-13 12:18:53,531 [INFO]: 	index_key: HNSW15
2025-03-13 12:18:53,531 [INFO]: 	index_param: efSearch=160
2025-03-13 12:18:53,531 [INFO]: 	index_path: knn.index
2025-03-13 12:18:53,531 [INFO]: 	size in bytes: 462151270
2025-03-13 12:18:53,531 [INFO]: 	avg_search_speed_ms: 7.295451556114874
2025-03-13 12:18:53,531 [INFO]: 	99p_search_speed_ms: 11.136248111724854
2025-03-13 12:18:53,531 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:18:53,531 [INFO]: 	nb vectors: 2349
2025-03-13 12:18:53,531 [INFO]: 	vectors dimension: 49152
2025-03-13 12:18:53,531 [INFO]: 	compression ratio: 0.9993095810382605
2025-03-13 12:18:53,531 [INFO]: }
2025-03-13 12:18:53,531 [INFO]: 	>>> Finished "Creating the index" in 45.5291 secs
2025-03-13 12:18:53,531 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7274 secs
2025-03-13 12:18:53: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:18:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 91147 [episode count 0/20]
[retrieval_preprocessing] for episode 64013 [episode count 1/20], we have num_retrieval=np.int64(2363) num_query=np.int64(98)
2025-03-13 12:18:54,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:18:55,361 [INFO]: Launching the whole pipeline 03/13/2025, 12:18:55
2025-03-13 12:18:55,361 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.32it/s]
2025-03-13 12:18:55,385 [INFO]: There are 2363 embeddings of dim 49152
2025-03-13 12:18:55,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:18:55,385 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:18:55,385 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:18:55,385 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:18:55,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:18:55,385 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,385 [INFO]: 487.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:18:55,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:18:55,385 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:18:55
2025-03-13 12:18:55,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:18:55,385 [INFO]: 	Creating the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,385 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:18:55
2025-03-13 12:18:55,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:18:55,386 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:18:55
2025-03-13 12:18:55,386 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:18:55,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.80it/s] 30%|███       | 3/10 [00:00<00:00,  9.53it/s] 50%|█████     | 5/10 [00:00<00:00, 10.79it/s] 70%|███████   | 7/10 [00:00<00:00, 11.35it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.67it/s]100%|██████████| 10/10 [00:02<00:00,  4.01it/s]
2025-03-13 12:18:57,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:18:57
2025-03-13 12:19:27,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9648 secs
2025-03-13 12:19:27,848 [INFO]: The best hyperparameters are: efSearch=244
2025-03-13 12:19:27,849 [INFO]: 	Compute fast metrics 03/13/2025, 12:19:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s]
2025-03-13 12:19:44,650 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8014 secs
2025-03-13 12:19:44,652 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2659 secs
2025-03-13 12:19:44,653 [INFO]: {
2025-03-13 12:19:44,653 [INFO]: 	index_key: HNSW15
2025-03-13 12:19:44,653 [INFO]: 	index_param: efSearch=244
2025-03-13 12:19:44,653 [INFO]: 	index_path: knn.index
2025-03-13 12:19:44,653 [INFO]: 	size in bytes: 464905690
2025-03-13 12:19:44,653 [INFO]: 	avg_search_speed_ms: 10.63552552046492
2025-03-13 12:19:44,653 [INFO]: 	99p_search_speed_ms: 17.25828957045451
2025-03-13 12:19:44,653 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:19:44,653 [INFO]: 	nb vectors: 2363
2025-03-13 12:19:44,653 [INFO]: 	vectors dimension: 49152
2025-03-13 12:19:44,653 [INFO]: 	compression ratio: 0.9993095674952913
2025-03-13 12:19:44,653 [INFO]: }
2025-03-13 12:19:44,653 [INFO]: 	>>> Finished "Creating the index" in 49.2673 secs
2025-03-13 12:19:44,653 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2920 secs
2025-03-13 12:19:45: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:19:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 64013 [episode count 1/20]
[retrieval_preprocessing] for episode 78863 [episode count 2/20], we have num_retrieval=np.int64(2321) num_query=np.int64(140)
2025-03-13 12:19:46,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:19:47,397 [INFO]: Launching the whole pipeline 03/13/2025, 12:19:47
2025-03-13 12:19:47,397 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:19:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1484.18it/s]
2025-03-13 12:19:47,424 [INFO]: There are 2321 embeddings of dim 49152
2025-03-13 12:19:47,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-13 12:19:47,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:19:47
2025-03-13 12:19:47,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:19:47,425 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:19:47,425 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:19:47,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:19:47,425 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:19:47
2025-03-13 12:19:47,425 [INFO]: 479.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:19:47,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:19:47,425 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:19:47
2025-03-13 12:19:47,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:19:47,425 [INFO]: 	Creating the index 03/13/2025, 12:19:47
2025-03-13 12:19:47,425 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:19:47
2025-03-13 12:19:47,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:19:47,426 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:19:47
2025-03-13 12:19:47,426 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:19:47,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:03,  2.46it/s] 20%|██        | 2/10 [00:00<00:01,  4.28it/s] 30%|███       | 3/10 [00:00<00:01,  5.61it/s] 40%|████      | 4/10 [00:00<00:00,  6.53it/s] 50%|█████     | 5/10 [00:00<00:00,  7.23it/s] 60%|██████    | 6/10 [00:00<00:00,  7.71it/s] 70%|███████   | 7/10 [00:01<00:00,  8.02it/s] 80%|████████  | 8/10 [00:01<00:00,  8.33it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.41it/s]100%|██████████| 10/10 [00:02<00:00,  1.70it/s]100%|██████████| 10/10 [00:02<00:00,  3.39it/s]
2025-03-13 12:19:50,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:19:50
2025-03-13 12:20:20,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1442 secs
2025-03-13 12:20:20,110 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 12:20:20,110 [INFO]: 	Compute fast metrics 03/13/2025, 12:20:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-13 12:20:38,582 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4722 secs
2025-03-13 12:20:38,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1582 secs
2025-03-13 12:20:38,585 [INFO]: {
2025-03-13 12:20:38,585 [INFO]: 	index_key: HNSW15
2025-03-13 12:20:38,585 [INFO]: 	index_param: efSearch=230
2025-03-13 12:20:38,585 [INFO]: 	index_path: knn.index
2025-03-13 12:20:38,585 [INFO]: 	size in bytes: 456642550
2025-03-13 12:20:38,585 [INFO]: 	avg_search_speed_ms: 9.877501322939374
2025-03-13 12:20:38,585 [INFO]: 	99p_search_speed_ms: 16.013979795388877
2025-03-13 12:20:38,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:20:38,585 [INFO]: 	nb vectors: 2321
2025-03-13 12:20:38,585 [INFO]: 	vectors dimension: 49152
2025-03-13 12:20:38,585 [INFO]: 	compression ratio: 0.9993093460081632
2025-03-13 12:20:38,585 [INFO]: }
2025-03-13 12:20:38,585 [INFO]: 	>>> Finished "Creating the index" in 51.1599 secs
2025-03-13 12:20:38,585 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1875 secs
2025-03-13 12:20:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:20:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 78863 [episode count 2/20]
[retrieval_preprocessing] for episode 10264 [episode count 3/20], we have num_retrieval=np.int64(2344) num_query=np.int64(117)
2025-03-13 12:20:40,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:20:41,174 [INFO]: Launching the whole pipeline 03/13/2025, 12:20:41
2025-03-13 12:20:41,174 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:20:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.41it/s]
2025-03-13 12:20:41,200 [INFO]: There are 2344 embeddings of dim 49152
2025-03-13 12:20:41,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-13 12:20:41,200 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:20:41
2025-03-13 12:20:41,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:20:41,201 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:20:41,201 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:20:41,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:20:41,201 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:20:41
2025-03-13 12:20:41,201 [INFO]: 483.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:20:41,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:20:41,201 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:20:41
2025-03-13 12:20:41,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:20:41,201 [INFO]: 	Creating the index 03/13/2025, 12:20:41
2025-03-13 12:20:41,201 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:20:41
2025-03-13 12:20:41,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-13 12:20:41,203 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:20:41
2025-03-13 12:20:41,203 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:20:41,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.87it/s] 30%|███       | 3/10 [00:00<00:00,  7.28it/s] 50%|█████     | 5/10 [00:00<00:00,  8.67it/s] 70%|███████   | 7/10 [00:00<00:00,  8.69it/s] 80%|████████  | 8/10 [00:01<00:00,  7.85it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.17it/s]100%|██████████| 10/10 [00:02<00:00,  1.92it/s]100%|██████████| 10/10 [00:02<00:00,  3.61it/s]
2025-03-13 12:20:43,979 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:20:43
2025-03-13 12:21:12,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9596 secs
2025-03-13 12:21:12,939 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:21:12,940 [INFO]: 	Compute fast metrics 03/13/2025, 12:21:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-13 12:21:30,246 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3059 secs
2025-03-13 12:21:30,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7152 secs
2025-03-13 12:21:30,918 [INFO]: {
2025-03-13 12:21:30,918 [INFO]: 	index_key: HNSW15
2025-03-13 12:21:30,918 [INFO]: 	index_param: efSearch=253
2025-03-13 12:21:30,919 [INFO]: 	index_path: knn.index
2025-03-13 12:21:30,919 [INFO]: 	size in bytes: 461167570
2025-03-13 12:21:30,919 [INFO]: 	avg_search_speed_ms: 11.661015810783613
2025-03-13 12:21:30,919 [INFO]: 	99p_search_speed_ms: 21.507272333838024
2025-03-13 12:21:30,919 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:21:30,919 [INFO]: 	nb vectors: 2344
2025-03-13 12:21:30,919 [INFO]: 	vectors dimension: 49152
2025-03-13 12:21:30,919 [INFO]: 	compression ratio: 0.9993095394804106
2025-03-13 12:21:30,919 [INFO]: }
2025-03-13 12:21:30,919 [INFO]: 	>>> Finished "Creating the index" in 49.7181 secs
2025-03-13 12:21:30,919 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7452 secs
2025-03-13 12:21:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:21:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 10264 [episode count 3/20]
[retrieval_preprocessing] for episode 90659 [episode count 4/20], we have num_retrieval=np.int64(2361) num_query=np.int64(100)
2025-03-13 12:21:33,114 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:21:33,502 [INFO]: Launching the whole pipeline 03/13/2025, 12:21:33
2025-03-13 12:21:33,502 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:21:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1341.32it/s]
2025-03-13 12:21:33,527 [INFO]: There are 2361 embeddings of dim 49152
2025-03-13 12:21:33,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-13 12:21:33,527 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:21:33
2025-03-13 12:21:33,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:21:33,527 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:21:33,528 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:21:33,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:21:33,528 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:21:33
2025-03-13 12:21:33,528 [INFO]: 487.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:21:33,528 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:21:33,528 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:21:33
2025-03-13 12:21:33,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:21:33,528 [INFO]: 	Creating the index 03/13/2025, 12:21:33
2025-03-13 12:21:33,528 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:21:33
2025-03-13 12:21:33,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:21:33,529 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:21:33
2025-03-13 12:21:33,529 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:21:33,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.40it/s] 30%|███       | 3/10 [00:00<00:00, 10.10it/s] 50%|█████     | 5/10 [00:00<00:00, 11.37it/s] 70%|███████   | 7/10 [00:00<00:00, 11.87it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.21it/s]100%|██████████| 10/10 [00:02<00:00,  4.43it/s]
2025-03-13 12:21:35,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:21:35
2025-03-13 12:22:07,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0721 secs
2025-03-13 12:22:07,863 [INFO]: The best hyperparameters are: efSearch=222
2025-03-13 12:22:07,863 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
2025-03-13 12:22:23,239 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3764 secs
2025-03-13 12:22:23,241 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7119 secs
2025-03-13 12:22:23,241 [INFO]: {
2025-03-13 12:22:23,241 [INFO]: 	index_key: HNSW15
2025-03-13 12:22:23,241 [INFO]: 	index_param: efSearch=222
2025-03-13 12:22:23,241 [INFO]: 	index_path: knn.index
2025-03-13 12:22:23,241 [INFO]: 	size in bytes: 464512210
2025-03-13 12:22:23,241 [INFO]: 	avg_search_speed_ms: 9.224587206890277
2025-03-13 12:22:23,241 [INFO]: 	99p_search_speed_ms: 13.27152428450063
2025-03-13 12:22:23,241 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:22:23,241 [INFO]: 	nb vectors: 2361
2025-03-13 12:22:23,241 [INFO]: 	vectors dimension: 49152
2025-03-13 12:22:23,241 [INFO]: 	compression ratio: 0.9993095509803714
2025-03-13 12:22:23,241 [INFO]: }
2025-03-13 12:22:23,242 [INFO]: 	>>> Finished "Creating the index" in 49.7137 secs
2025-03-13 12:22:23,242 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7397 secs
2025-03-13 12:22:23: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:22:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 90659 [episode count 4/20]
[retrieval_preprocessing] for episode 16933 [episode count 5/20], we have num_retrieval=np.int64(2275) num_query=np.int64(186)
2025-03-13 12:22:24,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:22:25,200 [INFO]: Launching the whole pipeline 03/13/2025, 12:22:25
2025-03-13 12:22:25,200 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:22:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-13 12:22:25,222 [INFO]: There are 2275 embeddings of dim 49152
2025-03-13 12:22:25,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 12:22:25,222 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:22:25
2025-03-13 12:22:25,222 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:22:25,222 [INFO]: 		-> Add: 1.2 seconds
2025-03-13 12:22:25,222 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:22:25,222 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:22:25,223 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:22:25
2025-03-13 12:22:25,223 [INFO]: 469.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:22:25,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:22:25,223 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:22:25
2025-03-13 12:22:25,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:22:25,223 [INFO]: 	Creating the index 03/13/2025, 12:22:25
2025-03-13 12:22:25,223 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:22:25
2025-03-13 12:22:25,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:22:25,224 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:22:25
2025-03-13 12:22:25,224 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:22:25,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.82it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.35it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.36it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.83it/s]100%|██████████| 9/9 [00:02<00:00,  2.41it/s]100%|██████████| 9/9 [00:02<00:00,  3.48it/s]
2025-03-13 12:22:27,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:22:27
2025-03-13 12:22:56,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0001 secs
2025-03-13 12:22:56,822 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 12:22:56,822 [INFO]: 	Compute fast metrics 03/13/2025, 12:22:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-13 12:23:13,314 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4921 secs
2025-03-13 12:23:13,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0932 secs
2025-03-13 12:23:13,318 [INFO]: {
2025-03-13 12:23:13,318 [INFO]: 	index_key: HNSW15
2025-03-13 12:23:13,318 [INFO]: 	index_param: efSearch=245
2025-03-13 12:23:13,318 [INFO]: 	index_path: knn.index
2025-03-13 12:23:13,318 [INFO]: 	size in bytes: 447592270
2025-03-13 12:23:13,318 [INFO]: 	avg_search_speed_ms: 10.366569664522311
2025-03-13 12:23:13,318 [INFO]: 	99p_search_speed_ms: 15.012131854891784
2025-03-13 12:23:13,318 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:23:13,318 [INFO]: 	nb vectors: 2275
2025-03-13 12:23:13,318 [INFO]: 	vectors dimension: 49152
2025-03-13 12:23:13,318 [INFO]: 	compression ratio: 0.9993094831597517
2025-03-13 12:23:13,318 [INFO]: }
2025-03-13 12:23:13,318 [INFO]: 	>>> Finished "Creating the index" in 48.0947 secs
2025-03-13 12:23:13,318 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1181 secs
2025-03-13 12:23:15: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:23:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 16933 [episode count 5/20]
[retrieval_preprocessing] for episode 18998 [episode count 6/20], we have num_retrieval=np.int64(2335) num_query=np.int64(126)
2025-03-13 12:23:16,870 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:23:17,328 [INFO]: Launching the whole pipeline 03/13/2025, 12:23:17
2025-03-13 12:23:17,328 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:23:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.82it/s]
2025-03-13 12:23:17,358 [INFO]: There are 2335 embeddings of dim 49152
2025-03-13 12:23:17,358 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-13 12:23:17,358 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:23:17
2025-03-13 12:23:17,359 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:23:17,359 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:23:17,359 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:23:17,359 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-13 12:23:17,359 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:23:17
2025-03-13 12:23:17,359 [INFO]: 481.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:23:17,360 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:23:17,360 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:23:17
2025-03-13 12:23:17,360 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:23:17,360 [INFO]: 	Creating the index 03/13/2025, 12:23:17
2025-03-13 12:23:17,360 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:23:17
2025-03-13 12:23:17,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-13 12:23:17,364 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:23:17
2025-03-13 12:23:17,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:23:17,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.05it/s] 30%|███       | 3/10 [00:00<00:00,  9.15it/s] 50%|█████     | 5/10 [00:00<00:00, 10.09it/s] 70%|███████   | 7/10 [00:00<00:00, 10.65it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.87it/s]100%|██████████| 10/10 [00:02<00:00,  3.52it/s]
2025-03-13 12:23:20,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:23:20
2025-03-13 12:23:50,125 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9179 secs
2025-03-13 12:23:50,125 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 12:23:50,125 [INFO]: 	Compute fast metrics 03/13/2025, 12:23:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-13 12:24:07,940 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8140 secs
2025-03-13 12:24:07,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.5774 secs
2025-03-13 12:24:07,941 [INFO]: {
2025-03-13 12:24:07,941 [INFO]: 	index_key: HNSW15
2025-03-13 12:24:07,941 [INFO]: 	index_param: efSearch=246
2025-03-13 12:24:07,941 [INFO]: 	index_path: knn.index
2025-03-13 12:24:07,941 [INFO]: 	size in bytes: 459396910
2025-03-13 12:24:07,941 [INFO]: 	avg_search_speed_ms: 9.899027839459773
2025-03-13 12:24:07,942 [INFO]: 	99p_search_speed_ms: 13.27586236177012
2025-03-13 12:24:07,942 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:24:07,942 [INFO]: 	nb vectors: 2335
2025-03-13 12:24:07,942 [INFO]: 	vectors dimension: 49152
2025-03-13 12:24:07,942 [INFO]: 	compression ratio: 0.9993094642277851
2025-03-13 12:24:07,942 [INFO]: }
2025-03-13 12:24:07,942 [INFO]: 	>>> Finished "Creating the index" in 50.5814 secs
2025-03-13 12:24:07,942 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6137 secs
2025-03-13 12:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:24:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 18998 [episode count 6/20]
[retrieval_preprocessing] for episode 15929 [episode count 7/20], we have num_retrieval=np.int64(2356) num_query=np.int64(105)
2025-03-13 12:24:09,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:24:10,307 [INFO]: Launching the whole pipeline 03/13/2025, 12:24:10
2025-03-13 12:24:10,307 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:24:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1980.31it/s]
2025-03-13 12:24:10,330 [INFO]: There are 2356 embeddings of dim 49152
2025-03-13 12:24:10,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-13 12:24:10,330 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:24:10
2025-03-13 12:24:10,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:24:10,330 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:24:10,330 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:24:10,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:24:10,330 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:24:10
2025-03-13 12:24:10,331 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:24:10,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:24:10,331 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:24:10
2025-03-13 12:24:10,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:24:10,331 [INFO]: 	Creating the index 03/13/2025, 12:24:10
2025-03-13 12:24:10,331 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:24:10
2025-03-13 12:24:10,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:24:10,332 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:24:10
2025-03-13 12:24:10,332 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:24:10,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.39it/s] 30%|███       | 3/10 [00:00<00:00,  9.92it/s] 50%|█████     | 5/10 [00:00<00:00, 10.97it/s] 70%|███████   | 7/10 [00:00<00:00, 11.46it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.50it/s]100%|██████████| 10/10 [00:02<00:00,  3.64it/s]
2025-03-13 12:24:13,082 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:24:13
2025-03-13 12:24:44,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6567 secs
2025-03-13 12:24:44,739 [INFO]: The best hyperparameters are: efSearch=230
2025-03-13 12:24:44,739 [INFO]: 	Compute fast metrics 03/13/2025, 12:24:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s]
2025-03-13 12:25:03,577 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8375 secs
2025-03-13 12:25:03,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2471 secs
2025-03-13 12:25:03,579 [INFO]: {
2025-03-13 12:25:03,579 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:03,579 [INFO]: 	index_param: efSearch=230
2025-03-13 12:25:03,579 [INFO]: 	index_path: knn.index
2025-03-13 12:25:03,579 [INFO]: 	size in bytes: 463528450
2025-03-13 12:25:03,579 [INFO]: 	avg_search_speed_ms: 9.327326794615391
2025-03-13 12:25:03,580 [INFO]: 	99p_search_speed_ms: 14.34356115991249
2025-03-13 12:25:03,580 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:03,580 [INFO]: 	nb vectors: 2356
2025-03-13 12:25:03,580 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:03,580 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-13 12:25:03,580 [INFO]: }
2025-03-13 12:25:03,580 [INFO]: 	>>> Finished "Creating the index" in 53.2489 secs
2025-03-13 12:25:03,580 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2724 secs
2025-03-13 12:25:04: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 15929 [episode count 7/20]
[retrieval_preprocessing] for episode 68681 [episode count 8/20], we have num_retrieval=np.int64(2356) num_query=np.int64(105)
2025-03-13 12:25:05,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:05,968 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:05
2025-03-13 12:25:05,968 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1864.96it/s]
2025-03-13 12:25:05,991 [INFO]: There are 2356 embeddings of dim 49152
2025-03-13 12:25:05,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-13 12:25:05,991 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:05
2025-03-13 12:25:05,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:05,991 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:25:05,991 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:05,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:05,991 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:05
2025-03-13 12:25:05,991 [INFO]: 486.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:05,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:25:05,991 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:05
2025-03-13 12:25:05,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:05,992 [INFO]: 	Creating the index 03/13/2025, 12:25:05
2025-03-13 12:25:05,992 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:05
2025-03-13 12:25:05,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:25:05,993 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:05
2025-03-13 12:25:05,993 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:25:05,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.32it/s] 30%|███       | 3/10 [00:00<00:00,  9.11it/s] 50%|█████     | 5/10 [00:00<00:00,  9.97it/s] 70%|███████   | 7/10 [00:00<00:00, 11.24it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.42it/s]100%|██████████| 10/10 [00:02<00:00,  3.48it/s]
2025-03-13 12:25:08,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:08
2025-03-13 12:25:38,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8501 secs
2025-03-13 12:25:38,723 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 12:25:38,723 [INFO]: 	Compute fast metrics 03/13/2025, 12:25:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-13 12:25:53,288 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5655 secs
2025-03-13 12:25:53,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2979 secs
2025-03-13 12:25:53,291 [INFO]: {
2025-03-13 12:25:53,291 [INFO]: 	index_key: HNSW15
2025-03-13 12:25:53,291 [INFO]: 	index_param: efSearch=229
2025-03-13 12:25:53,291 [INFO]: 	index_path: knn.index
2025-03-13 12:25:53,291 [INFO]: 	size in bytes: 463528450
2025-03-13 12:25:53,291 [INFO]: 	avg_search_speed_ms: 10.884833565923264
2025-03-13 12:25:53,291 [INFO]: 	99p_search_speed_ms: 18.487786944024247
2025-03-13 12:25:53,291 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:25:53,291 [INFO]: 	nb vectors: 2356
2025-03-13 12:25:53,291 [INFO]: 	vectors dimension: 49152
2025-03-13 12:25:53,291 [INFO]: 	compression ratio: 0.9993096389229184
2025-03-13 12:25:53,291 [INFO]: }
2025-03-13 12:25:53,291 [INFO]: 	>>> Finished "Creating the index" in 47.2993 secs
2025-03-13 12:25:53,291 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3225 secs
2025-03-13 12:25:54: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:25:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 68681 [episode count 8/20]
[retrieval_preprocessing] for episode 32339 [episode count 9/20], we have num_retrieval=np.int64(2308) num_query=np.int64(153)
2025-03-13 12:25:55,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:25:55,679 [INFO]: Launching the whole pipeline 03/13/2025, 12:25:55
2025-03-13 12:25:55,679 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:25:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-13 12:25:55,705 [INFO]: There are 2308 embeddings of dim 49152
2025-03-13 12:25:55,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:25:55,705 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:25:55
2025-03-13 12:25:55,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:25:55,705 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:25:55,705 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:25:55,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:25:55,705 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:25:55
2025-03-13 12:25:55,705 [INFO]: 476.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:25:55,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:25:55,705 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:25:55
2025-03-13 12:25:55,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:25:55,706 [INFO]: 	Creating the index 03/13/2025, 12:25:55
2025-03-13 12:25:55,706 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:25:55
2025-03-13 12:25:55,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:25:55,707 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:25:55
2025-03-13 12:25:55,707 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:25:55,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.08it/s] 30%|███       | 3/10 [00:00<00:00,  9.09it/s] 50%|█████     | 5/10 [00:00<00:00, 10.12it/s] 70%|███████   | 7/10 [00:00<00:00, 10.55it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.93it/s]100%|██████████| 10/10 [00:03<00:00,  3.32it/s]
2025-03-13 12:25:58,726 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:25:58
2025-03-13 12:26:28,638 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9110 secs
2025-03-13 12:26:28,638 [INFO]: The best hyperparameters are: efSearch=266
2025-03-13 12:26:28,638 [INFO]: 	Compute fast metrics 03/13/2025, 12:26:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
2025-03-13 12:26:46,358 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7196 secs
2025-03-13 12:26:46,359 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6525 secs
2025-03-13 12:26:46,359 [INFO]: {
2025-03-13 12:26:46,359 [INFO]: 	index_key: HNSW15
2025-03-13 12:26:46,359 [INFO]: 	index_param: efSearch=266
2025-03-13 12:26:46,359 [INFO]: 	index_path: knn.index
2025-03-13 12:26:46,359 [INFO]: 	size in bytes: 454084870
2025-03-13 12:26:46,359 [INFO]: 	avg_search_speed_ms: 10.879644393663492
2025-03-13 12:26:46,359 [INFO]: 	99p_search_speed_ms: 16.957909180782668
2025-03-13 12:26:46,359 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:26:46,359 [INFO]: 	nb vectors: 2308
2025-03-13 12:26:46,359 [INFO]: 	vectors dimension: 49152
2025-03-13 12:26:46,359 [INFO]: 	compression ratio: 0.9993093669912411
2025-03-13 12:26:46,359 [INFO]: }
2025-03-13 12:26:46,359 [INFO]: 	>>> Finished "Creating the index" in 50.6539 secs
2025-03-13 12:26:46,359 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6807 secs
2025-03-13 12:26:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:26:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 32339 [episode count 9/20]
[retrieval_preprocessing] for episode 40684 [episode count 10/20], we have num_retrieval=np.int64(2303) num_query=np.int64(158)
2025-03-13 12:26:48,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:26:48,983 [INFO]: Launching the whole pipeline 03/13/2025, 12:26:48
2025-03-13 12:26:48,983 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:26:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.03it/s]
2025-03-13 12:26:49,008 [INFO]: There are 2303 embeddings of dim 49152
2025-03-13 12:26:49,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:26:49,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:26:49
2025-03-13 12:26:49,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:26:49,009 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:26:49,009 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:26:49,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:26:49,009 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:26:49
2025-03-13 12:26:49,009 [INFO]: 475.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:26:49,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:26:49,010 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:26:49
2025-03-13 12:26:49,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:26:49,010 [INFO]: 	Creating the index 03/13/2025, 12:26:49
2025-03-13 12:26:49,010 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:26:49
2025-03-13 12:26:49,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:26:49,013 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:26:49
2025-03-13 12:26:49,014 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:26:49,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.59it/s] 20%|██        | 2/10 [00:00<00:01,  6.93it/s] 30%|███       | 3/10 [00:00<00:00,  7.51it/s] 40%|████      | 4/10 [00:00<00:00,  7.75it/s] 50%|█████     | 5/10 [00:00<00:00,  7.94it/s] 60%|██████    | 6/10 [00:00<00:00,  8.14it/s] 70%|███████   | 7/10 [00:00<00:00,  8.17it/s] 80%|████████  | 8/10 [00:01<00:00,  8.24it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.42it/s]100%|██████████| 10/10 [00:02<00:00,  1.58it/s]100%|██████████| 10/10 [00:02<00:00,  3.42it/s]
2025-03-13 12:26:51,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:26:51
2025-03-13 12:27:18,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0302 secs
2025-03-13 12:27:18,971 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:27:18,971 [INFO]: 	Compute fast metrics 03/13/2025, 12:27:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-13 12:27:41,089 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1185 secs
2025-03-13 12:27:41,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0778 secs
2025-03-13 12:27:41,091 [INFO]: {
2025-03-13 12:27:41,091 [INFO]: 	index_key: HNSW15
2025-03-13 12:27:41,091 [INFO]: 	index_param: efSearch=253
2025-03-13 12:27:41,091 [INFO]: 	index_path: knn.index
2025-03-13 12:27:41,091 [INFO]: 	size in bytes: 453101110
2025-03-13 12:27:41,091 [INFO]: 	avg_search_speed_ms: 9.53002468557643
2025-03-13 12:27:41,091 [INFO]: 	99p_search_speed_ms: 12.619981952011583
2025-03-13 12:27:41,091 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:27:41,092 [INFO]: 	nb vectors: 2303
2025-03-13 12:27:41,092 [INFO]: 	vectors dimension: 49152
2025-03-13 12:27:41,092 [INFO]: 	compression ratio: 0.9993094565581621
2025-03-13 12:27:41,092 [INFO]: }
2025-03-13 12:27:41,092 [INFO]: 	>>> Finished "Creating the index" in 52.0816 secs
2025-03-13 12:27:41,092 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1088 secs
2025-03-13 12:27:41: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:27:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 40684 [episode count 10/20]
[retrieval_preprocessing] for episode 77064 [episode count 11/20], we have num_retrieval=np.int64(2315) num_query=np.int64(146)
2025-03-13 12:27:43,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:27:43,437 [INFO]: Launching the whole pipeline 03/13/2025, 12:27:43
2025-03-13 12:27:43,437 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:27:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1051.47it/s]
2025-03-13 12:27:43,461 [INFO]: There are 2315 embeddings of dim 49152
2025-03-13 12:27:43,461 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-13 12:27:43,461 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:27:43
2025-03-13 12:27:43,461 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:27:43,462 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:27:43,462 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:27:43,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:27:43,462 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:27:43
2025-03-13 12:27:43,462 [INFO]: 477.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:27:43,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:27:43,462 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:27:43
2025-03-13 12:27:43,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:27:43,462 [INFO]: 	Creating the index 03/13/2025, 12:27:43
2025-03-13 12:27:43,462 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:27:43
2025-03-13 12:27:43,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:27:43,463 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:27:43
2025-03-13 12:27:43,463 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:27:43,463 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.01it/s] 30%|███       | 3/10 [00:00<00:00,  9.14it/s] 50%|█████     | 5/10 [00:00<00:00,  9.92it/s] 70%|███████   | 7/10 [00:00<00:00, 10.20it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.26it/s]100%|██████████| 10/10 [00:02<00:00,  3.92it/s]
2025-03-13 12:27:46,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:27:46
2025-03-13 12:28:12,883 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8679 secs
2025-03-13 12:28:12,883 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 12:28:12,883 [INFO]: 	Compute fast metrics 03/13/2025, 12:28:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-13 12:28:28,557 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6732 secs
2025-03-13 12:28:28,558 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0951 secs
2025-03-13 12:28:28,558 [INFO]: {
2025-03-13 12:28:28,559 [INFO]: 	index_key: HNSW15
2025-03-13 12:28:28,559 [INFO]: 	index_param: efSearch=283
2025-03-13 12:28:28,559 [INFO]: 	index_path: knn.index
2025-03-13 12:28:28,559 [INFO]: 	size in bytes: 455462050
2025-03-13 12:28:28,559 [INFO]: 	avg_search_speed_ms: 11.45929956268882
2025-03-13 12:28:28,559 [INFO]: 	99p_search_speed_ms: 17.505484586581588
2025-03-13 12:28:28,559 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:28:28,559 [INFO]: 	nb vectors: 2315
2025-03-13 12:28:28,559 [INFO]: 	vectors dimension: 49152
2025-03-13 12:28:28,559 [INFO]: 	compression ratio: 0.9993094265482712
2025-03-13 12:28:28,559 [INFO]: }
2025-03-13 12:28:28,559 [INFO]: 	>>> Finished "Creating the index" in 45.0968 secs
2025-03-13 12:28:28,559 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1215 secs
2025-03-13 12:28:29: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:28:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 77064 [episode count 11/20]
[retrieval_preprocessing] for episode 777 [episode count 12/20], we have num_retrieval=np.int64(2368) num_query=np.int64(93)
2025-03-13 12:28:30,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:28:30,917 [INFO]: Launching the whole pipeline 03/13/2025, 12:28:30
2025-03-13 12:28:30,917 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:28:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 975.19it/s]
2025-03-13 12:28:30,943 [INFO]: There are 2368 embeddings of dim 49152
2025-03-13 12:28:30,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-13 12:28:30,944 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:28:30
2025-03-13 12:28:30,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:28:30,944 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:28:30,944 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:28:30,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:28:30,945 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:28:30
2025-03-13 12:28:30,945 [INFO]: 488.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:28:30,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:28:30,945 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:28:30
2025-03-13 12:28:30,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:28:30,945 [INFO]: 	Creating the index 03/13/2025, 12:28:30
2025-03-13 12:28:30,946 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:28:30
2025-03-13 12:28:30,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-13 12:28:30,949 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:28:30
2025-03-13 12:28:30,949 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:28:30,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.11it/s] 20%|██        | 2/10 [00:00<00:01,  6.60it/s] 30%|███       | 3/10 [00:00<00:00,  7.29it/s] 40%|████      | 4/10 [00:00<00:00,  7.64it/s] 50%|█████     | 5/10 [00:00<00:00,  7.87it/s] 60%|██████    | 6/10 [00:00<00:00,  8.27it/s] 70%|███████   | 7/10 [00:00<00:00,  8.52it/s] 80%|████████  | 8/10 [00:01<00:00,  8.70it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.79it/s]100%|██████████| 10/10 [00:02<00:00,  1.80it/s]100%|██████████| 10/10 [00:02<00:00,  3.75it/s]
2025-03-13 12:28:33,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:28:33
2025-03-13 12:29:00,149 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5295 secs
2025-03-13 12:29:00,149 [INFO]: The best hyperparameters are: efSearch=196
2025-03-13 12:29:00,149 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-13 12:29:20,460 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3108 secs
2025-03-13 12:29:20,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6780 secs
2025-03-13 12:29:20,627 [INFO]: {
2025-03-13 12:29:20,627 [INFO]: 	index_key: HNSW15
2025-03-13 12:29:20,627 [INFO]: 	index_param: efSearch=196
2025-03-13 12:29:20,627 [INFO]: 	index_path: knn.index
2025-03-13 12:29:20,627 [INFO]: 	size in bytes: 465889390
2025-03-13 12:29:20,627 [INFO]: 	avg_search_speed_ms: 8.358520881022113
2025-03-13 12:29:20,627 [INFO]: 	99p_search_speed_ms: 12.76130093028768
2025-03-13 12:29:20,628 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:29:20,628 [INFO]: 	nb vectors: 2368
2025-03-13 12:29:20,628 [INFO]: 	vectors dimension: 49152
2025-03-13 12:29:20,628 [INFO]: 	compression ratio: 0.999309608660545
2025-03-13 12:29:20,628 [INFO]: }
2025-03-13 12:29:20,628 [INFO]: 	>>> Finished "Creating the index" in 49.6823 secs
2025-03-13 12:29:20,628 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7105 secs
2025-03-13 12:29:21: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:29:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 777 [episode count 12/20]
[retrieval_preprocessing] for episode 4873 [episode count 13/20], we have num_retrieval=np.int64(2364) num_query=np.int64(97)
2025-03-13 12:29:22,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:29:22,338 [INFO]: Launching the whole pipeline 03/13/2025, 12:29:22
2025-03-13 12:29:22,338 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:29:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.98it/s]
2025-03-13 12:29:22,364 [INFO]: There are 2364 embeddings of dim 49152
2025-03-13 12:29:22,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-13 12:29:22,364 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:29:22
2025-03-13 12:29:22,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:29:22,364 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:29:22,364 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:29:22,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:29:22,364 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:29:22
2025-03-13 12:29:22,364 [INFO]: 487.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:29:22,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:29:22,364 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:29:22
2025-03-13 12:29:22,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:29:22,364 [INFO]: 	Creating the index 03/13/2025, 12:29:22
2025-03-13 12:29:22,364 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:29:22
2025-03-13 12:29:22,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:29:22,366 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:29:22
2025-03-13 12:29:22,366 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:29:22,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.20it/s] 30%|███       | 3/10 [00:00<00:00,  8.30it/s] 40%|████      | 4/10 [00:00<00:00,  8.70it/s] 50%|█████     | 5/10 [00:00<00:00,  8.36it/s] 60%|██████    | 6/10 [00:00<00:00,  6.61it/s] 70%|███████   | 7/10 [00:00<00:00,  7.05it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.52it/s]100%|██████████| 10/10 [00:02<00:00,  1.89it/s]100%|██████████| 10/10 [00:02<00:00,  3.47it/s]
2025-03-13 12:29:25,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:29:25
2025-03-13 12:29:57,935 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6818 secs
2025-03-13 12:29:57,935 [INFO]: The best hyperparameters are: efSearch=224
2025-03-13 12:29:57,935 [INFO]: 	Compute fast metrics 03/13/2025, 12:29:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-13 12:30:14,291 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3557 secs
2025-03-13 12:30:14,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9272 secs
2025-03-13 12:30:14,293 [INFO]: {
2025-03-13 12:30:14,293 [INFO]: 	index_key: HNSW15
2025-03-13 12:30:14,293 [INFO]: 	index_param: efSearch=224
2025-03-13 12:30:14,293 [INFO]: 	index_path: knn.index
2025-03-13 12:30:14,293 [INFO]: 	size in bytes: 465102430
2025-03-13 12:30:14,293 [INFO]: 	avg_search_speed_ms: 11.405102141889634
2025-03-13 12:30:14,293 [INFO]: 	99p_search_speed_ms: 21.173920864239346
2025-03-13 12:30:14,293 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:30:14,293 [INFO]: 	nb vectors: 2364
2025-03-13 12:30:14,293 [INFO]: 	vectors dimension: 49152
2025-03-13 12:30:14,293 [INFO]: 	compression ratio: 0.9993095757422725
2025-03-13 12:30:14,293 [INFO]: }
2025-03-13 12:30:14,293 [INFO]: 	>>> Finished "Creating the index" in 51.9288 secs
2025-03-13 12:30:14,293 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9551 secs
2025-03-13 12:30:14: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:30:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 4873 [episode count 13/20]
[retrieval_preprocessing] for episode 11631 [episode count 14/20], we have num_retrieval=np.int64(2348) num_query=np.int64(113)
2025-03-13 12:30:16,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:30:16,613 [INFO]: Launching the whole pipeline 03/13/2025, 12:30:16
2025-03-13 12:30:16,614 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:30:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.09it/s]
2025-03-13 12:30:16,641 [INFO]: There are 2348 embeddings of dim 49152
2025-03-13 12:30:16,642 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:30:16,642 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:30:16
2025-03-13 12:30:16,642 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:30:16,642 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:30:16,642 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:30:16,642 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:30:16,642 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:30:16
2025-03-13 12:30:16,642 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:30:16,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:30:16,642 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:30:16
2025-03-13 12:30:16,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:30:16,642 [INFO]: 	Creating the index 03/13/2025, 12:30:16
2025-03-13 12:30:16,642 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:30:16
2025-03-13 12:30:16,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:30:16,643 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:30:16
2025-03-13 12:30:16,644 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:30:16,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.63it/s] 30%|███       | 3/10 [00:00<00:00,  8.91it/s] 50%|█████     | 5/10 [00:00<00:00, 10.05it/s] 70%|███████   | 7/10 [00:00<00:00, 10.55it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.87it/s]100%|██████████| 10/10 [00:03<00:00,  3.22it/s]
2025-03-13 12:30:19,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:30:19
2025-03-13 12:30:55,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4485 secs
2025-03-13 12:30:55,198 [INFO]: The best hyperparameters are: efSearch=223
2025-03-13 12:30:55,198 [INFO]: 	Compute fast metrics 03/13/2025, 12:30:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-13 12:31:11,139 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9407 secs
2025-03-13 12:31:11,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4969 secs
2025-03-13 12:31:11,141 [INFO]: {
2025-03-13 12:31:11,141 [INFO]: 	index_key: HNSW15
2025-03-13 12:31:11,141 [INFO]: 	index_param: efSearch=223
2025-03-13 12:31:11,141 [INFO]: 	index_path: knn.index
2025-03-13 12:31:11,141 [INFO]: 	size in bytes: 461954530
2025-03-13 12:31:11,141 [INFO]: 	avg_search_speed_ms: 10.649680755328273
2025-03-13 12:31:11,141 [INFO]: 	99p_search_speed_ms: 17.948475559242073
2025-03-13 12:31:11,141 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:31:11,141 [INFO]: 	nb vectors: 2348
2025-03-13 12:31:11,141 [INFO]: 	vectors dimension: 49152
2025-03-13 12:31:11,141 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-13 12:31:11,141 [INFO]: }
2025-03-13 12:31:11,141 [INFO]: 	>>> Finished "Creating the index" in 54.4985 secs
2025-03-13 12:31:11,141 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5271 secs
2025-03-13 12:31:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 11631 [episode count 14/20]
[retrieval_preprocessing] for episode 18421 [episode count 15/20], we have num_retrieval=np.int64(2350) num_query=np.int64(111)
2025-03-13 12:31:12,816 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:31:13,235 [INFO]: Launching the whole pipeline 03/13/2025, 12:31:13
2025-03-13 12:31:13,235 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:31:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.69it/s]
2025-03-13 12:31:13,260 [INFO]: There are 2350 embeddings of dim 49152
2025-03-13 12:31:13,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 12:31:13,260 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:31:13
2025-03-13 12:31:13,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:31:13,260 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:31:13,260 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:31:13,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:31:13,261 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:31:13
2025-03-13 12:31:13,261 [INFO]: 485.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:31:13,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:31:13,261 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:31:13
2025-03-13 12:31:13,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:31:13,261 [INFO]: 	Creating the index 03/13/2025, 12:31:13
2025-03-13 12:31:13,261 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:31:13
2025-03-13 12:31:13,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:31:13,262 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:31:13
2025-03-13 12:31:13,262 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:31:13,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.07it/s] 20%|██        | 2/10 [00:00<00:01,  6.71it/s] 30%|███       | 3/10 [00:00<00:00,  7.51it/s] 40%|████      | 4/10 [00:00<00:00,  8.04it/s] 50%|█████     | 5/10 [00:00<00:00,  8.24it/s] 60%|██████    | 6/10 [00:00<00:00,  8.36it/s] 70%|███████   | 7/10 [00:00<00:00,  8.44it/s] 80%|████████  | 8/10 [00:01<00:00,  8.35it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.44it/s]100%|██████████| 10/10 [00:03<00:00,  1.35it/s]100%|██████████| 10/10 [00:03<00:00,  3.06it/s]
2025-03-13 12:31:16,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:31:16
2025-03-13 12:31:46,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5203 secs
2025-03-13 12:31:46,055 [INFO]: The best hyperparameters are: efSearch=217
2025-03-13 12:31:46,055 [INFO]: 	Compute fast metrics 03/13/2025, 12:31:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 12:32:05,320 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2644 secs
2025-03-13 12:32:05,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0595 secs
2025-03-13 12:32:05,322 [INFO]: {
2025-03-13 12:32:05,322 [INFO]: 	index_key: HNSW15
2025-03-13 12:32:05,322 [INFO]: 	index_param: efSearch=217
2025-03-13 12:32:05,322 [INFO]: 	index_path: knn.index
2025-03-13 12:32:05,322 [INFO]: 	size in bytes: 462348010
2025-03-13 12:32:05,322 [INFO]: 	avg_search_speed_ms: 9.515062586619713
2025-03-13 12:32:05,322 [INFO]: 	99p_search_speed_ms: 12.490873574279249
2025-03-13 12:32:05,322 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:32:05,322 [INFO]: 	nb vectors: 2350
2025-03-13 12:32:05,322 [INFO]: 	vectors dimension: 49152
2025-03-13 12:32:05,322 [INFO]: 	compression ratio: 0.9993095893286098
2025-03-13 12:32:05,322 [INFO]: }
2025-03-13 12:32:05,322 [INFO]: 	>>> Finished "Creating the index" in 52.0610 secs
2025-03-13 12:32:05,322 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0873 secs
2025-03-13 12:32:05: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:32:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 18421 [episode count 15/20]
[retrieval_preprocessing] for episode 85423 [episode count 16/20], we have num_retrieval=np.int64(2342) num_query=np.int64(119)
2025-03-13 12:32:07,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:32:07,551 [INFO]: Launching the whole pipeline 03/13/2025, 12:32:07
2025-03-13 12:32:07,551 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:32:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-13 12:32:07,575 [INFO]: There are 2342 embeddings of dim 49152
2025-03-13 12:32:07,575 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-13 12:32:07,575 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:32:07
2025-03-13 12:32:07,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:32:07,576 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:32:07,576 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:32:07,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:32:07,576 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:32:07
2025-03-13 12:32:07,576 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:32:07,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:32:07,576 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:32:07
2025-03-13 12:32:07,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:32:07,576 [INFO]: 	Creating the index 03/13/2025, 12:32:07
2025-03-13 12:32:07,576 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:32:07
2025-03-13 12:32:07,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:32:07,577 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:32:07
2025-03-13 12:32:07,577 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:32:07,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.72it/s] 30%|███       | 3/10 [00:00<00:00,  8.77it/s] 50%|█████     | 5/10 [00:00<00:00,  9.48it/s] 70%|███████   | 7/10 [00:00<00:00, 10.10it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.60it/s]100%|██████████| 10/10 [00:02<00:00,  3.58it/s]
2025-03-13 12:32:10,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:32:10
2025-03-13 12:32:41,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9338 secs
2025-03-13 12:32:41,312 [INFO]: The best hyperparameters are: efSearch=227
2025-03-13 12:32:41,312 [INFO]: 	Compute fast metrics 03/13/2025, 12:32:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.95it/s]
2025-03-13 12:33:00,516 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2047 secs
2025-03-13 12:33:00,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9418 secs
2025-03-13 12:33:00,519 [INFO]: {
2025-03-13 12:33:00,519 [INFO]: 	index_key: HNSW15
2025-03-13 12:33:00,519 [INFO]: 	index_param: efSearch=227
2025-03-13 12:33:00,519 [INFO]: 	index_path: knn.index
2025-03-13 12:33:00,519 [INFO]: 	size in bytes: 460774090
2025-03-13 12:33:00,519 [INFO]: 	avg_search_speed_ms: 10.312143054548134
2025-03-13 12:33:00,519 [INFO]: 	99p_search_speed_ms: 16.584429843351217
2025-03-13 12:33:00,519 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:33:00,519 [INFO]: 	nb vectors: 2342
2025-03-13 12:33:00,519 [INFO]: 	vectors dimension: 49152
2025-03-13 12:33:00,519 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-13 12:33:00,519 [INFO]: }
2025-03-13 12:33:00,519 [INFO]: 	>>> Finished "Creating the index" in 52.9432 secs
2025-03-13 12:33:00,519 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9682 secs
2025-03-13 12:33:01: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:33:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 85423 [episode count 16/20]
[retrieval_preprocessing] for episode 55741 [episode count 17/20], we have num_retrieval=np.int64(2309) num_query=np.int64(152)
2025-03-13 12:33:02,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:33:03,977 [INFO]: Launching the whole pipeline 03/13/2025, 12:33:03
2025-03-13 12:33:03,977 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:33:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.88it/s]
2025-03-13 12:33:04,005 [INFO]: There are 2309 embeddings of dim 49152
2025-03-13 12:33:04,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-13 12:33:04,006 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:33:04,006 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:33:04,006 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:33:04,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:33:04,006 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,006 [INFO]: 476.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:33:04,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:33:04,006 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:33:04
2025-03-13 12:33:04,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:33:04,006 [INFO]: 	Creating the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,006 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:33:04
2025-03-13 12:33:04,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:33:04,008 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:33:04
2025-03-13 12:33:04,008 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:33:04,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.76it/s] 50%|█████     | 5/10 [00:00<00:00, 23.00it/s] 90%|█████████ | 9/10 [00:00<00:00, 26.58it/s]100%|██████████| 10/10 [00:02<00:00,  4.06it/s]
2025-03-13 12:33:06,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:33:06
2025-03-13 12:33:41,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1467 secs
2025-03-13 12:33:41,620 [INFO]: The best hyperparameters are: efSearch=246
2025-03-13 12:33:41,620 [INFO]: 	Compute fast metrics 03/13/2025, 12:33:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-13 12:34:01,982 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3621 secs
2025-03-13 12:34:01,984 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9762 secs
2025-03-13 12:34:01,984 [INFO]: {
2025-03-13 12:34:01,984 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:01,984 [INFO]: 	index_param: efSearch=246
2025-03-13 12:34:01,984 [INFO]: 	index_path: knn.index
2025-03-13 12:34:01,984 [INFO]: 	size in bytes: 454281610
2025-03-13 12:34:01,984 [INFO]: 	avg_search_speed_ms: 12.226514426893429
2025-03-13 12:34:01,984 [INFO]: 	99p_search_speed_ms: 21.80422498844566
2025-03-13 12:34:01,984 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:01,984 [INFO]: 	nb vectors: 2309
2025-03-13 12:34:01,984 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:01,984 [INFO]: 	compression ratio: 0.9993093755214965
2025-03-13 12:34:01,984 [INFO]: }
2025-03-13 12:34:01,984 [INFO]: 	>>> Finished "Creating the index" in 57.9780 secs
2025-03-13 12:34:01,984 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0071 secs
2025-03-13 12:34:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:34:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 55741 [episode count 17/20]
[retrieval_preprocessing] for episode 7636 [episode count 18/20], we have num_retrieval=np.int64(2339) num_query=np.int64(122)
2025-03-13 12:34:04,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:34:05,634 [INFO]: Launching the whole pipeline 03/13/2025, 12:34:05
2025-03-13 12:34:05,634 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:34:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1426.63it/s]
2025-03-13 12:34:05,660 [INFO]: There are 2339 embeddings of dim 49152
2025-03-13 12:34:05,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 12:34:05,660 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:34:05
2025-03-13 12:34:05,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:34:05,660 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:34:05,660 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:34:05,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:34:05,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:34:05
2025-03-13 12:34:05,661 [INFO]: 482.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:34:05,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:34:05,661 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:34:05
2025-03-13 12:34:05,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:34:05,661 [INFO]: 	Creating the index 03/13/2025, 12:34:05
2025-03-13 12:34:05,661 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:34:05
2025-03-13 12:34:05,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:34:05,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:34:05
2025-03-13 12:34:05,662 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:34:05,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.86it/s] 30%|███       | 3/10 [00:00<00:00,  9.06it/s] 50%|█████     | 5/10 [00:00<00:00, 10.01it/s] 70%|███████   | 7/10 [00:00<00:00,  9.42it/s] 80%|████████  | 8/10 [00:00<00:00,  8.91it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.46it/s]100%|██████████| 10/10 [00:03<00:00,  1.46it/s]100%|██████████| 10/10 [00:03<00:00,  3.03it/s]
2025-03-13 12:34:08,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:34:08
2025-03-13 12:34:40,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6240 secs
2025-03-13 12:34:40,592 [INFO]: The best hyperparameters are: efSearch=234
2025-03-13 12:34:40,592 [INFO]: 	Compute fast metrics 03/13/2025, 12:34:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-13 12:34:59,583 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9901 secs
2025-03-13 12:34:59,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9228 secs
2025-03-13 12:34:59,585 [INFO]: {
2025-03-13 12:34:59,585 [INFO]: 	index_key: HNSW15
2025-03-13 12:34:59,585 [INFO]: 	index_param: efSearch=234
2025-03-13 12:34:59,585 [INFO]: 	index_path: knn.index
2025-03-13 12:34:59,585 [INFO]: 	size in bytes: 460183870
2025-03-13 12:34:59,585 [INFO]: 	avg_search_speed_ms: 11.063846725500724
2025-03-13 12:34:59,585 [INFO]: 	99p_search_speed_ms: 24.825319400988533
2025-03-13 12:34:59,585 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:34:59,585 [INFO]: 	nb vectors: 2339
2025-03-13 12:34:59,585 [INFO]: 	vectors dimension: 49152
2025-03-13 12:34:59,585 [INFO]: 	compression ratio: 0.9993094977448905
2025-03-13 12:34:59,585 [INFO]: }
2025-03-13 12:34:59,585 [INFO]: 	>>> Finished "Creating the index" in 53.9243 secs
2025-03-13 12:34:59,585 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9509 secs
2025-03-13 12:35:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 7636 [episode count 18/20]
[retrieval_preprocessing] for episode 3687 [episode count 19/20], we have num_retrieval=np.int64(2353) num_query=np.int64(108)
2025-03-13 12:35:02,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:35:02,539 [INFO]: Launching the whole pipeline 03/13/2025, 12:35:02
2025-03-13 12:35:02,539 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:35:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.78it/s]
2025-03-13 12:35:02,563 [INFO]: There are 2353 embeddings of dim 49152
2025-03-13 12:35:02,563 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-13 12:35:02,563 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:35:02
2025-03-13 12:35:02,563 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:35:02,563 [INFO]: 		-> Add: 1.3 seconds
2025-03-13 12:35:02,563 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:35:02,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:35:02,563 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:35:02
2025-03-13 12:35:02,564 [INFO]: 485.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:35:02,564 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:35:02,564 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:35:02
2025-03-13 12:35:02,564 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:35:02,564 [INFO]: 	Creating the index 03/13/2025, 12:35:02
2025-03-13 12:35:02,564 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:35:02
2025-03-13 12:35:02,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 12:35:02,565 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:35:02
2025-03-13 12:35:02,565 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-13 12:35:02,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.44it/s] 30%|███       | 3/10 [00:00<00:00,  9.58it/s] 50%|█████     | 5/10 [00:00<00:00, 11.32it/s] 70%|███████   | 7/10 [00:00<00:00, 13.19it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.47it/s]100%|██████████| 10/10 [00:02<00:00,  4.43it/s]
2025-03-13 12:35:04,825 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:35:04
2025-03-13 12:35:34,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2006 secs
2025-03-13 12:35:34,026 [INFO]: The best hyperparameters are: efSearch=229
2025-03-13 12:35:34,026 [INFO]: 	Compute fast metrics 03/13/2025, 12:35:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-13 12:35:52,109 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0831 secs
2025-03-13 12:35:52,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5464 secs
2025-03-13 12:35:52,111 [INFO]: {
2025-03-13 12:35:52,111 [INFO]: 	index_key: HNSW15
2025-03-13 12:35:52,111 [INFO]: 	index_param: efSearch=229
2025-03-13 12:35:52,111 [INFO]: 	index_path: knn.index
2025-03-13 12:35:52,111 [INFO]: 	size in bytes: 462938230
2025-03-13 12:35:52,111 [INFO]: 	avg_search_speed_ms: 9.750752611318148
2025-03-13 12:35:52,111 [INFO]: 	99p_search_speed_ms: 12.88940740050748
2025-03-13 12:35:52,111 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:35:52,111 [INFO]: 	nb vectors: 2353
2025-03-13 12:35:52,112 [INFO]: 	vectors dimension: 49152
2025-03-13 12:35:52,112 [INFO]: 	compression ratio: 0.9993096141573791
2025-03-13 12:35:52,112 [INFO]: }
2025-03-13 12:35:52,112 [INFO]: 	>>> Finished "Creating the index" in 49.5478 secs
2025-03-13 12:35:52,112 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5721 secs
2025-03-13 12:35:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:35:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 3687 [episode count 19/20]
2025-03-13 12:35:53: [retrieval_preprocessing] finished for 3951366978_remove_blue_ring_from_wooden_stand [chosen_id count 5/260]
2025-03-13 12:35:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_lid_on_kettle [chosen_id count 6/260]
2025-03-13 12:35:57: [retrieval_preprocessing] we have num_total=6111 embedding_dim=49152
[retrieval_preprocessing] for episode 10760 [episode count 0/20], we have num_retrieval=np.int64(5798) num_query=np.int64(313)
2025-03-13 12:35:59,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:36:00,759 [INFO]: Launching the whole pipeline 03/13/2025, 12:36:00
2025-03-13 12:36:00,759 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:36:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1813.36it/s]
2025-03-13 12:36:00,784 [INFO]: There are 5798 embeddings of dim 49152
2025-03-13 12:36:00,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 12:36:00,784 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:36:00
2025-03-13 12:36:00,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:36:00,785 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:36:00,785 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:36:00,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:36:00,785 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:36:00
2025-03-13 12:36:00,785 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:36:00,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:36:00,786 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:36:00
2025-03-13 12:36:00,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:36:00,786 [INFO]: 	Creating the index 03/13/2025, 12:36:00
2025-03-13 12:36:00,786 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:36:00
2025-03-13 12:36:00,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:36:00,790 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:36:00
2025-03-13 12:36:00,790 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:36:00,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.51it/s] 12%|█▎        | 3/24 [00:00<00:02, 10.39it/s] 21%|██        | 5/24 [00:00<00:01, 11.87it/s] 29%|██▉       | 7/24 [00:00<00:01, 12.67it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.45it/s] 46%|████▌     | 11/24 [00:00<00:00, 13.36it/s] 54%|█████▍    | 13/24 [00:01<00:00, 12.72it/s] 62%|██████▎   | 15/24 [00:01<00:00, 12.42it/s] 71%|███████   | 17/24 [00:01<00:00, 11.99it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.76it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.59it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.87it/s]100%|██████████| 24/24 [00:07<00:00,  1.59it/s]100%|██████████| 24/24 [00:07<00:00,  3.41it/s]
2025-03-13 12:36:07,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:36:07
2025-03-13 12:36:52,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6998 secs
2025-03-13 12:36:52,540 [INFO]: The best hyperparameters are: efSearch=160
2025-03-13 12:36:52,540 [INFO]: 	Compute fast metrics 03/13/2025, 12:36:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 50%|█████     | 2/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-13 12:37:18,299 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7588 secs
2025-03-13 12:37:18,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5105 secs
2025-03-13 12:37:18,300 [INFO]: {
2025-03-13 12:37:18,300 [INFO]: 	index_key: HNSW15
2025-03-13 12:37:18,301 [INFO]: 	index_param: efSearch=160
2025-03-13 12:37:18,301 [INFO]: 	index_path: knn.index
2025-03-13 12:37:18,301 [INFO]: 	size in bytes: 1140722350
2025-03-13 12:37:18,301 [INFO]: 	avg_search_speed_ms: 6.942109097953006
2025-03-13 12:37:18,301 [INFO]: 	99p_search_speed_ms: 9.652732715476304
2025-03-13 12:37:18,301 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:37:18,301 [INFO]: 	nb vectors: 5798
2025-03-13 12:37:18,301 [INFO]: 	vectors dimension: 49152
2025-03-13 12:37:18,301 [INFO]: 	compression ratio: 0.999308187483133
2025-03-13 12:37:18,301 [INFO]: }
2025-03-13 12:37:18,301 [INFO]: 	>>> Finished "Creating the index" in 77.5145 secs
2025-03-13 12:37:18,301 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5420 secs
2025-03-13 12:37:19: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:37:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 10760 [episode count 0/20]
[retrieval_preprocessing] for episode 33815 [episode count 1/20], we have num_retrieval=np.int64(5778) num_query=np.int64(333)
2025-03-13 12:37:22,849 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:37:23,610 [INFO]: Launching the whole pipeline 03/13/2025, 12:37:23
2025-03-13 12:37:23,610 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:37:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.22it/s]
2025-03-13 12:37:23,638 [INFO]: There are 5778 embeddings of dim 49152
2025-03-13 12:37:23,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 12:37:23,639 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:37:23
2025-03-13 12:37:23,639 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:37:23,639 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:37:23,639 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:37:23,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-13 12:37:23,639 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:37:23
2025-03-13 12:37:23,640 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:37:23,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:37:23,640 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:37:23
2025-03-13 12:37:23,640 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:37:23,640 [INFO]: 	Creating the index 03/13/2025, 12:37:23
2025-03-13 12:37:23,640 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:37:23
2025-03-13 12:37:23,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:37:23,644 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:37:23
2025-03-13 12:37:23,644 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:37:23,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  5.88it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.29it/s] 21%|██        | 5/24 [00:00<00:01, 10.52it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.81it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.79it/s] 46%|████▌     | 11/24 [00:00<00:00, 13.74it/s] 54%|█████▍    | 13/24 [00:01<00:00, 13.99it/s] 62%|██████▎   | 15/24 [00:01<00:00, 14.23it/s] 71%|███████   | 17/24 [00:01<00:00, 14.84it/s] 79%|███████▉  | 19/24 [00:01<00:00, 13.90it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.56it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.84it/s]100%|██████████| 24/24 [00:06<00:00,  1.60it/s]100%|██████████| 24/24 [00:06<00:00,  3.44it/s]
2025-03-13 12:37:30,632 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:37:30
2025-03-13 12:38:24,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6228 secs
2025-03-13 12:38:24,256 [INFO]: The best hyperparameters are: efSearch=292
2025-03-13 12:38:24,256 [INFO]: 	Compute fast metrics 03/13/2025, 12:38:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-13 12:38:54,454 [INFO]: 	>>> Finished "Compute fast metrics" in 30.1980 secs
2025-03-13 12:38:54,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8113 secs
2025-03-13 12:38:54,455 [INFO]: {
2025-03-13 12:38:54,455 [INFO]: 	index_key: HNSW15
2025-03-13 12:38:54,455 [INFO]: 	index_param: efSearch=292
2025-03-13 12:38:54,455 [INFO]: 	index_path: knn.index
2025-03-13 12:38:54,455 [INFO]: 	size in bytes: 1136787490
2025-03-13 12:38:54,455 [INFO]: 	avg_search_speed_ms: 12.211933016199369
2025-03-13 12:38:54,455 [INFO]: 	99p_search_speed_ms: 20.21690515335649
2025-03-13 12:38:54,455 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:38:54,455 [INFO]: 	nb vectors: 5778
2025-03-13 12:38:54,455 [INFO]: 	vectors dimension: 49152
2025-03-13 12:38:54,455 [INFO]: 	compression ratio: 0.9993081679672601
2025-03-13 12:38:54,455 [INFO]: }
2025-03-13 12:38:54,455 [INFO]: 	>>> Finished "Creating the index" in 90.8152 secs
2025-03-13 12:38:54,455 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8453 secs
2025-03-13 12:38:56: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:38:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 33815 [episode count 1/20]
[retrieval_preprocessing] for episode 36391 [episode count 2/20], we have num_retrieval=np.int64(5849) num_query=np.int64(262)
2025-03-13 12:39:00,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:39:01,058 [INFO]: Launching the whole pipeline 03/13/2025, 12:39:01
2025-03-13 12:39:01,059 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:39:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.28it/s]
2025-03-13 12:39:01,086 [INFO]: There are 5849 embeddings of dim 49152
2025-03-13 12:39:01,087 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-13 12:39:01,087 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:39:01
2025-03-13 12:39:01,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:39:01,087 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:39:01,087 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:39:01,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:39:01,088 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:39:01
2025-03-13 12:39:01,088 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:39:01,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:39:01,088 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:39:01
2025-03-13 12:39:01,089 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:39:01,089 [INFO]: 	Creating the index 03/13/2025, 12:39:01
2025-03-13 12:39:01,089 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:39:01
2025-03-13 12:39:01,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 12:39:01,092 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:39:01
2025-03-13 12:39:01,092 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:39:01,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.98it/s]  8%|▊         | 2/25 [00:00<00:03,  6.61it/s] 12%|█▏        | 3/25 [00:00<00:02,  7.37it/s] 16%|█▌        | 4/25 [00:00<00:02,  7.77it/s] 20%|██        | 5/25 [00:00<00:02,  8.00it/s] 24%|██▍       | 6/25 [00:00<00:02,  8.26it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.35it/s] 32%|███▏      | 8/25 [00:01<00:02,  8.40it/s] 36%|███▌      | 9/25 [00:01<00:01,  8.42it/s] 40%|████      | 10/25 [00:01<00:01,  8.43it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.57it/s] 52%|█████▏    | 13/25 [00:01<00:01,  9.56it/s] 60%|██████    | 15/25 [00:01<00:00, 10.12it/s] 68%|██████▊   | 17/25 [00:01<00:00, 10.65it/s] 76%|███████▌  | 19/25 [00:02<00:00, 11.21it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.52it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.10it/s]100%|██████████| 25/25 [00:07<00:00,  1.82it/s]100%|██████████| 25/25 [00:07<00:00,  3.42it/s]
2025-03-13 12:39:08,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:39:08
2025-03-13 12:40:01,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6705 secs
2025-03-13 12:40:01,076 [INFO]: The best hyperparameters are: efSearch=329
2025-03-13 12:40:01,076 [INFO]: 	Compute fast metrics 03/13/2025, 12:40:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-13 12:40:37,720 [INFO]: 	>>> Finished "Compute fast metrics" in 36.6438 secs
2025-03-13 12:40:37,722 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.6296 secs
2025-03-13 12:40:37,722 [INFO]: {
2025-03-13 12:40:37,722 [INFO]: 	index_key: HNSW15
2025-03-13 12:40:37,722 [INFO]: 	index_param: efSearch=329
2025-03-13 12:40:37,722 [INFO]: 	index_path: knn.index
2025-03-13 12:40:37,722 [INFO]: 	size in bytes: 1150756210
2025-03-13 12:40:37,722 [INFO]: 	avg_search_speed_ms: 14.776138240743864
2025-03-13 12:40:37,722 [INFO]: 	99p_search_speed_ms: 31.683786278590567
2025-03-13 12:40:37,722 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:40:37,722 [INFO]: 	nb vectors: 5849
2025-03-13 12:40:37,722 [INFO]: 	vectors dimension: 49152
2025-03-13 12:40:37,722 [INFO]: 	compression ratio: 0.9993082653014751
2025-03-13 12:40:37,722 [INFO]: }
2025-03-13 12:40:37,722 [INFO]: 	>>> Finished "Creating the index" in 96.6333 secs
2025-03-13 12:40:37,722 [INFO]: >>> Finished "Launching the whole pipeline" in 96.6635 secs
2025-03-13 12:40:40: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:40:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 36391 [episode count 2/20]
[retrieval_preprocessing] for episode 29760 [episode count 3/20], we have num_retrieval=np.int64(5791) num_query=np.int64(320)
2025-03-13 12:40:45,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:40:46,953 [INFO]: Launching the whole pipeline 03/13/2025, 12:40:46
2025-03-13 12:40:46,953 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:40:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.57it/s]
2025-03-13 12:40:46,977 [INFO]: There are 5791 embeddings of dim 49152
2025-03-13 12:40:46,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-13 12:40:46,978 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:40:46
2025-03-13 12:40:46,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:40:46,979 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:40:46,979 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:40:46,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:40:46,979 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:40:46
2025-03-13 12:40:46,980 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:40:46,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-13 12:40:46,980 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:40:46
2025-03-13 12:40:46,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:40:46,980 [INFO]: 	Creating the index 03/13/2025, 12:40:46
2025-03-13 12:40:46,980 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:40:46
2025-03-13 12:40:46,984 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0036 secs
2025-03-13 12:40:46,984 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:40:46
2025-03-13 12:40:46,984 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:40:46,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.42it/s]  8%|▊         | 2/24 [00:00<00:03,  7.05it/s] 12%|█▎        | 3/24 [00:00<00:02,  7.67it/s] 17%|█▋        | 4/24 [00:00<00:02,  7.77it/s] 21%|██        | 5/24 [00:00<00:02,  7.85it/s] 25%|██▌       | 6/24 [00:00<00:02,  8.21it/s] 29%|██▉       | 7/24 [00:00<00:01,  8.56it/s] 33%|███▎      | 8/24 [00:01<00:01,  8.39it/s] 38%|███▊      | 9/24 [00:01<00:01,  8.24it/s] 46%|████▌     | 11/24 [00:01<00:01,  9.11it/s] 54%|█████▍    | 13/24 [00:01<00:01,  9.36it/s] 62%|██████▎   | 15/24 [00:01<00:00,  9.73it/s] 71%|███████   | 17/24 [00:01<00:00, 10.25it/s] 79%|███████▉  | 19/24 [00:02<00:00, 10.31it/s] 88%|████████▊ | 21/24 [00:06<00:02,  1.39it/s] 92%|█████████▏| 22/24 [00:06<00:01,  1.64it/s] 96%|█████████▌| 23/24 [00:06<00:00,  1.98it/s]100%|██████████| 24/24 [00:08<00:00,  1.32it/s]100%|██████████| 24/24 [00:08<00:00,  3.00it/s]
2025-03-13 12:40:55,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:40:55
2025-03-13 12:41:40,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3157 secs
2025-03-13 12:41:40,320 [INFO]: The best hyperparameters are: efSearch=349
2025-03-13 12:41:40,320 [INFO]: 	Compute fast metrics 03/13/2025, 12:41:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-13 12:42:06,491 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1706 secs
2025-03-13 12:42:06,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5076 secs
2025-03-13 12:42:06,492 [INFO]: {
2025-03-13 12:42:06,492 [INFO]: 	index_key: HNSW15
2025-03-13 12:42:06,492 [INFO]: 	index_param: efSearch=349
2025-03-13 12:42:06,492 [INFO]: 	index_path: knn.index
2025-03-13 12:42:06,492 [INFO]: 	size in bytes: 1139345110
2025-03-13 12:42:06,492 [INFO]: 	avg_search_speed_ms: 14.335980109488832
2025-03-13 12:42:06,492 [INFO]: 	99p_search_speed_ms: 21.89910680288448
2025-03-13 12:42:06,492 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:42:06,492 [INFO]: 	nb vectors: 5791
2025-03-13 12:42:06,492 [INFO]: 	vectors dimension: 49152
2025-03-13 12:42:06,492 [INFO]: 	compression ratio: 0.9993082148744202
2025-03-13 12:42:06,492 [INFO]: }
2025-03-13 12:42:06,492 [INFO]: 	>>> Finished "Creating the index" in 79.5120 secs
2025-03-13 12:42:06,492 [INFO]: >>> Finished "Launching the whole pipeline" in 79.5395 secs
2025-03-13 12:42:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:42:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 29760 [episode count 3/20]
[retrieval_preprocessing] for episode 32331 [episode count 4/20], we have num_retrieval=np.int64(5788) num_query=np.int64(323)
2025-03-13 12:42:38,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:42:39,596 [INFO]: Launching the whole pipeline 03/13/2025, 12:42:39
2025-03-13 12:42:39,596 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:42:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1433.46it/s]
2025-03-13 12:42:39,625 [INFO]: There are 5788 embeddings of dim 49152
2025-03-13 12:42:39,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-13 12:42:39,625 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,626 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:42:39,626 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:42:39,626 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:42:39,626 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-13 12:42:39,626 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,627 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:42:39,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 12:42:39,627 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:42:39
2025-03-13 12:42:39,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:42:39,628 [INFO]: 	Creating the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,628 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:42:39
2025-03-13 12:42:39,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-13 12:42:39,631 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:42:39
2025-03-13 12:42:39,632 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:42:39,632 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:05,  4.51it/s]  8%|▊         | 2/24 [00:00<00:03,  5.80it/s] 12%|█▎        | 3/24 [00:00<00:03,  6.38it/s] 17%|█▋        | 4/24 [00:00<00:02,  6.68it/s] 21%|██        | 5/24 [00:00<00:02,  6.86it/s] 25%|██▌       | 6/24 [00:00<00:02,  7.06it/s] 29%|██▉       | 7/24 [00:01<00:02,  7.11it/s] 33%|███▎      | 8/24 [00:01<00:02,  7.14it/s] 38%|███▊      | 9/24 [00:01<00:02,  7.18it/s] 42%|████▏     | 10/24 [00:01<00:03,  3.59it/s] 46%|████▌     | 11/24 [00:02<00:05,  2.54it/s] 50%|█████     | 12/24 [00:02<00:03,  3.10it/s] 58%|█████▊    | 14/24 [00:02<00:02,  4.85it/s] 71%|███████   | 17/24 [00:03<00:00,  7.63it/s] 79%|███████▉  | 19/24 [00:03<00:00,  8.98it/s] 88%|████████▊ | 21/24 [00:06<00:01,  1.55it/s] 92%|█████████▏| 22/24 [00:08<00:01,  1.09it/s] 96%|█████████▌| 23/24 [00:09<00:00,  1.29it/s]100%|██████████| 24/24 [00:10<00:00,  1.01it/s]100%|██████████| 24/24 [00:10<00:00,  2.21it/s]
2025-03-13 12:42:50,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:42:50
2025-03-13 12:43:35,579 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0660 secs
2025-03-13 12:43:35,579 [INFO]: The best hyperparameters are: efSearch=272
2025-03-13 12:43:35,579 [INFO]: 	Compute fast metrics 03/13/2025, 12:43:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.42it/s]
2025-03-13 12:43:56,472 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8928 secs
2025-03-13 12:43:56,473 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8418 secs
2025-03-13 12:43:56,473 [INFO]: {
2025-03-13 12:43:56,473 [INFO]: 	index_key: HNSW15
2025-03-13 12:43:56,473 [INFO]: 	index_param: efSearch=272
2025-03-13 12:43:56,473 [INFO]: 	index_path: knn.index
2025-03-13 12:43:56,473 [INFO]: 	size in bytes: 1138754890
2025-03-13 12:43:56,473 [INFO]: 	avg_search_speed_ms: 12.398208403218966
2025-03-13 12:43:56,473 [INFO]: 	99p_search_speed_ms: 17.65213385690003
2025-03-13 12:43:56,473 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:43:56,473 [INFO]: 	nb vectors: 5788
2025-03-13 12:43:56,473 [INFO]: 	vectors dimension: 49152
2025-03-13 12:43:56,473 [INFO]: 	compression ratio: 0.9993082040683926
2025-03-13 12:43:56,473 [INFO]: }
2025-03-13 12:43:56,473 [INFO]: 	>>> Finished "Creating the index" in 76.8457 secs
2025-03-13 12:43:56,473 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8777 secs
2025-03-13 12:43:58: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:44:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 32331 [episode count 4/20]
[retrieval_preprocessing] for episode 37992 [episode count 5/20], we have num_retrieval=np.int64(5828) num_query=np.int64(283)
2025-03-13 12:44:03,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:44:04,274 [INFO]: Launching the whole pipeline 03/13/2025, 12:44:04
2025-03-13 12:44:04,274 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:44:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1064.00it/s]
2025-03-13 12:44:04,302 [INFO]: There are 5828 embeddings of dim 49152
2025-03-13 12:44:04,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-13 12:44:04,303 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:44:04
2025-03-13 12:44:04,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:44:04,304 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:44:04,304 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:44:04,304 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:44:04,304 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:44:04
2025-03-13 12:44:04,304 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:44:04,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:44:04,305 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:44:04
2025-03-13 12:44:04,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:44:04,305 [INFO]: 	Creating the index 03/13/2025, 12:44:04
2025-03-13 12:44:04,305 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:44:04
2025-03-13 12:44:04,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-13 12:44:04,308 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:44:04
2025-03-13 12:44:04,308 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:44:04,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.21it/s]  8%|▊         | 2/24 [00:00<00:03,  6.93it/s] 12%|█▎        | 3/24 [00:00<00:02,  7.73it/s] 17%|█▋        | 4/24 [00:00<00:02,  8.17it/s] 21%|██        | 5/24 [00:00<00:02,  8.45it/s] 25%|██▌       | 6/24 [00:00<00:02,  8.74it/s] 29%|██▉       | 7/24 [00:00<00:01,  8.79it/s] 33%|███▎      | 8/24 [00:00<00:01,  9.00it/s] 38%|███▊      | 9/24 [00:01<00:01,  8.81it/s] 42%|████▏     | 10/24 [00:01<00:01,  8.65it/s] 46%|████▌     | 11/24 [00:01<00:01,  8.78it/s] 50%|█████     | 12/24 [00:01<00:01,  8.99it/s] 58%|█████▊    | 14/24 [00:01<00:00, 10.46it/s] 67%|██████▋   | 16/24 [00:01<00:00, 11.37it/s] 75%|███████▌  | 18/24 [00:01<00:00, 11.97it/s] 83%|████████▎ | 20/24 [00:02<00:00, 12.11it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.53it/s]100%|██████████| 24/24 [00:07<00:00,  1.41it/s]100%|██████████| 24/24 [00:07<00:00,  3.27it/s]
2025-03-13 12:44:11,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:44:11
2025-03-13 12:45:08,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6075 secs
2025-03-13 12:45:08,267 [INFO]: The best hyperparameters are: efSearch=303
2025-03-13 12:45:08,267 [INFO]: 	Compute fast metrics 03/13/2025, 12:45:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-13 12:45:37,768 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5013 secs
2025-03-13 12:45:37,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.4972 secs
2025-03-13 12:45:37,805 [INFO]: {
2025-03-13 12:45:37,805 [INFO]: 	index_key: HNSW15
2025-03-13 12:45:37,805 [INFO]: 	index_param: efSearch=303
2025-03-13 12:45:37,805 [INFO]: 	index_path: knn.index
2025-03-13 12:45:37,805 [INFO]: 	size in bytes: 1146624670
2025-03-13 12:45:37,805 [INFO]: 	avg_search_speed_ms: 11.490939929760591
2025-03-13 12:45:37,806 [INFO]: 	99p_search_speed_ms: 15.304376697167749
2025-03-13 12:45:37,806 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:45:37,806 [INFO]: 	nb vectors: 5828
2025-03-13 12:45:37,806 [INFO]: 	vectors dimension: 49152
2025-03-13 12:45:37,806 [INFO]: 	compression ratio: 0.9993081903601464
2025-03-13 12:45:37,806 [INFO]: }
2025-03-13 12:45:37,806 [INFO]: 	>>> Finished "Creating the index" in 93.5008 secs
2025-03-13 12:45:37,806 [INFO]: >>> Finished "Launching the whole pipeline" in 93.5319 secs
2025-03-13 12:45:39: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:45:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 37992 [episode count 5/20]
[retrieval_preprocessing] for episode 20134 [episode count 6/20], we have num_retrieval=np.int64(5816) num_query=np.int64(295)
2025-03-13 12:45:42,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:45:43,887 [INFO]: Launching the whole pipeline 03/13/2025, 12:45:43
2025-03-13 12:45:43,887 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:45:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.38it/s]
2025-03-13 12:45:43,911 [INFO]: There are 5816 embeddings of dim 49152
2025-03-13 12:45:43,912 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-13 12:45:43,912 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:45:43
2025-03-13 12:45:43,912 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:45:43,912 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:45:43,913 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:45:43,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:45:43,913 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:45:43
2025-03-13 12:45:43,913 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:45:43,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 12:45:43,913 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:45:43
2025-03-13 12:45:43,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:45:43,913 [INFO]: 	Creating the index 03/13/2025, 12:45:43
2025-03-13 12:45:43,914 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:45:43
2025-03-13 12:45:43,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 12:45:43,917 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:45:43
2025-03-13 12:45:43,917 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:45:43,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:02<01:08,  2.98s/it] 17%|█▋        | 4/24 [00:03<00:12,  1.66it/s] 29%|██▉       | 7/24 [00:03<00:05,  3.17it/s] 42%|████▏     | 10/24 [00:03<00:02,  5.08it/s] 54%|█████▍    | 13/24 [00:03<00:01,  7.27it/s] 67%|██████▋   | 16/24 [00:03<00:00,  9.57it/s] 79%|███████▉  | 19/24 [00:03<00:00, 12.02it/s] 92%|█████████▏| 22/24 [00:07<00:00,  2.29it/s]100%|██████████| 24/24 [00:08<00:00,  2.00it/s]100%|██████████| 24/24 [00:08<00:00,  2.74it/s]
2025-03-13 12:45:52,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:45:52
2025-03-13 12:46:41,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6442 secs
2025-03-13 12:46:41,341 [INFO]: The best hyperparameters are: efSearch=226
2025-03-13 12:46:41,341 [INFO]: 	Compute fast metrics 03/13/2025, 12:46:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
2025-03-13 12:47:01,299 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9585 secs
2025-03-13 12:47:01,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3831 secs
2025-03-13 12:47:01,300 [INFO]: {
2025-03-13 12:47:01,300 [INFO]: 	index_key: HNSW15
2025-03-13 12:47:01,300 [INFO]: 	index_param: efSearch=226
2025-03-13 12:47:01,300 [INFO]: 	index_path: knn.index
2025-03-13 12:47:01,300 [INFO]: 	size in bytes: 1144263730
2025-03-13 12:47:01,300 [INFO]: 	avg_search_speed_ms: 10.559167049101376
2025-03-13 12:47:01,300 [INFO]: 	99p_search_speed_ms: 17.539600362069894
2025-03-13 12:47:01,300 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:47:01,300 [INFO]: 	nb vectors: 5816
2025-03-13 12:47:01,301 [INFO]: 	vectors dimension: 49152
2025-03-13 12:47:01,301 [INFO]: 	compression ratio: 0.9993081996927404
2025-03-13 12:47:01,301 [INFO]: }
2025-03-13 12:47:01,301 [INFO]: 	>>> Finished "Creating the index" in 77.3871 secs
2025-03-13 12:47:01,301 [INFO]: >>> Finished "Launching the whole pipeline" in 77.4137 secs
2025-03-13 12:47:02: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:47:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 20134 [episode count 6/20]
[retrieval_preprocessing] for episode 10943 [episode count 7/20], we have num_retrieval=np.int64(5758) num_query=np.int64(353)
2025-03-13 12:47:06,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:47:06,902 [INFO]: Launching the whole pipeline 03/13/2025, 12:47:06
2025-03-13 12:47:06,902 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:47:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.61it/s]
2025-03-13 12:47:06,927 [INFO]: There are 5758 embeddings of dim 49152
2025-03-13 12:47:06,927 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 12:47:06,927 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:47:06
2025-03-13 12:47:06,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:47:06,927 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:47:06,927 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:47:06,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:47:06,927 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:47:06
2025-03-13 12:47:06,927 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:47:06,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:47:06,928 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:47:06
2025-03-13 12:47:06,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:47:06,928 [INFO]: 	Creating the index 03/13/2025, 12:47:06
2025-03-13 12:47:06,928 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:47:06
2025-03-13 12:47:06,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:47:06,929 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:47:06
2025-03-13 12:47:06,929 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:47:06,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.63it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.55it/s] 21%|██        | 5/24 [00:00<00:01, 10.90it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.51it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.24it/s] 46%|████▌     | 11/24 [00:01<00:01, 10.69it/s] 54%|█████▍    | 13/24 [00:01<00:01, 10.27it/s] 62%|██████▎   | 15/24 [00:01<00:00,  9.99it/s] 71%|███████   | 17/24 [00:01<00:00, 10.22it/s] 83%|████████▎ | 20/24 [00:01<00:00, 13.88it/s] 92%|█████████▏| 22/24 [00:05<00:01,  1.60it/s]100%|██████████| 24/24 [00:07<00:00,  1.58it/s]100%|██████████| 24/24 [00:07<00:00,  3.34it/s]
2025-03-13 12:47:14,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:47:14
2025-03-13 12:48:22,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.4840 secs
2025-03-13 12:48:22,602 [INFO]: The best hyperparameters are: efSearch=283
2025-03-13 12:48:22,603 [INFO]: 	Compute fast metrics 03/13/2025, 12:48:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.14it/s]
2025-03-13 12:48:41,590 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9877 secs
2025-03-13 12:48:41,592 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.6626 secs
2025-03-13 12:48:41,592 [INFO]: {
2025-03-13 12:48:41,592 [INFO]: 	index_key: HNSW15
2025-03-13 12:48:41,592 [INFO]: 	index_param: efSearch=283
2025-03-13 12:48:41,592 [INFO]: 	index_path: knn.index
2025-03-13 12:48:41,592 [INFO]: 	size in bytes: 1132852570
2025-03-13 12:48:41,592 [INFO]: 	avg_search_speed_ms: 15.43402956348821
2025-03-13 12:48:41,592 [INFO]: 	99p_search_speed_ms: 27.176779406145204
2025-03-13 12:48:41,592 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:48:41,592 [INFO]: 	nb vectors: 5758
2025-03-13 12:48:41,592 [INFO]: 	vectors dimension: 49152
2025-03-13 12:48:41,592 [INFO]: 	compression ratio: 0.9993082012428148
2025-03-13 12:48:41,592 [INFO]: }
2025-03-13 12:48:41,592 [INFO]: 	>>> Finished "Creating the index" in 94.6644 secs
2025-03-13 12:48:41,592 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6903 secs
2025-03-13 12:48:44: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:48:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 10943 [episode count 7/20]
[retrieval_preprocessing] for episode 56143 [episode count 8/20], we have num_retrieval=np.int64(5866) num_query=np.int64(245)
2025-03-13 12:48:46,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:48:47,731 [INFO]: Launching the whole pipeline 03/13/2025, 12:48:47
2025-03-13 12:48:47,731 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:48:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1317.31it/s]
2025-03-13 12:48:47,768 [INFO]: There are 5866 embeddings of dim 49152
2025-03-13 12:48:47,769 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-13 12:48:47,769 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:48:47
2025-03-13 12:48:47,769 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:48:47,769 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:48:47,769 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:48:47,769 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:48:47,769 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:48:47
2025-03-13 12:48:47,769 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:48:47,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:48:47,769 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:48:47
2025-03-13 12:48:47,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:48:47,769 [INFO]: 	Creating the index 03/13/2025, 12:48:47
2025-03-13 12:48:47,769 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:48:47
2025-03-13 12:48:47,770 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 12:48:47,771 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:48:47
2025-03-13 12:48:47,771 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:48:47,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.94it/s] 20%|██        | 5/25 [00:00<00:00, 23.03it/s] 40%|████      | 10/25 [00:00<00:00, 32.62it/s] 64%|██████▍   | 16/25 [00:00<00:00, 39.96it/s] 84%|████████▍ | 21/25 [00:03<00:01,  3.56it/s]100%|██████████| 25/25 [00:05<00:00,  3.31it/s]100%|██████████| 25/25 [00:05<00:00,  4.63it/s]
2025-03-13 12:48:53,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:48:53
2025-03-13 12:49:54,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.3752 secs
2025-03-13 12:49:54,546 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 12:49:54,546 [INFO]: 	Compute fast metrics 03/13/2025, 12:49:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.88it/s]
2025-03-13 12:50:19,121 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5748 secs
2025-03-13 12:50:19,122 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.3515 secs
2025-03-13 12:50:19,122 [INFO]: {
2025-03-13 12:50:19,122 [INFO]: 	index_key: HNSW15
2025-03-13 12:50:19,122 [INFO]: 	index_param: efSearch=287
2025-03-13 12:50:19,122 [INFO]: 	index_path: knn.index
2025-03-13 12:50:19,122 [INFO]: 	size in bytes: 1154100910
2025-03-13 12:50:19,122 [INFO]: 	avg_search_speed_ms: 10.986397781787993
2025-03-13 12:50:19,122 [INFO]: 	99p_search_speed_ms: 15.342913549393415
2025-03-13 12:50:19,122 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:50:19,122 [INFO]: 	nb vectors: 5866
2025-03-13 12:50:19,122 [INFO]: 	vectors dimension: 49152
2025-03-13 12:50:19,122 [INFO]: 	compression ratio: 0.9993082216701484
2025-03-13 12:50:19,122 [INFO]: }
2025-03-13 12:50:19,122 [INFO]: 	>>> Finished "Creating the index" in 91.3532 secs
2025-03-13 12:50:19,123 [INFO]: >>> Finished "Launching the whole pipeline" in 91.3911 secs
2025-03-13 12:50:20: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:50:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 56143 [episode count 8/20]
[retrieval_preprocessing] for episode 21253 [episode count 9/20], we have num_retrieval=np.int64(5799) num_query=np.int64(312)
2025-03-13 12:50:22,385 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:50:23,625 [INFO]: Launching the whole pipeline 03/13/2025, 12:50:23
2025-03-13 12:50:23,625 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:50:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1240.18it/s]
2025-03-13 12:50:23,658 [INFO]: There are 5799 embeddings of dim 49152
2025-03-13 12:50:23,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-13 12:50:23,659 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:50:23
2025-03-13 12:50:23,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:50:23,659 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:50:23,659 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:50:23,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-13 12:50:23,660 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:50:23
2025-03-13 12:50:23,660 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:50:23,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:50:23,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:50:23
2025-03-13 12:50:23,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:50:23,660 [INFO]: 	Creating the index 03/13/2025, 12:50:23
2025-03-13 12:50:23,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:50:23
2025-03-13 12:50:23,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:50:23,662 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:50:23
2025-03-13 12:50:23,662 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:50:23,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.55it/s] 21%|██        | 5/24 [00:00<00:00, 25.57it/s] 42%|████▏     | 10/24 [00:00<00:00, 35.18it/s] 62%|██████▎   | 15/24 [00:00<00:00, 40.38it/s] 83%|████████▎ | 20/24 [00:00<00:00, 43.21it/s]100%|██████████| 24/24 [00:05<00:00,  4.27it/s]
2025-03-13 12:50:29,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:50:29
2025-03-13 12:51:28,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2723 secs
2025-03-13 12:51:28,563 [INFO]: The best hyperparameters are: efSearch=264
2025-03-13 12:51:28,563 [INFO]: 	Compute fast metrics 03/13/2025, 12:51:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.65it/s]
2025-03-13 12:51:48,803 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2396 secs
2025-03-13 12:51:48,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.1425 secs
2025-03-13 12:51:48,804 [INFO]: {
2025-03-13 12:51:48,804 [INFO]: 	index_key: HNSW15
2025-03-13 12:51:48,804 [INFO]: 	index_param: efSearch=264
2025-03-13 12:51:48,804 [INFO]: 	index_path: knn.index
2025-03-13 12:51:48,804 [INFO]: 	size in bytes: 1140919090
2025-03-13 12:51:48,804 [INFO]: 	avg_search_speed_ms: 11.521629726542116
2025-03-13 12:51:48,804 [INFO]: 	99p_search_speed_ms: 15.142679298296574
2025-03-13 12:51:48,804 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:51:48,804 [INFO]: 	nb vectors: 5799
2025-03-13 12:51:48,804 [INFO]: 	vectors dimension: 49152
2025-03-13 12:51:48,804 [INFO]: 	compression ratio: 0.9993081910830329
2025-03-13 12:51:48,804 [INFO]: }
2025-03-13 12:51:48,804 [INFO]: 	>>> Finished "Creating the index" in 85.1444 secs
2025-03-13 12:51:48,804 [INFO]: >>> Finished "Launching the whole pipeline" in 85.1795 secs
2025-03-13 12:51:50: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:51:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 21253 [episode count 9/20]
[retrieval_preprocessing] for episode 89861 [episode count 10/20], we have num_retrieval=np.int64(5867) num_query=np.int64(244)
2025-03-13 12:51:52,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:51:53,682 [INFO]: Launching the whole pipeline 03/13/2025, 12:51:53
2025-03-13 12:51:53,682 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:51:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.33it/s]
2025-03-13 12:51:53,713 [INFO]: There are 5867 embeddings of dim 49152
2025-03-13 12:51:53,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-13 12:51:53,713 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:51:53
2025-03-13 12:51:53,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:51:53,713 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:51:53,713 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:51:53,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:51:53,713 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:51:53
2025-03-13 12:51:53,713 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:51:53,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:51:53,713 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:51:53
2025-03-13 12:51:53,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:51:53,713 [INFO]: 	Creating the index 03/13/2025, 12:51:53
2025-03-13 12:51:53,713 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:51:53
2025-03-13 12:51:53,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 12:51:53,714 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:51:53
2025-03-13 12:51:53,714 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:51:53,715 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  9.10it/s] 24%|██▍       | 6/25 [00:00<00:00, 29.71it/s] 44%|████▍     | 11/25 [00:00<00:00, 38.08it/s] 68%|██████▊   | 17/25 [00:00<00:00, 43.47it/s] 88%|████████▊ | 22/25 [00:04<00:00,  3.51it/s]100%|██████████| 25/25 [00:05<00:00,  2.95it/s]100%|██████████| 25/25 [00:05<00:00,  4.42it/s]
2025-03-13 12:51:59,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:51:59
2025-03-13 12:52:47,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9218 secs
2025-03-13 12:52:47,297 [INFO]: The best hyperparameters are: efSearch=325
2025-03-13 12:52:47,297 [INFO]: 	Compute fast metrics 03/13/2025, 12:52:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:08,  2.93s/it] 50%|█████     | 2/4 [00:06<00:07,  3.54s/it] 75%|███████▌  | 3/4 [00:10<00:03,  3.48s/it] 75%|███████▌  | 3/4 [00:12<00:04,  4.32s/it]
2025-03-13 12:53:22,265 [INFO]: 	>>> Finished "Compute fast metrics" in 34.9678 secs
2025-03-13 12:53:22,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5516 secs
2025-03-13 12:53:22,266 [INFO]: {
2025-03-13 12:53:22,266 [INFO]: 	index_key: HNSW15
2025-03-13 12:53:22,266 [INFO]: 	index_param: efSearch=325
2025-03-13 12:53:22,266 [INFO]: 	index_path: knn.index
2025-03-13 12:53:22,266 [INFO]: 	size in bytes: 1154297650
2025-03-13 12:53:22,266 [INFO]: 	avg_search_speed_ms: 11.615080179692042
2025-03-13 12:53:22,266 [INFO]: 	99p_search_speed_ms: 15.567347221076488
2025-03-13 12:53:22,266 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:53:22,266 [INFO]: 	nb vectors: 5867
2025-03-13 12:53:22,266 [INFO]: 	vectors dimension: 49152
2025-03-13 12:53:22,266 [INFO]: 	compression ratio: 0.9993082252224978
2025-03-13 12:53:22,266 [INFO]: }
2025-03-13 12:53:22,266 [INFO]: 	>>> Finished "Creating the index" in 88.5530 secs
2025-03-13 12:53:22,266 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5843 secs
2025-03-13 12:53:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:53:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 89861 [episode count 10/20]
[retrieval_preprocessing] for episode 39225 [episode count 11/20], we have num_retrieval=np.int64(5822) num_query=np.int64(289)
2025-03-13 12:53:25,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:53:26,815 [INFO]: Launching the whole pipeline 03/13/2025, 12:53:26
2025-03-13 12:53:26,815 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:53:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.54it/s]
2025-03-13 12:53:26,848 [INFO]: There are 5822 embeddings of dim 49152
2025-03-13 12:53:26,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-13 12:53:26,848 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:53:26
2025-03-13 12:53:26,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:53:26,848 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:53:26,848 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:53:26,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:53:26,848 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:53:26
2025-03-13 12:53:26,849 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:53:26,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:53:26,849 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:53:26
2025-03-13 12:53:26,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:53:26,849 [INFO]: 	Creating the index 03/13/2025, 12:53:26
2025-03-13 12:53:26,849 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:53:26
2025-03-13 12:53:26,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:53:26,850 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:53:26
2025-03-13 12:53:26,850 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:53:26,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.72it/s] 29%|██▉       | 7/24 [00:00<00:00, 31.90it/s] 54%|█████▍    | 13/24 [00:00<00:00, 43.10it/s] 79%|███████▉  | 19/24 [00:00<00:00, 48.98it/s]100%|██████████| 24/24 [00:05<00:00,  4.65it/s]
2025-03-13 12:53:32,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:53:32
2025-03-13 12:54:27,882 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.8669 secs
2025-03-13 12:54:27,882 [INFO]: The best hyperparameters are: efSearch=265
2025-03-13 12:54:27,882 [INFO]: 	Compute fast metrics 03/13/2025, 12:54:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.06it/s]
2025-03-13 12:54:57,762 [INFO]: 	>>> Finished "Compute fast metrics" in 29.8797 secs
2025-03-13 12:54:57,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.9123 secs
2025-03-13 12:54:57,763 [INFO]: {
2025-03-13 12:54:57,763 [INFO]: 	index_key: HNSW15
2025-03-13 12:54:57,763 [INFO]: 	index_param: efSearch=265
2025-03-13 12:54:57,763 [INFO]: 	index_path: knn.index
2025-03-13 12:54:57,763 [INFO]: 	size in bytes: 1145444170
2025-03-13 12:54:57,763 [INFO]: 	avg_search_speed_ms: 12.550201596530947
2025-03-13 12:54:57,763 [INFO]: 	99p_search_speed_ms: 19.853573916479945
2025-03-13 12:54:57,763 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:54:57,763 [INFO]: 	nb vectors: 5822
2025-03-13 12:54:57,763 [INFO]: 	vectors dimension: 49152
2025-03-13 12:54:57,763 [INFO]: 	compression ratio: 0.9993082211942289
2025-03-13 12:54:57,763 [INFO]: }
2025-03-13 12:54:57,763 [INFO]: 	>>> Finished "Creating the index" in 90.9139 secs
2025-03-13 12:54:57,763 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9474 secs
2025-03-13 12:54:59: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:55:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 39225 [episode count 11/20]
[retrieval_preprocessing] for episode 63790 [episode count 12/20], we have num_retrieval=np.int64(5807) num_query=np.int64(304)
2025-03-13 12:55:01,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:55:02,620 [INFO]: Launching the whole pipeline 03/13/2025, 12:55:02
2025-03-13 12:55:02,620 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:55:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]
2025-03-13 12:55:02,657 [INFO]: There are 5807 embeddings of dim 49152
2025-03-13 12:55:02,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0372 secs
2025-03-13 12:55:02,658 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:55:02
2025-03-13 12:55:02,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:55:02,658 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:55:02,658 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:55:02,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 12:55:02,659 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:55:02
2025-03-13 12:55:02,659 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:55:02,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-13 12:55:02,660 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:55:02
2025-03-13 12:55:02,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:55:02,660 [INFO]: 	Creating the index 03/13/2025, 12:55:02
2025-03-13 12:55:02,660 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:55:02
2025-03-13 12:55:02,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-13 12:55:02,663 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:55:02
2025-03-13 12:55:02,664 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:55:02,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 18.59it/s] 29%|██▉       | 7/24 [00:00<00:00, 35.47it/s] 46%|████▌     | 11/24 [00:00<00:00, 19.24it/s] 71%|███████   | 17/24 [00:00<00:00, 27.98it/s] 88%|████████▊ | 21/24 [00:03<00:00,  3.38it/s]100%|██████████| 24/24 [00:08<00:00,  1.57it/s]100%|██████████| 24/24 [00:08<00:00,  2.70it/s]
2025-03-13 12:55:11,550 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:55:11
2025-03-13 12:55:59,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7012 secs
2025-03-13 12:55:59,252 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 12:55:59,252 [INFO]: 	Compute fast metrics 03/13/2025, 12:55:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.13it/s]
2025-03-13 12:56:25,960 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7081 secs
2025-03-13 12:56:26,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.4113 secs
2025-03-13 12:56:26,075 [INFO]: {
2025-03-13 12:56:26,075 [INFO]: 	index_key: HNSW15
2025-03-13 12:56:26,075 [INFO]: 	index_param: efSearch=297
2025-03-13 12:56:26,075 [INFO]: 	index_path: knn.index
2025-03-13 12:56:26,076 [INFO]: 	size in bytes: 1142493010
2025-03-13 12:56:26,076 [INFO]: 	avg_search_speed_ms: 12.299158968097847
2025-03-13 12:56:26,076 [INFO]: 	99p_search_speed_ms: 19.614312248304486
2025-03-13 12:56:26,076 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:56:26,076 [INFO]: 	nb vectors: 5807
2025-03-13 12:56:26,076 [INFO]: 	vectors dimension: 49152
2025-03-13 12:56:26,076 [INFO]: 	compression ratio: 0.9993082198375989
2025-03-13 12:56:26,076 [INFO]: }
2025-03-13 12:56:26,076 [INFO]: 	>>> Finished "Creating the index" in 83.4159 secs
2025-03-13 12:56:26,076 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4556 secs
2025-03-13 12:56:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:56:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 63790 [episode count 12/20]
[retrieval_preprocessing] for episode 69608 [episode count 13/20], we have num_retrieval=np.int64(5853) num_query=np.int64(258)
2025-03-13 12:56:30,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:56:31,374 [INFO]: Launching the whole pipeline 03/13/2025, 12:56:31
2025-03-13 12:56:31,374 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:56:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.38it/s]
2025-03-13 12:56:31,405 [INFO]: There are 5853 embeddings of dim 49152
2025-03-13 12:56:31,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-13 12:56:31,406 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:56:31
2025-03-13 12:56:31,406 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:56:31,406 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:56:31,406 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:56:31,406 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-13 12:56:31,406 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:56:31
2025-03-13 12:56:31,406 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:56:31,406 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:56:31,406 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:56:31
2025-03-13 12:56:31,406 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:56:31,406 [INFO]: 	Creating the index 03/13/2025, 12:56:31
2025-03-13 12:56:31,407 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:56:31
2025-03-13 12:56:31,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 12:56:31,408 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:56:31
2025-03-13 12:56:31,408 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:56:31,408 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.11it/s] 24%|██▍       | 6/25 [00:00<00:00, 27.37it/s] 44%|████▍     | 11/25 [00:00<00:00, 35.07it/s] 64%|██████▍   | 16/25 [00:00<00:00, 38.97it/s] 84%|████████▍ | 21/25 [00:04<00:01,  3.09it/s]100%|██████████| 25/25 [00:05<00:00,  3.08it/s]100%|██████████| 25/25 [00:05<00:00,  4.34it/s]
2025-03-13 12:56:37,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:56:37
2025-03-13 12:57:40,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.1690 secs
2025-03-13 12:57:40,338 [INFO]: The best hyperparameters are: efSearch=274
2025-03-13 12:57:40,338 [INFO]: 	Compute fast metrics 03/13/2025, 12:57:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.13it/s]
2025-03-13 12:58:13,841 [INFO]: 	>>> Finished "Compute fast metrics" in 33.5023 secs
2025-03-13 12:58:14,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.2277 secs
2025-03-13 12:58:14,637 [INFO]: {
2025-03-13 12:58:14,637 [INFO]: 	index_key: HNSW15
2025-03-13 12:58:14,637 [INFO]: 	index_param: efSearch=274
2025-03-13 12:58:14,637 [INFO]: 	index_path: knn.index
2025-03-13 12:58:14,637 [INFO]: 	size in bytes: 1151543170
2025-03-13 12:58:14,637 [INFO]: 	avg_search_speed_ms: 13.13102141779229
2025-03-13 12:58:14,637 [INFO]: 	99p_search_speed_ms: 19.60427132900804
2025-03-13 12:58:14,637 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:58:14,637 [INFO]: 	nb vectors: 5853
2025-03-13 12:58:14,637 [INFO]: 	vectors dimension: 49152
2025-03-13 12:58:14,637 [INFO]: 	compression ratio: 0.9993082795150442
2025-03-13 12:58:14,637 [INFO]: }
2025-03-13 12:58:14,637 [INFO]: 	>>> Finished "Creating the index" in 103.2308 secs
2025-03-13 12:58:14,637 [INFO]: >>> Finished "Launching the whole pipeline" in 103.2636 secs
2025-03-13 12:58:16: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:58:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 69608 [episode count 13/20]
[retrieval_preprocessing] for episode 82833 [episode count 14/20], we have num_retrieval=np.int64(5794) num_query=np.int64(317)
2025-03-13 12:58:19,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:58:20,629 [INFO]: Launching the whole pipeline 03/13/2025, 12:58:20
2025-03-13 12:58:20,629 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:58:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-13 12:58:20,656 [INFO]: There are 5794 embeddings of dim 49152
2025-03-13 12:58:20,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-13 12:58:20,656 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:58:20
2025-03-13 12:58:20,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:58:20,656 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:58:20,656 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:58:20,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:58:20,656 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:58:20
2025-03-13 12:58:20,657 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:58:20,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 12:58:20,657 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:58:20
2025-03-13 12:58:20,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:58:20,657 [INFO]: 	Creating the index 03/13/2025, 12:58:20
2025-03-13 12:58:20,657 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:58:20
2025-03-13 12:58:20,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 12:58:20,658 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:58:20
2025-03-13 12:58:20,658 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:58:20,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.07it/s] 12%|█▎        | 3/24 [00:00<00:02, 10.16it/s] 21%|██        | 5/24 [00:00<00:01, 11.57it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.36it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.39it/s] 46%|████▌     | 11/24 [00:00<00:01, 11.69it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.15it/s] 62%|██████▎   | 15/24 [00:01<00:00, 10.57it/s] 71%|███████   | 17/24 [00:01<00:00, 10.35it/s] 79%|███████▉  | 19/24 [00:01<00:00, 10.50it/s] 88%|████████▊ | 21/24 [00:06<00:02,  1.23it/s] 92%|█████████▏| 22/24 [00:06<00:01,  1.46it/s]100%|██████████| 24/24 [00:08<00:00,  1.29it/s]100%|██████████| 24/24 [00:08<00:00,  2.78it/s]
2025-03-13 12:58:29,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 12:58:29
2025-03-13 12:59:30,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.7535 secs
2025-03-13 12:59:30,056 [INFO]: The best hyperparameters are: efSearch=253
2025-03-13 12:59:30,056 [INFO]: 	Compute fast metrics 03/13/2025, 12:59:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.64it/s]
2025-03-13 12:59:50,899 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8430 secs
2025-03-13 12:59:50,900 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.2422 secs
2025-03-13 12:59:50,900 [INFO]: {
2025-03-13 12:59:50,900 [INFO]: 	index_key: HNSW15
2025-03-13 12:59:50,900 [INFO]: 	index_param: efSearch=253
2025-03-13 12:59:50,901 [INFO]: 	index_path: knn.index
2025-03-13 12:59:50,901 [INFO]: 	size in bytes: 1139935390
2025-03-13 12:59:50,901 [INFO]: 	avg_search_speed_ms: 12.897576823109581
2025-03-13 12:59:50,901 [INFO]: 	99p_search_speed_ms: 23.805539277382195
2025-03-13 12:59:50,901 [INFO]: 	reconstruction error %: 0.0
2025-03-13 12:59:50,901 [INFO]: 	nb vectors: 5794
2025-03-13 12:59:50,901 [INFO]: 	vectors dimension: 49152
2025-03-13 12:59:50,901 [INFO]: 	compression ratio: 0.9993081730711071
2025-03-13 12:59:50,901 [INFO]: }
2025-03-13 12:59:50,901 [INFO]: 	>>> Finished "Creating the index" in 90.2439 secs
2025-03-13 12:59:50,901 [INFO]: >>> Finished "Launching the whole pipeline" in 90.2716 secs
2025-03-13 12:59:52: [retrieval_preprocessing] calculating distances ...
2025-03-13 12:59:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 82833 [episode count 14/20]
[retrieval_preprocessing] for episode 36763 [episode count 15/20], we have num_retrieval=np.int64(5863) num_query=np.int64(248)
2025-03-13 12:59:54,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 12:59:55,111 [INFO]: Launching the whole pipeline 03/13/2025, 12:59:55
2025-03-13 12:59:55,111 [INFO]: Reading total number of vectors and dimension 03/13/2025, 12:59:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.57it/s]
2025-03-13 12:59:55,140 [INFO]: There are 5863 embeddings of dim 49152
2025-03-13 12:59:55,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-13 12:59:55,141 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 12:59:55
2025-03-13 12:59:55,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 12:59:55,141 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 12:59:55,141 [INFO]: 		Total: 16.7 minutes
2025-03-13 12:59:55,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 12:59:55,141 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 12:59:55
2025-03-13 12:59:55,141 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 12:59:55,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 12:59:55,141 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 12:59:55
2025-03-13 12:59:55,141 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 12:59:55,141 [INFO]: 	Creating the index 03/13/2025, 12:59:55
2025-03-13 12:59:55,141 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 12:59:55
2025-03-13 12:59:55,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 12:59:55,142 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 12:59:55
2025-03-13 12:59:55,142 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 12:59:55,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.53it/s] 28%|██▊       | 7/25 [00:00<00:00, 33.49it/s] 52%|█████▏    | 13/25 [00:00<00:00, 43.29it/s] 76%|███████▌  | 19/25 [00:00<00:00, 48.33it/s] 96%|█████████▌| 24/25 [00:03<00:00,  3.88it/s]100%|██████████| 25/25 [00:05<00:00,  4.73it/s]
2025-03-13 13:00:00,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:00:00
2025-03-13 13:00:47,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7052 secs
2025-03-13 13:00:47,138 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 13:00:47,138 [INFO]: 	Compute fast metrics 03/13/2025, 13:00:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-13 13:01:07,508 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3700 secs
2025-03-13 13:01:07,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3665 secs
2025-03-13 13:01:07,509 [INFO]: {
2025-03-13 13:01:07,509 [INFO]: 	index_key: HNSW15
2025-03-13 13:01:07,509 [INFO]: 	index_param: efSearch=255
2025-03-13 13:01:07,509 [INFO]: 	index_path: knn.index
2025-03-13 13:01:07,509 [INFO]: 	size in bytes: 1153510630
2025-03-13 13:01:07,509 [INFO]: 	avg_search_speed_ms: 10.341713620559721
2025-03-13 13:01:07,509 [INFO]: 	99p_search_speed_ms: 14.451117566786708
2025-03-13 13:01:07,509 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:01:07,509 [INFO]: 	nb vectors: 5863
2025-03-13 13:01:07,509 [INFO]: 	vectors dimension: 49152
2025-03-13 13:01:07,509 [INFO]: 	compression ratio: 0.9993082629849713
2025-03-13 13:01:07,509 [INFO]: }
2025-03-13 13:01:07,509 [INFO]: 	>>> Finished "Creating the index" in 72.3680 secs
2025-03-13 13:01:07,509 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3983 secs
2025-03-13 13:01:09: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:01:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 36763 [episode count 15/20]
[retrieval_preprocessing] for episode 64414 [episode count 16/20], we have num_retrieval=np.int64(5884) num_query=np.int64(227)
2025-03-13 13:01:10,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:01:11,315 [INFO]: Launching the whole pipeline 03/13/2025, 13:01:11
2025-03-13 13:01:11,315 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:01:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-13 13:01:11,343 [INFO]: There are 5884 embeddings of dim 49152
2025-03-13 13:01:11,343 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-13 13:01:11,343 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:01:11
2025-03-13 13:01:11,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:01:11,343 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 13:01:11,343 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:01:11,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:01:11,343 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:01:11
2025-03-13 13:01:11,343 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:01:11,344 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:01:11,344 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:01:11
2025-03-13 13:01:11,344 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:01:11,344 [INFO]: 	Creating the index 03/13/2025, 13:01:11
2025-03-13 13:01:11,344 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:01:11
2025-03-13 13:01:11,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:01:11,345 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:01:11
2025-03-13 13:01:11,345 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 13:01:11,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.20it/s] 24%|██▍       | 6/25 [00:00<00:00, 30.26it/s] 48%|████▊     | 12/25 [00:00<00:00, 39.74it/s] 68%|██████▊   | 17/25 [00:00<00:00, 43.44it/s] 88%|████████▊ | 22/25 [00:04<00:00,  3.42it/s]100%|██████████| 25/25 [00:05<00:00,  2.97it/s]100%|██████████| 25/25 [00:05<00:00,  4.47it/s]
2025-03-13 13:01:16,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:01:16
2025-03-13 13:02:13,793 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8533 secs
2025-03-13 13:02:13,794 [INFO]: The best hyperparameters are: efSearch=215
2025-03-13 13:02:13,794 [INFO]: 	Compute fast metrics 03/13/2025, 13:02:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.62it/s]
2025-03-13 13:02:37,165 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3710 secs
2025-03-13 13:02:37,166 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.8215 secs
2025-03-13 13:02:37,166 [INFO]: {
2025-03-13 13:02:37,166 [INFO]: 	index_key: HNSW15
2025-03-13 13:02:37,166 [INFO]: 	index_param: efSearch=215
2025-03-13 13:02:37,166 [INFO]: 	index_path: knn.index
2025-03-13 13:02:37,166 [INFO]: 	size in bytes: 1157642230
2025-03-13 13:02:37,166 [INFO]: 	avg_search_speed_ms: 8.971939445995295
2025-03-13 13:02:37,166 [INFO]: 	99p_search_speed_ms: 12.17158074490726
2025-03-13 13:02:37,166 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:02:37,166 [INFO]: 	nb vectors: 5884
2025-03-13 13:02:37,166 [INFO]: 	vectors dimension: 49152
2025-03-13 13:02:37,166 [INFO]: 	compression ratio: 0.9993082854277008
2025-03-13 13:02:37,166 [INFO]: }
2025-03-13 13:02:37,166 [INFO]: 	>>> Finished "Creating the index" in 85.8228 secs
2025-03-13 13:02:37,166 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8510 secs
2025-03-13 13:02:38: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:02:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 64414 [episode count 16/20]
[retrieval_preprocessing] for episode 68521 [episode count 17/20], we have num_retrieval=np.int64(5633) num_query=np.int64(478)
2025-03-13 13:02:39,618 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:02:40,376 [INFO]: Launching the whole pipeline 03/13/2025, 13:02:40
2025-03-13 13:02:40,376 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:02:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.05it/s]
2025-03-13 13:02:40,408 [INFO]: There are 5633 embeddings of dim 49152
2025-03-13 13:02:40,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-13 13:02:40,408 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:02:40
2025-03-13 13:02:40,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:02:40,409 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:02:40,409 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:02:40,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:02:40,409 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:02:40
2025-03-13 13:02:40,409 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:02:40,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:02:40,409 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:02:40
2025-03-13 13:02:40,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:02:40,409 [INFO]: 	Creating the index 03/13/2025, 13:02:40
2025-03-13 13:02:40,409 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:02:40
2025-03-13 13:02:40,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:02:40,410 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:02:40
2025-03-13 13:02:40,410 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:02:40,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.68it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.24it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.54it/s] 67%|██████▋   | 16/24 [00:00<00:00, 41.52it/s] 88%|████████▊ | 21/24 [00:03<00:00,  3.54it/s]100%|██████████| 24/24 [00:05<00:00,  3.27it/s]100%|██████████| 24/24 [00:05<00:00,  4.78it/s]
2025-03-13 13:02:45,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:02:45
2025-03-13 13:03:48,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.6819 secs
2025-03-13 13:03:48,111 [INFO]: The best hyperparameters are: efSearch=247
2025-03-13 13:03:48,111 [INFO]: 	Compute fast metrics 03/13/2025, 13:03:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.50s/it] 50%|█████     | 2/4 [00:07<00:07,  3.68s/it] 75%|███████▌  | 3/4 [00:15<00:05,  5.66s/it] 75%|███████▌  | 3/4 [00:16<00:05,  5.42s/it]
2025-03-13 13:04:23,853 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7415 secs
2025-03-13 13:04:23,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.4440 secs
2025-03-13 13:04:23,854 [INFO]: {
2025-03-13 13:04:23,854 [INFO]: 	index_key: HNSW15
2025-03-13 13:04:23,854 [INFO]: 	index_param: efSearch=247
2025-03-13 13:04:23,854 [INFO]: 	index_path: knn.index
2025-03-13 13:04:23,854 [INFO]: 	size in bytes: 1108259770
2025-03-13 13:04:23,854 [INFO]: 	avg_search_speed_ms: 10.16463046539499
2025-03-13 13:04:23,854 [INFO]: 	99p_search_speed_ms: 15.9254760830663
2025-03-13 13:04:23,854 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:04:23,854 [INFO]: 	nb vectors: 5633
2025-03-13 13:04:23,854 [INFO]: 	vectors dimension: 49152
2025-03-13 13:04:23,854 [INFO]: 	compression ratio: 0.9993080088073575
2025-03-13 13:04:23,854 [INFO]: }
2025-03-13 13:04:23,854 [INFO]: 	>>> Finished "Creating the index" in 103.4454 secs
2025-03-13 13:04:23,854 [INFO]: >>> Finished "Launching the whole pipeline" in 103.4782 secs
2025-03-13 13:04:26: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:04:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 68521 [episode count 17/20]
[retrieval_preprocessing] for episode 85940 [episode count 18/20], we have num_retrieval=np.int64(5776) num_query=np.int64(335)
2025-03-13 13:04:35,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:04:36,321 [INFO]: Launching the whole pipeline 03/13/2025, 13:04:36
2025-03-13 13:04:36,321 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 941.91it/s]
2025-03-13 13:04:36,355 [INFO]: There are 5776 embeddings of dim 49152
2025-03-13 13:04:36,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-13 13:04:36,355 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:04:36,355 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 13:04:36,355 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:04:36,355 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:04:36,355 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,355 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:04:36,355 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:04:36,355 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:04:36
2025-03-13 13:04:36,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:04:36,356 [INFO]: 	Creating the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,356 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:04:36
2025-03-13 13:04:36,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:04:36,357 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:04:36
2025-03-13 13:04:36,357 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 13:04:36,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.44it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.60it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.76it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.24it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.29it/s]100%|██████████| 24/24 [00:06<00:00,  2.29it/s]100%|██████████| 24/24 [00:06<00:00,  3.58it/s]
2025-03-13 13:04:43,061 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:04:43
2025-03-13 13:05:41,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9549 secs
2025-03-13 13:05:41,017 [INFO]: The best hyperparameters are: efSearch=281
2025-03-13 13:05:41,017 [INFO]: 	Compute fast metrics 03/13/2025, 13:05:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.77it/s]
2025-03-13 13:06:08,870 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8531 secs
2025-03-13 13:06:08,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.5144 secs
2025-03-13 13:06:08,871 [INFO]: {
2025-03-13 13:06:08,871 [INFO]: 	index_key: HNSW15
2025-03-13 13:06:08,871 [INFO]: 	index_param: efSearch=281
2025-03-13 13:06:08,871 [INFO]: 	index_path: knn.index
2025-03-13 13:06:08,871 [INFO]: 	size in bytes: 1136393950
2025-03-13 13:06:08,871 [INFO]: 	avg_search_speed_ms: 11.638015488323097
2025-03-13 13:06:08,872 [INFO]: 	99p_search_speed_ms: 15.508850570768116
2025-03-13 13:06:08,872 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:06:08,872 [INFO]: 	nb vectors: 5776
2025-03-13 13:06:08,872 [INFO]: 	vectors dimension: 49152
2025-03-13 13:06:08,872 [INFO]: 	compression ratio: 0.9993082134940968
2025-03-13 13:06:08,872 [INFO]: }
2025-03-13 13:06:08,872 [INFO]: 	>>> Finished "Creating the index" in 92.5160 secs
2025-03-13 13:06:08,872 [INFO]: >>> Finished "Launching the whole pipeline" in 92.5505 secs
2025-03-13 13:06:11: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:06:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 85940 [episode count 18/20]
[retrieval_preprocessing] for episode 57732 [episode count 19/20], we have num_retrieval=np.int64(5739) num_query=np.int64(372)
2025-03-13 13:06:16,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:06:17,288 [INFO]: Launching the whole pipeline 03/13/2025, 13:06:17
2025-03-13 13:06:17,288 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:06:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.80it/s]
2025-03-13 13:06:17,321 [INFO]: There are 5739 embeddings of dim 49152
2025-03-13 13:06:17,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-13 13:06:17,322 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:06:17
2025-03-13 13:06:17,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:06:17,322 [INFO]: 		-> Add: 3.2 seconds
2025-03-13 13:06:17,322 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:06:17,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:06:17,322 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:06:17
2025-03-13 13:06:17,322 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:06:17,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:06:17,322 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:06:17
2025-03-13 13:06:17,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:06:17,322 [INFO]: 	Creating the index 03/13/2025, 13:06:17
2025-03-13 13:06:17,322 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:06:17
2025-03-13 13:06:17,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:06:17,324 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:06:17
2025-03-13 13:06:17,324 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-13 13:06:17,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.31it/s] 29%|██▉       | 7/24 [00:00<00:00, 31.67it/s] 54%|█████▍    | 13/24 [00:00<00:00, 40.97it/s] 79%|███████▉  | 19/24 [00:00<00:00, 45.60it/s]100%|██████████| 24/24 [00:05<00:00,  2.77it/s]100%|██████████| 24/24 [00:05<00:00,  4.38it/s]
2025-03-13 13:06:22,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:06:22
2025-03-13 13:07:11,626 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8157 secs
2025-03-13 13:07:11,626 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 13:07:11,626 [INFO]: 	Compute fast metrics 03/13/2025, 13:07:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.50it/s]
2025-03-13 13:07:33,702 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0758 secs
2025-03-13 13:07:33,703 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3789 secs
2025-03-13 13:07:33,703 [INFO]: {
2025-03-13 13:07:33,703 [INFO]: 	index_key: HNSW15
2025-03-13 13:07:33,703 [INFO]: 	index_param: efSearch=261
2025-03-13 13:07:33,703 [INFO]: 	index_path: knn.index
2025-03-13 13:07:33,703 [INFO]: 	size in bytes: 1129114510
2025-03-13 13:07:33,703 [INFO]: 	avg_search_speed_ms: 13.666983998553635
2025-03-13 13:07:33,703 [INFO]: 	99p_search_speed_ms: 23.23916529305279
2025-03-13 13:07:33,703 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:07:33,703 [INFO]: 	nb vectors: 5739
2025-03-13 13:07:33,703 [INFO]: 	vectors dimension: 49152
2025-03-13 13:07:33,703 [INFO]: 	compression ratio: 0.9993081321751857
2025-03-13 13:07:33,703 [INFO]: }
2025-03-13 13:07:33,703 [INFO]: 	>>> Finished "Creating the index" in 76.3805 secs
2025-03-13 13:07:33,703 [INFO]: >>> Finished "Launching the whole pipeline" in 76.4145 secs
2025-03-13 13:07:36: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:07:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 57732 [episode count 19/20]
2025-03-13 13:07:37: [retrieval_preprocessing] finished for 3951366978_put_lid_on_kettle [chosen_id count 6/260]
2025-03-13 13:07:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for 3951366978_put_lid_on_teapot [chosen_id count 7/260]
2025-03-13 13:07:39: [retrieval_preprocessing] we have num_total=5867 embedding_dim=49152
[retrieval_preprocessing] for episode 21019 [episode count 0/20], we have num_retrieval=np.int64(5581) num_query=np.int64(286)
2025-03-13 13:07:40,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:07:41,601 [INFO]: Launching the whole pipeline 03/13/2025, 13:07:41
2025-03-13 13:07:41,602 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:07:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.98it/s]
2025-03-13 13:07:41,635 [INFO]: There are 5581 embeddings of dim 49152
2025-03-13 13:07:41,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-13 13:07:41,635 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:07:41
2025-03-13 13:07:41,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:07:41,635 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:07:41,635 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:07:41,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:07:41,636 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:07:41
2025-03-13 13:07:41,636 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:07:41,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:07:41,636 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:07:41
2025-03-13 13:07:41,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:07:41,636 [INFO]: 	Creating the index 03/13/2025, 13:07:41
2025-03-13 13:07:41,636 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:07:41
2025-03-13 13:07:41,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:07:41,637 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:07:41
2025-03-13 13:07:41,638 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:07:41,638 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.12it/s] 17%|█▋        | 4/23 [00:00<00:01, 17.05it/s] 35%|███▍      | 8/23 [00:00<00:00, 24.89it/s] 57%|█████▋    | 13/23 [00:00<00:00, 31.27it/s] 78%|███████▊  | 18/23 [00:00<00:00, 34.95it/s] 96%|█████████▌| 22/23 [00:05<00:00,  2.52it/s]100%|██████████| 23/23 [00:06<00:00,  3.45it/s]
2025-03-13 13:07:48,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:07:48
2025-03-13 13:08:45,604 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2952 secs
2025-03-13 13:08:45,604 [INFO]: The best hyperparameters are: efSearch=207
2025-03-13 13:08:45,604 [INFO]: 	Compute fast metrics 03/13/2025, 13:08:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-13 13:09:07,243 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6394 secs
2025-03-13 13:09:07,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.6065 secs
2025-03-13 13:09:07,244 [INFO]: {
2025-03-13 13:09:07,244 [INFO]: 	index_key: HNSW15
2025-03-13 13:09:07,244 [INFO]: 	index_param: efSearch=207
2025-03-13 13:09:07,244 [INFO]: 	index_path: knn.index
2025-03-13 13:09:07,244 [INFO]: 	size in bytes: 1098029170
2025-03-13 13:09:07,244 [INFO]: 	avg_search_speed_ms: 10.14853784772917
2025-03-13 13:09:07,244 [INFO]: 	99p_search_speed_ms: 13.377207086887209
2025-03-13 13:09:07,244 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:09:07,244 [INFO]: 	nb vectors: 5581
2025-03-13 13:09:07,244 [INFO]: 	vectors dimension: 49152
2025-03-13 13:09:07,244 [INFO]: 	compression ratio: 0.9993079218469214
2025-03-13 13:09:07,244 [INFO]: }
2025-03-13 13:09:07,244 [INFO]: 	>>> Finished "Creating the index" in 85.6082 secs
2025-03-13 13:09:07,244 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6427 secs
2025-03-13 13:09:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:09:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 21019 [episode count 0/20]
[retrieval_preprocessing] for episode 84008 [episode count 1/20], we have num_retrieval=np.int64(5570) num_query=np.int64(297)
2025-03-13 13:09:09,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:09:10,542 [INFO]: Launching the whole pipeline 03/13/2025, 13:09:10
2025-03-13 13:09:10,542 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:09:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-13 13:09:10,569 [INFO]: There are 5570 embeddings of dim 49152
2025-03-13 13:09:10,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 13:09:10,569 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:09:10
2025-03-13 13:09:10,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:09:10,569 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:09:10,570 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:09:10,570 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:09:10,570 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:09:10
2025-03-13 13:09:10,570 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:09:10,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:09:10,570 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:09:10
2025-03-13 13:09:10,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:09:10,570 [INFO]: 	Creating the index 03/13/2025, 13:09:10
2025-03-13 13:09:10,570 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:09:10
2025-03-13 13:09:10,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-13 13:09:10,571 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:09:10
2025-03-13 13:09:10,571 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:09:10,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.31it/s] 26%|██▌       | 6/23 [00:00<00:00, 28.38it/s] 48%|████▊     | 11/23 [00:00<00:00, 36.75it/s] 70%|██████▉   | 16/23 [00:00<00:00, 40.93it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.19it/s]100%|██████████| 23/23 [00:05<00:00,  4.29it/s]
2025-03-13 13:09:15,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:09:15
2025-03-13 13:10:07,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8868 secs
2025-03-13 13:10:07,819 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 13:10:07,819 [INFO]: 	Compute fast metrics 03/13/2025, 13:10:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.30it/s]
2025-03-13 13:10:40,525 [INFO]: 	>>> Finished "Compute fast metrics" in 32.7051 secs
2025-03-13 13:10:40,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.9545 secs
2025-03-13 13:10:40,526 [INFO]: {
2025-03-13 13:10:40,526 [INFO]: 	index_key: HNSW15
2025-03-13 13:10:40,526 [INFO]: 	index_param: efSearch=277
2025-03-13 13:10:40,526 [INFO]: 	index_path: knn.index
2025-03-13 13:10:40,526 [INFO]: 	size in bytes: 1095864910
2025-03-13 13:10:40,526 [INFO]: 	avg_search_speed_ms: 14.99666012426236
2025-03-13 13:10:40,526 [INFO]: 	99p_search_speed_ms: 23.30589756835252
2025-03-13 13:10:40,526 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:10:40,526 [INFO]: 	nb vectors: 5570
2025-03-13 13:10:40,526 [INFO]: 	vectors dimension: 49152
2025-03-13 13:10:40,526 [INFO]: 	compression ratio: 0.9993079895221757
2025-03-13 13:10:40,526 [INFO]: }
2025-03-13 13:10:40,526 [INFO]: 	>>> Finished "Creating the index" in 89.9559 secs
2025-03-13 13:10:40,526 [INFO]: >>> Finished "Launching the whole pipeline" in 89.9834 secs
2025-03-13 13:10:43: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:10:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 84008 [episode count 1/20]
[retrieval_preprocessing] for episode 44080 [episode count 2/20], we have num_retrieval=np.int64(5591) num_query=np.int64(276)
2025-03-13 13:10:45,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:10:46,490 [INFO]: Launching the whole pipeline 03/13/2025, 13:10:46
2025-03-13 13:10:46,491 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:10:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.73it/s]
2025-03-13 13:10:46,524 [INFO]: There are 5591 embeddings of dim 49152
2025-03-13 13:10:46,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-13 13:10:46,525 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:10:46
2025-03-13 13:10:46,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:10:46,525 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:10:46,525 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:10:46,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:10:46,525 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:10:46
2025-03-13 13:10:46,526 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:10:46,526 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:10:46,526 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:10:46
2025-03-13 13:10:46,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:10:46,526 [INFO]: 	Creating the index 03/13/2025, 13:10:46
2025-03-13 13:10:46,526 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:10:46
2025-03-13 13:10:46,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:10:46,527 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:10:46
2025-03-13 13:10:46,527 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:10:46,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.83it/s] 22%|██▏       | 5/23 [00:00<00:00, 22.30it/s] 39%|███▉      | 9/23 [00:00<00:00, 29.34it/s] 61%|██████    | 14/23 [00:00<00:00, 33.81it/s] 78%|███████▊  | 18/23 [00:00<00:00, 35.49it/s] 96%|█████████▌| 22/23 [00:05<00:00,  2.30it/s]100%|██████████| 23/23 [00:06<00:00,  3.50it/s]
2025-03-13 13:10:53,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:10:53
2025-03-13 13:11:42,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6756 secs
2025-03-13 13:11:42,780 [INFO]: The best hyperparameters are: efSearch=255
2025-03-13 13:11:42,780 [INFO]: 	Compute fast metrics 03/13/2025, 13:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-13 13:12:05,955 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1752 secs
2025-03-13 13:12:05,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4294 secs
2025-03-13 13:12:05,957 [INFO]: {
2025-03-13 13:12:05,957 [INFO]: 	index_key: HNSW15
2025-03-13 13:12:05,957 [INFO]: 	index_param: efSearch=255
2025-03-13 13:12:05,957 [INFO]: 	index_path: knn.index
2025-03-13 13:12:05,957 [INFO]: 	size in bytes: 1099996570
2025-03-13 13:12:05,957 [INFO]: 	avg_search_speed_ms: 11.180466898149868
2025-03-13 13:12:05,957 [INFO]: 	99p_search_speed_ms: 15.850359904579816
2025-03-13 13:12:05,957 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:12:05,957 [INFO]: 	nb vectors: 5591
2025-03-13 13:12:05,957 [INFO]: 	vectors dimension: 49152
2025-03-13 13:12:05,957 [INFO]: 	compression ratio: 0.9993079596602742
2025-03-13 13:12:05,957 [INFO]: }
2025-03-13 13:12:05,957 [INFO]: 	>>> Finished "Creating the index" in 79.4311 secs
2025-03-13 13:12:05,957 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4663 secs
2025-03-13 13:12:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:12:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 44080 [episode count 2/20]
[retrieval_preprocessing] for episode 43590 [episode count 3/20], we have num_retrieval=np.int64(5602) num_query=np.int64(265)
2025-03-13 13:12:09,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:12:10,444 [INFO]: Launching the whole pipeline 03/13/2025, 13:12:10
2025-03-13 13:12:10,444 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:12:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1451.82it/s]
2025-03-13 13:12:10,473 [INFO]: There are 5602 embeddings of dim 49152
2025-03-13 13:12:10,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-13 13:12:10,473 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:12:10
2025-03-13 13:12:10,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:12:10,473 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:12:10,473 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:12:10,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:12:10,473 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:12:10
2025-03-13 13:12:10,473 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:12:10,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:12:10,474 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:12:10
2025-03-13 13:12:10,474 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:12:10,474 [INFO]: 	Creating the index 03/13/2025, 13:12:10
2025-03-13 13:12:10,474 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:12:10
2025-03-13 13:12:10,475 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:12:10,475 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:12:10
2025-03-13 13:12:10,475 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:12:10,475 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.12it/s] 29%|██▉       | 7/24 [00:00<00:00, 32.74it/s] 54%|█████▍    | 13/24 [00:00<00:00, 42.00it/s] 79%|███████▉  | 19/24 [00:00<00:00, 46.61it/s]100%|██████████| 24/24 [00:11<00:00,  1.28it/s]100%|██████████| 24/24 [00:11<00:00,  2.08it/s]
2025-03-13 13:12:22,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:12:22
2025-03-13 13:13:12,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3778 secs
2025-03-13 13:13:12,396 [INFO]: The best hyperparameters are: efSearch=175
2025-03-13 13:13:12,397 [INFO]: 	Compute fast metrics 03/13/2025, 13:13:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-13 13:13:33,489 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0922 secs
2025-03-13 13:13:33,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0202 secs
2025-03-13 13:13:33,495 [INFO]: {
2025-03-13 13:13:33,495 [INFO]: 	index_key: HNSW15
2025-03-13 13:13:33,495 [INFO]: 	index_param: efSearch=175
2025-03-13 13:13:33,495 [INFO]: 	index_path: knn.index
2025-03-13 13:13:33,495 [INFO]: 	size in bytes: 1102160710
2025-03-13 13:13:33,495 [INFO]: 	avg_search_speed_ms: 10.82221540704055
2025-03-13 13:13:33,495 [INFO]: 	99p_search_speed_ms: 18.191203398164358
2025-03-13 13:13:33,495 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:13:33,495 [INFO]: 	nb vectors: 5602
2025-03-13 13:13:33,495 [INFO]: 	vectors dimension: 49152
2025-03-13 13:13:33,495 [INFO]: 	compression ratio: 0.9993080010990412
2025-03-13 13:13:33,495 [INFO]: }
2025-03-13 13:13:33,495 [INFO]: 	>>> Finished "Creating the index" in 83.0219 secs
2025-03-13 13:13:33,495 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0513 secs
2025-03-13 13:13:34: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:13:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 43590 [episode count 3/20]
[retrieval_preprocessing] for episode 71747 [episode count 4/20], we have num_retrieval=np.int64(5613) num_query=np.int64(254)
2025-03-13 13:13:37,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:13:38,846 [INFO]: Launching the whole pipeline 03/13/2025, 13:13:38
2025-03-13 13:13:38,846 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:13:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1440.85it/s]
2025-03-13 13:13:38,874 [INFO]: There are 5613 embeddings of dim 49152
2025-03-13 13:13:38,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-13 13:13:38,874 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:13:38
2025-03-13 13:13:38,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:13:38,874 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:13:38,874 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:13:38,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:13:38,875 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:13:38
2025-03-13 13:13:38,875 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:13:38,875 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:13:38,875 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:13:38
2025-03-13 13:13:38,875 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:13:38,875 [INFO]: 	Creating the index 03/13/2025, 13:13:38
2025-03-13 13:13:38,875 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:13:38
2025-03-13 13:13:38,876 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-13 13:13:38,877 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:13:38
2025-03-13 13:13:38,877 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:13:38,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.37it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.38it/s] 21%|██        | 5/24 [00:00<00:02,  9.42it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.00it/s] 38%|███▊      | 9/24 [00:00<00:01, 10.38it/s] 46%|████▌     | 11/24 [00:01<00:01, 10.41it/s] 54%|█████▍    | 13/24 [00:01<00:01, 10.48it/s] 62%|██████▎   | 15/24 [00:01<00:00, 10.60it/s] 71%|███████   | 17/24 [00:01<00:00, 11.56it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.34it/s] 88%|████████▊ | 21/24 [00:06<00:02,  1.34it/s] 92%|█████████▏| 22/24 [00:06<00:01,  1.59it/s]100%|██████████| 24/24 [00:07<00:00,  1.57it/s]100%|██████████| 24/24 [00:07<00:00,  3.13it/s]
2025-03-13 13:13:46,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:13:46
2025-03-13 13:14:27,704 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8272 secs
2025-03-13 13:14:27,704 [INFO]: The best hyperparameters are: efSearch=273
2025-03-13 13:14:27,704 [INFO]: 	Compute fast metrics 03/13/2025, 13:14:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-13 13:14:53,941 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2365 secs
2025-03-13 13:14:53,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.0647 secs
2025-03-13 13:14:53,941 [INFO]: {
2025-03-13 13:14:53,941 [INFO]: 	index_key: HNSW15
2025-03-13 13:14:53,941 [INFO]: 	index_param: efSearch=273
2025-03-13 13:14:53,941 [INFO]: 	index_path: knn.index
2025-03-13 13:14:53,941 [INFO]: 	size in bytes: 1104324910
2025-03-13 13:14:53,941 [INFO]: 	avg_search_speed_ms: 11.102926704958165
2025-03-13 13:14:53,941 [INFO]: 	99p_search_speed_ms: 15.822311863303185
2025-03-13 13:14:53,941 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:14:53,941 [INFO]: 	nb vectors: 5613
2025-03-13 13:14:53,941 [INFO]: 	vectors dimension: 49152
2025-03-13 13:14:53,941 [INFO]: 	compression ratio: 0.9993079880811526
2025-03-13 13:14:53,941 [INFO]: }
2025-03-13 13:14:53,941 [INFO]: 	>>> Finished "Creating the index" in 75.0665 secs
2025-03-13 13:14:53,942 [INFO]: >>> Finished "Launching the whole pipeline" in 75.0956 secs
2025-03-13 13:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 71747 [episode count 4/20]
[retrieval_preprocessing] for episode 26742 [episode count 5/20], we have num_retrieval=np.int64(5584) num_query=np.int64(283)
2025-03-13 13:15:01,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:15:02,346 [INFO]: Launching the whole pipeline 03/13/2025, 13:15:02
2025-03-13 13:15:02,346 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:15:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1626.33it/s]
2025-03-13 13:15:02,372 [INFO]: There are 5584 embeddings of dim 49152
2025-03-13 13:15:02,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-13 13:15:02,372 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:15:02
2025-03-13 13:15:02,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:15:02,372 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:15:02,372 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:15:02,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:15:02,372 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:15:02
2025-03-13 13:15:02,373 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:15:02,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:15:02,373 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:15:02
2025-03-13 13:15:02,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:15:02,373 [INFO]: 	Creating the index 03/13/2025, 13:15:02
2025-03-13 13:15:02,373 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:15:02
2025-03-13 13:15:02,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:15:02,374 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:15:02
2025-03-13 13:15:02,374 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:15:02,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.90it/s]  9%|▊         | 2/23 [00:00<00:03,  6.51it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.29it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.85it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.03it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.17it/s] 30%|███       | 7/23 [00:00<00:01,  8.23it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.26it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.38it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.38it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.38it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.33it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.35it/s] 61%|██████    | 14/23 [00:01<00:01,  8.75it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.50it/s] 78%|███████▊  | 18/23 [00:02<00:00, 10.02it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.25it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.31it/s]100%|██████████| 23/23 [00:07<00:00,  1.16it/s]100%|██████████| 23/23 [00:07<00:00,  3.01it/s]
2025-03-13 13:15:10,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:15:10
2025-03-13 13:16:00,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7286 secs
2025-03-13 13:16:00,760 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 13:16:00,760 [INFO]: 	Compute fast metrics 03/13/2025, 13:16:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 13:16:23,504 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7439 secs
2025-03-13 13:16:23,647 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2726 secs
2025-03-13 13:16:23,647 [INFO]: {
2025-03-13 13:16:23,647 [INFO]: 	index_key: HNSW15
2025-03-13 13:16:23,647 [INFO]: 	index_param: efSearch=261
2025-03-13 13:16:23,647 [INFO]: 	index_path: knn.index
2025-03-13 13:16:23,647 [INFO]: 	size in bytes: 1098619390
2025-03-13 13:16:23,647 [INFO]: 	avg_search_speed_ms: 9.424268849796206
2025-03-13 13:16:23,647 [INFO]: 	99p_search_speed_ms: 13.010896788910042
2025-03-13 13:16:23,647 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:16:23,647 [INFO]: 	nb vectors: 5584
2025-03-13 13:16:23,648 [INFO]: 	vectors dimension: 49152
2025-03-13 13:16:23,648 [INFO]: 	compression ratio: 0.9993079332051475
2025-03-13 13:16:23,648 [INFO]: }
2025-03-13 13:16:23,648 [INFO]: 	>>> Finished "Creating the index" in 81.2750 secs
2025-03-13 13:16:23,648 [INFO]: >>> Finished "Launching the whole pipeline" in 81.3017 secs
2025-03-13 13:16:25: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:16:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 26742 [episode count 5/20]
[retrieval_preprocessing] for episode 18598 [episode count 6/20], we have num_retrieval=np.int64(5514) num_query=np.int64(353)
2025-03-13 13:16:28,421 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:16:29,472 [INFO]: Launching the whole pipeline 03/13/2025, 13:16:29
2025-03-13 13:16:29,472 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:16:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1020.26it/s]
2025-03-13 13:16:29,499 [INFO]: There are 5514 embeddings of dim 49152
2025-03-13 13:16:29,500 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-13 13:16:29,500 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:16:29
2025-03-13 13:16:29,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:16:29,501 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 13:16:29,501 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:16:29,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-13 13:16:29,501 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:16:29
2025-03-13 13:16:29,502 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:16:29,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-13 13:16:29,502 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:16:29
2025-03-13 13:16:29,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:16:29,503 [INFO]: 	Creating the index 03/13/2025, 13:16:29
2025-03-13 13:16:29,503 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:16:29
2025-03-13 13:16:29,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-13 13:16:29,507 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:16:29
2025-03-13 13:16:29,507 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:16:29,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.02it/s]  9%|▊         | 2/23 [00:00<00:03,  6.81it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.67it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.16it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.44it/s] 26%|██▌       | 6/23 [00:00<00:01,  8.64it/s] 30%|███       | 7/23 [00:00<00:01,  8.89it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.18it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.63it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.48it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.36it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.17it/s] 61%|██████    | 14/23 [00:01<00:00,  9.07it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.99it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.86it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.90it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.86it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.88it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.96it/s] 91%|█████████▏| 21/23 [00:05<00:02,  1.07s/it]100%|██████████| 23/23 [00:06<00:00,  1.12it/s]100%|██████████| 23/23 [00:06<00:00,  3.29it/s]
2025-03-13 13:16:36,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:16:36
2025-03-13 13:17:18,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3601 secs
2025-03-13 13:17:18,860 [INFO]: The best hyperparameters are: efSearch=277
2025-03-13 13:17:18,860 [INFO]: 	Compute fast metrics 03/13/2025, 13:17:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-13 13:17:40,074 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2147 secs
2025-03-13 13:17:40,075 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5676 secs
2025-03-13 13:17:40,075 [INFO]: {
2025-03-13 13:17:40,075 [INFO]: 	index_key: HNSW15
2025-03-13 13:17:40,075 [INFO]: 	index_param: efSearch=277
2025-03-13 13:17:40,075 [INFO]: 	index_path: knn.index
2025-03-13 13:17:40,075 [INFO]: 	size in bytes: 1084847230
2025-03-13 13:17:40,075 [INFO]: 	avg_search_speed_ms: 11.075203172895533
2025-03-13 13:17:40,075 [INFO]: 	99p_search_speed_ms: 17.806818960234523
2025-03-13 13:17:40,075 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:17:40,075 [INFO]: 	nb vectors: 5514
2025-03-13 13:17:40,075 [INFO]: 	vectors dimension: 49152
2025-03-13 13:17:40,075 [INFO]: 	compression ratio: 0.9993079965738586
2025-03-13 13:17:40,075 [INFO]: }
2025-03-13 13:17:40,075 [INFO]: 	>>> Finished "Creating the index" in 70.5720 secs
2025-03-13 13:17:40,075 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6034 secs
2025-03-13 13:17:42: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:17:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 18598 [episode count 6/20]
[retrieval_preprocessing] for episode 14503 [episode count 7/20], we have num_retrieval=np.int64(5468) num_query=np.int64(399)
2025-03-13 13:17:49,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:17:50,815 [INFO]: Launching the whole pipeline 03/13/2025, 13:17:50
2025-03-13 13:17:50,816 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:17:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1878.33it/s]
2025-03-13 13:17:50,841 [INFO]: There are 5468 embeddings of dim 49152
2025-03-13 13:17:50,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-13 13:17:50,841 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:17:50,841 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 13:17:50,841 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:17:50,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:17:50,841 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,841 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:17:50,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:17:50,841 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:17:50
2025-03-13 13:17:50,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:17:50,841 [INFO]: 	Creating the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,841 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:17:50
2025-03-13 13:17:50,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:17:50,842 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:17:50
2025-03-13 13:17:50,842 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:17:50,842 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:05,  3.81it/s]  9%|▊         | 2/23 [00:00<00:03,  5.38it/s] 13%|█▎        | 3/23 [00:00<00:03,  6.39it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.27it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.82it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.26it/s] 30%|███       | 7/23 [00:00<00:01,  8.70it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.77it/s] 39%|███▉      | 9/23 [00:01<00:01,  9.08it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.05it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.01it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.10it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.10it/s] 61%|██████    | 14/23 [00:01<00:00,  9.23it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.37it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.42it/s] 74%|███████▍  | 17/23 [00:02<00:00,  9.40it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.45it/s] 83%|████████▎ | 19/23 [00:02<00:00,  9.43it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.39it/s] 91%|█████████▏| 21/23 [00:05<00:02,  1.08s/it]100%|██████████| 23/23 [00:06<00:00,  1.21it/s]100%|██████████| 23/23 [00:06<00:00,  3.41it/s]
2025-03-13 13:17:57,598 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:17:57
2025-03-13 13:18:41,002 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4028 secs
2025-03-13 13:18:41,002 [INFO]: The best hyperparameters are: efSearch=194
2025-03-13 13:18:41,002 [INFO]: 	Compute fast metrics 03/13/2025, 13:18:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-13 13:19:06,202 [INFO]: 	>>> Finished "Compute fast metrics" in 25.1997 secs
2025-03-13 13:19:06,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5469 secs
2025-03-13 13:19:06,390 [INFO]: {
2025-03-13 13:19:06,390 [INFO]: 	index_key: HNSW15
2025-03-13 13:19:06,390 [INFO]: 	index_param: efSearch=194
2025-03-13 13:19:06,390 [INFO]: 	index_path: knn.index
2025-03-13 13:19:06,390 [INFO]: 	size in bytes: 1075797010
2025-03-13 13:19:06,390 [INFO]: 	avg_search_speed_ms: 14.908493715428627
2025-03-13 13:19:06,390 [INFO]: 	99p_search_speed_ms: 22.57978864945471
2025-03-13 13:19:06,390 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:19:06,390 [INFO]: 	nb vectors: 5468
2025-03-13 13:19:06,390 [INFO]: 	vectors dimension: 49152
2025-03-13 13:19:06,390 [INFO]: 	compression ratio: 0.9993079865503623
2025-03-13 13:19:06,390 [INFO]: }
2025-03-13 13:19:06,390 [INFO]: 	>>> Finished "Creating the index" in 75.5491 secs
2025-03-13 13:19:06,390 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5748 secs
2025-03-13 13:19:08: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 14503 [episode count 7/20]
[retrieval_preprocessing] for episode 72358 [episode count 8/20], we have num_retrieval=np.int64(5585) num_query=np.int64(282)
2025-03-13 13:19:12,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:19:13,654 [INFO]: Launching the whole pipeline 03/13/2025, 13:19:13
2025-03-13 13:19:13,655 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:19:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.99it/s]
2025-03-13 13:19:13,683 [INFO]: There are 5585 embeddings of dim 49152
2025-03-13 13:19:13,684 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-13 13:19:13,684 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:19:13
2025-03-13 13:19:13,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:19:13,684 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:19:13,684 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:19:13,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:19:13,684 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:19:13
2025-03-13 13:19:13,684 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:19:13,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:19:13,684 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:19:13
2025-03-13 13:19:13,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:19:13,684 [INFO]: 	Creating the index 03/13/2025, 13:19:13
2025-03-13 13:19:13,685 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:19:13
2025-03-13 13:19:13,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-13 13:19:13,686 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:19:13
2025-03-13 13:19:13,686 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:19:13,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.13it/s]  9%|▊         | 2/23 [00:00<00:03,  6.97it/s] 17%|█▋        | 4/23 [00:00<00:02,  9.07it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.73it/s] 35%|███▍      | 8/23 [00:00<00:01, 10.00it/s] 43%|████▎     | 10/23 [00:01<00:01, 10.06it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.10it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.24it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.63it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.13it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.35it/s] 91%|█████████▏| 21/23 [00:07<00:01,  1.14it/s] 96%|█████████▌| 22/23 [00:07<00:00,  1.36it/s]100%|██████████| 23/23 [00:09<00:00,  1.00it/s]100%|██████████| 23/23 [00:09<00:00,  2.51it/s]
2025-03-13 13:19:22,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:19:22
2025-03-13 13:20:09,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1986 secs
2025-03-13 13:20:09,068 [INFO]: The best hyperparameters are: efSearch=287
2025-03-13 13:20:09,068 [INFO]: 	Compute fast metrics 03/13/2025, 13:20:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-13 13:20:29,244 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1759 secs
2025-03-13 13:20:29,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5591 secs
2025-03-13 13:20:29,245 [INFO]: {
2025-03-13 13:20:29,245 [INFO]: 	index_key: HNSW15
2025-03-13 13:20:29,245 [INFO]: 	index_param: efSearch=287
2025-03-13 13:20:29,245 [INFO]: 	index_path: knn.index
2025-03-13 13:20:29,245 [INFO]: 	size in bytes: 1098816130
2025-03-13 13:20:29,245 [INFO]: 	avg_search_speed_ms: 10.981868929766389
2025-03-13 13:20:29,245 [INFO]: 	99p_search_speed_ms: 15.435237251222123
2025-03-13 13:20:29,245 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:20:29,245 [INFO]: 	nb vectors: 5585
2025-03-13 13:20:29,245 [INFO]: 	vectors dimension: 49152
2025-03-13 13:20:29,245 [INFO]: 	compression ratio: 0.9993079369885114
2025-03-13 13:20:29,245 [INFO]: }
2025-03-13 13:20:29,245 [INFO]: 	>>> Finished "Creating the index" in 75.5607 secs
2025-03-13 13:20:29,245 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5906 secs
2025-03-13 13:20:31: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:20:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 72358 [episode count 8/20]
[retrieval_preprocessing] for episode 15631 [episode count 9/20], we have num_retrieval=np.int64(5591) num_query=np.int64(276)
2025-03-13 13:20:34,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:20:35,492 [INFO]: Launching the whole pipeline 03/13/2025, 13:20:35
2025-03-13 13:20:35,492 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:20:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.03it/s]
2025-03-13 13:20:35,519 [INFO]: There are 5591 embeddings of dim 49152
2025-03-13 13:20:35,519 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-13 13:20:35,519 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:20:35
2025-03-13 13:20:35,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:20:35,520 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:20:35,520 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:20:35,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:20:35,520 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:20:35
2025-03-13 13:20:35,520 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:20:35,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:20:35,520 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:20:35
2025-03-13 13:20:35,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:20:35,520 [INFO]: 	Creating the index 03/13/2025, 13:20:35
2025-03-13 13:20:35,520 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:20:35
2025-03-13 13:20:35,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:20:35,521 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:20:35
2025-03-13 13:20:35,521 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:20:35,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.50it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.55it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.98it/s] 30%|███       | 7/23 [00:00<00:01, 11.75it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.11it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.34it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.61it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.52it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.56it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.51it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.67it/s]100%|██████████| 23/23 [00:06<00:00,  1.66it/s]100%|██████████| 23/23 [00:06<00:00,  3.62it/s]
2025-03-13 13:20:41,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:20:41
2025-03-13 13:21:24,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5098 secs
2025-03-13 13:21:24,389 [INFO]: The best hyperparameters are: efSearch=202
2025-03-13 13:21:24,389 [INFO]: 	Compute fast metrics 03/13/2025, 13:21:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.81it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-13 13:21:46,650 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2608 secs
2025-03-13 13:21:46,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1300 secs
2025-03-13 13:21:46,651 [INFO]: {
2025-03-13 13:21:46,651 [INFO]: 	index_key: HNSW15
2025-03-13 13:21:46,651 [INFO]: 	index_param: efSearch=202
2025-03-13 13:21:46,651 [INFO]: 	index_path: knn.index
2025-03-13 13:21:46,651 [INFO]: 	size in bytes: 1099996570
2025-03-13 13:21:46,651 [INFO]: 	avg_search_speed_ms: 8.817880769421198
2025-03-13 13:21:46,651 [INFO]: 	99p_search_speed_ms: 13.42643538257108
2025-03-13 13:21:46,651 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:21:46,651 [INFO]: 	nb vectors: 5591
2025-03-13 13:21:46,651 [INFO]: 	vectors dimension: 49152
2025-03-13 13:21:46,651 [INFO]: 	compression ratio: 0.9993079596602742
2025-03-13 13:21:46,651 [INFO]: }
2025-03-13 13:21:46,651 [INFO]: 	>>> Finished "Creating the index" in 71.1315 secs
2025-03-13 13:21:46,651 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1591 secs
2025-03-13 13:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 15631 [episode count 9/20]
[retrieval_preprocessing] for episode 29463 [episode count 10/20], we have num_retrieval=np.int64(5640) num_query=np.int64(227)
2025-03-13 13:21:51,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:21:51,984 [INFO]: Launching the whole pipeline 03/13/2025, 13:21:51
2025-03-13 13:21:51,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:21:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 915.79it/s]
2025-03-13 13:21:52,010 [INFO]: There are 5640 embeddings of dim 49152
2025-03-13 13:21:52,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 13:21:52,010 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:21:52
2025-03-13 13:21:52,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:21:52,010 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:21:52,010 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:21:52,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:21:52,010 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:21:52
2025-03-13 13:21:52,010 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:21:52,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-13 13:21:52,011 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:21:52
2025-03-13 13:21:52,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:21:52,011 [INFO]: 	Creating the index 03/13/2025, 13:21:52
2025-03-13 13:21:52,011 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:21:52
2025-03-13 13:21:52,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:21:52,012 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:21:52
2025-03-13 13:21:52,012 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:21:52,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  4.99it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.39it/s] 21%|██        | 5/24 [00:00<00:01,  9.79it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.44it/s] 38%|███▊      | 9/24 [00:00<00:01, 10.88it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.10it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.28it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.27it/s] 71%|███████   | 17/24 [00:01<00:00, 11.31it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.47it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.63it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.21it/s]100%|██████████| 24/24 [00:06<00:00,  1.71it/s]100%|██████████| 24/24 [00:06<00:00,  3.57it/s]
2025-03-13 13:21:58,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:21:58
2025-03-13 13:22:43,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7130 secs
2025-03-13 13:22:43,451 [INFO]: The best hyperparameters are: efSearch=297
2025-03-13 13:22:43,451 [INFO]: 	Compute fast metrics 03/13/2025, 13:22:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-13 13:23:04,538 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0870 secs
2025-03-13 13:23:04,539 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5273 secs
2025-03-13 13:23:04,540 [INFO]: {
2025-03-13 13:23:04,540 [INFO]: 	index_key: HNSW15
2025-03-13 13:23:04,540 [INFO]: 	index_param: efSearch=297
2025-03-13 13:23:04,540 [INFO]: 	index_path: knn.index
2025-03-13 13:23:04,540 [INFO]: 	size in bytes: 1109637010
2025-03-13 13:23:04,540 [INFO]: 	avg_search_speed_ms: 13.460144965281437
2025-03-13 13:23:04,540 [INFO]: 	99p_search_speed_ms: 22.01469350140542
2025-03-13 13:23:04,540 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:23:04,540 [INFO]: 	nb vectors: 5640
2025-03-13 13:23:04,540 [INFO]: 	vectors dimension: 49152
2025-03-13 13:23:04,540 [INFO]: 	compression ratio: 0.9993079809044941
2025-03-13 13:23:04,540 [INFO]: }
2025-03-13 13:23:04,540 [INFO]: 	>>> Finished "Creating the index" in 72.5291 secs
2025-03-13 13:23:04,540 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5553 secs
2025-03-13 13:23:06: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:23:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 29463 [episode count 10/20]
[retrieval_preprocessing] for episode 17222 [episode count 11/20], we have num_retrieval=np.int64(5579) num_query=np.int64(288)
2025-03-13 13:23:10,409 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:23:11,398 [INFO]: Launching the whole pipeline 03/13/2025, 13:23:11
2025-03-13 13:23:11,398 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:23:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.69it/s]
2025-03-13 13:23:11,423 [INFO]: There are 5579 embeddings of dim 49152
2025-03-13 13:23:11,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-13 13:23:11,424 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:23:11
2025-03-13 13:23:11,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:23:11,424 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:23:11,424 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:23:11,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:23:11,424 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:23:11
2025-03-13 13:23:11,424 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:23:11,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:23:11,424 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:23:11
2025-03-13 13:23:11,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:23:11,424 [INFO]: 	Creating the index 03/13/2025, 13:23:11
2025-03-13 13:23:11,424 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:23:11
2025-03-13 13:23:11,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:23:11,425 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:23:11
2025-03-13 13:23:11,425 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:23:11,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.13it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.39it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.48it/s] 30%|███       | 7/23 [00:00<00:01,  9.94it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.95it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.95it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.93it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.79it/s] 61%|██████    | 14/23 [00:01<00:00,  9.71it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.65it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.61it/s] 74%|███████▍  | 17/23 [00:01<00:00,  9.66it/s] 78%|███████▊  | 18/23 [00:01<00:00,  8.61it/s] 83%|████████▎ | 19/23 [00:02<00:00,  7.27it/s] 87%|████████▋ | 20/23 [00:02<00:00,  7.42it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.24s/it] 96%|█████████▌| 22/23 [00:06<00:00,  1.10it/s]100%|██████████| 23/23 [00:07<00:00,  1.00it/s]100%|██████████| 23/23 [00:07<00:00,  3.08it/s]
2025-03-13 13:23:18,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:23:18
2025-03-13 13:24:01,282 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3770 secs
2025-03-13 13:24:01,283 [INFO]: The best hyperparameters are: efSearch=238
2025-03-13 13:24:01,283 [INFO]: 	Compute fast metrics 03/13/2025, 13:24:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-13 13:24:26,910 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6272 secs
2025-03-13 13:24:26,911 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4860 secs
2025-03-13 13:24:26,911 [INFO]: {
2025-03-13 13:24:26,911 [INFO]: 	index_key: HNSW15
2025-03-13 13:24:26,911 [INFO]: 	index_param: efSearch=238
2025-03-13 13:24:26,911 [INFO]: 	index_path: knn.index
2025-03-13 13:24:26,911 [INFO]: 	size in bytes: 1097635690
2025-03-13 13:24:26,911 [INFO]: 	avg_search_speed_ms: 9.480998597783147
2025-03-13 13:24:26,911 [INFO]: 	99p_search_speed_ms: 15.406833016313614
2025-03-13 13:24:26,911 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:24:26,911 [INFO]: 	nb vectors: 5579
2025-03-13 13:24:26,911 [INFO]: 	vectors dimension: 49152
2025-03-13 13:24:26,911 [INFO]: 	compression ratio: 0.9993079142679845
2025-03-13 13:24:26,911 [INFO]: }
2025-03-13 13:24:26,911 [INFO]: 	>>> Finished "Creating the index" in 75.4874 secs
2025-03-13 13:24:26,911 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5134 secs
2025-03-13 13:24:28: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:24:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 17222 [episode count 11/20]
[retrieval_preprocessing] for episode 5920 [episode count 12/20], we have num_retrieval=np.int64(5553) num_query=np.int64(314)
2025-03-13 13:24:31,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:24:32,766 [INFO]: Launching the whole pipeline 03/13/2025, 13:24:32
2025-03-13 13:24:32,766 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:24:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.83it/s]
2025-03-13 13:24:32,793 [INFO]: There are 5553 embeddings of dim 49152
2025-03-13 13:24:32,793 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-13 13:24:32,793 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:24:32
2025-03-13 13:24:32,793 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:24:32,793 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:24:32,793 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:24:32,793 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:24:32,793 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:24:32
2025-03-13 13:24:32,793 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:24:32,793 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:24:32,793 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:24:32
2025-03-13 13:24:32,793 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:24:32,794 [INFO]: 	Creating the index 03/13/2025, 13:24:32
2025-03-13 13:24:32,794 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:24:32
2025-03-13 13:24:32,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-13 13:24:32,795 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:24:32
2025-03-13 13:24:32,795 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:24:32,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.62it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.30it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.11it/s] 30%|███       | 7/23 [00:00<00:01, 11.92it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.97it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.04it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.76it/s] 65%|██████▌   | 15/23 [00:01<00:00, 14.91it/s] 74%|███████▍  | 17/23 [00:01<00:00, 15.23it/s] 83%|████████▎ | 19/23 [00:01<00:00, 14.61it/s] 91%|█████████▏| 21/23 [00:04<00:01,  1.69it/s]100%|██████████| 23/23 [00:06<00:00,  1.64it/s]100%|██████████| 23/23 [00:06<00:00,  3.67it/s]
2025-03-13 13:24:39,069 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:24:39
2025-03-13 13:25:24,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6179 secs
2025-03-13 13:25:24,688 [INFO]: The best hyperparameters are: efSearch=245
2025-03-13 13:25:24,688 [INFO]: 	Compute fast metrics 03/13/2025, 13:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-13 13:25:44,532 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8438 secs
2025-03-13 13:25:44,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7377 secs
2025-03-13 13:25:44,533 [INFO]: {
2025-03-13 13:25:44,533 [INFO]: 	index_key: HNSW15
2025-03-13 13:25:44,533 [INFO]: 	index_param: efSearch=245
2025-03-13 13:25:44,533 [INFO]: 	index_path: knn.index
2025-03-13 13:25:44,533 [INFO]: 	size in bytes: 1092520210
2025-03-13 13:25:44,533 [INFO]: 	avg_search_speed_ms: 10.628302288404987
2025-03-13 13:25:44,533 [INFO]: 	99p_search_speed_ms: 14.460001420229675
2025-03-13 13:25:44,533 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:25:44,533 [INFO]: 	nb vectors: 5553
2025-03-13 13:25:44,533 [INFO]: 	vectors dimension: 49152
2025-03-13 13:25:44,533 [INFO]: 	compression ratio: 0.9993080347685285
2025-03-13 13:25:44,533 [INFO]: }
2025-03-13 13:25:44,533 [INFO]: 	>>> Finished "Creating the index" in 71.7397 secs
2025-03-13 13:25:44,533 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7669 secs
2025-03-13 13:25:46: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:25:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 5920 [episode count 12/20]
[retrieval_preprocessing] for episode 16695 [episode count 13/20], we have num_retrieval=np.int64(5570) num_query=np.int64(297)
2025-03-13 13:25:49,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:25:49,797 [INFO]: Launching the whole pipeline 03/13/2025, 13:25:49
2025-03-13 13:25:49,797 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:25:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1528.54it/s]
2025-03-13 13:25:49,821 [INFO]: There are 5570 embeddings of dim 49152
2025-03-13 13:25:49,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-13 13:25:49,821 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:25:49
2025-03-13 13:25:49,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:25:49,821 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:25:49,821 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:25:49,821 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:25:49,821 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:25:49
2025-03-13 13:25:49,821 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:25:49,822 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:25:49,822 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:25:49
2025-03-13 13:25:49,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:25:49,822 [INFO]: 	Creating the index 03/13/2025, 13:25:49
2025-03-13 13:25:49,822 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:25:49
2025-03-13 13:25:49,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-13 13:25:49,823 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:25:49
2025-03-13 13:25:49,823 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:25:49,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.14it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.23it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.66it/s] 30%|███       | 7/23 [00:00<00:01, 11.50it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.90it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.12it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.38it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.48it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.50it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.69it/s] 91%|█████████▏| 21/23 [00:04<00:01,  1.76it/s] 96%|█████████▌| 22/23 [00:05<00:00,  2.06it/s]100%|██████████| 23/23 [00:06<00:00,  1.62it/s]100%|██████████| 23/23 [00:06<00:00,  3.71it/s]
2025-03-13 13:25:56,023 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:25:56
2025-03-13 13:26:39,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2895 secs
2025-03-13 13:26:39,314 [INFO]: The best hyperparameters are: efSearch=261
2025-03-13 13:26:39,314 [INFO]: 	Compute fast metrics 03/13/2025, 13:26:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-13 13:26:58,683 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3697 secs
2025-03-13 13:26:58,684 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8614 secs
2025-03-13 13:26:58,684 [INFO]: {
2025-03-13 13:26:58,684 [INFO]: 	index_key: HNSW15
2025-03-13 13:26:58,684 [INFO]: 	index_param: efSearch=261
2025-03-13 13:26:58,684 [INFO]: 	index_path: knn.index
2025-03-13 13:26:58,684 [INFO]: 	size in bytes: 1095864910
2025-03-13 13:26:58,684 [INFO]: 	avg_search_speed_ms: 12.011934293429551
2025-03-13 13:26:58,684 [INFO]: 	99p_search_speed_ms: 20.779956793412563
2025-03-13 13:26:58,684 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:26:58,684 [INFO]: 	nb vectors: 5570
2025-03-13 13:26:58,684 [INFO]: 	vectors dimension: 49152
2025-03-13 13:26:58,684 [INFO]: 	compression ratio: 0.9993079895221757
2025-03-13 13:26:58,684 [INFO]: }
2025-03-13 13:26:58,684 [INFO]: 	>>> Finished "Creating the index" in 68.8627 secs
2025-03-13 13:26:58,684 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8876 secs
2025-03-13 13:27:00: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:27:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 16695 [episode count 13/20]
[retrieval_preprocessing] for episode 18361 [episode count 14/20], we have num_retrieval=np.int64(5534) num_query=np.int64(333)
2025-03-13 13:27:03,258 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:27:04,127 [INFO]: Launching the whole pipeline 03/13/2025, 13:27:04
2025-03-13 13:27:04,127 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:27:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.83it/s]
2025-03-13 13:27:04,152 [INFO]: There are 5534 embeddings of dim 49152
2025-03-13 13:27:04,152 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-13 13:27:04,153 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:27:04
2025-03-13 13:27:04,153 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:27:04,153 [INFO]: 		-> Add: 3.0 seconds
2025-03-13 13:27:04,153 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:27:04,153 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-13 13:27:04,153 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:27:04
2025-03-13 13:27:04,154 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:27:04,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-13 13:27:04,154 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:27:04
2025-03-13 13:27:04,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:27:04,154 [INFO]: 	Creating the index 03/13/2025, 13:27:04
2025-03-13 13:27:04,155 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:27:04
2025-03-13 13:27:04,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-13 13:27:04,158 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:27:04
2025-03-13 13:27:04,158 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:27:04,158 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.47it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.89it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.89it/s] 30%|███       | 7/23 [00:00<00:01, 10.35it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.14it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.21it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.29it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.33it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.49it/s] 61%|██████    | 14/23 [00:01<00:00,  9.55it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.57it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.53it/s] 74%|███████▍  | 17/23 [00:01<00:00,  9.49it/s] 78%|███████▊  | 18/23 [00:01<00:00,  9.62it/s] 83%|████████▎ | 19/23 [00:02<00:00,  9.61it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.47it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.30s/it]100%|██████████| 23/23 [00:07<00:00,  1.03s/it]100%|██████████| 23/23 [00:07<00:00,  3.00it/s]
2025-03-13 13:27:12,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:27:12
2025-03-13 13:27:55,444 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3931 secs
2025-03-13 13:27:55,445 [INFO]: The best hyperparameters are: efSearch=270
2025-03-13 13:27:55,445 [INFO]: 	Compute fast metrics 03/13/2025, 13:27:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-13 13:28:21,129 [INFO]: 	>>> Finished "Compute fast metrics" in 25.6838 secs
2025-03-13 13:28:22,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.9983 secs
2025-03-13 13:28:22,157 [INFO]: {
2025-03-13 13:28:22,157 [INFO]: 	index_key: HNSW15
2025-03-13 13:28:22,157 [INFO]: 	index_param: efSearch=270
2025-03-13 13:28:22,157 [INFO]: 	index_path: knn.index
2025-03-13 13:28:22,157 [INFO]: 	size in bytes: 1088782150
2025-03-13 13:28:22,157 [INFO]: 	avg_search_speed_ms: 11.858048215773605
2025-03-13 13:28:22,157 [INFO]: 	99p_search_speed_ms: 24.117109435610537
2025-03-13 13:28:22,157 [INFO]: 	reconstruction error %: 0.0
2025-03-13 13:28:22,157 [INFO]: 	nb vectors: 5534
2025-03-13 13:28:22,157 [INFO]: 	vectors dimension: 49152
2025-03-13 13:28:22,157 [INFO]: 	compression ratio: 0.9993079625708412
2025-03-13 13:28:22,157 [INFO]: }
2025-03-13 13:28:22,157 [INFO]: 	>>> Finished "Creating the index" in 78.0029 secs
2025-03-13 13:28:22,157 [INFO]: >>> Finished "Launching the whole pipeline" in 78.0304 secs
2025-03-13 13:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-13 13:28:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 18361 [episode count 14/20]
[retrieval_preprocessing] for episode 36576 [episode count 15/20], we have num_retrieval=np.int64(5667) num_query=np.int64(200)
2025-03-13 13:28:27,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-13 13:28:27,984 [INFO]: Launching the whole pipeline 03/13/2025, 13:28:27
2025-03-13 13:28:27,984 [INFO]: Reading total number of vectors and dimension 03/13/2025, 13:28:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1005.83it/s]
2025-03-13 13:28:28,008 [INFO]: There are 5667 embeddings of dim 49152
2025-03-13 13:28:28,008 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-13 13:28:28,008 [INFO]: 	Compute estimated construction time of the index 03/13/2025, 13:28:28
2025-03-13 13:28:28,008 [INFO]: 		-> Train: 16.7 minutes
2025-03-13 13:28:28,008 [INFO]: 		-> Add: 3.1 seconds
2025-03-13 13:28:28,008 [INFO]: 		Total: 16.7 minutes
2025-03-13 13:28:28,008 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-13 13:28:28,008 [INFO]: 	Checking that your have enough memory available to create the index 03/13/2025, 13:28:28
2025-03-13 13:28:28,009 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-13 13:28:28,009 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-13 13:28:28,009 [INFO]: 	Selecting most promising index types given data characteristics 03/13/2025, 13:28:28
2025-03-13 13:28:28,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-13 13:28:28,009 [INFO]: 	Creating the index 03/13/2025, 13:28:28
2025-03-13 13:28:28,009 [INFO]: 		-> Instanciate the index HNSW15 03/13/2025, 13:28:28
2025-03-13 13:28:28,010 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-13 13:28:28,010 [INFO]: 		-> Adding the vectors to the index 03/13/2025, 13:28:28
2025-03-13 13:28:28,010 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-13 13:28:28,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.42it/s] 12%|█▎        | 3/24 [00:00<00:01, 11.71it/s] 21%|██        | 5/24 [00:00<00:01, 13.57it/s] 29%|██▉       | 7/24 [00:00<00:01, 14.41it/s] 38%|███▊      | 9/24 [00:00<00:00, 15.00it/s] 46%|████▌     | 11/24 [00:00<00:00, 15.71it/s] 54%|█████▍    | 13/24 [00:00<00:00, 14.65it/s] 62%|██████▎   | 15/24 [00:01<00:00, 13.49it/s] 71%|███████   | 17/24 [00:01<00:00, 12.91it/s] 79%|███████▉  | 19/24 [00:01<00:00, 12.62it/s] 88%|████████▊ | 21/24 [00:04<00:01,  1.81it/s] 92%|█████████▏| 22/24 [00:04<00:00,  2.12it/s]100%|██████████| 24/24 [00:06<00:00,  1.86it/s]100%|██████████| 24/24 [00:06<00:00,  3.92it/s]
2025-03-13 13:28:34,128 [INFO]: 	Computing best hyperparameters for index knn.index 03/13/2025, 13:28:34
2025-03-13 13:29:15,840 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7120 secs
2025-03-13 13:29:15,841 [INFO]: The best hyperparameters are: efSearch=168
2025-03-13 13:29:15,841 [INFO]: 	Compute fast metrics 03/13/2025, 13:29:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 50%|█████     | 2/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
